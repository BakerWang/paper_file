<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:wb="http://open.weibo.com/wb" xml:lang="en" lang="en">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <link rel="shortcut icon" href="http://bobao.360.cn/favicon.ico?v=1.1"/>
    <link rel="alternate" title="安全资讯" href="/rss?type=news" type="application/rss+xml"/>
    <link rel="alternate" title="安全知识" href="/rss?type=learning" type="application/rss+xml"/>
    <link rel="alternate" title="安全圈活动" href="/rss?type=activity" type="application/rss+xml"/>
    <link rel="alternate" title="所有漏洞" href="/rss?type=vul" type="application/rss+xml"/>
    <link rel="alternate" title="通用型漏洞" href="/rss?type=commonvul" type="application/rss+xml"/>
    <link rel="alternate" title="事件型漏洞" href="/rss?type=eventvul" type="application/rss+xml"/>
    <link rel="alternate" title="热门漏洞" href="/rss?type=hotvul" type="application/rss+xml"/>

        <title>【木马分析】Cerber敲诈者家族再升级：Cerber4变身随机后缀 - 安全客 - 有思想的安全新媒体</title>
    
        <meta name="keywords" content="Cerber,敲诈者木马,Cerber4,360QVM"/>
    
        <meta name="description" content="对贪得无厌的病毒制作者来说，变种更新的速度也是极快的，新一代Cerber病毒很快涌现出来。360QVM团队在监测到Cerber4病毒变种后进行深入调查，此文是针对该变种的详细技术分析。"/>
        <meta property="wb:webmaster" content="224437c7be31d633"/>

    <script type="text/javascript" src="http://s7.qhimg.com/!56caa871/xpc_sync_height.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/reset.css" />
    <link rel="stylesheet" type="text/css" href="/css/common_new.css?v=4.4.2.1" />
    <link rel="stylesheet" type="text/css" href="/css/jquery.notyfy.css" />
    <link rel="stylesheet" type="text/css" href="/css/notyfy.theme.default.css" />
    <link rel="stylesheet" type="text/css" href="/css/s_common.css?v=2.2.7" media="only screen and
    (max-device-width:900px), only screen and (max-width:900px)" />
    <script type="text/javascript" src="/js/jquery.min.js?v=3.1"></script>
    <script type="text/javascript" src="/js/jquery.notyfy.js"></script>
    <script type="text/javascript" src="/js/iscroll.js"></script>
    <script src="http://js.passport.qihucdn.com/5.0.3.js"></script>
    <script type="text/javascript">
        var myScroll, myNavScroll;

        function iscrollLoaded() {
            myScroll = new IScroll('#wrapper',
                {
                    scrollX: true,
                    scrollY: false,
                    bounceEasing: 'circular',
                    eventPassthrough: true,
                    preventDefault: false,
                    bounceTime: 500
                }
            );
        }

        $(function () {

            //导航横向滚动


            function setNavWidth() {

                /* 计算导航宽度 */
                var allWidth = $(window).width();
                var scroller = $('#scroller');

                if (allWidth > 900) {
                    scroller.find('ul').add(scroller.find('.scroll')).removeAttr('style');
                    scroller.css('overflow', 'visible');
                    if (myNavScroll) myNavScroll.destroy();
                } else {

                    var width = 0;
                    scroller.find('.scroll').children('ul').children('li').each(function (index, el) {
                        if (!$(this).hasClass('mobile-hide')) {
                            width += $(this).outerWidth();
                        }
                    });
                    scroller.find('ul').add(scroller.find('.scroll')).width(width);

                    if (myNavScroll) myNavScroll.destroy();

                    myNavScroll = new IScroll('#scroller', {
                        scrollX: true,
                        scrollY: false,
                        momentum: false,
                        click: true
                    });

                }

            }

            setNavWidth();
            $(window).resize(function (event) {
                setNavWidth();
            });

        });

    </script>
</head>
<body onload="iscrollLoaded();">
<div style='margin:0 auto;width:0px;height:0px;overflow:hidden;'>
    <img src=""/>
</div>

<div id="is-mobile"></div>
<div class="container">
        <div class="mobile-header">
        <div class="header clearfix">
            <div class="header-wrapper clearfix">
                <a href="/index/index" class="logo"><img class="slogan" src="/img/logo.png?v=1.5"/></a>
                                <form id="search" class="search-box" action="/search/index" method="GET">
                    <input class="keys" name="keywords" type="text" placeholder="搜索漏洞" required="required">
                    <input class="icon" type="submit" value="">
                    <input type="hidden" name="type" value=""/>
                </form>
                <div class="bug">
                    <div class="name"><span class="seled">全部</span><i class="arrow"></i></div>
                    <ul class="typelist">
                        <li data-index="3"><a href="javascript:void(0);">全部</a></li>
                        <li data-index="0"><a href="javascript:void(0);">漏洞</a></li>
                        <li data-index="1"><a href="javascript:void(0);">资讯</a></li>
                        <li data-index="2"><a href="javascript:void(0);">知识</a></li>
                    </ul>
                </div>
                                <div class="logNreg mobile-hide">
                    <div class="unlog">
                        <i></i>
                        <a href="log.html" class="log">登录</a>
                        <span>|</span>
                        <a href="reg.html" class="reg">注册</a>
                    </div>
                    <div class="loged">
                        <a href="/member/profile" class="user-center"><i></i><span class="user-name-tag">个人中心</span></a>
                        <div class="user-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting"><a href="http://i.360.cn/profile/accountmanage"
                                                               target="_blank"><i></i><span>账号设置</span></a></li>
                                <li class="alert-setting"><a href="/keywords/index"
                                                             target="_blank"><i></i><span>告警设置</span></a></li>
                                <li class="bug-alert"><a href="/myalarm/index" target="_blank"><i></i><span>漏洞告警</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mylearn/index" target="_blank"><i></i><span>我的知识</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mycourse/index" target="_blank"><i></i><span>我的课堂</span></a>
                                </li>
                                <li class="my-exit"><a
                                            href="http://login.360.cn/?src=pcw_adlab&op=logout&destUrl=http://bobao.360.cn"><i></i><span>退出系统</span></a>
                                </li>
                            </ul>
                        </div>

                        <a href="/message" class="message-center" target="_blank"><i></i><span>我的消息</span></a>
                        <div class="message-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting" style="display:none;"><a href="/myres/index"
                                                                                     target="_blank"><i></i><span>回复我的</span></a>
                                </li>
                                <li class="my-bug"><a href="/myvul/index"
                                                      target="_blank"><i></i><span>我的漏洞</span></a></li>
                                <!--<li class="my-bug"><a href="/myres/index" target="_blank"><i></i><span>我的评论</span></a></li>-->
                                <!--<li class="alert-setting"><a href="###" target="_blank"><i></i><span>提到我的</span></a>
                                </li>-->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <style type="text/css">
            .nav {
                overflow: hidden;
            }

            .nav .scroll {
                width: auto;
            }
        </style>
        <div id="wrapper">
            <div id="scroller" class="nav">
                <div class="scroll">
                    <ul class="nav-list">
                        <li ><a class="link-nav"
                                                                                 href="/index/index">首页</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/vul/index">漏洞</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/introduce/list">招聘</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/news/index">资讯</a><!--<i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/introduce/list">招聘</a></li>
                        </ul>
			-->
                        </li>
                        <li class="cur">
                        <a class="link-nav" href="/learning/index">知识</a><i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/course/index">学院</a></li>
                        </ul>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/activity/index">活动</a></li>
                        <li class="mobile-hide "><a class="link-nav"
                                                                                                   href="/ctf/index">CTF训练营</a>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/interref/list">安全内参</a></li>
                        <li ><a class="link-nav" href="/app/index">APP</a></li>

                        <!--<li ><a href="/course/index">学院</a></li>-->
                        <!--<li ><a href="/introduce/list">招聘</a></li>-->
                        <!--<li  class="mobile-hide"><a href="/ctf/index">CTF训练营</a></li>-->
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="mobile-content">
        <link rel="stylesheet" type="text/css" href="/css/news.css?v=3.5" />
<link rel="stylesheet" type="text/css" href="/ue/SyntaxHighlighter/shCoreDefault.css?v=1.0" />
<style>
    p .syntaxhighlighter {
        width: 80%;
    }
</style>

<div class="cur-pos w1000">当前位置：<a href="http://bobao.360.cn/">安全客</a> &gt;&gt; 知识详情</div>

<div class="content clearfix">
    <div class="main">
        <div class="article">
            <div id="article_box">
                <h2>【木马分析】Cerber敲诈者家族再升级：Cerber4变身随机后缀</h2>
                <div class="article-msg">
                    <span class="time">2016-10-17 10:49:53</span>
                    
                                        <span class="read">阅读：19305次</span>
                    <span><a style="display: none;" class="good" href="javascript:;"
                             data-target="/learning/good" data-value="g_3108"
                             data-type="learning">点赞(0)</a></span>
                    <span><a class="fav" href="javascript:;" data-target="/mylearning/add"
                             data-pk="3108" data-type="learning">收藏</a></span>
                                        <span><a style="margin-left: 4px;" class="fav" href=""
                             target="_blank">来源： 安全客</a></span>
                    
                    
                    <div style="margin-top:10px; ">
                        <a href="/member/contribute?uid=2515404125" style="color:#848e99;">
                            <img src="http://p1.qhmsg.com/dm/150_150_100/t00df551a583a87f4e9.jpg" data-is-avatar="true"
                                 style="border: 1px solid #d5d5d5;padding: 2px; width: 80px;height: 80px;border-radius: 43px;"/>
                        </a>

                    </div>
                    <span class="orig">作者：<a href="/member/contribute?uid=2515404125" style="color:#848e99;">360QVM</a></span>
                                    </div>
                <hr size="1">
                <div class="article-msg">
                    <p><!-- JiaThis Button BEGIN -->

<!--
<span class="jiathis_style"><span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_tsina"></a>
    <a class="jiathis_button_tqq"></a>
    <a class="jiathis_button_qzone"></a>
    <a class="jiathis_button_renren"></a>
    <a class="jiathis_button_xiaoyou"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
</span>

-->
</p>
                </div>
                <p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><img src="http://p4.qhimg.com/t01ca0868c789b8acce.jpg" title="t01ca0868c789b8acce.jpg" alt="http://p4.qhimg.com/t01ca0868c789b8acce.jpg"/></span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(255, 0, 0);">从今年3月开始，Cerber敲诈者病毒家族开始在世界各地肆虐。在中国，Cerber3则成为近期敲诈者大军中的“明星成员”，电脑中毒后文件后缀变为cerber3的受害者求助在各大论坛比比皆是。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">对贪得无厌的病毒制作者来说，变种更新的速度也是极快的，新一代Cerber病毒——Cerber4又很快涌现出来。但这次它不再使用标志性的Cerber系列后缀，而是把加密文件后缀修改为4个随机字符（数字和字母），例如.w2qt等。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">360QVM团队在监测到Cerber4病毒变种后进行深入调查，发现该变种主打网站挂马传播，且更新了多国语言版本的勒索(根据本地语言)，将勒索信息存于后缀为hta的进程中。此外，Cerber4还增加了判断本机时间执行恶意操作、关闭数据库进程以加密数据文件（解除文件占用）等新的特性，但是在病毒运作流程上又回归了更传统的傀儡模式。以下是详细技术分析：</span></p><p style="text-align: left; text-indent: 2em;"><br/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong>一．	传播方式</strong></span></p><hr/><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(255, 0, 0);">Cerber4作者使用了一些Exploit工具对有漏洞的网站进行渗透，接着注入EITest脚本，最后执行最主要的payload进行下载cerber4。</span></p><p style="text-align:center"><img src="http://p0.qhimg.com/t0103390bc903a96959.png" title="t010b41cc9f8df60e27.png" alt="http://p4.qhimg.com/t010b41cc9f8df60e27.png"/></p><p style="text-align:center"><img src="http://p3.qhimg.com/t016ad438f45857e647.png" title="t0122288027773bcfa2.png" alt="http://p1.qhimg.com/t0122288027773bcfa2.png"/></p><p style="text-align: left; text-indent: 2em;"><br/></p><p style="text-align: left; text-indent: 2em;"><span style="font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong>二．	病毒运作流程</strong></span></p><hr/><p style="text-align: left; text-indent: 2em;"><strong><span style="text-indent: 2em; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">A．cerber3流程</span></strong></p><p style="text-align:center"><img src="http://p7.qhimg.com/t01757d95e94d0929d0.png" title="t0151338e69e85917bf.png" alt="http://p4.qhimg.com/t0151338e69e85917bf.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">如上图所示，cerber3本身是一个加载器，加载器使用了各种混淆技术来绕过杀软的特征检测，并通过最外层的loader加载器释放解密后的shellcode_1。Shellocde_1又充当了一层加载器，开始解密并释放shellcode_2。Shellcode_2也是一层加载器，只不过没有再进行解密释放shellcode_3。而是使用UnmapViewOfSection卸载当前的ImageBase。并把shellcode2写入到原ImageBase处。进行PE修复后，将eip设置到进程的入口点。于是乎开始执行勒索软件真正的功能了。</span></p><p style="text-align: left; text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">B．cerber4流程</span></strong></p><p style="text-align:center"><img src="http://p9.qhimg.com/t01e86ff96251c8b46d.png" title="t016ee73a2117bd78ca.png" alt="http://p2.qhimg.com/t016ee73a2117bd78ca.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(255, 0, 0);">Cerber4去除了Cerber3繁琐的加载流程，取而代之的是更为传统的傀儡模式：CreateProcess-》GetThraedContext-》ZwUnMapViewOfSection》WriteProcessMemory—》SetThreadContext-》ResumeThread。</span></p><p style="text-align: left; text-indent: 2em;"><br/></p><p style="text-align: left; text-indent: 2em;"><span style="font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong>三．	病毒分析（cerber3）</strong></span></p><hr/><p style="text-align: left; text-indent: 2em;"><strong><span style="text-indent: 2em; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">A．loader加载器</span></strong></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">a.	初始化Loader结构体</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">加载器动态的将初始化的数据存放置此结构中，以此绕过静态扫描</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t01dd8ba34cb088de2c.png" title="t01af06f2dcacac5a32.png" alt="http://p3.qhimg.com/t01af06f2dcacac5a32.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">b.	最外层加载器</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">最外层加载器函数如下：</span></p><p style="text-align:center"><img src="http://p2.qhimg.com/t019495b653eb7b0e07.png" title="t015951266e4a082af0.png" alt="http://p9.qhimg.com/t015951266e4a082af0.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">1.获取data段首4字节中的内容，此数值为shellcode_1需要分配的大小</span></p><p style="text-align:center"><img src="http://p5.qhimg.com/t01f35973ce276cdbce.png" title="t01788a6c5fc1a64f23.png" alt="http://p4.qhimg.com/t01788a6c5fc1a64f23.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2.分配该数值大小的内存，用于存储shellcode_1</span></p><p style="text-align:center"><img src="http://p3.qhimg.com/t013b1e145c7d6802c1.png" title="t01756e9cdf43fb0dbb.png" alt="http://p5.qhimg.com/t01756e9cdf43fb0dbb.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">3.从data段首地址+4处拷贝上述shellcode_1大小的内容到shellcode_1中</span></p><p style="text-align:center"><img src="http://p8.qhimg.com/t01e320639eaaca388a.png" title="t017b412b17cbdb5d56.png" alt="http://p2.qhimg.com/t017b412b17cbdb5d56.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">4.开始解密（分2步）</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">第一步：通过简单的加减运算单个字符来实现。</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t01dff83b3807094446.png" title="t0198b4970f00499805.png" alt="http://p7.qhimg.com/t0198b4970f00499805.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">第二步：将shellcode_1+4处的4字节作为亦或运算的key，使用key解密</span></p><p style="text-align:center"><img src="http://p0.qhimg.com/t01eda78a30f3e729bc.png" title="t018a661bfbf0540598.png" alt="http://p7.qhimg.com/t018a661bfbf0540598.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">5.跳转至shellcode_1入口处</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t01e536ab376fc89a81.png" title="t01b0ad1472476a102b.png" alt="http://p1.qhimg.com/t01b0ad1472476a102b.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">c.	Shellcode_1充当加载器</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Shellcode_1加载器函数如下：</span></p><p style="text-align:center"><img src="http://p3.qhimg.com/t01b5e23ad507486582.png" title="t0166f5376ca06eb903.png" alt="http://p1.qhimg.com/t0166f5376ca06eb903.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">与之前类似，这里只贴一下部分重要函数</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">1.解密函数：简单的加减和亦或运算</span></p><p style="text-align:center"><img src="http://p2.qhimg.com/t013c45a97bcf2fba15.png" title="t01c78385b3665c3fe9.png" alt="http://p5.qhimg.com/t01c78385b3665c3fe9.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2.跳转shellcode：</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t01f75c9a7ed1ae0d28.png" title="t017e261af231255153.png" alt="http://p9.qhimg.com/t017e261af231255153.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">d.	Shellcode_2充当傀儡进程</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">1.修复PE</span></p><p style="text-align:center"><img src="http://p9.qhimg.com/t01103b7b161d2dfae2.png" title="t017a66efb7d429d3e5.png" alt="http://p6.qhimg.com/t017a66efb7d429d3e5.png"/></p><p style="text-align:center"><img src="http://p0.qhimg.com/t0107c42768ebb25bfe.png" title="t01727641a385122324.png" alt="http://p9.qhimg.com/t01727641a385122324.png"/></p><p style="text-align:center"><img src="http://p7.qhimg.com/t01650488bc4d49b6ab.png" title="t019e28121198ca8d80.png" alt="http://p3.qhimg.com/t019e28121198ca8d80.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2.UnMapViewOfSection并写入修复好的PE进行傀儡</span></p><p style="text-align:center"><img src="http://p6.qhimg.com/t0135b9aa1a72aeae40.png" title="t013388dfbd0fd2b7a6.png" alt="http://p5.qhimg.com/t013388dfbd0fd2b7a6.png"/></p><p style="text-align: left; text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">B．文件加密</span></strong></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">加密的配置完全依据病毒内存中的json中的内容来进行操作的。大致上有如下几种：</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">1.	文件夹黑名单(不能加密的文件/文件夹,如Windows文件夹等)</span></p><p style="text-align:center"><img src="http://p3.qhimg.com/t0152c51312c54a4e20.png" title="t01e3b115d42492e5aa.png" alt="http://p0.qhimg.com/t01e3b115d42492e5aa.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2.	语言地区黑名单(不能加密的地区，如：俄罗斯，乌克兰，比利时等东欧/中欧国家)</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t0130acd03fe76e82a9.png" title="t010b3b50d7954b204a.png" alt="http://p6.qhimg.com/t010b3b50d7954b204a.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">3.	需要加密的文件后缀名(主要是一些mdb，db等数据格式的文件)</span></p><p style="text-align:center"><img src="http://p8.qhimg.com/t01827fa98b44f3c358.png" title="t01196fdd2959f355b7.png" alt="http://p2.qhimg.com/t01196fdd2959f355b7.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">4.	加密算法以及加密行为的一些配置</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t017cfd527f2d961e8c.png" title="t015096bf0fd0f7a447.png" alt="http://p5.qhimg.com/t015096bf0fd0f7a447.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">分别为：加密分块的最大大小以及加密区域的个数，最小的文件大小，是否开启多线程模式来加密文件，是否加密网络共享盘，加密后的文件名后缀，rc4 key的大小，rsa key的大小以及经过base64加密后的编码。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">经过base64解密，我们可以知道这是一个2048位rsa加密的公钥</span></p><p style="text-align:center"><img src="http://p0.qhimg.com/t016a630720e1b2e696.png" title="t01ff18c075017c58b7.png" alt="http://p9.qhimg.com/t01ff18c075017c58b7.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">5.	勒索的html文件以及txt文件中的内容，也是经过base64加密编码过的</span></p><p style="text-align:center"><img src="http://p2.qhimg.com/t01032d14fd22f03b0d.png" title="t01ae31d43591ecf281.png" alt="http://p9.qhimg.com/t01ae31d43591ecf281.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">经过base64解密后，我们可以很明显的看到html的标题为勒索文件的html内容</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t01075c144a9265ea51.png" title="t01ffe6ba55de29652a.png" alt="http://p2.qhimg.com/t01ffe6ba55de29652a.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">6.	行为配置，操作系统判断，端口，C&amp;C服务器等等</span></p><p style="text-align:center"><img src="http://p2.qhimg.com/t01d08388b4f746264b.png" title="t018871370813645e6e.png" alt="http://p3.qhimg.com/t018871370813645e6e.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">分别为：是否移除卷影副本，是否删除自身，操作系统信息，C&amp;C服务器地址，连接成功后发送的标示，C&amp;C服务器端口，是否需要发送，发送超时时间，成功感染后是否需要语音提示，语音提示重复次数以及语音提示的内容。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">7.	壁纸配置(是否需要改变壁纸，壁纸内容等)，成功加密后将勒索信息显示在桌面上</span></p><p style="text-align:center"><img src="http://p3.qhimg.com/t01951ec12f9d920c0d.png" title="t01b915c71bfa339358.png" alt="http://p7.qhimg.com/t01b915c71bfa339358.png"/></p><p style="text-align:center"><img src="http://p6.qhimg.com/t01ee52a2a8138a6cd2.png" title="t0156fe14c9afb7c4f4.png" alt="http://p1.qhimg.com/t0156fe14c9afb7c4f4.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">8.	文件夹白名单(必须要加密的文件/文件夹，如outlook，powerpoint等文件夹)</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t0155486436d9abf51c.png" title="t01d1eadbe050c6d285.png" alt="http://p4.qhimg.com/t01d1eadbe050c6d285.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">9.	TOR缴费网站经过base64加密后的编码以及解密后的原文</span></p><p style="text-align:center"><img src="http://p0.qhimg.com/t0109765e5ff5805949.png" title="t0109765e5ff5805949.png" alt="http://p0.qhimg.com/t0109765e5ff5805949.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">a.	加密前的准备工作(信息收集)</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">cerber3首先会在加密前判断PC所使用的语言，若存在为json配置中languages列表中的，则不会触发cerber3加密文件的功能</span></p><p style="text-align:center"><img src="http://p0.qhimg.com/t01353fa1157f204f11.png" title="t01353fa1157f204f11.png" alt="http://p0.qhimg.com/t01353fa1157f204f11.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">cerber3其次收集PC上相关的信息，并使用UDP单向传输发送到json配置中servers. Statistics.ip的C&amp;C服务器上。 发送内容的格式为json配置中的servers.data_start所包含的信息，大致如下：</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t01af035b17ee597b9f.png" title="t01af035b17ee597b9f.png" alt="http://p1.qhimg.com/t01af035b17ee597b9f.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">下图为一个发送knock的例子：</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t0147a9ce1011d3485e.png" title="t0147a9ce1011d3485e.png" alt="http://p1.qhimg.com/t0147a9ce1011d3485e.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">b.	加密前的准备(遍历满足要求的文件)</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">首先，cerber3使用双管道技术负责接收cmd的收发命令消息</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">并使用命令“C:\Windows\system32\wbem\wmic.exe shadowcopy delete”</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">来删除磁盘卷影，达到无法还原备份的作用。</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t01f24df5f886ee3a08.png" title="t01f24df5f886ee3a08.png" alt="http://p7.qhimg.com/t01f24df5f886ee3a08.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">接着，依据json配置中的multithread来决定是否使用多线程的方式来加密文件，如果multithread为1，则使用多线程加密，达到加速加密文件的效果。总线程的数量等于处理器的个数*2+2</span></p><p style="text-align:center"><img src="http://p9.qhimg.com/t01c84cc4256de1aad3.png" title="t01c84cc4256de1aad3.png" alt="http://p9.qhimg.com/t01c84cc4256de1aad3.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">接下来，根据json.network的数值来判断是否需要遍历网络共享文件，若json.network为1，则遍历。典型的有vmware的vmhgfs共享文件。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">下图为满足json.network为1的情况下，cerber3判定vmhgfs服务存在的依据</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t015755c2e931e87bcc.png" title="t015755c2e931e87bcc.png" alt="http://p1.qhimg.com/t015755c2e931e87bcc.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">然后，开始遍历文件，加密白名单中的文件(json.whitelist)，躲避黑名单中的文件/ 文件夹(json.blacklist)。满足要求的文件将会被存储下来，为下一步文件的加密做好准备。</span></p><p style="text-align:center"><img src="http://p0.qhimg.com/t01d91d68c3e5b50990.png" title="t01d91d68c3e5b50990.png" alt="http://p0.qhimg.com/t01d91d68c3e5b50990.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">c.	正式加密文件</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">首先，将目标加密文件名随机化。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">根据原文件名称的长度生成从特定串{a-z,A-Z,0-9,-}中随机组成的字符串来当做文件的名称。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">并且将后缀修改成.cerber3</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t0136f9fe8738764cf0.png" title="t0136f9fe8738764cf0.png" alt="http://p4.qhimg.com/t0136f9fe8738764cf0.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">接着，从文件偏移0x200处读取N个字节(N不定，一般地，N的数值为0x36)，并对这N个字节做murmurhash处理，最后存储到一个结构体里。</span></p><p style="text-align:center"><img src="http://p2.qhimg.com/t010c545e35298c8286.png" title="t010c545e35298c8286.png" alt="http://p2.qhimg.com/t010c545e35298c8286.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">根据Magic：0xCC9E2D51,0x1B873593,0x85EBCA6B</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">搜索引擎走起，可以得知是murmurhash。</span></p><p style="text-align:center"><img src="http://p2.qhimg.com/t0185c919fe7f48e114.png" title="t0185c919fe7f48e114.png" alt="http://p2.qhimg.com/t0185c919fe7f48e114.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">然后，开始从偏移0x200+N处到文件末尾-M个字节处进行RC4加密并写入。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">随机生成的16个字节的RC4 key</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t018292d4b8b9c0224b.png" title="t018292d4b8b9c0224b.png" alt="http://p4.qhimg.com/t018292d4b8b9c0224b.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">加密过后的buf如下</span></p><p style="text-align:center"><img src="http://p6.qhimg.com/t01f61e377058d5291a.png" title="t01f61e377058d5291a.png" alt="http://p6.qhimg.com/t01f61e377058d5291a.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">这样，头部加密的数据结构如下图所示</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t0148673966be959eb1.png" title="t0148673966be959eb1.png" alt="http://p4.qhimg.com/t0148673966be959eb1.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">尾部追加的数据( 解密块数据)分为3大部分：</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">1.	第一块经过rc4加密过的数据结构</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">再未加密前，它的格式是这样的</span></p><p style="text-align:center"><img src="http://p8.qhimg.com/t019f2f0afca207e2bf.png" title="t019f2f0afca207e2bf.png" alt="http://p8.qhimg.com/t019f2f0afca207e2bf.png"/></p><p style="text-align:center"><img src="http://p6.qhimg.com/t01b7f45ea4f199a45d.png" title="t01b7f45ea4f199a45d.png" alt="http://p6.qhimg.com/t01b7f45ea4f199a45d.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2.	第二块经过rsa 1024位加密的数据结构</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">RSA 1024加密</span></p><p style="text-align:center"><img src="http://p3.qhimg.com/t010be56355392d6697.png" title="t010be56355392d6697.png" alt="http://p3.qhimg.com/t010be56355392d6697.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">再未加密前，它的格式是这样的</span></p><p style="text-align:center"><img src="http://p8.qhimg.com/t01bea357e5db6b3c6e.png" title="t01bea357e5db6b3c6e.png" alt="http://p8.qhimg.com/t01bea357e5db6b3c6e.png"/></p><p style="text-align:center"><img src="http://p5.qhimg.com/t012dcaaab39890b080.png" title="t012dcaaab39890b080.png" alt="http://p5.qhimg.com/t012dcaaab39890b080.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">3.	global rsa2048加密过的rsa1024(public/private key)</span></p><p style="text-align:center"><img src="http://p8.qhimg.com/t01165ee3880540133d.png" title="t01165ee3880540133d.png" alt="http://p8.qhimg.com/t01165ee3880540133d.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">尾部数据块整合格式如下</span></p><p style="text-align:center"><img src="http://p9.qhimg.com/t014fa47ffe672d94b0.png" title="t014fa47ffe672d94b0.png" alt="http://p9.qhimg.com/t014fa47ffe672d94b0.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">被加密后的文件格式如下</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t01cc50a109250156d5.png" title="t01cc50a109250156d5.png" alt="http://p1.qhimg.com/t01cc50a109250156d5.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">其中global rsa 2048的公钥在json的配置中存储。</span></p><p style="text-align: left; text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">C．勒索方式</span></strong></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">创建线程从json配置文件中获取勒索文件(html/txt)的base64加密后的编码，获取私人的TOR地址并解密编码，写入当前被加密的文件夹下。获取json. wallpaper中的壁纸配置，并写入桌面壁纸。最后，获取json. Speaker中的语音次数以及语音内容，最后以一个女声的形式来提示你文件被加密了。大致意思就是：恭喜你，感染了cerber3！您需要掏钱解决问题！</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">勒索文件(html/txt格式)的线程生成函数</span></p><p style="text-align:center"><img src="http://p2.qhimg.com/t014a55f2dbd0c2f882.png" title="t014a55f2dbd0c2f882.png" alt="http://p2.qhimg.com/t014a55f2dbd0c2f882.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-align: left; text-indent: 2em;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">四．	病毒分析（cerber4）</span></strong></span></p><hr/><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">cerber4基本没有什么很大的变化(文件加密)。主要是做了一些优化的工作。</span></p><p style="text-align: left; text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">A．	loader优化</span></strong></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">废除了cerber3繁琐的加载过程，取而代之的是更为传统的傀儡进程模式，当然这里面还有一些适当的字符串混淆为了逃避杀软的静态特征扫描。此法可以有效地增加调试难度。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">传统的进程傀儡大致流程如下:</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">CreateProcess-&gt;GetThreadContext-&gt;ZwUnMapViewOfSection-&gt;WriteProcessMemory-&gt;SetThreadContext-&gt;ResumeThread</span></p><p style="text-align:center"><img src="http://p5.qhimg.com/t0173313a7db9b37f9d.png" title="t0173313a7db9b37f9d.png" alt="http://p5.qhimg.com/t0173313a7db9b37f9d.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Cerber4还会判断本机时间是否是2016年，如果是2016年，才执行后续恶意操作。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">这也就意味着，只要将本机的本地时间修改为非2016年，那么cerber4就不会进行后续的恶意行为。猜测作者可能是为了选择合法/干净的电脑下手。</span></p><p style="text-align:center"><img src="http://p6.qhimg.com/t015b925f41f1fcf706.png" title="t015b925f41f1fcf706.png" alt="http://p6.qhimg.com/t015b925f41f1fcf706.png"/></p><p style="text-align: left; text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">B．	数据库进程遍历</span></strong></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Cerber4会遍历正在运行数据库，并杀死它们。使得被数据库进程加载的数据库能够正常的被加密，避免了文件被占用（句柄未关闭）的问题。</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t01d35dd632c587e3c1.png" title="t01d35dd632c587e3c1.png" alt="http://p4.qhimg.com/t01d35dd632c587e3c1.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">具体的数据库进程存在于它的json中。和cerber3类似。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">不同的是新增了配置项：close_process。当close_process为1时，执行遍历并杀死数据库进程的操作(常见的数据库进程有mysql,sqlserver,oracle等)</span></p><p style="text-align:center"><img src="http://p9.qhimg.com/t01fcd3fb80da6c2080.png" title="t01fcd3fb80da6c2080.png" alt="http://p9.qhimg.com/t01fcd3fb80da6c2080.png"/></p><p style="text-align: left; text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">C．	拓展名随机化</span></strong></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">相对于cerber3(后缀为.cerber3)，cerber4将被加密后文件的拓展名更换为4位随机字符(数字/字母)。例如(.qw2g等)。可能是因为影响力太大了。想低调低调。</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t019d58390af9cfd707.png" title="t019d58390af9cfd707.png" alt="http://p7.qhimg.com/t019d58390af9cfd707.png"/></p><p style="text-align: left; text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">D．	友好的语言提示</span></strong></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">cerber4在json配置中的勒索文件后缀由原来的.html更换成了.hta，并启动此进程显示勒索信息(根据本地语言)。</span></p><p style="text-align:center"><img src="http://p6.qhimg.com/t01857ed573dc0e91a9.png" title="t01857ed573dc0e91a9.png" alt="http://p6.qhimg.com/t01857ed573dc0e91a9.png"/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-align: left; text-indent: 2em;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">五．	可预见的解密过程</span></strong></span></p><hr/><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">当勒索者收到赎金后，会提供给受害者RSA2048位的私钥，通过这个私钥可以解锁尾部数据块的第三部分，拿到RSA1024位加密的私钥和公钥。通过RSA1024位的私钥可以解锁尾部数据库的第三部分，拿到rc4的key，从而得到key stream。从而解锁尾部数据库的第一部分，头部数据以及中间主要被RC4加密过的部分。至此，文件解密全部完成。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-align: left; text-indent: 2em;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">六．	防护措施</span></strong></span></p><hr/><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">从2015年开始，敲诈者类病毒在中国逐渐成为互联网上的一个重要威胁，病毒与安全软件的对抗也在持续升级，病毒在花样翻新地尝试各种方法发出致命一击，安全软件则需要全天候响应查缺补漏，为用户布设坚固的防线。可以想见，攻防的对抗仍然会持续下去。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(255, 0, 0);">在此360QVM团队提醒广大网友：重要数据应定期备份；操作系统和浏览器、Adobe Flash Player等基础软件的漏洞补丁应及时安装，可以免疫绝大多数来自恶意网页或客户端的挂马攻击。此外，系统应设置显示文件后缀，他人发来的可疑程序或脚本（如exe、scr、js等）不要双击运行，这样就能最大限度的避免中招。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(255, 0, 0);">360安全卫士也已开通了“反勒索服务”，并向用户公开承诺：使用360安全卫士11.0版本并开启该服务后，如果仍防不住敲诈者病毒，360将提供最高3个比特币（约13000元人民币）的赎金帮助用户恢复数据，全方位保障用户的财产和数据安全。</span></p></p>
                <hr/>
                <p style="text-align: center;">
                    <img src="http://bobao.360.cn/img/app.jpeg"/>
                    <img src="http://bobao.360.cn/img/weixin.jpeg"/>
                </p>
                                <p>本文由 安全客 原创发布，如需转载请注明来源及本文地址。<br/>本文地址：http://bobao.360.cn/learning/detail/3108.html
                </p>
                            </div>
            <div style="margin-top: 20px;background-color:#FFFFFF">
    <input type="hidden" id="detail_title" name="detail_title" value="【木马分析】Cerber敲诈者家族再升级：Cerber4变身随机后缀 - 安全客 - 有思想的安全新媒体" />
    <input type="hidden" id="use_nickname" name="use_nickname" value="0" />
    <a name="mao"></a>
    <div class="reg-log mobile-hiden">
        <div class="" id="userTo">   
            <div id="to-list" class="input-text" style="">
                <textarea disabled="disabled" class="hide"  id="comment-content" to="to"></textarea>
                <ul id="preadded" style="display:none">       
                </ul>
                <div id="to-auto" style="width: 200px">
                    <ul id="feed">
                    </ul>
                </div>
            </div>
        </div>
        <input type="hidden" id="source-id" value="3108" />
        <input type="hidden" id="source-type" value="learning" />
        <input type="hidden" id="post-comment-url" value="/comment/add" />
        <input type="hidden" id="post-nickname-url-ajax" value="/comment/randnicknameajax" />
        <input type="hidden" id="post-check-login-url-ajax" value="/comment/checklogin" />
        <input type="hidden" id="stoken_comment_set" value="ea3898fb4df38673fdeb61c458234054">                 <span class="join">参与讨论，请先 <a href="javascript:;" class="comment-login">登录</a> | <a href="javascript:;" class="comment-reg">注册</a> |  <a href="javascript:;" class="anonymous-comment">匿名评论</a></span>
            </div>
    <div class="mobile-hide" style="width: 870px; margin: 0 auto;">
        <label style="vertical-align:middle;" for="use_nickname">匿名</label> 
        <input style="vertical-align:middle;" id="trigger-nickname" name="use_nickname" class="use_nickname" type="checkbox" value="0" />

        <a href="javascript:;" class="apply-use button" id="submit-comment" data-target="/comment/add">发布</a>
    </div>


    <div class="clearfix"></div>
    <div class="comments">
        <div class="comments-head">
            <span class="title">用户评论</span>
        </div>
                <div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/9x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="5557" user-name="安全客官方微博" href="javascript:;">
                安全客官方微博            </a>
                        <span class="comment-time">2016-10-25 19:05:10</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="5557">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_5557" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">回复@温文尔雅的校草:360安全卫士也已开通了“反勒索服务”，并向用户公开承诺：使用360安全卫士11.0版本并开启该服务后，如果仍防不住敲诈者病毒，360将提供最高3个比特币（约13000元人民币）的赎金帮助用户恢复数据，全方位保障用户的财产和数据安全。</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src='http://p1.qhmsg.com/dm/48_48_100/t01857c1978f2c4da10.jpg'/>              
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="390662405" class="response" data-bind-id="390662405" data-target="5555" user-name="聪明的狗子" href="javascript:;">
                聪明的狗子            </a>
                        <span class="comment-time">2016-10-25 19:04:35</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="390662405" data-target="5555">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_5555" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">兄弟冷静啊</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
<div class="clearfix re-comment">
    <div class="comment-quote">  
        <div class="comment-user">
            <a href="javascript:;" class="response" data-bind-id="0" data-target="5228">左岸咖啡308</a> <span class="comment-time">2016-10-22 12:33:53</span>            <div class="comment-action">                        <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="5228">回复</a></span>&nbsp;|&nbsp;                        <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_5228" data-type="comment">点赞</a></span>            </div>
            <p>所有的照片都变成了加密文件。我就在想，如果这是一个人历年的家庭生活照片，该有多么令人抓狂呢？编这样病毒的畜类，为什么要存在于社会呢？躲在阴暗处，靠下三滥手段如此活着，比渣男还渣。希望这个作者，被老天收了去，回炉重新做人……希望他活不活今年！！阿门！@人民网</p>
        </div>
    </div>
        </div>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src='http://p1.qhmsg.com/dm/48_48_100/t01857c1978f2c4da10.jpg'/>              
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="390662405" class="response" data-bind-id="390662405" data-target="5554" user-name="聪明的狗子" href="javascript:;">
                聪明的狗子            </a>
                        <span class="comment-time">2016-10-25 19:03:58</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="390662405" data-target="5554">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_5554" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">360安全卫士也已开通了“反勒索服务”，并向用户公开承诺：使用360安全卫士11.0版本并开启该服务后，如果仍防不住敲诈者病毒，360将提供最高3个比特币（约13000元人民币）的赎金帮助用户恢复数据，全方位保障用户的财产和数据安全。</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
<div class="clearfix re-comment">
    <div class="comment-quote">  
        <div class="comment-user">
            <a href="javascript:;" class="response" data-bind-id="0" data-target="5227">左岸咖啡308</a> <span class="comment-time">2016-10-22 12:33:53</span>            <div class="comment-action">                        <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="5227">回复</a></span>&nbsp;|&nbsp;                        <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_5227" data-type="comment">点赞</a></span>            </div>
            <p>回复@360安全卫士:希望这个作者，被老天收了去，回炉重新做人……希望他活不活今年！！阿门！@人民网 坦白的说，我电脑装了360安全卫士11，还是悲催了！@360企业安全</p>
        </div>
    </div>
        </div>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src='http://p1.qhmsg.com/dm/48_48_100/t01857c1978f2c4da10.jpg'/>              
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="390662405" class="response" data-bind-id="390662405" data-target="5553" user-name="聪明的狗子" href="javascript:;">
                聪明的狗子            </a>
                        <span class="comment-time">2016-10-25 19:03:30</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="390662405" data-target="5553">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_5553" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">360安全卫士也已开通了“反勒索服务”，并向用户公开承诺：使用360安全卫士11.0版本并开启该服务后，如果仍防不住敲诈者病毒，360将提供最高3个比特币（约13000元人民币）的赎金帮助用户恢复数据，全方位保障用户的财产和数据安全。更多问题可私信360安全卫士微博为您解答。</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
<div class="clearfix re-comment">
    <div class="comment-quote">  
        <div class="comment-user">
            <a href="javascript:;" class="response" data-bind-id="36185465" data-target="5541">中毒躺枪</a> <span class="comment-time">2016-10-25 15:03:50</span>            <div class="comment-action">                        <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="36185465" data-target="5541">回复</a></span>&nbsp;|&nbsp;                        <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_5541" data-type="comment">点赞</a></span>            </div>
            <p>大神啊！22号中了这个cerber病毒，word，pdf，xls，jpg等文件都被加密成10.4位随机数了，360能帮忙解开吗？</p>
        </div>
    </div>
        </div>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/4x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="36185465" class="response" data-bind-id="36185465" data-target="5541" user-name="中毒躺枪" href="javascript:;">
                中毒躺枪            </a>
                        <span class="comment-time">2016-10-25 15:03:50</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="36185465" data-target="5541">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_5541" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">大神啊！22号中了这个cerber病毒，word，pdf，xls，jpg等文件都被加密成10.4位随机数了，360能帮忙解开吗？</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/9x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="5540" user-name="安全客官方微博" href="javascript:;">
                安全客官方微博            </a>
                        <span class="comment-time">2016-10-25 14:55:28</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="5540">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_5540" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">回复@温文尔雅的校草:暂时只有已发布的文章的内容哈~</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/11x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="5538" user-name="温文尔雅的校草" href="javascript:;">
                温文尔雅的校草            </a>
                        <span class="comment-time">2016-10-25 12:15:20</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="5538">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_5538" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">回复@安全客官方微博:有恢复文件和杀毒办法吗</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/11x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="5535" user-name="温文尔雅的校草" href="javascript:;">
                温文尔雅的校草            </a>
                        <span class="comment-time">2016-10-25 10:45:17</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="5535">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_5535" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">想想都后怕</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/12x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="5228" user-name="左岸咖啡308" href="javascript:;">
                左岸咖啡308            </a>
                        <span class="comment-time">2016-10-22 12:33:53</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="5228">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_5228" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">所有的照片都变成了加密文件。我就在想，如果这是一个人历年的家庭生活照片，该有多么令人抓狂呢？编这样病毒的畜类，为什么要存在于社会呢？躲在阴暗处，靠下三滥手段如此活着，比渣男还渣。希望这个作者，被老天收了去，回炉重新做人……希望他活不活今年！！阿门！@人民网</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/12x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="5227" user-name="左岸咖啡308" href="javascript:;">
                左岸咖啡308            </a>
                        <span class="comment-time">2016-10-22 12:33:53</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="5227">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_5227" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">回复@360安全卫士:希望这个作者，被老天收了去，回炉重新做人……希望他活不活今年！！阿门！@人民网 坦白的说，我电脑装了360安全卫士11，还是悲催了！@360企业安全</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>

        <a class="more-long comment-more" href="javascript:;" data-target="/comment/more" data-type="learning" data-source-id="3108" data-page="2">查看更多</a>
            </div>
</div>
<script>
    $(function () {
        $('.anonymous-comment').click(function () {
            $(".join").hide();
            $(".reg-log textarea").first().removeAttr("disabled").show();
            $('#use_nickname').val('1');
//            $('#trigger-nickname').attr('checked', true);
            $('#trigger-nickname').trigger('click');
        });
        //为所有复选框绑定事件
//        checkbox_on_click();
        //ajax随机获取昵称
//        randnicknameajax(0);
        //ajax检测登录状态
        comment_check_login();
    });



    function input_checkbox(flag) {
        $('input:checkbox').each(function () {
            var value = flag ? 1 : 0;
            $(this).prop('checked', flag);
            $(this).val(value);
        });
    }

//ajax随机获取昵称
    function randnicknameajax(flag) {
        $.ajax({
            type: 'POST',
            url: $('#post-nickname-url-ajax').val(),
            data: {limit: 1, flag: flag},
            dataType: "json",
            success: function (data) {
                $('#nick-name').val(data.data[0]);
                _nick_name=data.data[0];
            }
        });
    }
    $();
//ajax检测登录状态
    function comment_check_login() {
        $.ajax({
            type: 'POST',
            url: $('#post-check-login-url-ajax').val(),
            data: {},
            dataType: "json",
            success: function (data) {
                if (data.success) {
                    $('.join').hide();
                    $(".reg-log textarea").first().removeAttr("disabled").show();
                    $("#span_use_nickname").show();
                    $('#use_nickname').val('0');
                    $('#use_nickname').attr('checked', false);
                }
            }
        });
    }
</script>        </div>
    </div>
    <div class="side-bar">
        <div class="mod hot-news">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-hot"></i><span>热门知识</span></h2>
    </div>
    <ul class="links-list">
                                <li><a href="/learning/detail/4411.html" alt="【漏洞预警】一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现——最新的Office高级威胁攻击预警" target="_blank">【漏洞预警】一个换行符引发的奥斯卡...</a></li>
                                <li><a href="/learning/detail/4416.html" alt="【漏洞预警】Microsoft .NET Framework漏洞（CVE–2017–8759）预警" target="_blank">【漏洞预警】Microsoft .NE...</a></li>
                                <li><a href="/learning/detail/4414.html" alt="【技术分享】妙用JavaScript绕过XSS过滤" target="_blank">【技术分享】妙用JavaScrip...</a></li>
                                <li><a href="/learning/detail/4418.html" alt="【技术分享】利用威胁情报数据平台拓展APT攻击线索一例" target="_blank">【技术分享】利用威胁情报数据平台拓...</a></li>
                                <li><a href="/learning/detail/4417.html" alt="【知识】9月15日 - 每日安全知识热点" target="_blank">【知识】9月15日 - 每日安全知识热...</a></li>
                                <li><a href="/learning/detail/4425.html" alt="【安全报告】XShellGhost事件技术回顾报告" target="_blank">【安全报告】XShellGhost事件...</a></li>
            </ul>
</div>        <!-- 友情链接 -->
        <div class="mod blog-links mobile-hide">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-link"></i><span>友情链接</span></h2>
        <a href="/links/index.html" class="more">更多<i></i></a>
    </div>
        <ul class="links-list">
                <li><a href="http://bbs.360safe.com" alt="360安全社区" target="_blank">360安全社区</a></li>
                <li><a href="http://zhuji.360.cn" alt="360主机卫士" target="_blank">360主机卫士</a></li>
                <li><a href="http://blogs.360.cn/" alt="奇虎360技术博客" target="_blank">奇虎360技术博客</a></li>
                <li><a href="http://wangzhan.360.cn/" alt="360网站卫士" target="_blank">360网站卫士</a></li>
                <li><a href="http://webscan.360.cn/" alt="360网站安全检测" target="_blank">360网站安全检测</a></li>
                <li><a href="http://research.360.cn/report/" alt="360研究报告" target="_blank">360研究报告</a></li>
                <li><a href="http://unicorn.360.cn/" alt="360 Unicorn Team" target="_blank">360 Unicorn Team</a></li>
                <li><a href="http://appscan.360.cn/" alt="360捉虫猎手" target="_blank">360捉虫猎手</a></li>
                <li><a href="https://threathunter.org/" alt="ThreatHunter社区" target="_blank">ThreatHunter社区</a></li>
                <li><a href="http://security.360.cn/" alt="360安全应急响应中心" target="_blank">360安全应急响应中心</a></li>
            </ul>
    </div>
        <!-- 联系我们 -->
        <div class="mod contact mobile-hide" style="text-align:center">
    <div class="head-bar clearfix">
        <h2><i></i><span>关注我们</span></h2>
    </div>
    <!-- 微信关注 -->
    <ul class="contact-way">
        <li><a>微信关注</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/qrcode_adlab_weixin.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
    <!-- APP下载 -->
    <ul class="contact-way">
        <li><a>安全播报APP</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/scan_code_big.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
</div>

    </div>
</div>

<script type="text/javascript" src="/js/jquery-ui.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/jquery.noty.packaged.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/common.js?v=4.5"></script>
<script>$(function() {sync_count('comment');});</script>


<!-- 语法高亮 -->
<script type="text/javascript" src="/ue/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">SyntaxHighlighter.all();sync_count('vul');sync_count('news');sync_count('learning');sync_count('activity');sync_count('course');sync_count('ctf');</script>
    </div>

        <div class="footer">
        <div class="friend-link">
            <a href="http://www.360.cn/" target="_blank">360首页</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">关于我们</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">联系我们</a>
            <span>|</span>
            <a href="/links/index.html" target="_blank">友情链接</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">招贤纳士</a>
        </div>
        <div class="copy">
            Copyright &copy; 360网络攻防实验室 All Rights Reserved <span class="copy_icp">京ICP证080047号[京ICP备08010314号-6]</span>
        </div>
    </div>
    
</div>

<!--奇舞团统计-->

<script src='https://s.ssl.qhimg.com/static/f5407c785655e6a1/monitor_analytic.js'></script>
<script>
    monitor.setProject('QH_171_1').getTrack().getClickAndKeydown().getClickHeatmap(10, 1);
</script>

<div class="hide">
    <script src="https://s95.cnzz.com/z_stat.php?id=1253147824&web_id=1253147824" language="JavaScript"></script>
</div>
<div class="backToTop_wrap off">
    <a id="back_to_top" class="backToTop" href="javascript:;" title="返回顶部"></a>
</div>
<script>
    var $backToTop_wrap = $(".backToTop_wrap"),
        $backToTop_btn = $("#back_to_top");

    if ($(window).scrollTop() > 100) {
        $backToTop_wrap.removeClass("off");
    }
    else {
        $backToTop_wrap.addClass("off");
    }

    $(window).on("scroll", function () {
        if ($(this).scrollTop() > 100) {
            $backToTop_wrap.removeClass("off");
        }
        else {
            $backToTop_wrap.addClass("off");
        }
    });

    $backToTop_btn.on("click", function () {
        $("html, body").animate({scrollTop: 0}, 120);
    });

    $(function () {
        var navlist = $('.nav-list > li');

        navlist.each(function () {
            $(this).on('mouseenter', function () {
                $(this).addClass('selected');
            });

            $(this).on('mouseleave', function () {
                $(this).removeClass('selected');
            });
        });
    })
</script>



</body>
</html>
