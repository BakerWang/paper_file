<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:wb="http://open.weibo.com/wb" xml:lang="en" lang="en">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <link rel="shortcut icon" href="http://bobao.360.cn/favicon.ico?v=1.1"/>
    <link rel="alternate" title="安全资讯" href="/rss?type=news" type="application/rss+xml"/>
    <link rel="alternate" title="安全知识" href="/rss?type=learning" type="application/rss+xml"/>
    <link rel="alternate" title="安全圈活动" href="/rss?type=activity" type="application/rss+xml"/>
    <link rel="alternate" title="所有漏洞" href="/rss?type=vul" type="application/rss+xml"/>
    <link rel="alternate" title="通用型漏洞" href="/rss?type=commonvul" type="application/rss+xml"/>
    <link rel="alternate" title="事件型漏洞" href="/rss?type=eventvul" type="application/rss+xml"/>
    <link rel="alternate" title="热门漏洞" href="/rss?type=hotvul" type="application/rss+xml"/>

        <title>国外安全研究员总结：长期维持木马的种种方法 - 安全客 - 有思想的安全新媒体</title>
    
        <meta name="keywords" content="国外安全研究员,发布,长期维持木马,的种种方法"/>
    
        <meta name="description" content="TL ； DR：你是红队的？需要长期维持木马吗？本文不长，读读吧;)你是蓝队的？必须找到那些令人讨厌的后门吗？本文不长，读读吧;)在 之前的帖子中，我列举了几种在Windows域/林中安置后门的方法。"/>
        <meta property="wb:webmaster" content="224437c7be31d633"/>

    <script type="text/javascript" src="http://s7.qhimg.com/!56caa871/xpc_sync_height.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/reset.css" />
    <link rel="stylesheet" type="text/css" href="/css/common_new.css?v=4.4.2.1" />
    <link rel="stylesheet" type="text/css" href="/css/jquery.notyfy.css" />
    <link rel="stylesheet" type="text/css" href="/css/notyfy.theme.default.css" />
    <link rel="stylesheet" type="text/css" href="/css/s_common.css?v=2.2.7" media="only screen and
    (max-device-width:900px), only screen and (max-width:900px)" />
    <script type="text/javascript" src="/js/jquery.min.js?v=3.1"></script>
    <script type="text/javascript" src="/js/jquery.notyfy.js"></script>
    <script type="text/javascript" src="/js/iscroll.js"></script>
    <script src="http://js.passport.qihucdn.com/5.0.3.js"></script>
    <script type="text/javascript">
        var myScroll, myNavScroll;

        function iscrollLoaded() {
            myScroll = new IScroll('#wrapper',
                {
                    scrollX: true,
                    scrollY: false,
                    bounceEasing: 'circular',
                    eventPassthrough: true,
                    preventDefault: false,
                    bounceTime: 500
                }
            );
        }

        $(function () {

            //导航横向滚动


            function setNavWidth() {

                /* 计算导航宽度 */
                var allWidth = $(window).width();
                var scroller = $('#scroller');

                if (allWidth > 900) {
                    scroller.find('ul').add(scroller.find('.scroll')).removeAttr('style');
                    scroller.css('overflow', 'visible');
                    if (myNavScroll) myNavScroll.destroy();
                } else {

                    var width = 0;
                    scroller.find('.scroll').children('ul').children('li').each(function (index, el) {
                        if (!$(this).hasClass('mobile-hide')) {
                            width += $(this).outerWidth();
                        }
                    });
                    scroller.find('ul').add(scroller.find('.scroll')).width(width);

                    if (myNavScroll) myNavScroll.destroy();

                    myNavScroll = new IScroll('#scroller', {
                        scrollX: true,
                        scrollY: false,
                        momentum: false,
                        click: true
                    });

                }

            }

            setNavWidth();
            $(window).resize(function (event) {
                setNavWidth();
            });

        });

    </script>
</head>
<body onload="iscrollLoaded();">
<div style='margin:0 auto;width:0px;height:0px;overflow:hidden;'>
    <img src=""/>
</div>

<div id="is-mobile"></div>
<div class="container">
        <div class="mobile-header">
        <div class="header clearfix">
            <div class="header-wrapper clearfix">
                <a href="/index/index" class="logo"><img class="slogan" src="/img/logo.png?v=1.5"/></a>
                                <form id="search" class="search-box" action="/search/index" method="GET">
                    <input class="keys" name="keywords" type="text" placeholder="搜索漏洞" required="required">
                    <input class="icon" type="submit" value="">
                    <input type="hidden" name="type" value=""/>
                </form>
                <div class="bug">
                    <div class="name"><span class="seled">全部</span><i class="arrow"></i></div>
                    <ul class="typelist">
                        <li data-index="3"><a href="javascript:void(0);">全部</a></li>
                        <li data-index="0"><a href="javascript:void(0);">漏洞</a></li>
                        <li data-index="1"><a href="javascript:void(0);">资讯</a></li>
                        <li data-index="2"><a href="javascript:void(0);">知识</a></li>
                    </ul>
                </div>
                                <div class="logNreg mobile-hide">
                    <div class="unlog">
                        <i></i>
                        <a href="log.html" class="log">登录</a>
                        <span>|</span>
                        <a href="reg.html" class="reg">注册</a>
                    </div>
                    <div class="loged">
                        <a href="/member/profile" class="user-center"><i></i><span class="user-name-tag">个人中心</span></a>
                        <div class="user-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting"><a href="http://i.360.cn/profile/accountmanage"
                                                               target="_blank"><i></i><span>账号设置</span></a></li>
                                <li class="alert-setting"><a href="/keywords/index"
                                                             target="_blank"><i></i><span>告警设置</span></a></li>
                                <li class="bug-alert"><a href="/myalarm/index" target="_blank"><i></i><span>漏洞告警</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mylearn/index" target="_blank"><i></i><span>我的知识</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mycourse/index" target="_blank"><i></i><span>我的课堂</span></a>
                                </li>
                                <li class="my-exit"><a
                                            href="http://login.360.cn/?src=pcw_adlab&op=logout&destUrl=http://bobao.360.cn"><i></i><span>退出系统</span></a>
                                </li>
                            </ul>
                        </div>

                        <a href="/message" class="message-center" target="_blank"><i></i><span>我的消息</span></a>
                        <div class="message-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting" style="display:none;"><a href="/myres/index"
                                                                                     target="_blank"><i></i><span>回复我的</span></a>
                                </li>
                                <li class="my-bug"><a href="/myvul/index"
                                                      target="_blank"><i></i><span>我的漏洞</span></a></li>
                                <!--<li class="my-bug"><a href="/myres/index" target="_blank"><i></i><span>我的评论</span></a></li>-->
                                <!--<li class="alert-setting"><a href="###" target="_blank"><i></i><span>提到我的</span></a>
                                </li>-->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <style type="text/css">
            .nav {
                overflow: hidden;
            }

            .nav .scroll {
                width: auto;
            }
        </style>
        <div id="wrapper">
            <div id="scroller" class="nav">
                <div class="scroll">
                    <ul class="nav-list">
                        <li ><a class="link-nav"
                                                                                 href="/index/index">首页</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/vul/index">漏洞</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/introduce/list">招聘</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/news/index">资讯</a><!--<i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/introduce/list">招聘</a></li>
                        </ul>
			-->
                        </li>
                        <li class="cur">
                        <a class="link-nav" href="/learning/index">知识</a><i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/course/index">学院</a></li>
                        </ul>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/activity/index">活动</a></li>
                        <li class="mobile-hide "><a class="link-nav"
                                                                                                   href="/ctf/index">CTF训练营</a>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/interref/list">安全内参</a></li>
                        <li ><a class="link-nav" href="/app/index">APP</a></li>

                        <!--<li ><a href="/course/index">学院</a></li>-->
                        <!--<li ><a href="/introduce/list">招聘</a></li>-->
                        <!--<li  class="mobile-hide"><a href="/ctf/index">CTF训练营</a></li>-->
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="mobile-content">
        <link rel="stylesheet" type="text/css" href="/css/news.css?v=3.5" />
<link rel="stylesheet" type="text/css" href="/ue/SyntaxHighlighter/shCoreDefault.css?v=1.0" />
<style>
    p .syntaxhighlighter {
        width: 80%;
    }
</style>

<div class="cur-pos w1000">当前位置：<a href="http://bobao.360.cn/">安全客</a> &gt;&gt; 知识详情</div>

<div class="content clearfix">
    <div class="main">
        <div class="article">
            <div id="article_box">
                <h2>国外安全研究员总结：长期维持木马的种种方法</h2>
                <div class="article-msg">
                    <span class="time">2015-05-06 17:39:30</span>
                                        <span class="read">阅读：21943次</span>
                    <span><a style="display: none;" class="good" href="javascript:;"
                             data-target="/learning/good" data-value="g_388"
                             data-type="learning">点赞(0)</a></span>
                    <span><a class="fav" href="javascript:;" data-target="/mylearning/add"
                             data-pk="388" data-type="learning">收藏</a></span>
                                        <span><a style="margin-left: 4px;" class="fav" href="http://jumpespjump.blogspot.com/2015/05/many-ways-of-malware-persistence-that.html"
                             target="_blank">来源： 360安全播报</a></span>
                    
                                    </div>
                <hr size="1">
                <div class="article-msg">
                    <p><!-- JiaThis Button BEGIN -->

<!--
<span class="jiathis_style"><span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_tsina"></a>
    <a class="jiathis_button_tqq"></a>
    <a class="jiathis_button_qzone"></a>
    <a class="jiathis_button_renren"></a>
    <a class="jiathis_button_xiaoyou"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
</span>

-->
</p>
                </div>
                <p><p style="text-align:center"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"><img alt="http://p4.qhimg.com/t013b9d5f98a48f895e.jpg" src="http://p4.qhimg.com/t013b9d5f98a48f895e.jpg" title="t013b9d5f98a48f895e.jpg"/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">TL ； DR：你是红队的？需要长期维持木马吗？本文不长，读读吧;)<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">你是蓝队的？必须找到那些令人讨厌的后门吗？本文不长，读读吧;)<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">在 </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="http://jumpespjump.blogspot.com/2015/03/thousand-ways-to-backdoor-windows.html"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">之前的帖子</span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">中，我列举了几种在Windows域/林中安置后门的方法。 在这个帖子中，我会更深入地挖掘，列举几种常用的维持木马的方法，仅仅利用受感染Windows系统的本地资源，就能让重启也无法清除木马。这份列表还相当不完整，我希望大家能积极提供列表上不存在的新方法。<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">从事件响应的角度来看，查看随系统启动的可疑项目是搜索木马的最佳策略之一。在以前，你只需要检查2-3个位置就能发现99%的感染。如今，木马可能有上千种启动方式。常见的感染都是自动在 Windows 启动时运行 （或在用户登录时），但一些狡诈的感染会由其他事件触发。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei;">Autoruns</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">我最喜欢用系统工具-Autoruns来维持木马。在这一段中，我主要引述了官方的内置帮助，但是我发现这些帮助还是挺有意思的。<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">在旁边的注释中说明了Autoruns工具存在的一些问题： 这个工具只能在实时系统上运行。但是我经常遇到的问题是 dd 图像造成的麻烦。虽然 VBoxManage 可以将 dd 映像转换为 VirtualBox 磁盘映像格式，但是我通常没有时间和存储空间来这样做。这时， xmount 就能发挥大作用了。xmount可以使用内存快速地把dd映像/Encase映像转换为Virtualbox格式。你只需要把磁盘映像连接到一个新的虚拟机，并将其作为主引导硬盘，修改 CPU，磁盘和控制器设置，直到 Windows 不崩溃能正常启动；这样你就不用逐个修改原有的dd文件，也能引导分析影响了。在实时系统上分析木马时还有另一个问题，就是一个狡猾的木马可以很轻松地骗过分析师。<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">为了提升速度，我通常会筛选掉微软条目，只查找每个用户位置和每用户位置只未经审核的 （缺少或无效的验证码） 可执行文件。利用这中方法，能很容易地发现 90%的恶意软件。尤其紫色或粉红色条目是高度可疑的。如果要查找其他条目，嗯，你就不得不更深入地挖掘。</span></p><p style="text-align:center"><img src="http://1.bp.blogspot.com/-MkAUaO-6HR8/VTQPF4XcREI/AAAAAAAACAs/4SwuysQORPI/s1600/zeus1.png" alt="zeus1.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">&nbsp;Zeus会&quot;隐藏&quot;在普通的随机目录中-检查伪造的时间戳</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">要想实现“无人监控”，那就需要定期保存Autoruns的输出结果。这些输出结果能很大程度上帮助到时间响应。操作指南 </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="http://www.sans.org/reading-room/whitepapers/malicious/utilizing-autoruns-catch-malware-33383"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">点击这里</span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">.&nbsp;</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei;">Logon</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">&quot;这个条目会扫描标准的自动启动位置，比如当前和所有用户的Sartup文件夹，Run注册表键值以及标准应用的启动位置。”<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">目前，Autoruns有42 个注册表项/文件夹，利用Autoruns木马就能实现自动启动。最常见的方法是 HKCU\Software\Microsoft\Windows\CurrentVersion\Run 和 C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup 文件夹。</span><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">我最喜欢的就是 </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="https://blog.gdatasoftware.com/blog/article/poweliks-the-persistent-malware-without-a-file.html"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">不依赖文件的Poweliks 恶意软件</span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">，可以实现100%感染。 典型的ring3 代码执行。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei;">Explorer</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">&quot;选择此项以查看资源管理器外壳扩展、 浏览器助手对象、 资源管理器工具栏、 主动安装执行和 shell 执行钩子&quot;。天啊，71 的注册表项。通常，这些都不是为了木马的自动启动，但某些位置可以隐藏木马。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei;">Internet Explorer</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">&quot;此项显示浏览器帮助对象 (BHO)、 互联网浏览器工具栏和扩展&quot;。在这里有 13条注册表项。如果你的浏览器上安装了一个恶意的BHO，你差不多就完蛋了。</span></p><p style="text-align:center"><img src="http://4.bp.blogspot.com/-z_Y0H4q5o80/VTQP3bJgZjI/AAAAAAAACA0/zw9bFLjk_HY/s1600/IE_pwn3d.jpg" alt="IE_pwn3d.jpg"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei;">Scheduled tasks</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">&quot;调度程序中的任务会在启动或登录时开始进行。&quot;。不常用，但是一定要看一看。<br/>我一直以为这个自启动条目很无聊，但是，现在我觉着这是隐藏木马的最好方式。默认情况下，这个条目中就有这么多项目，利用其中一些就能触发木马启动。<br/>你只要创建自定义事件 </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="http://blakhal0.blogspot.com/2015/03/windows-event-log-driven-back-doors.html"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">就能触发 Windows 的事件日志</span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">，你知道吗？<br/>只是 </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="http://0xthem.blogspot.com/2014/03/t-emporal-persistence-with-and-schtasks.html"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">通过使用 bitsadmin和调度程序等Windows 工具就能长期维持木马</span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">，你知道吗？</span></p><p style="text-align:center"><img src="http://4.bp.blogspot.com/-GjNZYG9kX6I/VTQRPT7cafI/AAAAAAAACBE/0pSM4H01-DM/s1600/sched2.png" alt="sched2.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">过去的调度程序</span></p><p style="text-align:center"><img src="http://4.bp.blogspot.com/-z5tOzhrJO-c/VTQRPW4QEiI/AAAAAAAACBA/vTiZpIxUufM/s1600/sched.png" alt="sched.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;现在的调度程序</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 16px;">服务</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">HKLM\System\CurrentControlSet\Services 是一个经常隐藏有木马的位置。仔细检查其中所有的项目。</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 16px;">驱动程序</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">与服务相同。也是经常隐藏有木马的位置。不幸的是，签署 64 位系统的驱动程序已经不再有趣了，因为要想签署这类驱动程序就必需要有</span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);" href="https://msdn.microsoft.com/en-us/library/windows/hardware/dn170454(v=vs.85).aspx"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">“软件发行商证书</span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">&quot;。 ring0木马经常使用的启动位置。</span><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">从 Windows 10 开始，所有的驱动程序都必须使用&quot;</span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="http://blogs.msdn.com/b/windows_hardware_certification/archive/2015/04/01/driver-signing-changes-in-windows-10.aspx"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">Windows 硬件开发人员中心Dasboard门户</span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">&quot;和 EV 证书签署。 </span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 16px;">编解码器</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">22 条注册表项。不是很常见，但是可能存在代码执行。</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 16px;">启动执行</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">&quot;本机映像（而不是 Windows 映像） 早在启动过程中运行&quot;。<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">5 条注册表项。隐藏木马的好地方。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei;">映像劫持</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">&quot;映像文件执行选项和命令提示符会自动启动&quot;。在这里有 13个注册表项。我相信其本意是出于调试目的。<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">以前，粘滞键木马常常隐藏在这个位置。这个位置与其他位置不同，因为这个位置提供了后门权限，但是你只能从本地网络 （通常） 上使用。这种情况下，只要有人连续点击SHIFT按键，代码就会在RDF登录之前执行。以前的方法是替换 sethc.exe，新的方法是在sethc上设置 </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="http://www.labofapenetrationtester.com/2012/05/fun-with-sticky-keys-utilman-and.html"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">一个调试程序</span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">。</span></p><p style="text-align:center"><img src="http://4.bp.blogspot.com/-3-c4wX9DYck/VTQS1k9Di-I/AAAAAAAACBU/AMG_e4FO50E/s1600/sethc.png" alt="sethc.png"/></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 16px;">AppInit</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">&quot;它的Autoruns会显示DLL注册为应用初始化DLL&quot;。在这里只有 3 条注册表项。以前，会利用这种方法把恶意的 DLL 注入资源管理器中，浏览器，等等。幸运的是这种方法几乎要过时了。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei;">已知的DLL</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">&quot;这里会显示DLL的位置，Windows系统会把这DLL加载到相应的应用中&quot;。只有 1 条注册表项。这个项目可能被用来劫持一些系统 DLL。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei;">Winlogon</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">&quot;显示Winlogon登录事件通知注册使用的 DLL&quot;。7 条注册表项。有时候，木马会使用。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei;">Winsock 供应商</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">&quot;显示已注册的 Winsock 协议，包括 Winsock 服务提供商。恶意软件通常会伪装成 Winsock 服务提供商进行安装，因为有几个工具可以删除它们。Autoruns可以禁用它们，但不能删除它们。4 条注册表项。据我所知，此前一段时间木马经常使用这种方法。但是，现在仍然也是隐藏木马的好地方。</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 16px;">打印监视器</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">&quot;显示加载到后台打印服务的 DLL。木马已经借此来实现自启动。1 条注册表项。一些木马作者会采用意想不到的方法来隐藏木马的维持模块。</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 16px;">LSA 供应商</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">&quot;显示注册本地安全机构(LSA) 身份验证、 通知和安全包&quot;。5 条注册表项。隐藏密码窃取木马的好地方。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei;">网络提供商</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">&quot;缺少的文件&quot;。如果你有好的 1 句文档，请发表评论。</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 16px;">WMI 筛选器</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">&quot;缺少的文件&quot;。查阅 </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="https://dl.mandiant.com/EE/library/MIRcon2014/MIRcon_2014_IR_Track_There's_Something_About_WMI.pdf"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">Mandiant </span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">查看详细信息。 </span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei;">侧边栏工具</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">感谢上帝 MS 禁用了这一功能:)</span></p><p style="text-align:center"><img src="http://2.bp.blogspot.com/-9fTdxnaF0xE/VTQWwd1ayKI/AAAAAAAACBs/_vD806fQT7s/s1600/coolest-best-latest-new-fun-tech-gadgets-sidebar-gadgets-2.jpg" alt="coolest-best-latest-new-fun-tech-gadgets"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">&nbsp; &nbsp;我们都很想念你，你这资源侵占噩梦啊！</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei;">常用的方法 — — 但不是自启动</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">现在，让我们看看其他的一些启动木马的方法，这些方法不会出现在系统内部的Autoruns中。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei;">后门程序和可执行文件/DLL</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">只需要更改一个可执行程序的代码就行，无论是自启动还是需要用户手动启动。若要避免低级的错误，请禁用文件更新...</span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="https://github.com/secretsquirrel/the-backdoor-factory"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">后门工厂</span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">是不错的来源。但如果你要在Autoruns列表中列出的可执行程序/DLL上安插后门，你就需要破解文件的数字签名。我建议你签名可执行程序，如果你没办法窃取一个受信的证书，你还可以把你自己的CA导入用户的受信任证书存储区 （具有用户权限），让你的CA伪装成受信的证书。注意:使用&quot;Microsoft Windows&quot;作为CA的代码签名人，这样你的可执行文件就能混入了。</span></p><p style="text-align:center"><img src="http://1.bp.blogspot.com/-B9fFPd7tbpc/VTVQvxVmrCI/AAAAAAAACCs/G5vqWFL8S_k/s1600/cert3.png" alt="cert3.png"/></p><p style="text-align:center"><img src="http://4.bp.blogspot.com/--zyvXDyOY0o/VTVQQBC6IGI/AAAAAAAACCc/X1d-Yk3L4-I/s1600/certs.png" alt="certs.png"/></p><p style="text-align:center"><img src="http://3.bp.blogspot.com/-J8b7Pj-bmzo/VTVQWBY0UEI/AAAAAAAACCk/pBw6BeX_1Rk/s1600/cert2.png" alt="cert2.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">看，rootkit.exe 看起来就是合法的，当分析师过滤Windows项目时，也能过滤掉。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei;">劫持 DLL 加载顺序</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">把你的DLL放置到一个目录中，这个目录必须是在找到原始DLL之前搜索过的。但是为了避免再次检测，务必使用代理的合法函数调用原始的DLL。</span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="https://www.mandiant.com/blog/dll-search-order-hijacking-revisited/"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">Mandiant</span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"> 和 </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="http://digital-forensics.sans.org/blog/2015/03/25/detecting-dll-hijacking-on-windows/"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">DLL 劫持探测器</span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">提供了很好的资源。</span></p><p style="text-align:center"><img src="http://4.bp.blogspot.com/-tD1QVdbX5PY/VTQZI7GyaPI/AAAAAAAACB4/_U946BrxjSs/s1600/dll-hijack-detector.jpg" alt="dll-hijack-detector.jpg"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei;">劫持桌面/开始菜单快捷方式</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">永远不要低估笨方法的作用。只需创建一个可执行文件来调用原始可执行文件，并同时启动你的后门。替换掉链接，ok了 ！别粗心大意，检查一下图标；我发现广告软件都是用这种方法来劫持浏览器。</span></p><p style="text-align:center"><img src="http://2.bp.blogspot.com/-XE2sxSPSPJc/VTQUVKoqybI/AAAAAAAACBg/mhhH9yL4Szo/s1600/ie.png" alt="ie.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">IE 劫持并以 http://tinyurl.com/2fcpre6 开头</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei;">文件关联劫持</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">选择的用户最喜欢的文件类型，使用相似的程序替换原来负责打开文件的程序，瞧 ！</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 16px;">COM 对象劫持</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">无论系统上有没有某些COM对象，有些COM对象都会被扫描，<br/>并且，COM对象在注册后，会自动加载。请参阅 </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="https://blog.gdatasoftware.com/blog/article/com-object-hijacking-the-discreet-way-of-persistence.html"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">COMpfun</span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">查看详细信息。 </span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 16px;">Windows 应用程序兼容性-SHIM</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">很多人都不熟悉 Windows 应用程序兼容性以及其运作原理。你可以把它想象成应用和OS之间的一个夹层。如果应用程序符合一定的条件下 （如文件名），某些操作就会执行。例如，模拟的目录、 注册表项、 DLL 注入等。在我的安装过程中，有 367中不同的兼容性修补（兼容性&quot;模拟&quot;的类型），并且其中一些可以定制。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">每次启动 IE，就向IE中注入一个 DLL</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 16px;">Bootkits</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">虽然bootkits 也可以归类到驱动程序部分 （因为，他们可能需要驱动程序），但是我认为bootkits值得单独列为一节，单独说明。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei;">MBR-主引导记录</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">木马可以覆盖主启动记录，使用它自己的代码启动引导过程，也可以继续原有的启动过程。木马常常会伪造MBR记录的内容，然后显示原始内容。这就意味着用户只把受感染的硬盘连接到了一个干净的系统，与未感染系统比较了前512 字节 （或更多的在某些情况下） 或者是比较了受感染系统的显示内容。SecureBoot 可用于防止此类木马感染。</span></p><p style="text-align:center"><img src="http://2.bp.blogspot.com/-bLZ9kwAaFE4/VTQfwM3XtTI/AAAAAAAACCI/ITKyfLIG5ow/s1600/mbr.png" alt="mbr.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">从受感染的操作系统 还是干净的操作系统上查看MBR的区别不大。</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 16px;">VBR-卷启动记录</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">这是下一个合乎逻辑的步骤，木马在此可以启动它的进程。某些木马喜欢把启动代码隐藏在这里。参阅</span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="http://arstechnica.com/security/2015/02/how-omnipotent-hackers-tied-to-the-nsa-hid-for-14-years-and-were-found-at-last/1/"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">GrayFish </span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">查看更多细节。SecureBoot 可用于防止此类木马感染。</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 16px;">BIOS/UEFI 木马</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">老版的 BIOS 和新版的UEFI 可以被篡改，这样木马就能在OS启动前启动。虽然 UEFI 比 BIOS更安全，但实施和设计错误也经常出现。参阅</span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="http://securelist.com/analysis/publications/58278/absolute-computrace-revisited/"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"> 计算机盗窃防盗 rootkit</span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">查看详细信息。 </span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei;">虚拟机监控程序-Ring-1 木马</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">这种木马有些特别，因为我相信虽然木马可以运行在这一层，但通常来说不可能只长期维持在物理设备的这一层，因为在物理设备重启后，木马也就不存在了 </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="http://blackhat.com/presentations/bh-usa-06/BH-US-06-Rutkowska.pdf"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">（参考 2006 年Rutkowska的说明）</span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">。但是，因为虚拟机监控程序可以拦截重新启动事件，所以，木马把自己写入其他的某一层中 （例如安装一个常见的内核驱动程序），并在重启后完全起作用后再删除。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei;">SMM （系统管理模式）木马-ring 2 木马</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">与此前的攻击类型有关联，但没有多少人知道 </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="http://en.wikipedia.org/wiki/System_Management_Mode#Problems"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">系统管理模式可用于在OS中注入代码</span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">. 检查 DEITYBOUNCE 木马查看详情）。此外，利用 </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="https://www.acsac.org/2014/workshops/mmf/Tamas%20Lengyel-Pitfalls%20of%20virtual%20machine%20introspection%20on%20modern%20hardware.pdf"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">英特尔双监视器模式 （DMM）</span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">可执行不受信任的代码，英特尔双监视器模式 （DMM）基本上监测着 SMM 模式。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei;">英特尔主动管理技术-ring-3 木马</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">根据维基百科，&quot;英特尔主动管理技术 （AMT） 是硬件和固件技术，用于进行远程管理个人电脑，可以监测、 维护、 更新、 升级，和修复计算机&quot;。你也许会问，有什么问题吗？请参阅 </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="http://invisiblethingslab.com/resources/bh09usa/Ring%20-3%20Rootkits.pdf"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">Alexander Tereshkin和Rafal Wojtczuk对此的研究</span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"> ，或 </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="http://people.kth.se/~maguire/DEGREE-PROJECT-REPORTS/100402-Vassilios_Ververis-with-cover.pdf"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">Vassilios Ververis关于 AMT的论文</span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">。<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">也有很多人没有点击链接查看，我还是说一说 AMT的可怕之处吧：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">独立于主 CPU</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">通过DMA （有限制）可以访问主机内存</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">专用的链接到 NIC ，具备过滤功能</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">可以强制主机操作系统随时重新启动 （并从虚拟光驱启动系统）</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">从S3休眠中启动！</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 16px;">其他等</span></strong></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 16px;">创建新用户，更新现有用户，隐藏管理员</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">黑客有时都不需要在系统中添加恶意代码，因为有效地用户凭据就足够了。现有用户可用于此目的，或者可以创建新的用户。如，一种方法是利用具有500个RID的支持账户 — — </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="http://xangosec.blogspot.com/2013/06/trojanizing-windows.html"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">点击这里</span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">，metasploit 工具 </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/manage/enable_support_account.rb"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">点击这里</span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">. </span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 16px;">深奥的固件木马</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">几乎计算机的任何不见都需要固件才能运行，如果把固件替换成恶意的，就能启动木马了。例如，硬盘固件 （见 </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="http://arstechnica.com/security/2015/02/how-omnipotent-hackers-tied-to-the-nsa-hid-for-14-years-and-were-found-at-last/1/"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">GrayFish </span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">）、 图形卡等</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 16px;">隐藏的启动设备</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">恶意软件可以隐藏在一个启动设备中，这个启动设备需要在OS加载前和木马加载后检查，还需要能加载受害OS。</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 16px;">网络级别的后门</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">想想下面的场景： 每次操作系统启动，后门从网络上加载额外的数据。后门可以检查新的软件更新、 配置更新等。每当一个存在漏洞的软件/配置更新时，木马就会注入到响应中并执行。这种级别的维持不是万无一失的，但仍然，有可能吧。想想最近发现的 </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="https://labs.mwrinfosecurity.com/blog/2015/04/02/how-to-own-any-windows-network-with-group-policy-hijacking-attacks/"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">GPO MiTM 攻击</span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">、 </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="https://github.com/infobyte/evilgrade"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">Evilgrade</span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"> 工具，甚至 </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="https://www.blackhat.com/presentations/bh-dc-08/Oberheide/Whitepaper/bh-dc-08-oberheide-WP.pdf"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">Xensploit</span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">工具，以及我们正在谈论的VM 迁移。 </span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 16px;">软件漏洞</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">几乎任何类型的软件漏洞可以用作持久性后门。尤其是，可以通过网络远程访问，无需任何用户交互的哪些漏洞。以前的MS08-067......</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; color: rgb(255, 0, 0);">芯片组上内置的硬件木马</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">我都不知道要写什么了。询问当地的间谍机构，你能了解更多。祝你好运了！</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 16px;">更多的链接</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">我强烈推荐的工具：</span></p><p style="text-indent: 2em; text-align: left;"><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="https://technet.microsoft.com/en-us/sysinternals/bb545027.aspx"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">Sysinternals Autoruns</span></a></p><p style="text-indent: 2em; text-align: left;"><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="http://www.gmer.net/"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">GMER</span></a></p><p style="text-indent: 2em; text-align: left;"><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="http://digital-forensics.sans.org/blog/2015/03/25/detecting-dll-hijacking-on-windows/"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">DLL hijack detector</span></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">PCHunter</span></p><p style="text-indent: 2em; text-align: left;"><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="https://www.mandiant.com/resources/download/redline"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">Mandiant Redline</span></a></p><p style="text-indent: 2em; text-align: left;"><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="https://github.com/volatilityfoundation"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">Volatility</span></a></p><p style="text-indent: 2em; text-align: left;"><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="https://github.com/davehull/Kansa/"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">Kansa</span></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">有关详细信息，请查阅这篇博客， </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="http://blog.cylance.com/windows-registry-persistence-part-1-introduction-attack-phases-and-windows-services"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">第 1 部分</span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">， </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="http://blog.cylance.com/windows-registry-persistence-part-2-the-run-keys-and-search-order"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">第 2 部分。</span></a></p></p>
                <hr/>
                <p style="text-align: center;">
                    <img src="http://bobao.360.cn/img/app.jpeg"/>
                    <img src="http://bobao.360.cn/img/weixin.jpeg"/>
                </p>
                                <p>本文由 安全客 翻译，转载请注明“转自安全客”，并附上链接。<br/><a class="text-more" href="http://jumpespjump.blogspot.com/2015/05/many-ways-of-malware-persistence-that.html" target="_blank">原文链接：http://jumpespjump.blogspot.com/2015/05/many-ways-of-malware-persistence-that.html</a></p>
                            </div>
            <div style="margin-top: 20px;background-color:#FFFFFF">
    <input type="hidden" id="detail_title" name="detail_title" value="国外安全研究员总结：长期维持木马的种种方法 - 安全客 - 有思想的安全新媒体" />
    <input type="hidden" id="use_nickname" name="use_nickname" value="0" />
    <a name="mao"></a>
    <div class="reg-log mobile-hiden">
        <div class="" id="userTo">   
            <div id="to-list" class="input-text" style="">
                <textarea disabled="disabled" class="hide"  id="comment-content" to="to"></textarea>
                <ul id="preadded" style="display:none">       
                </ul>
                <div id="to-auto" style="width: 200px">
                    <ul id="feed">
                    </ul>
                </div>
            </div>
        </div>
        <input type="hidden" id="source-id" value="388" />
        <input type="hidden" id="source-type" value="learning" />
        <input type="hidden" id="post-comment-url" value="/comment/add" />
        <input type="hidden" id="post-nickname-url-ajax" value="/comment/randnicknameajax" />
        <input type="hidden" id="post-check-login-url-ajax" value="/comment/checklogin" />
        <input type="hidden" id="stoken_comment_set" value="64d932c9bb50dc5a83db601d9b02e735">                 <span class="join">参与讨论，请先 <a href="javascript:;" class="comment-login">登录</a> | <a href="javascript:;" class="comment-reg">注册</a> |  <a href="javascript:;" class="anonymous-comment">匿名评论</a></span>
            </div>
    <div class="mobile-hide" style="width: 870px; margin: 0 auto;">
        <label style="vertical-align:middle;" for="use_nickname">匿名</label> 
        <input style="vertical-align:middle;" id="trigger-nickname" name="use_nickname" class="use_nickname" type="checkbox" value="0" />

        <a href="javascript:;" class="apply-use button" id="submit-comment" data-target="/comment/add">发布</a>
    </div>


    <div class="clearfix"></div>
    <div class="comments">
        <div class="comments-head">
            <span class="title">用户评论</span>
        </div>
                <div class="comment-none alarm-info bg-primary">无任何评论</div>
            </div>
</div>
<script>
    $(function () {
        $('.anonymous-comment').click(function () {
            $(".join").hide();
            $(".reg-log textarea").first().removeAttr("disabled").show();
            $('#use_nickname').val('1');
//            $('#trigger-nickname').attr('checked', true);
            $('#trigger-nickname').trigger('click');
        });
        //为所有复选框绑定事件
//        checkbox_on_click();
        //ajax随机获取昵称
//        randnicknameajax(0);
        //ajax检测登录状态
        comment_check_login();
    });



    function input_checkbox(flag) {
        $('input:checkbox').each(function () {
            var value = flag ? 1 : 0;
            $(this).prop('checked', flag);
            $(this).val(value);
        });
    }

//ajax随机获取昵称
    function randnicknameajax(flag) {
        $.ajax({
            type: 'POST',
            url: $('#post-nickname-url-ajax').val(),
            data: {limit: 1, flag: flag},
            dataType: "json",
            success: function (data) {
                $('#nick-name').val(data.data[0]);
                _nick_name=data.data[0];
            }
        });
    }
    $();
//ajax检测登录状态
    function comment_check_login() {
        $.ajax({
            type: 'POST',
            url: $('#post-check-login-url-ajax').val(),
            data: {},
            dataType: "json",
            success: function (data) {
                if (data.success) {
                    $('.join').hide();
                    $(".reg-log textarea").first().removeAttr("disabled").show();
                    $("#span_use_nickname").show();
                    $('#use_nickname').val('0');
                    $('#use_nickname').attr('checked', false);
                }
            }
        });
    }
</script>        </div>
    </div>
    <div class="side-bar">
        <div class="mod hot-news">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-hot"></i><span>热门知识</span></h2>
    </div>
    <ul class="links-list">
                                <li><a href="/learning/detail/4411.html" alt="【漏洞预警】一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现——最新的Office高级威胁攻击预警" target="_blank">【漏洞预警】一个换行符引发的奥斯卡...</a></li>
                                <li><a href="/learning/detail/4416.html" alt="【漏洞预警】Microsoft .NET Framework漏洞（CVE–2017–8759）预警" target="_blank">【漏洞预警】Microsoft .NE...</a></li>
                                <li><a href="/learning/detail/4414.html" alt="【技术分享】妙用JavaScript绕过XSS过滤" target="_blank">【技术分享】妙用JavaScrip...</a></li>
                                <li><a href="/learning/detail/4425.html" alt="【安全报告】XShellGhost事件技术回顾报告" target="_blank">【安全报告】XShellGhost事件...</a></li>
                                <li><a href="/learning/detail/4424.html" alt="【知识】9月16日 - 每日安全知识热点" target="_blank">【知识】9月16日 - 每日安全知识热...</a></li>
                                <li><a href="/learning/detail/4418.html" alt="【技术分享】利用威胁情报数据平台拓展APT攻击线索一例" target="_blank">【技术分享】利用威胁情报数据平台拓...</a></li>
            </ul>
</div>        <!-- 友情链接 -->
        <div class="mod blog-links mobile-hide">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-link"></i><span>友情链接</span></h2>
        <a href="/links/index.html" class="more">更多<i></i></a>
    </div>
        <ul class="links-list">
                <li><a href="http://bbs.360safe.com" alt="360安全社区" target="_blank">360安全社区</a></li>
                <li><a href="http://zhuji.360.cn" alt="360主机卫士" target="_blank">360主机卫士</a></li>
                <li><a href="http://blogs.360.cn/" alt="奇虎360技术博客" target="_blank">奇虎360技术博客</a></li>
                <li><a href="http://wangzhan.360.cn/" alt="360网站卫士" target="_blank">360网站卫士</a></li>
                <li><a href="http://webscan.360.cn/" alt="360网站安全检测" target="_blank">360网站安全检测</a></li>
                <li><a href="http://research.360.cn/report/" alt="360研究报告" target="_blank">360研究报告</a></li>
                <li><a href="http://unicorn.360.cn/" alt="360 Unicorn Team" target="_blank">360 Unicorn Team</a></li>
                <li><a href="http://appscan.360.cn/" alt="360捉虫猎手" target="_blank">360捉虫猎手</a></li>
                <li><a href="https://threathunter.org/" alt="ThreatHunter社区" target="_blank">ThreatHunter社区</a></li>
                <li><a href="http://security.360.cn/" alt="360安全应急响应中心" target="_blank">360安全应急响应中心</a></li>
            </ul>
    </div>
        <!-- 联系我们 -->
        <div class="mod contact mobile-hide" style="text-align:center">
    <div class="head-bar clearfix">
        <h2><i></i><span>关注我们</span></h2>
    </div>
    <!-- 微信关注 -->
    <ul class="contact-way">
        <li><a>微信关注</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/qrcode_adlab_weixin.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
    <!-- APP下载 -->
    <ul class="contact-way">
        <li><a>安全播报APP</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/scan_code_big.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
</div>

    </div>
</div>

<script type="text/javascript" src="/js/jquery-ui.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/jquery.noty.packaged.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/common.js?v=4.5"></script>
<script>$(function() {sync_count('comment');});</script>


<!-- 语法高亮 -->
<script type="text/javascript" src="/ue/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">SyntaxHighlighter.all();sync_count('vul');sync_count('news');sync_count('learning');sync_count('activity');sync_count('course');sync_count('ctf');</script>
    </div>

        <div class="footer">
        <div class="friend-link">
            <a href="http://www.360.cn/" target="_blank">360首页</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">关于我们</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">联系我们</a>
            <span>|</span>
            <a href="/links/index.html" target="_blank">友情链接</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">招贤纳士</a>
        </div>
        <div class="copy">
            Copyright &copy; 360网络攻防实验室 All Rights Reserved <span class="copy_icp">京ICP证080047号[京ICP备08010314号-6]</span>
        </div>
    </div>
    
</div>

<!--奇舞团统计-->

<script src='https://s.ssl.qhimg.com/static/f5407c785655e6a1/monitor_analytic.js'></script>
<script>
    monitor.setProject('QH_171_1').getTrack().getClickAndKeydown().getClickHeatmap(10, 1);
</script>

<div class="hide">
    <script src="https://s95.cnzz.com/z_stat.php?id=1253147824&web_id=1253147824" language="JavaScript"></script>
</div>
<div class="backToTop_wrap off">
    <a id="back_to_top" class="backToTop" href="javascript:;" title="返回顶部"></a>
</div>
<script>
    var $backToTop_wrap = $(".backToTop_wrap"),
        $backToTop_btn = $("#back_to_top");

    if ($(window).scrollTop() > 100) {
        $backToTop_wrap.removeClass("off");
    }
    else {
        $backToTop_wrap.addClass("off");
    }

    $(window).on("scroll", function () {
        if ($(this).scrollTop() > 100) {
            $backToTop_wrap.removeClass("off");
        }
        else {
            $backToTop_wrap.addClass("off");
        }
    });

    $backToTop_btn.on("click", function () {
        $("html, body").animate({scrollTop: 0}, 120);
    });

    $(function () {
        var navlist = $('.nav-list > li');

        navlist.each(function () {
            $(this).on('mouseenter', function () {
                $(this).addClass('selected');
            });

            $(this).on('mouseleave', function () {
                $(this).removeClass('selected');
            });
        });
    })
</script>



</body>
</html>
