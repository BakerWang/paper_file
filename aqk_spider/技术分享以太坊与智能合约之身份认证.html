<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:wb="http://open.weibo.com/wb" xml:lang="en" lang="en">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <link rel="shortcut icon" href="http://bobao.360.cn/favicon.ico?v=1.1"/>
    <link rel="alternate" title="安全资讯" href="/rss?type=news" type="application/rss+xml"/>
    <link rel="alternate" title="安全知识" href="/rss?type=learning" type="application/rss+xml"/>
    <link rel="alternate" title="安全圈活动" href="/rss?type=activity" type="application/rss+xml"/>
    <link rel="alternate" title="所有漏洞" href="/rss?type=vul" type="application/rss+xml"/>
    <link rel="alternate" title="通用型漏洞" href="/rss?type=commonvul" type="application/rss+xml"/>
    <link rel="alternate" title="事件型漏洞" href="/rss?type=eventvul" type="application/rss+xml"/>
    <link rel="alternate" title="热门漏洞" href="/rss?type=hotvul" type="application/rss+xml"/>

        <title>【技术分享】以太坊与智能合约之身份认证 - 安全客 - 有思想的安全新媒体</title>
    
        <meta name="keywords" content="以太坊,身份认证"/>
    
        <meta name="description" content="本文中我们将使用以太坊来处理身份验证的问题。我们在这里所给出的是与区块链身份验证技术相关的典型问题。
"/>
        <meta property="wb:webmaster" content="224437c7be31d633"/>

    <script type="text/javascript" src="http://s7.qhimg.com/!56caa871/xpc_sync_height.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/reset.css" />
    <link rel="stylesheet" type="text/css" href="/css/common_new.css?v=4.4.2.1" />
    <link rel="stylesheet" type="text/css" href="/css/jquery.notyfy.css" />
    <link rel="stylesheet" type="text/css" href="/css/notyfy.theme.default.css" />
    <link rel="stylesheet" type="text/css" href="/css/s_common.css?v=2.2.7" media="only screen and
    (max-device-width:900px), only screen and (max-width:900px)" />
    <script type="text/javascript" src="/js/jquery.min.js?v=3.1"></script>
    <script type="text/javascript" src="/js/jquery.notyfy.js"></script>
    <script type="text/javascript" src="/js/iscroll.js"></script>
    <script src="http://js.passport.qihucdn.com/5.0.3.js"></script>
    <script type="text/javascript">
        var myScroll, myNavScroll;

        function iscrollLoaded() {
            myScroll = new IScroll('#wrapper',
                {
                    scrollX: true,
                    scrollY: false,
                    bounceEasing: 'circular',
                    eventPassthrough: true,
                    preventDefault: false,
                    bounceTime: 500
                }
            );
        }

        $(function () {

            //导航横向滚动


            function setNavWidth() {

                /* 计算导航宽度 */
                var allWidth = $(window).width();
                var scroller = $('#scroller');

                if (allWidth > 900) {
                    scroller.find('ul').add(scroller.find('.scroll')).removeAttr('style');
                    scroller.css('overflow', 'visible');
                    if (myNavScroll) myNavScroll.destroy();
                } else {

                    var width = 0;
                    scroller.find('.scroll').children('ul').children('li').each(function (index, el) {
                        if (!$(this).hasClass('mobile-hide')) {
                            width += $(this).outerWidth();
                        }
                    });
                    scroller.find('ul').add(scroller.find('.scroll')).width(width);

                    if (myNavScroll) myNavScroll.destroy();

                    myNavScroll = new IScroll('#scroller', {
                        scrollX: true,
                        scrollY: false,
                        momentum: false,
                        click: true
                    });

                }

            }

            setNavWidth();
            $(window).resize(function (event) {
                setNavWidth();
            });

        });

    </script>
</head>
<body onload="iscrollLoaded();">
<div style='margin:0 auto;width:0px;height:0px;overflow:hidden;'>
    <img src=""/>
</div>

<div id="is-mobile"></div>
<div class="container">
        <div class="mobile-header">
        <div class="header clearfix">
            <div class="header-wrapper clearfix">
                <a href="/index/index" class="logo"><img class="slogan" src="/img/logo.png?v=1.5"/></a>
                                <form id="search" class="search-box" action="/search/index" method="GET">
                    <input class="keys" name="keywords" type="text" placeholder="搜索漏洞" required="required">
                    <input class="icon" type="submit" value="">
                    <input type="hidden" name="type" value=""/>
                </form>
                <div class="bug">
                    <div class="name"><span class="seled">全部</span><i class="arrow"></i></div>
                    <ul class="typelist">
                        <li data-index="3"><a href="javascript:void(0);">全部</a></li>
                        <li data-index="0"><a href="javascript:void(0);">漏洞</a></li>
                        <li data-index="1"><a href="javascript:void(0);">资讯</a></li>
                        <li data-index="2"><a href="javascript:void(0);">知识</a></li>
                    </ul>
                </div>
                                <div class="logNreg mobile-hide">
                    <div class="unlog">
                        <i></i>
                        <a href="log.html" class="log">登录</a>
                        <span>|</span>
                        <a href="reg.html" class="reg">注册</a>
                    </div>
                    <div class="loged">
                        <a href="/member/profile" class="user-center"><i></i><span class="user-name-tag">个人中心</span></a>
                        <div class="user-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting"><a href="http://i.360.cn/profile/accountmanage"
                                                               target="_blank"><i></i><span>账号设置</span></a></li>
                                <li class="alert-setting"><a href="/keywords/index"
                                                             target="_blank"><i></i><span>告警设置</span></a></li>
                                <li class="bug-alert"><a href="/myalarm/index" target="_blank"><i></i><span>漏洞告警</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mylearn/index" target="_blank"><i></i><span>我的知识</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mycourse/index" target="_blank"><i></i><span>我的课堂</span></a>
                                </li>
                                <li class="my-exit"><a
                                            href="http://login.360.cn/?src=pcw_adlab&op=logout&destUrl=http://bobao.360.cn"><i></i><span>退出系统</span></a>
                                </li>
                            </ul>
                        </div>

                        <a href="/message" class="message-center" target="_blank"><i></i><span>我的消息</span></a>
                        <div class="message-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting" style="display:none;"><a href="/myres/index"
                                                                                     target="_blank"><i></i><span>回复我的</span></a>
                                </li>
                                <li class="my-bug"><a href="/myvul/index"
                                                      target="_blank"><i></i><span>我的漏洞</span></a></li>
                                <!--<li class="my-bug"><a href="/myres/index" target="_blank"><i></i><span>我的评论</span></a></li>-->
                                <!--<li class="alert-setting"><a href="###" target="_blank"><i></i><span>提到我的</span></a>
                                </li>-->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <style type="text/css">
            .nav {
                overflow: hidden;
            }

            .nav .scroll {
                width: auto;
            }
        </style>
        <div id="wrapper">
            <div id="scroller" class="nav">
                <div class="scroll">
                    <ul class="nav-list">
                        <li ><a class="link-nav"
                                                                                 href="/index/index">首页</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/vul/index">漏洞</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/introduce/list">招聘</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/news/index">资讯</a><!--<i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/introduce/list">招聘</a></li>
                        </ul>
			-->
                        </li>
                        <li class="cur">
                        <a class="link-nav" href="/learning/index">知识</a><i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/course/index">学院</a></li>
                        </ul>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/activity/index">活动</a></li>
                        <li class="mobile-hide "><a class="link-nav"
                                                                                                   href="/ctf/index">CTF训练营</a>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/interref/list">安全内参</a></li>
                        <li ><a class="link-nav" href="/app/index">APP</a></li>

                        <!--<li ><a href="/course/index">学院</a></li>-->
                        <!--<li ><a href="/introduce/list">招聘</a></li>-->
                        <!--<li  class="mobile-hide"><a href="/ctf/index">CTF训练营</a></li>-->
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="mobile-content">
        <link rel="stylesheet" type="text/css" href="/css/news.css?v=3.5" />
<link rel="stylesheet" type="text/css" href="/ue/SyntaxHighlighter/shCoreDefault.css?v=1.0" />
<style>
    p .syntaxhighlighter {
        width: 80%;
    }
</style>

<div class="cur-pos w1000">当前位置：<a href="http://bobao.360.cn/">安全客</a> &gt;&gt; 知识详情</div>

<div class="content clearfix">
    <div class="main">
        <div class="article">
            <div id="article_box">
                <h2>【技术分享】以太坊与智能合约之身份认证</h2>
                <div class="article-msg">
                    <span class="time">2017-06-16 17:36:27</span>
                    
                                        <span class="read">阅读：22618次</span>
                    <span><a style="display: none;" class="good" href="javascript:;"
                             data-target="/learning/good" data-value="g_3992"
                             data-type="learning">点赞(0)</a></span>
                    <span><a class="fav" href="javascript:;" data-target="/mylearning/add"
                             data-pk="3992" data-type="learning">收藏</a></span>
                                        <span><a style="margin-left: 4px;" class="fav" href="https://dzone.com/articles/authentication-ethereum-and-smart-contracts"
                             target="_blank">来源： dzone.com</a></span>
                    
                    
                    <div style="margin-top:10px; ">
                        <a href="/member/contribute?uid=2586341479" style="color:#848e99;">
                            <img src="http://p1.qhmsg.com/dm/150_150_100/t00df551a583a87f4e9.jpg" data-is-avatar="true"
                                 style="border: 1px solid #d5d5d5;padding: 2px; width: 80px;height: 80px;border-radius: 43px;"/>
                        </a>

                    </div>
                    <span class="orig">作者：<a href="/member/contribute?uid=2586341479" style="color:#848e99;">ureallyloveme</a></span>
                                    </div>
                <hr size="1">
                <div class="article-msg">
                    <p><!-- JiaThis Button BEGIN -->

<!--
<span class="jiathis_style"><span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_tsina"></a>
    <a class="jiathis_button_tqq"></a>
    <a class="jiathis_button_qzone"></a>
    <a class="jiathis_button_renren"></a>
    <a class="jiathis_button_xiaoyou"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
</span>

-->
</p>
                </div>
                <p><p style="margin: 0px 25px 8px; padding: 0px; line-height: 25px; color: rgb(70, 79, 85); word-break: break-all; font-family: Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, 微软雅黑, serif; white-space: normal; background-color: rgb(255, 255, 255); text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(0, 112, 192); font-size: 18px; font-weight: 900;"><img src="http://p2.qhimg.com/t01261213ac09261231.jpg" title="t01261213ac09261231.jpg" alt="http://p2.qhimg.com/t01261213ac09261231.jpg"/></span></p><p style="margin: 0px 25px 8px; padding: 0px; line-height: 25px; color: rgb(70, 79, 85); word-break: break-all; font-family: Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, 微软雅黑, serif; white-space: normal; text-indent: 2em; background-color: rgb(255, 255, 255);"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(0, 112, 192); font-size: 18px; font-weight: 900;">作者：</span><a href="http://bobao.360.cn/member/contribute?uid=2586341479" target="_blank" style="text-decoration: none;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(0, 112, 192); font-size: 18px; font-weight: 900;">ureallyloveme</span></a></p><p style="margin: 0px 25px 8px; padding: 0px; line-height: 25px; color: rgb(70, 79, 85); word-break: break-all; font-family: Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, 微软雅黑, serif; white-space: normal; text-indent: 2em; background-color: rgb(255, 255, 255);"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(0, 112, 192); font-size: 18px; font-weight: 900;">预估</span><span style="font-weight: 900; color: rgb(0, 112, 192); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;">稿费：200RMB</span></p><p style="margin: 0px 25px 8px; padding: 0px; line-height: 25px; color: rgb(70, 79, 85); word-break: break-all; font-family: Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, 微软雅黑, serif; white-space: normal; text-indent: 2em; background-color: rgb(255, 255, 255);"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(0, 112, 192); font-size: 18px; font-weight: 900;">投稿方式：发送邮件至linwei#360.cn，或登陆网页版在线投稿</span></p><p><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(0, 112, 192); font-size: 18px; font-weight: 900;"><br/></span></p><p style="text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;">前言</span></strong></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><hr/><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">我们将使用以太坊来处理身份验证的问题。我们在这里所给出的是与区块链身份验证技术相关的典型问题。</span></p><p style="text-indent: 2em;"><a href="http://www.microsofttranslator.com/bv.aspx?from=en&to=zh-CHS&a=https%3A%2F%2Fwww.bitcoin.com%2F" target="_top" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">比特币</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">自2009 年问世以来，以其去中心化的、安全的货币交易理念惊艳了整个世界。以太坊的概念不仅仅只是数字化货币，它通过与图灵完备的智能合约相结合赋能了去中心化的交易模式。在这篇文章，我们联手Ivo Zieliński，Konrad Kozioł，David Belinchon，和来自</span><a href="http://www.microsofttranslator.com/bv.aspx?from=en&to=zh-CHS&a=https%3A%2F%2Fwww.gft.com%2F" target="_top" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">GFT创新团队</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">的Nicolás González为以太坊用户开发了一套可实现的基于以太坊的登录系统。这是一个理想的登录系统，它能够允许任何以太坊用户在不必使用其私钥的情况下，证明自己的以太坊帐户的所有权，就像他们登录到Facebook一样。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">介绍</span></strong></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><hr/><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">我们先来看看用户是如何登录到一个简单的系统上的：</span><br/></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">1.&nbsp;一个用户浏览到一个需要登录的第三方网站。该网站要求用户在文本区域内输入以太坊地址。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2.&nbsp;用户输入其以太坊地址，并单击&quot;登录&quot;。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">3.&nbsp;后端的第三方生成一个挑战字符串，并且签发一个JWT（Json web token），该挑战字符串被嵌入其中。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">4.&nbsp;由于login合约已在以太坊上可用了，用户可以直接将挑战字符串发送给login的方法。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">5.&nbsp;后端持续观察以太坊网络，是否出现由以太坊地址所有者在步骤2中所输入的并且被发送过来的挑战字符串。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">6.&nbsp;如果在合理的时间内，后端监测到挑战字符串，则用来自步骤2的以太坊地址作为标识，将该用户标记为登录成功的状态。一个新的带有完整地址的JWT随即会被发布给第三方网站。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">不过上述这种方法存在着一系列的问题：</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">1. 用户必须选择使用其以太坊的钱包，手动调用login合约里的login方法。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2. 用户必须事先知道login合约的地址和接口。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">3. 用户必须花费一些以太币用以登录，因为合约所依赖的events被记录到了区块链上（也就是说，它们执行了写操作）。这使得合约需要消费gas来运行。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">4.&nbsp;在登录完成之前，后端必须等待一个新的块来被开采，并从网络上传播过来（最小的延迟大约是12秒或更长的时间）。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">正如你所能想象到的，这些限制使得简单的身份验证都无法被实现。所以我们需要进行改进。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;</span></p><p style="text-indent: 2em;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">以太坊用户登录系统</span></strong></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><hr/><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">我们的系统将依赖于三个关键的要素： 一台身份验证服务器、一个移动应用程序和以太坊的网络。下图是他们之间的交互过程。</span><br/></p><p style="text-align: center; text-indent: 0em;"><img src="http://p8.qhimg.com/t015c67de8c1733e0c8.png" title="t017615c318f9277861.png" alt="http://p8.qhimg.com/t017615c318f9277861.png"/></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">要确保用户的以太坊地址与身份验证过程相独立，系统会生成一个完全不同的、仅作身份验证的以太坊地址。该地址通过使用以太坊合约与用户的以太坊地址相关联。换句话说，用户的以太坊地址和系统仅作登录用的地址之间的映射关系会被建立。这种映射在合约的帮助下被存储在以太坊的区块链内。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:bash;toolbar:false">pragma&nbsp;solidity&nbsp;^0.4.2;
contract&nbsp;Mapper&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;event&nbsp;AddressMapped(address&nbsp;primary,&nbsp;address&nbsp;secondary);
&nbsp;&nbsp;&nbsp;&nbsp;event&nbsp;Error(uint&nbsp;code,&nbsp;address&nbsp;sender);
&nbsp;&nbsp;&nbsp;&nbsp;mapping&nbsp;(address&nbsp;=&gt;&nbsp;address)&nbsp;public&nbsp;primaryToSecondary;
&nbsp;&nbsp;&nbsp;&nbsp;mapping&nbsp;(address&nbsp;=&gt;&nbsp;bool)&nbsp;public&nbsp;secondaryInUse;
&nbsp;&nbsp;&nbsp;&nbsp;modifier&nbsp;secondaryAddressMustBeUnique(address&nbsp;secondary)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(secondaryInUse[secondary])&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Error(1,&nbsp;msg.sender);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_;
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;mapAddress(address&nbsp;secondary)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;secondaryAddressMustBeUnique(secondary)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;mapping,&nbsp;this&nbsp;does&nbsp;nothing
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;secondaryInUse[primaryToSecondary[msg.sender]]&nbsp;=&nbsp;false;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;primaryToSecondary[msg.sender]&nbsp;=&nbsp;secondary;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;secondaryInUse[secondary]&nbsp;=&nbsp;true;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AddressMapped(msg.sender,&nbsp;secondary);
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">虽然该合约是我们目前所见到最为复杂的，但它仍然是比较容易理解的。让我们一起来解析一下吧：</span><br/></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">这里有两个事件：&nbsp;AddressMapped和Error&nbsp;。&nbsp;AddressMapped事件是在用户的主以太坊地址映射到一个辅助的、只作登录用的地址时所生成的。Error事件是遇到诸如映射使用到了现有的、已经存在的辅助地址之类的错误时才生成的。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">然后是两个变量的声明：primaryToSecondary和secondaryInUse。primaryToSecondary是一个地址的映射：根据主地址，它可以告知其所映射的辅助地址。secondaryInUse是一个指向布尔值的地址的映射，用于检查辅助地址是否已被使用。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">接下来的是secondaryAddressMustBeUnique。这个特殊函数是一个修改器。Solidity里的修改器是一些可以附加到合约方法里的特殊函数。这些都是在方法代码之前运行的，并且可以用来修改它们的行为。在本例中，secondaryAddressMustBeUnique使用secondaryInUse变量来确认作为参数传递的辅助地址是否正在使用中。如果是的话，它被标记为错误，而且Error事件就被激发了。如果它不是在使用中，则继续执行。_这个占位符是这个被修改的函数代码在逻辑上插入的位置。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">最后一个是mapAddress方法。此方法获得一个辅助的地址，并将它映射到该方法的发方或者是调用方的地址上。以太坊在语义上确保发方是其所声明的身份。换句话说，对于一个地址而言，只有密钥的所有者才能作为发方对Solidity的方法进行调用。这确保了在没有任何特殊检查的情况下，只有合法的主地址所有者才能够建立它与用于登录的辅助地址之间的映射关系。这正是我们系统的关键所在。</span></p><p style="text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">总之，我们的合约做到了四点：</span></strong></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">它建立了两个以太坊地址之间的映射：一个高值的地址（主地址）和一个低值的、只作登录的辅助地址。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">它保证了只有主地址的所有者才可以建立这种映射。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">它在区块链中公开地记录了此信息。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">它向监控发送了事件，并且对存储在它里面的数据变化作出了反应。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">我们的系统就是这样按我们的需要进行工作的。下面让我们来看看注册和身份验证流程是如何一起运作的。我们在此假设用户是具有一定数量以太币、以及具有以太坊帐户的合法拥有者。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">注册</span></strong></span></p><hr/><p style="text-align: center; text-indent: 0em;"><img src="http://p7.qhimg.com/t01a3137c361f219cda.png" title="t019da6d840db9ee41c.png" alt="http://p5.qhimg.com/t019da6d840db9ee41c.png" style="text-align: center; text-indent: 0em;"/></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">这只是在用户初次使用该系统时，所执行的一个一次性的步骤。一旦注册完成，用户可以将其以太坊的地址使用到任何第三方的网站上。换句话说，这是一个全系统的、一次性的步骤。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">为了简化身份验证的过程，我们使用一个移动应用程序来接受或拒绝身份验证的请求。用户通过启用其以太坊的帐户，来作为身份验证的一个因素，实现对移动应用程序的首次注册。</span></p><p style="text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">注册按照以下的步骤执行：</span></strong></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">1.&nbsp;用户打开移动应用程序。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2.&nbsp;用户输入其电子邮件地址和屏幕解锁图案。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">3.&nbsp;移动应用程序在后台生成新的以太坊的地址。这是个辅助地址。该地址被便捷地发送到用户的电子邮箱。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">4.&nbsp;用户在其主以太坊地址和辅助地址之间建立链接。要实现这一点，用户可以手动调用Mapper合约的mapAddress方法，或是用到为此目的开发的、特殊的钱包应用程序。这一步需要用户花费其主帐户里最少数量的gas。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">5.&nbsp;一旦地址之间的链接被建立，移动应用程序将显示一个确认的对话框。如果用户确认之，该映射就建立好了，而本过程也就完成。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">这种方法的增值好处之一在于：它使得一次性的传销帐户难以使用之。上述步骤4强制用户去花费以太币，来建立其个人的以太坊地址和仅登录用的地址之间的映射。对于这种方式，第三方则可以确保用户所使用的以太坊帐户并非一次性传销的帐户（例如垃圾邮件类帐户）。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">身份验证</span></strong></span></p><hr/><p style="text-align: center; text-indent: 0em;"><img src="http://p6.qhimg.com/t018fa5a86a7c269ad4.png" title="t017615c318f9277861.png" alt="http://p4.qhimg.com/t017615c318f9277861.png"/></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">一旦已注册的用户想要使用其以太坊帐户登录到一个第三方的网站，他或她就必须遵循如下的过程：</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">1.&nbsp;用户在输入字段中输入他或她的主以太坊地址或是他或她的电子邮件地址，单击&quot;登录&quot;。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2.&nbsp;第三方网站联系身份验证服务器，请求验证该地址。要实现这一步，第三方网站需要生成具有特定格式的挑战字符串，并将它传递给身份验证服务器。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">3.&nbsp;身份验证服务器检查该用户在以太坊网络中的当前辅助地址。然后，它在内部数据库中检查必需的数据，以联系与该地址相关联的移动设备。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">4.&nbsp;用户接收移动设备推送的通知，以是接受或拒绝登录请求。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">5.&nbsp;如果用户接受，辅助地址的私有密钥将被用于签发挑战字符串。签发的挑战然后被送回到身份验证服务器上。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">6.&nbsp;身份验证服务器验证该签名，如果其有效且与挑战相匹配，则认为该登录成功。随后，它发回已签名的挑战给第三方网站，作为可选的独立性确认依据。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">这就是全部！该方案将签名过程从敏感的主地址中分离出来，在防止暴露潜在重要的私有密钥的同时，仍然使第三方网站能够确认用户是否为该地址的合法所有者。此外，虽然为了方便起见，它依赖到了身份验证服务器，但是它在没有验证服务器的时候也能工作，它可以不把信任这一块放在验证服务器上（第三方网站可以自己检查签名）。因此在最坏的情况下（如身份验证服务器宕机），它也能够保持去中心化，而在平时去能保持便捷性。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">缺点</span></strong></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><hr/><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">为了方便起见，该方法依赖于身份验证服务器。虽然在没有身份验证服务器时，该系统仍然可能运行，但使用这种方式并不太方便。然而，我们在设计上必须考虑到“如果便捷的、去中心化的操作”是一种强制性的情况。在每种情况下，不信任的因素就被放在了该服务器之中。</span><br/></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">试试看！</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">由于这只是一个概念上的证明，而你在真正初次试水以太坊时可能会有点困难，因此我们在此为新用户给出一个步进式的指南来测试该系统。请注意，这只是一个测试系统，因此它使用的是以太坊的测试网络。换句话说，存储在以太坊的测试网络中的数据完整性并不能得以保障，因此，不要把重要的东西存放在本指南所创建的帐户中，它们是不会受到像以太坊主网络那样同等保障的。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">获取以太坊钱包</span></strong></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><hr/><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">为了执行以太坊的各种操作，你需要一个钱包。钱包是一个应用程序，它允许你与网络的其余部分进行交互。钱包为你的以太坊地址存储私有密钥。为简单起见，我们将用到</span><a href="http://www.microsofttranslator.com/bv.aspx?from=en&to=zh-CHS&a=https%3A%2F%2Fmetamask.io%2F" target="_top" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Metamask</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">。Metamask是一个基于浏览器的钱包，它作为Chrome的扩展运行在本地。各个密钥被存储在本地，并由它们来签发各笔交易。然后，这些被Metamask所运营的公共节点发送到网络中的其余部分。</span><br/></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">1.&nbsp;&nbsp; 获得Metamask</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">浏览</span><a href="http://www.microsofttranslator.com/bv.aspx?from=en&to=zh-CHS&a=https%3A%2F%2Fchrome.google.com%2Fwebstore%2Fdetail%2Fmetamask%2Fnkbihfbeogaeaoehlefnkodbefgpgknn" target="_top" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Chrome Webstore</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">（https://chrome.google.com/webstore/detail/metamask/nkbihfbeogaeaoehlefnkodbefgpgknn）并安装Metamask。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2.&nbsp;&nbsp; 创建一个新帐户</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在你的Chrome窗口的右上角单击Metamask图标，并根据其向导来创建一个帐户。请确保它是在Rinkeby&nbsp;的测试网络中被创建。要检查这一步是否成功，你可在创建帐户之后，在Metamask窗口的左上角，单击Metamask狐狸旁边的图标。如果你使用的是另外一个网络，请切换到&nbsp;Rinkeby，然后再跟着向导走下去。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">3.&nbsp;&nbsp; 获得一些以太币</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">为了注册，你将需要用最少数量的以太币。幸运的是，在测试网络中，这是很容易获得的（而在主网络中，你或是需要去购买，或是足够幸运地能够挖到“矿”)。在测试网络中，你可能会使用到&quot;水龙头&quot;（faucets），水龙头是一些得到免费以太币的地方。最</span><a href="http://www.microsofttranslator.com/bv.aspx?from=en&to=zh-CHS&a=https%3A%2F%2Fwww.rinkeby.io%2F" target="_top" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">普通的Rinkeby水龙头</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">（https://www.rinkeby.io/）是要求用户创建</span><a href="http://www.microsofttranslator.com/bv.aspx?from=en&to=zh-CHS&a=https%3A%2F%2Fgist.github.com%2F" target="_top" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">GitHub gist（https://gist.github.com/）</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">。这是简单的限制水龙头被滥用的方法。创建gist是非常容易的，你只需要有一个GitHub的帐户。请创建一个公共的GitHub gist，并将你的Metamask Rinkeby地址粘贴到其中。然后回到水龙头，并将链接放到gist的必填字段处，随后单击&quot;给我以太币&quot;(水龙头位于crypto faucet部分的左边条上)。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">经过这一番操作之后，你应该能在Metamask中可以看到你新获得的以太币了。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">要获得你的Rinkeby以太坊地址，请转到Metamask，然后单击你的帐户名称旁边的&quot;复制&quot;图标。这将是你主以太坊的地址。在实际的生产系统中，会有大量的以太币出现在该帐户的地址中。这个地址也是在你每次使用以太坊地址登录到第三方网站的时候，所不想暴露的。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">获取移动身份验证的应用程序</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">现在该设置你的辅助地址和登录帮助程序了。此应用程序将被作为身份验证的因子，用来确认你的登录请求。当你想要登录一些网站的时候，你将收到一个来自该应用程序的通知。此通知将允许你接受或拒绝身份验证的请求。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">1.&nbsp;&nbsp; 获取应用程序</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">进入Android Play商店，下载我们的</span><a href="http://www.microsofttranslator.com/bv.aspx?from=en&to=zh-CHS&a=https%3A%2F%2Fplay.google.com%2Fstore%2Fapps%2Fdetails%3Fid%3Dblock.chain.auth.zero" target="_top" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Auth0 PoC</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">应用程序（https://play.google.com/store/apps/details?id=block.chain.auth.zero）。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2.&nbsp;&nbsp; 注册</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">打开该应用程序并输入你的电子邮件地址。然后选择屏幕解锁图案。当你想登录到网站时，你会被要求输入此相同的图案。然后单击Register。你将被要求在移动应用程序上单击Sign来予以确认。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">移动应用程序现在就设置好了，让我们来为登录启用你的以太坊帐户吧。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">为登录启用你的以太坊地址</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">这一步，和以前一样只需执行一次，完成你的主地址和登录地址之间的映射设置。换句话说，它将把你的Metamask帐户连接到你智能手机的移动应用程序上。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">1.&nbsp;&nbsp; 获得你的移动应用程序（辅助）地址</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">如果你现在查看你的电子邮件（请注意检查那些垃圾、促销类邮件），你就会发现你以太坊的辅地址了。这就是通过你的智能手机来管理的帐户地址。请将它复制到剪贴板中。</span></p><p style="text-align: center; text-indent: 0em;"><img src="http://p7.qhimg.com/t019d82013e6ee969aa.png" title="t018d736ef6ce3ed2db.png" alt="http://p1.qhimg.com/t018d736ef6ce3ed2db.png"/></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2.&nbsp;&nbsp; 调用合约 ！</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">如果你是以太坊用户，且有你自己的钱包，你完全可以手动执行此步骤。然而为简单起见，我们已经建立了网站，为你分担了那些繁复的工作。同样使用你已安装了Metamask的Chrome实例，导航到</span><a href="http://www.microsofttranslator.com/bv.aspx?from=en&to=zh-CHS&a=http%3A%2F%2Fauth0-ethereum.com%3A3002%2Fwallet%2F" target="_top" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">我们PoC钱包</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">（http://auth0-ethereum.com:3002/wallet/）。这个网站是一个简单本地的、钱包类型的应用程序，它创建了调用合约所必须的以太坊事务。该网站与Metamask交互，因此你不必手动输入你的帐户详细信息。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">一旦你进入该网站，请将你从上一步电子邮件里复制的以太坊地址粘贴进来，单击Register，会弹出一个Metamask的窗口。这是一个对于你将使用主帐户里的以太币来进行一笔交易的确认，因此请单击Sign。过一会儿后，你主账户和辅助帐户就连接上了，其花费的时间完全取决于以太坊的网络状态。一般也就是几秒钟而已。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">考虑你可能已经对以太坊很熟悉了，而且想要自己手动执行此步骤。那么请调用Mapper合约里位于&nbsp;0x5e24bf433aee99227737663c0a387f02a9ed4b8a的mapAddress方法吧。你也可以通过链接：</span><a href="https://github.com/auth0/ethereum-auth-client/blob/master/config/abi.json" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">https://github.com/auth0/ethereum-auth-client/blob/master/config/abi.json</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">来获取</span><a href="http://www.microsofttranslator.com/bv.aspx?from=en&to=zh-CHS&a=https%3A%2F%2Fgithub.com%2Fauth0%2Fethereum-auth-client%2Fblob%2Fmaster%2Fconfig%2Fabi.json" target="_top" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">JSON API</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">。其唯一的参数就是你在电子邮件里获得的地址。至此，一切都以完成！</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">登录到我们的测试网站</span></strong></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><hr/><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">你现在可以运用你的电子邮件地址或是你的主以太坊地址作为凭据，登录到支持该身份验证方法的任何第三方网站了。请进入</span><a href="http://www.microsofttranslator.com/bv.aspx?from=en&to=zh-CHS&a=https%3A%2F%2Fauth0-ethereum.com%2Fauthzero" target="_top" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">我们的示例网站</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">：https://auth0-ethereum.com/authzero，填写你的电子邮件地址，然后单击Login。同时注意查看你的智能手机所弹出的通知，以批准你的登录信息。</span><br/></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">你会注意到一个标注着Trustless Authentication的复选框。如前文所述，第三方可能选用不同的安全级别。当被告知登录为有效（信任类型的身份验证）时，它们可以选择信任身份验证服务器；或者它们可能会选择不信任身份验证服务器，而是自己内部去验证签名。在这种情况下，第三方网站必须自己去验证辅助地址的签名，它们首先使用Mapper合约（这是公开可以获得的）来查询辅助地址，然后通过辅助地址的返回数据来验证签名，以查找到辅助地址所对应的公共密钥。这提供的是最高的安全级别，而只是用到身份验证服务器来传递消息。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">如果你有兴趣仔细了解我们的PoC是如何工作的话，这里是所有的资源库：</span></p><p style="text-indent: 2em;"><a href="http://www.microsofttranslator.com/bv.aspx?from=en&to=zh-CHS&a=https%3A%2F%2Fgithub.com%2Fauth0%2Fethereum-authentication-server" target="_top" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">身份验证服务器</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">：https://github.com/auth0/ethereum-authentication-server</span></p><p style="text-indent: 2em;"><a href="http://www.microsofttranslator.com/bv.aspx?from=en&to=zh-CHS&a=https%3A%2F%2Fgithub.com%2Fauth0%2Fethereum-authenticator-app-public" target="_top" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">移动应用程序</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">：https://github.com/auth0/ethereum-authenticator-app-public</span></p><p style="text-indent: 2em;"><a href="http://www.microsofttranslator.com/bv.aspx?from=en&to=zh-CHS&a=https%3A%2F%2Fgithub.com%2Fauth0%2Fethereum-sample-web" target="_top" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">第三方web应用程序</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">的示例：https://github.com/auth0/ethereum-sample-web</span></p><p style="text-indent: 2em;"><a href="http://www.microsofttranslator.com/bv.aspx?from=en&to=zh-CHS&a=https%3A%2F%2Fgithub.com%2Fauth0%2Fethereum-browser-wallet" target="_top" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">使用Metamask来注册钱包</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">：https://github.com/auth0/ethereum-browser-wallet</span></p><p style="text-indent: 2em;"><a href="file:///C:/Users/tangyizhen/Desktop/%E7%AE%80%E5%8D%95%E6%B5%8B%E8%AF%95%E7%9A%84%E5%90%84%E7%A7%8Ddocker%E8%84%9A%E6%9C%AC" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">简单测试的各种docker脚本</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">：https://github.com/auth0/ethereum-docker-deployment</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">上述的资料库也用到了一些针对此PoC开发的帮助库：</span></p><p style="text-indent: 2em;"><a href="http://www.microsofttranslator.com/bv.aspx?from=en&to=zh-CHS&a=https%3A%2F%2Fgithub.com%2Fauth0%2Fethereum-crypto" target="_top" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">以太坊加密的帮助库：</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">https://github.com/auth0/ethereum-crypto</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">此PoC用到的、</span><a href="http://www.microsofttranslator.com/bv.aspx?from=en&to=zh-CHS&a=https%3A%2F%2Fgithub.com%2Fauth0%2Fethereum-auth-client" target="_top" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">进行身份验证所需的JavaScript库</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">：https://github.com/auth0/ethereum-user-db-service</span></p><p style="text-indent: 2em;"><a href="http://www.microsofttranslator.com/bv.aspx?from=en&to=zh-CHS&a=https%3A%2F%2Fgithub.com%2Fauth0%2Fethereum-user-db-service" target="_top" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">简单的数据库抽象帮</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">助：https://github.com/auth0/ethereum-user-db-service</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">为</span><a href="file:///C:/Users/tangyizhen/Desktop/%E6%AD%A4PoC%E9%A2%84%E9%85%8D%E7%BD%AE%E7%9A%84%E4%BB%A5%E5%A4%AA%E5%9D%8A%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%8A%82%E7%82%B9" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">此PoC预配置的以太坊客户端节点</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">：https://github.com/auth0/go-ethereum</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;</span></p></p>
                <hr/>
                <p style="text-align: center;">
                    <img src="http://bobao.360.cn/img/app.jpeg"/>
                    <img src="http://bobao.360.cn/img/weixin.jpeg"/>
                </p>
                                <p>本文由 安全客 翻译，转载请注明“转自安全客”，并附上链接。<br/><a class="text-more" href="https://dzone.com/articles/authentication-ethereum-and-smart-contracts" target="_blank">原文链接：https://dzone.com/articles/authentication-ethereum-and-smart-contracts</a></p>
                            </div>
            <div style="margin-top: 20px;background-color:#FFFFFF">
    <input type="hidden" id="detail_title" name="detail_title" value="【技术分享】以太坊与智能合约之身份认证 - 安全客 - 有思想的安全新媒体" />
    <input type="hidden" id="use_nickname" name="use_nickname" value="0" />
    <a name="mao"></a>
    <div class="reg-log mobile-hiden">
        <div class="" id="userTo">   
            <div id="to-list" class="input-text" style="">
                <textarea disabled="disabled" class="hide"  id="comment-content" to="to"></textarea>
                <ul id="preadded" style="display:none">       
                </ul>
                <div id="to-auto" style="width: 200px">
                    <ul id="feed">
                    </ul>
                </div>
            </div>
        </div>
        <input type="hidden" id="source-id" value="3992" />
        <input type="hidden" id="source-type" value="learning" />
        <input type="hidden" id="post-comment-url" value="/comment/add" />
        <input type="hidden" id="post-nickname-url-ajax" value="/comment/randnicknameajax" />
        <input type="hidden" id="post-check-login-url-ajax" value="/comment/checklogin" />
        <input type="hidden" id="stoken_comment_set" value="ea3898fb4df38673fdeb61c458234054">                 <span class="join">参与讨论，请先 <a href="javascript:;" class="comment-login">登录</a> | <a href="javascript:;" class="comment-reg">注册</a> |  <a href="javascript:;" class="anonymous-comment">匿名评论</a></span>
            </div>
    <div class="mobile-hide" style="width: 870px; margin: 0 auto;">
        <label style="vertical-align:middle;" for="use_nickname">匿名</label> 
        <input style="vertical-align:middle;" id="trigger-nickname" name="use_nickname" class="use_nickname" type="checkbox" value="0" />

        <a href="javascript:;" class="apply-use button" id="submit-comment" data-target="/comment/add">发布</a>
    </div>


    <div class="clearfix"></div>
    <div class="comments">
        <div class="comments-head">
            <span class="title">用户评论</span>
        </div>
                <div class="comment-none alarm-info bg-primary">无任何评论</div>
            </div>
</div>
<script>
    $(function () {
        $('.anonymous-comment').click(function () {
            $(".join").hide();
            $(".reg-log textarea").first().removeAttr("disabled").show();
            $('#use_nickname').val('1');
//            $('#trigger-nickname').attr('checked', true);
            $('#trigger-nickname').trigger('click');
        });
        //为所有复选框绑定事件
//        checkbox_on_click();
        //ajax随机获取昵称
//        randnicknameajax(0);
        //ajax检测登录状态
        comment_check_login();
    });



    function input_checkbox(flag) {
        $('input:checkbox').each(function () {
            var value = flag ? 1 : 0;
            $(this).prop('checked', flag);
            $(this).val(value);
        });
    }

//ajax随机获取昵称
    function randnicknameajax(flag) {
        $.ajax({
            type: 'POST',
            url: $('#post-nickname-url-ajax').val(),
            data: {limit: 1, flag: flag},
            dataType: "json",
            success: function (data) {
                $('#nick-name').val(data.data[0]);
                _nick_name=data.data[0];
            }
        });
    }
    $();
//ajax检测登录状态
    function comment_check_login() {
        $.ajax({
            type: 'POST',
            url: $('#post-check-login-url-ajax').val(),
            data: {},
            dataType: "json",
            success: function (data) {
                if (data.success) {
                    $('.join').hide();
                    $(".reg-log textarea").first().removeAttr("disabled").show();
                    $("#span_use_nickname").show();
                    $('#use_nickname').val('0');
                    $('#use_nickname').attr('checked', false);
                }
            }
        });
    }
</script>        </div>
    </div>
    <div class="side-bar">
        <div class="mod hot-news">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-hot"></i><span>热门知识</span></h2>
    </div>
    <ul class="links-list">
                                <li><a href="/learning/detail/4411.html" alt="【漏洞预警】一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现——最新的Office高级威胁攻击预警" target="_blank">【漏洞预警】一个换行符引发的奥斯卡...</a></li>
                                <li><a href="/learning/detail/4416.html" alt="【漏洞预警】Microsoft .NET Framework漏洞（CVE–2017–8759）预警" target="_blank">【漏洞预警】Microsoft .NE...</a></li>
                                <li><a href="/learning/detail/4414.html" alt="【技术分享】妙用JavaScript绕过XSS过滤" target="_blank">【技术分享】妙用JavaScrip...</a></li>
                                <li><a href="/learning/detail/4418.html" alt="【技术分享】利用威胁情报数据平台拓展APT攻击线索一例" target="_blank">【技术分享】利用威胁情报数据平台拓...</a></li>
                                <li><a href="/learning/detail/4417.html" alt="【知识】9月15日 - 每日安全知识热点" target="_blank">【知识】9月15日 - 每日安全知识热...</a></li>
                                <li><a href="/learning/detail/4425.html" alt="【安全报告】XShellGhost事件技术回顾报告" target="_blank">【安全报告】XShellGhost事件...</a></li>
            </ul>
</div>        <!-- 友情链接 -->
        <div class="mod blog-links mobile-hide">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-link"></i><span>友情链接</span></h2>
        <a href="/links/index.html" class="more">更多<i></i></a>
    </div>
        <ul class="links-list">
                <li><a href="http://bbs.360safe.com" alt="360安全社区" target="_blank">360安全社区</a></li>
                <li><a href="http://zhuji.360.cn" alt="360主机卫士" target="_blank">360主机卫士</a></li>
                <li><a href="http://blogs.360.cn/" alt="奇虎360技术博客" target="_blank">奇虎360技术博客</a></li>
                <li><a href="http://wangzhan.360.cn/" alt="360网站卫士" target="_blank">360网站卫士</a></li>
                <li><a href="http://webscan.360.cn/" alt="360网站安全检测" target="_blank">360网站安全检测</a></li>
                <li><a href="http://research.360.cn/report/" alt="360研究报告" target="_blank">360研究报告</a></li>
                <li><a href="http://unicorn.360.cn/" alt="360 Unicorn Team" target="_blank">360 Unicorn Team</a></li>
                <li><a href="http://appscan.360.cn/" alt="360捉虫猎手" target="_blank">360捉虫猎手</a></li>
                <li><a href="https://threathunter.org/" alt="ThreatHunter社区" target="_blank">ThreatHunter社区</a></li>
                <li><a href="http://security.360.cn/" alt="360安全应急响应中心" target="_blank">360安全应急响应中心</a></li>
            </ul>
    </div>
        <!-- 联系我们 -->
        <div class="mod contact mobile-hide" style="text-align:center">
    <div class="head-bar clearfix">
        <h2><i></i><span>关注我们</span></h2>
    </div>
    <!-- 微信关注 -->
    <ul class="contact-way">
        <li><a>微信关注</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/qrcode_adlab_weixin.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
    <!-- APP下载 -->
    <ul class="contact-way">
        <li><a>安全播报APP</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/scan_code_big.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
</div>

    </div>
</div>

<script type="text/javascript" src="/js/jquery-ui.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/jquery.noty.packaged.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/common.js?v=4.5"></script>
<script>$(function() {sync_count('comment');});</script>


<!-- 语法高亮 -->
<script type="text/javascript" src="/ue/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">SyntaxHighlighter.all();sync_count('vul');sync_count('news');sync_count('learning');sync_count('activity');sync_count('course');sync_count('ctf');</script>
    </div>

        <div class="footer">
        <div class="friend-link">
            <a href="http://www.360.cn/" target="_blank">360首页</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">关于我们</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">联系我们</a>
            <span>|</span>
            <a href="/links/index.html" target="_blank">友情链接</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">招贤纳士</a>
        </div>
        <div class="copy">
            Copyright &copy; 360网络攻防实验室 All Rights Reserved <span class="copy_icp">京ICP证080047号[京ICP备08010314号-6]</span>
        </div>
    </div>
    
</div>

<!--奇舞团统计-->

<script src='https://s.ssl.qhimg.com/static/f5407c785655e6a1/monitor_analytic.js'></script>
<script>
    monitor.setProject('QH_171_1').getTrack().getClickAndKeydown().getClickHeatmap(10, 1);
</script>

<div class="hide">
    <script src="https://s95.cnzz.com/z_stat.php?id=1253147824&web_id=1253147824" language="JavaScript"></script>
</div>
<div class="backToTop_wrap off">
    <a id="back_to_top" class="backToTop" href="javascript:;" title="返回顶部"></a>
</div>
<script>
    var $backToTop_wrap = $(".backToTop_wrap"),
        $backToTop_btn = $("#back_to_top");

    if ($(window).scrollTop() > 100) {
        $backToTop_wrap.removeClass("off");
    }
    else {
        $backToTop_wrap.addClass("off");
    }

    $(window).on("scroll", function () {
        if ($(this).scrollTop() > 100) {
            $backToTop_wrap.removeClass("off");
        }
        else {
            $backToTop_wrap.addClass("off");
        }
    });

    $backToTop_btn.on("click", function () {
        $("html, body").animate({scrollTop: 0}, 120);
    });

    $(function () {
        var navlist = $('.nav-list > li');

        navlist.each(function () {
            $(this).on('mouseenter', function () {
                $(this).addClass('selected');
            });

            $(this).on('mouseleave', function () {
                $(this).removeClass('selected');
            });
        });
    })
</script>



</body>
</html>
