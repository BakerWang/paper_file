<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:wb="http://open.weibo.com/wb" xml:lang="en" lang="en">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <link rel="shortcut icon" href="http://bobao.360.cn/favicon.ico?v=1.1"/>
    <link rel="alternate" title="安全资讯" href="/rss?type=news" type="application/rss+xml"/>
    <link rel="alternate" title="安全知识" href="/rss?type=learning" type="application/rss+xml"/>
    <link rel="alternate" title="安全圈活动" href="/rss?type=activity" type="application/rss+xml"/>
    <link rel="alternate" title="所有漏洞" href="/rss?type=vul" type="application/rss+xml"/>
    <link rel="alternate" title="通用型漏洞" href="/rss?type=commonvul" type="application/rss+xml"/>
    <link rel="alternate" title="事件型漏洞" href="/rss?type=eventvul" type="application/rss+xml"/>
    <link rel="alternate" title="热门漏洞" href="/rss?type=hotvul" type="application/rss+xml"/>

        <title>【技术分享】ShadowFall：对域名阴影攻击活动的详细分析报告 - 安全客 - 有思想的安全新媒体</title>
    
        <meta name="keywords" content="ShadowFall"/>
    
        <meta name="description" content="在过去的几个月里，RSA研究部门与多个机构一起努力，专门针对RIG攻击工具集进行了研究，在研究过程中，我们深入了解了攻击者使用的基础设施，同时也发现了攻击者所使用的域名阴影“domain shadowing”技术。本篇文章为对域名阴影攻击活动的详细分析报告。"/>
        <meta property="wb:webmaster" content="224437c7be31d633"/>

    <script type="text/javascript" src="http://s7.qhimg.com/!56caa871/xpc_sync_height.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/reset.css" />
    <link rel="stylesheet" type="text/css" href="/css/common_new.css?v=4.4.2.1" />
    <link rel="stylesheet" type="text/css" href="/css/jquery.notyfy.css" />
    <link rel="stylesheet" type="text/css" href="/css/notyfy.theme.default.css" />
    <link rel="stylesheet" type="text/css" href="/css/s_common.css?v=2.2.7" media="only screen and
    (max-device-width:900px), only screen and (max-width:900px)" />
    <script type="text/javascript" src="/js/jquery.min.js?v=3.1"></script>
    <script type="text/javascript" src="/js/jquery.notyfy.js"></script>
    <script type="text/javascript" src="/js/iscroll.js"></script>
    <script src="http://js.passport.qihucdn.com/5.0.3.js"></script>
    <script type="text/javascript">
        var myScroll, myNavScroll;

        function iscrollLoaded() {
            myScroll = new IScroll('#wrapper',
                {
                    scrollX: true,
                    scrollY: false,
                    bounceEasing: 'circular',
                    eventPassthrough: true,
                    preventDefault: false,
                    bounceTime: 500
                }
            );
        }

        $(function () {

            //导航横向滚动


            function setNavWidth() {

                /* 计算导航宽度 */
                var allWidth = $(window).width();
                var scroller = $('#scroller');

                if (allWidth > 900) {
                    scroller.find('ul').add(scroller.find('.scroll')).removeAttr('style');
                    scroller.css('overflow', 'visible');
                    if (myNavScroll) myNavScroll.destroy();
                } else {

                    var width = 0;
                    scroller.find('.scroll').children('ul').children('li').each(function (index, el) {
                        if (!$(this).hasClass('mobile-hide')) {
                            width += $(this).outerWidth();
                        }
                    });
                    scroller.find('ul').add(scroller.find('.scroll')).width(width);

                    if (myNavScroll) myNavScroll.destroy();

                    myNavScroll = new IScroll('#scroller', {
                        scrollX: true,
                        scrollY: false,
                        momentum: false,
                        click: true
                    });

                }

            }

            setNavWidth();
            $(window).resize(function (event) {
                setNavWidth();
            });

        });

    </script>
</head>
<body onload="iscrollLoaded();">
<div style='margin:0 auto;width:0px;height:0px;overflow:hidden;'>
    <img src=""/>
</div>

<div id="is-mobile"></div>
<div class="container">
        <div class="mobile-header">
        <div class="header clearfix">
            <div class="header-wrapper clearfix">
                <a href="/index/index" class="logo"><img class="slogan" src="/img/logo.png?v=1.5"/></a>
                                <form id="search" class="search-box" action="/search/index" method="GET">
                    <input class="keys" name="keywords" type="text" placeholder="搜索漏洞" required="required">
                    <input class="icon" type="submit" value="">
                    <input type="hidden" name="type" value=""/>
                </form>
                <div class="bug">
                    <div class="name"><span class="seled">全部</span><i class="arrow"></i></div>
                    <ul class="typelist">
                        <li data-index="3"><a href="javascript:void(0);">全部</a></li>
                        <li data-index="0"><a href="javascript:void(0);">漏洞</a></li>
                        <li data-index="1"><a href="javascript:void(0);">资讯</a></li>
                        <li data-index="2"><a href="javascript:void(0);">知识</a></li>
                    </ul>
                </div>
                                <div class="logNreg mobile-hide">
                    <div class="unlog">
                        <i></i>
                        <a href="log.html" class="log">登录</a>
                        <span>|</span>
                        <a href="reg.html" class="reg">注册</a>
                    </div>
                    <div class="loged">
                        <a href="/member/profile" class="user-center"><i></i><span class="user-name-tag">个人中心</span></a>
                        <div class="user-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting"><a href="http://i.360.cn/profile/accountmanage"
                                                               target="_blank"><i></i><span>账号设置</span></a></li>
                                <li class="alert-setting"><a href="/keywords/index"
                                                             target="_blank"><i></i><span>告警设置</span></a></li>
                                <li class="bug-alert"><a href="/myalarm/index" target="_blank"><i></i><span>漏洞告警</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mylearn/index" target="_blank"><i></i><span>我的知识</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mycourse/index" target="_blank"><i></i><span>我的课堂</span></a>
                                </li>
                                <li class="my-exit"><a
                                            href="http://login.360.cn/?src=pcw_adlab&op=logout&destUrl=http://bobao.360.cn"><i></i><span>退出系统</span></a>
                                </li>
                            </ul>
                        </div>

                        <a href="/message" class="message-center" target="_blank"><i></i><span>我的消息</span></a>
                        <div class="message-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting" style="display:none;"><a href="/myres/index"
                                                                                     target="_blank"><i></i><span>回复我的</span></a>
                                </li>
                                <li class="my-bug"><a href="/myvul/index"
                                                      target="_blank"><i></i><span>我的漏洞</span></a></li>
                                <!--<li class="my-bug"><a href="/myres/index" target="_blank"><i></i><span>我的评论</span></a></li>-->
                                <!--<li class="alert-setting"><a href="###" target="_blank"><i></i><span>提到我的</span></a>
                                </li>-->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <style type="text/css">
            .nav {
                overflow: hidden;
            }

            .nav .scroll {
                width: auto;
            }
        </style>
        <div id="wrapper">
            <div id="scroller" class="nav">
                <div class="scroll">
                    <ul class="nav-list">
                        <li ><a class="link-nav"
                                                                                 href="/index/index">首页</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/vul/index">漏洞</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/introduce/list">招聘</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/news/index">资讯</a><!--<i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/introduce/list">招聘</a></li>
                        </ul>
			-->
                        </li>
                        <li class="cur">
                        <a class="link-nav" href="/learning/index">知识</a><i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/course/index">学院</a></li>
                        </ul>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/activity/index">活动</a></li>
                        <li class="mobile-hide "><a class="link-nav"
                                                                                                   href="/ctf/index">CTF训练营</a>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/interref/list">安全内参</a></li>
                        <li ><a class="link-nav" href="/app/index">APP</a></li>

                        <!--<li ><a href="/course/index">学院</a></li>-->
                        <!--<li ><a href="/introduce/list">招聘</a></li>-->
                        <!--<li  class="mobile-hide"><a href="/ctf/index">CTF训练营</a></li>-->
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="mobile-content">
        <link rel="stylesheet" type="text/css" href="/css/news.css?v=3.5" />
<link rel="stylesheet" type="text/css" href="/ue/SyntaxHighlighter/shCoreDefault.css?v=1.0" />
<style>
    p .syntaxhighlighter {
        width: 80%;
    }
</style>

<div class="cur-pos w1000">当前位置：<a href="http://bobao.360.cn/">安全客</a> &gt;&gt; 知识详情</div>

<div class="content clearfix">
    <div class="main">
        <div class="article">
            <div id="article_box">
                <h2>【技术分享】ShadowFall：对域名阴影攻击活动的详细分析报告</h2>
                <div class="article-msg">
                    <span class="time">2017-06-13 14:29:17</span>
                    
                                        <span class="read">阅读：23931次</span>
                    <span><a style="display: none;" class="good" href="javascript:;"
                             data-target="/learning/good" data-value="g_3973"
                             data-type="learning">点赞(0)</a></span>
                    <span><a class="fav" href="javascript:;" data-target="/mylearning/add"
                             data-pk="3973" data-type="learning">收藏</a></span>
                                        <span><a style="margin-left: 4px;" class="fav" href="https://blogs.rsa.com/shadowfall/"
                             target="_blank">来源： rsa.com</a></span>
                    
                    
                    <div style="margin-top:10px; ">
                        <a href="/member/contribute?uid=2819002922" style="color:#848e99;">
                            <img src="http://p1.qhmsg.com/dm/150_150_100/t0104d1b8b4ca36e961.jpg" data-is-avatar="true"
                                 style="border: 1px solid #d5d5d5;padding: 2px; width: 80px;height: 80px;border-radius: 43px;"/>
                        </a>

                    </div>
                    <span class="orig">作者：<a href="/member/contribute?uid=2819002922" style="color:#848e99;">興趣使然的小胃</a></span>
                                    </div>
                <hr size="1">
                <div class="article-msg">
                    <p><!-- JiaThis Button BEGIN -->

<!--
<span class="jiathis_style"><span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_tsina"></a>
    <a class="jiathis_button_tqq"></a>
    <a class="jiathis_button_qzone"></a>
    <a class="jiathis_button_renren"></a>
    <a class="jiathis_button_xiaoyou"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
</span>

-->
</p>
                </div>
                <p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></strong></span></p><p style="margin: 0px 25px 8px; white-space: normal; padding: 0px; line-height: 25px; color: rgb(70, 79, 85); word-break: break-all; font-family: Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, 微软雅黑, serif; background-color: rgb(255, 255, 255); text-indent: 0em; text-align: center;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(0, 112, 192); font-size: 18px; font-weight: 900;"><img src="http://p2.qhimg.com/t0162b1af6a04356768.jpg" title="t0162b1af6a04356768.jpg" alt="http://p2.qhimg.com/t0162b1af6a04356768.jpg"/></span></p><p style="margin: 0px 25px 8px; white-space: normal; padding: 0px; line-height: 25px; color: rgb(70, 79, 85); word-break: break-all; font-family: Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, 微软雅黑, serif; text-indent: 2em; background-color: rgb(255, 255, 255);"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(0, 112, 192); font-size: 18px; font-weight: 900;">翻译：</span><a href="http://bobao.360.cn/member/contribute?uid=2819002922" target="_blank" textvalue="興趣使然的小胃" style="text-decoration: underline; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px; color: rgb(0, 112, 192);"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px; color: rgb(0, 112, 192);"><strong>興趣使然的小胃</strong></span></a></p><p style="margin: 0px 25px 8px; white-space: normal; padding: 0px; line-height: 25px; color: rgb(70, 79, 85); word-break: break-all; font-family: Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, 微软雅黑, serif; text-indent: 2em; background-color: rgb(255, 255, 255);"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(0, 112, 192); font-size: 18px; font-weight: 900;">预估稿费：200RMB</span></p><p style="margin: 0px 25px 8px; white-space: normal; padding: 0px; line-height: 25px; color: rgb(70, 79, 85); word-break: break-all; font-family: Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, 微软雅黑, serif; text-indent: 2em; background-color: rgb(255, 255, 255);"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(0, 112, 192); font-size: 18px; font-weight: 900;">投稿方式：发送邮件至linwei#360.cn，或登陆网页版在线投稿</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">一、前言</span></strong></span><br/></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">在过去的几个月里，RSA研究部门与多个机构一起努力，专门针对RIG攻击工具集（RIG Exploit Kit，简称为RIG EK或者RIG）进行了研究，在研究过程中，我们深入了解了攻击者使用的基础设施（也可能是整个生态环境），同时也发现了攻击者所使用的域名阴影“domain shadowing”技术。所谓的域名阴影技术，就是指“攻击者窃取受害者的域名凭证，然后创建指向恶意服务器的多个子域名的一种技术”。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">这项研究的直接成果就是，数以万计活跃的影子域名资源得以删除，这些资源都与RIG、恶意软件以及恶意广告等攻击活动有关。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2017年2月21日以至3月20日期间，我们收集并评估了研究任务所需的初始数据，在后续研究过程中，我们对重要数据也进行了采集、评估以及研究，以确保整个研究内容与RIG EK活动有关。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">二、RIG EXPLOIT KIT</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">我们整个研究工作的立足点是对RIG EK的详细分析，因此我们有必要详细阐述RIG EK的具体工作方式。图1描述了RIG的典型操作流程，这一流程也是我们下文的分析基础。</span></p><p style="text-align:center"><img src="http://p9.qhimg.com/t01187b3c32a994d45b.jpg" title="t01b7989d1f20157d13.jpg" alt="http://p2.qhimg.com/t01b7989d1f20157d13.jpg"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图1. RIG分发概述</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">如图2所示，RIG目前仍是市场上活跃的一个具备多样化攻击载荷的工具集。</span></p><p style="text-align:center"><img src="http://p8.qhimg.com/t012c3c16572844b4b0.png" title="t01fb64f5803f758290.png" alt="http://p2.qhimg.com/t01fb64f5803f758290.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图2. 截至2017年5月17日RIG攻击工具的活动情况（参考来源：</span><a href="http://executemalware.com/" target="_self" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">@executemalware</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">）</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">三、被攻破的站点</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">RIG EK攻击活动中最初的落脚点就是被攻破的那些站点，这也是攻击活动中最关键的一环。虽然恶意广告、Chrome的字体弹出窗口以及其他方法在恶意页面传播方面有一定作用，但根据我们的研究，恶意页面最主要的传播途径是将iframe注入到已被攻击者攻陷的WordPress、Joomla!以及Drupal网站中。</span></p><p style="text-align:center"><img src="http://p9.qhimg.com/t01d1e4c9da48066b39.png" title="t01489435ff11f931d3.png" alt="http://p0.qhimg.com/t01489435ff11f931d3.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图3. 017年3月6日注入的</span><a href="https://gist.github.com/anonymous/6bc39fac0a5f1f4c7ecf63925148e1d3/" target="_self" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">iframe</span></a></p><p style="text-align:center"><img src="http://p6.qhimg.com/t01e070709fff3acea1.png" title="t0139ad9413d497f4bb.png" alt="http://p4.qhimg.com/t0139ad9413d497f4bb.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图4. 2017年3月20日注入的</span><a href="https://gist.github.com/anonymous/8b05509c4355973149af285c6ecd0d7b" target="_self" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">iframe</span></a></p><p style="text-align:center"><img src="http://p7.qhimg.com/t018aabc95e33a58bdf.png" title="t01b47c44eb62eb2a5d.png" alt="http://p6.qhimg.com/t01b47c44eb62eb2a5d.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图5. 2017年4月10日注入的</span><a href="https://gist.github.com/anonymous/780556dbe79cd0dd5abef7a726f23b4d" target="_self" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">iframe</span></a></p><p style="text-align:center"><img src="http://p3.qhimg.com/t01ed76051e82e3d3e1.png" title="t012f0f3055f244e2c9.png" alt="http://p5.qhimg.com/t012f0f3055f244e2c9.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图6. 2017年5月15日注入的</span><a href="https://malwarebreakdown.com/2017/05/15/rig-exploit-kit-at-185-154-53-7-drops-pony-downloads-philadelphia-ransomware/" target="_self" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">iframe</span></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在RIG EK中我们经常可以看到URL参数的使用。从历史上来看，研究人员发现这个攻击工具集会重复使用并且不断变换URL参数，这些URL参数在注入的iframe、JavaScript以及其他方面都有所使用。</span><a href="https://www.lac.co.jp/" target="_self" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">LAC</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">于2017年2月份发布的</span><a href="https://www.lac.co.jp/lacwatch/report/20170202_001203.html" target="_self" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">网格视图系列报告</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">中，包含一份（日本地区的）RIG白皮书，其中按时间线方式梳理了与RIG有关的URL参数。目前RIG EK所使用的参数如图7所示。</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t01ea37167dd4915327.png" title="t01ea70cfab091f46d4.png" alt="http://p4.qhimg.com/t01ea70cfab091f46d4.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图7. 2017年5月12日RIG所用的URL参数</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">当我们对某些被攻破的、被RIG挂马的站点进行分析时（我们通过抓包工具鉴别出这类站点），我们发现这类站点的注册者似乎集中在几个主要的域名注册商（如图8所示）。</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t01789c23905be64a56.png" title="t01a07482d0edac1324.png" alt="http://p3.qhimg.com/t01a07482d0edac1324.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图8. 受影响的站点分布图</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">四、网关（GATE）以及流量分配系统（TDS）技术</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="text-indent: 2em; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在我们研究的早期阶段，我们没有发现足够的证据表明主流RIG家族（特别是PseudoDarkleech以及EITEST）使用过流量分配系统（Traffic Distribution System，TDS）以及网关（GATE）等技术，尽管已经有其他安全研究人员（如@dynamicanalysis）发表过公开报告，分析与</span><a href="https://malwarebreakdown.com/2017/03/06/tds-redirecting-users-to-rig-exploit-kit-and-other-stuff/" target="_self" style="text-indent: 2em; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">RIG EK</a><span style="text-indent: 2em; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">有关的</span><a href="https://malwarebreakdown.com/2017/03/10/finding-a-good-man/" target="_self" style="text-indent: 2em; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">GoodMan</a><span style="text-indent: 2em; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">以及其他恶意广告使用过TDS技术来转发流量。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">然而，这种情况在3月底、4月份以及5月份发生了变化，原因主要归结于几个新家族的出现。GoodMan以及Seamless家族使用的是传统的网关技术（如GoodMan使用了“hurtmehard[.].net”这个地址），新兴的</span><a href="https://blog.malwarebytes.com/cybercrime/2017/03/websites-compromised-decimal-ip-campaign/" target="_self" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">“十进制IP”家族</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">使用了整数形式的IP地址，以将流量重定向到RIG宿主页面。这些家族使用这种技术，主要是想逃避传统的基于攻击指示器（indicator of compromise，IOC）的检测方法（如图9所示）。</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t01990f454ab6415b3f.png" title="t0168dc6a7d0900d2ee.png" alt="http://p7.qhimg.com/t0168dc6a7d0900d2ee.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图9. 重定向到RIG的十进制IP</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">五、宿主页面</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="text-indent: 2em; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">传统的网关技术以及被攻破站点的iframe注入技术都会将流量导向RIG宿主页面，这也是RIG工作模式的基础。图10为这类网络流量的一个抓包样例，读者可以参考</span><a href="https://github.com/nao-sec/RigEK/blob/master/decimalip_rig.pcap" target="_self" style="text-indent: 2em; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">此处</a><span style="text-indent: 2em; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">了解十进制IP家族当前所对应的PCAP报文。</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t016bd2e1e7915ea6fa.png" title="t016173e69a243c5f85.png" alt="http://p7.qhimg.com/t016173e69a243c5f85.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图10. 导向RIG宿主页面的网络流量</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2017年5月16日我们观察到的RIG宿主页面经过部分去混淆处理后，如图11所示。</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t0140f8ed30e6d1b4f5.png" title="t010e90959add74ba72.png" alt="http://p2.qhimg.com/t010e90959add74ba72.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图11. 2017年5月16日的RIG宿主页面</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">RIG宿主页面的主要目的就是智能化地处理来自客户主机的连入请求，使用一系列不同的载荷突破客户主机，这些载荷来自于许多不同的恶意家族。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">六、漏洞利用技术</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="text-indent: 2em; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在我们的调查过程中，我们发现RIG宿主页面最常使用的漏洞利用技术与Flash有关（通常是利用</span><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8651" target="_self" style="text-indent: 2em; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">CVE-2015-8651</a><span style="text-indent: 2em; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">漏洞）。经过一番细致的调查，我们将当前的RIG样本与之前的样本集合进行比较，发现多个家族间存在代码以及执行流程上的关联性，证据就是它们之间都使用了容易被识别的Flash漏洞利用技术（如图12所示）。</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t01c470db28ba10a531.png" title="t01f412fbbb25356b11.png" alt="http://p3.qhimg.com/t01f412fbbb25356b11.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图12. 与RIG有关的Flash漏洞利用技术的扫描结果</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">除了这个Flash漏洞利用技术，我们还发现RIG宿主页面也会利用</span><a href="https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-0189" target="_self" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">CVE-2016-0189</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">、</span><a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2015-2419" target="_self" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">CVE-2015-2419</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">以及</span><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6332" target="_self" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">CVE-2014-6332</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">三个漏洞对IE浏览器发起攻击（如图13所示）。</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t01dc0f53bd873a377e.png" title="t01b6b83e8857bb6d54.png" alt="http://p5.qhimg.com/t01b6b83e8857bb6d54.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图13. 按照user agent信息归类的</span><a href="https://github.com/nao-sec/RigEK" target="_self" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">CVE漏洞利用技术</span></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">虽然本文关注的重点不是对RIG宿主页面的逆向分析，也不是与漏洞利用有关的一些技术，但其中某些高超的技术仍然值得一提。具体来说，我们推荐读者阅读</span><a href="https://community.rsa.com/community/products/netwitness/blog/2017/02/01/rig-ek-chronology-of-an-exploit-kit" target="_self" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">RSA研究机构</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">以及</span><a href="http://www.nao-sec.org/2017/04/analyzing-rig-exploit-kit-vol1.html" target="_self" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">nao_sec</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">的一些分析文章。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">七、恶意载荷</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">RIG使用的恶意载荷数量巨大且源源不断，这些载荷很大程度上取决于使用RIG传播的各种恶意家族。在调查过程中，我们发现使用RIG传播的Cerber勒索软件影响范围巨大，这款恶意软件是PseudoDarkleech（PDL）家族的最爱。PDL在4月份逐渐归于沉寂，基本保持静默（或隐身）状态。读者可以在附录A中找到对Cerber载荷的分析。</span></p><p style="text-align:center"><img src="http://p9.qhimg.com/t01925593b866915d74.png" title="t017fcbfd42e45923a5.png" alt="http://p8.qhimg.com/t017fcbfd42e45923a5.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图14. Cerber勒索软件欢迎界面</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在我们前期调研中，我们还注意到另一个活跃的家族：EITEST。EITEST目前仍处于活跃状态，并且正在传播各种恶意载荷（如</span><a href="https://www.proofpoint.com/us/threat-insight/post/ursnif-variant-dreambot-adds-tor-functionality" target="_self" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Dreambot</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">银行木马），但主要的载荷还是勒索软件，以牟取稳定收入。在2月份以及3月份，这个家族投放了Cerber、CryptoShield、</span><a href="https://www.reverse.it/sample/2d8e4c759298089febd7db14826c8becdc2be7a20be203b6f113ba289fb4d8d1?environmentId=100" target="_self" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Sage</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">以及</span><a href="http://malware-traffic-analysis.net/2017/03/06/index.html" target="_self" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Spora</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">恶意软件。读者可以在附录B中找到对CryptoShield载荷的具体分析。</span></p><p style="text-align:center"><img src="http://p3.qhimg.com/t0194a297b8387a0d3e.png" title="t01727846196d38f59a.png" alt="http://p3.qhimg.com/t01727846196d38f59a.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图15. CryptoShield欢迎界面</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">最近活跃的利用RIG传播的两个十进制IP家族中，有一个正在投放</span><a href="https://blog.malwarebytes.com/threat-analysis/2016/08/smoke-loader-downloader-with-a-smokescreen-still-alive/" target="_self" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">smokeloader</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">（查看</span><a href="https://www.hybrid-analysis.com/sample/b1ac30b73b959603bb2c42f97bab6ca48f5a953a1fcb50bacb06f0eb5e2402c7?environmentId=100" target="_self" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">此链接</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">了解样本信息）载荷。目前有多个研究人员正在跟踪这个家族，其中</span><a href="https://zerophagemalware.com/2017/04/27/rig-ek-via-decimal-redirect-drops-smoke-loader/" target="_self" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">zerophage</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">分析了该样本的网络流量，如图16所示。</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t01ce96ecae7034404b.png" title="t0188ed07de6340e825.png" alt="http://p5.qhimg.com/t0188ed07de6340e825.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图16. 使用十进制IP重定向技术来投放Smokeloader载荷</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Seamless家族最近正在投放Latentbot以及Ramnit勒索软件。</span><a href="https://umbrella.cisco.com/blog/2017/03/29/seamless-campaign-delivers-ramnit-via-rig-ek/" target="_self" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Cisco</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">以及Brad Duncan已经对这个家族做了些技术分析，如图17所示。</span></p><p style="text-align:center"><img src="http://p2.qhimg.com/t017b3bbf7ec4486e09.png" title="t0191d7c5a726e5919a.png" alt="http://p6.qhimg.com/t0191d7c5a726e5919a.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图17. </span><a href="https://umbrella.cisco.com/blog/2017/03/29/seamless-campaign-delivers-ramnit-via-rig-ek/" target="_self" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Seamless家族</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在投放Ramnit勒索软件时的网络流量</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">八、追踪影子域名的基础设施</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">结合RIG传播流程，我们应如何描述这些恶意家族所用的基础设施？根据2月21日-27日期间收集到的RIG宿主页面信息，我们使用Maltego来生成EITEST以及PDL家族所使用的、与RIG有关的基础设施快照图（我们同样也使用了PassiveTotal以及DomainTools来关联及增强分析结果），如图18所示。</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t01cdd41e0bf5f0a9e2.png" title="t010f9d7a33f6e19639.png" alt="http://p7.qhimg.com/t010f9d7a33f6e19639.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图18. 2017年2月27日观察到的与RIG有关的基础设施样本图</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在分析过程中，我们注意到这些基础设施有三个地方比较有趣。首先，从2月底开始，贯穿整个3月份，直到4月初，我们发现RIG活动中有大量IP子网重复使用的程度很高。</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t01d7ab51768221f28c.png" title="t01e950f54f30ef326a.png" alt="http://p3.qhimg.com/t01e950f54f30ef326a.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图19. 托管RIG主机的ASN情况</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在过去的</span><a href="https://community.rsa.com/community/products/netwitness/blog/2016/12/29/2017-time-for-a-wake-up-call" target="_self" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">研究</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">中，我们讨论过</span><a href="http://www.uncensoredhosting.com/best-bulletproof-hosting/" target="_self" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">堡垒主机服务（bulletproof hosting）</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">对犯罪分子的重要性及可用性。RSA研究机构观察到与RIG有关的自治系统号（Autonomous System Number，ASN）主要集中在一部分“商业界限模糊”的堡垒主机服务提供商的范围中（如TimeWeb）。具体说来，这些ASN能够提供合法的、用途嘈杂的网络流量服务（这些流量难以被列入黑名单），以便成为犯罪分子开展攻击活动的中继站。经过粗略的OSINT（开源情报）搜索，我们可以找到支持这个结论的许多特征，如下所示：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><a href="https://ransomwaretracker.abuse.ch/host/dmtya.ru/" _src="https://ransomwaretracker.abuse.ch/host/dmtya.ru/">https://ransomwaretracker.abuse.ch/host/dmtya.ru/</a>&nbsp;</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><a href="https://otx.alienvault.com/indicator/ip/92.53.113.89/" _src="https://otx.alienvault.com/indicator/ip/92.53.113.89/">https://otx.alienvault.com/indicator/ip/92.53.113.89/</a>&nbsp;</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><a href="https://www.reddit.com/r/Malware/comments/4q4gg7/locky_ransomware_campaign_june_27th_2016/" _src="https://www.reddit.com/r/Malware/comments/4q4gg7/locky_ransomware_campaign_june_27th_2016/">https://www.reddit.com/r/Malware/comments/4q4gg7/locky_ransomware_campaign_june_27th_2016/</a>&nbsp;</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">几乎可以预见的事实是，一旦我们在与RIG有关的子网中（如图19所示）尝试抓取托管的域名时（根据图7的模式抓取子串），我们几乎难以找到指向RIG宿主页面的被注入的iframe页面。这可能意味着这类网站专门针对西方国家流量进行设计，特别是我们已经知道某些载荷使用了国家和语言白名单机制。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">第二个有趣的地方，我们发现这些基础设施中有大量SSL证书被重复使用，我们最开始认为这些可能都与RIG有关。然而，经过进一步调查，我们发现这些证书在许多ASN本土化域名中广泛存在（如图20所示）。根据这些发现，我们认为这些SSL证书与RIG没有关系，很有可能是托管服务商常用的证书。</span></p><p style="text-align:center"><img src="http://p8.qhimg.com/t01ef95da04b0198515.png" title="t01372e5255c60ec305.png" alt="http://p0.qhimg.com/t01372e5255c60ec305.png"/></p><p style="text-align:center"><img src="http://p3.qhimg.com/t01c1d9e23dce3f4016.png" title="t017917e3be91760357.png" alt="http://p5.qhimg.com/t017917e3be91760357.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图20. Shodan显示的证书信息</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">第三个有趣的地方，通过检查RIG宿主域名的Whois注册信息，我们发现GoDaddy是这些域名的主要注册商。2017年2月21日至4月10日期间，有多个域名注册商的395个不同的子域名为RIG宿主页面提供服务，Maltego的分析截图如图21所示。</span></p><p style="text-align:center"><img src="http://p5.qhimg.com/t014433e52ef087b693.png" title="t01f9b716823c596fcd.png" alt="http://p8.qhimg.com/t01f9b716823c596fcd.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图21. RIG宿主页面所依托的常用域名注册商</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">根据这些研究结果，我们对这些子域名所有者的登记邮箱进行了归类（最开始就过滤掉了一般性的注册邮箱，如abuse@形式的邮箱）。对这些注册邮箱进行分批处理后，我们成功识别出主要域名服务商的上千个影子域名。Maltego的分析结果如图22所示，从图中我们可知有18个GoDaddy用户注册了超过2200个子域名，这些子域名都与2017年3月25日至4月5日期间的RIG活动有关。我们认为这些账户都已被攻破。</span></p><p style="text-align:center"><img src="http://p6.qhimg.com/t01f17e7d06d6b678b2.png" title="t01b8ecd49f7eceb6c7.png" alt="http://p3.qhimg.com/t01b8ecd49f7eceb6c7.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图22. 被用于影子域名的账户信息</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">这些受影响账户所拥有的子域名似乎都在利用合法的GoDaddy域名来作为影子域名，并且当前域名所指向的RIG宿主页面都位于外国的网段中（如图19所示）。通过查询这些域名的DNS A记录值（即IPv4地址值），我们进一步确定了这个推断，如图23和图24所示（由centralops.net提供数据）：</span></p><p style="text-align:center"><img src="http://p9.qhimg.com/t010809a5c333a50283.png" title="t01883b6c58c643c0c7.png" alt="http://p4.qhimg.com/t01883b6c58c643c0c7.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图23. 某个影子域名的DNS记录示例</span></p><p style="text-align:center"><img src="http://p5.qhimg.com/t0121c6136b157915ec.png" title="t017956b078f159528d.png" alt="http://p2.qhimg.com/t017956b078f159528d.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图24. 2017年3月28日某个影子域名的DNS A记录信息</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">隐藏在RIG背后的攻击者在创建新的影子域名前，会定时清理并删除子域名以及DNS A记录信息。根据前期对影子域名DNS A记录值的分析，我们认为这些域名在被删除前有大概5-10天的使用寿命。话虽如此，我们认为，根据后端托管服务（如图19所示的ASN）的实际情况，这些影子域名实际上通常只有24-48小时的存活时长。我们可以从这个影子域名在2017年3月30日时的创建及删除信息中得出这个结论（如图25所示）。</span></p><p style="text-align:center"><img src="http://p9.qhimg.com/t015c1c8068d3f7d0c4.png" title="t0176a436d62cefc5be.png" alt="http://p2.qhimg.com/t0176a436d62cefc5be.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图25. 2017年3月30日某个影子域名DNS记录被清除</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">这种活动持续到4月及5月，如图26所示。</span></p><p style="text-align:center"><img src="http://p6.qhimg.com/t01279a592012b29a3d.png" title="t019a6c7cfe9e83b40c.png" alt="http://p4.qhimg.com/t019a6c7cfe9e83b40c.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图26. 2017年5月16日，RIG影子域名的DNS A记录</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">九、与GODADDY的合作</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">鉴于这个过程牵扯了很多在GoDaddy注册的域名，因此GoDaddy也作为我们的合作伙伴一起来调查影子域名基础设施。GoDaddy为我们提供了一个统一的视图，方便分析影子域名所涉及的DNS记录。经过GoDaddy的分析，他们提供了各种指标，可以用来识别攻击者所使用的策略、技术以及过程。根据这些指标梳理出的基础设施可以在进一步用来理解影子域名的相关问题。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">我们根据各种行为识别模式，对过去60天内的域名阴影攻击活动进行了分析。在这期间，RIG的阴影域名攻击活动主要使用一份固定的名单来生成子域名（如“red”、“admin”、“info”、“save”以及“new”）。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">RSA研究机构同样将GoDaddy DNS数据中的目的IP地址（如影子域名所指向的DNS A记录）与观察到的RIG后端网络（如图19所示）进行关联，结合对活动影子域名的沙箱化处理，我们进一步识别出了这些影子域名。5月初观察到的信息（如图27及图28所示）表明这些影子域名正作为RIG宿主页面所使用。这些域名接受当前RIG所用的URL模式，也会释放已知的.swf漏洞利用程序（示例样本的md5值为</span><a href="https://www.virustotal.com/en/file/c06ced000a6ed7e4f4e11251d1e4b6af18b47f9aebb57e9baf9b4d0fbe92c85d/analysis/" target="_self" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">dc7d6b8b623fdf82a8ba48195bd1bdbf</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">）。</span></p><p style="text-align:center"><img src="http://p9.qhimg.com/t0140ffb778e0134d18.png" title="t01389fa5f3e7c8824c.png" alt="http://p1.qhimg.com/t01389fa5f3e7c8824c.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图27. 对某个影子域名沙箱化处理伪装成RIG宿主页面</span></p><p style="text-align:center"><img src="http://p3.qhimg.com/t0137bf1221dda5b91e.png" title="t011511f9aa3d3c6797.png" alt="http://p5.qhimg.com/t011511f9aa3d3c6797.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图28. 对另一个影子域名沙箱化处理伪装成RIG宿主页面</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">此外，在本次调查中，我们进一步识别出了遵循其他模式的几个域名阴影活动。总的说来，域名阴影攻击影响了上百个客户，平均每个客户的DNS记录中被插入了150个影子域名。每天大约有450个新的影子域名的DNS被修改。发起记录修改请求的源大多为未知的客户端或TOR网络中的多个客户端。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">最为突出的影子域名由3-5个随机的字母数字字符所组成，如‘m47xh’、‘mv6’、‘eeiv’、‘l4pj2’、‘eiq0s’以及‘bthi’等。这几个域名占比最多，当前影子注册域名中大约有超过95%使用了这几个域名。我们在超过30,000个子域名中观察到了阴影域名攻击活动，总共影响了800多个域名。活跃状态的子域名处于不断变化中，每天平均有900条记录被添加、修改及删除。</span></p><p style="text-align:center"><img src="http://p9.qhimg.com/t015d44d0ab13136ae8.png" title="t0185302c4f4be6df76.png" alt="http://p1.qhimg.com/t0185302c4f4be6df76.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图29. 观察到的处于活跃状态的阴影域名攻击</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">我们对这类活动经过初步的OSINT分析后，结果表明这种模式可能与正在进行的恶意垃圾邮件以及恶意广告活动有关，这可能意味着范围更广的犯罪行为。这类活动如图30及31所示。</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t01a5f51b4622e84da1.png" title="t017dbdaa327cffc590.png" alt="http://p7.qhimg.com/t017dbdaa327cffc590.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图30. 使用影子域名的垃圾邮件活动</span></p><p style="text-align:center"><img src="http://p2.qhimg.com/t0194a14d3e7a8abe8e.png" title="t01dd44611870a08c2d.png" alt="http://p3.qhimg.com/t01dd44611870a08c2d.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图31. 使用Google查询其他影子域名</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">整体而言，我们识别出的影子域名指向了大约240不同的IP地址，覆盖超过20个不同的C类段。不幸的是，我们无法进一步分析目的地址，原因在于相关的托管服务商没有参与到我们的调查中。通过这类行为模式识别出的子域名正在被逐步关闭，如下文所述。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">十、以用户凭证为基础的生态系统</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">事实上，这类攻击活动严重依赖于所盗取的账户凭证，这一点很容易被察觉出来。然而，从上述讨论中，我们非常肯定RIG宿主页面几乎完全（即便没有全部）托管在被攻破域名的短期影子域名上，并且主要由东欧的ASN服务商来提供堡垒托管服务。问题来了，攻击者是如何窃取这些账户凭证的？</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">互联网上的信息窃贼已经横行多年，我们可能需要对某些攻击活动进行评估才能追踪溯源。我们尝试过将被窃取的这些凭证与过去几年的信息进行关联分析，却得到的负面的结果，这表明过去几年的犯罪活动可能并不是这次攻击行为的罪魁祸首，可能还存在其他肇事者。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">对影子域名本身而言，我们认为发起这些攻击活动的犯罪分子依靠非常复杂的网络钓鱼攻击来获取合法的账户凭证（如图32所示）。GoDaddy拥有1700万客户以及7100万个域名，这使得他们成为复杂钓鱼攻击的天然目标。GoDaddy不断倡导使用双因素认证（Two Factor Authentication，TFA）方式，并且与提供钓鱼页面的托管服务商一起积极合作，关闭提供恶意内容的这些站点。</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t013194b956902e4fa5.png" title="t01401cdd077faa2e48.png" alt="http://p9.qhimg.com/t01401cdd077faa2e48.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图32. 之前针对GoDaddy客户的钓鱼活动</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">对被攻破的站点而言（这些站点会通过被注入的iframe将流量导向GoDaddy影子域名），有多个域名注册商受到影响，表明攻击者使用了更多投机取巧的方法。虽然我们尚未了解攻击者通过什么方法获取这些凭证，但安全社区的</span><a href="https://www.bleepingcomputer.com/news/security/home-routers-used-to-hack-wordpress-sites/" target="_self" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">研究</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">表明有许多物联网僵尸节点被用来暴力破解WordPress站点。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">如果这些观察结果和猜测是正确的，那么我们也许需要从生态系统角度来思考分析RIG的操作模型，如图33所示。</span></p><p style="text-align:center"><img src="http://p6.qhimg.com/t01b345b952ccd9afd7.png" title="t014f086c2635ac4a89.png" alt="http://p5.qhimg.com/t014f086c2635ac4a89.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图33. 推测出的RIG生态系统</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">十一、补救措施</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">本文分析的影子域名已经从GoDaddy的DNS系统中删除。从历史上来看，域名阴影技术已经成为一个严峻的问题，因为这些域名很少被检查核实、数量众多并且处于合法域名的保护之下。GoDaddy与RSA一起合作，能够通过数据分析技术隔离并移除这些影子域名。已知的用于恶意目的IP地址也已被列入GoDaddy的DNS系统的黑名单中。此外，受影响的用户账户已被锁定，需要修改凭证以防被再次滥用。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">未来的工作重点是继续研发大规模的影子域名探测方法，进一步删除恶意DNS记录，并在域名数据修改流程中整合预防措施。如果这类方法在预防和破坏影子域名方面逐渐成熟，那么我们不会依赖点对点的补救措施，而会依托内部数据集，以自动化方式识别并移除恶意域名记录。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">这些技术的成功应用将最大限度地减少影子域名的检测时间以及修复时间，同时也会最大限度地减少影子域名的使用时长。我们也将对很可能受到域名阴影攻击的账户应用体系化的修复措施。这类技术将保证GoDaddy账户更加安全，降低域名阴影技术的攻击成功率。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">十二、影响及结论</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">在不是特别清楚攻击者活动的前提下，我们更加难以测量攻击活动所造成的影响。初步的分析表明，我们对RIG攻击活动仍然了解不足，特别是当前的Seamless家族以及十进制IP家族（如图34所示）。这类攻击活动造成的长期影响还有待GoDaddy以及RSA团队的联合评估。</span></p><p style="text-align:center"><img src="http://p9.qhimg.com/t01b386471303fe4ab3.png" title="t0121b1f88622e3a0f1.png" alt="http://p6.qhimg.com/t0121b1f88622e3a0f1.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图34. 尚不能识别十进制IP家族的RIG后端</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">如何确定不断发展的勒索软件、广告软件以及恶意邮件家族所造成的影响显然更具挑战性。我们所知道的是，在2017年5月16日，有成千上万个活跃的影子域名资源被删除，对活跃的网络犯罪行为有了一定程度的遏制。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">这篇报告对我们当前的研究和相关发现做了总结，我们希望未来能有更多研究机构联合起来，从犯罪生态系统这个更大的尺度上，共同参与对域名阴影技术攻击活动的分析研究。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">十三、附录A</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">PseudoDarkleech家族：Cerber勒索软件</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">SHA256： f7124736a95c472f4c98835786daccdbe751bbd0da4cb500fa0b35d7700d46ef</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">参考资料： <a href="http://www.malware-traffic-analysis.net/2017/02/27/index.html" _src="http://www.malware-traffic-analysis.net/2017/02/27/index.html">http://www.malware-traffic-analysis.net/2017/02/27/index.html</a>&nbsp;</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">恶意代码： <a href="https://panacea.threatgrid.com/samples/e55adbba88f8663369a1afea4f520c50" _src="https://panacea.threatgrid.com/samples/e55adbba88f8663369a1afea4f520c50">https://panacea.threatgrid.com/samples/e55adbba88f8663369a1afea4f520c50</a>&nbsp;</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">截图：</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t0166bcd00cd7c0be7a.png" title="t01746c517eac8d836e.png" alt="http://p7.qhimg.com/t01746c517eac8d836e.png"/></p><p style="text-align:center"><img src="http://p0.qhimg.com/t01cef9cb72bab8f1fd.png" title="t019cef8c1ceb086ee5.png" alt="http://p4.qhimg.com/t019cef8c1ceb086ee5.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">网络流量：</span></p><p style="text-align:center"><img src="http://p6.qhimg.com/t0142d44d61df00d19c.png" title="t012ee624fd3af71f68.png" alt="http://p0.qhimg.com/t012ee624fd3af71f68.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">十四、附录B</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">EITEST家族：Cryptoshield勒索软件</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">SHA256：1ceaccf925911b4da750321be0be31e0a8fe8220f75170725e74d3db7e828bcd</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">参考资料：<a href="http://pastebin.com/embed_iframe/y1TdBJH6" _src="http://pastebin.com/embed_iframe/y1TdBJH6">http://pastebin.com/embed_iframe/y1TdBJH6</a>&nbsp;</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">恶意代码：<a href="https://www.reverse.it/sample/1ceaccf925911b4da750321be0be31e0a8fe8220f75170725e74d3db7e828bcd?environmentId=100" _src="https://www.reverse.it/sample/1ceaccf925911b4da750321be0be31e0a8fe8220f75170725e74d3db7e828bcd?environmentId=100">https://www.reverse.it/sample/1ceaccf925911b4da750321be0be31e0a8fe8220f75170725e74d3db7e828bcd?environmentId=100</a>&nbsp;</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">截图：</span></p><p style="text-align:center"><img src="http://p9.qhimg.com/t0105f07c66e4b721bc.png" title="t0185ae2b28de015b6c.png" alt="http://p3.qhimg.com/t0185ae2b28de015b6c.png"/></p><p style="text-align:center"><img src="http://p8.qhimg.com/t016d3937ffc8b91ccb.png" title="t0124d0571f53aee916.png" alt="http://p3.qhimg.com/t0124d0571f53aee916.png"/></p><p style="text-align:center"><img src="http://p4.qhimg.com/t0149cfc93300beec12.png" title="t01363e309d485d153d.png" alt="http://p3.qhimg.com/t01363e309d485d153d.png"/></p><p style="text-align:center"><img src="http://p6.qhimg.com/t01eb6a1da01de171e6.png" title="t01a9ca751a930984ec.png" alt="http://p9.qhimg.com/t01a9ca751a930984ec.png"/></p><p style="text-align:center"><img src="http://p5.qhimg.com/t017301039dac9de00f.png" title="t018176e0759042092c.png" alt="http://p3.qhimg.com/t018176e0759042092c.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">网络流量：</span></p><p style="text-align: center;"><img src="http://p5.qhimg.com/t01d53d15db8697b4ba.png" title="t01b4e2f8d5b767fb1b.png" alt="http://p7.qhimg.com/t01b4e2f8d5b767fb1b.png"/></p></p>
                <hr/>
                <p style="text-align: center;">
                    <img src="http://bobao.360.cn/img/app.jpeg"/>
                    <img src="http://bobao.360.cn/img/weixin.jpeg"/>
                </p>
                                <p>本文由 安全客 翻译，转载请注明“转自安全客”，并附上链接。<br/><a class="text-more" href="https://blogs.rsa.com/shadowfall/" target="_blank">原文链接：https://blogs.rsa.com/shadowfall/</a></p>
                            </div>
            <div style="margin-top: 20px;background-color:#FFFFFF">
    <input type="hidden" id="detail_title" name="detail_title" value="【技术分享】ShadowFall：对域名阴影攻击活动的详细分析报告 - 安全客 - 有思想的安全新媒体" />
    <input type="hidden" id="use_nickname" name="use_nickname" value="0" />
    <a name="mao"></a>
    <div class="reg-log mobile-hiden">
        <div class="" id="userTo">   
            <div id="to-list" class="input-text" style="">
                <textarea disabled="disabled" class="hide"  id="comment-content" to="to"></textarea>
                <ul id="preadded" style="display:none">       
                </ul>
                <div id="to-auto" style="width: 200px">
                    <ul id="feed">
                    </ul>
                </div>
            </div>
        </div>
        <input type="hidden" id="source-id" value="3973" />
        <input type="hidden" id="source-type" value="learning" />
        <input type="hidden" id="post-comment-url" value="/comment/add" />
        <input type="hidden" id="post-nickname-url-ajax" value="/comment/randnicknameajax" />
        <input type="hidden" id="post-check-login-url-ajax" value="/comment/checklogin" />
        <input type="hidden" id="stoken_comment_set" value="ea3898fb4df38673fdeb61c458234054">                 <span class="join">参与讨论，请先 <a href="javascript:;" class="comment-login">登录</a> | <a href="javascript:;" class="comment-reg">注册</a> |  <a href="javascript:;" class="anonymous-comment">匿名评论</a></span>
            </div>
    <div class="mobile-hide" style="width: 870px; margin: 0 auto;">
        <label style="vertical-align:middle;" for="use_nickname">匿名</label> 
        <input style="vertical-align:middle;" id="trigger-nickname" name="use_nickname" class="use_nickname" type="checkbox" value="0" />

        <a href="javascript:;" class="apply-use button" id="submit-comment" data-target="/comment/add">发布</a>
    </div>


    <div class="clearfix"></div>
    <div class="comments">
        <div class="comments-head">
            <span class="title">用户评论</span>
        </div>
                <div class="comment-none alarm-info bg-primary">无任何评论</div>
            </div>
</div>
<script>
    $(function () {
        $('.anonymous-comment').click(function () {
            $(".join").hide();
            $(".reg-log textarea").first().removeAttr("disabled").show();
            $('#use_nickname').val('1');
//            $('#trigger-nickname').attr('checked', true);
            $('#trigger-nickname').trigger('click');
        });
        //为所有复选框绑定事件
//        checkbox_on_click();
        //ajax随机获取昵称
//        randnicknameajax(0);
        //ajax检测登录状态
        comment_check_login();
    });



    function input_checkbox(flag) {
        $('input:checkbox').each(function () {
            var value = flag ? 1 : 0;
            $(this).prop('checked', flag);
            $(this).val(value);
        });
    }

//ajax随机获取昵称
    function randnicknameajax(flag) {
        $.ajax({
            type: 'POST',
            url: $('#post-nickname-url-ajax').val(),
            data: {limit: 1, flag: flag},
            dataType: "json",
            success: function (data) {
                $('#nick-name').val(data.data[0]);
                _nick_name=data.data[0];
            }
        });
    }
    $();
//ajax检测登录状态
    function comment_check_login() {
        $.ajax({
            type: 'POST',
            url: $('#post-check-login-url-ajax').val(),
            data: {},
            dataType: "json",
            success: function (data) {
                if (data.success) {
                    $('.join').hide();
                    $(".reg-log textarea").first().removeAttr("disabled").show();
                    $("#span_use_nickname").show();
                    $('#use_nickname').val('0');
                    $('#use_nickname').attr('checked', false);
                }
            }
        });
    }
</script>        </div>
    </div>
    <div class="side-bar">
        <div class="mod hot-news">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-hot"></i><span>热门知识</span></h2>
    </div>
    <ul class="links-list">
                                <li><a href="/learning/detail/4411.html" alt="【漏洞预警】一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现——最新的Office高级威胁攻击预警" target="_blank">【漏洞预警】一个换行符引发的奥斯卡...</a></li>
                                <li><a href="/learning/detail/4416.html" alt="【漏洞预警】Microsoft .NET Framework漏洞（CVE–2017–8759）预警" target="_blank">【漏洞预警】Microsoft .NE...</a></li>
                                <li><a href="/learning/detail/4414.html" alt="【技术分享】妙用JavaScript绕过XSS过滤" target="_blank">【技术分享】妙用JavaScrip...</a></li>
                                <li><a href="/learning/detail/4418.html" alt="【技术分享】利用威胁情报数据平台拓展APT攻击线索一例" target="_blank">【技术分享】利用威胁情报数据平台拓...</a></li>
                                <li><a href="/learning/detail/4417.html" alt="【知识】9月15日 - 每日安全知识热点" target="_blank">【知识】9月15日 - 每日安全知识热...</a></li>
                                <li><a href="/learning/detail/4425.html" alt="【安全报告】XShellGhost事件技术回顾报告" target="_blank">【安全报告】XShellGhost事件...</a></li>
            </ul>
</div>        <!-- 友情链接 -->
        <div class="mod blog-links mobile-hide">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-link"></i><span>友情链接</span></h2>
        <a href="/links/index.html" class="more">更多<i></i></a>
    </div>
        <ul class="links-list">
                <li><a href="http://bbs.360safe.com" alt="360安全社区" target="_blank">360安全社区</a></li>
                <li><a href="http://zhuji.360.cn" alt="360主机卫士" target="_blank">360主机卫士</a></li>
                <li><a href="http://blogs.360.cn/" alt="奇虎360技术博客" target="_blank">奇虎360技术博客</a></li>
                <li><a href="http://wangzhan.360.cn/" alt="360网站卫士" target="_blank">360网站卫士</a></li>
                <li><a href="http://webscan.360.cn/" alt="360网站安全检测" target="_blank">360网站安全检测</a></li>
                <li><a href="http://research.360.cn/report/" alt="360研究报告" target="_blank">360研究报告</a></li>
                <li><a href="http://unicorn.360.cn/" alt="360 Unicorn Team" target="_blank">360 Unicorn Team</a></li>
                <li><a href="http://appscan.360.cn/" alt="360捉虫猎手" target="_blank">360捉虫猎手</a></li>
                <li><a href="https://threathunter.org/" alt="ThreatHunter社区" target="_blank">ThreatHunter社区</a></li>
                <li><a href="http://security.360.cn/" alt="360安全应急响应中心" target="_blank">360安全应急响应中心</a></li>
            </ul>
    </div>
        <!-- 联系我们 -->
        <div class="mod contact mobile-hide" style="text-align:center">
    <div class="head-bar clearfix">
        <h2><i></i><span>关注我们</span></h2>
    </div>
    <!-- 微信关注 -->
    <ul class="contact-way">
        <li><a>微信关注</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/qrcode_adlab_weixin.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
    <!-- APP下载 -->
    <ul class="contact-way">
        <li><a>安全播报APP</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/scan_code_big.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
</div>

    </div>
</div>

<script type="text/javascript" src="/js/jquery-ui.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/jquery.noty.packaged.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/common.js?v=4.5"></script>
<script>$(function() {sync_count('comment');});</script>


<!-- 语法高亮 -->
<script type="text/javascript" src="/ue/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">SyntaxHighlighter.all();sync_count('vul');sync_count('news');sync_count('learning');sync_count('activity');sync_count('course');sync_count('ctf');</script>
    </div>

        <div class="footer">
        <div class="friend-link">
            <a href="http://www.360.cn/" target="_blank">360首页</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">关于我们</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">联系我们</a>
            <span>|</span>
            <a href="/links/index.html" target="_blank">友情链接</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">招贤纳士</a>
        </div>
        <div class="copy">
            Copyright &copy; 360网络攻防实验室 All Rights Reserved <span class="copy_icp">京ICP证080047号[京ICP备08010314号-6]</span>
        </div>
    </div>
    
</div>

<!--奇舞团统计-->

<script src='https://s.ssl.qhimg.com/static/f5407c785655e6a1/monitor_analytic.js'></script>
<script>
    monitor.setProject('QH_171_1').getTrack().getClickAndKeydown().getClickHeatmap(10, 1);
</script>

<div class="hide">
    <script src="https://s95.cnzz.com/z_stat.php?id=1253147824&web_id=1253147824" language="JavaScript"></script>
</div>
<div class="backToTop_wrap off">
    <a id="back_to_top" class="backToTop" href="javascript:;" title="返回顶部"></a>
</div>
<script>
    var $backToTop_wrap = $(".backToTop_wrap"),
        $backToTop_btn = $("#back_to_top");

    if ($(window).scrollTop() > 100) {
        $backToTop_wrap.removeClass("off");
    }
    else {
        $backToTop_wrap.addClass("off");
    }

    $(window).on("scroll", function () {
        if ($(this).scrollTop() > 100) {
            $backToTop_wrap.removeClass("off");
        }
        else {
            $backToTop_wrap.addClass("off");
        }
    });

    $backToTop_btn.on("click", function () {
        $("html, body").animate({scrollTop: 0}, 120);
    });

    $(function () {
        var navlist = $('.nav-list > li');

        navlist.each(function () {
            $(this).on('mouseenter', function () {
                $(this).addClass('selected');
            });

            $(this).on('mouseleave', function () {
                $(this).removeClass('selected');
            });
        });
    })
</script>



</body>
</html>
