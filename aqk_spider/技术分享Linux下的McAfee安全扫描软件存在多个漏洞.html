<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:wb="http://open.weibo.com/wb" xml:lang="en" lang="en">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <link rel="shortcut icon" href="http://bobao.360.cn/favicon.ico?v=1.1"/>
    <link rel="alternate" title="安全资讯" href="/rss?type=news" type="application/rss+xml"/>
    <link rel="alternate" title="安全知识" href="/rss?type=learning" type="application/rss+xml"/>
    <link rel="alternate" title="安全圈活动" href="/rss?type=activity" type="application/rss+xml"/>
    <link rel="alternate" title="所有漏洞" href="/rss?type=vul" type="application/rss+xml"/>
    <link rel="alternate" title="通用型漏洞" href="/rss?type=commonvul" type="application/rss+xml"/>
    <link rel="alternate" title="事件型漏洞" href="/rss?type=eventvul" type="application/rss+xml"/>
    <link rel="alternate" title="热门漏洞" href="/rss?type=hotvul" type="application/rss+xml"/>

        <title>【技术分享】Linux下的McAfee安全扫描软件存在多个漏洞 - 安全客 - 有思想的安全新媒体</title>
    
        <meta name="keywords" content="McAfee,RCE攻击,Linux 系统,安全扫描软件,盗用root权限,盗用权限"/>
    
        <meta name="description" content="近期，有网络安全人员发现：Linux系统下的安全扫描软件McAfee中存在多个安全漏洞，黑客可利用其中一些漏洞盗用Linux系统的root权限，发动RCE攻击。"/>
        <meta property="wb:webmaster" content="224437c7be31d633"/>

    <script type="text/javascript" src="http://s7.qhimg.com/!56caa871/xpc_sync_height.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/reset.css" />
    <link rel="stylesheet" type="text/css" href="/css/common_new.css?v=4.4.2.1" />
    <link rel="stylesheet" type="text/css" href="/css/jquery.notyfy.css" />
    <link rel="stylesheet" type="text/css" href="/css/notyfy.theme.default.css" />
    <link rel="stylesheet" type="text/css" href="/css/s_common.css?v=2.2.7" media="only screen and
    (max-device-width:900px), only screen and (max-width:900px)" />
    <script type="text/javascript" src="/js/jquery.min.js?v=3.1"></script>
    <script type="text/javascript" src="/js/jquery.notyfy.js"></script>
    <script type="text/javascript" src="/js/iscroll.js"></script>
    <script src="http://js.passport.qihucdn.com/5.0.3.js"></script>
    <script type="text/javascript">
        var myScroll, myNavScroll;

        function iscrollLoaded() {
            myScroll = new IScroll('#wrapper',
                {
                    scrollX: true,
                    scrollY: false,
                    bounceEasing: 'circular',
                    eventPassthrough: true,
                    preventDefault: false,
                    bounceTime: 500
                }
            );
        }

        $(function () {

            //导航横向滚动


            function setNavWidth() {

                /* 计算导航宽度 */
                var allWidth = $(window).width();
                var scroller = $('#scroller');

                if (allWidth > 900) {
                    scroller.find('ul').add(scroller.find('.scroll')).removeAttr('style');
                    scroller.css('overflow', 'visible');
                    if (myNavScroll) myNavScroll.destroy();
                } else {

                    var width = 0;
                    scroller.find('.scroll').children('ul').children('li').each(function (index, el) {
                        if (!$(this).hasClass('mobile-hide')) {
                            width += $(this).outerWidth();
                        }
                    });
                    scroller.find('ul').add(scroller.find('.scroll')).width(width);

                    if (myNavScroll) myNavScroll.destroy();

                    myNavScroll = new IScroll('#scroller', {
                        scrollX: true,
                        scrollY: false,
                        momentum: false,
                        click: true
                    });

                }

            }

            setNavWidth();
            $(window).resize(function (event) {
                setNavWidth();
            });

        });

    </script>
</head>
<body onload="iscrollLoaded();">
<div style='margin:0 auto;width:0px;height:0px;overflow:hidden;'>
    <img src=""/>
</div>

<div id="is-mobile"></div>
<div class="container">
        <div class="mobile-header">
        <div class="header clearfix">
            <div class="header-wrapper clearfix">
                <a href="/index/index" class="logo"><img class="slogan" src="/img/logo.png?v=1.5"/></a>
                                <form id="search" class="search-box" action="/search/index" method="GET">
                    <input class="keys" name="keywords" type="text" placeholder="搜索漏洞" required="required">
                    <input class="icon" type="submit" value="">
                    <input type="hidden" name="type" value=""/>
                </form>
                <div class="bug">
                    <div class="name"><span class="seled">全部</span><i class="arrow"></i></div>
                    <ul class="typelist">
                        <li data-index="3"><a href="javascript:void(0);">全部</a></li>
                        <li data-index="0"><a href="javascript:void(0);">漏洞</a></li>
                        <li data-index="1"><a href="javascript:void(0);">资讯</a></li>
                        <li data-index="2"><a href="javascript:void(0);">知识</a></li>
                    </ul>
                </div>
                                <div class="logNreg mobile-hide">
                    <div class="unlog">
                        <i></i>
                        <a href="log.html" class="log">登录</a>
                        <span>|</span>
                        <a href="reg.html" class="reg">注册</a>
                    </div>
                    <div class="loged">
                        <a href="/member/profile" class="user-center"><i></i><span class="user-name-tag">个人中心</span></a>
                        <div class="user-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting"><a href="http://i.360.cn/profile/accountmanage"
                                                               target="_blank"><i></i><span>账号设置</span></a></li>
                                <li class="alert-setting"><a href="/keywords/index"
                                                             target="_blank"><i></i><span>告警设置</span></a></li>
                                <li class="bug-alert"><a href="/myalarm/index" target="_blank"><i></i><span>漏洞告警</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mylearn/index" target="_blank"><i></i><span>我的知识</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mycourse/index" target="_blank"><i></i><span>我的课堂</span></a>
                                </li>
                                <li class="my-exit"><a
                                            href="http://login.360.cn/?src=pcw_adlab&op=logout&destUrl=http://bobao.360.cn"><i></i><span>退出系统</span></a>
                                </li>
                            </ul>
                        </div>

                        <a href="/message" class="message-center" target="_blank"><i></i><span>我的消息</span></a>
                        <div class="message-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting" style="display:none;"><a href="/myres/index"
                                                                                     target="_blank"><i></i><span>回复我的</span></a>
                                </li>
                                <li class="my-bug"><a href="/myvul/index"
                                                      target="_blank"><i></i><span>我的漏洞</span></a></li>
                                <!--<li class="my-bug"><a href="/myres/index" target="_blank"><i></i><span>我的评论</span></a></li>-->
                                <!--<li class="alert-setting"><a href="###" target="_blank"><i></i><span>提到我的</span></a>
                                </li>-->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <style type="text/css">
            .nav {
                overflow: hidden;
            }

            .nav .scroll {
                width: auto;
            }
        </style>
        <div id="wrapper">
            <div id="scroller" class="nav">
                <div class="scroll">
                    <ul class="nav-list">
                        <li ><a class="link-nav"
                                                                                 href="/index/index">首页</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/vul/index">漏洞</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/introduce/list">招聘</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/news/index">资讯</a><!--<i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/introduce/list">招聘</a></li>
                        </ul>
			-->
                        </li>
                        <li class="cur">
                        <a class="link-nav" href="/learning/index">知识</a><i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/course/index">学院</a></li>
                        </ul>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/activity/index">活动</a></li>
                        <li class="mobile-hide "><a class="link-nav"
                                                                                                   href="/ctf/index">CTF训练营</a>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/interref/list">安全内参</a></li>
                        <li ><a class="link-nav" href="/app/index">APP</a></li>

                        <!--<li ><a href="/course/index">学院</a></li>-->
                        <!--<li ><a href="/introduce/list">招聘</a></li>-->
                        <!--<li  class="mobile-hide"><a href="/ctf/index">CTF训练营</a></li>-->
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="mobile-content">
        <link rel="stylesheet" type="text/css" href="/css/news.css?v=3.5" />
<link rel="stylesheet" type="text/css" href="/ue/SyntaxHighlighter/shCoreDefault.css?v=1.0" />
<style>
    p .syntaxhighlighter {
        width: 80%;
    }
</style>

<div class="cur-pos w1000">当前位置：<a href="http://bobao.360.cn/">安全客</a> &gt;&gt; 知识详情</div>

<div class="content clearfix">
    <div class="main">
        <div class="article">
            <div id="article_box">
                <h2>【技术分享】Linux下的McAfee安全扫描软件存在多个漏洞</h2>
                <div class="article-msg">
                    <span class="time">2016-12-14 10:44:05</span>
                    
                                        <span class="read">阅读：11488次</span>
                    <span><a style="display: none;" class="good" href="javascript:;"
                             data-target="/learning/good" data-value="g_3289"
                             data-type="learning">点赞(0)</a></span>
                    <span><a class="fav" href="javascript:;" data-target="/mylearning/add"
                             data-pk="3289" data-type="learning">收藏</a></span>
                                        <span><a style="margin-left: 4px;" class="fav" href="http://nation.state.actor/mcafee.html#vuln7"
                             target="_blank">来源： nation.state.actor</a></span>
                    
                    
                    <div style="margin-top:10px; ">
                        <a href="/member/contribute?uid=2606886003" style="color:#848e99;">
                            <img src="http://p1.qhmsg.com/dm/150_150_100/t016458bfee0c6f1be9.jpg" data-is-avatar="true"
                                 style="border: 1px solid #d5d5d5;padding: 2px; width: 80px;height: 80px;border-radius: 43px;"/>
                        </a>

                    </div>
                    <span class="orig">作者：<a href="/member/contribute?uid=2606886003" style="color:#848e99;">ResoLutiOn</a></span>
                                    </div>
                <hr size="1">
                <div class="article-msg">
                    <p><!-- JiaThis Button BEGIN -->

<!--
<span class="jiathis_style"><span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_tsina"></a>
    <a class="jiathis_button_tqq"></a>
    <a class="jiathis_button_qzone"></a>
    <a class="jiathis_button_renren"></a>
    <a class="jiathis_button_xiaoyou"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
</span>

-->
</p>
                </div>
                <p><p style="white-space: normal; text-align: center;"><img src="http://p3.qhimg.com/t011500d460ff9e4696.png" title="t0111e89ae96b9383ef.png" alt="t0111e89ae96b9383ef.png" width="600" height="480" border="0" vspace="0" style="width: 600px; height: 480px;"/></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px;"></span></p><p style="margin: 0px 25px 8px; padding: 0px; color: rgb(70, 79, 85); line-height: 25px; text-indent: 2em; font-family: Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, 微软雅黑, serif; white-space: normal; word-break: break-all; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px; font-weight: 900;">翻译：</span><a style="text-decoration: none;" href="http://bobao.360.cn/member/contribute?uid=2606886003" target="_blank"><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px; font-weight: 900;">ResoLutiOn </span></a></p><p style="margin: 0px 25px 8px; padding: 0px; color: rgb(70, 79, 85); line-height: 25px; text-indent: 2em; font-family: Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, 微软雅黑, serif; white-space: normal; word-break: break-all; background-color: rgb(255, 255, 255);"><span style="font-weight: 900;"><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;">预估稿费：260RMB（不服你也来投稿啊！）</span></span></p><p style="margin: 0px 25px 8px; padding: 0px; color: rgb(70, 79, 85); line-height: 25px; text-indent: 2em; font-family: Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, 微软雅黑, serif; white-space: normal; word-break: break-all; background-color: rgb(255, 255, 255);"><span style="font-weight: 900;"><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;">投稿方式：发送邮件至linwei#360.cn，或登陆网页版在线投稿</span></span></p><p style="white-space: normal; text-indent: 2em;"><br/></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px;"><strong>事件综述</strong></span></p><hr/><p style="white-space: normal; text-indent: 2em;"><span style="text-indent: 2em; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">近期，有网络安全人员发现：Linux系统下的安全扫描软件McAfee</span><span style="text-indent: 2em; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">中存在多个安全漏洞【软件传送门：<a href="http://www.mcafee.com/us/products/virusscan-enterprise-for-linux.aspx"><span style="font-family: 宋体; color: rgb(0, 0, 0);">（</span><span style="color: rgb(0, 0, 0);">McAfee for Linux</span><span style="font-family: 宋体; color: rgb(0, 0, 0);">）</span></a>】，黑客可利用其中一些漏洞盗用Linux系统的root权限，发动RCE攻击。</span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><strong><br/></strong></span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px;"><strong>关于McAfee</strong><strong>软件的情况介绍</strong></span></p><hr/><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">McAfee VirusScan Enterprise for Linux,一款利用Linux独特访问扫描程序，对系统进行实时防护的安全检测软件，由Intel旗下的子公司McAfee推出。该软件适用于使用Linux系统的企业用户。它能够检测隐藏在存档文件中的Linux病毒并予以阻止；阻止Microsoft Windows恶意软件，防止其通过Linux环境传播；同时还能借助来自McAfee Labs的自动安全更新，确保始终提供最新的Linux病毒防护。由此可见，McAfee VirusScan Enterprise for Linux的功能可谓十分强大。</span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">起初，在很多安全专家看来，这款安全防护软件似乎是“尽善尽美”，它近乎拥有了漏洞研究人员所期待的所有优点，例如：它能够利用系统root权限，这便能够保证用户PC的安全；但在最近一段时间里，McAfee似乎有点淡出人们视野的味道，原因在于在很长一段时间里，McAfee公司已没有对其进行更新了。当发现这些情况时，我决定要细致地了解有关该软件的具体情况。</span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><strong><br/></strong></span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px;"><strong>受到漏洞影响的McAfee</strong><strong>版本</strong></span></p><hr/><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">安全研究人员证实：从McAfee 1.9.2版本（于2015年2月19日发布）到2.0.2版本（于2016年4月22日发布），都存在多个相同的安全漏洞。它们之间唯一的差别便是：在漏洞利用方面，新版本要比旧版本更容易实施，也即是说：近期的McAfee软件的安全性下降了很多，更容易遭到黑客利用。</span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><strong><br/></strong></span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px;"><strong>漏洞报告时间轴</strong></span></p><hr/><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">1.2016年6月23日：安全人员将漏洞的相关情况向McAfee公司的安全应急响应中心（CERT）做了汇报；McAfee公司定于2016年8月23日向公众披露漏洞的具体细节。</span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">2.2016年7月19日：McAfee公司发表声明称： 鉴于关于漏洞的细节仍在不断更新中，他们决定将发布公告的时间延期至9月，最晚可至12月；</span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">3.2016年9月-11月期间：安全人员未与McAfee公司取得联系；</span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">4.2016年12月5日：McAfee公司发布消息称：公司将于12月12日发布关于McAfee软件漏洞的完整报告；</span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">5.2016年12月9日：McAfee公司发表安全公告，定义了漏洞的数字ID；</span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">6.2016年12月12日：完整的McAfee漏洞报告披露。</span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><strong><br/></strong></span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px;"><strong>McAfee</strong><strong>软件系统结构</strong></span></p><hr/><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">在深入探究McAfee软件漏洞的具体情况之前，我认为有必要先了解有关的软件结构，磨刀不误砍柴工，这将会对之后的漏洞研究有着一定的帮助。</span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><strong>（1</strong><strong>）软件所提供的服务：</strong></span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">McAfee VirusScan Enterprise for Linux可向用户提供两种单独的服务：一是用户能够以系统root权限运行该软件；二是还可以一种名为“nails”的非特权用户的身份运行该软件。具体说来，用户可用root权限使用该软件的主要扫描功能，它能够侦听一个本地的Unix网络套接字包（</span><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">/var/opt/NAI/LinuxShield/dev/nails_monitor）。</span><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">而网络服务器则可以用nails用户身份来运行，它能够侦听端</span><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">口0.0.0:55443发出的数据包。</span></p><p style="white-space: normal; text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">（2）实现进程间的通信</span></strong></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">在该软件的架构中，网络服务器是设置在扫描服务上的一个用户交互界面。当用户向网络服务器提交了一个请求时，该请求会被重新格式化，以另一种形式发送给root扫描程序；系统将会在一个HTML界面中显示该用户提交的请求及其相关信息。由于在交互过程中，web服务器不会对用户传递的数据做出太多的限制，这便给黑客利用该漏洞，向系统注入恶意代码提供了可趁之机。</span></p><p style="white-space: normal; text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">10个具体的McAfee漏洞：</span></strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><strong><span style="background: rgb(249, 242, 244);"></span></strong><strong><span style="background: rgb(249, 242, 244);"></span></strong></span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">接下来，我将为大家具体介绍10个McAfee VirusScan Enterprise for Linux软件中存在的漏洞。</span></p><p style="white-space: normal; text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">No.1&nbsp; CVE-2016-8016:未经验证的远程文件存在性校验漏洞</span></strong></p><p style="white-space: normal; text-align: center;"><img src="http://p3.qhimg.com/t01739042f396cf4d9f.png" title="t01b6818492d28fc4f6.png" alt="http://p4.qhimg.com/t01b6818492d28fc4f6.png"/></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">当我们在浏览网页的编译代码时，即会发现该html文件的存放路径是由tpIt参数来决定。在上图中，该tpIt参数是放置在tasks.html文件中。而运行在web服务器上的Linux Strace工具会显示：可打</span><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">开/opt/NAI/LinuxShield/apache/htdocs/0409/tasks.html文件，如下所示：</span></p><p style="white-space: normal; text-align: center;"><img src="http://p2.qhimg.com/t01a45de5b3537424a6.png" title="t01c6ad4f32fa42bc65.png" alt="http://p4.qhimg.com/t01c6ad4f32fa42bc65.png"/></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(51, 51, 51); background: rgb(255, 255, 255);">在编译时，如果将tpIt参数放置在地址为..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd（该字符串经过URL加密处理）的不同的页面中，那么编译过程就会出错，系统会返回一个格式错误的页面，并附有错误返回值14。而JavaScript语言中的lookupErrorCode功能函数会根据错误返回值14，向用户发送“web模块使用错误”的提示语句。若将tpIt参数放置在一个不存在的系统路径中，那么错误返回值将变为10，错误提示语句为“系统无法打开该文件”</span><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><span style="color: rgb(51, 51, 51); background: rgb(255, 255, 255);">。如下图所示：</span></span></p><p style="white-space: normal; text-align: center;"><img src="http://p3.qhimg.com/t018ae19c62ae1f8e04.png" title="t01be454ec16abc5f66.png" alt="http://p3.qhimg.com/t01be454ec16abc5f66.png" width="324" height="93" style="width: 324px; height: 93px;"/></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><span style="font-family: Calibri, sans-serif; color: rgb(51, 51, 51); background: rgb(255, 255, 255);"></span></span></p><p style="white-space: normal; text-align: center;"><img src="http://p0.qhimg.com/t014b39b4e9be62d637.png" title="t0190383181dcc35ce1.png" alt="http://p0.qhimg.com/t0190383181dcc35ce1.png"/></p><p style="white-space: normal; text-indent: 2em;"><span style="color: rgb(51, 51, 51); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em; background-color: rgb(255, 255, 255);">若系统中有类似的，已被命名的文件存在，那么系统会向未经授权的用户提示这两种错误编译消息。</span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><span style="color: rgb(51, 51, 51); background: rgb(255, 255, 255);">那么问题来了，有效的网页编译文件（例如：tasks.html）和无效网页编译文件（例如：</span><em><span style="color: rgb(51, 51, 51); background: rgb(255, 255, 255);">..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd</span></em><span style="color: rgb(51, 51, 51); background: rgb(255, 255, 255);">）之间的区别是什么呢？</span></span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">我将会继续深入探究这一问题。</span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><strong>No.2&nbsp; CVE-2016-8017:</strong><strong>非法读取未经授权的远程文件（含有约束条件）</strong></span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(51, 51, 51); background: rgb(255, 255, 255);">经过查看web服务器所使用的不同类型文件，我发现在有效编译文件的任何两个语句之间要么含有__REPLACE_THIS__字符串，要么含有【% %】标识符。</span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(51, 51, 51); background: rgb(255, 255, 255);">如果攻击者能够将以上的语句添加到系统的任何一个文件中（其中包括系统日志文件），那么他便可以通过web服务器进行远程读取文件。对于该漏洞的防护措施之一便是，对用户的身份进行严格限制：只允许具有nails身份的用户读取系统中的文件。</span></p><p style="white-space: normal; text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(51, 51, 51); background: rgb(255, 255, 255);">No.3&nbsp; CVE-2016-8018:软件中不含CSRF（跨站请求伪造）令牌验证机制</span></strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><strong><span style="background: rgb(249, 242, 244);"></span></strong><strong><span style="background: rgb(249, 242, 244);"></span></strong></span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">由于在软件的网页交互界面中，不含有防止CSRF攻击的令牌认证功能，这便使得黑客在通过了系统的身份验证后，可以随意地向系统提交认证请求，发动CSRF攻击。现在，看到一个安全软件竟然存在这样一个高危漏洞，令我着实感到很惊讶。利用CSRF令牌保护缺失而发动攻击，这只是黑客实施远程攻击的手段之一。</span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><strong>No.4&nbsp; CVE-2016-8019:</strong><strong>跨站脚本攻击</strong></span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">当将tpIt参数设置为指向NailsConfig.html文件或Monitor.html文件时，info：7和info：5这两个参数值将会替换用户的不可信输入，并将结果返回给JavaScript的formatData函数。info：7代表的是一个执行语句的清单，其中可能包含：single，show，serverUtcOffset=-25200等语句值。之后，系统会将其放入一个由单引号引导的字符串语句中，传递给formatData函数。若info:7被用来指向形如single’.prototype.constructor=eval（&#39;alert(“xss”)’）的语句时，eval函数将在formatData函数被调用之前，便会按照函数的功能，计算字符串中恶意代码的值。</span></p><p style="white-space: normal; text-align: center;"><img src="http://p2.qhimg.com/t016245073f051bca6c.png" title="t010e3bbb88be01f5f1.png" alt="http://p1.qhimg.com/t010e3bbb88be01f5f1.png"/></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">之后，经过修改数据包中的信息，系统会向用户发出一条关于XSS攻击的消息，如下所示：</span></p><p style="white-space: normal; text-align: center;"><img src="http://p5.qhimg.com/t01fd7205e15d5dcb8f.png" title="t01ceefc29cf0145a0d.png" alt="http://p4.qhimg.com/t01ceefc29cf0145a0d.png"/></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><strong>No.5 CVE-2016-8020:</strong><strong>远程代码执行及提权漏洞</strong></span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">在进行扫描系统之前，用户需要填写一个4页的表格：</span></p><p style="white-space: normal; text-align: center;"><img src="http://p5.qhimg.com/t012ca7a138e4f1c55c.png" title="t01111882d769925ea2.png" alt="http://p4.qhimg.com/t01111882d769925ea2.png"/></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">在表格提交之后，系统会向web服务器提交一个请求。下图展示的是整个过程中使用到的部分参数：</span></p><p style="white-space: normal; text-align: center;"><img src="http://p4.qhimg.com/t01899bf70f5d7da004.png" title="t016d3b07ca0171aae8.png" alt="http://p5.qhimg.com/t016d3b07ca0171aae8.png"/></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">nailsd.profile.ODS_9.scannerPath变量所包含的文件路径，也即是系统进行扫描操作的执行路径。若将路径修改为：/bin/sh，则在网页界面中会出现以下的错误结果：</span></p><p style="white-space: normal; text-align: center;"><img src="http://p2.qhimg.com/t01f2f0815b10959568.png" title="t01f9cb308e4c65ae89.png" alt="http://p5.qhimg.com/t01f9cb308e4c65ae89.png"/></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Strace工具将会给出信息，表明系统会通过一个以root权限运行的进程，将该参数传递给一个execve文件（可执行文件）。</span></p><p style="white-space: normal; text-align: center;"><img src="http://p3.qhimg.com/t01706b38d7f4059d5b.png" title="t01e281e4ff5c30ec30.png" alt="http://p8.qhimg.com/t01e281e4ff5c30ec30.png"/></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><strong>No.6&nbsp; CVE-2016-8021:</strong><strong>利用</strong><strong>web</strong><strong>界面，可向已知地址写入任意文件</strong></span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">用户可通过web界面指定使用一台网络服务器，并从该服务器上获取有关的更新信息。自从我决定要找到一种能够帮助用户远程向系统内写入文件的方法之后，我便意识到前面提到的那个特点会对我有所帮助。</span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">为了查明更新服务器是如何运作的，我先是备份了本地的资源库，之后从我的服务器上下载了新的资源库，重新配置新的服务器。以此来探究服务器的运作过程。</span></p><p style="white-space: normal; text-align: center;"><img src="http://p9.qhimg.com/t01bb3909729494eced.png" title="t0168dc4a0364dbee40.png" alt="http://p1.qhimg.com/t0168dc4a0364dbee40.png" width="816" height="183" style="width: 816px; height: 183px;"/></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">系统日志文件记录了更新进程所完成的操作，包括：下载一个更新程序包、验证其完成性、解压以及安装等。</span></p><p style="white-space: normal; text-align: center;"><img src="http://p8.qhimg.com/t01c61103a7627fca6a.png" title="t01b38912f1a25ec3a7.png" alt="http://p4.qhimg.com/t01b38912f1a25ec3a7.png"/></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">生成一个shell脚本其实很简单，但这需要花费一定的时间来进行下载，而且必须在一个网络数据包开始发送之前就要完成。这里有一个替代的方法，即为创建一个带有需求数据包的脚本程序，并在其中加入描述信息，就能够实现与shell脚本相同的功能。</span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">结合CVE-2016-8020（漏洞5）和CVE-2016-8021（漏洞6），我们就能够实现提升用户的系统权限（从nails变为root）。使用CSRF或XSS攻击方式，我们便可以实现远程提权。</span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><strong>No.7&nbsp; CVE-2016-8022</strong><strong>：远程利用身份验证令牌</strong></span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">在一次尝试利用一个XSS漏洞和CSRF漏洞的过程中，我将一个简易的cookie工具和从一名授权用户的系统中“拿到”的cookie融合在一起，作为测试工具来使用。但当我准备试着利用我的PC发起“攻击”时，发现我的身份验证失败了：</span></p><p style="white-space: normal; text-align: center;"><img src="http://p4.qhimg.com/t01cbec84ded0674597.png" title="t01353caee65b61e645.png" alt="http://p4.qhimg.com/t01353caee65b61e645.png"/></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">我还尝试着写出了一个脚本程序，它能够重设在数据通信过程中的阻断和拦截程序。</span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">接下来的两张图能够告诉我们有效请求和无效请求之间的区别：</span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">有效请求：</span></p><p style="white-space: normal; text-align: center;"><img src="http://p7.qhimg.com/t01054e3b1b9bbb43b7.png" title="t0194b60c72b25c3900.png" alt="http://p6.qhimg.com/t0194b60c72b25c3900.png"/></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">无效请求</span></p><p style="white-space: normal; text-align: center;"><img src="http://p3.qhimg.com/t01c48ff1bc305d03c2.png" title="t01adff403a77e73f5f.png" alt="http://p2.qhimg.com/t01adff403a77e73f5f.png"/></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">这看起来似乎有点奇怪：当用户向服务器提交了一个系统已授权的请求时，web服务器就会发送该台PC的IP地址（cookie除外）。虽然这种方式有点不寻常，但能够保证通信的安全。</span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><strong>No.8&nbsp; CVE-2016-8023</strong><strong>：暴力破解身份验证令牌</strong></span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">鉴于之前逻辑解析测试的失败，我更想要探究其他的cookie是如何进行逻辑确认测试的。</span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">下面给出的是nailsSessionId cookie的取值情况。它们是在用户进行登录和注销操作的过程中产生的，仅限于nails身份用户。</span></p><p style="white-space: normal; text-align: center;"><img src="http://p2.qhimg.com/t01d1da1cdc870afc2e.png" title="t01014cee2a851ad212.png" alt="http://p8.qhimg.com/t01014cee2a851ad212.png"/></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">而在常规的登录过程中，似乎仅有两部分的cookie的情况发生了改变。Cookie的格式为：</span></p><p style="white-space: normal; text-align: center;"><img src="http://p5.qhimg.com/t010480510ef93286c4.png" title="t015d07913ba112a901.png" alt="http://p6.qhimg.com/t015d07913ba112a901.png"/></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">相关变量的参数为：</span></p><p style="white-space: normal; text-align: center;"><img src="http://p1.qhimg.com/t01a3b2d3e4cbb26783.png" title="t012f5b1a305c4f62dc.png" alt="http://p8.qhimg.com/t012f5b1a305c4f62dc.png"/></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><strong>No.9&nbsp; CVE-2016-8024</strong><strong>：</strong><strong>HTTP</strong><strong>响应拆分攻击</strong></span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">用户可通过点击“系统事件”界面上的导出按钮，以此来导出记录系统日志数据的CSV文件。</span></p><p style="white-space: normal; text-align: center;"><img src="http://p8.qhimg.com/t0180aaa3b4fa535c83.png" title="t01e39de8568732418e.png" alt="http://p4.qhimg.com/t01e39de8568732418e.png"/></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">当用户发送请求之后，参数info的值会被置为%3A0。一般情况下，</span><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">该参数的值为multi%2Capplication%2Fvnd.ms-excel。之后，服务器会给系统发送一个名为Content-Type: application/vnd.ms-excel的标头文件（Header）作为响应。攻击者可通过简单地url加密处理标头文件的方式，创建一个藏有恶意标头文件的链接。</span></p><p style="white-space: normal; text-align: center;"><img src="http://p5.qhimg.com/t017353329f41945f6e.png" title="t01be474d130ec18236.png" alt="http://p8.qhimg.com/t01be474d130ec18236.png" width="729" height="130" style="width: 729px; height: 130px;"/></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><span style="font-family: Consolas; background: rgb(249, 242, 244);"></span></span></p><p style="white-space: normal; text-align: center;"><img src="http://p4.qhimg.com/t01dcd09f396dc73da7.png" title="t01e2c000e724ed11f0.png" alt="http://p1.qhimg.com/t01e2c000e724ed11f0.png" width="591" height="431" style="width: 591px; height: 431px;"/></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><span style="font-family: Consolas; background: rgb(249, 242, 244);"></span></span><br/></p><p style="white-space: normal; text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">No.10&nbsp; CVE-2016-8025:验证性SQL注入攻击</span></strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><strong><span style="background: rgb(249, 242, 244);"></span></strong><strong><span style="background: rgb(249, 242, 244);"></span></strong></span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">我在实验中所使用的数据库是SQLite轻型数据库，用来保存相关的设置数据和扫描数据。经过观察我发现，该数据库的安全性较弱，黑客可在该数据库的每一个接口处实施SQL代码注入攻击。这款数据库能够将URL参数转换为SQLite命令语句。使用我在第九号漏洞介绍中提到的CSV导出方法，我们可通过点击一个URL的方式，丢弃CSV文件中的sqlite_master标签。而SQLite中的查询</span><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">函数select * from sqlite_master;则是被嵌入到了一个URL中。（URL:</span><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><span style="background: rgb(249, 242, 244);"><a href="http://nation.state.actor/mcafee.html" style="color: rgb(0, 0, 0); background: rgb(255, 255, 255);">localhost:55443/0409/nails?pg=proxy&amp;tplt=-&amp;addr=127.0.0.1%3A65443&amp;mon%3A0=db+select+_show%3D%24*++_output%3Dcsv+_table%3Dsqlite_master+&amp;info%3A0=multi%2Capplication%2Fvnd.ms-excel</a><span style="font-family: 宋体; background: rgb(255, 255, 255);">.</span></span></span><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">）</span></p><p style="white-space: normal; text-align: center;"><img src="http://p6.qhimg.com/t01aeacc73514d8121d.png" title="t01646c5540fe129251.png" alt="http://p9.qhimg.com/t01646c5540fe129251.png" width="740" height="537" style="width: 740px; height: 537px;"/></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">该数据库不用于身份验证，而是用于追踪被扫描过的文件以及系统事件日志。在了解了系统相关的漏洞情况之后，攻击者便可以通过SQL注入攻击来修改系统事件日志，以清除他们在</span><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">系统中留下的文件追踪记录。</span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">该数据库的模型如下所示：</span></p><p style="white-space: normal; text-align: center;"><img src="http://p7.qhimg.com/t01304f3cab694d73a7.png" title="t01549d19a468ce62f2.png" alt="http://p7.qhimg.com/t01549d19a468ce62f2.png" width="740" height="445" style="width: 740px; height: 445px;"/></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><span style="font-family: Consolas; background: rgb(249, 242, 244);"></span></span></p><p style="white-space: normal; text-align: center;"><img src="http://p8.qhimg.com/t01e3dc9ce0c041770e.png" title="t0197c0bd46d15c9440.png" alt="http://p3.qhimg.com/t0197c0bd46d15c9440.png" width="676" height="358" style="width: 676px; height: 358px;"/></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><span style="font-family: Consolas; background: rgb(249, 242, 244);"></span></span><br/></p><p style="white-space: normal; text-align: center;"><img src="http://p1.qhimg.com/t01d9a6ebf4f1fa6efb.png" title="t019a8a9d194e600a9b.png" alt="http://p3.qhimg.com/t019a8a9d194e600a9b.png" width="683" height="178" style="width: 683px; height: 178px;"/></p><p style="white-space: normal; text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px;"><br/></span></strong></p><p style="white-space: normal; text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px;">总结</span></strong></p><hr/><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">黑客若将以上所有漏洞均加以利用，便能在Linux系统中以root权限执行RCE攻击，具体如下：</span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><span style="text-indent: 2em;">1.<span style="font-size: 9px;">&nbsp;</span></span><span style="text-indent: 2em;">利用</span><span style="text-indent: 2em;">CVE-2016-8022</span><span style="text-indent: 2em;">（漏洞</span><span style="text-indent: 2em;">7</span><span style="text-indent: 2em;">）和</span><span style="text-indent: 2em;">CVE-2016-8023</span><span style="text-indent: 2em;">（漏洞</span><span style="text-indent: 2em;">8</span><span style="text-indent: 2em;">），可暴力破解身份验证令牌。</span></span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><span style="text-indent: 2em;">2.<span style="font-size: 9px;">&nbsp;</span></span><span style="text-indent: 2em;">可运行被恶意代码感染的更新服务器。</span></span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><span style="text-indent: 2em;">3.<span style="font-size: 9px;">&nbsp;</span></span><span style="text-indent: 2em;">利用</span><span style="text-indent: 2em;">CVE-2016-8022</span><span style="text-indent: 2em;">（漏洞</span><span style="text-indent: 2em;">7</span><span style="text-indent: 2em;">），可向服务器发送带有验证令牌的请求，要求服务器自动更新数据。</span></span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><span style="text-indent: 2em;">4.<span style="font-size: 9px;">&nbsp;</span></span><span style="text-indent: 2em;">利用</span><span style="text-indent: 2em;">CVE-2016-8021</span><span style="text-indent: 2em;">（漏洞</span><span style="text-indent: 2em;">6</span><span style="text-indent: 2em;">），可迫使目标</span><span style="text-indent: 2em;">PC</span><span style="text-indent: 2em;">自动创建恶意脚本。</span></span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><span style="text-indent: 2em;">5.<span style="font-size: 9px;">&nbsp;</span></span><span style="text-indent: 2em;">利用</span><span style="text-indent: 2em;">CVE-2016-8020</span><span style="text-indent: 2em;">（漏洞</span><span style="text-indent: 2em;">5</span><span style="text-indent: 2em;">）和</span><span style="text-indent: 2em;">CVE-2016-8021</span><span style="text-indent: 2em;">（漏洞</span><span style="text-indent: 2em;">6</span><span style="text-indent: 2em;">），可采用发送带有验证令牌的不正确请求的方式来发动攻击，以代替原先执行恶意脚本的攻击方式。</span></span></p><p style="white-space: normal; text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><span style="text-indent: 2em;">6.<span style="font-size: 9px;">&nbsp;</span></span><span style="text-indent: 2em;">在受到感染的</span><span style="text-indent: 2em;">PC</span><span style="text-indent: 2em;">上，获得</span><span style="text-indent: 2em;">root</span><span style="text-indent: 2em;">权限的攻击者可直接运行恶意脚本。</span></span></p><p style="white-space: normal; text-indent: 0em; text-align: center;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><strong>更多细节以及代码描述请阅读原文：</strong><strong>【</strong></span><a href="http://nation.state.actor/mcafee.html#vuln7" target="_blank" textvalue="原文传送门"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><strong>原文传送门</strong></span></a><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><strong><span style="font-family: 宋体;">】</span></strong></span></p></p>
                <hr/>
                <p style="text-align: center;">
                    <img src="http://bobao.360.cn/img/app.jpeg"/>
                    <img src="http://bobao.360.cn/img/weixin.jpeg"/>
                </p>
                                <p>本文由 安全客 翻译，转载请注明“转自安全客”，并附上链接。<br/><a class="text-more" href="http://nation.state.actor/mcafee.html#vuln7" target="_blank">原文链接：http://nation.state.actor/mcafee.html#vuln7</a></p>
                            </div>
            <div style="margin-top: 20px;background-color:#FFFFFF">
    <input type="hidden" id="detail_title" name="detail_title" value="【技术分享】Linux下的McAfee安全扫描软件存在多个漏洞 - 安全客 - 有思想的安全新媒体" />
    <input type="hidden" id="use_nickname" name="use_nickname" value="0" />
    <a name="mao"></a>
    <div class="reg-log mobile-hiden">
        <div class="" id="userTo">   
            <div id="to-list" class="input-text" style="">
                <textarea disabled="disabled" class="hide"  id="comment-content" to="to"></textarea>
                <ul id="preadded" style="display:none">       
                </ul>
                <div id="to-auto" style="width: 200px">
                    <ul id="feed">
                    </ul>
                </div>
            </div>
        </div>
        <input type="hidden" id="source-id" value="3289" />
        <input type="hidden" id="source-type" value="learning" />
        <input type="hidden" id="post-comment-url" value="/comment/add" />
        <input type="hidden" id="post-nickname-url-ajax" value="/comment/randnicknameajax" />
        <input type="hidden" id="post-check-login-url-ajax" value="/comment/checklogin" />
        <input type="hidden" id="stoken_comment_set" value="ea3898fb4df38673fdeb61c458234054">                 <span class="join">参与讨论，请先 <a href="javascript:;" class="comment-login">登录</a> | <a href="javascript:;" class="comment-reg">注册</a> |  <a href="javascript:;" class="anonymous-comment">匿名评论</a></span>
            </div>
    <div class="mobile-hide" style="width: 870px; margin: 0 auto;">
        <label style="vertical-align:middle;" for="use_nickname">匿名</label> 
        <input style="vertical-align:middle;" id="trigger-nickname" name="use_nickname" class="use_nickname" type="checkbox" value="0" />

        <a href="javascript:;" class="apply-use button" id="submit-comment" data-target="/comment/add">发布</a>
    </div>


    <div class="clearfix"></div>
    <div class="comments">
        <div class="comments-head">
            <span class="title">用户评论</span>
        </div>
                <div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/5x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="356970816" class="response" data-bind-id="356970816" data-target="7063" user-name="小包" href="javascript:;">
                小包            </a>
                        <span class="comment-time">2016-12-14 11:25:06</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="356970816" data-target="7063">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_7063" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">及时雨</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
<div class="clearfix re-comment">
    <div class="comment-quote">  
        <div class="comment-user">
            <a href="javascript:;" class="response" data-bind-id="5058287" data-target="7061">白帽子</a> <span class="comment-time">2016-12-14 11:14:34</span>            <div class="comment-action">                        <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="5058287" data-target="7061">回复</a></span>&nbsp;|&nbsp;                        <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_7061" data-type="comment">点赞</a></span>            </div>
            <p>漏洞利用EXP：https://www.exploit-db.com/exploits/40911/</p>
        </div>
    </div>
        </div>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/8x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="5058287" class="response" data-bind-id="5058287" data-target="7061" user-name="白帽子" href="javascript:;">
                白帽子            </a>
                        <span class="comment-time">2016-12-14 11:14:34</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="5058287" data-target="7061">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_7061" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">漏洞利用EXP：https://www.exploit-db.com/exploits/40911/</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>

        <a class="more-long comment-more" href="javascript:;" data-target="/comment/more" data-type="learning" data-source-id="3289" data-page="2">查看更多</a>
            </div>
</div>
<script>
    $(function () {
        $('.anonymous-comment').click(function () {
            $(".join").hide();
            $(".reg-log textarea").first().removeAttr("disabled").show();
            $('#use_nickname').val('1');
//            $('#trigger-nickname').attr('checked', true);
            $('#trigger-nickname').trigger('click');
        });
        //为所有复选框绑定事件
//        checkbox_on_click();
        //ajax随机获取昵称
//        randnicknameajax(0);
        //ajax检测登录状态
        comment_check_login();
    });



    function input_checkbox(flag) {
        $('input:checkbox').each(function () {
            var value = flag ? 1 : 0;
            $(this).prop('checked', flag);
            $(this).val(value);
        });
    }

//ajax随机获取昵称
    function randnicknameajax(flag) {
        $.ajax({
            type: 'POST',
            url: $('#post-nickname-url-ajax').val(),
            data: {limit: 1, flag: flag},
            dataType: "json",
            success: function (data) {
                $('#nick-name').val(data.data[0]);
                _nick_name=data.data[0];
            }
        });
    }
    $();
//ajax检测登录状态
    function comment_check_login() {
        $.ajax({
            type: 'POST',
            url: $('#post-check-login-url-ajax').val(),
            data: {},
            dataType: "json",
            success: function (data) {
                if (data.success) {
                    $('.join').hide();
                    $(".reg-log textarea").first().removeAttr("disabled").show();
                    $("#span_use_nickname").show();
                    $('#use_nickname').val('0');
                    $('#use_nickname').attr('checked', false);
                }
            }
        });
    }
</script>        </div>
    </div>
    <div class="side-bar">
        <div class="mod hot-news">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-hot"></i><span>热门知识</span></h2>
    </div>
    <ul class="links-list">
                                <li><a href="/learning/detail/4411.html" alt="【漏洞预警】一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现——最新的Office高级威胁攻击预警" target="_blank">【漏洞预警】一个换行符引发的奥斯卡...</a></li>
                                <li><a href="/learning/detail/4416.html" alt="【漏洞预警】Microsoft .NET Framework漏洞（CVE–2017–8759）预警" target="_blank">【漏洞预警】Microsoft .NE...</a></li>
                                <li><a href="/learning/detail/4414.html" alt="【技术分享】妙用JavaScript绕过XSS过滤" target="_blank">【技术分享】妙用JavaScrip...</a></li>
                                <li><a href="/learning/detail/4418.html" alt="【技术分享】利用威胁情报数据平台拓展APT攻击线索一例" target="_blank">【技术分享】利用威胁情报数据平台拓...</a></li>
                                <li><a href="/learning/detail/4417.html" alt="【知识】9月15日 - 每日安全知识热点" target="_blank">【知识】9月15日 - 每日安全知识热...</a></li>
                                <li><a href="/learning/detail/4425.html" alt="【安全报告】XShellGhost事件技术回顾报告" target="_blank">【安全报告】XShellGhost事件...</a></li>
            </ul>
</div>        <!-- 友情链接 -->
        <div class="mod blog-links mobile-hide">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-link"></i><span>友情链接</span></h2>
        <a href="/links/index.html" class="more">更多<i></i></a>
    </div>
        <ul class="links-list">
                <li><a href="http://bbs.360safe.com" alt="360安全社区" target="_blank">360安全社区</a></li>
                <li><a href="http://zhuji.360.cn" alt="360主机卫士" target="_blank">360主机卫士</a></li>
                <li><a href="http://blogs.360.cn/" alt="奇虎360技术博客" target="_blank">奇虎360技术博客</a></li>
                <li><a href="http://wangzhan.360.cn/" alt="360网站卫士" target="_blank">360网站卫士</a></li>
                <li><a href="http://webscan.360.cn/" alt="360网站安全检测" target="_blank">360网站安全检测</a></li>
                <li><a href="http://research.360.cn/report/" alt="360研究报告" target="_blank">360研究报告</a></li>
                <li><a href="http://unicorn.360.cn/" alt="360 Unicorn Team" target="_blank">360 Unicorn Team</a></li>
                <li><a href="http://appscan.360.cn/" alt="360捉虫猎手" target="_blank">360捉虫猎手</a></li>
                <li><a href="https://threathunter.org/" alt="ThreatHunter社区" target="_blank">ThreatHunter社区</a></li>
                <li><a href="http://security.360.cn/" alt="360安全应急响应中心" target="_blank">360安全应急响应中心</a></li>
            </ul>
    </div>
        <!-- 联系我们 -->
        <div class="mod contact mobile-hide" style="text-align:center">
    <div class="head-bar clearfix">
        <h2><i></i><span>关注我们</span></h2>
    </div>
    <!-- 微信关注 -->
    <ul class="contact-way">
        <li><a>微信关注</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/qrcode_adlab_weixin.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
    <!-- APP下载 -->
    <ul class="contact-way">
        <li><a>安全播报APP</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/scan_code_big.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
</div>

    </div>
</div>

<script type="text/javascript" src="/js/jquery-ui.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/jquery.noty.packaged.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/common.js?v=4.5"></script>
<script>$(function() {sync_count('comment');});</script>


<!-- 语法高亮 -->
<script type="text/javascript" src="/ue/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">SyntaxHighlighter.all();sync_count('vul');sync_count('news');sync_count('learning');sync_count('activity');sync_count('course');sync_count('ctf');</script>
    </div>

        <div class="footer">
        <div class="friend-link">
            <a href="http://www.360.cn/" target="_blank">360首页</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">关于我们</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">联系我们</a>
            <span>|</span>
            <a href="/links/index.html" target="_blank">友情链接</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">招贤纳士</a>
        </div>
        <div class="copy">
            Copyright &copy; 360网络攻防实验室 All Rights Reserved <span class="copy_icp">京ICP证080047号[京ICP备08010314号-6]</span>
        </div>
    </div>
    
</div>

<!--奇舞团统计-->

<script src='https://s.ssl.qhimg.com/static/f5407c785655e6a1/monitor_analytic.js'></script>
<script>
    monitor.setProject('QH_171_1').getTrack().getClickAndKeydown().getClickHeatmap(10, 1);
</script>

<div class="hide">
    <script src="https://s95.cnzz.com/z_stat.php?id=1253147824&web_id=1253147824" language="JavaScript"></script>
</div>
<div class="backToTop_wrap off">
    <a id="back_to_top" class="backToTop" href="javascript:;" title="返回顶部"></a>
</div>
<script>
    var $backToTop_wrap = $(".backToTop_wrap"),
        $backToTop_btn = $("#back_to_top");

    if ($(window).scrollTop() > 100) {
        $backToTop_wrap.removeClass("off");
    }
    else {
        $backToTop_wrap.addClass("off");
    }

    $(window).on("scroll", function () {
        if ($(this).scrollTop() > 100) {
            $backToTop_wrap.removeClass("off");
        }
        else {
            $backToTop_wrap.addClass("off");
        }
    });

    $backToTop_btn.on("click", function () {
        $("html, body").animate({scrollTop: 0}, 120);
    });

    $(function () {
        var navlist = $('.nav-list > li');

        navlist.each(function () {
            $(this).on('mouseenter', function () {
                $(this).addClass('selected');
            });

            $(this).on('mouseleave', function () {
                $(this).removeClass('selected');
            });
        });
    })
</script>



</body>
</html>
