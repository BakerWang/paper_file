<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:wb="http://open.weibo.com/wb" xml:lang="en" lang="en">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <link rel="shortcut icon" href="http://bobao.360.cn/favicon.ico?v=1.1"/>
    <link rel="alternate" title="安全资讯" href="/rss?type=news" type="application/rss+xml"/>
    <link rel="alternate" title="安全知识" href="/rss?type=learning" type="application/rss+xml"/>
    <link rel="alternate" title="安全圈活动" href="/rss?type=activity" type="application/rss+xml"/>
    <link rel="alternate" title="所有漏洞" href="/rss?type=vul" type="application/rss+xml"/>
    <link rel="alternate" title="通用型漏洞" href="/rss?type=commonvul" type="application/rss+xml"/>
    <link rel="alternate" title="事件型漏洞" href="/rss?type=eventvul" type="application/rss+xml"/>
    <link rel="alternate" title="热门漏洞" href="/rss?type=hotvul" type="application/rss+xml"/>

        <title>【技术分享】AES标准及Rijndael算法解析 - 安全客 - 有思想的安全新媒体</title>
    
        <meta name="keywords" content="AES标准,Rijndael,Rijndael算法,密码学"/>
    
        <meta name="description" content="Rijndael算法是由比利时学者Joan Daemen和Vincent Rijmen所提出的，算法的名字就由两位作者的名字组合而成。Rijndael的优势在于集安全性、性能、效率、可实现性及灵活性与一体。本文为针对该算法的解析。"/>
        <meta property="wb:webmaster" content="224437c7be31d633"/>

    <script type="text/javascript" src="http://s7.qhimg.com/!56caa871/xpc_sync_height.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/reset.css" />
    <link rel="stylesheet" type="text/css" href="/css/common_new.css?v=4.4.2.1" />
    <link rel="stylesheet" type="text/css" href="/css/jquery.notyfy.css" />
    <link rel="stylesheet" type="text/css" href="/css/notyfy.theme.default.css" />
    <link rel="stylesheet" type="text/css" href="/css/s_common.css?v=2.2.7" media="only screen and
    (max-device-width:900px), only screen and (max-width:900px)" />
    <script type="text/javascript" src="/js/jquery.min.js?v=3.1"></script>
    <script type="text/javascript" src="/js/jquery.notyfy.js"></script>
    <script type="text/javascript" src="/js/iscroll.js"></script>
    <script src="http://js.passport.qihucdn.com/5.0.3.js"></script>
    <script type="text/javascript">
        var myScroll, myNavScroll;

        function iscrollLoaded() {
            myScroll = new IScroll('#wrapper',
                {
                    scrollX: true,
                    scrollY: false,
                    bounceEasing: 'circular',
                    eventPassthrough: true,
                    preventDefault: false,
                    bounceTime: 500
                }
            );
        }

        $(function () {

            //导航横向滚动


            function setNavWidth() {

                /* 计算导航宽度 */
                var allWidth = $(window).width();
                var scroller = $('#scroller');

                if (allWidth > 900) {
                    scroller.find('ul').add(scroller.find('.scroll')).removeAttr('style');
                    scroller.css('overflow', 'visible');
                    if (myNavScroll) myNavScroll.destroy();
                } else {

                    var width = 0;
                    scroller.find('.scroll').children('ul').children('li').each(function (index, el) {
                        if (!$(this).hasClass('mobile-hide')) {
                            width += $(this).outerWidth();
                        }
                    });
                    scroller.find('ul').add(scroller.find('.scroll')).width(width);

                    if (myNavScroll) myNavScroll.destroy();

                    myNavScroll = new IScroll('#scroller', {
                        scrollX: true,
                        scrollY: false,
                        momentum: false,
                        click: true
                    });

                }

            }

            setNavWidth();
            $(window).resize(function (event) {
                setNavWidth();
            });

        });

    </script>
</head>
<body onload="iscrollLoaded();">
<div style='margin:0 auto;width:0px;height:0px;overflow:hidden;'>
    <img src=""/>
</div>

<div id="is-mobile"></div>
<div class="container">
        <div class="mobile-header">
        <div class="header clearfix">
            <div class="header-wrapper clearfix">
                <a href="/index/index" class="logo"><img class="slogan" src="/img/logo.png?v=1.5"/></a>
                                <form id="search" class="search-box" action="/search/index" method="GET">
                    <input class="keys" name="keywords" type="text" placeholder="搜索漏洞" required="required">
                    <input class="icon" type="submit" value="">
                    <input type="hidden" name="type" value=""/>
                </form>
                <div class="bug">
                    <div class="name"><span class="seled">全部</span><i class="arrow"></i></div>
                    <ul class="typelist">
                        <li data-index="3"><a href="javascript:void(0);">全部</a></li>
                        <li data-index="0"><a href="javascript:void(0);">漏洞</a></li>
                        <li data-index="1"><a href="javascript:void(0);">资讯</a></li>
                        <li data-index="2"><a href="javascript:void(0);">知识</a></li>
                    </ul>
                </div>
                                <div class="logNreg mobile-hide">
                    <div class="unlog">
                        <i></i>
                        <a href="log.html" class="log">登录</a>
                        <span>|</span>
                        <a href="reg.html" class="reg">注册</a>
                    </div>
                    <div class="loged">
                        <a href="/member/profile" class="user-center"><i></i><span class="user-name-tag">个人中心</span></a>
                        <div class="user-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting"><a href="http://i.360.cn/profile/accountmanage"
                                                               target="_blank"><i></i><span>账号设置</span></a></li>
                                <li class="alert-setting"><a href="/keywords/index"
                                                             target="_blank"><i></i><span>告警设置</span></a></li>
                                <li class="bug-alert"><a href="/myalarm/index" target="_blank"><i></i><span>漏洞告警</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mylearn/index" target="_blank"><i></i><span>我的知识</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mycourse/index" target="_blank"><i></i><span>我的课堂</span></a>
                                </li>
                                <li class="my-exit"><a
                                            href="http://login.360.cn/?src=pcw_adlab&op=logout&destUrl=http://bobao.360.cn"><i></i><span>退出系统</span></a>
                                </li>
                            </ul>
                        </div>

                        <a href="/message" class="message-center" target="_blank"><i></i><span>我的消息</span></a>
                        <div class="message-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting" style="display:none;"><a href="/myres/index"
                                                                                     target="_blank"><i></i><span>回复我的</span></a>
                                </li>
                                <li class="my-bug"><a href="/myvul/index"
                                                      target="_blank"><i></i><span>我的漏洞</span></a></li>
                                <!--<li class="my-bug"><a href="/myres/index" target="_blank"><i></i><span>我的评论</span></a></li>-->
                                <!--<li class="alert-setting"><a href="###" target="_blank"><i></i><span>提到我的</span></a>
                                </li>-->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <style type="text/css">
            .nav {
                overflow: hidden;
            }

            .nav .scroll {
                width: auto;
            }
        </style>
        <div id="wrapper">
            <div id="scroller" class="nav">
                <div class="scroll">
                    <ul class="nav-list">
                        <li ><a class="link-nav"
                                                                                 href="/index/index">首页</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/vul/index">漏洞</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/introduce/list">招聘</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/news/index">资讯</a><!--<i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/introduce/list">招聘</a></li>
                        </ul>
			-->
                        </li>
                        <li class="cur">
                        <a class="link-nav" href="/learning/index">知识</a><i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/course/index">学院</a></li>
                        </ul>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/activity/index">活动</a></li>
                        <li class="mobile-hide "><a class="link-nav"
                                                                                                   href="/ctf/index">CTF训练营</a>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/interref/list">安全内参</a></li>
                        <li ><a class="link-nav" href="/app/index">APP</a></li>

                        <!--<li ><a href="/course/index">学院</a></li>-->
                        <!--<li ><a href="/introduce/list">招聘</a></li>-->
                        <!--<li  class="mobile-hide"><a href="/ctf/index">CTF训练营</a></li>-->
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="mobile-content">
        <link rel="stylesheet" type="text/css" href="/css/news.css?v=3.5" />
<link rel="stylesheet" type="text/css" href="/ue/SyntaxHighlighter/shCoreDefault.css?v=1.0" />
<style>
    p .syntaxhighlighter {
        width: 80%;
    }
</style>

<div class="cur-pos w1000">当前位置：<a href="http://bobao.360.cn/">安全客</a> &gt;&gt; 知识详情</div>

<div class="content clearfix">
    <div class="main">
        <div class="article">
            <div id="article_box">
                <h2>【技术分享】AES标准及Rijndael算法解析</h2>
                <div class="article-msg">
                    <span class="time">2017-03-10 10:23:52</span>
                    
                                        <span class="read">阅读：18381次</span>
                    <span><a style="display: none;" class="good" href="javascript:;"
                             data-target="/learning/good" data-value="g_3590"
                             data-type="learning">点赞(0)</a></span>
                    <span><a class="fav" href="javascript:;" data-target="/mylearning/add"
                             data-pk="3590" data-type="learning">收藏</a></span>
                                        <span><a style="margin-left: 4px;" class="fav" href=""
                             target="_blank">来源： 安全客</a></span>
                    
                    
                    <div style="margin-top:10px; ">
                        <a href="/member/contribute?uid=399871538" style="color:#848e99;">
                            <img src="http://p1.qhmsg.com/dm/150_150_100/t00df551a583a87f4e9.jpg" data-is-avatar="true"
                                 style="border: 1px solid #d5d5d5;padding: 2px; width: 80px;height: 80px;border-radius: 43px;"/>
                        </a>

                    </div>
                    <span class="orig">作者：<a href="/member/contribute?uid=399871538" style="color:#848e99;">mattwu</a></span>
                                    </div>
                <hr size="1">
                <div class="article-msg">
                    <p><!-- JiaThis Button BEGIN -->

<!--
<span class="jiathis_style"><span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_tsina"></a>
    <a class="jiathis_button_tqq"></a>
    <a class="jiathis_button_qzone"></a>
    <a class="jiathis_button_renren"></a>
    <a class="jiathis_button_xiaoyou"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
</span>

-->
</p>
                </div>
                <p><p style="text-align: center; text-indent: 0em;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><img src="http://p9.qhimg.com/t017ab9a869a0726df1.jpg" title="t017ab9a869a0726df1.jpg" alt="http://p9.qhimg.com/t017ab9a869a0726df1.jpg"/></span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></strong></span></p><p style="margin: 0px 25px 8px; white-space: normal; padding: 0px; line-height: 25px; color: rgb(70, 79, 85); word-break: break-all; font-family: Helvetica, &#39;Hiragino Sans GB&#39;, &#39;Microsoft Yahei&#39;, 微软雅黑, serif; text-indent: 2em; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 112, 192); font-weight: 900; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px;">作者：</span><a href="http://bobao.360.cn/member/contribute?uid=399871538" target="_blank" textvalue="mattwu" style="text-decoration: none;"><span style="color: rgb(0, 112, 192); font-weight: 900; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px;">mattwu</span></a></p><p style="margin: 0px 25px 8px; white-space: normal; padding: 0px; line-height: 25px; color: rgb(70, 79, 85); word-break: break-all; font-family: Helvetica, &#39;Hiragino Sans GB&#39;, &#39;Microsoft Yahei&#39;, 微软雅黑, serif; text-indent: 2em; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 112, 192); font-weight: 900; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px;">预估稿费：400RMB</span></p><p style="margin: 0px 25px 8px; white-space: normal; padding: 0px; line-height: 25px; color: rgb(70, 79, 85); word-break: break-all; font-family: Helvetica, &#39;Hiragino Sans GB&#39;, &#39;Microsoft Yahei&#39;, 微软雅黑, serif; text-indent: 2em; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 112, 192); font-weight: 900; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px;">投稿方式：发送邮件至<a href="mailto:linwei@360.cn" target="_self" style="text-decoration: none; color: rgb(51, 51, 51); line-height: 28px;"><span style="color: rgb(0, 112, 192);">linwei#360.cn</span></a>，或登陆<a href="http://bobao.360.cn/contribute/index" target="_blank" style="text-decoration: none; color: rgb(0, 112, 192); line-height: 28px;">网页版</a>在线投稿</span></p><p style="text-indent: 2em; text-align: left;"><br/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">AES简介</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="text-indent: 2em; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">AES, Advanced Encryption Standard，其实是一套标准：</span><a href="http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf" target="_self" style="text-indent: 2em; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">FIPS 197</a><span style="text-indent: 2em; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">，而我们所说的AES算法其实是Rijndael算法。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">NIST (National INstitute of Standards and Technology) 在1997年9月12日公开征集更高效更安全的替代DES加密算法，第一轮共有15种算法入选，其中5种算法入围了决赛，分别是MARS，RC6，Rijndael，Serpent和Twofish。又经过3年的验证、评测及公众讨论之后Rijndael算法最终入选。</span></p><p style="text-align:center"><img src="http://p9.qhimg.com/t016bc3c6a89395bea3.jpg" title="t01458b8778b4dc5957.jpg" alt="http://p4.qhimg.com/t01458b8778b4dc5957.jpg"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Rijndael算法</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">Rijndael算法是由比利时学者Joan Daemen和Vincent Rijmen所提出的，算法的名字就由两位作者的名字组合而成。Rijndael的优势在于集安全性、性能、效率、可实现性及灵活性与一体。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Joan Daemen和Vincent Rijmen</span></strong></span></p><hr/><p style="text-align: center; text-indent: 0em;"><img src="http://p3.qhimg.com/t01688bd104adef8ef2.png" title="t01248d8b93712581dc.png" alt="http://p0.qhimg.com/t01248d8b93712581dc.png" style="text-align: center;"/></p><p style="text-align:center"><img src="http://p7.qhimg.com/t019db026ac545ae21a.png" title="t017759147b89c79140.png" alt="http://p8.qhimg.com/t017759147b89c79140.png"/></p><p style="text-align:center"><img src="http://p2.qhimg.com/t015520afc219a09006.png" title="t0153ba152736865737.png" alt="http://p9.qhimg.com/t0153ba152736865737.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">AES vs Rijndael</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">Rijndael算法支持多种分组及密钥长度，介于128-256之间所有32的倍数均可，最小支持128位，最大256位，共25种组合。而AES标准支持的分组大小固定为128位，密钥长度有3种选择：128位、192位及256位。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">加密实例</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">下面针对16字节的简单明文字串“0011223344....eeff”，分别用AES-128/AES-192及AES-256进行加密运算：</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">AES-128</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">密钥选用16字节长的简单字串：“00010203....0e0f” 来，上面的明文经过加密变换后成为&quot;69c4e0d8....6089&quot;。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><pre class="brush:plain;toolbar:false">plain&nbsp;:&nbsp;&nbsp;00&nbsp;11&nbsp;22&nbsp;33&nbsp;44&nbsp;55&nbsp;66&nbsp;77&nbsp;88&nbsp;99&nbsp;aa&nbsp;bb&nbsp;cc&nbsp;dd&nbsp;ee&nbsp;ff
key&nbsp;&nbsp;&nbsp;:&nbsp;&nbsp;00&nbsp;01&nbsp;02&nbsp;03&nbsp;04&nbsp;05&nbsp;06&nbsp;07&nbsp;08&nbsp;09&nbsp;0a&nbsp;0b&nbsp;0c&nbsp;0d&nbsp;0e&nbsp;0f
cypher:&nbsp;&nbsp;69&nbsp;c4&nbsp;e0&nbsp;d8&nbsp;6a&nbsp;7b&nbsp;04&nbsp;30&nbsp;d8&nbsp;cd&nbsp;b7&nbsp;80&nbsp;70&nbsp;b4&nbsp;c5&nbsp;5a</pre><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">AES-192</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><pre class="brush:plain;toolbar:false">plain&nbsp;:&nbsp;&nbsp;00&nbsp;11&nbsp;22&nbsp;33&nbsp;44&nbsp;55&nbsp;66&nbsp;77&nbsp;88&nbsp;99&nbsp;aa&nbsp;bb&nbsp;cc&nbsp;dd&nbsp;ee&nbsp;ff
key&nbsp;&nbsp;&nbsp;:&nbsp;&nbsp;00&nbsp;01&nbsp;02&nbsp;03&nbsp;04&nbsp;05&nbsp;06&nbsp;07&nbsp;08&nbsp;09&nbsp;0a&nbsp;0b&nbsp;0c&nbsp;0d&nbsp;..&nbsp;..&nbsp;..&nbsp;17
cypher:&nbsp;&nbsp;dd&nbsp;a9&nbsp;7c&nbsp;a4&nbsp;86&nbsp;4c&nbsp;df&nbsp;e0&nbsp;6e&nbsp;af&nbsp;70&nbsp;a0&nbsp;ec&nbsp;0d&nbsp;71&nbsp;91</pre><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">AES-256</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><pre class="brush:plain;toolbar:false">plain&nbsp;:&nbsp;&nbsp;00&nbsp;11&nbsp;22&nbsp;33&nbsp;44&nbsp;55&nbsp;66&nbsp;77&nbsp;88&nbsp;99&nbsp;aa&nbsp;bb&nbsp;cc&nbsp;dd&nbsp;ee&nbsp;ff
key&nbsp;&nbsp;&nbsp;:&nbsp;&nbsp;00&nbsp;01&nbsp;02&nbsp;03&nbsp;04&nbsp;05&nbsp;06&nbsp;07&nbsp;08&nbsp;09&nbsp;0a&nbsp;0b&nbsp;0c&nbsp;0d&nbsp;..&nbsp;..&nbsp;..&nbsp;17&nbsp;..&nbsp;..&nbsp;..&nbsp;1f
cypher:&nbsp;&nbsp;8e&nbsp;a2&nbsp;b7&nbsp;ca&nbsp;51&nbsp;67&nbsp;45&nbsp;bf&nbsp;ea&nbsp;fc&nbsp;49&nbsp;90&nbsp;4b&nbsp;49&nbsp;60&nbsp;89</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span><br/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">总体结构</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">Rijndael算法是基于代换-置换网络（SPN，Substitution-permutation network）的迭代算法。明文数据经过多轮次的转换后方能生成密文，每个轮次的转换操作由轮函数定义。轮函数任务就是根据密钥编排序列（即轮密码）对数据进行不同的代换及置换等操作。</span></p><p style="text-align:center"><img src="http://p5.qhimg.com/t01370f8b46dea4405d.png" title="t0135f2d309102d6859.png" alt="http://p4.qhimg.com/t0135f2d309102d6859.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">图左侧为轮函数的流程，主要包含4种主要运算操作：字节代换(SubByte)、行移位(ShiftRow)、列混合(MixColumn)、轮密钥加(AddRoundKey)。图右侧为密钥编排方案，在Rijndael中称为密钥扩展算法（KeyExpansion）。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">AES标准算法将128位的明文，以特定次序生成一个4x4的矩阵（每个元素是一个字节，8位），即初始状态（state），经由轮函数的迭代转换之后又将作为下一轮迭代的输入继续参与运算直到迭代结束。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Rijndael算法支持大于128位的明文分组，所以需要列数更多的矩阵来描述。Rijndael轮函数的运算是在特殊定义的有限域GF(256)上进行的。有限域（Finite Field）又名伽罗瓦域（Galois field），简单言之就是一个满足特定规则的集合，集合中的元素可以进行加减乘除运算，且运算结果也是属于此集合。更详细有有关Rijndael算法的数学描述，可以参阅本文最后所罗列的参考资料，在此不做熬述。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">轮函数</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">我们已经得知轮函数主要包含4种运算，但不同的运算轮所做的具体运的算组合并不相同。主要区别是初始轮（Round: 0）和最后一轮（Round: Nr），所有中间轮的运算都是相同的，会依次进行4种运算，即：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 176, 80);">字节代换(SubByte)</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 176, 80);">行移位(ShiftRow)</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 176, 80);">列混合(MixColumn)</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 176, 80);">轮密钥加(AddRoundKey)</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">根据Rinjdael算法的定义，加密轮数会针对不同的分组及不同的密钥长度选择不同的数值：</span></p><p style="text-align:center"><img src="http://p2.qhimg.com/t01c72e87bde77723a1.png" title="t0145be07eb54ef875a.png" alt="http://p7.qhimg.com/t0145be07eb54ef875a.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">AES标准只支持128位分组（Nb = 4）的情况。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">轮函数的实现代码如下，直接实现在加密函数内部循环中：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><pre class="brush:plain;toolbar:false">int&nbsp;aes_encrypt(AES_CYPHER_T&nbsp;mode,&nbsp;uint8_t&nbsp;*data,&nbsp;int&nbsp;len,&nbsp;uint8_t&nbsp;*key)
{
&nbsp;&nbsp;&nbsp;&nbsp;uint8_t&nbsp;w[4&nbsp;*&nbsp;4&nbsp;*&nbsp;15]&nbsp;=&nbsp;{0};&nbsp;/*&nbsp;round&nbsp;key&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;uint8_t&nbsp;s[4&nbsp;*&nbsp;4]&nbsp;=&nbsp;{0};&nbsp;/*&nbsp;state&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;nr,&nbsp;i,&nbsp;j;
&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;key&nbsp;expansion&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;aes_key_expansion(mode,&nbsp;key,&nbsp;w);
&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;start&nbsp;data&nbsp;cypher&nbsp;loop&nbsp;over&nbsp;input&nbsp;buffer&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;len;&nbsp;i&nbsp;+=&nbsp;4&nbsp;*&nbsp;g_aes_nb[mode])&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;init&nbsp;state&nbsp;from&nbsp;user&nbsp;buffer&nbsp;(plaintext)&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(j&nbsp;=&nbsp;0;&nbsp;j&nbsp;&lt;&nbsp;4&nbsp;*&nbsp;g_aes_nb[mode];&nbsp;j++)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s[j]&nbsp;=&nbsp;data[i&nbsp;+&nbsp;j];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;start&nbsp;AES&nbsp;cypher&nbsp;loop&nbsp;over&nbsp;all&nbsp;AES&nbsp;rounds&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(nr&nbsp;=&nbsp;0;&nbsp;nr&nbsp;&lt;=&nbsp;g_aes_rounds[mode];&nbsp;nr++)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(nr&nbsp;&gt;&nbsp;0)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;do&nbsp;SubBytes&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aes_sub_bytes(mode,&nbsp;s);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;do&nbsp;ShiftRows&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aes_shift_rows(mode,&nbsp;s);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(nr&nbsp;&lt;&nbsp;g_aes_rounds[mode])&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;do&nbsp;MixColumns&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aes_mix_columns(mode,&nbsp;s);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;do&nbsp;AddRoundKey&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aes_add_round_key(mode,&nbsp;s,&nbsp;w,&nbsp;nr);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;save&nbsp;state&nbsp;(cypher)&nbsp;to&nbsp;user&nbsp;buffer&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(j&nbsp;=&nbsp;0;&nbsp;j&nbsp;&lt;&nbsp;4&nbsp;*&nbsp;g_aes_nb[mode];&nbsp;j++)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data[i&nbsp;+&nbsp;j]&nbsp;=&nbsp;s[j];
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;
}</pre><p style="text-indent: 2em; text-align: left;"><br/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;"><br/></span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">动画演示加密过程</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">Enrique Zabala创建了一个AES-128加密算法的动画演示，清楚、直观地介绍了轮函数执行的过程。</span><a href="http://www.formaestudio.com/rijndaelinspector/archivos/Rijndael_Animation_v4_eng.swf" target="_self" textvalue="点击可直接观看" style="text-decoration: none;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em; color: rgb(255, 0, 0);">点击可直接观看</span></a><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">。</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">轮函数拆解：字节代换（Substitute Bytes）</span></strong></span></p><p style="text-align:center"><img src="http://p9.qhimg.com/t01864f789e859b3794.png" title="t01e0e522a11414aa66.png" alt="http://p4.qhimg.com/t01e0e522a11414aa66.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">字节代换（SubBytes）是对state矩阵中的每一个独立元素于置换盒 （Substitution-box，S盒）中进行查找并以此替换输入状态的操作。字节代换是可逆的非线性变换，也是AES运算组中唯一的非线性变换。字节代换逆操作也是通过逆向置换盒的查找及替换来完成的。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">S盒是事先设计好的16x16的查询表，即256个元素。其设计不是随意的，要根据设计原则严格计算求得，不然无法保证算法的安全性。既然是S盒是计算得来，所以字节代换的操作完全可以通过计算来完成，不过通过S盒查表操作更方便快捷，图中所示就是通过S盒查找对应元素进行的替换操作。</span></p><p style="text-align:center"><img src="http://p8.qhimg.com/t0102510ff4700b80d1.jpg" title="t01744948c9e50187c3.jpg" alt="http://p5.qhimg.com/t01744948c9e50187c3.jpg"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><pre class="brush:plain;toolbar:false">void&nbsp;aes_sub_bytes(AES_CYPHER_T&nbsp;mode,&nbsp;uint8_t&nbsp;*state)
{
&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;i,&nbsp;j;
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;g_aes_nb[mode];&nbsp;i++)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(j&nbsp;=&nbsp;0;&nbsp;j&nbsp;&lt;&nbsp;4;&nbsp;j++)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state[i&nbsp;*&nbsp;4&nbsp;+&nbsp;j]&nbsp;=&nbsp;aes_sub_sbox(state[i&nbsp;*&nbsp;4&nbsp;+&nbsp;j]);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">实例说明：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><pre class="brush:plain;toolbar:false">&nbsp;&nbsp;&nbsp;input:&nbsp;&nbsp;00&nbsp;10&nbsp;20&nbsp;30&nbsp;40&nbsp;50&nbsp;60&nbsp;70&nbsp;80&nbsp;90&nbsp;a0&nbsp;b0&nbsp;c0&nbsp;d0&nbsp;e0&nbsp;f0
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub:&nbsp;&nbsp;63&nbsp;ca&nbsp;b7&nbsp;04&nbsp;09&nbsp;53&nbsp;d0&nbsp;51&nbsp;cd&nbsp;60&nbsp;e0&nbsp;e7&nbsp;ba&nbsp;70&nbsp;e1&nbsp;8c</pre><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">轮函数拆解：行移位（Shift Rows）</span></strong></span></p><p style="text-align:center"><img src="http://p8.qhimg.com/t0122b187ca769023b4.png" title="t01bb8598e28239ee53.png" alt="http://p9.qhimg.com/t01bb8598e28239ee53.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">行移位主要目的是实现字节在每一行的扩散，属于线性变换。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><pre class="brush:plain;toolbar:false">void&nbsp;aes_shift_rows(AES_CYPHER_T&nbsp;mode,&nbsp;uint8_t&nbsp;*state)
{
&nbsp;&nbsp;&nbsp;&nbsp;uint8_t&nbsp;*s&nbsp;=&nbsp;(uint8_t&nbsp;*)state;
&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;i,&nbsp;j,&nbsp;r;
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(i&nbsp;=&nbsp;1;&nbsp;i&nbsp;&lt;&nbsp;g_aes_nb[mode];&nbsp;i++)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(j&nbsp;=&nbsp;0;&nbsp;j&nbsp;&lt;&nbsp;i;&nbsp;j++)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uint8_t&nbsp;tmp&nbsp;=&nbsp;s[i];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(r&nbsp;=&nbsp;0;&nbsp;r&nbsp;&lt;&nbsp;g_aes_nb[mode];&nbsp;r++)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s[i&nbsp;+&nbsp;r&nbsp;*&nbsp;4]&nbsp;=&nbsp;s[i&nbsp;+&nbsp;(r&nbsp;+&nbsp;1)&nbsp;*&nbsp;4];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s[i&nbsp;+&nbsp;(g_aes_nb[mode]&nbsp;-&nbsp;1)&nbsp;*&nbsp;4]&nbsp;=&nbsp;tmp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">实例说明：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><pre class="brush:plain;toolbar:false">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub:&nbsp;&nbsp;63&nbsp;ca&nbsp;b7&nbsp;04&nbsp;09&nbsp;53&nbsp;d0&nbsp;51&nbsp;cd&nbsp;60&nbsp;e0&nbsp;e7&nbsp;ba&nbsp;70&nbsp;e1&nbsp;8c
&nbsp;&nbsp;&nbsp;shift:&nbsp;&nbsp;63&nbsp;53&nbsp;e0&nbsp;8c&nbsp;09&nbsp;60&nbsp;e1&nbsp;04&nbsp;cd&nbsp;70&nbsp;b7&nbsp;51&nbsp;ba&nbsp;ca&nbsp;d0&nbsp;e7</pre><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">轮函数拆解：列混合（Mix Columns）</span></strong></span></p><p style="text-align:center"><img src="http://p6.qhimg.com/t01e1900fcfe36537a7.png" title="t015ffea83758c9182e.png" alt="http://p4.qhimg.com/t015ffea83758c9182e.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">列混合是通过将state矩阵与常矩阵C相乘以达成在列上的扩散，属于代替变换。列混合是Rijndael算法中最复杂的一步，其实质是在有限域GF(256)上的多项式乘法运算。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><pre class="brush:plain;toolbar:false">void&nbsp;aes_mix_columns(AES_CYPHER_T&nbsp;mode,&nbsp;uint8_t&nbsp;*state)
{
&nbsp;&nbsp;&nbsp;&nbsp;uint8_t&nbsp;y[16]&nbsp;=&nbsp;{&nbsp;2,&nbsp;3,&nbsp;1,&nbsp;1,&nbsp;&nbsp;1,&nbsp;2,&nbsp;3,&nbsp;1,&nbsp;&nbsp;1,&nbsp;1,&nbsp;2,&nbsp;3,&nbsp;&nbsp;3,&nbsp;1,&nbsp;1,&nbsp;2};
&nbsp;&nbsp;&nbsp;&nbsp;uint8_t&nbsp;s[4];
&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;i,&nbsp;j,&nbsp;r;
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;g_aes_nb[mode];&nbsp;i++)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(r&nbsp;=&nbsp;0;&nbsp;r&nbsp;&lt;&nbsp;4;&nbsp;r++)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s[r]&nbsp;=&nbsp;0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(j&nbsp;=&nbsp;0;&nbsp;j&nbsp;&lt;&nbsp;4;&nbsp;j++)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s[r]&nbsp;=&nbsp;s[r]&nbsp;^&nbsp;aes_mul(state[i&nbsp;*&nbsp;4&nbsp;+&nbsp;j],&nbsp;y[r&nbsp;*&nbsp;4&nbsp;+&nbsp;j]);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(r&nbsp;=&nbsp;0;&nbsp;r&nbsp;&lt;&nbsp;4;&nbsp;r++)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state[i&nbsp;*&nbsp;4&nbsp;+&nbsp;r]&nbsp;=&nbsp;s[r];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">实例说明：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><pre class="brush:plain;toolbar:false">&nbsp;&nbsp;&nbsp;shift:&nbsp;&nbsp;63&nbsp;53&nbsp;e0&nbsp;8c&nbsp;09&nbsp;60&nbsp;e1&nbsp;04&nbsp;cd&nbsp;70&nbsp;b7&nbsp;51&nbsp;ba&nbsp;ca&nbsp;d0&nbsp;e7
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mix:&nbsp;&nbsp;5f&nbsp;72&nbsp;64&nbsp;15&nbsp;57&nbsp;f5&nbsp;bc&nbsp;92&nbsp;f7&nbsp;be&nbsp;3b&nbsp;29&nbsp;1d&nbsp;b9&nbsp;f9&nbsp;1a</pre><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">轮函数拆解：轮密钥加（Add Round Key）</span></strong></span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t0193099d3bcdf30b6d.png" title="t015981c87d4032e851.png" alt="http://p0.qhimg.com/t015981c87d4032e851.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">密钥加是将轮密钥简单地与状态进行逐比特异或。实现代码如下：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><pre class="brush:plain;toolbar:false">void&nbsp;aes_add_round_key(AES_CYPHER_T&nbsp;mode,&nbsp;uint8_t&nbsp;*state,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uint8_t&nbsp;*round,&nbsp;int&nbsp;nr)
{
&nbsp;&nbsp;&nbsp;&nbsp;uint32_t&nbsp;*w&nbsp;=&nbsp;(uint32_t&nbsp;*)round;
&nbsp;&nbsp;&nbsp;&nbsp;uint32_t&nbsp;*s&nbsp;=&nbsp;(uint32_t&nbsp;*)state;
&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;i;
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;g_aes_nb[mode];&nbsp;i++)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s[i]&nbsp;^=&nbsp;w[nr&nbsp;*&nbsp;g_aes_nb[mode]&nbsp;+&nbsp;i];
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">实例说明：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><pre class="brush:plain;toolbar:false">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mix:&nbsp;&nbsp;5f&nbsp;72&nbsp;64&nbsp;15&nbsp;57&nbsp;f5&nbsp;bc&nbsp;92&nbsp;f7&nbsp;be&nbsp;3b&nbsp;29&nbsp;1d&nbsp;b9&nbsp;f9&nbsp;1a
&nbsp;&nbsp;&nbsp;round:&nbsp;&nbsp;d6&nbsp;aa&nbsp;74&nbsp;fd&nbsp;d2&nbsp;af&nbsp;72&nbsp;fa&nbsp;da&nbsp;a6&nbsp;78&nbsp;f1&nbsp;d6&nbsp;ab&nbsp;76&nbsp;fe
&nbsp;&nbsp;&nbsp;state:&nbsp;&nbsp;89&nbsp;d8&nbsp;10&nbsp;e8&nbsp;85&nbsp;5a&nbsp;ce&nbsp;68&nbsp;2d&nbsp;18&nbsp;43&nbsp;d8&nbsp;cb&nbsp;12&nbsp;8f&nbsp;e4</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span><br/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">密钥扩展算法（Key Expansion）</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">密钥扩展算法是Rijndael的密钥编排实现算法，其目的是根据种子密钥（用户密钥）生成多组轮密钥。轮密钥为多组128位密钥，对应不同密钥长度，分别是11，13，15组。</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t01ea591f38dfd13e5b.png" title="t0150e3d5dbc8c942d7.png" alt="http://p3.qhimg.com/t0150e3d5dbc8c942d7.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">实现代码：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><pre class="brush:plain;toolbar:false">/*
&nbsp;*&nbsp;nr:&nbsp;number&nbsp;of&nbsp;rounds
&nbsp;*&nbsp;nb:&nbsp;number&nbsp;of&nbsp;columns&nbsp;comprising&nbsp;the&nbsp;state,&nbsp;nb&nbsp;=&nbsp;4&nbsp;dwords&nbsp;(16&nbsp;bytes)
&nbsp;*&nbsp;nk:&nbsp;number&nbsp;of&nbsp;32-bit&nbsp;words&nbsp;comprising&nbsp;cipher&nbsp;key,&nbsp;nk&nbsp;=&nbsp;4,&nbsp;6,&nbsp;8&nbsp;(KeyLength/(4*8))
&nbsp;*/
void&nbsp;aes_key_expansion(AES_CYPHER_T&nbsp;mode,&nbsp;uint8_t&nbsp;*key,&nbsp;uint8_t&nbsp;*round)
{
&nbsp;&nbsp;&nbsp;&nbsp;uint32_t&nbsp;*w&nbsp;=&nbsp;(uint32_t&nbsp;*)round;
&nbsp;&nbsp;&nbsp;&nbsp;uint32_t&nbsp;&nbsp;t;
&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;=&nbsp;0;
&nbsp;&nbsp;&nbsp;&nbsp;do&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w[i]&nbsp;=&nbsp;*((uint32_t&nbsp;*)&amp;key[i&nbsp;*&nbsp;4&nbsp;+&nbsp;0]);
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;while&nbsp;(++i&nbsp;&lt;&nbsp;g_aes_nk[mode]);
&nbsp;&nbsp;&nbsp;&nbsp;do&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;((i&nbsp;%&nbsp;g_aes_nk[mode])&nbsp;==&nbsp;0)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t&nbsp;=&nbsp;aes_rot_dword(w[i&nbsp;-&nbsp;1]);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t&nbsp;=&nbsp;aes_sub_dword(t);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t&nbsp;=&nbsp;t&nbsp;^&nbsp;aes_swap_dword(g_aes_rcon[i/g_aes_nk[mode]&nbsp;-&nbsp;1]);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(g_aes_nk[mode]&nbsp;&gt;&nbsp;6&nbsp;&amp;&amp;&nbsp;(i&nbsp;%&nbsp;g_aes_nk[mode])&nbsp;==&nbsp;4)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t&nbsp;=&nbsp;aes_sub_dword(w[i&nbsp;-&nbsp;1]);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t&nbsp;=&nbsp;w[i&nbsp;-&nbsp;1];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w[i]&nbsp;=&nbsp;w[i&nbsp;-&nbsp;g_aes_nk[mode]]&nbsp;^&nbsp;t;
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;while&nbsp;(++i&nbsp;&lt;&nbsp;g_aes_nb[mode]&nbsp;*&nbsp;(g_aes_rounds[mode]&nbsp;+&nbsp;1));
&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;key&nbsp;can&nbsp;be&nbsp;discarded&nbsp;(or&nbsp;zeroed)&nbsp;from&nbsp;memory&nbsp;*/
}</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">以AES-128为例，从128位种子密钥生成11组轮密钥（每组128位）：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><pre class="brush:plain;toolbar:false">Input:
&nbsp;&nbsp;&nbsp;&nbsp;key&nbsp;:&nbsp;&nbsp;00&nbsp;01&nbsp;02&nbsp;03&nbsp;04&nbsp;05&nbsp;06&nbsp;07&nbsp;08&nbsp;09&nbsp;0a&nbsp;0b&nbsp;0c&nbsp;0d&nbsp;0e&nbsp;0f
Key&nbsp;Expansion:
&nbsp;&nbsp;&nbsp;&nbsp;00:&nbsp;&nbsp;rs:&nbsp;00010203
&nbsp;&nbsp;&nbsp;&nbsp;01:&nbsp;&nbsp;rs:&nbsp;04050607
&nbsp;&nbsp;&nbsp;&nbsp;02:&nbsp;&nbsp;rs:&nbsp;08090a0b
&nbsp;&nbsp;&nbsp;&nbsp;03:&nbsp;&nbsp;rs:&nbsp;0c0d0e0f
&nbsp;&nbsp;&nbsp;&nbsp;04:&nbsp;&nbsp;rot:&nbsp;0d0e0f0c&nbsp;sub:&nbsp;d7ab76fe&nbsp;rcon:&nbsp;01000000&nbsp;xor:&nbsp;fe76abd6&nbsp;rs:&nbsp;d6aa74fd
&nbsp;&nbsp;&nbsp;&nbsp;05:&nbsp;&nbsp;equ:&nbsp;d6aa74fd&nbsp;rs:&nbsp;d2af72fa
&nbsp;&nbsp;&nbsp;&nbsp;06:&nbsp;&nbsp;equ:&nbsp;d2af72fa&nbsp;rs:&nbsp;daa678f1
&nbsp;&nbsp;&nbsp;&nbsp;07:&nbsp;&nbsp;equ:&nbsp;daa678f1&nbsp;rs:&nbsp;d6ab76fe
&nbsp;&nbsp;&nbsp;&nbsp;08:&nbsp;&nbsp;rot:&nbsp;ab76fed6&nbsp;sub:&nbsp;6238bbf6&nbsp;rcon:&nbsp;02000000&nbsp;xor:&nbsp;f6bb3860&nbsp;rs:&nbsp;b692cf0b
&nbsp;&nbsp;&nbsp;&nbsp;09:&nbsp;&nbsp;equ:&nbsp;b692cf0b&nbsp;rs:&nbsp;643dbdf1
&nbsp;&nbsp;&nbsp;&nbsp;10:&nbsp;&nbsp;equ:&nbsp;643dbdf1&nbsp;rs:&nbsp;be9bc500
&nbsp;&nbsp;&nbsp;&nbsp;11:&nbsp;&nbsp;equ:&nbsp;be9bc500&nbsp;rs:&nbsp;6830b3fe
&nbsp;&nbsp;&nbsp;&nbsp;12:&nbsp;&nbsp;rot:&nbsp;30b3fe68&nbsp;sub:&nbsp;046dbb45&nbsp;rcon:&nbsp;04000000&nbsp;xor:&nbsp;45bb6d00&nbsp;rs:&nbsp;b6ff744e
&nbsp;&nbsp;&nbsp;&nbsp;13:&nbsp;&nbsp;equ:&nbsp;b6ff744e&nbsp;rs:&nbsp;d2c2c9bf
&nbsp;&nbsp;&nbsp;&nbsp;14:&nbsp;&nbsp;equ:&nbsp;d2c2c9bf&nbsp;rs:&nbsp;6c590cbf
&nbsp;&nbsp;&nbsp;&nbsp;15:&nbsp;&nbsp;equ:&nbsp;6c590cbf&nbsp;rs:&nbsp;0469bf41
&nbsp;&nbsp;&nbsp;&nbsp;16:&nbsp;&nbsp;rot:&nbsp;69bf4104&nbsp;sub:&nbsp;f90883f2&nbsp;rcon:&nbsp;08000000&nbsp;xor:&nbsp;f28308f1&nbsp;rs:&nbsp;47f7f7bc
&nbsp;&nbsp;&nbsp;&nbsp;17:&nbsp;&nbsp;equ:&nbsp;47f7f7bc&nbsp;rs:&nbsp;95353e03
&nbsp;&nbsp;&nbsp;&nbsp;18:&nbsp;&nbsp;equ:&nbsp;95353e03&nbsp;rs:&nbsp;f96c32bc
&nbsp;&nbsp;&nbsp;&nbsp;19:&nbsp;&nbsp;equ:&nbsp;f96c32bc&nbsp;rs:&nbsp;fd058dfd
&nbsp;&nbsp;&nbsp;&nbsp;20:&nbsp;&nbsp;rot:&nbsp;058dfdfd&nbsp;sub:&nbsp;6b5d5454&nbsp;rcon:&nbsp;10000000&nbsp;xor:&nbsp;54545d7b&nbsp;rs:&nbsp;3caaa3e8
&nbsp;&nbsp;&nbsp;&nbsp;21:&nbsp;&nbsp;equ:&nbsp;3caaa3e8&nbsp;rs:&nbsp;a99f9deb
&nbsp;&nbsp;&nbsp;&nbsp;22:&nbsp;&nbsp;equ:&nbsp;a99f9deb&nbsp;rs:&nbsp;50f3af57
&nbsp;&nbsp;&nbsp;&nbsp;23:&nbsp;&nbsp;equ:&nbsp;50f3af57&nbsp;rs:&nbsp;adf622aa
&nbsp;&nbsp;&nbsp;&nbsp;24:&nbsp;&nbsp;rot:&nbsp;f622aaad&nbsp;sub:&nbsp;4293ac95&nbsp;rcon:&nbsp;20000000&nbsp;xor:&nbsp;95ac9362&nbsp;rs:&nbsp;5e390f7d
&nbsp;&nbsp;&nbsp;&nbsp;25:&nbsp;&nbsp;equ:&nbsp;5e390f7d&nbsp;rs:&nbsp;f7a69296
&nbsp;&nbsp;&nbsp;&nbsp;26:&nbsp;&nbsp;equ:&nbsp;f7a69296&nbsp;rs:&nbsp;a7553dc1
&nbsp;&nbsp;&nbsp;&nbsp;27:&nbsp;&nbsp;equ:&nbsp;a7553dc1&nbsp;rs:&nbsp;0aa31f6b
&nbsp;&nbsp;&nbsp;&nbsp;28:&nbsp;&nbsp;rot:&nbsp;a31f6b0a&nbsp;sub:&nbsp;0ac07f67&nbsp;rcon:&nbsp;40000000&nbsp;xor:&nbsp;677fc04a&nbsp;rs:&nbsp;14f9701a
&nbsp;&nbsp;&nbsp;&nbsp;29:&nbsp;&nbsp;equ:&nbsp;14f9701a&nbsp;rs:&nbsp;e35fe28c
&nbsp;&nbsp;&nbsp;&nbsp;30:&nbsp;&nbsp;equ:&nbsp;e35fe28c&nbsp;rs:&nbsp;440adf4d
&nbsp;&nbsp;&nbsp;&nbsp;31:&nbsp;&nbsp;equ:&nbsp;440adf4d&nbsp;rs:&nbsp;4ea9c026
&nbsp;&nbsp;&nbsp;&nbsp;32:&nbsp;&nbsp;rot:&nbsp;a9c0264e&nbsp;sub:&nbsp;d3baf72f&nbsp;rcon:&nbsp;80000000&nbsp;xor:&nbsp;2ff7ba53&nbsp;rs:&nbsp;47438735
&nbsp;&nbsp;&nbsp;&nbsp;33:&nbsp;&nbsp;equ:&nbsp;47438735&nbsp;rs:&nbsp;a41c65b9
&nbsp;&nbsp;&nbsp;&nbsp;34:&nbsp;&nbsp;equ:&nbsp;a41c65b9&nbsp;rs:&nbsp;e016baf4
&nbsp;&nbsp;&nbsp;&nbsp;35:&nbsp;&nbsp;equ:&nbsp;e016baf4&nbsp;rs:&nbsp;aebf7ad2
&nbsp;&nbsp;&nbsp;&nbsp;36:&nbsp;&nbsp;rot:&nbsp;bf7ad2ae&nbsp;sub:&nbsp;08dab5e4&nbsp;rcon:&nbsp;1b000000&nbsp;xor:&nbsp;e4b5da13&nbsp;rs:&nbsp;549932d1
&nbsp;&nbsp;&nbsp;&nbsp;37:&nbsp;&nbsp;equ:&nbsp;549932d1&nbsp;rs:&nbsp;f0855768
&nbsp;&nbsp;&nbsp;&nbsp;38:&nbsp;&nbsp;equ:&nbsp;f0855768&nbsp;rs:&nbsp;1093ed9c
&nbsp;&nbsp;&nbsp;&nbsp;39:&nbsp;&nbsp;equ:&nbsp;1093ed9c&nbsp;rs:&nbsp;be2c974e
&nbsp;&nbsp;&nbsp;&nbsp;40:&nbsp;&nbsp;rot:&nbsp;2c974ebe&nbsp;sub:&nbsp;71882fae&nbsp;rcon:&nbsp;36000000&nbsp;xor:&nbsp;ae2f8847&nbsp;rs:&nbsp;13111d7f
&nbsp;&nbsp;&nbsp;&nbsp;41:&nbsp;&nbsp;equ:&nbsp;13111d7f&nbsp;rs:&nbsp;e3944a17
&nbsp;&nbsp;&nbsp;&nbsp;42:&nbsp;&nbsp;equ:&nbsp;e3944a17&nbsp;rs:&nbsp;f307a78b
&nbsp;&nbsp;&nbsp;&nbsp;43:&nbsp;&nbsp;equ:&nbsp;f307a78b&nbsp;rs:&nbsp;4d2b30c5</pre><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">加密过程实例</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><pre class="brush:plain;toolbar:false">Encrypting&nbsp;block&nbsp;...
&nbsp;Round&nbsp;0:
&nbsp;&nbsp;&nbsp;input:&nbsp;&nbsp;00&nbsp;11&nbsp;22&nbsp;33&nbsp;44&nbsp;55&nbsp;66&nbsp;77&nbsp;88&nbsp;99&nbsp;aa&nbsp;bb&nbsp;cc&nbsp;dd&nbsp;ee&nbsp;ff
&nbsp;&nbsp;&nbsp;round:&nbsp;&nbsp;00&nbsp;01&nbsp;02&nbsp;03&nbsp;04&nbsp;05&nbsp;06&nbsp;07&nbsp;08&nbsp;09&nbsp;0a&nbsp;0b&nbsp;0c&nbsp;0d&nbsp;0e&nbsp;0f
&nbsp;&nbsp;&nbsp;state:&nbsp;&nbsp;00&nbsp;10&nbsp;20&nbsp;30&nbsp;40&nbsp;50&nbsp;60&nbsp;70&nbsp;80&nbsp;90&nbsp;a0&nbsp;b0&nbsp;c0&nbsp;d0&nbsp;e0&nbsp;f0
&nbsp;Round&nbsp;1:
&nbsp;&nbsp;&nbsp;input:&nbsp;&nbsp;00&nbsp;10&nbsp;20&nbsp;30&nbsp;40&nbsp;50&nbsp;60&nbsp;70&nbsp;80&nbsp;90&nbsp;a0&nbsp;b0&nbsp;c0&nbsp;d0&nbsp;e0&nbsp;f0
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub:&nbsp;&nbsp;63&nbsp;ca&nbsp;b7&nbsp;04&nbsp;09&nbsp;53&nbsp;d0&nbsp;51&nbsp;cd&nbsp;60&nbsp;e0&nbsp;e7&nbsp;ba&nbsp;70&nbsp;e1&nbsp;8c
&nbsp;&nbsp;&nbsp;shift:&nbsp;&nbsp;63&nbsp;53&nbsp;e0&nbsp;8c&nbsp;09&nbsp;60&nbsp;e1&nbsp;04&nbsp;cd&nbsp;70&nbsp;b7&nbsp;51&nbsp;ba&nbsp;ca&nbsp;d0&nbsp;e7
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mix:&nbsp;&nbsp;5f&nbsp;72&nbsp;64&nbsp;15&nbsp;57&nbsp;f5&nbsp;bc&nbsp;92&nbsp;f7&nbsp;be&nbsp;3b&nbsp;29&nbsp;1d&nbsp;b9&nbsp;f9&nbsp;1a
&nbsp;&nbsp;&nbsp;round:&nbsp;&nbsp;d6&nbsp;aa&nbsp;74&nbsp;fd&nbsp;d2&nbsp;af&nbsp;72&nbsp;fa&nbsp;da&nbsp;a6&nbsp;78&nbsp;f1&nbsp;d6&nbsp;ab&nbsp;76&nbsp;fe
&nbsp;&nbsp;&nbsp;state:&nbsp;&nbsp;89&nbsp;d8&nbsp;10&nbsp;e8&nbsp;85&nbsp;5a&nbsp;ce&nbsp;68&nbsp;2d&nbsp;18&nbsp;43&nbsp;d8&nbsp;cb&nbsp;12&nbsp;8f&nbsp;e4
&nbsp;Round&nbsp;2:
&nbsp;&nbsp;&nbsp;input:&nbsp;&nbsp;89&nbsp;d8&nbsp;10&nbsp;e8&nbsp;85&nbsp;5a&nbsp;ce&nbsp;68&nbsp;2d&nbsp;18&nbsp;43&nbsp;d8&nbsp;cb&nbsp;12&nbsp;8f&nbsp;e4
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub:&nbsp;&nbsp;a7&nbsp;61&nbsp;ca&nbsp;9b&nbsp;97&nbsp;be&nbsp;8b&nbsp;45&nbsp;d8&nbsp;ad&nbsp;1a&nbsp;61&nbsp;1f&nbsp;c9&nbsp;73&nbsp;69
&nbsp;&nbsp;&nbsp;shift:&nbsp;&nbsp;a7&nbsp;be&nbsp;1a&nbsp;69&nbsp;97&nbsp;ad&nbsp;73&nbsp;9b&nbsp;d8&nbsp;c9&nbsp;ca&nbsp;45&nbsp;1f&nbsp;61&nbsp;8b&nbsp;61
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mix:&nbsp;&nbsp;ff&nbsp;87&nbsp;96&nbsp;84&nbsp;31&nbsp;d8&nbsp;6a&nbsp;51&nbsp;64&nbsp;51&nbsp;51&nbsp;fa&nbsp;77&nbsp;3a&nbsp;d0&nbsp;09
&nbsp;&nbsp;&nbsp;round:&nbsp;&nbsp;b6&nbsp;92&nbsp;cf&nbsp;0b&nbsp;64&nbsp;3d&nbsp;bd&nbsp;f1&nbsp;be&nbsp;9b&nbsp;c5&nbsp;00&nbsp;68&nbsp;30&nbsp;b3&nbsp;fe
&nbsp;&nbsp;&nbsp;state:&nbsp;&nbsp;49&nbsp;15&nbsp;59&nbsp;8f&nbsp;55&nbsp;e5&nbsp;d7&nbsp;a0&nbsp;da&nbsp;ca&nbsp;94&nbsp;fa&nbsp;1f&nbsp;0a&nbsp;63&nbsp;f7
&nbsp;Round&nbsp;3:
&nbsp;&nbsp;&nbsp;input:&nbsp;&nbsp;49&nbsp;15&nbsp;59&nbsp;8f&nbsp;55&nbsp;e5&nbsp;d7&nbsp;a0&nbsp;da&nbsp;ca&nbsp;94&nbsp;fa&nbsp;1f&nbsp;0a&nbsp;63&nbsp;f7
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub:&nbsp;&nbsp;3b&nbsp;59&nbsp;cb&nbsp;73&nbsp;fc&nbsp;d9&nbsp;0e&nbsp;e0&nbsp;57&nbsp;74&nbsp;22&nbsp;2d&nbsp;c0&nbsp;67&nbsp;fb&nbsp;68
&nbsp;&nbsp;&nbsp;shift:&nbsp;&nbsp;3b&nbsp;d9&nbsp;22&nbsp;68&nbsp;fc&nbsp;74&nbsp;fb&nbsp;73&nbsp;57&nbsp;67&nbsp;cb&nbsp;e0&nbsp;c0&nbsp;59&nbsp;0e&nbsp;2d
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mix:&nbsp;&nbsp;4c&nbsp;9c&nbsp;1e&nbsp;66&nbsp;f7&nbsp;71&nbsp;f0&nbsp;76&nbsp;2c&nbsp;3f&nbsp;86&nbsp;8e&nbsp;53&nbsp;4d&nbsp;f2&nbsp;56
&nbsp;&nbsp;&nbsp;round:&nbsp;&nbsp;b6&nbsp;ff&nbsp;74&nbsp;4e&nbsp;d2&nbsp;c2&nbsp;c9&nbsp;bf&nbsp;6c&nbsp;59&nbsp;0c&nbsp;bf&nbsp;04&nbsp;69&nbsp;bf&nbsp;41
&nbsp;&nbsp;&nbsp;state:&nbsp;&nbsp;fa&nbsp;63&nbsp;6a&nbsp;28&nbsp;25&nbsp;b3&nbsp;39&nbsp;c9&nbsp;40&nbsp;66&nbsp;8a&nbsp;31&nbsp;57&nbsp;24&nbsp;4d&nbsp;17
&nbsp;Round&nbsp;4:
&nbsp;&nbsp;&nbsp;input:&nbsp;&nbsp;fa&nbsp;63&nbsp;6a&nbsp;28&nbsp;25&nbsp;b3&nbsp;39&nbsp;c9&nbsp;40&nbsp;66&nbsp;8a&nbsp;31&nbsp;57&nbsp;24&nbsp;4d&nbsp;17
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub:&nbsp;&nbsp;2d&nbsp;fb&nbsp;02&nbsp;34&nbsp;3f&nbsp;6d&nbsp;12&nbsp;dd&nbsp;09&nbsp;33&nbsp;7e&nbsp;c7&nbsp;5b&nbsp;36&nbsp;e3&nbsp;f0
&nbsp;&nbsp;&nbsp;shift:&nbsp;&nbsp;2d&nbsp;6d&nbsp;7e&nbsp;f0&nbsp;3f&nbsp;33&nbsp;e3&nbsp;34&nbsp;09&nbsp;36&nbsp;02&nbsp;dd&nbsp;5b&nbsp;fb&nbsp;12&nbsp;c7
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mix:&nbsp;&nbsp;63&nbsp;85&nbsp;b7&nbsp;9f&nbsp;fc&nbsp;53&nbsp;8d&nbsp;f9&nbsp;97&nbsp;be&nbsp;47&nbsp;8e&nbsp;75&nbsp;47&nbsp;d6&nbsp;91
&nbsp;&nbsp;&nbsp;round:&nbsp;&nbsp;47&nbsp;f7&nbsp;f7&nbsp;bc&nbsp;95&nbsp;35&nbsp;3e&nbsp;03&nbsp;f9&nbsp;6c&nbsp;32&nbsp;bc&nbsp;fd&nbsp;05&nbsp;8d&nbsp;fd
&nbsp;&nbsp;&nbsp;state:&nbsp;&nbsp;24&nbsp;72&nbsp;40&nbsp;23&nbsp;69&nbsp;66&nbsp;b3&nbsp;fa&nbsp;6e&nbsp;d2&nbsp;75&nbsp;32&nbsp;88&nbsp;42&nbsp;5b&nbsp;6c
&nbsp;Round&nbsp;5:
&nbsp;&nbsp;&nbsp;input:&nbsp;&nbsp;24&nbsp;72&nbsp;40&nbsp;23&nbsp;69&nbsp;66&nbsp;b3&nbsp;fa&nbsp;6e&nbsp;d2&nbsp;75&nbsp;32&nbsp;88&nbsp;42&nbsp;5b&nbsp;6c
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub:&nbsp;&nbsp;36&nbsp;40&nbsp;09&nbsp;26&nbsp;f9&nbsp;33&nbsp;6d&nbsp;2d&nbsp;9f&nbsp;b5&nbsp;9d&nbsp;23&nbsp;c4&nbsp;2c&nbsp;39&nbsp;50
&nbsp;&nbsp;&nbsp;shift:&nbsp;&nbsp;36&nbsp;33&nbsp;9d&nbsp;50&nbsp;f9&nbsp;b5&nbsp;39&nbsp;26&nbsp;9f&nbsp;2c&nbsp;09&nbsp;2d&nbsp;c4&nbsp;40&nbsp;6d&nbsp;23
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mix:&nbsp;&nbsp;f4&nbsp;bc&nbsp;d4&nbsp;54&nbsp;32&nbsp;e5&nbsp;54&nbsp;d0&nbsp;75&nbsp;f1&nbsp;d6&nbsp;c5&nbsp;1d&nbsp;d0&nbsp;3b&nbsp;3c
&nbsp;&nbsp;&nbsp;round:&nbsp;&nbsp;3c&nbsp;aa&nbsp;a3&nbsp;e8&nbsp;a9&nbsp;9f&nbsp;9d&nbsp;eb&nbsp;50&nbsp;f3&nbsp;af&nbsp;57&nbsp;ad&nbsp;f6&nbsp;22&nbsp;aa
&nbsp;&nbsp;&nbsp;state:&nbsp;&nbsp;c8&nbsp;16&nbsp;77&nbsp;bc&nbsp;9b&nbsp;7a&nbsp;c9&nbsp;3b&nbsp;25&nbsp;02&nbsp;79&nbsp;92&nbsp;b0&nbsp;26&nbsp;19&nbsp;96
&nbsp;Round&nbsp;6:
&nbsp;&nbsp;&nbsp;input:&nbsp;&nbsp;c8&nbsp;16&nbsp;77&nbsp;bc&nbsp;9b&nbsp;7a&nbsp;c9&nbsp;3b&nbsp;25&nbsp;02&nbsp;79&nbsp;92&nbsp;b0&nbsp;26&nbsp;19&nbsp;96
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub:&nbsp;&nbsp;e8&nbsp;47&nbsp;f5&nbsp;65&nbsp;14&nbsp;da&nbsp;dd&nbsp;e2&nbsp;3f&nbsp;77&nbsp;b6&nbsp;4f&nbsp;e7&nbsp;f7&nbsp;d4&nbsp;90
&nbsp;&nbsp;&nbsp;shift:&nbsp;&nbsp;e8&nbsp;da&nbsp;b6&nbsp;90&nbsp;14&nbsp;77&nbsp;d4&nbsp;65&nbsp;3f&nbsp;f7&nbsp;f5&nbsp;e2&nbsp;e7&nbsp;47&nbsp;dd&nbsp;4f
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mix:&nbsp;&nbsp;98&nbsp;16&nbsp;ee&nbsp;74&nbsp;00&nbsp;f8&nbsp;7f&nbsp;55&nbsp;6b&nbsp;2c&nbsp;04&nbsp;9c&nbsp;8e&nbsp;5a&nbsp;d0&nbsp;36
&nbsp;&nbsp;&nbsp;round:&nbsp;&nbsp;5e&nbsp;39&nbsp;0f&nbsp;7d&nbsp;f7&nbsp;a6&nbsp;92&nbsp;96&nbsp;a7&nbsp;55&nbsp;3d&nbsp;c1&nbsp;0a&nbsp;a3&nbsp;1f&nbsp;6b
&nbsp;&nbsp;&nbsp;state:&nbsp;&nbsp;c6&nbsp;2f&nbsp;e1&nbsp;09&nbsp;f7&nbsp;5e&nbsp;ed&nbsp;c3&nbsp;cc&nbsp;79&nbsp;39&nbsp;5d&nbsp;84&nbsp;f9&nbsp;cf&nbsp;5d
&nbsp;Round&nbsp;7:
&nbsp;&nbsp;&nbsp;input:&nbsp;&nbsp;c6&nbsp;2f&nbsp;e1&nbsp;09&nbsp;f7&nbsp;5e&nbsp;ed&nbsp;c3&nbsp;cc&nbsp;79&nbsp;39&nbsp;5d&nbsp;84&nbsp;f9&nbsp;cf&nbsp;5d
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub:&nbsp;&nbsp;b4&nbsp;15&nbsp;f8&nbsp;01&nbsp;68&nbsp;58&nbsp;55&nbsp;2e&nbsp;4b&nbsp;b6&nbsp;12&nbsp;4c&nbsp;5f&nbsp;99&nbsp;8a&nbsp;4c
&nbsp;&nbsp;&nbsp;shift:&nbsp;&nbsp;b4&nbsp;58&nbsp;12&nbsp;4c&nbsp;68&nbsp;b6&nbsp;8a&nbsp;01&nbsp;4b&nbsp;99&nbsp;f8&nbsp;2e&nbsp;5f&nbsp;15&nbsp;55&nbsp;4c
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mix:&nbsp;&nbsp;c5&nbsp;7e&nbsp;1c&nbsp;15&nbsp;9a&nbsp;9b&nbsp;d2&nbsp;86&nbsp;f0&nbsp;5f&nbsp;4b&nbsp;e0&nbsp;98&nbsp;c6&nbsp;34&nbsp;39
&nbsp;&nbsp;&nbsp;round:&nbsp;&nbsp;14&nbsp;f9&nbsp;70&nbsp;1a&nbsp;e3&nbsp;5f&nbsp;e2&nbsp;8c&nbsp;44&nbsp;0a&nbsp;df&nbsp;4d&nbsp;4e&nbsp;a9&nbsp;c0&nbsp;26
&nbsp;&nbsp;&nbsp;state:&nbsp;&nbsp;d1&nbsp;87&nbsp;6c&nbsp;0f&nbsp;79&nbsp;c4&nbsp;30&nbsp;0a&nbsp;b4&nbsp;55&nbsp;94&nbsp;ad&nbsp;d6&nbsp;6f&nbsp;f4&nbsp;1f
&nbsp;Round&nbsp;8:
&nbsp;&nbsp;&nbsp;input:&nbsp;&nbsp;d1&nbsp;87&nbsp;6c&nbsp;0f&nbsp;79&nbsp;c4&nbsp;30&nbsp;0a&nbsp;b4&nbsp;55&nbsp;94&nbsp;ad&nbsp;d6&nbsp;6f&nbsp;f4&nbsp;1f
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub:&nbsp;&nbsp;3e&nbsp;17&nbsp;50&nbsp;76&nbsp;b6&nbsp;1c&nbsp;04&nbsp;67&nbsp;8d&nbsp;fc&nbsp;22&nbsp;95&nbsp;f6&nbsp;a8&nbsp;bf&nbsp;c0
&nbsp;&nbsp;&nbsp;shift:&nbsp;&nbsp;3e&nbsp;1c&nbsp;22&nbsp;c0&nbsp;b6&nbsp;fc&nbsp;bf&nbsp;76&nbsp;8d&nbsp;a8&nbsp;50&nbsp;67&nbsp;f6&nbsp;17&nbsp;04&nbsp;95
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mix:&nbsp;&nbsp;ba&nbsp;a0&nbsp;3d&nbsp;e7&nbsp;a1&nbsp;f9&nbsp;b5&nbsp;6e&nbsp;d5&nbsp;51&nbsp;2c&nbsp;ba&nbsp;5f&nbsp;41&nbsp;4d&nbsp;23
&nbsp;&nbsp;&nbsp;round:&nbsp;&nbsp;47&nbsp;43&nbsp;87&nbsp;35&nbsp;a4&nbsp;1c&nbsp;65&nbsp;b9&nbsp;e0&nbsp;16&nbsp;ba&nbsp;f4&nbsp;ae&nbsp;bf&nbsp;7a&nbsp;d2
&nbsp;&nbsp;&nbsp;state:&nbsp;&nbsp;fd&nbsp;e3&nbsp;ba&nbsp;d2&nbsp;05&nbsp;e5&nbsp;d0&nbsp;d7&nbsp;35&nbsp;47&nbsp;96&nbsp;4e&nbsp;f1&nbsp;fe&nbsp;37&nbsp;f1
&nbsp;Round&nbsp;9:
&nbsp;&nbsp;&nbsp;input:&nbsp;&nbsp;fd&nbsp;e3&nbsp;ba&nbsp;d2&nbsp;05&nbsp;e5&nbsp;d0&nbsp;d7&nbsp;35&nbsp;47&nbsp;96&nbsp;4e&nbsp;f1&nbsp;fe&nbsp;37&nbsp;f1
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub:&nbsp;&nbsp;54&nbsp;11&nbsp;f4&nbsp;b5&nbsp;6b&nbsp;d9&nbsp;70&nbsp;0e&nbsp;96&nbsp;a0&nbsp;90&nbsp;2f&nbsp;a1&nbsp;bb&nbsp;9a&nbsp;a1
&nbsp;&nbsp;&nbsp;shift:&nbsp;&nbsp;54&nbsp;d9&nbsp;90&nbsp;a1&nbsp;6b&nbsp;a0&nbsp;9a&nbsp;b5&nbsp;96&nbsp;bb&nbsp;f4&nbsp;0e&nbsp;a1&nbsp;11&nbsp;70&nbsp;2f
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mix:&nbsp;&nbsp;e9&nbsp;f7&nbsp;4e&nbsp;ec&nbsp;02&nbsp;30&nbsp;20&nbsp;f6&nbsp;1b&nbsp;f2&nbsp;cc&nbsp;f2&nbsp;35&nbsp;3c&nbsp;21&nbsp;c7
&nbsp;&nbsp;&nbsp;round:&nbsp;&nbsp;54&nbsp;99&nbsp;32&nbsp;d1&nbsp;f0&nbsp;85&nbsp;57&nbsp;68&nbsp;10&nbsp;93&nbsp;ed&nbsp;9c&nbsp;be&nbsp;2c&nbsp;97&nbsp;4e
&nbsp;&nbsp;&nbsp;state:&nbsp;&nbsp;bd&nbsp;6e&nbsp;7c&nbsp;3d&nbsp;f2&nbsp;b5&nbsp;77&nbsp;9e&nbsp;0b&nbsp;61&nbsp;21&nbsp;6e&nbsp;8b&nbsp;10&nbsp;b6&nbsp;89
&nbsp;Round&nbsp;10:
&nbsp;&nbsp;&nbsp;input:&nbsp;&nbsp;bd&nbsp;6e&nbsp;7c&nbsp;3d&nbsp;f2&nbsp;b5&nbsp;77&nbsp;9e&nbsp;0b&nbsp;61&nbsp;21&nbsp;6e&nbsp;8b&nbsp;10&nbsp;b6&nbsp;89
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub:&nbsp;&nbsp;7a&nbsp;9f&nbsp;10&nbsp;27&nbsp;89&nbsp;d5&nbsp;f5&nbsp;0b&nbsp;2b&nbsp;ef&nbsp;fd&nbsp;9f&nbsp;3d&nbsp;ca&nbsp;4e&nbsp;a7
&nbsp;&nbsp;&nbsp;shift:&nbsp;&nbsp;7a&nbsp;d5&nbsp;fd&nbsp;a7&nbsp;89&nbsp;ef&nbsp;4e&nbsp;27&nbsp;2b&nbsp;ca&nbsp;10&nbsp;0b&nbsp;3d&nbsp;9f&nbsp;f5&nbsp;9f
&nbsp;&nbsp;&nbsp;round:&nbsp;&nbsp;13&nbsp;11&nbsp;1d&nbsp;7f&nbsp;e3&nbsp;94&nbsp;4a&nbsp;17&nbsp;f3&nbsp;07&nbsp;a7&nbsp;8b&nbsp;4d&nbsp;2b&nbsp;30&nbsp;c5
&nbsp;&nbsp;&nbsp;state:&nbsp;&nbsp;69&nbsp;c4&nbsp;e0&nbsp;d8&nbsp;6a&nbsp;7b&nbsp;04&nbsp;30&nbsp;d8&nbsp;cd&nbsp;b7&nbsp;80&nbsp;70&nbsp;b4&nbsp;c5&nbsp;5a
Output:
&nbsp;&nbsp;cypher:&nbsp;&nbsp;69&nbsp;c4&nbsp;e0&nbsp;d8&nbsp;6a&nbsp;7b&nbsp;04&nbsp;30&nbsp;d8&nbsp;cd&nbsp;b7&nbsp;80&nbsp;70&nbsp;b4&nbsp;c5&nbsp;5a</pre><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">解密轮函数</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">对Rijndael算法来说解密过程就是加密过程的逆向过程，其解密轮函数实现如下：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><pre class="brush:plain;toolbar:false">int&nbsp;aes_decrypt(AES_CYPHER_T&nbsp;mode,&nbsp;uint8_t&nbsp;*data,&nbsp;int&nbsp;len,&nbsp;uint8_t&nbsp;*key)
{
&nbsp;&nbsp;&nbsp;&nbsp;uint8_t&nbsp;w[4&nbsp;*&nbsp;4&nbsp;*&nbsp;15]&nbsp;=&nbsp;{0};&nbsp;/*&nbsp;round&nbsp;key&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;uint8_t&nbsp;s[4&nbsp;*&nbsp;4]&nbsp;=&nbsp;{0};&nbsp;/*&nbsp;state&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;nr,&nbsp;i,&nbsp;j;
&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;key&nbsp;expansion&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;aes_key_expansion(mode,&nbsp;key,&nbsp;w);
&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;start&nbsp;data&nbsp;cypher&nbsp;loop&nbsp;over&nbsp;input&nbsp;buffer&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;len;&nbsp;i&nbsp;+=&nbsp;4&nbsp;*&nbsp;g_aes_nb[mode])&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;init&nbsp;state&nbsp;from&nbsp;user&nbsp;buffer&nbsp;(cyphertext)&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(j&nbsp;=&nbsp;0;&nbsp;j&nbsp;&lt;&nbsp;4&nbsp;*&nbsp;g_aes_nb[mode];&nbsp;j++)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s[j]&nbsp;=&nbsp;data[i&nbsp;+&nbsp;j];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;start&nbsp;AES&nbsp;cypher&nbsp;loop&nbsp;over&nbsp;all&nbsp;AES&nbsp;rounds&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(nr&nbsp;=&nbsp;g_aes_rounds[mode];&nbsp;nr&nbsp;&gt;=&nbsp;0;&nbsp;nr--)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;do&nbsp;AddRoundKey&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aes_add_round_key(mode,&nbsp;s,&nbsp;w,&nbsp;nr);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(nr&nbsp;&gt;&nbsp;0)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(nr&nbsp;&lt;&nbsp;g_aes_rounds[mode])&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;do&nbsp;MixColumns&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inv_mix_columns(mode,&nbsp;s);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;do&nbsp;ShiftRows&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inv_shift_rows(mode,&nbsp;s);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;do&nbsp;SubBytes&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inv_sub_bytes(mode,&nbsp;s);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;save&nbsp;state&nbsp;(cypher)&nbsp;to&nbsp;user&nbsp;buffer&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(j&nbsp;=&nbsp;0;&nbsp;j&nbsp;&lt;&nbsp;4&nbsp;*&nbsp;g_aes_nb[mode];&nbsp;j++)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data[i&nbsp;+&nbsp;j]&nbsp;=&nbsp;s[j];
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;
}</pre><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">解密过程实例</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><pre class="brush:plain;toolbar:false">Decrypting&nbsp;block&nbsp;...
&nbsp;Round&nbsp;10:
&nbsp;&nbsp;&nbsp;input:&nbsp;&nbsp;69&nbsp;c4&nbsp;e0&nbsp;d8&nbsp;6a&nbsp;7b&nbsp;04&nbsp;30&nbsp;d8&nbsp;cd&nbsp;b7&nbsp;80&nbsp;70&nbsp;b4&nbsp;c5&nbsp;5a
&nbsp;&nbsp;&nbsp;round:&nbsp;&nbsp;13&nbsp;11&nbsp;1d&nbsp;7f&nbsp;e3&nbsp;94&nbsp;4a&nbsp;17&nbsp;f3&nbsp;07&nbsp;a7&nbsp;8b&nbsp;4d&nbsp;2b&nbsp;30&nbsp;c5
&nbsp;&nbsp;&nbsp;shift:&nbsp;&nbsp;7a&nbsp;d5&nbsp;fd&nbsp;a7&nbsp;89&nbsp;ef&nbsp;4e&nbsp;27&nbsp;2b&nbsp;ca&nbsp;10&nbsp;0b&nbsp;3d&nbsp;9f&nbsp;f5&nbsp;9f
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub:&nbsp;&nbsp;7a&nbsp;9f&nbsp;10&nbsp;27&nbsp;89&nbsp;d5&nbsp;f5&nbsp;0b&nbsp;2b&nbsp;ef&nbsp;fd&nbsp;9f&nbsp;3d&nbsp;ca&nbsp;4e&nbsp;a7
&nbsp;&nbsp;&nbsp;state:&nbsp;&nbsp;bd&nbsp;6e&nbsp;7c&nbsp;3d&nbsp;f2&nbsp;b5&nbsp;77&nbsp;9e&nbsp;0b&nbsp;61&nbsp;21&nbsp;6e&nbsp;8b&nbsp;10&nbsp;b6&nbsp;89
&nbsp;Round&nbsp;9:
&nbsp;&nbsp;&nbsp;input:&nbsp;&nbsp;bd&nbsp;6e&nbsp;7c&nbsp;3d&nbsp;f2&nbsp;b5&nbsp;77&nbsp;9e&nbsp;0b&nbsp;61&nbsp;21&nbsp;6e&nbsp;8b&nbsp;10&nbsp;b6&nbsp;89
&nbsp;&nbsp;&nbsp;round:&nbsp;&nbsp;54&nbsp;99&nbsp;32&nbsp;d1&nbsp;f0&nbsp;85&nbsp;57&nbsp;68&nbsp;10&nbsp;93&nbsp;ed&nbsp;9c&nbsp;be&nbsp;2c&nbsp;97&nbsp;4e
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mix:&nbsp;&nbsp;e9&nbsp;f7&nbsp;4e&nbsp;ec&nbsp;02&nbsp;30&nbsp;20&nbsp;f6&nbsp;1b&nbsp;f2&nbsp;cc&nbsp;f2&nbsp;35&nbsp;3c&nbsp;21&nbsp;c7
&nbsp;&nbsp;&nbsp;shift:&nbsp;&nbsp;54&nbsp;d9&nbsp;90&nbsp;a1&nbsp;6b&nbsp;a0&nbsp;9a&nbsp;b5&nbsp;96&nbsp;bb&nbsp;f4&nbsp;0e&nbsp;a1&nbsp;11&nbsp;70&nbsp;2f
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub:&nbsp;&nbsp;54&nbsp;11&nbsp;f4&nbsp;b5&nbsp;6b&nbsp;d9&nbsp;70&nbsp;0e&nbsp;96&nbsp;a0&nbsp;90&nbsp;2f&nbsp;a1&nbsp;bb&nbsp;9a&nbsp;a1
&nbsp;&nbsp;&nbsp;state:&nbsp;&nbsp;fd&nbsp;e3&nbsp;ba&nbsp;d2&nbsp;05&nbsp;e5&nbsp;d0&nbsp;d7&nbsp;35&nbsp;47&nbsp;96&nbsp;4e&nbsp;f1&nbsp;fe&nbsp;37&nbsp;f1
&nbsp;Round&nbsp;8:
&nbsp;&nbsp;&nbsp;input:&nbsp;&nbsp;fd&nbsp;e3&nbsp;ba&nbsp;d2&nbsp;05&nbsp;e5&nbsp;d0&nbsp;d7&nbsp;35&nbsp;47&nbsp;96&nbsp;4e&nbsp;f1&nbsp;fe&nbsp;37&nbsp;f1
&nbsp;&nbsp;&nbsp;round:&nbsp;&nbsp;47&nbsp;43&nbsp;87&nbsp;35&nbsp;a4&nbsp;1c&nbsp;65&nbsp;b9&nbsp;e0&nbsp;16&nbsp;ba&nbsp;f4&nbsp;ae&nbsp;bf&nbsp;7a&nbsp;d2
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mix:&nbsp;&nbsp;ba&nbsp;a0&nbsp;3d&nbsp;e7&nbsp;a1&nbsp;f9&nbsp;b5&nbsp;6e&nbsp;d5&nbsp;51&nbsp;2c&nbsp;ba&nbsp;5f&nbsp;41&nbsp;4d&nbsp;23
&nbsp;&nbsp;&nbsp;shift:&nbsp;&nbsp;3e&nbsp;1c&nbsp;22&nbsp;c0&nbsp;b6&nbsp;fc&nbsp;bf&nbsp;76&nbsp;8d&nbsp;a8&nbsp;50&nbsp;67&nbsp;f6&nbsp;17&nbsp;04&nbsp;95
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub:&nbsp;&nbsp;3e&nbsp;17&nbsp;50&nbsp;76&nbsp;b6&nbsp;1c&nbsp;04&nbsp;67&nbsp;8d&nbsp;fc&nbsp;22&nbsp;95&nbsp;f6&nbsp;a8&nbsp;bf&nbsp;c0
&nbsp;&nbsp;&nbsp;state:&nbsp;&nbsp;d1&nbsp;87&nbsp;6c&nbsp;0f&nbsp;79&nbsp;c4&nbsp;30&nbsp;0a&nbsp;b4&nbsp;55&nbsp;94&nbsp;ad&nbsp;d6&nbsp;6f&nbsp;f4&nbsp;1f
&nbsp;Round&nbsp;7:
&nbsp;&nbsp;&nbsp;input:&nbsp;&nbsp;d1&nbsp;87&nbsp;6c&nbsp;0f&nbsp;79&nbsp;c4&nbsp;30&nbsp;0a&nbsp;b4&nbsp;55&nbsp;94&nbsp;ad&nbsp;d6&nbsp;6f&nbsp;f4&nbsp;1f
&nbsp;&nbsp;&nbsp;round:&nbsp;&nbsp;14&nbsp;f9&nbsp;70&nbsp;1a&nbsp;e3&nbsp;5f&nbsp;e2&nbsp;8c&nbsp;44&nbsp;0a&nbsp;df&nbsp;4d&nbsp;4e&nbsp;a9&nbsp;c0&nbsp;26
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mix:&nbsp;&nbsp;c5&nbsp;7e&nbsp;1c&nbsp;15&nbsp;9a&nbsp;9b&nbsp;d2&nbsp;86&nbsp;f0&nbsp;5f&nbsp;4b&nbsp;e0&nbsp;98&nbsp;c6&nbsp;34&nbsp;39
&nbsp;&nbsp;&nbsp;shift:&nbsp;&nbsp;b4&nbsp;58&nbsp;12&nbsp;4c&nbsp;68&nbsp;b6&nbsp;8a&nbsp;01&nbsp;4b&nbsp;99&nbsp;f8&nbsp;2e&nbsp;5f&nbsp;15&nbsp;55&nbsp;4c
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub:&nbsp;&nbsp;b4&nbsp;15&nbsp;f8&nbsp;01&nbsp;68&nbsp;58&nbsp;55&nbsp;2e&nbsp;4b&nbsp;b6&nbsp;12&nbsp;4c&nbsp;5f&nbsp;99&nbsp;8a&nbsp;4c
&nbsp;&nbsp;&nbsp;state:&nbsp;&nbsp;c6&nbsp;2f&nbsp;e1&nbsp;09&nbsp;f7&nbsp;5e&nbsp;ed&nbsp;c3&nbsp;cc&nbsp;79&nbsp;39&nbsp;5d&nbsp;84&nbsp;f9&nbsp;cf&nbsp;5d
&nbsp;Round&nbsp;6:
&nbsp;&nbsp;&nbsp;input:&nbsp;&nbsp;c6&nbsp;2f&nbsp;e1&nbsp;09&nbsp;f7&nbsp;5e&nbsp;ed&nbsp;c3&nbsp;cc&nbsp;79&nbsp;39&nbsp;5d&nbsp;84&nbsp;f9&nbsp;cf&nbsp;5d
&nbsp;&nbsp;&nbsp;round:&nbsp;&nbsp;5e&nbsp;39&nbsp;0f&nbsp;7d&nbsp;f7&nbsp;a6&nbsp;92&nbsp;96&nbsp;a7&nbsp;55&nbsp;3d&nbsp;c1&nbsp;0a&nbsp;a3&nbsp;1f&nbsp;6b
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mix:&nbsp;&nbsp;98&nbsp;16&nbsp;ee&nbsp;74&nbsp;00&nbsp;f8&nbsp;7f&nbsp;55&nbsp;6b&nbsp;2c&nbsp;04&nbsp;9c&nbsp;8e&nbsp;5a&nbsp;d0&nbsp;36
&nbsp;&nbsp;&nbsp;shift:&nbsp;&nbsp;e8&nbsp;da&nbsp;b6&nbsp;90&nbsp;14&nbsp;77&nbsp;d4&nbsp;65&nbsp;3f&nbsp;f7&nbsp;f5&nbsp;e2&nbsp;e7&nbsp;47&nbsp;dd&nbsp;4f
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub:&nbsp;&nbsp;e8&nbsp;47&nbsp;f5&nbsp;65&nbsp;14&nbsp;da&nbsp;dd&nbsp;e2&nbsp;3f&nbsp;77&nbsp;b6&nbsp;4f&nbsp;e7&nbsp;f7&nbsp;d4&nbsp;90
&nbsp;&nbsp;&nbsp;state:&nbsp;&nbsp;c8&nbsp;16&nbsp;77&nbsp;bc&nbsp;9b&nbsp;7a&nbsp;c9&nbsp;3b&nbsp;25&nbsp;02&nbsp;79&nbsp;92&nbsp;b0&nbsp;26&nbsp;19&nbsp;96
&nbsp;Round&nbsp;5:
&nbsp;&nbsp;&nbsp;input:&nbsp;&nbsp;c8&nbsp;16&nbsp;77&nbsp;bc&nbsp;9b&nbsp;7a&nbsp;c9&nbsp;3b&nbsp;25&nbsp;02&nbsp;79&nbsp;92&nbsp;b0&nbsp;26&nbsp;19&nbsp;96
&nbsp;&nbsp;&nbsp;round:&nbsp;&nbsp;3c&nbsp;aa&nbsp;a3&nbsp;e8&nbsp;a9&nbsp;9f&nbsp;9d&nbsp;eb&nbsp;50&nbsp;f3&nbsp;af&nbsp;57&nbsp;ad&nbsp;f6&nbsp;22&nbsp;aa
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mix:&nbsp;&nbsp;f4&nbsp;bc&nbsp;d4&nbsp;54&nbsp;32&nbsp;e5&nbsp;54&nbsp;d0&nbsp;75&nbsp;f1&nbsp;d6&nbsp;c5&nbsp;1d&nbsp;d0&nbsp;3b&nbsp;3c
&nbsp;&nbsp;&nbsp;shift:&nbsp;&nbsp;36&nbsp;33&nbsp;9d&nbsp;50&nbsp;f9&nbsp;b5&nbsp;39&nbsp;26&nbsp;9f&nbsp;2c&nbsp;09&nbsp;2d&nbsp;c4&nbsp;40&nbsp;6d&nbsp;23
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub:&nbsp;&nbsp;36&nbsp;40&nbsp;09&nbsp;26&nbsp;f9&nbsp;33&nbsp;6d&nbsp;2d&nbsp;9f&nbsp;b5&nbsp;9d&nbsp;23&nbsp;c4&nbsp;2c&nbsp;39&nbsp;50
&nbsp;&nbsp;&nbsp;state:&nbsp;&nbsp;24&nbsp;72&nbsp;40&nbsp;23&nbsp;69&nbsp;66&nbsp;b3&nbsp;fa&nbsp;6e&nbsp;d2&nbsp;75&nbsp;32&nbsp;88&nbsp;42&nbsp;5b&nbsp;6c
&nbsp;Round&nbsp;4:
&nbsp;&nbsp;&nbsp;input:&nbsp;&nbsp;24&nbsp;72&nbsp;40&nbsp;23&nbsp;69&nbsp;66&nbsp;b3&nbsp;fa&nbsp;6e&nbsp;d2&nbsp;75&nbsp;32&nbsp;88&nbsp;42&nbsp;5b&nbsp;6c
&nbsp;&nbsp;&nbsp;round:&nbsp;&nbsp;47&nbsp;f7&nbsp;f7&nbsp;bc&nbsp;95&nbsp;35&nbsp;3e&nbsp;03&nbsp;f9&nbsp;6c&nbsp;32&nbsp;bc&nbsp;fd&nbsp;05&nbsp;8d&nbsp;fd
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mix:&nbsp;&nbsp;63&nbsp;85&nbsp;b7&nbsp;9f&nbsp;fc&nbsp;53&nbsp;8d&nbsp;f9&nbsp;97&nbsp;be&nbsp;47&nbsp;8e&nbsp;75&nbsp;47&nbsp;d6&nbsp;91
&nbsp;&nbsp;&nbsp;shift:&nbsp;&nbsp;2d&nbsp;6d&nbsp;7e&nbsp;f0&nbsp;3f&nbsp;33&nbsp;e3&nbsp;34&nbsp;09&nbsp;36&nbsp;02&nbsp;dd&nbsp;5b&nbsp;fb&nbsp;12&nbsp;c7
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub:&nbsp;&nbsp;2d&nbsp;fb&nbsp;02&nbsp;34&nbsp;3f&nbsp;6d&nbsp;12&nbsp;dd&nbsp;09&nbsp;33&nbsp;7e&nbsp;c7&nbsp;5b&nbsp;36&nbsp;e3&nbsp;f0
&nbsp;&nbsp;&nbsp;state:&nbsp;&nbsp;fa&nbsp;63&nbsp;6a&nbsp;28&nbsp;25&nbsp;b3&nbsp;39&nbsp;c9&nbsp;40&nbsp;66&nbsp;8a&nbsp;31&nbsp;57&nbsp;24&nbsp;4d&nbsp;17
&nbsp;Round&nbsp;3:
&nbsp;&nbsp;&nbsp;input:&nbsp;&nbsp;fa&nbsp;63&nbsp;6a&nbsp;28&nbsp;25&nbsp;b3&nbsp;39&nbsp;c9&nbsp;40&nbsp;66&nbsp;8a&nbsp;31&nbsp;57&nbsp;24&nbsp;4d&nbsp;17
&nbsp;&nbsp;&nbsp;round:&nbsp;&nbsp;b6&nbsp;ff&nbsp;74&nbsp;4e&nbsp;d2&nbsp;c2&nbsp;c9&nbsp;bf&nbsp;6c&nbsp;59&nbsp;0c&nbsp;bf&nbsp;04&nbsp;69&nbsp;bf&nbsp;41
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mix:&nbsp;&nbsp;4c&nbsp;9c&nbsp;1e&nbsp;66&nbsp;f7&nbsp;71&nbsp;f0&nbsp;76&nbsp;2c&nbsp;3f&nbsp;86&nbsp;8e&nbsp;53&nbsp;4d&nbsp;f2&nbsp;56
&nbsp;&nbsp;&nbsp;shift:&nbsp;&nbsp;3b&nbsp;d9&nbsp;22&nbsp;68&nbsp;fc&nbsp;74&nbsp;fb&nbsp;73&nbsp;57&nbsp;67&nbsp;cb&nbsp;e0&nbsp;c0&nbsp;59&nbsp;0e&nbsp;2d
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub:&nbsp;&nbsp;3b&nbsp;59&nbsp;cb&nbsp;73&nbsp;fc&nbsp;d9&nbsp;0e&nbsp;e0&nbsp;57&nbsp;74&nbsp;22&nbsp;2d&nbsp;c0&nbsp;67&nbsp;fb&nbsp;68
&nbsp;&nbsp;&nbsp;state:&nbsp;&nbsp;49&nbsp;15&nbsp;59&nbsp;8f&nbsp;55&nbsp;e5&nbsp;d7&nbsp;a0&nbsp;da&nbsp;ca&nbsp;94&nbsp;fa&nbsp;1f&nbsp;0a&nbsp;63&nbsp;f7
Round&nbsp;2:
&nbsp;&nbsp;&nbsp;input:&nbsp;&nbsp;49&nbsp;15&nbsp;59&nbsp;8f&nbsp;55&nbsp;e5&nbsp;d7&nbsp;a0&nbsp;da&nbsp;ca&nbsp;94&nbsp;fa&nbsp;1f&nbsp;0a&nbsp;63&nbsp;f7
&nbsp;&nbsp;&nbsp;round:&nbsp;&nbsp;b6&nbsp;92&nbsp;cf&nbsp;0b&nbsp;64&nbsp;3d&nbsp;bd&nbsp;f1&nbsp;be&nbsp;9b&nbsp;c5&nbsp;00&nbsp;68&nbsp;30&nbsp;b3&nbsp;fe
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mix:&nbsp;&nbsp;ff&nbsp;87&nbsp;96&nbsp;84&nbsp;31&nbsp;d8&nbsp;6a&nbsp;51&nbsp;64&nbsp;51&nbsp;51&nbsp;fa&nbsp;77&nbsp;3a&nbsp;d0&nbsp;09
&nbsp;&nbsp;&nbsp;shift:&nbsp;&nbsp;a7&nbsp;be&nbsp;1a&nbsp;69&nbsp;97&nbsp;ad&nbsp;73&nbsp;9b&nbsp;d8&nbsp;c9&nbsp;ca&nbsp;45&nbsp;1f&nbsp;61&nbsp;8b&nbsp;61
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub:&nbsp;&nbsp;a7&nbsp;61&nbsp;ca&nbsp;9b&nbsp;97&nbsp;be&nbsp;8b&nbsp;45&nbsp;d8&nbsp;ad&nbsp;1a&nbsp;61&nbsp;1f&nbsp;c9&nbsp;73&nbsp;69
&nbsp;&nbsp;&nbsp;state:&nbsp;&nbsp;89&nbsp;d8&nbsp;10&nbsp;e8&nbsp;85&nbsp;5a&nbsp;ce&nbsp;68&nbsp;2d&nbsp;18&nbsp;43&nbsp;d8&nbsp;cb&nbsp;12&nbsp;8f&nbsp;e4
&nbsp;Round&nbsp;1:
&nbsp;&nbsp;&nbsp;input:&nbsp;&nbsp;89&nbsp;d8&nbsp;10&nbsp;e8&nbsp;85&nbsp;5a&nbsp;ce&nbsp;68&nbsp;2d&nbsp;18&nbsp;43&nbsp;d8&nbsp;cb&nbsp;12&nbsp;8f&nbsp;e4
&nbsp;&nbsp;&nbsp;round:&nbsp;&nbsp;d6&nbsp;aa&nbsp;74&nbsp;fd&nbsp;d2&nbsp;af&nbsp;72&nbsp;fa&nbsp;da&nbsp;a6&nbsp;78&nbsp;f1&nbsp;d6&nbsp;ab&nbsp;76&nbsp;fe
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mix:&nbsp;&nbsp;5f&nbsp;72&nbsp;64&nbsp;15&nbsp;57&nbsp;f5&nbsp;bc&nbsp;92&nbsp;f7&nbsp;be&nbsp;3b&nbsp;29&nbsp;1d&nbsp;b9&nbsp;f9&nbsp;1a
&nbsp;&nbsp;&nbsp;shift:&nbsp;&nbsp;63&nbsp;53&nbsp;e0&nbsp;8c&nbsp;09&nbsp;60&nbsp;e1&nbsp;04&nbsp;cd&nbsp;70&nbsp;b7&nbsp;51&nbsp;ba&nbsp;ca&nbsp;d0&nbsp;e7
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub:&nbsp;&nbsp;63&nbsp;ca&nbsp;b7&nbsp;04&nbsp;09&nbsp;53&nbsp;d0&nbsp;51&nbsp;cd&nbsp;60&nbsp;e0&nbsp;e7&nbsp;ba&nbsp;70&nbsp;e1&nbsp;8c
&nbsp;&nbsp;&nbsp;state:&nbsp;&nbsp;00&nbsp;10&nbsp;20&nbsp;30&nbsp;40&nbsp;50&nbsp;60&nbsp;70&nbsp;80&nbsp;90&nbsp;a0&nbsp;b0&nbsp;c0&nbsp;d0&nbsp;e0&nbsp;f0
&nbsp;Round&nbsp;0:
&nbsp;&nbsp;&nbsp;input:&nbsp;&nbsp;00&nbsp;10&nbsp;20&nbsp;30&nbsp;40&nbsp;50&nbsp;60&nbsp;70&nbsp;80&nbsp;90&nbsp;a0&nbsp;b0&nbsp;c0&nbsp;d0&nbsp;e0&nbsp;f0
&nbsp;&nbsp;&nbsp;round:&nbsp;&nbsp;00&nbsp;01&nbsp;02&nbsp;03&nbsp;04&nbsp;05&nbsp;06&nbsp;07&nbsp;08&nbsp;09&nbsp;0a&nbsp;0b&nbsp;0c&nbsp;0d&nbsp;0e&nbsp;0f
&nbsp;&nbsp;&nbsp;state:&nbsp;&nbsp;00&nbsp;11&nbsp;22&nbsp;33&nbsp;44&nbsp;55&nbsp;66&nbsp;77&nbsp;88&nbsp;99&nbsp;aa&nbsp;bb&nbsp;cc&nbsp;dd&nbsp;ee&nbsp;ff
Output:
&nbsp;&nbsp;&nbsp;plain:&nbsp;&nbsp;00&nbsp;11&nbsp;22&nbsp;33&nbsp;44&nbsp;55&nbsp;66&nbsp;77&nbsp;88&nbsp;99&nbsp;aa&nbsp;bb&nbsp;cc&nbsp;dd&nbsp;ee&nbsp;ff</pre><p style="text-indent: 2em; text-align: left;"><br/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;"><br/></span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">算法设计思想</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">加密算法的一般设计准则</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">混淆 (Confusion)</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">最大限度地复杂化密文、明文与密钥之间的关系，通常用非线性变换算法达到最大化的混淆。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">扩散 (Diffusion)</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">明文或密钥每变动一位将最大化地影响密文中的位数，通常采用线性变换算法达到最大化的扩散。</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">AES评判要求</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">NIST在征集算法的时候就提出了几项硬性要求：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">分组加密算法：支持128位分组大小，128/192/256位密钥</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">安全性不低于3DES，但实施与执行要比3DES的更高效</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">优化过的ANSI C的实现代码</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">KAT(Known-Answer tests)及MCT(Monte Carlo Tests)测试及验证</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">软件及硬件实现的便捷</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">可抵御已知攻击</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Rijndael设计思想</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">安全性（Security）</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">算法足够强，抗攻击</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">经济性（Efficiency）</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">算法运算效率高</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">密钥捷变（Key Agility）</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">更改密钥所引入的损失尽量小，即最小消耗的密钥扩展算法</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">适应性 （Versatility）</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">适用于不同的CPU架构，软件或硬件平台的实现</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">设计简单（Simplicity）</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">轮函数的设计精简，只是多轮迭代</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">S盒设计</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">S盒是由一个有限域GF(256)上的乘法求逆并串联线性仿射变换所构造出来的，不是一个随意构造的简单查询表。因其运算复杂，众多的AES 软件及硬件实现直接使用了查找表(LUP, Look-up table)，但查询表的方式并不适合所有场景，针对特定的硬件最小化面积设计需求，则要采用优化的组合逻辑以得到同价的S盒替换。</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br/></span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">工作模式</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">分组加密算法是按分组大小来进行加解密操作的，如DES算法的分组是64位，而AES是128位，但实际明文的长度一般要远大于分组大小，这样的情况如何处理呢？</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">这正是&quot;mode of operation&quot;即工作模式要解决的问题：明文数据流怎样按分组大小切分，数据不对齐的情况怎么处理等等。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">早在1981年，DES算法公布之后，NIST在标准文献FIPS 81中公布了4种工作模式：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 176, 80);">电子密码本：Electronic Code Book Mode (ECB)</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 176, 80);">密码分组链接：Cipher Block Chaining Mode (CBC)</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 176, 80);">密文反馈：Cipher Feedback Mode (CFB)</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 176, 80);">输出反馈：Output Feedback Mode (OFB)</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">2001年又针对AES加入了新的工作模式：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 176, 80);">计数器模式：Counter Mode (CTR)</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">后来又陆续引入其它新的工作模式。在此仅介绍几种常用的：</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">ECB：电子密码本模式</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">ECB模式只是将明文按分组大小切分，然后用同样的密钥正常加密切分好的明文分组。</span></p><p style="text-align:center"><img src="http://p6.qhimg.com/t01c086b008bdf9e530.png" title="t01ebd0a753f21a658d.png" alt="http://p1.qhimg.com/t01ebd0a753f21a658d.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">ECB的理想应用场景是短数据（如加密密钥）的加密。此模式的问题是无法隐藏原明文数据的模式，因为同样的明文分组加密得到的密文也是一样的。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">举例来说明，下图为明文图片：</span></p><p style="text-align:center"><img src="http://p9.qhimg.com/t0120c2f5802895baad.png" title="t01847df31366f83706.png" alt="http://p8.qhimg.com/t01847df31366f83706.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">经ECB模式加密的图片：</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t01c2a579371737480d.png" title="t01e70a023e8c466294.png" alt="http://p7.qhimg.com/t01e70a023e8c466294.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">图中也正好验证了AES的扩散效果：作为局部图案的叶子，其红颜色在加密后扩散到了整张图片上。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">经CBC模式加密的图片：</span></p><p style="text-align:center"><img src="http://p2.qhimg.com/t01e2a8a5d6d5043cab.jpg" title="t01dc91dff70030dc21.jpg" alt="http://p3.qhimg.com/t01dc91dff70030dc21.jpg"/></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">CBC：密码分组链接模式</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">此模式是1976年由IBM所发明，引入了IV（初始化向量：Initialization Vector）的概念。IV是长度为分组大小的一组随机，通常情况下不用保密，不过在大多数情况下，针对同一密钥不应多次使用同一组IV。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">CBC要求第一个分组的明文在加密运算前先与IV进行异或；从第二组开始，所有的明文先与前一分组加密后的密文进行异或。[区块链(blockchain)的鼻祖！]</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t01de0f2529bf5eba08.png" title="t01211890074c5e93a3.png" alt="http://p4.qhimg.com/t01211890074c5e93a3.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">CBC模式相比ECB实现了更好的模式隐藏，但因为其将密文引入运算，加解密操作无法并行操作。同时引入的IV向量，还需要加、解密双方共同知晓方可。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">实现代码：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><pre class="brush:plain;toolbar:false">int&nbsp;aes_encrypt_cbc(AES_CYPHER_T&nbsp;mode,&nbsp;uint8_t&nbsp;*data,&nbsp;int&nbsp;len,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uint8_t&nbsp;*key,&nbsp;uint8_t&nbsp;*iv)
{
&nbsp;&nbsp;&nbsp;&nbsp;uint8_t&nbsp;w[4&nbsp;*&nbsp;4&nbsp;*&nbsp;15]&nbsp;=&nbsp;{0};&nbsp;/*&nbsp;round&nbsp;key&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;uint8_t&nbsp;s[4&nbsp;*&nbsp;4]&nbsp;=&nbsp;{0};&nbsp;/*&nbsp;state&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;uint8_t&nbsp;v[4&nbsp;*&nbsp;4]&nbsp;=&nbsp;{0};&nbsp;/*&nbsp;iv&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;nr,&nbsp;i,&nbsp;j;
&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;key&nbsp;expansion&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;aes_key_expansion(mode,&nbsp;key,&nbsp;w);
&nbsp;&nbsp;&nbsp;&nbsp;memcpy(v,&nbsp;iv,&nbsp;sizeof(v));
&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;start&nbsp;data&nbsp;cypher&nbsp;loop&nbsp;over&nbsp;input&nbsp;buffer&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;len;&nbsp;i&nbsp;+=&nbsp;4&nbsp;*&nbsp;g_aes_nb[mode])&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;init&nbsp;state&nbsp;from&nbsp;user&nbsp;buffer&nbsp;(plaintext)&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(j&nbsp;=&nbsp;0;&nbsp;j&nbsp;&lt;&nbsp;4&nbsp;*&nbsp;g_aes_nb[mode];&nbsp;j++)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s[j]&nbsp;=&nbsp;data[i&nbsp;+&nbsp;j]&nbsp;^&nbsp;v[j];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;start&nbsp;AES&nbsp;cypher&nbsp;loop&nbsp;over&nbsp;all&nbsp;AES&nbsp;rounds&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(nr&nbsp;=&nbsp;0;&nbsp;nr&nbsp;&lt;=&nbsp;g_aes_rounds[mode];&nbsp;nr++)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(nr&nbsp;&gt;&nbsp;0)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;do&nbsp;SubBytes&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aes_sub_bytes(mode,&nbsp;s);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;do&nbsp;ShiftRows&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aes_shift_rows(mode,&nbsp;s);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(nr&nbsp;&lt;&nbsp;g_aes_rounds[mode])&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;do&nbsp;MixColumns&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aes_mix_columns(mode,&nbsp;s);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;do&nbsp;AddRoundKey&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aes_add_round_key(mode,&nbsp;s,&nbsp;w,&nbsp;nr);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*&nbsp;save&nbsp;state&nbsp;(cypher)&nbsp;to&nbsp;user&nbsp;buffer&nbsp;*/
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(j&nbsp;=&nbsp;0;&nbsp;j&nbsp;&lt;&nbsp;4&nbsp;*&nbsp;g_aes_nb[mode];&nbsp;j++)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data[i&nbsp;+&nbsp;j]&nbsp;=&nbsp;v[j]&nbsp;=&nbsp;s[j];
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;
}</pre><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">CFB：密文反馈模式</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">与CBC模式类似，但不同的地方在于，CFB模式先生成密码流字典，然后用密码字典与明文进行异或操作并最终生成密文。后一分组的密码字典的生成需要前一分组的密文参与运算。</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t011234ee0661bc0588.png" title="t0170ff7f533e7fd007.png" alt="http://p7.qhimg.com/t0170ff7f533e7fd007.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">CFB模式是用分组算法实现流算法，明文数据不需要按分组大小对齐。</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">OFB：输出反馈模式</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">OFB模式与CFB模式不同的地方是：生成字典的时候会采用明文参与运算，CFB采用的是密文。</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t016bf96d150bbc4c18.png" title="t01fc03f8f0573afcc1.png" alt="http://p6.qhimg.com/t01fc03f8f0573afcc1.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">CTR：计数器模式模式</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">CTR模式同样会产生流密码字典，但同是会引入一个计数，以保证任意长时间均不会产生重复输出。</span></p><p style="text-align:center"><img src="http://p5.qhimg.com/t01e6d1419b4085e55d.png" title="t01897ad3acb72bbe31.png" alt="http://p8.qhimg.com/t01897ad3acb72bbe31.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">CTR模式只需要实现加密算法以生成字典，明文数据与之异或后得到密文，反之便是解密过程。CTR模式可以采用并行算法处理以提升吞量，另外加密数据块的访问可以是随机的，与前后上下文无关。</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">CCM：Counter with CBC-MAC</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">CCM模式，全称是Counter with Cipher Block Chaining-Message Authentication Code，是CTR工作模式和CMAC认证算法的组合体，可以同时数据加密和鉴别服务。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">明文数据通过CTR模式加密成密文，然后在密文后面再附加上认证数据，所以最终的密文会比明文要长。具体的加密流程如下描述：先对明文数据认证并产生一个tag，在后续加密过程中使用此tag和IV生成校验值U。然后用CTR模式来加密原输入明文数据，在密文的后面附上校验码Ｕ。</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">GCM：伽罗瓦计数器模式</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">类型CCM模式，GCM模式是CTR和GHASH的组合，GHASH操作定义为密文结果与密钥以及消息长度在GF（2^128）域上相乘。GCM比CCM的优势是在于更高并行度及更好的性能。TLS 1.2标准使用的就是AES-GCM算法，并且Intel CPU提供了GHASH的硬件加速功能。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">硬件加速</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">AES作为主导的加密标准，其应用越来越广泛，特别是针对网络数据的加密需求，越来越多的硬件都集成AES 128/192/256位算法及不同的工作模式的硬件加速的实现。</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">AES_NI: X86架构</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Intel于2010发发布了支持AES加速的CPU，实现了高阶的AES加解密指令即AES_NI：AES New Instructions。AES_NI包含6指令：其中4条用于加解密，2条用于密钥扩展。根据</span><a href="https://software.intel.com/sites/default/files/article/165683/aes-wp-2012-09-22-v01.pdf" target="_self" style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-decoration: underline;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">[AES_NI白皮书]</span></a><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">中所说，AES_NI可以带来2-3倍的性能提升。</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t0167e9dfd6116456bd.png" title="t0184b4ad2a0d55f635.png" alt="http://p6.qhimg.com/t0184b4ad2a0d55f635.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">目前OpenSSL，Linux&#39;s Crypto API以及Windows Cryptography API中均已加入对AES_NI的支持。</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">AES_NI: 测试</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">测试环境：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><pre class="brush:plain;toolbar:false">Intel(R)&nbsp;Core(TM)&nbsp;i7-4790&nbsp;CPU&nbsp;@&nbsp;3.60GHz&nbsp;4&nbsp;Cores&nbsp;with&nbsp;HyperThread&nbsp;(Enabled&nbsp;or&nbsp;Disabled)
Ubuntu&nbsp;16.04&nbsp;AMD64,&nbsp;OpenSSL&nbsp;1.0.2g-fips&nbsp;&nbsp;1&nbsp;Mar&nbsp;2016</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">测试方法：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">关闭硬件加速1/2/4/8线程AES-256/128-CBC：</span></p><pre class="brush:plain;toolbar:false">OPENSSL_ia32cap=&quot;~0x200000200000000&quot;&nbsp;openssl&nbsp;speed&nbsp;-multi&nbsp;{1/2/4/8}&nbsp;-elapsed&nbsp;-evp&nbsp;{aes-256/128-cbc}</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">开启硬件加速1/2/4/8线程AES-256/128-CBC：</span></p><pre class="brush:plain;toolbar:false">openssl&nbsp;speed&nbsp;-multi&nbsp;{1/2/4/8}&nbsp;-elapsed&nbsp;-evp&nbsp;{aes-256/128-cbc}</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">超线程的开户与关闭只能通过UEFI/BIOS来设置，测试命令同上。</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t01bd047048147ba29a.png" title="t01bd047048147ba29a.png" alt="http://p4.qhimg.com/t01bd047048147ba29a.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">从图中可以得到如下结论：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">AES_NI加速可以提升性能1倍多，AESNI-128基本上都是AES-128的2.2倍左右。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">AES-128与AES-256的性能比基本在1.36左右（15/11，忽略密钥编排用时的情况下）</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">比较有趣的一点发现是，超线程所带来的影响比预想的要大得多。针对高并行的情形，在开启AES_NI时超线程可以带来接近1倍的性能提升；但在关闭AES_NI的情况下对性能提升的贡献要小的多。超线程虽然逻辑上让我们觉得一核变成了两核，其实质只是同一物理核上的队列管理机制，关闭AES_NI的情况下的测试数据基本验证了这一点。另一方面AES_NI硬件加速是基于物理核的，不可能是针对超线程的，所以超线程与AES_NI组合所带来的巨大的性能提升让人有些费解，比较可能的解释是AES_NI硬件加速引擎的潜力足够强大以至于一个物理核心不能完全发挥其效能，所以在超线程开启的情况下能有更好的表现。</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">ARM及其它体系</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">2011年发布的ARMv8-A处理器架构开始支持AES加速指令，其指令集与AES_NI不兼容但实现了类似的功能。除ARM外，SUN SPARC(T4, T5, M5以后)及IBM Power7+架构的CPU均已支持AES加速。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">实现上的安全性考虑</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">内存与交换</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">程序如果将密钥存储在可交换内存页中，在内存吃紧的情况下有可能会交换出来并写入磁盘。如辅以代码逆向等，密钥很有可能会泄露。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">应用层最好用mlock(Linux)或VirtualLock(Windows)来防止内存页被交换至磁盘。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">但因为密钥在内存中，所以任何能访问内存的方式均有可能导致密钥的泄漏。曾流行的一种攻击是通过1394 DMA方式来访问目标机内存，Linux/Windows Login bypass，Windows bitlock等漏洞均由起引起。较新的CPU为硬件虚拟化所引入的IO MMU （Intel VT-d or AMD-Vi）可以有效地限制硬件对内存的访问权限。</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">传统攻击</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">AES从产生至今依然是最安全的加密算法，传统攻击手段依然无法撼动其安全性。虽然已有攻击手段显示可以将AES-256的暴力搜索次数从2^256次降至2^119次，但依然没有实际操作价值。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">不过随着计算力的提升，特别是量子计算机的发展，AES将不再是安全的。当然可以肯定的是：一定会出现更安全的加密算法。</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">旁路攻击</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">旁路攻击（Side-channel attack, SCA）是指绕过对加密算法的正面对抗及分析，利用硬件实现加密算法的逻辑电路在运算中所泄露的信息，如执行时间、功耗、电磁辐射等，并结合统计理论来实现对密码系统攻击的手段。</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">旁路攻击条件</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">旁路攻击成功的必要条件：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">在泄漏的物理信号与处理的数据之间建立关联</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">在信息泄漏模型中处理的数据与芯片中处理的数据之间建立关联</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">智能卡CPU的实现逻辑相对比较简单，并且都是单线程处理机制，因此可以很好的建立起密码-时序或密码-功耗之间的关联。</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">时序攻击</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">不同的数值及不同的运算所需时间是不同的，在算法(运算逻辑)固定的前提下完全可以根据运行时间反推出具体的操作数。举个简单的例子：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><pre class="brush:plain;toolbar:false">if&nbsp;(strelen(passwd)&nbsp;!=&nbsp;sizeof(fixed_passwd))
&nbsp;&nbsp;return&nbsp;0;
for&nbsp;(i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;sizeof(fixed_passwd);&nbsp;i++)
&nbsp;&nbsp;if&nbsp;(passwd[i]&nbsp;!=&nbsp;fixed_passwd[i])
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">这段代码在密码的判断上就存在时序攻击的漏洞，如果第一个字符不匹配则直接退出，只有在当前字符匹配的情况下才会继续下一个字符的比较。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">所以如果实际密码长度为8位且只能用字母及数字，则理论上暴力搜索次数为 (26 2 + 10) ^ 8。但因为算法的实现没有考虑到时序攻击，如果将执行时间加入考量，则搜索次数将降低至(26 2 + 10) * 8。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">本文示例代码中aes_mul()的实现也有时序攻击的漏洞，并且实现效率也比较低，当然主要目的是为了算法演示。</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">功耗攻击</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">当信号发生0-1跳变时，需要电源对电容进行充电；而在其它三种情况(0-0, 1-1, 1-0)下则不会进行充电操作，因此可以很容易区分出前者来，这就是功耗攻击原理的简单解释。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">功耗攻击一般分为简单功耗攻击(Simple Power Analysis，SPA)，差分功耗攻击(Differential Power Analysis, DPA)，高阶DPA等。SPA可以揭示出执行操作和能耗泄露间的关系，而DPA则能够揭示出处理数据和能耗泄露间的关系。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">DPA利用不同数据对应的条件功耗分布的差异进行统计分析以找出数值与功耗的微弱关联性，并利用此关联性极大的降低密钥的搜索空间，进而完成高效且低成本的攻击。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">上海交大的教授<a href="http://yuyu.hk/" target="_self">郁昱</a>就通过功耗攻击成功破解了来自多家手机制造商以及服务供应商的SIM卡的密钥。更详细信息可见于他在Blackhat 2015年的<a href="http://yuyu.hk/files/us-15-Yu-Cloning-3G-4G-Sim-Cards.pdf" target="_self">演示稿: Cloning 3G/4G SIM Cards with a PC and an Oscilloscope: Lessons Learned in Physical Security</a>。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">以色列特拉维夫大学的研究人员利用旁路攻击，成功从Android和iOS设备上窃取到用于加密比特币钱包、Apple Pay账号和其他高价值资产的密钥，详细请参阅<a href="https://www.cs.tau.ac.il/~tromer/mobilesc/mobilesc.pdf" target="_self">论文: ECDSA Key Extraction from Mobile Devices via Nonintrusive Physical Side Channels</a>。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">参考资料</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">密码学原理与实践(第二版)，Douglas R. Stinson，冯登国译</span></p><p style="text-indent: 2em; text-align: left;"><a href="http://csrc.nist.gov/archive/aes/rijndael/Rijndael-ammended.pdf" target="_self"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">AES Proposal: Rijndael by Joan Daemen and Vincent Rijmen</span></a></p><p style="text-indent: 2em; text-align: left;"><a href="http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf" target="_self"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">FIPS 197: Announcing the AES</span></a></p><p style="text-indent: 2em; text-align: left;"><a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard" target="_self"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Advanced Encryption Standard - Wikipedia</span></a></p><p style="text-indent: 2em; text-align: left;"><a href="http://www.springer.com/gp/book/9783540425809" target="_self"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">The Design of Rijndael by Joan Daemen &amp; Vincent Rijmen</span></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">The Block Cipher Companion, L. Knudsen &amp; M. Robshaw, 2011</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">加密芯片的旁道攻击防御对策研究(博士学位论文), 李海军, 2008</span></p><p style="text-indent: 2em; text-align: left;"><a href="https://g2ex.github.io/2016/05/31/Power-Analysis-Attacks-on-Smart-Card/" target="_self"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">旁路之能量分析攻击总结</span></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">AES算法介绍: 万天添，2015/3/23</span></p><p style="text-indent: 2em; text-align: left;"><a href="https://en.wikipedia.org/wiki/AES_instruction_set" target="_self"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">AES_NI - Wikipedia</span></a></p><p style="text-indent: 2em; text-align: left;"><a href="https://software.intel.com/en-us/articles/intel-advanced-encryption-standard-aes-instructions-set/" target="_self"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">AES_NI v3.01 - Intel</span></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">相关代码</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><a href="https://github.com/matt-wu/AES/" _src="https://github.com/matt-wu/AES/" style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">https://github.com/matt-wu/AES/</a><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">&nbsp;</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">&lt;最早的手工计算AES-128的想法来源于2016年底读过的一本书《How Software Works: The Magic Behind Encryption ...》，在阅读过程中发现AES一节中的数据全对不上，然后于17年初开始翻阅AES及Rijndael算法标准等资料，等看完所有文档后才发现此书对AES的介绍真是简化得没边了，后来又做了大量的延伸阅读，春节期间根据FIPS 197及《The Design of Rijndael》实现了AES 128/192/256 ECB/CBC的计算过程，之后开始本blog的书写，中间断断续续直至今日才完工，本文估计用时约40小时。学习从来不是容易的事！但越是不容易的事情做起来才更有乐趣！&gt;</span></p></p>
                <hr/>
                <p style="text-align: center;">
                    <img src="http://bobao.360.cn/img/app.jpeg"/>
                    <img src="http://bobao.360.cn/img/weixin.jpeg"/>
                </p>
                                <p>本文由 安全客 原创发布，如需转载请注明来源及本文地址。<br/>本文地址：http://bobao.360.cn/learning/detail/3590.html
                </p>
                            </div>
            <div style="margin-top: 20px;background-color:#FFFFFF">
    <input type="hidden" id="detail_title" name="detail_title" value="【技术分享】AES标准及Rijndael算法解析 - 安全客 - 有思想的安全新媒体" />
    <input type="hidden" id="use_nickname" name="use_nickname" value="0" />
    <a name="mao"></a>
    <div class="reg-log mobile-hiden">
        <div class="" id="userTo">   
            <div id="to-list" class="input-text" style="">
                <textarea disabled="disabled" class="hide"  id="comment-content" to="to"></textarea>
                <ul id="preadded" style="display:none">       
                </ul>
                <div id="to-auto" style="width: 200px">
                    <ul id="feed">
                    </ul>
                </div>
            </div>
        </div>
        <input type="hidden" id="source-id" value="3590" />
        <input type="hidden" id="source-type" value="learning" />
        <input type="hidden" id="post-comment-url" value="/comment/add" />
        <input type="hidden" id="post-nickname-url-ajax" value="/comment/randnicknameajax" />
        <input type="hidden" id="post-check-login-url-ajax" value="/comment/checklogin" />
        <input type="hidden" id="stoken_comment_set" value="ea3898fb4df38673fdeb61c458234054">                 <span class="join">参与讨论，请先 <a href="javascript:;" class="comment-login">登录</a> | <a href="javascript:;" class="comment-reg">注册</a> |  <a href="javascript:;" class="anonymous-comment">匿名评论</a></span>
            </div>
    <div class="mobile-hide" style="width: 870px; margin: 0 auto;">
        <label style="vertical-align:middle;" for="use_nickname">匿名</label> 
        <input style="vertical-align:middle;" id="trigger-nickname" name="use_nickname" class="use_nickname" type="checkbox" value="0" />

        <a href="javascript:;" class="apply-use button" id="submit-comment" data-target="/comment/add">发布</a>
    </div>


    <div class="clearfix"></div>
    <div class="comments">
        <div class="comments-head">
            <span class="title">用户评论</span>
        </div>
                <div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/2x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="14612" user-name="Mickey牛" href="javascript:;">
                Mickey牛            </a>
                        <span class="comment-time">2017-06-14 10:52:50</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="14612">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_14612" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">虽然看不明白，但是感觉很厉害的样子。uber还是干不赢我们滴滴啊，滴滴一出 uber就不行了。want to find cheap 4 color offset printing plastic card factory in china ? I can give you some recommendation. 
1, Putian Cards-Mart Company Limited, visit http://new.cards-mart.com/
2, Printingforless. http://www.printingforless.com/
3, Ultrawise Technology Co.,Limited, visit http://www.ultrawisetech.com/ and store.ultrawisetech.com.
4, CushyPrinting. visit http://www.cushyprinting.com/</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>

        <a class="more-long comment-more" href="javascript:;" data-target="/comment/more" data-type="learning" data-source-id="3590" data-page="2">查看更多</a>
            </div>
</div>
<script>
    $(function () {
        $('.anonymous-comment').click(function () {
            $(".join").hide();
            $(".reg-log textarea").first().removeAttr("disabled").show();
            $('#use_nickname').val('1');
//            $('#trigger-nickname').attr('checked', true);
            $('#trigger-nickname').trigger('click');
        });
        //为所有复选框绑定事件
//        checkbox_on_click();
        //ajax随机获取昵称
//        randnicknameajax(0);
        //ajax检测登录状态
        comment_check_login();
    });



    function input_checkbox(flag) {
        $('input:checkbox').each(function () {
            var value = flag ? 1 : 0;
            $(this).prop('checked', flag);
            $(this).val(value);
        });
    }

//ajax随机获取昵称
    function randnicknameajax(flag) {
        $.ajax({
            type: 'POST',
            url: $('#post-nickname-url-ajax').val(),
            data: {limit: 1, flag: flag},
            dataType: "json",
            success: function (data) {
                $('#nick-name').val(data.data[0]);
                _nick_name=data.data[0];
            }
        });
    }
    $();
//ajax检测登录状态
    function comment_check_login() {
        $.ajax({
            type: 'POST',
            url: $('#post-check-login-url-ajax').val(),
            data: {},
            dataType: "json",
            success: function (data) {
                if (data.success) {
                    $('.join').hide();
                    $(".reg-log textarea").first().removeAttr("disabled").show();
                    $("#span_use_nickname").show();
                    $('#use_nickname').val('0');
                    $('#use_nickname').attr('checked', false);
                }
            }
        });
    }
</script>        </div>
    </div>
    <div class="side-bar">
        <div class="mod hot-news">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-hot"></i><span>热门知识</span></h2>
    </div>
    <ul class="links-list">
                                <li><a href="/learning/detail/4411.html" alt="【漏洞预警】一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现——最新的Office高级威胁攻击预警" target="_blank">【漏洞预警】一个换行符引发的奥斯卡...</a></li>
                                <li><a href="/learning/detail/4416.html" alt="【漏洞预警】Microsoft .NET Framework漏洞（CVE–2017–8759）预警" target="_blank">【漏洞预警】Microsoft .NE...</a></li>
                                <li><a href="/learning/detail/4414.html" alt="【技术分享】妙用JavaScript绕过XSS过滤" target="_blank">【技术分享】妙用JavaScrip...</a></li>
                                <li><a href="/learning/detail/4418.html" alt="【技术分享】利用威胁情报数据平台拓展APT攻击线索一例" target="_blank">【技术分享】利用威胁情报数据平台拓...</a></li>
                                <li><a href="/learning/detail/4417.html" alt="【知识】9月15日 - 每日安全知识热点" target="_blank">【知识】9月15日 - 每日安全知识热...</a></li>
                                <li><a href="/learning/detail/4425.html" alt="【安全报告】XShellGhost事件技术回顾报告" target="_blank">【安全报告】XShellGhost事件...</a></li>
            </ul>
</div>        <!-- 友情链接 -->
        <div class="mod blog-links mobile-hide">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-link"></i><span>友情链接</span></h2>
        <a href="/links/index.html" class="more">更多<i></i></a>
    </div>
        <ul class="links-list">
                <li><a href="http://bbs.360safe.com" alt="360安全社区" target="_blank">360安全社区</a></li>
                <li><a href="http://zhuji.360.cn" alt="360主机卫士" target="_blank">360主机卫士</a></li>
                <li><a href="http://blogs.360.cn/" alt="奇虎360技术博客" target="_blank">奇虎360技术博客</a></li>
                <li><a href="http://wangzhan.360.cn/" alt="360网站卫士" target="_blank">360网站卫士</a></li>
                <li><a href="http://webscan.360.cn/" alt="360网站安全检测" target="_blank">360网站安全检测</a></li>
                <li><a href="http://research.360.cn/report/" alt="360研究报告" target="_blank">360研究报告</a></li>
                <li><a href="http://unicorn.360.cn/" alt="360 Unicorn Team" target="_blank">360 Unicorn Team</a></li>
                <li><a href="http://appscan.360.cn/" alt="360捉虫猎手" target="_blank">360捉虫猎手</a></li>
                <li><a href="https://threathunter.org/" alt="ThreatHunter社区" target="_blank">ThreatHunter社区</a></li>
                <li><a href="http://security.360.cn/" alt="360安全应急响应中心" target="_blank">360安全应急响应中心</a></li>
            </ul>
    </div>
        <!-- 联系我们 -->
        <div class="mod contact mobile-hide" style="text-align:center">
    <div class="head-bar clearfix">
        <h2><i></i><span>关注我们</span></h2>
    </div>
    <!-- 微信关注 -->
    <ul class="contact-way">
        <li><a>微信关注</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/qrcode_adlab_weixin.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
    <!-- APP下载 -->
    <ul class="contact-way">
        <li><a>安全播报APP</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/scan_code_big.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
</div>

    </div>
</div>

<script type="text/javascript" src="/js/jquery-ui.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/jquery.noty.packaged.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/common.js?v=4.5"></script>
<script>$(function() {sync_count('comment');});</script>


<!-- 语法高亮 -->
<script type="text/javascript" src="/ue/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">SyntaxHighlighter.all();sync_count('vul');sync_count('news');sync_count('learning');sync_count('activity');sync_count('course');sync_count('ctf');</script>
    </div>

        <div class="footer">
        <div class="friend-link">
            <a href="http://www.360.cn/" target="_blank">360首页</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">关于我们</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">联系我们</a>
            <span>|</span>
            <a href="/links/index.html" target="_blank">友情链接</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">招贤纳士</a>
        </div>
        <div class="copy">
            Copyright &copy; 360网络攻防实验室 All Rights Reserved <span class="copy_icp">京ICP证080047号[京ICP备08010314号-6]</span>
        </div>
    </div>
    
</div>

<!--奇舞团统计-->

<script src='https://s.ssl.qhimg.com/static/f5407c785655e6a1/monitor_analytic.js'></script>
<script>
    monitor.setProject('QH_171_1').getTrack().getClickAndKeydown().getClickHeatmap(10, 1);
</script>

<div class="hide">
    <script src="https://s95.cnzz.com/z_stat.php?id=1253147824&web_id=1253147824" language="JavaScript"></script>
</div>
<div class="backToTop_wrap off">
    <a id="back_to_top" class="backToTop" href="javascript:;" title="返回顶部"></a>
</div>
<script>
    var $backToTop_wrap = $(".backToTop_wrap"),
        $backToTop_btn = $("#back_to_top");

    if ($(window).scrollTop() > 100) {
        $backToTop_wrap.removeClass("off");
    }
    else {
        $backToTop_wrap.addClass("off");
    }

    $(window).on("scroll", function () {
        if ($(this).scrollTop() > 100) {
            $backToTop_wrap.removeClass("off");
        }
        else {
            $backToTop_wrap.addClass("off");
        }
    });

    $backToTop_btn.on("click", function () {
        $("html, body").animate({scrollTop: 0}, 120);
    });

    $(function () {
        var navlist = $('.nav-list > li');

        navlist.each(function () {
            $(this).on('mouseenter', function () {
                $(this).addClass('selected');
            });

            $(this).on('mouseleave', function () {
                $(this).removeClass('selected');
            });
        });
    })
</script>



</body>
</html>
