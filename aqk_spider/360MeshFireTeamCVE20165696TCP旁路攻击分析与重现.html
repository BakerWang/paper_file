<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:wb="http://open.weibo.com/wb" xml:lang="en" lang="en">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <link rel="shortcut icon" href="http://bobao.360.cn/favicon.ico?v=1.1"/>
    <link rel="alternate" title="安全资讯" href="/rss?type=news" type="application/rss+xml"/>
    <link rel="alternate" title="安全知识" href="/rss?type=learning" type="application/rss+xml"/>
    <link rel="alternate" title="安全圈活动" href="/rss?type=activity" type="application/rss+xml"/>
    <link rel="alternate" title="所有漏洞" href="/rss?type=vul" type="application/rss+xml"/>
    <link rel="alternate" title="通用型漏洞" href="/rss?type=commonvul" type="application/rss+xml"/>
    <link rel="alternate" title="事件型漏洞" href="/rss?type=eventvul" type="application/rss+xml"/>
    <link rel="alternate" title="热门漏洞" href="/rss?type=hotvul" type="application/rss+xml"/>

        <title>360MeshFire Team：CVE-2016-5696 TCP旁路攻击分析与重现 - 安全客 - 有思想的安全新媒体</title>
    
        <meta name="keywords" content="CVE-2016-5696,TCP旁路攻击分析与重现"/>
    
        <meta name="description" content="8月10-12日的USENIX安全大会，加州大学河滨分校与美国陆军研究实验室的6名研究人员揭露了关于RFC 5961的安全漏洞。为防止 “blind in-window”攻击， RFC5961引入Challenge ACK机制，但Linux 内核在实现该RFC文档时引入了漏洞，攻击者可以利用该漏洞通过旁路攻击准确推断TCP连接的端口号、SEQ号和ACK号，从而实现TCP Reset攻击和数据注入攻击。"/>
        <meta property="wb:webmaster" content="224437c7be31d633"/>

    <script type="text/javascript" src="http://s7.qhimg.com/!56caa871/xpc_sync_height.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/reset.css" />
    <link rel="stylesheet" type="text/css" href="/css/common_new.css?v=4.4.2.1" />
    <link rel="stylesheet" type="text/css" href="/css/jquery.notyfy.css" />
    <link rel="stylesheet" type="text/css" href="/css/notyfy.theme.default.css" />
    <link rel="stylesheet" type="text/css" href="/css/s_common.css?v=2.2.7" media="only screen and
    (max-device-width:900px), only screen and (max-width:900px)" />
    <script type="text/javascript" src="/js/jquery.min.js?v=3.1"></script>
    <script type="text/javascript" src="/js/jquery.notyfy.js"></script>
    <script type="text/javascript" src="/js/iscroll.js"></script>
    <script src="http://js.passport.qihucdn.com/5.0.3.js"></script>
    <script type="text/javascript">
        var myScroll, myNavScroll;

        function iscrollLoaded() {
            myScroll = new IScroll('#wrapper',
                {
                    scrollX: true,
                    scrollY: false,
                    bounceEasing: 'circular',
                    eventPassthrough: true,
                    preventDefault: false,
                    bounceTime: 500
                }
            );
        }

        $(function () {

            //导航横向滚动


            function setNavWidth() {

                /* 计算导航宽度 */
                var allWidth = $(window).width();
                var scroller = $('#scroller');

                if (allWidth > 900) {
                    scroller.find('ul').add(scroller.find('.scroll')).removeAttr('style');
                    scroller.css('overflow', 'visible');
                    if (myNavScroll) myNavScroll.destroy();
                } else {

                    var width = 0;
                    scroller.find('.scroll').children('ul').children('li').each(function (index, el) {
                        if (!$(this).hasClass('mobile-hide')) {
                            width += $(this).outerWidth();
                        }
                    });
                    scroller.find('ul').add(scroller.find('.scroll')).width(width);

                    if (myNavScroll) myNavScroll.destroy();

                    myNavScroll = new IScroll('#scroller', {
                        scrollX: true,
                        scrollY: false,
                        momentum: false,
                        click: true
                    });

                }

            }

            setNavWidth();
            $(window).resize(function (event) {
                setNavWidth();
            });

        });

    </script>
</head>
<body onload="iscrollLoaded();">
<div style='margin:0 auto;width:0px;height:0px;overflow:hidden;'>
    <img src=""/>
</div>

<div id="is-mobile"></div>
<div class="container">
        <div class="mobile-header">
        <div class="header clearfix">
            <div class="header-wrapper clearfix">
                <a href="/index/index" class="logo"><img class="slogan" src="/img/logo.png?v=1.5"/></a>
                                <form id="search" class="search-box" action="/search/index" method="GET">
                    <input class="keys" name="keywords" type="text" placeholder="搜索漏洞" required="required">
                    <input class="icon" type="submit" value="">
                    <input type="hidden" name="type" value=""/>
                </form>
                <div class="bug">
                    <div class="name"><span class="seled">全部</span><i class="arrow"></i></div>
                    <ul class="typelist">
                        <li data-index="3"><a href="javascript:void(0);">全部</a></li>
                        <li data-index="0"><a href="javascript:void(0);">漏洞</a></li>
                        <li data-index="1"><a href="javascript:void(0);">资讯</a></li>
                        <li data-index="2"><a href="javascript:void(0);">知识</a></li>
                    </ul>
                </div>
                                <div class="logNreg mobile-hide">
                    <div class="unlog">
                        <i></i>
                        <a href="log.html" class="log">登录</a>
                        <span>|</span>
                        <a href="reg.html" class="reg">注册</a>
                    </div>
                    <div class="loged">
                        <a href="/member/profile" class="user-center"><i></i><span class="user-name-tag">个人中心</span></a>
                        <div class="user-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting"><a href="http://i.360.cn/profile/accountmanage"
                                                               target="_blank"><i></i><span>账号设置</span></a></li>
                                <li class="alert-setting"><a href="/keywords/index"
                                                             target="_blank"><i></i><span>告警设置</span></a></li>
                                <li class="bug-alert"><a href="/myalarm/index" target="_blank"><i></i><span>漏洞告警</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mylearn/index" target="_blank"><i></i><span>我的知识</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mycourse/index" target="_blank"><i></i><span>我的课堂</span></a>
                                </li>
                                <li class="my-exit"><a
                                            href="http://login.360.cn/?src=pcw_adlab&op=logout&destUrl=http://bobao.360.cn"><i></i><span>退出系统</span></a>
                                </li>
                            </ul>
                        </div>

                        <a href="/message" class="message-center" target="_blank"><i></i><span>我的消息</span></a>
                        <div class="message-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting" style="display:none;"><a href="/myres/index"
                                                                                     target="_blank"><i></i><span>回复我的</span></a>
                                </li>
                                <li class="my-bug"><a href="/myvul/index"
                                                      target="_blank"><i></i><span>我的漏洞</span></a></li>
                                <!--<li class="my-bug"><a href="/myres/index" target="_blank"><i></i><span>我的评论</span></a></li>-->
                                <!--<li class="alert-setting"><a href="###" target="_blank"><i></i><span>提到我的</span></a>
                                </li>-->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <style type="text/css">
            .nav {
                overflow: hidden;
            }

            .nav .scroll {
                width: auto;
            }
        </style>
        <div id="wrapper">
            <div id="scroller" class="nav">
                <div class="scroll">
                    <ul class="nav-list">
                        <li ><a class="link-nav"
                                                                                 href="/index/index">首页</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/vul/index">漏洞</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/introduce/list">招聘</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/news/index">资讯</a><!--<i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/introduce/list">招聘</a></li>
                        </ul>
			-->
                        </li>
                        <li class="cur">
                        <a class="link-nav" href="/learning/index">知识</a><i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/course/index">学院</a></li>
                        </ul>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/activity/index">活动</a></li>
                        <li class="mobile-hide "><a class="link-nav"
                                                                                                   href="/ctf/index">CTF训练营</a>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/interref/list">安全内参</a></li>
                        <li ><a class="link-nav" href="/app/index">APP</a></li>

                        <!--<li ><a href="/course/index">学院</a></li>-->
                        <!--<li ><a href="/introduce/list">招聘</a></li>-->
                        <!--<li  class="mobile-hide"><a href="/ctf/index">CTF训练营</a></li>-->
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="mobile-content">
        <link rel="stylesheet" type="text/css" href="/css/news.css?v=3.5" />
<link rel="stylesheet" type="text/css" href="/ue/SyntaxHighlighter/shCoreDefault.css?v=1.0" />
<style>
    p .syntaxhighlighter {
        width: 80%;
    }
</style>

<div class="cur-pos w1000">当前位置：<a href="http://bobao.360.cn/">安全客</a> &gt;&gt; 知识详情</div>

<div class="content clearfix">
    <div class="main">
        <div class="article">
            <div id="article_box">
                <h2>360MeshFire Team：CVE-2016-5696 TCP旁路攻击分析与重现</h2>
                <div class="article-msg">
                    <span class="time">2016-08-31 18:20:39</span>
                    
                                        <span class="read">阅读：38143次</span>
                    <span><a style="display: none;" class="good" href="javascript:;"
                             data-target="/learning/good" data-value="g_2990"
                             data-type="learning">点赞(0)</a></span>
                    <span><a class="fav" href="javascript:;" data-target="/mylearning/add"
                             data-pk="2990" data-type="learning">收藏</a></span>
                                        <span><a style="margin-left: 4px;" class="fav" href=""
                             target="_blank">来源： 安全客</a></span>
                    
                    
                    <div style="margin-top:10px; ">
                        <a href="/member/contribute?uid=2758821769" style="color:#848e99;">
                            <img src="http://p1.qhmsg.com/dm/150_150_100/t00df551a583a87f4e9.jpg" data-is-avatar="true"
                                 style="border: 1px solid #d5d5d5;padding: 2px; width: 80px;height: 80px;border-radius: 43px;"/>
                        </a>

                    </div>
                    <span class="orig">作者：<a href="/member/contribute?uid=2758821769" style="color:#848e99;">360 MeshFire Team</a></span>
                                    </div>
                <hr size="1">
                <div class="article-msg">
                    <p><!-- JiaThis Button BEGIN -->

<!--
<span class="jiathis_style"><span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_tsina"></a>
    <a class="jiathis_button_tqq"></a>
    <a class="jiathis_button_qzone"></a>
    <a class="jiathis_button_renren"></a>
    <a class="jiathis_button_xiaoyou"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
</span>

-->
</p>
                </div>
                <p><p style="text-indent: 0em; text-align: center;"><span style="font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong><img src="http://p4.qhimg.com/t01d9381f6a173a270a.png" title="t015f81107f9950fa1e.png" alt="http://p1.qhimg.com/t015f81107f9950fa1e.png"/></strong></span></p><p style="text-indent: 2em;"><span style="font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong>0x01 &nbsp;漏洞背景</strong></span></p><hr/><p style="text-indent: 2em;"><span style="text-indent: 2em; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">8月10-12日的USENIX安全大会，加州大学河滨分校与美国陆军研究实验室的6名研究人员揭露了关于RFC 5961的安全漏洞。</span></p><p style="text-indent:28px"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><span style="font-family: 宋体;">为防止</span> <span style="font-family: 宋体;">“</span>blind in-window<span style="font-family: 宋体;">”攻击，</span> RFC5961<span style="font-family: 宋体;">引入</span>Challenge ACK<span style="font-family: 宋体;">机制，但</span>Linux <span style="font-family: 宋体;">内核在实现该RFC文档时引入了漏洞，攻击者可以利用该漏洞通过旁路攻击准确推断</span>TCP<span style="font-family: 宋体;">连接的端口号、</span>SEQ<span style="font-family: 宋体;">号和</span>ACK<span style="font-family: 宋体;">号，从而实现</span>TCP Reset<span style="font-family: 宋体;">攻击和数据注入攻击。</span></span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">为了更好的了解CVE-2016-5696，我想我们有必要回溯一下该漏洞的历史缘由。</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在RFC5961(August 2010)出现之前，是TCP的荒蛮时代。blind in-window attacks一直是针对TCP协议的主要攻击手段。TCP协议本身在设计时候并没有充分考虑其安全性，TCP的安全性依赖于其连接的不可确定性，能否攻击成功很大程度上取决于攻击者能否预测出TCP序列号和端口号，一旦伪造数据包的序列号落到了窗口上，攻击者就可以去注入恶意链接或者直接重置连接。序列号是一个32位随机数，有40多亿种可能，端口号则有65535种可能，组合起来这种设计能够在一定范围内防御TCP的拒绝服务和注入攻击。</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在RFC5961出现之前，Linux的tcp协议栈是这样做的：</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><p style="text-indent: 2em;"><span style="color: rgb(0, 176, 80); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">当一条已经正常建立的链接收到一个syn包后，会这样做：</span></p><p style="text-indent: 2em;"><span style="color: rgb(0, 176, 80); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong>if &nbsp; syn包中的seq在合法窗口中，</strong></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong><strong style="text-indent: 32px; white-space: normal;"><span class="Apple-tab-span" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre;"></span></strong>接收方reset连接</strong></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong>else</strong></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong><strong style="text-indent: 32px; white-space: normal;"><span class="Apple-tab-span" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre;"></span></strong>接收方发送ack包</strong></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong><br/></strong></span></p><p style="text-indent: 2em;"><span style="color: rgb(0, 176, 80); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">当一条已经正常建立的链接收到一个RST包后，会这样做：</span></p><p style="text-indent: 2em;"><span style="color: rgb(0, 176, 80); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong>if <span class="Apple-tab-span" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre;"></span>RST包中的seq在合法窗口中</strong></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong><span class="Apple-tab-span" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre;"></span>接收方reset连接</strong></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong>else</strong></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong><span class="Apple-tab-span" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre;"></span>接收方发送ack包</strong></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong><br/></strong></span></p><p style="text-indent: 2em;"><span style="color: rgb(0, 176, 80); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">如果想防止数据注入，会这样做：</span></p><p style="text-indent: 2em;"><span style="color: rgb(0, 176, 80); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em;"><span style="text-decoration: underline; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">1.seq 在合法范围内</span></p><p style="text-indent: 2em;"><span style="text-decoration: underline; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2.ack number必须有效范围内：[SND.UNA-(231-1）,SND.NXT]</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">SND表示发送方，UNA表示已发送未确认收到的seq NXT表示下一个要发送包的seq&nbsp;</span></p><p style="text-indent: 2em;"><span style="text-indent: 2em; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">以上这样的逻辑会发现一个很明显的问题，就是我作为一个旁路攻击者，我盲目的猜测一个源地址、一个源端口和一个seq number， 把这个包发给服务器，如果这个链接在服务器上刚好存在，且seq number也正好在合法窗口内的话，那该条连接会被服务器端重置，拒绝攻击成功；<br/></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">但是如果我没猜中呢？没猜中呢？没猜中呢？</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">好吧，没猜中那我就继续往后猜呗，我把地址0-255，端口1-65535，seq从0-4G发一遍，我一台机子不够用，我找一百台来发攻击包。这样一来，肯定会有很多条连接中招，然后被reset掉。其实这也就是所谓的blind in-window attacks，合法窗口盲打。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">但是，RFC5961出现了。RFC5961的出现，像黑暗中的一道光明，照亮了整个TCP协议栈，也照亮了Linux系统的大好前程。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">RFC5961对TCP协议栈的处理提出如下建议：</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">当一条已经正常建立的链接收到一个syn包后，应该这样做：</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">不对seq做校验，直接回复一个challenge ack给源端</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">if<span class="Apple-tab-span" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre;"></span>收到源端发来的reset包</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><span class="Apple-tab-span" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 32px; white-space: pre;"></span>接收方reset连接、</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">else</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><span class="Apple-tab-span" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre;"></span>接收方丢弃该syn包</span></p><p><br/></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">如果源端的确丢失了连接信息，要重新初使化一个新的，那么在收到挑战包后，原端会发送RST包，确认当前连接需要关闭.</span></p><p><br/></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">当一条已经正常建立的链接收到一个RST包后，应该这样做：</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">if <span class="Apple-tab-span" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre;"></span>seq &nbsp;== 期望接收值&nbsp;</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><span class="Apple-tab-span" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre; text-indent: 32px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span>接收方断开连接</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">elif &nbsp;seq 在有效窗口</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 接收方发送挑战包</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">else</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><span class="Apple-tab-span" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre; text-indent: 32px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span>接收方丢弃该包，不理会</span></p><p><br/></p><p style="text-indent: 2em;"><span style="color: rgb(0, 176, 80); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">如果想防止假数据注入，应该这样做：</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">接收端收到ACK包，确认合法性的条件：</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">1.<span class="Apple-tab-span" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre;"></span>seq 在合法范围内</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2.<span class="Apple-tab-span" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre;"></span>if ack number in【SND.UNA-MAX.SND.WN, SND.NXT】</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><span class="Apple-tab-span" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre; text-indent: 32px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span>(注：MAX.SND.WND表示接收方能看到的发送方的最大窗口范围)</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><span class="Apple-tab-span" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre; text-indent: 32px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span>then</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><span class="Apple-tab-span" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre; text-indent: 32px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span>确认合法数据包</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><span class="Apple-tab-span" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre; text-indent: 32px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span>elif &nbsp;ack number在剩下的范围内：[SND.UNA −(231 − 1), SND.UNA − MAX.SND.W ND)</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><span class="Apple-tab-span" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre; text-indent: 32px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</span>then</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><span class="Apple-tab-span" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre; text-indent: 32px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 32px; white-space: pre;">&nbsp;</span>&nbsp;</span>需要发送挑战包</span></p><p style="text-indent: 2em;"><br/></p><p style="text-align: center;"><img src="http://p2.qhimg.com/t01181b350bade7e6a8.png" title="t01a9f6b003663c79fe.png" alt="http://p0.qhimg.com/t01a9f6b003663c79fe.png"/><br/></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">以上是RFC5961对TCP协议栈如何修改所提出的建议。可以明显的看出，当增加了源端确认这样的流程之后， syn包的旁路攻击已经变得不可能，因为你无法收到challeng ack。你只有完全蒙对地址+端口+seq值才能reset掉一条连接，这样大大增加了成本，blind in-window attacks变得非常困难。在防止数据注入方面，RFC5961之前的机制中ACK的范围比较大，相对容易的可以命中有效范围。RFC5961所建议机制虽然不能完全消除，但是大大降低了包的成功注入，提升攻击者成本，本身也是防御的一种。</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">到这里，我们应该觉得RFC5961应该提出了很多不错的建议，可为什么旁路攻击又变得可能了呢？</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在RFC5961中给出了一段关于挑战包节流机制的建议，以防止过多的挑战包影响系统性能，也正是这个建议，导致linux kernel在严格遵守协议做实现后，引发这个漏洞：</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">包的检查严格了，会导致触发较多挑战包。为了减少CPU和带宽损耗，REF5961建议引入挑战包的节流机制：限制单位时间间隔中，挑战包的个数。</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在linux &nbsp;kernel 3.6中，缺省设置是每秒100个，管理员可以修改。</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">REC5961中建议：挑战包的节流机制应该保守些，&nbsp;</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">linux &nbsp;kernel 3.6中，挑战包的计数器是一个被所有TCP连接共用的全局变量sysctl_tcp_challenge_ack_limit。<span class="Apple-tab-span" style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre;"></span></span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">为什么windows, freebsd, MAC OS X, 没有这个问题呢？</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">因为这些系统都没有严格遵守RFC5961的要求，要么，没有完全实现挑战机制，要么，没有实现挑战包的节流机制。</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">BINGO, 好孩子linux，独中。</span></p><p style="text-indent: 2em;"><span style="font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong><br/></strong></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong style="font-size: 18px; text-indent: 2em;">0x02 攻击原理</strong><br/></span></p><hr/><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">为防止这种 “blind in-window attacks”， 在RFC5961中引入了挑战包机制，REF5961本身作为改进建议，协议的设计没有问题。该漏洞的根源在于RFC5961引入的Challenge ACK挑战包节流机制的速率限制，在linux kernel实现时出现了漏洞。由于所有连接共用一个计数器，那么通过伪造包和真实通信包去挑战，根据真实通信返回的挑战包的数量，通过旁路攻击的方式来推断探测包的命中与否，一旦攻击包命中则可以逐步准确的推断出连接的端口号、SEQ号和ACK号，从而可以实现Reset攻击和数据注入攻击。这就是下面的攻击方法</span></p><p style="text-indent: 2em;"><span style="color: rgb(255, 0, 0); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong>攻击方法:</strong></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">要想Reset攻击，需要知道的条件：</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;1、两IP是否有连接</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;2、seq 有效范围</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">要想注入攻击 ，需要知道的条件：</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;1、两IP间是否有连接</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;2、seq number</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;3、ACK number&nbsp;</span></p><p><br/></p><p style="text-indent: 2em;"><span style="color: rgb(255, 0, 0); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">下面以注入攻击为例，进行分析：</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">client与server存在TCP连接，</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;1创建真实连接，到server端（因为server端口大多公开，不需要猜测）</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;2伪造1个包发到server端，目的是为了触发对端的挑战机制。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;3再使用真实连接，故意发100个包，触发挑战条件，如果收到100个，说明步骤2发送的包未触发挑战条件，如果收到99个，说明步骤2发送的包，触发了挑战条件，可以进行进一步推断。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">详细攻击步骤：</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;1.推断两个IP间是否存在连接</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;假设两端IP固定，服务端的端口公开，只需要确定源端口，就能确定一个连接。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp; &nbsp; 1.1伪造一个syn-ack 包，伪造client端IP，源端口号为猜测值</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;1.2 使用真实连接，发送100个设计过的RST包(seq落在有效范围，且不等于正确值)，如果收到99个包，说明基于该端口的TCP连接存在。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp; &nbsp; 1.3 采用折半算法，收紧范围，最终确定准确的端口号</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;2 推断seq number</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;2.1伪造一个RST包，seq为猜测值</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;2.2 使用真实连接，发送100个设计过的RST包(seq落在有效范围，且不等于正确值)，如果收到99个包，说明seq num在范围内</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp; &nbsp; 2.3 采用折半算法，收紧范围，最终确定准确的seq值&nbsp;</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;3 推断ack number</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">原理：推断ACK值，可以先推断出挑战范围的左边界：SND.UNA −(231 − 1)， 然后再 +（231 – 1），就可以得到准确的ACK值了。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;3.1确定左边界的范围，尝试0， 1G，2G， 3G四个节点，确定左边界落在哪个象限中。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">具体实施：</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;3.1.1 发送伪造ACK包，ack分别为0、1G、2G、3G，seq为有效范围内的值</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;3.1.2 发送100个设计过的RST包, 如果收到99个包，说明ack在挑战范围</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;3.13 通过四个节点的命中挑战的情况，就可以判断出挑战范围的左边界。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;3.2 再使用折半逼近的方法，确定左边界的精确值。&nbsp;</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;具体实施：</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;3.2.1 伪造一个ACK包，ack为猜测值， seq为有效范围内的值，</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp; &nbsp; 3.2.2 发送100个设计过的RST包，如果收到99个包，说明 ack在挑战范围内; 如果收到100个包，则说明ack在invalid 范围内。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;3.2.3 根据判断结果，逐渐逼近至挑战范围的左边界。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;3.3 左边界+（231 – 1） = ack</span></p><p style="text-indent: 0em; text-align: center;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(255, 0, 0);">攻击示意图：</span></strong></span></p><p style="text-align: center;"><img src="http://p7.qhimg.com/t01b076aa163f7c7ce0.png" title="t01cbf0eb562750d8f7.png" alt="http://p5.qhimg.com/t01cbf0eb562750d8f7.png"/></p><hr/><p style="text-indent: 2em;"><span style="font-size: 16px; color: rgb(255, 0, 0); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong>现实挑战：</strong></span></p><p style="text-indent: 2em;"><span style="color: rgb(0, 176, 80); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong><span style="color: rgb(0, 176, 80); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 16px;">时间同步</span></strong></span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><span class="Apple-tab-span" style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</span>由于计数器是按秒复位，上一秒的计数器，在进入下一秒后会复位。</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><span class="Apple-tab-span" style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</span>所以攻击端，必须与被攻击机器的时间尽可能保持同步，才能使攻击成立。</span></p><p style="text-indent: 2em;"><span style="color: rgb(0, 176, 80); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong><span style="color: rgb(0, 176, 80); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 16px;">RST限制</span></strong></span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;通常 firewall都有限制RST的频率，防止攻击，那么就不能使用RST做尝试推断了。</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;可以使用ACK包进行挑战，ACK挑战条件：</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;1、seq在有效范围&nbsp;</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;2、ACK在挑战范围，</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;ACK的挑战值很容易确定：</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;四个节点：0，1G，2G，3G，必定有1到2个命中范围，在已知一个seq有效值的情况下，可以推断出ACK挑战值。</span></p><p style="text-indent: 2em;"><span style="color: rgb(0, 176, 80); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong><span style="color: rgb(0, 176, 80); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 16px;">包丢失<span class="Apple-tab-span" style="color: rgb(0, 176, 80); font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre;"></span></span></strong></span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">包的丢失，会影响推断：</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><span class="Apple-tab-span" style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</span>引入多次确认机制。</span></p><p style="text-indent: 2em;"><span style="color: rgb(0, 176, 80); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong><span style="color: rgb(0, 176, 80); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 16px;">窗口变化</span></strong></span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><span class="Apple-tab-span" style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre;">&nbsp;&nbsp;&nbsp;&nbsp;</span>tcp 窗口，不是固定，是变化的，一定程序上增加了推断难度。</span></p><p style="text-indent: 2em;"><span style="white-space: pre; font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><p style="text-indent: 2em;"><span style="font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong><br/></strong></span></p><p style="text-indent: 2em;"><span style="font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong>0x03 攻击效果</strong></span></p><hr/><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">有一组公开的数据，</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">1.断开连接攻击：</span></p><p style="text-indent: 0em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><img src="http://p7.qhimg.com/t012a88c7a7d5610c0d.png" title="t01cddb4aa6d999006c.png" alt="http://p0.qhimg.com/t01cddb4aa6d999006c.png" style="text-align: center; white-space: normal;"/></span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2.数据注入攻击</span></p><p style="text-align: center; text-indent: 0em;"><img src="http://p0.qhimg.com/t018f65205ccc38e4ca.png" title="t013276c0ccb7f2ee32.png" alt="http://p7.qhimg.com/t013276c0ccb7f2ee32.png"/></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">可以看到成功率非常高，时间基本控制在1分钟左右。</span></p><p style="text-indent: 2em;"><span style="font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong><br/></strong></span></p><p style="text-indent: 2em;"><span style="font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong>0x04 POC</strong></span></p><hr/><p style="text-indent: 2em;"><span style="text-indent: 2em; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">截止到8月30日，网络上已经出现两个POC：</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">rover: 第三方，只是开放了推断端口号部分，python实现。</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">mountain-goat: 官方曝出，只开放到推断seq 范围，C实现 。</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">8月底，360MeshFire网络安全团队完整实现了端口号、seq和ack的推断，并完成了reset攻击和inject数据攻击。</span></p><p style="text-indent: 2em;"><span style="color: rgb(255, 0, 0); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">360MeshFire Team POC演示视频： </span><a href="https://yunpan.cn/cMW9EbkGBscuz " _src="https://yunpan.cn/cMW9EbkGBscuz " style="text-decoration: underline; color: rgb(255, 0, 0); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><span style="color: rgb(255, 0, 0); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">https://yunpan.cn/cMW9EbkGBscuz&nbsp;</span></a><span style="text-indent: 2em; color: rgb(255, 0, 0); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">（提取码：b46b）</span></p><p style="text-indent: 0em; text-align: center;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">附演示视频截图：</span></p><p style="text-indent: 0em; text-align: center;"><img src="http://p6.qhimg.com/t01d22d6c9fdeef3969.png" title="t019d79f562c7921efd.png" alt="http://p4.qhimg.com/t019d79f562c7921efd.png"/></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">POC结论：</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><span class="Apple-tab-span" style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre;"></span>1.针对任意TCP连接，精准的猜测连接是否存在、源端口、seq、ack是可行的，成功率极高。</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><span class="Apple-tab-span" style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre;"></span>2.只要服务端的Linux kernel为漏洞影响版本，可触发挑战包机制，就会受到该漏洞的影响。</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><span class="Apple-tab-span" style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre;"></span>3.一旦推测出四元组信息，seq，ack的情况下，就可以实现双向的数据劫持注入和定向TCP连接的拒绝服务：包括HTTP中注入钓鱼代码，伪造客户端发送写命令（TELNET，HTTP等）</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><span class="Apple-tab-span" style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre;"></span>4.如果在网络带宽足够、程序实现优化（C实现）等情况下，可以快速精准地推断出以上元素数据，达到paper所述的攻击成功率。</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><span class="Apple-tab-span" style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre;"></span>5.由于安卓4.4版本以上均存在该问题，且大量APP中建立的是与服务器的长连接，导致可被利用的场景，可能会有更多的变数。</span></p><p style="text-indent: 2em;"><span style="font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong><br/></strong></span></p><p style="text-indent: 2em;"><span style="font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong>0x05 影响范围</strong></span></p><hr/><p style="text-indent: 2em;"><span style="text-indent: 2em; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Linux &nbsp;Kernel3.6 以上版本, 包括目前最高4.6版本，都受该漏洞影响。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 16px; color: rgb(0, 112, 192);">安卓</span></strong></span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">release version , name &nbsp;,kernel version&nbsp;</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">4.4 &nbsp; Kit Kat &nbsp; &nbsp; &nbsp; &nbsp; |3.10</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">5.x &nbsp; Lollipop &nbsp; &nbsp; &nbsp; &nbsp;|3.16.1</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">6.0 &nbsp; Marshmallow &nbsp; &nbsp; |3.18.10</span></p><p><br/></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 16px; color: rgb(0, 112, 192);">Centos 7</span></strong></span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">release version ,kernel version&nbsp;</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">7.0 &nbsp; 3.10</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">7.1 &nbsp; 3.10</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">7.2 &nbsp; 3.10</span></p><p><br/></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 16px; color: rgb(0, 112, 192);">Utuntu</span></strong></span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">release version ,kernel version&nbsp;</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">13.04 &nbsp; Raring Ringtail &nbsp;3.8</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">13.10 &nbsp; Saucy Salamander 3.11</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">14.04 &nbsp; Trusty Tahr &nbsp; &nbsp; &nbsp;3.13</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">14.10 &nbsp; Utopic Unicorn &nbsp; 3.16</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">15.04 &nbsp; Vivid Vervet &nbsp; &nbsp; 3.19</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">15.10 &nbsp; Wily Werewolf &nbsp; &nbsp;4.2</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">16.04 &nbsp; Xenial Xerus &nbsp; &nbsp; 4.4</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">16.10 &nbsp; Yakkety Yak &nbsp; &nbsp; &nbsp;4.6&nbsp;</span></p><p><br/></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 16px; color: rgb(0, 112, 192);">Redhat Enterprise release</span></strong></span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">release version ,kernel version&nbsp;</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">RHEL 7.2 &nbsp; &nbsp; &nbsp; &nbsp;3.10.0-327</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">RHEL 7.1 &nbsp; &nbsp; &nbsp; &nbsp;3.10.0-229</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">RHEL 7.0 GA &nbsp; 3.10.0-123</span></p><p style="text-indent: 2em;"><span style="font-size: 16px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">RHEL 7.0 Beta &nbsp; 3.10.0-54.0.1</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;"><br/></span></p><p style="text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;">0x06 修复方案</span></strong></p><hr/><hr/><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">1.升级Linux内核到4.7版本以上</span><br/></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2.修改挑战包计数器值，步骤如下：</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">1）修改挑战包的节流设置/etc/sysctl.conf:</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><span class="Apple-tab-span" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre;"></span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(255, 0, 0);">net.ipv4.tcp_challenge_ack_limit = 9999999</span></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><span class="Apple-tab-span" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre;"></span>该值取100-300间随机数，可以过滤那些只会使用工具的黑客，增加一定难度，同时对性能不会产生什么影响。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><span class="Apple-tab-span" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; white-space: pre;"></span>该值取一个大值，将直接解决此问题，但因此导致的性能、带宽损耗需要评估。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2 ）sysctl -p （激活）</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">3. 对业务来讲，使用加密传输，可以有效防止数据的劫持和注入。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;协议栈解决漏洞思路：</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;不采用全局挑战包计数器的实现方案，每个连接维护一个挑战包计数器。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;&nbsp;&nbsp;linux 4.0部分引入了这个思想，但只对SYN包的挑战进行了单独计算，所以面对攻击无效。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em;"><span style="font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong>0x07 参考资料</strong></span></p><hr/><p style="text-indent: 2em;"><a href="http://www.cs.ucr.edu/~zhiyunq/pub/sec16_TCP_pure_offpath.pdf" style="text-indent: 28px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">sec16_TCP_pure_offpath.pdf</span></a><br/></p><p style="text-indent:28px"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><span style="font-family: 宋体;">数据注入</span><span style="font-family: 宋体; color: black;"><a href="http://www.tudou.com/programs/view/UBS_Oel6FUQ/?resourceId=341181215_06_02_99">演示视频</a></span></span></p><p style="text-indent:28px"><a href="http://www.freebuf.com/news/112245.html" style="text-indent: 2em; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em; color: black;">14</span><span style="text-indent: 2em; font-family: 宋体; color: black;">亿</span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em; color: black;">Android</span><span style="text-indent: 2em; font-family: 宋体; color: black;">设备受</span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em; color: black;">Linux TCP</span><span style="text-indent: 2em; font-family: 宋体; color: black;">漏洞的影响</span></span></a></p><p style="text-indent:28px"><a href="https://bobcares.com/blog/fix-linux-off-path-tcp-attacks-cve-2016-5696/" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">How to mitigate Linux “Off-path” TCP exploits</span></a></p><p style="text-indent: 28px;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">知乎</span><a href="https://www.zhihu.com/question/46277448" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: underline;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: black;">tombkeeper</span><span style="font-family: 宋体; color: black;">与曹跃关于</span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: black;">geekpwn</span><span style="font-family: 宋体; color: black;">上任意</span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: black;">tcp</span><span style="font-family: 宋体; color: black;">远程支持的讨论</span></span></a></p></p>
                <hr/>
                <p style="text-align: center;">
                    <img src="http://bobao.360.cn/img/app.jpeg"/>
                    <img src="http://bobao.360.cn/img/weixin.jpeg"/>
                </p>
                                <p>本文由 安全客 原创发布，如需转载请注明来源及本文地址。<br/>本文地址：http://bobao.360.cn/learning/detail/2990.html
                </p>
                            </div>
            <div style="margin-top: 20px;background-color:#FFFFFF">
    <input type="hidden" id="detail_title" name="detail_title" value="360MeshFire Team：CVE-2016-5696 TCP旁路攻击分析与重现 - 安全客 - 有思想的安全新媒体" />
    <input type="hidden" id="use_nickname" name="use_nickname" value="0" />
    <a name="mao"></a>
    <div class="reg-log mobile-hiden">
        <div class="" id="userTo">   
            <div id="to-list" class="input-text" style="">
                <textarea disabled="disabled" class="hide"  id="comment-content" to="to"></textarea>
                <ul id="preadded" style="display:none">       
                </ul>
                <div id="to-auto" style="width: 200px">
                    <ul id="feed">
                    </ul>
                </div>
            </div>
        </div>
        <input type="hidden" id="source-id" value="2990" />
        <input type="hidden" id="source-type" value="learning" />
        <input type="hidden" id="post-comment-url" value="/comment/add" />
        <input type="hidden" id="post-nickname-url-ajax" value="/comment/randnicknameajax" />
        <input type="hidden" id="post-check-login-url-ajax" value="/comment/checklogin" />
        <input type="hidden" id="stoken_comment_set" value="ea3898fb4df38673fdeb61c458234054">                 <span class="join">参与讨论，请先 <a href="javascript:;" class="comment-login">登录</a> | <a href="javascript:;" class="comment-reg">注册</a> |  <a href="javascript:;" class="anonymous-comment">匿名评论</a></span>
            </div>
    <div class="mobile-hide" style="width: 870px; margin: 0 auto;">
        <label style="vertical-align:middle;" for="use_nickname">匿名</label> 
        <input style="vertical-align:middle;" id="trigger-nickname" name="use_nickname" class="use_nickname" type="checkbox" value="0" />

        <a href="javascript:;" class="apply-use button" id="submit-comment" data-target="/comment/add">发布</a>
    </div>


    <div class="clearfix"></div>
    <div class="comments">
        <div class="comments-head">
            <span class="title">用户评论</span>
        </div>
                <div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/3x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="4131" user-name="ald" href="javascript:;">
                ald            </a>
                        <span class="comment-time">2016-09-07 07:44:48</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="4131">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_4131" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">很详细</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>

        <a class="more-long comment-more" href="javascript:;" data-target="/comment/more" data-type="learning" data-source-id="2990" data-page="2">查看更多</a>
            </div>
</div>
<script>
    $(function () {
        $('.anonymous-comment').click(function () {
            $(".join").hide();
            $(".reg-log textarea").first().removeAttr("disabled").show();
            $('#use_nickname').val('1');
//            $('#trigger-nickname').attr('checked', true);
            $('#trigger-nickname').trigger('click');
        });
        //为所有复选框绑定事件
//        checkbox_on_click();
        //ajax随机获取昵称
//        randnicknameajax(0);
        //ajax检测登录状态
        comment_check_login();
    });



    function input_checkbox(flag) {
        $('input:checkbox').each(function () {
            var value = flag ? 1 : 0;
            $(this).prop('checked', flag);
            $(this).val(value);
        });
    }

//ajax随机获取昵称
    function randnicknameajax(flag) {
        $.ajax({
            type: 'POST',
            url: $('#post-nickname-url-ajax').val(),
            data: {limit: 1, flag: flag},
            dataType: "json",
            success: function (data) {
                $('#nick-name').val(data.data[0]);
                _nick_name=data.data[0];
            }
        });
    }
    $();
//ajax检测登录状态
    function comment_check_login() {
        $.ajax({
            type: 'POST',
            url: $('#post-check-login-url-ajax').val(),
            data: {},
            dataType: "json",
            success: function (data) {
                if (data.success) {
                    $('.join').hide();
                    $(".reg-log textarea").first().removeAttr("disabled").show();
                    $("#span_use_nickname").show();
                    $('#use_nickname').val('0');
                    $('#use_nickname').attr('checked', false);
                }
            }
        });
    }
</script>        </div>
    </div>
    <div class="side-bar">
        <div class="mod hot-news">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-hot"></i><span>热门知识</span></h2>
    </div>
    <ul class="links-list">
                                <li><a href="/learning/detail/4411.html" alt="【漏洞预警】一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现——最新的Office高级威胁攻击预警" target="_blank">【漏洞预警】一个换行符引发的奥斯卡...</a></li>
                                <li><a href="/learning/detail/4416.html" alt="【漏洞预警】Microsoft .NET Framework漏洞（CVE–2017–8759）预警" target="_blank">【漏洞预警】Microsoft .NE...</a></li>
                                <li><a href="/learning/detail/4414.html" alt="【技术分享】妙用JavaScript绕过XSS过滤" target="_blank">【技术分享】妙用JavaScrip...</a></li>
                                <li><a href="/learning/detail/4418.html" alt="【技术分享】利用威胁情报数据平台拓展APT攻击线索一例" target="_blank">【技术分享】利用威胁情报数据平台拓...</a></li>
                                <li><a href="/learning/detail/4417.html" alt="【知识】9月15日 - 每日安全知识热点" target="_blank">【知识】9月15日 - 每日安全知识热...</a></li>
                                <li><a href="/learning/detail/4425.html" alt="【安全报告】XShellGhost事件技术回顾报告" target="_blank">【安全报告】XShellGhost事件...</a></li>
            </ul>
</div>        <!-- 友情链接 -->
        <div class="mod blog-links mobile-hide">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-link"></i><span>友情链接</span></h2>
        <a href="/links/index.html" class="more">更多<i></i></a>
    </div>
        <ul class="links-list">
                <li><a href="http://bbs.360safe.com" alt="360安全社区" target="_blank">360安全社区</a></li>
                <li><a href="http://zhuji.360.cn" alt="360主机卫士" target="_blank">360主机卫士</a></li>
                <li><a href="http://blogs.360.cn/" alt="奇虎360技术博客" target="_blank">奇虎360技术博客</a></li>
                <li><a href="http://wangzhan.360.cn/" alt="360网站卫士" target="_blank">360网站卫士</a></li>
                <li><a href="http://webscan.360.cn/" alt="360网站安全检测" target="_blank">360网站安全检测</a></li>
                <li><a href="http://research.360.cn/report/" alt="360研究报告" target="_blank">360研究报告</a></li>
                <li><a href="http://unicorn.360.cn/" alt="360 Unicorn Team" target="_blank">360 Unicorn Team</a></li>
                <li><a href="http://appscan.360.cn/" alt="360捉虫猎手" target="_blank">360捉虫猎手</a></li>
                <li><a href="https://threathunter.org/" alt="ThreatHunter社区" target="_blank">ThreatHunter社区</a></li>
                <li><a href="http://security.360.cn/" alt="360安全应急响应中心" target="_blank">360安全应急响应中心</a></li>
            </ul>
    </div>
        <!-- 联系我们 -->
        <div class="mod contact mobile-hide" style="text-align:center">
    <div class="head-bar clearfix">
        <h2><i></i><span>关注我们</span></h2>
    </div>
    <!-- 微信关注 -->
    <ul class="contact-way">
        <li><a>微信关注</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/qrcode_adlab_weixin.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
    <!-- APP下载 -->
    <ul class="contact-way">
        <li><a>安全播报APP</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/scan_code_big.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
</div>

    </div>
</div>

<script type="text/javascript" src="/js/jquery-ui.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/jquery.noty.packaged.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/common.js?v=4.5"></script>
<script>$(function() {sync_count('comment');});</script>


<!-- 语法高亮 -->
<script type="text/javascript" src="/ue/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">SyntaxHighlighter.all();sync_count('vul');sync_count('news');sync_count('learning');sync_count('activity');sync_count('course');sync_count('ctf');</script>
    </div>

        <div class="footer">
        <div class="friend-link">
            <a href="http://www.360.cn/" target="_blank">360首页</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">关于我们</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">联系我们</a>
            <span>|</span>
            <a href="/links/index.html" target="_blank">友情链接</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">招贤纳士</a>
        </div>
        <div class="copy">
            Copyright &copy; 360网络攻防实验室 All Rights Reserved <span class="copy_icp">京ICP证080047号[京ICP备08010314号-6]</span>
        </div>
    </div>
    
</div>

<!--奇舞团统计-->

<script src='https://s.ssl.qhimg.com/static/f5407c785655e6a1/monitor_analytic.js'></script>
<script>
    monitor.setProject('QH_171_1').getTrack().getClickAndKeydown().getClickHeatmap(10, 1);
</script>

<div class="hide">
    <script src="https://s95.cnzz.com/z_stat.php?id=1253147824&web_id=1253147824" language="JavaScript"></script>
</div>
<div class="backToTop_wrap off">
    <a id="back_to_top" class="backToTop" href="javascript:;" title="返回顶部"></a>
</div>
<script>
    var $backToTop_wrap = $(".backToTop_wrap"),
        $backToTop_btn = $("#back_to_top");

    if ($(window).scrollTop() > 100) {
        $backToTop_wrap.removeClass("off");
    }
    else {
        $backToTop_wrap.addClass("off");
    }

    $(window).on("scroll", function () {
        if ($(this).scrollTop() > 100) {
            $backToTop_wrap.removeClass("off");
        }
        else {
            $backToTop_wrap.addClass("off");
        }
    });

    $backToTop_btn.on("click", function () {
        $("html, body").animate({scrollTop: 0}, 120);
    });

    $(function () {
        var navlist = $('.nav-list > li');

        navlist.each(function () {
            $(this).on('mouseenter', function () {
                $(this).addClass('selected');
            });

            $(this).on('mouseleave', function () {
                $(this).removeClass('selected');
            });
        });
    })
</script>



</body>
</html>
