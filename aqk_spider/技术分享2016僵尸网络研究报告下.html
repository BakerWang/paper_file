<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:wb="http://open.weibo.com/wb" xml:lang="en" lang="en">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <link rel="shortcut icon" href="http://bobao.360.cn/favicon.ico?v=1.1"/>
    <link rel="alternate" title="安全资讯" href="/rss?type=news" type="application/rss+xml"/>
    <link rel="alternate" title="安全知识" href="/rss?type=learning" type="application/rss+xml"/>
    <link rel="alternate" title="安全圈活动" href="/rss?type=activity" type="application/rss+xml"/>
    <link rel="alternate" title="所有漏洞" href="/rss?type=vul" type="application/rss+xml"/>
    <link rel="alternate" title="通用型漏洞" href="/rss?type=commonvul" type="application/rss+xml"/>
    <link rel="alternate" title="事件型漏洞" href="/rss?type=eventvul" type="application/rss+xml"/>
    <link rel="alternate" title="热门漏洞" href="/rss?type=hotvul" type="application/rss+xml"/>

        <title>【技术分享】2016僵尸网络研究报告（下） - 安全客 - 有思想的安全新媒体</title>
    
        <meta name="keywords" content="僵尸网络,ddos,botnet"/>
    
        <meta name="description" content="2016年，以Locky为代表的勒索软件的兴起非常引人注目，但是过去几个月，我们的注意力被网络犯罪基础设施的一个基础元素所吸引----僵尸网络。"/>
        <meta property="wb:webmaster" content="224437c7be31d633"/>

    <script type="text/javascript" src="http://s7.qhimg.com/!56caa871/xpc_sync_height.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/reset.css" />
    <link rel="stylesheet" type="text/css" href="/css/common_new.css?v=4.4.2.1" />
    <link rel="stylesheet" type="text/css" href="/css/jquery.notyfy.css" />
    <link rel="stylesheet" type="text/css" href="/css/notyfy.theme.default.css" />
    <link rel="stylesheet" type="text/css" href="/css/s_common.css?v=2.2.7" media="only screen and
    (max-device-width:900px), only screen and (max-width:900px)" />
    <script type="text/javascript" src="/js/jquery.min.js?v=3.1"></script>
    <script type="text/javascript" src="/js/jquery.notyfy.js"></script>
    <script type="text/javascript" src="/js/iscroll.js"></script>
    <script src="http://js.passport.qihucdn.com/5.0.3.js"></script>
    <script type="text/javascript">
        var myScroll, myNavScroll;

        function iscrollLoaded() {
            myScroll = new IScroll('#wrapper',
                {
                    scrollX: true,
                    scrollY: false,
                    bounceEasing: 'circular',
                    eventPassthrough: true,
                    preventDefault: false,
                    bounceTime: 500
                }
            );
        }

        $(function () {

            //导航横向滚动


            function setNavWidth() {

                /* 计算导航宽度 */
                var allWidth = $(window).width();
                var scroller = $('#scroller');

                if (allWidth > 900) {
                    scroller.find('ul').add(scroller.find('.scroll')).removeAttr('style');
                    scroller.css('overflow', 'visible');
                    if (myNavScroll) myNavScroll.destroy();
                } else {

                    var width = 0;
                    scroller.find('.scroll').children('ul').children('li').each(function (index, el) {
                        if (!$(this).hasClass('mobile-hide')) {
                            width += $(this).outerWidth();
                        }
                    });
                    scroller.find('ul').add(scroller.find('.scroll')).width(width);

                    if (myNavScroll) myNavScroll.destroy();

                    myNavScroll = new IScroll('#scroller', {
                        scrollX: true,
                        scrollY: false,
                        momentum: false,
                        click: true
                    });

                }

            }

            setNavWidth();
            $(window).resize(function (event) {
                setNavWidth();
            });

        });

    </script>
</head>
<body onload="iscrollLoaded();">
<div style='margin:0 auto;width:0px;height:0px;overflow:hidden;'>
    <img src=""/>
</div>

<div id="is-mobile"></div>
<div class="container">
        <div class="mobile-header">
        <div class="header clearfix">
            <div class="header-wrapper clearfix">
                <a href="/index/index" class="logo"><img class="slogan" src="/img/logo.png?v=1.5"/></a>
                                <form id="search" class="search-box" action="/search/index" method="GET">
                    <input class="keys" name="keywords" type="text" placeholder="搜索漏洞" required="required">
                    <input class="icon" type="submit" value="">
                    <input type="hidden" name="type" value=""/>
                </form>
                <div class="bug">
                    <div class="name"><span class="seled">全部</span><i class="arrow"></i></div>
                    <ul class="typelist">
                        <li data-index="3"><a href="javascript:void(0);">全部</a></li>
                        <li data-index="0"><a href="javascript:void(0);">漏洞</a></li>
                        <li data-index="1"><a href="javascript:void(0);">资讯</a></li>
                        <li data-index="2"><a href="javascript:void(0);">知识</a></li>
                    </ul>
                </div>
                                <div class="logNreg mobile-hide">
                    <div class="unlog">
                        <i></i>
                        <a href="log.html" class="log">登录</a>
                        <span>|</span>
                        <a href="reg.html" class="reg">注册</a>
                    </div>
                    <div class="loged">
                        <a href="/member/profile" class="user-center"><i></i><span class="user-name-tag">个人中心</span></a>
                        <div class="user-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting"><a href="http://i.360.cn/profile/accountmanage"
                                                               target="_blank"><i></i><span>账号设置</span></a></li>
                                <li class="alert-setting"><a href="/keywords/index"
                                                             target="_blank"><i></i><span>告警设置</span></a></li>
                                <li class="bug-alert"><a href="/myalarm/index" target="_blank"><i></i><span>漏洞告警</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mylearn/index" target="_blank"><i></i><span>我的知识</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mycourse/index" target="_blank"><i></i><span>我的课堂</span></a>
                                </li>
                                <li class="my-exit"><a
                                            href="http://login.360.cn/?src=pcw_adlab&op=logout&destUrl=http://bobao.360.cn"><i></i><span>退出系统</span></a>
                                </li>
                            </ul>
                        </div>

                        <a href="/message" class="message-center" target="_blank"><i></i><span>我的消息</span></a>
                        <div class="message-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting" style="display:none;"><a href="/myres/index"
                                                                                     target="_blank"><i></i><span>回复我的</span></a>
                                </li>
                                <li class="my-bug"><a href="/myvul/index"
                                                      target="_blank"><i></i><span>我的漏洞</span></a></li>
                                <!--<li class="my-bug"><a href="/myres/index" target="_blank"><i></i><span>我的评论</span></a></li>-->
                                <!--<li class="alert-setting"><a href="###" target="_blank"><i></i><span>提到我的</span></a>
                                </li>-->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <style type="text/css">
            .nav {
                overflow: hidden;
            }

            .nav .scroll {
                width: auto;
            }
        </style>
        <div id="wrapper">
            <div id="scroller" class="nav">
                <div class="scroll">
                    <ul class="nav-list">
                        <li ><a class="link-nav"
                                                                                 href="/index/index">首页</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/vul/index">漏洞</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/introduce/list">招聘</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/news/index">资讯</a><!--<i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/introduce/list">招聘</a></li>
                        </ul>
			-->
                        </li>
                        <li class="cur">
                        <a class="link-nav" href="/learning/index">知识</a><i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/course/index">学院</a></li>
                        </ul>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/activity/index">活动</a></li>
                        <li class="mobile-hide "><a class="link-nav"
                                                                                                   href="/ctf/index">CTF训练营</a>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/interref/list">安全内参</a></li>
                        <li ><a class="link-nav" href="/app/index">APP</a></li>

                        <!--<li ><a href="/course/index">学院</a></li>-->
                        <!--<li ><a href="/introduce/list">招聘</a></li>-->
                        <!--<li  class="mobile-hide"><a href="/ctf/index">CTF训练营</a></li>-->
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="mobile-content">
        <link rel="stylesheet" type="text/css" href="/css/news.css?v=3.5" />
<link rel="stylesheet" type="text/css" href="/ue/SyntaxHighlighter/shCoreDefault.css?v=1.0" />
<style>
    p .syntaxhighlighter {
        width: 80%;
    }
</style>

<div class="cur-pos w1000">当前位置：<a href="http://bobao.360.cn/">安全客</a> &gt;&gt; 知识详情</div>

<div class="content clearfix">
    <div class="main">
        <div class="article">
            <div id="article_box">
                <h2>【技术分享】2016僵尸网络研究报告（下）</h2>
                <div class="article-msg">
                    <span class="time">2017-01-17 14:16:03</span>
                    
                                        <span class="read">阅读：12885次</span>
                    <span><a style="display: none;" class="good" href="javascript:;"
                             data-target="/learning/good" data-value="g_3413"
                             data-type="learning">点赞(0)</a></span>
                    <span><a class="fav" href="javascript:;" data-target="/mylearning/add"
                             data-pk="3413" data-type="learning">收藏</a></span>
                                        <span><a style="margin-left: 4px;" class="fav" href="http://pages.cyren.com"
                             target="_blank">来源： cyren.com</a></span>
                    
                    
                    <div style="margin-top:10px; ">
                        <a href="/member/contribute?uid=2798962642" style="color:#848e99;">
                            <img src="http://p1.qhmsg.com/dm/150_150_100/t00df551a583a87f4e9.jpg" data-is-avatar="true"
                                 style="border: 1px solid #d5d5d5;padding: 2px; width: 80px;height: 80px;border-radius: 43px;"/>
                        </a>

                    </div>
                    <span class="orig">作者：<a href="/member/contribute?uid=2798962642" style="color:#848e99;">pwn_361</a></span>
                                    </div>
                <hr size="1">
                <div class="article-msg">
                    <p><!-- JiaThis Button BEGIN -->

<!--
<span class="jiathis_style"><span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_tsina"></a>
    <a class="jiathis_button_tqq"></a>
    <a class="jiathis_button_qzone"></a>
    <a class="jiathis_button_renren"></a>
    <a class="jiathis_button_xiaoyou"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
</span>

-->
</p>
                </div>
                <p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></strong></span></p><p style="text-indent: 0em; white-space: normal; text-align: center;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;"><img src="http://p7.qhimg.com/t0171fa018b64865803.jpg" title="t011eb353627cf0c22c.jpg" alt="http://p7.qhimg.com/t011eb353627cf0c22c.jpg"/></span></strong></span></p><p style="text-indent: 0em; white-space: normal;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;"></span></strong></span></p><p style="white-space: normal; text-indent: 2em;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">翻译：</span></strong></span><a href="http://bobao.360.cn/member/contribute?uid=2798962642" target="_blank" textvalue="pwn_361" style="text-decoration: none;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">pwn_361</span></strong><strong><span style="font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></strong></span></a></p><p style="white-space: normal; text-indent: 2em;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">预估稿费：300RMB</span></strong></span></p><p style="white-space: normal; text-indent: 2em;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">投稿方式：<span style="background-color: rgb(255, 255, 255);">发送邮件至</span><a href="mailto:linwei@360.cn" target="_self" style="background-color: rgb(255, 255, 255); text-decoration: none; color: rgb(51, 51, 51); line-height: 28px;"><span style="color: rgb(0, 112, 192);">linwei#360.cn</span></a><span style="background-color: rgb(255, 255, 255);">，或登陆</span><a href="http://bobao.360.cn/contribute/index" target="_blank" style="background-color: rgb(255, 255, 255); text-decoration: none; color: rgb(0, 112, 192); line-height: 28px;">网页版</a><span style="background-color: rgb(255, 255, 255);">在线投稿</span></span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></strong></span></p><p style="white-space: normal; text-indent: 2em;"><span style="color: rgb(0, 112, 192); font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong><span style="text-indent: 2em;"><br/></span></strong></span></p><p style="white-space: normal; text-indent: 2em;"><span style="color: rgb(0, 112, 192); font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong><span style="text-indent: 2em;">传送门</span></strong></span></p><hr style="white-space: normal;"/><p style="white-space: normal; text-indent: 2em;"><a href="http://bobao.360.cn/learning/detail/3412.html" target="_blank" textvalue="【技术分享】2017僵尸网络研究报告（上）" style="text-decoration: none;"><span style="color: rgb(0, 112, 192); font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong>【技术分享】2017僵尸网络研究报告（上）</strong></span></a></p><p style="text-indent: 2em; text-align: left;"><br/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">十、在Necurs僵尸网络生命的前24小时</span></strong></span><br/></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">Necurs是一个臭名昭著、极端危险的僵尸网络，在全球传播像“wildfire”这样的恶意软件，直到2015年十月份，在一个国际执法部门的努力下，它被下线了。然而，几个月后，这个神秘的僵尸网络又出现了，并开始传播Dridex和Locky恶意软件，在2016年六月份又一次消失了。几周之后，又出现了，并开始传播Locky恶意软件。为了更好的理解Necurs，及它是如何工作的，Cyren的安全专家重现并分析了一个真实的Necurs僵尸网络前24小时的活动。</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t011aaec70ce31974a0.png" title="t01e59399f81e91c357.png" alt="http://p2.qhimg.com/t01e59399f81e91c357.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192); font-size: 18px;"><strong><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">第一天：</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">9:46 AM.传送</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">僵尸恶意软件通过邮件方式到达欧洲的一台计算机，“crashreporter.exe”恶意软件作为邮件的附件，并伪装成“Mozilla基金会”。这个僵尸恶意软件属于Necurs僵尸网络，Cyren将其作为“w32/necurs.c.gen!eldorado”，成功的探测到。</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t01c5be91e907c6ceb4.png" title="t01e4dc79ca7b1324e4.png" alt="http://p3.qhimg.com/t01e4dc79ca7b1324e4.png"/></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">10:03 AM.感染</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">未加怀疑的受害人打开了邮件和邮件附件。</span></p><p style="text-align:center"><img src="http://p5.qhimg.com/t0181ea7cecc7d71a6a.png" title="t01ac9c8949437f3456.png" alt="http://p4.qhimg.com/t01ac9c8949437f3456.png"/></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">10:05 AM.环境感知</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在启动以后，僵尸程序运行的第一阶段是搜索已知的虚拟环境指标、及调试器、和其它的监控工具，如果发现存在这样的环境或工具，根据僵尸软件的运行流程，它会将自己结束掉。</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t01612f22f5c99a5abc.png" title="t01aee3b907e4ad7e6a.png" alt="http://p0.qhimg.com/t01aee3b907e4ad7e6a.png"/></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">10:05-10:08 AM.创建一个合适的工作环境</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在这个例子中，僵尸程序将自己复制到以下几个位置：</span></p><p style="text-align:center"><img src="http://p0.qhimg.com/t01fdce0ed9f7b9918c.png" title="t018d9fc67edbe50d86.png" alt="http://p3.qhimg.com/t018d9fc67edbe50d86.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">并将自己复制到临时文件夹：</span></p><p style="text-align:center"><img src="http://p9.qhimg.com/t01dc8cbfd4fcdd1230.png" title="t016eebc09548440121.png" alt="http://p0.qhimg.com/t016eebc09548440121.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">然后，检查机器的语言环境(有些情况下，当检测到某些语言环境时，恶意软件将会主动结束)，比如，Locky勒索软件不会在俄语系统中运行。在这个例子中，该僵尸软件检测到这个机器是英语环境，接下来，它做了以下几件事：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">a.	给syshost.exe程序创建一个服务，名称为“syshost32”(对于受害人，这个名称可能不会引起注意)，然后启动服务。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">b.	删除之前创建的临时文件。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">c.	通过几个命令，绕过计算机的防火墙和白名单。</span></p><p style="text-align:center"><img src="http://p0.qhimg.com/t016a847c5b21061ed0.png" title="t01cf5e44d0def45edf.png" alt="http://p4.qhimg.com/t01cf5e44d0def45edf.png"/></p><p style="text-align:center"><img src="http://p0.qhimg.com/t01d33876725c0ef7df.png" title="t01c3ed0e0255823f1f.png" alt="http://p9.qhimg.com/t01c3ed0e0255823f1f.png"/></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">10:08 AM.连接控制端</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">僵尸程序开始确定计算机能否联网，通过连接DNS服务器，并访问“Facebook.com”，如果DNS服务器解析了“Facebook.com”域名，僵尸程序为了找到一个响应的C&amp;C服务器，会立即发起域名生成算法(DGA)，并首先尝试以下四个域名：</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t0155bf8e925162e2bc.png" title="t01442a627360930647.png" alt="http://p9.qhimg.com/t01442a627360930647.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">如果上面四个域名无法连接，接下来，僵尸程序为了连接到C&amp;C服务器，会实施B计划。</span></p><p style="text-align:center"><img src="http://p3.qhimg.com/t017e27c8fac8fc1029.png" title="t012fa69ea7817b70d1.png" alt="http://p4.qhimg.com/t012fa69ea7817b70d1.png"/></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">10:09-10:19 AM.尝试一个新计划</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在检查了正确的时间后，僵尸程序为了找到C&amp;C服务器，开始第二次尝试，首先对“qcmbartuop.bit”中的数据进行57次尝试解析，如果失败，就对“Microsoft.com”进行尝试解析，如果还是失败，就进行C计划。C计划是使用域名生成算法，尝试连接2076个域名。以上所有都失败的话，还会有一个D计划，它会尝试连接一个C&amp;C服务器，IP地址作为硬编码已经被写入到了程序中。在10.12分，从该IP服务器上得到了回应，这个机器正式沦陷了。</span></p><p style="text-align:center"><img src="http://p9.qhimg.com/t01c9d746f6d614ace0.png" title="t0150fadfd6a7f3d920.png" alt="http://p5.qhimg.com/t0150fadfd6a7f3d920.png"/></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">10:20 AM.联通</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">最后，从一个硬编码的IP服务器得到了回应，僵尸主机成功上线，成功连接到了一个位于乌克兰的C&amp;C服务器。僵尸主机将机器的有关信息进行加密，并上传给C&amp;C服务器，然后僵尸主机随时等候下一步的命令。</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t01dff851db6286a83a.png" title="t01c25d694aeb439e8f.png" alt="http://p5.qhimg.com/t01c25d694aeb439e8f.png"/></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">11:13-4:30 PM.接收任务数据</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">乌克兰的C&amp;C服务器向僵尸主机发送大量的数据。包括软件的升级、目标地址、及稍后要发送的垃圾邮件的内容。此外，僵尸主机还尝试连接了其它C&amp;C服务器，但都失败了。</span></p><p style="text-align:center"><img src="http://p5.qhimg.com/t018f1e899296bd66c9.png" title="t019e18a8aec96f4b55.png" alt="http://p4.qhimg.com/t019e18a8aec96f4b55.png"/></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">10:21-11:14 PM.开始发动垃圾邮件攻击</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">该僵尸主机根据当天收到的指令，开始发送垃圾邮件。时间似乎是经过选择的，确保在美国的工作时间中。首先，僵尸主机开始寻找能用于发送垃圾邮件的SMTP服务器。起初尝试连接Gmail MX和Yahoo的服务器，但是都被拒绝了。几次尝试之后，成功连接到Yahoo和Hotmail的服务器，然后开始发动垃圾邮件攻击。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在11:14，“live.com”通知僵尸主机：“我们对于每小时和每天发送的消息数量是有限制的”，然后僵尸主机主动停止了当天的攻击。</span></p><p style="text-align:center"><img src="http://p8.qhimg.com/t014d09da13fa5ca48c.png" title="t0164b87283802a782b.png" alt="http://p2.qhimg.com/t0164b87283802a782b.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192); font-size: 18px;"><strong><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">第二天：</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">10:47 AM.勒索软件攻击</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在晚上已经收到了附加的加密信息，该僵尸主机开始通过发送钓鱼邮件的方式传播Locky勒索软件，邮件包含一个附件，该附件是一个经过压缩的JavaScript下载者。</span></p><p style="text-align:center"><img src="http://p0.qhimg.com/t01960bd87030caee42.png" title="t01aec60bd8afb0ac95.png" alt="http://p6.qhimg.com/t01aec60bd8afb0ac95.png"/></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">11:00 AM.完成了一天的工作</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在最初的24小时里发生了很多事情,想像一下，在僵尸网络所有僵尸主机的共同努力下，这是一个怎样的效果啊。</span></p><p style="text-align:center"><img src="http://p2.qhimg.com/t01ae067b7de9980a03.png" title="t01549a0e458c7a2516.png" alt="http://p0.qhimg.com/t01549a0e458c7a2516.png"/></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">经验教训</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在前24小时的生命中，该僵尸恶意软件被安装到计算机中，然后找到C&amp;C服务器、自身软件升级、传播垃圾邮件、和Locky勒索软件。包含了三个关键点：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">1.僵尸主机尝试了成千上万种不同的选择，非常执着的找到了一个C&amp;C服务器。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2.这个已经有两年的旧恶意软件成功的被一个工作的C&amp;C服务器所管理，C&amp;C服务器迅速对其进行了升级，证明了潜在威胁的弹性。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">3.该僵尸程序在相当长的一段时间中是不活跃的，可能由于以下几个原因：(a)等待更长的时间会自动防止沙箱的检测；(b)非活跃状态可以减少被感染计算机的资源使用；或者(c)僵尸程序的垃圾邮件/恶意软件活动是针对一个特殊的目标。</span></p><p style="text-align:center"><img src="http://p2.qhimg.com/t01bc4a97d313ed6c2e.png" title="t0178000d28fa3ed554.png" alt="http://p3.qhimg.com/t0178000d28fa3ed554.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">十一、躲在暗处：僵尸网络如何掩盖通信</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">僵尸网络最大的弱点在于僵尸主机需要和C&amp;C服务器进行通信，因为通过网络流量可以发现它。因此，网络犯罪分子使用各种方法来混淆僵尸网络通信，使它更难检测到僵尸主机的存在。多年以来，网络犯罪分子已经探索和发展了一系列越来越复杂的方法，来确保他们的非法网络能共享关键信息和指令。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">基于Tor的僵尸网络：Tor是一个众所周知的匿名通信工具，引导用户的互联网流量通过一个免费的、被设计成跳转数千次的全球网络，用来躲避各种类型的监控或分析，从而隐藏用户的位置和习惯。最近，犯罪份子已经使用Tor来隐藏C&amp;C服务器了，并运行在IRC协议之上。因为Tor是匿名的，用户的身份是隐藏的。在加上，所有的Tor流量都是加密传输的，因此，它能避过入侵检测系统，而且使用Tor网络是合法的。但是Tor网络也有一些缺点，这些缺点也影响到了僵尸网络，包括延迟、减速、和不可靠。</span></p><p style="text-align:center"><img src="http://p9.qhimg.com/t017a20857705690ca3.png" title="t0137084f724839aecc.png" alt="http://p2.qhimg.com/t0137084f724839aecc.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">域名生成算法(DGA):因为C&amp;C服务器的域名通常是作为硬编码写入到程序中的，安全方案可以相对容易的找到并阻止它们。为了避免被阻止，一些僵尸网络采用了域名生成算法，可以生成大量域名，从而使安全方案阻止它们变得很难。当然，并不是所有域名都会起作用，僵尸程序通常会遍历这个列表，直到找到一个能正常通联并使用的C&amp;C服务器的域名。就像前面我们讲到过的，Necurs僵尸网络就使用了DGA。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">互联网中继聊天(IRC)僵尸网络：IRC协议被第一代僵尸网络采用并用于犯罪目的。在一个IRC僵尸网络中，僵尸主机会作为一个客户端去连接IRC，并自动执行功能。IRC僵尸主机比较容易创建和管理，但安全专家通常有能力识别出这些服务器和僵尸控制者、并关闭僵尸网络。最近，IRC僵尸网络经历了一个小的复苏，得益于某些技术的发展，如使用多个C&amp;C服务器，这使快速关闭IRC僵尸网络的机会变得少了。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">加密/复杂协议：不仅仅是对消息进行加密，而且最好使用特殊的僵尸网络协议。就像后面我们要讲到的例子一样，任何通信字符串前都有多个报头和代码，这使得理解僵尸网络数据变得非常难。一些僵尸网络恶意软件，比如Gameover Zeus的木马，传播的恶意软件和C&amp;C的通讯都会被加密。在这个例子中，从被控服务器下载恶意软件时用了SSL进行加密，恶意软件被安装后，僵尸主机和C&amp;C服务器的通信数据也会被加密。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">社交网络：为了有效的躲避探测，新的恶意软件使用了社交网络，和基于WEB邮件的C&amp;C通信。安全研究人员已经发现有些恶意软件从tweets和Pinterest的评论中接收C&amp;C的数据。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">隐写术：数字隐写技术可以利用一个文件、消息、图片、或视频，来隐藏一个文件、消息、图片、或视频。僵尸主机可以利用这种技术，下载一个看似无害的图片文件，但实际上包含了C&amp;C服务器发送给僵尸主机的复杂的消息流。这个图片中可以存储任何数据。实际上，这种来自于看似正常的网络浏览流量、而且又经过了隐藏的数据，很难被探测到。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">将通信隐藏到合法服务中：和社交网络相似，如Dropbox，Pastebin，Imgur和Evernote，都可以隐藏僵尸网络的操作。就Dropbox来讲，C&amp;C服务器的地址可以隐藏到Dropbox帐户的文件中。在Imgur下，通过“Rig exploit kit”工具，受害人可以下载某种形式的勒索软件的数据。勒索软件可以将受害人机器上的文件和收集的信息进行加密，并重新打包成一个.png格式的文件，然后上传到Imgur的相册中，C&amp;C服务器再从相册中取出数据。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">全球C&amp;C服务器分布图：</span></p><p style="text-align:center"><img src="http://p2.qhimg.com/t0117565532d345370f.png" title="t0110864ffc605d55bc.png" alt="http://p7.qhimg.com/t0110864ffc605d55bc.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">上图显示：位于美国的C&amp;C服务器占到总数的30.09%，其次是荷兰，占到8.85%。</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192); font-size: 18px;"><strong><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">一、Cyren的研究：对C&amp;C通讯的分析</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Cyren对Gatak僵尸网络的恶意软件进行了分析研究，发现它使用了一个复杂的加密协议。下图是一个已经解密的僵尸主机发送给C&amp;C的数据包，目的是为了报告僵尸主机的状态：</span></p><p style="text-align:center"><img src="http://p5.qhimg.com/t016dfa84f5a914a3b9.png" title="t013693a5134769ce75.png" alt="http://p0.qhimg.com/t013693a5134769ce75.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">如上图，位置按16进制表示：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">从第0x00开始的16个字节：是shellcode的密钥ID。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">从第0x10开始的04个字节：是4字节的CRC校验值。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">从第0x14开始的16个字节：是shellcode的16字节随机生成的命令ID。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">从第0x24开始的16个字节：是shellcode的16字节随机生成的功能ID。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">第0x34字节：消息的字节头。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">从第0x35开始的08个字节：消息的8字节会话ID，在首次和C&amp;C服务器通信时会初始化为0。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">第0x3D字节：僵尸主机的命令标志(后面会讲到)。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">第0x3E字节：成功/错误的标志，0表示成功。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">第0x3F字节：信息标志，如果信息长度大于1024字节，设置为1。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">从第0x40开始的04个字节：信息的长度。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">从第0x44开始：信息本身。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">僵尸主机的命令标志信息如下图(上图第0x3D字节)：</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t01edb96b0652382a4f.png" title="t012d9d5fd129d24c18.png" alt="http://p8.qhimg.com/t012d9d5fd129d24c18.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">下图是一个已经解密的C&amp;C发送给僵尸主机的数据包：</span></p><p style="text-align:center"><img src="http://p6.qhimg.com/t0143c079eebbb17c00.png" title="t01a5977c0ec1feeac1.png" alt="http://p0.qhimg.com/t01a5977c0ec1feeac1.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">从第0x00开始的04个字节：4字节的CRC校验值。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">从第0x04开始的16个字节：16字节的C&amp;C服务器的命令ID。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">第0x14字节：消息的字节头。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">从第0x15开始的8个字节：消息的8字节会话ID。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">第0x1D字节：僵尸主机的命令标志。</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192); font-size: 18px;"><strong><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">二、幽灵域名：规避检测技术</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">当恶意软件样本被多个反病毒厂商检测到时，C&amp;C服务器的URL就不能再用了，该URL将会被很多WEB安全系统所屏蔽，导致僵尸主机无法解析出URL的地址，无法访问到C&amp;C服务器。显然，这是僵尸控制者面对的重要问题。那么怎么办呢？使用一种技术更改域名，这种技术被Cyren的研究人员称为“幽灵域名”。即在僵尸网络通信的HTTP域名字段中插入未知的域名，包括注册和未注册的，可以欺骗很多WEB安全系统和URL过滤系统。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">例如，幽灵域名怎么作为网络犯罪分子规避的方法，Cyren分析师观察恶意软件对www.djapp.info域名进行DNS解析，IP地址是52.1.45.42。</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t010293291a62323881.png" title="t01f493fdba7707a8ed.png" alt="http://p1.qhimg.com/t01f493fdba7707a8ed.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Cyren和其他几个安全厂商将这个域名标记为一个恶意的域名，并将它作为C&amp;C的地址阻止了。结果就是，在受这些厂商保护的网络中，所有对这个域名的HTTP请求都被阻止了。</span></p><p style="text-align:center"><img src="http://p0.qhimg.com/t016bf3bf758af26250.png" title="t01249daf92fd5b3c48.png" alt="http://p4.qhimg.com/t01249daf92fd5b3c48.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">然而，当其他机器用DNS解析了这个IP地址后，对一个新感染的僵尸主机向C&amp;C发送的数据进行分析，显示出以下的HTTP传输。这是在通知C&amp;C服务器，有一个新的机器成功被感染了。</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t0140638decf66ff25f.png" title="t01eb201cd21bf71047.png" alt="http://p4.qhimg.com/t01eb201cd21bf71047.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">上图显示，使用了不同的域名来连接52.1.45.42(多个域名指向同一个IP，之前的一个域名已经被屏蔽了)地址。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">目的地址是已知的恶意服务器，但是在HTTP请求的域名字段中使用了完全不同的域名--Cyren称为“幽灵域名”。在这个例子中，用于欺骗的幽灵域名是“events.nzlvin.net”和“json.nzlvin.net”，都指向52.1.45.42。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">这个技术可以从以下几个方面帮助僵尸网络控制者：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">1.WEB安全系统和URL过滤系统不会阻止幽灵域名，因为它们只会阻止原始的被解析的域名(在这个例子中只会阻止www.djapp.info)。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2.当收到这个“编码的”消息(说明主域名被屏蔽，僵尸主机使用了幽灵域名才发出了这个消息)时，僵尸控制者可以操纵服务器发送一个适当的响应。例如，给僵尸主机发送一个响应包，让它下载另一个特殊格式的恶意软件，并执行。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">3.通常，安全厂商只会屏蔽C&amp;C的域名，和C&amp;C的URL有关的IP地址不会被屏蔽，因为一个服务器上可能同时存在合法的网站、和有恶意行为的网站，如果将这个IP整个屏蔽，会造成一些合法的服务无法访问到。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;在那段时间，Cyren更新了自己的URL信誉数据库，Cyren的分析员检查了是否有安全厂商能检测到“events.nzlvin.net”和“json.nzlvin.net”两个幽灵域名，使用上面提到过的的HTTP请求。多个安全厂商可以将“www.djapp.info”标记为恶意域名，但是没有厂商能标记出幽灵域名。</span></p><p style="text-align:center"><img src="http://p3.qhimg.com/t01fa9a4dd939e126aa.png" title="t01b3fc89304e3ce6b7.png" alt="http://p6.qhimg.com/t01b3fc89304e3ce6b7.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在接下来的几个小时中，Cyren的沙箱阵列不断积累了关于该恶意IP的数据，在这个过程中，发现了一长列和它有关的幽灵域名。</span></p><p style="text-align:center"><img src="http://p9.qhimg.com/t01d47e3f2b3789a5cb.png" title="t0144f6c79b8be8031d.png" alt="http://p2.qhimg.com/t0144f6c79b8be8031d.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">尽管它们中的有些是注册的域名(创建于恶意软件出现的那几天)，有些没有注册的域名。</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192); font-size: 18px;"><strong><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">三、自卫：探测你网络中的僵尸</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">俗话说的好，“预防为主,治疗为辅”，这也同样适用于互联网安全。如果将避免感染放在首位，那显然是理想状态，实际很难实现，因为各种规避技术总是能愚弄许多安全系统。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">为了找到内部的僵尸主机，最好遵循以下建议---为了探测一个僵尸主机，你应该寻找僵尸主机和C&amp;C服务器的双向通信，有几个警告标志和方法，一个企业可以用这些找到存在的僵尸主机：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">检查邮件流量，如果由你的公司发送的邮件被收件公司或ISPs拒绝，这可能预示着从你公司发出的邮件被列入了黑名单，可能是由于你网络中存在僵尸主机，从事了垃圾邮件活动。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">利用公司防火墙。这可以检测到那些可疑的端口行为或未知的网络传输。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">安装一个入侵防御系统。这类系统具有内置的开放源代码或检测僵尸主机流量的厂商自定义的规则。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">使用Web安全/网址过滤系统。这类系统，如Cyren的WebSecurity,能阻止僵尸主机和C&amp;C的通信，并帮助管理员识别出僵尸主机的位置，从而清除它。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">考虑在你的网络上创建一个“暗网”。通过在你的局域网中创建一个子网，并记录访问这个子网的所有日志，通常不应该有流量被路由到它里面。你可以看一看有哪些计算机不听从你正常的网络设置；例如，这些计算机可能正在扫描他们打算感染的网络上的节点。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">使用厂商专门检测僵尸主机的安全解决方案。有厂商专门从事僵尸主机的检测，并依靠行为分析，使用日志分析和流量分析相结合的方法。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">一旦检测到异常的流量，下一步做的就是追查源头。网络安全解决方案提供了最大的可能来发现谁损害了你的网络。首选方案应该可以给用户提供简化识别过程的办法，特别是当用户在网络地址转换（NAT）设备之后。</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t01856f4d74ef6254df.png" title="t01898b2ea9571e6e83.png" alt="http://p7.qhimg.com/t01898b2ea9571e6e83.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192); font-size: 18px;"><strong><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">四、Cyren Globalview威胁趋势|2016年第3季度</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">“Cyren Globalview”季度安全指数已经发布，包括网络威胁的主要类型和全球趋势指标。这些指标是根据“Cyren Globalview”云安全数据生成的，它处理了超过6亿用户的WEB和邮件事件。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">根据Cyren云安全的监控，第三季度和第二季度的数据相比，钓鱼URL增长了22%，第三季度新增的钓鱼网站大约有1百万个。而WEB恶意软件的URL数量下降了10%，检测到的特殊恶意软件样本的总数增长了20%，特殊安卓手机恶意样本增长了32%，本季度平均每日邮件恶意软件的数量增长了59%，主要是由于Locky勒索软件在第三季度每周有5天都在持续活跃中。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">具体数据如下图所示：</span></p><p style="text-align:center"><img src="http://p5.qhimg.com/t01ad0286ed76fa06f5.png" title="t012fb163dd27d3e1f6.png" alt="http://p3.qhimg.com/t012fb163dd27d3e1f6.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">上图显示的是钓鱼威胁指数：在第三季度增长了22%。</span></p><p style="text-align:center"><img src="http://p2.qhimg.com/t01e4b5a666ba1d669c.png" title="t01ab9d5a8191a11651.png" alt="http://p5.qhimg.com/t01ab9d5a8191a11651.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">上图显示的是WEB恶意软件的URLs威胁指数：在第三季度减少了10%。</span></p><p style="text-align:center"><img src="http://p9.qhimg.com/t01b40d147790e19561.png" title="t017ec69e09616970da.png" alt="http://p0.qhimg.com/t017ec69e09616970da.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">上图显示的是垃圾邮件威胁指数：在第三季度增长了2%。</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t014f73eda6a1b40297.png" title="t015fafcef073886e0d.png" alt="http://p1.qhimg.com/t015fafcef073886e0d.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">上图显示的是恶意软件威胁指数：在第三季度增长了20%。</span></p><p style="text-align:center"><img src="http://p6.qhimg.com/t0194005c457f8e4cdd.png" title="t0110b58958f9d25a2e.png" alt="http://p3.qhimg.com/t0110b58958f9d25a2e.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">上图显示的是Android恶意软件威胁指数：在第三季度增长了32%。</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t014fe630eb413bde11.png" title="t018d7a4af45ab32761.png" alt="http://p5.qhimg.com/t018d7a4af45ab32761.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">上图显示的是邮件恶意软件威胁指数：在第三季度增长了59%。</span></p><p style="white-space: normal; text-indent: 2em;"><span style="color: rgb(0, 112, 192); font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong><span style="text-indent: 2em;"><br/></span></strong></span></p><p style="white-space: normal; text-indent: 2em;"><span style="color: rgb(0, 112, 192); font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong><span style="text-indent: 2em;">传送门</span></strong></span></p><hr style="white-space: normal;"/><p style="white-space: normal; text-indent: 2em;"><a href="http://bobao.360.cn/learning/detail/3412.html" target="_blank" textvalue="【技术分享】2017僵尸网络研究报告（上）" style="text-decoration: none;"><span style="color: rgb(0, 112, 192); font-size: 18px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><strong>【技术分享】2017僵尸网络研究报告（上）</strong></span></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span><br/></p></p>
                <hr/>
                <p style="text-align: center;">
                    <img src="http://bobao.360.cn/img/app.jpeg"/>
                    <img src="http://bobao.360.cn/img/weixin.jpeg"/>
                </p>
                                <p>本文由 安全客 翻译，转载请注明“转自安全客”，并附上链接。<br/><a class="text-more" href="http://pages.cyren.com" target="_blank">原文链接：http://pages.cyren.com</a></p>
                            </div>
            <div style="margin-top: 20px;background-color:#FFFFFF">
    <input type="hidden" id="detail_title" name="detail_title" value="【技术分享】2016僵尸网络研究报告（下） - 安全客 - 有思想的安全新媒体" />
    <input type="hidden" id="use_nickname" name="use_nickname" value="0" />
    <a name="mao"></a>
    <div class="reg-log mobile-hiden">
        <div class="" id="userTo">   
            <div id="to-list" class="input-text" style="">
                <textarea disabled="disabled" class="hide"  id="comment-content" to="to"></textarea>
                <ul id="preadded" style="display:none">       
                </ul>
                <div id="to-auto" style="width: 200px">
                    <ul id="feed">
                    </ul>
                </div>
            </div>
        </div>
        <input type="hidden" id="source-id" value="3413" />
        <input type="hidden" id="source-type" value="learning" />
        <input type="hidden" id="post-comment-url" value="/comment/add" />
        <input type="hidden" id="post-nickname-url-ajax" value="/comment/randnicknameajax" />
        <input type="hidden" id="post-check-login-url-ajax" value="/comment/checklogin" />
        <input type="hidden" id="stoken_comment_set" value="ea3898fb4df38673fdeb61c458234054">                 <span class="join">参与讨论，请先 <a href="javascript:;" class="comment-login">登录</a> | <a href="javascript:;" class="comment-reg">注册</a> |  <a href="javascript:;" class="anonymous-comment">匿名评论</a></span>
            </div>
    <div class="mobile-hide" style="width: 870px; margin: 0 auto;">
        <label style="vertical-align:middle;" for="use_nickname">匿名</label> 
        <input style="vertical-align:middle;" id="trigger-nickname" name="use_nickname" class="use_nickname" type="checkbox" value="0" />

        <a href="javascript:;" class="apply-use button" id="submit-comment" data-target="/comment/add">发布</a>
    </div>


    <div class="clearfix"></div>
    <div class="comments">
        <div class="comments-head">
            <span class="title">用户评论</span>
        </div>
                <div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/10x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="11447" user-name="你全家都是黑客" href="javascript:;">
                你全家都是黑客            </a>
                        <span class="comment-time">2017-01-18 14:13:42</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="11447">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_11447" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">关于幽灵域名，这招在国内不好使吧？国内的cert处理这种情况，是不是直接通知网监，然后让ISP封堵IP？管你这个IP上有啥服务</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>

        <a class="more-long comment-more" href="javascript:;" data-target="/comment/more" data-type="learning" data-source-id="3413" data-page="2">查看更多</a>
            </div>
</div>
<script>
    $(function () {
        $('.anonymous-comment').click(function () {
            $(".join").hide();
            $(".reg-log textarea").first().removeAttr("disabled").show();
            $('#use_nickname').val('1');
//            $('#trigger-nickname').attr('checked', true);
            $('#trigger-nickname').trigger('click');
        });
        //为所有复选框绑定事件
//        checkbox_on_click();
        //ajax随机获取昵称
//        randnicknameajax(0);
        //ajax检测登录状态
        comment_check_login();
    });



    function input_checkbox(flag) {
        $('input:checkbox').each(function () {
            var value = flag ? 1 : 0;
            $(this).prop('checked', flag);
            $(this).val(value);
        });
    }

//ajax随机获取昵称
    function randnicknameajax(flag) {
        $.ajax({
            type: 'POST',
            url: $('#post-nickname-url-ajax').val(),
            data: {limit: 1, flag: flag},
            dataType: "json",
            success: function (data) {
                $('#nick-name').val(data.data[0]);
                _nick_name=data.data[0];
            }
        });
    }
    $();
//ajax检测登录状态
    function comment_check_login() {
        $.ajax({
            type: 'POST',
            url: $('#post-check-login-url-ajax').val(),
            data: {},
            dataType: "json",
            success: function (data) {
                if (data.success) {
                    $('.join').hide();
                    $(".reg-log textarea").first().removeAttr("disabled").show();
                    $("#span_use_nickname").show();
                    $('#use_nickname').val('0');
                    $('#use_nickname').attr('checked', false);
                }
            }
        });
    }
</script>        </div>
    </div>
    <div class="side-bar">
        <div class="mod hot-news">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-hot"></i><span>热门知识</span></h2>
    </div>
    <ul class="links-list">
                                <li><a href="/learning/detail/4411.html" alt="【漏洞预警】一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现——最新的Office高级威胁攻击预警" target="_blank">【漏洞预警】一个换行符引发的奥斯卡...</a></li>
                                <li><a href="/learning/detail/4416.html" alt="【漏洞预警】Microsoft .NET Framework漏洞（CVE–2017–8759）预警" target="_blank">【漏洞预警】Microsoft .NE...</a></li>
                                <li><a href="/learning/detail/4414.html" alt="【技术分享】妙用JavaScript绕过XSS过滤" target="_blank">【技术分享】妙用JavaScrip...</a></li>
                                <li><a href="/learning/detail/4418.html" alt="【技术分享】利用威胁情报数据平台拓展APT攻击线索一例" target="_blank">【技术分享】利用威胁情报数据平台拓...</a></li>
                                <li><a href="/learning/detail/4417.html" alt="【知识】9月15日 - 每日安全知识热点" target="_blank">【知识】9月15日 - 每日安全知识热...</a></li>
                                <li><a href="/learning/detail/4425.html" alt="【安全报告】XShellGhost事件技术回顾报告" target="_blank">【安全报告】XShellGhost事件...</a></li>
            </ul>
</div>        <!-- 友情链接 -->
        <div class="mod blog-links mobile-hide">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-link"></i><span>友情链接</span></h2>
        <a href="/links/index.html" class="more">更多<i></i></a>
    </div>
        <ul class="links-list">
                <li><a href="http://bbs.360safe.com" alt="360安全社区" target="_blank">360安全社区</a></li>
                <li><a href="http://zhuji.360.cn" alt="360主机卫士" target="_blank">360主机卫士</a></li>
                <li><a href="http://blogs.360.cn/" alt="奇虎360技术博客" target="_blank">奇虎360技术博客</a></li>
                <li><a href="http://wangzhan.360.cn/" alt="360网站卫士" target="_blank">360网站卫士</a></li>
                <li><a href="http://webscan.360.cn/" alt="360网站安全检测" target="_blank">360网站安全检测</a></li>
                <li><a href="http://research.360.cn/report/" alt="360研究报告" target="_blank">360研究报告</a></li>
                <li><a href="http://unicorn.360.cn/" alt="360 Unicorn Team" target="_blank">360 Unicorn Team</a></li>
                <li><a href="http://appscan.360.cn/" alt="360捉虫猎手" target="_blank">360捉虫猎手</a></li>
                <li><a href="https://threathunter.org/" alt="ThreatHunter社区" target="_blank">ThreatHunter社区</a></li>
                <li><a href="http://security.360.cn/" alt="360安全应急响应中心" target="_blank">360安全应急响应中心</a></li>
            </ul>
    </div>
        <!-- 联系我们 -->
        <div class="mod contact mobile-hide" style="text-align:center">
    <div class="head-bar clearfix">
        <h2><i></i><span>关注我们</span></h2>
    </div>
    <!-- 微信关注 -->
    <ul class="contact-way">
        <li><a>微信关注</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/qrcode_adlab_weixin.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
    <!-- APP下载 -->
    <ul class="contact-way">
        <li><a>安全播报APP</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/scan_code_big.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
</div>

    </div>
</div>

<script type="text/javascript" src="/js/jquery-ui.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/jquery.noty.packaged.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/common.js?v=4.5"></script>
<script>$(function() {sync_count('comment');});</script>


<!-- 语法高亮 -->
<script type="text/javascript" src="/ue/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">SyntaxHighlighter.all();sync_count('vul');sync_count('news');sync_count('learning');sync_count('activity');sync_count('course');sync_count('ctf');</script>
    </div>

        <div class="footer">
        <div class="friend-link">
            <a href="http://www.360.cn/" target="_blank">360首页</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">关于我们</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">联系我们</a>
            <span>|</span>
            <a href="/links/index.html" target="_blank">友情链接</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">招贤纳士</a>
        </div>
        <div class="copy">
            Copyright &copy; 360网络攻防实验室 All Rights Reserved <span class="copy_icp">京ICP证080047号[京ICP备08010314号-6]</span>
        </div>
    </div>
    
</div>

<!--奇舞团统计-->

<script src='https://s.ssl.qhimg.com/static/f5407c785655e6a1/monitor_analytic.js'></script>
<script>
    monitor.setProject('QH_171_1').getTrack().getClickAndKeydown().getClickHeatmap(10, 1);
</script>

<div class="hide">
    <script src="https://s95.cnzz.com/z_stat.php?id=1253147824&web_id=1253147824" language="JavaScript"></script>
</div>
<div class="backToTop_wrap off">
    <a id="back_to_top" class="backToTop" href="javascript:;" title="返回顶部"></a>
</div>
<script>
    var $backToTop_wrap = $(".backToTop_wrap"),
        $backToTop_btn = $("#back_to_top");

    if ($(window).scrollTop() > 100) {
        $backToTop_wrap.removeClass("off");
    }
    else {
        $backToTop_wrap.addClass("off");
    }

    $(window).on("scroll", function () {
        if ($(this).scrollTop() > 100) {
            $backToTop_wrap.removeClass("off");
        }
        else {
            $backToTop_wrap.addClass("off");
        }
    });

    $backToTop_btn.on("click", function () {
        $("html, body").animate({scrollTop: 0}, 120);
    });

    $(function () {
        var navlist = $('.nav-list > li');

        navlist.each(function () {
            $(this).on('mouseenter', function () {
                $(this).addClass('selected');
            });

            $(this).on('mouseleave', function () {
                $(this).removeClass('selected');
            });
        });
    })
</script>



</body>
</html>
