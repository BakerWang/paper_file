<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:wb="http://open.weibo.com/wb" xml:lang="en" lang="en">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <link rel="shortcut icon" href="http://bobao.360.cn/favicon.ico?v=1.1"/>
    <link rel="alternate" title="安全资讯" href="/rss?type=news" type="application/rss+xml"/>
    <link rel="alternate" title="安全知识" href="/rss?type=learning" type="application/rss+xml"/>
    <link rel="alternate" title="安全圈活动" href="/rss?type=activity" type="application/rss+xml"/>
    <link rel="alternate" title="所有漏洞" href="/rss?type=vul" type="application/rss+xml"/>
    <link rel="alternate" title="通用型漏洞" href="/rss?type=commonvul" type="application/rss+xml"/>
    <link rel="alternate" title="事件型漏洞" href="/rss?type=eventvul" type="application/rss+xml"/>
    <link rel="alternate" title="热门漏洞" href="/rss?type=hotvul" type="application/rss+xml"/>

        <title>【技术分享】一个 ELF 蠕虫分析 - 安全客 - 有思想的安全新媒体</title>
    
        <meta name="keywords" content="ELF,蠕虫,分析"/>
    
        <meta name="description" content="我们在网上发现了一个有趣的 ELF 蠕虫，这可以帮助提高系统管理员的安全意识。这是个已知的 ELF 恶意软件，可能是 `Linux/PnScan` 的最新变种，这是一个提高对活动蠕虫认识的好机会。"/>
        <meta property="wb:webmaster" content="224437c7be31d633"/>

    <script type="text/javascript" src="http://s7.qhimg.com/!56caa871/xpc_sync_height.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/reset.css" />
    <link rel="stylesheet" type="text/css" href="/css/common_new.css?v=4.4.2.1" />
    <link rel="stylesheet" type="text/css" href="/css/jquery.notyfy.css" />
    <link rel="stylesheet" type="text/css" href="/css/notyfy.theme.default.css" />
    <link rel="stylesheet" type="text/css" href="/css/s_common.css?v=2.2.7" media="only screen and
    (max-device-width:900px), only screen and (max-width:900px)" />
    <script type="text/javascript" src="/js/jquery.min.js?v=3.1"></script>
    <script type="text/javascript" src="/js/jquery.notyfy.js"></script>
    <script type="text/javascript" src="/js/iscroll.js"></script>
    <script src="http://js.passport.qihucdn.com/5.0.3.js"></script>
    <script type="text/javascript">
        var myScroll, myNavScroll;

        function iscrollLoaded() {
            myScroll = new IScroll('#wrapper',
                {
                    scrollX: true,
                    scrollY: false,
                    bounceEasing: 'circular',
                    eventPassthrough: true,
                    preventDefault: false,
                    bounceTime: 500
                }
            );
        }

        $(function () {

            //导航横向滚动


            function setNavWidth() {

                /* 计算导航宽度 */
                var allWidth = $(window).width();
                var scroller = $('#scroller');

                if (allWidth > 900) {
                    scroller.find('ul').add(scroller.find('.scroll')).removeAttr('style');
                    scroller.css('overflow', 'visible');
                    if (myNavScroll) myNavScroll.destroy();
                } else {

                    var width = 0;
                    scroller.find('.scroll').children('ul').children('li').each(function (index, el) {
                        if (!$(this).hasClass('mobile-hide')) {
                            width += $(this).outerWidth();
                        }
                    });
                    scroller.find('ul').add(scroller.find('.scroll')).width(width);

                    if (myNavScroll) myNavScroll.destroy();

                    myNavScroll = new IScroll('#scroller', {
                        scrollX: true,
                        scrollY: false,
                        momentum: false,
                        click: true
                    });

                }

            }

            setNavWidth();
            $(window).resize(function (event) {
                setNavWidth();
            });

        });

    </script>
</head>
<body onload="iscrollLoaded();">
<div style='margin:0 auto;width:0px;height:0px;overflow:hidden;'>
    <img src=""/>
</div>

<div id="is-mobile"></div>
<div class="container">
        <div class="mobile-header">
        <div class="header clearfix">
            <div class="header-wrapper clearfix">
                <a href="/index/index" class="logo"><img class="slogan" src="/img/logo.png?v=1.5"/></a>
                                <form id="search" class="search-box" action="/search/index" method="GET">
                    <input class="keys" name="keywords" type="text" placeholder="搜索漏洞" required="required">
                    <input class="icon" type="submit" value="">
                    <input type="hidden" name="type" value=""/>
                </form>
                <div class="bug">
                    <div class="name"><span class="seled">全部</span><i class="arrow"></i></div>
                    <ul class="typelist">
                        <li data-index="3"><a href="javascript:void(0);">全部</a></li>
                        <li data-index="0"><a href="javascript:void(0);">漏洞</a></li>
                        <li data-index="1"><a href="javascript:void(0);">资讯</a></li>
                        <li data-index="2"><a href="javascript:void(0);">知识</a></li>
                    </ul>
                </div>
                                <div class="logNreg mobile-hide">
                    <div class="unlog">
                        <i></i>
                        <a href="log.html" class="log">登录</a>
                        <span>|</span>
                        <a href="reg.html" class="reg">注册</a>
                    </div>
                    <div class="loged">
                        <a href="/member/profile" class="user-center"><i></i><span class="user-name-tag">个人中心</span></a>
                        <div class="user-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting"><a href="http://i.360.cn/profile/accountmanage"
                                                               target="_blank"><i></i><span>账号设置</span></a></li>
                                <li class="alert-setting"><a href="/keywords/index"
                                                             target="_blank"><i></i><span>告警设置</span></a></li>
                                <li class="bug-alert"><a href="/myalarm/index" target="_blank"><i></i><span>漏洞告警</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mylearn/index" target="_blank"><i></i><span>我的知识</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mycourse/index" target="_blank"><i></i><span>我的课堂</span></a>
                                </li>
                                <li class="my-exit"><a
                                            href="http://login.360.cn/?src=pcw_adlab&op=logout&destUrl=http://bobao.360.cn"><i></i><span>退出系统</span></a>
                                </li>
                            </ul>
                        </div>

                        <a href="/message" class="message-center" target="_blank"><i></i><span>我的消息</span></a>
                        <div class="message-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting" style="display:none;"><a href="/myres/index"
                                                                                     target="_blank"><i></i><span>回复我的</span></a>
                                </li>
                                <li class="my-bug"><a href="/myvul/index"
                                                      target="_blank"><i></i><span>我的漏洞</span></a></li>
                                <!--<li class="my-bug"><a href="/myres/index" target="_blank"><i></i><span>我的评论</span></a></li>-->
                                <!--<li class="alert-setting"><a href="###" target="_blank"><i></i><span>提到我的</span></a>
                                </li>-->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <style type="text/css">
            .nav {
                overflow: hidden;
            }

            .nav .scroll {
                width: auto;
            }
        </style>
        <div id="wrapper">
            <div id="scroller" class="nav">
                <div class="scroll">
                    <ul class="nav-list">
                        <li ><a class="link-nav"
                                                                                 href="/index/index">首页</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/vul/index">漏洞</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/introduce/list">招聘</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/news/index">资讯</a><!--<i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/introduce/list">招聘</a></li>
                        </ul>
			-->
                        </li>
                        <li class="cur">
                        <a class="link-nav" href="/learning/index">知识</a><i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/course/index">学院</a></li>
                        </ul>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/activity/index">活动</a></li>
                        <li class="mobile-hide "><a class="link-nav"
                                                                                                   href="/ctf/index">CTF训练营</a>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/interref/list">安全内参</a></li>
                        <li ><a class="link-nav" href="/app/index">APP</a></li>

                        <!--<li ><a href="/course/index">学院</a></li>-->
                        <!--<li ><a href="/introduce/list">招聘</a></li>-->
                        <!--<li  class="mobile-hide"><a href="/ctf/index">CTF训练营</a></li>-->
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="mobile-content">
        <link rel="stylesheet" type="text/css" href="/css/news.css?v=3.5" />
<link rel="stylesheet" type="text/css" href="/ue/SyntaxHighlighter/shCoreDefault.css?v=1.0" />
<style>
    p .syntaxhighlighter {
        width: 80%;
    }
</style>

<div class="cur-pos w1000">当前位置：<a href="http://bobao.360.cn/">安全客</a> &gt;&gt; 知识详情</div>

<div class="content clearfix">
    <div class="main">
        <div class="article">
            <div id="article_box">
                <h2>【技术分享】一个 ELF 蠕虫分析</h2>
                <div class="article-msg">
                    <span class="time">2016-12-14 15:42:12</span>
                    
                                        <span class="read">阅读：11415次</span>
                    <span><a style="display: none;" class="good" href="javascript:;"
                             data-target="/learning/good" data-value="g_3290"
                             data-type="learning">点赞(0)</a></span>
                    <span><a class="fav" href="javascript:;" data-target="/mylearning/add"
                             data-pk="3290" data-type="learning">收藏</a></span>
                                        <span><a style="margin-left: 4px;" class="fav" href="http://www.kernelmode.info/forum/viewtopic.php?f=16&amp;t=3975&amp;p=26827#p26827v"
                             target="_blank">来源： kernelmode.info</a></span>
                    
                    
                    <div style="margin-top:10px; ">
                        <a href="/member/contribute?uid=2795682273" style="color:#848e99;">
                            <img src="http://p1.qhmsg.com/dm/150_150_100/t00df551a583a87f4e9.jpg" data-is-avatar="true"
                                 style="border: 1px solid #d5d5d5;padding: 2px; width: 80px;height: 80px;border-radius: 43px;"/>
                        </a>

                    </div>
                    <span class="orig">作者：<a href="/member/contribute?uid=2795682273" style="color:#848e99;">Titan_Avenger</a></span>
                                    </div>
                <hr size="1">
                <div class="article-msg">
                    <p><!-- JiaThis Button BEGIN -->

<!--
<span class="jiathis_style"><span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_tsina"></a>
    <a class="jiathis_button_tqq"></a>
    <a class="jiathis_button_qzone"></a>
    <a class="jiathis_button_renren"></a>
    <a class="jiathis_button_xiaoyou"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
</span>

-->
</p>
                </div>
                <p><p style="text-align:center"><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px; font-weight: 900;"><img src="http://p1.qhimg.com/t013fa4162a9fa5edfe.jpg" title="t013fa4162a9fa5edfe.jpg" alt="http://p1.qhimg.com/t013fa4162a9fa5edfe.jpg"/></span></p><p style="margin: 0px 25px 8px; padding: 0px; line-height: 25px; color: rgb(70, 79, 85); word-break: break-all; font-family: Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, 微软雅黑, serif; white-space: normal; text-indent: 2em; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px; font-weight: 900;">翻译：</span><a href="http://bobao.360.cn/member/contribute?uid=2795682273" target="_blank" style="text-decoration: none;"><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px; font-weight: 900;">Titan_Avenger</span></a></p><p style="margin: 0px 25px 8px; padding: 0px; line-height: 25px; color: rgb(70, 79, 85); word-break: break-all; font-family: Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, 微软雅黑, serif; white-space: normal; text-indent: 2em; background-color: rgb(255, 255, 255);"><span style="font-weight: 900;"><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;">预估稿费：200RMB（不服你也来投稿啊！）</span></span></p><p style="margin: 0px 25px 8px; padding: 0px; line-height: 25px; color: rgb(70, 79, 85); word-break: break-all; font-family: Helvetica, &quot;Hiragino Sans GB&quot;, &quot;Microsoft Yahei&quot;, 微软雅黑, serif; white-space: normal; text-indent: 2em; background-color: rgb(255, 255, 255);"><span style="font-weight: 900;"><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;">投稿方式：发送邮件至linwei#360.cn，或登陆网页版在线投稿</span></span></p><p style="text-align: left; text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;"><br/></span></strong></p><p style="text-align: left; text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;">背景</span></strong></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><hr/><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">我们在网上发现了一个有趣的 ELF 蠕虫，这可以帮助提高系统管理员的安全意识。这是个已知的 ELF 恶意软件，可能是 `Linux/PnScan` 的最新变种，在 x86-32 平台发现，从网络中受感染的结点到了我们手中。这个蠕虫针对嵌入式平台，我有点惊讶 i86 程序可以命中 Linux 目标。</span><br/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在样本送到 MalwareMustDie ELF 分析团队之前，我在 2015 年 9 月 28 日发表过一篇讲述该威胁的[文章][1]，我认为这种威胁现在已经消失了，但是我错了。因为恶意软件那时正处在蠕虫的感染阶段，硬编码指向 183.83.0.0，该恶意程序也是在此处被发现的。在此之前，我从来没有写过这种威胁，这是一个提高对活动蠕虫认识的好机会。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-align: left; text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;">威胁指标</span></strong></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><hr/><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">出于某种原因，我们不能告知你传染源来自哪里，但就存在于上面提到的 IP 段内。寻找一个受感染的主机非常困难，似乎恶意软件在绕着特定的网络兜圈子。</span><br/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">该文件具有以下特征：</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:bash;toolbar:false">Filename:&nbsp;&#39;stdin&#39;(.pnscan.x86-32.mmd)
Type:&nbsp;&#39;ELF&nbsp;32-bit&nbsp;LSB&nbsp;executable,&nbsp;Intel&nbsp;80386&#39;&nbsp;(GNU/Linux)&nbsp;statically&nbsp;linked,&nbsp;stripped
Packer:&nbsp;&#39;UPX&nbsp;(header&nbsp;bit&nbsp;&nbsp;tweak)&nbsp;packed,&#39;
Spotted:&nbsp;&#39;Tue&nbsp;Aug&nbsp;23&nbsp;12:27:21&nbsp;UTC&nbsp;2016&#39;
md5:&nbsp;&nbsp;&#39;6fb6f95546d5bdf4db11655249ee5288&#39;
sha1:&nbsp;&#39;2d3e2ce680de6c13ab3236429efd4bca3bfaa79d&#39;
According&nbsp;to&nbsp;VirusTotal&nbsp;it&#39;s&nbsp;firstly&nbsp;spotted&nbsp;months&nbsp;ago:
&nbsp;&nbsp;&nbsp;&nbsp;&#39;First&nbsp;submission&nbsp;2016-01-27&nbsp;05:26:45&nbsp;UTC&#39;</pre><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">静态检测可知，使用了 UPX 壳：</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:bash;toolbar:false">ELF&nbsp;Header:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;↓typical&nbsp;packed&nbsp;one&#39;
&nbsp;&nbsp;Magic:&nbsp;&nbsp;&nbsp;7f&nbsp;45&nbsp;4c&nbsp;46&nbsp;01&nbsp;01&nbsp;01&nbsp;03&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00&nbsp;00
&nbsp;&nbsp;Class:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELF32
&nbsp;&nbsp;Data:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&#39;s&nbsp;complement,&nbsp;little&nbsp;endian
&nbsp;&nbsp;Version:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;(current)
&nbsp;&nbsp;OS/ABI:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UNIX&nbsp;-&nbsp;GNU
&nbsp;&nbsp;ABI&nbsp;Version:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0
&nbsp;&nbsp;Type:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXEC&nbsp;(Executable&nbsp;file)
&nbsp;&nbsp;Machine:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Intel&nbsp;80386
&nbsp;&nbsp;Version:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x1
&nbsp;&#39;Entry&nbsp;point&nbsp;address:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xcfce38&#39;
&nbsp;&#39;Start&nbsp;of&nbsp;program&nbsp;headers:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;52&nbsp;(bytes&nbsp;into&nbsp;file)&#39;
&nbsp;&nbsp;Start&nbsp;of&nbsp;section&nbsp;headers:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;(bytes&nbsp;into&nbsp;file)
&nbsp;&nbsp;Flags:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x0
&#39;&nbsp;Size&nbsp;of&nbsp;this&nbsp;header:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;52&nbsp;(bytes)&#39;
&#39;&nbsp;Size&nbsp;of&nbsp;program&nbsp;headers:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;32&nbsp;(bytes)&#39;
&#39;&nbsp;Number&nbsp;of&nbsp;program&nbsp;headers:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&#39;
&#39;&nbsp;Size&nbsp;of&nbsp;section&nbsp;headers:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;40&nbsp;(bytes)&#39;</pre><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">就像我在[其他文章][2]中解释的一样，这是一个典型的 UPX 头。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:bash;toolbar:false">Type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Offset&nbsp;&nbsp;&nbsp;&nbsp;VirtAddr&nbsp;&nbsp;&nbsp;PhysAddr&nbsp;&nbsp;&nbsp;FileSiz&nbsp;MemSiz&nbsp;&nbsp;Flg&nbsp;Align
&nbsp;&nbsp;LOAD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x000000&nbsp;&#39;0x00c01000&#39;&nbsp;0x00c01000&nbsp;0xfc661&nbsp;0xfc661&nbsp;R&nbsp;E&nbsp;0x1000
&nbsp;&nbsp;LOAD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x000d68&nbsp;&#39;0x08290d68&#39;&nbsp;0x08290d68&nbsp;0x00000&nbsp;0x00000&nbsp;RW&nbsp;&nbsp;0x1000</pre><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">原始二进制文件可以看出 UPX 的打包痕迹：</span></p><pre class="brush:bash;toolbar:false">![1](https://lh3.googleusercontent.com/YekCRyfD4BBBVLnmzZY4UYc4002o2K06ZUbLvtRBP1lnBQHqLe0HDPh_TFXI0zFxYvCwPrSM1FIKmg=w853-h486-no)</pre><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">该蠕虫使用了定制的 UPX 头部样式来逃避逆向分析和解码：</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:bash;toolbar:false">0x00000000&nbsp;&nbsp;7f45&nbsp;4c46&nbsp;0101&nbsp;0103&nbsp;0000&nbsp;0000&nbsp;0000&nbsp;0000&nbsp;&nbsp;.ELF............
0x00000010&nbsp;&nbsp;0200&nbsp;0300&nbsp;0100&nbsp;0000&nbsp;38ce&nbsp;cf00&nbsp;3400&nbsp;0000&nbsp;&nbsp;........8...4...
0x00000020&nbsp;&nbsp;0000&nbsp;0000&nbsp;0000&nbsp;0000&nbsp;3400&nbsp;2000&nbsp;0200&nbsp;2800&nbsp;&nbsp;........4.&nbsp;...(.
0x00000030&nbsp;&nbsp;0000&nbsp;0000&nbsp;0100&nbsp;0000&nbsp;0000&nbsp;0000&nbsp;0010&nbsp;c000&nbsp;&nbsp;................
0x00000040&nbsp;&nbsp;0010&nbsp;c000&nbsp;61c6&nbsp;0f00&nbsp;61c6&nbsp;0f00&nbsp;0500&nbsp;0000&nbsp;&nbsp;....a...a.......
0x00000050&nbsp;&nbsp;0010&nbsp;0000&nbsp;0100&nbsp;0000&#39;680d&nbsp;0000&nbsp;680d&nbsp;2908&#39;&nbsp;........h...h.).
0x00000060&nbsp;&nbsp;680d&nbsp;2908&nbsp;0000&nbsp;0000&nbsp;0000&nbsp;0000&nbsp;0600&nbsp;0000&nbsp;&nbsp;h.).............
0x00000070&nbsp;&nbsp;0010&nbsp;0000&nbsp;22c0&nbsp;e4b8&nbsp;5550&nbsp;5821&nbsp;3408&nbsp;0d0c&nbsp;&nbsp;....&quot;...UPX!4...
0x00000080&nbsp;&nbsp;0000&nbsp;0000&nbsp;783f&nbsp;2400&nbsp;783f&nbsp;2400&nbsp;9400&nbsp;0000&nbsp;&nbsp;....x?$.x?$.....
0x00000090&nbsp;&nbsp;5d00&nbsp;0000&nbsp;0800&nbsp;0000&nbsp;771f&nbsp;a4f9&nbsp;7f45&nbsp;4c46&nbsp;&nbsp;].......w....ELF
0x000000a0&nbsp;&nbsp;0100&nbsp;0200&nbsp;0300&nbsp;1b68&nbsp;8104&nbsp;fbaf&nbsp;bddf&nbsp;0834&nbsp;&nbsp;.......h.......4
0x000000b0&nbsp;&nbsp;0ef8&nbsp;3c24&nbsp;2f16&nbsp;2032&nbsp;2800&nbsp;1000&nbsp;0f00&nbsp;5b5c&nbsp;&nbsp;..&lt;$/.&nbsp;2(.....[\
0x000000c0&nbsp;&nbsp;e59d&nbsp;1d80&nbsp;4607&nbsp;c807&nbsp;2200&nbsp;0527&nbsp;db76&nbsp;7fcf&nbsp;&nbsp;....F...&quot;..&#39;.v..</pre><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">有一些方法可以将其转换该 ELF 成原始形式，我会在这个案例处理完毕写一个如何做的文章。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">我们有几种不同的方法来破解用定制 UPX 处理过的 ELF 程序。其中之一就曾经在分析 `xxx.pokemon(.)inc` 时用过，[文章][3]中提到这是一个 IRC DDoS 僵尸网络。另一种方法是通过不同的破解手段来实现脱壳，在 radare.org 的论坛上有公开的[分享文章][4]。</span></p><pre class="brush:bash;toolbar:false">![2](https://lh3.googleusercontent.com/duPmCXCzsMk3yZgxwANVTC-1EsDNtlETg6f7B0b1GAaWGJm-QGmsw3r2hItXTYu0L2fr3eFNKRTvNw=w500-h500-no)</pre><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">上面提到的教程方法都可以成功的破解这个 ELF。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在处理一个困难的 ELF 壳时，我对系统管理员 和 RCE 新手的忠告是：如果你认定了什么事儿，就按照设定的目标不断提高自己，保持耐心和勇气。永远记住，骗子不会变得比你更聪明，秉持这个信念你总会解决问题的！</span></p><p style="text-align: left; text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em; color: rgb(227, 108, 9);">Linux/PnScan 蠕虫细节</span></strong><br/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">以下是 `Linux/PnScan` 蠕虫脱壳的细节，这段视频实际上是我给 CERT 和 IR 做的教程，指导其如何应付这种威胁。我使用 `radare` 来进行逆向分析，案例中有大量的编辑，有些删减掉了、有一部分出于安全考虑隐去了、也有无法解释的部分被跳过了。但是在视频中的全部内容都是可以公开的，如果你是一个 ISP 的 IR 或者在 CERT 工作，这个视频非常值得你观看！因为其他安全原因，有很多细节没有在这个[视频][5]中体现。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">译者注：原作者提到该视频中段有可能会遇到无法加载的情况，原作者希望你可以通过重新加载页面来解决这个问题，而不要怪罪视频本身。</span></p><p style="text-align: left; text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(227, 108, 9);">关于 r2 的一点</span></strong></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">系统管理员和逆向分析爱好者在对 ELF 恶意软件进行静态分析时，我会强烈推荐 radare2（r2） 这个工具。我使用不同的工具完成不同的任务，比如 gdb、objdump、ELF utils 等小工具，但我用 r2 [时间最长][6]，它永远不会在 UNIX Shell 中停止工作。MalwareMustDie 的团队成员每天都使用它作为 ELF 分析的工具。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">简单的说，r2 可以在任何一个 *NIX 原生架构 Shell 环境中运行，甚至包括那些受感染的系统，这样对静态分析的帮助极大。它不仅仅是一个静态分析工具，它还允许你抽取重要的信息，以及支持丰富的指令，它的灵活、快速值得每一个人去体验尝试！</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">你可以通过这个[项目][7]和另一个[网站][8]来进一步了解 radare2。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">继续我们的分析！</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">该 ELF 有下列依赖：</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:bash;toolbar:false">libc-2.13.so
ld-2.13.so</pre><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">其使用 GCC(4.1.x) 编译工具链完成编译，并指明编译选项为启用 SSL 配置、面向 i686。看起来作者工作的桌面在加密磁盘 `/media/truecrypt1` 中，工作路径为 `/my/framework/`：</span></p><pre class="brush:bash;toolbar:false">![3](https://lh3.googleusercontent.com/63PpWoS2rj8zOH3QImTEGZwqMXYY9otDi097L905m_iao_xU6cOSivf_W-NF2x10bNaoaVT9t0NkxQ=w724-h286-no)</pre><p style="text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;"><br/></span></strong></p><p style="text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;">工作综述</span></strong></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><hr/><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">通过逆向分析，在这个 ELF 样本中没有发现什么新的功能，只在具体使用方法上存在差异，它针对 x86-32 平台，并且以印度的网络为目标。工具链使用了 i686 的编译选项是很奇怪的，但也显示出 x86-32 不是他唯一的目标平台。从感染的历史数据来看，2015 年 9 月发现了针对 MIPS 的版本。简单来看，该蠕虫并不仅仅针对物联网设备和 Linux 的嵌入式设备，对服务器、应用程序以及默认口令都有关注。</span><br/></p><p style="text-align: left; text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(227, 108, 9);">总结</span></strong></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">1. fork 四次，算上主进程一共有 5 个</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2. 在工作目录创建带有以下功能的文件</span></p><pre class="brush:bash;toolbar:false">&nbsp;&nbsp;&nbsp;&nbsp;permission&nbsp;size&nbsp;date&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function
&nbsp;&nbsp;&nbsp;&nbsp;-----------------------------------------------&nbsp;&nbsp;&nbsp;&nbsp;-----------------
&nbsp;&nbsp;&nbsp;&nbsp;-rw-r--r--&nbsp;&nbsp;387&nbsp;Aug&nbsp;23&nbsp;12:06&nbsp;list2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--&nbsp;connected&nbsp;hosts
&nbsp;&nbsp;&nbsp;&nbsp;-rw-r--r--&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;Aug&nbsp;23&nbsp;12:02&nbsp;MalwareFile.pid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--&nbsp;pids
&nbsp;&nbsp;&nbsp;&nbsp;-rw-r--r--&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;Aug&nbsp;23&nbsp;12:02&nbsp;daemon.log&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--&nbsp;malware&nbsp;log
&nbsp;&nbsp;&nbsp;&nbsp;-rw-r--r--&nbsp;&nbsp;&nbsp;35&nbsp;Aug&nbsp;23&nbsp;12:02&nbsp;login2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--&nbsp;brute&nbsp;auth
&nbsp;&nbsp;&nbsp;&nbsp;drwxr-xr-x&nbsp;4096&nbsp;Aug&nbsp;23&nbsp;12:02&nbsp;files/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--&nbsp;updates/downloads/C2&nbsp;data</pre><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">3. 守护并监听 2 个 TCP 端口</span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">&nbsp;&nbsp;</span></p><pre class="brush:bash;toolbar:false">IPv4&nbsp;TCP/＊:9000&nbsp;(for&nbsp;/check&nbsp;command&nbsp;and&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/upload&nbsp;command&#39;s&nbsp;remote&nbsp;access)
IPv4&nbsp;TCP/＊:1337&nbsp;(remote&nbsp;uptime&nbsp;or&nbsp;ping&nbsp;quick&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;check)</pre><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">4. 最初攻击目标为 183.83.0.0/16（硬编码存储）</span></p><pre class="brush:bash;toolbar:false">Country:&nbsp;&#39;India&nbsp;(Telangana,&nbsp;Kashmit&nbsp;region&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;network&nbsp;in&nbsp;India)&#39;
For&nbsp;&#39;SSH&nbsp;services&#39;&nbsp;in&nbsp;&nbsp;port:&nbsp;&#39;TCP/22&#39;&nbsp;(ssh)</pre><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">5. 暴力破解</span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">&nbsp; &nbsp;</span></p><pre class="brush:bash;toolbar:false">&nbsp;&nbsp;&nbsp;&nbsp;root:root
&nbsp;&nbsp;&nbsp;&nbsp;admin:admin
&nbsp;&nbsp;&nbsp;&nbsp;ubnt:ubnt</pre><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">6. SSL 通信</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">通过 `HTTP/1.1` 对 `twitter.com、reddit.com、google.com、microsoft.com` 发起请求传送 SSL 流量。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:bash;toolbar:false">write(113,&nbsp;&quot;\26\3\1\2\0\1\0\1\374\3\3%\254\231\25\346\263EuU\vI\26\10bc\0I_\246\262g\273\267
\342C\24\33l\327\214R\215\0\0\240\3000\300,\300(\300$\300\24\300\n\0\245\0\243\0\241\0\237\0
k\0j\0i\0h\0009\0008\0007\0006\0\210\0\207\0\206\0\205\3002\300.\300*\300&amp;\300\17\300\5\0\23
5\0=\0005\0\204\300/\300+\300&#39;\300#\300\23\300\t\0\244\0\242\0\240\0\236\0g\0@\0?\0&gt;\0003\00
02\0001\0000\0\232\0\231\0\230\0\227\0E\0D\0C\0B\3001\300-\300)\300%\300\16\300\4\0\234\0&lt;\0
/\0\226\0A\0\7\300\22\300\10\0\26\0\23\0\20\0\r\300\r\300\3\0\n\0\377\1\0\0013\0\0\0\20\0\16
\0\0&#39;\vtwitter.com&#39;\0\v\0\4\3\0\1\2\0\n\0\34\0\32\0\27\0\31\0\34\0\33\0\30\0\32\0\26\0\16\0\r
\v\0\f\0\t\0\n\0\r\0&nbsp;\0\36\6\1\6\2\6\3\5\1\5\2\5\3\4\1\4\2\4\3\3\1\3\2\3\3\2\1\2\2\2\3\0\17
\0\1\0013t\0\0\0\20\0\v\0\t&#39;\10http/1.1&#39;\0\25\0\267\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\
&nbsp;&nbsp;&nbsp;:
0\0\0\0\0\0\0&quot;,&nbsp;517)</pre><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">EmergingThreat Lab 提供了一个更清晰的 PCAP：</span></p><pre class="brush:bash;toolbar:false">![4](https://lh3.googleusercontent.com/ElOldHOjoqyHVynB46AnFX4N29yZ_Kp2J7TE1CBrmIDmMNGO7a0arZbxrnCyP0asbtfC6PHqOO7Txw=w660-h909-no)</pre><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">7. SSL 加密流量</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">该蠕虫通过向 SNS 网站发送加密的 SSL 请求来进行隐蔽通信，主要包括 twitter.com、reddit.com、microsoft.com、google.com、my.mail.ru 等网站，如同上面的视频中提到的，蠕虫会在 /files/ 下生成一个包含命令控制服务器 IP 和 端口的文件。如果你想测试与蠕虫进行通信，该蠕虫可以在 TCP/9000 端口响应知名的僵尸网络协议，TCP/1337 也是一个感染成功的标志。如果 TCP/9000 和 TCP/1337 端口都开放了，状态都是 ESTBLISHED，有很大可能性被感染了。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">下面这个 PCAP 快照就是在感染初期阶段的一些请求：</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">启动连接</span></p><pre class="brush:bash;toolbar:false">![5](https://lh3.googleusercontent.com/CqydxyjdCAMDYb6NGuGpff5kUSphiz1lR2y_J0NYEBFer34dRz73gDy3pBaYDQHLEVBE9Pk28YihVQ=w1234-h352-no)</pre><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">客户端请求</span></p><pre class="brush:bash;toolbar:false">![6](https://lh3.googleusercontent.com/_3XJCO_jevd6kAGCa7Jj3kyBq7mkR4wB-xeJ3gSbINGO0bPRQImhU8S6Qi3ZNW7JsKWa6reBIblJAg=w580-h128-no)</pre><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">服务器应答</span></p><pre class="brush:bash;toolbar:false">![7](https://lh3.googleusercontent.com/tvGjYpk30bb-2rfYTKVmN8uMt6xaHr8w7L88LWCBXPsls3p9lF4ENxapahkjt8SkvcYkNmjnCgANQQ=w580-h189-no)</pre><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">没有成功建立连接，它将会重新尝试下一个，此时是 reddit.com</span></p><pre class="brush:bash;toolbar:false">![8](https://lh3.googleusercontent.com/uH__1mMM6JJm2DDp0EnR4ztHPhUcxcLJ4qDDeVfs4570dXbCt3R8oD-L8m9gFkk2OU8b6kReLPrEnw=w580-h346-no)</pre><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">蠕虫不断扫描、不断爆破的同时也在持续发送请求。直到蠕虫与控制服务器建立了连接，攻击者可以控制被感染设备才会停止活动。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">这就是为什么在编译选项中使用了启用 SSL 选项，需要使用 Twitter、reddit 等 SNS 网站的 SSL 认证来传输数据以及进一步创建与控制服务器的连接。</span></p><p><br style="text-align: left;"/></p><p style="text-align: left; text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;">感染症状</span></strong></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><hr/><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在感染的最初阶段，感染主机会发现如下进程运行：</span><br/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:bash;toolbar:false">stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;cwd&nbsp;&nbsp;&nbsp;&nbsp;DIR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8,1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4096&nbsp;&nbsp;131126&nbsp;/test/
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;rtd&nbsp;&nbsp;&nbsp;&nbsp;DIR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8,1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4096&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;/
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;txt&nbsp;&nbsp;&nbsp;&nbsp;REG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8,1&nbsp;&nbsp;1034309&nbsp;&nbsp;131146&nbsp;/test/stdin
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;0u&nbsp;&nbsp;&nbsp;REG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8,1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;131171&nbsp;/test/daemon.log
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;1u&nbsp;&nbsp;&nbsp;REG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8,1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;131171&nbsp;/test/daemon.log
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;2u&nbsp;&nbsp;&nbsp;CHR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;136,0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0t0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;/dev/pts/0
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;3r&nbsp;&nbsp;FIFO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0t0&nbsp;&nbsp;&nbsp;&nbsp;6188&nbsp;pipe
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;4w&nbsp;&nbsp;FIFO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0t0&nbsp;&nbsp;&nbsp;&nbsp;6188&nbsp;pipe
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;5u&nbsp;&nbsp;0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;1185&nbsp;anon_inode
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;6u&nbsp;&nbsp;unix&nbsp;0xcda07300&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0t0&nbsp;&nbsp;&nbsp;&nbsp;6191&nbsp;socket
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;7u&nbsp;&nbsp;unix&nbsp;0xce020d40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0t0&nbsp;&nbsp;&nbsp;&nbsp;6192&nbsp;socket
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;8u&nbsp;&nbsp;IPv4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6193&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0t0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TCP&nbsp;*:9000&nbsp;(LISTEN)
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;&nbsp;&nbsp;9u&nbsp;&nbsp;0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;1185&nbsp;anon_inode
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;&nbsp;10u&nbsp;&nbsp;unix&nbsp;0xce020ac0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0t0&nbsp;&nbsp;&nbsp;&nbsp;6194&nbsp;socket
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;&nbsp;11u&nbsp;&nbsp;unix&nbsp;0xce020840&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0t0&nbsp;&nbsp;&nbsp;&nbsp;6195&nbsp;socket
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;&nbsp;12u&nbsp;&nbsp;IPv4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6196&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0t0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TCP&nbsp;*:1337&nbsp;(LISTEN)</pre><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">发起的攻击可以在网络连接中看出：</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:bash;toolbar:false">stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;13u&nbsp;&nbsp;IPv4&nbsp;6197&nbsp;&nbsp;0t0&nbsp;TCP&nbsp;x.x.x.x:40709-&gt;183.83.0.0:22&nbsp;(SYN_SENT)
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;14u&nbsp;&nbsp;IPv4&nbsp;6198&nbsp;&nbsp;0t0&nbsp;TCP&nbsp;x.x.x.x:37944-&gt;183.83.0.1:22&nbsp;(SYN_SENT)
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;15u&nbsp;&nbsp;IPv4&nbsp;6199&nbsp;&nbsp;0t0&nbsp;TCP&nbsp;x.x.x.x:35576-&gt;183.83.0.2:22&nbsp;(SYN_SENT)
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;16u&nbsp;&nbsp;IPv4&nbsp;6200&nbsp;&nbsp;0t0&nbsp;TCP&nbsp;x.x.x.x:41811-&gt;183.83.0.3:22&nbsp;(SYN_SENT)
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;17u&nbsp;&nbsp;IPv4&nbsp;6201&nbsp;&nbsp;0t0&nbsp;TCP&nbsp;x.x.x.x:43278-&gt;183.83.0.4:22&nbsp;(SYN_SENT)
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;18u&nbsp;&nbsp;IPv4&nbsp;6202&nbsp;&nbsp;0t0&nbsp;TCP&nbsp;x.x.x.x:37969-&gt;183.83.0.5:22&nbsp;(SYN_SENT)
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;19u&nbsp;&nbsp;IPv4&nbsp;6203&nbsp;&nbsp;0t0&nbsp;TCP&nbsp;x.x.x.x:39383-&gt;183.83.0.6:22&nbsp;(SYN_SENT)
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;20u&nbsp;&nbsp;IPv4&nbsp;6204&nbsp;&nbsp;0t0&nbsp;TCP&nbsp;x.x.x.x:38038-&gt;183.83.0.7:22&nbsp;(SYN_SENT)
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;21u&nbsp;&nbsp;IPv4&nbsp;6205&nbsp;&nbsp;0t0&nbsp;TCP&nbsp;x.x.x.x:35040-&gt;183.83.0.8:22&nbsp;(SYN_SENT)
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;22u&nbsp;&nbsp;IPv4&nbsp;6206&nbsp;&nbsp;0t0&nbsp;TCP&nbsp;x.x.x.x:59569-&gt;183.83.0.9:22&nbsp;(SYN_SENT)
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;23u&nbsp;&nbsp;IPv4&nbsp;6207&nbsp;&nbsp;0t0&nbsp;TCP&nbsp;x.x.x.x:50921-&gt;183.83.0.10:22&nbsp;(SYN_SENT)
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;24u&nbsp;&nbsp;IPv4&nbsp;6208&nbsp;&nbsp;0t0&nbsp;TCP&nbsp;x.x.x.x:36079-&gt;183.83.0.11:22&nbsp;(SYN_SENT)
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;25u&nbsp;&nbsp;IPv4&nbsp;6209&nbsp;&nbsp;0t0&nbsp;TCP&nbsp;x.x.x.x:35134-&gt;183.83.0.12:22&nbsp;(SYN_SENT)
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;26u&nbsp;&nbsp;IPv4&nbsp;6210&nbsp;&nbsp;0t0&nbsp;TCP&nbsp;x.x.x.x:59932-&gt;183.83.0.13:22&nbsp;(SYN_SENT)
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;27u&nbsp;&nbsp;IPv4&nbsp;6211&nbsp;&nbsp;0t0&nbsp;TCP&nbsp;x.x.x.x:35682-&gt;183.83.0.14:22&nbsp;(SYN_SENT)
stdin&nbsp;2712&nbsp;root&nbsp;&nbsp;28u&nbsp;&nbsp;IPv4&nbsp;6212&nbsp;&nbsp;0t0&nbsp;TCP&nbsp;x.x.x.x:57709-&gt;183.83.0.15:22&nbsp;(SYN_SENT)</pre><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">为了更精确的描述攻击的具体情况，下面是包含 PoC 的 PCAP 包记录[视频][9]，数据太多所以视频只能将记录到的对 SSH 进行暴力扫描/破解过程的 3%。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">如果有数十台甚至上百台受感染主机，你可以想象流量将会多么混乱。如果目标网络中七号有大量的 SSH 默认口令登录，攻击者就可以创建一个庞大的感染链。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">每个已连接的目标都在 `list2` 文件中记录着：</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:bash;toolbar:false">0000&nbsp;&nbsp;31&nbsp;38&nbsp;33&nbsp;2e&nbsp;38&nbsp;33&nbsp;2e&nbsp;30&nbsp;&nbsp;2e&nbsp;33&nbsp;33&nbsp;3b&nbsp;32&nbsp;32&nbsp;3b&nbsp;0a&nbsp;&nbsp;|183.83.0.33;22;.|
0010&nbsp;&nbsp;31&nbsp;38&nbsp;33&nbsp;2e&nbsp;38&nbsp;33&nbsp;2e&nbsp;30&nbsp;&nbsp;2e&nbsp;38&nbsp;30&nbsp;3b&nbsp;32&nbsp;32&nbsp;3b&nbsp;0a&nbsp;&nbsp;|183.83.0.80;22;.|
0020&nbsp;&nbsp;31&nbsp;38&nbsp;33&nbsp;2e&nbsp;38&nbsp;33&nbsp;2e&nbsp;32&nbsp;&nbsp;2e&nbsp;32&nbsp;36&nbsp;3b&nbsp;32&nbsp;32&nbsp;3b&nbsp;0a&nbsp;&nbsp;|183.83.2.26;22;.|
0030&nbsp;&nbsp;31&nbsp;38&nbsp;33&nbsp;2e&nbsp;38&nbsp;33&nbsp;2e&nbsp;32&nbsp;&nbsp;2e&nbsp;34&nbsp;31&nbsp;3b&nbsp;32&nbsp;32&nbsp;3b&nbsp;0a&nbsp;&nbsp;|183.83.2.41;22;.|
0040&nbsp;&nbsp;31&nbsp;38&nbsp;33&nbsp;2e&nbsp;38&nbsp;33&nbsp;2e&nbsp;32&nbsp;&nbsp;2e&nbsp;31&nbsp;31&nbsp;30&nbsp;3b&nbsp;32&nbsp;32&nbsp;3b&nbsp;&nbsp;|183.83.2.110;22;|
0050&nbsp;&nbsp;0a&nbsp;31&nbsp;38&nbsp;33&nbsp;2e&nbsp;38&nbsp;33&nbsp;2e&nbsp;&nbsp;32&nbsp;2e&nbsp;32&nbsp;31&nbsp;30&nbsp;3b&nbsp;32&nbsp;32&nbsp;&nbsp;|.183.83.2.210;22|
0060&nbsp;&nbsp;3b&nbsp;0a&nbsp;31&nbsp;38&nbsp;33&nbsp;2e&nbsp;38&nbsp;33&nbsp;&nbsp;2e&nbsp;33&nbsp;2e&nbsp;32&nbsp;32&nbsp;3b&nbsp;32&nbsp;32&nbsp;&nbsp;|;.183.83.3.22;22|
0070&nbsp;&nbsp;3b&nbsp;0a&nbsp;31&nbsp;38&nbsp;33&nbsp;2e&nbsp;38&nbsp;33&nbsp;&nbsp;2e&nbsp;33&nbsp;2e&nbsp;31&nbsp;34&nbsp;38&nbsp;3b&nbsp;32&nbsp;&nbsp;|;.183.83.3.148;2|
0080&nbsp;&nbsp;32&nbsp;3b&nbsp;0a&nbsp;31&nbsp;38&nbsp;33&nbsp;2e&nbsp;38&nbsp;&nbsp;33&nbsp;2e&nbsp;34&nbsp;2e&nbsp;39&nbsp;33&nbsp;3b&nbsp;32&nbsp;&nbsp;|2;.183.83.4.93;2|
0090&nbsp;&nbsp;32&nbsp;3b&nbsp;0a&nbsp;31&nbsp;38&nbsp;33&nbsp;2e&nbsp;38&nbsp;&nbsp;33&nbsp;2e&nbsp;34&nbsp;2e&nbsp;31&nbsp;35&nbsp;36&nbsp;3b&nbsp;&nbsp;|2;.183.83.4.156;|
00a0&nbsp;&nbsp;32&nbsp;32&nbsp;3b&nbsp;0a&nbsp;31&nbsp;38&nbsp;33&nbsp;2e&nbsp;&nbsp;38&nbsp;33&nbsp;2e&nbsp;35&nbsp;2e&nbsp;31&nbsp;36&nbsp;3b&nbsp;&nbsp;|22;.183.83.5.16;|
00b0&nbsp;&nbsp;32&nbsp;32&nbsp;3b&nbsp;0a&nbsp;31&nbsp;38&nbsp;33&nbsp;2e&nbsp;&nbsp;38&nbsp;33&nbsp;2e&nbsp;35&nbsp;2e&nbsp;32&nbsp;30&nbsp;36&nbsp;&nbsp;|22;.183.83.5.206|
00c0&nbsp;&nbsp;3b&nbsp;32&nbsp;32&nbsp;3b&nbsp;0a&nbsp;31&nbsp;38&nbsp;33&nbsp;&nbsp;2e&nbsp;38&nbsp;33&nbsp;2e&nbsp;36&nbsp;2e&nbsp;31&nbsp;32&nbsp;&nbsp;|;22;.183.83.6.12|
00d0&nbsp;&nbsp;37&nbsp;3b&nbsp;32&nbsp;32&nbsp;3b&nbsp;0a&nbsp;31&nbsp;38&nbsp;&nbsp;33&nbsp;2e&nbsp;38&nbsp;33&nbsp;2e&nbsp;37&nbsp;2e&nbsp;34&nbsp;&nbsp;|7;22;.183.83.7.4|
00e0&nbsp;&nbsp;33&nbsp;3b&nbsp;32&nbsp;32&nbsp;3b&nbsp;0a&nbsp;31&nbsp;38&nbsp;&nbsp;33&nbsp;2e&nbsp;38&nbsp;33&nbsp;2e&nbsp;37&nbsp;2e&nbsp;31&nbsp;&nbsp;|3;22;.183.83.7.1|
00f0&nbsp;&nbsp;32&nbsp;33&nbsp;3b&nbsp;32&nbsp;32&nbsp;3b&nbsp;0a&nbsp;31&nbsp;&nbsp;38&nbsp;33&nbsp;2e&nbsp;38&nbsp;33&nbsp;2e&nbsp;37&nbsp;2e&nbsp;&nbsp;|23;22;.183.83.7.|
0100&nbsp;&nbsp;31&nbsp;38&nbsp;37&nbsp;3b&nbsp;32&nbsp;32&nbsp;3b&nbsp;0a&nbsp;&nbsp;31&nbsp;38&nbsp;33&nbsp;2e&nbsp;38&nbsp;33&nbsp;2e&nbsp;31&nbsp;&nbsp;|187;22;.183.83.1|
0110&nbsp;&nbsp;31&nbsp;2e&nbsp;35&nbsp;31&nbsp;3b&nbsp;32&nbsp;32&nbsp;3b&nbsp;&nbsp;0a&nbsp;31&nbsp;38&nbsp;33&nbsp;2e&nbsp;38&nbsp;33&nbsp;2e&nbsp;&nbsp;|1.51;22;.183.83.|
0120&nbsp;&nbsp;31&nbsp;31&nbsp;2e&nbsp;38&nbsp;34&nbsp;3b&nbsp;32&nbsp;32&nbsp;&nbsp;3b&nbsp;0a&nbsp;31&nbsp;38&nbsp;33&nbsp;2e&nbsp;38&nbsp;33&nbsp;&nbsp;|11.84;22;.183.83|
0130&nbsp;&nbsp;2e&nbsp;31&nbsp;31&nbsp;2e&nbsp;31&nbsp;36&nbsp;38&nbsp;3b&nbsp;&nbsp;32&nbsp;32&nbsp;3b&nbsp;0a&nbsp;31&nbsp;38&nbsp;33&nbsp;2e&nbsp;&nbsp;|.11.168;22;.183.|
0140&nbsp;&nbsp;38&nbsp;33&nbsp;2e&nbsp;31&nbsp;32&nbsp;2e&nbsp;31&nbsp;34&nbsp;&nbsp;35&nbsp;3b&nbsp;32&nbsp;32&nbsp;3b&nbsp;0a&nbsp;31&nbsp;38&nbsp;&nbsp;|83.12.145;22;.18|
0150&nbsp;&nbsp;33&nbsp;2e&nbsp;38&nbsp;33&nbsp;2e&nbsp;31&nbsp;32&nbsp;2e&nbsp;&nbsp;32&nbsp;34&nbsp;30&nbsp;3b&nbsp;32&nbsp;32&nbsp;3b&nbsp;0a&nbsp;&nbsp;|3.83.12.240;22;.|
0160&nbsp;&nbsp;31&nbsp;38&nbsp;33&nbsp;2e&nbsp;38&nbsp;33&nbsp;2e&nbsp;31&nbsp;&nbsp;33&nbsp;2e&nbsp;31&nbsp;36&nbsp;32&nbsp;3b&nbsp;32&nbsp;32&nbsp;&nbsp;|183.83.13.162;22|
0170&nbsp;&nbsp;3b&nbsp;0a&nbsp;31&nbsp;38&nbsp;33&nbsp;2e&nbsp;38&nbsp;33&nbsp;&nbsp;2e&nbsp;31&nbsp;34&nbsp;2e&nbsp;39&nbsp;32&nbsp;3b&nbsp;32&nbsp;&nbsp;|;.183.83.14.92;2|
0180&nbsp;&nbsp;32&nbsp;3b&nbsp;0a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|2;.|</pre><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">在 `login2` 的文件中可以发现爆破列表：</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:bash;toolbar:false">0000&nbsp;&nbsp;72&nbsp;6f&nbsp;6f&nbsp;74&nbsp;3b&nbsp;72&nbsp;6f&nbsp;6f&nbsp;&nbsp;74&nbsp;3b&nbsp;0a&nbsp;61&nbsp;64&nbsp;6d&nbsp;69&nbsp;6e&nbsp;&nbsp;|root;root;.admin|
0010&nbsp;&nbsp;3b&nbsp;61&nbsp;64&nbsp;6d&nbsp;69&nbsp;6e&nbsp;3b&nbsp;0a&nbsp;&nbsp;75&nbsp;62&nbsp;6e&nbsp;74&nbsp;3b&nbsp;75&nbsp;62&nbsp;6e&nbsp;&nbsp;|;admin;.ubnt;ubn|
0020&nbsp;&nbsp;74&nbsp;3b&nbsp;0a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|t;.|
0023</pre><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">主要的进程 PID 都存储在 `[MalwareFile].pid ` 中：</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:bash;toolbar:false">0000&nbsp;&nbsp;32&nbsp;37&nbsp;31&nbsp;32&nbsp;&nbsp;|2712|
0004</pre><p style="text-align: left; text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em; color: rgb(227, 108, 9);">威胁起源</span></strong><br/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">对于其威胁来源，我和同事进行过讨论，处于安全原因，我不提他的身份了。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">1. 编译痕迹</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">可以看出其使用了 Truecrytt 使用过的交叉编译工具，而且其工作目录运行在 Truecrypt 中也可以看出其与东欧网络骗子的一些活动有关。这些都暗示了这个威胁的起源：</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:bash;toolbar:false">0x8238ff8&nbsp;102&nbsp;101&nbsp;OPENSSLDIR:&nbsp;&quot;/media/truecrypt1/my/framework/../toolchains/cross-compiler-i686/i686-unknown-linux/ssl&quot;
0x8248eac&nbsp;96&nbsp;95&nbsp;/media/truecrypt1/my/framework/../toolchains/cross-compiler-i686/i686-unknown-linux/lib/engines
0x825e294&nbsp;96&nbsp;95&nbsp;/media/truecrypt1/my/framework/../toolchains/cross-compiler-i686/i686-unknown-linux/ssl/private
0x825e2f4&nbsp;88&nbsp;87&nbsp;/media/truecrypt1/my/framework/../toolchains/cross-compiler-i686/i686-unknown-linux/ssl
0x825e34c&nbsp;94&nbsp;93&nbsp;/media/truecrypt1/my/framework/../toolchains/cross-compiler-i686/i686-unknown-linux/ssl/certs
0x825e3ac&nbsp;97&nbsp;96&nbsp;/media/truecrypt1/my/framework/../toolchains/cross-compiler-i686/i686-unknown-linux/ssl/cert.pem</pre><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">2.MY.MAIL.RU API 的使用</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">该蠕虫使用了俄罗斯最大的公共邮件服务 `mail.ru` 的 API，我们认为攻击者应该是讲俄语的，我们没有提到国家性质，这只能表明很大可能性攻击者定居在俄罗斯。攻击者知道如何使用 `my.mail.ru` 的特定子域名：</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:bash;toolbar:false">0x8220f7a&nbsp;11&nbsp;10&nbsp;my.mail.ru
0x8220f85&nbsp;20&nbsp;19&nbsp;https://%s/mail/%s/</pre><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span><br/></p><p style="text-align: left; text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;">缓解与检测方法</span></strong></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><hr/><p style="text-align: left; text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(227, 108, 9);">缓解办法</span></strong><br/></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">1. 确保你网络上的设备都不是 SSH 默认口令，如果可能不要使用 SSH 标准端口</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2. 如果有一个主机与你的连接建立在 TCP/1337 和 TCP/9000 的基础上，你很有可能已经被感染了。如果你本地还有使用 TCP/9000 的程序在运行，就可以进一步确定，你可以在这个[网站][10]查看。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">3. 如果你在 IDS/IPS 上发现了通过 SSL 加密发往那些 SNS 网站的数据包，而这些数据包恰好来自那些本不应该出现类似行为的设备，比如物联网设备。请务必查看 TCP/1337 和 TCP/9000 端口是否被利用，如果可以，进行脱机检查是必要的；如果已经被感染控制，最好重置固件然后更改 SSH 的默认端口和密码。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">4. 对于服务器，清除该蠕虫并不困难。蠕虫在最初感染阶段并不具备 rootkit 能力，除非攻击者不再进行后门连接或者进一步对受害者的设备进行操作，检测活动目录并删除木马文件即可。在删除之前，快照一个网络进程列表，在修复过程中要断网操作。迄今为止这个蠕虫还没有表现出自启动的设计。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">5. 只是为了确定你的系统是否危险不用保持离线。蠕虫会扫描 SSH 端口、尝试爆破才能感染。该蠕虫的感染速度非常快，在分析的短短几分钟内就有超过一百个节点被攻击了。一旦感染了蠕虫请立即脱机，极有可能是因为你的 IP 段内有设备受到了感染。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">6. 可以给我留言联系进一步的协助，或者尝试与我们的 Twitter 账户（@malwaremustdie）进行沟通，我们将会尽我们所能帮助您。不过请耐心等待答复。</span></p><p style="text-align: left; text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(227, 108, 9);">拦截签名</span></strong></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">十分感谢 ETLab 帮助我们完善了 Snort 和 Suricata 开源规则来应对这种威胁。</span></p><pre class="brush:bash;toolbar:false">![5](https://lh3.googleusercontent.com/ATVF4Z6t4YuJ3D3EXmQ4bVWMtedKEzqm75wIDnFvPoLkNyKwjyr8h8mwFG_NrKwIKp7fKuUkX_XzZA=w499-h389-no)</pre><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">规则极其复杂，探测该蠕虫的网络活动：</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:bash;toolbar:false">2023087&nbsp;-&nbsp;ET&nbsp;TROJAN&nbsp;PNScan.2&nbsp;Inbound&nbsp;Status&nbsp;Check&nbsp;-&nbsp;set&nbsp;(trojan.rules)
2023088&nbsp;-&nbsp;ET&nbsp;TROJAN&nbsp;PNScan.2&nbsp;Inbound&nbsp;Status&nbsp;Check&nbsp;Response&nbsp;(trojan.rules)
2023089&nbsp;-&nbsp;ET&nbsp;TROJAN&nbsp;PNScan.2&nbsp;CnC&nbsp;Beacon&nbsp;(trojan.rules)
2023090&nbsp;-&nbsp;ET&nbsp;TROJAN&nbsp;PNScan.2&nbsp;CnC&nbsp;Beacon&nbsp;2&nbsp;(trojan.rules)</pre><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">需要指出的是，这可能让你有点困惑，但是不要将它和 `Linux/PnScan.1` 混为一谈，他们的工作方式并不相同。另外这些威胁的命名是由宣布发现的第一个实体决定的。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-align: left; text-indent: 2em;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;">结论、样本</span></strong></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><hr/><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">这个蠕虫重新感染了 i86 的 Linux 机器，当该蠕虫攻陷了一个目标，就会扫描更多的目标。它可以在易受攻击的网络中肆意传播，感染数量呈指数级增长。我猜在过去的六个月中，位于俄罗斯的攻击者等待合适的时机来访问受感染的节点。</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">VirusTotal 上的[样本][11]</span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-align: left; text-indent: 2em;"><strong><span style="color: rgb(227, 108, 9);"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">[原文地址]</span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">[12]</span></span></strong></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp; [1]: <a href="http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3975&p=26827#p26827" _src="http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3975&p=26827#p26827">http://www.kernelmode.info/forum/viewtopic.php?f=16&amp;t=3975&amp;p=26827#p26827</a></span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp; [2]: <a href="http://blog.malwaremustdie.org/2016/04/mmd-0053-2016-bit-about-elfstd-irc-bot.html" _src="http://blog.malwaremustdie.org/2016/04/mmd-0053-2016-bit-about-elfstd-irc-bot.html">http://blog.malwaremustdie.org/2016/04/mmd-0053-2016-bit-about-elfstd-irc-bot.html</a></span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp; [3]: <a href="http://blog.malwaremustdie.org/2016/04/mmd-0053-2016-bit-about-elfstd-irc-bot.html" _src="http://blog.malwaremustdie.org/2016/04/mmd-0053-2016-bit-about-elfstd-irc-bot.html">http://blog.malwaremustdie.org/2016/04/mmd-0053-2016-bit-about-elfstd-irc-bot.html</a></span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp; [4]: <a href="http://radare.org/" _src="http://radare.org/">http://radare.org/</a></span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp; [5]: <a href="https://youtu.be/58zr-1JU2OI" _src="https://youtu.be/58zr-1JU2OI">https://youtu.be/58zr-1JU2OI</a></span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp; [6]: <a href="http://blog.malwaremustdie.org/2012/09/slight-changes-in-shellcode-dropper.html" _src="http://blog.malwaremustdie.org/2012/09/slight-changes-in-shellcode-dropper.html">http://blog.malwaremustdie.org/2012/09/slight-changes-in-shellcode-dropper.html</a></span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp; [7]: <a href="https://github.com/radare/radare2/releases" _src="https://github.com/radare/radare2/releases">https://github.com/radare/radare2/releases</a></span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp; [8]: <a href="http://radare.org/con/" _src="http://radare.org/con/">http://radare.org/con/</a></span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp; [9]: <a href="https://youtu.be/IX6L7v8dXsk" _src="https://youtu.be/IX6L7v8dXsk">https://youtu.be/IX6L7v8dXsk</a></span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp; [10]: <a href="http://www.speedguide.net/port.php?port=9000" _src="http://www.speedguide.net/port.php?port=9000">http://www.speedguide.net/port.php?port=9000</a></span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp; [11]: <a href="https://www.virustotal.com/en/file/5685b086ce12ffede8814e303223a67eca476735dfe4e9e84b751354a5ea0232/analysis/1471967010/" _src="https://www.virustotal.com/en/file/5685b086ce12ffede8814e303223a67eca476735dfe4e9e84b751354a5ea0232/analysis/1471967010/">https://www.virustotal.com/en/file/5685b086ce12ffede8814e303223a67eca476735dfe4e9e84b751354a5ea0232/analysis/1471967010/</a></span></p><p style="text-align: left; text-indent: 2em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp; [12]: <a href="http://blog.malwaremustdie.org/2016/08/mmd-0054-2016-pnscan-elf-worm-that.html" _src="http://blog.malwaremustdie.org/2016/08/mmd-0054-2016-pnscan-elf-worm-that.html">http://blog.malwaremustdie.org/2016/08/mmd-0054-2016-pnscan-elf-worm-that.html</a></span></p><p><br style="text-align: left;"/></p></p>
                <hr/>
                <p style="text-align: center;">
                    <img src="http://bobao.360.cn/img/app.jpeg"/>
                    <img src="http://bobao.360.cn/img/weixin.jpeg"/>
                </p>
                                <p>本文由 安全客 翻译，转载请注明“转自安全客”，并附上链接。<br/><a class="text-more" href="http://www.kernelmode.info/forum/viewtopic.php?f=16&amp;t=3975&amp;p=26827#p26827v" target="_blank">原文链接：http://www.kernelmode.info/forum/viewtopic.php?f=16&amp;t=3975&amp;p=26827#p26827v</a></p>
                            </div>
            <div style="margin-top: 20px;background-color:#FFFFFF">
    <input type="hidden" id="detail_title" name="detail_title" value="【技术分享】一个 ELF 蠕虫分析 - 安全客 - 有思想的安全新媒体" />
    <input type="hidden" id="use_nickname" name="use_nickname" value="0" />
    <a name="mao"></a>
    <div class="reg-log mobile-hiden">
        <div class="" id="userTo">   
            <div id="to-list" class="input-text" style="">
                <textarea disabled="disabled" class="hide"  id="comment-content" to="to"></textarea>
                <ul id="preadded" style="display:none">       
                </ul>
                <div id="to-auto" style="width: 200px">
                    <ul id="feed">
                    </ul>
                </div>
            </div>
        </div>
        <input type="hidden" id="source-id" value="3290" />
        <input type="hidden" id="source-type" value="learning" />
        <input type="hidden" id="post-comment-url" value="/comment/add" />
        <input type="hidden" id="post-nickname-url-ajax" value="/comment/randnicknameajax" />
        <input type="hidden" id="post-check-login-url-ajax" value="/comment/checklogin" />
        <input type="hidden" id="stoken_comment_set" value="ea3898fb4df38673fdeb61c458234054">                 <span class="join">参与讨论，请先 <a href="javascript:;" class="comment-login">登录</a> | <a href="javascript:;" class="comment-reg">注册</a> |  <a href="javascript:;" class="anonymous-comment">匿名评论</a></span>
            </div>
    <div class="mobile-hide" style="width: 870px; margin: 0 auto;">
        <label style="vertical-align:middle;" for="use_nickname">匿名</label> 
        <input style="vertical-align:middle;" id="trigger-nickname" name="use_nickname" class="use_nickname" type="checkbox" value="0" />

        <a href="javascript:;" class="apply-use button" id="submit-comment" data-target="/comment/add">发布</a>
    </div>


    <div class="clearfix"></div>
    <div class="comments">
        <div class="comments-head">
            <span class="title">用户评论</span>
        </div>
                <div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/10x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="2753148133" class="response" data-bind-id="2753148133" data-target="7195" user-name="360U2753148133" href="javascript:;">
                360U2753148133            </a>
                        <span class="comment-time">2016-12-16 19:47:38</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="2753148133" data-target="7195">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_7195" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">指的是什么呢？</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
<div class="clearfix re-comment">
    <div class="comment-quote">  
        <div class="comment-user">
            <a href="javascript:;" class="response" data-bind-id="0" data-target="7072">0opslab狮</a> <span class="comment-time">2016-12-14 16:01:36</span>            <div class="comment-action">                        <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="7072">回复</a></span>&nbsp;|&nbsp;                        <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_7072" data-type="comment">点赞</a></span>            </div>
            <p>India的干货？</p>
        </div>
    </div>
        </div>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/0x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="7074" user-name="努力要成为段子手的M0rk" href="javascript:;">
                努力要成为段子手的M0rk            </a>
                        <span class="comment-time">2016-12-14 16:21:23</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="7074">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_7074" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">Repost</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/7x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="7072" user-name="0opslab狮" href="javascript:;">
                0opslab狮            </a>
                        <span class="comment-time">2016-12-14 16:01:36</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="7072">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_7072" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">India的干货？</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>

        <a class="more-long comment-more" href="javascript:;" data-target="/comment/more" data-type="learning" data-source-id="3290" data-page="2">查看更多</a>
            </div>
</div>
<script>
    $(function () {
        $('.anonymous-comment').click(function () {
            $(".join").hide();
            $(".reg-log textarea").first().removeAttr("disabled").show();
            $('#use_nickname').val('1');
//            $('#trigger-nickname').attr('checked', true);
            $('#trigger-nickname').trigger('click');
        });
        //为所有复选框绑定事件
//        checkbox_on_click();
        //ajax随机获取昵称
//        randnicknameajax(0);
        //ajax检测登录状态
        comment_check_login();
    });



    function input_checkbox(flag) {
        $('input:checkbox').each(function () {
            var value = flag ? 1 : 0;
            $(this).prop('checked', flag);
            $(this).val(value);
        });
    }

//ajax随机获取昵称
    function randnicknameajax(flag) {
        $.ajax({
            type: 'POST',
            url: $('#post-nickname-url-ajax').val(),
            data: {limit: 1, flag: flag},
            dataType: "json",
            success: function (data) {
                $('#nick-name').val(data.data[0]);
                _nick_name=data.data[0];
            }
        });
    }
    $();
//ajax检测登录状态
    function comment_check_login() {
        $.ajax({
            type: 'POST',
            url: $('#post-check-login-url-ajax').val(),
            data: {},
            dataType: "json",
            success: function (data) {
                if (data.success) {
                    $('.join').hide();
                    $(".reg-log textarea").first().removeAttr("disabled").show();
                    $("#span_use_nickname").show();
                    $('#use_nickname').val('0');
                    $('#use_nickname').attr('checked', false);
                }
            }
        });
    }
</script>        </div>
    </div>
    <div class="side-bar">
        <div class="mod hot-news">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-hot"></i><span>热门知识</span></h2>
    </div>
    <ul class="links-list">
                                <li><a href="/learning/detail/4411.html" alt="【漏洞预警】一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现——最新的Office高级威胁攻击预警" target="_blank">【漏洞预警】一个换行符引发的奥斯卡...</a></li>
                                <li><a href="/learning/detail/4416.html" alt="【漏洞预警】Microsoft .NET Framework漏洞（CVE–2017–8759）预警" target="_blank">【漏洞预警】Microsoft .NE...</a></li>
                                <li><a href="/learning/detail/4414.html" alt="【技术分享】妙用JavaScript绕过XSS过滤" target="_blank">【技术分享】妙用JavaScrip...</a></li>
                                <li><a href="/learning/detail/4418.html" alt="【技术分享】利用威胁情报数据平台拓展APT攻击线索一例" target="_blank">【技术分享】利用威胁情报数据平台拓...</a></li>
                                <li><a href="/learning/detail/4417.html" alt="【知识】9月15日 - 每日安全知识热点" target="_blank">【知识】9月15日 - 每日安全知识热...</a></li>
                                <li><a href="/learning/detail/4425.html" alt="【安全报告】XShellGhost事件技术回顾报告" target="_blank">【安全报告】XShellGhost事件...</a></li>
            </ul>
</div>        <!-- 友情链接 -->
        <div class="mod blog-links mobile-hide">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-link"></i><span>友情链接</span></h2>
        <a href="/links/index.html" class="more">更多<i></i></a>
    </div>
        <ul class="links-list">
                <li><a href="http://bbs.360safe.com" alt="360安全社区" target="_blank">360安全社区</a></li>
                <li><a href="http://zhuji.360.cn" alt="360主机卫士" target="_blank">360主机卫士</a></li>
                <li><a href="http://blogs.360.cn/" alt="奇虎360技术博客" target="_blank">奇虎360技术博客</a></li>
                <li><a href="http://wangzhan.360.cn/" alt="360网站卫士" target="_blank">360网站卫士</a></li>
                <li><a href="http://webscan.360.cn/" alt="360网站安全检测" target="_blank">360网站安全检测</a></li>
                <li><a href="http://research.360.cn/report/" alt="360研究报告" target="_blank">360研究报告</a></li>
                <li><a href="http://unicorn.360.cn/" alt="360 Unicorn Team" target="_blank">360 Unicorn Team</a></li>
                <li><a href="http://appscan.360.cn/" alt="360捉虫猎手" target="_blank">360捉虫猎手</a></li>
                <li><a href="https://threathunter.org/" alt="ThreatHunter社区" target="_blank">ThreatHunter社区</a></li>
                <li><a href="http://security.360.cn/" alt="360安全应急响应中心" target="_blank">360安全应急响应中心</a></li>
            </ul>
    </div>
        <!-- 联系我们 -->
        <div class="mod contact mobile-hide" style="text-align:center">
    <div class="head-bar clearfix">
        <h2><i></i><span>关注我们</span></h2>
    </div>
    <!-- 微信关注 -->
    <ul class="contact-way">
        <li><a>微信关注</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/qrcode_adlab_weixin.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
    <!-- APP下载 -->
    <ul class="contact-way">
        <li><a>安全播报APP</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/scan_code_big.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
</div>

    </div>
</div>

<script type="text/javascript" src="/js/jquery-ui.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/jquery.noty.packaged.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/common.js?v=4.5"></script>
<script>$(function() {sync_count('comment');});</script>


<!-- 语法高亮 -->
<script type="text/javascript" src="/ue/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">SyntaxHighlighter.all();sync_count('vul');sync_count('news');sync_count('learning');sync_count('activity');sync_count('course');sync_count('ctf');</script>
    </div>

        <div class="footer">
        <div class="friend-link">
            <a href="http://www.360.cn/" target="_blank">360首页</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">关于我们</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">联系我们</a>
            <span>|</span>
            <a href="/links/index.html" target="_blank">友情链接</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">招贤纳士</a>
        </div>
        <div class="copy">
            Copyright &copy; 360网络攻防实验室 All Rights Reserved <span class="copy_icp">京ICP证080047号[京ICP备08010314号-6]</span>
        </div>
    </div>
    
</div>

<!--奇舞团统计-->

<script src='https://s.ssl.qhimg.com/static/f5407c785655e6a1/monitor_analytic.js'></script>
<script>
    monitor.setProject('QH_171_1').getTrack().getClickAndKeydown().getClickHeatmap(10, 1);
</script>

<div class="hide">
    <script src="https://s95.cnzz.com/z_stat.php?id=1253147824&web_id=1253147824" language="JavaScript"></script>
</div>
<div class="backToTop_wrap off">
    <a id="back_to_top" class="backToTop" href="javascript:;" title="返回顶部"></a>
</div>
<script>
    var $backToTop_wrap = $(".backToTop_wrap"),
        $backToTop_btn = $("#back_to_top");

    if ($(window).scrollTop() > 100) {
        $backToTop_wrap.removeClass("off");
    }
    else {
        $backToTop_wrap.addClass("off");
    }

    $(window).on("scroll", function () {
        if ($(this).scrollTop() > 100) {
            $backToTop_wrap.removeClass("off");
        }
        else {
            $backToTop_wrap.addClass("off");
        }
    });

    $backToTop_btn.on("click", function () {
        $("html, body").animate({scrollTop: 0}, 120);
    });

    $(function () {
        var navlist = $('.nav-list > li');

        navlist.each(function () {
            $(this).on('mouseenter', function () {
                $(this).addClass('selected');
            });

            $(this).on('mouseleave', function () {
                $(this).removeClass('selected');
            });
        });
    })
</script>



</body>
</html>
