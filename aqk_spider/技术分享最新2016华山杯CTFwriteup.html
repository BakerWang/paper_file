<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:wb="http://open.weibo.com/wb" xml:lang="en" lang="en">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <link rel="shortcut icon" href="http://bobao.360.cn/favicon.ico?v=1.1"/>
    <link rel="alternate" title="安全资讯" href="/rss?type=news" type="application/rss+xml"/>
    <link rel="alternate" title="安全知识" href="/rss?type=learning" type="application/rss+xml"/>
    <link rel="alternate" title="安全圈活动" href="/rss?type=activity" type="application/rss+xml"/>
    <link rel="alternate" title="所有漏洞" href="/rss?type=vul" type="application/rss+xml"/>
    <link rel="alternate" title="通用型漏洞" href="/rss?type=commonvul" type="application/rss+xml"/>
    <link rel="alternate" title="事件型漏洞" href="/rss?type=eventvul" type="application/rss+xml"/>
    <link rel="alternate" title="热门漏洞" href="/rss?type=hotvul" type="application/rss+xml"/>

        <title>【技术分享】最新2016华山杯CTF writeup - 安全客 - 有思想的安全新媒体</title>
    
        <meta name="keywords" content="华山杯CTF,writeup,网络安全技能大赛,解题报告"/>
    
        <meta name="description" content="最新2016华山杯CTF writeup"/>
        <meta property="wb:webmaster" content="224437c7be31d633"/>

    <script type="text/javascript" src="http://s7.qhimg.com/!56caa871/xpc_sync_height.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/reset.css" />
    <link rel="stylesheet" type="text/css" href="/css/common_new.css?v=4.4.2.1" />
    <link rel="stylesheet" type="text/css" href="/css/jquery.notyfy.css" />
    <link rel="stylesheet" type="text/css" href="/css/notyfy.theme.default.css" />
    <link rel="stylesheet" type="text/css" href="/css/s_common.css?v=2.2.7" media="only screen and
    (max-device-width:900px), only screen and (max-width:900px)" />
    <script type="text/javascript" src="/js/jquery.min.js?v=3.1"></script>
    <script type="text/javascript" src="/js/jquery.notyfy.js"></script>
    <script type="text/javascript" src="/js/iscroll.js"></script>
    <script src="http://js.passport.qihucdn.com/5.0.3.js"></script>
    <script type="text/javascript">
        var myScroll, myNavScroll;

        function iscrollLoaded() {
            myScroll = new IScroll('#wrapper',
                {
                    scrollX: true,
                    scrollY: false,
                    bounceEasing: 'circular',
                    eventPassthrough: true,
                    preventDefault: false,
                    bounceTime: 500
                }
            );
        }

        $(function () {

            //导航横向滚动


            function setNavWidth() {

                /* 计算导航宽度 */
                var allWidth = $(window).width();
                var scroller = $('#scroller');

                if (allWidth > 900) {
                    scroller.find('ul').add(scroller.find('.scroll')).removeAttr('style');
                    scroller.css('overflow', 'visible');
                    if (myNavScroll) myNavScroll.destroy();
                } else {

                    var width = 0;
                    scroller.find('.scroll').children('ul').children('li').each(function (index, el) {
                        if (!$(this).hasClass('mobile-hide')) {
                            width += $(this).outerWidth();
                        }
                    });
                    scroller.find('ul').add(scroller.find('.scroll')).width(width);

                    if (myNavScroll) myNavScroll.destroy();

                    myNavScroll = new IScroll('#scroller', {
                        scrollX: true,
                        scrollY: false,
                        momentum: false,
                        click: true
                    });

                }

            }

            setNavWidth();
            $(window).resize(function (event) {
                setNavWidth();
            });

        });

    </script>
</head>
<body onload="iscrollLoaded();">
<div style='margin:0 auto;width:0px;height:0px;overflow:hidden;'>
    <img src=""/>
</div>

<div id="is-mobile"></div>
<div class="container">
        <div class="mobile-header">
        <div class="header clearfix">
            <div class="header-wrapper clearfix">
                <a href="/index/index" class="logo"><img class="slogan" src="/img/logo.png?v=1.5"/></a>
                                <form id="search" class="search-box" action="/search/index" method="GET">
                    <input class="keys" name="keywords" type="text" placeholder="搜索漏洞" required="required">
                    <input class="icon" type="submit" value="">
                    <input type="hidden" name="type" value=""/>
                </form>
                <div class="bug">
                    <div class="name"><span class="seled">全部</span><i class="arrow"></i></div>
                    <ul class="typelist">
                        <li data-index="3"><a href="javascript:void(0);">全部</a></li>
                        <li data-index="0"><a href="javascript:void(0);">漏洞</a></li>
                        <li data-index="1"><a href="javascript:void(0);">资讯</a></li>
                        <li data-index="2"><a href="javascript:void(0);">知识</a></li>
                    </ul>
                </div>
                                <div class="logNreg mobile-hide">
                    <div class="unlog">
                        <i></i>
                        <a href="log.html" class="log">登录</a>
                        <span>|</span>
                        <a href="reg.html" class="reg">注册</a>
                    </div>
                    <div class="loged">
                        <a href="/member/profile" class="user-center"><i></i><span class="user-name-tag">个人中心</span></a>
                        <div class="user-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting"><a href="http://i.360.cn/profile/accountmanage"
                                                               target="_blank"><i></i><span>账号设置</span></a></li>
                                <li class="alert-setting"><a href="/keywords/index"
                                                             target="_blank"><i></i><span>告警设置</span></a></li>
                                <li class="bug-alert"><a href="/myalarm/index" target="_blank"><i></i><span>漏洞告警</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mylearn/index" target="_blank"><i></i><span>我的知识</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mycourse/index" target="_blank"><i></i><span>我的课堂</span></a>
                                </li>
                                <li class="my-exit"><a
                                            href="http://login.360.cn/?src=pcw_adlab&op=logout&destUrl=http://bobao.360.cn"><i></i><span>退出系统</span></a>
                                </li>
                            </ul>
                        </div>

                        <a href="/message" class="message-center" target="_blank"><i></i><span>我的消息</span></a>
                        <div class="message-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting" style="display:none;"><a href="/myres/index"
                                                                                     target="_blank"><i></i><span>回复我的</span></a>
                                </li>
                                <li class="my-bug"><a href="/myvul/index"
                                                      target="_blank"><i></i><span>我的漏洞</span></a></li>
                                <!--<li class="my-bug"><a href="/myres/index" target="_blank"><i></i><span>我的评论</span></a></li>-->
                                <!--<li class="alert-setting"><a href="###" target="_blank"><i></i><span>提到我的</span></a>
                                </li>-->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <style type="text/css">
            .nav {
                overflow: hidden;
            }

            .nav .scroll {
                width: auto;
            }
        </style>
        <div id="wrapper">
            <div id="scroller" class="nav">
                <div class="scroll">
                    <ul class="nav-list">
                        <li ><a class="link-nav"
                                                                                 href="/index/index">首页</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/vul/index">漏洞</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/introduce/list">招聘</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/news/index">资讯</a><!--<i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/introduce/list">招聘</a></li>
                        </ul>
			-->
                        </li>
                        <li class="cur">
                        <a class="link-nav" href="/learning/index">知识</a><i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/course/index">学院</a></li>
                        </ul>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/activity/index">活动</a></li>
                        <li class="mobile-hide "><a class="link-nav"
                                                                                                   href="/ctf/index">CTF训练营</a>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/interref/list">安全内参</a></li>
                        <li ><a class="link-nav" href="/app/index">APP</a></li>

                        <!--<li ><a href="/course/index">学院</a></li>-->
                        <!--<li ><a href="/introduce/list">招聘</a></li>-->
                        <!--<li  class="mobile-hide"><a href="/ctf/index">CTF训练营</a></li>-->
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="mobile-content">
        <link rel="stylesheet" type="text/css" href="/css/news.css?v=3.5" />
<link rel="stylesheet" type="text/css" href="/ue/SyntaxHighlighter/shCoreDefault.css?v=1.0" />
<style>
    p .syntaxhighlighter {
        width: 80%;
    }
</style>

<div class="cur-pos w1000">当前位置：<a href="http://bobao.360.cn/">安全客</a> &gt;&gt; 知识详情</div>

<div class="content clearfix">
    <div class="main">
        <div class="article">
            <div id="article_box">
                <h2>【技术分享】最新2016华山杯CTF writeup</h2>
                <div class="article-msg">
                    <span class="time">2016-09-11 13:06:28</span>
                                        <span class="read">阅读：31257次</span>
                    <span><a style="display: none;" class="good" href="javascript:;"
                             data-target="/learning/good" data-value="g_3019"
                             data-type="learning">点赞(0)</a></span>
                    <span><a class="fav" href="javascript:;" data-target="/mylearning/add"
                             data-pk="3019" data-type="learning">收藏</a></span>
                                        <span><a style="margin-left: 4px;" class="fav" href=""
                             target="_blank">来源： 安全客-FlappyPig</a></span>
                    
                                    </div>
                <hr size="1">
                <div class="article-msg">
                    <p><!-- JiaThis Button BEGIN -->

<!--
<span class="jiathis_style"><span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_tsina"></a>
    <a class="jiathis_button_tqq"></a>
    <a class="jiathis_button_qzone"></a>
    <a class="jiathis_button_renren"></a>
    <a class="jiathis_button_xiaoyou"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
</span>

-->
</p>
                </div>
                <p><p style="text-align:center"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);"><img src="http://p6.qhimg.com/t0181413579db29e760.png" title="t016026e8bfc01831a1.png" alt="http://p5.qhimg.com/t016026e8bfc01831a1.png"/></span></p><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);"></span></p><p style="margin: 0px 25px 8px; padding: 0px; line-height: 25px; color: rgb(70, 79, 85); word-break: break-all; font-family: Helvetica, &#39;Hiragino Sans GB&#39;, &#39;Microsoft Yahei&#39;, 微软雅黑, serif; white-space: normal; text-indent: 2em; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 0);"><strong><span style="color: rgb(0, 0, 0); text-indent: 2em; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px;"></span></strong></span></p><p style="margin: 0px 25px 8px; padding: 0px; line-height: 25px; color: rgb(70, 79, 85); word-break: break-all; font-family: Helvetica, &#39;Hiragino Sans GB&#39;, &#39;Microsoft Yahei&#39;, 微软雅黑, serif; white-space: normal; text-indent: 2em; background-color: rgb(255, 255, 255);"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><span style="color: rgb(0, 112, 192);"><span style="font-weight: 900;">作者：FlappyPig</span></span></span></p><p style="margin: 0px 25px 8px; padding: 0px; line-height: 25px; color: rgb(70, 79, 85); word-break: break-all; font-family: Helvetica, &#39;Hiragino Sans GB&#39;, &#39;Microsoft Yahei&#39;, 微软雅黑, serif; white-space: normal; text-indent: 2em; background-color: rgb(255, 255, 255);"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 112, 192);"><span style="font-weight: 900;">稿费：700RMB</span></span></p><p style="margin: 0px 25px 8px; padding: 0px; line-height: 25px; color: rgb(70, 79, 85); word-break: break-all; font-family: Helvetica, &#39;Hiragino Sans GB&#39;, &#39;Microsoft Yahei&#39;, 微软雅黑, serif; white-space: normal; text-indent: 2em; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-weight: 900; text-indent: 2em;">投稿方式：发送邮件至linwei#360.cn，或登陆网页版在线投稿</span></p><p style="margin: 0px 25px 8px; padding: 0px; line-height: 25px; color: rgb(70, 79, 85); word-break: break-all; font-family: Helvetica, &#39;Hiragino Sans GB&#39;, &#39;Microsoft Yahei&#39;, 微软雅黑, serif; white-space: normal; text-indent: 2em; background-color: rgb(255, 255, 255);"><br/></p><p style="margin: 0px 25px 8px; padding: 0px; line-height: 25px; color: rgb(70, 79, 85); word-break: break-all; font-family: Helvetica, &#39;Hiragino Sans GB&#39;, &#39;Microsoft Yahei&#39;, 微软雅黑, serif; white-space: normal; text-indent: 2em; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 0);"><strong><span style="color: rgb(0, 0, 0); text-indent: 2em; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px;">2016 华山杯&nbsp;网络安全技能大赛&nbsp;</span></strong><strong style="text-indent: 2em;"><span style="color: rgb(0, 0, 0); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">解题报告</span></strong></span></p><p style="margin: 0px 25px 8px; padding: 0px; line-height: 25px; color: rgb(70, 79, 85); word-break: break-all; font-family: Helvetica, &#39;Hiragino Sans GB&#39;, &#39;Microsoft Yahei&#39;, 微软雅黑, serif; white-space: normal; text-indent: 2em; background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 0, 0);"><strong><span style="color: rgb(0, 0, 0); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px;">队伍: FlappyPig&nbsp;</span></strong></span></p><h1 style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">Web渗透</span></strong></h1><hr/><h1 style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x01&nbsp;打不过~</span></strong></h1><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">添加type=”submin”，点击提交抓包</span></p><p style="text-align:center"><img src="http://p6.qhimg.com/t01d68c837036a8ce13.png" title="t013a6b95255f5236bb.png" alt="http://p2.qhimg.com/t013a6b95255f5236bb.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">有一串字符串，base64-&gt;md5，1931b。提交getflag</span></p><p style="text-align:center"><img src="http://p9.qhimg.com/t0193800516b5dccbb1.png" title="t0103d144d5e036d518.png" alt="http://p5.qhimg.com/t0103d144d5e036d518.png"/></p><p style="text-align:center"><img src="http://p0.qhimg.com/t01c0c54fb44adc3626.png" title="t014638d654e12ee190.png" alt="http://p5.qhimg.com/t014638d654e12ee190.png"/></p><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x02&nbsp;系统管理</span></h2><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">源码有代码，先找0e开头的md5，然后user.php，直接反序列化绕过</span></p><p style="text-align:center"><img src="http://p5.qhimg.com/t01e541e49caea4b6a7.png" title="t010bb7ad7cada8e84f.png" alt="http://p4.qhimg.com/t010bb7ad7cada8e84f.png"/></p><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x03&nbsp;简单js</span></h2><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">看了下js,直接alert(a)&nbsp;&nbsp;&nbsp; 14208</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t010c02d95f855f1cb5.png" title="t017b70bea1c31b0547.png" alt="http://p9.qhimg.com/t017b70bea1c31b0547.png"/></p><p style="text-align:center"><img src="http://p6.qhimg.com/t01e542afd606806db7.png" title="t0128975ccd378b9c67.png" alt="http://p7.qhimg.com/t0128975ccd378b9c67.png"/></p><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x04 弹弹弹！</span></h2><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">&lt;img src=1 onerror=alert(1)&gt;</span></p><p style="text-align:center"><img src="http://p8.qhimg.com/t0159dc7cf307103e03.png" title="t014c9cc7f98fc22514.png" alt="http://p3.qhimg.com/t014c9cc7f98fc22514.png"/></p><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x05 233</span></h2><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">Jsfuck，解密后是一句话</span></p><p style="text-align:center"><img src="http://p0.qhimg.com/t01206b75718096ea5c.png" title="t01f60397496def3d4c.png" alt="http://p9.qhimg.com/t01f60397496def3d4c.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">用工具解不开，直接自己写脚本吧ANSI-&gt;Unicode</span></p><p style="text-align:center"><img src="http://p8.qhimg.com/t015fe2aa94f03af25e.png" title="t01985b70a790bc3b01.png" alt="http://p8.qhimg.com/t01985b70a790bc3b01.png"/></p><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x06 无间道</span></h2><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">这题怀疑出错了吧，函数的都没定义，咋传？还没get到出题人的意图，通过下一题直接读的源码</span></p><p style="text-align:center"><img src="http://p5.qhimg.com/t01832b330c17d62d95.png" title="t0117aa9d1b5f2b3056.png" alt="http://p7.qhimg.com/t0117aa9d1b5f2b3056.png"/></p><p style="text-align:center"><img src="http://p0.qhimg.com/t01a35ec39f429244f9.png" title="t0100bca3c32df3796f.png" alt="http://p2.qhimg.com/t0100bca3c32df3796f.png"/></p><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x07 php很烦人</span></h2><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">先看源码，用php://input改成admin，然后可以直接读文件，index中有个class.php</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t01a8f0926612b2a5dd.png" title="t010086c487e62bec8a.png" alt="http://p7.qhimg.com/t010086c487e62bec8a.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);"></span></p><pre class="brush:plain;toolbar:false"><span style="color: rgb(0, 0, 0);">&lt;?php<br/>class&nbsp;Read{//f1a9.php<br/>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;$file;<br/>&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;function&nbsp;__toString(){<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isset($this-&gt;file)){<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;file_get_contents($this-&gt;file);&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&quot;__toString&nbsp;was&nbsp;called!&quot;;<br/>&nbsp;&nbsp;&nbsp;&nbsp;}<br/>}<br/></span></pre><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 0, 0); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">没法直接读f1a9.php,反序列化去读</span></p><p style="text-align:center"><img src="http://p3.qhimg.com/t01d83e42544c64040f.png" title="t01783537eb3eec0aa1.png" alt="http://p2.qhimg.com/t01783537eb3eec0aa1.png"/></p><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x08 More try</span></h2><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">靠上个题读到源码，然后看了下role有注入，还有两层base64</span></p><p style="text-align:center"><img src="http://p0.qhimg.com/t011f0fb9a855f42619.png" title="t0193c1ea2a10c48b0b.png" alt="http://p0.qhimg.com/t0193c1ea2a10c48b0b.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">Sqlmap有个base64encode.py的tamper，所以自己改下，改成两层</span></p><p style="text-align:center"><img src="null" title="t015ae748d49b28a98a.png" alt="http://p5.qhimg.com/t015ae748d49b28a98a.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">然后sqlmap.py –r –tamper=”base2.py” –v 3 ,the_key表，key字段</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t013198f07bd358522a.png" title="t01ecc8929555f1785e.png" alt="http://p0.qhimg.com/t01ecc8929555f1785e.png"/></p><p style="text-align:center"><img src="http://p6.qhimg.com/t016512719019618a7a.png" title="t01b6e036b4e6eb390c.png" alt="http://p3.qhimg.com/t01b6e036b4e6eb390c.png"/></p><p style="text-align:center"><img src="http://p4.qhimg.com/t01cde920e298a69075.png" title="t0194afec6bdc16aef4.png" alt="http://p5.qhimg.com/t0194afec6bdc16aef4.png"/></p><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x0A 三秒钟记忆</span></h2><p style="text-indent: 2em; text-align: left;"><a href="http://huashan.xdsec.cn/pic/login" style="text-decoration: underline; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">http://huashan.xdsec.cn/pic/login</span></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">这里可以看到源码，</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">重置密码的地方可以二次注入</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t011dfa59f3084267b5.png" title="t01aca054abb4b9cf68.png" alt="http://p9.qhimg.com/t01aca054abb4b9cf68.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">注册的时候带’的用户名，然后重置密码的时候会注入</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">‘ and LEFT ((select flag from flag),x)=’ flag_Xd{hSh_ctf:dutwq}’</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">如果充值成功了，密码就会变，所以就无法登陆了，写脚本跑下就好了,太慢了……</span></p><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x0B 疯狂的js</span></h2><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">这个是plaidctf2014的原题，不过改了一个地方，</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">var args = [].slice.apply(arguments).sort().filter(function(x,i,a){return a.indexOf(x) == i;});</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">if(args.length != 5) return &quot;数够参数了吗？&quot;;</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">var flag = false; args.map(function(x){flag |= x &gt;= 999;});</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">if(flag) return &quot;有点大了哦&quot;;</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);"></span></p><pre class="brush:plain;toolbar:false">var&nbsp;m&nbsp;=&nbsp;args.map(cal);
if(m.filter(function(x,i){return&nbsp;m[2]+3*i==x;}).length&nbsp;&lt;&nbsp;1)&nbsp;return&nbsp;&quot;no&quot;;
if(m.filter(function(x,i){return&nbsp;x&nbsp;==&nbsp;args[i];}).length&nbsp;&lt;&nbsp;2)&nbsp;return&nbsp;&quot;nono&quot;;
if(m.filter(function(x,i){return&nbsp;x&nbsp;&gt;&nbsp;m[i-1];}).length&nbsp;&gt;&nbsp;2)&nbsp;return&nbsp;&quot;bala&quot;;
if(m.filter(function(x,i){return&nbsp;x&nbsp;&lt;&nbsp;m[i-1];}).length&nbsp;&gt;&nbsp;1)&nbsp;return&nbsp;&quot;balana~&quot;;</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);"></span><br/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">满足条件即可弹出flag</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">五次分别输入</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">2.0</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">2.00</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">6</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">76</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">949</span></p><p style="text-align:center"><img src="http://p5.qhimg.com/t01735276b78c266c8e.png" title="t01e17032382dfb20c6.png" alt="http://p2.qhimg.com/t01e17032382dfb20c6.png"/></p><h1 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">Reverse逆向破解</span></h1><hr/><h1 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; text-indent: 2em; color: rgb(0, 0, 0);">0x01 Crackme1. Warming Up</span></h1><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">代码就是个简单变化，动态跟了几步，发现进行了如下操作：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);"></span></p><pre class="brush:plain;toolbar:false">&quot;&quot;&quot;
xor&nbsp;0x30&nbsp;^&nbsp;1
xor&nbsp;0x32&nbsp;^&nbsp;2
xor&nbsp;0x33&nbsp;^&nbsp;3
xor&nbsp;0x34&nbsp;^&nbsp;1
xor&nbsp;0x35&nbsp;^&nbsp;2
&quot;&quot;&quot;</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);"></span><br/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">最后进行字符串比较，反过来写下就可以，如下：</span></p><pre class="brush:plain;toolbar:false">target&nbsp;=&nbsp;&quot;VgobmndVlBVE&quot;
result&nbsp;=&nbsp;&quot;&quot;
for&nbsp;index,&nbsp;item&nbsp;in&nbsp;enumerate(target):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;+=&nbsp;chr(ord(item)^(((index)%3)+1))
print&nbsp;result</pre><p style="text-align:center"><img src="http://p4.qhimg.com/t0103e81b956acf062a.png" title="t01cb8a0db10796388b.png" alt="http://p5.qhimg.com/t01cb8a0db10796388b.png"/><br/></p><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x02 Crackme2. 到手的钥匙</span></h2><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">这题的逻辑就不是常人的，有两个用户名和密码。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">开始那个还正常点</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">用户名：amdin，</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">密码的md5值知道，然后反查了下值为：xdadmin</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t01f1173fb3e2b2f5f8.png" title="t01b1a634141170ed54.png" alt="http://p0.qhimg.com/t01b1a634141170ed54.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">但是输完并没有什么用，提交也不对：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">后来发现另外一个函数也用到了用户名密码，如下：</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t0199fc029aa9ea2c0c.png" title="t01468d04375fd5efc7.png" alt="http://p4.qhimg.com/t01468d04375fd5efc7.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">输入3247,5569得到如下：</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t0156d12994b7aaa361.png" title="t01e8b57a762fafd55d.png" alt="http://p6.qhimg.com/t01e8b57a762fafd55d.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">组合下输出的结果，提交不对，，，，，，，，，，</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">不对啊，，，，，，，，，，</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">仔细看代码，没别的逻辑了啊，，，，纠结了好久</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">突然队友提交了“用户名+密码+输出”的结果，通过。。。。。。。。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">竟然通过了。。。。。。。。。</span></p><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x03 Crackme3. 探囊取物</span></h2><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">题目是个图片，直接strings crackme3.jpg，得到一串01</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t014999fbb963647056.png" title="t01fa6fd50b1c7283f4.png" alt="http://p6.qhimg.com/t01fa6fd50b1c7283f4.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">目测可以拼出来字，一共1177个，11*107</span></p><p style="text-align:center"><img src="http://p8.qhimg.com/t01dc546ef036ae7ec7.png" title="t019138862cec0eae39.png" alt="http://p2.qhimg.com/t019138862cec0eae39.png"/></p><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x04 Crackme4. 移动迷宫</span></h2><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">代码就是个简单的走迷宫，图如下：</span></p><p style="text-align:center"><img src="http://p0.qhimg.com/t0151e33af64a6d3fd7.png" title="t0117192c965f927135.png" alt="http://p9.qhimg.com/t0117192c965f927135.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">输入的东西，进行各简单变化，对应于走的方向，如下：</span></p><p style="text-align:center"><img src="http://p2.qhimg.com/t01fd5ee3ec9c12ab90.png" title="t01b7014729a4dd5319.png" alt="http://p4.qhimg.com/t01b7014729a4dd5319.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">走的逻辑如下：</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t011189aa5075180cae.png" title="t0112178bff52413f0a.png" alt="http://p0.qhimg.com/t0112178bff52413f0a.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">根据坐标生成方向即可，逆代码如下：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);"></span></p><pre class="brush:plain;toolbar:false"><span style="color: rgb(0, 0, 0);">map_info&nbsp;=&nbsp;&quot;***********####******#**#*****##*##********#*********#*#####***###***#*********#*********#********##&quot;<br/>result&nbsp;=&nbsp;&quot;&quot;<br/>x&nbsp;=&nbsp;0<br/>y&nbsp;=&nbsp;0<br/>pos_list&nbsp;=&nbsp;[]<br/>for&nbsp;i&nbsp;in&nbsp;range(len(map_info)):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;+=&nbsp;map_info[i]<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;=&nbsp;(i)%10<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;i/10<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(i+1)%10&nbsp;==&nbsp;0:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;+=&nbsp;&quot;\n&quot;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;map_info[i]&nbsp;==&nbsp;&quot;#&quot;:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos_list.append((x,&nbsp;y))<br/>print&nbsp;map_info[0x28]<br/>print&nbsp;result<br/>print&nbsp;pos_list<br/>last&nbsp;=&nbsp;0<br/>way_list&nbsp;=&nbsp;[]<br/>way_list.append((1,0))<br/>way_list.append((0,-1))<br/>way_list.append((0,-1))<br/>way_list.append((1,0))<br/>way_list.append((1,0))<br/>way_list.append((1,0))<br/>way_list.append((0,1))<br/>way_list.append((0,1))<br/>way_list.append((-1,0))<br/>way_list.append((0,1))<br/>way_list.append((0,1))<br/>way_list.append((0,1))<br/>way_list.append((1,0))<br/>way_list.append((1,0))<br/>way_list.append((0,-1))<br/>way_list.append((1,0))<br/>way_list.append((1,0))<br/>way_list.append((1,0))<br/>way_list.append((1,0))<br/>way_list.append((0,1))<br/>way_list.append((0,1))<br/>way_list.append((0,1))<br/>way_list.append((0,1))<br/>way_list.append((-1,0))<br/>print&nbsp;len(way_list)<br/>map_dic&nbsp;=&nbsp;{}<br/>map_dic[(-1,&nbsp;0)]&nbsp;=&nbsp;3<br/>map_dic[(1,&nbsp;0)]&nbsp;=&nbsp;4<br/>map_dic[(0,&nbsp;-1)]&nbsp;=&nbsp;1<br/>map_dic[(0,&nbsp;1)]&nbsp;=&nbsp;2<br/>result&nbsp;=&nbsp;[]<br/>for&nbsp;i&nbsp;in&nbsp;way_list:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result.append(map_dic[i])<br/>way_key&nbsp;=&nbsp;&quot;&quot;&quot;0A1B<br/>a2b3<br/>4C5D<br/>c6d7<br/>8E9F<br/>e0f1&quot;&quot;&quot;<br/>way_key&nbsp;=&nbsp;way_key.split(&quot;\n&quot;)<br/>print&nbsp;result<br/>print&nbsp;len(result)<br/>result_info&nbsp;=&nbsp;&quot;&quot;<br/>for&nbsp;i&nbsp;in&nbsp;range(4):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;range(6):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result_info&nbsp;+=&nbsp;way_key[j][result[i*6+j]-1]<br/>print&nbsp;way_key<br/>print&nbsp;result_info<br/></span></pre><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 0, 0); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">flag如下：最后一行</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t01e5db0167239c1d02.png" title="t01d3e2015dad03bb45.png" alt="http://p8.qhimg.com/t01d3e2015dad03bb45.png"/></p><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x05 Crackme5. Do something</span></h2><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">虽然题目给了个jpg，但其实是个程序，主要的判断逻辑如下：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);"></span></p><pre class="brush:plain;toolbar:false"><span style="color: rgb(0, 0, 0);">int&nbsp;__cdecl&nbsp;sub_401000(char&nbsp;*Src)<br/>{<br/>&nbsp;&nbsp;char&nbsp;Dst[20];&nbsp;//&nbsp;[sp+0h]&nbsp;[bp-14h]@1<br/>&nbsp;&nbsp;Dst[0]&nbsp;=&nbsp;byte_415282;<br/>&nbsp;&nbsp;*(_DWORD&nbsp;*)&amp;Dst[1]&nbsp;=&nbsp;0;<br/>&nbsp;&nbsp;*(_DWORD&nbsp;*)&amp;Dst[5]&nbsp;=&nbsp;0;<br/>&nbsp;&nbsp;*(_DWORD&nbsp;*)&amp;Dst[9]&nbsp;=&nbsp;0;<br/>&nbsp;&nbsp;*(_DWORD&nbsp;*)&amp;Dst[13]&nbsp;=&nbsp;0;<br/>&nbsp;&nbsp;*(_WORD&nbsp;*)&amp;Dst[17]&nbsp;=&nbsp;0;<br/>&nbsp;&nbsp;Dst[19]&nbsp;=&nbsp;0;<br/>&nbsp;&nbsp;strcpy_s(Dst,&nbsp;17u,&nbsp;Src);<br/>&nbsp;&nbsp;check_equ_401320(Dst[0],&nbsp;Dst[8]);<br/>&nbsp;&nbsp;check_equ_401320(Dst[0],&nbsp;Dst[9]);<br/>&nbsp;&nbsp;check_equ_401320(Dst[1],&nbsp;Dst[10]);<br/>&nbsp;&nbsp;check_equ_401320(Dst[2],&nbsp;Dst[4]);<br/>&nbsp;&nbsp;check_equ_401320(Dst[3],&nbsp;Dst[5]);<br/>&nbsp;&nbsp;check_equ_401320(Dst[11],&nbsp;5);<br/>&nbsp;&nbsp;check_equ_401320(Dst[7],&nbsp;3&nbsp;*&nbsp;Dst[11]);<br/>&nbsp;&nbsp;check_bigger_401350(Dst[12],&nbsp;5&nbsp;*&nbsp;Dst[14]);<br/>&nbsp;&nbsp;check_equ_401320(Dst[13],&nbsp;2&nbsp;*&nbsp;Dst[12]);<br/>&nbsp;&nbsp;check_bigger_401350(Dst[3],&nbsp;3&nbsp;*&nbsp;Dst[12]);<br/>&nbsp;&nbsp;check_bigger_401350(Dst[0],&nbsp;Dst[3]);<br/>&nbsp;&nbsp;check_bigger_401350(21,&nbsp;Dst[0]);<br/>&nbsp;&nbsp;check_equ_401320(Dst[0],&nbsp;Dst[6]&nbsp;+&nbsp;Dst[12]);<br/>&nbsp;&nbsp;check_equ_401320(Dst[6],&nbsp;2&nbsp;*&nbsp;Dst[15]);<br/>&nbsp;&nbsp;check_bigger_401350(Dst[2],&nbsp;4&nbsp;*&nbsp;Dst[14]);<br/>&nbsp;&nbsp;check_bigger_401350(Dst[6],&nbsp;Dst[2]);<br/>&nbsp;&nbsp;if&nbsp;(&nbsp;Dst[2]&nbsp;%&nbsp;3&nbsp;)<br/>&nbsp;&nbsp;{<br/>&nbsp;&nbsp;&nbsp;&nbsp;printf(aNextTime);<br/>&nbsp;&nbsp;&nbsp;&nbsp;sub_40E644();<br/>&nbsp;&nbsp;&nbsp;&nbsp;exit(0);<br/>&nbsp;&nbsp;}<br/>&nbsp;&nbsp;check_bigger_401350(Dst[1],&nbsp;7);<br/>&nbsp;&nbsp;check_bigger_401350(Dst[2],&nbsp;Dst[1]);<br/>&nbsp;&nbsp;return&nbsp;check_bigger_401350(Dst[0],&nbsp;Dst[1]&nbsp;+&nbsp;Dst[2]);<br/>}<br/></span></pre><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 0, 0); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">就是一些列的条件，满足就会输出得到了flag，约束如下：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);"></span></p><pre class="brush:plain;toolbar:false"><span style="color: rgb(0, 0, 0);">Dst[0]&nbsp;=&nbsp;Dst[8]<br/>Dst[0]&nbsp;==&nbsp;Dst[9]<br/>Dst[1]&nbsp;==&nbsp;Dst[10]<br/>Dst[2]&nbsp;==&nbsp;Dst[4]<br/>Dst[3]&nbsp;==&nbsp;Dst[5]<br/>Dst[11]&nbsp;==&nbsp;5<br/>Dst[7]&nbsp;==&nbsp;3&nbsp;*&nbsp;Dst[11]<br/>Dst[12]&nbsp;&gt;&nbsp;5&nbsp;*&nbsp;Dst[14]<br/>Dst[13]&nbsp;==&nbsp;2&nbsp;*&nbsp;Dst[12]<br/>Dst[3]&nbsp;&gt;&nbsp;3&nbsp;*&nbsp;Dst[12]<br/>Dst[0]&nbsp;&gt;&nbsp;Dst[3]<br/>21&nbsp;&gt;&nbsp;Dst[0]<br/>Dst[0]&nbsp;==&nbsp;Dst[6]&nbsp;+&nbsp;Dst[12]<br/>Dst[6]&nbsp;==&nbsp;2&nbsp;*&nbsp;Dst[15]<br/>Dst[2]&nbsp;&gt;&nbsp;4&nbsp;*&nbsp;Dst[14]<br/>Dst[6]&nbsp;&gt;&nbsp;Dst[2]<br/>Dst[2]&nbsp;%&nbsp;3&nbsp;==&nbsp;0<br/>Dst[1]&nbsp;&gt;&nbsp;7<br/>Dst[2]&nbsp;&gt;&nbsp;Dst[1]<br/>Dst[0]&nbsp;&gt;&nbsp;Dst[1]&nbsp;+&nbsp;Dst[2])<br/></span></pre><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 0, 0); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">直接用个求解器求解即可，结果如下：</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t01907aa00dbf7ef995.png" title="t01203d428c835978f3.png" alt="http://p2.qhimg.com/t01203d428c835978f3.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">直接算出与加上0x60即可得到flag，如下：</span></p><p style="text-align:center"><img src="http://p0.qhimg.com/t0155cd22525176e54f.png" title="t01db94fcf4f56f10b3.png" alt="http://p9.qhimg.com/t01db94fcf4f56f10b3.png"/></p><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x06 Crackme6. Help me</span></h2><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">这题目就是运行得时候，对一些不可访问的地址进行了写入，导致崩溃，看代码貌似是专门这样写的，如下：</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t017b0983ff9a648213.png" title="t0167e8d630acc46e52.png" alt="http://p5.qhimg.com/t0167e8d630acc46e52.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">直接对[0x10]处进行了赋值，程序这样的位置还有好几处，如下：</span></p><p style="text-align:center"><img src="http://p0.qhimg.com/t011bd8f413b648a063.png" title="t01dad85f9acbc37d07.png" alt="http://p4.qhimg.com/t01dad85f9acbc37d07.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">直接对其进行nop，然后将输出，转成printf即可，如下:</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t01975b3118ce170760.png" title="t0145ab7b613d9a25b7.png" alt="http://p0.qhimg.com/t0145ab7b613d9a25b7.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">Flag直接就打印出来了，如下：</span></p><p style="text-align:center"><img src="http://p3.qhimg.com/t0175d11eaa0e57e76e.png" title="t012609562f4273a34c.png" alt="http://p6.qhimg.com/t012609562f4273a34c.png"/></p><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x08 Crackme8. 忘记用户名</span></h2><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">代码就很简单，如下图：</span></p><p style="text-align:center"><img src="http://p5.qhimg.com/t016039fc74f39bc9b1.png" title="t01aed257c6b2116048.png" alt="http://p4.qhimg.com/t01aed257c6b2116048.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">直接计算即可， 代码如下：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);"></span></p><pre class="brush:plain;toolbar:false">info&nbsp;=&nbsp;&quot;ILoveXD&quot;
result_info&nbsp;=&nbsp;&quot;&quot;
for&nbsp;i&nbsp;in&nbsp;range(7):
&nbsp;&nbsp;&nbsp;&nbsp;result_info&nbsp;+=&nbsp;chr(ord(info[i])+7-i)
print&nbsp;result_info</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);"></span><br/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">结果如下：</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t0143aee72e7e6d7ea5.png" title="t0199e6d647fbd73585.png" alt="http://p4.qhimg.com/t0199e6d647fbd73585.png"/></p><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x09 Crackme9. 捉迷藏</span></h2><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">用户名: FindKey</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">密码：T25Zb3VyQ29tcHV0ZXI= base64解码得: OnYourComputer</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">生成了一个flag.jpg，里面的内容为FindKeyOnYourComputerArvinShow</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">Flag的品相好差。</span></p><h1 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">Crypto加密解密</span></h1><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x01 紧急报文</span></h2><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">ADFGX加密</span></p><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x02 is it x or z ?</span></h2><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">给了3个文件 clear-1.txt crypt-1.txt和crypt-2.txt，用clear-1.txt和crypt-1.txt异或可以得到重复循环的片段，推测循环节即为密钥，用该密钥解密crypt-2即可得到flag</span></p><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x03 分组加密模式检测</span></h2><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">这是个原题，见这里：</span><a href="https://github.com/truongkma/ctf-tools/tree/master/cryptopals-solutions-master/set1/8" style="text-decoration: underline; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">https://github.com/truongkma/ctf-tools/tree/master/cryptopals-solutions-master/set1/8</span></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">主要就是从一大堆CBC密文里检测出ECB密文，脚本一模一样抄即可。</span></p><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x04 修复一下这份邀请函的部分内容</span></h2><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">打开就是flag，明文，直接交</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t014e0d1a2cfef1a114.png" title="t0127632dd8545363b7.png" alt="http://p8.qhimg.com/t0127632dd8545363b7.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">flag_Xd{hSh_ctf:flag xie can xie yu hen xing gao}</span></p><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x0 5协议？认证？加密？</span></h2><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">这题先进行了DH交换密钥，然后用交换后的密钥加密的flag。A B P都不是很大，猜想这个离散对数问题比较容易解。</span></p><p style="text-indent: 2em; text-align: left;"><a href="https://www.alpertron.com.ar/DILOG.HTM" style="text-decoration: underline; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">https://www.alpertron.com.ar/DILOG.HTM</span></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">用这个工具可以直接求解出离散对数算出a的私有指数，然后计算B^a就作为密钥了。但是这题有一个地方很坑，得到的密钥只有8个字节，但是AES需要16个字节作为密钥，一开始卡这里卡了很久。后来才脑洞出来高位全部补\x00，然后解完发现后一半flag是乱码，又是很坑，后来用CBC模式试了一下，iv取全0，解出来才正常。</span></p><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x06 时间决定一切</span></h2><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">web的任意文件读取，直接读源码</span></p><p style="text-align:center"><img src="http://p6.qhimg.com/t01c1c8a72c1121c0fb.png" title="t016b8aa2edab5e0f69.png" alt="http://p3.qhimg.com/t016b8aa2edab5e0f69.png"/></p><h1 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">Android</span></h1><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x01 错错错</span></h2><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">这题算法其实很简单，就是对随机字符串进行啦哈希操作然后进行一个替换作为密码。由于运行的时候用的hash函数是随机的，所以4个都试一下。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);"></span></p><pre class="brush:plain;toolbar:false"><span style="color: rgb(0, 0, 0);">#!/usr/bin/env&nbsp;python<br/>import&nbsp;hashlib<br/>dic&nbsp;=&nbsp;&quot;AabRcQPXdYVeTWUSfghijklCmDnEoGpqFrHsItKJLuvwxyz01M23O45N67Z89B&quot;<br/>serial&nbsp;=&nbsp;&quot;skxxRWi23&quot;<br/>for&nbsp;i&nbsp;in&nbsp;range(4):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ans&nbsp;=&nbsp;&#39;&#39;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(i==0):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enc&nbsp;=&nbsp;hashlib.md5(serial).hexdigest()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;range(8):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ans&nbsp;+=&nbsp;str(dic.index(enc[j]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;enc<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;ans<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(i==1):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enc&nbsp;=&nbsp;hashlib.sha1(serial).hexdigest()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;range(8):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ans&nbsp;+=&nbsp;str(dic.index(enc[j]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;enc<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;ans<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(i==2):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enc&nbsp;=&nbsp;hashlib.sha256(serial).hexdigest()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;range(8):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ans&nbsp;+=&nbsp;str(dic.index(enc[j]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;enc<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;ans<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(i==3):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enc&nbsp;=&nbsp;hashlib.sha384(serial).hexdigest()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;range(8):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ans&nbsp;+=&nbsp;str(dic.index(enc[j]))<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;enc<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;ans<br/></span></pre><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 0, 0); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">最后尝试发现：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">序列号：skxxRWi23</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">哈希值：521c0892b9dc0a7026fbe9664e6a339e7fee9492605733ea09968fbd83f18dfff91fe87d9d620fa4d3dd3010b47495dc</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">解锁码：545048447596050</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">这一是正确的。</span></p><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x02 寻找密码</span></h2><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">这题其实是给apk加了个壳，程序里把真实的apk经过了加密(异或255)拼到了apk的dex文件后面，所以我直接把dex文件提取出来，整个文件异或255，然后从第一个PK开始提取出原始APK。然后原始的APK扔到jeb里就很容易看出源代码了。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">算法很简单：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);"></span></p><pre class="brush:plain;toolbar:false"><span style="color: rgb(0, 0, 0);">#!/usr/bin/env&nbsp;python<br/>import&nbsp;base64<br/>import&nbsp;hashlib<br/>username&nbsp;=&nbsp;base64.b64decode(&#39;U2hlMTFfTjZSYw==&#39;)<br/>v4&nbsp;=&nbsp;hashlib.sha1(username).hexdigest()<br/>print&nbsp;username<br/>print&nbsp;v4[:16]<br/></span></pre><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 0, 0); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px;"><br/></span></p><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x03 顺藤摸瓜</span></h2><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">apk用了zip伪加密，首先用010editor打开，将所有 0x50 0x4B 0x01 0x02（PK..）的位置后的第五个字节改为0，即可成功安装或解压。可参考吾爱破解的文章帖子http://www.52pojie.cn/thread-287242-1-1.html。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">反编译apk后发现会调用Native函数check来验证密码，直接用ida将libdemo.so打开。如下</span></p><p style="text-align:center"><img src="http://p6.qhimg.com/t0144b117eae2215fa9.png" title="t01aa8d45fe86c7d347.png" alt="http://p3.qhimg.com/t01aa8d45fe86c7d347.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">三段比较简单的加密，直接用ipython解了</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t013c4bb7c917f6b81c.png" title="t0179168d6def347bff.png" alt="http://p2.qhimg.com/t0179168d6def347bff.png"/></p><p style="text-align:center"><img src="http://p7.qhimg.com/t0199f3c4302d3089e1.png" title="t012a8a792a888ec2c4.png" alt="http://p1.qhimg.com/t012a8a792a888ec2c4.png"/></p><p style="text-align:center"><img src="http://p3.qhimg.com/t01c836a21866c3dd22.png" title="t01680958f750f2ba1b.png" alt="http://p8.qhimg.com/t01680958f750f2ba1b.png"/></p><p style="text-align:center"><img src="http://p1.qhimg.com/t012222cf128adebeca.png" title="t015b9aefb48b5ff351.png" alt="http://p2.qhimg.com/t015b9aefb48b5ff351.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">把上面的result的值输入手机中，即可显示“碰头地点：太白南路2号”</span></p><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x04 神奇的zip</span></h2><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">这个题首先也是一个伪加密，修复后即可正常安装和解压。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">首先apk一启动就会调用libgeneratekey.so中的isExit函数，如果该函数返回0那么apk就退出，而ida查看isExit函数的唯一作用就是返回0。因此可以使用apktool反编译apk，将SplashActivity.smali文件中第52行的if-eqz改为if-nez，即可绕过这个检测。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">随后会启动MainActivity，这个类的唯一操作就是将输入的字符串传入native层的函数encodePassword中，并且显示出encodePassword返回的字符串。因此我们使用ida查看encodePassword函数。主要逻辑如下</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t01cf683e56cc679505.png" title="t0183eb860d2c0a2dda.png" alt="http://p3.qhimg.com/t0183eb860d2c0a2dda.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">可以看出，该函数会将输入的字符串与一串经过极其复杂变形的字符串进行比较，这里我们可以不去深入研究变形的过程，因为该函数没有将输入的字符串做任何变化，而是去直接比较的，因此我们可以使用调试或者hook的方法直接将变形完的字符串打印出来。这里我用frida直接hook了encodePS函数，打印出它的返回值即可，会打印两遍，取后一次。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">hook代码</span></p><table cellspacing="0" cellpadding="0"><tbody><tr class="firstRow"><td width="553" valign="top" style="border-color: windowtext; border-width: 1px; padding: 0px 7px;"><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);"></span></p><pre class="brush:plain;toolbar:false"><span style="color: rgb(0, 0, 0);">let&nbsp;F&nbsp;=&nbsp;&nbsp;&nbsp;Module.findExportByName(&#39;libgeneratekey.so&#39;,&nbsp;&#39;encodePS&#39;);<br/>Interceptor.attach(F,&nbsp;&nbsp;&nbsp;{<br/>&nbsp;&nbsp;&nbsp;&nbsp;onLeave:&nbsp;function&nbsp;(retval)&nbsp;{<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let&nbsp;ptr&nbsp;=&nbsp;new&nbsp;NativePointer(retval);<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(hexdump(ptr));<br/>&nbsp;&nbsp;&nbsp;&nbsp;}<br/>});<br/></span></pre><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 0, 0); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px;"><br/></span></p></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">输出：</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t01942e2a625ce0cd92.png" title="t01cb185e4cd3766cc1.png" alt="http://p3.qhimg.com/t01cb185e4cd3766cc1.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">上图以l开头的字符串即为flag。</span></p><h1 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">Misc</span></h1><hr/><h1 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; text-indent: 2em; color: rgb(0, 0, 0);">0x01 Try Everything</span></h1><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">这题并不难，直接解压后发现是乱的</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t01f3b5fef7dd792598.png" title="t0140ffa70e4e0dcd53.png" alt="http://p8.qhimg.com/t0140ffa70e4e0dcd53.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">&nbsp;<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">然后扔binwalk，得到文件名和偏移量，脚本分解出文件</span></p><p style="text-align:center"><img src="http://p2.qhimg.com/t0112d8c7006ffa913c.png" title="t01a9706cabb50e6283.png" alt="http://p9.qhimg.com/t01a9706cabb50e6283.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">然后按照文件名排序解出并且合并文本</span></p><p style="text-align:center"><img src="http://p2.qhimg.com/t01396caea248e01383.png" title="t015eae64c03e0f86a3.png" alt="http://p6.qhimg.com/t015eae64c03e0f86a3.png"/></p><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x02 挣脱牢笼</span></h2><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">Python沙盒逃逸题。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">一开始设想用[].__class__.__base__.__subclasses__()[40]来使用file读文件。后来发现他命令限制长度50，非常蛋疼。后来才发现可以直接设定__builtins__变量来把指令分成多条进行，就不会受这个限制了。最后的exp如下：<br/> </span></p><pre class="brush:plain;toolbar:false"><span style="color: rgb(0, 0, 0);">__builtins__[&#39;ww&#39;]=().__class__.__base__<br/>__builtins__[&#39;w&#39;]=ww.__subclasses__()<br/>w[40](&#39;./flag.txt&#39;).read();print&nbsp;k<br/></span></pre><h1 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">Forensics</span></h1><hr/><h1 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; text-indent: 2em; color: rgb(0, 0, 0);">0x01蒲公英的约定</span></h1><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">Stegsolve打开，里面有张二维码，反色下就好了</span></p><p style="text-align:center"><img src="http://p2.qhimg.com/t01f0112957f531b49e.png" title="t01b194e82d741f199d.png" alt="http://p9.qhimg.com/t01b194e82d741f199d.png"/></p><p style="text-align:center"><img src="http://p6.qhimg.com/t016147de97345d5bb9.png" title="t01a14e139955364da1.png" alt="http://p6.qhimg.com/t01a14e139955364da1.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">扫码后base32</span></p><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x02什么鬼</span></h2><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">Binwalk可以看到一个zip</span></p><p style="text-align:center"><img src="http://p0.qhimg.com/t0117cb1e799747ebd7.png" title="t01648962475f855c53.png" alt="http://p4.qhimg.com/t01648962475f855c53.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">密码长度4位，直接爆破，密码：19bZ</span></p><p style="text-align:center"><img src="http://p3.qhimg.com/t014c740820ba288e86.png" title="t01084d8a9891b46248.png" alt="http://p8.qhimg.com/t01084d8a9891b46248.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">解开后将右边的块补上即可</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t013e71914f5c882522.png" title="t0193fd27b18d21f29a.png" alt="http://p1.qhimg.com/t0193fd27b18d21f29a.png"/></p><h2 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">0x03客官，听点小曲儿？</span></h2><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 那个http的头里发现了：</span></p><p style="text-align:center"><img src="http://p5.qhimg.com/t01634b585e82d0004f.png" title="t0127942c1a076aa92d.png" alt="http://p8.qhimg.com/t0127942c1a076aa92d.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 直接用mp3stego decode掉得到：</span></p><p style="text-align:center"><img src="http://p2.qhimg.com/t019d6e07e05363aa94.png" title="t01fd08424457e6a0d8.png" alt="http://p7.qhimg.com/t01fd08424457e6a0d8.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 可见字符，顺序乱了，考虑栅栏，长度为6的试了不行，后面应该长度有些许变化，手动切割，得到flag：</span></p><table cellspacing="0" cellpadding="0"><tbody><tr class="firstRow"><td width="553" valign="top" style="border-color: windowtext; border-width: 1px; padding: 0px 7px; word-break: break-all;"><pre class="brush:ps;toolbar:false"><span style="color: rgb(0, 0, 0);">a=&quot;fdc3_#&nbsp;l{tsf#&nbsp;ahfte}&nbsp;gS:en&nbsp;_hmgc&nbsp;X_poe&quot;<br/>&nbsp;&nbsp;&nbsp;b=a.split(&quot;&nbsp;&quot;)<br/>&nbsp;&nbsp;&nbsp;s=&quot;&quot;<br/>&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;&nbsp;&nbsp;range(6):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;j&nbsp;in&nbsp;b:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;i&nbsp;&lt;&nbsp;len(j):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s+=j[i]<br/>&nbsp;&nbsp;&nbsp;print&nbsp;s<br/></span></pre><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 0, 0); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px;"><br/></span></p></td></tr></tbody></table></p>
                <hr/>
                <p style="text-align: center;">
                    <img src="http://bobao.360.cn/img/app.jpeg"/>
                    <img src="http://bobao.360.cn/img/weixin.jpeg"/>
                </p>
                                <p>本文由 安全客 原创发布，如需转载请注明来源及本文地址。<br/>本文地址：http://bobao.360.cn/learning/detail/3019.html
                </p>
                            </div>
            <div style="margin-top: 20px;background-color:#FFFFFF">
    <input type="hidden" id="detail_title" name="detail_title" value="【技术分享】最新2016华山杯CTF writeup - 安全客 - 有思想的安全新媒体" />
    <input type="hidden" id="use_nickname" name="use_nickname" value="0" />
    <a name="mao"></a>
    <div class="reg-log mobile-hiden">
        <div class="" id="userTo">   
            <div id="to-list" class="input-text" style="">
                <textarea disabled="disabled" class="hide"  id="comment-content" to="to"></textarea>
                <ul id="preadded" style="display:none">       
                </ul>
                <div id="to-auto" style="width: 200px">
                    <ul id="feed">
                    </ul>
                </div>
            </div>
        </div>
        <input type="hidden" id="source-id" value="3019" />
        <input type="hidden" id="source-type" value="learning" />
        <input type="hidden" id="post-comment-url" value="/comment/add" />
        <input type="hidden" id="post-nickname-url-ajax" value="/comment/randnicknameajax" />
        <input type="hidden" id="post-check-login-url-ajax" value="/comment/checklogin" />
        <input type="hidden" id="stoken_comment_set" value="ea3898fb4df38673fdeb61c458234054">                 <span class="join">参与讨论，请先 <a href="javascript:;" class="comment-login">登录</a> | <a href="javascript:;" class="comment-reg">注册</a> |  <a href="javascript:;" class="anonymous-comment">匿名评论</a></span>
            </div>
    <div class="mobile-hide" style="width: 870px; margin: 0 auto;">
        <label style="vertical-align:middle;" for="use_nickname">匿名</label> 
        <input style="vertical-align:middle;" id="trigger-nickname" name="use_nickname" class="use_nickname" type="checkbox" value="0" />

        <a href="javascript:;" class="apply-use button" id="submit-comment" data-target="/comment/add">发布</a>
    </div>


    <div class="clearfix"></div>
    <div class="comments">
        <div class="comments-head">
            <span class="title">用户评论</span>
        </div>
                <div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/11x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="14632" user-name="darmao" href="javascript:;">
                darmao            </a>
                        <span class="comment-time">2017-06-16 19:02:18</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="14632">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_14632" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">安卓第一题，可以直接用个toast直接把正确的注册码弹出来。</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/10x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="167838976" class="response" data-bind-id="167838976" data-target="5468" user-name="大表哥" href="javascript:;">
                大表哥            </a>
                        <span class="comment-time">2016-10-23 11:55:20</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="167838976" data-target="5468">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_5468" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">脑洞够大</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/10x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="2753148133" class="response" data-bind-id="2753148133" data-target="4178" user-name="360U2753148133" href="javascript:;">
                360U2753148133            </a>
                        <span class="comment-time">2016-09-12 18:35:07</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="2753148133" data-target="4178">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_4178" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">有视频吗</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/4x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="4177" user-name="helen的小弟" href="javascript:;">
                helen的小弟            </a>
                        <span class="comment-time">2016-09-12 16:57:03</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="4177">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_4177" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">233那题，记事本保存成Unicode格式的就可以了</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>

        <a class="more-long comment-more" href="javascript:;" data-target="/comment/more" data-type="learning" data-source-id="3019" data-page="2">查看更多</a>
            </div>
</div>
<script>
    $(function () {
        $('.anonymous-comment').click(function () {
            $(".join").hide();
            $(".reg-log textarea").first().removeAttr("disabled").show();
            $('#use_nickname').val('1');
//            $('#trigger-nickname').attr('checked', true);
            $('#trigger-nickname').trigger('click');
        });
        //为所有复选框绑定事件
//        checkbox_on_click();
        //ajax随机获取昵称
//        randnicknameajax(0);
        //ajax检测登录状态
        comment_check_login();
    });



    function input_checkbox(flag) {
        $('input:checkbox').each(function () {
            var value = flag ? 1 : 0;
            $(this).prop('checked', flag);
            $(this).val(value);
        });
    }

//ajax随机获取昵称
    function randnicknameajax(flag) {
        $.ajax({
            type: 'POST',
            url: $('#post-nickname-url-ajax').val(),
            data: {limit: 1, flag: flag},
            dataType: "json",
            success: function (data) {
                $('#nick-name').val(data.data[0]);
                _nick_name=data.data[0];
            }
        });
    }
    $();
//ajax检测登录状态
    function comment_check_login() {
        $.ajax({
            type: 'POST',
            url: $('#post-check-login-url-ajax').val(),
            data: {},
            dataType: "json",
            success: function (data) {
                if (data.success) {
                    $('.join').hide();
                    $(".reg-log textarea").first().removeAttr("disabled").show();
                    $("#span_use_nickname").show();
                    $('#use_nickname').val('0');
                    $('#use_nickname').attr('checked', false);
                }
            }
        });
    }
</script>        </div>
    </div>
    <div class="side-bar">
        <div class="mod hot-news">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-hot"></i><span>热门知识</span></h2>
    </div>
    <ul class="links-list">
                                <li><a href="/learning/detail/4411.html" alt="【漏洞预警】一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现——最新的Office高级威胁攻击预警" target="_blank">【漏洞预警】一个换行符引发的奥斯卡...</a></li>
                                <li><a href="/learning/detail/4416.html" alt="【漏洞预警】Microsoft .NET Framework漏洞（CVE–2017–8759）预警" target="_blank">【漏洞预警】Microsoft .NE...</a></li>
                                <li><a href="/learning/detail/4414.html" alt="【技术分享】妙用JavaScript绕过XSS过滤" target="_blank">【技术分享】妙用JavaScrip...</a></li>
                                <li><a href="/learning/detail/4418.html" alt="【技术分享】利用威胁情报数据平台拓展APT攻击线索一例" target="_blank">【技术分享】利用威胁情报数据平台拓...</a></li>
                                <li><a href="/learning/detail/4417.html" alt="【知识】9月15日 - 每日安全知识热点" target="_blank">【知识】9月15日 - 每日安全知识热...</a></li>
                                <li><a href="/learning/detail/4425.html" alt="【安全报告】XShellGhost事件技术回顾报告" target="_blank">【安全报告】XShellGhost事件...</a></li>
            </ul>
</div>        <!-- 友情链接 -->
        <div class="mod blog-links mobile-hide">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-link"></i><span>友情链接</span></h2>
        <a href="/links/index.html" class="more">更多<i></i></a>
    </div>
        <ul class="links-list">
                <li><a href="http://bbs.360safe.com" alt="360安全社区" target="_blank">360安全社区</a></li>
                <li><a href="http://zhuji.360.cn" alt="360主机卫士" target="_blank">360主机卫士</a></li>
                <li><a href="http://blogs.360.cn/" alt="奇虎360技术博客" target="_blank">奇虎360技术博客</a></li>
                <li><a href="http://wangzhan.360.cn/" alt="360网站卫士" target="_blank">360网站卫士</a></li>
                <li><a href="http://webscan.360.cn/" alt="360网站安全检测" target="_blank">360网站安全检测</a></li>
                <li><a href="http://research.360.cn/report/" alt="360研究报告" target="_blank">360研究报告</a></li>
                <li><a href="http://unicorn.360.cn/" alt="360 Unicorn Team" target="_blank">360 Unicorn Team</a></li>
                <li><a href="http://appscan.360.cn/" alt="360捉虫猎手" target="_blank">360捉虫猎手</a></li>
                <li><a href="https://threathunter.org/" alt="ThreatHunter社区" target="_blank">ThreatHunter社区</a></li>
                <li><a href="http://security.360.cn/" alt="360安全应急响应中心" target="_blank">360安全应急响应中心</a></li>
            </ul>
    </div>
        <!-- 联系我们 -->
        <div class="mod contact mobile-hide" style="text-align:center">
    <div class="head-bar clearfix">
        <h2><i></i><span>关注我们</span></h2>
    </div>
    <!-- 微信关注 -->
    <ul class="contact-way">
        <li><a>微信关注</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/qrcode_adlab_weixin.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
    <!-- APP下载 -->
    <ul class="contact-way">
        <li><a>安全播报APP</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/scan_code_big.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
</div>

    </div>
</div>

<script type="text/javascript" src="/js/jquery-ui.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/jquery.noty.packaged.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/common.js?v=4.5"></script>
<script>$(function() {sync_count('comment');});</script>


<!-- 语法高亮 -->
<script type="text/javascript" src="/ue/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">SyntaxHighlighter.all();sync_count('vul');sync_count('news');sync_count('learning');sync_count('activity');sync_count('course');sync_count('ctf');</script>
    </div>

        <div class="footer">
        <div class="friend-link">
            <a href="http://www.360.cn/" target="_blank">360首页</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">关于我们</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">联系我们</a>
            <span>|</span>
            <a href="/links/index.html" target="_blank">友情链接</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">招贤纳士</a>
        </div>
        <div class="copy">
            Copyright &copy; 360网络攻防实验室 All Rights Reserved <span class="copy_icp">京ICP证080047号[京ICP备08010314号-6]</span>
        </div>
    </div>
    
</div>

<!--奇舞团统计-->

<script src='https://s.ssl.qhimg.com/static/f5407c785655e6a1/monitor_analytic.js'></script>
<script>
    monitor.setProject('QH_171_1').getTrack().getClickAndKeydown().getClickHeatmap(10, 1);
</script>

<div class="hide">
    <script src="https://s95.cnzz.com/z_stat.php?id=1253147824&web_id=1253147824" language="JavaScript"></script>
</div>
<div class="backToTop_wrap off">
    <a id="back_to_top" class="backToTop" href="javascript:;" title="返回顶部"></a>
</div>
<script>
    var $backToTop_wrap = $(".backToTop_wrap"),
        $backToTop_btn = $("#back_to_top");

    if ($(window).scrollTop() > 100) {
        $backToTop_wrap.removeClass("off");
    }
    else {
        $backToTop_wrap.addClass("off");
    }

    $(window).on("scroll", function () {
        if ($(this).scrollTop() > 100) {
            $backToTop_wrap.removeClass("off");
        }
        else {
            $backToTop_wrap.addClass("off");
        }
    });

    $backToTop_btn.on("click", function () {
        $("html, body").animate({scrollTop: 0}, 120);
    });

    $(function () {
        var navlist = $('.nav-list > li');

        navlist.each(function () {
            $(this).on('mouseenter', function () {
                $(this).addClass('selected');
            });

            $(this).on('mouseleave', function () {
                $(this).removeClass('selected');
            });
        });
    })
</script>



</body>
</html>
