<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:wb="http://open.weibo.com/wb" xml:lang="en" lang="en">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <link rel="shortcut icon" href="http://bobao.360.cn/favicon.ico?v=1.1"/>
    <link rel="alternate" title="安全资讯" href="/rss?type=news" type="application/rss+xml"/>
    <link rel="alternate" title="安全知识" href="/rss?type=learning" type="application/rss+xml"/>
    <link rel="alternate" title="安全圈活动" href="/rss?type=activity" type="application/rss+xml"/>
    <link rel="alternate" title="所有漏洞" href="/rss?type=vul" type="application/rss+xml"/>
    <link rel="alternate" title="通用型漏洞" href="/rss?type=commonvul" type="application/rss+xml"/>
    <link rel="alternate" title="事件型漏洞" href="/rss?type=eventvul" type="application/rss+xml"/>
    <link rel="alternate" title="热门漏洞" href="/rss?type=hotvul" type="application/rss+xml"/>

        <title>解密BBOSS组织：全球超十二万站点的地下掌控者 - 安全客 - 有思想的安全新媒体</title>
    
        <meta name="keywords" content="解密,BBOSS组织,全球,超十二万,站点,地下,掌控者"/>
    
        <meta name="description" content="每一天我们都在疑惑,疑惑我们所处的世界,疑惑这个世界呈现出的不断超出我们认知的事物。每一天我们又都在惊喜,惊喜的是不断的新的认知,总能让我们短暂地认为,似乎又更理解了这个世界"/>
        <meta property="wb:webmaster" content="224437c7be31d633"/>

    <script type="text/javascript" src="http://s7.qhimg.com/!56caa871/xpc_sync_height.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/reset.css" />
    <link rel="stylesheet" type="text/css" href="/css/common_new.css?v=4.4.2.1" />
    <link rel="stylesheet" type="text/css" href="/css/jquery.notyfy.css" />
    <link rel="stylesheet" type="text/css" href="/css/notyfy.theme.default.css" />
    <link rel="stylesheet" type="text/css" href="/css/s_common.css?v=2.2.7" media="only screen and
    (max-device-width:900px), only screen and (max-width:900px)" />
    <script type="text/javascript" src="/js/jquery.min.js?v=3.1"></script>
    <script type="text/javascript" src="/js/jquery.notyfy.js"></script>
    <script type="text/javascript" src="/js/iscroll.js"></script>
    <script src="http://js.passport.qihucdn.com/5.0.3.js"></script>
    <script type="text/javascript">
        var myScroll, myNavScroll;

        function iscrollLoaded() {
            myScroll = new IScroll('#wrapper',
                {
                    scrollX: true,
                    scrollY: false,
                    bounceEasing: 'circular',
                    eventPassthrough: true,
                    preventDefault: false,
                    bounceTime: 500
                }
            );
        }

        $(function () {

            //导航横向滚动


            function setNavWidth() {

                /* 计算导航宽度 */
                var allWidth = $(window).width();
                var scroller = $('#scroller');

                if (allWidth > 900) {
                    scroller.find('ul').add(scroller.find('.scroll')).removeAttr('style');
                    scroller.css('overflow', 'visible');
                    if (myNavScroll) myNavScroll.destroy();
                } else {

                    var width = 0;
                    scroller.find('.scroll').children('ul').children('li').each(function (index, el) {
                        if (!$(this).hasClass('mobile-hide')) {
                            width += $(this).outerWidth();
                        }
                    });
                    scroller.find('ul').add(scroller.find('.scroll')).width(width);

                    if (myNavScroll) myNavScroll.destroy();

                    myNavScroll = new IScroll('#scroller', {
                        scrollX: true,
                        scrollY: false,
                        momentum: false,
                        click: true
                    });

                }

            }

            setNavWidth();
            $(window).resize(function (event) {
                setNavWidth();
            });

        });

    </script>
</head>
<body onload="iscrollLoaded();">
<div style='margin:0 auto;width:0px;height:0px;overflow:hidden;'>
    <img src=""/>
</div>

<div id="is-mobile"></div>
<div class="container">
        <div class="mobile-header">
        <div class="header clearfix">
            <div class="header-wrapper clearfix">
                <a href="/index/index" class="logo"><img class="slogan" src="/img/logo.png?v=1.5"/></a>
                                <form id="search" class="search-box" action="/search/index" method="GET">
                    <input class="keys" name="keywords" type="text" placeholder="搜索漏洞" required="required">
                    <input class="icon" type="submit" value="">
                    <input type="hidden" name="type" value=""/>
                </form>
                <div class="bug">
                    <div class="name"><span class="seled">全部</span><i class="arrow"></i></div>
                    <ul class="typelist">
                        <li data-index="3"><a href="javascript:void(0);">全部</a></li>
                        <li data-index="0"><a href="javascript:void(0);">漏洞</a></li>
                        <li data-index="1"><a href="javascript:void(0);">资讯</a></li>
                        <li data-index="2"><a href="javascript:void(0);">知识</a></li>
                    </ul>
                </div>
                                <div class="logNreg mobile-hide">
                    <div class="unlog">
                        <i></i>
                        <a href="log.html" class="log">登录</a>
                        <span>|</span>
                        <a href="reg.html" class="reg">注册</a>
                    </div>
                    <div class="loged">
                        <a href="/member/profile" class="user-center"><i></i><span class="user-name-tag">个人中心</span></a>
                        <div class="user-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting"><a href="http://i.360.cn/profile/accountmanage"
                                                               target="_blank"><i></i><span>账号设置</span></a></li>
                                <li class="alert-setting"><a href="/keywords/index"
                                                             target="_blank"><i></i><span>告警设置</span></a></li>
                                <li class="bug-alert"><a href="/myalarm/index" target="_blank"><i></i><span>漏洞告警</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mylearn/index" target="_blank"><i></i><span>我的知识</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mycourse/index" target="_blank"><i></i><span>我的课堂</span></a>
                                </li>
                                <li class="my-exit"><a
                                            href="http://login.360.cn/?src=pcw_adlab&op=logout&destUrl=http://bobao.360.cn"><i></i><span>退出系统</span></a>
                                </li>
                            </ul>
                        </div>

                        <a href="/message" class="message-center" target="_blank"><i></i><span>我的消息</span></a>
                        <div class="message-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting" style="display:none;"><a href="/myres/index"
                                                                                     target="_blank"><i></i><span>回复我的</span></a>
                                </li>
                                <li class="my-bug"><a href="/myvul/index"
                                                      target="_blank"><i></i><span>我的漏洞</span></a></li>
                                <!--<li class="my-bug"><a href="/myres/index" target="_blank"><i></i><span>我的评论</span></a></li>-->
                                <!--<li class="alert-setting"><a href="###" target="_blank"><i></i><span>提到我的</span></a>
                                </li>-->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <style type="text/css">
            .nav {
                overflow: hidden;
            }

            .nav .scroll {
                width: auto;
            }
        </style>
        <div id="wrapper">
            <div id="scroller" class="nav">
                <div class="scroll">
                    <ul class="nav-list">
                        <li ><a class="link-nav"
                                                                                 href="/index/index">首页</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/vul/index">漏洞</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/introduce/list">招聘</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/news/index">资讯</a><!--<i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/introduce/list">招聘</a></li>
                        </ul>
			-->
                        </li>
                        <li class="cur">
                        <a class="link-nav" href="/learning/index">知识</a><i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/course/index">学院</a></li>
                        </ul>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/activity/index">活动</a></li>
                        <li class="mobile-hide "><a class="link-nav"
                                                                                                   href="/ctf/index">CTF训练营</a>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/interref/list">安全内参</a></li>
                        <li ><a class="link-nav" href="/app/index">APP</a></li>

                        <!--<li ><a href="/course/index">学院</a></li>-->
                        <!--<li ><a href="/introduce/list">招聘</a></li>-->
                        <!--<li  class="mobile-hide"><a href="/ctf/index">CTF训练营</a></li>-->
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="mobile-content">
        <link rel="stylesheet" type="text/css" href="/css/news.css?v=3.5" />
<link rel="stylesheet" type="text/css" href="/ue/SyntaxHighlighter/shCoreDefault.css?v=1.0" />
<style>
    p .syntaxhighlighter {
        width: 80%;
    }
</style>

<div class="cur-pos w1000">当前位置：<a href="http://bobao.360.cn/">安全客</a> &gt;&gt; 知识详情</div>

<div class="content clearfix">
    <div class="main">
        <div class="article">
            <div id="article_box">
                <h2>解密BBOSS组织：全球超十二万站点的地下掌控者</h2>
                <div class="article-msg">
                    <span class="time">2016-01-19 10:16:05</span>
                                        <span class="read">阅读：5119次</span>
                    <span><a style="display: none;" class="good" href="javascript:;"
                             data-target="/learning/good" data-value="g_2573"
                             data-type="learning">点赞(0)</a></span>
                    <span><a class="fav" href="javascript:;" data-target="/mylearning/add"
                             data-pk="2573" data-type="learning">收藏</a></span>
                                        <span><a style="margin-left: 4px;" class="fav" href="http://www.freebuf.com/articles/system/93491.html?from=groupmessage&amp;isappinstalled=0"
                             target="_blank">来源： FREEBUF</a></span>
                    
                                    </div>
                <hr size="1">
                <div class="article-msg">
                    <p><!-- JiaThis Button BEGIN -->

<!--
<span class="jiathis_style"><span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_tsina"></a>
    <a class="jiathis_button_tqq"></a>
    <a class="jiathis_button_qzone"></a>
    <a class="jiathis_button_renren"></a>
    <a class="jiathis_button_xiaoyou"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
</span>

-->
</p>
                </div>
                <p><p style="text-align:center"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(0, 176, 80);"><strong style="box-sizing: border-box; font-weight: 700; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; line-height: 24px;"><img alt="http://p2.qhimg.com/t01dc0a33e386790de9.jpg" src="http://p2.qhimg.com/t01dc0a33e386790de9.jpg" title="t01dc0a33e386790de9.jpg"/></span></strong></span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); line-height: 22px;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(0, 176, 80);"><strong style="box-sizing: border-box; font-weight: 700; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; line-height: 24px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;每一天我们都在疑惑,疑惑我们所处的世界,疑惑这个世界呈现出的不断超出我们认知的事物。每一天我们又都在惊喜,惊喜的是不断的新的认知,总能让我们短暂地认为,似乎又更理解了这个世界。疑惑与惊喜的交织,似乎是对人类最好的诱惑,驱使着我们一直探索。未知到已知的转换,似乎是我们认知世界唯一的途径。</span><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; line-height: 24px;">永远令人着迷的不是未知,而是下一个未知。</span></strong></span></p><p style="box-sizing: border-box; margin: 10px 0px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: normal; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(38, 38, 38);"><strong style="box-sizing: border-box; font-weight: 700; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;报告楔子</strong></span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); line-height: 22px;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;还记得2015年年末基于TelsaCrypt变种(VVV病毒)猖獗的勒索攻击吗?</span><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; line-height: 22px;">阿里安全威胁情报中心监测到大量来自邮件的此类攻击,同时在调查中发现有客户未收到邮件也受到了勒索软件的攻击。进一步跟踪调查发现客户是访问了被挂马网站导致感染。</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;基于发现的挂马指纹在全球范围内做指纹探测,发现互联网上具有同样特征的网站总计超过12万,深入地调查了此次事件,我们注意到该事件背后程序架构体系已经非常完善,达工业化水准。基于从代码结构中发现的BASE层和 BOSS层信息,故将其命名为BBOSS组织(事件)。</span></p><p style="box-sizing: border-box; margin: 15px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(38, 38, 38);"><strong style="box-sizing: border-box; font-weight: 700; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2. 全球影响</strong></span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;根据截至1月13日全网监测数据显示,BBOSS组织在最近三个月内呈显性活跃,入侵控制网站的规模也不断扩张。这些被控制的站点以欧美地区为主,亚非地区目前相对较少, 但已经呈蔓延趋势。</span></p><p style="text-align: center;"><a href="http://image.3001.net/images/20160118/14531257157814.png" target="_blank" style="box-sizing: border-box; color: rgb(6, 154, 239); text-decoration: underline; background-position: 0px 0px;"><img data-original="http://image.3001.net/images/20160118/14531257157814.png!small" src="http://p8.qhimg.com/t017da870b536788b7e.jpg" style="box-sizing: border-box; border: 0px none; vertical-align: middle; max-width: 100%; display: inline; float: none;"/></a></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: center;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">图 1 BBOSS全球威胁态势</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;受灾最为严重的为美国,比例高达30%,其次为欧洲各国,亚洲国家中韩国排列第一,占到4%,而南美、非洲、澳洲占比最小。</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: left;"><br/></p><p style="text-align: center;"><a href="http://image.3001.net/images/20160118/14531257289901.png" target="_blank" style="box-sizing: border-box; color: rgb(6, 154, 239); text-decoration: underline; background-position: 0px 0px;"><img data-original="http://image.3001.net/images/20160118/14531257289901.png!small" src="http://p8.qhimg.com/t0108d495bcd07a3ba5.jpg" style="box-sizing: border-box; border: 0px none; vertical-align: middle; max-width: 100%; display: inline; float: none;"/></a></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: center;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">图 2 BBOSS威胁全球分布</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(0, 112, 192);"><strong style="box-sizing: border-box; font-weight: 700; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.1.&nbsp;影响站点和软件</strong></span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; line-height: 22px; text-indent: 40px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;受感染的网站数量全球范围内超过12万个,其中约78%都使用了开源CMS框架,以Wordpress和Jommla 为主,尤其是Wordpress,占比高达57%。</span></p><p style="text-align: center;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;"><a href="http://image.3001.net/images/20160118/14531258616640.png" target="_blank" style="box-sizing: border-box; color: rgb(6, 154, 239); text-decoration: underline; background-position: 0px 0px; background-repeat: initial initial;"><img data-original="http://image.3001.net/images/20160118/14531258616640.png!small" src="http://p6.qhimg.com/t012e3051d937579402.jpg" style="box-sizing: border-box; border: 0px none; vertical-align: middle; max-width: 100%; display: inline; float: none;"/></a></span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: center;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">图 3 BBOSS 影响软件比例(\N表示无任何CMS软件)</span></p><p style="box-sizing: border-box; margin: 15px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(38, 38, 38);"><strong style="box-sizing: border-box; font-weight: 700; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3. BBOSS技术体系</strong></span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;控制超过12万的网站,BBOSS背后的技术体系也极其完善,可以看到该组织为了更高效掌控和易隐藏,使用了多层架构,目前已形成控制超大规模集群肉鸡网站的能力。</span></p><p style="text-align: center;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;"><a href="http://image.3001.net/images/20160118/14531259894761.png" target="_blank" style="box-sizing: border-box; color: rgb(6, 154, 239); text-decoration: underline; background-position: 0px 0px; background-repeat: initial initial;"><img data-original="http://image.3001.net/images/20160118/14531259894761.png!small" src="http://p8.qhimg.com/t016a3777a3e21cd063.jpg" style="box-sizing: border-box; border: 0px none; vertical-align: middle; max-width: 100%; display: inline; float: none;"/></a></span></p><p><br/></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: center;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">图 4 BBOSS系统技术体系</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; text-indent: 28px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BBOSS技术体系中,大致分为4层,分别是JS层,BASE层,KEEPER层和BOSS层。每一层的肉鸡分工明确,配合密切。JS层为直接接触用户的站点,页面中嵌入了js,构造请求转发流量到BASE层。BASE层会向BOSS层请求指令,完成校验后BOSS层根据当前需要进行的攻击返回攻击指令,再由BASE层下发给用户。同时,KEEPER层会定期对JS层和BASE层站点进行探测存活、增删修改、漏洞利用等操作。</span></p><p style="text-align: center;"><a href="http://image.3001.net/images/20160118/14531259975704.png" target="_blank" style="box-sizing: border-box; color: rgb(6, 154, 239); text-decoration: underline; background-position: 0px 0px;"><img data-original="http://image.3001.net/images/20160118/14531259975704.png!small" src="http://p4.qhimg.com/t016b5b34f0876a3669.jpg" style="box-sizing: border-box; border: 0px none; vertical-align: middle; max-width: 100%; display: inline; float: none;"/></a></p><p><br/></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: center;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">图 5 BBOSS分层关系</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(0, 112, 192);"><strong style="box-sizing: border-box; font-weight: 700; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.1.&nbsp;JS层分析</strong></span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; text-indent: 28px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JS层受感染的网站数量全球范围内有10万个左右,这一层站点约85%都使用了开源CMS框架,其中以Wordpress占比63%,Jommla占比10%。</span></p><p style="text-align: center;"><a href="http://image.3001.net/images/20160118/145312603020.png" target="_blank" style="box-sizing: border-box; color: rgb(6, 154, 239); text-decoration: underline; background-position: 0px 0px;"><img data-original="http://image.3001.net/images/20160118/145312603020.png!small" src="http://p5.qhimg.com/t0139c65128f8718d62.jpg" style="box-sizing: border-box; border: 0px none; vertical-align: middle; max-width: 100%; display: inline; float: none;"/></a></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: center;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">图 6 JS层站点CMS比例(\N表示无任何CMS软件)</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; text-indent: 28px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在近日,我们也关注到PaloAlto Netwokrs公布的报告「Angler Exploit Kit Continues to Evade Detection: Over 90,000 Websites Compromised」,对其公布的数据进行比对,发现仅11863个域名匹配,这些网站具备弱密码或通用型漏洞,易被入侵,这和本次事件中在这些网站上发现多种不同类型的webshell的证据吻合。</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: left;"><br/></p><p style="text-align: center;"><a href="http://image.3001.net/images/20160118/14531260467069.png" target="_blank" style="box-sizing: border-box; color: rgb(6, 154, 239); text-decoration: underline; background-position: 0px 0px;"><img data-original="http://image.3001.net/images/20160118/14531260467069.png!small" src="http://p1.qhimg.com/t01e3513a7700187037.jpg" style="box-sizing: border-box; border: 0px none; vertical-align: middle; max-width: 100%; display: inline; float: none;"/></a></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: center;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">图 7 JS层webshell之一</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; text-indent: 28px;">JS层站点受感染的特征表现为,其框架head.php内均被嵌入了恶意js,导致访问网站所有页面时都会带有该script。基于wordpress的网站主要是通过webshell在其主题的/wp-content/themes/twentyfourteen/header.php中插入,而基于Jommla的主要通过在/libraries/joomla/document/html/renderer/head.php中来插入。</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: left;"><br/></p><p style="text-align: center;"><a href="http://image.3001.net/images/20160118/14531260595647.png" target="_blank" style="box-sizing: border-box; color: rgb(6, 154, 239); text-decoration: underline; background-position: 0px 0px;"><img data-original="http://image.3001.net/images/20160118/14531260595647.png!small" src="http://p7.qhimg.com/t01c0f4e4c20e993361.jpg" style="box-sizing: border-box; border: 0px none; vertical-align: middle; max-width: 100%; display: inline; float: none;"/></a></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: center;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">图 8 修改header.php</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; text-indent: 28px;">恶意js代码如下,提取了当前页title、referer、host信息,构造请求后发往BASE层域下的jquery.min.php文件。</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: left;"><br/></p><p style="text-align: center;"><a href="http://image.3001.net/images/20160118/14531260701941.png" target="_blank" style="box-sizing: border-box; color: rgb(6, 154, 239); text-decoration: underline; background-position: 0px 0px;"><img data-original="http://image.3001.net/images/20160118/14531260701941.png!small" src="http://p5.qhimg.com/t018802be24138feca5.jpg" style="box-sizing: border-box; border: 0px none; vertical-align: middle; max-width: 100%; display: inline; float: none;"/></a></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: center;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">图 9 JS层恶意代码</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; text-indent: 28px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KEEPER层会不定期更新JS层站点的header.php 中的植入js,同测试发现其带有一定对抗能力。当模拟一个JS层站点对BASE层站点进行请求测试时,如果被检测出是模拟测试,该JS层站点下所植入的恶意js会被暂时性清除几天。</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><strong style="box-sizing: border-box; font-weight: 700; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(0, 112, 192);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.2.&nbsp;BASE层分析</span></strong></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; text-indent: 28px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;与JS层相同,BASE层依然是大量被入侵控制的站点,BASE层受感染数量与JS层受感染数量大致为1:5的关系。与JS层不同的是,这一层的站点不再是以CMS为主,85%站点均未使用任何CMS,并且处于中国地区的站点极少,这类站点以IIS,Apache偏多,也存在少量Nginx站点。</span></p><p style="text-align: center;"><a href="http://image.3001.net/images/20160118/14531260905314.png" target="_blank" style="box-sizing: border-box; color: rgb(6, 154, 239); text-decoration: underline; background-position: 0px 0px;"><img data-original="http://image.3001.net/images/20160118/14531260905314.png!small" src="http://p3.qhimg.com/t01228e47f011689054.jpg" style="box-sizing: border-box; border: 0px none; vertical-align: middle; max-width: 100%; display: inline; float: none;"/></a></p><p><br/></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: center;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">图 10 BASE层站点CMS比例</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; text-indent: 28px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;可以看到以往的攻击在这一层就直接开始植入恶意载荷了,但BBOSS不是,BASE这一层仍然只是中间跳板。BASE层站点表现的特征为,被入侵后会在网站目录下放置js/jquery.min.php和js/jquery-1.9.1.min.php两个文件。这两个文件使用障眼法,让用户误以为是jquery相关的jquery.min.js及jquery-1.9.1.min.js。</span></p><p style="text-align: center;"><a href="http://image.3001.net/images/20160118/14531260984729.png" target="_blank" style="box-sizing: border-box; color: rgb(6, 154, 239); text-decoration: underline; outline: 0px none; background-position: 0px 0px;"><img data-original="http://image.3001.net/images/20160118/14531260984729.png!small" src="http://p5.qhimg.com/t015532d3e2420f1465.jpg" style="box-sizing: border-box; border: 0px none; vertical-align: middle; max-width: 100%; display: inline; float: none;"/></a></p><p><br/></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: center;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">图 11 BASE层恶意样本</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; text-indent: 28px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;按图索骥,拿到了jquery.min.php样本,揭开了其神秘的面纱。代码中使用了加密和混淆,解密后看到其封装了BossAPI类,该类实现了向后端BOSS层的C&amp;C的通信,并解析响应结果的功能。</span></p><p style="text-align: center;"><a href="http://image.3001.net/images/20160118/14531261143011.png" target="_blank" style="box-sizing: border-box; color: rgb(6, 154, 239); text-decoration: underline; background-position: 0px 0px;"><img data-original="http://image.3001.net/images/20160118/14531261143011.png!small" src="http://p3.qhimg.com/t014acf7d5a3b4412a8.jpg" style="box-sizing: border-box; border: 0px none; vertical-align: middle; max-width: 100%; display: inline; float: none;"/></a></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: center;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">图 12 BossAPI类</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; text-indent: 28px;">主程序部分包含3个流程,若GET请求参数为空,构造同域名下随机页面,访问并404返回。</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: left;"><br/></p><p style="text-align: center;"><a href="http://image.3001.net/images/20160118/14531261265829.png" target="_blank" style="box-sizing: border-box; color: rgb(6, 154, 239); text-decoration: underline; background-position: 0px 0px;"><img data-original="http://image.3001.net/images/20160118/14531261265829.png!small" src="http://p4.qhimg.com/t01a8f1daafdb376b5e.jpg" style="box-sizing: border-box; border: 0px none; vertical-align: middle; max-width: 100%; display: inline; float: none;"/></a></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: center;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">图 13 GET为空</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; text-indent: 28px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c_utm流程用于接收来自JS层构造的请求,并随机转发给BOSS层的4台C&amp;C,C&amp;C会根据请求中的参数,下发恶意指令。</span></p><p style="text-align: center;"><a href="http://image.3001.net/images/20160118/14531261363357.png" target="_blank" style="box-sizing: border-box; color: rgb(6, 154, 239); text-decoration: underline; background-position: 0px 0px;"><img data-original="http://image.3001.net/images/20160118/14531261363357.png!small" src="http://p9.qhimg.com/t01b4194a6a5aba8e62.jpg" style="box-sizing: border-box; border: 0px none; vertical-align: middle; max-width: 100%; display: inline; float: none;"/></a></p><p><br/></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: center;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">图 14 c_utm流程</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; text-indent: 28px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pi流程主要用于接收来自KEEPER层的流量,并转发给BOSS层C&amp;C来校验,用于判定BASE层是否存活以及是否是伪造。</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: left;"><br/></p><p style="text-align: center;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;"><a href="http://image.3001.net/images/20160118/14531261497700.png" target="_blank" style="box-sizing: border-box; color: rgb(6, 154, 239); text-decoration: underline; background-position: 0px 0px; background-repeat: initial initial;"><img data-original="http://image.3001.net/images/20160118/14531261497700.png!small" src="http://p3.qhimg.com/t0142d9558926dfa1d6.jpg" style="box-sizing: border-box; border: 0px none; vertical-align: middle; max-width: 100%; display: inline; float: none;"/></a></span></p><p><br/></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: center;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">图 15 pi流程</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; text-indent: 28px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;同时,发现BASE层同BOSS层的通信同样也存在一定的反侦查策略。另外代码中还自带了xor加密解密类,但目前尚未在主程序中使用。</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(0, 112, 192);"><strong style="box-sizing: border-box; font-weight: 700; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.3.&nbsp;BOSS层分析</strong></span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; text-indent: 28px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;与前面两层不同,BOSS层受感染的机器数量要小得多。截止目前,通过分析多个从BASE层采集到的jquery.min.php及jquery.1.9.1.min.php样本,获得了4个活跃的BOSS层C&amp;C IP,以及一个闲置的IP。这5个IP的近期流量趋势如下:</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: left;"><br/></p><p style="text-align: center;"><a href="http://image.3001.net/images/20160118/14531261879084.png" target="_blank" style="box-sizing: border-box; color: rgb(6, 154, 239); text-decoration: underline; background-position: 0px 0px;"><img data-original="http://image.3001.net/images/20160118/14531261879084.png!small" src="http://p4.qhimg.com/t01621bcb1ecc81d78b.jpg" style="box-sizing: border-box; border: 0px none; vertical-align: middle; max-width: 100%; display: inline; float: none;"/></a></p><p><br/></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: center;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">图 16 BOSS层流量趋势</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; text-indent: 28px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;有意思的是,这5个ip分属不同的5个国家,分别是美国、俄罗斯、立陶宛、法国和印度尼西亚,这些独立IP同样也都是入侵而来。根据我们的数据显示,2015年11月其身影出现在了VVV勒索攻击中,以及一些恶意推广。</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: left;"><br/></p><p style="text-align: center;"><a href="http://image.3001.net/images/20160118/145312619545.png" target="_blank" style="box-sizing: border-box; color: rgb(6, 154, 239); text-decoration: underline; background-position: 0px 0px;"><img data-original="http://image.3001.net/images/20160118/145312619545.png!small" src="http://p4.qhimg.com/t011842cab47589beca.jpg" style="box-sizing: border-box; border: 0px none; vertical-align: middle; max-width: 100%; display: inline; float: none;"/></a></p><p><br/></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: center;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">图 17 BOSS层下发的恶意js</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; text-indent: 28px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;只有当需要攻击的时候BOSS层才会下发攻击指令,而平时只会下发重定向请求重定向到Google首页。</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: left;"><br/></p><p style="text-align: center;"><a href="http://image.3001.net/images/20160118/14531262055108.png" target="_blank" style="box-sizing: border-box; color: rgb(6, 154, 239); text-decoration: underline; background-position: 0px 0px;"><img data-original="http://image.3001.net/images/20160118/14531262055108.png!small" src="http://p4.qhimg.com/t01c2e1392bf88ba564.jpg" style="box-sizing: border-box; border: 0px none; vertical-align: middle; max-width: 100%; display: inline; float: none;"/></a></p><p><br/></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: center;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">图 18 BOSS层下发的正常跳转</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(0, 112, 192);"><strong style="box-sizing: border-box; font-weight: 700; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.4.&nbsp;KEEPER层分析</strong></span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; text-indent: 28px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;除了上述几层,在BBOSS技术架构中,还有一层KEEPER层。截止目已发现多个KEEPER层IP,同样分布在不同国家。这一层肉鸡主要用于对JS层的webshell进行探活、增删修改JS层恶意js内容;对BASE层webshell、 juqery.min.php和jquery-1.9.1.min.php进行探活。同时,还会伴随有对JS层网站后台的暴力破解、弱口令猜解、插件漏洞利用、后台上传带后门插件等一系列入侵行为。对KEEPER层最为活跃的来自阿联酋的IP 85.**.**.78进行分析,其流量趋势如下:</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: left;"><br/></p><p style="text-align: center;"><a href="http://image.3001.net/images/20160118/14531262168879.png" target="_blank" style="box-sizing: border-box; color: rgb(6, 154, 239); text-decoration: underline; background-position: 0px 0px;"><img data-original="http://image.3001.net/images/20160118/14531262168879.png!small" src="http://p6.qhimg.com/t01547423378253236f.jpg" style="box-sizing: border-box; border: 0px none; vertical-align: middle; max-width: 100%; display: inline; float: none;"/></a></p><p><br/></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: center;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">图 19 某Zombie Keeper流量趋势</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; text-indent: 28px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;可以发现,该Zombie Keeper并不是每天都在工作,会阶段性的休息且每次休息间隔时间不同,由此推测Keeper是由攻击者主动启动而非定时自动启动。在1226-1229期间,甚至停止活动了4天。同时,对JS层的请求趋势与对BASE层的请求趋势基本相同。</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: left;"><br/></p><p style="text-align: center;"><a href="http://image.3001.net/images/20160118/14531262231194.png" target="_blank" style="box-sizing: border-box; color: rgb(6, 154, 239); text-decoration: underline; background-position: 0px 0px;"><img data-original="http://image.3001.net/images/20160118/14531262231194.png!small" src="http://p2.qhimg.com/t011228667561db4d9d.jpg" style="box-sizing: border-box; border: 0px none; vertical-align: middle; max-width: 100%; display: inline; float: none;"/></a></p><p><br/></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: center;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">图 20 某Zombie Keeper活跃时间矩阵分析</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; text-indent: 28px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;根据近一个月内该Zombie Keeper每天的活跃时间,绘制如上的时间矩阵图,横轴为日期,纵轴为小时。将不同天的数据重叠到一天,每个小时在不同天出现的次数越多,颜色越深,从而推断出攻击者每天最活跃时间为20点左右持续到次日早8点左右。显然攻击者不是处于UTC/GMT+8时区,经过不断变化时区来拟合数据,最终发现当采用UTC/GMT-5时区时,不仅最活跃时间符合作息规律,且其他所有数据也都惊人的吻合。</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: left;"><br/></p><p style="text-align: center;"><a href="http://image.3001.net/images/20160118/14531262402442.png" target="_blank" style="box-sizing: border-box; color: rgb(6, 154, 239); text-decoration: underline; background-position: 0px 0px;"><img data-original="http://image.3001.net/images/20160118/14531262402442.png!small" src="http://p8.qhimg.com/t01336d3a9b9a139fe3.jpg" style="box-sizing: border-box; border: 0px none; vertical-align: middle; max-width: 100%; display: inline; float: none;"/></a></p><p><br/></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255); text-align: center;"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">图 21 UTC/GMT-5时区</span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; text-indent: 28px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;这也印证了前文提到的该Zombie Keeper在1226-1229的停止活动行为,事实上或许是攻击者在UTC/GMT-5时区下1225-1228期间去圣诞度假了。</span></p><p style="box-sizing: border-box; margin: 15px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(38, 38, 38);"><strong style="box-sizing: border-box; font-weight: 700; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4. 自查方法</strong></span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(38, 38, 38);"><strong style="box-sizing: border-box; font-weight: 700; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 查看前台页面是否被插入如下类型或其它异常的JS代码;</strong></span></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><br/></p><p style="text-align: center;"><a href="http://image.3001.net/images/20160118/14531262536380.png" target="_blank" style="box-sizing: border-box; color: rgb(6, 154, 239); text-decoration: underline; background-position: 0px 0px;"><img data-original="http://image.3001.net/images/20160118/14531262536380.png!small" src="http://p6.qhimg.com/t018802be24138feca5.jpg" style="box-sizing: border-box; border: 0px none; vertical-align: middle; max-width: 100%; display: inline; float: none;"/></a></p><p><br/></p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2. 查看后台源码是否被修改,特别是上述框架文件;</p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3. 查看后台是否新增异常的源码文件,是否新增js目录及jquery.min.php等;</p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4. 查看站点访问记录是否存在暴力破解等异常访问。</p><p style="box-sizing: border-box; margin: 15px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: normal; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(38, 38, 38);"><strong style="box-sizing: border-box; font-weight: 700; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5. 修复建议</strong></span></p><p style="box-sizing: border-box; margin: 15px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: normal; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 审核是否有可疑的新增用户,修改站点密码;</p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2. 清除新增或修改的可疑代码;</p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3. 清理不再使用的插件,升级CMS及第三方插件到最新版本;</p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4. 增加如防暴力破解,WAF等安全防护措施;</p><p style="box-sizing: border-box; margin: 15px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(38, 38, 38);"><strong style="box-sizing: border-box; font-weight: 700; word-wrap: break-word; word-break: break-all; white-space: pre-wrap;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6. 总结</strong></span></p><p style="box-sizing: border-box; margin: 15px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;综合上述分析和数据,发现BBOSS组织有如下特点:</p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.控制超过12万网站,影响范围辐射全球;</p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.技术架构体系高度成熟,多级分层,更易控制和隐藏,有很强的攻防对抗意识;</p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.业务灵活,高可配置,不定期更新;</p><p style="box-sizing: border-box; margin: 0px 0px 10px; padding-bottom: 6px; word-wrap: break-word; word-break: break-all; white-space: pre-wrap; color: rgb(88, 88, 88); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 28px; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(255, 255, 255);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4.危害范围极大,影响数以千万互联网用户。</p></p>
                <hr/>
                <p style="text-align: center;">
                    <img src="http://bobao.360.cn/img/app.jpeg"/>
                    <img src="http://bobao.360.cn/img/weixin.jpeg"/>
                </p>
                                <p>本文转载自 FREEBUF<br/><a class="text-more" href="http://www.freebuf.com/articles/system/93491.html?from=groupmessage&amp;isappinstalled=0" target="_blank">原文链接：http://www.freebuf.com/articles/system/93491.html?from=groupmessage&amp;isappinstalled=0</a></p>
                            </div>
            <div style="margin-top: 20px;background-color:#FFFFFF">
    <input type="hidden" id="detail_title" name="detail_title" value="解密BBOSS组织：全球超十二万站点的地下掌控者 - 安全客 - 有思想的安全新媒体" />
    <input type="hidden" id="use_nickname" name="use_nickname" value="0" />
    <a name="mao"></a>
    <div class="reg-log mobile-hiden">
        <div class="" id="userTo">   
            <div id="to-list" class="input-text" style="">
                <textarea disabled="disabled" class="hide"  id="comment-content" to="to"></textarea>
                <ul id="preadded" style="display:none">       
                </ul>
                <div id="to-auto" style="width: 200px">
                    <ul id="feed">
                    </ul>
                </div>
            </div>
        </div>
        <input type="hidden" id="source-id" value="2573" />
        <input type="hidden" id="source-type" value="learning" />
        <input type="hidden" id="post-comment-url" value="/comment/add" />
        <input type="hidden" id="post-nickname-url-ajax" value="/comment/randnicknameajax" />
        <input type="hidden" id="post-check-login-url-ajax" value="/comment/checklogin" />
        <input type="hidden" id="stoken_comment_set" value="64d932c9bb50dc5a83db601d9b02e735">                 <span class="join">参与讨论，请先 <a href="javascript:;" class="comment-login">登录</a> | <a href="javascript:;" class="comment-reg">注册</a> |  <a href="javascript:;" class="anonymous-comment">匿名评论</a></span>
            </div>
    <div class="mobile-hide" style="width: 870px; margin: 0 auto;">
        <label style="vertical-align:middle;" for="use_nickname">匿名</label> 
        <input style="vertical-align:middle;" id="trigger-nickname" name="use_nickname" class="use_nickname" type="checkbox" value="0" />

        <a href="javascript:;" class="apply-use button" id="submit-comment" data-target="/comment/add">发布</a>
    </div>


    <div class="clearfix"></div>
    <div class="comments">
        <div class="comments-head">
            <span class="title">用户评论</span>
        </div>
                <div class="comment-none alarm-info bg-primary">无任何评论</div>
            </div>
</div>
<script>
    $(function () {
        $('.anonymous-comment').click(function () {
            $(".join").hide();
            $(".reg-log textarea").first().removeAttr("disabled").show();
            $('#use_nickname').val('1');
//            $('#trigger-nickname').attr('checked', true);
            $('#trigger-nickname').trigger('click');
        });
        //为所有复选框绑定事件
//        checkbox_on_click();
        //ajax随机获取昵称
//        randnicknameajax(0);
        //ajax检测登录状态
        comment_check_login();
    });



    function input_checkbox(flag) {
        $('input:checkbox').each(function () {
            var value = flag ? 1 : 0;
            $(this).prop('checked', flag);
            $(this).val(value);
        });
    }

//ajax随机获取昵称
    function randnicknameajax(flag) {
        $.ajax({
            type: 'POST',
            url: $('#post-nickname-url-ajax').val(),
            data: {limit: 1, flag: flag},
            dataType: "json",
            success: function (data) {
                $('#nick-name').val(data.data[0]);
                _nick_name=data.data[0];
            }
        });
    }
    $();
//ajax检测登录状态
    function comment_check_login() {
        $.ajax({
            type: 'POST',
            url: $('#post-check-login-url-ajax').val(),
            data: {},
            dataType: "json",
            success: function (data) {
                if (data.success) {
                    $('.join').hide();
                    $(".reg-log textarea").first().removeAttr("disabled").show();
                    $("#span_use_nickname").show();
                    $('#use_nickname').val('0');
                    $('#use_nickname').attr('checked', false);
                }
            }
        });
    }
</script>        </div>
    </div>
    <div class="side-bar">
        <div class="mod hot-news">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-hot"></i><span>热门知识</span></h2>
    </div>
    <ul class="links-list">
                                <li><a href="/learning/detail/4411.html" alt="【漏洞预警】一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现——最新的Office高级威胁攻击预警" target="_blank">【漏洞预警】一个换行符引发的奥斯卡...</a></li>
                                <li><a href="/learning/detail/4416.html" alt="【漏洞预警】Microsoft .NET Framework漏洞（CVE–2017–8759）预警" target="_blank">【漏洞预警】Microsoft .NE...</a></li>
                                <li><a href="/learning/detail/4414.html" alt="【技术分享】妙用JavaScript绕过XSS过滤" target="_blank">【技术分享】妙用JavaScrip...</a></li>
                                <li><a href="/learning/detail/4425.html" alt="【安全报告】XShellGhost事件技术回顾报告" target="_blank">【安全报告】XShellGhost事件...</a></li>
                                <li><a href="/learning/detail/4424.html" alt="【知识】9月16日 - 每日安全知识热点" target="_blank">【知识】9月16日 - 每日安全知识热...</a></li>
                                <li><a href="/learning/detail/4418.html" alt="【技术分享】利用威胁情报数据平台拓展APT攻击线索一例" target="_blank">【技术分享】利用威胁情报数据平台拓...</a></li>
            </ul>
</div>        <!-- 友情链接 -->
        <div class="mod blog-links mobile-hide">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-link"></i><span>友情链接</span></h2>
        <a href="/links/index.html" class="more">更多<i></i></a>
    </div>
        <ul class="links-list">
                <li><a href="http://bbs.360safe.com" alt="360安全社区" target="_blank">360安全社区</a></li>
                <li><a href="http://zhuji.360.cn" alt="360主机卫士" target="_blank">360主机卫士</a></li>
                <li><a href="http://blogs.360.cn/" alt="奇虎360技术博客" target="_blank">奇虎360技术博客</a></li>
                <li><a href="http://wangzhan.360.cn/" alt="360网站卫士" target="_blank">360网站卫士</a></li>
                <li><a href="http://webscan.360.cn/" alt="360网站安全检测" target="_blank">360网站安全检测</a></li>
                <li><a href="http://research.360.cn/report/" alt="360研究报告" target="_blank">360研究报告</a></li>
                <li><a href="http://unicorn.360.cn/" alt="360 Unicorn Team" target="_blank">360 Unicorn Team</a></li>
                <li><a href="http://appscan.360.cn/" alt="360捉虫猎手" target="_blank">360捉虫猎手</a></li>
                <li><a href="https://threathunter.org/" alt="ThreatHunter社区" target="_blank">ThreatHunter社区</a></li>
                <li><a href="http://security.360.cn/" alt="360安全应急响应中心" target="_blank">360安全应急响应中心</a></li>
            </ul>
    </div>
        <!-- 联系我们 -->
        <div class="mod contact mobile-hide" style="text-align:center">
    <div class="head-bar clearfix">
        <h2><i></i><span>关注我们</span></h2>
    </div>
    <!-- 微信关注 -->
    <ul class="contact-way">
        <li><a>微信关注</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/qrcode_adlab_weixin.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
    <!-- APP下载 -->
    <ul class="contact-way">
        <li><a>安全播报APP</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/scan_code_big.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
</div>

    </div>
</div>

<script type="text/javascript" src="/js/jquery-ui.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/jquery.noty.packaged.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/common.js?v=4.5"></script>
<script>$(function() {sync_count('comment');});</script>


<!-- 语法高亮 -->
<script type="text/javascript" src="/ue/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">SyntaxHighlighter.all();sync_count('vul');sync_count('news');sync_count('learning');sync_count('activity');sync_count('course');sync_count('ctf');</script>
    </div>

        <div class="footer">
        <div class="friend-link">
            <a href="http://www.360.cn/" target="_blank">360首页</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">关于我们</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">联系我们</a>
            <span>|</span>
            <a href="/links/index.html" target="_blank">友情链接</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">招贤纳士</a>
        </div>
        <div class="copy">
            Copyright &copy; 360网络攻防实验室 All Rights Reserved <span class="copy_icp">京ICP证080047号[京ICP备08010314号-6]</span>
        </div>
    </div>
    
</div>

<!--奇舞团统计-->

<script src='https://s.ssl.qhimg.com/static/f5407c785655e6a1/monitor_analytic.js'></script>
<script>
    monitor.setProject('QH_171_1').getTrack().getClickAndKeydown().getClickHeatmap(10, 1);
</script>

<div class="hide">
    <script src="https://s95.cnzz.com/z_stat.php?id=1253147824&web_id=1253147824" language="JavaScript"></script>
</div>
<div class="backToTop_wrap off">
    <a id="back_to_top" class="backToTop" href="javascript:;" title="返回顶部"></a>
</div>
<script>
    var $backToTop_wrap = $(".backToTop_wrap"),
        $backToTop_btn = $("#back_to_top");

    if ($(window).scrollTop() > 100) {
        $backToTop_wrap.removeClass("off");
    }
    else {
        $backToTop_wrap.addClass("off");
    }

    $(window).on("scroll", function () {
        if ($(this).scrollTop() > 100) {
            $backToTop_wrap.removeClass("off");
        }
        else {
            $backToTop_wrap.addClass("off");
        }
    });

    $backToTop_btn.on("click", function () {
        $("html, body").animate({scrollTop: 0}, 120);
    });

    $(function () {
        var navlist = $('.nav-list > li');

        navlist.each(function () {
            $(this).on('mouseenter', function () {
                $(this).addClass('selected');
            });

            $(this).on('mouseleave', function () {
                $(this).removeClass('selected');
            });
        });
    })
</script>



</body>
</html>
