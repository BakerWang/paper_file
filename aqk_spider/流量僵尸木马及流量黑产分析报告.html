<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:wb="http://open.weibo.com/wb" xml:lang="en" lang="en">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <link rel="shortcut icon" href="http://bobao.360.cn/favicon.ico?v=1.1"/>
    <link rel="alternate" title="安全资讯" href="/rss?type=news" type="application/rss+xml"/>
    <link rel="alternate" title="安全知识" href="/rss?type=learning" type="application/rss+xml"/>
    <link rel="alternate" title="安全圈活动" href="/rss?type=activity" type="application/rss+xml"/>
    <link rel="alternate" title="所有漏洞" href="/rss?type=vul" type="application/rss+xml"/>
    <link rel="alternate" title="通用型漏洞" href="/rss?type=commonvul" type="application/rss+xml"/>
    <link rel="alternate" title="事件型漏洞" href="/rss?type=eventvul" type="application/rss+xml"/>
    <link rel="alternate" title="热门漏洞" href="/rss?type=hotvul" type="application/rss+xml"/>

        <title>流量僵尸木马及流量黑产分析报告 - 安全客 - 有思想的安全新媒体</title>
    
        <meta name="keywords" content="流量,僵尸,木马,流量,黑产,分析,报告"/>
    
        <meta name="description" content="近期,360互联网安全中心检测发现有90款手机应用的部分样本被混入了一段云控代码,该段代码会在用户不知情的情况下,从网上下载恶意插件msg.jar,msg.jar释放后在后台静默访问某知名导航网站,并联网获取关键词模拟真实用户的搜索行为在该导航网站上进行搜索操作,从而实现为该导航网站和指定搜索引擎刷流量目的。"/>
        <meta property="wb:webmaster" content="224437c7be31d633"/>

    <script type="text/javascript" src="http://s7.qhimg.com/!56caa871/xpc_sync_height.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/reset.css" />
    <link rel="stylesheet" type="text/css" href="/css/common_new.css?v=4.4.2.1" />
    <link rel="stylesheet" type="text/css" href="/css/jquery.notyfy.css" />
    <link rel="stylesheet" type="text/css" href="/css/notyfy.theme.default.css" />
    <link rel="stylesheet" type="text/css" href="/css/s_common.css?v=2.2.7" media="only screen and
    (max-device-width:900px), only screen and (max-width:900px)" />
    <script type="text/javascript" src="/js/jquery.min.js?v=3.1"></script>
    <script type="text/javascript" src="/js/jquery.notyfy.js"></script>
    <script type="text/javascript" src="/js/iscroll.js"></script>
    <script src="http://js.passport.qihucdn.com/5.0.3.js"></script>
    <script type="text/javascript">
        var myScroll, myNavScroll;

        function iscrollLoaded() {
            myScroll = new IScroll('#wrapper',
                {
                    scrollX: true,
                    scrollY: false,
                    bounceEasing: 'circular',
                    eventPassthrough: true,
                    preventDefault: false,
                    bounceTime: 500
                }
            );
        }

        $(function () {

            //导航横向滚动


            function setNavWidth() {

                /* 计算导航宽度 */
                var allWidth = $(window).width();
                var scroller = $('#scroller');

                if (allWidth > 900) {
                    scroller.find('ul').add(scroller.find('.scroll')).removeAttr('style');
                    scroller.css('overflow', 'visible');
                    if (myNavScroll) myNavScroll.destroy();
                } else {

                    var width = 0;
                    scroller.find('.scroll').children('ul').children('li').each(function (index, el) {
                        if (!$(this).hasClass('mobile-hide')) {
                            width += $(this).outerWidth();
                        }
                    });
                    scroller.find('ul').add(scroller.find('.scroll')).width(width);

                    if (myNavScroll) myNavScroll.destroy();

                    myNavScroll = new IScroll('#scroller', {
                        scrollX: true,
                        scrollY: false,
                        momentum: false,
                        click: true
                    });

                }

            }

            setNavWidth();
            $(window).resize(function (event) {
                setNavWidth();
            });

        });

    </script>
</head>
<body onload="iscrollLoaded();">
<div style='margin:0 auto;width:0px;height:0px;overflow:hidden;'>
    <img src=""/>
</div>

<div id="is-mobile"></div>
<div class="container">
        <div class="mobile-header">
        <div class="header clearfix">
            <div class="header-wrapper clearfix">
                <a href="/index/index" class="logo"><img class="slogan" src="/img/logo.png?v=1.5"/></a>
                                <form id="search" class="search-box" action="/search/index" method="GET">
                    <input class="keys" name="keywords" type="text" placeholder="搜索漏洞" required="required">
                    <input class="icon" type="submit" value="">
                    <input type="hidden" name="type" value=""/>
                </form>
                <div class="bug">
                    <div class="name"><span class="seled">全部</span><i class="arrow"></i></div>
                    <ul class="typelist">
                        <li data-index="3"><a href="javascript:void(0);">全部</a></li>
                        <li data-index="0"><a href="javascript:void(0);">漏洞</a></li>
                        <li data-index="1"><a href="javascript:void(0);">资讯</a></li>
                        <li data-index="2"><a href="javascript:void(0);">知识</a></li>
                    </ul>
                </div>
                                <div class="logNreg mobile-hide">
                    <div class="unlog">
                        <i></i>
                        <a href="log.html" class="log">登录</a>
                        <span>|</span>
                        <a href="reg.html" class="reg">注册</a>
                    </div>
                    <div class="loged">
                        <a href="/member/profile" class="user-center"><i></i><span class="user-name-tag">个人中心</span></a>
                        <div class="user-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting"><a href="http://i.360.cn/profile/accountmanage"
                                                               target="_blank"><i></i><span>账号设置</span></a></li>
                                <li class="alert-setting"><a href="/keywords/index"
                                                             target="_blank"><i></i><span>告警设置</span></a></li>
                                <li class="bug-alert"><a href="/myalarm/index" target="_blank"><i></i><span>漏洞告警</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mylearn/index" target="_blank"><i></i><span>我的知识</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mycourse/index" target="_blank"><i></i><span>我的课堂</span></a>
                                </li>
                                <li class="my-exit"><a
                                            href="http://login.360.cn/?src=pcw_adlab&op=logout&destUrl=http://bobao.360.cn"><i></i><span>退出系统</span></a>
                                </li>
                            </ul>
                        </div>

                        <a href="/message" class="message-center" target="_blank"><i></i><span>我的消息</span></a>
                        <div class="message-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting" style="display:none;"><a href="/myres/index"
                                                                                     target="_blank"><i></i><span>回复我的</span></a>
                                </li>
                                <li class="my-bug"><a href="/myvul/index"
                                                      target="_blank"><i></i><span>我的漏洞</span></a></li>
                                <!--<li class="my-bug"><a href="/myres/index" target="_blank"><i></i><span>我的评论</span></a></li>-->
                                <!--<li class="alert-setting"><a href="###" target="_blank"><i></i><span>提到我的</span></a>
                                </li>-->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <style type="text/css">
            .nav {
                overflow: hidden;
            }

            .nav .scroll {
                width: auto;
            }
        </style>
        <div id="wrapper">
            <div id="scroller" class="nav">
                <div class="scroll">
                    <ul class="nav-list">
                        <li ><a class="link-nav"
                                                                                 href="/index/index">首页</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/vul/index">漏洞</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/introduce/list">招聘</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/news/index">资讯</a><!--<i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/introduce/list">招聘</a></li>
                        </ul>
			-->
                        </li>
                        <li class="cur">
                        <a class="link-nav" href="/learning/index">知识</a><i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/course/index">学院</a></li>
                        </ul>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/activity/index">活动</a></li>
                        <li class="mobile-hide "><a class="link-nav"
                                                                                                   href="/ctf/index">CTF训练营</a>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/interref/list">安全内参</a></li>
                        <li ><a class="link-nav" href="/app/index">APP</a></li>

                        <!--<li ><a href="/course/index">学院</a></li>-->
                        <!--<li ><a href="/introduce/list">招聘</a></li>-->
                        <!--<li  class="mobile-hide"><a href="/ctf/index">CTF训练营</a></li>-->
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="mobile-content">
        <link rel="stylesheet" type="text/css" href="/css/news.css?v=3.5" />
<link rel="stylesheet" type="text/css" href="/ue/SyntaxHighlighter/shCoreDefault.css?v=1.0" />
<style>
    p .syntaxhighlighter {
        width: 80%;
    }
</style>

<div class="cur-pos w1000">当前位置：<a href="http://bobao.360.cn/">安全客</a> &gt;&gt; 知识详情</div>

<div class="content clearfix">
    <div class="main">
        <div class="article">
            <div id="article_box">
                <h2>流量僵尸木马及流量黑产分析报告</h2>
                <div class="article-msg">
                    <span class="time">2015-08-28 11:39:55</span>
                                        <span class="read">阅读：14159次</span>
                    <span><a style="display: none;" class="good" href="javascript:;"
                             data-target="/learning/good" data-value="g_618"
                             data-type="learning">点赞(0)</a></span>
                    <span><a class="fav" href="javascript:;" data-target="/mylearning/add"
                             data-pk="618" data-type="learning">收藏</a></span>
                                        <span><a style="margin-left: 4px;" class="fav" href=""
                             target="_blank">来源： 360安全播报</a></span>
                    
                                    </div>
                <hr size="1">
                <div class="article-msg">
                    <p><!-- JiaThis Button BEGIN -->

<!--
<span class="jiathis_style"><span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_tsina"></a>
    <a class="jiathis_button_tqq"></a>
    <a class="jiathis_button_qzone"></a>
    <a class="jiathis_button_renren"></a>
    <a class="jiathis_button_xiaoyou"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
</span>

-->
</p>
                </div>
                <p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">第一章 木马概述</span></strong></span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);">一、木马危害</span></strong></span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 176, 80);">近期,360互联网安全中心检测发现有90款手机应用的部分样本被混入了一段云控代码,该段代码会在用户不知情的情况下,从网上下载恶意插件msg.jar,msg.jar释放后在后台静默访问某知名导航网站,并联网获取关键词模拟真实用户的搜索行为在该导航网站上进行搜索操作,从而实现为该导航网站和指定搜索引擎刷流量目的。</span></strong></span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">由于这些手机应用会大量消耗用户的手机流量,故此,我们将含有该段恶意代码的应用程序命名为“流量僵尸”木马。</span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">测试结果显示,此类木马在用户每次滑动解手机锁屏幕时都会在后台进行一次静默刷流量操作,平均每次操作消耗用户手机流量约0.76M。按照每个用户平均每天解锁手机屏幕150次计算(参考第三方实验统计),该木马平均每天约消耗每位用户手机流量114M。</span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">截止2015年7月13日,360互联网安全中心共发现90款不同名称的应用被植入“流量僵尸”木马,包括80款游戏类应用和10款工具类应用,样本数量达到1000余个。同时,已经累计检测出感染此类木马的手机数量为445561部。若手机安全软件未对此类进行查杀,则仅这44万余部被感染的手机,每天就会为木马所指向的导航网站和搜索引擎刷掉约6683万次的虚假请求量。按照国内最大的搜索引擎每日约10亿次的搜索请求量计算,该木马伪造的搜索请求量约可占国内最大搜索引擎日均搜索请求量的6.68%。</span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">逆向分析及测试结果显示,流量僵尸木马的数字签名和msg.jar包的下载地址均指向深圳市某软件公司。此报告发布前,360互联网安全中心已经向有关部门进行了举报。</span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);">二、木马行为</span></strong></span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">流量僵尸木马启动后,其攻击过程大致可以分解为3个阶段:</span></p><p style="margin-bottom: 10px; line-height: 20px; border: none; padding: 0px; text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(72, 72, 76); font-size: 14px;">1)云控后门向服务器发起请求,联网下载并运行名为msg.jar的恶意插件;</span></p><p style="margin-bottom: 10px; line-height: 20px; border: none; padding: 0px; text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(72, 72, 76); font-size: 14px;">2)从服务器上获取home页网址,之后完成对home页网址的模拟访问;</span></p><p style="margin-bottom: 10px; line-height: 20px; border: none; padding: 0px; text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(72, 72, 76); font-size: 14px;">3)从服务器上获取搜索关键词,之后用此关键词对指定的搜索引擎完成模拟访问。</span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">其中,第2)和第3)阶段都是由恶意插件msg.jar来执行的,其具体操作过程又可以分为以下六个小步骤。</span></p><p style="margin-bottom: 10px; line-height: 20px; border: none; padding: 0px; text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(72, 72, 76); font-size: 14px;">1)构造初始请求JSRequest并向服务器发起请求;</span></p><p style="margin-bottom: 10px; line-height: 20px; border: none; padding: 0px; text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(72, 72, 76); font-size: 14px;">2)接收服务器返回数据,初始化home页地址及跳转页JS文件下载地址;</span></p><p style="margin-bottom: 10px; line-height: 20px; border: none; padding: 0px; text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(72, 72, 76); font-size: 14px;">3)调用浏览器加载服务器返回的home页,完成home页的访问;</span></p><p style="margin-bottom: 10px; line-height: 20px; border: none; padding: 0px; text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(72, 72, 76); font-size: 14px;">4)发起跳转请求;</span></p><p style="margin-bottom: 10px; line-height: 20px; border: none; padding: 0px; text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(72, 72, 76); font-size: 14px;">5)根据初始服务器返回的JS文件下载地址,向服务器请求JS文件;</span></p><p style="margin-bottom: 10px; line-height: 20px; border: none; padding: 0px; text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(72, 72, 76); font-size: 14px;">6)加载JS文件,取回关键词,完成跳转及模拟搜索操作。</span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">下图给出了msg.jar被加载后的运行过程示意图。</span></p><p style="margin-bottom: 10px; text-align: left; line-height: 28px; text-indent: 2em; background: white;"><br/></p><p style="text-align: center;"><img src="http://p1.qhimg.com/t013aec9e777e0ea57e.png" title="t015d98c72a58360713.png" alt="http://p5.qhimg.com/t015d98c72a58360713.png"/></p><p><br/></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(38, 38, 38);">与以往常见的单纯刷点击量的流量木马不同,该木马的行为,事实上是在手机后台完整的模拟了用户访问网址导航,再通过网址导航的搜索栏进行搜索的整个过程,并且会在后台接收服务器返回的所有页面数据。木马之所以会进行这样的设计,主要是为了躲避导流目标网站的反作弊机制。但是,这种完整的模拟行为也是导致用户手机流量的大量消耗的根本原因。</span></strong></span></p><p style="margin: 15px 0px 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(38, 38, 38);">第二章 测试分析</span></strong></span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">为了能够定量的分析流量僵尸木马对用户手机产生的影响,我们对木马样本进行了两项测试分析,一个是流量消耗测试分析,一个是联网取词测试分析。</span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);">一、 流量消耗</span></strong></span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">由于流量僵尸木马对用户访问行为的模拟非常完整,所以手机会在用户不知情的情况下,从目标网站下载大量的网页数据并在后台运行,因此会对用户手机产生很大的流量消耗。</span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">测试结果显示,用户每解锁一次手机屏幕便会触发一次刷流量动作,每次动作连续调用android.webkit.WebView.loadUrl方法加载指定JS文件10到30次不等,具体次数取决于服务器返回的JS列表大小。</span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">我们使用系统自带了流量检测工具Data Usage对一款被植入了“流量僵尸”木马程序样本进行测试。下图记录了一次解锁屏幕过程中,该木马样本消耗用户手机流量的情况。从图中可见,这个感染了木马的应用程序在屏幕解锁前后的前台流量没有变化,均为为3.99MB,而后台流量却从7.96M增加到了8.69M,也就是说,在这一过程中,木马使被感染的应用程序多消耗了用户手机0.73M的流量。此外,后台监测记录还显示,该木马样本在本次测试中,共调用android.webkit.WebView.loadUrl方法11次。</span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"></span></p><p style="text-align: center;"><img src="http://p2.qhimg.com/t019842facf40df233f.png" title="t01b682759277af28ce.png" alt="http://p6.qhimg.com/t01b682759277af28ce.png"/></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); text-indent: 2em; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">木马的刷量行为由用户解锁屏幕触发,流量的损耗程度与用户解锁手机的次数成正比。我们对十次解锁过程中该软件后台消耗的流量进行统计,得到如下流量损耗统计图:</span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); text-indent: 2em; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"></span></p><p style="text-align: center;"><img src="http://p8.qhimg.com/t01048cc5f08cf597ce.png" title="t01fb646ca5cfa552bd.png" alt="http://p9.qhimg.com/t01fb646ca5cfa552bd.png"/></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(88, 88, 88); text-indent: 2em;">统计结果显示平均每次刷量的流量损耗为0.759M,也就是用户每解锁一次屏幕损耗约0.759M流量,每100次解锁便会损耗约75.9M流量。</span><br/><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(88, 88, 88); text-indent: 2em;"></span></span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);">二、联网取词</span></strong></span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">为了进一步研究流量僵尸木马的行为特征,2015年7月22日,我们对部分木马的样本进行了一次取词测试。我们将部分流量僵尸木马的样本置于沙箱中进行了20000次的测试实验,并将服务器提供给木马的搜索关键词进行了记录分析。统计结果显示,在这20000次的测试中,木马样本共从服务器取回搜索关键词474个(去重),单个关键词最多被重复取回了358次。这些搜索关键词大致可以分为5种类型:时政新闻、娱乐新闻、一般新闻、商品信息和服务信息。从不同类型的关键词被取回的总次数来看,娱乐新闻最多,占39.3%;其次是商品信息,25.2%;服务信息、一般新闻和时政新闻分别占比15.6%、12.7%、7.2%。</span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"></span></p><p style="text-align: center;"><img src="http://p7.qhimg.com/t010165e211beeda712.png" title="t01a711bda9b88aecba.png" alt="http://p2.qhimg.com/t01a711bda9b88aecba.png"/></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); text-indent: 2em; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">下表给出了测试过程中,木马从服务器取回并模拟搜索次数最多的10个搜索关键词。</span></p><p style="text-align: center;"><span style="color: rgb(6, 154, 239); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><a href="http://image.3001.net/images/20150827/14406633786447.jpg!small" target="_blank"><img src="http://p7.qhimg.com/t01446f976a00363b8a.png" title="t0172d99ab29dffa382.png" alt="http://p2.qhimg.com/t0172d99ab29dffa382.png"/></a></span></p><p style="margin-bottom: 10px; text-align: center; line-height: 28px; text-indent: 2em; background: white;"><span style="color: rgb(127, 127, 127); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">表1 木马联网取词TOP10</span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">下表给出了木马从服务器上取回的各类搜索关键词中的“热词”举例。</span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"></span></p><p style="text-align: center;"><img src="http://p0.qhimg.com/t01d490659edbc464dd.png" title="t0183153f1d31e8fb6d.png" alt="http://p3.qhimg.com/t0183153f1d31e8fb6d.png"/></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: center; background: white;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(127, 127, 127); text-indent: 2em;">表2 木马联网取词各类搜索关键词热词举例</span><br/><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(88, 88, 88);"></span></span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">从木马联网取词的结果分析来看,流量僵尸木马的控制服务器对于搜索关键词的选取显然是经过精心设计的,不仅和当日新闻热点有关,而且选词范围非常丰富,这就使得木马所模拟的搜索行为看起来更加真实,更加不容易被一般的搜索引擎的反作弊机制发现。</span></p><p style="margin: 15px 0px 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(38, 38, 38);">第三章 代码分析</span></strong></span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">为了进一步了解流量僵尸木马的具体技术原理,我们对流量僵尸木马的样本进行了逆向分析。下面就从木马攻击的三个主要阶段分别进行分析。</span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);">一、下载恶意插件</span></strong></span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">样本启动后,云控后门向服务器发起请求,联网下载名为msg.jar 的恶意插件,下载信息如下面的数据包截图所示:</span></p><p style="text-align: center;"><img src="http://p5.qhimg.com/t01c569f04460d6d611.png" title="t01b7acb5f19ebac4d6.png" alt="http://p5.qhimg.com/t01b7acb5f19ebac4d6.png"/></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">截至2015年7月13日,恶意插件msg.jar的最新版本为1.3.6,下载链接根据版本号的升级也会发生变化,该版本号MD5如下表:</span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"></span></p><p style="text-align: center;"><img src="http://p0.qhimg.com/t01600b4cc99bd4f960.png" title="t0119c91e3de4746626.png" alt="http://p3.qhimg.com/t0119c91e3de4746626.png"/></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: center; background: white;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(127, 127, 127); text-indent: 2em;">表3 msg.jar基本信息</span><br/><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(88, 88, 88);"></span></span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">木马下载msg.jar之后使用动态加载的方式加载该插件,插件启动后开启后台线程执行恶意刷流量动作。</span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);">二、刷指定网页</span></strong></span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">样本首先访问初始网址http://hao.yhshiji.com/haoaff/api/2 获取home页地址及跳转页JS文件信息,获取信息的数据包如下图所示:</span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"></span></p><p style="text-align: center;"><img src="http://p7.qhimg.com/t019554aea2fd422d64.png" title="t01a671295eb6036f82.png" alt="http://p0.qhimg.com/t01a671295eb6036f82.png"/></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(88, 88, 88); text-indent: 2em;">解码返回数据得到如下信息,其中“home”字段对应home页地址,“js”字段对应要跳转到的JS页文件:</span><br/><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(88, 88, 88);"></span></span></p><p style="margin-bottom: 10px; line-height: 20px; border: none; padding: 0px; text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(72, 72, 76); font-size: 14px;">{&quot;home&quot;:&quot;http://m.hao123.com/?union=1&amp;from=1012771e&amp;tn=ops1012771e&quot;,&quot;js&quot;:[{&quot;url&quot;:&quot;http://hao.yhshiji.com/haoaff/hao123.js&quot;}],&quot;result&quot;:0,&quot;status&quot;:0,&quot;version&quot;:1}。</span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">接着后台调用浏览器加载返回的home页地址,即访问某知名导航网站的主页,以伪造该网站的访问记录:</span></p><p style="text-align: center;"><img src="http://p5.qhimg.com/t0174f533e4a451cb09.png" title="t017027b986e53bb963.png" alt="http://p8.qhimg.com/t017027b986e53bb963.png"/></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">完成home页的加载后立即跳转到js页面,伪造一次“真实”的网站访问过程:</span></p><p style="text-align: center;"><img src="http://p2.qhimg.com/t01ada4d92c9c85c7ff.png" title="t01e4fa21e1afc5aab2.png" alt="http://p3.qhimg.com/t01e4fa21e1afc5aab2.png"/></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">整个过程在后台执行,用户完全无感知。通过输出样本日志我们获取到加载js文件时获取的服务器内容,如下图所示:</span></p><p style="text-align: center;"><img src="http://p2.qhimg.com/t01f860d31de12b4287.png" title="t016ba66ceec54ac51a.png" alt="http://p6.qhimg.com/t016ba66ceec54ac51a.png"/></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);">三、刷搜索引擎</span></strong></span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">在分析木马的网络数据包中时,我们发现如下格式的网络请求:</span></p><p style="text-align: center;"><img src="http://p0.qhimg.com/t0100cb7474f8850e7a.png" title="t014066363e0c68ea4a.png" alt="http://p8.qhimg.com/t014066363e0c68ea4a.png"/></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">请求的Referer指向某知名导航网站,以此方式来伪造在该网站上进行关键词搜索的动作,达到给该网站刷流量的目的。将请求地址复制到浏览器中打开,可以看到生成关键词链接:</span></p><p style="text-align: center;"><img src="http://p4.qhimg.com/t01c00ba38b9e5ae3fc.png" title="t01c5cc42a7d621bcd1.png" alt="http://p6.qhimg.com/t01c5cc42a7d621bcd1.png"/></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">点击上图左侧的推广关键词链接跳转到如下搜索页面:</span></p><p style="text-align: center;"><img src="http://p5.qhimg.com/t01aa5c73e55c6029e0.png" title="t014de0784402d42f6d.png" alt="http://p9.qhimg.com/t014de0784402d42f6d.png"/></p><p style="margin: 15px 0px 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(38, 38, 38);">第四章 流量黑产</span></strong></span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);">一、木马制作</span></strong></span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">截止2015年7月13日,360互联网安全中心共发现90款不同名称的应用被植入“流量僵尸”木马,样本数量达到1000余个,感染手机445561部。通过分析木马样本的数字证书发现,“流量僵尸”木马的样本主要使用了4个不同的数字签名证书,分别是:</span></p><p style="margin-bottom: 10px; line-height: 20px; border: none; padding: 0px; text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(72, 72, 76); font-size: 14px;">1)&nbsp;CN=ngsteam,&nbsp;OU=ngsteam,&nbsp;O=xinyinhe,&nbsp;C=CN</span></p><p style="margin-bottom: 10px; line-height: 20px; border: none; padding: 0px; text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(72, 72, 76); font-size: 14px;">2)&nbsp;CN=google,&nbsp;OU=google,&nbsp;O=android,&nbsp;C=CN</span></p><p style="margin-bottom: 10px; line-height: 20px; border: none; padding: 0px; text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(72, 72, 76); font-size: 14px;">3)&nbsp;CN=Android&nbsp;Debug,&nbsp;O=Android,&nbsp;C=US</span></p><p style="margin-bottom: 10px; line-height: 20px; border: none; padding: 0px; text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(72, 72, 76); font-size: 14px;">4)&nbsp;EMAILADDRESS=android@android.com,&nbsp;CN=Android,&nbsp;OU=Android,&nbsp;O=Android,&nbsp;L=Mountain&nbsp;View,&nbsp;ST=California,&nbsp;C=US</span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">其中,前两个证书共占到目前已截获样本总量的61%。</span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">下图是感染流量僵尸木马的样本证书分布情况。</span></p><p style="text-align: center;"><img id="loading_idv39kd4" src="https://publish.adlab.corp.qihoo.net:8360/ueditor/themes/default/images/spacer.gif" title="正在上传..."/></p><p style="text-align: center;"><img src="http://p4.qhimg.com/t01839c8c1e46ab7c74.png" title="t01f50d4944a1ef0a01.png" alt="http://p2.qhimg.com/t01f50d4944a1ef0a01.png"/><br/></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">进一步分析发现,证书CN=ngsteam, OU=ngsteam, O=xinyinhe, C=CN(以下简称a证书)的名称与恶意插件msg.jar的下载地址均指向深圳市某科技公司。</span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">而在目前360互联网安全中心已经截获的所有使用a证书的3600余个APP样本中,约70%存在私自下载行为,而且这种情况已经至少持续了12个月以上。</span></p><p style="text-align: center;"><img src="http://p0.qhimg.com/t01874e59d00b0c91af.png" title="t01ec7f5db859619184.png" alt="http://p6.qhimg.com/t01ec7f5db859619184.png"/></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);">二、木马传播</span></strong></span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">在目前已经截获的90款感染流量僵尸木马的应用中,80款为游戏类应用,占88.9%,10款为工具类应用,占11.1%。</span></p><p style="text-align: center;"><img src="http://p9.qhimg.com/t01b8abd849732c50c8.png" title="t0127fa2c71e60c8a7a.png" alt="http://p3.qhimg.com/t0127fa2c71e60c8a7a.png"/></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">鉴于被感染应用为木马作者精心制作的某些游戏和常用工具的同名应用,同时,这些同名应用中也只有一部分是感染了流量僵尸木马的。为避免引起读者误解和恐慌,本报告暂不公布这90款存在感染流量僵尸木马现象的应用的具体名称。相关信息已经在报告发布的之前通报给了各应用厂商。</span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">此外,截至2015年7月13日,360互联网安全中心共监测到流量僵尸木马的下载源289个,涉及手机应用商店16家。其中流量僵尸木马下载量最大的两个应用商店,下载量分别占到了该木马下载总量的20.4%和17.1%。</span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">鉴于绝大多数应用商店中存在流量僵尸木马的情况应当属于无心之过,本报告中暂不披露相关应用商店的具体名单和木马下载量情况。在本报告发布之前,360互联网安全中心已经将相关木马信息通报给了国内各大手机应用商店。</span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);">三、黑产利益链</span></strong></span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">截止2015年7月13日,360互联网安全中心已经监测到感染流量僵尸木马的手机445561部。根据前述分析,若手机安全软件未对该木马进行查杀,则仅这44万余部被感染的手机,每天就会为木马所指向的导航网站和搜索引擎刷掉约6683万次的虚假请求量。按照国内最大的搜索引擎每日约10亿次的搜索请求量计算,该木马伪造的搜索请求量约可占国内最大搜索引擎日均搜索请求量的6.68%。</span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(38, 38, 38);">事实上,通过制作手机木马为指定网站刷流量的行为,已经形成了一条非常隐蔽的黑色产业链,其本质是拿用户的手机流量费为木马作者盈利,同时也能在很大程度上帮助被刷网站赚取更多的广告收入——这也是部分网站对某些厂商用木马帮自己刷流量行为睁一只眼、闭一只眼的主要原因。</span></strong></span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">下图给出了手机木马刷流量黑产利益链条的基本形式。从图中可以看出,由木马制造的虚假流量也可以成为网站或搜索引擎欺骗广告主,虚报流量和用户量的依据。而在这一过程中,用户损失的是手机话费,广告主损失的是广告费。被木马导流的网站会与木马作者进行分成。</span></p><p style="text-align: center;"><img src="http://p5.qhimg.com/t01ed7b256623e6c6e8.png" title="t01734c57aed709abe8.png" alt="http://p2.qhimg.com/t01734c57aed709abe8.png"/></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(0, 112, 192);">需要说明的是,目前互联网企业的导流量分成一般有两种基本模式:一是按照约定金额和有效导流次数进行分成;二是进行资源互换,合作双方相互推广,相互导流。</span></strong></span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">例如,就一般的市场价格而言,某主流搜索引擎厂商会根据导入流量多少的不同,分阶梯的给予流量提供者每千次query(访问请求)5元-20元不等的酬劳。以此价格计算,若流量僵尸木马不被查杀,目前仅360互联网安全中心已经监测到的44万余部被感染手机平均每天能够产生的6683万次的虚假请求量,就可以为流量僵尸的木马作者每天赚取约33万-134万元的经济收入。</span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">可见,制作木马的的确确可以日赚百万。</span></p><p style="margin: 15px 0px 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(38, 38, 38);">第五章 流量泡沫</span></strong></span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">事实上,流量僵尸木马只不过是消耗用户手机流量,为网站制造虚假请求量的众多手机木马中的一个而已。根据360互联网安全中心发布的《2015年第二季度中国手机安全状况报告》数据显示,在2015年4-6月截获的所有550万个安卓平台恶意程序中,通过静默访问等形式消耗用户手机流量资费的恶意程序样本多达442.8万个,占比高达80.5%。相比之下,流量僵尸木马的1000余个样本甚至仅为这一数字的0.2‰。由此可以想象由各种木马造成的虚假的移动互联网流量,其规模是何等的庞大。</span></p><p style="text-align: center;"><img src="http://p0.qhimg.com/t01529903e115ee8331.png" title="t01ffd1eff1f956a384.png" alt="http://p4.qhimg.com/t01ffd1eff1f956a384.png"/></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">除了木马之外,网上还有很多公开或半公开的虚假流量交易。比如,下图就是在某购物网站上搜索“刷网站流量”一词所得到的查询结果页面。可以看出,想在网上购买点击量、广告点击量都不难找到。</span></p><p style="text-align: center;"><img src="http://p5.qhimg.com/t019825c40704a503a9.png" title="t017f6447f68adef119.png" alt="http://p8.qhimg.com/t017f6447f68adef119.png"/></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(38, 38, 38);">除了基本的刷流量和点击量之外,还有一些比较“高级”的刷法,如:刷下载量、刷激活量(APP被下载之后至少被打开使用一次)和刷存活量(APP下载之后还必须在一定时间内被持续使用)等。</span></strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; color: rgb(88, 88, 88);">而这些业务也都能比较容易的在网上找到。下图两图是在某购物网站上分别搜索“app刷激活”和“app刷存活量”(实为“app刷量”)这两个词所得到的结果。</span></span></p><p style="text-align: center;"><img src="http://p4.qhimg.com/t01f9bc68a753ff6a85.png" title="t0185324a4430779552.png" alt="http://p9.qhimg.com/t0185324a4430779552.png"/></p><p style="text-align: center;"><a href="http://image.3001.net/images/20150827/14406640055740.jpg!small" target="_blank" style="color: rgb(6, 154, 239); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-decoration: underline; font-size: 14px;"><span style="color: rgb(6, 154, 239); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"></span></a></p><p style="text-align: center;"><img src="http://p8.qhimg.com/t0160f68ad768686ebc.png" title="t01fcdd6ecca261338a.png" alt="http://p2.qhimg.com/t01fcdd6ecca261338a.png"/></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">从图中可见,下载、安装、注册、激活、评论,什么都可以刷,而且安卓、苹果都能刷。</span></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">下图是某个专门给苹果iOS系统APP刷量的“宝贝”详情截图。其中给出的可刷选项更加丰富,不仅包括存留、日活(每日活跃数量)等,还可以刷时长分布这种“高级选项”。</span></p><p style="text-align: center;"><img src="http://p4.qhimg.com/t01f3a78432a8c0e949.png" title="t01656ff79f77dcbb4a.png" alt="http://p9.qhimg.com/t01656ff79f77dcbb4a.png"/></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(88, 88, 88); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">除了网站流量外,社交网络也是可以刷的。下面几张图是我们在某手机应用商店中查询到的一些专门针对腾讯微信、QQ和QQ空间的刷赞、刷人气工具。</span></p><p style="margin-bottom: 10px; text-align: left; line-height: 28px; text-indent: 2em; background: white;"><br/></p><p style="text-align: center;"><img src="http://p7.qhimg.com/t0137cbc5fa800e3af9.png" title="t0137cbc5fa800e3af9.png" alt="http://p7.qhimg.com/t0137cbc5fa800e3af9.png"/></p><p><br/></p><p style="margin-bottom: 10px; text-align: left; line-height: 28px; text-indent: 2em; background: white;"><br/></p><p style="text-align: center;"><a href="http://image.3001.net/images/20150827/14406640687945.jpg!small" target="_blank" style="color: rgb(6, 154, 239); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-decoration: underline; font-size: 14px;"><span style="color: rgb(6, 154, 239); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><img src="http://p6.qhimg.com/t019329562cf9910873.png" title="t019329562cf9910873.png" alt="http://p6.qhimg.com/t019329562cf9910873.png"/></span></a></p><p><br/></p><p style="margin-bottom: 10px; text-align: left; line-height: 28px; text-indent: 2em; background: white;"><br/></p><p style="text-align: center;"><a href="http://image.3001.net/images/20150827/14406640715024.jpg!small" target="_blank" style="color: rgb(6, 154, 239); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-decoration: underline; font-size: 14px;"><span style="color: rgb(6, 154, 239); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"><img src="http://p3.qhimg.com/t015ace35dfea49beb4.png" title="t015ace35dfea49beb4.png" alt="http://p3.qhimg.com/t015ace35dfea49beb4.png"/></span></a></p><p style="margin-bottom: 10px; line-height: 28px; text-indent: 2em; text-align: left; background: white;"><span style="color: rgb(255, 0, 0); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">由上述分析可见,移动互联网上至少有相当数量的点击、下载、安装甚至是点赞、评论都并非是真实用户所为,而是由一些木马或自动化工具来完成的。而这些虚假的流量实际上就是移动互联上的流量泡沫。虽然我们很难准确的估算流量泡沫究竟有多大,但它一定远远超出了我们一般人的想象。在移动互联网高速发展的今天,我们更应该警惕流量泡沫背后的所隐藏的巨大黑洞。</span></p></p>
                <hr/>
                <p style="text-align: center;">
                    <img src="http://bobao.360.cn/img/app.jpeg"/>
                    <img src="http://bobao.360.cn/img/weixin.jpeg"/>
                </p>
                                <p>本文由 安全客 原创发布，如需转载请注明来源及本文地址。<br/>本文地址：http://bobao.360.cn/learning/detail/618.html
                </p>
                            </div>
            <div style="margin-top: 20px;background-color:#FFFFFF">
    <input type="hidden" id="detail_title" name="detail_title" value="流量僵尸木马及流量黑产分析报告 - 安全客 - 有思想的安全新媒体" />
    <input type="hidden" id="use_nickname" name="use_nickname" value="0" />
    <a name="mao"></a>
    <div class="reg-log mobile-hiden">
        <div class="" id="userTo">   
            <div id="to-list" class="input-text" style="">
                <textarea disabled="disabled" class="hide"  id="comment-content" to="to"></textarea>
                <ul id="preadded" style="display:none">       
                </ul>
                <div id="to-auto" style="width: 200px">
                    <ul id="feed">
                    </ul>
                </div>
            </div>
        </div>
        <input type="hidden" id="source-id" value="618" />
        <input type="hidden" id="source-type" value="learning" />
        <input type="hidden" id="post-comment-url" value="/comment/add" />
        <input type="hidden" id="post-nickname-url-ajax" value="/comment/randnicknameajax" />
        <input type="hidden" id="post-check-login-url-ajax" value="/comment/checklogin" />
        <input type="hidden" id="stoken_comment_set" value="64d932c9bb50dc5a83db601d9b02e735">                 <span class="join">参与讨论，请先 <a href="javascript:;" class="comment-login">登录</a> | <a href="javascript:;" class="comment-reg">注册</a> |  <a href="javascript:;" class="anonymous-comment">匿名评论</a></span>
            </div>
    <div class="mobile-hide" style="width: 870px; margin: 0 auto;">
        <label style="vertical-align:middle;" for="use_nickname">匿名</label> 
        <input style="vertical-align:middle;" id="trigger-nickname" name="use_nickname" class="use_nickname" type="checkbox" value="0" />

        <a href="javascript:;" class="apply-use button" id="submit-comment" data-target="/comment/add">发布</a>
    </div>


    <div class="clearfix"></div>
    <div class="comments">
        <div class="comments-head">
            <span class="title">用户评论</span>
        </div>
                <div class="comment-none alarm-info bg-primary">无任何评论</div>
            </div>
</div>
<script>
    $(function () {
        $('.anonymous-comment').click(function () {
            $(".join").hide();
            $(".reg-log textarea").first().removeAttr("disabled").show();
            $('#use_nickname').val('1');
//            $('#trigger-nickname').attr('checked', true);
            $('#trigger-nickname').trigger('click');
        });
        //为所有复选框绑定事件
//        checkbox_on_click();
        //ajax随机获取昵称
//        randnicknameajax(0);
        //ajax检测登录状态
        comment_check_login();
    });



    function input_checkbox(flag) {
        $('input:checkbox').each(function () {
            var value = flag ? 1 : 0;
            $(this).prop('checked', flag);
            $(this).val(value);
        });
    }

//ajax随机获取昵称
    function randnicknameajax(flag) {
        $.ajax({
            type: 'POST',
            url: $('#post-nickname-url-ajax').val(),
            data: {limit: 1, flag: flag},
            dataType: "json",
            success: function (data) {
                $('#nick-name').val(data.data[0]);
                _nick_name=data.data[0];
            }
        });
    }
    $();
//ajax检测登录状态
    function comment_check_login() {
        $.ajax({
            type: 'POST',
            url: $('#post-check-login-url-ajax').val(),
            data: {},
            dataType: "json",
            success: function (data) {
                if (data.success) {
                    $('.join').hide();
                    $(".reg-log textarea").first().removeAttr("disabled").show();
                    $("#span_use_nickname").show();
                    $('#use_nickname').val('0');
                    $('#use_nickname').attr('checked', false);
                }
            }
        });
    }
</script>        </div>
    </div>
    <div class="side-bar">
        <div class="mod hot-news">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-hot"></i><span>热门知识</span></h2>
    </div>
    <ul class="links-list">
                                <li><a href="/learning/detail/4411.html" alt="【漏洞预警】一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现——最新的Office高级威胁攻击预警" target="_blank">【漏洞预警】一个换行符引发的奥斯卡...</a></li>
                                <li><a href="/learning/detail/4416.html" alt="【漏洞预警】Microsoft .NET Framework漏洞（CVE–2017–8759）预警" target="_blank">【漏洞预警】Microsoft .NE...</a></li>
                                <li><a href="/learning/detail/4414.html" alt="【技术分享】妙用JavaScript绕过XSS过滤" target="_blank">【技术分享】妙用JavaScrip...</a></li>
                                <li><a href="/learning/detail/4425.html" alt="【安全报告】XShellGhost事件技术回顾报告" target="_blank">【安全报告】XShellGhost事件...</a></li>
                                <li><a href="/learning/detail/4424.html" alt="【知识】9月16日 - 每日安全知识热点" target="_blank">【知识】9月16日 - 每日安全知识热...</a></li>
                                <li><a href="/learning/detail/4418.html" alt="【技术分享】利用威胁情报数据平台拓展APT攻击线索一例" target="_blank">【技术分享】利用威胁情报数据平台拓...</a></li>
            </ul>
</div>        <!-- 友情链接 -->
        <div class="mod blog-links mobile-hide">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-link"></i><span>友情链接</span></h2>
        <a href="/links/index.html" class="more">更多<i></i></a>
    </div>
        <ul class="links-list">
                <li><a href="http://bbs.360safe.com" alt="360安全社区" target="_blank">360安全社区</a></li>
                <li><a href="http://zhuji.360.cn" alt="360主机卫士" target="_blank">360主机卫士</a></li>
                <li><a href="http://blogs.360.cn/" alt="奇虎360技术博客" target="_blank">奇虎360技术博客</a></li>
                <li><a href="http://wangzhan.360.cn/" alt="360网站卫士" target="_blank">360网站卫士</a></li>
                <li><a href="http://webscan.360.cn/" alt="360网站安全检测" target="_blank">360网站安全检测</a></li>
                <li><a href="http://research.360.cn/report/" alt="360研究报告" target="_blank">360研究报告</a></li>
                <li><a href="http://unicorn.360.cn/" alt="360 Unicorn Team" target="_blank">360 Unicorn Team</a></li>
                <li><a href="http://appscan.360.cn/" alt="360捉虫猎手" target="_blank">360捉虫猎手</a></li>
                <li><a href="https://threathunter.org/" alt="ThreatHunter社区" target="_blank">ThreatHunter社区</a></li>
                <li><a href="http://security.360.cn/" alt="360安全应急响应中心" target="_blank">360安全应急响应中心</a></li>
            </ul>
    </div>
        <!-- 联系我们 -->
        <div class="mod contact mobile-hide" style="text-align:center">
    <div class="head-bar clearfix">
        <h2><i></i><span>关注我们</span></h2>
    </div>
    <!-- 微信关注 -->
    <ul class="contact-way">
        <li><a>微信关注</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/qrcode_adlab_weixin.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
    <!-- APP下载 -->
    <ul class="contact-way">
        <li><a>安全播报APP</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/scan_code_big.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
</div>

    </div>
</div>

<script type="text/javascript" src="/js/jquery-ui.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/jquery.noty.packaged.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/common.js?v=4.5"></script>
<script>$(function() {sync_count('comment');});</script>


<!-- 语法高亮 -->
<script type="text/javascript" src="/ue/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">SyntaxHighlighter.all();sync_count('vul');sync_count('news');sync_count('learning');sync_count('activity');sync_count('course');sync_count('ctf');</script>
    </div>

        <div class="footer">
        <div class="friend-link">
            <a href="http://www.360.cn/" target="_blank">360首页</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">关于我们</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">联系我们</a>
            <span>|</span>
            <a href="/links/index.html" target="_blank">友情链接</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">招贤纳士</a>
        </div>
        <div class="copy">
            Copyright &copy; 360网络攻防实验室 All Rights Reserved <span class="copy_icp">京ICP证080047号[京ICP备08010314号-6]</span>
        </div>
    </div>
    
</div>

<!--奇舞团统计-->

<script src='https://s.ssl.qhimg.com/static/f5407c785655e6a1/monitor_analytic.js'></script>
<script>
    monitor.setProject('QH_171_1').getTrack().getClickAndKeydown().getClickHeatmap(10, 1);
</script>

<div class="hide">
    <script src="https://s95.cnzz.com/z_stat.php?id=1253147824&web_id=1253147824" language="JavaScript"></script>
</div>
<div class="backToTop_wrap off">
    <a id="back_to_top" class="backToTop" href="javascript:;" title="返回顶部"></a>
</div>
<script>
    var $backToTop_wrap = $(".backToTop_wrap"),
        $backToTop_btn = $("#back_to_top");

    if ($(window).scrollTop() > 100) {
        $backToTop_wrap.removeClass("off");
    }
    else {
        $backToTop_wrap.addClass("off");
    }

    $(window).on("scroll", function () {
        if ($(this).scrollTop() > 100) {
            $backToTop_wrap.removeClass("off");
        }
        else {
            $backToTop_wrap.addClass("off");
        }
    });

    $backToTop_btn.on("click", function () {
        $("html, body").animate({scrollTop: 0}, 120);
    });

    $(function () {
        var navlist = $('.nav-list > li');

        navlist.each(function () {
            $(this).on('mouseenter', function () {
                $(this).addClass('selected');
            });

            $(this).on('mouseleave', function () {
                $(this).removeClass('selected');
            });
        });
    })
</script>



</body>
</html>
