<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:wb="http://open.weibo.com/wb" xml:lang="en" lang="en">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <link rel="shortcut icon" href="http://bobao.360.cn/favicon.ico?v=1.1"/>
    <link rel="alternate" title="安全资讯" href="/rss?type=news" type="application/rss+xml"/>
    <link rel="alternate" title="安全知识" href="/rss?type=learning" type="application/rss+xml"/>
    <link rel="alternate" title="安全圈活动" href="/rss?type=activity" type="application/rss+xml"/>
    <link rel="alternate" title="所有漏洞" href="/rss?type=vul" type="application/rss+xml"/>
    <link rel="alternate" title="通用型漏洞" href="/rss?type=commonvul" type="application/rss+xml"/>
    <link rel="alternate" title="事件型漏洞" href="/rss?type=eventvul" type="application/rss+xml"/>
    <link rel="alternate" title="热门漏洞" href="/rss?type=hotvul" type="application/rss+xml"/>

        <title>【技术分享】移动应用：进入物联网的后门？ - 安全客 - 有思想的安全新媒体</title>
    
        <meta name="keywords" content="iot安全,物联网安全"/>
    
        <meta name="description" content="现在，每天都有大量新设备接入物联网，但是迫于市场的压力，这些设备的安全性和隐私性往往没有得到足够的重视。为了评估和改善这些设备的安全状况，研究人员需要对它们进行逆向工程。在本文中，我们将解决这个问题，从移动应用程序着手来逆向智能设备。"/>
        <meta property="wb:webmaster" content="224437c7be31d633"/>

    <script type="text/javascript" src="http://s7.qhimg.com/!56caa871/xpc_sync_height.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/reset.css" />
    <link rel="stylesheet" type="text/css" href="/css/common_new.css?v=4.4.2.1" />
    <link rel="stylesheet" type="text/css" href="/css/jquery.notyfy.css" />
    <link rel="stylesheet" type="text/css" href="/css/notyfy.theme.default.css" />
    <link rel="stylesheet" type="text/css" href="/css/s_common.css?v=2.2.7" media="only screen and
    (max-device-width:900px), only screen and (max-width:900px)" />
    <script type="text/javascript" src="/js/jquery.min.js?v=3.1"></script>
    <script type="text/javascript" src="/js/jquery.notyfy.js"></script>
    <script type="text/javascript" src="/js/iscroll.js"></script>
    <script src="http://js.passport.qihucdn.com/5.0.3.js"></script>
    <script type="text/javascript">
        var myScroll, myNavScroll;

        function iscrollLoaded() {
            myScroll = new IScroll('#wrapper',
                {
                    scrollX: true,
                    scrollY: false,
                    bounceEasing: 'circular',
                    eventPassthrough: true,
                    preventDefault: false,
                    bounceTime: 500
                }
            );
        }

        $(function () {

            //导航横向滚动


            function setNavWidth() {

                /* 计算导航宽度 */
                var allWidth = $(window).width();
                var scroller = $('#scroller');

                if (allWidth > 900) {
                    scroller.find('ul').add(scroller.find('.scroll')).removeAttr('style');
                    scroller.css('overflow', 'visible');
                    if (myNavScroll) myNavScroll.destroy();
                } else {

                    var width = 0;
                    scroller.find('.scroll').children('ul').children('li').each(function (index, el) {
                        if (!$(this).hasClass('mobile-hide')) {
                            width += $(this).outerWidth();
                        }
                    });
                    scroller.find('ul').add(scroller.find('.scroll')).width(width);

                    if (myNavScroll) myNavScroll.destroy();

                    myNavScroll = new IScroll('#scroller', {
                        scrollX: true,
                        scrollY: false,
                        momentum: false,
                        click: true
                    });

                }

            }

            setNavWidth();
            $(window).resize(function (event) {
                setNavWidth();
            });

        });

    </script>
</head>
<body onload="iscrollLoaded();">
<div style='margin:0 auto;width:0px;height:0px;overflow:hidden;'>
    <img src=""/>
</div>

<div id="is-mobile"></div>
<div class="container">
        <div class="mobile-header">
        <div class="header clearfix">
            <div class="header-wrapper clearfix">
                <a href="/index/index" class="logo"><img class="slogan" src="/img/logo.png?v=1.5"/></a>
                                <form id="search" class="search-box" action="/search/index" method="GET">
                    <input class="keys" name="keywords" type="text" placeholder="搜索漏洞" required="required">
                    <input class="icon" type="submit" value="">
                    <input type="hidden" name="type" value=""/>
                </form>
                <div class="bug">
                    <div class="name"><span class="seled">全部</span><i class="arrow"></i></div>
                    <ul class="typelist">
                        <li data-index="3"><a href="javascript:void(0);">全部</a></li>
                        <li data-index="0"><a href="javascript:void(0);">漏洞</a></li>
                        <li data-index="1"><a href="javascript:void(0);">资讯</a></li>
                        <li data-index="2"><a href="javascript:void(0);">知识</a></li>
                    </ul>
                </div>
                                <div class="logNreg mobile-hide">
                    <div class="unlog">
                        <i></i>
                        <a href="log.html" class="log">登录</a>
                        <span>|</span>
                        <a href="reg.html" class="reg">注册</a>
                    </div>
                    <div class="loged">
                        <a href="/member/profile" class="user-center"><i></i><span class="user-name-tag">个人中心</span></a>
                        <div class="user-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting"><a href="http://i.360.cn/profile/accountmanage"
                                                               target="_blank"><i></i><span>账号设置</span></a></li>
                                <li class="alert-setting"><a href="/keywords/index"
                                                             target="_blank"><i></i><span>告警设置</span></a></li>
                                <li class="bug-alert"><a href="/myalarm/index" target="_blank"><i></i><span>漏洞告警</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mylearn/index" target="_blank"><i></i><span>我的知识</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mycourse/index" target="_blank"><i></i><span>我的课堂</span></a>
                                </li>
                                <li class="my-exit"><a
                                            href="http://login.360.cn/?src=pcw_adlab&op=logout&destUrl=http://bobao.360.cn"><i></i><span>退出系统</span></a>
                                </li>
                            </ul>
                        </div>

                        <a href="/message" class="message-center" target="_blank"><i></i><span>我的消息</span></a>
                        <div class="message-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting" style="display:none;"><a href="/myres/index"
                                                                                     target="_blank"><i></i><span>回复我的</span></a>
                                </li>
                                <li class="my-bug"><a href="/myvul/index"
                                                      target="_blank"><i></i><span>我的漏洞</span></a></li>
                                <!--<li class="my-bug"><a href="/myres/index" target="_blank"><i></i><span>我的评论</span></a></li>-->
                                <!--<li class="alert-setting"><a href="###" target="_blank"><i></i><span>提到我的</span></a>
                                </li>-->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <style type="text/css">
            .nav {
                overflow: hidden;
            }

            .nav .scroll {
                width: auto;
            }
        </style>
        <div id="wrapper">
            <div id="scroller" class="nav">
                <div class="scroll">
                    <ul class="nav-list">
                        <li ><a class="link-nav"
                                                                                 href="/index/index">首页</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/vul/index">漏洞</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/introduce/list">招聘</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/news/index">资讯</a><!--<i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/introduce/list">招聘</a></li>
                        </ul>
			-->
                        </li>
                        <li class="cur">
                        <a class="link-nav" href="/learning/index">知识</a><i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/course/index">学院</a></li>
                        </ul>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/activity/index">活动</a></li>
                        <li class="mobile-hide "><a class="link-nav"
                                                                                                   href="/ctf/index">CTF训练营</a>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/interref/list">安全内参</a></li>
                        <li ><a class="link-nav" href="/app/index">APP</a></li>

                        <!--<li ><a href="/course/index">学院</a></li>-->
                        <!--<li ><a href="/introduce/list">招聘</a></li>-->
                        <!--<li  class="mobile-hide"><a href="/ctf/index">CTF训练营</a></li>-->
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="mobile-content">
        <link rel="stylesheet" type="text/css" href="/css/news.css?v=3.5" />
<link rel="stylesheet" type="text/css" href="/ue/SyntaxHighlighter/shCoreDefault.css?v=1.0" />
<style>
    p .syntaxhighlighter {
        width: 80%;
    }
</style>

<div class="cur-pos w1000">当前位置：<a href="http://bobao.360.cn/">安全客</a> &gt;&gt; 知识详情</div>

<div class="content clearfix">
    <div class="main">
        <div class="article">
            <div id="article_box">
                <h2>【技术分享】移动应用：进入物联网的后门？</h2>
                <div class="article-msg">
                    <span class="time">2017-01-03 09:59:46</span>
                    
                                        <span class="read">阅读：12237次</span>
                    <span><a style="display: none;" class="good" href="javascript:;"
                             data-target="/learning/good" data-value="g_3363"
                             data-type="learning">点赞(0)</a></span>
                    <span><a class="fav" href="javascript:;" data-target="/mylearning/add"
                             data-pk="3363" data-type="learning">收藏</a></span>
                                        <span><a style="margin-left: 4px;" class="fav" href="https://www.virusbulletin.com/virusbulletin/2016/11/vb2016-paper-mobile-applications-backdoor-internet-things/"
                             target="_blank">来源： virusbulletin.com</a></span>
                    
                    
                    <div style="margin-top:10px; ">
                        <a href="/member/contribute?uid=2522399780" style="color:#848e99;">
                            <img src="http://p1.qhmsg.com/dm/150_150_100/t00df551a583a87f4e9.jpg" data-is-avatar="true"
                                 style="border: 1px solid #d5d5d5;padding: 2px; width: 80px;height: 80px;border-radius: 43px;"/>
                        </a>

                    </div>
                    <span class="orig">作者：<a href="/member/contribute?uid=2522399780" style="color:#848e99;">shan66</a></span>
                                    </div>
                <hr size="1">
                <div class="article-msg">
                    <p><!-- JiaThis Button BEGIN -->

<!--
<span class="jiathis_style"><span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_tsina"></a>
    <a class="jiathis_button_tqq"></a>
    <a class="jiathis_button_qzone"></a>
    <a class="jiathis_button_renren"></a>
    <a class="jiathis_button_xiaoyou"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
</span>

-->
</p>
                </div>
                <p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></strong></span></p><p style="white-space: normal; text-indent: 0em; text-align: center;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;"><img src="http://p7.qhimg.com/t0181e4b253fbd90dfe.jpg" title="t010a609b96782eaf78.jpg" alt="http://p3.qhimg.com/t010a609b96782eaf78.jpg" style="text-align: center; white-space: normal;"/></span></strong></span></p><p style="white-space: normal; text-indent: 2em;"><span style="text-indent: 2em; color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;">翻译：</span></strong></span><a href="http://bobao.360.cn/member/contribute?uid=2522399780" target="_blank" textvalue="shan66" style="text-indent: 2em; text-decoration: none;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;">shan66</span></strong></span></a></p><p style="white-space: normal; text-indent: 2em;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;">预估稿费：300RMB（不服你也来投稿啊！）</span></strong></span></p><p style="white-space: normal; text-indent: 2em;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;"><strong><strong>投稿方式：发送邮件至</strong><a href="mailto:linwei@360.cn" target="_self" style="text-decoration: none;"><span style="color: rgb(0, 112, 192);"><strong>linwei#360.cn</strong></span></a><strong>，或登陆</strong><a href="http://bobao.360.cn/contribute/index" target="_blank" style="color: rgb(0, 112, 192); text-decoration: none;"><strong>网页版</strong></a><strong>在线投稿</strong></strong></span></strong></span></p><p style="text-indent: 2em; text-align: left;"><br/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">摘要</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em; color: rgb(255, 0, 0);">现在，每天都有大量新设备接入物联网，但是迫于市场的压力，这些设备的安全性和隐私性往往没有得到足够的重视。</span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">为了评估和改善这些设备的安全状况，研究人员需要对它们进行逆向工程。不幸的是，这可不是一个容易的任务，因为他们需要面对各种不同的智能对象，并且它们经常使用定制的硬件、固件、操作系统和协议，这意味着每次逆向工程都需要从头开始，这是相当费时费力的。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在本文中，我们将解决这个问题，并提出一个更容易的方法来逆向智能对象。<span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(255, 0, 0);">我们的思路是，在许多情况下无需关注对象本身，而是关注相关的移动应用程序。</span>我们详细介绍了该方法在三个智能对象上的应用，结果表明这种方法的效果非常棒。<span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; color: rgb(255, 0, 0);">实验的设备包括：智能牙刷、智能手表和家用安全报警器。</span></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">引言</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">在牛津英语词典中，将物联网（IoT）定义为“互联网的进一步拓展，能让日常生活中的所有对象互联互通，允许它们发送和接收数据”。现在，物联网正在逐步走入我们的生活。2014年，约有20亿个物联网设备，这已经超过了笔记本电脑和台式电脑的数量（15亿），并且与智能手机的数量（18亿）相当。一些最常见的物联网对象包括：智能手表（请注意，截止2015年第4季度，智能手表的出货量就已经超过了瑞士手表）、健身腕带（通常用于人类，但也可用于猫和狗的设备，如奥托宠物系统）、智能电视和智能眼镜。但这些只是其中的很少一部分，物联网设备实际上涉及广泛的领域：</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">娱乐领域</span></strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">，例如Archos公司的音乐智能比尼帽，Mattel公司的智能芭比娃娃Hello Barbie。</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">高科技领域</span></strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">，例如Recon Instruments公司的增强现实防雪面罩，Narrative公司的可穿戴相机等。</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">时尚领域</span></strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">，例如Volvorii公司的物联网高跟鞋或服装。</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">农业领域</span></strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">，例如奶牛授精。</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">健康和安全领域</span></strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">，例如Netatmo June公司的皮肤暴露检测仪，Vigo公司的睡眠检测仪，Glow-Cap公司的药物提醒帽。</span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">等等。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">然而，这些设备的隐私和安全问题却非常让人担忧。迫于市场压力，这些物联网设备通常会急不可耐的尽早面世，因此，通常都没有经过适当的安全审查，有时甚至缺乏正确的安全设计。例如，HP研究发现，90％的IoT设备至少会收集一条个人信息，70％的设备使用未加密的网络，10个UI中有6个设备容易受到诸如XSS和弱凭证的威胁。根据这些现状，IDC预测到2016年12月，90％的IT网络将因IoT的安全漏洞而遭受威胁。在消费者方面，埃森哲咨询公司在28个不同国家对28,000个人进行了调查结果表明，47％的消费者对IoT存在隐私和安全担忧。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">为了评估智能对象的安全性和隐私性，研究人员需要密切分析它们的具体实现。但是，由于技术文档很少，所以第一步通常需要对相关设备进行逆向工程。逆向工程本来就不是一个轻松的任务，对于物联网设备来说，就更加困难了，因为（i）它们使用的组件越特殊，人们对它的了解就越少，以及（ii）因为智能对象彼此差异很大。前者需要了解陌生领域的专业知识（例如，Riot，Contiki，Brillo等操作系统），而后者则意味着需要逆向智能对象，但是逆向一个智能对象的经验，在逆向其他对象的时候帮助不大。例如，智能手表的逆向工程与智能牙刷的逆向工程几乎没有共同之处。因此，在第一个任务期间获得的经验对第二个任务几乎没有帮助。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">这些正是本文要解决的问题。我在这里提出了一种简单的方法，并且我已经多次实践，证明该方法确实有效。这种方法能够使得逆向过程的前面几步更加简单，从而有助于研究人员更快地了解设备本身。此外，它还能提供许多有价值的信息，可以使进一步的逆向工作更集中、更有针对性。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在本文中，我们首先讨论这个主题的前期工作（第2节），然后解释我们使用的方法（第3节）。然后，通过三种不同智能对象举例说明我们的方法：智能牙刷（第4节）、智能手表（第5节）和（第6节）。最后，我们将对这种方法进行总结。</span></p><p style="text-indent: 2em; text-align: left;"><br/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">发展现状</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">虽然物联网已经开始流行，但是，其安全研究仍处于早期阶段，相关的出版物也远少于其他领域，如操作系统安全。我们可以引用的文献有NEST恒温器、WeMo电源插座、健康输液泵中的漏洞、在Fitbit Flex dongles中注入任意代码、蓝牙扫描、婴儿监视器等等。一方面，这些研究为逆向物联网设备提供了有趣的线索，同时，也说明了不同的智能对象的差距是多么大，以及研究人员为了了解它们而需要做的工作量有多么大。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">参考文献[14]将这项任务比作CTF竞赛，这看起来是非常合适的，因为每个挑战是不同的而且非常耗时，并且在网络上也找不到立即可用的解决方案。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在学术界，一些研究人员提出了相关的方法或自动化方法来帮助逆向固件。文献[15]给出了物联网不同攻击面的详细清单。该清单有助于在安全审核/渗透测试时防止遗漏某些领域。然而，它对逆向工程本身没有提供帮助，只是旨在帮助我们涵盖安全相关的所有方面。对于自动化框架和工具，它们是有发展潜力的，但目前仍处于早期阶段，因此现在还难以在实践中大展拳脚。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">方法论&nbsp;</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">为了简化物联网设备的逆向工程，本文提出了以下方法：这种方法不是直接逆向智能对象本身，而是首先侧重于逆向与它们打交道的移动应用程序。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">许多物联网设备都是通过相关的移动应用程序来进行控制、监督或与之交互的。例如，Meian公司的安全报警器就提供了相应的Android应用程序，帮助最终用户启动、停止设备，获取状态或设置警报区域。类似地，Beam牙刷也配备了与智能牙刷等通信的iOS或Android应用程序。当有这样的移动应用程序可用时，那就为我们提供了很大的优势：</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">更简单</span></strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">。有许多工具可以用来逆向移动应用程序（例如apktool、baksmali、clutch以及IDA Pro）。反病毒分析师经常使用这些工具来考察移动病毒，因此我们会有一个良好的支持社区。</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">安全性</span></strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">。物联网供应商开发这些移动应用程序（因为它们对最终用户很有吸引力）通常是处于营销的角度来考虑的，所以不会将它们完全集成到其安全设计中（如果有的话）。因此，我们通常有机会访问这些移动应用程序未经混淆的源代码，更有甚者，我们还能在这些应用中找到危及智能对象本身的安全漏洞，具体参考第6节。</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">退可守</span></strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">。如果针对移动应用的分析不足以解决问题，则研究人员总是可以将逆向智能对象作为研究的第二步。在第一阶段收集的信息很可能有助于在第二阶段进行更有针对性的逆向工程。</span></p><p style="text-indent: 2em; text-align: left;"><br/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Beam牙刷</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;"></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192); font-size: 18px;"><strong><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">概述</span></strong></span><br/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">智能牙刷的问世已经有一段时间了，但直到2015年才引起了相关媒体的关注，因为当时Beam在一份围绕其联网设备的牙科保险计划中提到了它。每支Beam牙刷都纳入了牙科保险计划，并且每支牙刷有自己的特殊优惠（例如免费牙膏）和附属牙医。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">与胰岛素泵或起搏器相比，牙刷可能还涉及不到最敏感的健康数据。然而，一旦与保险单挂钩，就会引发多个问题，无论从安全教育角度还是从隐私角度考虑，考察该牙刷的工作原理都是非常有趣的。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">该牙刷除了提供其商品规格：蓝牙LE 4.0（BLE）、声波电机、尺寸和颜色之外，没有提供其他技术信息。此外，也没有用户论坛，没有开发者社区，也没有学术出版物。不幸的是，这种情况对于物联网设备来说是非常常见的：我们必须从头开始，因为没有信息可供利用。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">面对这种处境，一条路是拆卸牙刷的硬件：拆开它，拿到电子组件，探测测试点等。但是，这里我们决定重点探索该设备相关的iOS和Android移动应用。</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192); font-size: 18px;"><strong><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">逆向iOS应用程序</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在逆向iOS应用程序的时候，它的架构对我们是很有帮助的。因为应用程序会使用名为BeamBrushData.sqlite的sqlite数据库，其中包含多个表，如BrushEvent、ClientDevice和ClientSession（请参见图1），所以，我们可以通过在函数名称中搜索关键字“primaryKey”来列出这些表。</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t01d3a0544bb6712805.png" title="t01cbb49290dd78dc7d.png" alt="http://p4.qhimg.com/t01cbb49290dd78dc7d.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图1：Beam牙刷的移动应用程序所使用的SQL表。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">每个表的内容都是由mappings命名的函数进行描述的，例如Insured表的[Insured mappings]。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">了解每个表的字段对于掌握哪些数据被存储以及哪些数据可能泄露给对手是非常有用的。例如，BTStarCardInfo表包含最终用户的积分的变化情况：name，beforeValue，afterValue，starCount，lastTotalStars，totalStars。积分是最终用户完成指定挑战（例如连续刷牙超过两分钟）时授予终端用户的虚拟点数。攻击者当然可以尝试修改这里的值来获取积分——当然，还可能存在其他相关的检查，例如在远程服务器上的检查事项等。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">存储在这些表中的信息对于广告工具包或广告软件来说，可能是非常有价值的。例如，Insured表保存被保险用户的称谓，名字，中间名，姓氏，性别和出生日期，当然用户也可能是家庭中的成年人（通常是父亲或母亲）。然后，User表为家庭的其他成员（例如儿童）提供相同的信息。因此，通过分析这些表中包含的数据，间谍软件可以了解特定家庭的组成成员，然后给他们发送有针对性的广告等。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">除了数据库结构之外，通过反汇编iOS应用程序还能揭示它实现的类的结构。移动应用程序二进制文件的objc节提供了每个类的方法和字段的完整概述。例如，图2示出了UserSummary类的字段——也称为属性（例如，beamScore，numberOfBrushDaysLeft）和方法（例如，beamScoreRoundedInteger）。此外，IDA Pro中的注释也特别有用，甚至为每个字段的类型和方法都提供了签名。</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t01cf652cfb0a22ab7b.png" title="t016c9130516855fe03.png" alt="http://p0.qhimg.com/t016c9130516855fe03.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图2：IDA Pro显示了UserSummary类的方法和属性。属性的注释显示了该字段的具体类型。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">从这里我们可以了解到：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">牙刷提供了加速度计和陀螺仪。两者都在BTBrushData类中提供了一个三轴向量。牙刷就是通过它们来了解最终用户是否正在刷牙，如果是的话，当前位于哪个象限（口腔被分为四个区域，或象限：左上，右上，右下，左下）。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">固件的空中下载服务。BTFirmwareUpdater类的内容表明，该固件提供了通过空中下载进行的更新服务。更新固件时，会将新固件的字节发送到牙刷，直到写入所有字节为止。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:plain;toolbar:false">char&nbsp;*firmware;
unsigned&nbsp;int&nbsp;totalLength;
unsigned&nbsp;int&nbsp;written;
unsigned&nbsp;int&nbsp;toWrite;
unsigned&nbsp;int&nbsp;loopCount;
int&nbsp;state;
CBService&nbsp;*otaService;
CBCharacteristic&nbsp;*otaControlPoint,&nbsp;*otaDataPoint;</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">这些积分只是软件而已。特定最终用户的积分数量并不存储在牙刷本身上，而是存储在移动电话上（并且可能在远程服务器数据库上）。事实上，类BTBrushData，BTBrushEvent，Device和ClientDevice中没有积分相关的字段。从这些类的内容可以看出，牙刷是由固件、硬件、序列号、闪光灯、电池电量、电动机（其速度是可控的）、三轴陀螺仪、三轴加速度计、自动关闭定时器和具有BLE功能的芯片构成的。</span><br/></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192); font-size: 18px;"><strong><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">逆向Android应用程序</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">通过逆向该Android应用程序，我们可以获得更多的详细信息。例如，虽然我们知道牙刷导出了几种BLE服务和characteristic（参见图3），但是除了标准的服务之外，大多数都是未知的。</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t01d35092d9f097fc19.png" title="t016c9130516855fe03.png" alt="http://p6.qhimg.com/t016c9130516855fe03.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图3：牙刷的BLE characteristic。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">通过逆向Android应用程序，能够更轻松地找到每个characteristic的意义。例如，图4中的代码给出了牙刷的电动机速度（其转换为刷子每分钟的行程）的UUID和象限蜂鸣（当最终用户在特定象限中的刷牙时间足够长时，牙刷就会振动）。我们在表1和2中分别列出了已知的BLE服务和characteristic。</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t013d00a824feb2c3c8.png" title="t018469ccef1999e43a.png" alt="http://p3.qhimg.com/t018469ccef1999e43a.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图4：用于电机速度和象限蜂鸣的BLE characteristic。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:plain;toolbar:false">UUID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;描述
00001800-0000-1000-8000-00805f9b34fb&nbsp;通用访问（标准）
c05fc343-c076-4a97-95d3-f6d3e92a2799&nbsp;固件&nbsp;OTA&nbsp;服务
04234f8e-75b0-4525-9a32-193d9c899d30&nbsp;Beam&nbsp;服务
89bae1fa-2b59-4b06-919a-8a775081771d&nbsp;可能是加速度计/陀螺仪芯片服务</pre><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">表1：Beam牙刷的BLE服务。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:plain;toolbar:false">UUID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;描述
a8902afd-4937-4346-a4f1-b7e71616a383&nbsp;布尔指示器，指示牙刷处于活动状态
267b09fd-fb8e-4bb9-85ccade55975431b&nbsp;&nbsp;电机状态
3530b2ca-94f8-4a1d-96beaa76d808c131&nbsp;&nbsp;当前时间
833da694-51c5-4418-b4a9-3482de840aa8&nbsp;电机速度
19dc94fa-7bb3-4248-9b2d-1a0cc6437af5&nbsp;自动关闭和象限蜂鸣指示器（2位）
6dac0185-e4b7-4afd-ac6b-515eb9603c4c&nbsp;电池电量（2字节）
0971ed14-e929-49f9-925f-81f638952193&nbsp;牙刷颜色(1&nbsp;byte)
0227f1b0-ff5f-40e3-a246-b8140205bc49&nbsp;加速度计数据（6字节）
ed1aa0cf-c85f-4262-b501-b9ddf586a1db&nbsp;陀螺仪（6字节）
cf0848aa-ccdb-41bf-b1e1-337651f65461&nbsp;按钮状态</pre><p style="text-align: center;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em; text-align: center;">表2：我们对Beam牙刷最感兴趣的BLE characteristics</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">有了这些信息，我们便可以使用自己的实现代码来控制自动关闭和象限蜂鸣功能了。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">我们可以控制的功能包括：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">打开与牙刷的BLE连接。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">将字节值写入相应的characteristic UUID中。最低有效位用来控制象限蜂鸣，第二位控制自动关闭。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">断开牙刷的连接。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">BLE命令可以使用诸如建立在bluez（蓝牙栈实现）之上的gattlib [21]之类的库和简单的BLE USB dongle来发送。</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192); font-size: 18px;"><strong><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">利弊</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">通过对Beam牙刷的移动应用程序进行逆向，我们发现了下列有效信息。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">存在陀螺仪和加速度计。这一点上，通过拆卸牙刷的硬件也能达到同样的效果，只不过做起来可能会有点难度，具体取决于芯片的封装方式。显然，逆向移动应用程序的优点是我们不需要拆开牙刷，并且也没有毁坏它的风险。缺点是我们看不到组件的铭牌和型号，因此也无法了解其电器规格。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">存在固件更新服务。对于这一点来说，很难通过其他方式（例如通过监听BLE流量）来获得。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">积分并未存储在牙刷本身中。这一点很难通过硬件探测或BLE扫描找到。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">实现代码的设计。显然，没有反汇编代码的话，是没有办法了解这一点的。我们唯一不知道的部分，就是硬件设计。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">识别BLE服务和characteristic。这一点也可以使用BLE扫描器应用程序（例如nRF主控制面板[22]）来达到目的，但需要消耗更长的时间，因为必须通过尝试各种值，然后通过观察牙刷的行为差异来进行识别。</span></p><p style="text-indent: 2em; text-align: left;"><br/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">智能手表</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;"></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192); font-size: 18px;"><strong><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">架构</span></strong></span><br/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">我们对索尼的智能手表SmartWatch 2 SW2进行了相应的实验。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">与Beam牙刷不同，这款智能手表提供了很多技术信息和开发人员信息，这主要得益于索尼鼓励开发人员为其编写新的应用程序。索尼为该产品提供了相应的API、文档、示例和教程。该智能手表含有STM32F439 SoC（包括ARM Cortex-M4和加密加速器）、光传感器、加速器，支持NFC和蓝牙3.0（注意不兼容低功耗蓝牙技术）和LiPo电池。它运行的是Micrium的μC/ OS-II实时操作系统。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">知道了这一点，那么就可以请μC/ OS-II或ST微电子SoC专家继续对设备的相关部件进行深入调查。在本文中，我们假设研究人员无法接触这方面的专家，相反，我们将重点研究该智能手表的应用情况。要使用智能手表，必须至少安装两个Android应用程序：一个名为Smart Connect的应用程序以及一个名为SmartWatch 2 SW2的应用程序。这里，我们将重点考察这两个应用程序。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">要了解这些应用程序，必须首先掌握索尼的有关术语。对于索尼而言，智能手表更一般的称呼为智能配件，因为还有其他类型的配件，如耳机等。一个智能手表的“应用程序”（我们稍后就会发现，实际上根本没有这样的东西）被称为智能扩展。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">要创建新的智能扩展程序，开发人员需要对使用了索尼的智能扩展API的代码进行编译，从而得到一个Android应用程序（即一个.apk程序，研究人员可以使用标准工具，如apktool，baksmali等对它们进行逆向）——但需要注意的是，只有将我们前面提到的两个应用程序都安装之后，该应用程序才能正常运行。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">因此，为了安装智能扩展程序，最终用户需要安装开发人员的apk，即Android应用程序。该应用程序由两个强制性应用程序之一的Smart Connect自动找到，并添加到相应的智能配件中。这样，新的智能扩展图标就会出现在智能手表上。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">需要注意的是，我们没有在智能手表本身上直接安装软件。事实上，根本就没有智能手表应用程序的概念。实际上，智能扩展的所有工作都是在智能手机上完成的。智能手表基本上只是充当一个远程显示器。智能扩展生成的各种事件和消息都是由两个强制性应用程序中的第二个，即SmartWatch 2 SW2生成的。这个应用程序实际上就是索尼所谓的主机应用程序，即专门用来跟给定智能附件（就本例而言，就是SW2）通信的Android应用程序。我们在表3和图5中对相关的术语进行了详细的解释，需要注意的是，其中一些很容易引起误解。</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t0181e4b253fbd90dfe.jpg" title="t010a609b96782eaf78.jpg" alt="http://p3.qhimg.com/t010a609b96782eaf78.jpg"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图5：索尼SmartWatch 2 SW2的架构。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:plain;toolbar:false">名称&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;说明
主机应用程序专门用于跟特定智能配件通信的Android应用程序的通用术语。
智能配件&nbsp;&nbsp;&nbsp;&nbsp;智能手表、智能耳机等的通用术语
Smart&nbsp;Connect这是必须安装在智能手机上才能使用智能手表的两个强制性Android应用程序之一。这是一个官方的索尼应用程序。它管理哪个扩展使用哪个配件。它的软件包名称是com.sonyericsson.extras.liveware。
智能扩展&nbsp;&nbsp;&nbsp;&nbsp;这是一个Android应用程序，它在手机上运行，但可从智能手表远程访问/控制。索尼提供了几个扩展（Twitter&nbsp;feed，Facebook&nbsp;feed，Chrono），并鼓励开发人员创建自己的扩展。
Smart&nbsp;Watch&nbsp;2&nbsp;SW&nbsp;2这是SW2的两个强制性Android应用程序中的另一个。实际上，它是SW2配件的主机应用程序。这是一个官方的索尼应用程序，该软件包名为com.sonymobile.smartconnect.smartwatch2。</pre><p style="text-align: center;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em; text-align: center;">表3：索尼的智能手表术语。</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192); font-size: 18px;"><strong><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">推论</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">知道了智能手表的架构之后，可以得到下列推论：对于智能手表上的任何扩展，实际上都可以通过逆向其Android应用程序的代码来进行安全分析。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">我们假设，需要考察发送SMS消息的扩展。智能手表本身没有什么可逆向的，相反，我们需要做的是反汇编相关的Android应用程序，这样，就能找到像smsManager.sendTextMessage（mPhoneNumber，null，message，...）这样的代码。如果智能手表恶意软件的确存在并在传播的话，防病毒供应商只需要为相应的Android应用程序写签名即可，这些事情正是他们所擅长的。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">此外，我们还可以对官方SmartWatch 2 SW2主机应用程序也进行逆向工程。逆向结果表明，与远程智能手表的通信是通过“Costanza”消息来进行处理的。这些消息由类型（消息类型），消息标识符和打包的缓冲区字节组成。打包或解包是通过名为“protocol”（libprotocol.so）的本机库进行处理的。一旦打包完毕，这些消息就可以通过蓝牙进行发送了——这里是通过Android API来打开蓝牙套接字的。Costanza消息的类型有多种，例如：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">电池电量指示（id = 18），电量水平以百分比形式表示。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">恢复出厂设置的请求和响应（id = 20或21）。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&#39;Force crash&#39;（id = 666）。源代码表明，这里有一个隐藏的调试界面，其中含有“Force crash on watch”按钮。这将创建以下消息：&nbsp;</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:plain;toolbar:false">public&nbsp;RequestForceCrash(int
newMessageId)&nbsp;{
super(newMessageId);
this.type&nbsp;=&nbsp;666;
this.mMagic&nbsp;=&nbsp;0xC057A72A;
}</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">注意类型666和魔法值，可能与前面讲过的&#39;costanza&#39;消息相匹配。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Fota请求（id = 6）。这可能意味着空中下载更新固件。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">传感器数据（请求或响应）（id = 127或128）。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">滑动指示（id = 116）。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">版本请求和响应（id = 4和5）。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">振动请求（id = 129），其中包括振动的持续时间等。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">这些消息的用法和标识符将很难通过其他方式找到（特别是在正常情况下不出现的Force Crash消息）。同样，这也证明了通过考察移动应用来分析物联网硬件是多么的有价值。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">安全报警器&nbsp;</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">Meian公司是一家家用安全报警器的制造商。该公司的一些报警器可通过SMS进行远程控制：您可以远程启动/停止报警器、获取其当前状态、启用/禁用某些监控区域等。当然，这些命令必须符合特定的格式，同时，还必须提供正确的密码。为了控制报警器，最终用户必须按照特定格式把相应的命令写入SMS，并将其发送到报警器。当报警器接收SMS后，会对传入的消息进行处理，并回复执行结果。由于Meian对于SMS消息的格式的要求非常严格，所以Meian专门实现了一个Android应用程序来自动格式化短信。在配置期间，最终用户需要提供报警器的具体配置：报警器的电话号码、管理密码、输入密码时可接受的延迟、紧急电话号码（如果检测到入侵，则拨打该号码）。然后，该应用程序就会提供用于启动/停止/获取警报的状态（等等）的各种按钮（参见图6），这给用户的操作带来了极大的便利。</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t0100697ed27b1d00fe.png" title="t016fd5567d0cf8ead4.png" alt="http://p3.qhimg.com/t016fd5567d0cf8ead4.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图6：用于远程控制家用安全报警器的Android应用程序的主屏幕。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">同样的，这里我们还是通过分析设备的移动应用程序来考察该设备的安全问题。这里存在两个安全问题：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">短信未删除。发送的短信会继续保留在智能手机上，除非手动删除。因此，如果攻击者能够读取它的话，就能得到报警器的密码。注意，无论最终用户是否使用该应用程序（手动写入SMS），都会出现此问题。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">报警器配置的弱保护。该应用程序使用了一个弱加密算法来保护配置数据（电话号码、密码、紧急电话号码和延迟。请注意，配置数据是非常敏感的，因为任何人都可以用它来控制报警器。攻击者可以轻松逆向该加密算法，从而解密所有的设置（参见图7中的概念证明）。该漏洞在2015年就报告给Meian [23]公司了，但是一直没有回应。在Play商店中的这个应用程序仍未修复该漏洞，截至目前已被下载了1,000到5,000次。</span></p><p style="text-align:center"><img src="http://p9.qhimg.com/t01ac4de5b283cd35fe.png" title="t014a75997f9b9a4990.png" alt="http://p7.qhimg.com/t014a75997f9b9a4990.png"/></p><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">图7：解密安全报警器的所有主要机密设置的概念证明。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">这个家用安全报警器的安全状态总结在表4中。遗憾的是，它的相关移动应用实际上给该设备的安全性带来了很大的麻烦，这也正是其他物联网设备正面临的问题之一。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">情形：攻击者可以获得报警器的密码或电话号码...	从发件箱的命令SMS中...？	一旦SMS消息被删除...？</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:plain;toolbar:false">手动SMS是否
使用Meian的Android应用程序是是</pre><p style="text-align: center; text-indent: 0em;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">表4：使用Android应用程序前后报警器的安全状况比较&nbsp;</span></p><p style="text-indent: 2em; text-align: left;"><br/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">结束语</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">物联网设备的安全分析具有很大的挑战性，主要是因为它们的多样性所导致的，有时研究人员根本就不知道如何开始或从哪里开始。本文表明，在这种情况下，我们不妨从相关的移动应用程序开始下手，因为它们通常会与物联网设备进行通信，这是一个不错的起点。此外，这些移动应用在物联网设备中是非常常见的。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在本文中，我们通过相关移动应用程序分析了三种不同的设备：智能牙刷，智能手表和家用安全报警器。在所有三个案例中下，我们所用的策略都能够快速揭示其安全设计、协议详细信息和相关漏洞。当然，这些信息也可以通过其他方式发现，例如蓝牙扫描和模糊测试，但这样会需要消耗更多的时间，因为我们不得不猜测多种可能，而移动应用程序逆向工程则能够直接给出结果。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">事实上，物联网和移动应用程序的结合会带来多个问题。为此，供应商应该设法完善设备的安全设计和实现，以及提高相关的移动应用的安全性。注意，对代码进行模糊处理的快速修复方案将很难奏效，而应该下大力气改进安全设计和实现。另外，防病毒行业需要为IoT恶意软件做好准备，无论来自设备本身还是来自移动应用程序。这可能是安全行业的下一个主战场。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">参考文献&nbsp;</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">[1] BI Intelligence. The internet of everything: 2015. <a href="http://uk.businessinsider.com/internetof-everything-2015-bi-2014-12?r=US&IR=T#like-this-decksubscribe-to-bi-intelligencebelow-6" _src="http://uk.businessinsider.com/internetof-everything-2015-bi-2014-12?r=US&IR=T#like-this-decksubscribe-to-bi-intelligencebelow-6">http://uk.businessinsider.com/internetof-everything-2015-bi-2014-12?r=US&amp;IR=T#like-this-decksubscribe-to-bi-intelligencebelow-6</a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">[2] StrategyAnalytics. Global Smartwatch Shipments Overtake Swiss Watch Shipments in Q4 2015. <a href="https://www.strategyanalytics.com/strategy-analytics/news/strategy-analyticspress-releases/strategyanalytics-press-release/2016/02/18/global-smartwatchshipments-overtake-swisswatch-shipments-in-q4-2015" _src="https://www.strategyanalytics.com/strategy-analytics/news/strategy-analyticspress-releases/strategyanalytics-press-release/2016/02/18/global-smartwatchshipments-overtake-swisswatch-shipments-in-q4-2015">https://www.strategyanalytics.com/strategy-analytics/news/strategy-analyticspress-releases/strategyanalytics-press-release/2016/02/18/global-smartwatchshipments-overtake-swisswatch-shipments-in-q4-2015</a></span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">#.Vs8cw0J59hH, February 2016</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">[3] Hewlett Packard. Internet of things research study. <a href="http://h20195.www2.hp.com/V2/GetDocument.aspx?docname=4AA5-4759ENW&cc=us&lc=en" _src="http://h20195.www2.hp.com/V2/GetDocument.aspx?docname=4AA5-4759ENW&cc=us&lc=en">http://h20195.www2.hp.com/V2/GetDocument.aspx?docname=4AA5-4759ENW&amp;cc=us&amp;lc=en</a></span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">, 2015.</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">[4] IDC. IDC Reveals Worldwide Internet of Things Predictions for 2015, December 2014. <a href="https://www.idc.com/getdoc.jsp?containerId=prUS25291514" _src="https://www.idc.com/getdoc.jsp?containerId=prUS25291514">https://www.idc.com/getdoc.jsp?containerId=prUS25291514</a></span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">.</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">[5] Accenture Consulting. Igniting growth in consumer technology. <a href="https://www.accenture.com/_acnmedia/PDF-3/Accenture-Igniting-Growthin-Consumer-Technology.pdf" _src="https://www.accenture.com/_acnmedia/PDF-3/Accenture-Igniting-Growthin-Consumer-Technology.pdf">https://www.accenture.com/_acnmedia/PDF-3/Accenture-Igniting-Growthin-Consumer-Technology.pdf</a></span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">.</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">[6] Baccelli, E.; Hahm, O.; Wählisch, M.; Guìnes, M.; Schmidt, T. RIOT: One OS to Rule Them All in the IoT. Research Report RR-8176, INRIA, December 2012.</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">[7] Contiki: The Open Source OS for the Internet of Things. <a href="http://www.contiki-os.org/" _src="http://www.contiki-os.org/">http://www.contiki-os.org/</a></span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">.</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">[8] Brillo. <a href="https://developers.google.com/brillo/" _src="https://developers.google.com/brillo/">https://developers.google.com/brillo/</a></span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">.</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">[9] Hernandez, G.; Arias, O.; Buentello, D.; Jin, Y. Smart Nest Thermostat: A Smart Spy in Your Home, 2014. BlackHat US.</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">[10] Buentello, D. Weaponizing your coffee pot. DerbyCon, 2013.</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">[11] Hospira Lifecare PCA Infusion Pump 412 Telnet Service weak authentication. CVE-2015-3459. <a href="http://www.scip.ch/en/?vuldb.75158" _src="http://www.scip.ch/en/?vuldb.75158">http://www.scip.ch/en/?vuldb.75158</a></span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">.</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">[12] Apvrille, A. Geek usages for your Fitbit Flex tracker. Hack.lu, October 2015. <a href="http://2015.hack.lu/archive/2015/fitbit-hackluslides.pdf" _src="http://2015.hack.lu/archive/2015/fitbit-hackluslides.pdf">http://2015.hack.lu/archive/2015/fitbit-hackluslides.pdf</a></span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">.</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">[13] Wueest, C. Quantified Self – A Path to Self-Enlightenment or Just a Security Nightmare?, 2014. BlackHat Europe.</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">[14] Wineberg, W. Internet of Things: Hacking 14 Devices, August 2015. DEFCON 23.</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">[15] Miessler, D. IoT Attack Surfaces, August 2015. DEFCON 23.</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">[16] Costin, A.; Zaddach, J.; Francillon, A.; Balzarotti, D. A large scale analysis of the security of embedded firmwares, 2014. BlackHat Europe.</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">[17] Zaddach, J.; Bruno, L.; Francillon, A.; Balzarotti, D. Avatar: A framework to support dynamic security analysis of embedded systems&#39; firmwares. Network and Distributed System Security (NDSS) Symposium, NDSS 14, February 2014.</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">[18] Higginbotham, S. Meet a startup building an insurance business around a connected toothbrush. Fortune. <a href="http://fortune.com/2015/06/26/connected-toothbrush-insurance/" _src="http://fortune.com/2015/06/26/connected-toothbrush-insurance/">http://fortune.com/2015/06/26/connected-toothbrush-insurance/</a></span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">.</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">[19] Apvrille, A. Insurance Fraud via Internet of Things, July 2015. <a href="http://blog.fortinet.com/post/insurance-fraud-via-internetof-things." _src="http://blog.fortinet.com/post/insurance-fraud-via-internetof-things.">http://blog.fortinet.com/post/insurance-fraud-via-internetof-things</a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">[20] Beam Technologies. <a href="https://www.beam.dental/tech" _src="https://www.beam.dental/tech">https://www.beam.dental/tech</a></span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">.</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">[21] gattlib. <a href="https://bitbucket.org/OscarAcena/pygattlib" _src="https://bitbucket.org/OscarAcena/pygattlib">https://bitbucket.org/OscarAcena/pygattlib</a></span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">.</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">[22] Nordic nRF Master Control Panel. <a href="https://www.nordicsemi.com/eng/Products/Nordic-mobile-Apps/nRF-Master-Control-Panel-application/(language)/eng-GB" _src="https://www.nordicsemi.com/eng/Products/Nordic-mobile-Apps/nRF-Master-Control-Panel-application/(language)/eng-GB">https://www.nordicsemi.com/eng/Products/Nordic-mobile-Apps/nRF-Master-Control-Panel-application/(language)/eng-GB</a></span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">.</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">[23] Fortinet Discovers Meian Safety Alarm Android Application Weak Credential Encryption Vulnerability. <a href="http://www.fortiguard.com/advisory/fortinet-discovers-meian-safety-alarm-android-application-weak-credential-encryption-vulnerability" _src="http://www.fortiguard.com/advisory/fortinet-discovers-meian-safety-alarm-android-application-weak-credential-encryption-vulnerability">http://www.fortiguard.com/advisory/fortinet-discovers-meian-safety-alarm-android-application-weak-credential-encryption-vulnerability</a></span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">.</span></p></p>
                <hr/>
                <p style="text-align: center;">
                    <img src="http://bobao.360.cn/img/app.jpeg"/>
                    <img src="http://bobao.360.cn/img/weixin.jpeg"/>
                </p>
                                <p>本文由 安全客 翻译，转载请注明“转自安全客”，并附上链接。<br/><a class="text-more" href="https://www.virusbulletin.com/virusbulletin/2016/11/vb2016-paper-mobile-applications-backdoor-internet-things/" target="_blank">原文链接：https://www.virusbulletin.com/virusbulletin/2016/11/vb2016-paper-mobile-applications-backdoor-internet-things/</a></p>
                            </div>
            <div style="margin-top: 20px;background-color:#FFFFFF">
    <input type="hidden" id="detail_title" name="detail_title" value="【技术分享】移动应用：进入物联网的后门？ - 安全客 - 有思想的安全新媒体" />
    <input type="hidden" id="use_nickname" name="use_nickname" value="0" />
    <a name="mao"></a>
    <div class="reg-log mobile-hiden">
        <div class="" id="userTo">   
            <div id="to-list" class="input-text" style="">
                <textarea disabled="disabled" class="hide"  id="comment-content" to="to"></textarea>
                <ul id="preadded" style="display:none">       
                </ul>
                <div id="to-auto" style="width: 200px">
                    <ul id="feed">
                    </ul>
                </div>
            </div>
        </div>
        <input type="hidden" id="source-id" value="3363" />
        <input type="hidden" id="source-type" value="learning" />
        <input type="hidden" id="post-comment-url" value="/comment/add" />
        <input type="hidden" id="post-nickname-url-ajax" value="/comment/randnicknameajax" />
        <input type="hidden" id="post-check-login-url-ajax" value="/comment/checklogin" />
        <input type="hidden" id="stoken_comment_set" value="ea3898fb4df38673fdeb61c458234054">                 <span class="join">参与讨论，请先 <a href="javascript:;" class="comment-login">登录</a> | <a href="javascript:;" class="comment-reg">注册</a> |  <a href="javascript:;" class="anonymous-comment">匿名评论</a></span>
            </div>
    <div class="mobile-hide" style="width: 870px; margin: 0 auto;">
        <label style="vertical-align:middle;" for="use_nickname">匿名</label> 
        <input style="vertical-align:middle;" id="trigger-nickname" name="use_nickname" class="use_nickname" type="checkbox" value="0" />

        <a href="javascript:;" class="apply-use button" id="submit-comment" data-target="/comment/add">发布</a>
    </div>


    <div class="clearfix"></div>
    <div class="comments">
        <div class="comments-head">
            <span class="title">用户评论</span>
        </div>
                <div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/12x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="7593" user-name="_等一分钟" href="javascript:;">
                _等一分钟            </a>
                        <span class="comment-time">2017-01-03 12:40:57</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="7593">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_7593" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">Repost</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/12x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="7592" user-name="_等一分钟" href="javascript:;">
                _等一分钟            </a>
                        <span class="comment-time">2017-01-03 12:40:39</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="7592">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_7592" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">Repost</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>

        <a class="more-long comment-more" href="javascript:;" data-target="/comment/more" data-type="learning" data-source-id="3363" data-page="2">查看更多</a>
            </div>
</div>
<script>
    $(function () {
        $('.anonymous-comment').click(function () {
            $(".join").hide();
            $(".reg-log textarea").first().removeAttr("disabled").show();
            $('#use_nickname').val('1');
//            $('#trigger-nickname').attr('checked', true);
            $('#trigger-nickname').trigger('click');
        });
        //为所有复选框绑定事件
//        checkbox_on_click();
        //ajax随机获取昵称
//        randnicknameajax(0);
        //ajax检测登录状态
        comment_check_login();
    });



    function input_checkbox(flag) {
        $('input:checkbox').each(function () {
            var value = flag ? 1 : 0;
            $(this).prop('checked', flag);
            $(this).val(value);
        });
    }

//ajax随机获取昵称
    function randnicknameajax(flag) {
        $.ajax({
            type: 'POST',
            url: $('#post-nickname-url-ajax').val(),
            data: {limit: 1, flag: flag},
            dataType: "json",
            success: function (data) {
                $('#nick-name').val(data.data[0]);
                _nick_name=data.data[0];
            }
        });
    }
    $();
//ajax检测登录状态
    function comment_check_login() {
        $.ajax({
            type: 'POST',
            url: $('#post-check-login-url-ajax').val(),
            data: {},
            dataType: "json",
            success: function (data) {
                if (data.success) {
                    $('.join').hide();
                    $(".reg-log textarea").first().removeAttr("disabled").show();
                    $("#span_use_nickname").show();
                    $('#use_nickname').val('0');
                    $('#use_nickname').attr('checked', false);
                }
            }
        });
    }
</script>        </div>
    </div>
    <div class="side-bar">
        <div class="mod hot-news">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-hot"></i><span>热门知识</span></h2>
    </div>
    <ul class="links-list">
                                <li><a href="/learning/detail/4411.html" alt="【漏洞预警】一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现——最新的Office高级威胁攻击预警" target="_blank">【漏洞预警】一个换行符引发的奥斯卡...</a></li>
                                <li><a href="/learning/detail/4416.html" alt="【漏洞预警】Microsoft .NET Framework漏洞（CVE–2017–8759）预警" target="_blank">【漏洞预警】Microsoft .NE...</a></li>
                                <li><a href="/learning/detail/4414.html" alt="【技术分享】妙用JavaScript绕过XSS过滤" target="_blank">【技术分享】妙用JavaScrip...</a></li>
                                <li><a href="/learning/detail/4418.html" alt="【技术分享】利用威胁情报数据平台拓展APT攻击线索一例" target="_blank">【技术分享】利用威胁情报数据平台拓...</a></li>
                                <li><a href="/learning/detail/4417.html" alt="【知识】9月15日 - 每日安全知识热点" target="_blank">【知识】9月15日 - 每日安全知识热...</a></li>
                                <li><a href="/learning/detail/4425.html" alt="【安全报告】XShellGhost事件技术回顾报告" target="_blank">【安全报告】XShellGhost事件...</a></li>
            </ul>
</div>        <!-- 友情链接 -->
        <div class="mod blog-links mobile-hide">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-link"></i><span>友情链接</span></h2>
        <a href="/links/index.html" class="more">更多<i></i></a>
    </div>
        <ul class="links-list">
                <li><a href="http://bbs.360safe.com" alt="360安全社区" target="_blank">360安全社区</a></li>
                <li><a href="http://zhuji.360.cn" alt="360主机卫士" target="_blank">360主机卫士</a></li>
                <li><a href="http://blogs.360.cn/" alt="奇虎360技术博客" target="_blank">奇虎360技术博客</a></li>
                <li><a href="http://wangzhan.360.cn/" alt="360网站卫士" target="_blank">360网站卫士</a></li>
                <li><a href="http://webscan.360.cn/" alt="360网站安全检测" target="_blank">360网站安全检测</a></li>
                <li><a href="http://research.360.cn/report/" alt="360研究报告" target="_blank">360研究报告</a></li>
                <li><a href="http://unicorn.360.cn/" alt="360 Unicorn Team" target="_blank">360 Unicorn Team</a></li>
                <li><a href="http://appscan.360.cn/" alt="360捉虫猎手" target="_blank">360捉虫猎手</a></li>
                <li><a href="https://threathunter.org/" alt="ThreatHunter社区" target="_blank">ThreatHunter社区</a></li>
                <li><a href="http://security.360.cn/" alt="360安全应急响应中心" target="_blank">360安全应急响应中心</a></li>
            </ul>
    </div>
        <!-- 联系我们 -->
        <div class="mod contact mobile-hide" style="text-align:center">
    <div class="head-bar clearfix">
        <h2><i></i><span>关注我们</span></h2>
    </div>
    <!-- 微信关注 -->
    <ul class="contact-way">
        <li><a>微信关注</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/qrcode_adlab_weixin.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
    <!-- APP下载 -->
    <ul class="contact-way">
        <li><a>安全播报APP</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/scan_code_big.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
</div>

    </div>
</div>

<script type="text/javascript" src="/js/jquery-ui.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/jquery.noty.packaged.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/common.js?v=4.5"></script>
<script>$(function() {sync_count('comment');});</script>


<!-- 语法高亮 -->
<script type="text/javascript" src="/ue/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">SyntaxHighlighter.all();sync_count('vul');sync_count('news');sync_count('learning');sync_count('activity');sync_count('course');sync_count('ctf');</script>
    </div>

        <div class="footer">
        <div class="friend-link">
            <a href="http://www.360.cn/" target="_blank">360首页</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">关于我们</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">联系我们</a>
            <span>|</span>
            <a href="/links/index.html" target="_blank">友情链接</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">招贤纳士</a>
        </div>
        <div class="copy">
            Copyright &copy; 360网络攻防实验室 All Rights Reserved <span class="copy_icp">京ICP证080047号[京ICP备08010314号-6]</span>
        </div>
    </div>
    
</div>

<!--奇舞团统计-->

<script src='https://s.ssl.qhimg.com/static/f5407c785655e6a1/monitor_analytic.js'></script>
<script>
    monitor.setProject('QH_171_1').getTrack().getClickAndKeydown().getClickHeatmap(10, 1);
</script>

<div class="hide">
    <script src="https://s95.cnzz.com/z_stat.php?id=1253147824&web_id=1253147824" language="JavaScript"></script>
</div>
<div class="backToTop_wrap off">
    <a id="back_to_top" class="backToTop" href="javascript:;" title="返回顶部"></a>
</div>
<script>
    var $backToTop_wrap = $(".backToTop_wrap"),
        $backToTop_btn = $("#back_to_top");

    if ($(window).scrollTop() > 100) {
        $backToTop_wrap.removeClass("off");
    }
    else {
        $backToTop_wrap.addClass("off");
    }

    $(window).on("scroll", function () {
        if ($(this).scrollTop() > 100) {
            $backToTop_wrap.removeClass("off");
        }
        else {
            $backToTop_wrap.addClass("off");
        }
    });

    $backToTop_btn.on("click", function () {
        $("html, body").animate({scrollTop: 0}, 120);
    });

    $(function () {
        var navlist = $('.nav-list > li');

        navlist.each(function () {
            $(this).on('mouseenter', function () {
                $(this).addClass('selected');
            });

            $(this).on('mouseleave', function () {
                $(this).removeClass('selected');
            });
        });
    })
</script>



</body>
</html>
