<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:wb="http://open.weibo.com/wb" xml:lang="en" lang="en">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <link rel="shortcut icon" href="http://bobao.360.cn/favicon.ico?v=1.1"/>
    <link rel="alternate" title="安全资讯" href="/rss?type=news" type="application/rss+xml"/>
    <link rel="alternate" title="安全知识" href="/rss?type=learning" type="application/rss+xml"/>
    <link rel="alternate" title="安全圈活动" href="/rss?type=activity" type="application/rss+xml"/>
    <link rel="alternate" title="所有漏洞" href="/rss?type=vul" type="application/rss+xml"/>
    <link rel="alternate" title="通用型漏洞" href="/rss?type=commonvul" type="application/rss+xml"/>
    <link rel="alternate" title="事件型漏洞" href="/rss?type=eventvul" type="application/rss+xml"/>
    <link rel="alternate" title="热门漏洞" href="/rss?type=hotvul" type="application/rss+xml"/>

        <title>手工测试SSL/TLS的脆弱性 - 安全客 - 有思想的安全新媒体</title>
    
        <meta name="keywords" content="手工测试,SSL/TLS,脆弱性"/>
    
        <meta name="description" content="该文章描绘了主要的SSL/TLS (mis)配置及简单的测试你系统的脆弱性。"/>
        <meta property="wb:webmaster" content="224437c7be31d633"/>

    <script type="text/javascript" src="http://s7.qhimg.com/!56caa871/xpc_sync_height.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/reset.css" />
    <link rel="stylesheet" type="text/css" href="/css/common_new.css?v=4.4.2.1" />
    <link rel="stylesheet" type="text/css" href="/css/jquery.notyfy.css" />
    <link rel="stylesheet" type="text/css" href="/css/notyfy.theme.default.css" />
    <link rel="stylesheet" type="text/css" href="/css/s_common.css?v=2.2.7" media="only screen and
    (max-device-width:900px), only screen and (max-width:900px)" />
    <script type="text/javascript" src="/js/jquery.min.js?v=3.1"></script>
    <script type="text/javascript" src="/js/jquery.notyfy.js"></script>
    <script type="text/javascript" src="/js/iscroll.js"></script>
    <script src="http://js.passport.qihucdn.com/5.0.3.js"></script>
    <script type="text/javascript">
        var myScroll, myNavScroll;

        function iscrollLoaded() {
            myScroll = new IScroll('#wrapper',
                {
                    scrollX: true,
                    scrollY: false,
                    bounceEasing: 'circular',
                    eventPassthrough: true,
                    preventDefault: false,
                    bounceTime: 500
                }
            );
        }

        $(function () {

            //导航横向滚动


            function setNavWidth() {

                /* 计算导航宽度 */
                var allWidth = $(window).width();
                var scroller = $('#scroller');

                if (allWidth > 900) {
                    scroller.find('ul').add(scroller.find('.scroll')).removeAttr('style');
                    scroller.css('overflow', 'visible');
                    if (myNavScroll) myNavScroll.destroy();
                } else {

                    var width = 0;
                    scroller.find('.scroll').children('ul').children('li').each(function (index, el) {
                        if (!$(this).hasClass('mobile-hide')) {
                            width += $(this).outerWidth();
                        }
                    });
                    scroller.find('ul').add(scroller.find('.scroll')).width(width);

                    if (myNavScroll) myNavScroll.destroy();

                    myNavScroll = new IScroll('#scroller', {
                        scrollX: true,
                        scrollY: false,
                        momentum: false,
                        click: true
                    });

                }

            }

            setNavWidth();
            $(window).resize(function (event) {
                setNavWidth();
            });

        });

    </script>
</head>
<body onload="iscrollLoaded();">
<div style='margin:0 auto;width:0px;height:0px;overflow:hidden;'>
    <img src=""/>
</div>

<div id="is-mobile"></div>
<div class="container">
        <div class="mobile-header">
        <div class="header clearfix">
            <div class="header-wrapper clearfix">
                <a href="/index/index" class="logo"><img class="slogan" src="/img/logo.png?v=1.5"/></a>
                                <form id="search" class="search-box" action="/search/index" method="GET">
                    <input class="keys" name="keywords" type="text" placeholder="搜索漏洞" required="required">
                    <input class="icon" type="submit" value="">
                    <input type="hidden" name="type" value=""/>
                </form>
                <div class="bug">
                    <div class="name"><span class="seled">全部</span><i class="arrow"></i></div>
                    <ul class="typelist">
                        <li data-index="3"><a href="javascript:void(0);">全部</a></li>
                        <li data-index="0"><a href="javascript:void(0);">漏洞</a></li>
                        <li data-index="1"><a href="javascript:void(0);">资讯</a></li>
                        <li data-index="2"><a href="javascript:void(0);">知识</a></li>
                    </ul>
                </div>
                                <div class="logNreg mobile-hide">
                    <div class="unlog">
                        <i></i>
                        <a href="log.html" class="log">登录</a>
                        <span>|</span>
                        <a href="reg.html" class="reg">注册</a>
                    </div>
                    <div class="loged">
                        <a href="/member/profile" class="user-center"><i></i><span class="user-name-tag">个人中心</span></a>
                        <div class="user-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting"><a href="http://i.360.cn/profile/accountmanage"
                                                               target="_blank"><i></i><span>账号设置</span></a></li>
                                <li class="alert-setting"><a href="/keywords/index"
                                                             target="_blank"><i></i><span>告警设置</span></a></li>
                                <li class="bug-alert"><a href="/myalarm/index" target="_blank"><i></i><span>漏洞告警</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mylearn/index" target="_blank"><i></i><span>我的知识</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mycourse/index" target="_blank"><i></i><span>我的课堂</span></a>
                                </li>
                                <li class="my-exit"><a
                                            href="http://login.360.cn/?src=pcw_adlab&op=logout&destUrl=http://bobao.360.cn"><i></i><span>退出系统</span></a>
                                </li>
                            </ul>
                        </div>

                        <a href="/message" class="message-center" target="_blank"><i></i><span>我的消息</span></a>
                        <div class="message-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting" style="display:none;"><a href="/myres/index"
                                                                                     target="_blank"><i></i><span>回复我的</span></a>
                                </li>
                                <li class="my-bug"><a href="/myvul/index"
                                                      target="_blank"><i></i><span>我的漏洞</span></a></li>
                                <!--<li class="my-bug"><a href="/myres/index" target="_blank"><i></i><span>我的评论</span></a></li>-->
                                <!--<li class="alert-setting"><a href="###" target="_blank"><i></i><span>提到我的</span></a>
                                </li>-->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <style type="text/css">
            .nav {
                overflow: hidden;
            }

            .nav .scroll {
                width: auto;
            }
        </style>
        <div id="wrapper">
            <div id="scroller" class="nav">
                <div class="scroll">
                    <ul class="nav-list">
                        <li ><a class="link-nav"
                                                                                 href="/index/index">首页</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/vul/index">漏洞</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/introduce/list">招聘</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/news/index">资讯</a><!--<i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/introduce/list">招聘</a></li>
                        </ul>
			-->
                        </li>
                        <li class="cur">
                        <a class="link-nav" href="/learning/index">知识</a><i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/course/index">学院</a></li>
                        </ul>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/activity/index">活动</a></li>
                        <li class="mobile-hide "><a class="link-nav"
                                                                                                   href="/ctf/index">CTF训练营</a>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/interref/list">安全内参</a></li>
                        <li ><a class="link-nav" href="/app/index">APP</a></li>

                        <!--<li ><a href="/course/index">学院</a></li>-->
                        <!--<li ><a href="/introduce/list">招聘</a></li>-->
                        <!--<li  class="mobile-hide"><a href="/ctf/index">CTF训练营</a></li>-->
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="mobile-content">
        <link rel="stylesheet" type="text/css" href="/css/news.css?v=3.5" />
<link rel="stylesheet" type="text/css" href="/ue/SyntaxHighlighter/shCoreDefault.css?v=1.0" />
<style>
    p .syntaxhighlighter {
        width: 80%;
    }
</style>

<div class="cur-pos w1000">当前位置：<a href="http://bobao.360.cn/">安全客</a> &gt;&gt; 知识详情</div>

<div class="content clearfix">
    <div class="main">
        <div class="article">
            <div id="article_box">
                <h2>手工测试SSL/TLS的脆弱性</h2>
                <div class="article-msg">
                    <span class="time">2015-06-26 13:48:46</span>
                                        <span class="read">阅读：61075次</span>
                    <span><a style="display: none;" class="good" href="javascript:;"
                             data-target="/learning/good" data-value="g_479"
                             data-type="learning">点赞(0)</a></span>
                    <span><a class="fav" href="javascript:;" data-target="/mylearning/add"
                             data-pk="479" data-type="learning">收藏</a></span>
                                        <span><a style="margin-left: 4px;" class="fav" href="http://www.contextis.com/resources/blog/manually-testing-ssltls-weaknesses/"
                             target="_blank">来源： 360安全播报</a></span>
                    
                                    </div>
                <hr size="1">
                <div class="article-msg">
                    <p><!-- JiaThis Button BEGIN -->

<!--
<span class="jiathis_style"><span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_tsina"></a>
    <a class="jiathis_button_tqq"></a>
    <a class="jiathis_button_qzone"></a>
    <a class="jiathis_button_renren"></a>
    <a class="jiathis_button_xiaoyou"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
</span>

-->
</p>
                </div>
                <p><p style="text-align:center"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"><img alt="http://p3.qhimg.com/t0182b83293987278e5.jpg" src="http://p3.qhimg.com/t0182b83293987278e5.jpg" title="t0182b83293987278e5.jpg"/></span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">该文章描绘了主要的SSL/TLS (mis)配置及简单的测试你系统的脆弱性。如下为已考虑到的配置和攻击相关的内容。</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">SSLv2 Support</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">SSLv3 Support</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">Cipher Suites</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">SSL Certificates</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">Renegotiation</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">Compression</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">Implementation Issues</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(255, 0, 0);">在二十年以前发布了SSLv2并且就在发布不久后，被发现其存在严重的缺陷，它允许攻击者解密并修改通信流量。在一年之后被替代为SSLv3(已发现这些问题)，但是短寿命的SSLv2仍然非常普遍。</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">检查远程host是否开启了SSLv2，可以使用如下命令：</span></p><pre class="brush:bash;toolbar:false">openssl&nbsp;s_client&nbsp;–ssl2&nbsp;-connect&nbsp;example.com:443</pre><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">如果支持SSLv2，那么将完成握手包并且返回服务器的授权信息，如下为响应内容：</span></p><pre class="brush:html;toolbar:false">openssl&nbsp;s_client&nbsp;-ssl2&nbsp;-connect&nbsp;10.0.0.1:443
CONNECTED(00000003)
depth=0&nbsp;/C=AU/ST=/L=/O=Context/OU=context/CN=sslserver
verify&nbsp;error:num=18:self&nbsp;signed&nbsp;certificate
verify&nbsp;return:1
depth=0&nbsp;/C=AU/ST=/L=/O=Context/OU=context/CN=sslserver
verify&nbsp;return:1
---
Server&nbsp;certificate
-----BEGIN&nbsp;CERTIFICATE-----
MIICnjCCAgugAwIBAgIJAPB2liVH7xRsMA0GCSqGSIb3DQEBBQUAMGwxCzAJBgNV
BAYTAkFVMREwDwYDVQQIDAhWaWN0b3JpYTESMBAGA1UEBwwJTWVsYm91cm5lMRAw
DgYDVQQKDAdDb250ZXh0MRAwDgYDVQQLDAdQbGF5cGVuMRIwEAYDVQQDDAlzc2xz
ZXJ2ZXIwHhcNMTQwMTE3MDMwNjAxWhcNMTcxMDEzMDMwNjAxWjBsMQswCQYDVQQG
EwJBVTERMA8GA1UECAwIVmljdG9yaWExEjAQBgNVBAcMCU1lbGJvdXJuZTEQMA4G
A1UECgwHQ29udGV4dDEQMA4GA1UECwwHUGxheXBlbjESMBAGA1UEAwwJc3Nsc2Vy
dmVyMIGbMA0GCSqGSIb3DQEBAQUAA4GJADCBhQJ+AJdlQF95PWaFnmN0hQd5BYUf
SALBHBDO+JkNIPj5evYEAoPql3Am6Uphv3Pxyd+scDowb7UrReH8dBltxfz0Id4V
3wpSJRdwo4Gx8xx27tLjDqbTaPKfSRWGpr0s2S2KJerr3XJvTDtWoiHN3zsx5kLU
qvKTm+3LNHp7DgwNAgMBAAGjUDBOMB0GA1UdDgQWBBS5W+orwrw8K5LuFRykGg9w
1DCanzAfBgNVHSMEGDAWgBS5W+orwrw8K5LuFRykGg9w1DCanzAMBgNVHRMEBTAD
AQH/MA0GCSqGSIb3DQEBBQUAA34AegQVwKLQseAu7krFdsrfL117Sfpk7BuucJXJ
nNbg9WRKFk5raikmp1nc5zLRZ4c6waDSX/rrT2g06IXSAJXmv5d2NYU+5YECJnY5
ApexOlQJvsunKXZdJvBC6FijyLGi8G9zbA5S++JQkXWtiiICPGF2afYI5ahBgGO2
hgE=
-----END&nbsp;CERTIFICATE-----
subject=/C=AU/ST=/L=/O=Context/OU=context/CN=sslserver
issuer=/C=AU/ST=/L=/O=Context/OU=context/CN=sslserver&nbsp;---
No&nbsp;client&nbsp;certificate&nbsp;CA&nbsp;names&nbsp;sent
---
Ciphers&nbsp;common&nbsp;between&nbsp;both&nbsp;SSL&nbsp;endpoints:
RC4-MD5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXP-RC4-MD5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RC2-CBC-MD5&nbsp;&nbsp;&nbsp;
EXP-RC2-CBC-MD5&nbsp;DES-CBC-MD5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DES-CBC3-MD5
---
SSL&nbsp;handshake&nbsp;has&nbsp;read&nbsp;807&nbsp;bytes&nbsp;and&nbsp;written&nbsp;233&nbsp;bytes
---
New,&nbsp;SSLv2,&nbsp;Cipher&nbsp;is&nbsp;DES-CBC3-MD5
Server&nbsp;public&nbsp;key&nbsp;is&nbsp;1000&nbsp;bit
Secure&nbsp;Renegotiation&nbsp;IS&nbsp;NOT&nbsp;supported
Compression:&nbsp;NONE
Expansion:&nbsp;NONE
SSL-Session:
&nbsp;&nbsp;&nbsp;&nbsp;Protocol&nbsp;&nbsp;:&nbsp;SSLv2
&nbsp;&nbsp;&nbsp;&nbsp;Cipher&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;DES-CBC3-MD5
&nbsp;&nbsp;&nbsp;&nbsp;Session-ID:&nbsp;3BD641677102DBE9BDADF9B990D2D716
&nbsp;&nbsp;&nbsp;&nbsp;Session-ID-ctx:
&nbsp;&nbsp;&nbsp;&nbsp;Master-Key:&nbsp;D2AAB3751263EB53BAD83453D26A09DA1F700059FD16B510
&nbsp;&nbsp;&nbsp;&nbsp;Key-Arg&nbsp;&nbsp;&nbsp;:&nbsp;DB92A6A80BF4CA4A
&nbsp;&nbsp;&nbsp;&nbsp;Start&nbsp;Time:&nbsp;1390178607
&nbsp;&nbsp;&nbsp;&nbsp;Timeout&nbsp;&nbsp;&nbsp;:&nbsp;300&nbsp;(sec)
&nbsp;&nbsp;&nbsp;&nbsp;Verify&nbsp;return&nbsp;code:&nbsp;18&nbsp;(self&nbsp;signed&nbsp;certificate)</pre><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">如果服务器不支持SSLv2，那么将出现握手失败错误，如下所示：</span></p><pre class="brush:html;toolbar:false">CONNECTED(00000003)
458:error:1407F0E5:SSL&nbsp;routines:SSL2_WRITE:ssl&nbsp;handshake&nbsp;failure:s2_pkt.c:428:
SSLv3&nbsp;Support</pre><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">谷歌安全团队更深入的透露道：某一攻击者可强迫客户端和服务器对SSLv3进行降级处理。即使他们将像平时那样使用TLS，也意味着应该确保完全关闭SSLv3。</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">测试某一系统是否支持SSLv3，可使用OpenSSL命令，如下所示：</span></p><pre class="brush:bash;toolbar:false">openssl&nbsp;s_client&nbsp;-ssl3&nbsp;-connect&nbsp;google.com:443</pre><pre class="brush:html;toolbar:false">CONNECTED(00000003)
depth=2&nbsp;/C=US/O=GeoTrust&nbsp;Inc./CN=GeoTrust&nbsp;Global&nbsp;CA
verify&nbsp;error:num=20:unable&nbsp;to&nbsp;get&nbsp;local&nbsp;issuer&nbsp;certificate
verify&nbsp;return:0
---
Certificate&nbsp;chain
---&nbsp;Certificate&nbsp;details&nbsp;removed&nbsp;for&nbsp;brevity&nbsp;---
---
New,&nbsp;TLSv1/SSLv3,&nbsp;Cipher&nbsp;is&nbsp;RC4-SHA
Server&nbsp;public&nbsp;key&nbsp;is&nbsp;2048&nbsp;bit
Secure&nbsp;Renegotiation&nbsp;IS&nbsp;supported
Compression:&nbsp;NONE
Expansion:&nbsp;NONE
SSL-Session:
&nbsp;&nbsp;&nbsp;&nbsp;Protocol&nbsp;&nbsp;:&nbsp;SSLv3
&nbsp;&nbsp;&nbsp;&nbsp;Cipher&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;RC4-SHA
&nbsp;&nbsp;&nbsp;&nbsp;Session-ID:&nbsp;6E461AEAD8C1516F9D8950A9B5E735F9882BFC6EA0838D81CFD41C01A3799A41
&nbsp;&nbsp;&nbsp;&nbsp;Session-ID-ctx:
&nbsp;&nbsp;&nbsp;&nbsp;Master-Key:&nbsp;7E7680640BB7E2C83CBE87342727E0D09AC10EEEB095A8C0A2501EAE80FA1C20D3F3FE4346B1234057D6D506420273FA
&nbsp;&nbsp;&nbsp;&nbsp;Key-Arg&nbsp;&nbsp;&nbsp;:&nbsp;None
&nbsp;&nbsp;&nbsp;&nbsp;Start&nbsp;Time:&nbsp;1421296281
&nbsp;&nbsp;&nbsp;&nbsp;Timeout&nbsp;&nbsp;&nbsp;:&nbsp;7200&nbsp;(sec)
&nbsp;&nbsp;&nbsp;&nbsp;Verify&nbsp;return&nbsp;code:&nbsp;0&nbsp;(ok)
---</pre><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">发生握手失败错误表明并不支持使用SSLv3，并且服务器并不存在漏洞（用于进行POODLE攻击。)</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">Cipher Suites</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">SSL/TLS协议的主要功能之一是允许客户端和服务器处理某一相互的可接受的&quot;cipher suite&quot;，在连接中使用到它。cipher suite已选用了特定的算法集，在客户端和服务器，进行密钥交换，加密和授权信息时将会使用到它们。</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">用类型格式描述cipher suite：</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">TLS_RSA_WITH_AES_128_CBC_SHA</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">RSA是密钥的交换算法，AES_128_CBC是加密cipher（在Cipher-Block Chaining模式中，AES使用一128位密钥操作），且SHA是Message Authentication Code (MAC)算法。</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">通过配置（由它的安全需求来规定)来支持cipher suites。如下指导路线通常被推荐为基础路线：</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">对于那些提供&quot;perfect forward secrecy&quot;的来说,密钥交换算法应该被限制，如Ephemeral Diffie-Hellman (DHE) 或 Ephemeral Elliptic Curve Diffie-Hellman (ECDHE)。</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">Cipher不应该有众所周知的加密缺陷。这排除RC4,它在许多年里一直存在缺陷且在过去的一些年里展示了比想象中更严重的脆弱性。</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">Cipher应使用至少一个128位的密钥(排除使用DES和Triple-DES)。</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">Cipher-Block Chaining (CBC)模式易于实现填充oracle攻击且应该避免使用这种模式，但重要的是它不应该被使用于SSLv3 或 TLSv1.0，因为它可导致能实现BEAST攻击的漏洞。某一可替代的是Galois Counter Mode (GCM)，它并不受这些问题和提供已授权加密的影响。</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">消息授权算法应该是SHA256.众所周知MD5存在缺陷且应该避免在加密时使用它，并且SHA1也有它脆弱的地方（容易实现的区域）。</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">三种算法，应该避免NULL/之后的设置，因为这些设置一点也不安全。&quot;Export&quot;算法也应该被停用，因为它们简短的长度容易让攻击者实现暴力破解攻击及其它的攻击，如：FREAK攻击。</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">Nmap的 &quot;ssl-enum-ciphers&quot; 脚本用如下方法来生产大量cipher suites：</span></p><pre class="brush:bash;toolbar:false">nmap&nbsp;--script&nbsp;ssl-enum-ciphers&nbsp;-p&nbsp;443&nbsp;example.com</pre><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">例如:</span></p><pre class="brush:bash;toolbar:false">nmap&nbsp;--script&nbsp;ssl-enum-ciphers&nbsp;-p&nbsp;443&nbsp;10.0.0.1
Nmap&nbsp;scan&nbsp;report&nbsp;for&nbsp;10.0.0.1
PORT&nbsp;&nbsp;&nbsp;&nbsp;STATE&nbsp;SERVICE&nbsp;REASON
443/tcp&nbsp;open&nbsp;&nbsp;https&nbsp;&nbsp;&nbsp;syn-ack
|&nbsp;ssl-enum-ciphers:
|&nbsp;&nbsp;&nbsp;SSLv3
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ciphers&nbsp;(6)
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA&nbsp;-&nbsp;unknown&nbsp;strength
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA&nbsp;-&nbsp;weak
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TLS_DH_anon_EXPORT_WITH_RC4_40_MD5&nbsp;-&nbsp;broken
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TLS_DHE_RSA_WITH_AES_128_CBC_SHA&nbsp;-&nbsp;strong
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TLS_DHE_RSA_WITH_AES_256_CBC_SHA&nbsp;-&nbsp;unknown&nbsp;strength
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TLS_RSA_WITH_3DES_EDE_CBC_SHA&nbsp;-&nbsp;strong
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TLS_RSA_WITH_AES_128_CBC_SHA&nbsp;-&nbsp;strong
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TLS_RSA_WITH_AES_256_CBC_SHA&nbsp;-&nbsp;unknown&nbsp;strength
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Compressors&nbsp;(1)
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uncompressed
|&nbsp;&nbsp;&nbsp;TLSv1.0
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ciphers&nbsp;(6)
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA&nbsp;-&nbsp;unknown&nbsp;strength
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TLS_DHE_RSA_WITH_AES_128_CBC_SHA&nbsp;-&nbsp;strong
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TLS_DHE_RSA_WITH_AES_256_CBC_SHA&nbsp;-&nbsp;unknown&nbsp;strength
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TLS_RSA_WITH_3DES_EDE_CBC_SHA&nbsp;-&nbsp;strong
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TLS_RSA_WITH_AES_128_CBC_SHA&nbsp;-&nbsp;strong
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TLS_RSA_WITH_AES_256_CBC_SHA&nbsp;-&nbsp;unknown&nbsp;strength
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Compressors&nbsp;(1)
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uncompressed
|_</pre><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">当nmap将为每个支持的cipher suite给出一个加密强度时，快速的改变了SSL/TLS的安全，这意味着这些ratings应该手动审计。</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">SSL Certificates</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">可使用如下命令查看某一服务器授权的细节：</span></p><pre class="brush:bash;toolbar:false">openssl&nbsp;s_client&nbsp;-connect&nbsp;example.com:443&nbsp;|&nbsp;openssl&nbsp;x509&nbsp;-noout&nbsp;-text
This&nbsp;will&nbsp;produce&nbsp;output&nbsp;similar&nbsp;to&nbsp;the&nbsp;following&nbsp;(here&nbsp;PayPal&#39;s&nbsp;certificate&nbsp;is&nbsp;shown):</pre><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">这将输出如下（这里展示了PayPal的授权情况）：</span></p><pre class="brush:html;toolbar:false">Certificate:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Data:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Version:&nbsp;3&nbsp;(0x2)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Serial&nbsp;Number:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0e:65:41:91:6c:e8:cf:b2:9b:7b:52:71:01:05:ba:c4
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Signature&nbsp;Algorithm:&nbsp;sha256WithRSAEncryption
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Issuer:&nbsp;C=US,&nbsp;O=DigiCert&nbsp;Inc,&nbsp;OU=www.digicert.com,&nbsp;CN=DigiCert&nbsp;SHA2&nbsp;High&nbsp;Assurance&nbsp;Server&nbsp;CA
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Validity
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Not&nbsp;Before:&nbsp;Dec&nbsp;12&nbsp;00:00:00&nbsp;2014&nbsp;GMT
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Not&nbsp;After&nbsp;:&nbsp;Dec&nbsp;16&nbsp;12:00:00&nbsp;2016&nbsp;GMT
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Subject:&nbsp;C=US,&nbsp;ST=California,&nbsp;L=San&nbsp;Jose,&nbsp;O=PayPal,&nbsp;Inc.,&nbsp;OU=PayPal&nbsp;Production,&nbsp;CN=paypal.com
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Subject&nbsp;Public&nbsp;Key&nbsp;Info:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Public&nbsp;Key&nbsp;Algorithm:&nbsp;rsaEncryption
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Public-Key:&nbsp;(2048&nbsp;bit)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Modulus:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;00:d5:c8:b2:65:07:ff:fb:71:0a:cf:a8:77:97:fc:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e1:a4:87:5d:79:29:03:e0:1a:5f:c2:f8:71:c9:ac:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bc:d3:16:e0:9c:2e:bb:d9:1c:5b:cc:90:7d:e3:54:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ab:53:79:50:37:63:b1:cb:68:56:ee:6a:5b:d2:10:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;38:1a:35:f7:37:12:83:d9:72:51:9e:b7:f9:9c:1d:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b8:a9:e6:f3:27:bb:5b:8b:b9:be:fa:39:19:83:d9:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cd:66:69:1d:cc:8a:cb:59:b5:53:3e:ca:41:f6:ac:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;89:4d:58:06:04:a5:e2:c9:94:05:26:6c:24:a6:81:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ca:4a:01:11:4c:a2:8d:83:7a:9a:2a:7d:16:93:ca:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a0:df:59:b8:e1:38:18:b2:bd:eb:77:6b:57:fb:7f:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d6:70:e1:2d:70:dd:cc:af:43:f0:de:a0:fc:2f:8e:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;94:74:3c:4f:ae:ca:f6:f2:ab:09:7f:63:71:b6:27:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;78:4d:f8:e1:e0:86:3a:81:9f:d4:55:45:27:ff:4d:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;53:2f:99:43:28:ad:fa:c9:63:6f:64:28:36:d7:ea:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3:00:50:88:86:a3:d0:83:ae:be:99:18:25:b2:44:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;05:c6:e8:36:4a:fb:4d:ab:df:6d:0f:50:3f:80:fc:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;38:ba:4c:53:c1:6d:48:22:68:7a:ed:6e:05:e4:9d:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;58:ef
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exponent:&nbsp;65537&nbsp;(0x10001)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X509v3&nbsp;extensions:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X509v3&nbsp;Authority&nbsp;Key&nbsp;Identifier:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keyid:51:68:FF:90:AF:02:07:75:3C:CC:D9:65:64:62:A2:12:B8:59:72:3B
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X509v3&nbsp;Subject&nbsp;Key&nbsp;Identifier:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1F:54:C7:2D:0E:D3:6C:C4:63:FE:66:1C:EA:8C:50:75:3A:01:8F:DE
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X509v3&nbsp;Subject&nbsp;Alternative&nbsp;Name:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DNS:paypal.com,&nbsp;DNS:www.paypal.com
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X509v3&nbsp;Key&nbsp;Usage:&nbsp;critical
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Digital&nbsp;Signature,&nbsp;Key&nbsp;Encipherment
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X509v3&nbsp;Extended&nbsp;Key&nbsp;Usage:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TLS&nbsp;Web&nbsp;Server&nbsp;Authentication,&nbsp;TLS&nbsp;Web&nbsp;Client&nbsp;Authentication
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X509v3&nbsp;CRL&nbsp;Distribution&nbsp;Points:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Full&nbsp;Name:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;URI:http://crl3.digicert.com/sha2-ha-server-g3.crl
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Full&nbsp;Name:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;URI:http://crl4.digicert.com/sha2-ha-server-g3.crl
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X509v3&nbsp;Certificate&nbsp;Policies:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Policy:&nbsp;2.16.840.1.114412.1.1
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CPS:&nbsp;https://www.digicert.com/CPS
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Authority&nbsp;Information&nbsp;Access:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OCSP&nbsp;-&nbsp;URI:http://ocsp.digicert.com
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CA&nbsp;Issuers&nbsp;-&nbsp;URI:http://cacerts.digicert.com/DigiCertSHA2HighAssuranceServerCA.crt
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;X509v3&nbsp;Basic&nbsp;Constraints:&nbsp;critical
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CA:FALSE
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Signature&nbsp;Algorithm:&nbsp;sha256WithRSAEncryption
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3d:79:69:48:5d:f6:bc:4b:5f:81:f3:97:9d:61:e5:9c:46:b9:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;73:00:66:09:f1:8a:06:89:14:a3:25:ea:ba:a2:5d:ac:77:3a:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8f:6a:8a:11:9b:c3:35:67:99:9f:9d:c2:c0:ac:9f:eb:24:58:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c8:4a:be:07:31:30:8c:69:07:bc:ff:c0:5a:d1:17:c6:05:f7:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;75:ca:fe:cd:98:78:43:41:ac:14:75:f7:c9:10:f4:07:38:58:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;73:6a:84:58:1f:a9:31:7d:28:47:70:98:de:3f:d7:00:82:a6:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5c:2e:5d:31:96:4a:06:82:a2:a0:02:95:fd:6f:ef:66:4a:57:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;50:c3:1a:84:48:26:47:73:6e:c8:d7:30:fb:75:11:d6:ee:67:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7e:d4:15:b2:44:15:ef:ee:ab:ba:81:c2:f5:05:04:d1:f3:70:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bb:96:41:03:eb:d1:e0:e4:3d:57:41:8d:3d:7a:df:f0:c1:68:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6f:43:68:e1:8d:1e:19:7e:57:aa:49:43:28:2a:f1:8c:f7:0d:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a4:6a:8c:18:75:6b:a4:cc:a7:2f:e5:21:d1:81:8c:d4:bc:f4:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;00:4c:f6:37:03:a3:61:33:b2:ea:15:34:48:53:83:48:57:6c:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;33:f2:b7:fb:f3:fc:ea:df:0d:d0:e2:49:01:b4:23:c9:3d:7a:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f4:42:4f:98
Renegotiation</pre><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">在某一会话期间，SSL/TLS协议允许客户端和服务器重新审查新的加密密钥。2009年发现了某一漏洞，它展示了在重新审查过程中利用该缺陷的方法并将内容注入到会话起始部分，这样就攻陷了会话部分的内容。</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">如果满足两个条件，那么将可能发生类似事件，命名的服务器不支持安全的重新审查，但是支持已初始化客户端的重新审查。这些条件可被检查到，如下所述：</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">Secure Renegotiation<br/></span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">如下示范如何识别某一系统是否支持Secure Renegotiation：</span></p><pre class="brush:bash;toolbar:false">openssl&nbsp;s_client&nbsp;-connect&nbsp;example.com:443</pre><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">如果某一系统不支持secure renegotiation，那么在建立连接后将返回如下：</span></p><pre class="brush:html;toolbar:false">CONNECTED(00000003)
139677333890704:error:1407F0E5:SSL&nbsp;routines:SSL2_WRITE:ssl&nbsp;handshake&nbsp;failure:s2_pkt.c:429:
---
no&nbsp;peer&nbsp;certificate&nbsp;available
---
No&nbsp;client&nbsp;certificate&nbsp;CA&nbsp;names&nbsp;sent
---
SSL&nbsp;handshake&nbsp;has&nbsp;read&nbsp;0&nbsp;bytes&nbsp;and&nbsp;written&nbsp;36&nbsp;bytes
---
New,&nbsp;(NONE),&nbsp;Cipher&nbsp;is&nbsp;(NONE)
Secure&nbsp;Renegotiation&nbsp;IS&nbsp;NOT&nbsp;supported
Compression:&nbsp;NONE
Expansion:&nbsp;NONE
SSL-Session:
&nbsp;&nbsp;&nbsp;&nbsp;Protocol&nbsp;&nbsp;:&nbsp;SSLv2
&nbsp;&nbsp;&nbsp;&nbsp;Cipher&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;0000
&nbsp;&nbsp;&nbsp;&nbsp;Session-ID:
&nbsp;&nbsp;&nbsp;&nbsp;Session-ID-ctx:
&nbsp;&nbsp;&nbsp;&nbsp;Master-Key:
&nbsp;&nbsp;&nbsp;&nbsp;Key-Arg&nbsp;&nbsp;&nbsp;:&nbsp;None
&nbsp;&nbsp;&nbsp;&nbsp;PSK&nbsp;identity:&nbsp;None
&nbsp;&nbsp;&nbsp;&nbsp;PSK&nbsp;identity&nbsp;hint:&nbsp;None
&nbsp;&nbsp;&nbsp;&nbsp;SRP&nbsp;username:&nbsp;None
&nbsp;&nbsp;&nbsp;&nbsp;Start&nbsp;Time:&nbsp;1428910482
&nbsp;&nbsp;&nbsp;&nbsp;Timeout&nbsp;&nbsp;&nbsp;:&nbsp;300&nbsp;(sec)
&nbsp;&nbsp;&nbsp;&nbsp;Verify&nbsp;return&nbsp;code:&nbsp;0&nbsp;(ok)
---
Client&nbsp;Initiated&nbsp;Renegotiation</pre><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">如下命令用于识别是否支持client initiated renegotiation：</span></p><pre class="brush:bash;toolbar:false">openssl&nbsp;s_client&nbsp;-connect&nbsp;example.com:443</pre><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">一旦建立好连接，服务器将等待我们来输入下一命令。为了初始化第二行通过R定义的某一renegotiation，我们可以写入如下两行，通过进入或返回继续进行：</span><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"><br/></span></p><pre class="brush:bash;toolbar:false">openssl&nbsp;s_client&nbsp;-connect&nbsp;host:port</pre><pre class="brush:html;toolbar:false">HEAD&nbsp;/&nbsp;HTTP/1.0
R
&lt;Enter&nbsp;or&nbsp;Return&nbsp;key&gt;</pre><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">某一系统不支持<span style="font-size: 14px; font-family: 微软雅黑,Microsoft YaHei; text-indent: 2em;">客户端（已初始化的renegotiation）将返回错误并中断连接，或连接将会超时：</span></span></p><pre class="brush:html;toolbar:false">RENEGOTIATING
write:errno=104</pre><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">某一支持客户端（已初始化的renegotiation）的系统将保持连接的活跃并响应更多的命令。</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">Compression</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">测试支持的TLS是否可压缩，并且测试其是否可实现CRIME攻击，用如下方法:</span></p><pre class="brush:bash;toolbar:false">openssl&nbsp;s_client&nbsp;-connect&nbsp;example.com:443</pre><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">在支持压缩的服务器上，某一响应类似于如下接收到的内容，其包括压缩细节。行&quot;Compression: zlib compression&quot; 和&quot;Compression: 1 (zlib compression)&quot;指明远程服务器有可实现CRIME攻击的漏洞。</span></p><pre class="brush:html;toolbar:false">---
New,&nbsp;TLSv1/SSLv3,&nbsp;Cipher&nbsp;is&nbsp;DHE-RSA-AES256-SHA
Server&nbsp;public&nbsp;key&nbsp;is&nbsp;2048&nbsp;bit
Secure&nbsp;Renegotiation&nbsp;IS&nbsp;supported
Compression:&nbsp;zlib&nbsp;compression
Expansion:&nbsp;zlib&nbsp;compression
SSL-Session:
&nbsp;&nbsp;&nbsp;&nbsp;Protocol&nbsp;&nbsp;:&nbsp;TLSv1.1
&nbsp;&nbsp;&nbsp;&nbsp;Cipher&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;DHE-RSA-AES256-SHA
&nbsp;&nbsp;&nbsp;&nbsp;Session-ID:&nbsp;50791A02E03E42F8983344B25C8ED4598620518D5C917A3388239AAACE991858
&nbsp;&nbsp;&nbsp;&nbsp;Session-ID-ctx:
&nbsp;&nbsp;&nbsp;&nbsp;Master-Key:&nbsp;9FEDB91F439775B49A5C49342FF53C3DD7384E4AFC33F9C6AFB64EA3D639CA57253AD7D059BA54E01581AD3A73306342
&nbsp;&nbsp;&nbsp;&nbsp;Key-Arg&nbsp;&nbsp;&nbsp;:&nbsp;None
&nbsp;&nbsp;&nbsp;&nbsp;PSK&nbsp;identity:&nbsp;None
&nbsp;&nbsp;&nbsp;&nbsp;PSK&nbsp;identity&nbsp;hint:&nbsp;None
&nbsp;&nbsp;&nbsp;&nbsp;SRP&nbsp;username:&nbsp;None
&nbsp;&nbsp;&nbsp;&nbsp;TLS&nbsp;session&nbsp;ticket&nbsp;lifetime&nbsp;hint:&nbsp;300&nbsp;(seconds)
&nbsp;&nbsp;&nbsp;&nbsp;TLS&nbsp;session&nbsp;ticket:
&nbsp;&nbsp;&nbsp;&nbsp;0000&nbsp;-&nbsp;34&nbsp;38&nbsp;24&nbsp;70&nbsp;35&nbsp;88&nbsp;4a&nbsp;68-0c&nbsp;80&nbsp;e6&nbsp;c5&nbsp;76&nbsp;a1&nbsp;0e&nbsp;ee&nbsp;&nbsp;&nbsp;48$p5.Jh....v...
&nbsp;&nbsp;&nbsp;&nbsp;0010&nbsp;-&nbsp;14&nbsp;2e&nbsp;fb&nbsp;ef&nbsp;fa&nbsp;42&nbsp;f0&nbsp;c1-58&nbsp;ee&nbsp;70&nbsp;02&nbsp;90&nbsp;45&nbsp;f4&nbsp;8c&nbsp;&nbsp;&nbsp;.....B..X.p..E..
&nbsp;&nbsp;&nbsp;&nbsp;0020&nbsp;-&nbsp;7d&nbsp;0b&nbsp;2e&nbsp;1e&nbsp;71&nbsp;70&nbsp;b0&nbsp;a2-cc&nbsp;27&nbsp;1b&nbsp;13&nbsp;29&nbsp;cc&nbsp;f5&nbsp;ee&nbsp;&nbsp;&nbsp;}...qp...&#39;..)...
&nbsp;&nbsp;&nbsp;&nbsp;0030&nbsp;-&nbsp;84&nbsp;43&nbsp;98&nbsp;fa&nbsp;b1&nbsp;ae&nbsp;83&nbsp;dc-ff&nbsp;6d&nbsp;aa&nbsp;07&nbsp;9f&nbsp;7a&nbsp;95&nbsp;4f&nbsp;&nbsp;&nbsp;.C.......m...z.O
&nbsp;&nbsp;&nbsp;&nbsp;0040&nbsp;-&nbsp;44&nbsp;68&nbsp;63&nbsp;21&nbsp;72&nbsp;d7&nbsp;b9&nbsp;18-97&nbsp;d8&nbsp;8e&nbsp;d7&nbsp;61&nbsp;7d&nbsp;71&nbsp;6f&nbsp;&nbsp;&nbsp;Dhc!r.......a}qo
&nbsp;&nbsp;&nbsp;&nbsp;0050&nbsp;-&nbsp;a7&nbsp;16&nbsp;85&nbsp;79&nbsp;f9&nbsp;a2&nbsp;80&nbsp;2a-b4&nbsp;bc&nbsp;f9&nbsp;47&nbsp;78&nbsp;6a&nbsp;b7&nbsp;08&nbsp;&nbsp;&nbsp;...y...*...Gxj..
&nbsp;&nbsp;&nbsp;&nbsp;0060&nbsp;-&nbsp;f6&nbsp;4f&nbsp;09&nbsp;96&nbsp;7b&nbsp;e8&nbsp;d4&nbsp;9b-26&nbsp;2d&nbsp;1a&nbsp;fd&nbsp;55&nbsp;fe&nbsp;6a&nbsp;ab&nbsp;&nbsp;&nbsp;.O..{...&amp;-..U.j.
&nbsp;&nbsp;&nbsp;&nbsp;0070&nbsp;-&nbsp;fc&nbsp;8d&nbsp;6d&nbsp;87&nbsp;7a&nbsp;13&nbsp;e1&nbsp;a9-0a&nbsp;05&nbsp;09&nbsp;d9&nbsp;ce&nbsp;ea&nbsp;fe&nbsp;70&nbsp;&nbsp;&nbsp;..m.z..........p
&nbsp;&nbsp;&nbsp;&nbsp;0080&nbsp;-&nbsp;09&nbsp;c9&nbsp;5f&nbsp;33&nbsp;3c&nbsp;5f&nbsp;28&nbsp;4e-20&nbsp;3b&nbsp;3a&nbsp;10&nbsp;75&nbsp;c4&nbsp;86&nbsp;45&nbsp;&nbsp;&nbsp;.._3&lt;_(N&nbsp;;:.u..E
&nbsp;&nbsp;&nbsp;&nbsp;0090&nbsp;-&nbsp;1d&nbsp;8b&nbsp;c8&nbsp;a5&nbsp;21&nbsp;89&nbsp;a1&nbsp;12-59&nbsp;b6&nbsp;0f&nbsp;55&nbsp;e3&nbsp;48&nbsp;8f&nbsp;91&nbsp;&nbsp;&nbsp;....!...Y..U.H..
&nbsp;&nbsp;&nbsp;&nbsp;00a0&nbsp;-&nbsp;01&nbsp;af&nbsp;53&nbsp;b6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;..S.
&nbsp;&nbsp;&nbsp;&nbsp;Compression:&nbsp;1&nbsp;(zlib&nbsp;compression)
&nbsp;&nbsp;&nbsp;&nbsp;Start&nbsp;Time:&nbsp;1348073759
&nbsp;&nbsp;&nbsp;&nbsp;Timeout&nbsp;&nbsp;&nbsp;:&nbsp;300&nbsp;(sec)
&nbsp;&nbsp;&nbsp;&nbsp;Verify&nbsp;return&nbsp;code:&nbsp;20&nbsp;(unable&nbsp;to&nbsp;get&nbsp;local&nbsp;issuer&nbsp;certificate)
---</pre><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">因为服务器已关闭了TLS压缩的功能，所以响应将会类似如下。&quot;Compression: NONE&quot;表明该服务器会拒绝TLS-level压缩的用法。</span></p><pre class="brush:html;toolbar:false">---
New,&nbsp;TLSv1/SSLv3,&nbsp;Cipher&nbsp;is&nbsp;ECDHE-RSA-AES128-GCM-SHA256
Server&nbsp;public&nbsp;key&nbsp;is&nbsp;2048&nbsp;bit
Secure&nbsp;Renegotiation&nbsp;IS&nbsp;supported
Compression:&nbsp;NONE
Expansion:&nbsp;NONE
SSL-Session:
&nbsp;&nbsp;&nbsp;&nbsp;Protocol&nbsp;&nbsp;:&nbsp;TLSv1.2
&nbsp;&nbsp;&nbsp;&nbsp;Cipher&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;ECDHE-RSA-AES128-GCM-SHA256
&nbsp;&nbsp;&nbsp;&nbsp;Session-ID:&nbsp;7E49EA6457B200B441A26C05F1AE9634AAF97284AC7A12EC58F69CEF5470B052
&nbsp;&nbsp;&nbsp;&nbsp;Session-ID-ctx:
&nbsp;&nbsp;&nbsp;&nbsp;Master-Key:&nbsp;E035F082F5545424373A546A1F76D77673E8AEE018B3F0A3AFD7A3545746013664C18E6BB69F08BFAECA6C7FB3010C9C
&nbsp;&nbsp;&nbsp;&nbsp;Key-Arg&nbsp;&nbsp;&nbsp;:&nbsp;None
&nbsp;&nbsp;&nbsp;&nbsp;PSK&nbsp;identity:&nbsp;None
&nbsp;&nbsp;&nbsp;&nbsp;PSK&nbsp;identity&nbsp;hint:&nbsp;None
&nbsp;&nbsp;&nbsp;&nbsp;SRP&nbsp;username:&nbsp;None
&nbsp;&nbsp;&nbsp;&nbsp;TLS&nbsp;session&nbsp;ticket&nbsp;lifetime&nbsp;hint:&nbsp;100800&nbsp;(seconds)
&nbsp;&nbsp;&nbsp;&nbsp;TLS&nbsp;session&nbsp;ticket:
&nbsp;&nbsp;&nbsp;&nbsp;0000&nbsp;-&nbsp;66&nbsp;72&nbsp;6f&nbsp;6e&nbsp;74&nbsp;70&nbsp;61&nbsp;67-65&nbsp;61&nbsp;61&nbsp;61&nbsp;61&nbsp;61&nbsp;61&nbsp;61&nbsp;&nbsp;&nbsp;frontpageaaaaaaa
&nbsp;&nbsp;&nbsp;&nbsp;0010&nbsp;-&nbsp;89&nbsp;55&nbsp;c6&nbsp;6a&nbsp;92&nbsp;c3&nbsp;28&nbsp;85-86&nbsp;b0&nbsp;ff&nbsp;c3&nbsp;08&nbsp;12&nbsp;5a&nbsp;a8&nbsp;&nbsp;&nbsp;.U.j..(.......Z.
&nbsp;&nbsp;&nbsp;&nbsp;0020&nbsp;-&nbsp;f2&nbsp;ec&nbsp;f8&nbsp;56&nbsp;6d&nbsp;d3&nbsp;29&nbsp;99-7b&nbsp;98&nbsp;90&nbsp;ef&nbsp;57&nbsp;fd&nbsp;c6&nbsp;15&nbsp;&nbsp;&nbsp;...Vm.).{...W...
&nbsp;&nbsp;&nbsp;&nbsp;0030&nbsp;-&nbsp;ee&nbsp;a2&nbsp;53&nbsp;4b&nbsp;43&nbsp;ef&nbsp;19&nbsp;ee-41&nbsp;25&nbsp;1f&nbsp;76&nbsp;28&nbsp;37&nbsp;68&nbsp;b6&nbsp;&nbsp;&nbsp;..SKC...A%.v(7h.
&nbsp;&nbsp;&nbsp;&nbsp;0040&nbsp;-&nbsp;64&nbsp;ca&nbsp;e7&nbsp;3f&nbsp;71&nbsp;01&nbsp;70&nbsp;30-35&nbsp;91&nbsp;ef&nbsp;bc&nbsp;d8&nbsp;19&nbsp;20&nbsp;4f&nbsp;&nbsp;&nbsp;d..?q.p05.....&nbsp;O
&nbsp;&nbsp;&nbsp;&nbsp;0050&nbsp;-&nbsp;9d&nbsp;9e&nbsp;2c&nbsp;ab&nbsp;3f&nbsp;35&nbsp;5c&nbsp;3f-65&nbsp;f8&nbsp;c6&nbsp;9a&nbsp;a9&nbsp;90&nbsp;fa&nbsp;60&nbsp;&nbsp;&nbsp;..,.?5\?e......`
&nbsp;&nbsp;&nbsp;&nbsp;0060&nbsp;-&nbsp;4d&nbsp;53&nbsp;a1&nbsp;b8&nbsp;49&nbsp;8c&nbsp;e7&nbsp;61-e4&nbsp;6c&nbsp;e1&nbsp;51&nbsp;8e&nbsp;83&nbsp;b5&nbsp;25&nbsp;&nbsp;&nbsp;MS..I..a.l.Q...%
&nbsp;&nbsp;&nbsp;&nbsp;0070&nbsp;-&nbsp;bc&nbsp;9a&nbsp;32&nbsp;d8&nbsp;fa&nbsp;be&nbsp;16&nbsp;a1-ae&nbsp;3d&nbsp;8c&nbsp;0b&nbsp;e3&nbsp;9e&nbsp;e4&nbsp;78&nbsp;&nbsp;&nbsp;..2......=.....x
&nbsp;&nbsp;&nbsp;&nbsp;0080&nbsp;-&nbsp;77&nbsp;d7&nbsp;91&nbsp;6b&nbsp;a9&nbsp;a0&nbsp;01&nbsp;2b-e1&nbsp;98&nbsp;33&nbsp;d4&nbsp;2c&nbsp;eb&nbsp;b3&nbsp;84&nbsp;&nbsp;&nbsp;w..k...+..3.,...
&nbsp;&nbsp;&nbsp;&nbsp;0090&nbsp;-&nbsp;f9&nbsp;da&nbsp;0f&nbsp;fa&nbsp;77&nbsp;df&nbsp;ac&nbsp;d6-08&nbsp;b6&nbsp;34&nbsp;97&nbsp;07&nbsp;d9&nbsp;b2&nbsp;58&nbsp;&nbsp;&nbsp;....w.....4....X
&nbsp;&nbsp;&nbsp;&nbsp;Start&nbsp;Time:&nbsp;1428988675
&nbsp;&nbsp;&nbsp;&nbsp;Timeout&nbsp;&nbsp;&nbsp;:&nbsp;300&nbsp;(sec)
&nbsp;&nbsp;&nbsp;&nbsp;Verify&nbsp;return&nbsp;code:&nbsp;20&nbsp;(unable&nbsp;to&nbsp;get&nbsp;local&nbsp;issuer&nbsp;certificate)
---</pre><p style="text-indent:2em;text-align:left;"><strong><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">BREACH</span></strong></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">BREACH攻击类似于CRIME攻击，但是这次利用HTTP压缩的使用来推断出攻击者的请求内容。</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">测试服务器支持缩减还是压缩，如下步骤进行：</span></p><pre class="brush:bash;toolbar:false">openssl&nbsp;s_client&nbsp;-connect&nbsp;example.com:443</pre><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">提交如下内容将可看出服务器是否支持HTTP的压缩内容：</span></p><pre class="brush:html;toolbar:false">GET&nbsp;/&nbsp;HTTP/1.1
Host:&nbsp;example.com
Accept-Encoding:&nbsp;compress,&nbsp;gzip</pre><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">如果响应含有编码过的数据，类似如下响应，它指明其支持HTTP压缩，因此远程host存在漏洞。</span></p><pre class="brush:html;toolbar:false">HTTP/1.1&nbsp;200&nbsp;OK
Server:&nbsp;nginx/1.1.19
Date:&nbsp;Sun,&nbsp;19&nbsp;Mar&nbsp;2015&nbsp;20:48:31&nbsp;GMT
Content-Type:&nbsp;text/html
Last-Modified:&nbsp;Thu,&nbsp;19&nbsp;Mar&nbsp;2015&nbsp;23:34:28&nbsp;GMT
Transfer-Encoding:&nbsp;chunked
Connection:&nbsp;keep-alive
Content-Encoding:&nbsp;gzip</pre><p style="text-indent:2em;text-align:left;"><br/></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">Implementation Issues</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">介绍看这里：</span><a href="http://en.wikipedia.org/wiki/Lucky_Thirteen_attack" style="text-indent: 2em; text-decoration: underline; font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">Lucky-13 attack</span></a></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">“心脏滴血”</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">如下为用测试脚本测试漏洞的命令：</span></p><pre class="brush:bash;toolbar:false">nmap&nbsp;-p&nbsp;443&nbsp;--script&nbsp;ssl-heartbleed&nbsp;--script-args&nbsp;vulns.showall&nbsp;example.com</pre><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">类似的输出如下：</span></p><p></p><pre class="brush:html;toolbar:false">PORT&nbsp;&nbsp;&nbsp;&nbsp;STATE&nbsp;SERVICE
443/tcp&nbsp;open&nbsp;&nbsp;https
|&nbsp;ssl-heartbleed:
|&nbsp;&nbsp;&nbsp;VULNERABLE:
|&nbsp;&nbsp;&nbsp;The&nbsp;Heartbleed&nbsp;Bug&nbsp;is&nbsp;a&nbsp;serious&nbsp;vulnerability&nbsp;in&nbsp;the&nbsp;popular&nbsp;OpenSSL&nbsp;cryptographic&nbsp;software&nbsp;library.&nbsp;It&nbsp;allows&nbsp;for&nbsp;stealing&nbsp;information&nbsp;intended&nbsp;to&nbsp;be&nbsp;protected&nbsp;by&nbsp;SSL/TLS&nbsp;encryption.
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;State:&nbsp;VULNERABLE
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Risk&nbsp;factor:&nbsp;High
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Description:
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OpenSSL&nbsp;versions&nbsp;1.0.1&nbsp;and&nbsp;1.0.2-beta&nbsp;releases&nbsp;(including&nbsp;1.0.1f&nbsp;and&nbsp;1.0.2-beta1)&nbsp;of&nbsp;OpenSSL&nbsp;are&nbsp;affected&nbsp;by&nbsp;the&nbsp;Heartbleed&nbsp;bug.&nbsp;The&nbsp;bug&nbsp;allows&nbsp;for&nbsp;reading&nbsp;memory&nbsp;of&nbsp;systems&nbsp;protected&nbsp;by&nbsp;the&nbsp;vulnerable&nbsp;OpenSSL&nbsp;versions&nbsp;and&nbsp;could&nbsp;allow&nbsp;for&nbsp;disclosure&nbsp;of&nbsp;otherwise&nbsp;encrypted&nbsp;confidential&nbsp;information&nbsp;as&nbsp;well&nbsp;as&nbsp;the&nbsp;encryption&nbsp;keys&nbsp;themselves.
|
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;References:
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0160
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://www.openssl.org/news/secadv_20140407.txt
|_&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://cvedetails.com/cve/2014-0160/</pre><p><a href="http://cvedetails.com/cve/2014-0160/"></a><br/></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">Change Cipher Spec Injection</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">影响版本</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">•&nbsp;&nbsp; OpenSSL 1.0.1 through 1.0.1g</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">•&nbsp;&nbsp; OpenSSL 1.0.0 through 1.0.0l</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px; color: rgb(0, 176, 80);">•&nbsp;&nbsp; all versions before OpenSSL 0.9.8y</span></p><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">使用脚本测试是否存在该漏洞：</span></p><pre class="brush:bash;toolbar:false">nmap&nbsp;-p&nbsp;443&nbsp;--script&nbsp;ssl-ccs-injection&nbsp;example.com</pre><p style="text-indent:2em;text-align:left;"><span style="font-family: 微软雅黑,Microsoft YaHei; font-size: 14px;">输出范例：</span></p><p></p><pre class="brush:html;toolbar:false;">PORT&nbsp;&nbsp;&nbsp;&nbsp;STATE&nbsp;SERVICE
443/tcp&nbsp;open&nbsp;&nbsp;https
|&nbsp;ssl-ccs-injection:
|&nbsp;&nbsp;&nbsp;VULNERABLE:
|&nbsp;&nbsp;&nbsp;SSL/TLS&nbsp;MITM&nbsp;vulnerability&nbsp;(CCS&nbsp;Injection)
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;State:&nbsp;VULNERABLE
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Risk&nbsp;factor:&nbsp;High
|
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;References:
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://www.cvedetails.com/cve/2014-0224
|_&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://www.openssl.org/news/secadv_20140605.txt</pre><p><a href="http://www.openssl.org/news/secadv_20140605.txt"></a><br/></p><p style="text-indent: 2em; text-align: left;"><br/></p></p>
                <hr/>
                <p style="text-align: center;">
                    <img src="http://bobao.360.cn/img/app.jpeg"/>
                    <img src="http://bobao.360.cn/img/weixin.jpeg"/>
                </p>
                                <p>本文由 安全客 翻译，转载请注明“转自安全客”，并附上链接。<br/><a class="text-more" href="http://www.contextis.com/resources/blog/manually-testing-ssltls-weaknesses/" target="_blank">原文链接：http://www.contextis.com/resources/blog/manually-testing-ssltls-weaknesses/</a></p>
                            </div>
            <div style="margin-top: 20px;background-color:#FFFFFF">
    <input type="hidden" id="detail_title" name="detail_title" value="手工测试SSL/TLS的脆弱性 - 安全客 - 有思想的安全新媒体" />
    <input type="hidden" id="use_nickname" name="use_nickname" value="0" />
    <a name="mao"></a>
    <div class="reg-log mobile-hiden">
        <div class="" id="userTo">   
            <div id="to-list" class="input-text" style="">
                <textarea disabled="disabled" class="hide"  id="comment-content" to="to"></textarea>
                <ul id="preadded" style="display:none">       
                </ul>
                <div id="to-auto" style="width: 200px">
                    <ul id="feed">
                    </ul>
                </div>
            </div>
        </div>
        <input type="hidden" id="source-id" value="479" />
        <input type="hidden" id="source-type" value="learning" />
        <input type="hidden" id="post-comment-url" value="/comment/add" />
        <input type="hidden" id="post-nickname-url-ajax" value="/comment/randnicknameajax" />
        <input type="hidden" id="post-check-login-url-ajax" value="/comment/checklogin" />
        <input type="hidden" id="stoken_comment_set" value="64d932c9bb50dc5a83db601d9b02e735">                 <span class="join">参与讨论，请先 <a href="javascript:;" class="comment-login">登录</a> | <a href="javascript:;" class="comment-reg">注册</a> |  <a href="javascript:;" class="anonymous-comment">匿名评论</a></span>
            </div>
    <div class="mobile-hide" style="width: 870px; margin: 0 auto;">
        <label style="vertical-align:middle;" for="use_nickname">匿名</label> 
        <input style="vertical-align:middle;" id="trigger-nickname" name="use_nickname" class="use_nickname" type="checkbox" value="0" />

        <a href="javascript:;" class="apply-use button" id="submit-comment" data-target="/comment/add">发布</a>
    </div>


    <div class="clearfix"></div>
    <div class="comments">
        <div class="comments-head">
            <span class="title">用户评论</span>
        </div>
                <div class="comment-none alarm-info bg-primary">无任何评论</div>
            </div>
</div>
<script>
    $(function () {
        $('.anonymous-comment').click(function () {
            $(".join").hide();
            $(".reg-log textarea").first().removeAttr("disabled").show();
            $('#use_nickname').val('1');
//            $('#trigger-nickname').attr('checked', true);
            $('#trigger-nickname').trigger('click');
        });
        //为所有复选框绑定事件
//        checkbox_on_click();
        //ajax随机获取昵称
//        randnicknameajax(0);
        //ajax检测登录状态
        comment_check_login();
    });



    function input_checkbox(flag) {
        $('input:checkbox').each(function () {
            var value = flag ? 1 : 0;
            $(this).prop('checked', flag);
            $(this).val(value);
        });
    }

//ajax随机获取昵称
    function randnicknameajax(flag) {
        $.ajax({
            type: 'POST',
            url: $('#post-nickname-url-ajax').val(),
            data: {limit: 1, flag: flag},
            dataType: "json",
            success: function (data) {
                $('#nick-name').val(data.data[0]);
                _nick_name=data.data[0];
            }
        });
    }
    $();
//ajax检测登录状态
    function comment_check_login() {
        $.ajax({
            type: 'POST',
            url: $('#post-check-login-url-ajax').val(),
            data: {},
            dataType: "json",
            success: function (data) {
                if (data.success) {
                    $('.join').hide();
                    $(".reg-log textarea").first().removeAttr("disabled").show();
                    $("#span_use_nickname").show();
                    $('#use_nickname').val('0');
                    $('#use_nickname').attr('checked', false);
                }
            }
        });
    }
</script>        </div>
    </div>
    <div class="side-bar">
        <div class="mod hot-news">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-hot"></i><span>热门知识</span></h2>
    </div>
    <ul class="links-list">
                                <li><a href="/learning/detail/4411.html" alt="【漏洞预警】一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现——最新的Office高级威胁攻击预警" target="_blank">【漏洞预警】一个换行符引发的奥斯卡...</a></li>
                                <li><a href="/learning/detail/4416.html" alt="【漏洞预警】Microsoft .NET Framework漏洞（CVE–2017–8759）预警" target="_blank">【漏洞预警】Microsoft .NE...</a></li>
                                <li><a href="/learning/detail/4414.html" alt="【技术分享】妙用JavaScript绕过XSS过滤" target="_blank">【技术分享】妙用JavaScrip...</a></li>
                                <li><a href="/learning/detail/4425.html" alt="【安全报告】XShellGhost事件技术回顾报告" target="_blank">【安全报告】XShellGhost事件...</a></li>
                                <li><a href="/learning/detail/4424.html" alt="【知识】9月16日 - 每日安全知识热点" target="_blank">【知识】9月16日 - 每日安全知识热...</a></li>
                                <li><a href="/learning/detail/4418.html" alt="【技术分享】利用威胁情报数据平台拓展APT攻击线索一例" target="_blank">【技术分享】利用威胁情报数据平台拓...</a></li>
            </ul>
</div>        <!-- 友情链接 -->
        <div class="mod blog-links mobile-hide">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-link"></i><span>友情链接</span></h2>
        <a href="/links/index.html" class="more">更多<i></i></a>
    </div>
        <ul class="links-list">
                <li><a href="http://bbs.360safe.com" alt="360安全社区" target="_blank">360安全社区</a></li>
                <li><a href="http://zhuji.360.cn" alt="360主机卫士" target="_blank">360主机卫士</a></li>
                <li><a href="http://blogs.360.cn/" alt="奇虎360技术博客" target="_blank">奇虎360技术博客</a></li>
                <li><a href="http://wangzhan.360.cn/" alt="360网站卫士" target="_blank">360网站卫士</a></li>
                <li><a href="http://webscan.360.cn/" alt="360网站安全检测" target="_blank">360网站安全检测</a></li>
                <li><a href="http://research.360.cn/report/" alt="360研究报告" target="_blank">360研究报告</a></li>
                <li><a href="http://unicorn.360.cn/" alt="360 Unicorn Team" target="_blank">360 Unicorn Team</a></li>
                <li><a href="http://appscan.360.cn/" alt="360捉虫猎手" target="_blank">360捉虫猎手</a></li>
                <li><a href="https://threathunter.org/" alt="ThreatHunter社区" target="_blank">ThreatHunter社区</a></li>
                <li><a href="http://security.360.cn/" alt="360安全应急响应中心" target="_blank">360安全应急响应中心</a></li>
            </ul>
    </div>
        <!-- 联系我们 -->
        <div class="mod contact mobile-hide" style="text-align:center">
    <div class="head-bar clearfix">
        <h2><i></i><span>关注我们</span></h2>
    </div>
    <!-- 微信关注 -->
    <ul class="contact-way">
        <li><a>微信关注</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/qrcode_adlab_weixin.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
    <!-- APP下载 -->
    <ul class="contact-way">
        <li><a>安全播报APP</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/scan_code_big.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
</div>

    </div>
</div>

<script type="text/javascript" src="/js/jquery-ui.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/jquery.noty.packaged.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/common.js?v=4.5"></script>
<script>$(function() {sync_count('comment');});</script>


<!-- 语法高亮 -->
<script type="text/javascript" src="/ue/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">SyntaxHighlighter.all();sync_count('vul');sync_count('news');sync_count('learning');sync_count('activity');sync_count('course');sync_count('ctf');</script>
    </div>

        <div class="footer">
        <div class="friend-link">
            <a href="http://www.360.cn/" target="_blank">360首页</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">关于我们</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">联系我们</a>
            <span>|</span>
            <a href="/links/index.html" target="_blank">友情链接</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">招贤纳士</a>
        </div>
        <div class="copy">
            Copyright &copy; 360网络攻防实验室 All Rights Reserved <span class="copy_icp">京ICP证080047号[京ICP备08010314号-6]</span>
        </div>
    </div>
    
</div>

<!--奇舞团统计-->

<script src='https://s.ssl.qhimg.com/static/f5407c785655e6a1/monitor_analytic.js'></script>
<script>
    monitor.setProject('QH_171_1').getTrack().getClickAndKeydown().getClickHeatmap(10, 1);
</script>

<div class="hide">
    <script src="https://s95.cnzz.com/z_stat.php?id=1253147824&web_id=1253147824" language="JavaScript"></script>
</div>
<div class="backToTop_wrap off">
    <a id="back_to_top" class="backToTop" href="javascript:;" title="返回顶部"></a>
</div>
<script>
    var $backToTop_wrap = $(".backToTop_wrap"),
        $backToTop_btn = $("#back_to_top");

    if ($(window).scrollTop() > 100) {
        $backToTop_wrap.removeClass("off");
    }
    else {
        $backToTop_wrap.addClass("off");
    }

    $(window).on("scroll", function () {
        if ($(this).scrollTop() > 100) {
            $backToTop_wrap.removeClass("off");
        }
        else {
            $backToTop_wrap.addClass("off");
        }
    });

    $backToTop_btn.on("click", function () {
        $("html, body").animate({scrollTop: 0}, 120);
    });

    $(function () {
        var navlist = $('.nav-list > li');

        navlist.each(function () {
            $(this).on('mouseenter', function () {
                $(this).addClass('selected');
            });

            $(this).on('mouseleave', function () {
                $(this).removeClass('selected');
            });
        });
    })
</script>



</body>
</html>
