<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:wb="http://open.weibo.com/wb" xml:lang="en" lang="en">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <link rel="shortcut icon" href="http://bobao.360.cn/favicon.ico?v=1.1"/>
    <link rel="alternate" title="安全资讯" href="/rss?type=news" type="application/rss+xml"/>
    <link rel="alternate" title="安全知识" href="/rss?type=learning" type="application/rss+xml"/>
    <link rel="alternate" title="安全圈活动" href="/rss?type=activity" type="application/rss+xml"/>
    <link rel="alternate" title="所有漏洞" href="/rss?type=vul" type="application/rss+xml"/>
    <link rel="alternate" title="通用型漏洞" href="/rss?type=commonvul" type="application/rss+xml"/>
    <link rel="alternate" title="事件型漏洞" href="/rss?type=eventvul" type="application/rss+xml"/>
    <link rel="alternate" title="热门漏洞" href="/rss?type=hotvul" type="application/rss+xml"/>

        <title>关于攻击PHP框架的几种思路 - 安全客 - 有思想的安全新媒体</title>
    
        <meta name="keywords" content="攻击 PHP 框架"/>
    
        <meta name="description" content="认识一些主流的开发框架与现在程序设计理念，包含了一些WEB设计上的趋势与概念。另外以我自己的角度去说明一下怎么去看一个PHP程序，方法适合于以上开源框架和一些公司内部开发的框架（只要能看到源码）。"/>
        <meta property="wb:webmaster" content="224437c7be31d633"/>

    <script type="text/javascript" src="http://s7.qhimg.com/!56caa871/xpc_sync_height.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/reset.css" />
    <link rel="stylesheet" type="text/css" href="/css/common_new.css?v=4.4.2.1" />
    <link rel="stylesheet" type="text/css" href="/css/jquery.notyfy.css" />
    <link rel="stylesheet" type="text/css" href="/css/notyfy.theme.default.css" />
    <link rel="stylesheet" type="text/css" href="/css/s_common.css?v=2.2.7" media="only screen and
    (max-device-width:900px), only screen and (max-width:900px)" />
    <script type="text/javascript" src="/js/jquery.min.js?v=3.1"></script>
    <script type="text/javascript" src="/js/jquery.notyfy.js"></script>
    <script type="text/javascript" src="/js/iscroll.js"></script>
    <script src="http://js.passport.qihucdn.com/5.0.3.js"></script>
    <script type="text/javascript">
        var myScroll, myNavScroll;

        function iscrollLoaded() {
            myScroll = new IScroll('#wrapper',
                {
                    scrollX: true,
                    scrollY: false,
                    bounceEasing: 'circular',
                    eventPassthrough: true,
                    preventDefault: false,
                    bounceTime: 500
                }
            );
        }

        $(function () {

            //导航横向滚动


            function setNavWidth() {

                /* 计算导航宽度 */
                var allWidth = $(window).width();
                var scroller = $('#scroller');

                if (allWidth > 900) {
                    scroller.find('ul').add(scroller.find('.scroll')).removeAttr('style');
                    scroller.css('overflow', 'visible');
                    if (myNavScroll) myNavScroll.destroy();
                } else {

                    var width = 0;
                    scroller.find('.scroll').children('ul').children('li').each(function (index, el) {
                        if (!$(this).hasClass('mobile-hide')) {
                            width += $(this).outerWidth();
                        }
                    });
                    scroller.find('ul').add(scroller.find('.scroll')).width(width);

                    if (myNavScroll) myNavScroll.destroy();

                    myNavScroll = new IScroll('#scroller', {
                        scrollX: true,
                        scrollY: false,
                        momentum: false,
                        click: true
                    });

                }

            }

            setNavWidth();
            $(window).resize(function (event) {
                setNavWidth();
            });

        });

    </script>
</head>
<body onload="iscrollLoaded();">
<div style='margin:0 auto;width:0px;height:0px;overflow:hidden;'>
    <img src=""/>
</div>

<div id="is-mobile"></div>
<div class="container">
        <div class="mobile-header">
        <div class="header clearfix">
            <div class="header-wrapper clearfix">
                <a href="/index/index" class="logo"><img class="slogan" src="/img/logo.png?v=1.5"/></a>
                                <form id="search" class="search-box" action="/search/index" method="GET">
                    <input class="keys" name="keywords" type="text" placeholder="搜索漏洞" required="required">
                    <input class="icon" type="submit" value="">
                    <input type="hidden" name="type" value=""/>
                </form>
                <div class="bug">
                    <div class="name"><span class="seled">全部</span><i class="arrow"></i></div>
                    <ul class="typelist">
                        <li data-index="3"><a href="javascript:void(0);">全部</a></li>
                        <li data-index="0"><a href="javascript:void(0);">漏洞</a></li>
                        <li data-index="1"><a href="javascript:void(0);">资讯</a></li>
                        <li data-index="2"><a href="javascript:void(0);">知识</a></li>
                    </ul>
                </div>
                                <div class="logNreg mobile-hide">
                    <div class="unlog">
                        <i></i>
                        <a href="log.html" class="log">登录</a>
                        <span>|</span>
                        <a href="reg.html" class="reg">注册</a>
                    </div>
                    <div class="loged">
                        <a href="/member/profile" class="user-center"><i></i><span class="user-name-tag">个人中心</span></a>
                        <div class="user-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting"><a href="http://i.360.cn/profile/accountmanage"
                                                               target="_blank"><i></i><span>账号设置</span></a></li>
                                <li class="alert-setting"><a href="/keywords/index"
                                                             target="_blank"><i></i><span>告警设置</span></a></li>
                                <li class="bug-alert"><a href="/myalarm/index" target="_blank"><i></i><span>漏洞告警</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mylearn/index" target="_blank"><i></i><span>我的知识</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mycourse/index" target="_blank"><i></i><span>我的课堂</span></a>
                                </li>
                                <li class="my-exit"><a
                                            href="http://login.360.cn/?src=pcw_adlab&op=logout&destUrl=http://bobao.360.cn"><i></i><span>退出系统</span></a>
                                </li>
                            </ul>
                        </div>

                        <a href="/message" class="message-center" target="_blank"><i></i><span>我的消息</span></a>
                        <div class="message-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting" style="display:none;"><a href="/myres/index"
                                                                                     target="_blank"><i></i><span>回复我的</span></a>
                                </li>
                                <li class="my-bug"><a href="/myvul/index"
                                                      target="_blank"><i></i><span>我的漏洞</span></a></li>
                                <!--<li class="my-bug"><a href="/myres/index" target="_blank"><i></i><span>我的评论</span></a></li>-->
                                <!--<li class="alert-setting"><a href="###" target="_blank"><i></i><span>提到我的</span></a>
                                </li>-->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <style type="text/css">
            .nav {
                overflow: hidden;
            }

            .nav .scroll {
                width: auto;
            }
        </style>
        <div id="wrapper">
            <div id="scroller" class="nav">
                <div class="scroll">
                    <ul class="nav-list">
                        <li ><a class="link-nav"
                                                                                 href="/index/index">首页</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/vul/index">漏洞</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/introduce/list">招聘</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/news/index">资讯</a><!--<i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/introduce/list">招聘</a></li>
                        </ul>
			-->
                        </li>
                        <li class="cur">
                        <a class="link-nav" href="/learning/index">知识</a><i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/course/index">学院</a></li>
                        </ul>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/activity/index">活动</a></li>
                        <li class="mobile-hide "><a class="link-nav"
                                                                                                   href="/ctf/index">CTF训练营</a>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/interref/list">安全内参</a></li>
                        <li ><a class="link-nav" href="/app/index">APP</a></li>

                        <!--<li ><a href="/course/index">学院</a></li>-->
                        <!--<li ><a href="/introduce/list">招聘</a></li>-->
                        <!--<li  class="mobile-hide"><a href="/ctf/index">CTF训练营</a></li>-->
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="mobile-content">
        <link rel="stylesheet" type="text/css" href="/css/news.css?v=3.5" />
<link rel="stylesheet" type="text/css" href="/ue/SyntaxHighlighter/shCoreDefault.css?v=1.0" />
<style>
    p .syntaxhighlighter {
        width: 80%;
    }
</style>

<div class="cur-pos w1000">当前位置：<a href="http://bobao.360.cn/">安全客</a> &gt;&gt; 知识详情</div>

<div class="content clearfix">
    <div class="main">
        <div class="article">
            <div id="article_box">
                <h2>关于攻击PHP框架的几种思路</h2>
                <div class="article-msg">
                    <span class="time">2016-09-02 15:10:15</span>
                                        <span class="read">阅读：23742次</span>
                    <span><a style="display: none;" class="good" href="javascript:;"
                             data-target="/learning/good" data-value="g_2995"
                             data-type="learning">点赞(0)</a></span>
                    <span><a class="fav" href="javascript:;" data-target="/mylearning/add"
                             data-pk="2995" data-type="learning">收藏</a></span>
                                        <span><a style="margin-left: 4px;" class="fav" href=""
                             target="_blank">来源： MottoIN</a></span>
                    
                                    </div>
                <hr size="1">
                <div class="article-msg">
                    <p><!-- JiaThis Button BEGIN -->

<!--
<span class="jiathis_style"><span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_tsina"></a>
    <a class="jiathis_button_tqq"></a>
    <a class="jiathis_button_qzone"></a>
    <a class="jiathis_button_renren"></a>
    <a class="jiathis_button_xiaoyou"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
</span>

-->
</p>
                </div>
                <p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; color: rgb(0, 0, 0);"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br/></span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; color: rgb(0, 0, 0);"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">写在前面</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">认识一些主流的开发框架与现在程序设计理念，包含了一些WEB设计上的趋势与概念。另外以我自己的角度去说明一下怎么去看一个PHP程序，方法适合于以上开源框架和一些公司内部开发的框架（只要能看到源码）。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; color: rgb(0, 0, 0);"><strong><span style="color: rgb(0, 0, 0); font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br/></span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; color: rgb(0, 0, 0);"><strong><span style="color: rgb(0, 0, 0); font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">框架的选择</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; color: rgb(0, 0, 0);"><strong><span style="color: rgb(0, 0, 0); font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></strong></span><br/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">ThinkPHP V3.2</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">CodeIgniter V2.2.2</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">Laravel V5.1</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">选择以上三个框架也是以为这三个框架算是比较有代表性的！ThinkPHP（TP）在国内很受欢迎，特别是小公司。CodeIgniter（CI）是传统且很流行的框架，并且也是很成熟的框架，据我说知sina的大多数地方站都是这个框架写的。Laravel是一个充满设计感的框架，应用了目前PHP上的所有新技术，并且借鉴了大量java与python的框架设计结构，也是目前调查的最流行的的Laravel框架（国内外）！</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; color: rgb(0, 0, 0);"><strong><span style="color: rgb(0, 0, 0); font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br/></span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; color: rgb(0, 0, 0);"><strong><span style="color: rgb(0, 0, 0); font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">认识框架</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; color: rgb(0, 0, 0);"><strong><span style="color: rgb(0, 0, 0); font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></strong></span><br/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">依次排开：Laravel-&gt; CodeIgniter(CI)-&gt;ThinkPHP(TP)</span></p><p style="text-align:center"><img data-w="447" data-ratio="0.727069351230425" data-s="300,640" data-type="png" data-src="http://mmbiz.qpic.cn/mmbiz_png/AwpvPj6iaV2eBkofDZL7P9AyiaLXayXUmibvBF2AM9nl8eTkNNKpQEEgwOMccJ3tuAutmtyOhiaNmLibFP90MluJXeg/0?wx_fmt=png" _width="auto" src="http://p4.qhimg.com/t014af03e03602dd173.webp" style="margin: 0px; padding: 0px; height: auto !important; max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; width: auto !important; visibility: visible !important;"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">中间的CI并未包含composer.json这个文件，这是PHP的包管理配置文件，在CI的3.0+版本中同样加入了PHP的包管理，真的是方便了大多数程序员。这样的目录结构很明显，一眼就能看出来。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; color: rgb(0, 0, 0);"><strong><span style="color: rgb(0, 0, 0); font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br/></span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; color: rgb(0, 0, 0);"><strong><span style="color: rgb(0, 0, 0); font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">框架的基本设计模式</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; color: rgb(0, 0, 0);"><strong><span style="color: rgb(0, 0, 0); font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></strong></span><br/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">基本的设计模式就是MVC设计模式。注意：多层级的分层模式为HMVC模式。HMVC就是把客户端应用程序分解为有层次的父子关系的MVC。</span></p><p style="text-align:center"><img src="http://p5.qhimg.com/t01d6b7d3cd64dd4cfe.png" title="t012e99ef872706c103.png" alt="http://p6.qhimg.com/t012e99ef872706c103.png" style="line-height: 25.6px; text-align: center; text-indent: 32px; white-space: pre-wrap; background-color: rgb(255, 255, 255);"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; color: rgb(0, 0, 0);"><strong><span style="color: rgb(0, 0, 0); font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br/></span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; color: rgb(0, 0, 0);"><strong><span style="color: rgb(0, 0, 0); font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">MVC对应的文件位置</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; color: rgb(0, 0, 0);"><strong><span style="color: rgb(0, 0, 0); font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></strong></span><br/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">看一个cms程序首先就是找控制器代码在哪个位置，之后就是模型文件的位置，视图文件最后，不过我真的在使用框架开发的程序中发现了模型控制代码而找到漏洞，这个程序员简直是B了dog！</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t010b4b26e1aa9b416a.png" title="t016f45848abed39c84.png" alt="http://p7.qhimg.com/t016f45848abed39c84.png"/></p><h3 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">控制器</span></h3><pre class="brush:plain;toolbar:false">&nbsp;&nbsp;&nbsp;Laravel-&gt;&nbsp;CodeIgniter(CI)-&gt;ThinkPHP(TP)</pre><p><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);"></span></p><p style="text-align:center"><img src="http://p0.qhimg.com/t01585d524f55bfa88c.png" title="t0129ab039a1768b9b5.png" alt="http://p4.qhimg.com/t0129ab039a1768b9b5.png"/></p><h3 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">模型</span></h3><pre><span style="font-size: 16px; color: rgb(0, 0, 0);"> &nbsp; &nbsp;Laravel-&gt;&nbsp;CodeIgniter(CI)-&gt;ThinkPHP(TP)<br/></span></pre><p style="text-align:center"><img src="http://p9.qhimg.com/t01f6289c45a26a419e.png" title="t01a57e5e83fa251ce3.png" alt="http://p2.qhimg.com/t01a57e5e83fa251ce3.png"/></p><h3 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">数据库连接文件</span></h3><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">TP：（通用2.0|3.0）</span></p><blockquote style="text-indent: 2em; text-align: left;"><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">(Application)\(Home)\Conf\config.php</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">//(Application) 默认为Application，保不齐修改，可以直接查看index.php</span></p><p style="text-align:center"><img src="http://p8.qhimg.com/t01f648073affe41943.png" title="t01c9dad73bbcff1695.png" alt="http://p6.qhimg.com/t01c9dad73bbcff1695.png"/></p></blockquote><blockquote style="text-indent: 2em; text-align: left;"><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">//(home) 项目目录，因项目而异！</span></p><pre><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">‘DB_TYPE’&nbsp;=&gt;&nbsp;‘mysql’,&nbsp;//&nbsp;数据库类型<br/>‘DB_HOST’&nbsp;=&gt;&nbsp;‘localhost’,&nbsp;//&nbsp;服务器地址<br/>‘DB_NAME’&nbsp;=&gt;&nbsp;‘chopperproxyl’,&nbsp;//&nbsp;数据库名<br/>‘DB_USER’&nbsp;=&gt;&nbsp;‘root’,&nbsp;//&nbsp;用户名<br/>‘DB_PWD’&nbsp;=&gt;&nbsp;‘root’,&nbsp;//&nbsp;密码<br/>‘DB_PORT’&nbsp;=&gt;&nbsp;3306,&nbsp;//&nbsp;端口<br/>‘DB_PREFIX’&nbsp;=&gt;&nbsp;‘xl_’,&nbsp;//&nbsp;数据库表前缀</span></pre></blockquote><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">CI:（通用2.0|3.0）</span></p><blockquote style="text-indent: 2em; text-align: left;"><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">(application)\config\database.php</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">//一般是固定形式application，保不齐修改一样可以到index.php里面查看项目命名。</span></p></blockquote><p style="text-align: center; text-indent: 0em;"><img src="http://p7.qhimg.com/t015f8be43985a19809.png" title="t01eb4c639f9595b9c7.png" alt="http://p6.qhimg.com/t01eb4c639f9595b9c7.png"/></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-align: left; text-indent: 2em;">Laravel：（5.0|4.0的目录少一个app）</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">这玩意特殊一些！在代码目录下有一个.env文件，里面存在项目的一些配置，可以在这里设置数据库连接信息。（当然可以不）</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t0171284d0b288b595d.png" title="t011efd64fce22aa9b7.png" alt="http://p1.qhimg.com/t011efd64fce22aa9b7.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">另外可以直接写在文件中：</span></p><blockquote style="text-indent: 2em; text-align: left;"><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">config\database.php文件</span></p></blockquote><p style="text-align:center"><img src="http://p3.qhimg.com/t019ce14c415e94218e.png" title="t01ef9cf5b11e442a4a.png" alt="http://p3.qhimg.com/t01ef9cf5b11e442a4a.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">//定义默认的数据库类型</span></p><p style="text-align:center"><img src="http://p2.qhimg.com/t018e699c82bf18fe69.png" title="t01de2015998ec24581.png" alt="http://p1.qhimg.com/t01de2015998ec24581.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">备注：具体的配置可能是这样两种类型，使用env中定义，或者写入文件。如果配置文件中同时存在上图中的两套配置，说明系统可能使用了多数据库。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">结束了！？</span></p><hr style="margin: 0px; padding: 0px; max-width: 100%; color: rgb(62, 62, 62); line-height: 25.6px; white-space: normal; box-sizing: border-box !important; word-wrap: break-word !important; background-color: rgb(255, 255, 255);"/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">这是几个框架最基本的东西了，下面把其中的关于安全的部分以及自己的一部分见解写出来，会挺有意思的。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">SQL操作模型</span></p><hr style="margin: 0px; padding: 0px; max-width: 100%; color: rgb(62, 62, 62); line-height: 25.6px; white-space: normal; box-sizing: border-box !important; word-wrap: break-word !important; background-color: rgb(255, 255, 255);"/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">在PHP开发过程中，一般都会使用两种技术。</span></p><h3 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">技术一：</span></h3><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">Active</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">Record（ORM）</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">ORM技术：Object-Relational</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">Mapping，把关系数据库的表结构映射到对象上。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">例如</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">ThinkPHP中：</span></p><p style="text-align:center"><img data-w="413" data-ratio="0.45278450363196127" data-s="300,640" data-type="png" data-src="http://mmbiz.qpic.cn/mmbiz_png/AwpvPj6iaV2eBkofDZL7P9AyiaLXayXUmibZGUVxNzFOvOTjARmKeOfdE6ITiaB1hXkKB9y07ib8DqIkKgCoM3xQ2rA/0?wx_fmt=png" src="http://p2.qhimg.com/t0117871efacaa85862.webp" style="margin: 0px; padding: 0px; height: auto !important; max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; width: auto !important; visibility: visible !important;"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">CI中的：</span></p><p style="text-align:center"><img data-w="866" data-ratio="0.09468822170900693" data-s="300,640" data-type="png" data-src="http://mmbiz.qpic.cn/mmbiz_png/AwpvPj6iaV2eBkofDZL7P9AyiaLXayXUmibQnV2FwzsztJGwIf3AZvlOf9UVMtWiam0xCDbiccfqXHH7c0xLibyfgOTg/0?wx_fmt=png" src="http://p0.qhimg.com/t01adbaffb94749ecbb.webp" style="margin: 0px; padding: 0px; height: auto !important; max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; width: auto !important; visibility: visible !important;"/></p><h3 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">二：查询构造器方式</span></h3><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">定义一个抽象数据库类，包含常用的各种方式。例如：在laravel中的</span></p><p style="text-align:center"><img data-w="402" data-ratio="0.40298507462686567" data-s="300,640" data-type="png" data-src="http://mmbiz.qpic.cn/mmbiz_png/AwpvPj6iaV2eBkofDZL7P9AyiaLXayXUmibrQXtibW3B6a4qpOM1cfy0XNhp1mO0AWEic6USOH5S5Zgc7hANd8DOObw/0?wx_fmt=png" src="http://p2.qhimg.com/t01a059c6ba8f1291ec.webp" style="margin: 0px; padding: 0px; height: auto !important; max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; width: auto !important; visibility: visible !important;"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">注意：这两种方式的区别简单说就是需不需要自己去顶一个model文件。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">可能存在的SQL注入问题：</span></p><hr style="margin: 0px; padding: 0px; max-width: 100%; color: rgb(62, 62, 62); line-height: 25.6px; white-space: normal; box-sizing: border-box !important; word-wrap: break-word !important; background-color: rgb(255, 255, 255);"/><h3 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">1、 由于业务的复杂性导致SQL语句有时候很变态，几乎每种框架都支持使用原生SQL语句。</span></h3><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">CI：</span></p><p style="text-align:center"><img data-w="768" data-ratio="0.0625" data-s="300,640" data-type="png" data-src="http://mmbiz.qpic.cn/mmbiz_png/AwpvPj6iaV2eBkofDZL7P9AyiaLXayXUmibuagnWUM2cibOXJr5MCX2AbvL0d960cU5wMOIT09iaBmtlThdibj2SQ7qQ/0?wx_fmt=png" src="http://p6.qhimg.com/t010e9a2361833233c3.webp" style="margin: 0px; padding: 0px; height: auto !important; max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; width: auto !important; visibility: visible !important;"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">TP：</span></p><p style="text-align:center"><img data-w="705" data-ratio="0.1673758865248227" data-s="300,640" data-type="png" data-src="http://mmbiz.qpic.cn/mmbiz_png/AwpvPj6iaV2eBkofDZL7P9AyiaLXayXUmib8BhQ3EMHvOW533pdyo1CTN3whAn7PO5QVHibXjtsqdygmeft6281Yfg/0?wx_fmt=png" src="http://p9.qhimg.com/t01c6f35640273b3b53.webp" style="margin: 0px; padding: 0px; height: auto !important; max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; width: auto !important; visibility: visible !important;"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">Laravel：</span></p><p style="text-align:center"><img data-w="463" data-ratio="0.08423326133909287" data-s="300,640" data-type="png" data-src="http://mmbiz.qpic.cn/mmbiz_png/AwpvPj6iaV2eBkofDZL7P9AyiaLXayXUmibP8RenpEqGYVDIWicbb8S0exNricX1h9Cq8w4xdXhhgImpyEibhAytYMVA/0?wx_fmt=png" src="http://p4.qhimg.com/t019af3aa3bbcca91f9.webp" style="margin: 0px; padding: 0px; height: auto !important; max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; width: auto !important; visibility: visible !important;"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">注意：凡是这些方式中带入的参数未经过过滤，底层的解析都是不会进行注入处理的，都有可能造成注入。</span></p><h3 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">2、 错误的安全函数用法（预编译）</span></h3><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">TP官方方法：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">如果使用3.1以上版本的话，使用字符串条件的时候，建议配合预处理机制，确保更加安全，例如：</span></p><blockquote style="text-indent: 2em; text-align: left;"><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">$Model-&amp;gt;where(“id=%d and</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">username=’%s’ and xx=’%f&#39;”,array($id,$username,$xx))-&amp;gt;select();</span></p></blockquote><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">或者使用：</span></p><blockquote style="text-indent: 2em; text-align: left;"><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">$Model-&amp;gt;where(“id=%d and</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">username=’%s’ and xx=’%f&#39;”,$id,$username,$xx)-&amp;gt;select()</span></p></blockquote><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">底层实现原理：获取函数输入参数，所有参数经过一次addslashes，然后使用vsprintf格式化字符串。问题：如果在数字字段带入%s，且没有引号，一样能注入。</span></p><h3 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">3、 where子查询中key字段可控</span></h3><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">CI：控制器代码</span></p><p style="text-align:center"><img data-w="768" data-ratio="0.19140625" data-s="300,640" data-type="png" data-src="http://mmbiz.qpic.cn/mmbiz_png/AwpvPj6iaV2eBkofDZL7P9AyiaLXayXUmibysy5wJWVvV5PRnN6dxuhs8R5iaS1bKxibZQ86lam2ib1icibIR8byNN3mLg/0?wx_fmt=png" src="http://p4.qhimg.com/t018caaf7a6e2ccd5b5.webp" style="margin: 0px; padding: 0px; height: auto !important; max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; width: auto !important; visibility: visible !important;"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">模型代码：</span></p><p style="text-align:center"><img src="http://p0.qhimg.com/t011a4a1cfbbc05aa61.png" title="t016ec87b7904896ab8.png" alt="http://p2.qhimg.com/t016ec87b7904896ab8.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">针对查询数组中的value字段是会做处理的，但是针对key字段并不会。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">访问查看：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">Laravel：同样的Laravel这个框架也存在这个问题。</span></p><p style="text-align:center"><img src="http://p3.qhimg.com/t01f73cd21969969f1b.png" title="t01096ec6d56ab5bea2.png" alt="http://p1.qhimg.com/t01096ec6d56ab5bea2.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">其中$type可控一样可以造成注入。</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t0169b785e0b7d09be5.png" title="t01a70b8090092b0ae7.png" alt="http://p9.qhimg.com/t01a70b8090092b0ae7.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">备注：Thinkphp这种框架就没有，它自己写了解析where字句的方式，虽然在这点上很安全，可是历史上出事最多的就是它了。</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);"><br/></span></strong></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">URL路由</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">一般看一个CMS就是要去找URL对应的代码是哪些，这样才有办法进行审计！WEB开发过程中有一个概念是URL语义化。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">传统的URL</span></p><blockquote style="text-indent: 2em; text-align: left;"><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">https://g.wen.lu/search?newwindow=1&amp;site=&amp;source=hp&amp;q=URL+%E8%AF%AD%E4%B9%89%E5%8C%96&amp;btnG=Google+%E6%90%9C%E7%B4%A2&amp;gws_rd=cr&amp;ei=Jli4VeX_Bciy0gSNjZvgDA</span></p></blockquote><p style="text-align:center"><img src="http://p0.qhimg.com/t01374560400816623a.png" title="t019e0842672362d173.png" alt="http://p6.qhimg.com/t019e0842672362d173.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">就是参数=值的形式。</span></p><h3 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">做了语义化的URL</span></h3><blockquote style="text-indent: 2em; text-align: left;"><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">http://blog.suchasplus.com/2008/10/uri-pretty-and-url-mapping-with-apache-and-php-how-to.html</span></p></blockquote><p style="text-align:center"><img src="http://p4.qhimg.com/t01bf82516671791cf1.png" title="t01bf82516671791cf1.png" alt="http://p6.qhimg.com/t01bf82516671791cf1.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">简单解释就是从URL上就能知道该页面具体展示的数据或者是什么功能，这是以后WEB开发的一个趋势。这里不光指这三个框架，其他框架或者自己开发的框架都将会有这样的功能。作为一个先进的PHP框架，都是存在路由绑定这个功能的！路由绑定就是将用户访问URL对应到项目的具体控制器中去。（代码审计过程中就是怎么通过URL去访问对应的代码）</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">Laravel：</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">项目目录中app\Http\routes.php</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t01818b8dc61367aa89.png" title="t01818b8dc61367aa89.png" alt="http://p1.qhimg.com/t01818b8dc61367aa89.png"/></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">CI：</span></strong></p><p style="text-align:center"><img src="http://p2.qhimg.com/t015fa7f6b04c4b70be.png" title="t015fa7f6b04c4b70be.png" alt="http://p2.qhimg.com/t015fa7f6b04c4b70be.png"/></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">TP：</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">像TP这种框架，到3.2默认的URL方式还是</span></p><blockquote style="text-indent: 2em; text-align: left;"><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">http://serverName/index.php/模块/控制器/操作</span></p></blockquote><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">这种傻逼方式。但是也有路由绑定的功能。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">查找配置项</span></p><blockquote style="text-indent: 2em; text-align: left;"><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">‘URL_ROUTER_ON’ =&gt; true,</span></p></blockquote><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">然后寻找配置项</span></p><blockquote style="text-indent: 2em; text-align: left;"><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">URL_ROUTE_RULES</span></p></blockquote><p style="text-align:center"><img data-w="637" data-ratio="0.2119309262166405" data-s="300,640" data-type="png" data-src="http://mmbiz.qpic.cn/mmbiz_png/AwpvPj6iaV2eBkofDZL7P9AyiaLXayXUmibEzGoB3pctTwAXibaEl9xRvyu898iaSpibsNiczNGBty5YltykibGchphdkA/0?wx_fmt=png" src="http://p6.qhimg.com/t01895a95ad1cfa81cf.webp" style="margin: 0px; padding: 0px; height: auto !important; max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; width: auto !important; visibility: visible !important;"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">备注：通过这些配置项目可以快速的找到URL对应的控制器代码是什么！说这个还有一个原因就是以后可能会接触到REST模式的URL，这个也是趋势！</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">同一条URL可能对应不同的几个控制器代码。HTTP协议存在GET POST PUT&nbsp;DELETE方法。web程序就是增删改查，对应的操作就是CURD，直接对应到的方法就是：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">C对应POST，R对应GET，U对应PUT，D对应DELETE</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">具体代码就是通过判断请求方法来调用对应的控制器。</span></p><p style="text-align:center"><img data-w="691" data-ratio="0.08827785817655572" data-s="300,640" data-type="png" data-src="http://mmbiz.qpic.cn/mmbiz_png/AwpvPj6iaV2eBkofDZL7P9AyiaLXayXUmibpfdicjdTC3cT9hDkVb9Dphuhsal2ZtMYLlh1AMHMuIhvTYTrYycXicug/0?wx_fmt=png" src="http://p7.qhimg.com/t01eeb871cc7942467d.png" style="margin: 0px; padding: 0px; height: auto !important; max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; width: auto !important; visibility: visible !important;"/></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);"><br/></span></strong></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">框架的过滤机制（审计过程需要注意的点）</span></strong></p><hr/><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);"></span></strong><br/></p><h3 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">一：针对URL的过滤</span></h3><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">由于URL路由的关系，现在的框架在GET方式上都或多或少的存在过滤或者说验证。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">TP：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">1、例如\d就限制了该参数只能是数字。</span></p><p style="text-align:center"><img data-w="254" data-ratio="0.16141732283464566" data-s="300,640" data-type="png" data-src="http://mmbiz.qpic.cn/mmbiz_png/AwpvPj6iaV2eBkofDZL7P9AyiaLXayXUmibibMG2oaEP4RBPCgfLrQicCgCCcurEZfO2aeYib6cW7icF47pkGBNI9WuuA/0?wx_fmt=png" src="http://p7.qhimg.com/t01b37fd1d2469b7f36.webp" style="margin: 0px; padding: 0px; height: auto !important; max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; width: auto !important; visibility: visible !important;"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">2、或者是使用正则的方式来匹配，达到过滤的效果。</span></p><p style="text-align:center"><strong><img data-w="557" data-ratio="0.07001795332136446" data-s="300,640" data-type="png" data-src="http://mmbiz.qpic.cn/mmbiz_png/AwpvPj6iaV2eBkofDZL7P9AyiaLXayXUmibRk9e86UZRcMewaLXn0mnUiaPibyicEBFqQJHSv3F4ZRF8pJfopx42BqaQ/0?wx_fmt=png" src="http://p3.qhimg.com/t013096ce2f4e078026.webp" style="margin: 0px; padding: 0px; height: auto !important; max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; width: auto !important; visibility: visible !important;"/></strong></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">CI：</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">CI的过滤也一样，就是使用正则去匹配。</span></p><p style="text-align:center"><img data-w="300" data-ratio="0.22666666666666666" data-s="300,640" data-type="png" data-src="http://mmbiz.qpic.cn/mmbiz_png/AwpvPj6iaV2eBkofDZL7P9AyiaLXayXUmibu3KhP6ZGTMYOzFGHf8m0jwtjOwtwkB1WDb4fH5L7IAvkKAcPIeC0Rw/0?wx_fmt=png" src="http://p5.qhimg.com/t01372b4766ccfea234.webp" style="margin: 0px; padding: 0px; height: auto !important; max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; width: auto !important; visibility: visible !important;"/></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">Laravel：</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">同样可以在定义URL路由的时候定义过滤，直接在路由上用where函数限制参数的类型。</span></p><p style="text-align:center"><img data-w="602" data-ratio="0.1893687707641196" data-s="300,640" data-type="png" data-src="http://mmbiz.qpic.cn/mmbiz_png/AwpvPj6iaV2eBkofDZL7P9AyiaLXayXUmibERLeW6fDtyUHoXiclSPzXBiajdj0GeSbMu8PIUEx83TDsXyhB2VvUl7g/0?wx_fmt=png" src="http://p5.qhimg.com/t01fe25e796c5238e56.webp" style="margin: 0px; padding: 0px; height: auto !important; max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; width: auto !important; visibility: visible !important;"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">或者在文件app\Providers\RouteServiceProvider.php中存在boot的函数，可以定义全局过滤，可以在这里面找找。</span></p><p style="text-align:center"><img data-w="451" data-ratio="0.3436807095343681" data-s="300,640" data-type="png" data-src="http://mmbiz.qpic.cn/mmbiz_png/AwpvPj6iaV2eBkofDZL7P9AyiaLXayXUmibRnicEMV7eWCsGc3q9lpLhGjshvnyCFEhFweYMfIN6Qgiasib1IFEUAzVg/0?wx_fmt=png" src="http://p4.qhimg.com/t0159106edf004d87b9.webp" style="margin: 0px; padding: 0px; height: auto !important; max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; width: auto !important; visibility: visible !important;"/></p><h3 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">二：针对接收参数的过滤</span></h3><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">现在的框架一般都会重写$_GET/$_POST/$_REQUEST，自建系统的输入，然后这些输入存在一些参数可以选择是否过滤。</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">TP：</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">重写的函数 I()</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">用法</span></p><blockquote style="text-indent: 2em; text-align: left;"><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">I(‘get.id’); | I(‘post.id’);</span></p></blockquote><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">利用设置默认值，设置过滤函数来达到过滤的效果。</span></p><blockquote style="text-indent: 2em; text-align: left;"><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">I(‘get.name’,’test’,’htmlspecialchars’);</span></p></blockquote><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">CI:</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">CI中所有的系统方法都是$this开头的。重写的输入函数 $this-&gt;input</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">用法</span></p><blockquote style="text-indent: 2em; text-align: left;"><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">$this-&amp;gt;input-&amp;gt;post(‘something’);</span></p></blockquote><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">针对输入的第二个参数仅针对XSS，设置成true会进过一次CI内奸的xss_clean函数。</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">Laravel：</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">这个吊了！这玩意自己定义了一个中间件Middleware类型（借鉴java）。中间件的作用就是在HTTP请求实际接触应用程序之前，进行层层的检查跟过滤，甚至完全拒绝。一般被用来做权限验证，参数过滤，数据加解密等等。所有中间件都在app\Http\Middleware目录下面，根据具体情况查看是否将过滤写在这里面了。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">重写的输入函数</span></p><blockquote style="text-indent: 2em; text-align: left;"><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">Request $request</span></p></blockquote><blockquote style="text-indent: 2em; text-align: left;"><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">$request-&amp;gt;input(‘ip’);</span></p></blockquote><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">第二个参数仅有设置默认值的作用，并没有实际的过滤。</span></p><h3 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">三：默认设置的全局安全机制</span></h3><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">CI：</span></strong></p><p style="text-align:center"><img data-w="768" data-ratio="0.20963541666666666" data-s="300,640" data-type="png" data-src="http://mmbiz.qpic.cn/mmbiz_png/AwpvPj6iaV2eBkofDZL7P9AyiaLXayXUmibLFBrYjMUKtbwQ0KJIaczUlT0ia9Fr2iaQ8HTdWcuJTmF6V3bpwCKlU5w/0?wx_fmt=png" src="http://p0.qhimg.com/t0154ac95a5c13b9886.webp" style="margin: 0px; padding: 0px; height: auto !important; max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; width: auto !important; visibility: visible !important;"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">默认还有一个参数</span></p><blockquote style="text-indent: 2em; text-align: left;"><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">$config[‘global_xss_filtering’] = TRUE;</span></p></blockquote><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">开启后所有的参数都会经过xss_clean函数一遍。</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">TP：</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">全局的过滤参数</span></p><blockquote style="text-indent: 2em; text-align: left;"><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">‘DEFAULT_FILTER’ =&amp;gt;’strip_tags,stripslashes’,</span></p></blockquote><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">对接收数据进行依次的过滤。</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">Laravel：</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">默认开启的全局CSRF过滤（借鉴django等框架）。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">其他貌似就没了0-0</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">由各个框架编写过程联想到的一些东西</span></p><hr style="margin: 0px; padding: 0px; max-width: 100%; color: rgb(62, 62, 62); line-height: 25.6px; white-space: normal; box-sizing: border-box !important; word-wrap: break-word !important; background-color: rgb(255, 255, 255);"/><h3 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">1、 测试的时候如果一个正常的请求就是获取不到数据，可以在HTTP头里面加上</span></h3><h3 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">X-Requested-With:XMLHttpRequest</span></h3><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">就是ajax请求。现在一般程序员的编写纯api接口的时候习惯是会区分直接访问还是ajax的，这样可以减少乱七八的数据请求。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">例如：</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">Laravel：</span></strong></p><p style="text-align:center"><img data-w="613" data-ratio="0.2365415986949429" data-s="300,640" data-type="png" data-src="http://mmbiz.qpic.cn/mmbiz_png/AwpvPj6iaV2eBkofDZL7P9AyiaLXayXUmibicXHE2uMjT60KWrCIq3FrT20wOUfuws9y0g4zkicfATZhdgmicn0yAM4Q/0?wx_fmt=png" src="http://p0.qhimg.com/t01d8b86f0afb3807f7.webp" style="margin: 0px; padding: 0px; height: auto !important; max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; width: auto !important; visibility: visible !important;"/></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">CI：</span></strong></p><p style="text-align:center"><img data-w="632" data-ratio="0.4462025316455696" data-s="300,640" data-type="png" data-src="http://mmbiz.qpic.cn/mmbiz_png/AwpvPj6iaV2eBkofDZL7P9AyiaLXayXUmibTeXbkREYaddc8jIamEVxzuQ8lM0XS1GlUlkicE9dE6aviamqYumc9aIw/0?wx_fmt=png" src="http://p5.qhimg.com/t01695e6e93a9d4ba51.webp" style="margin: 0px; padding: 0px; height: auto !important; max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; width: auto !important; visibility: visible !important;"/></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">TP：</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">常量IS_AJAX 判断是否是AJAX提交，不写了！</span></p><h3 style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">2、 如果上传成功一个文件，但是就是访问不到，有几个原因。</span></h3><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">.htaccess 文件限制了根目录下index.php以外的所有文件的访问权限，配合URL路由这个功能所有不在路由中的路径</span></p><blockquote style="text-indent: 2em; text-align: left;"><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">http://testtest.net/test/test.php</span></p></blockquote><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">都是无法访问的。这个也是django类似的框架难以攻击的一个原因。（PHP正在往规范严谨的方向去）这种时候要么能覆盖route文件，要么能覆盖对应的方法（这个太难，需要不破坏文件，只是修改对应的方法。）Laravel这样的框架本身www设置的时候就是一个public目录（默认）。</span></p><p style="text-align:center"><img data-w="243" data-ratio="1.2345679012345678" data-s="300,640" data-type="png" data-src="http://mmbiz.qpic.cn/mmbiz_png/AwpvPj6iaV2eBkofDZL7P9AyiaLXayXUmibia7aX0IygVOINsvZsyZs35AbIVbQlOKNu9nZFSRLlicV8A3rL37vgCNw/0?wx_fmt=png" src="http://p0.qhimg.com/t01d9fb4661b5b638a9.webp" style="margin: 0px; padding: 0px; height: auto !important; max-width: 100%; box-sizing: border-box !important; word-wrap: break-word !important; width: auto !important; visibility: visible !important;"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 16px; color: rgb(0, 0, 0);">这个目录除了index.php文件啥也没有了，上传文件一般都在www目录的外层目录，无法直接访问。这种时候只能靠跳转目录来跳到public下面才能访问，或者文件包含。</span></p></p>
                <hr/>
                <p style="text-align: center;">
                    <img src="http://bobao.360.cn/img/app.jpeg"/>
                    <img src="http://bobao.360.cn/img/weixin.jpeg"/>
                </p>
                                <p>本文转载自 MottoIN<br/><a class="text-more" href="" target="_blank">原文链接：</a></p>
                            </div>
            <div style="margin-top: 20px;background-color:#FFFFFF">
    <input type="hidden" id="detail_title" name="detail_title" value="关于攻击PHP框架的几种思路 - 安全客 - 有思想的安全新媒体" />
    <input type="hidden" id="use_nickname" name="use_nickname" value="0" />
    <a name="mao"></a>
    <div class="reg-log mobile-hiden">
        <div class="" id="userTo">   
            <div id="to-list" class="input-text" style="">
                <textarea disabled="disabled" class="hide"  id="comment-content" to="to"></textarea>
                <ul id="preadded" style="display:none">       
                </ul>
                <div id="to-auto" style="width: 200px">
                    <ul id="feed">
                    </ul>
                </div>
            </div>
        </div>
        <input type="hidden" id="source-id" value="2995" />
        <input type="hidden" id="source-type" value="learning" />
        <input type="hidden" id="post-comment-url" value="/comment/add" />
        <input type="hidden" id="post-nickname-url-ajax" value="/comment/randnicknameajax" />
        <input type="hidden" id="post-check-login-url-ajax" value="/comment/checklogin" />
        <input type="hidden" id="stoken_comment_set" value="ea3898fb4df38673fdeb61c458234054">                 <span class="join">参与讨论，请先 <a href="javascript:;" class="comment-login">登录</a> | <a href="javascript:;" class="comment-reg">注册</a> |  <a href="javascript:;" class="anonymous-comment">匿名评论</a></span>
            </div>
    <div class="mobile-hide" style="width: 870px; margin: 0 auto;">
        <label style="vertical-align:middle;" for="use_nickname">匿名</label> 
        <input style="vertical-align:middle;" id="trigger-nickname" name="use_nickname" class="use_nickname" type="checkbox" value="0" />

        <a href="javascript:;" class="apply-use button" id="submit-comment" data-target="/comment/add">发布</a>
    </div>


    <div class="clearfix"></div>
    <div class="comments">
        <div class="comments-head">
            <span class="title">用户评论</span>
        </div>
                <div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/10x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="167838976" class="response" data-bind-id="167838976" data-target="5469" user-name="大表哥" href="javascript:;">
                大表哥            </a>
                        <span class="comment-time">2016-10-23 11:56:50</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="167838976" data-target="5469">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_5469" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">yii呢</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>

        <a class="more-long comment-more" href="javascript:;" data-target="/comment/more" data-type="learning" data-source-id="2995" data-page="2">查看更多</a>
            </div>
</div>
<script>
    $(function () {
        $('.anonymous-comment').click(function () {
            $(".join").hide();
            $(".reg-log textarea").first().removeAttr("disabled").show();
            $('#use_nickname').val('1');
//            $('#trigger-nickname').attr('checked', true);
            $('#trigger-nickname').trigger('click');
        });
        //为所有复选框绑定事件
//        checkbox_on_click();
        //ajax随机获取昵称
//        randnicknameajax(0);
        //ajax检测登录状态
        comment_check_login();
    });



    function input_checkbox(flag) {
        $('input:checkbox').each(function () {
            var value = flag ? 1 : 0;
            $(this).prop('checked', flag);
            $(this).val(value);
        });
    }

//ajax随机获取昵称
    function randnicknameajax(flag) {
        $.ajax({
            type: 'POST',
            url: $('#post-nickname-url-ajax').val(),
            data: {limit: 1, flag: flag},
            dataType: "json",
            success: function (data) {
                $('#nick-name').val(data.data[0]);
                _nick_name=data.data[0];
            }
        });
    }
    $();
//ajax检测登录状态
    function comment_check_login() {
        $.ajax({
            type: 'POST',
            url: $('#post-check-login-url-ajax').val(),
            data: {},
            dataType: "json",
            success: function (data) {
                if (data.success) {
                    $('.join').hide();
                    $(".reg-log textarea").first().removeAttr("disabled").show();
                    $("#span_use_nickname").show();
                    $('#use_nickname').val('0');
                    $('#use_nickname').attr('checked', false);
                }
            }
        });
    }
</script>        </div>
    </div>
    <div class="side-bar">
        <div class="mod hot-news">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-hot"></i><span>热门知识</span></h2>
    </div>
    <ul class="links-list">
                                <li><a href="/learning/detail/4411.html" alt="【漏洞预警】一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现——最新的Office高级威胁攻击预警" target="_blank">【漏洞预警】一个换行符引发的奥斯卡...</a></li>
                                <li><a href="/learning/detail/4416.html" alt="【漏洞预警】Microsoft .NET Framework漏洞（CVE–2017–8759）预警" target="_blank">【漏洞预警】Microsoft .NE...</a></li>
                                <li><a href="/learning/detail/4414.html" alt="【技术分享】妙用JavaScript绕过XSS过滤" target="_blank">【技术分享】妙用JavaScrip...</a></li>
                                <li><a href="/learning/detail/4418.html" alt="【技术分享】利用威胁情报数据平台拓展APT攻击线索一例" target="_blank">【技术分享】利用威胁情报数据平台拓...</a></li>
                                <li><a href="/learning/detail/4417.html" alt="【知识】9月15日 - 每日安全知识热点" target="_blank">【知识】9月15日 - 每日安全知识热...</a></li>
                                <li><a href="/learning/detail/4425.html" alt="【安全报告】XShellGhost事件技术回顾报告" target="_blank">【安全报告】XShellGhost事件...</a></li>
            </ul>
</div>        <!-- 友情链接 -->
        <div class="mod blog-links mobile-hide">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-link"></i><span>友情链接</span></h2>
        <a href="/links/index.html" class="more">更多<i></i></a>
    </div>
        <ul class="links-list">
                <li><a href="http://bbs.360safe.com" alt="360安全社区" target="_blank">360安全社区</a></li>
                <li><a href="http://zhuji.360.cn" alt="360主机卫士" target="_blank">360主机卫士</a></li>
                <li><a href="http://blogs.360.cn/" alt="奇虎360技术博客" target="_blank">奇虎360技术博客</a></li>
                <li><a href="http://wangzhan.360.cn/" alt="360网站卫士" target="_blank">360网站卫士</a></li>
                <li><a href="http://webscan.360.cn/" alt="360网站安全检测" target="_blank">360网站安全检测</a></li>
                <li><a href="http://research.360.cn/report/" alt="360研究报告" target="_blank">360研究报告</a></li>
                <li><a href="http://unicorn.360.cn/" alt="360 Unicorn Team" target="_blank">360 Unicorn Team</a></li>
                <li><a href="http://appscan.360.cn/" alt="360捉虫猎手" target="_blank">360捉虫猎手</a></li>
                <li><a href="https://threathunter.org/" alt="ThreatHunter社区" target="_blank">ThreatHunter社区</a></li>
                <li><a href="http://security.360.cn/" alt="360安全应急响应中心" target="_blank">360安全应急响应中心</a></li>
            </ul>
    </div>
        <!-- 联系我们 -->
        <div class="mod contact mobile-hide" style="text-align:center">
    <div class="head-bar clearfix">
        <h2><i></i><span>关注我们</span></h2>
    </div>
    <!-- 微信关注 -->
    <ul class="contact-way">
        <li><a>微信关注</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/qrcode_adlab_weixin.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
    <!-- APP下载 -->
    <ul class="contact-way">
        <li><a>安全播报APP</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/scan_code_big.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
</div>

    </div>
</div>

<script type="text/javascript" src="/js/jquery-ui.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/jquery.noty.packaged.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/common.js?v=4.5"></script>
<script>$(function() {sync_count('comment');});</script>


<!-- 语法高亮 -->
<script type="text/javascript" src="/ue/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">SyntaxHighlighter.all();sync_count('vul');sync_count('news');sync_count('learning');sync_count('activity');sync_count('course');sync_count('ctf');</script>
    </div>

        <div class="footer">
        <div class="friend-link">
            <a href="http://www.360.cn/" target="_blank">360首页</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">关于我们</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">联系我们</a>
            <span>|</span>
            <a href="/links/index.html" target="_blank">友情链接</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">招贤纳士</a>
        </div>
        <div class="copy">
            Copyright &copy; 360网络攻防实验室 All Rights Reserved <span class="copy_icp">京ICP证080047号[京ICP备08010314号-6]</span>
        </div>
    </div>
    
</div>

<!--奇舞团统计-->

<script src='https://s.ssl.qhimg.com/static/f5407c785655e6a1/monitor_analytic.js'></script>
<script>
    monitor.setProject('QH_171_1').getTrack().getClickAndKeydown().getClickHeatmap(10, 1);
</script>

<div class="hide">
    <script src="https://s95.cnzz.com/z_stat.php?id=1253147824&web_id=1253147824" language="JavaScript"></script>
</div>
<div class="backToTop_wrap off">
    <a id="back_to_top" class="backToTop" href="javascript:;" title="返回顶部"></a>
</div>
<script>
    var $backToTop_wrap = $(".backToTop_wrap"),
        $backToTop_btn = $("#back_to_top");

    if ($(window).scrollTop() > 100) {
        $backToTop_wrap.removeClass("off");
    }
    else {
        $backToTop_wrap.addClass("off");
    }

    $(window).on("scroll", function () {
        if ($(this).scrollTop() > 100) {
            $backToTop_wrap.removeClass("off");
        }
        else {
            $backToTop_wrap.addClass("off");
        }
    });

    $backToTop_btn.on("click", function () {
        $("html, body").animate({scrollTop: 0}, 120);
    });

    $(function () {
        var navlist = $('.nav-list > li');

        navlist.each(function () {
            $(this).on('mouseenter', function () {
                $(this).addClass('selected');
            });

            $(this).on('mouseleave', function () {
                $(this).removeClass('selected');
            });
        });
    })
</script>



</body>
</html>
