<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:wb="http://open.weibo.com/wb" xml:lang="en" lang="en">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <link rel="shortcut icon" href="http://bobao.360.cn/favicon.ico?v=1.1"/>
    <link rel="alternate" title="安全资讯" href="/rss?type=news" type="application/rss+xml"/>
    <link rel="alternate" title="安全知识" href="/rss?type=learning" type="application/rss+xml"/>
    <link rel="alternate" title="安全圈活动" href="/rss?type=activity" type="application/rss+xml"/>
    <link rel="alternate" title="所有漏洞" href="/rss?type=vul" type="application/rss+xml"/>
    <link rel="alternate" title="通用型漏洞" href="/rss?type=commonvul" type="application/rss+xml"/>
    <link rel="alternate" title="事件型漏洞" href="/rss?type=eventvul" type="application/rss+xml"/>
    <link rel="alternate" title="热门漏洞" href="/rss?type=hotvul" type="application/rss+xml"/>

        <title>'cryptoApp‘的故事：片段分析敲诈勒索软件 - 安全客 - 有思想的安全新媒体</title>
    
        <meta name="keywords" content="cryptoApp,故事,片段,分析,敲诈,勒索,软件"/>
    
        <meta name="description" content="勒索软件在这过去的几年中一直是处于一个上升的阶段，在引领的这几年中也出现了越来越多的变异。"/>
        <meta property="wb:webmaster" content="224437c7be31d633"/>

    <script type="text/javascript" src="http://s7.qhimg.com/!56caa871/xpc_sync_height.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/reset.css" />
    <link rel="stylesheet" type="text/css" href="/css/common_new.css?v=4.4.2.1" />
    <link rel="stylesheet" type="text/css" href="/css/jquery.notyfy.css" />
    <link rel="stylesheet" type="text/css" href="/css/notyfy.theme.default.css" />
    <link rel="stylesheet" type="text/css" href="/css/s_common.css?v=2.2.7" media="only screen and
    (max-device-width:900px), only screen and (max-width:900px)" />
    <script type="text/javascript" src="/js/jquery.min.js?v=3.1"></script>
    <script type="text/javascript" src="/js/jquery.notyfy.js"></script>
    <script type="text/javascript" src="/js/iscroll.js"></script>
    <script src="http://js.passport.qihucdn.com/5.0.3.js"></script>
    <script type="text/javascript">
        var myScroll, myNavScroll;

        function iscrollLoaded() {
            myScroll = new IScroll('#wrapper',
                {
                    scrollX: true,
                    scrollY: false,
                    bounceEasing: 'circular',
                    eventPassthrough: true,
                    preventDefault: false,
                    bounceTime: 500
                }
            );
        }

        $(function () {

            //导航横向滚动


            function setNavWidth() {

                /* 计算导航宽度 */
                var allWidth = $(window).width();
                var scroller = $('#scroller');

                if (allWidth > 900) {
                    scroller.find('ul').add(scroller.find('.scroll')).removeAttr('style');
                    scroller.css('overflow', 'visible');
                    if (myNavScroll) myNavScroll.destroy();
                } else {

                    var width = 0;
                    scroller.find('.scroll').children('ul').children('li').each(function (index, el) {
                        if (!$(this).hasClass('mobile-hide')) {
                            width += $(this).outerWidth();
                        }
                    });
                    scroller.find('ul').add(scroller.find('.scroll')).width(width);

                    if (myNavScroll) myNavScroll.destroy();

                    myNavScroll = new IScroll('#scroller', {
                        scrollX: true,
                        scrollY: false,
                        momentum: false,
                        click: true
                    });

                }

            }

            setNavWidth();
            $(window).resize(function (event) {
                setNavWidth();
            });

        });

    </script>
</head>
<body onload="iscrollLoaded();">
<div style='margin:0 auto;width:0px;height:0px;overflow:hidden;'>
    <img src=""/>
</div>

<div id="is-mobile"></div>
<div class="container">
        <div class="mobile-header">
        <div class="header clearfix">
            <div class="header-wrapper clearfix">
                <a href="/index/index" class="logo"><img class="slogan" src="/img/logo.png?v=1.5"/></a>
                                <form id="search" class="search-box" action="/search/index" method="GET">
                    <input class="keys" name="keywords" type="text" placeholder="搜索漏洞" required="required">
                    <input class="icon" type="submit" value="">
                    <input type="hidden" name="type" value=""/>
                </form>
                <div class="bug">
                    <div class="name"><span class="seled">全部</span><i class="arrow"></i></div>
                    <ul class="typelist">
                        <li data-index="3"><a href="javascript:void(0);">全部</a></li>
                        <li data-index="0"><a href="javascript:void(0);">漏洞</a></li>
                        <li data-index="1"><a href="javascript:void(0);">资讯</a></li>
                        <li data-index="2"><a href="javascript:void(0);">知识</a></li>
                    </ul>
                </div>
                                <div class="logNreg mobile-hide">
                    <div class="unlog">
                        <i></i>
                        <a href="log.html" class="log">登录</a>
                        <span>|</span>
                        <a href="reg.html" class="reg">注册</a>
                    </div>
                    <div class="loged">
                        <a href="/member/profile" class="user-center"><i></i><span class="user-name-tag">个人中心</span></a>
                        <div class="user-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting"><a href="http://i.360.cn/profile/accountmanage"
                                                               target="_blank"><i></i><span>账号设置</span></a></li>
                                <li class="alert-setting"><a href="/keywords/index"
                                                             target="_blank"><i></i><span>告警设置</span></a></li>
                                <li class="bug-alert"><a href="/myalarm/index" target="_blank"><i></i><span>漏洞告警</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mylearn/index" target="_blank"><i></i><span>我的知识</span></a>
                                </li>
                                <li class="my-knowl"><a href="/mycourse/index" target="_blank"><i></i><span>我的课堂</span></a>
                                </li>
                                <li class="my-exit"><a
                                            href="http://login.360.cn/?src=pcw_adlab&op=logout&destUrl=http://bobao.360.cn"><i></i><span>退出系统</span></a>
                                </li>
                            </ul>
                        </div>

                        <a href="/message" class="message-center" target="_blank"><i></i><span>我的消息</span></a>
                        <div class="message-links">
                            <span class="arrow"></span>
                            <ul>
                                <li class="account-setting" style="display:none;"><a href="/myres/index"
                                                                                     target="_blank"><i></i><span>回复我的</span></a>
                                </li>
                                <li class="my-bug"><a href="/myvul/index"
                                                      target="_blank"><i></i><span>我的漏洞</span></a></li>
                                <!--<li class="my-bug"><a href="/myres/index" target="_blank"><i></i><span>我的评论</span></a></li>-->
                                <!--<li class="alert-setting"><a href="###" target="_blank"><i></i><span>提到我的</span></a>
                                </li>-->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <style type="text/css">
            .nav {
                overflow: hidden;
            }

            .nav .scroll {
                width: auto;
            }
        </style>
        <div id="wrapper">
            <div id="scroller" class="nav">
                <div class="scroll">
                    <ul class="nav-list">
                        <li ><a class="link-nav"
                                                                                 href="/index/index">首页</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/vul/index">漏洞</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/introduce/list">招聘</a>
                        </li>
                        <li >
                        <a class="link-nav" href="/news/index">资讯</a><!--<i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/introduce/list">招聘</a></li>
                        </ul>
			-->
                        </li>
                        <li class="cur">
                        <a class="link-nav" href="/learning/index">知识</a><i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="/course/index">学院</a></li>
                        </ul>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/activity/index">活动</a></li>
                        <li class="mobile-hide "><a class="link-nav"
                                                                                                   href="/ctf/index">CTF训练营</a>
                        </li>
                        <li ><a class="link-nav"
                                                               href="/interref/list">安全内参</a></li>
                        <li ><a class="link-nav" href="/app/index">APP</a></li>

                        <!--<li ><a href="/course/index">学院</a></li>-->
                        <!--<li ><a href="/introduce/list">招聘</a></li>-->
                        <!--<li  class="mobile-hide"><a href="/ctf/index">CTF训练营</a></li>-->
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="mobile-content">
        <link rel="stylesheet" type="text/css" href="/css/news.css?v=3.5" />
<link rel="stylesheet" type="text/css" href="/ue/SyntaxHighlighter/shCoreDefault.css?v=1.0" />
<style>
    p .syntaxhighlighter {
        width: 80%;
    }
</style>

<div class="cur-pos w1000">当前位置：<a href="http://bobao.360.cn/">安全客</a> &gt;&gt; 知识详情</div>

<div class="content clearfix">
    <div class="main">
        <div class="article">
            <div id="article_box">
                <h2>&#039;cryptoApp‘的故事：片段分析敲诈勒索软件</h2>
                <div class="article-msg">
                    <span class="time">2015-08-18 19:00:06</span>
                                        <span class="read">阅读：8307次</span>
                    <span><a style="display: none;" class="good" href="javascript:;"
                             data-target="/learning/good" data-value="g_592"
                             data-type="learning">点赞(0)</a></span>
                    <span><a class="fav" href="javascript:;" data-target="/mylearning/add"
                             data-pk="592" data-type="learning">收藏</a></span>
                                        <span><a style="margin-left: 4px;" class="fav" href="http://blog.0x3a.com/post/126900680679/analysis-of-a-piece-of-ransomware-in-development"
                             target="_blank">来源： 360安全播报</a></span>
                    
                                    </div>
                <hr size="1">
                <div class="article-msg">
                    <p><!-- JiaThis Button BEGIN -->

<!--
<span class="jiathis_style"><span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_tsina"></a>
    <a class="jiathis_button_tqq"></a>
    <a class="jiathis_button_qzone"></a>
    <a class="jiathis_button_renren"></a>
    <a class="jiathis_button_xiaoyou"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
</span>

-->
</p>
                </div>
                <p><p style="text-align:center"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);"><img src="http://p0.qhimg.com/t01d1fd2c0fe51719ac.jpg" title="t01d1fd2c0fe51719ac.jpg" alt="http://p0.qhimg.com/t01d1fd2c0fe51719ac.jpg"/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 176, 80);">勒索软件在这过去的几年中一直是处于一个上升的阶段,在引领的这几年中也出现了越来越多的变异。这篇文章是一个新的“应变”,我可以告诉你它可以追溯到今年3月。在此之前我还没有看到任何关于这个的评论或信息(在日常生活中没有什么重大事件并且任何其他分析师听说过它)。我可以说它仍在开发阶段,这篇文章将讲述有关勒索软件的故事。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 112, 192);">发现</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">我准备通过Tor的隐藏服务地址(onion地址)来获取信息。通常这方面的市场比较多并且有许多用于隐藏hacker身份的网站,就像下面这个,其地址(如这篇文章所写)是:</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">guhvuoz7am24b5mv.onion</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">注意:服务是在八月初开始的。可能是“项目”是停止或者仅仅是通过一个旧的测试设置搬到一个新的C2继续他的运转</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">当访问隐藏的服务网址时,我注意到了以下:</span></p><p style="text-align:center"><img alt="http://p4.qhimg.com/t018e1759136892302a.png" src="http://p2.qhimg.com/t018e1759136892302a.png" title="t018e1759136892302a.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">这信息看起来就像看到了勒索软件的秘密围墙等等。它引起我的注意,是因为它通过RSA-2048描述的文件库和CryptoWall消息很像。在支付赎金后文件会恢复。向下滚动我们得到第二节:</span></p><p style="text-align:center"><img alt="http://p4.qhimg.com/t017aa0022530611c8b.png" src="http://p6.qhimg.com/t017aa0022530611c8b.png" title="t017aa0022530611c8b.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">这一节说没有原始密钥就无法解密文件&nbsp;(如果你使用RSA的2048,密钥是有意义的)。这值得注意的是使用其他工具相对其而言只会使得情况更糟。在知道此信息后,我们发现第三节:</span></p><p style="text-align:center"><img alt="http://p1.qhimg.com/t0113fd1a7722ccf0cf.png" src="http://p7.qhimg.com/t0113fd1a7722ccf0cf.png" title="t0113fd1a7722ccf0cf.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">本节讨论的是需要支付的赎金,1比特币。比如说,比特币可以买网址并且网址的比特币需要转移到:1&nbsp;abwltv7jttblmj8lrgq7tzcdkd4znet5c。这是一个链接到可以下载的(必须重点强调)只能支付赎金后才可以工作的解密软件。<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">下面第三节有一小部分是关于反病毒产品如何检测解密和引起解密问题:</span></p><p style="text-align:center"><img alt="http://p4.qhimg.com/t01e9a7a1d75d9b630b.png" src="http://p7.qhimg.com/t01e9a7a1d75d9b630b.png" title="t01e9a7a1d75d9b630b.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">所有的这一切都给出了一个好的迹象,就是至少之前我从没看过的一些(新的)正在开发的勒索软件。是时候找出一个与之结合有关的例子。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">这件事有趣的是,在你通常看到的CryptoWall,&nbsp;CTB&nbsp;or&nbsp;TorrentLocker感染中是没有需要“支付的ID”。这个机器的唯一ID是用来跟踪支付赎金的。在这个&nbsp;C2(如果我们可以这样称呼其),每个人都支付相同的比特币地址,它只是一个静态页面。</span></p><h2 style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 112, 192);">分析恶意软件本身</span></strong></h2><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">找到一个示例实际上是很简单的,它是今年5月上传到Malwr.com:</span><a style="font-size: 14px; text-decoration: underline; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">(csrsss.exe)</span></a><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">.</span><span style="color: rgb(38, 38, 38); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; text-indent: 2em;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(38, 38, 38); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; text-indent: 2em;">我能够找到它的原因是因为:比特币地址本身就是在二进制中(如同一个文本字符串):</span><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);"><br/></span></p><p style="text-align:center"><img alt="http://p2.qhimg.com/t010e909164cdd9e319.png" src="http://p1.qhimg.com/t010e909164cdd9e319.png" title="t010e909164cdd9e319.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">如果你查看了其余的文本,它实际匹配的相匹配条目是在C2,但我们等下再看。我们先来一起看这个例子,就会发现一些在PE文件中的信息。</span><span style="color: rgb(38, 38, 38); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; text-indent: 2em;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(38, 38, 38); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; text-indent: 2em;">马上弹出的是这么一个框体,它是用C++通过很多里面的编程(基类)编写的,很多vftable的查找使得在OllyDBG查看有一点困难。</span><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">接下来弹出的另一个框体是建造时间戳,它似乎与Malwr.com的提交日期是相同的(当然这可能是伪造的):</span></p><p style="text-align:center"><img alt="http://p7.qhimg.com/t017d9f7f52a4894fb7.png" src="http://p8.qhimg.com/t017d9f7f52a4894fb7.png" title="t017d9f7f52a4894fb7.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">更有趣的是在PR资源中,似乎还没有可以打包的方式,并且资源本质是可用的。</span></p><p style="text-align:center"><img alt="http://p9.qhimg.com/t01820c7ddbb220e46c.png" src="http://p4.qhimg.com/t01820c7ddbb220e46c.png" title="t01820c7ddbb220e46c.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">2,弹出的框中“BIM”和“HTML”,BIM实际上包含两个PE:</span></p><p style="text-align:center"><img alt="http://p9.qhimg.com/t01ffbd2ab19a0a2e8b.png" src="http://p3.qhimg.com/t01ffbd2ab19a0a2e8b.png" title="t01ffbd2ab19a0a2e8b.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">HTML资源(我们寻找匹配的比特币地址)实际上是落在受害者的电脑上的赎金消息:</span></p><p style="text-align:center"><img alt="http://p8.qhimg.com/t015bc407cfb4026224.png" src="http://p6.qhimg.com/t015bc407cfb4026224.png" title="t015bc407cfb4026224.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">也有大量的对话框在PE中,其中一些看起来像是勒索软件弹出的,就像通常看到的诸如此类型的恶意软件:</span></p><p style="text-align:center"><img alt="http://p5.qhimg.com/t011ec94b4dc4c5542f.png" src="http://p0.qhimg.com/t011ec94b4dc4c5542f.png" title="t011ec94b4dc4c5542f.png"/></p><p style="text-align:center"><img alt="http://p9.qhimg.com/t01b806db7297475025.png" src="http://p0.qhimg.com/t01b806db7297475025.png" title="t01b806db7297475025.png"/></p><p style="text-align:center"><img alt="http://p9.qhimg.com/t0196a768798a43265c.png" src="http://p9.qhimg.com/t0196a768798a43265c.png" title="t0196a768798a43265c.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">最后一个对话框在你点击它后会看到就像是一个经典的勒索软件会弹出的,。<br/>通过有效载荷时我也注意到每个bim都有其完整的链接器信息(PDB路径),其链接信息给了我以下PDB路径:</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;C:\Users\windows\Desktop\CryptoApp\build\bin\Release\&nbsp;CryptoApp.pdb</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;C:\Users\windows\Desktop\CryptoApp\build\bin\Release\&nbsp;KeepAlive.pdb</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;C:\Users\windows\Desktop\CryptoApp\build\bin\Release\&nbsp;SelfDestroy.pdb</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">这些PDB路径当然也是我称之为“CryptoApp”勒索软件的原因。</span></p><h3 style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192); font-size: 16px;"><strong><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">启动和持久性</span></strong></span></h3><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">主要的&#39;CryptoApp.pdb’是来自从Malwr获取的intiail样本,另外两个是来自两个嵌入式的PE。其功能是非常多的,正如他们的名字一样。<br/>“KeepAlive”&nbsp;为windows创建了启动键&nbsp;(然而它实际上在任何地方都不会打扰或复制有效载荷,只是会从目录这运行):</span></p><p style="text-align:center"><img alt="http://p5.qhimg.com/t01137208c9824b46a7.png" src="http://p9.qhimg.com/t01137208c9824b46a7.png" title="t01137208c9824b46a7.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">有趣的是“CryptoAppDelay”的关键是不断更新,它保持每天都会更新。通过查找负责这部分的代码,我们发现:</span></p><p style="text-align:center"><img alt="http://p4.qhimg.com/t01aadf1a764423d6a6.png" src="http://p7.qhimg.com/t01aadf1a764423d6a6.png" title="t01aadf1a764423d6a6.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">这部分可以被分割为三个部分(标有红色块),第一部分的检查是“CryptoAppForcedEnded”的存在,其存在的关键是呈现出(通过绿线显示)。如果该键不存在,它会移到下一个可以生成一个线程的部分,直到它完成。线程完成代码后进入第3节,在此中,它改变了&#39;CryptoAppDelay&#39;键的值。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">虽然这部分不是超有趣的新创建的线程,但它是一种监督。该线程背后的想法是,它通过等待&#39;延迟&#39;来达到一定数量后,它将执行代码的其余部分。线程代码如下所示:</span></p><p style="text-align:center"><img alt="http://p7.qhimg.com/t0173f2cf9877e2c445.png" src="http://p1.qhimg.com/t0173f2cf9877e2c445.png" title="t0173f2cf9877e2c445.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">首先获得微软软件的处理\&nbsp;\&nbsp;Windows&nbsp;\&nbsp;CurrentVersion&nbsp;\运行的关键是能够根据(“CryptoAppDelay”值)查询值。设置一些变量后和进入一个循环(通过绿色框表示)。循环是有不可思议的东西发生的地方;它检查了“CryptoAppDelay”的值,并且把它比作一个数字即使这个集合并不是能够非常清晰的读取,主要做了以下步骤:</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">把“CryptoAppDelay”键的值,除以1000,比较是否超过86400,</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">原因如下,如果没有达到这个数字的CryptoAppDelay值设置为返回的值,CurrenTickCount()”是一个窗口函数,它返回的毫秒之后机器将会启动。通过你获得的1000秒来区分开,86400实际上是24小时;勒索软件在等到机器运转24小时后才会做一些破坏</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">每当勒索软件运行时,它所产生的嵌入式PEs是用于持久性。一个例子是“keepalive”,你会发现运行时就会开始感染:</span></p><p style="text-align:center"><img alt="http://p1.qhimg.com/t01ef94b689bb3d2461.png" src="http://p0.qhimg.com/t01ef94b689bb3d2461.png" title="t01ef94b689bb3d2461.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">这里的“keepalive。exe”时在临时目录(用绿色框标志)的下方,并且实际ransomware的程序&#39;csrss.exe’依旧在休眠直到达到24小时正常运行时间(红色框标记的)。试图杀死ransomware的程序并不多,其是通过keepalive负载而维持运转的。让我们看看这是如何工作的。察看keepalive&nbsp;PE给我们的参数,我们已经可以得到一个关于其工作原理的好想法:</span></p><p style="text-align:center"><img alt="http://p7.qhimg.com/t01b74d01f4146956f9.png" src="http://p7.qhimg.com/t01b74d01f4146956f9.png" title="t01b74d01f4146956f9.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">它给出一个图像路径(勒索软件本身的)和当前运行的勒索软件进程的PID。查看通过把the&nbsp;&#39;keepalive.exe’&nbsp;分解出的PE,我们发现所使用的参数确实是“保护”ransomware的主要过程。方法是:一旦“阻碍”ransomware的主要进程被停止,它就一遍又一遍的开始。它的工作原理是这样的:</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;处理的流程表</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;调用Windows函数WaitForMulipleObjects和停止流程处理</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;当它返回(及其相关戒烟)重启ransomware过程和关闭自我(keepalive退出后重新启动ransomware的主程序)</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;Ransomware过程启动一个新的keepalive又开始同样的事情(监督线程)</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">ransomware过程本身可以重新启动,只计算系统正常运行时间(通过之前描述的注册表键)。</span></p><h3 style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; color: rgb(0, 112, 192);"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">文件加密</span></strong></span></h3><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">ransomware将通过下面的文件扩展名加密文件,总共162个文件扩展名:</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">.3fr&nbsp;.3gp&nbsp;.7z&nbsp;.accdb&nbsp;.ai&nbsp;.arc&nbsp;.arw&nbsp;.avi&nbsp;.bad&nbsp;.bay&nbsp;.bmp&nbsp;.cam&nbsp;.cdr&nbsp;.cer&nbsp;.cineon&nbsp;.cr2&nbsp;.crt&nbsp;.crw&nbsp;.csv&nbsp;.ctl&nbsp;.dat&nbsp;.db&nbsp;.dbf&nbsp;.dcr&nbsp;.der&nbsp;.des&nbsp;.dicom&nbsp;.dng&nbsp;.doc&nbsp;.docm&nbsp;.docx&nbsp;.dsc&nbsp;.dwg&nbsp;.dxf&nbsp;.dxg&nbsp;.eps&nbsp;.erf&nbsp;.fla&nbsp;.flv&nbsp;.fmb&nbsp;.fmt&nbsp;.fmx&nbsp;.gif&nbsp;.hdr&nbsp;.html&nbsp;.iif&nbsp;.img&nbsp;.indd&nbsp;.jpe&nbsp;.jpeg&nbsp;.jpg&nbsp;.kdc&nbsp;.log&nbsp;.lst&nbsp;.m4v&nbsp;.mdb&nbsp;.mdf&nbsp;.mef&nbsp;.mov&nbsp;.mpeg&nbsp;.mrw&nbsp;.nd&nbsp;.nef&nbsp;.nrw&nbsp;.odb&nbsp;.odm&nbsp;.odp&nbsp;.ods&nbsp;.odt&nbsp;.openexr&nbsp;.ora&nbsp;.orf&nbsp;.p12&nbsp;.p7b&nbsp;.p7c&nbsp;.pbm&nbsp;.pck&nbsp;.pdd&nbsp;.pdf&nbsp;.pef&nbsp;.pem&nbsp;.pfx&nbsp;.pgm&nbsp;.pic&nbsp;.pkb&nbsp;.pks&nbsp;.plb&nbsp;.pls&nbsp;.png&nbsp;.pot&nbsp;.ppm&nbsp;.pps&nbsp;.ppt&nbsp;.pptm&nbsp;.pptx&nbsp;.prn&nbsp;.psb&nbsp;.psd&nbsp;.pst&nbsp;.ptx&nbsp;.qba.tlg&nbsp;.qbm&nbsp;.qbr&nbsp;.qbw&nbsp;.qbw.tlg&nbsp;.qbx&nbsp;.qby&nbsp;.qfx&nbsp;.r3d&nbsp;.raf&nbsp;.rar&nbsp;.raw&nbsp;.rdf&nbsp;.rdo&nbsp;.rep&nbsp;.rex&nbsp;.rtf&nbsp;.rw2&nbsp;.rwl&nbsp;.sql&nbsp;.srf&nbsp;.srw&nbsp;.sti&nbsp;.sxi&nbsp;.tiff&nbsp;.txt&nbsp;.vdi&nbsp;.wb2&nbsp;.wpd&nbsp;.wps&nbsp;.xbm&nbsp;.xlk&nbsp;.xls&nbsp;.xlsb&nbsp;.xlsm&nbsp;.xlsx&nbsp;.xml&nbsp;.yaml&nbsp;.zip&nbsp;.php&nbsp;.css&nbsp;.asp&nbsp;.cpp&nbsp;.c&nbsp;.js&nbsp;.pl&nbsp;.perl&nbsp;.swf&nbsp;.aspx&nbsp;.potx&nbsp;.potm&nbsp;.ppam&nbsp;.ppsx&nbsp;.ppsm&nbsp;.sldx&nbsp;.sldm&nbsp;.thmx&nbsp;.xlam&nbsp;.xltm&nbsp;.dotm&nbsp;.dotx</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">这里大部分的文件并不奇怪,图像格式,文本文档格式,报告格式。我发现有趣的是文件扩展名的文件相关解释,特别是QuickBooks会计软件(.qba&nbsp;.tlg&nbsp;.qbm&nbsp;.qbr&nbsp;.qbw&nbsp;.qbw&nbsp;.tlg&nbsp;.qbx&nbsp;.qby&nbsp;.qfx)的目标公司。它试图找到文件访问所有可用的逻辑驱动器,它使用一个电话(</span><a style="font-size: 14px; text-decoration: underline; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">GetLogicalDrives()</span></a><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">)与下面的列表映射的驱动器字母(基本上每一个都可能是驱动字母,整个字母表):</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">A:&nbsp;B:&nbsp;C:&nbsp;D:&nbsp;E:&nbsp;F:&nbsp;G:&nbsp;H:&nbsp;I:&nbsp;J:&nbsp;K:&nbsp;L:&nbsp;M:&nbsp;N:&nbsp;O:&nbsp;P:&nbsp;Q:&nbsp;R:&nbsp;S:&nbsp;T:&nbsp;U:&nbsp;V:&nbsp;W:&nbsp;X:&nbsp;Y:&nbsp;Z:</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">对跟踪ransomware的加密文件信息存储件在磁盘上的一个sqlite数据库中。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">Ransomware充分利用了微软的CryptoAPI,特别是它使用了RSA加密</span></p><p style="text-align:center"><img alt="http://p8.qhimg.com/t014a2ce65fa1f0bf2c.png" src="http://p2.qhimg.com/t014a2ce65fa1f0bf2c.png" title="t014a2ce65fa1f0bf2c.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">设置加密后,会生成一个私人或公共密钥对应它开始启动的文件,加密的方法它遵循“</span><a style="font-size: 14px; text-decoration: underline; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">混合密码系统</span></a><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">”。在这个系统里你不用使用私钥加密文件,但你要创建对称密钥(我称之为“文件”下面的键)进行数据加密。这些键是使用私有密匙加密的操作。这意味着解密的文件需要私钥文件的密钥解密,依次解密文件数据。<br/>他们的搜索是基于上面所示的逻辑驱动器的基于描述文件扩展名的可用匹配的文件。当一个文件的加密是有效时,它将开始加密,工作如下:</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;它将获取完整的文件名并且追加。对其加密,作为新的文件扩展名</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;“文件”键(MSDN会称它为会话密钥)是通过&nbsp;(</span><a style="font-size: 14px; text-decoration: underline; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">CryptGenKey()</span></a><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">)使用前面初始化密码并且使用PROV_RSA_FULL调用生成的</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;一个文件处理的开口是新创建文件名(加密的一个)</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;4字节被写入到打开的文件(int)通过一种标记/标签的加密文件的0&nbsp;x2200af&nbsp;中的&#39;magic&nbsp;value’</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;4个字节导出“文件”的键(密钥用于加密/解密文件数据,加密当然,可以通过使用私钥进行解密的pub&nbsp;/所使用的关键部分)后,是用</span><a style="font-size: 14px; text-decoration: underline; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">CryptExportKey()</span></a><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">]SIMPLEBLOB&nbsp;blob类型的出口</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;写完‘文件’的键的文件,其原始文件(非加密)正在读取,加密并且附加到.encrypted&nbsp;文件中</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;磁盘上的文件加密后插入到磁盘上的SQLite数据库(用于列表用户他/她的解密加密的文件以及再次找到的文件)</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;将加密文件插入到SQLite数据库成功后,在磁盘中通过调用</span><a style="font-size: 14px; text-decoration: underline; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">DeleteFile()</span></a><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">)功能删除它。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">它把私人/公共密钥的对应发送到C2服务器,有关详细信息,请参阅下面的“C2沟通”部分。<br/>作为一个旁观者,整个加密过程ransomware状态保存在注册表中,同时显示其当前状态的加密,有多少文件等。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; color: rgb(0, 112, 192);"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">解密</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">在网站上有一个链接到解密,这是相当有趣的。除了它是一个“解密”以外,从原始恶意软件或其他感染上它实际上是都有可能的。“解密”事实上是稍微修改主要恶意软件本身后的版本。<br/>然而它确实显示了一些有趣的事,我设法从Malwr.com获取的样本是一个过时的ransomware的版本。除了一些稍微清理和修改的功能,它新增了一些功能。这些功能之一是显示这张图片:</span></p><p style="text-align:center"><img alt="http://p3.qhimg.com/t01de592b2ee83a5204.png" src="http://p3.qhimg.com/t01de592b2ee83a5204.png" title="t01de592b2ee83a5204.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">它是在临时目录的下面。&#39;wlp.jpg’和系统设置为背景,我们可以看到这种行为在分解:</span></p><p style="text-align:center"><img alt="http://p8.qhimg.com/t016e16b4f705a27ce2.png" src="http://p3.qhimg.com/t016e16b4f705a27ce2.png" title="t016e16b4f705a27ce2.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">除了封锁消息,这里还有一个新的解密对话框(连同ransomware本身)是关于解密过程的:</span></p><p style="text-align:center"><img alt="http://p1.qhimg.com/t0131db45ddb65bee28.png" src="http://p1.qhimg.com/t0131db45ddb65bee28.png" title="t0131db45ddb65bee28.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">ransome下降在HTML页面的形式的信息,我们之前看到的样品也已经更新。现在包括Tor隐藏的链接服务也在红色图片中:</span></p><p style="text-align:center"><img alt="http://p2.qhimg.com/t01933fce43c4be595a.png" src="http://p6.qhimg.com/t01933fce43c4be595a.png" title="t01933fce43c4be595a.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">这一切显示我从Malwr.com获取的样品已经相当久了。<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">解密本身对Blockchain.info的网站检查是用户是否支付。我们可以在decrypter’s&nbsp;dissasembly直接的使用它</span></p><p style="text-align:center"><img alt="http://p6.qhimg.com/t01d3840bd5ce67a65d.png" src="http://p9.qhimg.com/t01d3840bd5ce67a65d.png" title="t01d3840bd5ce67a65d.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">它解析事务处理计数和匹配来自blockchain.info的比特币地址,以事务解析为例:</span></p><p style="text-align:center"><img alt="http://p9.qhimg.com/t0149fc36ec190272cb.png" src="http://p9.qhimg.com/t0149fc36ec190272cb.png" title="t0149fc36ec190272cb.png"/></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">付款方式确认如下:<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">1.用户支付固定金额的比特币到指定的比特币地址1abwltv7jttblmj8lrgq7tzcdkd4znet5c<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">2.用户在勒索软件的付款形式上复制自己的比特币地址<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">3.解密软件检查比特币是否是在感染期后支付到指定的比特币地址(这也是存储在注册表)来确认付款是否与感染有关。<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">4.如果用户支付了将会通过C2获取关键信息</span><span style="color: rgb(38, 38, 38); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; text-indent: 2em;"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(38, 38, 38); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 14px; text-indent: 2em;">在支付的1abwltv7jttblmj8lrgq7tzcdkd4znet5c网站列出的比特币地址只有一个“在五月十五日支付1比特币”这一确切的赎金要求。付款后仅仅在两天之内勒索软件的第一开发版本被上传到malwr.com,使它看起来像在测试勒索软件的解密部分</span><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192); font-size: 16px;"><strong><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">文件解密</span></strong></span><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);"><br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">当接收者确认用户已交纳赎金,私钥将从C2服务器获得(这是如何完成的将从下面的C2通信部分解释)。这个密钥将通过用户的文件解密步骤:<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">1.找到当地的SQLite数据库,列出所有加密的文件<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">2.它会截取文件,改变文件扩展名从.encrypted和.decrypted加密。<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">3.这将确认该文件魔法标签的0x2200af前4字节,如果没有,将会忽略这个文件<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">4.它将从包含“文件”或“会话”关键词的文件中截取下一节<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">5.使用此密钥和私有密钥将开始解密文件<br/></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">6.这个过程一直持续到他们的每一个文件都被解密&nbsp;</span></p><h3 style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; color: rgb(0, 112, 192);"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">C2的沟通</span></strong></span></h3><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">虽然隐藏的服务展示了“可怕的”有关所需的赎金的信息,但是对于主机并没有C2的通信流量。真正的沟通是对主机以外的Tor。有趣的是这个主机下降同时,隐藏服务也下降,这表明它们可能被托管在同一个系统上,虽然我对这并没有确切的证据。<br/>ransomware本身是HTTP的通信只对集中式C2服务器,然而对集中式C2服务器解密是通过HTTP通信以及SSL进入blockchain.info的网络流量。</span></p><h4 style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 112, 192);">Ransomware&nbsp;C2沟通</span></h4><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">ransomware本身对静态域通信:cryptorepairsystems.com(当时指着一个主机在波斯尼亚和黑塞哥维那:80.242.123.197)在简单的HTTP上。通信路径有两种:</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;cryptorepairsystems.com/ksubmit.php——用来发送用于文件加密的关键</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;cryptorepairsystems.com/kretrieve.php——解密检索使用的加密密钥来解密加密的文件</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">通信/&nbsp;ksubmit.php是简单的HTTP&nbsp;POST通讯。特定的首要是硬编码为这个通讯:“内容类型:应用程序/&nbsp;x-www-form-urlencoded”执行服务器,以此检查它是urlencoded表单数据。表单数据具有以下格式:</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">bitcoin_address&nbsp;=&nbsp;%&nbsp;s&amp;empid&nbsp;=&nbsp;%&nbsp;s&amp;comp&nbsp;=&nbsp;%&nbsp;s&amp;ipv4&nbsp;=&nbsp;%&nbsp;s&amp;blkk&nbsp;=&nbsp;%&nbsp;s&amp;publ&nbsp;=&nbsp;%&nbsp;s&amp;priv&nbsp;=&nbsp;%&nbsp;s</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">具体参数:</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;bitcoin_address-付款地址</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;empid-系统惟一的ID</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;comp&nbsp;-计算机名通过调用获得(</span><a style="font-size: 14px; text-decoration: underline; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">GetComputerName()</span></a><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">]</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;ipv4&nbsp;-&nbsp;ipv4地址为感染客户</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;blkk-空的硬编码的值(不确定真正目的)</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;publ&nbsp;-&nbsp;RSA密钥集的公布,公钥用于加密的文件</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;priv——私有密钥的RSA密钥用于加密的文件</span></p><h4 style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 112, 192); font-size: 16px;"><strong><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">解密C2沟通</span></strong></span></h4><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">在前一节中说,通信/&nbsp;kretrieve.php是特定于解密。其通信协议也只是普通的HTTP&nbsp;POST沟通。特定的头是硬编码的通信,其ransomwared登入的一样:“内容类型:应用程序/&nbsp;x-www-form-urlencoded”。表单数据具有以下格式:</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">empid&nbsp;=&nbsp;%&nbsp;s&amp;comp&nbsp;=&nbsp;%&nbsp;s&amp;ipv4&nbsp;=&nbsp;%&nbsp;s</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">具体参数:</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;empid-系统惟一的ID</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;comp&nbsp;-计算机名获得通过调用(</span><a style="font-size: 14px; text-decoration: underline; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">GetComputerName()</span></a><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">]</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;ipv4&nbsp;-&nbsp;ipv4地址为感染客户</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">&nbsp;结论:未完成的而不是分散的</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">&nbsp;从我的角度看,这款勒索软件(ransoware)正处于发展当中而且未完成,还在继续发展。有些地方在很好的运行,而有些地方是破碎的、不稳定的。我没有任何线索来发掘这背后的东西或者更多的C2s。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">&nbsp;&nbsp;&nbsp;与其他勒索软件威胁相比如CryptoWall,这款软件比较业余和简单,但又很难去比较。如果对它的后台一无所知(它可以扭转C2洋葱地址,如果每位会员都有会员系统;这不是很相似,但谁知道呢)和演员,我不能从“尺寸”这一角度来告诉你更多关于这款软件的东西。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">&nbsp;&nbsp;&nbsp;&nbsp;除去我上面说的这些东西,其他方面都存在着缺陷。我不会将更多的细节放到我的博客上面,但文件恢复有很多不同的方法使其成为可能。c2的研究我会继续下去,我会一直注意观察看是否有新的东西出现。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">注意:如果你亲自去看一下,你会发现我已经跳过了一些细节。我只写出一些重要的细节使得这个结构可以很好的工作。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">例子与国际石油公司</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">我只找到2个例子,一个是旧的发展建立在我从Malwr.com上发现的和从Tor隐藏服务C2解密的。解密并没有公开之前我把它发布在Malwr.com。这是我们从Malwr.com下载和VirusTotal:样品</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;老开发样品——(</span><a style="font-size: 14px; text-decoration: underline; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">Malwr</span></a><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">][</span><a style="font-size: 14px; text-decoration: underline; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">VT:36/56</span></a><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">]</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">·&nbsp;解密样品——(</span><a style="font-size: 14px; text-decoration: underline; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);"><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">Malwr</span></a><span style="font-size: 14px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(38, 38, 38);">&lt;span style=&quot;font-family:&#39;宋体&#39;;color:rgb(3</span></p></p>
                <hr/>
                <p style="text-align: center;">
                    <img src="http://bobao.360.cn/img/app.jpeg"/>
                    <img src="http://bobao.360.cn/img/weixin.jpeg"/>
                </p>
                                <p>本文由 安全客 翻译，转载请注明“转自安全客”，并附上链接。<br/><a class="text-more" href="http://blog.0x3a.com/post/126900680679/analysis-of-a-piece-of-ransomware-in-development" target="_blank">原文链接：http://blog.0x3a.com/post/126900680679/analysis-of-a-piece-of-ransomware-in-development</a></p>
                            </div>
            <div style="margin-top: 20px;background-color:#FFFFFF">
    <input type="hidden" id="detail_title" name="detail_title" value="'cryptoApp‘的故事：片段分析敲诈勒索软件 - 安全客 - 有思想的安全新媒体" />
    <input type="hidden" id="use_nickname" name="use_nickname" value="0" />
    <a name="mao"></a>
    <div class="reg-log mobile-hiden">
        <div class="" id="userTo">   
            <div id="to-list" class="input-text" style="">
                <textarea disabled="disabled" class="hide"  id="comment-content" to="to"></textarea>
                <ul id="preadded" style="display:none">       
                </ul>
                <div id="to-auto" style="width: 200px">
                    <ul id="feed">
                    </ul>
                </div>
            </div>
        </div>
        <input type="hidden" id="source-id" value="592" />
        <input type="hidden" id="source-type" value="learning" />
        <input type="hidden" id="post-comment-url" value="/comment/add" />
        <input type="hidden" id="post-nickname-url-ajax" value="/comment/randnicknameajax" />
        <input type="hidden" id="post-check-login-url-ajax" value="/comment/checklogin" />
        <input type="hidden" id="stoken_comment_set" value="64d932c9bb50dc5a83db601d9b02e735">                 <span class="join">参与讨论，请先 <a href="javascript:;" class="comment-login">登录</a> | <a href="javascript:;" class="comment-reg">注册</a> |  <a href="javascript:;" class="anonymous-comment">匿名评论</a></span>
            </div>
    <div class="mobile-hide" style="width: 870px; margin: 0 auto;">
        <label style="vertical-align:middle;" for="use_nickname">匿名</label> 
        <input style="vertical-align:middle;" id="trigger-nickname" name="use_nickname" class="use_nickname" type="checkbox" value="0" />

        <a href="javascript:;" class="apply-use button" id="submit-comment" data-target="/comment/add">发布</a>
    </div>


    <div class="clearfix"></div>
    <div class="comments">
        <div class="comments-head">
            <span class="title">用户评论</span>
        </div>
                <div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="/img/photo/11x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="2498" user-name="mike cry" href="javascript:;">
                mike cry            </a>
                        <span class="comment-time">2016-03-04 19:42:26</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="2498">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;"  class="good" data-target="/comment/good" data-value="g_2498" data-type="comment">点赞</a></span>
            </div>
        </div>

        <p class="content">bingo@opensourcemail.org是一个危险的勒索它可以加密你的电脑，如果你试图解密然后它会要求钱从你的赎金。因此，作为快，您可以将其删除。为了更多地了解它的访问拆除 http://www.Howtocleanspyware-cn.net</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>

        <a class="more-long comment-more" href="javascript:;" data-target="/comment/more" data-type="learning" data-source-id="592" data-page="2">查看更多</a>
            </div>
</div>
<script>
    $(function () {
        $('.anonymous-comment').click(function () {
            $(".join").hide();
            $(".reg-log textarea").first().removeAttr("disabled").show();
            $('#use_nickname').val('1');
//            $('#trigger-nickname').attr('checked', true);
            $('#trigger-nickname').trigger('click');
        });
        //为所有复选框绑定事件
//        checkbox_on_click();
        //ajax随机获取昵称
//        randnicknameajax(0);
        //ajax检测登录状态
        comment_check_login();
    });



    function input_checkbox(flag) {
        $('input:checkbox').each(function () {
            var value = flag ? 1 : 0;
            $(this).prop('checked', flag);
            $(this).val(value);
        });
    }

//ajax随机获取昵称
    function randnicknameajax(flag) {
        $.ajax({
            type: 'POST',
            url: $('#post-nickname-url-ajax').val(),
            data: {limit: 1, flag: flag},
            dataType: "json",
            success: function (data) {
                $('#nick-name').val(data.data[0]);
                _nick_name=data.data[0];
            }
        });
    }
    $();
//ajax检测登录状态
    function comment_check_login() {
        $.ajax({
            type: 'POST',
            url: $('#post-check-login-url-ajax').val(),
            data: {},
            dataType: "json",
            success: function (data) {
                if (data.success) {
                    $('.join').hide();
                    $(".reg-log textarea").first().removeAttr("disabled").show();
                    $("#span_use_nickname").show();
                    $('#use_nickname').val('0');
                    $('#use_nickname').attr('checked', false);
                }
            }
        });
    }
</script>        </div>
    </div>
    <div class="side-bar">
        <div class="mod hot-news">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-hot"></i><span>热门知识</span></h2>
    </div>
    <ul class="links-list">
                                <li><a href="/learning/detail/4411.html" alt="【漏洞预警】一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现——最新的Office高级威胁攻击预警" target="_blank">【漏洞预警】一个换行符引发的奥斯卡...</a></li>
                                <li><a href="/learning/detail/4416.html" alt="【漏洞预警】Microsoft .NET Framework漏洞（CVE–2017–8759）预警" target="_blank">【漏洞预警】Microsoft .NE...</a></li>
                                <li><a href="/learning/detail/4414.html" alt="【技术分享】妙用JavaScript绕过XSS过滤" target="_blank">【技术分享】妙用JavaScrip...</a></li>
                                <li><a href="/learning/detail/4425.html" alt="【安全报告】XShellGhost事件技术回顾报告" target="_blank">【安全报告】XShellGhost事件...</a></li>
                                <li><a href="/learning/detail/4424.html" alt="【知识】9月16日 - 每日安全知识热点" target="_blank">【知识】9月16日 - 每日安全知识热...</a></li>
                                <li><a href="/learning/detail/4418.html" alt="【技术分享】利用威胁情报数据平台拓展APT攻击线索一例" target="_blank">【技术分享】利用威胁情报数据平台拓...</a></li>
            </ul>
</div>        <!-- 友情链接 -->
        <div class="mod blog-links mobile-hide">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-link"></i><span>友情链接</span></h2>
        <a href="/links/index.html" class="more">更多<i></i></a>
    </div>
        <ul class="links-list">
                <li><a href="http://bbs.360safe.com" alt="360安全社区" target="_blank">360安全社区</a></li>
                <li><a href="http://zhuji.360.cn" alt="360主机卫士" target="_blank">360主机卫士</a></li>
                <li><a href="http://blogs.360.cn/" alt="奇虎360技术博客" target="_blank">奇虎360技术博客</a></li>
                <li><a href="http://wangzhan.360.cn/" alt="360网站卫士" target="_blank">360网站卫士</a></li>
                <li><a href="http://webscan.360.cn/" alt="360网站安全检测" target="_blank">360网站安全检测</a></li>
                <li><a href="http://research.360.cn/report/" alt="360研究报告" target="_blank">360研究报告</a></li>
                <li><a href="http://unicorn.360.cn/" alt="360 Unicorn Team" target="_blank">360 Unicorn Team</a></li>
                <li><a href="http://appscan.360.cn/" alt="360捉虫猎手" target="_blank">360捉虫猎手</a></li>
                <li><a href="https://threathunter.org/" alt="ThreatHunter社区" target="_blank">ThreatHunter社区</a></li>
                <li><a href="http://security.360.cn/" alt="360安全应急响应中心" target="_blank">360安全应急响应中心</a></li>
            </ul>
    </div>
        <!-- 联系我们 -->
        <div class="mod contact mobile-hide" style="text-align:center">
    <div class="head-bar clearfix">
        <h2><i></i><span>关注我们</span></h2>
    </div>
    <!-- 微信关注 -->
    <ul class="contact-way">
        <li><a>微信关注</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/qrcode_adlab_weixin.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
    <!-- APP下载 -->
    <ul class="contact-way">
        <li><a>安全播报APP</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="/img/scan_code_big.png?v=1.1"  width="145px" height="145px;"/>
    </div>
    
</div>

    </div>
</div>

<script type="text/javascript" src="/js/jquery-ui.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/jquery.noty.packaged.min.js?v=3.0"></script>
<script type="text/javascript" src="/js/common.js?v=4.5"></script>
<script>$(function() {sync_count('comment');});</script>


<!-- 语法高亮 -->
<script type="text/javascript" src="/ue/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">SyntaxHighlighter.all();sync_count('vul');sync_count('news');sync_count('learning');sync_count('activity');sync_count('course');sync_count('ctf');</script>
    </div>

        <div class="footer">
        <div class="friend-link">
            <a href="http://www.360.cn/" target="_blank">360首页</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">关于我们</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">联系我们</a>
            <span>|</span>
            <a href="/links/index.html" target="_blank">友情链接</a>
            <span>|</span>
            <a href="/introduce/index" target="_blank">招贤纳士</a>
        </div>
        <div class="copy">
            Copyright &copy; 360网络攻防实验室 All Rights Reserved <span class="copy_icp">京ICP证080047号[京ICP备08010314号-6]</span>
        </div>
    </div>
    
</div>

<!--奇舞团统计-->

<script src='https://s.ssl.qhimg.com/static/f5407c785655e6a1/monitor_analytic.js'></script>
<script>
    monitor.setProject('QH_171_1').getTrack().getClickAndKeydown().getClickHeatmap(10, 1);
</script>

<div class="hide">
    <script src="https://s95.cnzz.com/z_stat.php?id=1253147824&web_id=1253147824" language="JavaScript"></script>
</div>
<div class="backToTop_wrap off">
    <a id="back_to_top" class="backToTop" href="javascript:;" title="返回顶部"></a>
</div>
<script>
    var $backToTop_wrap = $(".backToTop_wrap"),
        $backToTop_btn = $("#back_to_top");

    if ($(window).scrollTop() > 100) {
        $backToTop_wrap.removeClass("off");
    }
    else {
        $backToTop_wrap.addClass("off");
    }

    $(window).on("scroll", function () {
        if ($(this).scrollTop() > 100) {
            $backToTop_wrap.removeClass("off");
        }
        else {
            $backToTop_wrap.addClass("off");
        }
    });

    $backToTop_btn.on("click", function () {
        $("html, body").animate({scrollTop: 0}, 120);
    });

    $(function () {
        var navlist = $('.nav-list > li');

        navlist.each(function () {
            $(this).on('mouseenter', function () {
                $(this).addClass('selected');
            });

            $(this).on('mouseleave', function () {
                $(this).removeClass('selected');
            });
        });
    })
</script>



</body>
</html>
