<!DOCTYPE HTML>
<html>
<head>
<meta name="viewport" content="width=device-width , initial-scale=1.0 , user-scalable=0 , minimum-scale=1.0 , maximum-scale=1.0" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>云安全监控：云安全系列（一） | Sec-UN 安全圈</title>
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="pingback" href="https://www.sec-un.org/xmlrpc.php" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Sec-UN 安全圈 &raquo; Feed" href="https://www.sec-un.org/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sec-UN 安全圈 &raquo; 评论Feed" href="https://www.sec-un.org/comments/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.sec-un.org\/wp-includes\/js\/wp-emoji-release.min.js?ver=d2207c9bc2f8d7af72d793379f207c99"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,56826,8203,55356,56819),0,0),c=j.toDataURL(),b===c&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55358,56794,8205,9794,65039),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55358,56794,8203,9794,65039),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='jQuery_notice-css'  href='https://www.sec-un.org/wp-content/plugins/cubepoints/modules/notice/jquery.notice.css?ver=d2207c9bc2f8d7af72d793379f207c99' type='text/css' media='all' />
<link rel='stylesheet' id='cptch_stylesheet-css'  href='https://www.sec-un.org/wp-content/plugins/captcha/css/front_end_style.css?ver=4.3.5' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://www.sec-un.org/wp-includes/css/dashicons.min.css?ver=d2207c9bc2f8d7af72d793379f207c99' type='text/css' media='all' />
<link rel='stylesheet' id='cptch_desktop_style-css'  href='https://www.sec-un.org/wp-content/plugins/captcha/css/desktop_style.css?ver=4.3.5' type='text/css' media='all' />
<script type='text/javascript' src='https://www.sec-un.org/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='https://www.sec-un.org/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript' src='https://www.sec-un.org/wp-content/plugins/cubepoints/modules/notice/jquery.notice.js?ver=1.0.1'></script>
<link rel='prev' title='http81新型僵尸网络来袭  国内超5万台摄像头遭控制' href='https://www.sec-un.org/http81%e6%96%b0%e5%9e%8b%e5%83%b5%e5%b0%b8%e7%bd%91%e7%bb%9c%e6%9d%a5%e8%a2%ad-%e5%9b%bd%e5%86%85%e8%b6%855%e4%b8%87%e5%8f%b0%e6%91%84%e5%83%8f%e5%a4%b4%e9%81%ad%e6%8e%a7%e5%88%b6/' />
<link rel='next' title='SyScan360在西雅图办黑客大会  谷歌微软鼎力支持' href='https://www.sec-un.org/syscan360%e5%9c%a8%e8%a5%bf%e9%9b%85%e5%9b%be%e5%8a%9e%e9%bb%91%e5%ae%a2%e5%a4%a7%e4%bc%9a-%e8%b0%b7%e6%ad%8c%e5%be%ae%e8%bd%af%e9%bc%8e%e5%8a%9b%e6%94%af%e6%8c%81/' />
<link rel="canonical" href="https://www.sec-un.org/%e4%ba%91%e5%ae%89%e5%85%a8%e7%9b%91%e6%8e%a7%ef%bc%9a%e4%ba%91%e5%ae%89%e5%85%a8%e7%b3%bb%e5%88%97%ef%bc%88%e4%b8%80%ef%bc%89/" />
<script type="text/javascript">
(function(url){
	if(/(?:Chrome\/26\.0\.1410\.63 Safari\/537\.31|WordfenceTestMonBot)/.test(navigator.userAgent)){ return; }
	var addEvent = function(evt, handler) {
		if (window.addEventListener) {
			document.addEventListener(evt, handler, false);
		} else if (window.attachEvent) {
			document.attachEvent('on' + evt, handler);
		}
	};
	var removeEvent = function(evt, handler) {
		if (window.removeEventListener) {
			document.removeEventListener(evt, handler, false);
		} else if (window.detachEvent) {
			document.detachEvent('on' + evt, handler);
		}
	};
	var evts = 'contextmenu dblclick drag dragend dragenter dragleave dragover dragstart drop keydown keypress keyup mousedown mousemove mouseout mouseover mouseup mousewheel scroll'.split(' ');
	var logHuman = function() {
		var wfscr = document.createElement('script');
		wfscr.type = 'text/javascript';
		wfscr.async = true;
		wfscr.src = url + '&r=' + Math.random();
		(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(wfscr);
		for (var i = 0; i < evts.length; i++) {
			removeEvent(evts[i], logHuman);
		}
	};
	for (var i = 0; i < evts.length; i++) {
		addEvent(evts[i], logHuman);
	}
})('//www.sec-un.org/?wordfence_logHuman=1&hid=B6412C5F87779EEF8A74C08CCF9B96DD');
</script><meta name="description" content="（一）介绍 	   	   	组织开始使用云计算，有很多收益，例如节省成本，快速上线、按需扩展等。随着组织开始使用云计算，安全人员必须更新其运营以跟上云计算模式。本文的附件部分提供了有关NIST的云安全控制，以及云安全联盟，ENISA和NIST的云部署模型和云安全参考建议。   	&nbsp;在2016年最新版“云计算TOP威胁”中，该报告（CIS，2016）确定了云安全的12个关键问题。有效的安全监控减轻以下风险：   	 		 		">
<script type="text/javascript">(function(){mod_txt = '#'; adminBar = "" || 0})();</script>
<script type="text/javascript" src="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/frontopen.js?ver=1.5.04.15"></script>
<script type="text/javascript" src="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/include/lightbox-2.6.min.js"></script>
<link href="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/lightbox.css" rel="stylesheet" type="text/css" />

<link rel="stylesheet" type="text/css" media="all" href="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/style.css?ver=1.5.04.15" />
<link rel="stylesheet" type="text/css" media="all" href="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/mobile.css?ver=1.5.04.15" />
<style type="text/css">@media screen and (min-width:1366px){.c-con{height:140px;}}
a:hover , .header .logo i , .tit .h1 a , .tit .iititle2 span a:hover , .entry-content a , .entry-title , .mbx a:hover , .commentlist .comment-body a , .top_post .ulist a:hover , .gonggao a , .loc_link a , .tit .iititle a:hover{color:#000000}.nav .tig .rrs , #wp-calendar td a:hover , .jz_bt , .loading , .subbtn .btn , .post_pic_box:hover , .title_hot , .top_bar , .car-toggler , .but_down a , .page-link a span , .page-link .t_s_s , .page_num a , .nav-next a{background:#000000;}.j_zeng , .jz_bt:hover , .f_links li{border-color:#000000}.navcon ul li a:hover, .navcurrent{color:#4EA4EF;}</style>

<!--[if lt IE 9]><script src="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/html5.js"></script><![endif]-->
<link rel="stylesheet" href="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/css/font-awesome.min.css?ver=1.5.04.15">
<!--[if IE 7]>
<link rel="stylesheet" href="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/css/font-awesome-ie7.min.css?ver=1.5.04.15">
<![endif]-->
</head>

<body class="post-template-default single single-post postid-5288 single-format-standard">
<div class="loading"></div>
<div class="web_bod">
<header class="header marauto">
    <span class="logo">
        <a href="https://www.sec-un.org/" title="Sec-UN 安全圈" rel="home"><img src="https://www.sec-un.org/wp-content/uploads/2014/09/logo2x-300x74.png" alt="Sec-UN 安全圈" /></a>
        <i></i>
    </span>
    <form role="search" method="get" id="searchform" action="https://www.sec-un.org/">
      <span class="search">
        <input name="s" id="s" type="text"  class="input" value="" onclick="this.value = '';" style="color:#999" onkeypress="javascript:if(event.keyCode == 13){query(this.value);}" x-webkit-speech=""/>
        <button id="searchsubmit" class="btn">搜索</button>
      </span>
    </form>
    <div class="cls"></div>
</header>


<nav class="navcon marauto">
  <div id="mobile_nav_btn">网站导航</div>
  <div class="menu-header"><ul id="menu-%e5%af%bc%e8%88%aa" class="menu"><li id="menu-item-18" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-18"><a href="http://www.sec-un.org">首页</a></li>
<li id="menu-item-23" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-23"><a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e8%b5%84%e8%ae%af/">安全资讯</a></li>
<li id="menu-item-19" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-19"><a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e6%b2%bb%e7%90%86/">安全治理</a></li>
<li id="menu-item-20" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-20"><a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e6%96%b9%e6%a1%88/">安全方案</a></li>
<li id="menu-item-21" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-21"><a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e6%8a%80%e6%9c%af/">安全技术</a></li>
<li id="menu-item-22" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-22"><a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e4%ba%ba%e6%89%8d/">安全人才</a></li>
<li id="menu-item-27" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-27"><a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e4%bb%bb%e5%8a%a1/">安全任务</a></li>
<li id="menu-item-1027" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1027"><a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e5%a8%81%e8%83%81%e6%83%85%e6%8a%a5/">安全威胁情报</a></li>
<li id="menu-item-1764" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1764"><a href="https://www.sec-un.org/category/%e4%bf%a1%e6%81%af%e9%80%9f%e9%80%92/">信息速递</a></li>
<li id="menu-item-77" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-77"><a href="http://www.sec-un.org/wp-admin/post-new.php">我要投稿</a></li>
<li id="menu-item-75" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-75"><a href="https://www.sec-un.org/category/%e7%bd%91%e7%ab%99%e5%85%ac%e5%91%8a/">网站公告</a></li>
</ul></div>  
  </nav>   
  <section class="conter marauto"><script type="text/javascript">loading('33%',1000)</script>
  <div id="container">
      <div id="content" role="main" style="width:96%">
      <div class="mbx"><i class="icon-home icon-large" style="font-size:14px;"></i>
<a href="https://www.sec-un.org"  class="gray">首页</a>  >  <a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e8%b5%84%e8%ae%af/">安全资讯</a>  >  云安全监控：云安全系列（一）</div>

				<div id="post-5288" class="post-5288 post type-post status-publish format-standard hentry category-4">
                <div class="c-top2" id="post-55">
                <div class="datetime">2017<br />05-11</div>
					<header class="tit"><h1 class="entry-title">云安全监控：云安全系列（一）</h1>
					<aside class="entry-meta iititle2">
                        <span><i class="icon-user icon-large"></i> <a href="https://www.sec-un.org/author/legnl/" title="由legnl发布" rel="author">legnl</a></span><span><i class="icon-folder-open icon-large"></i> <a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e8%b5%84%e8%ae%af/" rel="category tag">安全资讯</a></span><span><i class="icon-eye-open icon-large"></i> 围观<i id="number">736</i><script type="text/javascript">jQuery(function($){$.get("https://www.sec-un.org/fo_ajax?ajax=getPostViews&postID=5288",function(data){if(data.length < 10)$('#number').text(data)});})</script>次</span><span><i class="icon-comment-alt icon-large"></i> <span><span class="screen-reader-text">云安全监控：云安全系列（一）</span>已关闭评论</span></span><span><i class="icon-pencil icon-large"></i> 编辑日期：<time>2017-05-11</time></span><span><i class="icon-zoom-in icon-large"></i> 字体：<a href="javascript:;" onclick="checkFontSize(18)">大</a> <a href="javascript:;" onclick="checkFontSize(16)">中</a> <a href="javascript:;" onclick="checkFontSize(14)">小</a></span>					</aside>
                    </header>
                    <div class="cls"></div>
		    </div>
                    <!-- .entry-meta -->

					<article class="entry-content">
                    
						<p class="rich_media_content ">
	
</p>
<div class="rich_media_content ">
<p style="color:#FFFFFF;font-size:18px">
		（一）介绍
	</p>
</div>
<p class="rich_media_content ">
	
</p>
<p class="rich_media_content " style="text-indent:2em">
	组织开始使用云计算，有很多收益，例如节省成本，快速上线、按需扩展等。随着组织开始使用云计算，安全人员必须更新其运营以跟上云计算模式。本文的附件部分提供了有关NIST的云安全控制，以及云安全联盟，ENISA和NIST的云部署模型和云安全参考建议。
</p>
<p class="rich_media_content " style="text-indent:2em">
	&nbsp;在2016年最新版“云计算TOP威胁”中，该报告（<em>CIS，2016</em>）确定了云安全的12个关键问题。有效的安全监控减轻以下风险：
</p>
<div class="rich_media_content ">
<ul class="list-paddingleft-2">
<li>
<p style="text-indent:0em">
				&nbsp;认证、证书和访问管理
			</p>
</li>
<li>
<p style="text-indent:0em">
				&nbsp; 不安全API
			</p>
</li>
<li>
<p style="text-indent:0em">
				&nbsp;帐号劫持
			</p>
</li>
<li>
<p style="text-indent:0em">
				恶意内部人员
			</p>
</li>
<li>
<p style="text-indent:0em">
				高级持续威胁（APT）
			</p>
</li>
<li>
<p style="text-indent:0em">
				&nbsp;数据丢失
			</p>
</li>
<li>
<p style="text-indent:0em">
				&nbsp; 使用和恶意使用云服务
			</p>
</li>
</ul>
</div>
<p style="text-indent:2em">
	保护云服务涉及进行详细的风险评估和架构安全解决方案以满足业务需求。安全监控在保护云服务方面起着至关重要的作用。本文重点介绍如何为Amazon Web Services（AWS）环境实施安全监控解决方案。
</p>
<p style="text-indent:2em">
	
</p>
<p style="text-indent:2em">
	<strong>1.1 云安全监控挑战</strong>
</p>
<p style="text-indent:2em">
	&nbsp;云计算解决方案的主要类型是基础架构即服务（IaaS），平台即服务（PaaS）和软件即服务（SaaS）。AWS把自己定位为领先的云服务提供商，微软Azure和Google Cloud分别位居第二和第三位。
</p>
<p style="text-indent:2em">
	&nbsp;AWS每天都能以快速的速度创新，每天都会引入许多新功能和/或服务，平均每天AWS客户可以获得三项新功能。 “参考”部分提供了可用的不同AWS服务和用于保护AWS环境的最佳实践。一些最佳做法包括加密、特权访问管理、资源隔离和监控。
</p>
<p style="text-indent:2em">
	&nbsp;本文着重于实施AWS workload的安全监控。以下部门将强调除了传统的数据中心监控之外AWS的安全监控的关键领域。
</p>
<p style="text-indent:2em">
	<strong><br />
</strong>
</p>
<p style="text-indent:2em">
	<strong>AWS管理控制台监测</strong>
</p>
<p style="text-indent:2em">
	AWS实例和资源的管理由AWS管理控制台执行。使用AWS管理控制台可以进行的主要活动是创建新的虚拟机、并删除任何现有的虚拟机和其他AWS服务。监控对AWS管理控制台的未经授权的访问至关重要，因为获得云端管理平台的访问就像拥有云计算王国的钥匙一样。
</p>
<p style="text-indent:2em">
	<strong>&nbsp;</strong>
</p>
<p style="text-indent:2em">
	<strong>应用程序编程接口（API）访问监测</strong>
</p>
<p style="text-indent:2em">
	&nbsp;随着组织向云解决方案迈进，他们必须适应新的DevOps架构。如果将当前的应用程序转到云上，团队将很难意识到实现云平台的好处。现有应用程序结构必须重新架构适应云部署模型。理想情况下，云解决方案使用DevOps方法进行连续部署。这种方法使企业能够缩短开发时间，并转而采取快速解决方案。例如，一些AWS环境使用AWS<br />
 CodePipeline，在AWS环境中使用DevOps策略进行连续应用程序部署。
</p>
<p style="text-indent:2em">
	DevOps为安全监控带来了新的挑战。由于与AWS<br />
CodePipeline相关的自动化，基础设施作为代码和无服务器计算，API调用的数量正在增加。监控这些API调用是很重要的，确保没有未经授权的访问。由于活动量大，很难使用传统的规则和基于阈值的监控来跟踪这些事件。机器学习技术非常适合通过从数据中学习不同的特征/特征来监测这一巨大的活动。
</p>
<p style="text-indent:2em">
	<strong><br />
</strong>
</p>
<p style="text-indent:2em">
	<strong>AWS无服务器计算监测</strong>
</p>
<p style="text-indent:2em">
	&nbsp;最近AWS引入了“无服务器”计算;无服务器计算依赖于AWS Lambda来运行应用程序代码。在无服务器计算中，没有服务器基础设施;重点是监控与AWS Lambda功能相关的AWS Lambda功能执行、调用和其他参数。
</p>
<p style="text-indent:2em">
	<strong><br />
</strong>
</p>
<p style="text-indent:2em">
	<strong>AWS身份和访问管理（IAM）监测</strong>
</p>
<p style="text-indent:2em">
	&nbsp;AWS<br />
 IAM使组织能够控制对AWS服务和特定资源的访问。 AWS<br />
IAM提供了在AWS环境中配置精细权限的选项。建议给予最少的权限来管理执行作业功能所需的AWS资源。作为有效的信息安全控制，安全团队应该使用AWS提供的许多工具，如Access<br />
Advisor。提供适当的访问可防止任何未经授权的访问，并有效监控AWS资源管理访问。监视AWS环境中使用的不同管理credentials是各种合规规定的要求。机器学习是监测各种AWScredentials的理想选择，因为它从以前的事件中学习，并且了解识别异常的正常现象。像Sarbanes-Oxley法案这样的财务监管要求，要求组织审查所有特权访问和对托管财务数据的AWS环境的变化，作为安全合规性监控的一部分。
</p>
<p style="text-indent:2em">
	
</p>
<p style="text-indent:2em">
	<strong>&nbsp;1.2 提出的解决方案的总体架构</strong>
</p>
<p style="text-indent:2em">
	&nbsp;<br />
 提出的云安全监控解决方案是使用大型数据分析解决方案，如Splunk，Apache Spark或Amazon<br />
Elasticsearch来加载所有AWS云基础设施日志。应用机器学习模型来对风险进行评分，以确定可疑的事件。然后，根据事件，安全小组应采用自动化（lambda函数）邮件来告警，由安全小组进行手动分析。
</p>
<p style="text-indent:2em">
	由于AWS环境中的变化，手动基准和配置AWS基础设施安全监控规则是一项挑战。机器学习技术如本文后面介绍的有监督学习算法可以通过从数据自动学习理解异常和高风险事件，以应对云安全监控的安全监控挑战。机器学习模型可用于构建基线，进行风险评分，以识别可疑事件，使用身份认证信息、位置信息和活动类型来识别。
</p>
<p style="text-indent:2em">
	在本文中，Splunk将用于获取用于实施AWS安全监控用例的所有AWS<br />
 CloudTrail和CloudWatch日志。应用机器学习模型来识别AWS云基础架构中的可疑活动。最新版本的Splunk<br />
6.5具有内置的机器学习工具包，支持各种机器学习算法。将使用Splunk Machine<br />
Learning工具包应用机器学习模型。使用机器学习算法的步骤如下：
</p>
<p style="text-indent:2em">
	&nbsp;a）可视化，将数据清理与智能特征工程组合，
</p>
<p style="text-indent:2em">
	b）选择正确的度量/方法来估计模型性能
</p>
<p style="text-indent:2em">
	&nbsp;c）调整参数。
</p>
<p style="text-indent:2em">
	
</p>
<p style="text-indent:2em">
	提出的关键概念总结如下：
</p>
<p style="text-indent:2em">
	&nbsp;1）将所有AWS日志数据从Cloudtrail和CloudWatch收集到Splunk
</p>
<p style="text-indent:2em">
	2）应用机器学习模型构建基线，进行风险评分，而不是手动规则/阈值。
</p>
<p style="text-indent:2em">
	
</p>
<p style="text-indent:2em">
	&nbsp;使这一实现可行的一些因素是：
</p>
<p style="text-indent:2em">
	a）推进大数据技术，使信息安全团队能够大规模存储所有类型的数据。
</p>
<p style="text-indent:2em">
	b）许多机器学习解决方案正在变得可用，如Microsoft Azure ML Studio，Amazon Machine Learning，Databricks Spark，Splunk Machine Learning工具包。
</p>
<p style="text-indent:2em">
	通过拥有集中的开源大数据分析解决方案，安全团队可以将机器学习和其他统计技术应用于任何数据集。该解决方案的主要优点是，一旦使用机器学习识别出成功的方法，就可以使用相同的方法来解决类似的挑战。例如，如果一种技术有助于识别来自基于AWS云的基础架构身份和访问认证数据的可疑访问尝试，则可以应用相同的方法来识别其他应用程序和云基础架构（如Microsoft<br />
 Azure和Google Cloud）的可疑访问尝试。下一节将介绍机器学习技术，并使用Splunk实现两种用例。
</p>
<p style="text-indent:2em">
	
</p>
<p style="text-indent:2em">
	<strong>&nbsp;1.3 风险评分方法</strong>
</p>
<p style="text-indent:2em">
	风险评分不是新概念;信息安全界一直在使用风险评分，来确定最重要的漏洞和解决问题问题。在传统的数据中心监控中，风险评分方法依赖于了解企业环境来识别可疑事件。这种类型的示例，是基于对具有访问权限的授权管理员的理解，产生关键的服务器资产的未经授权的访问告警。基于已知的不良模式，检测恶意事件并对已知的不良模式进行将风险分数，对于信息安全社区已经看到和已知的威胁是有用的。<br />
 “参考”部分提供了一些使用AWS环境中的静态规则和阈值手动进行风险评分。
</p>
<p style="text-indent:2em">
	这些的基于标准风险评分的监控的挑战在于跟上AWS推出的新API调用和权限的快速步伐。与云安全监控相关的一些标准是身份、数据访问、执行的操作和地理位置。通过利用这些标准（特征）结合历史数据，机器学习技术可以学习环境，识别异常。机器学习模型可以根据先前数据的学习提供风险分数。在本文中，以线性回归算法为例来开发预测风险分数的机器学习模型。线性回归算法将预测数值。线性回归算法使用线性函数建模，连续输出变量与特征（输入，解释变量）之间的关系。以下有关机器学习的部分详细介绍了算法。该模型从数据中学习;对于AWS用例，如果与手动更新风险分数的规则/阈值相比，更有效的。
</p>
<p>
	
</p>
<p style="text-indent:2em">
	<strong>1.4机器学习</strong>
</p>
<p style="text-indent:2em">
	机器学习有两大类：监督和无监督学习。在监督学习中，机器学习算法将从提供的数据和标签（分类）中学习。所得到的模型将尝试预测标签（分类）（Astroml，2015）。通常使用的一些分类算法是Neural<br />
 Networks, Random Forests, Support Vector Machines (SVM), Decision<br />
Trees, Logistic<br />
Regression, and Naive Bayes。监督学习的一个例子是，提供一套狗和猫图片给机器学习算法，标签指示图片是猫还是狗。监督学习算法将从狗和猫图片中学习，并创建一个预测模型。将新图片应用于预测模型，将预测所提供的图片是狗还是猫，如图1所示：
</p>
<p>
	<img title="云安全监控：云安全系列（一） - 第1张  | Sec-UN 安全圈" alt="云安全监控：云安全系列（一） - 第1张  | Sec-UN 安全圈" class=" " style="width:auto !important;height:auto !important" src="http://mmbiz.qpic.cn/mmbiz_png/6pKFVUHHI4MzUgic8q0nWF2BlGMnETRpQhUFuL4xQYnRnXPESG9Hs8URJtIOWNNDZrlelqHe6tehnK1Eb9vgbSA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1" />
</p>
<p style="text-indent:2em">
	&nbsp;在本文中，使用线性回归算法的监督学习技术将用于预测AWS云基础架构事件的风险评分。
</p>
<p style="text-indent:2em">
	在无监督学习中，该模型尝试使用没有标签的功能来了解数据集，识别数据的模式和异常。无监督学习包括降维，聚类和密度估计（AstroML，2015）等任务。无监督学习的一个例子是，为机器学习算法提供一些狗和猫图片;它会将猫和狗图片分组，如图2所示：
</p>
<p>
	<img title="云安全监控：云安全系列（一） - 第2张  | Sec-UN 安全圈" alt="云安全监控：云安全系列（一） - 第2张  | Sec-UN 安全圈" class=" " style="width:auto !important;height:auto !important" src="http://mmbiz.qpic.cn/mmbiz_png/6pKFVUHHI4MzUgic8q0nWF2BlGMnETRpQP54SWz1vhK0DiaGcrK2PctoXQEzVCZN30P9ESp0n0feaLzjAj2Grmiag/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1" />
</p>
<p style="text-indent:2em">
	无监督学习算法将有助于识别数据集中的主要特征。根据各种功能提供不同的有利点也是非常有帮助的。在狗和猫图片的示例中，使用无监督学习技术将有助于了解如何通过基于这些面部特征的数据分类来最有用地分类几个面部特征。在我们的AWS云基础架构事件的用例中，根据其登录位置将数据分类，可以提供对其是否是重要功能的帮助。一些常见的无监督算法是K-Means<br />
 Clustering, Hierarchical clustering, and Hidden Markov模型。图3突出显示了Splunk<br />
Machine中的不同算法。
</p>
<p>
	<img title="云安全监控：云安全系列（一） - 第3张  | Sec-UN 安全圈" alt="云安全监控：云安全系列（一） - 第3张  | Sec-UN 安全圈" class=" " style="width:auto !important;height:auto !important" src="http://mmbiz.qpic.cn/mmbiz_png/6pKFVUHHI4MzUgic8q0nWF2BlGMnETRpQBVu9ZYKbtsXXY3aicZsqTsVeB1y2UOXybWAgReVax2e0oQn0EgjHdhQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1" />
</p>
<p>
	
</p>
<p style="text-indent:2em">
	机器学习应被应用于适用的案例并产生结果。机器学习需要大量数据，摄取大量数据的机器学习模型将产生明确的结果。由于机器学习算法需要大量数据来提供有用的模型，因此需要很大的耐心才能获得结果。在AWS环境中生成大量日志，使用适当的算法创建模型，并且大量和多种数据将确保没有overfitting问题。另外，还需要注意，每一个AWS环境都是不同的。作为一个例子，大多数环境使用不同的AWS<br />
 Virtual Private<br />
Cloud(VPC)配置，根据特定的业务需求，来区分AWS资源。使用来自相同AWS环境的数据创建机器学习模型将产生最好的结果。
</p>
<p style="text-indent:2em">
	最近的技术发展（如Splunk和Apache Spark）使得可以在不同的数据种类上快速部署机器学习算法，并使用许多不同数据集的功能。
</p>
<p>
	
</p>
<p style="color:#FFFFFF;font-size:18px">
	（二）Lab Setup
</p>
<p>
	
</p>
<p>
	
</p>
<p style="text-indent:2em">
	附录B解释了初始实验室配置的步骤。 在实验室配置中，Splunk配置为从AWS Cloudtrail接收日志。已安装和设置Splunk机器学习工具包。
</p>
<p style="text-indent:2em">
	为进一步测试，通过添加用户，添加实例，从AWS QuickStart启动新环境生成额外的日志。 随着日志de 收集，机器学习的应用，计算风险分数并检测可疑事件。
</p>
<p>
	<img title="云安全监控：云安全系列（一） - 第4张  | Sec-UN 安全圈" alt="云安全监控：云安全系列（一） - 第4张  | Sec-UN 安全圈" class=" " style="width:auto !important;height:auto !important" src="http://mmbiz.qpic.cn/mmbiz_png/6pKFVUHHI4MzUgic8q0nWF2BlGMnETRpQ88BrpfqBIGm7C5o2WuW94NjOnk44iaqFwMd0ZK0AdjCZAHrkZLRIM6A/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1" />
</p>
<p>
	
</p>
<p>
	
</p>
<p style="color:#FFFFFF;font-size:18px">
	（三）机器学习 -过程
</p>
<p>
	
</p>
<p style="text-indent:2em">
	以下步骤强调了使用Splunk<br />
 Machine Learning<br />
Toolkit应用机器学习技术的方法。机器学习解决方案使用相同的过程，也可以应用于安全监测用例。该解决方案也可以使用Apache Spark<br />
MLLib库来实现。 Apache Spark中的AWS Cloudtrail JSON数据文件的一个挑战是解析和规范化。 AWS已经将AWS<br />
CloudTrail日志转换为Spark Data Frame（Github，2016）的代码开源了。将数据加载到Apache<br />
Spark数据包后，Apache Spark MLLib库可以了。
</p>
<p style="text-indent:2em">
	在机器学习过程中要记住的一个方面是数据清理。数据清理确保数据一致和统一。在许多情况下，应将数据提取并格式化，然后再送入机器学习算法。<br />
Splunk本身通过在摄取时间索引数据来解决数据清理，并提取相关字段，并提供从JSON格式到标准列的映射。机器学习算法可以直接从使用列的数据。与许多开源解决方案（如Apache<br />
 Spark）相比，Splunk在数据清理和格式化方面节省了大量时间。下面的图5突出显示了机器学习过程中涉及的步骤：
</p>
<p>
	<img title="云安全监控：云安全系列（一） - 第5张  | Sec-UN 安全圈" alt="云安全监控：云安全系列（一） - 第5张  | Sec-UN 安全圈" class=" " style="width:auto !important;height:auto !important" src="http://mmbiz.qpic.cn/mmbiz_png/6pKFVUHHI4MzUgic8q0nWF2BlGMnETRpQHsgQEtj5C20tDOicuRs8eeM6x5Xz9RZqgGXjJicmDZqJibZvABPq3U1sw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1" />
</p>
<p style="text-indent:2em">
	&nbsp;
</p>
<p style="text-indent:2em">
	<strong>3.1 将数据采集到Splunk并了解数据</strong>
</p>
<p style="text-indent:2em">
	安全小组必须将所有的AWS日志收集到一个中心位置。即使组织无法实施任何主动监控，日志将在事件发生后的后续时间内进行取证分析。
</p>
<p style="text-indent:2em">
	在初始设置中，Splunk被配置为从Cloudtrail和Cloudwatch日志中获取数据。 Splunk AWS应用程序可用于探索和了解日志事件，确认机器学习的功能。
</p>
<p style="text-indent:2em">
	
</p>
<p style="text-indent:2em">
	<strong>3.1.1&nbsp; AWS CloudTrail</strong>
</p>
<p style="text-indent:2em">
	AWS<br />
 Cloudtrail创建所有API访问请求的日志、AWS资源访问和AWS控制台登录访问信息。了解AWS<br />
Cloudtrail日志数据以有效地设计机器学习算法很重要。 AWS<br />
Cloudtrail用户指南（AWS，2014）提供了不同类型日志事件的参考和示例。 Cloudtrail<br />
API调用日志包含两部分：Record Body Contents和 userIdentity Element.。
</p>
<p style="text-indent:2em">
	分析的事件类型有：
</p>
<p>
	<img title="云安全监控：云安全系列（一） - 第6张  | Sec-UN 安全圈" alt="云安全监控：云安全系列（一） - 第6张  | Sec-UN 安全圈" class=" " style="width:auto !important;height:auto !important" src="http://mmbiz.qpic.cn/mmbiz_png/6pKFVUHHI4MzUgic8q0nWF2BlGMnETRpQIA0ZicuXg2v6PAUiaAC5yQHia2epuvTouL0ltlZHW5YsSibsZUAl5jGoxQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1" />
</p>
<p style="text-indent:2em">
	
</p>
<p style="text-indent:2em">
	<strong>&nbsp;3.2浏览数据</strong>
</p>
<p style="text-indent:2em">
	在这种特殊情况下，用于AWS的Splunk<br />
 App可用于研究AWS日志数据。The Splunk App for AWS为Amazon Web<br />
Services帐户提供了关键的操作和安全洞察。下图6显示了适用于The Splunk App for<br />
AWS可用的不同仪表板选项。这些仪表盘有助于理解相关AWS日志，确定任何可疑活动。
</p>
<p>
	<img title="云安全监控：云安全系列（一） - 第7张  | Sec-UN 安全圈" alt="云安全监控：云安全系列（一） - 第7张  | Sec-UN 安全圈" class=" " style="width:auto !important;height:auto !important" src="http://mmbiz.qpic.cn/mmbiz_png/6pKFVUHHI4MzUgic8q0nWF2BlGMnETRpQr7twhTRnfc8WdaYiaicDLgTTcUJu0LMkRPUyx0QH5zkBuvujLcEBZE3A/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1" />
</p>
<p style="text-indent:2em">
	
</p>
<p style="text-indent:2em">
	图7中的仪表板显示了AWS环境中的各种用户的行为。使用不同的字段（特征）查看数据，将有助于安全小组了解日志数据中的相关字段。
</p>
<p style="text-indent:2em">
	The Splunk App for AWS允许安全从业人员了解和探索数据，以确定有助于识别可疑AWS活动的字段。 Splunk Machine Learning Toolkit在开发模型时将可以使用这些字段。
</p>
<p style="text-indent:2em">
	
</p>
<p style="text-indent:2em">
	<strong>&nbsp;3.3 用例1 &#8211; 检测可疑AWS控制台登录</strong>
</p>
<p style="text-indent:2em">
	<strong>3.3.1定义特征</strong>
</p>
<p style="text-indent:2em">
	在本案例研究中，探索了“AwsConsoleSignIn”事件，目的是了解哪些领域将有助于确定任何可疑的AWS控制台登录。确定的一些相关领域是：<br />
&nbsp;sourceIPAddress<br />
&nbsp;userAgent<br />
&nbsp;userIdentity.arn<br />
&nbsp;eventTime<br />
&nbsp;responseElements.ConsoleLogin
</p>
<p style="text-indent:2em">
	&nbsp;在上述示例中，从安全角度理解和探索各种日志，可以识别特征。 Splunk机器学习工具包有例如PCA等算法，可以用数学方法来探索和定义特征。从不同有利位置的理解数据将有助于确定异常活动。
</p>
<p style="text-indent:2em">
	
</p>
<p style="text-indent:2em">
	<strong>&nbsp;3.3.2 选择并应用学习算法</strong>
</p>
<p style="text-indent:2em">
	本节重点介绍了创建、评分和测试模型所需的Splunk Machine Learning Toolkit命令。
</p>
<p style="text-indent:2em">
	AwsConsoleSignIn.csv是使用实验室环境中的AWS日志生成的。可用 Splunk命令将事件导出为CSV格式：
</p>
<p style="text-indent:2em">
	*<br />
 sourcetype=&#8221;aws:cloudtrail&#8221; eventType=AwsConsoleSignIn | table<br />
sourceIPAddress, userAgent, userIdentity.arn, eventTime,<br />
responseElements.ConsoleLogin。
</p>
<p style="text-indent:2em">
	安全人员应该为这些事件添加风险分数。风险分数应根据安全领域的知识和环境进行分配。理想情况下，安全人员应根据环境事件的评分进行评估和分配风险分数，一个月一次或其他时间。机器学习模型需要大量标签的风险评分数据才能获得有用的结果。
</p>
<p style="text-indent:2em">
	AwsConsoleSignIn.csv一个示例如图8中所示：
</p>
<p>
	<img title="云安全监控：云安全系列（一） - 第8张  | Sec-UN 安全圈" alt="云安全监控：云安全系列（一） - 第8张  | Sec-UN 安全圈" class=" img_loading" style="width:670px !important;height:95.71px !important" src="image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" />
</p>
<p style="text-indent:2em">
	<strong>&nbsp;<br />
</strong>
</p>
<p style="text-indent:2em">
	<strong>创建新模型 &#8211; AwsConsoleSignIn</strong>
</p>
<p style="text-indent:2em">
	该机器学习模型的目标是预测风险评分，识别的可疑事件。此监督学习模型的输入是具有指定风险分数和算法LinearRegression。输出将是一个模型，用于从数据学习出来的，地预测风险分数的模型。
</p>
<p style="text-indent:2em">
	在图9的机器学习工具包应用配置中，选择Assistants -&gt; Predict Numeric fie，并在“Enter a search”中提供输入文件AwsConsoleSignIn.csv：
</p>
<p style="text-indent:2em">
	inputlookup AwsConsoleSignIn.csv
</p>
<p>
	<img title="云安全监控：云安全系列（一） - 第9张  | Sec-UN 安全圈" alt="云安全监控：云安全系列（一） - 第9张  | Sec-UN 安全圈" class=" img_loading" style="width:670px !important;height:288.24px !important" src="image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" />
</p>
<p style="text-indent:2em">
	AwsConsoleSignIn.csv作为输入文件。该搜索将加载AwsConsoleSignIn.csv文件中的所有记录进行分析。选择以下选项来创建模型：
</p>
<p style="text-indent:2em">
	算法：线性回归.
</p>
<p style="text-indent:2em">
	要预测的字段: riskScore
</p>
<p style="text-indent:2em">
	
</p>
<p style="text-indent:2em">
	用于预测的字段: &#8220;sourceIPAddress&#8221;, &#8220;userAgent&#8221;, &#8220;userIdentity.arn&#8221; ,
</p>
<p style="text-indent:2em">
	&#8220;eventTime&#8221;, &#8220;responseElements.ConsoleLogin&#8221;
</p>
<p style="text-indent:2em">
	
</p>
<p style="text-indent:2em">
	The resultant set of Splunk commands are below:
</p>
<p style="text-indent:2em">
	| inputlookup AwsConsoleSignIn.csv
</p>
<p style="text-indent:2em">
	|<br />
 fit LinearRegression fit_intercept=true &#8220;risk_score&#8221; from<br />
&#8220;sourceIPAddress&#8221;,&#8221;userAgent&#8221;, &#8220;userIdentity.arn&#8221; , &#8220;eventTime&#8221;,<br />
&#8220;responseElements.ConsoleLogin&#8221; into &#8220;aws_console&#8221;
</p>
<p style="text-indent:2em">
	
</p>
<p style="text-indent:2em">
	在此特定示例中使用的是监督学习，向机器学习算法LinearRegression提供AWS日志数据和实际风险分数。输出的模型aws_console将预测给定一组功能“sourceIPAddress”，“userAgent”，“userIdentity：arn”，“eventTime”，“responseElements：ConsoleLogin”）的风险分数。
</p>
<p style="text-indent:2em">
	
</p>
<p style="text-indent:2em">
	<strong>评估结果并更新模型</strong>
</p>
<p style="text-indent:2em">
	&nbsp;在图10中的配置中，数据分为70％用于训练，30％用于测试和评估模型。分配30％的数据用于测试和评估模型有助于了解模型的准确性。
</p>
<p>
	<img title="云安全监控：云安全系列（一） - 第10张  | Sec-UN 安全圈" alt="云安全监控：云安全系列（一） - 第10张  | Sec-UN 安全圈" class=" " style="width:auto !important;height:auto !important" src="http://mmbiz.qpic.cn/mmbiz_png/6pKFVUHHI4MzUgic8q0nWF2BlGMnETRpQpOW5RFk1qBliazzNUHmfFW4lBqjjlkG9fl7wk0amxickrWpMicvia1eQmQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1" />
</p>
<p style="text-indent:2em">
	在匹配模型之后，Splunk Machine Learning Toolkit执行必要计算，测量模型性能。
</p>
<p style="text-indent:2em">
	如图11所示，在线图上绘制实际值与预测值，有助于安全小组了解模型的效率。
</p>
<p>
	<img title="云安全监控：云安全系列（一） - 第11张  | Sec-UN 安全圈" alt="云安全监控：云安全系列（一） - 第11张  | Sec-UN 安全圈" class=" " style="width:auto !important;height:auto !important" src="http://mmbiz.qpic.cn/mmbiz_png/6pKFVUHHI4MzUgic8q0nWF2BlGMnETRpQwHovia2WcFbnmp31duKPfT6RB3k1jISiaT5HvibHRb5fjJhH6pVfq6HVg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1" />
</p>
<p style="text-indent:2em">
	&nbsp;图11 Splunk机器学习工具包 &#8211; 实际与预测图
</p>
<p style="text-indent:2em">
	这些命令将将模型应用于AwsConsoleSignIn.csv中的数据集，并绘制实际值和预测值，以了解模型的准确性。
</p>
<p>
	<img title="云安全监控：云安全系列（一） - 第12张  | Sec-UN 安全圈" alt="云安全监控：云安全系列（一） - 第12张  | Sec-UN 安全圈" class=" " style="width:auto !important;height:auto !important" src="http://mmbiz.qpic.cn/mmbiz_png/6pKFVUHHI4MzUgic8q0nWF2BlGMnETRpQvCtq6A7H5aSMzgnnVQcyPDXOsbqgwe8icnWHfMNlBFNEOoicPibKhhBAA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1" />
</p>
<p style="text-indent:2em">
	这些命令将将模型应用于AwsConsoleSignIn.csv中的数据集，以计算 R² and root mean squared error (RMSE).。
</p>
<p style="text-indent:2em">
	这些值有助于测量模型的准确性。
</p>
<p>
	<img title="云安全监控：云安全系列（一） - 第13张  | Sec-UN 安全圈" alt="云安全监控：云安全系列（一） - 第13张  | Sec-UN 安全圈" class=" " style="width:auto !important;height:auto !important" src="http://mmbiz.qpic.cn/mmbiz_png/6pKFVUHHI4MzUgic8q0nWF2BlGMnETRpQAFbybQSn64ibuZ5E1P3bVNJ0UsW7B8sIZAtlEvWiajDxu0Sc7CHxroqg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1" />
</p>
<p style="text-indent:2em">
	均方根误差”和“R ^ 2”值提供了误差幅度的概念。 R ^ 2表示一组对实际值的预测的有效性的指示。值在0和1之间。接近0的值表示模型不是很好的拟合，如图12所示
</p>
<p>
	<img title="云安全监控：云安全系列（一） - 第14张  | Sec-UN 安全圈" alt="云安全监控：云安全系列（一） - 第14张  | Sec-UN 安全圈" class=" " style="width:auto !important;height:auto !important" src="http://mmbiz.qpic.cn/mmbiz_png/6pKFVUHHI4MzUgic8q0nWF2BlGMnETRpQ95RRZJhVTTcdTbLZUQJicL52Ha7c3EBs1PHCdbntLJ3XlJwDvcgx4AA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1" />
</p>
<p style="text-indent:2em">
	在分析性能后，如果性能不令人满意，可以提取其他特征。 例如，包括地理数据库从Maxmind的Geolocation数据，为IP地址设置地理位置新的上下文将有助于提高模型的有效性。
</p>
<p style="text-indent:2em">
	一旦性能令人满意，安全团队应该使用apply &lt;model&gt;命令部署模型。 在实施模型之后，安全分析师应根据反馈，不断调整模型。
</p>
<p style="text-indent:2em">
	
</p>
<p>
	
</p>
<p style="text-indent:2em">
	<strong>3.4 用例2 &#8211; 检测可疑API调用</strong>
</p>
<p style="text-indent:2em">
	<strong>&nbsp;3.4.1定义特征</strong>
</p>
<p style="text-indent:2em">
	使用AWS Cloud安全性方面的专业知识探索了“AwsApiCall”事件，目的是了解哪些字段将有助于确定是可疑的AWS API调用。确定的一些相关领域是：
</p>
<p>
	<img title="云安全监控：云安全系列（一） - 第15张  | Sec-UN 安全圈" alt="云安全监控：云安全系列（一） - 第15张  | Sec-UN 安全圈" class=" " style="width:auto !important;height:auto !important" src="http://mmbiz.qpic.cn/mmbiz_png/6pKFVUHHI4MzUgic8q0nWF2BlGMnETRpQkec9R4NQ8wiauugCb3ib0xKCY2TauIdsvibsvokPiblN0ZfVGTn8F5nh4Q/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1" />
</p>
<p style="text-indent:2em">
	<strong>3.4.2选择并应用学习算法</strong>
</p>
<p style="text-indent:2em">
	&nbsp;使用实验室环境中的AWS日志生成AwsAPICall.csv。 Splunk命令可用于将事件导出为CSV：
</p>
<p style="text-indent:2em">
	*<br />
 sourcetype=&#8221;aws:cloudtrail&#8221; eventType=AwsAPICall | table<br />
sourceIPAddress,eventSource , eventName , userIdentity.arn, eventTime,<br />
userAgent, userIdentity.type
</p>
<p style="text-indent:2em">
	安全人员应该为这些事件添加风险分数。风险分数应根据安全领域的知识和环境进行分配。 AwsAPICall.csv的示例记录如下图13所示。
</p>
<p>
	<img title="云安全监控：云安全系列（一） - 第16张  | Sec-UN 安全圈" alt="云安全监控：云安全系列（一） - 第16张  | Sec-UN 安全圈" class=" " style="width:auto !important;height:auto !important" src="http://mmbiz.qpic.cn/mmbiz_png/6pKFVUHHI4MzUgic8q0nWF2BlGMnETRpQDoX0eU2anVmJvokg0zMCVicltFcyG3qO2QugibiaPDwTmMGYcwnxmibuTw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1" />
</p>
<p style="text-indent:2em">
	该机器学习模型的目标是预测风险评分，以识别高可疑API调用集。在机器学习工具包应用程序中，Assistants -&gt; Predict<br />
Numeric fields, 并在搜索框中使用以下命令提供输入文件AwsConsoleSignIn.csv：
</p>
<p style="text-indent:2em">
	inputlookup AwsAPICall.csv
</p>
<p style="text-indent:2em">
	AwsAPICall.csv作为输入文件。该搜索将加载AwsAPICall.csv文件中的所有记录进行分析。选择以下选项来创建模型：
</p>
<p style="text-indent:2em">
	算法：线性回归。
</p>
<p style="text-indent:2em">
	预测的字段：riskScore
</p>
<p style="text-indent:2em">
	在图14的配置中，用于预测的字段有：“sourceIPAddress”，“eventSource”，“eventName”，“userIdentity.arn”，“eventTime”，“userAgent”，“userIdentity”。
</p>
<p>
	<img title="云安全监控：云安全系列（一） - 第17张  | Sec-UN 安全圈" alt="云安全监控：云安全系列（一） - 第17张  | Sec-UN 安全圈" class=" " style="width:auto !important;height:auto !important" src="http://mmbiz.qpic.cn/mmbiz_png/6pKFVUHHI4MzUgic8q0nWF2BlGMnETRpQ5p0VX1u1K8ib3YhicvQ1fA9yuaM9HU9epH7OgGcaM7nwOZ6b2pD9XOSQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1" />
</p>
<p style="text-indent:2em">
	| inputlookup AwsAPICall.csv
</p>
<p style="text-indent:2em">
	|<br />
 fit LinearRegression fit_intercept=true &#8220;riskScore&#8221; from<br />
&#8220;sourceIPAddress&#8221;, &#8220;eventSource&#8221; ,&#8221;eventName&#8221; , &#8220;userIdentity.arn&#8221;,<br />
&#8220;eventTime&#8221;, &#8220;userAgent&#8221;, &#8220;userIdentity.type&#8221; into &#8220;aws_apicall&#8221;
</p>
<p style="text-indent:2em">
	在我们的例子中使用了监督学习，为机器学习算法LinearRegression提供了AWS日志数据和实际风险分数。输出的模型aws_console将尝试预测风险分数，给定的功能集“sourceIPAddress”，“eventSource”，“eventName”，“userIdentity.arn”，“eventTime”，“userAgent”，“userIdentity.type”
</p>
<p>
	
</p>
<p style="text-indent:2em">
	<strong>评估结果并更新模型</strong>
</p>
<p style="text-indent:2em">
	数据分为70％用于训练模型，30％用于测试和评估模型。这有助于了解模型的准确性。
</p>
<p style="text-indent:2em">
	在安装模型之后，Splunk Machine Learning Toolkit执行用于必要计算，测量模型性能。在线图上绘制实际值与预测值，如下图15所示，有助于了解模型的效率。
</p>
<p>
	<img title="云安全监控：云安全系列（一） - 第18张  | Sec-UN 安全圈" alt="云安全监控：云安全系列（一） - 第18张  | Sec-UN 安全圈" class=" " style="width:auto !important;height:auto !important" src="http://mmbiz.qpic.cn/mmbiz_png/6pKFVUHHI4MzUgic8q0nWF2BlGMnETRpQWIPdCxAN4JC4SaBprHAhZic3HtqK1ib9aYEsvuSsfGnF0cCmb8V2KNRQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1" />
</p>
<p style="text-indent:2em">
	均方根误差和R ^ 2值提供了误差大小的概念。R ^ 2表示预测对实际值的有效性。 值在0和1之间。接近1的值表示模型是一个很好的拟合。
</p>
<p>
	<img title="云安全监控：云安全系列（一） - 第19张  | Sec-UN 安全圈" alt="云安全监控：云安全系列（一） - 第19张  | Sec-UN 安全圈" class=" " style="width:auto !important;height:auto !important" src="http://mmbiz.qpic.cn/mmbiz_png/6pKFVUHHI4MzUgic8q0nWF2BlGMnETRpQARqexNZuA0cU7u53pKv1GDgld9ygHwmUkDL86p6pvmg8ic3SNHnc5cg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1" />
</p>
<p style="text-indent:2em">
	分析后，如果性能不令人满意，可以提取其他特征。例如，包括涉及事件的VPC信息将有助于提高模型的有效性。
</p>
<p style="text-indent:2em">
	性能满意后，使用apply &lt;model&gt;命令部署模型。在实施模型之后，安全分析师应根据反馈，不断调整模型。
</p>
<p style="text-indent:2em">
	本节重点介绍如何使用Splunk<br />
 Machine<br />
Learning工具箱来创建、评估和部署机器学习模型。生成的两个模型是在实验室中创建的数据记录很少的示例，用于对Splunk机器学习工具包功能进行原型化。安全小组应根据AWS环境测试，调整和部署机器学习模型。
</p>
<p style="text-indent:2em">
	本文只讨论了两个用例。可能有用的另一个实际用例是确定AWS VPC之间的异常网络流量会话。威胁建模，使用攻击者工具，技术和过程（TTP）的输入，进行可用于识别其他安全监控用例。在确定用例后，本文讨论的方法可用于评估特征，并将机器学习模型应用于新的用例。
</p>
<p style="text-indent:2em">
	机器学习的数据需求非常大，摄取大量数据创建机器学习模型将产生有用的结果。此外，如果使用多个数据源来提取特征，则可以实现更高的保真度。例如，为IP地址的附加Geolocation数据将有助于提高模型的有效性。
</p>
<p>
	
</p>
<p style="color:#FFFFFF;font-size:18px">
	（四）结论
</p>
<p>
	
</p>
<p>
	
</p>
<p style="text-indent:2em">
	本文重点介绍如何实现AWS日志的机器学习技术。本文应用机器学习技术来识别IaaS环境中的可疑事件。身份是新的边界，使用机器学习技术将身份数据与其他数据相结合，将有助于安全专业人员识别可疑事件。作为第一步，安全小组成员应了解监控需求、了解数据、评估合适的方法。安全小组应考虑机器学习是否适合于日志的性质、探索、可视化和选择特征，作为创建模型的输入。建立和测试模型后，安全小组应将该模型应用于实时流量（数据）。使用该模型后，安全小组应定期评估结果并调整模型。
</p>
<p style="text-indent:2em">
	&nbsp;<br />
 许多机器学习解决方案正在变得可用，如Microsoft Azure ML Studio，Amazon机器学习，Databricks<br />
Spark，Splunk Machine<br />
Learning工具包。所有这些机器学习工具使得机器学习模型的实现非常直观，易于使用。这些用户界面封装了数学和编码，例如传统机器学习应用程序语言（如R）。
</p>
<p style="text-indent:2em">
	&nbsp;使用亚马逊机器学习进行安全监控，AWS<br />
 re Invent 2016会议（Videos from re Invent 2016 security and compliance<br />
sessions,<br />
2016）中演示demo。随着云实施的发展，安全团队还应该了解新方法和优点，来实施安全操作和安全监控活动。自动化和机器学习是云中的两个关键领域，为防御者提供了优势。
</p>
<p style="text-indent:2em">
	作为防御者，目标是通过在每个层设置预防性和侦测性控制，深度战略部署防御，使得攻击者要花费高额成本实现其目标。机器学习可以成为有用工具。在确定可疑活动后，使用取证，安全小组可以跟踪和跟踪攻击者执行的任何活动，并采取补救措施。
</p>
<p style="text-indent:2em">
	可能受益于此解决方案的其他一些用例包括风险管理，安全自动化/业务流程，用户/网络行为分析，欺诈检测，威胁追踪（hunting），多源的威胁情报整合以及事件响应/取证分析。
</p>
<p style="text-indent:2em">
	
</p>
<p>
	原文地址：https://www.sans.org/reading-room/whitepapers/cloud/cloud-security-monitoring-37672
</p>
<p>
	<img title="云安全监控：云安全系列（一） - 第20张  | Sec-UN 安全圈" alt="云安全监控：云安全系列（一） - 第20张  | Sec-UN 安全圈" alt="" src="/wp-content/uploads/2017/05/20170511114116_13708.png" />
</p>
<p>
	
</p>
<div class="rich_media_tool" id="js_toobar3">
</div>
 
 										                        <div class="loc_link"><ul><li>本文固定链接: <a href="https://www.sec-un.org/%e4%ba%91%e5%ae%89%e5%85%a8%e7%9b%91%e6%8e%a7%ef%bc%9a%e4%ba%91%e5%ae%89%e5%85%a8%e7%b3%bb%e5%88%97%ef%bc%88%e4%b8%80%ef%bc%89/" rel="bookmark" title="云安全监控：云安全系列（一）">https://www.sec-un.org/云安全监控：云安全系列（一）/</a></li>
                        <li>转载请注明: <a href="https://www.sec-un.org/author/legnl/" title="由legnl发布" rel="author">legnl</a> <time>2017年05月11日 </time>于 <a href="https://www.sec-un.org/" title="访问Sec-UN 安全圈">Sec-UN 安全圈</a> 发表</li></ul>
                        </div>
                        						                        <div class="author_info">
                        	<div class="au_top_bar"><div class="edit_date">最后编辑：<time>2017-05-11</time></div><b>作者：legnl</b></div>
                            <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d6eae393c48e07e0c6a40bedd24d38f0?s=96&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d6eae393c48e07e0c6a40bedd24d38f0?s=192&amp;d=mm&amp;r=g 2x' class='avatar avatar-96 photo' height='96' width='96' /></div>
                            <div class="type_out"><span class="ttxx">这个作者貌似有点懒，什么都没有留下。</span><div class="au_links"><a href="https://www.sec-un.org?author=1094" class="c1"><i class="icon-home"></i> 站内专栏</a></div></div>
                        <div class="cls"></div>
                        </div>
                        					</article>
                    
                    <!-- .entry-content -->

					<!-- .entry-utility -->
				</div><!-- #post-## -->
<div class="c-bot">
            <div class="cls"></div>
    </div>
    <br />
				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="https://www.sec-un.org/syscan360%e5%9c%a8%e8%a5%bf%e9%9b%85%e5%9b%be%e5%8a%9e%e9%bb%91%e5%ae%a2%e5%a4%a7%e4%bc%9a-%e8%b0%b7%e6%ad%8c%e5%be%ae%e8%bd%af%e9%bc%8e%e5%8a%9b%e6%94%af%e6%8c%81/" rel="next"><span class="meta-nav"><i class="icon-arrow-left"></i></span> SyScan360在西雅图办黑客大会  谷歌微软鼎力支持 </a></div>
					<div class="nav-next"><a href="https://www.sec-un.org/http81%e6%96%b0%e5%9e%8b%e5%83%b5%e5%b0%b8%e7%bd%91%e7%bb%9c%e6%9d%a5%e8%a2%ad-%e5%9b%bd%e5%86%85%e8%b6%855%e4%b8%87%e5%8f%b0%e6%91%84%e5%83%8f%e5%a4%b4%e9%81%ad%e6%8e%a7%e5%88%b6/" rel="prev">http81新型僵尸网络来袭  国内超5万台摄像头遭控制  <i class="icon-arrow-right"></i></a></div>
				</div><!-- #nav-below -->
<div class="cls"></div>
				                    <div class="ad_2">
						                    </div>
                                <div class="relatedposts">
<h3 class="widget-title"><i class="icon-warning-sign"></i> 您可能还会对这些文章感兴趣！</h3>
<ul>
		<li><a href="https://www.sec-un.org/cybersecurity-ventures-2015-network-security-market-q1-report/" rel="bookmark" title="详细阅读 Cybersecurity Ventures 2015年Q1网络安全市场报告">Cybersecurity Ventures 2015年Q1网络安全市场报告</a></li>
		<li><a href="https://www.sec-un.org/information-security-analysts-practice-analysis-of-the-splunk-platform-app-making-tutorial/" rel="bookmark" title="详细阅读 信息安全分析师实践：splunk平台分析app制作教程">信息安全分析师实践：splunk平台分析app制作教程</a></li>
		<li><a href="https://www.sec-un.org/0203-salon-open-content-identification-analysis-on-industry-data-security/" rel="bookmark" title="详细阅读 sec-un安全技术沙龙ppt&#8211;内容识别-行业应用-大数据安全分析">sec-un安全技术沙龙ppt&#8211;内容识别-行业应用-大数据安全分析</a></li>
		<li><a href="https://www.sec-un.org/blackhat2015-registration-guide/" rel="bookmark" title="详细阅读 Blackhat2015参会指南">Blackhat2015参会指南</a></li>
		<li><a href="https://www.sec-un.org/february-3-sec-un-security-technology-salon-technical-shorthand-supplementary/" rel="bookmark" title="详细阅读 2月3日sec-un安全技术沙龙技术观点速记(补充）">2月3日sec-un安全技术沙龙技术观点速记(补充）</a></li>
		<li><a href="https://www.sec-un.org/behind-the-clouds-is-the-white-hat/" rel="bookmark" title="详细阅读 乌云背后的“白帽子”">乌云背后的“白帽子”</a></li>
		<li><a href="https://www.sec-un.org/analysis-of-high-hidden-webshell-weevely-3-2-backdoor-flow-characteristics-a/" rel="bookmark" title="详细阅读 高隐藏性webshell分析：Weevely 3.2 Backdoor流量特征（一）">高隐藏性webshell分析：Weevely 3.2 Backdoor流量特征（一）</a></li>
		<li><a href="https://www.sec-un.org/webshell-event-handling-with-threat-information-about-2-portrait-of-attacker-and-machine-readable-ioc/" rel="bookmark" title="详细阅读 结合威胁情报的Webshell事件处理谈（2）&#8211;攻击者画像与机读IOC">结合威胁情报的Webshell事件处理谈（2）&#8211;攻击者画像与机读IOC</a></li>
	</ul>
<div class="cls"></div>
</div>

<div id="comments">
</div><!-- #comments -->
      </div><!-- #content -->
  </div><!-- #container -->
<script type="text/javascript">loading('55%',1000)</script>
    <aside id="primary" class="side" role="complementary">
        <ul class="xoxo">
<li id="frontloginblock-3" class="widget-container widget_login">	 <div class="front_login_box">
            	<div class="from_box">
      <form name="loginform" id="loginform" action="https://www.sec-un.org/wp-login.php" method="post">
            <p class="p1"><span><i class="icon-user icon-2x"></i></span><input onfocus="this.value = '';" name="log" id="user_login" type="text" class="user_name" value="User Name" /></p>
          <p class="p1" style="margin-bottom:30px;"><span><i class="icon-lock icon-2x"></i></span><input onfocus="this.value = '';this.type = 'password';" name="pwd" id="user_pass" type="text" class="password" value="Your Password" /></p>
          <p class="p2"><input name="提交" type="submit" class="submit_button" value="登 录" /></p>
          <p class="p3"><span style="float:right"><i class="icon-signin"></i> <a href="https://www.sec-un.org/wp-login.php?action=register">注册</a></span><span class="keep_me"><label style="display:none;" for="rememberme"><input name="rememberme" type="checkbox" id="rememberme" value="forever"></label><i class="icon-check-empty"></i> 记住我的登录信息</span></p>
          <input type="hidden" name="redirect_to" value="https://www.sec-un.org/%e4%ba%91%e5%ae%89%e5%85%a8%e7%9b%91%e6%8e%a7%ef%bc%9a%e4%ba%91%e5%ae%89%e5%85%a8%e7%b3%bb%e5%88%97%ef%bc%88%e4%b8%80%ef%bc%89/">
          </form>
        </div>
        <script type="text/javascript">
		jQuery(function($){
			$('.keep_me').click(function(){
				var nowSet = $(this).find('i').attr('class');
				if(nowSet == "icon-check-empty"){
					$(this).find('i').attr('class','icon-check');
					$(this).find('#rememberme').attr('checked','')
				}else{
					$(this).find('i').attr('class','icon-check-empty');
					$(this).find('#rememberme').removeAttr('checked')
				}
			})
		});
        </script>
            </div>
     </li><li id="cp_pointswidget-3" class="widget-container widget_cp_pointswidget"><h3 class="widget-title">我的积分</h3>				<ul>
						<li>您需要先登录才能查看您的积分。.</li>
										</ul>
			</li><li id="cp_topuserswidget-5" class="widget-container widget_cp_topuserswidget"><h3 class="widget-title">Rank排行榜</h3><ul><li class="cp_topUsersWidget top_1" style="list-style:none;">迷路的指南针 (Rank1145)</li><li class="cp_topUsersWidget top_2" style="list-style:none;">DJ (Rank841)</li><li class="cp_topUsersWidget top_3" style="list-style:none;">NUKE (Rank814)</li><li class="cp_topUsersWidget top_4" style="list-style:none;">孙维 (Rank485)</li><li class="cp_topUsersWidget top_5" style="list-style:none;">consen (Rank415)</li><li class="cp_topUsersWidget top_6" style="list-style:none;">crackershi (Rank280)</li><li class="cp_topUsersWidget top_7" style="list-style:none;">lzy (Rank276)</li><li class="cp_topUsersWidget top_8" style="list-style:none;">ThreatActor (Rank265)</li><li class="cp_topUsersWidget top_9" style="list-style:none;">archer (Rank255)</li><li class="cp_topUsersWidget top_10" style="list-style:none;">驭龙 (Rank240)</li><li class="cp_topUsersWidget top_11" style="list-style:none;">zhuyue (Rank235)</li><li class="cp_topUsersWidget top_12" style="list-style:none;">辛巴达(Sinbad) (Rank225)</li><li class="cp_topUsersWidget top_13" style="list-style:none;">SHIELD (Rank215)</li><li class="cp_topUsersWidget top_14" style="list-style:none;">zsfnotes (Rank213)</li><li class="cp_topUsersWidget top_15" style="list-style:none;">Bruce_Zhang (Rank185)</li><li class="cp_topUsersWidget top_16" style="list-style:none;">Anonymous (Rank170)</li><li class="cp_topUsersWidget top_17" style="list-style:none;">Piz0n (Rank165)</li><li class="cp_topUsersWidget top_18" style="list-style:none;">coolweis (Rank155)</li><li class="cp_topUsersWidget top_19" style="list-style:none;">bennyye (Rank150)</li><li class="cp_topUsersWidget top_20" style="list-style:none;">linzhi (Rank145)</li><li class="cp_topUsersWidget top_21" style="list-style:none;">kris (Rank125)</li><li class="cp_topUsersWidget top_22" style="list-style:none;">清风作伴明月为邻 (Rank125)</li><li class="cp_topUsersWidget top_23" style="list-style:none;">chenji123456 (Rank85)</li><li class="cp_topUsersWidget top_24" style="list-style:none;">rapido (Rank80)</li><li class="cp_topUsersWidget top_25" style="list-style:none;">heitian (Rank75)</li><li class="cp_topUsersWidget top_26" style="list-style:none;">ChrisChen世雄 (Rank75)</li><li class="cp_topUsersWidget top_27" style="list-style:none;">killer (Rank50)</li><li class="cp_topUsersWidget top_28" style="list-style:none;">mad (Rank50)</li><li class="cp_topUsersWidget top_29" style="list-style:none;">CoolICE (Rank50)</li><li class="cp_topUsersWidget top_30" style="list-style:none;">淡水鱼 (Rank50)</li></ul></li>        </ul>
    </aside><!-- #primary .widget-area -->

<script type="text/javascript">loading('78%',1000)</script>
<div class="cls"></div>
</section><!-- #main -->
<div class="cls"></div>
	<footer id="footer" role="contentinfo">
		<div id="colophon">

<div id="site-info">
<a href="javascript:void(0)" onClick="goRoll(0)" id="goTop">返回顶部</a> <a href="https://www.sec-un.org/sitemap.html">网站地图</a> &nbsp; <a href="http://www.miitbeian.gov.cn/" rel="external nofollow">京ICP备15036950号-1</a> <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?0ef96af0d6646bc4db46b410e4f2e212";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script> ©2017 Sec-UN All Rights Reserved | Theme <span id='official'>frontopen2</span></div>
		</div>	</footer></div><script type='text/javascript' src='https://www.sec-un.org/wp-includes/js/comment-reply.min.js?ver=d2207c9bc2f8d7af72d793379f207c99'></script>
<script type='text/javascript' src='https://www.sec-un.org/wp-includes/js/wp-embed.min.js?ver=d2207c9bc2f8d7af72d793379f207c99'></script>
<div id="float"><a id="float_gotop" class="floatbtn"  href="javascript:void()" onClick="goRoll(0)" title="返回顶部"></a><a class="linbak floatbtn" href="https://www.sec-un.org/wp-admin/" title="登陆&注册"></a><a id="float_goend" class="floatbtn" href="javascript:void()" onClick="goend()" title="转到底部"></a></div>
</body>
</html><script type="text/javascript">loading('100%',1000)</script>
