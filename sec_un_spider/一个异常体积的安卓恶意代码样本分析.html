<!DOCTYPE HTML>
<html>
<head>
<meta name="viewport" content="width=device-width , initial-scale=1.0 , user-scalable=0 , minimum-scale=1.0 , maximum-scale=1.0" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>一个异常体积的安卓恶意代码样本分析 | Sec-UN 安全圈</title>
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="pingback" href="https://www.sec-un.org/xmlrpc.php" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Sec-UN 安全圈 &raquo; Feed" href="https://www.sec-un.org/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sec-UN 安全圈 &raquo; 评论Feed" href="https://www.sec-un.org/comments/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.sec-un.org\/wp-includes\/js\/wp-emoji-release.min.js?ver=d2207c9bc2f8d7af72d793379f207c99"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,56826,8203,55356,56819),0,0),c=j.toDataURL(),b===c&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55358,56794,8205,9794,65039),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55358,56794,8203,9794,65039),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='jQuery_notice-css'  href='https://www.sec-un.org/wp-content/plugins/cubepoints/modules/notice/jquery.notice.css?ver=d2207c9bc2f8d7af72d793379f207c99' type='text/css' media='all' />
<link rel='stylesheet' id='cptch_stylesheet-css'  href='https://www.sec-un.org/wp-content/plugins/captcha/css/front_end_style.css?ver=4.3.5' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://www.sec-un.org/wp-includes/css/dashicons.min.css?ver=d2207c9bc2f8d7af72d793379f207c99' type='text/css' media='all' />
<link rel='stylesheet' id='cptch_desktop_style-css'  href='https://www.sec-un.org/wp-content/plugins/captcha/css/desktop_style.css?ver=4.3.5' type='text/css' media='all' />
<script type='text/javascript' src='https://www.sec-un.org/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='https://www.sec-un.org/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript' src='https://www.sec-un.org/wp-content/plugins/cubepoints/modules/notice/jquery.notice.js?ver=1.0.1'></script>
<link rel='prev' title='守望者威胁情报Feed(2016/5/4)：推出国内版feed' href='https://www.sec-un.org/watchmen-threat-intelligence-feed-2016-5-3-home-feed/' />
<link rel='next' title='威胁情报Feed之优化需求(5月5日)：问题答复' href='https://www.sec-un.org/threat-intelligence-feed-optimization-needs-may-5-question-answers/' />
<link rel="canonical" href="https://www.sec-un.org/bugly-introduced-the-android-sdk-samples-of-malicious-code-analysis/" />
<script type="text/javascript">
(function(url){
	if(/(?:Chrome\/26\.0\.1410\.63 Safari\/537\.31|WordfenceTestMonBot)/.test(navigator.userAgent)){ return; }
	var addEvent = function(evt, handler) {
		if (window.addEventListener) {
			document.addEventListener(evt, handler, false);
		} else if (window.attachEvent) {
			document.attachEvent('on' + evt, handler);
		}
	};
	var removeEvent = function(evt, handler) {
		if (window.removeEventListener) {
			document.removeEventListener(evt, handler, false);
		} else if (window.detachEvent) {
			document.detachEvent('on' + evt, handler);
		}
	};
	var evts = 'contextmenu dblclick drag dragend dragenter dragleave dragover dragstart drop keydown keypress keyup mousedown mousemove mouseout mouseover mouseup mousewheel scroll'.split(' ');
	var logHuman = function() {
		var wfscr = document.createElement('script');
		wfscr.type = 'text/javascript';
		wfscr.async = true;
		wfscr.src = url + '&r=' + Math.random();
		(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(wfscr);
		for (var i = 0; i < evts.length; i++) {
			removeEvent(evts[i], logHuman);
		}
	};
	for (var i = 0; i < evts.length; i++) {
		addEvent(evts[i], logHuman);
	}
})('//www.sec-un.org/?wordfence_logHuman=1&hid=7BB4AAB095002A7BE8A8251779A1E064');
</script><meta name="description" content="一个异常体积的安卓恶意代码样本分析   5.1放假前收到样本，从大小看，远远超过常见的恶意代码。这其中有何玄机呢？分析发现此样本是比较新的一种样本类型，特点如下：  1.使用加固工具进行加固对抗逆向分析  2.利用腾讯Bugly进行崩溃捕获，达到修复自身代码问题的目的。  3.利用asset目录隐藏恶意代码，掩盖恶意行为  与其他样本比较，比较特别的还是加入了Bugly android sdk。  一、起源：传播  4月30日收到木马传">
<script type="text/javascript">(function(){mod_txt = '#'; adminBar = "" || 0})();</script>
<script type="text/javascript" src="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/frontopen.js?ver=1.5.04.15"></script>
<script type="text/javascript" src="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/include/lightbox-2.6.min.js"></script>
<link href="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/lightbox.css" rel="stylesheet" type="text/css" />

<link rel="stylesheet" type="text/css" media="all" href="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/style.css?ver=1.5.04.15" />
<link rel="stylesheet" type="text/css" media="all" href="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/mobile.css?ver=1.5.04.15" />
<style type="text/css">@media screen and (min-width:1366px){.c-con{height:140px;}}
a:hover , .header .logo i , .tit .h1 a , .tit .iititle2 span a:hover , .entry-content a , .entry-title , .mbx a:hover , .commentlist .comment-body a , .top_post .ulist a:hover , .gonggao a , .loc_link a , .tit .iititle a:hover{color:#000000}.nav .tig .rrs , #wp-calendar td a:hover , .jz_bt , .loading , .subbtn .btn , .post_pic_box:hover , .title_hot , .top_bar , .car-toggler , .but_down a , .page-link a span , .page-link .t_s_s , .page_num a , .nav-next a{background:#000000;}.j_zeng , .jz_bt:hover , .f_links li{border-color:#000000}.navcon ul li a:hover, .navcurrent{color:#4EA4EF;}</style>

<!--[if lt IE 9]><script src="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/html5.js"></script><![endif]-->
<link rel="stylesheet" href="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/css/font-awesome.min.css?ver=1.5.04.15">
<!--[if IE 7]>
<link rel="stylesheet" href="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/css/font-awesome-ie7.min.css?ver=1.5.04.15">
<![endif]-->
</head>

<body class="post-template-default single single-post postid-4166 single-format-standard">
<div class="loading"></div>
<div class="web_bod">
<header class="header marauto">
    <span class="logo">
        <a href="https://www.sec-un.org/" title="Sec-UN 安全圈" rel="home"><img src="https://www.sec-un.org/wp-content/uploads/2014/09/logo2x-300x74.png" alt="Sec-UN 安全圈" /></a>
        <i></i>
    </span>
    <form role="search" method="get" id="searchform" action="https://www.sec-un.org/">
      <span class="search">
        <input name="s" id="s" type="text"  class="input" value="" onclick="this.value = '';" style="color:#999" onkeypress="javascript:if(event.keyCode == 13){query(this.value);}" x-webkit-speech=""/>
        <button id="searchsubmit" class="btn">搜索</button>
      </span>
    </form>
    <div class="cls"></div>
</header>


<nav class="navcon marauto">
  <div id="mobile_nav_btn">网站导航</div>
  <div class="menu-header"><ul id="menu-%e5%af%bc%e8%88%aa" class="menu"><li id="menu-item-18" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-18"><a href="http://www.sec-un.org">首页</a></li>
<li id="menu-item-23" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-23"><a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e8%b5%84%e8%ae%af/">安全资讯</a></li>
<li id="menu-item-19" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-19"><a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e6%b2%bb%e7%90%86/">安全治理</a></li>
<li id="menu-item-20" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-20"><a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e6%96%b9%e6%a1%88/">安全方案</a></li>
<li id="menu-item-21" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-21"><a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e6%8a%80%e6%9c%af/">安全技术</a></li>
<li id="menu-item-22" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-22"><a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e4%ba%ba%e6%89%8d/">安全人才</a></li>
<li id="menu-item-27" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-27"><a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e4%bb%bb%e5%8a%a1/">安全任务</a></li>
<li id="menu-item-1027" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-1027"><a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e5%a8%81%e8%83%81%e6%83%85%e6%8a%a5/">安全威胁情报</a></li>
<li id="menu-item-1764" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1764"><a href="https://www.sec-un.org/category/%e4%bf%a1%e6%81%af%e9%80%9f%e9%80%92/">信息速递</a></li>
<li id="menu-item-77" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-77"><a href="http://www.sec-un.org/wp-admin/post-new.php">我要投稿</a></li>
<li id="menu-item-75" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-75"><a href="https://www.sec-un.org/category/%e7%bd%91%e7%ab%99%e5%85%ac%e5%91%8a/">网站公告</a></li>
</ul></div>  
  </nav>   
  <section class="conter marauto"><script type="text/javascript">loading('33%',1000)</script>
  <div id="container">
      <div id="content" role="main" style="width:96%">
      <div class="mbx"><i class="icon-home icon-large" style="font-size:14px;"></i>
<a href="https://www.sec-un.org"  class="gray">首页</a>  >  <a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e5%a8%81%e8%83%81%e6%83%85%e6%8a%a5/">安全威胁情报</a>  >  一个异常体积的安卓恶意代码样本分析</div>

				<div id="post-4166" class="post-4166 post type-post status-publish format-standard hentry category-61">
                <div class="c-top2" id="post-55">
                <div class="datetime">2016<br />05-05</div>
					<header class="tit"><h1 class="entry-title">一个异常体积的安卓恶意代码样本分析</h1>
					<aside class="entry-meta iititle2">
                        <span><i class="icon-user icon-large"></i> <a href="https://www.sec-un.org/author/sally_ch/" title="由清风作伴明月为邻发布" rel="author">清风作伴明月为邻</a></span><span><i class="icon-folder-open icon-large"></i> <a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e5%a8%81%e8%83%81%e6%83%85%e6%8a%a5/" rel="category tag">安全威胁情报</a></span><span><i class="icon-eye-open icon-large"></i> 围观<i id="number">1001</i><script type="text/javascript">jQuery(function($){$.get("https://www.sec-un.org/fo_ajax?ajax=getPostViews&postID=4166",function(data){if(data.length < 10)$('#number').text(data)});})</script>次</span><span><i class="icon-comment-alt icon-large"></i> <span><span class="screen-reader-text">一个异常体积的安卓恶意代码样本分析</span>已关闭评论</span></span><span><i class="icon-pencil icon-large"></i> 编辑日期：<time>2016-05-05</time></span><span><i class="icon-zoom-in icon-large"></i> 字体：<a href="javascript:;" onclick="checkFontSize(18)">大</a> <a href="javascript:;" onclick="checkFontSize(16)">中</a> <a href="javascript:;" onclick="checkFontSize(14)">小</a></span>					</aside>
                    </header>
                    <div class="cls"></div>
		    </div>
                    <!-- .entry-meta -->

					<article class="entry-content">
                    
						<div id="js_content" class="rich_media_content ">
<h2 id="activity-name" class="rich_media_title">一个异常体积的安卓恶意代码样本分析</h2>
<div id="js_content" class="rich_media_content ">
<p>5.1放假前收到样本，从大小看，远远超过常见的恶意代码。这其中有何玄机呢？分析发现此样本是比较新的一种样本类型，特点如下：</p>
<p>1.使用加固工具进行加固对抗逆向分析</p>
<p>2.利用腾讯Bugly进行崩溃捕获，达到修复自身代码问题的目的。</p>
<p>3.利用asset目录隐藏恶意代码，掩盖恶意行为</p>
<p>与其他样本比较，比较特别的还是加入了Bugly android sdk。</p>
<p><strong>一、起源：传播</strong></p>
<p>4月30日收到木马传播的线索，传播方式和手段和一般木马无异，伪装成熟人发来的相册。同时，中招手机自动依据通讯录进行钓鱼短信的转发。<br />
<a href="http://www.sec-un.org/wp-content/uploads/2016/05/222.png" data-lightbox="image_lg"><img title="一个异常体积的安卓恶意代码样本分析 - 第1张  | Sec-UN 安全圈" alt="一个异常体积的安卓恶意代码样本分析 - 第1张  | Sec-UN 安全圈"  class="alignnone size-medium wp-image-4205"  data-src="http://www.sec-un.org/wp-content/uploads/2016/05/222-300x243.png" width="300" height="243" srcset="https://www.sec-un.org/wp-content/uploads/2016/05/222-300x243.png 300w, https://www.sec-un.org/wp-content/uploads/2016/05/222.png 382w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>随后依据钓鱼短信中的地址进行下载，下载一个名称为相册3.apk的文件。</p>
<p>初步判断为恶意代码，但利用微步在线平台进行恶意代码分析，检出率仅仅7/22（注：其中有的是免费版引擎）。</p>
<p><a href="http://www.sec-un.org/wp-content/uploads/2016/05/image005.png" data-lightbox="image_lg"><img title="一个异常体积的安卓恶意代码样本分析 - 第2张  | Sec-UN 安全圈" alt="一个异常体积的安卓恶意代码样本分析 - 第2张  | Sec-UN 安全圈"  class="alignnone size-medium wp-image-4174"  data-src="http://www.sec-un.org/wp-content/uploads/2016/05/image005-300x292.png" width="300" height="292" srcset="https://www.sec-un.org/wp-content/uploads/2016/05/image005-300x292.png 300w, https://www.sec-un.org/wp-content/uploads/2016/05/image005-768x746.png 768w, https://www.sec-un.org/wp-content/uploads/2016/05/image005.png 813w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>腾讯的哈勃在线分析平台分析结论为未发现风险。</p>
<p><a href="http://www.sec-un.org/wp-content/uploads/2016/05/image007.png" data-lightbox="image_lg"><img title="一个异常体积的安卓恶意代码样本分析 - 第3张  | Sec-UN 安全圈" alt="一个异常体积的安卓恶意代码样本分析 - 第3张  | Sec-UN 安全圈"  class="alignnone size-medium wp-image-4175"  data-src="http://www.sec-un.org/wp-content/uploads/2016/05/image007-229x300.png" width="229" height="300" srcset="https://www.sec-un.org/wp-content/uploads/2016/05/image007-229x300.png 229w, https://www.sec-un.org/wp-content/uploads/2016/05/image007.png 394w" sizes="(max-width: 229px) 100vw, 229px" /></a></p>
<p>计算哈希如下：</p>
<p><strong>样本一：</strong></p>
<p>文件: C:\Users\ASUS\Desktop\相册3.apk</p>
<p>大小: 1836569 字节</p>
<p>修改时间: 2016年5月2日, 12:09:51</p>
<p>MD5: f2b0590b558a08514e1c497d400d08ba</p>
<p>SHA1: E84C48434A1715A7D3AABC77DFC014F9718C9259</p>
<p>CRC32: 3BBA687A</p>
<p>在此之前，访问同一个地址笔者还曾下载过两次样本，名称相同，但文件大小，哈希值都不相同，判断应该是做了修改。</p>
<p><strong>样本二：</strong></p>
<p>文件: E:\新建文件夹\apk样本\相册3.apk</p>
<p>大小: 1837637 字节</p>
<p>修改时间: 2016年4月29日, 9:43:00</p>
<p>MD5: f4b3c7ab83402ec87a905cf6c9444074</p>
<p>SHA1: DD9CF591E4177B90BF05FCE26A201231F061D7B7</p>
<p>CRC32: A5EA2581</p>
<p><strong>样本三：</strong></p>
<p>文件: E:\新建文件夹\apk样本\相册3.apk</p>
<p>大小: 1837600 字节</p>
<p>修改时间: 2016年4月30日, 23:01:34</p>
<p>MD5: 3adc9adc32eb6e5abd6b5a1ea00070ef</p>
<p>SHA1: C4A72CFAC7DF4CED58DDC6C627ADC72FAD694859</p>
<p>CRC32: 76AAA825</p>
<p>从下载文件的大小看，远远超过常见的恶意代码。这其中有何玄机呢？</p>
<p>同时在笔者跟踪的过程中，编写者一直在做修改。那么他又是根据什么信息做出调整和修改的呢？且看后面分解。</p>
<p><strong>二、恶意代码行为分析</strong></p>
<p>经分析主要行为如下：</p>
<p><a href="http://www.sec-un.org/wp-content/uploads/2016/05/image009.png" data-lightbox="image_lg"><img title="一个异常体积的安卓恶意代码样本分析 - 第4张  | Sec-UN 安全圈" alt="一个异常体积的安卓恶意代码样本分析 - 第4张  | Sec-UN 安全圈"  class="alignnone size-medium wp-image-4176"  data-src="http://www.sec-un.org/wp-content/uploads/2016/05/image009-300x189.png" width="300" height="189" srcset="https://www.sec-un.org/wp-content/uploads/2016/05/image009-300x189.png 300w, https://www.sec-un.org/wp-content/uploads/2016/05/image009.png 546w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p><strong>1.</strong><strong>诱导安装其它</strong><strong>apk</strong></p>
<p>在虚拟机中运行相册3.apk(MD5: F2B0590B558A08514E1C497D400D08BA)。因为我使用的虚拟机是Genymotion,不支持中文名，所以改为3.apk。启动后伪装相册欢迎界面如下：</p>
<p><a href="http://www.sec-un.org/wp-content/uploads/2016/05/image011.png" data-lightbox="image_lg"><img title="一个异常体积的安卓恶意代码样本分析 - 第5张  | Sec-UN 安全圈" alt="一个异常体积的安卓恶意代码样本分析 - 第5张  | Sec-UN 安全圈"  class="alignnone size-medium wp-image-4177"  data-src="http://www.sec-un.org/wp-content/uploads/2016/05/image011-195x300.png" width="195" height="300" srcset="https://www.sec-un.org/wp-content/uploads/2016/05/image011-195x300.png 195w, https://www.sec-un.org/wp-content/uploads/2016/05/image011.png 458w" sizes="(max-width: 195px) 100vw, 195px" /></a></p>
<p>随后提示andriod相册版本过低，要求更新。点击安装，实际是在诱导用户安装其/assets目录下的另一个恶意代码。高版本的安卓会提示用户设置安装权限。</p>
<p><a href="http://www.sec-un.org/wp-content/uploads/2016/05/image013.png" data-lightbox="image_lg"><img title="一个异常体积的安卓恶意代码样本分析 - 第6张  | Sec-UN 安全圈" alt="一个异常体积的安卓恶意代码样本分析 - 第6张  | Sec-UN 安全圈"  class="alignnone size-medium wp-image-4179"  data-src="http://www.sec-un.org/wp-content/uploads/2016/05/image013-300x259.png" width="300" height="259" srcset="https://www.sec-un.org/wp-content/uploads/2016/05/image013-300x259.png 300w, https://www.sec-un.org/wp-content/uploads/2016/05/image013.png 466w" sizes="(max-width: 300px) 100vw, 300px" /></a><a href="http://www.sec-un.org/wp-content/uploads/2016/05/image014.png" data-lightbox="image_lg"><img title="一个异常体积的安卓恶意代码样本分析 - 第7张  | Sec-UN 安全圈" alt="一个异常体积的安卓恶意代码样本分析 - 第7张  | Sec-UN 安全圈"  class="alignnone size-medium wp-image-4178"  data-src="http://www.sec-un.org/wp-content/uploads/2016/05/image014-183x300.png" width="183" height="300" srcset="https://www.sec-un.org/wp-content/uploads/2016/05/image014-183x300.png 183w, https://www.sec-un.org/wp-content/uploads/2016/05/image014.png 460w" sizes="(max-width: 183px) 100vw, 183px" /></a></p>
<p>如果用户选择了允许从未知源安装应用，就会安装com.mafe.dotars.flaird.apk，伪装名称为android，表面上看是系统应用。同时诱导用户选择赋予其系统权限，这种手法是很多恶意代码常用的。</p>
<p><a href="http://www.sec-un.org/wp-content/uploads/2016/05/image016.png" data-lightbox="image_lg"><img title="一个异常体积的安卓恶意代码样本分析 - 第8张  | Sec-UN 安全圈" alt="一个异常体积的安卓恶意代码样本分析 - 第8张  | Sec-UN 安全圈"  class="alignnone size-medium wp-image-4180"  data-src="http://www.sec-un.org/wp-content/uploads/2016/05/image016-300x243.png" width="300" height="243" srcset="https://www.sec-un.org/wp-content/uploads/2016/05/image016-300x243.png 300w, https://www.sec-un.org/wp-content/uploads/2016/05/image016.png 510w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p><strong>2.</strong><strong>个人信息钓鱼</strong></p>
<p>点击注册相册，会要求填入个人身份证信息</p>
<p><a href="http://www.sec-un.org/wp-content/uploads/2016/05/image017.png" data-lightbox="image_lg"><img title="一个异常体积的安卓恶意代码样本分析 - 第9张  | Sec-UN 安全圈" alt="一个异常体积的安卓恶意代码样本分析 - 第9张  | Sec-UN 安全圈"  class="alignnone size-medium wp-image-4181"  data-src="http://www.sec-un.org/wp-content/uploads/2016/05/image017-170x300.png" width="170" height="300" srcset="https://www.sec-un.org/wp-content/uploads/2016/05/image017-170x300.png 170w, https://www.sec-un.org/wp-content/uploads/2016/05/image017.png 476w" sizes="(max-width: 170px) 100vw, 170px" /></a></p>
<p><strong>3.</strong><strong>个人隐私信息上传</strong></p>
<p><a href="http://www.sec-un.org/wp-content/uploads/2016/05/image019.png" data-lightbox="image_lg"><img title="一个异常体积的安卓恶意代码样本分析 - 第10张  | Sec-UN 安全圈" alt="一个异常体积的安卓恶意代码样本分析 - 第10张  | Sec-UN 安全圈"  class="alignnone size-medium wp-image-4182"  data-src="http://www.sec-un.org/wp-content/uploads/2016/05/image019-300x169.png" width="300" height="169" srcset="https://www.sec-un.org/wp-content/uploads/2016/05/image019-300x169.png 300w, https://www.sec-un.org/wp-content/uploads/2016/05/image019-768x432.png 768w, https://www.sec-un.org/wp-content/uploads/2016/05/image019-1024x576.png 1024w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>通过抓包发现恶意代码最终目的还是利用邮箱进行个人隐私信息的上传。分析得知，其邮箱和密码为：</p>
<p>邮箱：<a>sha**@tenceny.com</a>（此为网易企业邮箱，可自定域名）</p>
<p>密码：qq******</p>
<p>截至目前，已经有6000多封邮件。内容是恶意代码上传的通讯录、短信等隐私信息。</p>
<p><strong><a href="http://www.sec-un.org/wp-content/uploads/2016/05/image022.jpg" data-lightbox="image_lg"><img title="一个异常体积的安卓恶意代码样本分析 - 第11张  | Sec-UN 安全圈" alt="一个异常体积的安卓恶意代码样本分析 - 第11张  | Sec-UN 安全圈"  class="alignnone size-medium wp-image-4183"  data-src="http://www.sec-un.org/wp-content/uploads/2016/05/image022-300x168.jpg" width="300" height="168" srcset="https://www.sec-un.org/wp-content/uploads/2016/05/image022-300x168.jpg 300w, https://www.sec-un.org/wp-content/uploads/2016/05/image022.jpg 515w" sizes="(max-width: 300px) 100vw, 300px" /></a></strong></p>
<p><a href="http://www.sec-un.org/wp-content/uploads/2016/05/image023.png" data-lightbox="image_lg"><img title="一个异常体积的安卓恶意代码样本分析 - 第12张  | Sec-UN 安全圈" alt="一个异常体积的安卓恶意代码样本分析 - 第12张  | Sec-UN 安全圈"  class="alignnone size-medium wp-image-4184"  data-src="http://www.sec-un.org/wp-content/uploads/2016/05/image023-220x300.png" width="220" height="300" srcset="https://www.sec-un.org/wp-content/uploads/2016/05/image023-220x300.png 220w, https://www.sec-un.org/wp-content/uploads/2016/05/image023.png 667w" sizes="(max-width: 220px) 100vw, 220px" /></a></p>
<p><strong>4.apk</strong><strong>用户信息上传到</strong><strong>Bugly.com</strong></p>
<p>数据包过滤POST行为的记录，获得IP：220.249.245.89</p>
<p><a href="http://www.sec-un.org/wp-content/uploads/2016/05/image025.png" data-lightbox="image_lg"><img title="一个异常体积的安卓恶意代码样本分析 - 第13张  | Sec-UN 安全圈" alt="一个异常体积的安卓恶意代码样本分析 - 第13张  | Sec-UN 安全圈"  class="alignnone size-medium wp-image-4185"  data-src="http://www.sec-un.org/wp-content/uploads/2016/05/image025-300x191.png" width="300" height="191" srcset="https://www.sec-un.org/wp-content/uploads/2016/05/image025-300x191.png 300w, https://www.sec-un.org/wp-content/uploads/2016/05/image025.png 416w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>上传数据至少包括安装设备的型号、MAC地址、WIFI信息、IMEI等信息。</p>
<p>经与Bugly的帅哥沟通，Bugly采集IMEI、MAC等信息，只是为了计算影响设备数，并未将信息提供给开发者。</p>
<p><a href="http://www.sec-un.org/wp-content/uploads/2016/05/6.png" data-lightbox="image_lg"><img title="一个异常体积的安卓恶意代码样本分析 - 第14张  | Sec-UN 安全圈" alt="一个异常体积的安卓恶意代码样本分析 - 第14张  | Sec-UN 安全圈"  class="alignnone size-medium wp-image-4206"  data-src="http://www.sec-un.org/wp-content/uploads/2016/05/6-300x227.png" width="300" height="227" srcset="https://www.sec-un.org/wp-content/uploads/2016/05/6-300x227.png 300w, https://www.sec-un.org/wp-content/uploads/2016/05/6.png 596w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>结合apk的逆向分析，确认apk使用了Bugly Android快速接入功能，根据腾讯Bugly平台SDK使用说明，可知此恶意代码的appid为9000******，可以进行查询溯源。</p>
<p><a href="http://www.sec-un.org/wp-content/uploads/2016/05/捕获.png" data-lightbox="image_lg"><img title="一个异常体积的安卓恶意代码样本分析 - 第15张  | Sec-UN 安全圈" alt="一个异常体积的安卓恶意代码样本分析 - 第15张  | Sec-UN 安全圈"  class="alignnone size-medium wp-image-4207"  data-src="http://www.sec-un.org/wp-content/uploads/2016/05/捕获-283x300.png" width="283" height="300" srcset="https://www.sec-un.org/wp-content/uploads/2016/05/捕获-283x300.png 283w, https://www.sec-un.org/wp-content/uploads/2016/05/捕获.png 596w" sizes="(max-width: 283px) 100vw, 283px" /></a></p>
<p>注：Bugly平台的作用是腾讯Bugly是腾讯公司为移动开发者开放的服务之一。针对移动应用，腾讯Bugly提供了专业的Crash(崩溃)、Android ANR(application not response)、iOS卡顿监控和解决方案。移动开发者(Android/iOS)可以通过监控，快速发现用户在使用过程中出现的Crash(崩溃)、Android ANR和iOS卡顿，并根据上报的信息快速定位和解决问题<strong>。 </strong></p>
<p><a href="http://www.sec-un.org/wp-content/uploads/2016/05/image037.png" data-lightbox="image_lg"><img title="一个异常体积的安卓恶意代码样本分析 - 第16张  | Sec-UN 安全圈" alt="一个异常体积的安卓恶意代码样本分析 - 第16张  | Sec-UN 安全圈"  class="alignnone size-medium wp-image-4209"  data-src="http://www.sec-un.org/wp-content/uploads/2016/05/image037-300x218.png" width="300" height="218" srcset="https://www.sec-un.org/wp-content/uploads/2016/05/image037-300x218.png 300w, https://www.sec-un.org/wp-content/uploads/2016/05/image037-768x559.png 768w, https://www.sec-un.org/wp-content/uploads/2016/05/image037.png 935w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>通过Bugly的DEMO显示，可以很好的进行用户量的监控，了解设备信息，定位出错信息。前面几个恶意代码样本的频繁变化，应该是写马者根据监控结果做了调整。</p>
<p><a href="http://www.sec-un.org/wp-content/uploads/2016/05/image039.png" data-lightbox="image_lg"><img title="一个异常体积的安卓恶意代码样本分析 - 第17张  | Sec-UN 安全圈" alt="一个异常体积的安卓恶意代码样本分析 - 第17张  | Sec-UN 安全圈"  class="alignnone size-medium wp-image-4210"  data-src="http://www.sec-un.org/wp-content/uploads/2016/05/image039-300x207.png" width="300" height="207" srcset="https://www.sec-un.org/wp-content/uploads/2016/05/image039-300x207.png 300w, https://www.sec-un.org/wp-content/uploads/2016/05/image039-768x529.png 768w, https://www.sec-un.org/wp-content/uploads/2016/05/image039-1024x706.png 1024w, https://www.sec-un.org/wp-content/uploads/2016/05/image039.png 1162w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p><a href="http://www.sec-un.org/wp-content/uploads/2016/05/image041.png" data-lightbox="image_lg"><img title="一个异常体积的安卓恶意代码样本分析 - 第18张  | Sec-UN 安全圈" alt="一个异常体积的安卓恶意代码样本分析 - 第18张  | Sec-UN 安全圈"  class="alignnone size-medium wp-image-4211"  data-src="http://www.sec-un.org/wp-content/uploads/2016/05/image041-300x151.png" width="300" height="151" srcset="https://www.sec-un.org/wp-content/uploads/2016/05/image041-300x151.png 300w, https://www.sec-un.org/wp-content/uploads/2016/05/image041-768x385.png 768w, https://www.sec-un.org/wp-content/uploads/2016/05/image041.png 843w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p><strong><a href="http://www.sec-un.org/wp-content/uploads/2016/05/image043.png" data-lightbox="image_lg"><img title="一个异常体积的安卓恶意代码样本分析 - 第19张  | Sec-UN 安全圈" alt="一个异常体积的安卓恶意代码样本分析 - 第19张  | Sec-UN 安全圈"  class="alignnone size-medium wp-image-4212"  data-src="http://www.sec-un.org/wp-content/uploads/2016/05/image043-300x198.png" width="300" height="198" srcset="https://www.sec-un.org/wp-content/uploads/2016/05/image043-300x198.png 300w, https://www.sec-un.org/wp-content/uploads/2016/05/image043-768x506.png 768w, https://www.sec-un.org/wp-content/uploads/2016/05/image043-1024x675.png 1024w, https://www.sec-un.org/wp-content/uploads/2016/05/image043.png 1200w" sizes="(max-width: 300px) 100vw, 300px" /></a></strong></p>
<p><strong>三、关联分析</strong></p>
<p>该恶意代码直接关联的域名有：</p>
<p><strong>lcnover.com(</strong><strong>恶意代码存放空间) </strong></p>
<p><strong>tenceny.com(</strong><a><strong>恶意</strong><strong>代码上传用户隐私</strong><strong>到</strong><strong>网易企业免费邮箱shabi@tenceny.com</strong></a><strong>，可以注册自己设定的后缀，对应已注册的域名)</strong></p>
<p>下面主要根据站长whois工具、微步在线、360威胁情报中心进行关联分析。（顺便说一下，这几个平台各有所长，但是有数据的可视化不好，可视化好的没数据……威胁情报加油）</p>
<p><strong>1.lcnover.com</strong></p>
<p><a href="http://www.sec-un.org/wp-content/uploads/2016/05/image045.png" data-lightbox="image_lg"><img title="一个异常体积的安卓恶意代码样本分析 - 第20张  | Sec-UN 安全圈" alt="一个异常体积的安卓恶意代码样本分析 - 第20张  | Sec-UN 安全圈"  class="alignnone size-medium wp-image-4214"  data-src="http://www.sec-un.org/wp-content/uploads/2016/05/image045-300x253.png" width="300" height="253" srcset="https://www.sec-un.org/wp-content/uploads/2016/05/image045-300x253.png 300w, https://www.sec-un.org/wp-content/uploads/2016/05/image045.png 726w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>（此图根据各平台数据整合绘制）</p>
<p><strong>梳理结果：</strong></p>
<p><strong>QQ:32425545\406229685\755188400</strong><strong>（经搜索标示位于广西、买卖备案域名等相关）</strong></p>
<p><strong>邮箱：</strong><a><strong>sddds5@163.com</strong><strong>、</strong><strong>dfgkfdj8899@126.com</strong></a><strong>后者与赌博网站关。当然这只是潜在可疑的关系，具体还要进一步查证分析。</strong></p>
<p><strong>2.tenceny.com</strong></p>
<p><a href="http://www.sec-un.org/wp-content/uploads/2016/05/image048.png" data-lightbox="image_lg"><img title="一个异常体积的安卓恶意代码样本分析 - 第21张  | Sec-UN 安全圈" alt="一个异常体积的安卓恶意代码样本分析 - 第21张  | Sec-UN 安全圈"  class="alignnone size-medium wp-image-4213"  data-src="http://www.sec-un.org/wp-content/uploads/2016/05/image048-300x231.png" width="300" height="231" srcset="https://www.sec-un.org/wp-content/uploads/2016/05/image048-300x231.png 300w, https://www.sec-un.org/wp-content/uploads/2016/05/image048-768x591.png 768w, https://www.sec-un.org/wp-content/uploads/2016/05/image048.png 870w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>（图片来源：微步在线）</p>
<p><strong>附数据来源(原始数据已经过整理归纳)：</strong></p>
<p><strong>lcnover.com</strong></p>
<table width="614" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="96">解析次数</td>
<td valign="top" width="100">解析结果</td>
<td valign="top" width="98">域名</td>
<td valign="top" width="161">首次解析时间</td>
<td valign="top" width="161">最后解析时间</td>
</tr>
<tr>
<td valign="top" width="96">8031</td>
<td valign="top" width="100">45.64.112.28</td>
<td valign="top" width="98">lcnover.com</td>
<td valign="top" width="161">2016/04/18  00:00:00</td>
<td valign="top" width="161">2016/05/03  00:00:00</td>
</tr>
</tbody>
</table>
<p>（数据来源：360威胁情报中心）</p>
<table cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="217">注册域名</td>
<td valign="top" width="336">lcnover.com</td>
</tr>
<tr>
<td valign="top" width="217">创建时间</td>
<td valign="top" width="336">2016-04-12 15:49:04</td>
</tr>
<tr>
<td valign="top" width="217">域名过期时间</td>
<td valign="top" width="336">2017-04-12 15:49:04</td>
</tr>
<tr>
<td valign="top" width="217">注册人</td>
<td valign="top" width="336">wanmengshao</td>
</tr>
<tr>
<td valign="top" width="217">域名管理员邮箱</td>
<td valign="top" width="336">32425545@qq.com</td>
</tr>
<tr>
<td valign="top" width="217">注册管理员电话</td>
<td valign="top" width="336">+86.0,+86.03216273623</td>
</tr>
</tbody>
</table>
<p>（数据来源：站长whois查询）</p>
<table cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="144">域名</td>
<td valign="top" width="91">注册人</td>
<td valign="top" width="104">邮箱</td>
<td valign="top" width="94">注册日</td>
<td valign="top" width="95">到期日</td>
</tr>
<tr>
<td valign="top" width="144">lcnover.com</td>
<td valign="top" width="117">wanmengshao</td>
<td valign="top" width="104">32425545@qq.com</td>
<td valign="top" width="94">2016-04-12</td>
<td valign="top" width="95">2017-04-12</td>
</tr>
<tr>
<td valign="top" width="144">xuexiaotongzhi.com</td>
<td valign="top" width="117">wanmengshao</td>
<td valign="top" width="104">32425545@qq.com</td>
<td valign="top" width="94">2016-02-20</td>
<td valign="top" width="95">2017-02-20</td>
</tr>
</tbody>
</table>
<p>（数据来源：站长whois查询）</p>
<p><strong>同</strong><strong>IP</strong><strong>解析历史</strong><strong>45.64.112.28</strong></p>
<table cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="156">解析结果</td>
<td valign="top" width="114">解析时间</td>
<td valign="top" width="117">注册邮箱</td>
<td valign="top" width="90">注册人</td>
</tr>
<tr>
<td valign="top" width="156">www.lcnover.com</td>
<td valign="top" width="126">2016/5/3  14:58</td>
<td valign="top" width="117">32425545@qq.com</td>
<td valign="top" width="90">wanmengshao</td>
</tr>
<tr>
<td valign="top" width="156">lcnover.com</td>
<td valign="top" width="126">2016/5/3  14:44</td>
<td valign="top" width="117">32425545@qq.com</td>
<td valign="top" width="90">wanmengshao</td>
</tr>
<tr>
<td valign="top" width="156">wap.lcnover.com</td>
<td valign="top" width="126">2016/4/29  15:29</td>
<td valign="top" width="117">32425545@qq.com</td>
<td valign="top" width="90">wanmengshao</td>
</tr>
<tr>
<td valign="top" width="156">www.ssc1880.com</td>
<td valign="top" width="126">2015/11/1  10:54</td>
<td valign="top" width="117">406229685@qq.com</td>
<td valign="top" width="90">li  dong</td>
</tr>
<tr>
<td valign="top" width="156">ssc1880.com</td>
<td valign="top" width="126">2015/10/7  21:52</td>
<td valign="top" width="117">406229685@qq.com</td>
<td valign="top" width="90">li  dong</td>
</tr>
<tr>
<td valign="top" width="156">d.711xy.com</td>
<td valign="top" width="126">2015/7/22  20:54</td>
<td valign="top" width="117">privacy@sun-privacy.com</td>
<td valign="top" width="90"></td>
</tr>
<tr>
<td valign="top" width="156">m.ssc1880.com</td>
<td valign="top" width="126">2015/4/7  23:15</td>
<td valign="top" width="117">406229685@qq.com</td>
<td valign="top" width="90">li  dong</td>
</tr>
<tr>
<td valign="top" width="156">6h.ssc1880.com</td>
<td valign="top" width="126">2015/3/22  14:20</td>
<td valign="top" width="117">406229685@qq.com</td>
<td valign="top" width="90">li  dong</td>
</tr>
<tr>
<td valign="top" width="156">www.nnn7777.com</td>
<td valign="top" width="126">2015/1/7  10:06</td>
<td valign="top" width="117">sddds5@163.com</td>
<td valign="top" width="90">sds sd</td>
</tr>
<tr>
<td valign="top" width="156">www.xunyou7.com</td>
<td valign="top" width="126">2014/12/19  13:20</td>
<td valign="top" width="117">755188400@qq.com</td>
<td valign="top" width="90">lirong  shi</td>
</tr>
<tr>
<td valign="top" width="156">www.nnn3333.com</td>
<td valign="top" width="126">2014/12/19  11:32</td>
<td valign="top" width="117">sddds5@163.com</td>
<td valign="top" width="90">sds sd</td>
</tr>
<tr>
<td valign="top" width="156">www.ttt4444.com</td>
<td valign="top" width="126">2014/12/17  13:16</td>
<td valign="top" width="117">sddds5@163.com</td>
<td valign="top" width="90">sds sd</td>
</tr>
<tr>
<td valign="top" width="156">www.nnn1111.com</td>
<td valign="top" width="126">2014/12/16  10:51</td>
<td valign="top" width="117">sddds5@163.com</td>
<td valign="top" width="90">sds sd</td>
</tr>
<tr>
<td valign="top" width="156">xunyou7.com</td>
<td valign="top" width="126">2014/12/15  21:12</td>
<td valign="top" width="117">755188400@qq.com</td>
<td valign="top" width="90">lirong  shi</td>
</tr>
<tr>
<td valign="top" width="156">nnn7777.com</td>
<td valign="top" width="126">2014/12/14  17:40</td>
<td valign="top" width="117">sddds5@163.com</td>
<td valign="top" width="90">sds sd</td>
</tr>
<tr>
<td valign="top" width="156">www.qqq4444.com</td>
<td valign="top" width="126">2014/12/12  19:28</td>
<td valign="top" width="117">sddds5@163.com</td>
<td valign="top" width="90">sds sd</td>
</tr>
<tr>
<td valign="top" width="156">nnn1111.com</td>
<td valign="top" width="126">2014/12/6  6:34</td>
<td valign="top" width="117">sddds5@163.com</td>
<td valign="top" width="90">sds sd</td>
</tr>
<tr>
<td valign="top" width="156">nnn3333.com</td>
<td valign="top" width="126">2014/12/6  6:34</td>
<td valign="top" width="117">sddds5@163.com</td>
<td valign="top" width="90">sds sd</td>
</tr>
<tr>
<td valign="top" width="156">ttt4444.com</td>
<td valign="top" width="126">2014/12/6  6:34</td>
<td valign="top" width="117">dfgkfdj8899@126.com</td>
<td valign="top" width="90">lirong  shi</td>
</tr>
<tr>
<td valign="top" width="156">qqq4444.com</td>
<td valign="top" width="126">2014/12/6  6:33</td>
<td valign="top" width="117">sddds5@163.com</td>
<td valign="top" width="90">sds sd</td>
</tr>
<tr>
<td valign="top" width="156">www.vvv4444.com</td>
<td valign="top" width="126">2014/12/6  6:33</td>
<td valign="top" width="117">dfgkfdj8899@126.com</td>
<td valign="top" width="90">lirong  shi</td>
</tr>
<tr>
<td valign="top" width="156">vvv4444.com</td>
<td valign="top" width="126">2014/12/6  6:33</td>
<td valign="top" width="117">dfgkfdj8899@126.com</td>
<td valign="top" width="90">lirong  shi</td>
</tr>
</tbody>
</table>
<p>（数据来源：360威胁情报中心）</p>
<p><strong>tenceny.com</strong></p>
<table cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="217">注册域名</td>
<td valign="top" width="336">tenceny.com</td>
</tr>
<tr>
<td valign="top" width="217">创建时间</td>
<td valign="top" width="336">2014-12-09 13:33:51</td>
</tr>
<tr>
<td valign="top" width="217">域名过期时间</td>
<td valign="top" width="336">2015-12-09 13:33:51</td>
</tr>
<tr>
<td valign="top" width="217">注册人</td>
<td valign="top" width="336">ennis ennis</td>
</tr>
<tr>
<td valign="top" width="217">域名管理员邮箱</td>
<td valign="top" width="336">10000@qq.com</td>
</tr>
<tr>
<td valign="top" width="217">注册管理员电话</td>
<td valign="top" width="336">+86.1000 10086100</td>
</tr>
</tbody>
</table>
<p>（数据来源：360威胁情报中心）</p>
<table cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="35">解析次数</td>
<td valign="top" width="111">解析结果</td>
<td valign="top" width="94">域名</td>
<td valign="top" width="100">首次解析时间</td>
<td valign="top" width="138">最后解析时间</td>
</tr>
<tr>
<td valign="top" width="41">2</td>
<td valign="top" width="111">173.208.243.233</td>
<td valign="top" width="94">tenceny.com</td>
<td valign="top" width="100">2015/04/04  00:00:00</td>
<td valign="top" width="138">2015/04/04  00:00:00</td>
</tr>
<tr>
<td valign="top" width="41">1</td>
<td valign="top" width="111">123.125.81.12</td>
<td valign="top" width="94">tenceny.com</td>
<td valign="top" width="100">2014/08/18  00:00:00</td>
<td valign="top" width="138">2014/08/18  00:00:00</td>
</tr>
<tr>
<td valign="top" width="41">19</td>
<td valign="top" width="111">ns11.xincache.com</td>
<td valign="top" width="94">tenceny.com</td>
<td valign="top" width="100">2014/12/10  00:00:00</td>
<td valign="top" width="138">2014/12/10  00:00:00</td>
</tr>
</tbody>
</table>
<p>（数据来源：360威胁情报中心）</p>
<p><strong> </strong></p>
<p><strong>四、</strong><strong>apk</strong><strong>逆向分析</strong></p>
<p><strong>1</strong><strong>、相册</strong><strong>3.apk</strong></p>
<p><strong>a.</strong><strong>基本信息：</strong></p>
<p>名称：相册</p>
<p>包名：com.qsfnxg.cvtxhs</p>
<p>入口：com.mnvmteng.xunbaikew1.WelcomeActivity</p>
<p>版本信息：Ver：1.0(1) SDK：8TargetSDK：19</p>
<p>MD5:f2b0590b558a08514e1c497d400d08ba</p>
<p>权限：</p>
<p>android.permission.READ_LOGS//允许程序读取底层系统日志文件</p>
<p>android.permission.WRITE_EXTERNAL_STORAGE//写存储卡</p>
<p>android.permission.ACCESS_WIFI_STATE//允许程序访问Wi-Fi网络状态信息</p>
<p>android.permission.INTERNET//允许程序打开网络套接字</p>
<p>android.permission.READ_PHONE_STATE//允许应用程序读取电话状态</p>
<p>android.permission.READ_CONTACTS//允许应用程序读取联系人通讯录信息</p>
<p>android.permission.WRITE_CONTACTS//允许应用程序写入联系人</p>
<p>android.permission.SEND_SMS//允许应用程序发送短信</p>
<p>android.permission.ACCESS_NETWORK_STATE//允许应用程序获取网络信息状态</p>
<p><strong>b.</strong><strong>主要危险行为：</strong></p>
<p>通过Intent安装apk</p>
<p>详情信息：</p>
<p>file:///data/data/com.qsfnxg.cvtxhs/files/com.mafe.dotars.flaird.apk</p>
<p>通过Intent启动apk</p>
<p>详情信息：</p>
<p>ComponentInfo{com.mafe.dotars.flaird/com.mafe.dotars.flaird}</p>
<p>发送短信</p>
<p>详情信息：</p>
<p>number:**8001380** data:message:blank ，送份相册你欣赏 lcnover.com/xcwj</p>
<p>number:**2691912** data:message:ye</p>
<p>注：Android中提供了Intent机制来协助应用间的交互与通讯</p>
<p><strong>c.</strong><strong>加壳处理</strong></p>
<p>经分析是用了腾讯的乐固加壳。会导致反编译工具无法分析。</p>
<p><a href="http://www.sec-un.org/wp-content/uploads/2016/05/无标题.png" data-lightbox="image_lg"><img title="一个异常体积的安卓恶意代码样本分析 - 第22张  | Sec-UN 安全圈" alt="一个异常体积的安卓恶意代码样本分析 - 第22张  | Sec-UN 安全圈"  class="alignnone size-medium wp-image-4208"  data-src="http://www.sec-un.org/wp-content/uploads/2016/05/无标题-300x95.png" width="300" height="95" srcset="https://www.sec-un.org/wp-content/uploads/2016/05/无标题-300x95.png 300w, https://www.sec-un.org/wp-content/uploads/2016/05/无标题-768x242.png 768w, https://www.sec-un.org/wp-content/uploads/2016/05/无标题.png 935w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p><strong>d.assets</strong><strong>目录存放apk文件</strong></p>
<p><a href="http://www.sec-un.org/wp-content/uploads/2016/05/image052.png" data-lightbox="image_lg"><img title="一个异常体积的安卓恶意代码样本分析 - 第23张  | Sec-UN 安全圈" alt="一个异常体积的安卓恶意代码样本分析 - 第23张  | Sec-UN 安全圈"  class="alignnone size-full wp-image-4216"  data-src="http://www.sec-un.org/wp-content/uploads/2016/05/image052.png" width="281" height="238" /></a></p>
<p>在其assets目录中带有com.mafe.dotars.flaird.apk。这也对应了我们前面行为分析。</p>
<p><strong>e.</strong><strong>使用Bugly android sdk</strong></p>
<p>从代码结构上看，使用了Bugly android sdk，这应该也是此代码体积比较大的主要原因吧。</p>
<p><a href="http://www.sec-un.org/wp-content/uploads/2016/05/image054.png" data-lightbox="image_lg"><img title="一个异常体积的安卓恶意代码样本分析 - 第24张  | Sec-UN 安全圈" alt="一个异常体积的安卓恶意代码样本分析 - 第24张  | Sec-UN 安全圈"  class="alignnone size-medium wp-image-4217"  data-src="http://www.sec-un.org/wp-content/uploads/2016/05/image054-300x178.png" width="300" height="178" srcset="https://www.sec-un.org/wp-content/uploads/2016/05/image054-300x178.png 300w, https://www.sec-un.org/wp-content/uploads/2016/05/image054.png 672w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p><strong>同时在源码中也发现了</strong><strong>Bugly</strong><strong>需要的</strong><strong>appid</strong><strong>。</strong><strong>Bugly</strong><strong>平台可以依据</strong><strong>appid</strong><strong>来收集</strong><strong>crash</strong><strong>信息。</strong></p>
<p><a href="http://www.sec-un.org/wp-content/uploads/2016/05/image057.png" data-lightbox="image_lg"><img title="一个异常体积的安卓恶意代码样本分析 - 第25张  | Sec-UN 安全圈" alt="一个异常体积的安卓恶意代码样本分析 - 第25张  | Sec-UN 安全圈"  class="alignnone size-medium wp-image-4219"  data-src="http://www.sec-un.org/wp-content/uploads/2016/05/image057-300x150.png" width="300" height="150" srcset="https://www.sec-un.org/wp-content/uploads/2016/05/image057-300x150.png 300w, https://www.sec-un.org/wp-content/uploads/2016/05/image057.png 562w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p><strong>2.com.mafe.dotars.flaird</strong><strong>包分析</strong></p>
<p>名称：Android</p>
<p>包名：com.mafe.dotars.flaird</p>
<p>入口：com.phone2.stop.activity.MainActivity</p>
<p>版本信息：Ver：5.5.365(98) SDK：8TargetSDK：19</p>
<p>MD5：45a2ab6d15c6954f24a861016e4994db</p>
<p>权限：</p>
<p>android.permission.READ_LOGS//允许程序读取底层系统日志文件</p>
<p>android.permission.RECEIVE_WAP_PUSH//允许应用程序接收WAP PUSH信息</p>
<p>android.permission.RECEIVE_BOOT_COMPLETED//允许应用程序开机自动运行</p>
<p>android.permission.MODIFY_AUDIO_SETTINGS//允许应用程序修改全局音频设置</p>
<p>android.permission.WRITE_EXTERNAL_STORAGE//允许应用程序写入外部存储，如SD卡上写文件</p>
<p>android.permission.RECEIVE_USER_PRESENT//允许程序唤醒机器</p>
<p>android.permission.READ_CONTACTS////允许应用程序读取联系人通讯录信息</p>
<p>android.permission.INTERNET//允许应用程序访问网络连接</p>
<p>android.permission.READ_PHONE_STATE//允许应用程序读取电话状态</p>
<p>android.permission.READ_SMS//允许程序读取短信息</p>
<p>android.permission.WRITE_SETTINGS//允许应用程序读取短信内容</p>
<p>android.permission.VIBRATE//允许访问振动设备</p>
<p>android.permission.RECEIVE_SMS//允许应用程序接收短信</p>
<p>android.permission.ACCESS_NETWORK_STATE//允许应用程序获取网络信息状态</p>
<p>android.permission.GET_TASKS//允许应用程序获取当前或最近运行的应用</p>
<p>android.permission.WRITE_SMS//允许应用程序写短信</p>
<p>android.permission.SEND_SMS//允许应用程序发送短信</p>
<p>android.permission.ACCESS_WIFI_STATE//允许应用程序访问Wi-Fi网络状态信息</p>
<p>分析可知，com.mafe.dotars.flaird包申请的权限更多，同样也进行了加固，使用了Bugly android sdk。可执行字符串命令，搜集用户手机IMEI码、电话号码、系统版本号等信息，上传邮箱。重要信息通过短信发送到木马所有人手机上。成功安装被谐音改为程工安装，识别码，行号，手机，系统版本…能看明白吗…</p>
<p><a href="http://www.sec-un.org/wp-content/uploads/2016/05/image059.png" data-lightbox="image_lg"><img title="一个异常体积的安卓恶意代码样本分析 - 第26张  | Sec-UN 安全圈" alt="一个异常体积的安卓恶意代码样本分析 - 第26张  | Sec-UN 安全圈"  class="alignnone size-medium wp-image-4218"  data-src="http://www.sec-un.org/wp-content/uploads/2016/05/image059-300x40.png" width="300" height="40" srcset="https://www.sec-un.org/wp-content/uploads/2016/05/image059-300x40.png 300w, https://www.sec-un.org/wp-content/uploads/2016/05/image059.png 693w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p><strong>五、总结</strong></p>
<p>此样本特点如下：</p>
<p>1.使用加固工具进行加固对抗逆向分析</p>
<p>2.利用腾讯Bugly进行崩溃捕获，达到修复自身代码问题的目的。</p>
<p>3.利用asset目录隐藏恶意代码，掩盖恶意行为</p>
<p>与其他样本比较，比较特别的还是加入了Bugly android sdk。</p>
<p>腾讯Bugly是很方便的crash监控平台，但是从上传的数据包分析， Bugly sdk至少可以提交安装设备的MAC地址，WIFI信息，IMEI等信息（经了解Bugly为保护个人隐私，只提供有限的数据给开发者）。同时恶意代码所有者还可以利用其监控代码感染量。</p>
<p>同时Bugly还可以做内测分发，恶意代码所有者利用平台没有分析恶意行为的特点，可能会进一步进行木马的分发和传播。</p>
<p>1、通过Bugly监控其恶意代码安装情况，获取扩散范围。</p>
<p>2、利用Bugly获知其恶意代码的crash从而进行修正。</p>
<p>3、利用Bugly进行恶意代码的分发和传播。</p>
<p>经与Bugly帅哥沟通得知，其平台内测分发服务也有恶意代码扫描功能，只是还无法完美识别出所有的恶意代码，知识希望Bugly做一些改进，防止被恶意代码利用。</p>
</div>
</div>
 
 										                        <div class="loc_link"><ul><li>本文固定链接: <a href="https://www.sec-un.org/bugly-introduced-the-android-sdk-samples-of-malicious-code-analysis/" rel="bookmark" title="一个异常体积的安卓恶意代码样本分析">https://www.sec-un.org/bugly-introduced-the-android-sdk-samples-of-malicious-code-analysis/</a></li>
                        <li>转载请注明: <a href="https://www.sec-un.org/author/sally_ch/" title="由清风作伴明月为邻发布" rel="author">清风作伴明月为邻</a> <time>2016年05月05日 </time>于 <a href="https://www.sec-un.org/" title="访问Sec-UN 安全圈">Sec-UN 安全圈</a> 发表</li></ul>
                        </div>
                        						                        <div class="author_info">
                        	<div class="au_top_bar"><div class="edit_date">最后编辑：<time>2016-05-05</time></div><b>作者：清风作伴明月为邻</b></div>
                            <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/d2b03d9551a2265acec35b010fa23326?s=96&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/d2b03d9551a2265acec35b010fa23326?s=192&amp;d=mm&amp;r=g 2x' class='avatar avatar-96 photo' height='96' width='96' /></div>
                            <div class="type_out"><span class="ttxx">一个普通的教师</span><div class="au_links"><a href="https://www.sec-un.org?author=703" class="c1"><i class="icon-home"></i> 站内专栏</a></div></div>
                        <div class="cls"></div>
                        </div>
                        					</article>
                    
                    <!-- .entry-content -->

					<!-- .entry-utility -->
				</div><!-- #post-## -->
<div class="c-bot">
            <div class="cls"></div>
    </div>
    <br />
				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="https://www.sec-un.org/threat-intelligence-feed-optimization-needs-may-5-question-answers/" rel="next"><span class="meta-nav"><i class="icon-arrow-left"></i></span> 威胁情报Feed之优化需求(5月5日)：问题答复 </a></div>
					<div class="nav-next"><a href="https://www.sec-un.org/watchmen-threat-intelligence-feed-2016-5-3-home-feed/" rel="prev">守望者威胁情报Feed(2016/5/4)：推出国内版feed  <i class="icon-arrow-right"></i></a></div>
				</div><!-- #nav-below -->
<div class="cls"></div>
				                    <div class="ad_2">
						                    </div>
                                <div class="relatedposts">
<h3 class="widget-title"><i class="icon-warning-sign"></i> 您可能还会对这些文章感兴趣！</h3>
<ul>
		<li><a href="https://www.sec-un.org/threat-information-structured-machine-readable-taxii-standard-sharing/" rel="bookmark" title="详细阅读 威胁情报的“结构化”“可机读”&#8212;TAXII标准的分享">威胁情报的“结构化”“可机读”&#8212;TAXII标准的分享</a></li>
		<li><a href="https://www.sec-un.org/context-aware-context-aware-security-several-points-of-understanding/" rel="bookmark" title="详细阅读 情境感知（Context-Aware-Security）的几点理解">情境感知（Context-Aware-Security）的几点理解</a></li>
		<li><a href="https://www.sec-un.org/threat-information-sharing-attack-against-enterprise-data-sources/" rel="bookmark" title="详细阅读 威胁信息共享－－一起针对企业攻击事件的数据源">威胁信息共享－－一起针对企业攻击事件的数据源</a></li>
		<li><a href="https://www.sec-un.org/next-generation-information-security-information-security-based-on-information-perception-including-interpretation-of-context-aware-security/" rel="bookmark" title="详细阅读 下一代信息安全-基于情报感知的信息安全（内含情景感知安全的解读）">下一代信息安全-基于情报感知的信息安全（内含情景感知安全的解读）</a></li>
		<li><a href="https://www.sec-un.org/on-the-establishment-of-a-security-threat-intelligence-to-advance-the-vision-of-union/" rel="bookmark" title="详细阅读 关于成立一个安全威胁情报推进联盟的构想">关于成立一个安全威胁情报推进联盟的构想</a></li>
		<li><a href="https://www.sec-un.org/united-states-odni-office-of-the-director-of-national-intelligence-reading-series/" rel="bookmark" title="详细阅读 美国ODNI（国家情报总监办公室）系列之情报联盟成员简介">美国ODNI（国家情报总监办公室）系列之情报联盟成员简介</a></li>
		<li><a href="https://www.sec-un.org/technology-is-what-02-article-intelligence-threats-threat-intelligence-behind/" rel="bookmark" title="详细阅读 技术算个啥之02篇——威胁情报（Threat Intelligence）的背后">技术算个啥之02篇——威胁情报（Threat Intelligence）的背后</a></li>
		<li><a href="https://www.sec-un.org/latest-survey-results-on-sans-security-analysis-and-intelligence/" rel="bookmark" title="详细阅读 最新SANS关于安全分析与情报的调研报告">最新SANS关于安全分析与情报的调研报告</a></li>
	</ul>
<div class="cls"></div>
</div>

<div id="comments">
</div><!-- #comments -->
      </div><!-- #content -->
  </div><!-- #container -->
<script type="text/javascript">loading('55%',1000)</script>
    <aside id="primary" class="side" role="complementary">
        <ul class="xoxo">
<li id="frontloginblock-3" class="widget-container widget_login">	 <div class="front_login_box">
            	<div class="from_box">
      <form name="loginform" id="loginform" action="https://www.sec-un.org/wp-login.php" method="post">
            <p class="p1"><span><i class="icon-user icon-2x"></i></span><input onfocus="this.value = '';" name="log" id="user_login" type="text" class="user_name" value="User Name" /></p>
          <p class="p1" style="margin-bottom:30px;"><span><i class="icon-lock icon-2x"></i></span><input onfocus="this.value = '';this.type = 'password';" name="pwd" id="user_pass" type="text" class="password" value="Your Password" /></p>
          <p class="p2"><input name="提交" type="submit" class="submit_button" value="登 录" /></p>
          <p class="p3"><span style="float:right"><i class="icon-signin"></i> <a href="https://www.sec-un.org/wp-login.php?action=register">注册</a></span><span class="keep_me"><label style="display:none;" for="rememberme"><input name="rememberme" type="checkbox" id="rememberme" value="forever"></label><i class="icon-check-empty"></i> 记住我的登录信息</span></p>
          <input type="hidden" name="redirect_to" value="https://www.sec-un.org/bugly-introduced-the-android-sdk-samples-of-malicious-code-analysis/">
          </form>
        </div>
        <script type="text/javascript">
		jQuery(function($){
			$('.keep_me').click(function(){
				var nowSet = $(this).find('i').attr('class');
				if(nowSet == "icon-check-empty"){
					$(this).find('i').attr('class','icon-check');
					$(this).find('#rememberme').attr('checked','')
				}else{
					$(this).find('i').attr('class','icon-check-empty');
					$(this).find('#rememberme').removeAttr('checked')
				}
			})
		});
        </script>
            </div>
     </li><li id="cp_pointswidget-3" class="widget-container widget_cp_pointswidget"><h3 class="widget-title">我的积分</h3>				<ul>
						<li>您需要先登录才能查看您的积分。.</li>
										</ul>
			</li><li id="cp_topuserswidget-5" class="widget-container widget_cp_topuserswidget"><h3 class="widget-title">Rank排行榜</h3><ul><li class="cp_topUsersWidget top_1" style="list-style:none;">迷路的指南针 (Rank1145)</li><li class="cp_topUsersWidget top_2" style="list-style:none;">DJ (Rank841)</li><li class="cp_topUsersWidget top_3" style="list-style:none;">NUKE (Rank814)</li><li class="cp_topUsersWidget top_4" style="list-style:none;">孙维 (Rank485)</li><li class="cp_topUsersWidget top_5" style="list-style:none;">consen (Rank415)</li><li class="cp_topUsersWidget top_6" style="list-style:none;">crackershi (Rank280)</li><li class="cp_topUsersWidget top_7" style="list-style:none;">lzy (Rank276)</li><li class="cp_topUsersWidget top_8" style="list-style:none;">ThreatActor (Rank265)</li><li class="cp_topUsersWidget top_9" style="list-style:none;">archer (Rank255)</li><li class="cp_topUsersWidget top_10" style="list-style:none;">驭龙 (Rank240)</li><li class="cp_topUsersWidget top_11" style="list-style:none;">zhuyue (Rank235)</li><li class="cp_topUsersWidget top_12" style="list-style:none;">辛巴达(Sinbad) (Rank225)</li><li class="cp_topUsersWidget top_13" style="list-style:none;">SHIELD (Rank215)</li><li class="cp_topUsersWidget top_14" style="list-style:none;">zsfnotes (Rank213)</li><li class="cp_topUsersWidget top_15" style="list-style:none;">Bruce_Zhang (Rank185)</li><li class="cp_topUsersWidget top_16" style="list-style:none;">Anonymous (Rank170)</li><li class="cp_topUsersWidget top_17" style="list-style:none;">Piz0n (Rank165)</li><li class="cp_topUsersWidget top_18" style="list-style:none;">coolweis (Rank155)</li><li class="cp_topUsersWidget top_19" style="list-style:none;">bennyye (Rank150)</li><li class="cp_topUsersWidget top_20" style="list-style:none;">linzhi (Rank145)</li><li class="cp_topUsersWidget top_21" style="list-style:none;">kris (Rank125)</li><li class="cp_topUsersWidget top_22" style="list-style:none;">清风作伴明月为邻 (Rank125)</li><li class="cp_topUsersWidget top_23" style="list-style:none;">chenji123456 (Rank85)</li><li class="cp_topUsersWidget top_24" style="list-style:none;">rapido (Rank80)</li><li class="cp_topUsersWidget top_25" style="list-style:none;">heitian (Rank75)</li><li class="cp_topUsersWidget top_26" style="list-style:none;">ChrisChen世雄 (Rank75)</li><li class="cp_topUsersWidget top_27" style="list-style:none;">killer (Rank50)</li><li class="cp_topUsersWidget top_28" style="list-style:none;">mad (Rank50)</li><li class="cp_topUsersWidget top_29" style="list-style:none;">CoolICE (Rank50)</li><li class="cp_topUsersWidget top_30" style="list-style:none;">淡水鱼 (Rank50)</li></ul></li>        </ul>
    </aside><!-- #primary .widget-area -->

<script type="text/javascript">loading('78%',1000)</script>
<div class="cls"></div>
</section><!-- #main -->
<div class="cls"></div>
	<footer id="footer" role="contentinfo">
		<div id="colophon">

<div id="site-info">
<a href="javascript:void(0)" onClick="goRoll(0)" id="goTop">返回顶部</a> <a href="https://www.sec-un.org/sitemap.html">网站地图</a> &nbsp; <a href="http://www.miitbeian.gov.cn/" rel="external nofollow">京ICP备15036950号-1</a> <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?0ef96af0d6646bc4db46b410e4f2e212";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script> ©2017 Sec-UN All Rights Reserved | Theme <span id='official'>frontopen2</span></div>
		</div>	</footer></div><script type='text/javascript' src='https://www.sec-un.org/wp-includes/js/comment-reply.min.js?ver=d2207c9bc2f8d7af72d793379f207c99'></script>
<script type='text/javascript' src='https://www.sec-un.org/wp-includes/js/wp-embed.min.js?ver=d2207c9bc2f8d7af72d793379f207c99'></script>
<div id="float"><a id="float_gotop" class="floatbtn"  href="javascript:void()" onClick="goRoll(0)" title="返回顶部"></a><a class="linbak floatbtn" href="https://www.sec-un.org/wp-admin/" title="登陆&注册"></a><a id="float_goend" class="floatbtn" href="javascript:void()" onClick="goend()" title="转到底部"></a></div>
</body>
</html><script type="text/javascript">loading('100%',1000)</script>
