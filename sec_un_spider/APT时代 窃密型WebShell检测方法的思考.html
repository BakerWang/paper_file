<!DOCTYPE HTML>
<html>
<head>
<meta name="viewport" content="width=device-width , initial-scale=1.0 , user-scalable=0 , minimum-scale=1.0 , maximum-scale=1.0" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>APT时代-窃密型WebShell检测方法的思考 | Sec-UN 安全圈</title>
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="pingback" href="https://www.sec-un.org/xmlrpc.php" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Sec-UN 安全圈 &raquo; Feed" href="https://www.sec-un.org/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sec-UN 安全圈 &raquo; 评论Feed" href="https://www.sec-un.org/comments/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.sec-un.org\/wp-includes\/js\/wp-emoji-release.min.js?ver=d2207c9bc2f8d7af72d793379f207c99"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,56826,8203,55356,56819),0,0),c=j.toDataURL(),b===c&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55358,56794,8205,9794,65039),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55358,56794,8203,9794,65039),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='jQuery_notice-css'  href='https://www.sec-un.org/wp-content/plugins/cubepoints/modules/notice/jquery.notice.css?ver=d2207c9bc2f8d7af72d793379f207c99' type='text/css' media='all' />
<link rel='stylesheet' id='cptch_stylesheet-css'  href='https://www.sec-un.org/wp-content/plugins/captcha/css/front_end_style.css?ver=4.3.5' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://www.sec-un.org/wp-includes/css/dashicons.min.css?ver=d2207c9bc2f8d7af72d793379f207c99' type='text/css' media='all' />
<link rel='stylesheet' id='cptch_desktop_style-css'  href='https://www.sec-un.org/wp-content/plugins/captcha/css/desktop_style.css?ver=4.3.5' type='text/css' media='all' />
<script type='text/javascript' src='https://www.sec-un.org/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='https://www.sec-un.org/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript' src='https://www.sec-un.org/wp-content/plugins/cubepoints/modules/notice/jquery.notice.js?ver=1.0.1'></script>
<link rel='prev' title='对预测未知威胁的要求 – 摘自美国2013年国防预算法案' href='https://www.sec-un.org/detect-unknown-threats-2013-national-defense-authorization-act/' />
<link rel='next' title='WebRAY理念谈：“威胁情报与情景感知”' href='https://www.sec-un.org/webray-on-threat-information-and-context-awareness/' />
<link rel="canonical" href="https://www.sec-un.org/ideas-like-article-espionage-webshell-method/" />
<script type="text/javascript">
(function(url){
	if(/(?:Chrome\/26\.0\.1410\.63 Safari\/537\.31|WordfenceTestMonBot)/.test(navigator.userAgent)){ return; }
	var addEvent = function(evt, handler) {
		if (window.addEventListener) {
			document.addEventListener(evt, handler, false);
		} else if (window.attachEvent) {
			document.attachEvent('on' + evt, handler);
		}
	};
	var removeEvent = function(evt, handler) {
		if (window.removeEventListener) {
			document.removeEventListener(evt, handler, false);
		} else if (window.detachEvent) {
			document.detachEvent('on' + evt, handler);
		}
	};
	var evts = 'contextmenu dblclick drag dragend dragenter dragleave dragover dragstart drop keydown keypress keyup mousedown mousemove mouseout mouseover mouseup mousewheel scroll'.split(' ');
	var logHuman = function() {
		var wfscr = document.createElement('script');
		wfscr.type = 'text/javascript';
		wfscr.async = true;
		wfscr.src = url + '&r=' + Math.random();
		(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(wfscr);
		for (var i = 0; i < evts.length; i++) {
			removeEvent(evts[i], logHuman);
		}
	};
	for (var i = 0; i < evts.length; i++) {
		addEvent(evts[i], logHuman);
	}
})('//www.sec-un.org/?wordfence_logHuman=1&hid=54DA8F06F392F5B4CAFBFB61C7107BE4');
</script><meta name="description" content="前段时间由于项目的需要也因为正在负责一个后门检测小工具的项目开发所以恶补了一下Webshell检测技术内容，一路天马行空写下此文和大家分享。小弟才疏学浅如有内容上的问题还请不吝指正。  	 	 		窃密型WebShell检测方法 	 	 		1.前言 	 	 		近年来网站被植入后门等隐蔽性攻击呈逐年增长态势，国家互联网应急中心发布的《2013年我国互联网网络安全态势综述》称2013年国家互联网应急中心共监测发现我国境内6.1万个网站通">
<script type="text/javascript">(function(){mod_txt = '#'; adminBar = "" || 0})();</script>
<script type="text/javascript" src="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/frontopen.js?ver=1.5.04.15"></script>
<script type="text/javascript" src="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/include/lightbox-2.6.min.js"></script>
<link href="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/lightbox.css" rel="stylesheet" type="text/css" />

<link rel="stylesheet" type="text/css" media="all" href="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/style.css?ver=1.5.04.15" />
<link rel="stylesheet" type="text/css" media="all" href="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/mobile.css?ver=1.5.04.15" />
<style type="text/css">@media screen and (min-width:1366px){.c-con{height:140px;}}
a:hover , .header .logo i , .tit .h1 a , .tit .iititle2 span a:hover , .entry-content a , .entry-title , .mbx a:hover , .commentlist .comment-body a , .top_post .ulist a:hover , .gonggao a , .loc_link a , .tit .iititle a:hover{color:#000000}.nav .tig .rrs , #wp-calendar td a:hover , .jz_bt , .loading , .subbtn .btn , .post_pic_box:hover , .title_hot , .top_bar , .car-toggler , .but_down a , .page-link a span , .page-link .t_s_s , .page_num a , .nav-next a{background:#000000;}.j_zeng , .jz_bt:hover , .f_links li{border-color:#000000}.navcon ul li a:hover, .navcurrent{color:#4EA4EF;}</style>

<!--[if lt IE 9]><script src="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/html5.js"></script><![endif]-->
<link rel="stylesheet" href="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/css/font-awesome.min.css?ver=1.5.04.15">
<!--[if IE 7]>
<link rel="stylesheet" href="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/css/font-awesome-ie7.min.css?ver=1.5.04.15">
<![endif]-->
</head>

<body class="post-template-default single single-post postid-2000 single-format-standard">
<div class="loading"></div>
<div class="web_bod">
<header class="header marauto">
    <span class="logo">
        <a href="https://www.sec-un.org/" title="Sec-UN 安全圈" rel="home"><img src="https://www.sec-un.org/wp-content/uploads/2014/09/logo2x-300x74.png" alt="Sec-UN 安全圈" /></a>
        <i></i>
    </span>
    <form role="search" method="get" id="searchform" action="https://www.sec-un.org/">
      <span class="search">
        <input name="s" id="s" type="text"  class="input" value="" onclick="this.value = '';" style="color:#999" onkeypress="javascript:if(event.keyCode == 13){query(this.value);}" x-webkit-speech=""/>
        <button id="searchsubmit" class="btn">搜索</button>
      </span>
    </form>
    <div class="cls"></div>
</header>


<nav class="navcon marauto">
  <div id="mobile_nav_btn">网站导航</div>
  <div class="menu-header"><ul id="menu-%e5%af%bc%e8%88%aa" class="menu"><li id="menu-item-18" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-18"><a href="http://www.sec-un.org">首页</a></li>
<li id="menu-item-23" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-23"><a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e8%b5%84%e8%ae%af/">安全资讯</a></li>
<li id="menu-item-19" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-19"><a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e6%b2%bb%e7%90%86/">安全治理</a></li>
<li id="menu-item-20" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-20"><a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e6%96%b9%e6%a1%88/">安全方案</a></li>
<li id="menu-item-21" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-21"><a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e6%8a%80%e6%9c%af/">安全技术</a></li>
<li id="menu-item-22" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-22"><a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e4%ba%ba%e6%89%8d/">安全人才</a></li>
<li id="menu-item-27" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-27"><a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e4%bb%bb%e5%8a%a1/">安全任务</a></li>
<li id="menu-item-1027" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1027"><a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e5%a8%81%e8%83%81%e6%83%85%e6%8a%a5/">安全威胁情报</a></li>
<li id="menu-item-1764" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1764"><a href="https://www.sec-un.org/category/%e4%bf%a1%e6%81%af%e9%80%9f%e9%80%92/">信息速递</a></li>
<li id="menu-item-77" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-77"><a href="http://www.sec-un.org/wp-admin/post-new.php">我要投稿</a></li>
<li id="menu-item-75" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-75"><a href="https://www.sec-un.org/category/%e7%bd%91%e7%ab%99%e5%85%ac%e5%91%8a/">网站公告</a></li>
</ul></div>  
  </nav>   
  <section class="conter marauto"><script type="text/javascript">loading('33%',1000)</script>
  <div id="container">
      <div id="content" role="main" style="width:96%">
      <div class="mbx"><i class="icon-home icon-large" style="font-size:14px;"></i>
<a href="https://www.sec-un.org"  class="gray">首页</a>  >  <a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e6%8a%80%e6%9c%af/">安全技术</a>  >  <a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e6%8a%80%e6%9c%af/%e6%94%bb%e9%98%b2%e6%8a%80%e6%9c%af/">攻防技术</a>  >  APT时代-窃密型WebShell检测方法的思考</div>

				<div id="post-2000" class="post-2000 post type-post status-publish format-standard hentry category-23">
                <div class="c-top2" id="post-55">
                <div class="datetime">2015<br />06-11</div>
					<header class="tit"><h1 class="entry-title">APT时代-窃密型WebShell检测方法的思考</h1>
					<aside class="entry-meta iititle2">
                        <span><i class="icon-user icon-large"></i> <a href="https://www.sec-un.org/author/lostcompass/" title="由迷路的指南针发布" rel="author">迷路的指南针</a></span><span><i class="icon-folder-open icon-large"></i> <a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e6%8a%80%e6%9c%af/%e6%94%bb%e9%98%b2%e6%8a%80%e6%9c%af/" rel="category tag">攻防技术</a></span><span><i class="icon-eye-open icon-large"></i> 围观<i id="number">3364</i><script type="text/javascript">jQuery(function($){$.get("https://www.sec-un.org/fo_ajax?ajax=getPostViews&postID=2000",function(data){if(data.length < 10)$('#number').text(data)});})</script>次</span><span><i class="icon-comment-alt icon-large"></i> <a href="https://www.sec-un.org/ideas-like-article-espionage-webshell-method/#comments">4 条评论</a></span><span><i class="icon-pencil icon-large"></i> 编辑日期：<time>2015-06-11</time></span><span><i class="icon-zoom-in icon-large"></i> 字体：<a href="javascript:;" onclick="checkFontSize(18)">大</a> <a href="javascript:;" onclick="checkFontSize(16)">中</a> <a href="javascript:;" onclick="checkFontSize(14)">小</a></span>					</aside>
                    </header>
                    <div class="cls"></div>
		    </div>
                    <!-- .entry-meta -->

					<article class="entry-content">
                    
						<blockquote>
<p>
		<span style="font-size:14px;">前段时间由于项目的需要也因为正在负责一个后门检测小工具的项目开发所以恶补了一下Webshell检测技术内容，一路天马行空写下此文和大家分享。小弟才疏学浅如有内容上的问题还请不吝指正。</span>
	</p>
<h1 align="center">
		<span style="font-size:14px;"><strong><span style="font-size:32px;">窃密型WebShell检测方法</span></strong></span><br />
	</h1>
<h1>
		<span style="font-size:24px;font-family:SimHei;">1.前言</span><br />
	</h1>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">近年来网站被植入后门等隐蔽性攻击呈逐年增长态势，国家互联网应急中心发布的《<span>2013</span>年我国互联网网络安全态势综述》称<span>2013</span>年国家互联网应急中心共监测发现我国境内<span>6.1</span>万个网站通过境外被植入后门，较<span>2012</span>年增长<span>62.1%</span>。黑客在利用<span>WEB</span>应用漏洞攻击成功后，通常会利用植入Webshell后门实现对应用系统篡改、对操作系统控制以及对数据库中敏感数据的窃取。攻击者通过浏览器或者控制端与被<span><span style="color:windowtext;text-decoration:none;"><span>控制</span></span></span>的<span>WEB</span>应用系统之间通过开启的合法端口交换数据<span>,</span>隐蔽性很高，传统<span><span style="color:windowtext;text-decoration:none;"><span>防火墙</span></span></span>无法进行拦截，并且一般在<span><span style="color:windowtext;text-decoration:none;"><span>系统日志</span></span></span>中无操作记录。<span></span></span>
	</p>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">针<br />
对Webshell后门的检测方法一般是静态特征属性的检测方式，此类方式一般可查杀常见的破坏型后门，但在巨大的经济利益诱惑下，以窃取网站内敏感信息<br />
为目的的窃密型后门越来越多。此类后门往往采用特殊的变型方式与业务相融合，传统方法难以检测，本文针对窃密型后门进行了研究分析，通过研究多种窃密型后<br />
门的特点及原理，提出了一种全新的检测方法，丰富了窃密型脚本后门的检测手段，并就相关核心问题进行了分析和阐述。</span>
	</p>
<h1>
		<span style="font-size:24px;">2.Webshell后门</span><br />
	</h1>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">随着信息化的不断发展，信息系统所承载的不仅仅是新闻发布、内容展示等传统功能，同时还承担了信息查询、订单处理、事务管理等业务，其中往往涉及一些需要保密的信息，窃密型<span>web</span>应用脚本后门应运而生，其以窃密为主要目的，获取系统保密信息，危害极大。<span></span></span>
	</p>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">“<span>Web</span>”的含义是需要服务器开放<span>web</span>服务，“<span>shell</span>”的含义是取得对服务器某种程度上的操作权限<span>,</span>常常被称为匿名用户（入侵者）通过网站端口对网站服务器的某种程度的操作权限。由于<span>Webshell</span>大多是以动态脚本的形式出现，也有人称之为网站后门工具或者<span>WEB</span>应用脚本后门。但由于此类后门往往与系统契合度较高，利用了系统部分功能模块以实现以假乱真、长期潜伏的目的。该类后门往往不具备文件操作、命令执行等常见木马功能，多数只具备查询数据库功能，可直接调用系统自身的存储过程来连接数据库，与系统契合度高。</span>
	</p>
<h1>
		<span style="font-size:24px;">3.Webshell后门检测</span><br />
	</h1>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">目前针对<span>Webshell</span>的特征检测一般是通过特征比对及文件属性异常的静态检测和基于访问情况、行为模式特征的动态检测方式进行查杀，由于窃密型<span>Webshell</span>通常会伪装成正常的<span>WEB</span>脚本文件，静态特征检测及动态行为检测都无法有效的针对此类后门进行检测。</span>
	</p>
<h1>
		<span style="font-size:24px;">4.传统及现有的检测方法</span><br />
	</h1>
<blockquote>
<h2>
			<span style="font-size:18px;">4.1静态检测</span><br />
		</h2>
</blockquote>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">静态特征检测是指对脚本文件中所使用的关键词、高危函数、文件修改的时间、文件权限、文件的所有者以及和其它文件的关联性等多个维度的特征进行检测，即先建立一个恶意字符串特征库，例如：“组专用大马<span>|</span>提权<span>|</span>木马<span>|PHP\s?</span>反弹提权<span>cmd</span>执行<span>”</span>，“<span>WScript.Shell</span>、<span>Shell.Application</span>、<span>Eval()</span>、<span>Excute()</span>、<span>Set Server</span>、<span>Run()</span>、<span>Exec()</span>、<span>ShellExcute()</span>”，同时对<span>WEB</span>文件修改时间，文件权限以及文件所有者等进行确认。通常情况下<span>WEB</span>文件不会包含上述特征或者特征异常，通过与特征库的比对检索出高危脚本文件。<span></span></span>
	</p>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">该检测方法的优点：可快速检测，快速定位；<span></span></span>
	</p>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">缺点：容易误报，无法对加密或者经过特殊处理的<span>Webshell</span>文件进行检测。尤其是针对窃密型<span>Webshell</span>无法做到准确的检测，因为窃密型<span>Webshell</span>通常具有和正常的<span>WEB</span>脚本文件具有相似的特征。</span>
	</p>
<blockquote>
<h2>
			<span style="font-size:18px;">4.2动态检测</span><br />
		</h2>
</blockquote>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">动态特征检测通过<span>Webshell</span>运行时使用的系统命令或者网络流量及状态的异常来判断<span>动作</span>的威胁程度，<span>Webshell</span>通常会被加密从而避免静态特征的检测，当<span>Webshell</span>运行时就必须向系统发送系统命令来达到控制系统或者操作数据库的目的，通过检测系统调用来监测甚至拦截系统命令被执行，从行为模式上深度检测脚本文件的安全性。<span></span></span>
	</p>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">优点：可用于网站集群，对新型变种脚本有一定的检测能力。<span></span></span>
	</p>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">缺点：针对特定用途的后门较难检测<span>,</span>实施难度较大。</span>
	</p>
<blockquote>
<h2>
			<span style="font-size:18px;">4.3日志分析</span><br />
		</h2>
</blockquote>
<p class="MsoNormal" style="text-indent:24.0pt;">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;color:black;background:white;">使用<span>Webshell</span>一般不会在系统日志中留下记录，但是会在网站的<span>web</span>日志中留下<span>Webshell</span>页面的访问数据和数据提交记录。日志分析检测技术通过大量的日志文件建立请求模型从而检测出异常文件，</span><span style="font-size:12.0pt;line-height:150%;font-family:宋体;">称之为：<span>HTTP</span>异常请求模型检测。例如：一个平时是<span>GET</span>的请求突然有了<span>POST</span>请求并且返回代码为<span>200</span>、某个页面的访问者<span>IP</span>、访问时间具有规律性等。</span><span style="font-size:12.0pt;line-height:150%;font-family:宋体;color:black;background:white;"></span>
	</p>
<p class="MsoNormal" style="text-indent:24.0pt;">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;color:black;background:white;">优点：采用了一定数据分析的方式，网站的访问量达到一定量级时这种检测方法的结果具有较大参考价值。<span></span></span>
	</p>
<p class="MsoNormal" style="text-indent:24.0pt;">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;color:black;background:white;">缺点：存在一定误报，对于大量的访问日志，检测工具的处理能力和效率会比较低。</span>
	</p>
<blockquote>
<h2>
			<span style="font-size:18px;">4.4统计学</span><br />
		</h2>
</blockquote>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">在<span>Webshell</span>后门检测中被使用较为广泛的一种方法是统计学方法，<span>NeoPi</span>是国外流行的一个基于统计学的<span>Webshell后门</span>检测工具，它使用五种计学方法在脚本文件中搜索潜在的被混淆或被编码的恶意代码。<span></span></span>
	</p>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">NeoPi</span><span style="font-size:12.0pt;line-height:150%;font-family:宋体;">使用以下五种检测方法：<span></span></span>
	</p>
<p class="MsoNormal" style="margin-left:24.0pt;text-align:left;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">1</span><span style="font-size:12.0pt;line-height:150%;font-family:宋体;">、信息熵<span>(Entropy):</span>通过使用<span>ASCII</span>码表来衡量文件的不确定性；<span></span></span>
	</p>
<p class="MsoNormal" style="margin-left:24.0pt;text-align:left;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">2</span><span style="font-size:12.0pt;line-height:150%;font-family:宋体;">、最长单词<span>(Longest<br />
Word):</span>最长的字符串也许潜在的被编码或被混淆；<span></span></span>
	</p>
<p class="MsoNormal" style="margin-left:24.0pt;text-align:left;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">3</span><span style="font-size:12.0pt;line-height:150%;font-family:宋体;">、重合指数<span>(Index<br />
of Coincidence):</span>低重合指数预示文件代码潜在的被加密或被混效过；<span></span></span>
	</p>
<p class="MsoNormal" style="margin-left:24.0pt;text-align:left;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">4</span><span style="font-size:12.0pt;line-height:150%;font-family:宋体;">、特征<span>(Signature):</span>在文件中搜索已知的恶意代码字符串片段；<span></span></span>
	</p>
<p class="MsoNormal" style="margin-left:24.0pt;text-align:left;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">5</span><span style="font-size:12.0pt;line-height:150%;font-family:宋体;">、压缩<span>(Compression):</span>对比文件的压缩比。<span></span></span>
	</p>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">采用这种检测方法也存在明显的弱点，<span>NeoPi</span>的检测重心在于识别混淆代码，它常常在识别模糊代码或者混淆编排的木马方面表现良好。未经模糊处理的代码对于<span>NeoPi</span>的检测机制较为透明。如果代码整合于系统中的其它脚本之上，这种“正常”的文件极可能无法被<span>NeoPi</span>识别出来。</span>
	</p>
<h1>
		<span style="font-size:24px;">5.传统检测方法的缺陷</span><br />
	</h1>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">现有技术是针对普通的脚本后门、以控制服务器为目的、通常包含较为明显的静态特征或者行为模式，不能对窃密型后门进行有效检测。<span></span></span>
	</p>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">由于业务系统更新频繁，<span>WEB</span>脚<br />
本文件相关的属性经常发生变化所以偏重于文件属性检测的方法往往会产生更多的误报，基于动态行为检测的方法往往技术难度较大，难以实现，而且对系统造成的<br />
性能影响较大，甚至可能对系统稳定性造成影响，基于日志的检测方法，一方面，由于业务功能较多且复杂，部分功能可能很少会被用到，其日志访问可能会命中某<br />
些检测规则从而造成更多的误报，另一方面，大量的日志记录处理起来会对服务器性能产生负担、而且由于日志量巨大检测过程消耗时间长，检测速度较慢。而窃密<br />
型<span>Webshell</span>后门往往会模拟正常的数据库操作、不具有较为明显静态特殊属性、被访问的次数比较少无法形成较为明显的访问特征，通过日志分析也很难发现。</span>
	</p>
<h1>
		<span style="font-size:24px;">6.窃密型Webshell后门检测方法设计</span><br />
	</h1>
<blockquote>
<h2>
			<span style="font-size:18px;">6.1检测方法</span><br />
		</h2>
<blockquote>
<h3>
				<span style="font-size:16px;">6.1.1基于数据库操作审计的检测方式</span><br />
			</h3>
</blockquote>
</blockquote>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">针对窃密型<span>Webshell</span>必须具有操作数据库的能力，可以引申出一种新的检测方法，通过分析正常<span>WEB</span>脚本文件和窃密型<span>Webshell</span>对数据库操作的差异进行分析是本检测方法所重点研究的方向。<span></span></span>
	</p>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">正常情况下<span>WEB</span>站点进行数据操作的过程应该是重复性且较为复杂的查询过程，这种查询通常精确度非常高，查询过程不会出现类似于“<span>select * from</span>”这种查询语句。正常的<span>WEB</span>脚本在进行数据库操作的过程中也不会出现跨越数据库查询的情况，一旦出现这种现象基本可以判断为非正常的<span>WEB</span>脚本操作过程。<span></span></span>
	</p>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">就以上思路设计如下的检测方案：<span></span></span>
	</p>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">审计数据操作记录。通过审计数据库操作记录可以单独的为每一个<span>WEB</span>站点甚至<span>WEB</span>站点中的每一个脚步文件建立查询请求模型，通过几天甚至数月的自我学习过程来学习并维护一份查询请求数据库。该数据库的内容包含了每次查询操作的详细信息、请求归类和分析结果。并且建立动态查询请求规则，<span>Agent</span>一旦检测到违反该规则的查询请求后会向<span>Server</span>端传递相关信息，<span>Server</span>端再结合其它的扫描过程综合判断发起请求的文件是否为Webshell，并最终决定是否向管理员报警。<span></span></span>
	</p>
<blockquote>
<blockquote>
<h3>
				<span style="font-size:16px;">6.1.2建立机器学习日志分析系统</span><br />
			</h3>
</blockquote>
</blockquote>
<p class="MsoNormal" style="text-indent:24.0pt;">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">由于数据库操作记录日志量非常大，使用人工的方法难以进行精确筛选和审计。所以需要建立一套机器自学习的日志审计系统。该日志审计系统主要基于查询模型白名单学习与数学统计模型这两方面进行设计。</span><span></span>
	</p>
<ul>
<li>
			<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">查询模型白名单学习系统：<span></span></span>
		</li>
</ul>
<p class="MsoNormal" style="margin-left:21.55pt;text-indent:24.0pt;">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">在一个网站系统中，由于系统业务逻辑相对固定，执行的数据库查询语句可以归类并且是可预测的，基于这些事实可以建立一套自学习系统，在无人值守的状态下进行无监督的机器学习。在对日志进行泛化处理之后，根据特征<span>(</span>包括时间，查询语句，参数等<span>)</span>建立<span>N</span>维的特征向量。使用<span>k-</span>均值聚类算法对日志进行初步分组。其中对参数的处理使用局部加权线性回归算法预测参数类型。对聚类后的数据进行抽样，使用贝叶斯决策树进行抽样结果的机器决策。<span></span></span>
	</p>
<ul>
<li>
			<span style="font-family:Wingdings;"><span><span>&nbsp;</span></span></span><span style="font-size:12.0pt;line-height:150%;font-family:宋体;">数学统计模型系统：</span><span></span>
		</li>
</ul>
<p class="MsoNormal" style="margin-left:21.55pt;text-indent:24.0pt;">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">由于窃密型<span>web</span>应<br />
用脚本后门只服务于入侵者，所执行的查询语句也是超出业务系统正常使用逻辑的，在一个有一定访问量级的业务系统中，窃密使用的查询语句是执行量最少的。对<br />
业务系统数据库的日志进行参数归一化处理后，正常应用中的查询语句与窃密使用的语句从数量上来看一定有数量级的差距。可以建立查询语句的统计模型，也可以<br />
对窃密型<span>Webshell</span>行为进行审计。</span>
	</p>
<blockquote>
<h2>
			<span style="font-size:18px;">6.2检测系统设计</span><br />
		</h2>
</blockquote>
<p class="MsoNormal" style="text-align:left;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">该方法有两种实现过程：<span></span></span>
	</p>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">一种是直接在数据库服务器上增加日志审计客户端，可以实时的审计数据库操作记录。</span>
	</p>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">优点是审计全面并且处于攻击后方被人为破坏几率较小；</span>
	</p>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">缺点是数据库在开启较多的日志记录的情况下会造成严重的性能负担。</span>
	</p>
<p class="MsoNormal" style="text-align:center;">
		&nbsp; <img title="APT时代-窃密型WebShell检测方法的思考 - 第1张  | Sec-UN 安全圈" alt="APT时代-窃密型WebShell检测方法的思考 - 第1张  | Sec-UN 安全圈" src="http://www.sec-un.org/wp-content/uploads/2015/06/20150611100032_16449.png" alt="" /><span style="font-family:宋体;"><br />
</span>
	</p>
<p class="MsoNormal" style="text-align:center;">
		<span style="font-family:宋体;">图<span>1</span>：审计型<span>Agent</span></span>
	</p>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">另外一种实现是方法是在<span>WEB</span>服务器上部署代理型<span>Agent</span>，代理型<span>Agent</span>可以代理所有的数据库操作过程，精确的检索出异常操作，并且较审计型检测速度快。代理型<span>Agent</span>可以经过优化后与中间件进行深度结合能够追踪到发起数据查询请求的具体脚本文件。</span>
	</p>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">优点是检测速度快，精准度高，可以查询到发起查询操作的具体的脚本文件；</span>
	</p>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">缺点是：位于前端<span>WEB</span>服务器上被破坏的可能性较大。学习过程时间稍长。<span></span></span>
	</p>
<div align="center">
<p align="center">
			<span style="font-size:12.0pt;line-height:150%;font-family:宋体;"></span><img title="APT时代-窃密型WebShell检测方法的思考 - 第2张  | Sec-UN 安全圈" alt="APT时代-窃密型WebShell检测方法的思考 - 第2张  | Sec-UN 安全圈" src="http://www.sec-un.org/wp-content/uploads/2015/06/20150611100317_69629.png" alt="" /><span style="font-family:宋体;"><br />
</span>
		</p>
<p>
			<span style="font-family:宋体;">图<span>2</span>：代理型<span>Agent</span></span>
		</p>
<p>
			<br />
<span style="font-family:宋体;"></span>
		</p>
<p>
			
		</p>
<p>
			
		</p>
</p></div>
<h1>
		<span style="font-size:24px;">7.总结</span><br />
	</h1>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;"><span></span></span>
	</p>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;"><span></span></span>
	</p>
<p class="MsoNormal" style="text-indent:24.0pt;">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;color:black;background:white;"><span></span></span>
	</p>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;">只依靠一种检测方法也是很难以进行全面检测的。在真实的环境中进行部署检测系统时需要同步的部署传统检测方法的系统，来达到互补和增强检测结果可行度的目的。<span></span></span>
	</p>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;"><span></span></span>
	</p>
<p>
		
	</p>
<p>
		
	</p>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;"><span></span></span>
	</p>
<p>
		
	</p>
<p>
		
	</p>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;"><span></span></span>
	</p>
<p>
		
	</p>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;"><span></span></span>
	</p>
<p class="MsoNormal" style="text-align:left;text-indent:24.0pt;" align="left">
		<span style="font-size:12.0pt;line-height:150%;font-family:宋体;"><span></span></span>
	</p>
</blockquote>
 
 										                        <div class="loc_link"><ul><li>本文固定链接: <a href="https://www.sec-un.org/ideas-like-article-espionage-webshell-method/" rel="bookmark" title="APT时代-窃密型WebShell检测方法的思考">https://www.sec-un.org/ideas-like-article-espionage-webshell-method/</a></li>
                        <li>转载请注明: <a href="https://www.sec-un.org/author/lostcompass/" title="由迷路的指南针发布" rel="author">迷路的指南针</a> <time>2015年06月11日 </time>于 <a href="https://www.sec-un.org/" title="访问Sec-UN 安全圈">Sec-UN 安全圈</a> 发表</li></ul>
                        </div>
                        						                        <div class="author_info">
                        	<div class="au_top_bar"><div class="edit_date">最后编辑：<time>2015-06-11</time></div><b>作者：迷路的指南针</b></div>
                            <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/ad95e3c008fe241ec9684eac8c53d270?s=96&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ad95e3c008fe241ec9684eac8c53d270?s=192&amp;d=mm&amp;r=g 2x' class='avatar avatar-96 photo' height='96' width='96' /></div>
                            <div class="type_out"><span class="ttxx">这个作者貌似有点懒，什么都没有留下。</span><div class="au_links"><a href="https://www.sec-un.org?author=540" class="c1"><i class="icon-home"></i> 站内专栏</a></div></div>
                        <div class="cls"></div>
                        </div>
                        					</article>
                    
                    <!-- .entry-content -->

					<!-- .entry-utility -->
				</div><!-- #post-## -->
<div class="c-bot">
            <div class="cls"></div>
    </div>
    <br />
				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="https://www.sec-un.org/webray-on-threat-information-and-context-awareness/" rel="next"><span class="meta-nav"><i class="icon-arrow-left"></i></span> WebRAY理念谈：“威胁情报与情景感知” </a></div>
					<div class="nav-next"><a href="https://www.sec-un.org/detect-unknown-threats-2013-national-defense-authorization-act/" rel="prev">对预测未知威胁的要求 – 摘自美国2013年国防预算法案  <i class="icon-arrow-right"></i></a></div>
				</div><!-- #nav-below -->
<div class="cls"></div>
				                    <div class="ad_2">
						                    </div>
                                <div class="relatedposts">
<h3 class="widget-title"><i class="icon-warning-sign"></i> 您可能还会对这些文章感兴趣！</h3>
<ul>
		<li><a href="https://www.sec-un.org/offensive-and-defensive-are-basic-requirements-for-safety-for-the-unknown-attack-knows-anti-is-a-false-dichotomy-of-different-views/" rel="bookmark" title="详细阅读 攻防兼备-是安全的基本要求 &#8212; 对《“未知攻 焉知防”是伪命题》的不同看法">攻防兼备-是安全的基本要求 &#8212; 对《“未知攻 焉知防”是伪命题》的不同看法</a></li>
		<li><a href="https://www.sec-un.org/webshell-security-testing-1-based-traffic-detection/" rel="bookmark" title="详细阅读 Webshell安全检测篇（1）-基于流量的检测方式">Webshell安全检测篇（1）-基于流量的检测方式</a></li>
		<li><a href="https://www.sec-un.org/recently-tried-prism-united-states-prism-2013-budget-establishment-and-work-tasks/" rel="bookmark" title="详细阅读 最近棱镜门爆料-美国棱镜系统2013年预算、编制及工作任务">最近棱镜门爆料-美国棱镜系统2013年预算、编制及工作任务</a></li>
		<li><a href="https://www.sec-un.org/technology-is-what-01-apt-not-attacking-technology-is-the-attacking-mentality-and-mode/" rel="bookmark" title="详细阅读 技术算个啥之01篇——APT不是攻击技术，是攻击的心态和模式">技术算个啥之01篇——APT不是攻击技术，是攻击的心态和模式</a></li>
		<li><a href="https://www.sec-un.org/wretched-netfilter-backdoor/" rel="bookmark" title="详细阅读 猥琐的netfilter backdoor">猥琐的netfilter backdoor</a></li>
		<li><a href="https://www.sec-un.org/nsa-technical-analysis-of-prism-router-backdoor/" rel="bookmark" title="详细阅读 NSA棱镜门路由器后门技术分析">NSA棱镜门路由器后门技术分析</a></li>
		<li><a href="https://www.sec-un.org/talk-about-penetration-testing/" rel="bookmark" title="详细阅读 说说渗透测试">说说渗透测试</a></li>
		<li><a href="https://www.sec-un.org/do-not-know-know-prevention-of-attack-is-a-false-proposition/" rel="bookmark" title="详细阅读 “不知攻焉知防”是个伪命题">“不知攻焉知防”是个伪命题</a></li>
	</ul>
<div class="cls"></div>
</div>

<div id="comments">
<h3 id="comments-title">《<em>APT时代-窃密型WebShell检测方法的思考</em>》有 4 条评论</h3>
<ol class="commentlist">
  	<li class="comment byuser comment-author-yang even thread-even depth-1" id="li-comment-99">
		<div id="comment-99">
		<div class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/77650bdfca578e159f6831b07e5c47ee?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/77650bdfca578e159f6831b07e5c47ee?s=80&amp;d=mm&amp;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn">yang</cite> <span class="says">说：</span>		</div><!-- .comment-author .vcard -->
		
		<div class="comment-meta commentmetadata"><a href="https://www.sec-un.org/ideas-like-article-espionage-webshell-method/#comment-99">
			2015年6月11日12:09</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body"><p>很不错的一篇文章啊</p>
</div>

		<div class="reply">
					</div><!-- .reply -->
	</div><!-- #comment-##  -->

	<ul class="children">
	<li class="comment odd alt depth-2" id="li-comment-100">
		<div id="comment-100">
		<div class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/efb40e9fd7df588c0feabd40cb6581bc?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/efb40e9fd7df588c0feabd40cb6581bc?s=80&amp;d=mm&amp;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn">迷路的指南针</cite> <span class="says">说：</span>		</div><!-- .comment-author .vcard -->
		
		<div class="comment-meta commentmetadata"><a href="https://www.sec-un.org/ideas-like-article-espionage-webshell-method/#comment-100">
			2015年6月11日12:23</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body"><p>谢谢，有些内容写的可能不太好，欢迎指正。</p>
</div>

		<div class="reply">
					</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment byuser comment-author-springold even thread-odd thread-alt depth-1" id="li-comment-101">
		<div id="comment-101">
		<div class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/48c206be49f57de17e7492fdfdbbc73a?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/48c206be49f57de17e7492fdfdbbc73a?s=80&amp;d=mm&amp;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn">springold</cite> <span class="says">说：</span>		</div><!-- .comment-author .vcard -->
		
		<div class="comment-meta commentmetadata"><a href="https://www.sec-un.org/ideas-like-article-espionage-webshell-method/#comment-101">
			2015年6月16日19:22</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body"><p>代理型Agent可以经过优化后与中间件进行深度结合能够追踪到发起数据查询请求的具体脚本文件。<br />
具体的思路是怎么样的？ 在大并发的情况下，将web访问和sql语句进行准确的对应。</p>
</div>

		<div class="reply">
					</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-guanyinlei odd alt thread-even depth-1" id="li-comment-136">
		<div id="comment-136">
		<div class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/ee5c5de015f4b4a8ed30c72a450def97?s=40&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ee5c5de015f4b4a8ed30c72a450def97?s=80&amp;d=mm&amp;r=g 2x' class='avatar avatar-40 photo' height='40' width='40' />			<cite class="fn">guanyinlei</cite> <span class="says">说：</span>		</div><!-- .comment-author .vcard -->
		
		<div class="comment-meta commentmetadata"><a href="https://www.sec-un.org/ideas-like-article-espionage-webshell-method/#comment-136">
			2015年11月30日19:29</a>		</div><!-- .comment-meta .commentmetadata -->

		<div class="comment-body"><p>	你这个思路和GREENSQL很像，可以参考参考</p>
</div>

		<div class="reply">
					</div><!-- .reply -->
	</div><!-- #comment-##  -->

	</li><!-- #comment-## -->
</ol>
</div><!-- #comments -->
      </div><!-- #content -->
  </div><!-- #container -->
<script type="text/javascript">loading('55%',1000)</script>
    <aside id="primary" class="side" role="complementary">
        <ul class="xoxo">
<li id="frontloginblock-3" class="widget-container widget_login">	 <div class="front_login_box">
            	<div class="from_box">
      <form name="loginform" id="loginform" action="https://www.sec-un.org/wp-login.php" method="post">
            <p class="p1"><span><i class="icon-user icon-2x"></i></span><input onfocus="this.value = '';" name="log" id="user_login" type="text" class="user_name" value="User Name" /></p>
          <p class="p1" style="margin-bottom:30px;"><span><i class="icon-lock icon-2x"></i></span><input onfocus="this.value = '';this.type = 'password';" name="pwd" id="user_pass" type="text" class="password" value="Your Password" /></p>
          <p class="p2"><input name="提交" type="submit" class="submit_button" value="登 录" /></p>
          <p class="p3"><span style="float:right"><i class="icon-signin"></i> <a href="https://www.sec-un.org/wp-login.php?action=register">注册</a></span><span class="keep_me"><label style="display:none;" for="rememberme"><input name="rememberme" type="checkbox" id="rememberme" value="forever"></label><i class="icon-check-empty"></i> 记住我的登录信息</span></p>
          <input type="hidden" name="redirect_to" value="https://www.sec-un.org/ideas-like-article-espionage-webshell-method/">
          </form>
        </div>
        <script type="text/javascript">
		jQuery(function($){
			$('.keep_me').click(function(){
				var nowSet = $(this).find('i').attr('class');
				if(nowSet == "icon-check-empty"){
					$(this).find('i').attr('class','icon-check');
					$(this).find('#rememberme').attr('checked','')
				}else{
					$(this).find('i').attr('class','icon-check-empty');
					$(this).find('#rememberme').removeAttr('checked')
				}
			})
		});
        </script>
            </div>
     </li><li id="cp_pointswidget-3" class="widget-container widget_cp_pointswidget"><h3 class="widget-title">我的积分</h3>				<ul>
						<li>您需要先登录才能查看您的积分。.</li>
										</ul>
			</li><li id="cp_topuserswidget-5" class="widget-container widget_cp_topuserswidget"><h3 class="widget-title">Rank排行榜</h3><ul><li class="cp_topUsersWidget top_1" style="list-style:none;">迷路的指南针 (Rank1145)</li><li class="cp_topUsersWidget top_2" style="list-style:none;">DJ (Rank841)</li><li class="cp_topUsersWidget top_3" style="list-style:none;">NUKE (Rank814)</li><li class="cp_topUsersWidget top_4" style="list-style:none;">孙维 (Rank485)</li><li class="cp_topUsersWidget top_5" style="list-style:none;">consen (Rank415)</li><li class="cp_topUsersWidget top_6" style="list-style:none;">crackershi (Rank280)</li><li class="cp_topUsersWidget top_7" style="list-style:none;">lzy (Rank276)</li><li class="cp_topUsersWidget top_8" style="list-style:none;">ThreatActor (Rank265)</li><li class="cp_topUsersWidget top_9" style="list-style:none;">archer (Rank255)</li><li class="cp_topUsersWidget top_10" style="list-style:none;">驭龙 (Rank240)</li><li class="cp_topUsersWidget top_11" style="list-style:none;">zhuyue (Rank235)</li><li class="cp_topUsersWidget top_12" style="list-style:none;">辛巴达(Sinbad) (Rank225)</li><li class="cp_topUsersWidget top_13" style="list-style:none;">SHIELD (Rank215)</li><li class="cp_topUsersWidget top_14" style="list-style:none;">zsfnotes (Rank213)</li><li class="cp_topUsersWidget top_15" style="list-style:none;">Bruce_Zhang (Rank185)</li><li class="cp_topUsersWidget top_16" style="list-style:none;">Anonymous (Rank170)</li><li class="cp_topUsersWidget top_17" style="list-style:none;">Piz0n (Rank165)</li><li class="cp_topUsersWidget top_18" style="list-style:none;">coolweis (Rank155)</li><li class="cp_topUsersWidget top_19" style="list-style:none;">bennyye (Rank150)</li><li class="cp_topUsersWidget top_20" style="list-style:none;">linzhi (Rank145)</li><li class="cp_topUsersWidget top_21" style="list-style:none;">kris (Rank125)</li><li class="cp_topUsersWidget top_22" style="list-style:none;">清风作伴明月为邻 (Rank125)</li><li class="cp_topUsersWidget top_23" style="list-style:none;">chenji123456 (Rank85)</li><li class="cp_topUsersWidget top_24" style="list-style:none;">rapido (Rank80)</li><li class="cp_topUsersWidget top_25" style="list-style:none;">heitian (Rank75)</li><li class="cp_topUsersWidget top_26" style="list-style:none;">ChrisChen世雄 (Rank75)</li><li class="cp_topUsersWidget top_27" style="list-style:none;">killer (Rank50)</li><li class="cp_topUsersWidget top_28" style="list-style:none;">mad (Rank50)</li><li class="cp_topUsersWidget top_29" style="list-style:none;">CoolICE (Rank50)</li><li class="cp_topUsersWidget top_30" style="list-style:none;">淡水鱼 (Rank50)</li></ul></li>        </ul>
    </aside><!-- #primary .widget-area -->

<script type="text/javascript">loading('78%',1000)</script>
<div class="cls"></div>
</section><!-- #main -->
<div class="cls"></div>
	<footer id="footer" role="contentinfo">
		<div id="colophon">

<div id="site-info">
<a href="javascript:void(0)" onClick="goRoll(0)" id="goTop">返回顶部</a> <a href="https://www.sec-un.org/sitemap.html">网站地图</a> &nbsp; <a href="http://www.miitbeian.gov.cn/" rel="external nofollow">京ICP备15036950号-1</a> <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?0ef96af0d6646bc4db46b410e4f2e212";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script> ©2017 Sec-UN All Rights Reserved | Theme <span id='official'>frontopen2</span></div>
		</div>	</footer></div><script type='text/javascript' src='https://www.sec-un.org/wp-includes/js/comment-reply.min.js?ver=d2207c9bc2f8d7af72d793379f207c99'></script>
<script type='text/javascript' src='https://www.sec-un.org/wp-includes/js/wp-embed.min.js?ver=d2207c9bc2f8d7af72d793379f207c99'></script>
<div id="float"><a id="float_gotop" class="floatbtn"  href="javascript:void()" onClick="goRoll(0)" title="返回顶部"></a><a class="linbak floatbtn" href="https://www.sec-un.org/wp-admin/" title="登陆&注册"></a><a id="float_goend" class="floatbtn" href="javascript:void()" onClick="goend()" title="转到底部"></a></div>
</body>
</html><script type="text/javascript">loading('100%',1000)</script>
