<!DOCTYPE HTML>
<html>
<head>
<meta name="viewport" content="width=device-width , initial-scale=1.0 , user-scalable=0 , minimum-scale=1.0 , maximum-scale=1.0" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>改进WHOIS流关联分析的方法 | Sec-UN 安全圈</title>
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="pingback" href="https://www.sec-un.org/xmlrpc.php" />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Sec-UN 安全圈 &raquo; Feed" href="https://www.sec-un.org/feed/" />
<link rel="alternate" type="application/rss+xml" title="Sec-UN 安全圈 &raquo; 评论Feed" href="https://www.sec-un.org/comments/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.sec-un.org\/wp-includes\/js\/wp-emoji-release.min.js?ver=d2207c9bc2f8d7af72d793379f207c99"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,56826,8203,55356,56819),0,0),c=j.toDataURL(),b===c&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55358,56794,8205,9794,65039),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55358,56794,8203,9794,65039),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='jQuery_notice-css'  href='https://www.sec-un.org/wp-content/plugins/cubepoints/modules/notice/jquery.notice.css?ver=d2207c9bc2f8d7af72d793379f207c99' type='text/css' media='all' />
<link rel='stylesheet' id='cptch_stylesheet-css'  href='https://www.sec-un.org/wp-content/plugins/captcha/css/front_end_style.css?ver=4.3.5' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='https://www.sec-un.org/wp-includes/css/dashicons.min.css?ver=d2207c9bc2f8d7af72d793379f207c99' type='text/css' media='all' />
<link rel='stylesheet' id='cptch_desktop_style-css'  href='https://www.sec-un.org/wp-content/plugins/captcha/css/desktop_style.css?ver=4.3.5' type='text/css' media='all' />
<script type='text/javascript' src='https://www.sec-un.org/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='https://www.sec-un.org/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript' src='https://www.sec-un.org/wp-content/plugins/cubepoints/modules/notice/jquery.notice.js?ver=1.0.1'></script>
<link rel='prev' title='安全界的黑天鹅与反脆弱' href='https://www.sec-un.org/black-swans-of-the-security-sector-and-the-vulnerable/' />
<link rel='next' title='大象起舞的安全时代即将降临' href='https://www.sec-un.org/dancing-elephant-security-era-is-coming/' />
<link rel="canonical" href="https://www.sec-un.org/improved-whois-correlation-analysis-method/" />
<script type="text/javascript">
(function(url){
	if(/(?:Chrome\/26\.0\.1410\.63 Safari\/537\.31|WordfenceTestMonBot)/.test(navigator.userAgent)){ return; }
	var addEvent = function(evt, handler) {
		if (window.addEventListener) {
			document.addEventListener(evt, handler, false);
		} else if (window.attachEvent) {
			document.attachEvent('on' + evt, handler);
		}
	};
	var removeEvent = function(evt, handler) {
		if (window.removeEventListener) {
			document.removeEventListener(evt, handler, false);
		} else if (window.detachEvent) {
			document.detachEvent('on' + evt, handler);
		}
	};
	var evts = 'contextmenu dblclick drag dragend dragenter dragleave dragover dragstart drop keydown keypress keyup mousedown mousemove mouseout mouseover mouseup mousewheel scroll'.split(' ');
	var logHuman = function() {
		var wfscr = document.createElement('script');
		wfscr.type = 'text/javascript';
		wfscr.async = true;
		wfscr.src = url + '&r=' + Math.random();
		(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(wfscr);
		for (var i = 0; i < evts.length; i++) {
			removeEvent(evts[i], logHuman);
		}
	};
	for (var i = 0; i < evts.length; i++) {
		addEvent(evts[i], logHuman);
	}
})('//www.sec-un.org/?wordfence_logHuman=1&hid=E4868876FDE0F5C60C7E1DACAA11A0D2');
</script><meta name="description" content="&nbsp;  本文节选自笔者在NSC2016中国网络安全大会上《人工智能辅助威胁情报生产的三个实例》演讲，为其中第二个实例的内容。  &nbsp;    &nbsp;  Whois流，指将Whois域名注册数据、PassiveDNS解析数据、IP、邮箱、和各类地址等信息用于挖掘恶意组织的方法。Whois流这两年出镜率愈发高涨，每篇公开发表的分析报告里都会出现，国际国内会议的幻灯片内也随处可见耳熟能详的网状关系图。俨然Whois流已成为">
<script type="text/javascript">(function(){mod_txt = '#'; adminBar = "" || 0})();</script>
<script type="text/javascript" src="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/frontopen.js?ver=1.5.04.15"></script>
<script type="text/javascript" src="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/include/lightbox-2.6.min.js"></script>
<link href="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/lightbox.css" rel="stylesheet" type="text/css" />

<link rel="stylesheet" type="text/css" media="all" href="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/style.css?ver=1.5.04.15" />
<link rel="stylesheet" type="text/css" media="all" href="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/mobile.css?ver=1.5.04.15" />
<style type="text/css">@media screen and (min-width:1366px){.c-con{height:140px;}}
a:hover , .header .logo i , .tit .h1 a , .tit .iititle2 span a:hover , .entry-content a , .entry-title , .mbx a:hover , .commentlist .comment-body a , .top_post .ulist a:hover , .gonggao a , .loc_link a , .tit .iititle a:hover{color:#000000}.nav .tig .rrs , #wp-calendar td a:hover , .jz_bt , .loading , .subbtn .btn , .post_pic_box:hover , .title_hot , .top_bar , .car-toggler , .but_down a , .page-link a span , .page-link .t_s_s , .page_num a , .nav-next a{background:#000000;}.j_zeng , .jz_bt:hover , .f_links li{border-color:#000000}.navcon ul li a:hover, .navcurrent{color:#4EA4EF;}</style>

<!--[if lt IE 9]><script src="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/html5.js"></script><![endif]-->
<link rel="stylesheet" href="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/css/font-awesome.min.css?ver=1.5.04.15">
<!--[if IE 7]>
<link rel="stylesheet" href="https://www.sec-un.org/wp-content/themes/frontopen2_v1.5.04.15/css/font-awesome-ie7.min.css?ver=1.5.04.15">
<![endif]-->
</head>

<body class="post-template-default single single-post postid-4378 single-format-standard">
<div class="loading"></div>
<div class="web_bod">
<header class="header marauto">
    <span class="logo">
        <a href="https://www.sec-un.org/" title="Sec-UN 安全圈" rel="home"><img src="https://www.sec-un.org/wp-content/uploads/2014/09/logo2x-300x74.png" alt="Sec-UN 安全圈" /></a>
        <i></i>
    </span>
    <form role="search" method="get" id="searchform" action="https://www.sec-un.org/">
      <span class="search">
        <input name="s" id="s" type="text"  class="input" value="" onclick="this.value = '';" style="color:#999" onkeypress="javascript:if(event.keyCode == 13){query(this.value);}" x-webkit-speech=""/>
        <button id="searchsubmit" class="btn">搜索</button>
      </span>
    </form>
    <div class="cls"></div>
</header>


<nav class="navcon marauto">
  <div id="mobile_nav_btn">网站导航</div>
  <div class="menu-header"><ul id="menu-%e5%af%bc%e8%88%aa" class="menu"><li id="menu-item-18" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-18"><a href="http://www.sec-un.org">首页</a></li>
<li id="menu-item-23" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-23"><a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e8%b5%84%e8%ae%af/">安全资讯</a></li>
<li id="menu-item-19" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-19"><a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e6%b2%bb%e7%90%86/">安全治理</a></li>
<li id="menu-item-20" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-20"><a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e6%96%b9%e6%a1%88/">安全方案</a></li>
<li id="menu-item-21" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-21"><a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e6%8a%80%e6%9c%af/">安全技术</a></li>
<li id="menu-item-22" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-22"><a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e4%ba%ba%e6%89%8d/">安全人才</a></li>
<li id="menu-item-27" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-27"><a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e4%bb%bb%e5%8a%a1/">安全任务</a></li>
<li id="menu-item-1027" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-1027"><a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e5%a8%81%e8%83%81%e6%83%85%e6%8a%a5/">安全威胁情报</a></li>
<li id="menu-item-1764" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1764"><a href="https://www.sec-un.org/category/%e4%bf%a1%e6%81%af%e9%80%9f%e9%80%92/">信息速递</a></li>
<li id="menu-item-77" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-77"><a href="http://www.sec-un.org/wp-admin/post-new.php">我要投稿</a></li>
<li id="menu-item-75" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-75"><a href="https://www.sec-un.org/category/%e7%bd%91%e7%ab%99%e5%85%ac%e5%91%8a/">网站公告</a></li>
</ul></div>  
  </nav>   
  <section class="conter marauto"><script type="text/javascript">loading('33%',1000)</script>
  <div id="container">
      <div id="content" role="main" style="width:96%">
      <div class="mbx"><i class="icon-home icon-large" style="font-size:14px;"></i>
<a href="https://www.sec-un.org"  class="gray">首页</a>  >  <a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e5%a8%81%e8%83%81%e6%83%85%e6%8a%a5/">安全威胁情报</a>  >  改进WHOIS流关联分析的方法</div>

				<div id="post-4378" class="post-4378 post type-post status-publish format-standard has-post-thumbnail hentry category-61 category-8">
                <div class="c-top2" id="post-55">
                <div class="datetime">2016<br />07-01</div>
					<header class="tit"><h1 class="entry-title">改进WHOIS流关联分析的方法</h1>
					<aside class="entry-meta iititle2">
                        <span><i class="icon-user icon-large"></i> <a href="https://www.sec-un.org/author/dj/" title="由DJ发布" rel="author">DJ</a></span><span><i class="icon-folder-open icon-large"></i> <a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e5%a8%81%e8%83%81%e6%83%85%e6%8a%a5/" rel="category tag">安全威胁情报</a>, <a href="https://www.sec-un.org/category/%e5%ae%89%e5%85%a8%e6%8a%80%e6%9c%af/" rel="category tag">安全技术</a></span><span><i class="icon-eye-open icon-large"></i> 围观<i id="number">1684</i><script type="text/javascript">jQuery(function($){$.get("https://www.sec-un.org/fo_ajax?ajax=getPostViews&postID=4378",function(data){if(data.length < 10)$('#number').text(data)});})</script>次</span><span><i class="icon-comment-alt icon-large"></i> <span><span class="screen-reader-text">改进WHOIS流关联分析的方法</span>已关闭评论</span></span><span><i class="icon-pencil icon-large"></i> 编辑日期：<time>2016-07-01</time></span><span><i class="icon-zoom-in icon-large"></i> 字体：<a href="javascript:;" onclick="checkFontSize(18)">大</a> <a href="javascript:;" onclick="checkFontSize(16)">中</a> <a href="javascript:;" onclick="checkFontSize(14)">小</a></span>					</aside>
                    </header>
                    <div class="cls"></div>
		    </div>
                    <!-- .entry-meta -->

					<article class="entry-content">
                    
						<p>&nbsp;</p>
<p>本文节选自笔者在NSC2016中国网络安全大会上《人工智能辅助威胁情报生产的三个实例》演讲，为其中第二个实例的内容。</p>
<p>&nbsp;</p>
<p><a href="http://www.sec-un.org/wp-content/uploads/2016/07/幻灯片11.jpg" data-lightbox="image_lg"><img title="改进WHOIS流关联分析的方法 - 第1张  | Sec-UN 安全圈" alt="改进WHOIS流关联分析的方法 - 第1张  | Sec-UN 安全圈"  class="aligncenter size-full wp-image-4379"  data-src="http://www.sec-un.org/wp-content/uploads/2016/07/幻灯片11.jpg" width="1280" height="720" srcset="https://www.sec-un.org/wp-content/uploads/2016/07/幻灯片11.jpg 1280w, https://www.sec-un.org/wp-content/uploads/2016/07/幻灯片11-300x169.jpg 300w, https://www.sec-un.org/wp-content/uploads/2016/07/幻灯片11-768x432.jpg 768w, https://www.sec-un.org/wp-content/uploads/2016/07/幻灯片11-1024x576.jpg 1024w" sizes="(max-width: 1280px) 100vw, 1280px" /></a></p>
<p>&nbsp;</p>
<p>Whois流，指将Whois域名注册数据、PassiveDNS解析数据、IP、邮箱、和各类地址等信息用于挖掘恶意组织的方法。Whois流这两年出镜率愈发高涨，每篇公开发表的分析报告里都会出现，国际国内会议的幻灯片内也随处可见耳熟能详的网状关系图。俨然Whois流已成为当今最主要的方法之一，也是威胁情报服务平台的标准配置。</p>
<p>但是，辛辛苦苦积累了十年域名注册数据和变迁历史，只要黑客组织在注册新域名时使用了隐私保护，分析者就无法获得有效信息，那么关联分析也无从谈起。庞大的历史数据，在缺少第一环的情况下，突然变得对分析师的溯源分析工作毫无帮助，不能提供丝毫价值。</p>
<p>目前，域名注册信息隐私保护服务随手可得，传统的花费已经极低，而免费的又大量涌现，例如有几家.pw注册服务商免费提供隐私保护，而阿里云也为相当部分后缀提供类似服务。既有那些采用脱敏方式的，又有批量使用同一虚拟注册人的。后者会造成分析人员自以为是的误报：看，我又抓到了一个超大地下组织，名下多达几万恶意域名，关联恶意样本几百种，横跨数十次战役（campaign）。</p>
<p>Domain Shadowing（域名阴影）利用失窃口令的正常域名账户，大量创建子域名，用于钓鱼、挂马、C&amp;C等，这种恶意攻击手法非常有效，且难以遏止。因为你不知道黑客下一个会使用谁的账户，所以几乎没有办法去获悉下一个受害者。同时，这对Whois流分析师是个灾难，因为域名的注册人完全是合法的，不是恶意组织，关联分析更无从谈起。</p>
<p>pDNS的处境也不是全无隐忧，动态DNS和CDN等的盛行，第三方被黑服务器的加入，也增加了数据采集难度，降低了信息准确性。</p>
<p>在这种趋势下，最令防守方胆战心惊的是，谈到关联分析，Whois和pDNS这两招目前是大部分厂商都会，同时也是唯一会的。你去看市面上提供威胁情报服务的平台厂商，大部分也就只能提供这两类数据的关联，加上作用很小的单只木马样本哈希数值（木马家族分析对关联挖掘很有帮助，但投入大技术壁垒高）。再过两年，Whois流关联分析手法已得到普及的我们，面对黑客都使用隐私保护的情景，还有没有能力愉快地在分析报告里堂而皇之地对嫌疑人画像？</p>
<p>此外，Whois流的误报漏报率实在是高，笔者就曾发现过公开报告中出现了多次明显错误，相信各位看官也有类似经历，亟需一种新的办法来改进。</p>
<p>&nbsp;</p>
<p><a href="http://www.sec-un.org/wp-content/uploads/2016/07/幻灯片12.jpg" data-lightbox="image_lg"><img title="改进WHOIS流关联分析的方法 - 第2张  | Sec-UN 安全圈" alt="改进WHOIS流关联分析的方法 - 第2张  | Sec-UN 安全圈"  class="aligncenter size-full wp-image-4380"  data-src="http://www.sec-un.org/wp-content/uploads/2016/07/幻灯片12.jpg" width="1280" height="720" srcset="https://www.sec-un.org/wp-content/uploads/2016/07/幻灯片12.jpg 1280w, https://www.sec-un.org/wp-content/uploads/2016/07/幻灯片12-300x169.jpg 300w, https://www.sec-un.org/wp-content/uploads/2016/07/幻灯片12-768x432.jpg 768w, https://www.sec-un.org/wp-content/uploads/2016/07/幻灯片12-1024x576.jpg 1024w" sizes="(max-width: 1280px) 100vw, 1280px" /></a></p>
<p>&nbsp;</p>
<p>显然，为了能在未来有效地挖掘僵尸网络与恶意组织，大幅提高准确率，威胁情报服务商和分析人员必须未雨绸缪，从现在开始就努力寻找更多能够标识入侵者、载体、与手法的特征，积累更多的“指纹”，以保证未来有能力继续实施关联分析。</p>
<p>笔者在准备此演讲内容时，尚未见到有类似公开研究发表。寻找更多特征指纹标注，是很自然的技术与业务发展，迟早都会出现。我们在文件追踪溯源中已经使用包括相似内容在内的多种组合指纹，反欺诈中的人机识别也大量使用了组合指纹，读者也能想到更多应用场景。上周参加FIRST2016时也发现RiskIQ讲了类似内容议题。相信主动收集特征指纹的尝试，即使目前在全球范围内是凤毛麟角，以威胁情报行业的速度，想来用不了多久各家都会推出。</p>
<p>笔者沿用了行业内惯称的“指纹”一词，更能帮助从业者直观理解特征的含义，另外，笔者将指纹特征分成两大类：基础设施和表层应用，这是根据识别特征的本质进行区分，表示着从采集到使用、以及后期分析中都有相对应的不同，更适合未来进一步实施行为分析。未来随着恶意行为的演化，也肯定会出现更多分类。</p>
<p>&nbsp;</p>
<p><a href="http://www.sec-un.org/wp-content/uploads/2016/07/幻灯片13.jpg" data-lightbox="image_lg"><img title="改进WHOIS流关联分析的方法 - 第3张  | Sec-UN 安全圈" alt="改进WHOIS流关联分析的方法 - 第3张  | Sec-UN 安全圈"  class="aligncenter size-full wp-image-4381"  data-src="http://www.sec-un.org/wp-content/uploads/2016/07/幻灯片13.jpg" width="1280" height="720" srcset="https://www.sec-un.org/wp-content/uploads/2016/07/幻灯片13.jpg 1280w, https://www.sec-un.org/wp-content/uploads/2016/07/幻灯片13-300x169.jpg 300w, https://www.sec-un.org/wp-content/uploads/2016/07/幻灯片13-768x432.jpg 768w, https://www.sec-un.org/wp-content/uploads/2016/07/幻灯片13-1024x576.jpg 1024w" sizes="(max-width: 1280px) 100vw, 1280px" /></a></p>
<p>&nbsp;</p>
<p>显然，IP、域名注册信息等都是基础设施指纹的一部分。恶意组织的基础设施需要一定花费来获取，导致变动成本较高，因此相对应用层特征来说变化较慢，是很好的数据基础。说起来Whois信息并不是很理想，因为区分度不够强，造假的成本太低，只是因为获取简单且使用直观容易理解才得到普及。</p>
<p>一个可以作为基础设施指纹的选择是，SSL连接中用于标识服务器身份的证书。恶意组织使用脚本大量快速部署服务器时，经常会使用同一证书，管理僵尸网络和传输收集数据都更加容易。威胁情报平台采集证书十分简单，既可以主动尝试发起SSL连接，也可以通过网络抓包获取，存储和查询也十分简单。证书可提供强关联支持，是分析员梦寐以求的利器。</p>
<p>与Whois域名注册信息不同，类似证书这样的基础设施指纹并不是普遍存在的，所以简单提供关联操作界面并不现实，需要引入更复杂的算法分析能力和可视化界面。另外，此类分析工作远比人机识别复杂，后者只需要按照预先设定好的权重进行打分即可，而溯源追踪则需要针对海量指纹数据做大规模索引、聚类、和分类。</p>
<p>因此，我们仍需要引入多个弱关联的指纹，以提高准确率和可实施性。例如，提供服务器的第三方供应商（有组织为黑客服务的地下产业链信息尤佳）、多层C&amp;C之间的连接、动态域名提供商、主机的基本属性（操作系统和数据库等）、基础设施的复用、等等。处理如此多的维度，对情报生成平台的架构和用户界面设计是一项颇大挑战。</p>
<p>&nbsp;</p>
<p><a href="http://www.sec-un.org/wp-content/uploads/2016/07/幻灯片14.jpg" data-lightbox="image_lg"><img title="改进WHOIS流关联分析的方法 - 第4张  | Sec-UN 安全圈" alt="改进WHOIS流关联分析的方法 - 第4张  | Sec-UN 安全圈"  class="aligncenter size-full wp-image-4382"  data-src="http://www.sec-un.org/wp-content/uploads/2016/07/幻灯片14.jpg" width="1280" height="720" srcset="https://www.sec-un.org/wp-content/uploads/2016/07/幻灯片14.jpg 1280w, https://www.sec-un.org/wp-content/uploads/2016/07/幻灯片14-300x169.jpg 300w, https://www.sec-un.org/wp-content/uploads/2016/07/幻灯片14-768x432.jpg 768w, https://www.sec-un.org/wp-content/uploads/2016/07/幻灯片14-1024x576.jpg 1024w" sizes="(max-width: 1280px) 100vw, 1280px" /></a></p>
<p>&nbsp;</p>
<p>表层应用指纹的选择更加多样化。例如webshell脚本代码都可以计算复杂内容指纹，进行代码相似度识别。我们这里讨论的不是简单对整体文件计算散列值，而是将内容分段并提取关键特征后考虑特征顺序因素而设计的内容指纹，可以在更改代码小于30%时仍可明确计算出木马来源，或者指出木马家族名称。这些也都是强关联支撑。</p>
<p>我们在实践中发现钓鱼网站系统也存在高度复用，通过分析页面展现，即可划分不同恶意组织。在某些钓鱼页面上，还存有第三方统计代码，例如Google Analytics、百度统计等。料想黑产组织内部也需要不断改进手法以提高渗透率，或者KPI驱动要考核不同地区间的业绩，或者按效果分赃或向第三方设施服务商付款。同样的，这些统计代码也可以用于关联分析。</p>
<p>表层应用的指纹选择非常多，笔者就不一一赘述了。有些黑产组织善于利用wordpress嵌入C&amp;C，有的善于通过广告联盟植入恶意代码。更多的例子包括，数据表名称、代码注释、着陆页、转向、第三方服务商等等。请读者自行研究。</p>
<p>&nbsp;</p>
<p><a href="http://www.sec-un.org/wp-content/uploads/2016/07/幻灯片15.jpg" data-lightbox="image_lg"><img title="改进WHOIS流关联分析的方法 - 第5张  | Sec-UN 安全圈" alt="改进WHOIS流关联分析的方法 - 第5张  | Sec-UN 安全圈"  class="aligncenter size-full wp-image-4383"  data-src="http://www.sec-un.org/wp-content/uploads/2016/07/幻灯片15.jpg" width="1280" height="720" srcset="https://www.sec-un.org/wp-content/uploads/2016/07/幻灯片15.jpg 1280w, https://www.sec-un.org/wp-content/uploads/2016/07/幻灯片15-300x169.jpg 300w, https://www.sec-un.org/wp-content/uploads/2016/07/幻灯片15-768x432.jpg 768w, https://www.sec-un.org/wp-content/uploads/2016/07/幻灯片15-1024x576.jpg 1024w" sizes="(max-width: 1280px) 100vw, 1280px" /></a></p>
<p>&nbsp;</p>
<p>当然，特征越多，手工分析越难。面对特征维度快速上升的海量指纹数据，使用机器学习做相似度关联是基本要求。Whois流简单点几下鼠标右键逐渐单线生成网状关系图的情景恐怕很难复现，而是一类具有相似特征的基础设施（如C&amp;C服务器）会被聚成一堆，或被分类区别开。单单应用大规模索引系统（如Elastic Search）将无法胜任复杂分析需求。可以预见系统将会变得十分复杂，但在目前恶意组织隐匿身份的手法越来越多样化的趋势下，我们除了继续投入建设威胁情报平台之外还有别的选择吗？就在NSC大会当天传出新闻，Mandiant在辅助孟加拉央行追查SWIFT项目中花费了700小时后没有得到有效结果，再次请求追加580小时。从现在的市场反馈看来，甲方更关注的是，厂商究竟有没有办法让用户看到情报的效果，有没有持续产生商业价值的能力。如果业界的威胁情报平台能提供更多的特征指纹和更强大的关联分析能力，将会极大促进安全的整体水平。</p>
<p>&nbsp;</p>
 
 										                        <div class="loc_link"><ul><li>本文固定链接: <a href="https://www.sec-un.org/improved-whois-correlation-analysis-method/" rel="bookmark" title="改进WHOIS流关联分析的方法">https://www.sec-un.org/improved-whois-correlation-analysis-method/</a></li>
                        <li>转载请注明: <a href="https://www.sec-un.org/author/dj/" title="由DJ发布" rel="author">DJ</a> <time>2016年07月01日 </time>于 <a href="https://www.sec-un.org/" title="访问Sec-UN 安全圈">Sec-UN 安全圈</a> 发表</li></ul>
                        </div>
                        						                        <div class="author_info">
                        	<div class="au_top_bar"><div class="edit_date">最后编辑：<time>2016-07-01</time></div><b>作者：DJ</b></div>
                            <div class="avatar"><img alt='' src='https://secure.gravatar.com/avatar/731d2234682b59da6804c1e801d2d792?s=96&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/731d2234682b59da6804c1e801d2d792?s=192&amp;d=mm&amp;r=g 2x' class='avatar avatar-96 photo' height='96' width='96' /></div>
                            <div class="type_out"><span class="ttxx">关注数据治理和安全的前沿技术和发展趋势。微信公众号：DJ_notes 邮件：DJ [at] sec-un.org</span><div class="au_links"><a href="https://www.sec-un.org?author=22" class="c1"><i class="icon-home"></i> 站内专栏</a></div></div>
                        <div class="cls"></div>
                        </div>
                        					</article>
                    
                    <!-- .entry-content -->

					<!-- .entry-utility -->
				</div><!-- #post-## -->
<div class="c-bot">
            <div class="cls"></div>
    </div>
    <br />
				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="https://www.sec-un.org/dancing-elephant-security-era-is-coming/" rel="next"><span class="meta-nav"><i class="icon-arrow-left"></i></span> 大象起舞的安全时代即将降临 </a></div>
					<div class="nav-next"><a href="https://www.sec-un.org/black-swans-of-the-security-sector-and-the-vulnerable/" rel="prev">安全界的黑天鹅与反脆弱  <i class="icon-arrow-right"></i></a></div>
				</div><!-- #nav-below -->
<div class="cls"></div>
				                    <div class="ad_2">
						                    </div>
                                <div class="relatedposts">
<h3 class="widget-title"><i class="icon-warning-sign"></i> 您可能还会对这些文章感兴趣！</h3>
<ul>
		<li><a href="https://www.sec-un.org/protecting-infrastructure-of-national-based-information-securitys-top-ten-part-one/" rel="bookmark" title="详细阅读 国家基础设施安全保护十大原则－上篇">国家基础设施安全保护十大原则－上篇</a></li>
		<li><a href="https://www.sec-un.org/traffic-analysis-analysis-of-malicious-messages-and-encrypting-ransomware-virus-attack-1-2/" rel="bookmark" title="详细阅读 流量安全分析：恶意邮件&amp;加密勒索病毒攻击分析（1）">流量安全分析：恶意邮件&amp;加密勒索病毒攻击分析（1）</a></li>
		<li><a href="https://www.sec-un.org/beacon-threat-intelligence-subscription-0529c2-feed/" rel="bookmark" title="详细阅读 烽火台威胁情报订阅0529：C2-feed">烽火台威胁情报订阅0529：C2-feed</a></li>
		<li><a href="https://www.sec-un.org/splunk-uses-security-threat-intelligence-and-situational-analysis-of-use-case/" rel="bookmark" title="详细阅读 Splunk利用安全威胁情报和情境分析的Use Case">Splunk利用安全威胁情报和情境分析的Use Case</a></li>
		<li><a href="https://www.sec-un.org/nuke-students-foreign-open-source-threat-intelligence-gathered-resources-related-websites/" rel="bookmark" title="详细阅读 NUKE同学收集的国外开源威胁情报资源相关网站（2015.11.6更新）">NUKE同学收集的国外开源威胁情报资源相关网站（2015.11.6更新）</a></li>
		<li><a href="https://www.sec-un.org/information-security-analysts-practice-analysis-of-the-splunk-platform-app-making-tutorial/" rel="bookmark" title="详细阅读 信息安全分析师实践：splunk平台分析app制作教程">信息安全分析师实践：splunk平台分析app制作教程</a></li>
		<li><a href="https://www.sec-un.org/splunk-application-threat-intelligence-and-situation-analysis-based-on-exception-instance/" rel="bookmark" title="详细阅读 Splunk应用威胁情报和进行基于异常的情境分析实例">Splunk应用威胁情报和进行基于异常的情境分析实例</a></li>
		<li><a href="https://www.sec-un.org/machine-learning-malicious-domain/" rel="bookmark" title="详细阅读 机器智能识别恶意域名，是重要的威胁防御能力">机器智能识别恶意域名，是重要的威胁防御能力</a></li>
	</ul>
<div class="cls"></div>
</div>

<div id="comments">
</div><!-- #comments -->
      </div><!-- #content -->
  </div><!-- #container -->
<script type="text/javascript">loading('55%',1000)</script>
    <aside id="primary" class="side" role="complementary">
        <ul class="xoxo">
<li id="frontloginblock-3" class="widget-container widget_login">	 <div class="front_login_box">
            	<div class="from_box">
      <form name="loginform" id="loginform" action="https://www.sec-un.org/wp-login.php" method="post">
            <p class="p1"><span><i class="icon-user icon-2x"></i></span><input onfocus="this.value = '';" name="log" id="user_login" type="text" class="user_name" value="User Name" /></p>
          <p class="p1" style="margin-bottom:30px;"><span><i class="icon-lock icon-2x"></i></span><input onfocus="this.value = '';this.type = 'password';" name="pwd" id="user_pass" type="text" class="password" value="Your Password" /></p>
          <p class="p2"><input name="提交" type="submit" class="submit_button" value="登 录" /></p>
          <p class="p3"><span style="float:right"><i class="icon-signin"></i> <a href="https://www.sec-un.org/wp-login.php?action=register">注册</a></span><span class="keep_me"><label style="display:none;" for="rememberme"><input name="rememberme" type="checkbox" id="rememberme" value="forever"></label><i class="icon-check-empty"></i> 记住我的登录信息</span></p>
          <input type="hidden" name="redirect_to" value="https://www.sec-un.org/improved-whois-correlation-analysis-method/">
          </form>
        </div>
        <script type="text/javascript">
		jQuery(function($){
			$('.keep_me').click(function(){
				var nowSet = $(this).find('i').attr('class');
				if(nowSet == "icon-check-empty"){
					$(this).find('i').attr('class','icon-check');
					$(this).find('#rememberme').attr('checked','')
				}else{
					$(this).find('i').attr('class','icon-check-empty');
					$(this).find('#rememberme').removeAttr('checked')
				}
			})
		});
        </script>
            </div>
     </li><li id="cp_pointswidget-3" class="widget-container widget_cp_pointswidget"><h3 class="widget-title">我的积分</h3>				<ul>
						<li>您需要先登录才能查看您的积分。.</li>
										</ul>
			</li><li id="cp_topuserswidget-5" class="widget-container widget_cp_topuserswidget"><h3 class="widget-title">Rank排行榜</h3><ul><li class="cp_topUsersWidget top_1" style="list-style:none;">迷路的指南针 (Rank1145)</li><li class="cp_topUsersWidget top_2" style="list-style:none;">DJ (Rank841)</li><li class="cp_topUsersWidget top_3" style="list-style:none;">NUKE (Rank814)</li><li class="cp_topUsersWidget top_4" style="list-style:none;">孙维 (Rank485)</li><li class="cp_topUsersWidget top_5" style="list-style:none;">consen (Rank415)</li><li class="cp_topUsersWidget top_6" style="list-style:none;">crackershi (Rank280)</li><li class="cp_topUsersWidget top_7" style="list-style:none;">lzy (Rank276)</li><li class="cp_topUsersWidget top_8" style="list-style:none;">ThreatActor (Rank265)</li><li class="cp_topUsersWidget top_9" style="list-style:none;">archer (Rank255)</li><li class="cp_topUsersWidget top_10" style="list-style:none;">驭龙 (Rank240)</li><li class="cp_topUsersWidget top_11" style="list-style:none;">zhuyue (Rank235)</li><li class="cp_topUsersWidget top_12" style="list-style:none;">辛巴达(Sinbad) (Rank225)</li><li class="cp_topUsersWidget top_13" style="list-style:none;">SHIELD (Rank215)</li><li class="cp_topUsersWidget top_14" style="list-style:none;">zsfnotes (Rank213)</li><li class="cp_topUsersWidget top_15" style="list-style:none;">Bruce_Zhang (Rank185)</li><li class="cp_topUsersWidget top_16" style="list-style:none;">Anonymous (Rank170)</li><li class="cp_topUsersWidget top_17" style="list-style:none;">Piz0n (Rank165)</li><li class="cp_topUsersWidget top_18" style="list-style:none;">coolweis (Rank155)</li><li class="cp_topUsersWidget top_19" style="list-style:none;">bennyye (Rank150)</li><li class="cp_topUsersWidget top_20" style="list-style:none;">linzhi (Rank145)</li><li class="cp_topUsersWidget top_21" style="list-style:none;">kris (Rank125)</li><li class="cp_topUsersWidget top_22" style="list-style:none;">清风作伴明月为邻 (Rank125)</li><li class="cp_topUsersWidget top_23" style="list-style:none;">chenji123456 (Rank85)</li><li class="cp_topUsersWidget top_24" style="list-style:none;">rapido (Rank80)</li><li class="cp_topUsersWidget top_25" style="list-style:none;">heitian (Rank75)</li><li class="cp_topUsersWidget top_26" style="list-style:none;">ChrisChen世雄 (Rank75)</li><li class="cp_topUsersWidget top_27" style="list-style:none;">killer (Rank50)</li><li class="cp_topUsersWidget top_28" style="list-style:none;">mad (Rank50)</li><li class="cp_topUsersWidget top_29" style="list-style:none;">CoolICE (Rank50)</li><li class="cp_topUsersWidget top_30" style="list-style:none;">淡水鱼 (Rank50)</li></ul></li>        </ul>
    </aside><!-- #primary .widget-area -->

<script type="text/javascript">loading('78%',1000)</script>
<div class="cls"></div>
</section><!-- #main -->
<div class="cls"></div>
	<footer id="footer" role="contentinfo">
		<div id="colophon">

<div id="site-info">
<a href="javascript:void(0)" onClick="goRoll(0)" id="goTop">返回顶部</a> <a href="https://www.sec-un.org/sitemap.html">网站地图</a> &nbsp; <a href="http://www.miitbeian.gov.cn/" rel="external nofollow">京ICP备15036950号-1</a> <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?0ef96af0d6646bc4db46b410e4f2e212";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script> ©2017 Sec-UN All Rights Reserved | Theme <span id='official'>frontopen2</span></div>
		</div>	</footer></div><script type='text/javascript' src='https://www.sec-un.org/wp-includes/js/comment-reply.min.js?ver=d2207c9bc2f8d7af72d793379f207c99'></script>
<script type='text/javascript' src='https://www.sec-un.org/wp-includes/js/wp-embed.min.js?ver=d2207c9bc2f8d7af72d793379f207c99'></script>
<div id="float"><a id="float_gotop" class="floatbtn"  href="javascript:void()" onClick="goRoll(0)" title="返回顶部"></a><a class="linbak floatbtn" href="https://www.sec-un.org/wp-admin/" title="登陆&注册"></a><a id="float_goend" class="floatbtn" href="javascript:void()" onClick="goend()" title="转到底部"></a></div>
</body>
</html><script type="text/javascript">loading('100%',1000)</script>
