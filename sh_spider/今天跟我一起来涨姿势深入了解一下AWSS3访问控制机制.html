<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <title>今天跟我一起来涨姿势，深入了解一下AWS S3访问控制机制 - 嘶吼 RoarTalk &#8211; 回归最本质的信息安全,互联网安全新媒体,4hou.com</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="renderer" content="webkit">
    <meta property="wb:webmaster" content="4517e8fe39b18975" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,Chrome=1" />
    <meta name="description" content="前言近日，美国最大的无线通信公司Verizon遭遇了一次大规模的数据泄露事件，导致超过1.4亿的美国用户个人信息暴露在网上。事后调查才知道Verizon的这些数据存储在一个不受保护的AWS S3云服务器上，任何人都可以访问…" />
    <meta name="keywords" content="" />
        <link href="http://img.4hou.com/wp-content/themes/4houv2/images/favicon.ico" rel="shortcut icon">
    <link href="http://img.4hou.com/wp-content/themes/4houv2/images/favicon_114.png" rel="apple-touch-icon">
    <link href="http://img.4hou.com/wp-content/themes/4houv2/images/favicon_76.png" sizes="76x76" rel="apple-touch-icon">
    <link href="http://img.4hou.com/wp-content/themes/4houv2/images/favicon_120.png" sizes="120x120" rel="apple-touch-icon">
    <link href="http://img.4hou.com/wp-content/themes/4houv2/images/favicon_152.png" sizes="152x152" rel="apple-touch-icon">

    <!-- 引入 lib -->
    <script src="http://www.4hou.com/wp-content/themes/4houv2/lib/jquery.min.js"></script>
    <script src="http://www.4hou.com/wp-content/themes/4houv2/lib/swiper.jquery.min.js"></script>
    <link rel="stylesheet" href="http://www.4hou.com/wp-content/themes/4houv2/lib/swiper.min.css">
    <link rel="stylesheet" href="http://www.4hou.com/wp-content/themes/4houv2/lib/allmin.css">
    <!--[if lt IE 11]>
    <script src="http://www.4hou.com/wp-content/themes/4houv2/lib/html5shiv.min.js"></script>
    <script src="http://www.4hou.com/wp-content/themes/4houv2/lib/respond.js"></script>
    <![endif]-->
    <!-- 引入 css js -->
    <link rel="stylesheet" href="http://www.4hou.com/wp-content/themes/4houv2/css/style.css">
    <link rel="stylesheet" href="http://www.4hou.com/wp-content/themes/4houv2/lib/allmin.css">
    <script src="http://www.4hou.com/wp-content/themes/4houv2/js/public.js"></script>
    <script src="http://www.4hou.com/wp-content/themes/4houv2/js/main.js"></script>
    <script src="http://www.4hou.com/wp-content/themes/4houv2/js/index-more.js"></script>
    </head>
<body>
<style type="text/css">
.memberlistanimate{width: 122px}
.memberlistanimateleave{width: 122px}
.nameheader{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width: 78px;display: block;}
</style>

<header class="header">
            <article class="header_center">
                <div class="logowrap">
            <a href="http://www.4hou.com"><div class="logo icons"></div></a>
            <h1>回归最本质的信息安全</h1>
        </div>
        <div class="login">
            <form action="/" class="navbar-form inSearch " name="searchform" onsubmit="return checksubmit()">
                <div class="br">
                    <span class="in-btn icons"></span>
                    <input type="text" name="s" id="search" class="animated">
                    <div class="clear icons"></div>
                </div>
                <div id="submitBtnplace" class="icons animated" value=""></div>
                <!--<input type="submit" id="submitBtn" class="icons animated" value="">-->
            </form>
                            <!--登录注册按钮-->
                 <div id="register">
                     <a href="http://www.4hou.com/register" data-event-category="Referral to Signup" data-event-action="click" data-event-label="Signup Menu button / Header">注册</a>
                 </div>
                 <div id="sing">
                      <a href="http://www.4hou.com/login" class="pzh_login">登录</a>
                 </div>

                 <div class="burger2 menu" id="burger">
                  <div class="icon"></div>
                 </div>

            
           <!-- <div id="register">注册</div>
            <div id="sing">登录</div>
            <div class="burger2 menu" id="burger">
                <div class="icon"></div>
            </div>-->
        </div>
    </article>
</header>
<nav class="navbox animated">
    <section class="navbox_cen">
        <article class="navboxleft">
            <ul class="nav navbar-nav index-nav" id="inNav">
					<li>
							<li class="cat-item cat-item-18"><a href="http://www.4hou.com/category/info" >资讯</a>
</li>
	<li class="cat-item cat-item-19"><a href="http://www.4hou.com/category/technology" >技术</a>
</li>
	<li class="cat-item cat-item-20"><a href="http://www.4hou.com/category/xactivity" >活动</a>
</li>
	<li class="cat-item cat-item-29"><a href="http://www.4hou.com/category/vulnerable" >漏洞</a>
</li>
					</li>
                    <li class="cat-item cat-item-29"><a href="http://www.4hou.com/piao" >嘶票</a>
                    </li>
            </ul>
        </article>
        <article class="navboxright">
            <div class="contrib"> <a href="http://www.4hou.com/contribute" class="tougao" data-event-category="Referral to Signup" data-event-action="click" data-event-label="Signup Menu button / Header">投稿</a></div>
        </article>
    </section>
</nav>
<div id="modelbg"></div>
    <style>


    ::selection {
    background:#fea283;
    color:#fff;
}
::-moz-selection {
    background:#fea283;
    color:#fff;
}
::-webkit-selection {
    background:#fea283;
    color:#fff;
}


        .article_cen p img{height: auto !important;}
        .commentlist .children{width: 90%; padding-right: 15px; border-color: transparent ;}
        .commentname,.commenteml{width: 60%; margin-left:5% ;margin-bottom: 30px;border-bottom: 1px solid #dbdbdb;}
        .article_cen ol li{list-style-type: decimal;}
         .article_cen ol li p{overflow: inherit;}
        .commentname label{font-size: 16px;color: #666; margin-right: 10px;line-height: 32px;}
        .commentname input{width: 50%;border: none; outline: none;}
        .commenteml label{font-size: 16px;color: #666; margin-right: 10px;line-height: 32px;}
        .commenteml input{width: 50%;border: none; outline: none;}
        #zooming{display: none;width: 100%;height: 100%; position: fixed;z-index: 999;left: 0px; top: 0px; background-color: rgba(0,0,0,.6);}
        .zoomaniatae{display: block !important;}
        .imgcon{}
        #imgcon{position: absolute;left: 50%; top: 20%;max-width: 80%}
        .article_cen img{cursor: pointer;}
        #zooming{cursor: pointer;}
        .imgconadimate{animation:imgcon 0.5s 1 forwards;
        -webkit-animation:imgcon 0.5s 1 forwards;}
        .article_authorbox{    width: 222px;min-height: 214px;
        padding-bottom: 20px;
        float: right;
        position: relative;}
        .interested{position: relative;}
        .interested>h1{font-size: 18px; font-weight: 900; position: absolute; top: -36px;color: #5e5e5e}
       .user-comment span{font-size: 13px; position: relative; top: 2px;}
        .article_authoradd{position: fixed;}
        .stratend{background:url(http://www.4hou.com/wp-content/themes/4houv2/img/starend.png); !important;background-size: contain !important;}
        .wpfp-span{opacity: 0;width:100%; height: 100%;display: block; left: 0px; top: 0px; }
        .wpfp-link{width:100%; height: 100%;display: block; left: 0px; top: 0px; }
        .wpfp-span img{display: none;}
        .interested{width: 222px;padding-bottom: 20px;background-color: #fff;margin-top: 70px; padding-bottom: 10px; padding-top: 10px;border: 1px solid #f5c2b1}
        .interested li{width: 100%;position: relative;padding-top: 8px; padding-bottom: 8px;  line-height: 24px; padding-left: 20px;padding-right: 14px}
        .interested li i{width: 6px;height: 6px;border-radius: 50%; background-color: #f63;position: absolute; left: 8px; top: 18px;}
        .interested li a{color: #666;font-size: 14px; line-height: 18px;}
        .interested li:hover{background-color: #f9e7e3;-moz-transition: all 0.4s ease-in-out;
        .footer{position: relative;z-index: 99}   
        .article_authorbox_top{position: relative;} 
        

        -o-transition: all 0.4s ease-in-out; -webkit-transition: all 0.4s ease-in-out; transition: all 0.4s ease-in-out;}
    
        @-webkit-keyframes imgcon{
            0%{ opacity:0; -webkit-transform:scale3d(.3, .3, .3); transform:scale3d(.3, .3, .3) }
            50%{ opacity:1 }
        }
        @keyframes imgcon{
            0%{ opacity:0; -webkit-transform:scale3d(.3, .3, .3); transform:scale3d(.3, .3, .3) }
            50%{ opacity:1 }
        }
        .asideanimate{animation:asideanimate 1s 1 forwards;
        -webkit-animation:asideanimate 1s 1 forwards; position: fixed;}
        @-webkit-keyframes asideanimate{
            0%{ opacity:0; -webkit-transform:translate3d(0,-20%, 0); transform:translate3d(0, -20%, 0) }
            50%{ opacity:1 }
        }
        @keyframes asideanimate{
            0%{ opacity:0; -webkit-transform:translate3d(0,-20%, 0); transform:translate3d(0, -20%, 0) }
            50%{ opacity:1 }
        }
        .asideanimateleave{animation:asideanimateleave 1s 1 forwards;
        -webkit-animation:asideanimateleave 1s 1 forwards;}
        @-webkit-keyframes asideanimateleave{
            0%{ opacity:1; -webkit-transform:translate3d(0,0, 0); transform:translate3d(0, 0, 0) }
            50%{ opacity:0;-webkit-transform:translate3d(0,-20%, 0); transform:translate3d(0, -20%, 0) }
        }
        @keyframes asideanimateleave{
            0%{ opacity:1; -webkit-transform:translate3d(0,0, 0); transform:translate3d(0, 0, 0) }
            50%{ opacity:0;-webkit-transform:translate3d(0,-20%, 0); transform:translate3d(0, -20%, 0) }
        }
        @media screen and (max-width:650px) {
            .member_list{right: -30px !important;top: 34px !important;}
            .article_authorbox{display: none;}
            .nameheader{display: none;}
            .shang_box{width: 90%; margin-left:-45% }
            #imgcon{width: 90% !important; margin-left: -45% !important;max-width: inherit !important}
            .dy{padding: 12px 15px!important;font-size: 14px !important; line-height: 22px !important;}
        }
        .article_author{float:none !important;padding-top: 1px;}
        .article_cen pre{color: #666 !important; line-height: 26px; background-color: #f1f1f1}
        .articlecontent blockquote>p{ color: #666; font-size: 16px; }
    </style>
    <section class="articlewrap">
        <article class="articlecontent">
            <div class="article_top">
                <h1 class="art_title">今天跟我一起来涨姿势，深入了解一下AWS S3访问控制机制</h1>
                <p class="art_time">2017年7月17日发布</p>
                <div class="art_nav">
                    <!--<a href="">翻译文章</a>
                    <span>／</span>
                    <a href="">新闻</a>
                    <span>／</span>
                    <a href="">原创</a>-->
                                        <a href="http://www.4hou.com">首页 </a></a>
                    <span>／</span>
                    <a href="http://www.4hou.com/category/technology">技术</a>
                    <span>／</span>
                    <a href="">正文</a>

                    </ul>
                </div>
                <div class="art_type">
                    <div class="newtype">
                        <div class="read ">
                            <i class="icons"></i>
                            <span>13,509</span>
                        </div>
                        <div class="comment ">
                            <i class="icons"></i>
                            <span>0</span>
                        </div>
                        <div class="Praise">
                            <i class="icons"></i>
                            <span>9</span>
                        </div>
                    </div>
                </div>
            </div>
             <p class="dy" style="padding: 24px 60px;font-size: 16px;line-height: 30px;color: #808080;background-color: #f6f6f6;"><span style="font-weight: bold;">导语：</span>近日，美国最大的无线通信公司Verizon遭遇了一次大规模的数据泄露事件，导致超过1.4亿的美国用户个人信息暴露在网上，事后调查才知道Verizon的这些数据存储在一个不受保护的AWS S3云服务器上。</p>

            <div class="article_cen">
                <!--文章摘要-->
               
                <p><p style="text-align: center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170715/1500081838794002.jpg" title="1500081838794002.jpg" alt="69283011ly1fd9i7wzv50j20dn07ljsj.jpg"/><noscript><img src="/uploads/20170715/1500081838794002.jpg" title="1500081838794002.jpg" alt="69283011ly1fd9i7wzv50j20dn07ljsj.jpg"/></noscript></p>
<p><span style="font-size: 20px;"><strong>前言</strong></span></p>
<p>近日，美国最大的无线通信公司Verizon遭遇了一次大规模的数据泄露事件，导致超过1.4亿的美国用户个人信息暴露在网上。事后调查才知道Verizon的这些数据存储在一个不受保护的AWS S3云服务器上，任何人都可以访问并且下载这些数据。详情请点击<a href="http://www.4hou.com/info/news/6327.html" target="_self">这里</a>。</p>
<p>如果你还不了解对AWS S3的保护有多重要，那小编就告诉你，如果有人控制了你的AWS S3，那你所有的网络资料都将被人盗取。怎么样，就问你怕不怕？</p>
<p style="text-align: center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170715/1500081847611758.jpg" title="1500081847611758.jpg" alt="9-161001160325.jpg"/><noscript><img src="/uploads/20170715/1500081847611758.jpg" title="1500081847611758.jpg" alt="9-161001160325.jpg"/></noscript></p>
<p>AWS S3的访问控制设置由多个级别组成，每级都有自己独特的错误配置风险。下文，我将详细介绍每个级别的细节，并确定弱ACL可以创建易受影响的配置，从而对使用S3-bucket的个人和组织的网络安全造成影响。另外，我还会在本文介绍如何正确监控这些影响所造成的破坏。</p>
<p>译者注：bucket是S3对数据的管理单元，一个bucket类似于一组数据的根目录。</p>
<p><span style="font-size: 20px;"><strong>AWS S3的介绍</strong></span></p>
<p>S3是 AWS 最早发布的诸多服务之一，用作可信存储。所谓可信，AWS给出的概念是，在指定年度内为对象提供 99.999999999% 的持久性和高达 99.99% 的可用性，换句话说就是任何存储于S3的数据基本不可能丢失，在一个年度内，不超过1小时（3153.6s）的宕机时间。</p>
<p>AWS S3会有一个存储容器接口，存储容器称为“bucket”，bucket内的文件称为“objects”。 S3为每个bucket提供无限存储的空间，用户可以这些bucket来存放文件。可以通过个人（通过签名的URL）或通过适当配置的ACL（访问控制列表）或ACP（访问控制策略）公开存放文件。</p>
<p>另外， Amazon CloudFront还提供了一种全球内容分发网络 (CDN) 服务，可以安全地以低延迟和高传输速度向浏览者分发数据、视频、应用程序和 API。CloudFront可与 AWS 相互集成，不仅可以与直接连接到 AWS 全球基础设施的物理站点集成，也可以与多种 AWS 服务（包括S3）无缝协作软件集成，以便用户快速地从S3储存文件或对象</p>
<p><span style="font-size: 20px;"><strong>AWS S3的漏洞</strong></span></p>
<p>最近有研究人员提到了用于S3存储的bucket配置错误可能会暴露敏感数据，并解释了其中的原因可能是S3访问控制列表（ACL）与AWS中常规用户权限设置有很大不同，这些设置称为识别访问管理(IAM)。</p>
<p>不过，本文决定从另外一个角度来解释这个问题。通过识别一些不同的配置错误，我发现由于bucket和对象ACL的配置很弱，可以控制，监控和破坏高端网站（high end website）。</p>
<p><strong>测试声明</strong></p>
<p>我不建议在未经事先批准的情况下测试下列任何易受攻击的情况，这在识别漏洞的唯一方法是实际覆盖文件和配置的情况下尤其重要。但是，我发现了一种可以用来检测其中一个易受攻击的设置方法，而无需实际修改数据。</p>
<p><strong>测试技术细节</strong></p>
<p>每种配置和其影响取决于以下标准：</p>
<p>1.谁拥有S3bucket</p>
<p>2.使用什么域向bucket上传文件</p>
<p>3.bucket中有什么类型的文件</p>
<p>我将尝试通过以下所描述的不同情况，来具体解释何时可以创建易受攻击的配置错误。</p>
<p><span style="font-size: 20px;"><strong>识别bucket</strong></span></p>
<p>一开始，我需要能够识别拥有或使用的bucket的公司，另外还需要特定bucket的名称才能对bucket进行签名请求。</p>
<p>识别一个存储bucket取决于设置，以及如何访问存储bucket的方式，比如有可以直接转到S3的请求，也有CloudFront或任何其他来自bucket的CDN代理服务文件，还可以利用S3静态网站托管等。</p>
<p>识别S3-bucket的一些方法：</p>
<p>1.看看AmazonS3的服务器头的HTTP响应。</p>
<p>2.看一个不存在的随机URL，看看它是否给你一个S3-404，或者是禁用静态网站的提示，或者是访问被拒绝或NoSuchKey的提示：</p>
<p style="text-align: center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170715/1500083133330966.jpg" title="1500083133330966.jpg" alt="1.jpg"/><noscript><img src="/uploads/20170715/1500083133330966.jpg" title="1500083133330966.jpg" alt="1.jpg"/></noscript></p>
<p>3.如果主机直接指向S3，则该域的DNS条目可能会直接显示bucket名称。</p>
<p>4.尝试访问根URL，如果启用了索引列表（Bucket ACL上的public READ），你将可以看到在&lt;Name&gt; -element中定义的bucket名称。</p>
<p>如果你已经找到一个指向一个存储bucket但无法获取存储bucket名称的域名，请尝试使用实际的完全限定域名（FQDN）作为存储bucket名称，这是一个常见的设置。</p>
<p>如果这不行，请尝试以下方法：</p>
<p>1.搜索域名，查看其历史记录是否暴露了bucket名称。</p>
<p>2.查看bucket中的对象的响应头，看看它们是否具有显示存储bucket名称的元数据。</p>
<p>3.看看内容，看看它是否涉及任何一个bucket。利用这些方法，我已经看到过资料被标记为bucket名称和部署日期的实例。</p>
<p>4.使用Brute-Force算法，不要试图在S3上用几千个请求来找到一个bucket。能否找到bucket，具体取决于指向它的域的名称以及存储bucket的实际原因。如果该bucket包含域media.acme.edu上ACME的音频文件，请尝试使用media.acme.edu，acme-edu-media，acme-audio或acme-media。</p>
<p>如果$ bucket.s3.amazonaws.com上的响应显示NoSuchBucket，则表示该bucket不存在。如果存在bucket，则显示的响应应该是ListBucketResult或AccessDenied。</p>
<p>不过要注意的是，找到的bucket并不一定是对应的公司，你还要尝试直接从公司的官网查找其相关资料进行核对。</p>
<p><span style="font-size: 20px;"><strong>权限组或预定义组</strong></span></p>
<p>首先，我将用不同的方式来探讨可用于访问bucket的请求者和对象。</p>
<p><strong>用户名或电子邮件地址</strong></p>
<p>你可以使用AWS用户ID或其电子邮件地址访问AWS内的单个用户，如果你希望允许单个用户具有对该存储bucket的特定访问权限，那么这招很管用。</p>
<p><strong>AuthenticatedUsers</strong></p>
<p>这可能是AWS S3的ACL中最被误解的一个预定义组。将ACL设置为AuthenticatedUsers基本上意味着只要到计算机验证你的身份合法，你就会有一个有效的AWS凭证，即登录请求的所有AWS帐户都在该组内。请求者根本不需要拥有与bucket或对象的AWS帐户有任何关系。记住，“认证”与“授权”不一样。</p>
<p><strong>全部用户</strong></p>
<p>当设置此授权时，请求者甚至不需要进行认证请求来读取或写入任何数据，任何人都可以根据配置的策略对PUT请求进行修改或GET请求下载对象。</p>
<p><span style="font-size: 20px;"><strong>政策许可或访问控制策略</strong></span></p>
<p>可以在存储bucket或bucket中的对象上设置以下策略权限。</p>
<p>bucket和对象上的ACP控制S3的不同部分，AWS有一个功能表单，显示了每个部分的<a href="http://docs.aws.amazon.com/AmazonS3/latest/dev/acl-overview.html#permissions" target="_self">具体功能</a>。你可以在其中为bucket创建特定的IAM策略，称为bucket策略（bucket-policy）。虽然创建bucket策略也存在一定的漏洞，但是，我只是用它来涵盖在bucket和对象上设置的ACL的标准设置。</p>
<p><strong>读取</strong></p>
<p>此权限允许读取内容，如果这个ACP设置在一个bucket上，请求者可以列出bucket中的文件。如果ACP设置在对象上，则可以由请求者检索内容。</p>
<p>即使在完整的存储bucket中未设置对象访问读取，读取仍然可以在bucket中的特定对象上工作。</p>
<p>在AWS S3中进行以下ACL设置：</p>
<p style="text-align: center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170715/1500083143147156.jpg" title="1500083143147156.jpg" alt="2.jpg"/><noscript><img src="/uploads/20170715/1500083143147156.jpg" title="1500083143147156.jpg" alt="2.jpg"/></noscript></p>
<p>我仍然可以看到具体的对象：</p>
<p style="text-align: center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170715/1500083153300593.jpg" title="1500083153300593.jpg" alt="3.jpg"/><noscript><img src="/uploads/20170715/1500083153300593.jpg" title="1500083153300593.jpg" alt="3.jpg"/></noscript></p>
<p>这意味着每个对象的读取可以是不同的，与bucket上的设置无关。</p>
<p><strong>READ_ACP</strong></p>
<p>此权限允许读取bucket或对象的访问控制列表，如果启用此功能，你可以在不尝试修改内容或ACP的情况下识别易受攻击的资料。</p>
<p>即使在完整的存储bucket中未设置对象访问READ_ACP，READ_ACP仍然可以在bucket中的特定对象上工作。</p>
<p style="text-align: center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170715/1500083164211417.jpg" title="1500083164211417.jpg" alt="加图.jpg"/><noscript><img src="/uploads/20170715/1500083164211417.jpg" title="1500083164211417.jpg" alt="加图.jpg"/></noscript></p>
<p>这意味着每个对象的READ_ACP可以不同，与bucket上的设置无关。</p>
<p><strong>写入</strong></p>
<p>此权限允许写入内容，如果bucket已为用户或组启用此功能，则就可以上传，修改和创建新文件。</p>
<p>如果整个存储bucket中未设置对象访问写入，写入将无法在bucket中的特定对象上运行：</p>
<p style="text-align: center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170715/1500083178967436.jpg" title="1500083178967436.jpg" alt="45.jpg"/><noscript><img src="/uploads/20170715/1500083178967436.jpg" title="1500083178967436.jpg" alt="45.jpg"/></noscript></p>
<p>但是，如果写入设置在存储bucket中，则所有对象都将遵循，并且无法单独决定是否可写入：</p>
<p style="text-align: center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170715/1500083190190386.jpg" title="1500083190190386.jpg" alt="67.jpg"/><noscript><img src="/uploads/20170715/1500083190190386.jpg" title="1500083190190386.jpg" alt="67.jpg"/></noscript></p>
<p>这意味着，写入可以通过两种方式在bucket上进行验证，无论是通过上传随机文件，还是修改现有文件。不过修改现有文件是破坏性的，建议不要使用。下面我将介绍一种检查方法，该方法可以不用进行破坏性调用，通过触发访问控制检查和文件的实际修改之间的错误。</p>
<p><strong>WRITE_ACP</strong></p>
<p>此权限允许修改bucket或对象的权限ACL。</p>
<p>如果bucket中有一个用户或一个组启用，那么就可以修改bucket的ACL，其实这是非常糟糕的。在bucket上具有WRITE_ACP将完全暴露出由具有ACP集合的一方控制，这意味着任何对象的任何内容现在都可以由该方控制。虽然攻击者可能无法读取bucket中已有的每个对象，但仍可以完全修改现有对象。此外，S3-bucket的原始所有者在新的AWS S3控制台中的访问会被拒绝，当攻击者在删除bucket上的读取访问权时会同时声称拥有该AWS存储。</p>
<p>首先，不能访问READ_ACP或WRITE：</p>
<p style="text-align: center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170715/1500083198319427.jpg" title="1500083198319427.jpg" alt="8.jpg"/><noscript><img src="/uploads/20170715/1500083198319427.jpg" title="1500083198319427.jpg" alt="8.jpg"/></noscript></p>
<p>然后我尝试更改bucket ACL：</p>
<p style="text-align: center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170715/1500083206149810.jpg" title="1500083206149810.jpg" alt="9.jpg"/><noscript><img src="/uploads/20170715/1500083206149810.jpg" title="1500083206149810.jpg" alt="9.jpg"/></noscript></p>
<p>bucket的初始所有者现在可以看到，不过作为使用者，他们仍然可以修改bucket的策略，这是一个奇怪的情况：</p>
<p style="text-align: center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170715/1500083215175686.png" title="1500083215175686.png" alt="9.2.png"/><noscript><img src="/uploads/20170715/1500083215175686.png" title="1500083215175686.png" alt="9.2.png"/></noscript></p>
<p>现在我就可以控制一切了：</p>
<p style="text-align: center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170715/1500083225810407.jpg" title="1500083225810407.jpg" alt="10.jpg"/><noscript><img src="/uploads/20170715/1500083225810407.jpg" title="1500083225810407.jpg" alt="10.jpg"/></noscript></p>
<p>一个非常有趣的事情是，即使是在完整的数据bucket中未设置对象访问WRITE_ACP，WRITE_ACP仍然可以在bucket中的特定对象上工作：</p>
<p style="text-align: center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170715/1500083238930802.jpg" title="1500083238930802.jpg" alt="1112.jpg"/><noscript><img src="/uploads/20170715/1500083238930802.jpg" title="1500083238930802.jpg" alt="1112.jpg"/></noscript></p>
<p>此外，与此相反的写入则适用于在bucket上使用WRITE_ACP，但这并不意味着你可以直接在对象上拥有WRITE_ACP：</p>
<p style="text-align: center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170715/1500083249709968.jpg" title="1500083249709968.jpg" alt="1314.jpg"/><noscript><img src="/uploads/20170715/1500083249709968.jpg" title="1500083249709968.jpg" alt="1314.jpg"/></noscript></p>
<p>但是，通过在bucket上的WRITE_ACP执行以下步骤，你仍然可以通过用新内容替换现有对象，获得对所有对象内容的完全访问权限，：</p>
<p>1.改变bucketACL：</p>
<p style="text-align: center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170715/1500083258369230.jpg" title="1500083258369230.jpg" alt="15.jpg"/><noscript><img src="/uploads/20170715/1500083258369230.jpg" title="1500083258369230.jpg" alt="15.jpg"/></noscript></p>
<p>2.修改对象，这会将你更改为对象的所有者：</p>
<p style="text-align: center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170715/1500083267743863.jpg" title="1500083267743863.jpg" alt="16.jpg"/><noscript><img src="/uploads/20170715/1500083267743863.jpg" title="1500083267743863.jpg" alt="16.jpg"/></noscript></p>
<p>3.再次修改对象的ACP：</p>
<p style="text-align: center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170715/1500083281458178.jpg" title="1500083281458178.jpg" alt="17.jpg"/><noscript><img src="/uploads/20170715/1500083281458178.jpg" title="1500083281458178.jpg" alt="17.jpg"/></noscript></p>
<p>由于写入仍然需要在bucket上设置，因此无法在对象上升级WRITE_ACP，以便在同一个对象上获取本身的WRITE：</p>
<p style="text-align: center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170715/1500083293658191.jpg" title="1500083293658191.jpg" alt="1819.jpg"/><noscript><img src="/uploads/20170715/1500083293658191.jpg" title="1500083293658191.jpg" alt="1819.jpg"/></noscript></p>
<p>最终显示如下：</p>
<p style="text-align: center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170715/1500083303187711.jpg" title="1500083303187711.jpg" alt="20.jpg"/><noscript><img src="/uploads/20170715/1500083303187711.jpg" title="1500083303187711.jpg" alt="20.jpg"/></noscript></p>
<p>但是，你仍然可以删除对象上的所有ACP，使对象完全隐藏，这将阻止它被发送，同时给出一个403 Forbidden提示。</p>
<p>译者注：403 Forbidden 是HTTP协议中的一个状态码(Status Code)，可以简单的理解为没有权限访问此站。</p>
<p>不过，WRITE_ACP只能通过在bucket或对象上写入新的ACP来进行验证。修改现有的当然是破坏性的，但目前为止，我还没有发现一种非破坏性的测试方法。</p>
<p><span style="font-size: 20px;"><strong>FULL_CONTROL</strong></span></p>
<p>这是结合所有其他方法的一种政策。但是，即使在对象上设置了此权限，除非存储bucket已设置，否则写入仍然无法正常工作。</p>
<p><span style="font-size: 20px;"><strong>易受攻击的情况</strong></span></p>
<p>以下是公司受到AWS S3攻击的情况：</p>
<p><strong>一、在公司所有的域名上使用的bucket</strong></p>
<p>如果你发现一个由公司的子域或域服务的bucket，你应该进行以下测试：</p>
<p><strong>1.1BUCKET READ</strong></p>
<p>在bucket中列出文件，敏感信息可能会暴露出来。</p>
<p>1.2 BUCKET READ-ACP</p>
<p>来看看ACP，看看是否可以在无需测试的情况下，识别出容易受到攻击的垃圾bucket。如果能看到AllUsers或AuthenticatedUsers设置了WRITE_ACP，就知道是否可以完全控制bucket。</p>
<p>1.3BUCKET WRITE（模拟使用无效的MD5被黑的情况）</p>
<p>如果我可以将新文件上传到存储bucket，就代表我可以覆盖bucket中的任何对象。但是，如果想避免上传任何东西，可以尝试以下被黑的几种情况：</p>
<p>当对bucket进行签名的PUT请求时，我可以选择添加一个Content-MD5来告知AWS正在上传内容的校验和。事实证明，这个检查正在以下流程中进行：</p>
<p>1.3.1检查用户是否存取写入文件的权限。</p>
<p>1.3.2检查MD5校验和是否与内容匹配。</p>
<p>1.3.3上传文件。</p>
<p>由于校验和控制发生在访问该文件之后，所以我不需要写入文件。</p>
<p>以下是用bash代码模拟此场景的情况：</p>
<p style="text-align: center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170715/1500083313756041.jpg" title="1500083313756041.jpg" alt="21.jpg"/><noscript><img src="/uploads/20170715/1500083313756041.jpg" title="1500083313756041.jpg" alt="21.jpg"/></noscript></p>
<p>我可以上传到一个bucket的情况，这将导致：</p>
<p style="text-align: center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170715/1500083328362047.jpg" title="1500083328362047.jpg" alt="22.jpg"/><noscript><img src="/uploads/20170715/1500083328362047.jpg" title="1500083328362047.jpg" alt="22.jpg"/></noscript></p>
<p>我不可以上传到一个bucket的情况，这将导致：</p>
<p style="text-align: center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170715/1500083337776115.jpg" title="1500083337776115.jpg" alt="23.jpg"/><noscript><img src="/uploads/20170715/1500083337776115.jpg" title="1500083337776115.jpg" alt="23.jpg"/></noscript></p>
<p>通过对比以上两种情况，可以知道，我永远不能修改内容，只能对内容进行确认。不过这种情况仅在对象的WRITE上有效，而不是在WRITE_ACP上。</p>
<p><strong>BUCKET WRITE-ACP</strong></p>
<p>这是最危险的一个漏洞，黑客会完全升级到bucket的完全访问权限。所以要对其进行了解的唯一方法是首先弄清楚bucket的工作原理，不过前提是不会破坏任何当前的ACP。不过要注意的是，即使你无法访问READ_ACP，你仍然可以访问WRITE_ACP。</p>
<p><strong>对象读取</strong></p>
<p>我可以尝试读取由BUCKET READ发现的我感兴趣的文件的内容。</p>
<p><strong>对象写入</strong></p>
<p>不需要测试这个，因为BUCKET WRITE可以完全自我决定。如果BUCKET WRITE给出的是错误的结果，则对象不可写入，而且如果BUCKET WRITE成功，则该对象将始终可写入。</p>
<p>但是，如果使用存储bucket的公司有用户可以上传文件的应用程序，可以查看如何实现将实际文件上传到S3。如果公司正在使用POST策略上传，请特别查看$key和Content-type条件匹配中的策略。根据是否使用启动，你可以将内容类型修改为HTML / XML / SVG或类似内容，或更改正在上传的文件的位置。</p>
<p><strong>OBJECT WRITE-ACP</strong></p>
<p>我可以尝试修改特定对象的ACP，这样就不会修改内容，而只能修改文件的访问控制，使我能够停止文件的公开。</p>
<p><strong>可能的漏洞</strong></p>
<p>1.Reflected XSS(反射跨站脚本攻击)，如果我可以实现BUCKET读取，就可以找出其中的资料，并可能会发现易受攻击的对象，例如在公司域名上提供的脆弱的SWF。</p>
<p>2.Stored XSS(存储式XSS漏洞)或资料控制漏洞，如果我可以运行BUCKET写入或BUCKET WRITE-ACP，我可以修改现有内容或创建新内容，从而进一步修改javascript/css文件或上传新的HTML文件。</p>
<p>3.窃听拒绝服务(Denial of Server)漏洞，如果我可以使用OBJECT WRITE-ACP修改对象的ACP，我可以防止对象被公开加载。</p>
<p>4.信息披露（Information Disclosure）漏洞，如果我可以列出对象，很可能会找到敏感信息。</p>
<p>5.RCE漏洞，如果存储bucket包含可修改的可执行文件，这可能会导致远程执行代码（RCE）漏洞，具体取决于可执行文件的使用位置，以及是否被下载。</p>
<p><strong>二、公司使用的bucket资料</strong></p>
<p>有些项目试图自动化，如Second Order。但是，Second Order仅检查HTTP响应中引用的资料，动态加载的文件将不在被检查的范围之内。以下是使用Headless Chrome检查动态加载资料的快速示例。</p>
<p>首先，在端口9222上启动headless模式下的Chrome：</p>
<p style="text-align: center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170715/1500083350347341.jpg" title="1500083350347341.jpg" alt="24.jpg"/><noscript><img src="/uploads/20170715/1500083350347341.jpg" title="1500083350347341.jpg" alt="24.jpg"/></noscript></p>
<p>然后我可以使用一个小脚本（context.js是从HAR-capturer项目借来的）。</p>
<p style="text-align: center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170715/1500083363467992.jpg" title="1500083363467992.jpg" alt="25.1.jpg"/><noscript><img src="/uploads/20170715/1500083363467992.jpg" title="1500083363467992.jpg" alt="25.1.jpg"/></noscript></p>
<p style="text-align: center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170715/1500083375342072.jpg" title="1500083375342072.jpg" alt="25.2.jpg"/><noscript><img src="/uploads/20170715/1500083375342072.jpg" title="1500083375342072.jpg" alt="25.2.jpg"/></noscript></p>
<p>根据页面上的所有资料，我可以使用它们来确定是否在利用S3提供服务：</p>
<p style="text-align: center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170715/1500083385465038.jpg" title="1500083385465038.jpg" alt="26.jpg"/><noscript><img src="/uploads/20170715/1500083385465038.jpg" title="1500083385465038.jpg" alt="26.jpg"/></noscript></p>
<p>你应该进行的测试如下：</p>
<p>BUCKET READ-ACP</p>
<p>BUCKET WRITE</p>
<p>BUCKET WRITE-ACP</p>
<p>OBJECT WRITE-ACP</p>
<p><strong>可能的漏洞：</strong></p>
<p>1.Stored XSS(存储式XSS漏洞)或资料控制漏洞，如果我可以运行BUCKET写入或BUCKET WRITE-ACP，则可以修改现有的内容或创建新的内容，从而修改javascript / css文件或类似的内容。这取决于使用资料的位置，例如登录页面或主页面。</p>
<p>2.窃听拒绝服务(Denial of Server)漏洞，如果我可以使用OBJECT WRITE-ACP修改对象的ACP，则可以防止对象被公开加载。</p>
<p>3.RCE漏洞。如果资料是可修改的可执行文件，则可能会导致远程执行代码（RCE），具体取决于可执行文件的使用位置，以及是否被下载。</p>
<p><strong>三、如果bucket被随机发现，则代表是公司在使用</strong></p>
<p>这个解释起来有点复杂，你需要有明确的证据证明该bucket确实属于公司所有。尝试从公司找到指向此bucket的各种引用，例如其网站上的引用，CI日志或开源代码。</p>
<p>你应该进行的测试如下：</p>
<p>BUCKET READ</p>
<p>BUCKET READ-ACP</p>
<p>BUCKET WRITE&nbsp;</p>
<p>BUCKET WRITE-ACP</p>
<p>OBJECT WRITE-ACP</p>
<p><strong>可能的漏洞：</strong></p>
<p>1.Stored XSS(存储式XSS漏洞)或资料控制漏洞，如果我可以运行BUCKET写入或BUCKET WRITE-ACP，就可以修改现有的内容或创建新的内容，从而修改javascript / css文件。不过此时，我并不知道文件在哪里被使用，也就不知道对公司的影响有多大。</p>
<p>2.窃听拒绝服务(Denial of Server)漏洞，如果我可以使用OBJECT WRITE-ACP修改对象的ACP，就可以防止对象被公开加载。</p>
<p>3信息披露（Information Disclosure）漏洞，如果我可以列出对象，就可能会找到敏感信息。只有当你确认bucket确实连接到你已获得的公司时，才能执行此操作。</p>
<p>4. RCE漏洞，如果存储bucket包含可修改的可执行文件，这可能会导致远程执行代码（RCE），具体取决于可执行文件的使用位置，以及是否/被下载。</p>
<p><span style="font-size: 20px;"><strong>测试结果</strong></span></p>
<p>在本文的测试研究中，我可以确认的是我能够控制高知名度的网站（high profile website）上的资料。</p>
<p>我发现以下类别的网站都受到了AWS S3攻击的影响：</p>
<p>1.密码管理员</p>
<p>2.DNS/CDN提供商</p>
<p>3.文件存储</p>
<p>4.赌博</p>
<p>5.音视频流提供商</p>
<p>6.健康跟踪</p>
<p style="text-align: center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170715/1500083398394333.png" title="1500083398394333.png" alt="27.png"/><noscript><img src="/uploads/20170715/1500083398394333.png" title="1500083398394333.png" alt="27.png"/></noscript></p>
<p>我确定了一些公司登录页面上确实存在一些易受攻击的资料。</p>
<p>在某些情况下，虽然使用Google代码管理器（gtm.js）加载了易受攻击的资料，但是他们没有正确地进行沙箱分析，而是直接在域名上运行第三方资料（不使用www.googletagmanager.com沙箱）。</p>
<p>为此，我直接与一些第三方提供商联系，但也得到受影响公司的帮助，以便他们可以迅速识别此问题并解决。</p>
<p><span style="font-size: 20px;"><strong>如何防止AWS S3的攻击</strong></span></p>
<p>1.对第三方资料进行沙盒验证，一旦你需要第三方资料，就可以通过gtm.js，尝试使用由Google跟踪代码管理器提供的iframe或将其放置在单独的域上来隔离脚本。同时，你的提供商还要知道如何处理其文件的访问控制，以及如果使用S3进行文件服务。</p>
<p>2.如果你有自己的bucket，请查看bucketACL以验证WRITE和WRITE_ACP是否仅在特定用户上设置，而从不在诸如AllUsers或AuthenticatedUsers之类的组中。</p>
<p>3.防止任何bucket中的任何对象拥有WRITE_ACP，通过使用受限的AWS用户对你的bucket中的对象执行适当的设置，来测试自己的aws s3api put-object-acl，你可能需要更新每个对象上的ACL以完全缓解这一问题。</p>
<p>4.看看如何将对象上传到S3bucket，并确保在两个bucket和对象上设置适当的ACL。</p>
<p>5.不要使用秘密bucket名作为安全性的一种形式，因为处理Bucket_name就像已经是公开了。</p>
<p><span style="font-size: 20px;"><strong>总结</strong></span></p>
<p>通过阅读本文，你大概了解了AWS S3访问控制机制中所存在的普遍问题，它们难以识别和彻底解决，特别是如果公司使用了不同系统创建的大量存储bucket。 WRITE_ACP是最为危险的，因为在bucket和对象上都大量存在WRITE_ACP。</p>
<p>使用Cyberduck手动将文件上传到S3，以便更改文件上的访问控制：</p>
<p style="text-align: center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170715/1500083416389883.png" title="1500083416389883.png" alt="28.png"/><noscript><img src="/uploads/20170715/1500083416389883.png" title="1500083416389883.png" alt="28.png"/></noscript></p>
<p>译者注：cyberduck是一个开放源代码的ftp及sftp客户端，只需要在IP或IT上安装openssh协议就可以将mac系统的电脑和移动设备联接起来。</p>
<p><span style="font-size: 20px;"><strong>应该进行哪类检测扫描</strong></span></p>
<p>检测Web应用程序可以对以下S3错误配置漏洞进行测试，严重性范围在CVSS级别的4.4-9之间：</p>
<p>Amazon S3 bucket允许完全匿名访问</p>
<p>Amazon S3 bucket允许任意文件列表</p>
<p>Amazon S3 bucket允许任意文件上传和曝光</p>
<p>Amazon S3 bucket允许盲目上传</p>
<p>Amazon S3 bucket允许任意读取或写入对象</p>
<p>Amazon S3存储bucket显示为ACP / ACL</p>
                <div class="foot_description" style="background-color: #fff;">
                    本文翻译自：https://labs.detectify.com/2017/07/13/a-deep-dive-into-aws-s3-access-controls-taking-full-control-over-your-assets/
，如若转载，请注明来源于嘶吼：                        <a href="http://www.4hou.com/technology/6649.html" target=_blank>http://www.4hou.com/technology/6649.html</a>
                                    </div>


                 </p>
            </div>
            <div class="article_con">
                <!--文章内容-->
            </div>
            <div class="post-like">
                <a href="javascript:;" data-action="ding" target=_blank data-id="6649" class="favorite">
                <div class="zanbox">
                    <dd class="zanbefor"></dd>
                    <dd class="zanafter"></dd>
                </div>
                <span class="zantext">点赞</span>
                <span class="count">
            9</span>
                </a>
            </div>
            <div class="active_bottom">
                <ul>
                    <a class="Sina" href="http://service.weibo.com/share/share.php?url=http://www.4hou.com/technology/6649.html" title="分享到新浪微博" target="_blank"><li class="sinahover"></li></a>
                    <a onclick="window.open('http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url='+encodeURIComponent(document.location.href));return false;" title="分享到QQ空间" class="WeChat" href="javascript:void(0)" target="_blank"><li class="kj"></li></a>
                    <a onclick="dashangToggle()" class="friend" title="分享到微信、朋友圈等" target="_blank"><li class="wx"></li></a>

                </ul>
                <div class="strat icons"><span class='wpfp-span'><img src='http://img.4hou.com/wp-content/plugins/wp-favorite-posts/img/star.png' alt='Favorite' title='Favorite' class='wpfp-img' /><a class='wpfp-link' href='?wpfpaction=add&amp;postid=6649' title='收藏' rel='nofollow'>收藏</a></span></div>
                <div class="hide_box"></div>
                <div class="shang_box">
                    <a class="shang_close" href="javascript:void(0)" onClick="dashangToggle()" title="关闭"><img src="http://img.4hou.com/wp-content/themes/4houv2/images/close.jpg" alt="取消" /></a>
                    <img class="shang_logo" width="120px" src="http://img.4hou.com/wp-content/themes/4houv2/images/logo.png" alt="嘶吼" />
                    <div class="shang_tit">
                        <p>感谢您的支持，我会继续努力的!</p>
                    </div>
                    <div class="shang_payimg">
                        <img src="http://www.4hou.com/wp-content/themes/4houv2/qrcode.php?url=http%3A%2F%2Fwww.4hou.com%2Ftechnology%2F6649.html" alt="扫码支持" title="扫一扫" />
                    </div>

                    <div class="shang_info">
                        <p>打开<span id="shang_pay_txt">微信</span>扫一扫后点击右上角即可分享哟</p>
                    </div>
                </div>
            </div>
            
            <div class="avatarbottomwrap">
                 <div class="avatarboxleft">
                        <div class="avatarbottom">
                           
                            <a class="upload-img"><img alt='luochicun' src='http://img.4hou.com/wp-content/uploads/2017/07/6cfb327dad8fe371f6fa-96x96.jpg' class='avatar avatar-96 photo' height='96' width='96' /></a>
                        </div>
                        <h1 class="authornamebottom"><a href="http://www.4hou.com/member?Author=luochicun" class="upload-img" target=_blank>
                                luochicun                             </a></h1>
                        <p class="authorzybottom">这个人很懒，什么也没留下</p>

                        <div class="authorbottombox">
                            <!--<div class="gzbtn">关注</div>
                            <div class="sxbtn">私信</div>-->
                                                            <span class="gzbtn"  style="cursor: pointer;" onclick="location.href='/mybox?action=reply&to_user=luochicun&type=send'">发私信</span>
                                                    </div>
                 </div>
                <div class="authorother">
                 <a class="morearticle" href="http://www.4hou.com/member?Author=luochicun" class="upload-img" target=_blank>
                            <span class="swiper-pagination-bullet swiper-pagination-bullet-active"></span>
                            <span class="swiper-pagination-bullet swiper-pagination-bullet-active"></span>
                            <span class="swiper-pagination-bullet swiper-pagination-bullet-active"></span>
                             </a>
                    <div class="swiper-container">

                                                    <div class="swiper-wrapper">
                               
                                <div class="swiper-slide">
                                                                        <div><a href="http://www.4hou.com/technology/7653.html" target=_blank>
                                            <img data-original="/uploads/20170914/1505378346273171.jpg?imageView2/1/w/140/h/104/format/png"  class="wp-post-image"width="140" height="104"  />                                        </a></div>
                                                                        <div><a href="http://www.4hou.com/technology/7669.html" target=_blank>
                                            <img data-original="/uploads/20170916/1505492677116095.png?imageView2/1/w/140/h/104/format/png"  class="wp-post-image"width="140" height="104"  />                                        </a></div>
                                                                        <div><a href="http://www.4hou.com/technology/7620.html" target=_blank>
                                            <img data-original="/uploads/20170912/1505205779401446.jpg?imageView2/1/w/140/h/104/format/png"  class="wp-post-image"width="140" height="104"  />                                        </a></div>
                                                                        <div><a href="http://www.4hou.com/technology/7605.html" target=_blank>
                                            <img data-original="/uploads/20170909/1504930271434222.jpg?imageView2/1/w/140/h/104/format/png"  class="wp-post-image"width="140" height="104"  />                                        </a></div>
                                                                    </div>
                            </div>
                                        </div>
                </div>
                <script type="text/javascript">
                    function dashangToggle(){
                        $(".hide_box").fadeToggle();
                        $(".shang_box").fadeToggle();
                    }
                </script>
                <script> 
                    var mySwiper = new Swiper('.swiper-container', {
                        direction : 'vertical',
                        pagination : '.swiper-pagination',
                        paginationClickable :true,
                        spaceBetween : 20
                    })
                </script>
            </div>
                            <div class="review" style="margin-bottom:80px;">
    <h3 id="reply-title" class="comment-reply-title">发表评论 <small></h3>
    <form action="http://www.4hou.com/wp-comments-post.php" method="post" id="commentform">
        <p class="commentname"><label for="author">昵称</label>
            <input type="text" name="author" id="author" value="" size="14" tabindex="1" aria-required='true' placeholder = "请输入昵称" required />
        </p>
        <p class="commenteml">
            <label for="email">邮箱</label>
            <input type="text" name="email" id="email" value="" size="25" tabindex="2" aria-required='true' placeholder = "请输入邮箱地址" required />
        </p>
        <p class="comment-form-comment">
           <label for="comment">评论</label>
           <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea>
        </p>

        <p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="发表评论" />
        <input type='hidden' name='comment_post_ID' value="6649" id='comment_post_ID' />
            <input type='hidden' name='comment_parent' id='comment_parent' value='0' />
        </p>
    </form>
					
<div class="new-review">
   <ol class="commentlist">
      </ol>
   <div class="hr clearfix">&nbsp;</div>
</div>
</div>             
        </article>

        <!--作者其他文章-->
        <aside class="article_authorbox">
          <div class="article_authorbox_top">
                <div class="article_author">
            <div class="article_author_avatar">
                 <a class="upload-img"><img alt='luochicun' src='http://img.4hou.com/wp-content/uploads/2017/07/6cfb327dad8fe371f6fa-96x96.jpg' class='avatar avatar-96 photo' height='96' width='96' /></a>
            </div>
            <h1 class="article_author_name"><a href="http://www.4hou.com/member?Author=luochicun" class="upload-img" target=_blank>
                    luochicun                </a></h1>
            <p class="article_author_type">这个人很懒，什么也没留下 </p>
            <div class="article_author_bottom">
                                        <span class="send-info" onclick="location.href='/mybox?action=reply&to_user=luochicun&type=send'">发私信</span>
                         
            </div>
          </div>  
            <div class="interested">
                <h1>可能喜欢</h1>
                                                    <li>
                    <i></i>
                    <a href="http://www.4hou.com/technology/7667.html" target="_blank">小心找工作时被挖坑，有人利用 LinkedIn 发送钓鱼链接</a> 
                </li> 
                                <li>
                    <i></i>
                    <a href="http://www.4hou.com/technology/7653.html" target="_blank">一次服务器被攻击的应急行动</a> 
                </li> 
                                <li>
                    <i></i>
                    <a href="http://www.4hou.com/info/news/7646.html" target="_blank">一个Tor浏览器0day漏洞价值100万美元，其中的隐情是……</a> 
                </li> 
                                <li>
                    <i></i>
                    <a href="http://www.4hou.com/info/news/7660.html" target="_blank">Elasticsearche僵尸网络：超过4000台服务器遭到两款POS 恶意软件感染</a> 
                </li> 
                                <li>
                    <i></i>
                    <a href="http://www.4hou.com/technology/7669.html" target="_blank">渗透挑战赛：从SQL注入到管理员权限</a> 
                </li> 
                                                </div>
       </div>

          
        </aside>
    </section>
    <div id="zooming">
        <img src="" id="imgcon">
    </div>
    <script>
        $(document).ready(function() {
            $.fn.postLike = function() {
                if ($(this).hasClass('done')) {
                    return false;
                } else {
                    $(this).addClass('done');
                    var id = $(this).data("id"),
                        action = $(this).data('action'),
                        rateHolder = $(this).children('.count');
                    var ajax_data = {
                        action: "bigfa_like",
                        um_id: id,
                        um_action: action
                    };
                    $.post("/wp-admin/admin-ajax.php", ajax_data,
                        function(data) {
                            $(rateHolder).html(data);
                        });
                    return false;
                }
            };
            $(document).on("click", ".favorite",
                function() {
                    $(this).postLike();
                });


            $("img").attr("title","");
            var altcon=$(".art_title").text();
            $("img").attr("alt",altcon);
            // 图片放大
            $(".article_cen").find('img').on("click",function(){
                var imgsrc=$(this).attr("src");
                var winthimg=$(this).width();
                var zooming=winthimg*1.2;
                $("#imgcon").css({width:zooming});
                $("#imgcon").css({marginLeft:-zooming/2});
                $("#imgcon").attr("src",imgsrc);
                $("#zooming").addClass("zoomaniatae");
                $("#imgcon").addClass("imgconadimate");
            });
            $("#zooming").on("click",function(){
                $("#imgcon").removeClass("imgconadimate");
                $("#zooming").removeClass("zoomaniatae");

            });

            $(window).scroll(function(){
                var scrtop=$(window).scrollTop();
                if(scrtop>450){
                    $(".article_authorbox_top").removeClass("asideanimateleave").addClass('asideanimate')
                    // $(".interested").hide()
                }
                else if(scrtop<450&&scrtop>350){
                     $(".article_authorbox_top").addClass("asideanimateleave").removeClass('asideanimate')
                     $(".interested").show()

                }
            });
            var start=$(".strat .wpfp-span .wpfp-link").text()
            if(start=="已收藏"){
                $(".strat").addClass("stratend")
            }else{
                $(".strat").removeClass("stratend")
            }

            $(".avatar-96").width(72);
            $(".avatar-96").height(72);
            $(".avatar-120").width(50);
            $(".avatar-120").height(50);

        });
    </script>
<style type="text/css">
.footer{height:auto; background-color: #282828}
.footer_about{width: 1200px;height: 50px;padding-top: 26px; margin: 0 auto;border-bottom-color: transparent !important; position: relative;}
.footer_about>a{font-size: 16px;height: 16px !important;line-height: 16px !important; float: left; padding-right: 18px; border-right:1px solid #ccc;}
.last-child-a{border:none !important}
.footer_bottom_cen p{ margin-top: 5px; margin-right: 25px;text-align: left; margin-bottom: 6px;float: left;}
.footer_bottom_cen>div{width: 450px;float: left;margin-right: 8px}
.footer_bottom{height: 74px}
.footerlogos{width: 130px; height: 24px; position: absolute;right: 10%; top:24px;}
.footerlogos dd{float: left; margin-right: 20px;cursor: pointer;}
.footerlogos dd a{display: block;width: 100%; height: 100%}
.wechartlogo{width: 20px; height: 20px; background-position:-227px 0px;}
.weibologo{width: 20px; height: 20px; background-position:-269px 0px;}
.zhihulogo{width: 20px; height: 20px; background-position:-361px 0px;}
.wechartlogo i{width: 80px;height: 78px;background-size: contain !important; right: 137px;display: none;opacity: 1;background: url(http://www.4hou.com/wp-content/themes/4houv2/img/wechatqr.png) no-repeat;position: absolute;top: -28px;}
.wechartlogo:hover i{display: block;}
.footer_bottom{width: 1200px; background-color: #282828; margin:0 auto } 
.footer_bottom_cen>div img{float: left; margin-right: 4px;margin-top: 4px; margin-left: 4px;width: 66px;}
.footer_bottom_cen{width: 100%}
.cloudserver{float: right !important; margin: 0 auto !important;width: 385px !important; margin-top: -31px}
.cloudserver img{float: left;}
.cloudserver dd{float: left;}
@media screen and (max-width:1260px) {
    .footer{width: 100%; padding: 0px 20px;}
    .footer_about{width: 100%}
    .footer_bottom{width: 100%}
    .footer_bottom div{width: 100%;display: none;}
}
@media screen and (max-width:660px) {
    .footer_about{padding-top: 14px; margin-bottom: 22px;}
    .footerlogos{display: none;}
    .footer_bottom{height: 44px;}

}
</style>
<footer class="footer">
    <div class="footer_about">
        <a href="/about" target=_blank>关于我们</a>
        <!--<a href="">加入我们</a>-->
        <a href="/submit" target=_blank>我要投稿</a>
        <a href="/service" target=_blank>广告及服务</a>
        <a href="/partner" target=_blank class="last-child-a">友情链接</a>
        <div class="footerlogos">
                <dd class="wechartlogo icons">
                  <i></i>
                </dd>
                <dd class="weibologo icons">
                 <a href="http://weibo.com/u/6069423878" target=_blank></a>
                </dd>
                <dd class="zhihulogo icons">
                    <a href="https://zhuanlan.zhihu.com/roartalk" target=_blank></a>
                    
                </dd>
        </div>
    </div>

    <section class="footer_bottom">
        <article class="footer_bottom_cen">
            <p>©2017 北京嘶吼文化传媒有限公司&nbsp;&nbsp;&nbsp;京ICP备16063439号</p>
            <p class="mobilefooter">©2017 北京嘶吼文化传媒有限公司&nbsp;&nbsp;|&nbsp;&nbsp;京ICP备16063439号</p>
            <div class="cloudserver">
                <span>本站由</span>
                <img src="http://img.4hou.com/wp-content/themes/4houv2/img/bdcloud.png">
                <img src="http://img.4hou.com/wp-content/themes/4houv2/img/bdcloud1.png">
                <img src="http://img.4hou.com/wp-content/themes/4houv2/img/ucloud.png">
                <span>提供云计算服务</span>
            </div>
        </article>
    </section>
    <section class="footer_top" style="display:none">
        <article class="footer_top_cen">
            <div class="homeqrcode">
                <dd class="icons"></dd>
                <div class="wb">
                    <a href="http://weibo.com/u/6069423878" target=_blank>
                    <i class="icons"></i>
                    <p>关注嘶吼传媒</p>
                    </a>
                </div>

                <div class="sh">
                    <a href="https://zhuanlan.zhihu.com/roartalk" target=_blank>
                    <i class="icons"></i>
                    <p>关注嘶吼</p>
                    </a>
                </div>
            </div>
            
            <h1>合作伙伴</h1>
            <div class="footer_friend">
                <a href="http://www.xinhuanet.com/talking/chinasafety/" target=_blank>新华网安全中国</a>
                <a href="http://jaq.alibaba.com/" target=_blank>阿里聚安全</a>
                <a href="http://www.seclover.com/" target=_blank>四叶草安全</a>
                <a href="https://sec.vip.com/" target=_blank>唯品会安全应急响应中心</a>
                <a href="https://www.duoyinsu.com/" target=_blank>安识科技</a>
                <a href="http://xianzhi.aliyun.com" target=_blank>云盾先知</a>
                <a href="http://www.ardsec.com/" target=_blank>兴华永恒</a>
                <a href="https://www.sobug.com/" target=_blank>SOBUG</a>
            </div>
        </article>
    </section>
    
</footer>
<aside class="side" >
    <div class="side_top icons "></div>
    <div class="iconbox">
        <div class="side_wechart icons iconhover">微信
            <dd></dd>
        </div>
        <a href="http://weibo.com/u/6069423878" target=_blank><div class="side_webo icons iconhover">微博</div></a>
        <a href="http://www.4hou.com/feed/" target=_blank><div class="side_rss icons iconhover">RSS</div></a>
        <a href="https://zhuanlan.zhihu.com/roartalk" target=_blank><div class="side_zh icons iconhover">知乎</div></a>
    </div>
    <div class="side_bottom icons"></div>
    
</aside>

<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?ac201c14c3d2a4747423252be421e1bc";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-91554508-1', 'auto');
    ga('send', 'pageview');

</script>
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
</body>
</html>