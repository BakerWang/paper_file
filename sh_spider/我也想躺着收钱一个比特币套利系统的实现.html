<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <title>我也想躺着收钱：一个比特币套利系统的实现 - 嘶吼 RoarTalk &#8211; 回归最本质的信息安全,互联网安全新媒体,4hou.com</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="renderer" content="webkit">
    <meta property="wb:webmaster" content="4517e8fe39b18975" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,Chrome=1" />
    <meta name="description" content="记得在很早的时候就在知乎日报上看过青铜时代：中本聪之惑这篇文章，当时的我完全没有搞懂作者在说什么，只是觉得很厉害，于是在添加完收藏之后也没有在多想这件事，也没有精力去想这件事。大约在11月的时候，我终…" />
    <meta name="keywords" content="比特币套利" />
        <link href="http://img.4hou.com/wp-content/themes/4houv2/images/favicon.ico" rel="shortcut icon">
    <link href="http://img.4hou.com/wp-content/themes/4houv2/images/favicon_114.png" rel="apple-touch-icon">
    <link href="http://img.4hou.com/wp-content/themes/4houv2/images/favicon_76.png" sizes="76x76" rel="apple-touch-icon">
    <link href="http://img.4hou.com/wp-content/themes/4houv2/images/favicon_120.png" sizes="120x120" rel="apple-touch-icon">
    <link href="http://img.4hou.com/wp-content/themes/4houv2/images/favicon_152.png" sizes="152x152" rel="apple-touch-icon">

    <!-- 引入 lib -->
    <script src="http://www.4hou.com/wp-content/themes/4houv2/lib/jquery.min.js"></script>
    <script src="http://www.4hou.com/wp-content/themes/4houv2/lib/swiper.jquery.min.js"></script>
    <link rel="stylesheet" href="http://www.4hou.com/wp-content/themes/4houv2/lib/swiper.min.css">
    <link rel="stylesheet" href="http://www.4hou.com/wp-content/themes/4houv2/lib/allmin.css">
    <!--[if lt IE 11]>
    <script src="http://www.4hou.com/wp-content/themes/4houv2/lib/html5shiv.min.js"></script>
    <script src="http://www.4hou.com/wp-content/themes/4houv2/lib/respond.js"></script>
    <![endif]-->
    <!-- 引入 css js -->
    <link rel="stylesheet" href="http://www.4hou.com/wp-content/themes/4houv2/css/style.css">
    <link rel="stylesheet" href="http://www.4hou.com/wp-content/themes/4houv2/lib/allmin.css">
    <script src="http://www.4hou.com/wp-content/themes/4houv2/js/public.js"></script>
    <script src="http://www.4hou.com/wp-content/themes/4houv2/js/main.js"></script>
    <script src="http://www.4hou.com/wp-content/themes/4houv2/js/index-more.js"></script>
    </head>
<body>
<style type="text/css">
.memberlistanimate{width: 122px}
.memberlistanimateleave{width: 122px}
.nameheader{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width: 78px;display: block;}
</style>

<header class="header">
            <article class="header_center">
                <div class="logowrap">
            <a href="http://www.4hou.com"><div class="logo icons"></div></a>
            <h1>回归最本质的信息安全</h1>
        </div>
        <div class="login">
            <form action="/" class="navbar-form inSearch " name="searchform" onsubmit="return checksubmit()">
                <div class="br">
                    <span class="in-btn icons"></span>
                    <input type="text" name="s" id="search" class="animated">
                    <div class="clear icons"></div>
                </div>
                <div id="submitBtnplace" class="icons animated" value=""></div>
                <!--<input type="submit" id="submitBtn" class="icons animated" value="">-->
            </form>
                            <!--登录注册按钮-->
                 <div id="register">
                     <a href="http://www.4hou.com/register" data-event-category="Referral to Signup" data-event-action="click" data-event-label="Signup Menu button / Header">注册</a>
                 </div>
                 <div id="sing">
                      <a href="http://www.4hou.com/login" class="pzh_login">登录</a>
                 </div>

                 <div class="burger2 menu" id="burger">
                  <div class="icon"></div>
                 </div>

            
           <!-- <div id="register">注册</div>
            <div id="sing">登录</div>
            <div class="burger2 menu" id="burger">
                <div class="icon"></div>
            </div>-->
        </div>
    </article>
</header>
<nav class="navbox animated">
    <section class="navbox_cen">
        <article class="navboxleft">
            <ul class="nav navbar-nav index-nav" id="inNav">
					<li>
							<li class="cat-item cat-item-18"><a href="http://www.4hou.com/category/info" >资讯</a>
</li>
	<li class="cat-item cat-item-19"><a href="http://www.4hou.com/category/technology" >技术</a>
</li>
	<li class="cat-item cat-item-20"><a href="http://www.4hou.com/category/xactivity" >活动</a>
</li>
	<li class="cat-item cat-item-29"><a href="http://www.4hou.com/category/vulnerable" >漏洞</a>
</li>
					</li>
                    <li class="cat-item cat-item-29"><a href="http://www.4hou.com/piao" >嘶票</a>
                    </li>
            </ul>
        </article>
        <article class="navboxright">
            <div class="contrib"> <a href="http://www.4hou.com/contribute" class="tougao" data-event-category="Referral to Signup" data-event-action="click" data-event-label="Signup Menu button / Header">投稿</a></div>
        </article>
    </section>
</nav>
<div id="modelbg"></div>
    <style>


    ::selection {
    background:#fea283;
    color:#fff;
}
::-moz-selection {
    background:#fea283;
    color:#fff;
}
::-webkit-selection {
    background:#fea283;
    color:#fff;
}


        .article_cen p img{height: auto !important;}
        .commentlist .children{width: 90%; padding-right: 15px; border-color: transparent ;}
        .commentname,.commenteml{width: 60%; margin-left:5% ;margin-bottom: 30px;border-bottom: 1px solid #dbdbdb;}
        .article_cen ol li{list-style-type: decimal;}
         .article_cen ol li p{overflow: inherit;}
        .commentname label{font-size: 16px;color: #666; margin-right: 10px;line-height: 32px;}
        .commentname input{width: 50%;border: none; outline: none;}
        .commenteml label{font-size: 16px;color: #666; margin-right: 10px;line-height: 32px;}
        .commenteml input{width: 50%;border: none; outline: none;}
        #zooming{display: none;width: 100%;height: 100%; position: fixed;z-index: 999;left: 0px; top: 0px; background-color: rgba(0,0,0,.6);}
        .zoomaniatae{display: block !important;}
        .imgcon{}
        #imgcon{position: absolute;left: 50%; top: 20%;max-width: 80%}
        .article_cen img{cursor: pointer;}
        #zooming{cursor: pointer;}
        .imgconadimate{animation:imgcon 0.5s 1 forwards;
        -webkit-animation:imgcon 0.5s 1 forwards;}
        .article_authorbox{    width: 222px;min-height: 214px;
        padding-bottom: 20px;
        float: right;
        position: relative;}
        .interested{position: relative;}
        .interested>h1{font-size: 18px; font-weight: 900; position: absolute; top: -36px;color: #5e5e5e}
       .user-comment span{font-size: 13px; position: relative; top: 2px;}
        .article_authoradd{position: fixed;}
        .stratend{background:url(http://www.4hou.com/wp-content/themes/4houv2/img/starend.png); !important;background-size: contain !important;}
        .wpfp-span{opacity: 0;width:100%; height: 100%;display: block; left: 0px; top: 0px; }
        .wpfp-link{width:100%; height: 100%;display: block; left: 0px; top: 0px; }
        .wpfp-span img{display: none;}
        .interested{width: 222px;padding-bottom: 20px;background-color: #fff;margin-top: 70px; padding-bottom: 10px; padding-top: 10px;border: 1px solid #f5c2b1}
        .interested li{width: 100%;position: relative;padding-top: 8px; padding-bottom: 8px;  line-height: 24px; padding-left: 20px;padding-right: 14px}
        .interested li i{width: 6px;height: 6px;border-radius: 50%; background-color: #f63;position: absolute; left: 8px; top: 18px;}
        .interested li a{color: #666;font-size: 14px; line-height: 18px;}
        .interested li:hover{background-color: #f9e7e3;-moz-transition: all 0.4s ease-in-out;
        .footer{position: relative;z-index: 99}   
        .article_authorbox_top{position: relative;} 
        

        -o-transition: all 0.4s ease-in-out; -webkit-transition: all 0.4s ease-in-out; transition: all 0.4s ease-in-out;}
    
        @-webkit-keyframes imgcon{
            0%{ opacity:0; -webkit-transform:scale3d(.3, .3, .3); transform:scale3d(.3, .3, .3) }
            50%{ opacity:1 }
        }
        @keyframes imgcon{
            0%{ opacity:0; -webkit-transform:scale3d(.3, .3, .3); transform:scale3d(.3, .3, .3) }
            50%{ opacity:1 }
        }
        .asideanimate{animation:asideanimate 1s 1 forwards;
        -webkit-animation:asideanimate 1s 1 forwards; position: fixed;}
        @-webkit-keyframes asideanimate{
            0%{ opacity:0; -webkit-transform:translate3d(0,-20%, 0); transform:translate3d(0, -20%, 0) }
            50%{ opacity:1 }
        }
        @keyframes asideanimate{
            0%{ opacity:0; -webkit-transform:translate3d(0,-20%, 0); transform:translate3d(0, -20%, 0) }
            50%{ opacity:1 }
        }
        .asideanimateleave{animation:asideanimateleave 1s 1 forwards;
        -webkit-animation:asideanimateleave 1s 1 forwards;}
        @-webkit-keyframes asideanimateleave{
            0%{ opacity:1; -webkit-transform:translate3d(0,0, 0); transform:translate3d(0, 0, 0) }
            50%{ opacity:0;-webkit-transform:translate3d(0,-20%, 0); transform:translate3d(0, -20%, 0) }
        }
        @keyframes asideanimateleave{
            0%{ opacity:1; -webkit-transform:translate3d(0,0, 0); transform:translate3d(0, 0, 0) }
            50%{ opacity:0;-webkit-transform:translate3d(0,-20%, 0); transform:translate3d(0, -20%, 0) }
        }
        @media screen and (max-width:650px) {
            .member_list{right: -30px !important;top: 34px !important;}
            .article_authorbox{display: none;}
            .nameheader{display: none;}
            .shang_box{width: 90%; margin-left:-45% }
            #imgcon{width: 90% !important; margin-left: -45% !important;max-width: inherit !important}
            .dy{padding: 12px 15px!important;font-size: 14px !important; line-height: 22px !important;}
        }
        .article_author{float:none !important;padding-top: 1px;}
        .article_cen pre{color: #666 !important; line-height: 26px; background-color: #f1f1f1}
        .articlecontent blockquote>p{ color: #666; font-size: 16px; }
    </style>
    <section class="articlewrap">
        <article class="articlecontent">
            <div class="article_top">
                <h1 class="art_title">我也想躺着收钱：一个比特币套利系统的实现</h1>
                <p class="art_time">2017年1月6日发布</p>
                <div class="art_nav">
                    <!--<a href="">翻译文章</a>
                    <span>／</span>
                    <a href="">新闻</a>
                    <span>／</span>
                    <a href="">原创</a>-->
                                        <a href="http://www.4hou.com">首页 </a></a>
                    <span>／</span>
                    <a href="http://www.4hou.com/category/technology">技术</a>
                    <span>／</span>
                    <a href="">正文</a>

                    </ul>
                </div>
                <div class="art_type">
                    <div class="newtype">
                        <div class="read ">
                            <i class="icons"></i>
                            <span>16,942</span>
                        </div>
                        <div class="comment ">
                            <i class="icons"></i>
                            <span>2</span>
                        </div>
                        <div class="Praise">
                            <i class="icons"></i>
                            <span>0</span>
                        </div>
                    </div>
                </div>
            </div>
             <p class="dy" style="padding: 24px 60px;font-size: 16px;line-height: 30px;color: #808080;background-color: #f6f6f6;"><span style="font-weight: bold;">导语：</span>记得在很早的时候就在知乎日报上看过青铜时代：中本聪之惑这篇文章，当时的我完全没有搞懂作者在说什么，只是觉得很厉害，于是在添加完收藏之后也没有在多想这件事，也没有精力去想这件事。</p>

            <div class="article_cen">
                <!--文章摘要-->
               
                <p><p style="text-align:center"><a href="http://icybee.cn/pics/2016_01_13_07_43_34527.png"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170106/1483687138767073.png" title="1483687138767073.png" alt="1483687138767073.png" width="600" height="349" border="0" vspace="0" style="width: 600px; height: 349px;"/><noscript><img src="/uploads/20170106/1483687138767073.png" title="1483687138767073.png" alt="1483687138767073.png" width="600" height="349" border="0" vspace="0" style="width: 600px; height: 349px;"/></noscript></a></p>
<p style="text-align: left;">记得在很早的时候就在知乎日报上看过<a href="http://daily.zhihu.com/story/4831821?utm_campaign=in_app_share&#038;utm_medium=Android&#038;utm_source=Weixin&#038;from=timeline&#038;isappinstalled=0" target="_blank" title="青铜时代：中本聪之惑" textvalue="青铜时代：中本聪之惑">青铜时代：中本聪之惑</a>这篇文章，当时的我完全没有搞懂作者在说什么，只是觉得很厉害，于是在添加完收藏之后也没有在多想这件事，也没有精力去想这件事。</p>
<p style="text-align: left;">大约在11月的时候，我终于忙完了手头所有的事情，一下子闲了下来，再一次重新整理收藏夹的时候再次发现了这篇文章，于是我又聚精会神地读了一遍，这次依然没有搞懂整个系统是怎么盈利的，但是我记住了一个数字：280%，作者估计的系统年化利率，虽然没有理解这篇文章的意思，但是我还是着手开始设计一个平台,因为即使因为各种原因，只能达到作者十分之一的收益率，28%，也是极其可观的。</p>
<p style="text-align: left;">平台的第一步肯定是先抓去一部分数据进行分析，同时这也是这个系统中最简单的一个部分，当时发现中国三大比特币交易平台 火币，btcc，okcoin 都有开放的查询接口，而且接口比较稳定，所以没有必要自己去页面爬取数据了，同时我也发现，各个平台也开放了交易接口，虽然不是特别稳定，稳定性也可以凑合凑合，这是我和<a href="http://daily.zhihu.com/story/4831821?utm_campaign=in_app_share&#038;utm_medium=Android&#038;utm_source=Weixin&#038;from=timeline&#038;isappinstalled=0" target="_blank" title="青铜时代：中本聪之惑" textvalue="青铜时代：中本聪之惑">青铜时代：中本聪之惑</a>作者所处环境非常不一样的第一点：</p>
<p style="text-align: left;"><strong>技术门槛大幅度降低</strong></p>
<p style="text-align: left;">第二个不同点在抓取三个平台数据开始后不久就显现出来，</p>
<p style="text-align:center"><a href="http://icybee.cn/pics/2016_01_01_15_52_06907.png"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170106/1483687178737786.png" title="1483687178737786.png" alt="1483687178737786.png" width="600" height="302" border="0" vspace="0" style="width: 600px; height: 302px;"/><noscript><img src="/uploads/20170106/1483687178737786.png" title="1483687178737786.png" alt="1483687178737786.png" width="600" height="302" border="0" vspace="0" style="width: 600px; height: 302px;"/></noscript></a></p>
<p style="text-align: left;">上面这张图是火币和btcc的价差实时监控，可以发现的是价差非常非常的小，接近没有，而且波动幅度也不是很大，总结起来就是：</p>
<p style="text-align: left;"><strong>套利空间大幅度减小</strong></p>
<p style="text-align: left;">真的是特别大幅度的减小，知乎文章的作者提到的价差空间在几十甚至上百的范围内，而仅仅夏天到冬天，价差就已经缩小到了几乎看不到的地步，非常恐怖。</p>
<p style="text-align: left;">这两个消息一好一坏，一下动摇了我的决心，但是经过大概0.5秒的纠结，金钱的诱惑还是战胜了理性，我决定继续把项目进行下去。</p>
<p style="text-align: left;">由于当时又找了实习，所以白天实习，晚上心情好的时候就写一点，不久抓取平台就完成了，没多少工作量，然后就是漫长的数据积累阶段了，没有一定的数据，我是没法凭空设计一个模型出来的，但是平台在抓取的同时也可以做一些其他的事情，于是我开始恶补一些金融的入门级知识，比如股票的实时成交价格是怎么产生的，order book是怎么一回事，什么是盘口，市价单，现价单，冰山委托都是什么东西，交易所是怎么赢利的，什么是做市商，什么是对冲，这些东西其实都相当入门级，但是对于一个计算机系的学生来说就是天书了。</p>
<p style="text-align: left;">在吃透了这些概念之后，我终于完全理解了套利的操作是怎么进行的：</p>
<pre class="brush:html;toolbar:false">首先在两个比特币交易平台分别部署现金，并且借入一定数量的比特币
在两个平台价差拉大时在价位较高的平台卖出，在较低价位平台买入，确保数额相同
在两个平台价差缩小甚至逆转时再做逆向操作</pre>
<p style="text-align: left;">大家也可以参考一下知乎文章上的“两个苹果”的解释，这三步操作其实描述的就是一个对冲，对冲是一种规避风险的方法，这里被对冲掉的就是比特币本身的价值，也就是说，本来我们在投资比特币本身，通过对冲，我们实际上在投资的是比特币市场之间的价差：</p>
<p style="text-align:center"><a href="http://icybee.cn/pics/2016_01_01_16_23_48592.png"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170106/1483687221566717.png" title="1483687221566717.png" alt="1483687221566717.png" width="600" height="307" border="0" vspace="0" style="width: 600px; height: 307px;"/><noscript><img src="/uploads/20170106/1483687221566717.png" title="1483687221566717.png" alt="1483687221566717.png" width="600" height="307" border="0" vspace="0" style="width: 600px; height: 307px;"/></noscript></a></p>
<p style="text-align: left;">这个行为有一个学术点的名字：统计套利</p>
<p style="text-align: left;">整个统计套利的基石就在于把比特币币值变化的风险给对冲掉，所以我们必须做到以下几点：</p>
<pre class="brush:html;toolbar:false">平台上部署的比特币必须是借来的（或者说是融币融来的）
必须保证价差计算准确，不能有太多的滑点（实际成交价格和意向成交价格的偏差）
同时整个系统的延迟必须做到最小，否则在两个交易所的下单会受到币值波动的影响</pre>
<p style="text-align: left;">但是这里就有一个问题了，投资价差和投资比特币本身有什么区别呢？区别只有一个，就是价差收敛，什么叫价差收敛呢？就是说价差虽然会有变化，但是始终是稳定在某个值附近，实际导致这个现象的原因是不同比特币交易所买卖的实际上是同一个东西——比特币。就像不同地方的麦当劳一样，价格可能会有不同，但总体上这种价差不会发生太大变化，总是在某个值上下变化。利用这个特点我们就可以做出一些有意思的策略了。</p>
<p style="text-align: left;">但是想要对冲掉比特币本身的价值就意味着需要融币，融币意味着每天千分之一左右的利息，就是说如果今天你的策略获得的利润小于千分之一，那么即使你的策略能够产生利润，也是没有价值的。</p>
<p style="text-align: left;">在对比特币的不断了解中，我也发现了比特币的魅力之处：</p>
<pre class="brush:html;toolbar:false">所有交易所全天候24小时交易
国内三大交易所的比特币人民币现货交易完全没有手续费，但是提现的时候会有手续费和延迟
完全没有涨幅和跌幅的限制，也就是说在一分钟之内理论上来说完全有可能1个比特币会变成不如一张厕纸值钱，也可能变得比一吨黄金还贵
监管很少，交易所有整个跑路的风险（参考Mt.Gox）</pre>
<p style="text-align: left;">抛开比特币本质不谈，比特币交易的这些性质简直就是金融的一朵奇葩，所以比特币交易的数据也是非常有特点，或者说非常有价值的，这也更加激发了我对比特币的兴趣。</p>
<p style="text-align: left;">在收集数据的同时，我也开始了套利平台的一些基础建设，根据设计，平台划分为几个大的并且互相几乎完全独立的模块：</p>
<p style="text-align: left;"><span style="font-size: 20px; color: rgb(38, 38, 38);"><strong>哈勃（hubble）</strong></span></p>
<p style="text-align:center"><a href="http://icybee.cn/pics/2016_01_03_14_48_25318.jpg"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170106/1483687276150403.jpg" title="1483687276150403.jpg" alt="0000.jpg"/><noscript><img src="/uploads/20170106/1483687276150403.jpg" title="1483687276150403.jpg" alt="0000.jpg"/></noscript></a></p>
<p style="text-align: left;">hubble 模块的计划功能是图形化的数据抓取和展示平台，作用是数据可视化，提供平台的价格和差价的可视化功能。当时的希望是能够通过hubble来目测发现一些市场的基本规律。最后hubble整个是用web2py框架写的，抓取则用的是crontab，提供市场分钟级的数据展示，用来观察市场走势。</p>
<p style="text-align: left;"><span style="font-size: 20px; color: rgb(38, 38, 38);"><strong>南柯（Nanke）</strong></span></p>
<p style="text-align:center"><a href="http://icybee.cn/pics/2016_01_03_14_54_50707.jpg"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170106/1483687316601158.jpg" title="1483687316601158.jpg" alt="9.jpg"/><noscript><img src="/uploads/20170106/1483687316601158.jpg" title="1483687316601158.jpg" alt="9.jpg"/></noscript></a></p>
<p style="text-align: left;">取名自南柯一梦，作用是市场数据的回测，为了回测方便，我把策略逻辑和框架逻辑分离，最后南柯模块可以直接在网页上编辑和回测策略，并且查看报告。取名南柯其实也是警示自己，回测再美好也是南柯一梦。</p>
<p style="text-align: left;"><span style="font-size: 20px; color: rgb(38, 38, 38);"><strong>黄粱（Huangliang）</strong></span></p>
<p style="text-align: left;">计划中南柯的姊妹模块，提供比南柯更精细的回测功能，但是目前并没有开发。</p>
<p style="text-align: left;"><span style="font-size: 20px; color: rgb(38, 38, 38);"><strong>矩阵（matrix）</strong></span></p>
<p style="text-align:center"><a href="http://icybee.cn/pics/2016_01_03_15_01_39131.jpg"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170106/1483687350898312.jpg" title="1483687350898312.jpg" alt="99.jpg"/><noscript><img src="/uploads/20170106/1483687350898312.jpg" title="1483687350898312.jpg" alt="99.jpg"/></noscript></a></p>
<p style="text-align: left;">是的，矩阵取名自黑客帝国，这个模块很有意思，是一个根据即时交易所价格模拟策略在交易所行为的模块，在南柯初期验证过的策略代码在上线之前都需要经过matrix的模拟，但是matrix目前的功能比较有限，只能模拟交易所的市价单行为，因为市价单只需要再查一遍order book就可以了，但这对于我来说已经足够，matrix还可以模拟交易所的交易延迟和交易失败造成的影响，并且也支持在线编辑策略代码和热加载，热重载，和同时模拟多个策略的行为。</p>
<p style="text-align: left;">但是，matrix这个模块的名字也时刻提醒着我，再真实，也是假的，matrix不能也不可能模拟市场的全部行为，一切以线上为准。实际上也由于种种原因，市场的行为在中高频的情况下也和matrix有相当的差异。</p>
<p style="text-align: left;"><span style="font-size: 20px; color: rgb(38, 38, 38);"><strong>斯叶特（sjet）</strong></span></p>
<p style="text-align:center"><a href="http://icybee.cn/pics/2016_01_03_15_12_50292.jpg"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170106/1483687384797022.jpg" title="1483687384797022.jpg" alt="999.jpg"/><noscript><img src="/uploads/20170106/1483687384797022.jpg" title="1483687384797022.jpg" alt="999.jpg"/></noscript></a></p>
<p style="text-align: left;">先说一下命名吧，卡伦·斯叶特是一款非常老的游戏《homeworld》中库申人的精神领袖，是一个女科学家，把自己嵌入到了库申人的巨大飞船mothership中作为生物cpu，这个游戏也是第一款让我感动的游戏，有兴趣大家可以了解下。把这个传奇作为模块的名字，模块的作用也很明显了：sjet是整个平台的核心，是线上策略运行的地方，也运用了和matrix相近的技术，支持策略脚本的线上编辑和热重载，理论上sjet和matrix的策略脚本可以通用，就是说在matrix经过验证的策略理论上可以无缝直接在线上运行，但是实际操作的时候还是有一些策略需要经过一些小修改才能上线到sjet。</p>
<p style="text-align: left;">还有一些小模块不表</p>
<p style="text-align: left;"><span style="font-size: 20px; color: rgb(38, 38, 38);"><strong>框架开发中遇到的一些技术问题Q&amp;A</strong></span></p>
<p style="text-align: left;"><strong>如何让程序持续抓取？</strong></p>
<p style="text-align: left;">这个问题有两种解决方案：</p>
<pre class="brush:html;toolbar:false">crontab定时抓取
demon进程中循环抓取</pre>
<p style="text-align: left;">其中hubble模块使用了第一种而matrix和sjet模块使用了第二种。</p>
<p style="text-align: left;"><strong>如何实现热加载，热重载python策略脚本？</strong></p>
<p style="text-align: left;">初始化时直接import 策略模块，循环判断策略脚本是否发生变化，如果发生变化，则重新加载,唯一需要注意的一点是在重载是不能直接再次import模块，而要使用python的reload语句。这里还有一点就是由于需要在线上程序运行的时候热重载，所以最好要把策略做成无状态的，就算有状态的话最好也要用文件，或者数据库，或者redis的形式存储下来，否则策略一重载状态就没了。另一个需要注意的地方是由于程序常驻内存，所以不当的策略会导致内存泄漏，稍微注意一下就行。</p>
<p style="text-align: left;"><strong>程序需要在两方下单，要是一方失败了怎么办？</strong></p>
<p style="text-align: left;">需要对双方的下单进行事务化处理，但是这种事务和数据库的事务完全不同，而是类似于分布式事务，对于fail的处理需要谨慎，在一次套利开始时纪录下两个市场账户中的比特币分布和期望中交易完成后时称中的比特币分布情况，接下来分别发送两个下单请求，然后锁住整个交易系统，接下来在市场账户中的比特币分布达到成功条件或失败条件时解锁交易系统继续交易,在其他情况下判断交易应该继续进行还是回滚，走相应的逻辑就行。</p>
<p style="text-align: left;"><strong>交易受滑点的影响太大怎么办？</strong></p>
<p style="text-align: left;">这个也是目前交易中遇到的最大问题，策略经常在南柯和矩阵中运行非常良好，但是一到sjet就开始亏钱，揪其原因就是滑点太大，这个问题目前来看几乎是无解的，只能设计一些策略来减少滑点造成的损失。</p>
<p style="text-align: left;"><strong>目前自动化交易的利润空间有多大？</strong></p>
<p style="text-align: left;">我手头上也没有具体数据，但是就目前这个策略上线这几天的运行情况来看，是一个数学期望大于30%的年化收益率，但是风险（方差）非常大，而且需要更多时间来验证，但是不排除今后设计更好的策略能够提升。</p>
<p style="text-align: left;"><strong>为什么使用市价单而不考虑限价单这种不会产生滑点的手段？</strong></p>
<p style="text-align: left;">也考虑过，限价单并不是立即成交的，有可能一直不成交，会大大增加套利事务的复杂性，不是不想用，是没想好怎么用才合适。</p>
<p style="text-align: left;"><span style="font-size: 20px; color: rgb(38, 38, 38);"><strong>交易策略</strong></span></p>
<p style="text-align: left;">在解决了这些框架开发的问题之后，我终于可以将注意力集到交易策略上了,按照知乎文章上的思路，首先是找出两个市场价差分布的均值E和方差σ，然后再确定一个大于0的参数α，然后在价差大于E＋ασ时做正向搬运，当价差小于E－ασ时做反向搬运，这是一个简单而有效的策略，唯一可能导致亏损的点就是交易时的滑点了。</p>
<p style="text-align: left;">这里唯一需要确定的参数是α，一个较小的α意味着更多的交易次数，但是也意味着每次交易的利润会变小，然而南柯和matrix的模拟显示这也意味着更多的总利润，这是比较耐人寻味的一点。然而减小α的代价就是系统受滑点的影响也就更大，如果没有较强的高频交易能力，一个较小的α会让你亏成翔。抛开其他问题不谈，我们肯定是希望有一个尽可能小的α,但是由于这个系统的交易延迟有1～2秒之久，比一个高频系统的最低要求都差太多了，只能算是一个中低频的自动交易系统，所以说α就不能选的很小了。绝对不要小看这一两秒，这一两秒足够让一个在matrix和南柯上爆赚的策略在实盘亏成翔,所以说：回测很丰满，现实很骨感。这句话绝对非常非常有道理。</p>
<p style="text-align: left;">我们不妨把上面这个策略称为simple sigma，整个simple sigma策略的假设就有这几点：</p>
<pre class="brush:html;toolbar:false">两个市场的价差不恒定，而是在某个数值（E）附近上下波动
两个市场的价差大体上符合正态分布</pre>
<p style="text-align: left;">这两个假设都是基本上正确的，所以说理论上这个策略是可以做到盈利的。</p>
<p style="text-align: left;"><span style="font-size: 20px; color: rgb(38, 38, 38);"><strong>深入思考两个假设</strong></span></p>
<p style="text-align: left;">虽然上面两个假设都是正确的，但是实际上微观的价差的分布并不总是围绕平均值波动，并且如果根据历史数据计算出一个价差的平均值，那么谁也没法保证这个平均值在将来也会适用，我们观察一下下面这张图：</p>
<p style="text-align:center"><a href="http://icybee.cn/pics/2016_01_12_03_27_26144.png"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170106/1483687443219017.png" title="1483687443219017.png" alt="1483687443219017.png" width="600" height="299" border="0" vspace="0" style="width: 600px; height: 299px;"/><noscript><img src="/uploads/20170106/1483687443219017.png" title="1483687443219017.png" alt="1483687443219017.png" width="600" height="299" border="0" vspace="0" style="width: 600px; height: 299px;"/></noscript></a></p>
<p style="text-align: left;">这张图显示的是火币和btcc两个市场1月4日到1月6日三天的价差数据，在前一个红框里，价差围绕着3.5左右波动，而在后一个红框里，价差围绕着0上下波动，如果我们按照simple sigma策略的思路，那么我们就会失去1月6号几乎一整天的套利空间。</p>
<p style="text-align: left;">我们需要的，是一个能够动态反应价差“均值”的标志，它不能变化得太快，否则会失去“均值”的作用，也不能太慢，否则难以跟上价差的变化幅度，所以必须有一个参数来确定这一点。</p>
<p style="text-align: left;">也就是在这个时候，我想到了之前做智能车的时候运用到的一个数学工具，<a href="http://blog.sina.com.cn/s/blog_808b1cb80100zb79.html" target="_blank" title="互补滤波" textvalue="互补滤波">互补滤波</a>，整个智能车项目对于我来说就是一场巨大的悲剧，但是我却记住了互补滤波，互补滤波原本的作用是过滤掉一些信号中的高频杂音，从而提取出有用的低频信号，但是在不同的场景下也有一些其他的用途，但是是否适合运用在这里，效果如何呢？</p>
<p style="text-align: left;">不了解互补滤波的同学可以<a href="http://google.icybee.cn/#q=%E4%BA%92%E8%A1%A5%E6%BB%A4%E6%B3%A2" target="_blank" title="戳这里" textvalue="戳这里">戳这里</a></p>
<p style="text-align: left;">接着首先，我修改了simple sigma策略，将其中的E(均值)换成了互补滤波的输出，并且在南柯和matrix上进行了回测和模拟，回测和模拟都显示这种新的策略比simple sigma的盈利多30%以上，那么理论上，这个策略还不错。</p>
<p style="text-align: left;">（后来看《<a href="https://pan.icybee.cn/index.php/s/3FhNK68pGasyjUs" target="_blank" title="统计套利" textvalue="统计套利">统计套利</a>》这本书才知道，这种方法早也被人发明出来了，叫<a href="http://wiki.mbalib.com/wiki/%E5%8A%A0%E6%9D%83%E7%A7%BB%E5%8A%A8%E5%B9%B3%E5%9D%87%E6%B3%95" target="_blank" title="指数加权平均移动模型" textvalue="指数加权平均移动模型">指数加权平均移动模型</a>,所以说多读一点书还是可以少走一些弯路的）</p>
<p style="text-align: left;">总的来说，用上了互补滤波的策略之所以比simple sigma表现得更好，还是因为它正确地精细化了市场价格差波动的模型，现在模型的假设是这样的：</p>
<pre class="brush:html;toolbar:false">两个市场的价差不恒定，在某个特定时间段内会在某个数值（E）附近上下波动
两个市场的价差大体上符合正态分布
一个时间段内市场的价差大体也符合正态分布</pre>
<p style="text-align: left;">是否还有能更加正确或者更加精细市场行为的模型呢？我认为肯定是有的，只是我没有发现而已，如果大家觉得自己发现了一些有意思的市场规律，一定要告诉我。但在发现更好的模型前，就用它上线了。</p>
<p style="text-align: left;"><span style="font-size: 20px; color: rgb(38, 38, 38);"><strong>上线那些事</strong></span></p>
<p style="text-align: left;">由于本人技术太渣，上面这些事情做完时，时间已经从11月中旬到达了12月末，除了sjet之外的模块都已经上线，只剩下最重要的实盘策略模块sjet了。于是我挑了一个好日子上线，12月31日晚上，这样一来，系统第一次盈利就会在1月1日这样一个好日子，以后装逼的时候就可以说在2016年的第一天我上线了一个牛逼的系统，然后如何如何，想想也有些小激动呢。其实真正的原因是平时要实习，也只有元旦假期才能确保我有充分的时间处理刚上线系统中的各种bug。</p>
<p style="text-align: left;">上线的时候，我选择了一个非常保守的仓位，0.01比特币，大概是30块钱，所以就算我的系统爆炸，也就是半天饭钱而已。果不其然，系统完全被各种bug所困扰，只进行了一两次有效交易，而且由于各种bug，系统完全在贴钱，新年第一天的也时不时的需要查看一下系统的稳定性，我也是醉了。</p>
<p style="text-align: left;">新年的第一天不仅没有盈利，系统反而因为稳定性原因亏掉了1毛钱，但是上线还是勉勉强强上去了。装逼失败。</p>
<p style="text-align: left;">1号2号基本上解决了系统的各种bug，3号把收益的图形化模块上线了，终于从图形化界面上看到系统第一次盈利：</p>
<p style="text-align:center"><a href="http://icybee.cn/pics/2016_01_15_09_12_49750.png"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170106/1483687508898846.png" title="1483687508898846.png" alt="1483687508898846.png" width="600" height="287" border="0" vspace="0" style="width: 600px; height: 287px;"/><noscript><img src="/uploads/20170106/1483687508898846.png" title="1483687508898846.png" alt="1483687508898846.png" width="600" height="287" border="0" vspace="0" style="width: 600px; height: 287px;"/></noscript></a></p>
<p style="text-align: left;">然而还没来得及高兴多久，刚刚盈利的money马上给亏回去了：</p>
<p style="text-align:center"><a href="http://icybee.cn/pics/2016_01_15_09_14_38867.png"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170106/1483687546809440.png" title="1483687546809440.png" alt="1483687546809440.png" width="600" height="317" border="0" vspace="0" style="width: 600px; height: 317px;"/><noscript><img src="/uploads/20170106/1483687546809440.png" title="1483687546809440.png" alt="1483687546809440.png" width="600" height="317" border="0" vspace="0" style="width: 600px; height: 317px;"/></noscript></a></p>
<p style="text-align: left;">调查原因发现策略本身没有问题，是滑点造成的利润损失，于是6,7号两天我开始尝试调整模型参数（调大α），并且加入一些策略（在开始交易前考虑价差变化方向和速度），希望能够有效遏制滑点，结果是滑点没有消失，但是严重程度有所减轻，经过一周多的验证，系统可以盈利：</p>
<p style="text-align:center"><a href="http://icybee.cn/pics/2016_01_15_09_21_33183.png"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170106/1483687582266826.png" title="1483687582266826.png" alt="1483687582266826.png" width="600" height="180" border="0" vspace="0" style="width: 600px; height: 180px;"/><noscript><img src="/uploads/20170106/1483687582266826.png" title="1483687582266826.png" alt="1483687582266826.png" width="600" height="180" border="0" vspace="0" style="width: 600px; height: 180px;"/></noscript></a></p>
<p style="text-align: left;">后几天的时间慢慢把系统的监控模块titan也上线了，系统收益和稳定性报警都能够通过短信形式直接发送到手机上，实现了半个自动化运维。</p>
<p style="text-align:center"></p>
<p style="text-align:center"><a href="http://icybee.cn/pics/2016_01_27_06_28_50465.jpg"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170106/1483687635493481.jpg" title="1483687635493481.jpg" alt="1483687635493481.jpg" width="500" height="889" border="0" vspace="0" style="width: 500px; height: 889px;"/><noscript><img src="/uploads/20170106/1483687635493481.jpg" title="1483687635493481.jpg" alt="1483687635493481.jpg" width="500" height="889" border="0" vspace="0" style="width: 500px; height: 889px;"/></noscript></a></p>
<p style="text-align:center"><img src="http://img.4hou.com/wp-content/themes/4houv2/img/lazy.gif" data-original="/uploads/20170106/1483687666963978.jpg" title="1483687666963978.jpg" alt="1483687666963978.jpg" width="500" height="889" border="0" vspace="0" style="width: 500px; height: 889px;"/><noscript><img src="/uploads/20170106/1483687666963978.jpg" title="1483687666963978.jpg" alt="1483687666963978.jpg" width="500" height="889" border="0" vspace="0" style="width: 500px; height: 889px;"/></noscript></p>
<p style="text-align: left;">当然系统中还有很多非常不完善的地方，并且算法还存在非常大的继续优化的空间，也希望对交易算法有了解或者感兴趣的同学email我或者私信我,我们可以一起改进这个系统。</p>
<p style="text-align: left;">本文转载自http://icybee.cn/article/52.html</p>
                <div class="foot_description" style="background-color: #fff;">
                    本文转载自icybee's blog，如若转载，请注明来源于嘶吼：                        <a href="http://www.4hou.com/technology/2897.html" target=_blank>http://www.4hou.com/technology/2897.html</a>
                                    </div>


                 </p>
            </div>
            <div class="article_con">
                <!--文章内容-->
            </div>
            <div class="post-like">
                <a href="javascript:;" data-action="ding" target=_blank data-id="2897" class="favorite">
                <div class="zanbox">
                    <dd class="zanbefor"></dd>
                    <dd class="zanafter"></dd>
                </div>
                <span class="zantext">点赞</span>
                <span class="count">
            0</span>
                </a>
            </div>
            <div class="active_bottom">
                <ul>
                    <a class="Sina" href="http://service.weibo.com/share/share.php?url=http://www.4hou.com/technology/2897.html" title="分享到新浪微博" target="_blank"><li class="sinahover"></li></a>
                    <a onclick="window.open('http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url='+encodeURIComponent(document.location.href));return false;" title="分享到QQ空间" class="WeChat" href="javascript:void(0)" target="_blank"><li class="kj"></li></a>
                    <a onclick="dashangToggle()" class="friend" title="分享到微信、朋友圈等" target="_blank"><li class="wx"></li></a>

                </ul>
                <div class="strat icons"><span class='wpfp-span'><img src='http://img.4hou.com/wp-content/plugins/wp-favorite-posts/img/star.png' alt='Favorite' title='Favorite' class='wpfp-img' /><a class='wpfp-link' href='?wpfpaction=add&amp;postid=2897' title='收藏' rel='nofollow'>收藏</a></span></div>
                <div class="hide_box"></div>
                <div class="shang_box">
                    <a class="shang_close" href="javascript:void(0)" onClick="dashangToggle()" title="关闭"><img src="http://img.4hou.com/wp-content/themes/4houv2/images/close.jpg" alt="取消" /></a>
                    <img class="shang_logo" width="120px" src="http://img.4hou.com/wp-content/themes/4houv2/images/logo.png" alt="嘶吼" />
                    <div class="shang_tit">
                        <p>感谢您的支持，我会继续努力的!</p>
                    </div>
                    <div class="shang_payimg">
                        <img src="http://www.4hou.com/wp-content/themes/4houv2/qrcode.php?url=http%3A%2F%2Fwww.4hou.com%2Ftechnology%2F2897.html" alt="扫码支持" title="扫一扫" />
                    </div>

                    <div class="shang_info">
                        <p>打开<span id="shang_pay_txt">微信</span>扫一扫后点击右上角即可分享哟</p>
                    </div>
                </div>
            </div>
            
            <div class="avatarbottomwrap">
                 <div class="avatarboxleft">
                        <div class="avatarbottom">
                           
                            <a class="upload-img"><img alt='lujiang' src='http://img.4hou.com/wp-content/uploads/2017/06/4255a2f42cdedce6cde0-96x96.jpg' class='avatar avatar-96 photo' height='96' width='96' /></a>
                        </div>
                        <h1 class="authornamebottom"><a href="http://www.4hou.com/member?Author=lujiang" class="upload-img" target=_blank>
                                lujiang                                                            <i class="mem_level"></i>
                             </a></h1>
                        <p class="authorzybottom">嘶吼资讯编辑</p>

                        <div class="authorbottombox">
                            <!--<div class="gzbtn">关注</div>
                            <div class="sxbtn">私信</div>-->
                                                            <span class="gzbtn"  style="cursor: pointer;" onclick="location.href='/mybox?action=reply&to_user=lujiang&type=send'">发私信</span>
                                                    </div>
                 </div>
                <div class="authorother">
                 <a class="morearticle" href="http://www.4hou.com/member?Author=lujiang" class="upload-img" target=_blank>
                            <span class="swiper-pagination-bullet swiper-pagination-bullet-active"></span>
                            <span class="swiper-pagination-bullet swiper-pagination-bullet-active"></span>
                            <span class="swiper-pagination-bullet swiper-pagination-bullet-active"></span>
                             </a>
                    <div class="swiper-container">

                                                    <div class="swiper-wrapper">
                               
                                <div class="swiper-slide">
                                                                        <div><a href="http://www.4hou.com/info/news/7621.html" target=_blank>
                                            <img data-original="/uploads/20170912/1505208668911359.jpeg?imageView2/1/w/140/h/104/format/png"  class="wp-post-image"width="140" height="104"  />                                        </a></div>
                                                                        <div><a href="http://www.4hou.com/info/news/7206.html" target=_blank>
                                            <img data-original="http://img.4hou.com/wp-content/uploads/2017/08/0b9b488ca11f290b61c6.png?imageView2/1/w/140/h/104/format/png"  class="wp-post-image"width="140" height="104"  />                                        </a></div>
                                                                        <div><a href="http://www.4hou.com/info/news/6327.html" target=_blank>
                                            <img data-original="http://img.4hou.com/wp-content/uploads/2017/07/6e4f663a5433df33f0c6.png?imageView2/1/w/140/h/104/format/png"  class="wp-post-image"width="140" height="104"  />                                        </a></div>
                                                                        <div><a href="http://www.4hou.com/info/news/6174.html" target=_blank>
                                            <img data-original="http://img.4hou.com/wp-content/uploads/2017/07/346668eadb3b13b2a977.png?imageView2/1/w/140/h/104/format/png"  class="wp-post-image"width="140" height="104"  />                                        </a></div>
                                                                    </div>
                            </div>
                                        </div>
                </div>
                <script type="text/javascript">
                    function dashangToggle(){
                        $(".hide_box").fadeToggle();
                        $(".shang_box").fadeToggle();
                    }
                </script>
                <script> 
                    var mySwiper = new Swiper('.swiper-container', {
                        direction : 'vertical',
                        pagination : '.swiper-pagination',
                        paginationClickable :true,
                        spaceBetween : 20
                    })
                </script>
            </div>
                            <div class="review" style="margin-bottom:80px;">
    <h3 id="reply-title" class="comment-reply-title">发表评论 <small></h3>
    <form action="http://www.4hou.com/wp-comments-post.php" method="post" id="commentform">
        <p class="commentname"><label for="author">昵称</label>
            <input type="text" name="author" id="author" value="" size="14" tabindex="1" aria-required='true' placeholder = "请输入昵称" required />
        </p>
        <p class="commenteml">
            <label for="email">邮箱</label>
            <input type="text" name="email" id="email" value="" size="25" tabindex="2" aria-required='true' placeholder = "请输入邮箱地址" required />
        </p>
        <p class="comment-form-comment">
           <label for="comment">评论</label>
           <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea>
        </p>

        <p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="发表评论" />
        <input type='hidden' name='comment_post_ID' value="2897" id='comment_post_ID' />
            <input type='hidden' name='comment_parent' id='comment_parent' value='0' />
        </p>
    </form>
					
<div class="new-review">
   <ol class="commentlist">
   <div class="comment-box" id="li-comment-302">
    <div class="avatar fl"><img alt='Mystery' src='http://img.4hou.com/wp-content/uploads/2017/06/14deb5623f628726870e-120x120.png' class='avatar avatar-120 photo' height='120' width='120' /></div>
    <!--评论列表-->
    <div class="user-comment">
    <!--评论人-->
  <a id="c-man" href="http://www.4hou.com/member?Author=Mystery" class="nick">Mystery</a>
    <i class="level_v"></i>
  <!--评论时间-->
  <span>2017-01-07 13:20</span>
  <!--评论内容-->
<p>测试中</p>
  <!--回复按钮-->
  <div class="reply clearfix">
<a rel='nofollow' class='comment-reply-link' href='http://www.4hou.com/technology/2897.html?replytocom=302#respond' onclick='return addComment.moveForm( "comment-302", "302", "respond", "2897" )' aria-label='回复给Mystery'>回复</a>  </div>
  </div>
<script>
  $("#replybtn").click(function(){
     $("#ta").text("Mystery");
     $("#comment").focus();
  })
</script>
  <!--评论审核提示-->
  <div class="comment_text">
  </div>
</div>
</li><!-- #comment-## -->
<div class="comment-box" id="li-comment-301">
    <div class="avatar fl"><img alt='' src='http://cn.gravatar.com/avatar/321b7eed17b993a380b77df142098527?s=120&#038;d=mm&#038;r=g' srcset='http://cn.gravatar.com/avatar/321b7eed17b993a380b77df142098527?s=240&amp;d=mm&amp;r=g 2x' class='avatar avatar-120 photo' height='120' width='120' /></div>
    <!--评论列表-->
    <div class="user-comment">
    <!--评论人-->
  <a id="c-man" href="http://www.4hou.com/member?Author=r4bb1t" class="nick">r4bb1t</a>
  <!--评论时间-->
  <span>2017-01-06 18:51</span>
  <!--评论内容-->
<p>厉害了</p>
  <!--回复按钮-->
  <div class="reply clearfix">
<a rel='nofollow' class='comment-reply-link' href='http://www.4hou.com/technology/2897.html?replytocom=301#respond' onclick='return addComment.moveForm( "comment-301", "301", "respond", "2897" )' aria-label='回复给r4bb1t'>回复</a>  </div>
  </div>
<script>
  $("#replybtn").click(function(){
     $("#ta").text("r4bb1t");
     $("#comment").focus();
  })
</script>
  <!--评论审核提示-->
  <div class="comment_text">
  </div>
</div>
</li><!-- #comment-## -->
   </ol>
   <div class="hr clearfix">&nbsp;</div>
</div>
</div>             
        </article>

        <!--作者其他文章-->
        <aside class="article_authorbox">
          <div class="article_authorbox_top">
                <div class="article_author">
            <div class="article_author_avatar">
                 <a class="upload-img"><img alt='lujiang' src='http://img.4hou.com/wp-content/uploads/2017/06/4255a2f42cdedce6cde0-96x96.jpg' class='avatar avatar-96 photo' height='96' width='96' /></a>
            </div>
            <h1 class="article_author_name"><a href="http://www.4hou.com/member?Author=lujiang" class="upload-img" target=_blank>
                    lujiang                                    <i class="mem_level"></i>
                </a></h1>
            <p class="article_author_type">嘶吼资讯编辑 </p>
            <div class="article_author_bottom">
                                        <span class="send-info" onclick="location.href='/mybox?action=reply&to_user=lujiang&type=send'">发私信</span>
                         
            </div>
          </div>  
            <div class="interested">
                <h1>可能喜欢</h1>
                                                    <li>
                    <i></i>
                    <a href="http://www.4hou.com/technology/7667.html" target="_blank">小心找工作时被挖坑，有人利用 LinkedIn 发送钓鱼链接</a> 
                </li> 
                                <li>
                    <i></i>
                    <a href="http://www.4hou.com/technology/7653.html" target="_blank">一次服务器被攻击的应急行动</a> 
                </li> 
                                <li>
                    <i></i>
                    <a href="http://www.4hou.com/info/news/7646.html" target="_blank">一个Tor浏览器0day漏洞价值100万美元，其中的隐情是……</a> 
                </li> 
                                <li>
                    <i></i>
                    <a href="http://www.4hou.com/info/news/7660.html" target="_blank">Elasticsearche僵尸网络：超过4000台服务器遭到两款POS 恶意软件感染</a> 
                </li> 
                                <li>
                    <i></i>
                    <a href="http://www.4hou.com/technology/7669.html" target="_blank">渗透挑战赛：从SQL注入到管理员权限</a> 
                </li> 
                                                </div>
       </div>

          
        </aside>
    </section>
    <div id="zooming">
        <img src="" id="imgcon">
    </div>
    <script>
        $(document).ready(function() {
            $.fn.postLike = function() {
                if ($(this).hasClass('done')) {
                    return false;
                } else {
                    $(this).addClass('done');
                    var id = $(this).data("id"),
                        action = $(this).data('action'),
                        rateHolder = $(this).children('.count');
                    var ajax_data = {
                        action: "bigfa_like",
                        um_id: id,
                        um_action: action
                    };
                    $.post("/wp-admin/admin-ajax.php", ajax_data,
                        function(data) {
                            $(rateHolder).html(data);
                        });
                    return false;
                }
            };
            $(document).on("click", ".favorite",
                function() {
                    $(this).postLike();
                });


            $("img").attr("title","");
            var altcon=$(".art_title").text();
            $("img").attr("alt",altcon);
            // 图片放大
            $(".article_cen").find('img').on("click",function(){
                var imgsrc=$(this).attr("src");
                var winthimg=$(this).width();
                var zooming=winthimg*1.2;
                $("#imgcon").css({width:zooming});
                $("#imgcon").css({marginLeft:-zooming/2});
                $("#imgcon").attr("src",imgsrc);
                $("#zooming").addClass("zoomaniatae");
                $("#imgcon").addClass("imgconadimate");
            });
            $("#zooming").on("click",function(){
                $("#imgcon").removeClass("imgconadimate");
                $("#zooming").removeClass("zoomaniatae");

            });

            $(window).scroll(function(){
                var scrtop=$(window).scrollTop();
                if(scrtop>450){
                    $(".article_authorbox_top").removeClass("asideanimateleave").addClass('asideanimate')
                    // $(".interested").hide()
                }
                else if(scrtop<450&&scrtop>350){
                     $(".article_authorbox_top").addClass("asideanimateleave").removeClass('asideanimate')
                     $(".interested").show()

                }
            });
            var start=$(".strat .wpfp-span .wpfp-link").text()
            if(start=="已收藏"){
                $(".strat").addClass("stratend")
            }else{
                $(".strat").removeClass("stratend")
            }

            $(".avatar-96").width(72);
            $(".avatar-96").height(72);
            $(".avatar-120").width(50);
            $(".avatar-120").height(50);

        });
    </script>
<style type="text/css">
.footer{height:auto; background-color: #282828}
.footer_about{width: 1200px;height: 50px;padding-top: 26px; margin: 0 auto;border-bottom-color: transparent !important; position: relative;}
.footer_about>a{font-size: 16px;height: 16px !important;line-height: 16px !important; float: left; padding-right: 18px; border-right:1px solid #ccc;}
.last-child-a{border:none !important}
.footer_bottom_cen p{ margin-top: 5px; margin-right: 25px;text-align: left; margin-bottom: 6px;float: left;}
.footer_bottom_cen>div{width: 450px;float: left;margin-right: 8px}
.footer_bottom{height: 74px}
.footerlogos{width: 130px; height: 24px; position: absolute;right: 10%; top:24px;}
.footerlogos dd{float: left; margin-right: 20px;cursor: pointer;}
.footerlogos dd a{display: block;width: 100%; height: 100%}
.wechartlogo{width: 20px; height: 20px; background-position:-227px 0px;}
.weibologo{width: 20px; height: 20px; background-position:-269px 0px;}
.zhihulogo{width: 20px; height: 20px; background-position:-361px 0px;}
.wechartlogo i{width: 80px;height: 78px;background-size: contain !important; right: 137px;display: none;opacity: 1;background: url(http://www.4hou.com/wp-content/themes/4houv2/img/wechatqr.png) no-repeat;position: absolute;top: -28px;}
.wechartlogo:hover i{display: block;}
.footer_bottom{width: 1200px; background-color: #282828; margin:0 auto } 
.footer_bottom_cen>div img{float: left; margin-right: 4px;margin-top: 4px; margin-left: 4px;width: 66px;}
.footer_bottom_cen{width: 100%}
.cloudserver{float: right !important; margin: 0 auto !important;width: 385px !important; margin-top: -31px}
.cloudserver img{float: left;}
.cloudserver dd{float: left;}
@media screen and (max-width:1260px) {
    .footer{width: 100%; padding: 0px 20px;}
    .footer_about{width: 100%}
    .footer_bottom{width: 100%}
    .footer_bottom div{width: 100%;display: none;}
}
@media screen and (max-width:660px) {
    .footer_about{padding-top: 14px; margin-bottom: 22px;}
    .footerlogos{display: none;}
    .footer_bottom{height: 44px;}

}
</style>
<footer class="footer">
    <div class="footer_about">
        <a href="/about" target=_blank>关于我们</a>
        <!--<a href="">加入我们</a>-->
        <a href="/submit" target=_blank>我要投稿</a>
        <a href="/service" target=_blank>广告及服务</a>
        <a href="/partner" target=_blank class="last-child-a">友情链接</a>
        <div class="footerlogos">
                <dd class="wechartlogo icons">
                  <i></i>
                </dd>
                <dd class="weibologo icons">
                 <a href="http://weibo.com/u/6069423878" target=_blank></a>
                </dd>
                <dd class="zhihulogo icons">
                    <a href="https://zhuanlan.zhihu.com/roartalk" target=_blank></a>
                    
                </dd>
        </div>
    </div>

    <section class="footer_bottom">
        <article class="footer_bottom_cen">
            <p>©2017 北京嘶吼文化传媒有限公司&nbsp;&nbsp;&nbsp;京ICP备16063439号</p>
            <p class="mobilefooter">©2017 北京嘶吼文化传媒有限公司&nbsp;&nbsp;|&nbsp;&nbsp;京ICP备16063439号</p>
            <div class="cloudserver">
                <span>本站由</span>
                <img src="http://img.4hou.com/wp-content/themes/4houv2/img/bdcloud.png">
                <img src="http://img.4hou.com/wp-content/themes/4houv2/img/bdcloud1.png">
                <img src="http://img.4hou.com/wp-content/themes/4houv2/img/ucloud.png">
                <span>提供云计算服务</span>
            </div>
        </article>
    </section>
    <section class="footer_top" style="display:none">
        <article class="footer_top_cen">
            <div class="homeqrcode">
                <dd class="icons"></dd>
                <div class="wb">
                    <a href="http://weibo.com/u/6069423878" target=_blank>
                    <i class="icons"></i>
                    <p>关注嘶吼传媒</p>
                    </a>
                </div>

                <div class="sh">
                    <a href="https://zhuanlan.zhihu.com/roartalk" target=_blank>
                    <i class="icons"></i>
                    <p>关注嘶吼</p>
                    </a>
                </div>
            </div>
            
            <h1>合作伙伴</h1>
            <div class="footer_friend">
                <a href="http://www.xinhuanet.com/talking/chinasafety/" target=_blank>新华网安全中国</a>
                <a href="http://jaq.alibaba.com/" target=_blank>阿里聚安全</a>
                <a href="http://www.seclover.com/" target=_blank>四叶草安全</a>
                <a href="https://sec.vip.com/" target=_blank>唯品会安全应急响应中心</a>
                <a href="https://www.duoyinsu.com/" target=_blank>安识科技</a>
                <a href="http://xianzhi.aliyun.com" target=_blank>云盾先知</a>
                <a href="http://www.ardsec.com/" target=_blank>兴华永恒</a>
                <a href="https://www.sobug.com/" target=_blank>SOBUG</a>
            </div>
        </article>
    </section>
    
</footer>
<aside class="side" >
    <div class="side_top icons "></div>
    <div class="iconbox">
        <div class="side_wechart icons iconhover">微信
            <dd></dd>
        </div>
        <a href="http://weibo.com/u/6069423878" target=_blank><div class="side_webo icons iconhover">微博</div></a>
        <a href="http://www.4hou.com/feed/" target=_blank><div class="side_rss icons iconhover">RSS</div></a>
        <a href="https://zhuanlan.zhihu.com/roartalk" target=_blank><div class="side_zh icons iconhover">知乎</div></a>
    </div>
    <div class="side_bottom icons"></div>
    
</aside>

<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?ac201c14c3d2a4747423252be421e1bc";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-91554508-1', 'auto');
    ga('send', 'pageview');

</script>
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
</body>
</html>