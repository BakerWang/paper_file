<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
                              _.._        ,------------.
                           ,'      `.    ( We want you! )
                          /  __) __` \    `-,----------'
                         (  (`-`(-')  ) _.-'
                         /)  \  = /  (
                        /'    |--' .  \
                       (  ,---|  `-.)__`
                        )(  `-.,--'   _`-.
                       '/,'          (  Uu",
                        (_       ,    `/,-' )
                        `.__,  : `-'/  /`--'
                          |     `--'  |
                          `   `-._   /
                           \        (
                           /\ .      \.  freebuf
                          / |` \     ,-\
                         /  \| .)   /   \
                        ( ,'|\    ,'     :
                        | \,`.`--"/      }
                        `,'    \  |,'    /
                       / "-._   `-/      |
                       "-.   "-.,'|     ;
                      /        _/["---'""]
                     :        /  |"-     '
                     '           |      /
                                 `      |
-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  向正在运行的Linux应用程序注入代码 - FreeBuf.COM | 关注黑客与极客</title>
<meta name="description" content="小编的话：感谢0&#215;80的认真翻译，辛苦:) ，各位同学，不要吝惜你的顶和评论哦！


	原作者：Gregory Shpitalnik
翻译：0×80



	1、简介


	假设Linux上正在运行某程序，像Unix守护程序等，我们不想终止该程…" />
<meta name="keywords" content="c语言, linux, 代码注入, 底层, 系统编程, 系统安全解决方案,系统安全软件排行,系统安全技术" />
<meta name="baidu-site-verification" content="nKKKqQxp6R" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="renderer" content="webkit">
<meta property="qc:admins" content="6620477777662552566375" />
<link rel='stylesheet' id='wpfp-css' href='http://www.freebuf.com/buf/plugins/wp-favorite-posts/wpfp.css' type='text/css' />
<link rel='stylesheet' id='wp-recentcomments-css'  href='http://static.3001.net/css/recentcomments/wp-recentcomments.css?ver=2.2.3' type='text/css' media='screen' />
<link rel='stylesheet' id='mycred-widget-css'  href='http://www.freebuf.com/buf/plugins/gold/assets/css/widget.css?ver=1.3.2.1' type='text/css' media='all' />
<script type='text/javascript' src='http://static.3001.net/js/header/jquery.min.js?ver=3.6.1'></script>
<script type='text/javascript' src='http://www.freebuf.com/buf/plugins/wp-favorite-posts/wpfp.js?ver=3.6.1'></script>
<link rel='prev' title='增强现实灯—让桌面变触屏' href='http://www.freebuf.com/geek/6405.html' />
<link rel='next' title='[快讯]Apache Tomcat多个安全漏洞被公布' href='http://www.freebuf.com/news/6416.html' />
<link rel='canonical' href='http://www.freebuf.com/articles/system/6388.html' />
<link rel='shortlink' href='http://www.freebuf.com/?p=6388' />

<link rel="stylesheet" href="http://static.3001.net/css/highslide/highslide.css" type="text/css" />
<script type="text/javascript" src="http://static.3001.net/js/highslide/highslide-with-html.packed.js"></script>
<script type="text/javascript">
jQuery(document).ready(function($) {
    hs.graphicsDir = "http://www.freebuf.com/buf/plugins/auto-highslide/images/graphics/";
    hs.outlineType = "rounded-white";
    hs.dimmingOpacity = 0.8;
    hs.outlineWhileAnimating = true;
    hs.showCredits = false;
    hs.captionEval = "this.thumb.alt";
    hs.numberPosition = "caption";
    hs.align = "center";
    hs.transitions = ["expand", "crossfade"];
    hs.addSlideshow({
        interval: 5000,
        repeat: true,
        useControls: true,
        fixedControls: "fit",
        overlayOptions: {
            opacity: 0.75,
            position: "bottom center",
            hideOnMouseOut: true

        }

    });
});
</script>
          <script language="JavaScript" type="text/javascript" src="http://www.freebuf.com/buf/plugins/cartpauj-pm/js/script.js"></script>
      <link rel="stylesheet" type="text/css" href="http://www.freebuf.com/buf/plugins/cartpauj-pm/style/style.css" />
      <script type="text/javascript" src="http://www.freebuf.com/buf/plugins/simditor/highlight/highlight.pack.js"></script><link type="text/css" rel="stylesheet" href=" http://www.freebuf.com/buf/plugins/simditor/highlight/styles/default.css" />	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<link rel="shortcut icon" href="http://static.freebuf.com/images/favicon.ico" />
<link rel="stylesheet" href="http://static.3001.net/css/new/header.css" />
<link href="http://static.3001.net/css/new/bootstrap.min.css?ver=2016051701" rel="stylesheet" media="screen">
    <!--轮播图-->
    <link href="http://static.3001.net/css/new/swiper-3.4.2.min.css" rel="stylesheet" type="text/css">
    <link href="http://static.3001.net/css/new/style.css?ver=20170912568" rel="stylesheet" type="text/css">
    <style type="text/css">
#contenttxt hr {
  display: block;
  height: 0px;
  border: 0;
  border-top: 1px solid #ccc;
  margin: 15px 0;
  padding: 0;
}
#contenttxt table {
  width: 100%;
  table-layout: fixed;
  border-collapse: collapse;
  border-spacing: 0;
  margin: 15px 0;
}
#contenttxt table thead {
  background-color: #f9f9f9;
}
#contenttxt table td, #contenttxt table th {
  min-width: 40px;
  height: 30px;
  border: 1px solid #ccc;
  vertical-align: top;
  padding: 2px 4px;
  text-align: left;
  box-sizing: border-box;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
#contenttxt table td.active, #contenttxt table th.active {
  background-color: #ffffee;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
</style>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/jquery-2.0.3.min.js"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/bootstrap.min.js"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/slider.js?2016022501.1" type="text/javascript"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/jquery.sticky.js" type="text/javascript"></script>
<script src="http://static.3001.net/js/focus/bjqs-1.3.min.js" type="text/javascript" ></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/mosaic.1.0.1.min.js" type="text/javascript" ></script>
<script type="text/javascript" src="http://static.3001.net/js/new/setint.js"></script>
    <!--轮播图-->
    <script src="http://static.3001.net/js/colum/swiper-3.4.2.min.js"></script>
<!--[if lt IE 9]>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/html5shiv.min.js"></script>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/respond.min.js"></script>
<![endif]-->
    <style>
        @font-face {font-family: 'iconfont';
            src: url('http://static.3001.net/iconfont/iconfont.eot'); /* IE9*/
            src: url('http://static.3001.net/iconfont/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
            url('http://static.3001.net/iconfont/iconfont.woff') format('woff'), /* chrome、firefox */
            url('http://static.3001.net/iconfont/iconfonticonfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
            url('http://static.3001.net/iconfont/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
        }
    </style>
</head>

<body>
<!----------header---------->
<!--头部导航-->
<div id="undefined-sticky-wrapper" class="sticky-wrapper is-sticky">
    <div class="main-header">
        <div class="header">
            <div class="header-container clearfix">
                                <div class="header-logo"><a href="http://www.freebuf.com"></a></div>
                                        <!-- column -->
                        <div class="nav">
                            <ul class="nav-child clearfix">
                                <li class=" index">
                                    <a href="http://www.freebuf.com">首页</a></li>
                                <li data-value="read-menu">
                                    <a href="#">分类阅读<b class="triangle-down triangle-down-04"></b></a>
                                </li>
                                <li data-value="wenku-menu"><a href="javascript:;" target="_blank">文库<b class="triangle-down triangle-down-04"></b></a></li>
                                <li>
                                    <a href="http://zhuanlan.freebuf.com" target="_blank">专栏</a><b class="icon-betr"></b>
                                </li>
                                <li><a href="http://open.freebuf.com" target="_blank">公开课</a></li>
                                <li><a href="http://shop.freebuf.com" target="_blank">商城</a></li>
                                <li data-value="company-menu"><a href="javascript:;" >企业服务<b class="triangle-down triangle-down-04"></b></a></li>
                                <li data-value="user-menu"><a href="javascript:;" >用户服务<b class="triangle-down triangle-down-04"></b></a></li>
                            </ul>
                        </div>
                                        <div class="header-right">
                                    <div class="loginSign login-before">
                        <a href="https://account.tophant.com/register.html" class="login-btn">注册</a>
                        |
                        <a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a>
                    </div>
                                    <!--搜索-->
                    <div class="search-form-inner clearfix">
                        <i class="searchdisplayico"></i>
                        <div class="form-group has-active search-col search-form-text">
                            <form id="hpsform-new" class="navbar-search navbar-form" onsubmit="return dispatch();">
                                <div class="form-group">
                                    <input id="bigq" class="input form-control" type="text" placeholder="关键字查找" autocomplete="off" title="关键字查找" name="q">
                                    <button class="submit" type="submit"></button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <!--<script>
                        $('.search-form-inner .searchdisplayico').click(function(event) {
                            var evt = evt || event;
                            evt.stopPropagation();
                            $(this).siblings('.search-col').addClass('active');
                        });
                        $('.search-form-inner .search-col').click(function(event) {
                            var evt = evt || event;
                            evt.stopPropagation();
                            $('.search-form-inner .search-col').addClass('active');
                        });
                        $(document).click(function() {
                            $('.search-form-inner .search-col').removeClass('active');
                        });
                    </script>-->
                                    <div class="btn-publish">
                        <a href="#">投稿</a>
                        <div class="btn-publish-child">
                            <ul class="btn-child clearfix">
                                <li><a href="http://my.freebuf.com/post/edit/" target="_blank">文章撰写</a></li>
                                <li><hr/></li>
                                <li><a href="http://my.freebuf.com/post/article/" target="_blank">投稿管理</a></li>
                                                        </ul>
                        </div>
                    </div>
                </div>
                <div class="nav-small">
                    <a href="#">&#xe634;</a>
                    <ul class="nav-child clearfix">
                                                        <li class=" index">
                                    <a href="http://www.freebuf.com">首页</a></li>
                                <li class="read-classify">
                                    <a href="#">分类阅读<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2 read-classify clearfix">
                                        <li>
                                            <strong>黑客</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                                <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                                <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                                <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                                <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                                <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                                <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                                <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                                <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                                <a href="http://www.freebuf.com/articles/es" target="_blank">企业安全</a>
                                                <a href="http://www.freebuf.com/ics-articles" target="_blank">工控安全</a>
                                            </div>
                                        </li>
                                        <li>
                                            <strong>极客</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                                <a href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                                            </div>
                                        </li>
                                        <li>
                                            <strong>特色</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/news/special" target="_blank">头条</a>
                                                <a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a>
                                                <a href="http://www.freebuf.com/fevents" target="_blank">活动</a>
                                                <a href="http://www.freebuf.com/video" target="_blank">视频</a>
                                                <a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a>
                                                <a href="http://www.freebuf.com/jobs" target="_blank">招聘</a>
                                                <a href="http://www.freebuf.com/paper/" target="_blank">报告</a>
                                            </div>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="http://zhuanlan.freebuf.com/" target="_blank">专栏</a></li>
                                <li><a href="http://open.freebuf.com" target="_blank">公开课</a></li>
                                <li><a href="http://shop.freebuf.com" target="_blank">商城</a></li>
                                <li>
                                    <a href="javascript:;" target="_blank">企业服务<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="https://www.vulbox.com/bounties/item-9-0-1" target="_blank"><strong>企业SRC</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://company.freebuf.com" target="_blank"><strong>企业空间</strong></a>
                                        </li>
                                        <li>
                                            <a href="https://www.vulbox.com/" target="_blank"><strong>安全测试</strong></a>
                                        </li>
                                        <li>
                                            <a href="https://www.riskivy.com/" target="_blank"><strong>风险感知</strong></a>
                                        </li>

                                    </ul>
                                </li>
                                <li>
                                    <a href="javascript:;" target="_blank">用户服务<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="http://www.freebuf.com/newsend" target="_blank"><strong>有奖投稿</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://zhuanlan.freebuf.com" target="_blank">
                                        </li>
                                        <li>
                                            <a href="https://www.vulbox.com/bounties/detail-72" target="_blank"><strong>提交漏洞</strong></a>
                                        </li>
                                        <li class="last">
                                            <a href="https://www.vulbox.com/bounties" target="_blank"><strong>参与众测</strong></a>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="javascript:;" target="_blank">文库<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="http://www.freebuf.com/wenku" target="_blank"><strong>文库</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://www.freebuf.com/special-subject" target="_blank"><strong>专题</strong></a>
                                        </li>
                                    </ul>
                                </li>
                                                    <li><a href="http://my.freebuf.com/post/edit" target="_blank">投稿</a></li>
                                                    <li><a href="https://account.tophant.com/register.html" class="login-btn">注册</a>
                            </li>
                            <li><a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a></li>
                                            </ul>
                </div>
            </div>
            <div class="dropdown-menu read-menu" id="read-menu">
                <div class="container">
                    <ul class="menu clearfix">
                        <li>
                            <strong>黑客</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                <a href="http://www.freebuf.com/articles/es" target="_blank">企业安全</a>
                                <a class="last" href="http://www.freebuf.com/ics-articles" target="_blank">工控安全</a>
                            </div>
                        </li>
                        <li>
                            <strong>极客</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                <a class="last" href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                            </div>
                        </li>
                        <li>
                            <strong>特色</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/news/special" target="_blank">头条</a>
                                <a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a>
                                <a href="http://www.freebuf.com/fevents" target="_blank">活动</a>
                                <a href="http://www.freebuf.com/video" target="_blank">视频</a>
                                <a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a>
                                <a href="http://www.freebuf.com/jobs" target="_blank">招聘</a>
                                <a class="last" href="http://www.freebuf.com/paper/" target="_blank">报告</a>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="dropdown-menu company-menu" id="company-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="https://www.vulbox.com/bounties/item-9-0-1" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-src.png"></span>
                                <span class="name">企业SRC</span>
                                <span class="intro">全/半托管式互联网漏洞收集管理</span>
                            </a>
                        </li>
                        <li>
                            <a href="http://company.freebuf.com" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-company.png"></span>
                                <span class="name">企业空间</span>
                                <span class="intro">为企业定制信息安全专属门户</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.vulbox.com/" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-safety.png"></span>
                                <span class="name">安全测试</span>
                                <span class="intro">国内领先的互联网安全众测服务</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="https://www.riskivy.com/" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-risk.png"></span>
                                <span class="name">风险感知</span>
                                <span class="intro">基于IT资产的自动化安全监控</span>
                            </a>
                        </li>

                    </ul>
                </div>
            </div>
            <div class="dropdown-menu user-menu" id="user-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="http://www.freebuf.com/newsend" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-write.png"></span>
                                <span class="name">有奖投稿</span>
                                <span class="intro">与整个行业分享你的经验与见解</span>
                            </a>
                        </li>
                        <li>
                            <a href="http://zhuanlan.freebuf.com" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-column.png"></span>
                                <span class="name">申请专栏</span>
                                <span class="intro">自由创作，打造自主内容品牌</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.vulbox.com/bounties/detail-72" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-leak.png"></span>
                                <span class="name">提交漏洞</span>
                                <span class="intro">与数万白帽一起，让互联网更安全</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="https://www.vulbox.com/bounties" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-test.png"></span>
                                <span class="name">参与众测</span>
                                <span class="intro">挖洞开启自由职业之路</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="dropdown-menu wenku-menu" id="wenku-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="http://www.freebuf.com/wenku" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-write.png"></span>
                                <span class="name">文库</span>
                                <span class="intro">最全的FB百科</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="http://www.freebuf.com/special-subject" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-test.png"></span>
                                <span class="name">专题</span>
                                <span class="intro">浓缩的安全精华汇总</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!----------header end---------->
<!--<script type="application/javascript">
    var  _value_tab = '';
    $(function(){
        var _that = '', _show_flag = 0;
        $('.header .header-container .nav .nav-child > li:not(input[data-value])').mouseover(function() {
            $('.header .dropdown-menu').stop().slideUp(50);
        });
        $('.header').mouseout(function() {
            $('.header .dropdown-menu').stop().slideUp(50);
        });
        /*$('.header .header-container .nav .nav-child > li').mouseover(function() {
         _value_tab = $(this).attr('data-value');
         $('#'+_value_tab).siblings('.dropdown-menu').stop().slideUp(50);
         $('#'+_value_tab).stop().slideDown(100);
         });*/
        $(".header .header-container .nav .nav-child > li").hoverDelay({
            hoverDuring: 500,
            hoverEvent: function(){
                $('#'+_value_tab).siblings('.dropdown-menu').stop().slideUp(50);
                $('#'+_value_tab).stop().slideDown(100);
            }
        });
        $('.header .dropdown-menu').mouseover(function() {
            _value_tab = $(this).attr('id');
            _that = this;
            $('.nav-child li[data-value="'+_value_tab+'"]').addClass('hover');
            $(this).stop().slideDown(50);
        }).mouseout(function() {
            $('.nav-child li[data-value="'+_value_tab+'"]').removeClass('hover');
            $(_that).stop().slideUp(50);
        });

        $(".nav-small .nav-child > li").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();

            if($(this).find('.nav-child2').is(":hidden")) {
                _show_flag = 1;
                $(this).find('.nav-child2').slideDown();
                $(this).find('.icon-arrow').addClass('bottom');
            }else {
                _show_flag = 0;
                $(this).find('.nav-child2').slideUp();
                $(this).find('.icon-arrow').removeClass('bottom');
            }
            $(this).siblings().find('.nav-child2').slideUp();
            $(this).siblings().find('.icon-arrow').removeClass('bottom');
        });
        //头部投稿按钮hover状态展开菜单
        $(".btn-publish-child > ul > li").hover(function(){
            $(this).addClass("active");
            $(this).siblings().removeClass("active");
        });

        $(document).click(function(event){
            var ev = ev || event;
            $(".login-after").find(".login-after-child").hide();
        });
        //点击用户信息，出现下拉菜单
        $("#user-info").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();
            $(".login-after").find(".login-after-child").toggle();
        });
        //顶部导航
        $(".nav-small").click(function(){
            $(this).find(".nav-child").slideToggle();
        });
        var that = '';
        $('.header .header-container .nav .nav-child > li').mouseover(function() {
            that = this;
            $(this).find('.dropdown-menu').stop().slideDown(200);
        }).mouseout(function() {
            $(that).find('.dropdown-menu').stop().slideUp(200);
        });
    });
    $(".nav-small .nav-child > li").click(function(event){
        var ev = ev || event;
        ev.stopPropagation();
        $(this).siblings('li').find('.dropdown-menu').hide();
        $(this).find(".dropdown-menu").toggle();
    });
    //鼠标经过(hover)事件的延时处理
    (function($){
        $.fn.hoverDelay = function(options){
            var defaults = {
                hoverDuring: 100,
                outDuring: 100,
                hoverEvent: function(){
                    $.noop();
                },
                outEvent: function(){
                    $.noop();
                }
            };
            var sets = $.extend(defaults,options || {});
            var hoverTimer, outTimer;
            return $(this).each(function(){
                $(this).hover(function(){
                    _value_tab = $(this).attr('data-value');
                    clearTimeout(outTimer);
                    hoverTimer = setTimeout(sets.hoverEvent, sets.hoverDuring);
                },function(){
                    clearTimeout(hoverTimer);
                    outTimer = setTimeout(sets.outEvent, sets.outDuring);
                });
            });
        }
    })(jQuery);
</script>-->
<script type="text/javascript" src="http://static.3001.net/js/header/header.js"></script><script>
    jQuery(window).load(function(){
      if(jQuery(window).width()>480){
        jQuery(".main-header").sticky({ topSpacing: 0 });
      }else{
        jQuery(".main-header nav").removeClass("navbar-fixed-top");
      }
      jQuery("#mar-right").sticky({ topSpacing: 105,bottomSpacing: 410 });
    });
</script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/layer.js"></script>
<script type="text/javascript" src="http://static.3001.net/js/pretty/prettify.js"></script>
<script type="text/javascript" src="http://static.3001.net/js/header/lazyload.js"></script>
<script type="text/javascript" charset="utf-8">
      jQuery(function() {
          jQuery("img").lazyload({
              effect : "fadeIn"
          });
      });
 </script>
<script type="text/javascript">
    window.onload = function(){
        prettyPrint();
    }
</script>
<script language="JavaScript" type="text/javascript">
//<![CDATA[
var va = "您已经点亮过了";
function acv_vote(id,option, m){
  if( m==null) m =''; m = m + '';
  jQuery('#acv_stat_'+m+id).html('Loading...');
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option="+option+"&ID="+id;
  jQuery.get(url,function(d){
    d =d.split('|');var s='#acv_stat_'+m+d[0];
    var sele = '#cos_support-'+m+id,unsele = '#cos_unsupport-'+m+id,tpjs = 'javascript:alert(va)';
    jQuery( s ).html( d[1] );jQuery(s).fadeOut(400,function(){jQuery(s).fadeIn();});
    if( d[2] == 1 ){ jQuery(sele).html(jQuery(sele).html()*1+1); }
    if( d[2] == -1 ){ jQuery(unsele).html(jQuery(unsele).html()*1+1); }
    jQuery('#vote4-'+id).attr('href',tpjs);jQuery('#vote4-2'+id).attr('href',tpjs);
    jQuery('#votea-'+id).attr('href',tpjs);jQuery('#votea-2'+id).attr('href',tpjs);
  });
}
  
$(document).on("mouseenter",".comment-tools",function(){
  $(this).find(".btn-report").show();
  $(this).find(".btn-report").addClass("hover");
}).on("mouseleave",".comment-tools",function(){
  var $_this = $(this);
  $(this).find(".btn-report").removeClass("hover");
  if(!$(this).find(".dropup").hasClass('open')){
    $(this).find(".btn-report").hide(); 
    $_this.find(".dropdown-menu").css("display","none");
  }else{
    setTimeout(function(){
      if(!$_this.find(".btn-report").hasClass("hover")){
        $_this.find(".dropup").removeClass("open");
        $_this.find(".dropdown-menu").css("display","none");
        $_this.find(".btn-report").hide(); 
      }
    },"500");
  }
})

$(document).on("click",".click_report",function(){
  $(this).parent().parent().css("display","none");
  var id = $(this).attr("data-id");
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option=0&ID="+id;
  $_this = $(this);
  jQuery.get(url,function(d){
    d =d.split('|');
    if(d[1]=='您已经点过灯了'){
      d[1] = '您已经举报过了';
    }
    if(d[1]=='Thank you'){
      d[1] = '举报成功';
    }
    $_this.parent().parent().parent().find(".btn-report").text(d[1]);
    $_this.parent().parent().parent().find(".btn-report").css("display","block");
  })
})

$(document).on("click",".btn-report",function(){
  if($(this).parent().hasClass('open')){
    $(this).parent().find(".dropdown-menu").css("display","block");
  }else{
    $(this).parent().find(".dropdown-menu").css("display","none");
  }
})
//]]>
</script>
<div class="column-article" data-column="">
            <div class="container pad-top35">
        <div class="row clearfix">
            <div class="col-md-9" id="getWidth">
                                    <div class="reletive search-xs-wrap">
                    <div class="form-group has-active search-col search-xs">
                        <form id="hpsform-new" class="navbar-search navbar-form" onsubmit="return dispatch()">
                            <div class="form-group">
                                <input id="q" class="input form-control" type="text" placeholder="关键字查找" autocomplete="off" title="关键字查找" name="q">
                                <button class="submit" type="submit"></button>
                            </div>
                        </form>
                    </div>
                </div>
                    <script type="text/javascript">
                        var dispatch = function () {
                            console.log(123)
                            var q = document.getElementById("q");
                            if (q.value == "") {
                                q = document.getElementById("bigq");
                            }
                            if (q.value != "") {
                                window.open('http://www.freebuf.com/?s=' + q.value, "_blank");
                                return false;
                            } else {
                                return false;
                            }
                        }
                    </script>
                                <div class="article-wrap panel panel-default">
                                                            <div class="articlecontent">
                                                    <div class="title">
                                <h2>
                                    向正在运行的Linux应用程序注入代码                                </h2>
                                <div class="property">
                                                                            <span class="name"><a href="http://www.freebuf.com/author/0x80" title="由 0x80 发布" rel="author">0x80</a></span>
                                                                        <span class="icon-f"></span>
                                    <span class="time">2012-12-06</span>
                                                                                                            <span class="look">共<strong>351458</strong>人围观
                                        ，发现 <strong>19</strong> 个不明物体 </span>                                      </span>
                                                                <span class="tags">
                                      <a href="http://www.freebuf.com/./articles/system">系统安全</a></span>
                                    <span class="tags_01"></span>
                                </div>
                            </div>
                                                                                                <div id="contenttxt">
                            <p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<strong style="font-size:12px;"><span style="white-space:nowrap;"><span style="color:#009900;">小编的话：</span><span style="color:#009900;">感谢0&#215;80的认真翻译，辛苦:) ，各位同学，不要吝惜你的顶和评论哦！</span></span></strong>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<strong style="font-size:12px;"><span style="white-space:nowrap;">原作者：Gregory Shpitalnik</span><br />
<span style="white-space:nowrap;color:#009900;">翻译：0×80</span><br />
</strong>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<strong style="font-size:12px;">1、简介</strong>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;">假设Linux上正在运行某程序，像Unix守护程序等，我们不想终止该程序，但是同时又需要更新程序的功能。首先映入脑海的可能是更新程序中一些已知函数，添加额外的功能，这样就不会影响到程序已有的功能，且不用终止程序。考虑向正在运行的程序中注入一些新的代码，当程序中已存在的另一个函数被调用时触发这些新代码。也许这种想法有些异想天开，但并不是不能实现的，有时我们确实需要向正在运行的程序中注入一些代码，当然其与病毒的代码注入技术与存在一定关联。</span><span style="font-size:12px;"><br />
</span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;">在本文中，我会向读者解释如何向正在Linux系统上运行的程序中注入一段C函数代码，而不必终止该程序。文中我们会讨论Linux目标文件格式Executable and Linkable Format(ELF)，讨论目标文件sections（段）、symbols（符号）以及relocations（重定位）。</span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;"><span style="white-space:nowrap;"><strong>2、示例概述</strong></span><br />
<span style="white-space:nowrap;">笔者会利用以下简单的示例程序向读者一步步解释代码注入技术。示例由以下三部分组成：</span></span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;"><span style="white-space:nowrap;"> </span></span>
</p>
<pre class="prettyprint">（1）由源码dynlib.h与dynlib.c编译的动态（共享）库libdynlib.so
（2）由源码app.c编译的app程序，会链接libdynlib.so库
（3）injection.c文件中的注入函数</pre>
<p>
	
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;"><span style="white-space:nowrap;">下面看一下这些代码：</span><br />
</span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;"> </span>
</p>
<pre class="prettyprint lang-cpp">//dynlib.h
extern void print();</pre>
<p>
	
</p>
<p>
	<span style="color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:12px;line-height:24px;background-color:#FFFFFF;">dynlib.h文件中声明了printf()函数。</span>
</p>
<p>
	<span style="color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:12px;line-height:24px;background-color:#FFFFFF;"> </span>
</p>
<pre class="prettyprint lang-cpp">//dynlib.c
 #include &lt;stdio.h&gt;
 #include &lt;sys/types.h&gt;
 #include &lt;unistd.h&gt;
 #include "dynlib.h"
 extern void print()
 {
     static unsigned int counter = 0;
     ++counter;
     printf("%d : PID %d : In print()\n", counter, getpid());
 }</pre>
<p>
	
</p>
<p>
	<span style="color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:12px;line-height:24px;background-color:#FFFFFF;">dynlib.c文件实现了print()函数，该函数只是打印一个计数（每次函数被调用时都会使该值增加）以及当前进程的pid。</span>
</p>
<p>
	<span style="color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:12px;line-height:24px;background-color:#FFFFFF;"> </span>
</p>
<pre class="prettyprint lang-cpp">//app.c
#include &lt;stdio.h&gt;
#include &lt;unistd.h&gt;
#include "dynlib.h"
int main()
{
     while(1)
     {
         print();
         printf("Going to sleep...\n");
         sleep(3);
         printf("Waked up...\n");
     }
     return 0;
}</pre>
<p>
	
</p>
<p>
	<span style="color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:12px;line-height:24px;background-color:#FFFFFF;">app.c文件中的函数调用print()函数（来自libdynlib.so动态库），之后睡眠几秒钟，然后继续执行该无限循环。</span>
</p>
<p>
	<span style="color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:12px;line-height:24px;background-color:#FFFFFF;"> </span>
</p>
<pre class="prettyprint lang-cpp">//injection.c
#include &lt;stdlib.h&gt;
extern void print();
extern void injection()
{ 
     print();  //原本的工作，调用print()函数
     system("date");  //添加的额外工作
}</pre>
<p>
	
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;">injection()函数调用会替换app.c文件中main()函数调用的print()函数调用。injection()函数首先会调用原print()函数，之后进行额外的工作。例如，它可以利用system()函数运行一些外部可执行程序，或者像本例中一样打印当前的日期。</span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;"><strong>3、编译并运行程序</strong></span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;">首先利用gcc编译器编译这些源文件：</span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;"> </span>
</p>
<pre class="prettyprint lang-cpp">$ gcc -g -Wall dynlib.c -fPIC -shared -o libdynlib.so
$ gcc –g app.c –ldynlib –L ./ -o app
$ gcc -Wall injection.c -c -o injection.o</pre>
<p>
	<span style="white-space:nowrap;font-size:12px;">编译后的程序为：</span>
</p>
<pre class="prettyprint lang-cpp">-rwxrwxr-x 1 0×80 0×80 6224 Oct 15 14:04 app
-rw-rw-r– 1 0×80 0×80 888 Oct 16 17:53 injection.o
-rwxrwxr-x 1 0×80 0×80 5753 Oct 16 17:52 libdynlib.so</pre>
<p>
	
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;">需要注意的是动态库libdynlib.so在编译时指定了-fPIC选项，用来生成地址无关的程序。下面运行app可执行程序：</span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;"> </span>
</p>
<pre class="prettyprint lang-cpp">[0x80@localhost dynlib]$ ./app
./app: error while loading shared libraries: libdynlib.so: cannot open shared object file: No such file or directory</pre>
<p>
	
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;">如果产生以上错误，我们需要将生成的libdynlib.so文件拷贝到/usr/lib/目录下，再执行该程序，得到如下结果：</span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;"> </span>
</p>
<pre class="prettyprint lang-bsh">[0x80@localhost dynlib]$ ./app
1 : PID 25658 : In print()
Going to sleep…
Waked up…
2 : PID 25658 : In print()
Going to sleep…
Waked up…
3 : PID 25658 : In print()
Going to sleep…</pre>
<p>
	
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;"><strong>4、调试应用程序</strong></span><br />
<span style="font-size:12px;">程序app只是一个简单的循环程序，这里我们假设其已经运行了几周，在不终止该程序的情况下，将我们的新代码注入到该程序中。在注入过程中利用Linux自带的功能强大的调试器gdb。首先我们需要利用pid（见程序的输出）将程序附着到gdb：</span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;"> </span>
</p>
<pre class="prettyprint lang-bsh">[0x80@localhost dynlib]$ gdb app 25658
GNU gdb Red Hat Linux (6.3.0.0-1.122rh)
Copyright 2004 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type “show copying” to see the conditions.
There is absolutely no warranty for GDB. Type “show warranty” for details.
This GDB was configured as “i386-redhat-linux-gnu”…Using host libthread_db library “/lib/libthread_db.so.1″.
Attaching to program: /home/0×80/dynlib/app, process 25658
Reading symbols from shared object read from target memory…done.
Loaded system supplied DSO at 0×464000
`shared object read from target memory’ has disappeared; keeping its symbols.
Reading symbols from /usr/lib/libdynlib.so…done.
Loaded symbols for /usr/lib/libdynlib.so
Reading symbols from /lib/libc.so.6…done.
Loaded symbols for /lib/libc.so.6
Reading symbols from /lib/ld-linux.so.2…done.
Loaded symbols for /lib/ld-linux.so.2
0×00464410 in __kernel_vsyscall ()
(gdb)</pre>
<p>
	
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;"><strong>5、将注入代码加载到可执行程序的内存中</strong></span><br />
<span style="font-size:12px;">如前所述，目标文件injection.o初始并不包含在app可执行进程镜像中，我们首先需要将injection.o加载到进程的内存地址空间。可以通过mmap()系统调用，该系统调用可以将injection.o文件映射到app进程地址空间中。在gdb调试器中：</span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;"> </span>
</p>
<pre class="prettyprint lang-bsh">(gdb) call open(“injection.o”, 2)
$1 = 3
(gdb) call mmap(0, 888, 1|2|4, 1, 3, 0)
$2 = 1118208
(gdb)</pre>
<p>
	
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;">首先利用O_RDWR（值为2）的读/写权限打开injection.o文件。一会之后我们在加载注入代码时做写修改，因此需要写权限。返回值为系统分配的文件描述符，可以看到值为3。之后调用mmap()系统调用将该文件载入进程的地址空间。mmap()函数原型如下：</span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;"> </span>
</p>
<pre class="prettyprint lang-cpp">#include &lt;sys/mman.h&gt;
void *mmap(void *start, size_t length, int prot, int flags, int fd, off_t offset);</pre>
<p>
	
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;">函数包含6个参数：</span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;"><span style="white-space:nowrap;"><strong>start</strong>表示映射区的开始地址，设置为0时表示由系统决定映射区起始地址。</span><br />
<span style="white-space:nowrap;"><strong>length</strong>表示映射区的长度，这里为injection.o文件的长度，该值在前文第3节出现过。</span><br />
<span style="white-space:nowrap;"><strong>prot</strong>表示期望的内存保护标志（即映射权限），不能与文件的打开模式冲突，这里为1|2|4（即PROT_READ | PROT_WRITE | PROT_EXEC，读/写/执行）</span><br />
<span style="white-space:nowrap;"><strong>flags</strong>指定映射对象的类型，映射选项和映射页是否可以共享，</span><br />
<span style="white-space:nowrap;"><strong>fd</strong>表示已经打开的文件描述符，这里为3。</span><br />
<span style="white-space:nowrap;"><strong>offset</strong>表示被映射对象内容的起点，这里为0。</span><br />
<span style="white-space:nowrap;">如果函数执行成功，则返回被映射文件在映射区的起始地址　</span><br />
<span style="white-space:nowrap;">通过查看/proc/[pid]/maps的内容（这里pid为要注入的可执行进程的pid，本例为25593），我们可以确定injection.o文件实际被映射到的进程地址空间，在Linux系统中，文件包含当前正在运行的进程的内存布局信息</span></span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;"><span style="white-space:nowrap;"> </span></span>
</p>
<pre class="prettyprint lang-bsh">[0x80@localhost ~]$ cat /proc/25658/maps
00111000-00112000 rwxs 00000000 03:02 57933979 /home/0x80/dynlib/injection.o
00464000-00465000 r-xp 00464000 00:00 0 [vdso]
00500000-00501000 r-xp 00000000 03:01 5464089 /usr/lib/libdynlib.so
00501000-00502000 rw-p 00000000 03:01 5464089 /usr/lib/libdynlib.so
007bb000-007d4000 r-xp 00000000 03:01 1311704 /lib/ld-2.4.so
007d4000-007d5000 r--p 00018000 03:01 1311704 /lib/ld-2.4.so
007d5000-007d6000 rw-p 00019000 03:01 1311704 /lib/ld-2.4.so
007d8000-00904000 r-xp 00000000 03:01 1311705 /lib/libc-2.4.so
00904000-00907000 r--p 0012b000 03:01 1311705 /lib/libc-2.4.so
00907000-00908000 rw-p 0012e000 03:01 1311705 /lib/libc-2.4.so
00908000-0090b000 rw-p 00908000 00:00 0
08048000-08049000 r-xp 00000000 03:02 57933977 /home/ 0x80 /dynlib/app
08049000-0804a000 rw-p 00000000 03:02 57933977 /home/ 0x80 /dynlib/app
09ca5000-09cc6000 rw-p 09ca5000 00:00 0 [heap]
b7f94000-b7f95000 rw-p b7f94000 00:00 0
b7fa4000-b7fa6000 rw-p b7fa4000 00:00 0
bfb91000-bfba6000 rw-p bfb91000 00:00 0 [stack]
[0x80@localhost ~]$</pre>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;">可以看到/home/0×80/dynlib/injection.o起始于进程地址空间的0×00111000地址处（转换成十进制即为1118208），终止于地址空间的0×00112000地址处。以上输出同时包含了其它动态库的映射信息。现在我们已经将所有需要的组件加载到可执行进程的内存空间中了。</span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;"><span style="white-space:nowrap;"><strong>6、重定位</strong></span><br />
<span style="white-space:nowrap;">下面，我们从内部检查ELF格式的二进制可执行文件程序app。我们使用Linux自带的readelf程序，来显示ELF格式的目标文件（Linux中的任意object文件、库或可执行文件）中的不同数据，即查看app程序中的符号重定位信息。我们只对其中的print()函数调用的重定位感兴趣。</span><br />
</span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;"> </span>
</p>
<pre class="prettyprint lang-bsh">[0x80@localhost dynlib]$ readelf -r app
Relocation section ‘.rel.dyn’ at offset 0×338 contains 1 entries:
Offset Info Type Sym.Value Sym. Name
08049678 00000c06 R_386_GLOB_DAT 00000000 __gmon_start__
Relocation section ‘.rel.plt’ at offset 0×340 contains 5 entries:
Offset Info Type Sym.Value Sym. Name
08049688 00000107 R_386_JUMP_SLOT 00000000 print
0804968c 00000207 R_386_JUMP_SLOT 00000000 puts
08049690 00000407 R_386_JUMP_SLOT 00000000 sleep
08049694 00000607 R_386_JUMP_SLOT 00000000 __libc_start_main
08049698 00000c07 R_386_JUMP_SLOT 00000000 __gmon_start__
[0x80@localhost dynlib]$</pre>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;">如读者所见，print符号重定位位于app程序的绝对（虚拟）地址0×08049688偏移处，重定位的类型为R_386_JUMP_SLOT。在程序被加载到内存且在运行之前，重定位地址是一个绝对虚拟地址。注意该重定位驻留在程序二进制镜像的.rel.plt段内。PLT即Procedure Linkage Table的缩写，是为函数间接调用提供的表，即在调用一个函数是，不是直接跳转到函数的位置，而是首先跳转到Procedure Linkage Table的入口处，之后再从PLT跳转到函数的实际代码处。如果要调用的函数位于一个动态库中（如本例中的libdynlib.so），那么这种做法是必要的，因为我们不可能提前知道动态库会被加载到进程空间的什么位置，以及动态库中的第一个函数是什么（本位中为print()函数）。所有这些知识只在程序被加载到内存之后且运行之前有效，这时系统的动态链接器（Linux系统中为ld-linux.so）会解决重定位的问题，使请求的函数能够被正确调用。在本文的例子中，动态链接器会将libdynlib.so加载到可执行进程的地址空间，找到print()函数在库中的地址，并将该地址设置为重定位地址0×08049688。</span>
</p>
<p><span style="font-size:12px;background-color:#FFFFFF;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;line-height:24px;">我们的目标是用injection.o目标文件中injection()函数的地址替换print()函数的地址，该函数在程序刚开始运行之初并不包含在它的进程地址空间中。</span><br />
<span style="font-size:12px;background-color:#FFFFFF;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;line-height:24px;">更多关于ELF格式、重定位以及动态链接器的的信息，读者可以参考Executable and Linkable Format(ELF)文档。</span></p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;">我们可以检查地址0×08049688正是函数print()函数的地址：</span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;"> </span>
</p>
<pre class="prettyprint lang-cpp">(gdb) p &amp; print
$3 = (void (*)()) 0x50051c (gdb) p/x * 0×08049688
$4 = 0x50051c
(gdb)</pre>
<p>
	
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;">injection()函数的地址可以通过对injection.o文件运行readelf –s(显示目标文件的符号表)得到：</span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;"> </span>
</p>
<pre class="prettyprint lang-cpp">[0x80@localhost dynlib]$ readelf -s injection.o
Symbol table ‘.symtab’ contains 11 entries:
Num: Value Size Type Bind Vis Ndx Name
0: 00000000 0 NOTYPE LOCAL DEFAULT UND
1: 00000000 0 FILE LOCAL DEFAULT ABS injection.c
2: 00000000 0 SECTION LOCAL DEFAULT 1
3: 00000000 0 SECTION LOCAL DEFAULT 3
4: 00000000 0 SECTION LOCAL DEFAULT 4
5: 00000000 0 SECTION LOCAL DEFAULT 5
6: 00000000 0 SECTION LOCAL DEFAULT 7
7: 00000000 0 SECTION LOCAL DEFAULT 6
8: 00000000 25 FUNC GLOBAL DEFAULT 1 injection
9: 00000000 0 NOTYPE GLOBAL DEFAULT UND print
10: 00000000 0 NOTYPE GLOBAL DEFAULT UND system
[0x80@localhost dynlib]$</pre>
<p>
	
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;">函数（符号）injection位于injection.o文件.text段的偏移0处，但.text段起始于injection.o文件的偏移0×000034处：</span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;"> </span>
</p>
<pre class="prettyprint lang-cpp">[0x80@localhost dynlib]$ sudo readelf -S injection.o
There are 11 section headers, starting at offset 0xd4:
Section Headers:
[Nr] Name Type Addr Off Size ES Flg Lk Inf Al
[ 0] NULL 00000000 000000 000000 00 0 0 0
[ 1] .text PROGBITS 00000000 000034 000019 00 AX 0 0 4
[ 2] .rel.text REL 00000000 000360 000018 08 9 1 4
[ 3] .data PROGBITS 00000000 000050 000000 00 WA 0 0 4
[ 4] .bss NOBITS 00000000 000050 000000 00 WA 0 0 4
[ 5] .rodata PROGBITS 00000000 000050 000005 00 A 0 0 1
[ 6] .comment PROGBITS 00000000 000055 00002d 00 0 0 1
[ 7] .note.GNU-stack PROGBITS 00000000 000082 000000 00 0 0 1
[ 8] .shstrtab STRTAB 00000000 000082 000051 00 0 0 1
[ 9] .symtab SYMTAB 00000000 00028c 0000b0 10 10 8 4
[10] .strtab STRTAB 00000000 00033c 000024 00 0 0 1
Key to Flags:
W (write), A (alloc), X (execute), M (merge), S (strings)
I (info), L (link order), G (group), x (unknown)
O (extra OS processing required) o (OS specific), p (processor specific)
[0x80@localhost dynlib]$</pre>
<p>
	
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;"><strong>7、用injection()函数替换print()函数</strong></span><br />
<span style="font-size:12px;">这里提醒读者，injection.o文件已经被加载到app进程内存空间的地址0×00111000处（见上文）。因此injection()函数的最终绝对虚拟地址为0×00111000+0×000034.</span><br />
<span style="font-size:12px;">下面用该地址替换print()函数的重定位地址0×08069688：</span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;"> </span>
</p>
<pre class="prettyprint lang-cpp">(gdb) set *0×08049688 = 0×00111000 + 0×000034
(gdb)</pre>
<p>
	
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;">到这里，我们已经成功用对injection()函数的调用替换了对print()函数的调用。</span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;"><span style="white-space:nowrap;"><strong>8、解决injection()函数的重定位</strong></span><strong></strong><br />
</span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;">不过我们还有一些工作要做。injection()函数的代码目前还不能运行，因为我们仍有3个重定位没有解决：</span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;"> </span>
</p>
<pre class="prettyprint lang-cpp">[0x80@localhost dynlib]$ readelf -r injection.o
Relocation section ‘.rel.text’ at offset 0×360 contains 3 entries:
Offset Info Type Sym.Value Sym. Name
00000007 00000902 R_386_PC32 00000000 print
0000000e 00000501 R_386_32 00000000 .rodata
00000013 00000a02 R_386_PC32 00000000 system
[0x80@localhost dynlib]$</pre>
<p>
	
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;">print重定位引用libdynlib.so库中的print()函数调用，.rodata重定位指向保存在.rodata只读数据段的“date”常量字符串（译者注：即system(date)调用中的“date”），system重定位引用系统的system()函数调用。需要注意的是所有这三个重定位是驻留在.rel.text段中的，因此它们的偏移是相对于.text段而言的。</span><span style="font-size:12px;"><br />
</span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;">我们需要手动解决以上三个重定位，为这三个内存位置设置适当的地址。程序进程地址空间中的这些重定位地址是通过求和计算出来的：</span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;"> </span>
</p>
<pre class="prettyprint lang-cpp">（1）injection.o在进程地址空间中的起始地址（0×00111000）。
（2）.text段在injection.o目标文件中的起始偏移量（0×000034）。
（3）相对于.text段的重定位偏移量（print为0×00000007， .rodata为0x0000000e，system为0×00000013）。</pre>
<p>
	
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;">可以看到print与system的重定位类型为R_386_PC32，意味着要设置的重定位地址的值应该利用程序计数寄存器PC来计算，这样才是相对于重定位地址的。</span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<em style="font-size:16px;"><span style="font-size:12px;">（译者注：所谓重定位类型，就是规定了使用何种方式，去计算这个值，具体有哪些变量参与计算如同如何进行计算一样也是不固定的，各种重定位类型有自己的规定。</span></em><em style="font-size:16px;"><span style="font-size:12px;">据规范里面的规定，重定位类型R_386_PC32的计算需要有三个变量参与：S，A和P。其计算方式是 S+A-P。根据规范，当R_386_PC32类型的重定位发生在link editor链接若干个.o对象文件从而形成可执行文件的过程中的时候，变量S指代的是被重定位的符号的实际运行时地址，而变量P是重定位所影响到的地址单元的实际运行时地址。在运行于x86架构上的Linux系统中，这两个地址都是虚拟地址。变量A最简单，就是重定位所需要的附加数，它是一个常数。别忘x86架构所使用的重定位条目结构体类型Elf32_Rela，所以附加数就存在于受重定位影响的地址单元中。重定位最后将计算得到的值patch到这个地址单元中。）</span></em>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;line-height:24px;">
	<span style="font-size:12px;">R_386_32表示绝对地址的重定位，可以直接使用符号的地址；R_386_PC32表示对相对地址的重定位，要用“符号地址－重定位地址”得出相对地址。</span><br />
<span style="font-size:12px;">R_386_32 类型规定只是将附加数加上符号的值作为所需要的值，即.rodata的重定位需要在地址0×00111000的基础上加上一个附加数。</span><br />
<span style="font-size:12px;">计算方法如下：</span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;line-height:24px;">
	<span style="font-size:12px;"> </span>
</p>
<pre class="prettyprint lang-cpp">(gdb) p &amp; system
$7 = ( *) 0×733650 //system()函数的地址
(gdb) p * (0×00111000 + 0×000034 + 0×000000013)
$8 = -4 // system符号重定位的加数
(gdb) set * (0×00111000 + 0×000034 + 0×000000013) = 0×733650 – (0×00111000 + 0×000034 + 0×000000013) – 4

(gdb) p &amp; print
$9 = (void (*)(void)) 0x40000be8 // print()函数的地址
(gdb) p * (0×00111000 + 0×000034 + 0×0000007)
$10 = -4 // print符号重定位的加数
(gdb) set * (0×00111000 + 0×000034 + 0×0000007) = 0x40000be8 – (0×00111000 + 0×000034 + 0×0000007) – 4

(gdb) p * (0×00111000 + 0×000034 + 0x0000000e)
$11 = 0 // .rodata符号重定位的加数
(gdb) set * (0×00111000 + 0×000034 + 0x0000000e) = 0×00111000 + 0×000050
//0×000050为.rodata 段在injection.o目标文件中的偏移（见上文第6节结尾处）</pre>
<p>
	
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;">解决了injection()函数代码中的所有3个重定位，那么要做的准备工作就做完了，可以退出gdb调试器了。应用程序会继续运行，并且在此之后，除了继续之前的打印工作，程序同时还会输出当前的日期。</span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;"> </span>
</p>
<pre class="prettyprint lang-cpp">(gdb) q
A debugging session is active.
Inferior 1 [process 25658] will be detached.

Quit anyway? (y or n) y
Detaching from program: /home/0×80/dynlib/app, process 25658
[0x80@localhost dynlib]$ [lnx63:code_injection]

// app程序会继续执行
Waked up …
Thu Oct 12 20:09:40 IST 2012
4: PID 25658: In print()
Going to sleep …
Waked up …
Thu Oct 12 20:09:43 IST 2012
5: PID 25658: In print()
Going to sleep …
Waked up …
Thu Oct 12 20:09:46 IST 2012
6: PID 25658: In print()
Going to sleep …
Waked up …
Thu Oct 12 20:09:49 IST 2012
7: PID 25658: In print()
Going to sleep …
Waked up …</pre>
<p>
	
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;"><strong>9、结论</strong></span><br />
<span style="font-size:12px;"> 　　在本文中，笔者演示了如何向正在运行于Linux系统上的应用程序注入一个C函数，而不必终止该程序。需要注意的是当前用户必须是被注入的进程的，或者拥有对进程内存处理的相应权限。</span>
</p>
<p style="background-color:#FFFFFF;border:0px;margin-top:0px;margin-bottom:24px;padding:0px;vertical-align:baseline;color:#333333;font-family:Georgia, 'Bitstream Charter', serif;font-size:16px;line-height:24px;">
	<span style="font-size:12px;"><span style="color:#009900;">via[</span><a href="http://www.codeproject.com/Articles/33340/Code-Injection-into-Running-Linux-Application" target="_blank"><span style="color:#009900;">codeproject</span></a><span style="color:#009900;">]</span></span></p>
                                                    </div>
                        <div class="article-oper article-oper-new">
                            <style>
                                @font-face {font-family: 'iconfont';
                                    src: url('http://static.3001.net/iconfonts/iconfont.eot'); /* IE9*/
                                    src: url('http://static.3001.net/iconfonts/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
                                    url('http://static.3001.net/iconfonts/iconfont.woff') format('woff'), /* chrome、firefox */
                                    url('http://static.3001.net/iconfonts/iconfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
                                    url('http://static.3001.net/iconfonts/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
                                }
                            </style>
                            <div class="share-new clearfix">
                                <div class="share-author">
                                                                            <a href="http://www.freebuf.com/author/0x80" title="由 0x80 发布" rel="author">
                                            <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png" width="50" height="50" alt="" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 photo avatar-default" />                                            <!--							<img src="http://image.3001.net/2015/06/17.jpg" alt="ArthurKiller">-->
                                        </a>
                                        <div class="share-author-info">
                                                                                        <a class="author-name" href="http://www.freebuf.com/author/0x80">0x80</a>
                                            <!--<span class="icon-f"></span>-->
                                            <span>
                                <i class="colour-red">
                                    1                                </i>
                                篇文章</span>
                                            <span>等级：
                                <i class="colour-green">1</i>级
                            </span>
                                        </div>
                                                                                                        </div>
                                <div class="user-center clearfix">
                                                                            <a href="http://www.freebuf.com/author/0x80" data-toggle="tooltip" data-placement="top" title="个人主页" class="home" target="_blank"></a>
                                                                        <a href="http://www.freebuf.com/user/pm?pmaction=newmessage&to=0x80" data-toggle="tooltip" data-placement="top" title="私信" class="letter" target="_blank"></a>
                                </div>
                                <div class="share-ctrl clearfix">
                                                                        <div class="bdsharebuttonbox clearfix bdshare-button-style1-24 columnstatus"
                                         data-bd-bind="1489991449190" data-column="" data-title="向正在运行的Linux应用程序注入代码" data-name="">
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="tsina" title="分享到新浪微博" id="tsina"></a>
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="weixin" title="分享到微信" id="weixin"></a>
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="qzone" title="分享到QQ空间" id="qzone"></a>
                                       <!-- _shareUrlWeibo = 'http://service.weibo.com/share/share.php?url=http://'+encodeURIComponent(_json[i].url)+'&title='+encodeURIComponent(_json[i].title)+'-FreeBuf涓撴爮路'+_json[i].columnName;
                                        _shareUrlZone = 'http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://'+encodeURIComponent(_json[i].url)+'&title='+_json[i].title+'-FreeBuf涓撴爮路'+_json[i].columnName;
                                        _shareSrc = 'http://s.jiathis.com/qrcode.php?url=http://'+_json[i].url;-->
                                        <span class="share-line">|</span>
                                    </div>
                                </div>
                                <div class="user-ctrl clearfix">
                                                                            <a href="http://www.freebuf.com/oauth" id="collect" data-toggle="tooltip" data-placement="top" title="收藏" ></a>
                                                                        <a href="#respond" data-toggle="tooltip" data-placement="top" title="评论" id="comments"></a>
                                                                        <!--					<a href="#" title="文章纠正">&#xe6e3;</a>-->
                                    <span class="share-line">|</span>
                                    <span class="info-alert"></span>
                                </div>
                            </div>
                            <script>
                                var column = $('.columnstatus').attr('data-column');
                                var text = '';
                                if(column){
                                    var title = $('.columnstatus').attr('data-title');
                                    var name = $('.columnstatus').attr('data-name');
                                    text = title+' - FreeBuf专栏·'+name;
                                }
                                window._bd_share_config={
                                    "common": {
                                        "bdSnsKey": {},
                                        "bdText": text,
                                        "bdMini": "2",
                                        "bdMiniList": ["qzone", "tsina", "weixin"],
                                        "bdPic": "",
                                        "bdStyle": "1",
                                        "bdSize": "24"
                                    },
                                    "share":{},
                                };
                                with(document)0[
                                    (getElementsByTagName('head')[0]||body).
                                    appendChild(createElement('script')).
                                        src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)
                                    ];
                                //控制垂直方向分享模块的定位
                                function shareFixVertical(){
                                    var offsetTop = jQuery(".article-oper").get(0).offsetTop;
                                    var win_h = jQuery(window).height();
                                    var win_w = jQuery(window).width();
                                    var scrollTop = document.body.scrollTop||document.documentElement.scrollTop;
                                    var _height = offsetTop-scrollTop;
                                    var _flag = $('.column-article').attr('data-column');
                                    if(_flag == 1) {
                                        if(_height>=win_h-660&&win_w>975){
                                            var _width = jQuery("#getWidth").innerWidth()-30;
                                            var _left = jQuery("#getWidth").offset().left+15;
                                            jQuery(".share-new").addClass("fixed");
                                            jQuery(".fixed").css({
                                                width:_width,
                                                left:_left
                                            });

                                        }else{
                                            jQuery(".share-new").removeClass("fixed");
                                            jQuery(".share-new").css({
                                                width: "100%"
                                            });
                                        }
                                    }else {
                                        if(_height>=win_h-255&&win_w>975){
                                            var _width = jQuery("#getWidth").innerWidth()-30;
                                            var _left = jQuery("#getWidth").offset().left+15;
                                            jQuery(".share-new").addClass("fixed");
                                            jQuery(".fixed").css({
                                                width:_width,
                                                left:_left
                                            });

                                        }else{
                                            jQuery(".share-new").removeClass("fixed");
                                            jQuery(".share-new").css({
                                                width: "100%"
                                            });
                                        }
                                    }
                                }
                                //控制水平方向分享模块的定位
                                function shareFixHorizontal(){
                                    var _width = jQuery("#getWidth").innerWidth()-30;
                                    var _left = jQuery("#getWidth").get(0).offsetLeft+15;
                                    var win_w = document.documentElement.clientWidth || document.body.clientWidth;
                                    jQuery(".fixed").css({
                                        width:_width,
                                        left:_left
                                    });
                                    if(win_w< 975){
                                        jQuery(".share-new").css({
                                            width: "100%",
                                            left: "0"
                                        });
                                    }else{
                                        var _width = jQuery("#getWidth").innerWidth()-30;
                                        var _left = jQuery("#getWidth").get(0).offsetLeft+15;
                                        jQuery(".fixed").css({
                                            width:_width,
                                            left:_left
                                        });
                                    }
                                }
                                function click(){
                                    var _w = jQuery(window).width();
                                    jQuery(document).click(function(e){
                                        if(jQuery(e.target).attr("id")=="weixin"){
                                            if(_w <= 760) {
                                                jQuery("#bdshare_weixin_qrcode_dialog").hide();
                                                layer.open({
                                                    title: '提示',
                                                    btnAlign: 'c',
                                                    content: '请使用手机浏览器自带的分享功能分享该页面',
                                                    area: '260px'
                                                });
                                            }else {
                                                jQuery("#bdshare_weixin_qrcode_dialog").show();
                                            }
                                        }else {
                                            jQuery("#bdshare_weixin_qrcode_dialog").hide();
                                        }
                                    });
                                }

                                jQuery(window).on("load",function(){
                                    shareFixVertical();
                                    click();
                                });

                                jQuery(window).on("scroll",function(){
                                    //判断滚轮方向
                                    var agent = navigator.userAgent;
                                    if (/.*Firefox.*/.test(agent)) {
                                        document.addEventListener("DOMMouseScroll", function(e) {
                                            e = e || window.event;
                                            var detail = e.detail;
                                            if (detail > 0) {
                                                $(".share-new").removeClass("fixed");
                                                $(".share-new").css({
                                                    width: "100%"
                                                });
                                                $('.main-header .header').removeClass('op1');
                                                $('.main-header .header').addClass('op0');
                                            } else {
                                                shareFixVertical();
                                                $('.main-header .header').removeClass('op0');
                                                $('.main-header .header').addClass('op1');
                                            }
                                        });
                                    } else {
                                        document.onmousewheel = function(e) {
                                            e = e || window.event;
                                            var wheelDelta = e.wheelDelta;
                                            if (wheelDelta > 0) {
                                                shareFixVertical();
                                                $('.main-header .header').removeClass('op0');
                                                $('.main-header .header').addClass('op1');
                                            } else {
                                                $(".share-new").removeClass("fixed");
                                                $(".share-new").css({
                                                    width: "100%"
                                                });
                                                $('.main-header .header').removeClass('op1');
                                                $('.main-header .header').addClass('op0');
                                            }
                                        }
                                    }
                                });


                                jQuery(window).on("resize",function(){
                                    shareFixHorizontal();
                                    click();
                                })

                                //tooltips提示
                                $(function () { $("[data-toggle='tooltip']").tooltip(); });
                            </script>
                        </div>
                                                                                                                            <div class="article-pager ">
                                <ul>
                                    <li class="previous"><span>上一篇：</span><a href="http://www.freebuf.com/articles/system/6315.html" rel="prev">针对虚拟机的渗透测试</a>                                    </li>
                                    <li class="next"><span>下一篇：</span>
                                        <a href="http://www.freebuf.com/vuls/6456.html" rel="next">Android Linux Kernel 2.6本地DoS</a>                                    </li>
                                </ul>
                            </div>
                                            </div>
                </div>
                    <div class="comment-bright"><div class="main-tit04">
    <h3>这些评论亮了</h3></div>      <ul>      <li>
            <div class="user_photo"> <a href="http://www.freebuf.com/author/global_hacker">
            <img src="http://image.3001.net/2014/04/QQ圖片20140401200158.jpg" width="58" height="58" /></a>
             </div>
            <div class="tit"><span class="name"> <a href="http://www.freebuf.com/author/global_hacker" target="_blank">global_hacker</a>  </span> 
						<span class="icon-f">  </span> 
			<span class="rank">(4级)</span>
						<span class="explain"></span>
			<span class="reply"><a onclick="return addComment.moveForm( 'comment-','', 'respond','6388' ) " href="?replytocom=#respond" class="comment-reply-link" rel="nofollow">回复</a></span></div>
            <div class="txt">
						虽然看不懂 但是好像很强大的 样子</div>
            <div class="but"><span class="vote-count">)</span><span style="none" id="cos_support-24574" class="vote-count">18</span><span class="vote-count">(</span><span class="vote">  <a class="ilike_icon" id="vote4-24574" href="javascript:acv_vote(4574,1,2);">亮了</a></span></div>
          </li>
            <li>
            <div class="user_photo"> <a href="http://www.freebuf.com/author/agui">
            <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png" width="58" height="58" /></a>
             </div>
            <div class="tit"><span class="name"> <a href="http://www.freebuf.com/author/agui" target="_blank">agui</a>  </span> 
						<span class="icon-f">  </span> 
			<span class="rank">(2级)</span>
						<span class="explain"></span>
			<span class="reply"><a onclick="return addComment.moveForm( 'comment-','', 'respond','6388' ) " href="?replytocom=#respond" class="comment-reply-link" rel="nofollow">回复</a></span></div>
            <div class="txt">
						:cool:</div>
            <div class="but"><span class="vote-count">)</span><span style="none" id="cos_support-24548" class="vote-count">7</span><span class="vote-count">(</span><span class="vote">  <a class="ilike_icon" id="vote4-24548" href="javascript:acv_vote(4548,1,2);">亮了</a></span></div>
          </li>
            <li>
            <div class="user_photo">             <img src="http://image.3001.net/images/headimg/pic16.png">             </div>
            <div class="tit"><span class="name"> cnbug </span> 
						<span class="explain"></span>
			<span class="reply"><a onclick="return addComment.moveForm( 'comment-','', 'respond','6388' ) " href="?replytocom=#respond" class="comment-reply-link" rel="nofollow">回复</a></span></div>
            <div class="txt">
						顶===。</div>
            <div class="but"><span class="vote-count">)</span><span style="none" id="cos_support-24547" class="vote-count">6</span><span class="vote-count">(</span><span class="vote">  <a class="ilike_icon" id="vote4-24547" href="javascript:acv_vote(4547,1,2);">亮了</a></span></div>
          </li>
            <li>
            <div class="user_photo"> <a href="http://www.freebuf.com/author/morris2600">
            <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png" width="58" height="58" /></a>
             </div>
            <div class="tit"><span class="name"> <a href="http://www.freebuf.com/author/morris2600" target="_blank">morris2600</a>  </span> 
						<span class="icon-f">  </span> 
			<span class="rank">(1级)</span>
						<span class="explain"></span>
			<span class="reply"><a onclick="return addComment.moveForm( 'comment-','', 'respond','6388' ) " href="?replytocom=#respond" class="comment-reply-link" rel="nofollow">回复</a></span></div>
            <div class="txt">
						动态打补丁就是这种方法吧，可以更新函数， 但是无法处理全局变量吧</div>
            <div class="but"><span class="vote-count">)</span><span style="none" id="cos_support-219431" class="vote-count">6</span><span class="vote-count">(</span><span class="vote">  <a class="ilike_icon" id="vote4-219431" href="javascript:acv_vote(19431,1,2);">亮了</a></span></div>
          </li>
         </ul></div><div class="comment-list">
      <div class="main-tit02">
		<a rel="nofollow" class="btnbtn-default btn-comment" href="#respond">发表评论</a>
        <h3>已有 <span class="color_red">19</span> 条评论
      </div>
      <ul>
         <li class="comment even thread-even depth-1" id="li-comment-4547">
    <div id="comment-4547">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic10.png">     </div>
    <div class="tit"> 
	    <span class="name"> cnbug </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2012-12-06</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-4547','4547', 'respond','6388' ) " href="?replytocom=4547#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">1楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>顶===。</p>
<div class="comment-tools">
<div class="vote" id="vote-4547"><span id="acv_stat_4547"></span><a class="ilike_icon"  id="vote4-4547" href="javascript:acv_vote(4547,1);">亮了</a>(<span id="cos_support-4547">6</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="4547" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="4547" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="4547" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="4547" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="4547" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-agui odd alt thread-odd thread-alt depth-1" id="li-comment-4548">
    <div id="comment-4548">
        <div class="photo"> <a href="http://www.freebuf.com/author/agui">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/agui" target="_blank">agui&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(2级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2012-12-06</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-4548','4548', 'respond','6388' ) " href="?replytocom=4548#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">2楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p> <img src='http://image.3001.net/images/index/smilies/icon_cool.gif' alt=':cool:' class='wp-smiley' /> </p>
<div class="comment-tools">
<div class="vote" id="vote-4548"><span id="acv_stat_4548"></span><a class="ilike_icon"  id="vote4-4548" href="javascript:acv_vote(4548,1);">亮了</a>(<span id="cos_support-4548">7</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="4548" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="4548" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="4548" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="4548" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="4548" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-4554">
    <div id="comment-4554">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic12.png">     </div>
    <div class="tit"> 
	    <span class="name"> chenyoufu123 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2012-12-06</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-4554','4554', 'respond','6388' ) " href="?replytocom=4554#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">3楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>好文章，明天试一把</p>
<div class="comment-tools">
<div class="vote" id="vote-4554"><span id="acv_stat_4554"></span><a class="ilike_icon"  id="vote4-4554" href="javascript:acv_vote(4554,1);">亮了</a>(<span id="cos_support-4554">5</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="4554" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="4554" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="4554" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="4554" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="4554" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-annie_duoduo odd alt thread-odd thread-alt depth-1" id="li-comment-4556">
    <div id="comment-4556">
        <div class="photo"> <a href="http://www.freebuf.com/author/annie_duoduo">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/annie_duoduo" target="_blank">annie_duoduo&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain"> I may not be there yet, but I’... </span>
		<span class="time">&nbsp;2012-12-06</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-4556','4556', 'respond','6388' ) " href="?replytocom=4556#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">4楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>嘿嘿，激动的试了一下，成功了，顶</p>
<div class="comment-tools">
<div class="vote" id="vote-4556"><span id="acv_stat_4556"></span><a class="ilike_icon"  id="vote4-4556" href="javascript:acv_vote(4556,1);">亮了</a>(<span id="cos_support-4556">5</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="4556" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="4556" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="4556" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="4556" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="4556" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-72503">
    <div id="comment-72503">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic17.png">     </div>
    <div class="tit"> 
	    <span class="name"> 无心化语_Coder<span class="weibo"></span> </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2012-12-06</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-72503','72503', 'respond','6388' ) " href="?replytocom=72503#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">5楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>其实可以预见到这类需求，就应该选用解释性脚本语言来做相关模块，会很容易实现</p>
<div class="comment-tools">
<div class="vote" id="vote-72503"><span id="acv_stat_72503"></span><a class="ilike_icon"  id="vote4-72503" href="javascript:acv_vote(72503,1);">亮了</a>(<span id="cos_support-72503">3</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="72503" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="72503" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="72503" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="72503" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="72503" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-72502">
    <div id="comment-72502">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic5.png">     </div>
    <div class="tit"> 
	    <span class="name"> julyclyde<span class="weibo"></span> </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2012-12-06</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-72502','72502', 'respond','6388' ) " href="?replytocom=72502#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">6楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>高级</p>
<div class="comment-tools">
<div class="vote" id="vote-72502"><span id="acv_stat_72502"></span><a class="ilike_icon"  id="vote4-72502" href="javascript:acv_vote(72502,1);">亮了</a>(<span id="cos_support-72502">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="72502" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="72502" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="72502" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="72502" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="72502" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-72501">
    <div id="comment-72501">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic7.png">     </div>
    <div class="tit"> 
	    <span class="name"> 詹天佐<span class="weibo"></span> </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2012-12-06</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-72501','72501', 'respond','6388' ) " href="?replytocom=72501#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">7楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>我部门N个人都是搞这个的。。。不过是windows下的</p>
<div class="comment-tools">
<div class="vote" id="vote-72501"><span id="acv_stat_72501"></span><a class="ilike_icon"  id="vote4-72501" href="javascript:acv_vote(72501,1);">亮了</a>(<span id="cos_support-72501">4</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="72501" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="72501" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="72501" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="72501" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="72501" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-linver odd alt thread-odd thread-alt depth-1" id="li-comment-4566">
    <div id="comment-4566">
        <div class="photo"> <a href="http://www.freebuf.com/author/Linver">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/Linver" target="_blank">Linver&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2012-12-07</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-4566','4566', 'respond','6388' ) " href="?replytocom=4566#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">8楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p> <img src='http://image.3001.net/images/index/smilies/icon_redface.gif' alt=':oops:' class='wp-smiley' />  学习+实践，嘿嘿。果断顶阿。</p>
<div class="comment-tools">
<div class="vote" id="vote-4566"><span id="acv_stat_4566"></span><a class="ilike_icon"  id="vote4-4566" href="javascript:acv_vote(4566,1);">亮了</a>(<span id="cos_support-4566">5</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="4566" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="4566" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="4566" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="4566" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="4566" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-dante even thread-even depth-1" id="li-comment-4570">
    <div id="comment-4570">
        <div class="photo"> <a href="http://www.freebuf.com/author/Dante">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/Dante" target="_blank">Dante&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(2级)</span>
				<span class="explain"> linuxer </span>
		<span class="time">&nbsp;2012-12-07</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-4570','4570', 'respond','6388' ) " href="?replytocom=4570#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">9楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>路过。刚学编程的 的&#8220;  看不懂</p>
<div class="comment-tools">
<div class="vote" id="vote-4570"><span id="acv_stat_4570"></span><a class="ilike_icon"  id="vote4-4570" href="javascript:acv_vote(4570,1);">亮了</a>(<span id="cos_support-4570">5</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="4570" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="4570" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="4570" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="4570" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="4570" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-global_hacker odd alt thread-odd thread-alt depth-1" id="li-comment-4574">
    <div id="comment-4574">
        <div class="photo"> <a href="http://www.freebuf.com/author/global_hacker">
    <img src="http://image.3001.net/2014/04/QQ圖片20140401200158.jpg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/global_hacker" target="_blank">global_hacker&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(4级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2012-12-07</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-4574','4574', 'respond','6388' ) " href="?replytocom=4574#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">10楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>虽然看不懂 但是好像很强大的 样子</p>
<div class="comment-tools">
<div class="vote" id="vote-4574"><span id="acv_stat_4574"></span><a class="ilike_icon"  id="vote4-4574" href="javascript:acv_vote(4574,1);">亮了</a>(<span id="cos_support-4574">18</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="4574" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="4574" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="4574" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="4574" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="4574" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-72500">
    <div id="comment-72500">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic7.png">     </div>
    <div class="tit"> 
	    <span class="name"> 程IT龙<span class="weibo"></span> </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2012-12-11</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-72500','72500', 'respond','6388' ) " href="?replytocom=72500#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">11楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>神经病</p>
<div class="comment-tools">
<div class="vote" id="vote-72500"><span id="acv_stat_72500"></span><a class="ilike_icon"  id="vote4-72500" href="javascript:acv_vote(72500,1);">亮了</a>(<span id="cos_support-72500">3</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="72500" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="72500" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="72500" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="72500" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="72500" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-4969">
    <div id="comment-4969">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic5.png">     </div>
    <div class="tit"> 
	    <span class="name"> 4nil </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2012-12-26</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-4969','4969', 'respond','6388' ) " href="?replytocom=4969#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">12楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>类似windows下的dll注入，hook</p>
<div class="comment-tools">
<div class="vote" id="vote-4969"><span id="acv_stat_4969"></span><a class="ilike_icon"  id="vote4-4969" href="javascript:acv_vote(4969,1);">亮了</a>(<span id="cos_support-4969">5</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="4969" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="4969" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="4969" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="4969" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="4969" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-5224">
    <div id="comment-5224">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic16.png">     </div>
    <div class="tit"> 
	    <span class="name"> OverTime </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2013-01-06</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-5224','5224', 'respond','6388' ) " href="?replytocom=5224#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">13楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p> <img src='http://image.3001.net/images/index/smilies/icon_idea.gif' alt=':idea:' class='wp-smiley' /> </p>
<div class="comment-tools">
<div class="vote" id="vote-5224"><span id="acv_stat_5224"></span><a class="ilike_icon"  id="vote4-5224" href="javascript:acv_vote(5224,1);">亮了</a>(<span id="cos_support-5224">5</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="5224" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="5224" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="5224" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="5224" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="5224" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-morris2600 odd alt thread-odd thread-alt depth-1" id="li-comment-19431">
    <div id="comment-19431">
        <div class="photo"> <a href="http://www.freebuf.com/author/morris2600">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/morris2600" target="_blank">morris2600&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2013-11-29</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-19431','19431', 'respond','6388' ) " href="?replytocom=19431#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">14楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>动态打补丁就是这种方法吧，可以更新函数， 但是无法处理全局变量吧</p>
<div class="comment-tools">
<div class="vote" id="vote-19431"><span id="acv_stat_19431"></span><a class="ilike_icon"  id="vote4-19431" href="javascript:acv_vote(19431,1);">亮了</a>(<span id="cos_support-19431">6</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="19431" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="19431" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="19431" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="19431" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="19431" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-qq6a52f6b318aa561a62e7d1564d41d735 even thread-even depth-1" id="li-comment-35791">
    <div id="comment-35791">
        <div class="photo"> <a href="http://www.freebuf.com/author/QQ6A52F6B318AA561A62E7D1564D41D735">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/QQ6A52F6B318AA561A62E7D1564D41D735" target="_blank">池上好风&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2014-01-16</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-35791','35791', 'respond','6388' ) " href="?replytocom=35791#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">15楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>测试成功，非常强大！！！</p>
<div class="comment-tools">
<div class="vote" id="vote-35791"><span id="acv_stat_35791"></span><a class="ilike_icon"  id="vote4-35791" href="javascript:acv_vote(35791,1);">亮了</a>(<span id="cos_support-35791">4</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="35791" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="35791" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="35791" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="35791" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="35791" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment odd alt depth-2" id="li-comment-35896">
    <div id="comment-35896">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic11.png">     </div>
    <div class="tit"> 
	    <span class="name"> 匿名 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2014-01-17</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-35896','35896', 'respond','6388' ) " href="?replytocom=35896#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@池上好风   你好，请问你试过那个讲解Linux hook api的方法吗？ （http://blog.csdn.net/yyttiao/article/details/7777032），在测试时，发现现在都没有glibc中没有_dl_open，应该是已经被静态编译进去了。请问有办法解决吗？</p>
<div class="comment-tools">
<div class="vote" id="vote-35896"><span id="acv_stat_35896"></span><a class="ilike_icon"  id="vote4-35896" href="javascript:acv_vote(35896,1);">亮了</a>(<span id="cos_support-35896">3</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="35896" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="35896" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="35896" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="35896" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="35896" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-sina2259650934 even thread-odd thread-alt depth-1" id="li-comment-53022">
    <div id="comment-53022">
        <div class="photo"> <a href="http://www.freebuf.com/author/SINA2259650934">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/SINA2259650934" target="_blank">飞絮的低自尊&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2014-10-11</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-53022','53022', 'respond','6388' ) " href="?replytocom=53022#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">16楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p> <img src='http://image.3001.net/images/index/smilies/icon_mrgreen.gif' alt=':mrgreen:' class='wp-smiley' /> </p>
<div class="comment-tools">
<div class="vote" id="vote-53022"><span id="acv_stat_53022"></span><a class="ilike_icon"  id="vote4-53022" href="javascript:acv_vote(53022,1);">亮了</a>(<span id="cos_support-53022">4</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="53022" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="53022" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="53022" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="53022" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="53022" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-littlehann odd alt thread-even depth-1" id="li-comment-60571">
    <div id="comment-60571">
        <div class="photo"> <a href="http://www.freebuf.com/author/LittleHann">
    <img src="http://image.3001.net/2015/07/simba.jpeg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/LittleHann" target="_blank">LittleHann&nbsp;</a>  </span>
        		
		<span class="icon-f"> <a href="http://www.freebuf.com/bufer" target="_blank"><img src="http://image.3001.net/images/index/f1.png" title="认证作者"></a></span>
		<span class="rank">(5级)</span>
				<span class="explain"> 阿里巴巴安全工程师 </span>
		<span class="time">&nbsp;2015-01-05</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-60571','60571', 'respond','6388' ) " href="?replytocom=60571#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">17楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>感谢楼主分享，来学习了，Linux下没有win的CreateRemoteThread，使用GDB的调试注入方式向目标进程注入可执行代码，这个技术可以实现Kill Process了</p>
<div class="comment-tools">
<div class="vote" id="vote-60571"><span id="acv_stat_60571"></span><a class="ilike_icon"  id="vote4-60571" href="javascript:acv_vote(60571,1);">亮了</a>(<span id="cos_support-60571">5</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="60571" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="60571" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="60571" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="60571" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="60571" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="li-comment-127518">
    <div id="comment-127518">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic11.png">     </div>
    <div class="tit"> 
	    <span class="name"> 峰回 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2015-09-17</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-127518','127518', 'respond','6388' ) " href="?replytocom=127518#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">18楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>不错，支持下。请继续保持这种作风。</p>
<div class="comment-tools">
<div class="vote" id="vote-127518"><span id="acv_stat_127518"></span><a class="ilike_icon"  id="vote4-127518" href="javascript:acv_vote(127518,1);">亮了</a>(<span id="cos_support-127518">3</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="127518" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="127518" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="127518" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="127518" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="127518" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
      </ul>
      <div class="commentnav page01" style="padding-top:10px; text-align: center;">
               </div>
	  
<script src="http://www.freebuf.com/buf/themes/freebuf/js/ajaxfileupload.js" type="text/javascript"></script>
<div id="respond" class="comment-box">
<input type="file" id="uploadUnit" name="upfile" class="hidden" value="">
    <form action="http://www.freebuf.com/wp-comments-post.php" method="post" id="commentform">
        <div id="comment-author-info">
	    <div class="login-other">
		  <div class="login_button login_icon_sina" title="使用新浪微博登陆" onclick="login_button_click('sina')"></div>
          <div class="login_button login_icon_qq" title="使用腾讯QQ登陆" onclick="login_button_click('qq')"></div></div>
        <div class="login-input">
	    <p><label for="author">昵称</label>
		          <input type="text" name="author" id="author" value="" size="14" tabindex="1" aria-required='true' placeholder = "请输入昵称" required />
        </p><span>必须</span><span>您当前尚未登录。<a  class="simplemodal-login" href="http://www.freebuf.com/oauth" title="登陆">登陆？</a><a  href="https://account.tophant.com/register.html" target="_blank">注册</a></span></div>
		<div class="login-input">
		  <p><label for="email">邮箱</label><input type="text" name="email" id="email" value="" size="25" tabindex="2" aria-required='true' placeholder = "请输入邮箱地址" required /></p>
		<span>必须（保密）</span>
		</div>
    </div>

        <div id="test" class="post-area">
      <div class="holiday"></div>
	    <div class="comment-editor">
			<a id="comment-smiley" href="javascript:;">表情</a><a href="javascript:;" id="imageThumb">插图</a>
	    </div>
        <div id="smileys" >
           <a title="mrgreen" href="javascript:grin(':mrgreen:')"><img src="http://image.3001.net/images/index/smilies/icon_mrgreen.gif" /></a><a title="razz" href="javascript:grin(':razz:')"><img src="http://image.3001.net/images/index/smilies/icon_razz.gif" /></a><a title="sad" href="javascript:grin(':sad:')"><img src="http://image.3001.net/images/index/smilies/icon_sad.gif" /></a><a title="smile" href="javascript:grin(':smile:')"><img src="http://image.3001.net/images/index/smilies/icon_smile.gif" /></a><a title="oops" href="javascript:grin(':oops:')"><img src="http://image.3001.net/images/index/smilies/icon_redface.gif" /></a><a title="grin" href="javascript:grin(':grin:')"><img src="http://image.3001.net/images/index/smilies/icon_biggrin.gif" /></a><a title="eek" href="javascript:grin(':eek:')"><img src="http://image.3001.net/images/index/smilies/icon_surprised.gif" /></a><a title="???" href="javascript:grin(':???:')"><img src="http://image.3001.net/images/index/smilies/icon_confused.gif" /></a><a title="cool" href="javascript:grin(':cool:')"><img src="http://image.3001.net/images/index/smilies/icon_cool.gif" /></a><a title="lol" href="javascript:grin(':lol:')"><img src="http://image.3001.net/images/index/smilies/icon_lol.gif" /></a><a title="mad" href="javascript:grin(':mad:')"><img src="http://image.3001.net/images/index/smilies/icon_mad.gif" /></a><a title="twisted" href="javascript:grin(':twisted:')"><img src="http://image.3001.net/images/index/smilies/icon_twisted.gif" /></a><a title="roll" href="javascript:grin(':roll:')"><img src="http://image.3001.net/images/index/smilies/icon_rolleyes.gif" /></a><a title="wink" href="javascript:grin(':wink:')"><img src="http://image.3001.net/images/index/smilies/icon_wink.gif" /></a><a title="idea" href="javascript:grin(':idea:')"><img src="http://image.3001.net/images/index/smilies/icon_idea.gif" /></a><a title="arrow" href="javascript:grin(':arrow:')"><img src="http://image.3001.net/images/index/smilies/icon_arrow.gif" /></a><a title="neutral" href="javascript:grin(':neutral:')"><img src="http://image.3001.net/images/index/smilies/icon_neutral.gif" /></a><a title="cry" href="javascript:grin(':cry:')"><img src="http://image.3001.net/images/index/smilies/icon_cry.gif" /></a><a title="?" href="javascript:grin(':?:')"><img src="http://image.3001.net/images/index/smilies/icon_question.gif" /></a><a title="evil" href="javascript:grin(':evil:')"><img src="http://image.3001.net/images/index/smilies/icon_evil.gif" /></a><a title="shock" href="javascript:grin(':shock:')"><img src="http://image.3001.net/images/index/smilies/icon_eek.gif" /></a><a title="!" href="javascript:grin(':!:')"><img src="http://image.3001.net/images/index/smilies/icon_exclaim.gif" /></a>        </div>
         <textarea name="comment" id="comment" cols="100%" rows="7" tabindex="4" style="overflow-x:hidden; overflow-y:hidden; border:0; width:100%;" onkeydown="if(event.ctrlKey&amp;&amp;event.keyCode==13){document.getElementById('submit').click();return false};"></textarea>
    </div>
      <div class="subcon but">
      <input class="btn btn-success" type="submit" name="submit" id="submit" tabindex="5" value="提交评论(Ctrl+Enter)" />
      <a rel="nofollow" class="btn btn-default" id="cancel-comment-reply-link" href="javascript:;">取消</a>
      <div class="checkbox"><input type='hidden' name='comment_post_ID' value='6388' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
<label for="comment_mail_notify" class="comment_mail"><input type="checkbox" name="comment_mail_notify" id="comment_mail_notify" value="comment_mail_notify" checked="checked"/>有人回复时邮件通知我</label></div>
      </div>
    <input name="Token" id="Token" type="hidden" value="0lp6iw" />
  </form>
  </div>
</div>	  
<div class="commentshow">
<div class="comments-loading">Loading...</div>
</div>
<script language="javascript">
jQuery(document).ready(function($){ //Begin jQuery
    $('.reply').click(function() {
    var atid = '"#' + $(this).parent().attr("id") + '"';
    var atname = $(this).parent().find('span:first').text();
    $("#comment").val("@" + atname + " ").focus();
});
    $('.cancel-comment-reply a').click(function() { //点击取消回复评论清空评论框的内容
    $("#comment").val('');
});
}) 

jQuery(document).ready(function($) {
    $body = (window.opera) ? (document.compatMode == "CSS1Compat" ? $('html') : $('body')) : $('html,body');//commentnav ajax
    $(document).on('click', '.commentnav a', function(e) {
        e.preventDefault();
        $.ajax({
            type: "GET",
            url: $(this).attr('href'),
            beforeSend: function() {
                $('.commentnav').remove();
                $('.comment-list').remove();
                $('.comments-loading').slideDown();
            },
            dataType: "html",
            success: function(out) {
                result = $(out).find('.comment-list');
                nextlink = $(out).find('.commentnav');
                $('.comments-loading').slideUp(550);
                $('.comments-loading').after(result.fadeIn(800));
                $(".comment-list img").each(function(){
                  var url = $(this).attr("data-original");
                  $(this).attr("src",url);
                })
            }
        });
    });    
});
</script>            </div>
                    <div class="col-md-3 visible-md-block visible-lg-block">
                <div class="panel panel-default">
                    <div class="author-top">
                         <div class="author-wrap">
                            <div class="author-header"><img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-150x150.png" width="100" height="100" alt="" class="avatar avatar-100 wp-user-avatar wp-user-avatar-100 photo avatar-default" />                            </div>
                            <p class="name"><a href="http://www.freebuf.com/author/0x80" title="由 0x80 发布" rel="author">0x80</a><span></span></p>
                            <p class="signature">nothing</p>
                            <p class="art-com clearfix">
                                <span class="aut-article">
                                    <a href="/author/0x80"target="_blank">
                                        <i>1</i>
                                        <i>文章数</i>
                                    </a>
                                </span>
                                <span class="aut-comment">
                                    <a href="/author/0x80?comment=1" target="_blank">
                                        <i>2</i>
                                        <i>评论数</i>
                                    </a>
                                </span>
                            </p>
                        </div>
                    </div>
                    <div class="author-bottom">
                        <div class="author-wrap">
                            <h3 class="last-title">最近文章</h3>
                            <div class="last-item-wrap">
                                                                        <div class="last-item">
                                            <a href="http://www.freebuf.com/articles/system/6388.html" target="_blank"><span class="point"></span>向正在运行的Linux应用程序注入代码</a>
                                            <p class="last-time">2012.12.06</p>
                                        </div>
                                                                </div>
                        </div>

                        <div class="more-wrap">
                            <a href="http://www.freebuf.com/author/0x80" target="_blank" class="btn-new">浏览更多</a>
                        </div>
                    </div>
                </div>
                                <div class="panel panel-default">
                    <div class="read visible-md-block visible-lg-block">
                        <div class="main-tit02">
                            <h3>相关阅读</h3>
                        </div>
                        <ul>
  <li><a href="http://www.freebuf.com/vuls/85647.html" target="_blank">首个Linux勒索软件马失前蹄：加密存在漏洞可被人攻破</a></li>
  
  <li><a href="http://www.freebuf.com/news/117677.html" target="_blank">脏牛漏洞影响范围超出想象，以后所有Android手机都能被Root？</a></li>
  
  <li><a href="http://www.freebuf.com/vuls/93799.html" target="_blank">Linux内核提权漏洞的分析和利用（CVE-2016-0728）</a></li>
  
  <li><a href="http://www.freebuf.com/sectool/181.html" target="_blank">CERT发布Linux安全工具Triage Tools 1.0</a></li>
  
  <li><a href="http://www.freebuf.com/articles/system/121540.html" target="_blank">Linux强化论：15步打造一个安全的Linux服务器</a></li>
  </ul>                    </div>
                </div>
                <!--<div class="ad-wrap"><a href="http://www.ijiami.cn/?freebuf.com" target="_blank"><img width="100%" src="http://image.3001.net/images/20141201/14174039186901.jpg"></a></div>-->
                <div class="panel panel-default rec-spe">
                    <div class="main-tit03 colour-blue">
                        <h3>特别推荐</h3>
                    </div>
                                                    <div class="rec-img"><a href="http://www.freebuf.com/ad?id=3" target="_blank"><img
                                            src="http://image.3001.net/2017/05/14a10c5c919d154dddbee79e3a944143-220x150.png" width="220"></a></div>
                                                </div>
                <div id="mar-right">
                    <!--<div class="read visible-lg-block">
        <div class="main-tit04">
          <h3>商城新品</h3>
        </div>
        <div id="slider" class="nivoSlider">  </div>
      </div>-->
                    <div class="panel panel-default code"><img src="http://image.3001.net/images/new/code.jpg" width="192"
                                                               height="192">
                        <p>关注我们 分享每日精选文章</p>
                    </div>
                </div>
            </div>
                </div>
                    <div class="row marvellous visible-lg-block">
                <h3>不容错过</h3>
                <ul>
                                                <li><a href="http://www.freebuf.com/news/58217.html" rel="bookmark"
                                   title="黑客伪装美女窃取叙利亚反对派近8G军事机密">黑客伪装美女窃取叙利亚反对派近8G军事机密</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/cindy" title="由 cindy 发布" rel="author">cindy</a></span>
                                                                        <span class="time">2015-02-04</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/sectool/141234.html" rel="bookmark"
                                   title="修改Metasploit安卓Payload源码以实现持久化访问">修改Metasploit安卓Payload源码以实现持久化访问</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/xiaohuanshu" title="由 xiaohuanshu 发布" rel="author">xiaohuanshu</a></span>
                                                                        <span class="time">2017-07-27</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/articles/terminal/144662.html" rel="bookmark"
                                   title="浅谈非PE的攻击技巧">浅谈非PE的攻击技巧</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/%E6%B8%94%E6%9D%91%E5%AE%89%E5%85%A8" title="由 渔村安全 发布" rel="author">渔村安全</a></span>
                                                                        <span class="time">2017-08-21</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/articles/es/142957.html" rel="bookmark"
                                   title="如何写好一篇漏洞报告（国外篇）">如何写好一篇漏洞报告（国外篇）</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/%e6%bc%8f%e6%b4%9e%e7%9b%92%e5%ad%90" title="由 漏洞盒子 发布" rel="author">漏洞盒子</a></span>
                                                                        <span class="time">2017-08-21</span></p>
                            </li>
                                                            </ul>
            </div>
            </div>
</div>
<script type="text/javascript">
  $(window).load(function() {
    $('#slider').nivoSlider();
  });
  $('#contenttxt img').removeAttr('height');
  $('#contenttxt img').wrap(function(){
    if(!$(this).parent().attr('href')){
      var imgurl = $(this).attr('data-original');
      if(imgurl.substr(-6)=='!small'){
        imgurl = imgurl.substring(0,imgurl.length-6);
      }
      return '<a href="' + imgurl + '" class="highslide-image" onclick="return hs.expand(this);" target="_blank"></a>';
    }
  })
</script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/comments-ajax.js" type="text/javascript"></script>
<script type="text/javascript" src="http://static.3001.net/js/focus/jquery.nivo.slider.pack.js"></script>
<!----------footer---------->
<div class="footer">
  <div class="container">
    <div class="footer-list ">
      <h3>FREEBUF</h3>
      <ul>
        <li><a href="http://www.freebuf.com/dis">免责声明</a></li>
        <li><a href="http://www.freebuf.com/news/others/864.html">关于我们</a></li>
        <li><a href="http://www.freebuf.com/jobs/40386.html">加入我们</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>广告及服务</h3>
      <ul>
        <li><a target="_blank" href="mailto:root@freebuf.com">寻求报道</a></li>
        <li><a href="http://www.freebuf.com/advertise">广告合作</a></li>
        <li><a target="_blank" href="mailto:help@freebuf.com">联系我们</a></li>
        <li><a href="http://www.freebuf.com/friends">友情链接</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>关注我们</h3>
      <ul>
        <li><div class="weixin-pannel weixin"><a class="qr" href="javascript:viod(0);"><span class="g-icon-qr1">官方微信</span><i></i></a></div></li>
        <li><a rel="nofollow" target="_blank" href="http://weibo.com/freebuf">新浪微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://t.qq.com/freebuf">腾讯微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://twitter.com/freebuf">Twitter</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>赞助商</h3>
      <ul>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="http://www.aliyun.com/?freebuf"><img src="http://image.3001.net/images/ad/ali.png"></a></li>
        <li><a rel="nofollow" target="_blank" href="http://www.upyun.com/?freebuf"><img src="http://image.3001.net/images/ad/upyun.png"></a></li>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="https://www.trustasia.com/?freebuf"><img src="http://image.3001.net/images/ad/ad-yzcx.png"></a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <ul>
      </ul>
    </div>
    <div class="footer-logo  pull-right"><img src="http://image.3001.net/images/index/freebufrobot_shendanjie.png" ></div>
  </div>
  <div class="copyright"><div class="container"><p>Copyright &copy; 2017 WWW.FREEBUF.COM All Rights Reserved <a rel="nofollow" target="_blank" href="http://www.miitbeian.gov.cn">沪ICP备13033796号</a></p><span><a rel="nofollow" target="_blank" href="http://click.aliyun.com/m/1336/?freebuf"><img src="http://image.3001.net/images/new/icon-aly.png"></a></span></div></div>
</div>
<div class="bottom_tools"><a id="scrollUp" href="javascript:;" title="飞回顶部"></a></div>
<!----------footer end----------> 
<script src="http://static.3001.net/js/new/backtop.js"></script>
<script type="text/javascript">
jQuery(function(){	
	jQuery('.tabPanes ul li').click(function(){
		jQuery(this).addClass('hit').siblings().removeClass('hit');
		jQuery('.panesl>div:eq('+jQuery(this).index()+')').show().siblings().hide();	
	})
	jQuery('.vulbox-nav').click(function(e) { 
        e.stopPropagation(); 
    });  
})
</script>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fcc53db168808048541c6735ce30421f5' type='text/javascript'%3E%3C/script%3E"));
</script>
<img alt='css.php' src="http://www.freebuf.com/buf/plugins/cc/css.php?k=3cb185a485c81b23211eb80b75a406fd&amp;o=i&amp;t=1918781616" width='1' height='1' /><script type="text/javascript">
jQuery(function() {
    jQuery(".simditor pre").each(function(i, block){
        hljs.highlightBlock(block);    
    });
    hljs.initHighlightingOnLoad();
});
</script>
<script>
/* <![CDATA[ */
var rcGlobal = {
	serverUrl		:'http://www.freebuf.com',
	infoTemp		:'%REVIEWER% on %POST%',
	loadingText		:'Loading',
	noCommentsText	:'No comments',
	newestText		:'&laquo; 最新',
	newerText		:'&laquo; 新一点',
	olderText		:'旧一点 &raquo;',
	showContent		:'1',
	external		:'1',
	avatarSize		:'32',
	avatarPosition	:'left',
	anonymous		:'Anonymous'
};
/* ]]> */
</script>
<script type='text/javascript' src='http://static.3001.net/js/recentcomments/wp-recentcomments-jquery.js?ver=2.2.3'></script>
</body>
</html>
