<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
                              _.._        ,------------.
                           ,'      `.    ( We want you! )
                          /  __) __` \    `-,----------'
                         (  (`-`(-')  ) _.-'
                         /)  \  = /  (
                        /'    |--' .  \
                       (  ,---|  `-.)__`
                        )(  `-.,--'   _`-.
                       '/,'          (  Uu",
                        (_       ,    `/,-' )
                        `.__,  : `-'/  /`--'
                          |     `--'  |
                          `   `-._   /
                           \        (
                           /\ .      \.  freebuf
                          / |` \     ,-\
                         /  \| .)   /   \
                        ( ,'|\    ,'     :
                        | \,`.`--"/      }
                        `,'    \  |,'    /
                       / "-._   `-/      |
                       "-.   "-.,'|     ;
                      /        _/["---'""]
                     :        /  |"-     '
                     '           |      /
                                 `      |
-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  代码战争：伪装和狙杀，从“壳”到“病毒混淆器” - FreeBuf.COM | 关注黑客与极客</title>
<meta name="description" content="一、前言
“壳”（Packer）——在安全领域同APT一样，是一个宽泛的概念，即指代一类对可执行代码及数据进行包装已达到隐藏、压缩或保护等目的的运行时代码。
在病毒与安全软件的代码对抗过程中，“壳”一直扮演着极为重要…" />
<meta name="keywords" content="代码战争, 壳, 火绒安全, 系统安全解决方案,系统安全软件排行,系统安全技术" />
<meta name="baidu-site-verification" content="nKKKqQxp6R" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="renderer" content="webkit">
<meta property="qc:admins" content="6620477777662552566375" />
<link rel='stylesheet' id='wpfp-css' href='http://www.freebuf.com/buf/plugins/wp-favorite-posts/wpfp.css' type='text/css' />
<link rel='stylesheet' id='wp-recentcomments-css'  href='http://static.3001.net/css/recentcomments/wp-recentcomments.css?ver=2.2.3' type='text/css' media='screen' />
<link rel='stylesheet' id='mycred-widget-css'  href='http://www.freebuf.com/buf/plugins/gold/assets/css/widget.css?ver=1.3.2.1' type='text/css' media='all' />
<script type='text/javascript' src='http://static.3001.net/js/header/jquery.min.js?ver=3.6.1'></script>
<script type='text/javascript' src='http://www.freebuf.com/buf/plugins/wp-favorite-posts/wpfp.js?ver=3.6.1'></script>
<link rel='prev' title='KCon黑客大会第二日议题荟萃' href='http://www.freebuf.com/fevents/113151.html' />
<link rel='next' title='LOKI：一款APT威胁指标扫描软件' href='http://www.freebuf.com/sectool/113050.html' />
<link rel='canonical' href='http://www.freebuf.com/articles/system/112631.html' />
<link rel='shortlink' href='http://www.freebuf.com/?p=112631' />

<link rel="stylesheet" href="http://static.3001.net/css/highslide/highslide.css" type="text/css" />
<script type="text/javascript" src="http://static.3001.net/js/highslide/highslide-with-html.packed.js"></script>
<script type="text/javascript">
jQuery(document).ready(function($) {
    hs.graphicsDir = "http://www.freebuf.com/buf/plugins/auto-highslide/images/graphics/";
    hs.outlineType = "rounded-white";
    hs.dimmingOpacity = 0.8;
    hs.outlineWhileAnimating = true;
    hs.showCredits = false;
    hs.captionEval = "this.thumb.alt";
    hs.numberPosition = "caption";
    hs.align = "center";
    hs.transitions = ["expand", "crossfade"];
    hs.addSlideshow({
        interval: 5000,
        repeat: true,
        useControls: true,
        fixedControls: "fit",
        overlayOptions: {
            opacity: 0.75,
            position: "bottom center",
            hideOnMouseOut: true

        }

    });
});
</script>
          <script language="JavaScript" type="text/javascript" src="http://www.freebuf.com/buf/plugins/cartpauj-pm/js/script.js"></script>
      <link rel="stylesheet" type="text/css" href="http://www.freebuf.com/buf/plugins/cartpauj-pm/style/style.css" />
      <script type="text/javascript" src="http://www.freebuf.com/buf/plugins/simditor/highlight/highlight.pack.js"></script><link type="text/css" rel="stylesheet" href=" http://www.freebuf.com/buf/plugins/simditor/highlight/styles/default.css" />	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<link rel="shortcut icon" href="http://static.freebuf.com/images/favicon.ico" />
<link rel="stylesheet" href="http://static.3001.net/css/new/header.css" />
<link href="http://static.3001.net/css/new/bootstrap.min.css?ver=2016051701" rel="stylesheet" media="screen">
    <!--轮播图-->
    <link href="http://static.3001.net/css/new/swiper-3.4.2.min.css" rel="stylesheet" type="text/css">
    <link href="http://static.3001.net/css/new/style.css?ver=20170912568" rel="stylesheet" type="text/css">
    <style type="text/css">
#contenttxt hr {
  display: block;
  height: 0px;
  border: 0;
  border-top: 1px solid #ccc;
  margin: 15px 0;
  padding: 0;
}
#contenttxt table {
  width: 100%;
  table-layout: fixed;
  border-collapse: collapse;
  border-spacing: 0;
  margin: 15px 0;
}
#contenttxt table thead {
  background-color: #f9f9f9;
}
#contenttxt table td, #contenttxt table th {
  min-width: 40px;
  height: 30px;
  border: 1px solid #ccc;
  vertical-align: top;
  padding: 2px 4px;
  text-align: left;
  box-sizing: border-box;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
#contenttxt table td.active, #contenttxt table th.active {
  background-color: #ffffee;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
</style>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/jquery-2.0.3.min.js"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/bootstrap.min.js"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/slider.js?2016022501.1" type="text/javascript"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/jquery.sticky.js" type="text/javascript"></script>
<script src="http://static.3001.net/js/focus/bjqs-1.3.min.js" type="text/javascript" ></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/mosaic.1.0.1.min.js" type="text/javascript" ></script>
<script type="text/javascript" src="http://static.3001.net/js/new/setint.js"></script>
    <!--轮播图-->
    <script src="http://static.3001.net/js/colum/swiper-3.4.2.min.js"></script>
<!--[if lt IE 9]>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/html5shiv.min.js"></script>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/respond.min.js"></script>
<![endif]-->
    <style>
        @font-face {font-family: 'iconfont';
            src: url('http://static.3001.net/iconfont/iconfont.eot'); /* IE9*/
            src: url('http://static.3001.net/iconfont/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
            url('http://static.3001.net/iconfont/iconfont.woff') format('woff'), /* chrome、firefox */
            url('http://static.3001.net/iconfont/iconfonticonfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
            url('http://static.3001.net/iconfont/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
        }
    </style>
</head>

<body>
<!----------header---------->
<!--头部导航-->
<div id="undefined-sticky-wrapper" class="sticky-wrapper is-sticky">
    <div class="main-header">
        <div class="header">
            <div class="header-container clearfix">
                                <div class="header-logo"><a href="http://www.freebuf.com"></a></div>
                                        <!-- column -->
                        <div class="nav">
                            <ul class="nav-child clearfix">
                                <li class=" index">
                                    <a href="http://www.freebuf.com">首页</a></li>
                                <li data-value="read-menu">
                                    <a href="#">分类阅读<b class="triangle-down triangle-down-04"></b></a>
                                </li>
                                <li data-value="wenku-menu"><a href="javascript:;" target="_blank">文库<b class="triangle-down triangle-down-04"></b></a></li>
                                <li>
                                    <a href="http://zhuanlan.freebuf.com" target="_blank">专栏</a><b class="icon-betr"></b>
                                </li>
                                <li><a href="http://open.freebuf.com" target="_blank">公开课</a></li>
                                <li><a href="http://shop.freebuf.com" target="_blank">商城</a></li>
                                <li data-value="company-menu"><a href="javascript:;" >企业服务<b class="triangle-down triangle-down-04"></b></a></li>
                                <li data-value="user-menu"><a href="javascript:;" >用户服务<b class="triangle-down triangle-down-04"></b></a></li>
                            </ul>
                        </div>
                                        <div class="header-right">
                                    <div class="loginSign login-before">
                        <a href="https://account.tophant.com/register.html" class="login-btn">注册</a>
                        |
                        <a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a>
                    </div>
                                    <!--搜索-->
                    <div class="search-form-inner clearfix">
                        <i class="searchdisplayico"></i>
                        <div class="form-group has-active search-col search-form-text">
                            <form id="hpsform-new" class="navbar-search navbar-form" onsubmit="return dispatch();">
                                <div class="form-group">
                                    <input id="bigq" class="input form-control" type="text" placeholder="关键字查找" autocomplete="off" title="关键字查找" name="q">
                                    <button class="submit" type="submit"></button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <!--<script>
                        $('.search-form-inner .searchdisplayico').click(function(event) {
                            var evt = evt || event;
                            evt.stopPropagation();
                            $(this).siblings('.search-col').addClass('active');
                        });
                        $('.search-form-inner .search-col').click(function(event) {
                            var evt = evt || event;
                            evt.stopPropagation();
                            $('.search-form-inner .search-col').addClass('active');
                        });
                        $(document).click(function() {
                            $('.search-form-inner .search-col').removeClass('active');
                        });
                    </script>-->
                                    <div class="btn-publish">
                        <a href="#">投稿</a>
                        <div class="btn-publish-child">
                            <ul class="btn-child clearfix">
                                <li><a href="http://my.freebuf.com/post/edit/" target="_blank">文章撰写</a></li>
                                <li><hr/></li>
                                <li><a href="http://my.freebuf.com/post/article/" target="_blank">投稿管理</a></li>
                                                        </ul>
                        </div>
                    </div>
                </div>
                <div class="nav-small">
                    <a href="#">&#xe634;</a>
                    <ul class="nav-child clearfix">
                                                        <li class=" index">
                                    <a href="http://www.freebuf.com">首页</a></li>
                                <li class="read-classify">
                                    <a href="#">分类阅读<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2 read-classify clearfix">
                                        <li>
                                            <strong>黑客</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                                <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                                <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                                <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                                <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                                <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                                <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                                <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                                <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                                <a href="http://www.freebuf.com/articles/es" target="_blank">企业安全</a>
                                                <a href="http://www.freebuf.com/ics-articles" target="_blank">工控安全</a>
                                            </div>
                                        </li>
                                        <li>
                                            <strong>极客</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                                <a href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                                            </div>
                                        </li>
                                        <li>
                                            <strong>特色</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/news/special" target="_blank">头条</a>
                                                <a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a>
                                                <a href="http://www.freebuf.com/fevents" target="_blank">活动</a>
                                                <a href="http://www.freebuf.com/video" target="_blank">视频</a>
                                                <a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a>
                                                <a href="http://www.freebuf.com/jobs" target="_blank">招聘</a>
                                                <a href="http://www.freebuf.com/paper/" target="_blank">报告</a>
                                            </div>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="http://zhuanlan.freebuf.com/" target="_blank">专栏</a></li>
                                <li><a href="http://open.freebuf.com" target="_blank">公开课</a></li>
                                <li><a href="http://shop.freebuf.com" target="_blank">商城</a></li>
                                <li>
                                    <a href="javascript:;" target="_blank">企业服务<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="https://www.vulbox.com/bounties/item-9-0-1" target="_blank"><strong>企业SRC</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://company.freebuf.com" target="_blank"><strong>企业空间</strong></a>
                                        </li>
                                        <li>
                                            <a href="https://www.vulbox.com/" target="_blank"><strong>安全测试</strong></a>
                                        </li>
                                        <li>
                                            <a href="https://www.riskivy.com/" target="_blank"><strong>风险感知</strong></a>
                                        </li>

                                    </ul>
                                </li>
                                <li>
                                    <a href="javascript:;" target="_blank">用户服务<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="http://www.freebuf.com/newsend" target="_blank"><strong>有奖投稿</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://zhuanlan.freebuf.com" target="_blank">
                                        </li>
                                        <li>
                                            <a href="https://www.vulbox.com/bounties/detail-72" target="_blank"><strong>提交漏洞</strong></a>
                                        </li>
                                        <li class="last">
                                            <a href="https://www.vulbox.com/bounties" target="_blank"><strong>参与众测</strong></a>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="javascript:;" target="_blank">文库<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="http://www.freebuf.com/wenku" target="_blank"><strong>文库</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://www.freebuf.com/special-subject" target="_blank"><strong>专题</strong></a>
                                        </li>
                                    </ul>
                                </li>
                                                    <li><a href="http://my.freebuf.com/post/edit" target="_blank">投稿</a></li>
                                                    <li><a href="https://account.tophant.com/register.html" class="login-btn">注册</a>
                            </li>
                            <li><a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a></li>
                                            </ul>
                </div>
            </div>
            <div class="dropdown-menu read-menu" id="read-menu">
                <div class="container">
                    <ul class="menu clearfix">
                        <li>
                            <strong>黑客</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                <a href="http://www.freebuf.com/articles/es" target="_blank">企业安全</a>
                                <a class="last" href="http://www.freebuf.com/ics-articles" target="_blank">工控安全</a>
                            </div>
                        </li>
                        <li>
                            <strong>极客</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                <a class="last" href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                            </div>
                        </li>
                        <li>
                            <strong>特色</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/news/special" target="_blank">头条</a>
                                <a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a>
                                <a href="http://www.freebuf.com/fevents" target="_blank">活动</a>
                                <a href="http://www.freebuf.com/video" target="_blank">视频</a>
                                <a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a>
                                <a href="http://www.freebuf.com/jobs" target="_blank">招聘</a>
                                <a class="last" href="http://www.freebuf.com/paper/" target="_blank">报告</a>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="dropdown-menu company-menu" id="company-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="https://www.vulbox.com/bounties/item-9-0-1" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-src.png"></span>
                                <span class="name">企业SRC</span>
                                <span class="intro">全/半托管式互联网漏洞收集管理</span>
                            </a>
                        </li>
                        <li>
                            <a href="http://company.freebuf.com" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-company.png"></span>
                                <span class="name">企业空间</span>
                                <span class="intro">为企业定制信息安全专属门户</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.vulbox.com/" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-safety.png"></span>
                                <span class="name">安全测试</span>
                                <span class="intro">国内领先的互联网安全众测服务</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="https://www.riskivy.com/" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-risk.png"></span>
                                <span class="name">风险感知</span>
                                <span class="intro">基于IT资产的自动化安全监控</span>
                            </a>
                        </li>

                    </ul>
                </div>
            </div>
            <div class="dropdown-menu user-menu" id="user-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="http://www.freebuf.com/newsend" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-write.png"></span>
                                <span class="name">有奖投稿</span>
                                <span class="intro">与整个行业分享你的经验与见解</span>
                            </a>
                        </li>
                        <li>
                            <a href="http://zhuanlan.freebuf.com" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-column.png"></span>
                                <span class="name">申请专栏</span>
                                <span class="intro">自由创作，打造自主内容品牌</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.vulbox.com/bounties/detail-72" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-leak.png"></span>
                                <span class="name">提交漏洞</span>
                                <span class="intro">与数万白帽一起，让互联网更安全</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="https://www.vulbox.com/bounties" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-test.png"></span>
                                <span class="name">参与众测</span>
                                <span class="intro">挖洞开启自由职业之路</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="dropdown-menu wenku-menu" id="wenku-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="http://www.freebuf.com/wenku" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-write.png"></span>
                                <span class="name">文库</span>
                                <span class="intro">最全的FB百科</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="http://www.freebuf.com/special-subject" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-test.png"></span>
                                <span class="name">专题</span>
                                <span class="intro">浓缩的安全精华汇总</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!----------header end---------->
<!--<script type="application/javascript">
    var  _value_tab = '';
    $(function(){
        var _that = '', _show_flag = 0;
        $('.header .header-container .nav .nav-child > li:not(input[data-value])').mouseover(function() {
            $('.header .dropdown-menu').stop().slideUp(50);
        });
        $('.header').mouseout(function() {
            $('.header .dropdown-menu').stop().slideUp(50);
        });
        /*$('.header .header-container .nav .nav-child > li').mouseover(function() {
         _value_tab = $(this).attr('data-value');
         $('#'+_value_tab).siblings('.dropdown-menu').stop().slideUp(50);
         $('#'+_value_tab).stop().slideDown(100);
         });*/
        $(".header .header-container .nav .nav-child > li").hoverDelay({
            hoverDuring: 500,
            hoverEvent: function(){
                $('#'+_value_tab).siblings('.dropdown-menu').stop().slideUp(50);
                $('#'+_value_tab).stop().slideDown(100);
            }
        });
        $('.header .dropdown-menu').mouseover(function() {
            _value_tab = $(this).attr('id');
            _that = this;
            $('.nav-child li[data-value="'+_value_tab+'"]').addClass('hover');
            $(this).stop().slideDown(50);
        }).mouseout(function() {
            $('.nav-child li[data-value="'+_value_tab+'"]').removeClass('hover');
            $(_that).stop().slideUp(50);
        });

        $(".nav-small .nav-child > li").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();

            if($(this).find('.nav-child2').is(":hidden")) {
                _show_flag = 1;
                $(this).find('.nav-child2').slideDown();
                $(this).find('.icon-arrow').addClass('bottom');
            }else {
                _show_flag = 0;
                $(this).find('.nav-child2').slideUp();
                $(this).find('.icon-arrow').removeClass('bottom');
            }
            $(this).siblings().find('.nav-child2').slideUp();
            $(this).siblings().find('.icon-arrow').removeClass('bottom');
        });
        //头部投稿按钮hover状态展开菜单
        $(".btn-publish-child > ul > li").hover(function(){
            $(this).addClass("active");
            $(this).siblings().removeClass("active");
        });

        $(document).click(function(event){
            var ev = ev || event;
            $(".login-after").find(".login-after-child").hide();
        });
        //点击用户信息，出现下拉菜单
        $("#user-info").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();
            $(".login-after").find(".login-after-child").toggle();
        });
        //顶部导航
        $(".nav-small").click(function(){
            $(this).find(".nav-child").slideToggle();
        });
        var that = '';
        $('.header .header-container .nav .nav-child > li').mouseover(function() {
            that = this;
            $(this).find('.dropdown-menu').stop().slideDown(200);
        }).mouseout(function() {
            $(that).find('.dropdown-menu').stop().slideUp(200);
        });
    });
    $(".nav-small .nav-child > li").click(function(event){
        var ev = ev || event;
        ev.stopPropagation();
        $(this).siblings('li').find('.dropdown-menu').hide();
        $(this).find(".dropdown-menu").toggle();
    });
    //鼠标经过(hover)事件的延时处理
    (function($){
        $.fn.hoverDelay = function(options){
            var defaults = {
                hoverDuring: 100,
                outDuring: 100,
                hoverEvent: function(){
                    $.noop();
                },
                outEvent: function(){
                    $.noop();
                }
            };
            var sets = $.extend(defaults,options || {});
            var hoverTimer, outTimer;
            return $(this).each(function(){
                $(this).hover(function(){
                    _value_tab = $(this).attr('data-value');
                    clearTimeout(outTimer);
                    hoverTimer = setTimeout(sets.hoverEvent, sets.hoverDuring);
                },function(){
                    clearTimeout(hoverTimer);
                    outTimer = setTimeout(sets.outEvent, sets.outDuring);
                });
            });
        }
    })(jQuery);
</script>-->
<script type="text/javascript" src="http://static.3001.net/js/header/header.js"></script><script>
    jQuery(window).load(function(){
      if(jQuery(window).width()>480){
        jQuery(".main-header").sticky({ topSpacing: 0 });
      }else{
        jQuery(".main-header nav").removeClass("navbar-fixed-top");
      }
      jQuery("#mar-right").sticky({ topSpacing: 105,bottomSpacing: 410 });
    });
</script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/layer.js"></script>
<script type="text/javascript" src="http://static.3001.net/js/pretty/prettify.js"></script>
<script type="text/javascript" src="http://static.3001.net/js/header/lazyload.js"></script>
<script type="text/javascript" charset="utf-8">
      jQuery(function() {
          jQuery("img").lazyload({
              effect : "fadeIn"
          });
      });
 </script>
<script type="text/javascript">
    window.onload = function(){
        prettyPrint();
    }
</script>
<script language="JavaScript" type="text/javascript">
//<![CDATA[
var va = "您已经点亮过了";
function acv_vote(id,option, m){
  if( m==null) m =''; m = m + '';
  jQuery('#acv_stat_'+m+id).html('Loading...');
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option="+option+"&ID="+id;
  jQuery.get(url,function(d){
    d =d.split('|');var s='#acv_stat_'+m+d[0];
    var sele = '#cos_support-'+m+id,unsele = '#cos_unsupport-'+m+id,tpjs = 'javascript:alert(va)';
    jQuery( s ).html( d[1] );jQuery(s).fadeOut(400,function(){jQuery(s).fadeIn();});
    if( d[2] == 1 ){ jQuery(sele).html(jQuery(sele).html()*1+1); }
    if( d[2] == -1 ){ jQuery(unsele).html(jQuery(unsele).html()*1+1); }
    jQuery('#vote4-'+id).attr('href',tpjs);jQuery('#vote4-2'+id).attr('href',tpjs);
    jQuery('#votea-'+id).attr('href',tpjs);jQuery('#votea-2'+id).attr('href',tpjs);
  });
}
  
$(document).on("mouseenter",".comment-tools",function(){
  $(this).find(".btn-report").show();
  $(this).find(".btn-report").addClass("hover");
}).on("mouseleave",".comment-tools",function(){
  var $_this = $(this);
  $(this).find(".btn-report").removeClass("hover");
  if(!$(this).find(".dropup").hasClass('open')){
    $(this).find(".btn-report").hide(); 
    $_this.find(".dropdown-menu").css("display","none");
  }else{
    setTimeout(function(){
      if(!$_this.find(".btn-report").hasClass("hover")){
        $_this.find(".dropup").removeClass("open");
        $_this.find(".dropdown-menu").css("display","none");
        $_this.find(".btn-report").hide(); 
      }
    },"500");
  }
})

$(document).on("click",".click_report",function(){
  $(this).parent().parent().css("display","none");
  var id = $(this).attr("data-id");
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option=0&ID="+id;
  $_this = $(this);
  jQuery.get(url,function(d){
    d =d.split('|');
    if(d[1]=='您已经点过灯了'){
      d[1] = '您已经举报过了';
    }
    if(d[1]=='Thank you'){
      d[1] = '举报成功';
    }
    $_this.parent().parent().parent().find(".btn-report").text(d[1]);
    $_this.parent().parent().parent().find(".btn-report").css("display","block");
  })
})

$(document).on("click",".btn-report",function(){
  if($(this).parent().hasClass('open')){
    $(this).parent().find(".dropdown-menu").css("display","block");
  }else{
    $(this).parent().find(".dropdown-menu").css("display","none");
  }
})
//]]>
</script>
<div class="column-article" data-column="">
            <div class="container pad-top35">
        <div class="row clearfix">
            <div class="col-md-9" id="getWidth">
                                    <div class="reletive search-xs-wrap">
                    <div class="form-group has-active search-col search-xs">
                        <form id="hpsform-new" class="navbar-search navbar-form" onsubmit="return dispatch()">
                            <div class="form-group">
                                <input id="q" class="input form-control" type="text" placeholder="关键字查找" autocomplete="off" title="关键字查找" name="q">
                                <button class="submit" type="submit"></button>
                            </div>
                        </form>
                    </div>
                </div>
                    <script type="text/javascript">
                        var dispatch = function () {
                            console.log(123)
                            var q = document.getElementById("q");
                            if (q.value == "") {
                                q = document.getElementById("bigq");
                            }
                            if (q.value != "") {
                                window.open('http://www.freebuf.com/?s=' + q.value, "_blank");
                                return false;
                            } else {
                                return false;
                            }
                        }
                    </script>
                                <div class="article-wrap panel panel-default">
                                                            <div class="articlecontent">
                                                    <div class="title">
                                <h2>
                                    代码战争：伪装和狙杀，从“壳”到“病毒混淆器”                                </h2>
                                <div class="property">
                                                                            <span class="name"><a href="http://www.freebuf.com/author/%e7%81%ab%e7%bb%92%e5%ae%89%e5%85%a8" title="由 火绒安全 发布" rel="author">火绒安全</a></span>
                                                                        <span class="icon-f"><a href="http://www.freebuf.com/bufer" target="_blank"><img src="http://image.3001.net/images/index/f2.png" title="认证厂商"></a></span>
                                    <span class="time">2016-08-30</span>
                                                                                                            <span class="look">共<strong>214275</strong>人围观
                                        ，发现 <strong>13</strong> 个不明物体 </span>                                      </span>
                                                                <span class="tags">
                                      <a href="http://www.freebuf.com/./articles/system">系统安全</a></span>
                                    <span class="tags_01"></span>
                                </div>
                            </div>
                                                                                                <div id="contenttxt">
                            <h2>一、前言</h2>
<p><b style="color: rgb(0, 176, 80);">“壳”（Packer）——在安全领域同APT一样，是一个宽泛的概念，即指代一类对可执行代码及数据进行包装已达到隐藏、压缩或保护等目的的运行时代码。</b></p>
<blockquote><p>在病毒与安全软件的代码对抗过程中，“壳”一直扮演着极为重要的角色。早期反病毒引擎仅能够扫描可执行文件最外层的特征（代码和数据）。“加壳”后的病毒由于原始病毒特征（代码和数据）被“壳”改变（压缩、加密等），则可以躲避反病毒引擎的查杀。随着这种对抗的不断发展，虽然很多病毒的核心特征变化并不大，但是“壳”的“免杀”能力在不断增强，不断地更新换代，长时间与安全软件进行着对抗。所以，在现今互联网大环境中，如果一个反病毒引擎不具备强大的“脱壳”能力，就不能对病毒进行有效查杀，最终落后于整个安全行业的发展。</p>
</blockquote>
<p>早期的“壳”通常以压缩目标程序为目的，如UPX、PECompact等经典的“压缩壳”等。随着软件知识产权意识的萌发，以保护程序代码及数据为目的的“壳”应运而生，此类“加密壳”、“保护壳”往往会利用花指令、反调试等手段干扰破解者对被保护代码和数据的“窥探”（包括静态和动态分析），Asprotect、VMProtect、Themida便是其中一些经典的“保护壳”。</p>
<p>上述“压缩壳”、“加密壳”和“保护壳”由于加壳程序公开（免费或收费），所以安全工程师可以对”加壳“的过程和结果进行分析，从而可以通过代码识别程序是否被“加壳”、加了何种“壳”，进而“脱壳”，并可以将这种“脱壳”逻辑嵌入到反病毒引擎的扫描逻辑中，从而在一定程度上“解决”了“壳”的对抗。</p>
<p>然而近10年来，很多病毒作者通过“壳”和感染型病毒常用的多态、变形等技术编写非公开的“私有壳”对病毒代码进行保护，这类“壳”往往不仅包括上述公开“保护壳”的功能，并且外层的“壳”代码还会通过各种手段干扰、误导、对抗反病毒引擎的识别，比较典型的手段包括代码变形、入口伪装、高级语言包裹（High-Level Language Wrapper）等。安全领域为此类“壳”起了个更为“高大上”的名字：“病毒混淆器”（Obfuscator）。安全领域较早的关于“病毒混淆器”的详细分析可以参考2010年RECon大会上Pierre-Marc Bureau（来自ESET）和Joan Calvet对于C2Lop病毒外层的Swizzor混淆器的分析（<u><a href="https://recon.cx/2010/slides/Recon2010-UnderStaningSwizzorObfuscation.pdf">https://recon.cx/2010/slides/Recon2010-UnderStaningSwizzorObfuscation.pdf</a></u>）。</p>
<p>“病毒混淆器”的出现使得传统反病毒引擎“认壳”才能“脱壳”的机制完全失效。更有意思的是，在很长一段时间，很多安全厂商由于一直以来依赖对“壳”和编译器的识别，完全没有意识到“病毒混淆器”的崛起，甚至根据“大数据”的分析发现“加壳”样本的比例不升反降，思忖一定是“现在反病毒引擎都能‘脱壳’，所以病毒作者也就不再‘加壳’了”。就像曾有人对笔者说的，“‘壳’的问题是个轮回的过程，从2008年以后壳就变得很少了”。然而，根据我们对大量病毒样本的分析，我们坚定的认为“壳”的问题并不是轮回，传统的“壳”早已被“病毒混淆器”这个更为复杂的概念意义上的“后代”所取代，并持续的进化着。</p>
<p>病毒制造者在“病毒混淆器”的帮助下，可以在短时间内批量生成大量“伪装”（变形）过的病毒样本并迅速传播。为了应对不断变化的病毒样本，云引擎和大数据人工智能学习的方法逐渐走进了人们的视野。但长期看来，上述两种对抗策略从根本上存在着不可逾越的瓶颈和数据资源的限制。而“通用脱壳”技术相较于前两者，虽需要长期的技术投入，但却可以获得更为持久、有效的查杀回报，无疑将成为未来解决“病毒混淆器”类问题的优选方案。</p>
<p>下面我们针对这三种技术进行详细说明：</p>
<h3>1.云查杀和云引擎</h3>
<p>如今很多安全厂商的“云引擎”，主要是希望通过缩短反病毒引擎特征更新周期来与病毒作者拼速度，从而达到快速抑制病毒扩散的效果。当然，这显然不是“云安全”的本质，但由于篇幅所限，本文并不对“云安全”这一话题进行讨论。</p>
<p>“云引擎”虽然可以实时同步云端的计算结果，但由于网络带宽的限制，在有限的扫描时间内，云引擎只能在本地提取高度抽象的数据特征发送到云端进行匹配，所以一般云引擎会选择哈希类特征（通常是全文哈希）。而哈希类特征的检出能力与样本基本是1：1的关系，即一条哈希特征通常只能检出一个样本。</p>
<p>由于“云引擎”采用哈希类特征，所以每个“伪装”过的病毒样本对于云引擎来说都是全新的，都需要进行“鉴定”。我们并不需要进行精确的计算，就可以得出如下结论：“云引擎”从采集到样本并传到云端分析，到云端分析出结果，再到客户端能够请求到结果，这个周期远远长于病毒作者通过“病毒混淆器”批量生成变形病毒样本的周期。</p>
<p>虽然“云引擎”能够缩短反病毒引擎特征更新周期、提高安全产品的反应速度，但是对于“病毒混淆器”批量生成的变形病毒，起到的作用只不过是“掩耳盗铃”罢了。</p>
<h3>2.利用大数据和“人工智能“，猜测病毒的“伪装“</h3>
<p>近些年，国内一些安全软件发布了各自的基于大数据或“人工智能”的反病毒引擎。这些引擎本质上都是基于统计学算法，通过对海量样本以固定方法抽取特征，并对特征进行统计、分析，进而产生计算模型。依照计算模型对待扫描样本进行分类，进而预测新样本是否属于恶意分类。</p>
<p>在没有数据为依托的前提下，我不能对此类引擎的效果妄加揣测。但无论算法如何、样本如何选取，都逃不过一个重要条件，那就是对特征的抽取。我们不妨做如下假设：我们通过外貌、服饰、声音、举止等方面可以基本准确地判断一个人的性别，这就像扫描明文的恶意代码。如果将人关进房间，只有房间的颜色、外观等特征可见，而人本身相关的特征完全看不到，这就像是被混淆过的恶意代码。将大量的人随机安排进不同颜色，不同外观的房间，试问仅通过房间的颜色和外观，通过统计、分析，产生计算模型，并推测某一房间内人的性别是否可靠？我想答案是否定的。</p>
<p>无论是统计学或是人工智能算法，算法本身并没有任何问题，但如果不能戳穿病毒的“伪装”，不能抽取到有效的特征，一切都只会是徒劳。如果仅抽取样本的外层特征，“病毒混淆器”作者可以很轻易“伪装”出正常的程序结构、代码特征以及数据特征来躲过统计模型的预测，甚至可以”误导”并“污染”统计模型从而使此类反病毒引擎导致严重的误报。</p>
<h3>3.通过“通用脱壳”戳穿病毒的“伪装”</h3>
<p>“通用脱壳”（Generic Unpacking）就是最典型的用于戳穿病毒“伪装”的技术。简单来说，“通用脱壳”就是不对程序进行精确的“壳识别”，而是通过某些启发式逻辑评估待扫描是否可能被“加壳”（或者完全不评估是否可能“加壳”），并在虚拟沙盒中运行待扫描样本，使其在虚拟环境中还原被保护的代码、数据、行为，从而进行查毒。关于虚拟沙盒相关介绍可以参考《动若脱兔——火绒虚拟沙盒简介》一文相关章节，此处不再赘述。后文中，如无特别说明，“虚拟机”均指代虚拟沙盒。</p>
<p>“通用脱壳”技术对于处理“病毒混淆器”显然具有极大的帮助，如果反病毒引擎构造的虚拟环境足够逼真、虚拟沙盒的执行效率足够高，那么对于批量产生的变形病毒样本，反病毒引擎仅需要捕获其中部分样本则可以查杀后续的全部变种。纵观国内外也只有部分反病毒引擎在不同程度上实现了“通用脱壳“技术，国外包括MSE、ESET、Kaspersky、BitDefender、VIPRE在内的多款反病毒引擎，很早就引入了“通用脱壳”技术，并且多年来从未停止过对这方面的技术投入。火绒也在2013年实现了“通用脱壳”技术，并至今仍然持续保持着火绒虚拟沙盒的高速更新。关于“通用脱壳”相关介绍可以参考《反病毒”芯“技术——火绒反病毒引擎简介》一文相关章节，此处不再赘述。</p>
<p>在对大量样本的分析基础上，我们将“病毒混淆器”的大致进化过程进行了简单梳理，如下表所示。后续，本文将以”病毒混淆器“的“进化”过程为主轴，回溯“病毒混淆器”与反病毒引擎的对抗过程。后文中，如无特殊说明，“混淆器”均指代“病毒混淆器”。</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719247359775.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="表1.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719247359775.png!small" alt="表1.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">表1、混淆器进化过程总表</b></p>
<h2>二、经典案例</h2>
<h3>1.指令级混淆器——Conficker</h3>
<p>Conficker的出现时间在2008年，作为最早使用混淆器的病毒家族之一，其对于整个病毒的“黑色产业链”发展有着里程碑式的意义。MS08-067这个漏洞利用门槛低、成功率高是这个病毒能够快速流行的主要原因，但能使该病毒能够长期处于“免杀”状态显然归功于其使用的变形混淆器。在该病毒流行的早期，国内外安全厂商在没有“通用脱壳”技术的状态下，只能采用批量入库的方式处理，从而很难有效通杀整个病毒家族。在Conficker“一战成名”之后，使用混淆器的病毒样本开始逐渐增多，“病毒混淆器”的“进化”也就此展开。</p>
<p><b>1.1病毒行为</b></p>
<p>该病毒会尝试创建许多用于其进行病毒传播的网络连接，并禁用系统安全设置、阻止本地安全软件的正常升级。其主要传播途径为：U盘、网络共享、弱口令密码的共享计算机等。当病毒在一个局域网内部大范围传播后，会造成严重的网络阻塞。</p>
<p>通过火绒行为沙盒我们可以看到一些主要的病毒行为：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719247937709.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T1.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719247937709.png!small" alt="T1.png"></p></noscript>
<p style="text-align: center;"><span style="color: rgb(159, 163, 168);"><b>图1、火绒行为沙盒运行效果图</b></span></p>
<p><b>1.2混淆器结构</b></p>
<p>Conficker家族的样本结构极为统一。最外层为混淆器，其主要功能为解密原有数据、对抗虚拟沙盒和反调试。经过混淆器的数据解密后，再向内一层是经过UPX压缩的Conficker病毒主体。如下图所示：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719248032805.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T2.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719248032805.png!small" alt="T2.png"></p></noscript>
<p style="text-align: center;"><span style="color: rgb(159, 163, 168);"><b>图2、Conficker病毒整体结构</b></span></p>
<p>虽然混淆器的逻辑并不十分复杂，但是其主要逻辑代码被切分成了很多小的逻辑块，随机打乱顺序后分布在整个混淆器代码中，逻辑块与逻辑块之间用jmp指令进行连接，jmp指令的跳转位置全部被存放在混淆器的跳转表中。</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719248419774.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T3.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719248419774.png!small" alt="T3.png"></p></noscript>
<p style="text-align: center;"><span style="color: rgb(159, 163, 168);"><b>图3、混淆器跳转表示意图</b></span></p>
<p>其混淆器的解密过程并不复杂，本样本解密流程如下（dest代表目标字节，index为当前解密位置，shl_count为可变参数，decrypt_data为加密数据）：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719248513517.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T4.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719248513517.png!small" alt="T4.png"></p></noscript>
<p style="text-align: center;"><span style="color: rgb(159, 163, 168);"><b>图4、混淆器解密流程</b></span></p>
<p>通过对Conficker所使用的混淆器的分析，我们发现最初的混淆器只是通过对外层特征的混淆达到其与安全软件对抗的目的，对抗主要还停留在指令级。基于“通用脱壳”的反病毒引擎还是可以很从容地处理。</p>
<p>混淆代码运行结束后，我们可以看到内层的UPX相关代码。如下图所示：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719248778917.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T5.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719248778917.png!small" alt="T5.png"></p></noscript>
<p style="text-align: center;"><span style="color: rgb(159, 163, 168);"><b>图5、内层UPX相关代码示意图</b></span></p>
<p><b>1.3对抗手段</b></p>
<p>该混淆器由于出现时间比较早，采用的反调试、反虚拟机的手段还比较原始，利用rdtsc执行检测两次系统时间戳的间隔是否过长，如果间隔时间过长，则判定是在进行调试，从而结束病毒进程。此处逻辑也都是使用jmp指令进行连接，通过简单的反混淆之后我们可以清楚地看到其反调试、反虚拟机的具体逻辑。如下图所示：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719248886678.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T6.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719248886678.png!small" alt="T6.png"></p></noscript>
<p style="text-align: center;"><span style="color: rgb(159, 163, 168);"><b>图6、混淆器反调试相关代码</b></span></p>
<h3>2.虚拟环境对抗型混淆器—Ogimant</h3>
<p>Ogimant是一个国外的著名“下载器”病毒家族，主要流行时间在2014前后，其所使用的混淆器在混淆能力上较Conficker家族已经有了“长足的进步”。随着”通用脱壳“技术的成熟，混淆器为了加强自己的“免杀能力”已经逐渐的开始使用一些简单的针对虚拟沙盒的对抗和检测技巧，其对抗和检测逻辑会根据不同样本而稍有不同。</p>
<p><b>2.1病毒行为</b></p>
<p>通过火绒行为沙盒，我们可以看到一些主要的病毒行为：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719248986954.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T7.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719248986954.png!small" alt="T7.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图7、Ogimant病毒的主要病毒行为</b></p>
<p><b>2.2混淆器结构</b></p>
<p>该混淆器的总体结构比较简单，最外层是病毒混淆器，在混淆器运行完成后，原程序主映像区中就会解密出病毒本体。虽然总体结构比较简单，但其解密过程则稍微复杂一些。</p>
<p>首先，混淆器会在内存中将负责解密原始病毒PE文件的解密代码在堆区中进行解密并执行。</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/1471924908738.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T8.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/1471924908738.png!small" alt="T8.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图8、解密代码</b></p>
<p>解密出解密代码之后，再由该解密代码利用8个字节的解密密钥对整个加密的病毒PE文件进行全文解密。解密代码如下图：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719303564612.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T9.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719303564612.png!small" alt="T9.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图9、Ogimant病毒原始PE文件解密代码</b></p>
<p>然后，在原进程的主映像区中将病毒的PE文件进行内存映射，将映射后的病毒数据以逐字节异或的方式备份起来，使用NtUnmapViewOfSection函数将原进程的主映像区内存释放，之后用备份数据将映射后的病毒数据重新在主映像区复原。由于加密与解密代码相似，我们只列出了加密代码，代码如下：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719303709967.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T10.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719303709967.png!small" alt="T10.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图10、加密映射后的病毒PE文件代码</b></p>
<p>在完成了病毒文件的内存映射后，最后混淆器帮助病毒修复导入表后从病毒的映像入口点开始运行，混淆器的所有逻辑运行完毕。</p>
<p><b>2.3对抗手段</b></p>
<p>相较于早期的混淆器，该混淆器使用了一些与虚拟沙盒对抗的技巧，如循环执行没有实际意义的代码试图使反病毒引擎的“通用脱壳“流程超时、检测API返回值、检测调用API出错后的LastError等，下面我们逐一举例。</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719303795767.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T11.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719303795767.png!small" alt="T11.png"></p></noscript>
<p style="text-align: center;"><span style="color: rgb(159, 163, 168);"><b>图11、混淆器拖慢虚拟机代码</b></span></p>
<p>通过上图我们看到，该混淆器大量调用VirtualAlloc函数申请内存，并填入垃圾数据再逐一释放。这样的混淆手段很大程度上的消耗了扫描效率，如果虚拟沙盒一味的按照其逻辑进行执行，最终都会因为超时而很难对其进行查杀。</p>
<p>相较于拖慢虚拟机而言，检测API LastError的检测手法则更加直接。在真实操作系统中setsockopt调用时五个参数如果全部为0时，LastError的值应该为0x276d，如果虚拟沙盒中环境不够真实，那么程序将无法为解密代码分配内存空间，从而造成异常。如下图所示：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719303877938.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T12.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719303877938.png!small" alt="T12.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图12、混淆器检测API LastError代码</b></p>
<p>在其解密代码中，我们依然可以看到与虚拟沙盒对抗的相关代码。如下图，其代码中调用了Winscard.dll动态库中的SCardIntroduceCardTypeA函数，并检测器返回的错误号。与上文说到的检测函数LastError相近，其目的都是为了检测当前运行环境是否真实。</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719303963702.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T13.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719303963702.png!small" alt="T13.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图13、混淆器检测函数返回值代码</b></p>
<p>该混淆器还使用了GetTickCount函数来进行反调试，在Conficker使用的混淆器中我们已经介绍过类似手法，这里不再进行过多赘述。</p>
<p>在该混淆器中，相对于上述几种反虚拟机的手段之外，我们还发现其使用CreateProcessW函数开启新的自身进程并添加了命令行参数，新进程会通过检验命令行参数的方法判断是否执行后续逻辑代码。我们以此可以看到，混淆器的发展从单一、简单的检测方法，逐渐向系统化检测运行环境的方向进行发展。</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719304037035.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T14.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719304037035.png!small" alt="T14.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图14、利用进程命令参数对抗虚拟沙盒行为效果图</b></p>
<p>在我们所发现的混淆器中，经常会发现混淆器检测一些比较不常见的API，由于这些函数本身不容易被一般程序使用，所以在虚拟沙盒中通常也不会对其进行实现，这样就给了这些混淆器一个可乘之机。虽然这些的“稀奇古怪”的 API有一定的数量，但是API的数量也毕竟是有限的，经过我们对虚拟沙盒环境的不断进行完善，此类问题就都将会迎刃而解。</p>
<h3>3.虚拟环境对抗型混淆器——FakeAV</h3>
<p>FakeAV的出现时间在2007年前后，该病毒主要以虚假病毒威胁进行欺骗，让用户相信当前系统已被病毒感染或存在严重问题需要付费进行修复，骗取用户钱财。在利益的驱使下，病毒制造者在保持病毒核心不变的情况下，不停地迭代混淆器来”免杀”，随之而来的变是更加“花样百出 ”的反虚拟机对抗手段。</p>
<p><b>3.1病毒行为</b></p>
<p>本报告中所述样本有一定的反虚拟机能力，经过简单的对抗后，我们可以看到该病毒的运行界面。在当前环境无任何安全威胁的情况下，谎报出若干各式各样的病毒，并提示用户付费购买其所为的“安全软件”。</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719304206856.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T15.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719304206856.png!small" alt="T15.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图15、FakeAV病毒运行界面</b></p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719304257604.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T16.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719304257604.png!small" alt="T16.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图16、FakeAV虚假报毒弹窗</b></p>
<p>通过火绒行为沙盒我们也可以看到该样本运行的一些细节，如下图所示：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719304345114.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T17.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719304345114.png!small" alt="T17.png"></p></noscript>
<p style="text-align: center;"><span style="color: rgb(159, 163, 168);"><b>图17、火绒行为沙盒运行效果图</b></span></p>
<p>FakeAV在火绒虚拟沙盒中运行后的内存特征如下：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/1471930449549.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T18.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/1471930449549.png!small" alt="T18.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图18、FakeAV在火绒虚拟沙盒中运行后的内存特征</b></p>
<p><b>3.2混淆器结构</b></p>
<p>该混淆器先进行了反虚拟机的相关操作。在通过检测后，其会在堆区解密出用于还原原本病毒PE文件的一段解密代码。因为其解密代码中穿插有大量花指令，在对其代码进行过反混淆之后，我们得到了如下解密逻辑：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/1471930463102.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T19.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/1471930463102.png!small" alt="T19.png"></p></noscript>
<p style="text-align: center;">图19、解密代码示意图</p>
<p>最终负责解密病毒文件的代码分为两个部分。第一部分主要用于获取后面逻辑所用的API地址，并简单检测了ReadFile函数的入口点数据。检测函数入口点是一种对抗虚拟沙盒的手段，我们初步猜测，混淆器作者发现某家安全软件的虚拟沙盒中，其仿真的ReadFile函数入口为0x8B（很多Windows API入口都是8BFF:mov edi,edi）。在上述逻辑运行之后，再将解密代码释放到另外一块堆区中，对其的第二部分进行执行。</p>
<p>解密代码的第一部分具体逻辑如下图所示：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719304812803.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T20.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719304812803.png!small" alt="T20.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图20、解密代码第一部分逻辑示意图</b></p>
<p>该解密代码的第二部分主要负责病毒PE文件的还原与加载。首先其从自身PE文件中读取被加密的病毒PE 文件，之后进行解密。经过PE文件映射、修复导入表、检测是否需要修复重定位表之后，开始执行病毒逻辑代码。</p>
<p>其主要流程如下：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719304905885.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T21.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719304905885.png!small" alt="T21.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图21、病毒PE文件解密相关代码</b></p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719305931942.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T22.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719305931942.png!small" alt="T22.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图22、恢复及加载病毒PE结构代码</b></p>
<p><b>3.3对抗手段</b></p>
<p>对于FakeAV所使用的混淆器来说，其使用了更加“疯狂”的反虚拟机手法。在混淆器运行之初，调用了若干的API来检测当前环境是否为真实环境。与之前的Ogimant混淆器中所使用的混淆方法相比，FakeAV混淆器所调用的系统API检测效果更加系统化，如：FindResourceA，需要对当前进程中的所有资源进行解析；SetCurrentDirectoryA，需要在虚拟沙盒中也模拟一个完整的文件系统。</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719306055758.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T23.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719306055758.png!small" alt="T23.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图23、FakeAV调用API检测运行环境效果图</b></p>
<p>除了上述这些监测点外，我们还发现了一些十分有意思的检测方法。该混淆器先调用GetCursorPos函数得到两次当前鼠标位置（其间会调用GetEnvironmentVariableA检测环境变量真实性），之后不断地调用 GetCursorPos函数，直到所得鼠标位置的x坐标与第一次不同的时候，才会执行后续逻辑。经过简单的反混淆处理之后，我们可以看到其基本的对抗虚拟沙盒的逻辑，如下图所示：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719306182094.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T24.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719306182094.png!small" alt="T24.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图24、FakeAV通过检测鼠标位置反虚拟机代码示意</b></p>
<p>随着混淆器技术的不断发展，混淆器检测虚拟沙盒的手段也不断更新换代。其所使用的检测方法要求虚拟沙盒中的运行环境与真实机中更加接近，这使得我们对于虚拟沙盒仿真的复杂程度也逐渐提升。虽然如此，但是对于虚拟沙盒的提升是对整个引擎综合能力的提升，一个良好仿真环境就如同庖丁手中的利刃，可以帮助我们剖开其表象，直达其本质。</p>
<h3>4.虚拟环境对抗型混淆器——Upatre</h3>
<p>Upatre是2013年左右开始流行的“下载器”病毒家族，该家族主要通过将自己伪装成Email附件的形式进行传播，并附以发票、传票等欺骗性的文件名诱骗用户下载、运行，该病毒通常会将自己的图标设置为PDF图标。由于其所使用的混淆器十分复杂多变，所以如果不借助“通用脱壳”技术，仅仅使用静态特征对其进行查杀是十分困难的。这使得该家族在短时间之内大范围传播，甚至成为了很多勒索病毒的主要传播渠道，如：CryptoLocker。</p>
<p>混淆器整体结构与之前的混淆器相近，在此不再赘述。下面我们针对Upatre的病毒行为及其所使用的混淆器的反虚拟机的手段进行详细说明。</p>
<p><b>4.1病毒行为</b></p>
<p>其主要病毒行为比较简单，只是联网下载文件。如下图所示：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719306263582.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T25.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719306263582.png!small" alt="T25.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图25、行为沙盒运行效果图</b></p>
<p><b>4.2对抗手段</b></p>
<p>其混淆器使用的反虚拟机手段十分复杂，其主要使用了一些Windows图形控件的回调函数进行运行环境监测，如RichEdit、ListBox等。在本样本中其使用的是RichEdit，首先其利用SendMessage向RichEdit发送EM_SETBKGNDCOLOR消息将解密代码地址相对某区域的相对偏移设置改控件的背景颜色（由于在设置新的背景颜色时SendMessage函数会返回原来的背景色，所以在该混淆器中将其当作一个隐藏的数据存储空间），然后在其再次向该RichEdit发送消息时，获取其之前设置的数值。这一检测手段大大提高的虚拟沙盒的仿真难度，首先要对图形窗口的生命周期流程、消息的获取、派发等一系列窗口运行流程进行全面的仿真，其次还要对RichEdit、ListView等一系列控件进行仿真。</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719306375470.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T26.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719306375470.png!small" alt="T26.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图26、混淆器利用RichEdit检测虚拟沙盒代码展示</b></p>
<p>从行为中我们也可以观察出其反虚拟机的基本逻辑：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719306472605.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T27.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719306472605.png!small" alt="T27.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图27、混淆器利用RichEdit检测虚拟沙盒效果图</b></p>
<p>早期混淆器的检测手法多为单一检测点的检测，比如注册表项、文件、API返回结果等，虽然在反虚拟机上确实在很短的一段时间内存在一定的效果，但对于虚拟沙盒来说，其依然可以通过添加这些运行环境有效地进行仿真。随着这种简单交锋的次数不断增多，虚拟沙盒的运行环境也越来越接近于真实的操作系统，混淆器制作者想要通过单一方法检测虚拟沙盒所要付出的成本也越来越高，这也促使了其对抗手段的又一次升级。从上述分析中，我们不难看出混淆器对运行环境的检测手法已经从单一检测点完全过渡到了系统化检测的新阶段。在这一层面进行对抗，就要求虚拟沙盒的仿真方面，在对抗初期投入大量的精力对其检测的整个系统框架进行整体仿真。因为只有进行仿真才能抓住病毒本质，从而跳出一味地使用外层特征查杀而被动挨打的局面。</p>
<h3>5.虚拟环境对抗型混淆器——Tescrypt</h3>
<p>Tescrypt是在2014年前后较为流行的勒索病毒，其已经给成千上万的受害者带来巨大的经济损失。其大面积爆发的主要原因也是因为其所使用的病毒混淆器。如本文中所提到的Tescrypt病毒样本，其包含有内外两层混淆逻辑，外层混淆效果较弱，主要用于加密内层数据、躲避静态查杀；内层混淆能力较强，主要用于对抗虚拟沙盒。</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719306552643.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T28.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719306552643.png!small" alt="T28.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图28、Tescrypt样本结构图</b></p>
<p>由此我们推断，随着虚拟沙盒的越来越接近真实操作系统，混淆器在与虚拟沙盒进行对抗所需要付出的精力越来越大，最后混淆器的制作者将混淆工作进行了明确的分工。即外层混淆器使用代码级混淆、更改主要逻辑等方法与静态查杀进行对抗；内层混淆器使用系统化检测运行环境的方法与虚拟沙盒进行对抗。在这种分工模式下，致使多数安全软件很难对其所混淆后的样本进行有效查杀。</p>
<p><b>5.1病毒行为</b></p>
<p>其病毒行为主要以加密本地文件为主，我们通过行为沙盒看到一些主要的行为细节：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719306678107.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T29.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719306678107.png!small" alt="T29.png"></p></noscript>
<p style="text-align: center;"><span style="color: rgb(159, 163, 168);"><b>图29、Tescrypt病毒行为示意图</b></span></p>
<p>Tescrypt病毒在在火绒虚拟沙盒中运行后的内存特征如下：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719306784597.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T30.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719306784597.png!small" alt="T30.png"></p></noscript>
<p style="text-align: center;"><span style="color: rgb(159, 163, 168);"><b>图30、Tescrypt病毒在火绒虚拟沙盒中运行后的内存特征</b></span></p>
<p><b>5.2对抗手段</b></p>
<p>混淆器一路发展而来，混淆手段已经不断“推陈出新”升级了很多次，其主要目的是与虚拟沙盒进行对抗，从而绕过安全软件的查杀。Tescrypt家族作为一个曾大范围传播的勒索病毒家族，其所使用的混淆手段十分巧妙（因为外层混淆器与以往的高级壳类似，所以我们主要围绕其内层混淆器展开讨论）。</p>
<p>其内层混淆器主要使用了COM接口帮助其检测当前运行环境。其先创建了两个COM对象，FilgraphManager对象中可以调用IGraphBuilder接口中的AddFilter方法来添加Filter对象。其先添加了空的对象地址以检测错误，之后以创建出来的Filter对象以随机名调用AddFilter方法再次进行添加。添加之后在通过IGraphBuilder接口中的FindFilterByName方法查找并检测对象信息中名字和Filter对象的地址是否与之前添加的对象信息相匹配。</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719306917393.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T31.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719306917393.png!small" alt="T31.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图31、通过COM接口检测虚拟沙盒代码示意图</b></p>
<p>与之前提到的Upatre家族所使用的混淆器相同，该混淆器也是通过系统化的检测手法对当前运行环境进行检测。根据我们以往所遇到的使用COM接口进行混淆的混淆器来说，此类混淆器多为使用两个COM对象相互配合从而达到检测运行环境的作用。用来进行反虚拟机的COM对象经常变换，Windows所提供的COM接口十分繁杂、多样，这就使得此类混淆器变化多端，从而也致使使用这种混淆器的病毒可以在短时间之内大范围进行传播。</p>
<h3>6.高级语言混淆器</h3>
<p>病毒混淆器除了使用上述方法与虚拟沙盒进行对抗外，还会使用一些高级语言制作病毒混淆器，如Visual C++、Visual Basic、C#等。这不光给病毒分析人员制造了麻烦，也给虚拟沙盒带来了新的难题。</p>
<p><b>6.1Visual C++混淆器——C2Lop</b></p>
<p>C2Lop病毒可以说开创了大规模使用高级语言混淆器的先河，其主要流行时间在2008年前后。在2010年的RECon大会上Pierre-Marc Bureau和Joan Calvet对于C2Lop病毒外层的混淆器（此前该混淆器被业内多家安全软件命名为Swizzor）的分析（<a href="https://recon.cx/2010/slides/Recon2010-UnderStaningSwizzorObfuscation.pdf">https://recon.cx/2010/slides/Recon2010-UnderStaningSwizzorObfuscation.pdf</a>）已十分详细，此处不再赘述分析过程。</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719307093455.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T32.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719307093455.png!small" alt="T32.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图32、Swizzor混淆器 “伪装“的Visual C++入口</b></p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/1471930719774.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T33.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/1471930719774.png!small" alt="T33.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图33、Swizzor混淆器的WinMian函数</b></p>
<p>Swizzor混淆器与以前的加密不同的地方是其解密后的代码及数据全部都在堆区，所以在其运行后在主映像区提取到的数据与C2Lop病毒本体并无直接关系。Swizzor混淆器运行后，我们即可看到内层的C2Lop病毒本体。如下图所示：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719307285648.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T34.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719307285648.png!small" alt="T34.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图34、C2Lop病毒的真正入口</b></p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719307377248.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T35.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719307377248.png!small" alt="T35.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图35、C2Lop病毒WinMain函数</b></p>
<p>在火绒虚拟沙盒运行后，我们可以看到C2Lop病毒的内存特征。如下图所示：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719307483128.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T36.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719307483128.png!small" alt="T36.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图36、C2Lop病毒在火绒虚拟沙盒中运行后的内存特征</b></p>
<p><b>6.2Visual Basic混淆器——Zbot</b></p>
<p>Visual Basic是一种高级语言，其主要特点是程序主要运行在Visual Basic虚拟机中，所以为Visual Basic程序的调试造成了很大的困难。我们可以通过行为沙盒查看其主要病毒行为，如下图所示：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719307617995.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T37.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719307617995.png!small" alt="T37.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图37、使用Visual Basic混淆器的Zbot病毒运行效果图</b></p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719307738487.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T38.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719307738487.png!small" alt="T38.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图38、使用Visual Basic混淆器的Zbot病毒主要行为一览</b></p>
<p>通过上图我们可以看出，虽然此类混淆器使用了高级语言进行混淆，但是因为Visual Basic程序也基于x86指令集，所以只要针对Visual Basic程序中使用的关键函数进行仿真该类程序依然可以在虚拟沙盒中正确运行。</p>
<p><b>6.3.Net混淆器</b></p>
<p>与Visual Basic程序相比，.Net程序的运行需要依托于IL指令和.Net运行时框架，这使得基于x86指令集的虚拟沙盒很难对其进行完整还原。就以我们所遇到的.Net混淆器——mpress进行具体说明。</p>
<p>该混淆器中的大部分代码都是对LZMAT的实现，该混淆器把用LZMAT算法压缩后的病毒数据存放在PE文件的一个指定位置上，通过解压缩将原本病毒文件进行还原。mpress混淆器中的类结构图：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719307874911.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T39.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719307874911.png!small" alt="T39.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图39、mpress混淆器中的类机构图</b></p>
<p>其混淆器的主要逻辑就是使用LZMAT算法将原样本进行还原，并释放到指定目录进行执行。如下图：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719307996941.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T40.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719307996941.png!small" alt="T40.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图40、混淆器解密代码</b></p>
<h3>7.AutoIt混淆器——Zbot</h3>
<p>随着病毒混淆器与安全软件对抗的不断升级，我们发现了一些利用AutoIt脚本程序制作病毒混淆器。通常，这类混淆器用脚本作为病毒程序的加载器，其加载的病毒程序可以任意更替。再加之脚本混淆可以通过变量名替换、常量拆分等简单却十分有效的方法实现，所以即使安全软件在查杀过程中能够获取到脚本文件也很难对这类混淆器进行通杀。Zbot，作为一个在互联网中活跃多年的病毒家族，也曾在2012前后使用过AutoIt脚本所编写的病毒混淆器。在病毒的运行过程中，其不会直接释放出病毒文件，而是直接在内存中进行还原。</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719308075776.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T41.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719308075776.png!small" alt="T41.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图41、混淆器脚本示意图</b></p>
<p><b>7.1病毒行为</b></p>
<p>我们可以直观的看到，使用了AutoIt混淆器的Zbot病毒在火绒行为沙盒中的主要病毒行为。</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719308211733.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T42.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719308211733.png!small" alt="T42.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图42、火绒行为沙盒运行效果图</b></p>
<p><b>7.2混淆器结构</b></p>
<p>通过对该样本的分析，我们对该混淆器的结构有了进一步的了解。Zbot病毒的二进制数据以字符串的形式存放在文件的尾部，数据的字符串之前是混淆器用来定位病毒数据的标记字符串。</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719308324507.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T43.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719308324507.png!small" alt="T43.png"></p></noscript>
<p style="text-align: center;"><span style="color: rgb(159, 163, 168);"><b>图43、AutoIt混淆器结构概览</b></span></p>
<p>我们对图34中所示病毒脚本进行了反混淆之后，得到了原始的脚本代码。</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719308566720.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T44.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719308566720.png!small" alt="T44.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图44、整理后的混淆器脚本</b></p>
<p>如上图所示，混淆器脚本可以通过标记字符串“delimitador”找到Zbot病毒的二进制数据，virus_loader中所存放的就是混淆器用来加载Zbot病毒的汇编代码，之后将上述两段数据进行注册，最后通过AutoIt中的DllCall函数调用WindowsAPI（CallWindowProcW）将两块数据的地址以参数的形式传入，virus_loader为回调函数。</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719308735384.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T45.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719308735384.png!small" alt="T45.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图45、混淆器回调函数调用示意</b></p>
<p>如上图，virus_loader主要负责将Zbot病毒的二进制数据注入到新进程中。首先，混淆器根据自己的使用需求分配内存，将这些内存地址添入提前准备好的结构中（如下图）。</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719308823161.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T46.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719308823161.png!small" alt="T46.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图46、混淆器调用数据结构示意图</b></p>
<p>之后，其将NT头复制到之前开辟的对应内存中，以挂起方式再次启动自身进程，利用NtUnmapViewOfSection卸载掉主模块之后重新在镜像基址位置开辟新空间。最后，通过NT头中的信息遍历节表，并将病毒的PE结构以每个节所对应的映射位置在内存中进行还原，在设置进程映像基址和EIP之后恢复主线程。</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719308911425.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T47.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719308911425.png!small" alt="T47.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图47、在内存中映射代码示意</b></p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719309017719.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T48.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719309017719.png!small" alt="T48.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图48、恢复线程环境代码示意</b></p>
<p><b>7.3对抗手段</b></p>
<p>我们还注意到，在其申请内存的时候，其真实使用的内存大小总比调用VirtualAlloc申请内存时大4个字节。</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719309242122.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T49.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719309242122.png!small" alt="T49.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图49、混淆器使用内存代码举例</b></p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719309336837.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T50.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719309336837.png!small" alt="T50.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图50、混淆器申请内存代码举例</b></p>
<p>根据MSDN上微软给出VirtualAlloc函数说明，我们了解到该函数实际申请的空间大小为系统内存页大小的整数倍。根据混淆器传入的参数0x3C、0xF4，其实际申请大小为64K，这样频繁进行块分配试图对虚拟沙盒的内存占用造成负担。</p>
<h3>8.NSIS混淆器——Cerber</h3>
<p>Cerber家族是在自2016年3月以来较为流行的勒索病毒家族，由于其所使用的混淆器复杂多变，其所使用混淆手段也多种多样。在该家族的大量样本中，我们发现很多使用NSIS混淆器进行混淆的Cerber样本。其主要特点是：加密的病毒以文件的方式被NSIS安装包释放到指定的安装目录，之后其用于还原病毒的Loader动态库会将Cerber病毒以注入的方式在新进程中进行还原。加密病毒源文件所用的加密密钥可以随意更改，加密后的数据也会随之进行变化；用来还原病毒的Loader动态库也可以任意变化还原流程或者进行代码级免杀。所以使得对于这类混淆器来讲，最有效的方法就是对其整个还原病毒流程进行完整还原。</p>
<p><b>8.1病毒行为</b></p>
<p>我们可以在行为沙盒看到其病毒还原的完整流程。首先其释放用于病毒还原的所有文件，如下图所示：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719309539414.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T51.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719309539414.png!small" alt="T51.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图51、NSIS混淆器释放文件效果图</b></p>
<p>释放文件后，混淆器会调用Services.dll中的Orchil函数以注入的方式将Cerber病毒进行还原，如下图所示：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719309637481.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T52.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719309637481.png!small" alt="T52.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图52、NSIS混淆器以注入方式还原病毒效果图</b></p>
<p>最后我们可以得到其还原后的病毒文件，虽然外层混淆器千变万化，但是内层病毒行为完全相同，我们可以清楚看到Cerber运行的一些基本行为特征。如下图所示：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719309765376.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T53.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719309765376.png!small" alt="T53.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图53、混淆器解密后的Cerber病毒运行效果图</b></p>
<p><b>8.2混淆器结构</b></p>
<p>s混淆器整体是一个NSIS安装包，主体逻辑有NSIS脚本进行控制。在NSIS安装包中包括三个主要部分：用来恢复病毒程序的Loader动态库、混淆器所调用API名字的加密数据和病毒加密数据。如下图所示：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719309903218.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T54.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719309903218.png!small" alt="T54.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图54、NSIS混淆器的基本结构图</b></p>
<p>在本报告所提到的样本中，NSIS释放的文件如下：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719310006980.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T55.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719310006980.png!small" alt="T55.png"></p></noscript>
<p style="text-align: center;"><span style="color: rgb(159, 163, 168);"><b>图55、NSIS混淆器释放的文件一览</b></span></p>
<p>如上图，NardooDeposal.W文件中存放着还原病毒程序时需要使用系统函数名，我们下文将称其为函数数据；ShopDemise.RkT文件中存放着加密后的Cerber病毒数据，暂且称其病毒数据；Services.dll为用来还原病毒程序的Loader动态库。</p>
<p>Loader动态库首先会将函数数据进行解密，解密时所用的密钥即是函数数据的文件名“NardooDeposal.W”，通过解密之后我们可以看到其所使用的函数列表。由于在如下图所示：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719310154522.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T56.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719310154522.png!small" alt="T56.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图56、函数数据解密过程</b></p>
<p>在恢复函数数据之后，Loader动态库再根据提前设定好的解密密钥“CaratSerinIntermittency”对加密的病毒数据进行解密。解密之后，再将病毒PE文件进行映射等操作，最后运行病毒代码。如下图所示：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/14719310262574.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T57.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/14719310262574.png!small" alt="T57.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图57、病毒数据解密示意图</b></p>
<p>根据我们对这类样本经验，在病毒混淆器中出现解密密钥、文件名和Loader动态库都会不断的进行变化，数据存放的结构也会进行不断变化。虽然混淆器中的这些关键点都会不断地改变、不断地进行免杀，但是该类混淆器的整体还原逻辑是不会改变的。不论中间环节如何改变，虚拟沙盒都将会原原本本的还原病毒行为，进而可以通过火绒的行为沙盒评估病毒行为并查杀。</p>
<p><b>8.3对抗手段</b></p>
<p>虽然此类混淆器已经将自己裹上了一层NSIS安装包的外衣，但是其所使用的对抗手段却一点也没有比以往混淆器要少。与以往的混淆器不同的是，NSIS混淆器所使用的对抗手段是在NSIS脚本中进行实现的，这就不单需要虚拟沙盒具有可以正常运行NSIS安装包能力，还需要与其脚本中对抗手法进行博弈。脚本中反虚拟机代码如下图所示：</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20160823/1471931036702.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="T58.png"></p>
<noscript><img src="http://image.3001.net/images/20160823/1471931036702.png!small" alt="T58.png"></p></noscript>
<p style="text-align: center;"><b style="color: rgb(159, 163, 168);">图58、NSIS脚本反虚拟机代码</b></p>
<p>其脚本中首先其欲从comdlg32动态库中调用Chippewa函数，在真实系统中的comdlg32动态库中并不存在Chippewa函数，如果调用成功则无法正常运行，从而达到了检测虚拟沙盒的效果。</p>
<p>之后，检测一初值为0的变量是否大于预先设定好的一个非常大的数值，如果不满足条件则每次将变量加2，试图以此来拖慢在虚拟沙盒中的运行速度，导致扫描超时。与之前提到拖慢虚拟沙盒速度的方法相比，其整体逻辑都会由NSIS脚本的解释器进行执行，使得虚拟沙盒对于这种对抗手段更加复杂。</p>
<h2>三、总结</h2>
<p>“特征”的时代永远不会过去，我们需要的只是发现“特征”的“眼睛”。</p>
<p>通过前文的分析，我们可以清晰地了解到，静态特征已不再能够有效地解决日益严峻的代码对抗问题。只有通过动态还原病毒本来的代码、数据以及行为，才能戳穿病毒的“伪装”，进而有效地解决此类问题。虚拟沙盒和动态防御，这两项技术则天然具备了上述特质，相信未来这两项技术将成为终端安全领域的制高点。</p>
<p>泡沫终将散去，安全必然回归本质。在这个病毒技术日新月异、不断推陈出新的年代，安全核心技术的迭代将是决定安全软件整体能力的基石。</p>
<h3>附录</h3>
<p>文中涉及样本SHA1：</p>
<table>
<colgroup>
<col width="49.96405463695183%">
<col width="50.035945363048164%"></colgroup>
<thead>
<tr>
<th>病毒名</th>
<th>SHA1</th>
</tr>
</thead>
<tbody>
<tr>
<td>Worm/Conficker(指令级混淆器)</td>
<td>19547db17e9f04572079d07eda5005af34f79d2e</td>
</tr>
<tr>
<td>TrojanDownloader/Ogimant（虚拟环境对抗型混淆器）</td>
<td>39575163c922fa90339ce84cee6b6abd758dbc68</td>
</tr>
<tr>
<td>Rogue/FakeAV.aj（虚拟环境对抗型混淆器）</td>
<td>3b392eb11bdb3b1c39f30c5dca4a91ec079c342f</td>
</tr>
<tr>
<td>HVM:TrojanDownloader/Upatre.gen!B（虚拟环境对抗型混淆器）</td>
<td>82c67dd7a41ea8f50af64305ea15d9acf4bd137a</td>
</tr>
<tr>
<td>Ransom/Tescrypt.d（虚拟环境对抗型混淆器）</td>
<td>0ffc994e247d2b108910e8bb6de3ef57439c51af</td>
</tr>
<tr>
<td>Trojan/C2Lop.gen!B(Visual C++ 混淆器)</td>
<td>262aad2b16408175d70d5ff9c672615f1648f770</td>
</tr>
<tr>
<td>HVM:Trojan/Injector.gen!A(Visual Basic 混淆器)</td>
<td>a8e20a4edbfc083fdeee18aa6da56d932ea35eb4</td>
</tr>
<tr>
<td>TrojanDropper/MSIL.Agent.e（.Net混淆器）</td>
<td>e42c142eef15fee35361724111d7486ac5fc6ae4</td>
</tr>
<tr>
<td>HVM:Trojan/Injector.gen!A（AutoIt混淆器）</td>
<td>2c28062f683a463885286db789418f28bc233a14</td>
</tr>
<tr>
<td>HVM:Trojan/Injector.gen!A(NSIS混淆器)</td>
<td>acc1128f30e7cf60203bbcf76a6e03248000829a</td>
</tr>
</tbody>
</table>
<p>与文中类似样本举例：</p>
<table>
<colgroup>
<col width="49.96405463695183%">
<col width="50.035945363048164%"></colgroup>
<thead>
<tr>
<th>病毒名</th>
<th>SHA1</th>
</tr>
</thead>
<tbody>
<tr>
<td>Worm/Conficker(指令级混淆器)</td>
<td>48f690c5a08534ad4ea49a77daad83ee07171c28</td>
</tr>
<tr>
<td>4daab0e43fc83397a3c0a5a1526ca6d3a9f5897d</td>
</tr>
<tr>
<td>c1944388870f76dd8ac51eaae6788d274690f779</td>
</tr>
<tr>
<td>……</td>
</tr>
<tr>
<td>TrojanDownloader/Ogimant（虚拟环境对抗型混淆器）</td>
<td>0134c5a3516b2534e1a7f35053aa0da85ecc3e0b</td>
</tr>
<tr>
<td>074da6a3bd7efa59982de255c9a95b7224ed0cc9</td>
</tr>
<tr>
<td>4efe62a8e41ec02acd8394cdd33f190761dc0c00</td>
</tr>
<tr>
<td>……</td>
</tr>
<tr>
<td>Rogue/FakeAV.aj（虚拟环境对抗型混淆器）</td>
<td>2ddbd1e054f2e8f71fbd3e4fe2d609add803f1f7</td>
</tr>
<tr>
<td>3abc54a287b2f36bfd7e0b3dc587a082a5090d7c</td>
</tr>
<tr>
<td>3b5db8ce4095126ef183df32689b7eb1e08740aa</td>
</tr>
<tr>
<td>……</td>
</tr>
<tr>
<td>HVM:TrojanDownloader/Upatre.gen!B（虚拟环境对抗型混淆器）</td>
<td>01faae2e965b01978e82e12f2e6fef24b0778e50</td>
</tr>
<tr>
<td>08f709774d793846036be4cef883de2a450f0674</td>
</tr>
<tr>
<td>0980f6ccd5963855bf8885c9394f007c51c87633</td>
</tr>
<tr>
<td>……</td>
</tr>
<tr>
<td>Ransom/Tescrypt.d（虚拟环境对抗型混淆器）</td>
<td>35b1d6c19eaea0669cf5af92046648d857ce7fc3</td>
</tr>
<tr>
<td>93ff6f91575d4a08d20588186ea9ea7904159961</td>
</tr>
<tr>
<td>f1e0dadba836a1e31d3142253796792e93709aa6</td>
</tr>
<tr>
<td>……</td>
</tr>
<tr>
<td>Trojan/C2Lop.gen!B(Visual C++ 混淆器)</td>
<td>88dd9102b8a15981f03c255adb42c611341f5ea1</td>
</tr>
<tr>
<td>a96edf881b75b2d25c0f55c2e6b1a63058811b59</td>
</tr>
<tr>
<td>b459cecc8241ae50e54666ae996ab0505d6484d8</td>
</tr>
<tr>
<td>……</td>
</tr>
<tr>
<td>HVM:Trojan/Injector.gen!A(Visual Basic 混淆器)</td>
<td>06a93a31566b2e781af61f22032c241c165acfd3</td>
</tr>
<tr>
<td>071a66ebe01eed93e8d48aa253b8e76c79b31ad5</td>
</tr>
<tr>
<td>076b81f51023a13fde5f1c39d58dda543a04cb17</td>
</tr>
<tr>
<td>……</td>
</tr>
<tr>
<td>TrojanDropper/MSIL.Agent.e（.Net混淆器）</td>
<td>1699ec1032ebda017ac96a6fbe58d224c2dd5aa9</td>
</tr>
<tr>
<td>7d980d2eb12f56f11bd9a3c0e1337e89be4c416e</td>
</tr>
<tr>
<td>954ae75ac05e2f167aaaefe3272c8a0eae574681</td>
</tr>
<tr>
<td>……</td>
</tr>
<tr>
<td>HVM:Trojan/Injector.gen!A（AutoIt混淆器）</td>
<td>0f8ba86000cd4a730e14f4bf1bd869fccedde7f8</td>
</tr>
<tr>
<td>110e5255459c756e7e4b8f59ef1b4e36cfa12bc8</td>
</tr>
<tr>
<td>29af93063140ab59398466a9f00398661a94555f</td>
</tr>
<tr>
<td>……</td>
</tr>
<tr>
<td>HVM:Trojan/Injector.gen!A(NSIS混淆器)</td>
<td>072e3ae98305a34668bc68b08c5f97e8589ab04d</td>
</tr>
<tr>
<td>0a759bbe9b31099e99570842b98b992454b9acd3</td>
</tr>
<tr>
<td>12aa1a435465e0904a126189b4b5d7bf5ca2cf84</td>
</tr>
<tr>
<td>……</td>
</tr>
</tbody>
</table>
<p><b style="color: rgb(0, 176, 80);">*本文作者：火绒安全（企业账号），转载须注明来自FreeBuf黑客与极客（FreeBuf.COM）</b></p>
                                                    </div>
                        <div class="article-oper article-oper-new">
                            <style>
                                @font-face {font-family: 'iconfont';
                                    src: url('http://static.3001.net/iconfonts/iconfont.eot'); /* IE9*/
                                    src: url('http://static.3001.net/iconfonts/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
                                    url('http://static.3001.net/iconfonts/iconfont.woff') format('woff'), /* chrome、firefox */
                                    url('http://static.3001.net/iconfonts/iconfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
                                    url('http://static.3001.net/iconfonts/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
                                }
                            </style>
                            <div class="share-new clearfix">
                                <div class="share-author">
                                                                            <a href="http://www.freebuf.com/author/火绒安全" title="由 火绒安全 发布" rel="author">
                                            <img src="http://image.3001.net/2016/11/b23f3d198041c43cb1bc508d904bdf64.jpeg" width="50" height="50" alt="火绒安全" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 photo" />                                            <!--							<img src="http://image.3001.net/2015/06/17.jpg" alt="ArthurKiller">-->
                                        </a>
                                        <div class="share-author-info">
                                                                                        <a class="author-name" href="http://www.freebuf.com/author/火绒安全">火绒安全</a>
                                            <!--<span class="icon-f"></span>-->
                                            <span>
                                <i class="colour-red">
                                    15                                </i>
                                篇文章</span>
                                            <span>等级：
                                <i class="colour-green">4</i>级
                            </span>
                                        </div>
                                                                                                        </div>
                                <div class="user-center clearfix">
                                                                            <a href="http://www.freebuf.com/author/火绒安全" data-toggle="tooltip" data-placement="top" title="个人主页" class="home" target="_blank"></a>
                                                                        <a href="http://www.freebuf.com/user/pm?pmaction=newmessage&to=火绒安全" data-toggle="tooltip" data-placement="top" title="私信" class="letter" target="_blank"></a>
                                </div>
                                <div class="share-ctrl clearfix">
                                                                        <div class="bdsharebuttonbox clearfix bdshare-button-style1-24 columnstatus"
                                         data-bd-bind="1489991449190" data-column="" data-title="代码战争：伪装和狙杀，从“壳”到“病毒混淆器”" data-name="">
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="tsina" title="分享到新浪微博" id="tsina"></a>
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="weixin" title="分享到微信" id="weixin"></a>
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="qzone" title="分享到QQ空间" id="qzone"></a>
                                       <!-- _shareUrlWeibo = 'http://service.weibo.com/share/share.php?url=http://'+encodeURIComponent(_json[i].url)+'&title='+encodeURIComponent(_json[i].title)+'-FreeBuf涓撴爮路'+_json[i].columnName;
                                        _shareUrlZone = 'http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://'+encodeURIComponent(_json[i].url)+'&title='+_json[i].title+'-FreeBuf涓撴爮路'+_json[i].columnName;
                                        _shareSrc = 'http://s.jiathis.com/qrcode.php?url=http://'+_json[i].url;-->
                                        <span class="share-line">|</span>
                                    </div>
                                </div>
                                <div class="user-ctrl clearfix">
                                                                            <a href="http://www.freebuf.com/oauth" id="collect" data-toggle="tooltip" data-placement="top" title="收藏" ></a>
                                                                        <a href="#respond" data-toggle="tooltip" data-placement="top" title="评论" id="comments"></a>
                                                                        <!--					<a href="#" title="文章纠正">&#xe6e3;</a>-->
                                    <span class="share-line">|</span>
                                    <span class="info-alert"></span>
                                </div>
                            </div>
                            <script>
                                var column = $('.columnstatus').attr('data-column');
                                var text = '';
                                if(column){
                                    var title = $('.columnstatus').attr('data-title');
                                    var name = $('.columnstatus').attr('data-name');
                                    text = title+' - FreeBuf专栏·'+name;
                                }
                                window._bd_share_config={
                                    "common": {
                                        "bdSnsKey": {},
                                        "bdText": text,
                                        "bdMini": "2",
                                        "bdMiniList": ["qzone", "tsina", "weixin"],
                                        "bdPic": "",
                                        "bdStyle": "1",
                                        "bdSize": "24"
                                    },
                                    "share":{},
                                };
                                with(document)0[
                                    (getElementsByTagName('head')[0]||body).
                                    appendChild(createElement('script')).
                                        src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)
                                    ];
                                //控制垂直方向分享模块的定位
                                function shareFixVertical(){
                                    var offsetTop = jQuery(".article-oper").get(0).offsetTop;
                                    var win_h = jQuery(window).height();
                                    var win_w = jQuery(window).width();
                                    var scrollTop = document.body.scrollTop||document.documentElement.scrollTop;
                                    var _height = offsetTop-scrollTop;
                                    var _flag = $('.column-article').attr('data-column');
                                    if(_flag == 1) {
                                        if(_height>=win_h-660&&win_w>975){
                                            var _width = jQuery("#getWidth").innerWidth()-30;
                                            var _left = jQuery("#getWidth").offset().left+15;
                                            jQuery(".share-new").addClass("fixed");
                                            jQuery(".fixed").css({
                                                width:_width,
                                                left:_left
                                            });

                                        }else{
                                            jQuery(".share-new").removeClass("fixed");
                                            jQuery(".share-new").css({
                                                width: "100%"
                                            });
                                        }
                                    }else {
                                        if(_height>=win_h-255&&win_w>975){
                                            var _width = jQuery("#getWidth").innerWidth()-30;
                                            var _left = jQuery("#getWidth").offset().left+15;
                                            jQuery(".share-new").addClass("fixed");
                                            jQuery(".fixed").css({
                                                width:_width,
                                                left:_left
                                            });

                                        }else{
                                            jQuery(".share-new").removeClass("fixed");
                                            jQuery(".share-new").css({
                                                width: "100%"
                                            });
                                        }
                                    }
                                }
                                //控制水平方向分享模块的定位
                                function shareFixHorizontal(){
                                    var _width = jQuery("#getWidth").innerWidth()-30;
                                    var _left = jQuery("#getWidth").get(0).offsetLeft+15;
                                    var win_w = document.documentElement.clientWidth || document.body.clientWidth;
                                    jQuery(".fixed").css({
                                        width:_width,
                                        left:_left
                                    });
                                    if(win_w< 975){
                                        jQuery(".share-new").css({
                                            width: "100%",
                                            left: "0"
                                        });
                                    }else{
                                        var _width = jQuery("#getWidth").innerWidth()-30;
                                        var _left = jQuery("#getWidth").get(0).offsetLeft+15;
                                        jQuery(".fixed").css({
                                            width:_width,
                                            left:_left
                                        });
                                    }
                                }
                                function click(){
                                    var _w = jQuery(window).width();
                                    jQuery(document).click(function(e){
                                        if(jQuery(e.target).attr("id")=="weixin"){
                                            if(_w <= 760) {
                                                jQuery("#bdshare_weixin_qrcode_dialog").hide();
                                                layer.open({
                                                    title: '提示',
                                                    btnAlign: 'c',
                                                    content: '请使用手机浏览器自带的分享功能分享该页面',
                                                    area: '260px'
                                                });
                                            }else {
                                                jQuery("#bdshare_weixin_qrcode_dialog").show();
                                            }
                                        }else {
                                            jQuery("#bdshare_weixin_qrcode_dialog").hide();
                                        }
                                    });
                                }

                                jQuery(window).on("load",function(){
                                    shareFixVertical();
                                    click();
                                });

                                jQuery(window).on("scroll",function(){
                                    //判断滚轮方向
                                    var agent = navigator.userAgent;
                                    if (/.*Firefox.*/.test(agent)) {
                                        document.addEventListener("DOMMouseScroll", function(e) {
                                            e = e || window.event;
                                            var detail = e.detail;
                                            if (detail > 0) {
                                                $(".share-new").removeClass("fixed");
                                                $(".share-new").css({
                                                    width: "100%"
                                                });
                                                $('.main-header .header').removeClass('op1');
                                                $('.main-header .header').addClass('op0');
                                            } else {
                                                shareFixVertical();
                                                $('.main-header .header').removeClass('op0');
                                                $('.main-header .header').addClass('op1');
                                            }
                                        });
                                    } else {
                                        document.onmousewheel = function(e) {
                                            e = e || window.event;
                                            var wheelDelta = e.wheelDelta;
                                            if (wheelDelta > 0) {
                                                shareFixVertical();
                                                $('.main-header .header').removeClass('op0');
                                                $('.main-header .header').addClass('op1');
                                            } else {
                                                $(".share-new").removeClass("fixed");
                                                $(".share-new").css({
                                                    width: "100%"
                                                });
                                                $('.main-header .header').removeClass('op1');
                                                $('.main-header .header').addClass('op0');
                                            }
                                        }
                                    }
                                });


                                jQuery(window).on("resize",function(){
                                    shareFixHorizontal();
                                    click();
                                })

                                //tooltips提示
                                $(function () { $("[data-toggle='tooltip']").tooltip(); });
                            </script>
                        </div>
                                                                                                                            <div class="article-pager ">
                                <ul>
                                    <li class="previous"><span>上一篇：</span><a href="http://www.freebuf.com/articles/system/112328.html" rel="prev">初步分析勒索软件ZEPTO</a>                                    </li>
                                    <li class="next"><span>下一篇：</span>
                                        <a href="http://www.freebuf.com/articles/system/113113.html" rel="next">Pegasus间谍套件内部原理及流程剖析</a>                                    </li>
                                </ul>
                            </div>
                                            </div>
                </div>
                    <div class="comment-bright"><div class="main-tit04">
    <h3>这些评论亮了</h3></div>      <ul>      <li>
            <div class="user_photo">             <img src="http://image.3001.net/images/headimg/pic7.png">             </div>
            <div class="tit"><span class="name"> cf浩哥 </span> 
						<span class="explain"></span>
			<span class="reply"><a onclick="return addComment.moveForm( 'comment-','', 'respond','112631' ) " href="?replytocom=#respond" class="comment-reply-link" rel="nofollow">回复</a></span></div>
            <div class="txt">
						十句不离火绒   不过写的不错</div>
            <div class="but"><span class="vote-count">)</span><span style="none" id="cos_support-2195048" class="vote-count">12</span><span class="vote-count">(</span><span class="vote">  <a class="ilike_icon" id="vote4-2195048" href="javascript:acv_vote(195048,1,2);">亮了</a></span></div>
          </li>
         </ul></div><div class="comment-list">
      <div class="main-tit02">
		<a rel="nofollow" class="btnbtn-default btn-comment" href="#respond">发表评论</a>
        <h3>已有 <span class="color_red">13</span> 条评论
      </div>
      <ul>
         <li class="comment byuser comment-author-cujam even thread-even depth-1" id="li-comment-195040">
    <div id="comment-195040">
        <div class="photo"> <a href="http://www.freebuf.com/author/cujam">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/cujam" target="_blank">cujam&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2016-08-30</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-195040','195040', 'respond','112631' ) " href="?replytocom=195040#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">1楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p> <img src='http://image.3001.net/images/index/smilies/icon_surprised.gif' alt=':eek:' class='wp-smiley' /> </p>
<div class="comment-tools">
<div class="vote" id="vote-195040"><span id="acv_stat_195040"></span><a class="ilike_icon"  id="vote4-195040" href="javascript:acv_vote(195040,1);">亮了</a>(<span id="cos_support-195040">3</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="195040" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="195040" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="195040" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="195040" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="195040" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-fornext odd alt thread-odd thread-alt depth-1" id="li-comment-195041">
    <div id="comment-195041">
        <div class="photo"> <a href="http://www.freebuf.com/author/fornext">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/fornext" target="_blank">fornext&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain"> 这家伙就是太懒了，打死都不填写个人描述。 </span>
		<span class="time">&nbsp;2016-08-30</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-195041','195041', 'respond','112631' ) " href="?replytocom=195041#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">2楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p> <img src='http://image.3001.net/images/index/smilies/icon_lol.gif' alt=':lol:' class='wp-smiley' /> </p>
<div class="comment-tools">
<div class="vote" id="vote-195041"><span id="acv_stat_195041"></span><a class="ilike_icon"  id="vote4-195041" href="javascript:acv_vote(195041,1);">亮了</a>(<span id="cos_support-195041">4</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="195041" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="195041" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="195041" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="195041" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="195041" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-195048">
    <div id="comment-195048">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic15.png">     </div>
    <div class="tit"> 
	    <span class="name"> cf浩哥 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-08-30</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-195048','195048', 'respond','112631' ) " href="?replytocom=195048#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">3楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>十句不离火绒   不过写的不错</p>
<div class="comment-tools">
<div class="vote" id="vote-195048"><span id="acv_stat_195048"></span><a class="ilike_icon"  id="vote4-195048" href="javascript:acv_vote(195048,1);">亮了</a>(<span id="cos_support-195048">12</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="195048" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="195048" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="195048" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="195048" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="195048" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-10086 odd alt thread-odd thread-alt depth-1" id="li-comment-195049">
    <div id="comment-195049">
        <div class="photo"> <a href="http://www.freebuf.com/author/死宅10086">
    <img src="http://image.3001.net/2016/04/145254ordw99xzxszuusly.jpg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/死宅10086" target="_blank">死宅10086&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(6级)</span>
				<span class="explain"> 这家伙太懒了，还未填写个人描述！ </span>
		<span class="time">&nbsp;2016-08-30</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-195049','195049', 'respond','112631' ) " href="?replytocom=195049#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">4楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>吊爆了 <img src='http://image.3001.net/images/index/smilies/icon_surprised.gif' alt=':eek:' class='wp-smiley' /> </p>
<div class="comment-tools">
<div class="vote" id="vote-195049"><span id="acv_stat_195049"></span><a class="ilike_icon"  id="vote4-195049" href="javascript:acv_vote(195049,1);">亮了</a>(<span id="cos_support-195049">4</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="195049" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="195049" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="195049" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="195049" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="195049" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-- even thread-even depth-1" id="li-comment-195056">
    <div id="comment-195056">
        <div class="photo"> <a href="http://www.freebuf.com/author/比尔.盖茨">
    <img src="http://image.3001.net/2013/12/QQ截图20131222122914.jpg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/比尔.盖茨" target="_blank">比尔.盖茨&nbsp;</a>  </span>
        		
		<span class="icon-f"> <a href="http://www.freebuf.com/bufer" target="_blank"><img src="http://image.3001.net/images/index/f1.png" title="认证作者"></a><a href="http://zhuanlan.freebuf.com" target="_blank"><img src="http://image.3001.net/images/index/column-iden.png" title="专栏作者"></a></span>
		<span class="rank">(4级)</span>
				<span class="explain"> iplaynice </span>
		<span class="time">&nbsp;2016-08-30</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-195056','195056', 'respond','112631' ) " href="?replytocom=195056#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">5楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>已阅，前排支持。</p>
<div class="comment-tools">
<div class="vote" id="vote-195056"><span id="acv_stat_195056"></span><a class="ilike_icon"  id="vote4-195056" href="javascript:acv_vote(195056,1);">亮了</a>(<span id="cos_support-195056">4</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="195056" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="195056" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="195056" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="195056" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="195056" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-cwg2552298 odd alt thread-odd thread-alt depth-1" id="li-comment-195075">
    <div id="comment-195075">
        <div class="photo"> <a href="http://www.freebuf.com/author/cwg2552298">
    <img src="http://image.3001.net/2016/06/火狐截图_2016-03-06T00-22-02.973Z.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/cwg2552298" target="_blank">cwg2552298&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(6级)</span>
				<span class="explain"> Follow my own course </span>
		<span class="time">&nbsp;2016-08-30</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-195075','195075', 'respond','112631' ) " href="?replytocom=195075#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">6楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>太叼了，分析器可以分享一下吗 <img src='http://image.3001.net/images/index/smilies/icon_mrgreen.gif' alt=':mrgreen:' class='wp-smiley' /> </p>
<div class="comment-tools">
<div class="vote" id="vote-195075"><span id="acv_stat_195075"></span><a class="ilike_icon"  id="vote4-195075" href="javascript:acv_vote(195075,1);">亮了</a>(<span id="cos_support-195075">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="195075" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="195075" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="195075" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="195075" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="195075" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-195103">
    <div id="comment-195103">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic12.png">     </div>
    <div class="tit"> 
	    <span class="name"> 周红衣 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-08-30</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-195103','195103', 'respond','112631' ) " href="?replytocom=195103#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">7楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>还是行为分析靠谱</p>
<div class="comment-tools">
<div class="vote" id="vote-195103"><span id="acv_stat_195103"></span><a class="ilike_icon"  id="vote4-195103" href="javascript:acv_vote(195103,1);">亮了</a>(<span id="cos_support-195103">3</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="195103" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="195103" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="195103" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="195103" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="195103" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-195105">
    <div id="comment-195105">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic14.png">     </div>
    <div class="tit"> 
	    <span class="name"> 吼离海 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-08-30</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-195105','195105', 'respond','112631' ) " href="?replytocom=195105#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">8楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>感谢楼主分享这么详细地文章。话说这种广告文，多多益善！</p>
<div class="comment-tools">
<div class="vote" id="vote-195105"><span id="acv_stat_195105"></span><a class="ilike_icon"  id="vote4-195105" href="javascript:acv_vote(195105,1);">亮了</a>(<span id="cos_support-195105">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="195105" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="195105" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="195105" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="195105" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="195105" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-235959 even thread-even depth-1" id="li-comment-195107">
    <div id="comment-195107">
        <div class="photo"> <a href="http://www.freebuf.com/author/麻麻是天后">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/麻麻是天后" target="_blank">麻麻是天后&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2016-08-30</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-195107','195107', 'respond','112631' ) " href="?replytocom=195107#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">9楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>和一群没事炒作人工智能的码农说下，目前最靠谱的“人工智能”是：找个妹子生个孩子，从小培养&#8230;说不定能比你智能高些。</p>
<div class="comment-tools">
<div class="vote" id="vote-195107"><span id="acv_stat_195107"></span><a class="ilike_icon"  id="vote4-195107" href="javascript:acv_vote(195107,1);">亮了</a>(<span id="cos_support-195107">4</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="195107" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="195107" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="195107" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="195107" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="195107" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment odd alt depth-2" id="li-comment-195125">
    <div id="comment-195125">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic15.png">     </div>
    <div class="tit"> 
	    <span class="name"> nicker </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-08-31</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-195125','195125', 'respond','112631' ) " href="?replytocom=195125#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ 麻麻是天后    然后用2进制作为这个小孩的第一语言，16进制第二语言，第三语言用来跟我们沟通，要把win&amp;unix从底层实现到上层逻辑的知识都灌输给他，看到混淆器他就直接脑脱然后给出dump.exe</p>
<div class="comment-tools">
<div class="vote" id="vote-195125"><span id="acv_stat_195125"></span><a class="ilike_icon"  id="vote4-195125" href="javascript:acv_vote(195125,1);">亮了</a>(<span id="cos_support-195125">5</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="195125" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="195125" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="195125" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="195125" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="195125" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="li-comment-195258">
    <div id="comment-195258">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic7.png">     </div>
    <div class="tit"> 
	    <span class="name"> ttzer0 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-09-01</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-195258','195258', 'respond','112631' ) " href="?replytocom=195258#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">10楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>哈哈，800年前的东西包装一下也挺唬人的</p>
<div class="comment-tools">
<div class="vote" id="vote-195258"><span id="acv_stat_195258"></span><a class="ilike_icon"  id="vote4-195258" href="javascript:acv_vote(195258,1);">亮了</a>(<span id="cos_support-195258">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="195258" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="195258" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="195258" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="195258" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="195258" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-arthurkiller odd alt thread-even depth-1" id="li-comment-195428">
    <div id="comment-195428">
        <div class="photo"> <a href="http://www.freebuf.com/author/ArthurKiller">
    <img src="http://image.3001.net/2016/11/a1edd4100beccaadcc97dc445d07df0b.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/ArthurKiller" target="_blank">ArthurKiller&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(7级)</span>
				<span class="explain"> 窃.格瓦拉驻FreeBuf办事处 </span>
		<span class="time">&nbsp;2016-09-02</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-195428','195428', 'respond','112631' ) " href="?replytocom=195428#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">11楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>看来火绒的众多分析文章，默默安装了一个火绒杀毒软件。别说，还真的蛮好用的。</p>
<div class="comment-tools">
<div class="vote" id="vote-195428"><span id="acv_stat_195428"></span><a class="ilike_icon"  id="vote4-195428" href="javascript:acv_vote(195428,1);">亮了</a>(<span id="cos_support-195428">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="195428" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="195428" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="195428" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="195428" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="195428" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="li-comment-195814">
    <div id="comment-195814">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic16.png">     </div>
    <div class="tit"> 
	    <span class="name"> virk </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-09-07</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-195814','195814', 'respond','112631' ) " href="?replytocom=195814#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">12楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>话说这个虚拟沙盒，长的好像X豆的虚拟机</p>
<div class="comment-tools">
<div class="vote" id="vote-195814"><span id="acv_stat_195814"></span><a class="ilike_icon"  id="vote4-195814" href="javascript:acv_vote(195814,1);">亮了</a>(<span id="cos_support-195814">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="195814" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="195814" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="195814" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="195814" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="195814" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
      </ul>
      <div class="commentnav page01" style="padding-top:10px; text-align: center;">
               </div>
	  
<script src="http://www.freebuf.com/buf/themes/freebuf/js/ajaxfileupload.js" type="text/javascript"></script>
<div id="respond" class="comment-box">
<input type="file" id="uploadUnit" name="upfile" class="hidden" value="">
    <form action="http://www.freebuf.com/wp-comments-post.php" method="post" id="commentform">
        <div id="comment-author-info">
	    <div class="login-other">
		  <div class="login_button login_icon_sina" title="使用新浪微博登陆" onclick="login_button_click('sina')"></div>
          <div class="login_button login_icon_qq" title="使用腾讯QQ登陆" onclick="login_button_click('qq')"></div></div>
        <div class="login-input">
	    <p><label for="author">昵称</label>
		          <input type="text" name="author" id="author" value="" size="14" tabindex="1" aria-required='true' placeholder = "请输入昵称" required />
        </p><span>必须</span><span>您当前尚未登录。<a  class="simplemodal-login" href="http://www.freebuf.com/oauth" title="登陆">登陆？</a><a  href="https://account.tophant.com/register.html" target="_blank">注册</a></span></div>
		<div class="login-input">
		  <p><label for="email">邮箱</label><input type="text" name="email" id="email" value="" size="25" tabindex="2" aria-required='true' placeholder = "请输入邮箱地址" required /></p>
		<span>必须（保密）</span>
		</div>
    </div>

        <div id="test" class="post-area">
      <div class="holiday"></div>
	    <div class="comment-editor">
			<a id="comment-smiley" href="javascript:;">表情</a><a href="javascript:;" id="imageThumb">插图</a>
	    </div>
        <div id="smileys" >
           <a title="mrgreen" href="javascript:grin(':mrgreen:')"><img src="http://image.3001.net/images/index/smilies/icon_mrgreen.gif" /></a><a title="razz" href="javascript:grin(':razz:')"><img src="http://image.3001.net/images/index/smilies/icon_razz.gif" /></a><a title="sad" href="javascript:grin(':sad:')"><img src="http://image.3001.net/images/index/smilies/icon_sad.gif" /></a><a title="smile" href="javascript:grin(':smile:')"><img src="http://image.3001.net/images/index/smilies/icon_smile.gif" /></a><a title="oops" href="javascript:grin(':oops:')"><img src="http://image.3001.net/images/index/smilies/icon_redface.gif" /></a><a title="grin" href="javascript:grin(':grin:')"><img src="http://image.3001.net/images/index/smilies/icon_biggrin.gif" /></a><a title="eek" href="javascript:grin(':eek:')"><img src="http://image.3001.net/images/index/smilies/icon_surprised.gif" /></a><a title="???" href="javascript:grin(':???:')"><img src="http://image.3001.net/images/index/smilies/icon_confused.gif" /></a><a title="cool" href="javascript:grin(':cool:')"><img src="http://image.3001.net/images/index/smilies/icon_cool.gif" /></a><a title="lol" href="javascript:grin(':lol:')"><img src="http://image.3001.net/images/index/smilies/icon_lol.gif" /></a><a title="mad" href="javascript:grin(':mad:')"><img src="http://image.3001.net/images/index/smilies/icon_mad.gif" /></a><a title="twisted" href="javascript:grin(':twisted:')"><img src="http://image.3001.net/images/index/smilies/icon_twisted.gif" /></a><a title="roll" href="javascript:grin(':roll:')"><img src="http://image.3001.net/images/index/smilies/icon_rolleyes.gif" /></a><a title="wink" href="javascript:grin(':wink:')"><img src="http://image.3001.net/images/index/smilies/icon_wink.gif" /></a><a title="idea" href="javascript:grin(':idea:')"><img src="http://image.3001.net/images/index/smilies/icon_idea.gif" /></a><a title="arrow" href="javascript:grin(':arrow:')"><img src="http://image.3001.net/images/index/smilies/icon_arrow.gif" /></a><a title="neutral" href="javascript:grin(':neutral:')"><img src="http://image.3001.net/images/index/smilies/icon_neutral.gif" /></a><a title="cry" href="javascript:grin(':cry:')"><img src="http://image.3001.net/images/index/smilies/icon_cry.gif" /></a><a title="?" href="javascript:grin(':?:')"><img src="http://image.3001.net/images/index/smilies/icon_question.gif" /></a><a title="evil" href="javascript:grin(':evil:')"><img src="http://image.3001.net/images/index/smilies/icon_evil.gif" /></a><a title="shock" href="javascript:grin(':shock:')"><img src="http://image.3001.net/images/index/smilies/icon_eek.gif" /></a><a title="!" href="javascript:grin(':!:')"><img src="http://image.3001.net/images/index/smilies/icon_exclaim.gif" /></a>        </div>
         <textarea name="comment" id="comment" cols="100%" rows="7" tabindex="4" style="overflow-x:hidden; overflow-y:hidden; border:0; width:100%;" onkeydown="if(event.ctrlKey&amp;&amp;event.keyCode==13){document.getElementById('submit').click();return false};"></textarea>
    </div>
      <div class="subcon but">
      <input class="btn btn-success" type="submit" name="submit" id="submit" tabindex="5" value="提交评论(Ctrl+Enter)" />
      <a rel="nofollow" class="btn btn-default" id="cancel-comment-reply-link" href="javascript:;">取消</a>
      <div class="checkbox"><input type='hidden' name='comment_post_ID' value='112631' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
<label for="comment_mail_notify" class="comment_mail"><input type="checkbox" name="comment_mail_notify" id="comment_mail_notify" value="comment_mail_notify" checked="checked"/>有人回复时邮件通知我</label></div>
      </div>
    <input name="Token" id="Token" type="hidden" value="iflh28" />
  </form>
  </div>
</div>	  
<div class="commentshow">
<div class="comments-loading">Loading...</div>
</div>
<script language="javascript">
jQuery(document).ready(function($){ //Begin jQuery
    $('.reply').click(function() {
    var atid = '"#' + $(this).parent().attr("id") + '"';
    var atname = $(this).parent().find('span:first').text();
    $("#comment").val("@" + atname + " ").focus();
});
    $('.cancel-comment-reply a').click(function() { //点击取消回复评论清空评论框的内容
    $("#comment").val('');
});
}) 

jQuery(document).ready(function($) {
    $body = (window.opera) ? (document.compatMode == "CSS1Compat" ? $('html') : $('body')) : $('html,body');//commentnav ajax
    $(document).on('click', '.commentnav a', function(e) {
        e.preventDefault();
        $.ajax({
            type: "GET",
            url: $(this).attr('href'),
            beforeSend: function() {
                $('.commentnav').remove();
                $('.comment-list').remove();
                $('.comments-loading').slideDown();
            },
            dataType: "html",
            success: function(out) {
                result = $(out).find('.comment-list');
                nextlink = $(out).find('.commentnav');
                $('.comments-loading').slideUp(550);
                $('.comments-loading').after(result.fadeIn(800));
                $(".comment-list img").each(function(){
                  var url = $(this).attr("data-original");
                  $(this).attr("src",url);
                })
            }
        });
    });    
});
</script>            </div>
                    <div class="col-md-3 visible-md-block visible-lg-block">
                <div class="panel panel-default">
                    <div class="author-top">
                         <div class="author-wrap">
                            <div class="author-header"><img src="http://image.3001.net/2016/11/b23f3d198041c43cb1bc508d904bdf64.jpeg" width="96" height="96" alt="火绒安全" class="avatar avatar-100 wp-user-avatar wp-user-avatar-100 photo" />                            </div>
                            <p class="name"><a href="http://www.freebuf.com/author/%e7%81%ab%e7%bb%92%e5%ae%89%e5%85%a8" title="由 火绒安全 发布" rel="author">火绒安全</a><span><a href="http://www.freebuf.com/bufer" target="_blank"><img src="http://image.3001.net/images/index/f2.png" title="认证厂商"></a></span></p>
                            <p class="signature">火绒安全软件官方账号</p>
                            <p class="art-com clearfix">
                                <span class="aut-article">
                                    <a href="/author/火绒安全"target="_blank">
                                        <i>15</i>
                                        <i>文章数</i>
                                    </a>
                                </span>
                                <span class="aut-comment">
                                    <a href="/author/火绒安全?comment=1" target="_blank">
                                        <i>1</i>
                                        <i>评论数</i>
                                    </a>
                                </span>
                            </p>
                        </div>
                    </div>
                    <div class="author-bottom">
                        <div class="author-wrap">
                            <h3 class="last-title">最近文章</h3>
                            <div class="last-item-wrap">
                                                                        <div class="last-item">
                                            <a href="http://www.freebuf.com/news/142984.html" target="_blank"><span class="point"></span>恶性病毒Kuzzle“攻破”安全厂商白名单，用户重装系统也难以清除</a>
                                            <p class="last-time">2017.08.08</p>
                                        </div>
                                                                            <div class="last-item">
                                            <a href="http://www.freebuf.com/news/141644.html" target="_blank"><span class="point"></span>彻底曝光黑客组织“隐匿者”，目前作恶最多的网络攻击团伙</a>
                                            <p class="last-time">2017.07.28</p>
                                        </div>
                                                                            <div class="last-item">
                                            <a href="http://www.freebuf.com/news/139381.html" target="_blank"><span class="point"></span>恶性病毒Pengex通过系统盘疯狂传播，攻击所有主流杀软却唯独放过腾讯</a>
                                            <p class="last-time">2017.07.10</p>
                                        </div>
                                                                </div>
                        </div>

                        <div class="more-wrap">
                            <a href="http://www.freebuf.com/author/火绒安全" target="_blank" class="btn-new">浏览更多</a>
                        </div>
                    </div>
                </div>
                                <div class="panel panel-default">
                    <div class="read visible-md-block visible-lg-block">
                        <div class="main-tit02">
                            <h3>相关阅读</h3>
                        </div>
                        <ul></ul><ul>
  <li><a href="http://www.freebuf.com/news/143685.html" target="_blank" title=乌龙的CVE-2017-8570样本及背后的狗血>乌龙的CVE-2017-8570样本及背后的狗血</a></li>
  
  <li><a href="http://www.freebuf.com/articles/terminal/85442.html" target="_blank" title=payload实例分析：加密的恶意文档>payload实例分析：加密的恶意文档</a></li>
  
  <li><a href="http://www.freebuf.com/articles/terminal/75854.html" target="_blank" title=索尼PS4安全现状分析>索尼PS4安全现状分析</a></li>
  
  <li><a href="http://www.freebuf.com/news/140760.html" target="_blank" title=思科WebEx视频会议插件再度发现严重RCE漏洞，这是今年第二次了>思科WebEx视频会议插件再度发现严重RCE漏洞，这是今年第二次了</a></li>
  
  <li><a href="http://www.freebuf.com/articles/system/146415.html" target="_blank" title=针对MSOffice的木马新变种（毒藤）深度分析>针对MSOffice的木马新变种（毒藤）深度分析</a></li>
  </ul>                    </div>
                </div>
                <!--<div class="ad-wrap"><a href="http://www.ijiami.cn/?freebuf.com" target="_blank"><img width="100%" src="http://image.3001.net/images/20141201/14174039186901.jpg"></a></div>-->
                <div class="panel panel-default rec-spe">
                    <div class="main-tit03 colour-blue">
                        <h3>特别推荐</h3>
                    </div>
                                                    <div class="rec-img"><a href="http://www.freebuf.com/ad?id=3" target="_blank"><img
                                            src="http://image.3001.net/2017/05/14a10c5c919d154dddbee79e3a944143-220x150.png" width="220"></a></div>
                                                </div>
                <div id="mar-right">
                    <!--<div class="read visible-lg-block">
        <div class="main-tit04">
          <h3>商城新品</h3>
        </div>
        <div id="slider" class="nivoSlider">  </div>
      </div>-->
                    <div class="panel panel-default code"><img src="http://image.3001.net/images/new/code.jpg" width="192"
                                                               height="192">
                        <p>关注我们 分享每日精选文章</p>
                    </div>
                </div>
            </div>
                </div>
                    <div class="row marvellous visible-lg-block">
                <h3>不容错过</h3>
                <ul>
                                                <li><a href="http://www.freebuf.com/news/79262.html" rel="bookmark"
                                   title="安卓粉的愤怒：苹果首款Android App遭疯狂差评">安卓粉的愤怒：苹果首款Android App遭疯狂差评</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/dawner" title="由 dawner 发布" rel="author">dawner</a></span>
                                                                        <span class="time">2015-09-22</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/articles/web/133306.html" rel="bookmark"
                                   title="游戏外挂网站暗藏病毒：盗号、锁首等数种危害并举">游戏外挂网站暗藏病毒：盗号、锁首等数种危害并举</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/%e7%81%ab%e7%bb%92%e5%ae%89%e5%85%a8" title="由 火绒安全 发布" rel="author">火绒安全</a></span>
                                                                        <span class="time">2017-05-02</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/news/111825.html" rel="bookmark"
                                   title="【FB TV】一周「BUF大事件」（20160806-201608012）">【FB TV】一周「BUF大事件」（20160806-201608012）</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/supercoco" title="由 supercoco 发布" rel="author">supercoco</a></span>
                                                                        <span class="time">2016-08-13</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/news/107916.html" rel="bookmark"
                                   title="动手搭建DDoS演练：揭秘在线DDoS攻击平台（下）">动手搭建DDoS演练：揭秘在线DDoS攻击平台（下）</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/arthurkiller" title="由 ArthurKiller 发布" rel="author">ArthurKiller</a></span>
                                                                        <span class="time">2016-07-05</span></p>
                            </li>
                                                            </ul>
            </div>
            </div>
</div>
<script type="text/javascript">
  $(window).load(function() {
    $('#slider').nivoSlider();
  });
  $('#contenttxt img').removeAttr('height');
  $('#contenttxt img').wrap(function(){
    if(!$(this).parent().attr('href')){
      var imgurl = $(this).attr('data-original');
      if(imgurl.substr(-6)=='!small'){
        imgurl = imgurl.substring(0,imgurl.length-6);
      }
      return '<a href="' + imgurl + '" class="highslide-image" onclick="return hs.expand(this);" target="_blank"></a>';
    }
  })
</script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/comments-ajax.js" type="text/javascript"></script>
<script type="text/javascript" src="http://static.3001.net/js/focus/jquery.nivo.slider.pack.js"></script>
<!----------footer---------->
<div class="footer">
  <div class="container">
    <div class="footer-list ">
      <h3>FREEBUF</h3>
      <ul>
        <li><a href="http://www.freebuf.com/dis">免责声明</a></li>
        <li><a href="http://www.freebuf.com/news/others/864.html">关于我们</a></li>
        <li><a href="http://www.freebuf.com/jobs/40386.html">加入我们</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>广告及服务</h3>
      <ul>
        <li><a target="_blank" href="mailto:root@freebuf.com">寻求报道</a></li>
        <li><a href="http://www.freebuf.com/advertise">广告合作</a></li>
        <li><a target="_blank" href="mailto:help@freebuf.com">联系我们</a></li>
        <li><a href="http://www.freebuf.com/friends">友情链接</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>关注我们</h3>
      <ul>
        <li><div class="weixin-pannel weixin"><a class="qr" href="javascript:viod(0);"><span class="g-icon-qr1">官方微信</span><i></i></a></div></li>
        <li><a rel="nofollow" target="_blank" href="http://weibo.com/freebuf">新浪微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://t.qq.com/freebuf">腾讯微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://twitter.com/freebuf">Twitter</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>赞助商</h3>
      <ul>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="http://www.aliyun.com/?freebuf"><img src="http://image.3001.net/images/ad/ali.png"></a></li>
        <li><a rel="nofollow" target="_blank" href="http://www.upyun.com/?freebuf"><img src="http://image.3001.net/images/ad/upyun.png"></a></li>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="https://www.trustasia.com/?freebuf"><img src="http://image.3001.net/images/ad/ad-yzcx.png"></a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <ul>
      </ul>
    </div>
    <div class="footer-logo  pull-right"><img src="http://image.3001.net/images/index/freebufrobot_shendanjie.png" ></div>
  </div>
  <div class="copyright"><div class="container"><p>Copyright &copy; 2017 WWW.FREEBUF.COM All Rights Reserved <a rel="nofollow" target="_blank" href="http://www.miitbeian.gov.cn">沪ICP备13033796号</a></p><span><a rel="nofollow" target="_blank" href="http://click.aliyun.com/m/1336/?freebuf"><img src="http://image.3001.net/images/new/icon-aly.png"></a></span></div></div>
</div>
<div class="bottom_tools"><a id="scrollUp" href="javascript:;" title="飞回顶部"></a></div>
<!----------footer end----------> 
<script src="http://static.3001.net/js/new/backtop.js"></script>
<script type="text/javascript">
jQuery(function(){	
	jQuery('.tabPanes ul li').click(function(){
		jQuery(this).addClass('hit').siblings().removeClass('hit');
		jQuery('.panesl>div:eq('+jQuery(this).index()+')').show().siblings().hide();	
	})
	jQuery('.vulbox-nav').click(function(e) { 
        e.stopPropagation(); 
    });  
})
</script>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fcc53db168808048541c6735ce30421f5' type='text/javascript'%3E%3C/script%3E"));
</script>
<img alt='css.php' src="http://www.freebuf.com/buf/plugins/cc/css.php?k=3cb185a485c81b23211eb80b75a406fd&amp;o=i&amp;t=660708405" width='1' height='1' /><script type="text/javascript">
jQuery(function() {
    jQuery(".simditor pre").each(function(i, block){
        hljs.highlightBlock(block);    
    });
    hljs.initHighlightingOnLoad();
});
</script>
<script>
/* <![CDATA[ */
var rcGlobal = {
	serverUrl		:'http://www.freebuf.com',
	infoTemp		:'%REVIEWER% on %POST%',
	loadingText		:'Loading',
	noCommentsText	:'No comments',
	newestText		:'&laquo; 最新',
	newerText		:'&laquo; 新一点',
	olderText		:'旧一点 &raquo;',
	showContent		:'1',
	external		:'1',
	avatarSize		:'32',
	avatarPosition	:'left',
	anonymous		:'Anonymous'
};
/* ]]> */
</script>
<script type='text/javascript' src='http://static.3001.net/js/recentcomments/wp-recentcomments-jquery.js?ver=2.2.3'></script>
</body>
</html>
