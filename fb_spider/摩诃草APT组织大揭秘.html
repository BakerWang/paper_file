<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
                              _.._        ,------------.
                           ,'      `.    ( We want you! )
                          /  __) __` \    `-,----------'
                         (  (`-`(-')  ) _.-'
                         /)  \  = /  (
                        /'    |--' .  \
                       (  ,---|  `-.)__`
                        )(  `-.,--'   _`-.
                       '/,'          (  Uu",
                        (_       ,    `/,-' )
                        `.__,  : `-'/  /`--'
                          |     `--'  |
                          `   `-._   /
                           \        (
                           /\ .      \.  freebuf
                          / |` \     ,-\
                         /  \| .)   /   \
                        ( ,'|\    ,'     :
                        | \,`.`--"/      }
                        `,'    \  |,'    /
                       / "-._   `-/      |
                       "-.   "-.,'|     ;
                      /        _/["---'""]
                     :        /  |"-     '
                     '           |      /
                                 `      |
-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  摩诃草APT组织大揭秘 - FreeBuf.COM | 关注黑客与极客</title>
<meta name="description" content="披露申明
本报告中出现的IOC（Indicators of Compromise，威胁指标），进一步包括涉及到相关攻击事件的样本文件MD5等哈希值、域名、IP、URL、邮箱等威胁情报信息，由于其相关信息的敏感性和特殊性，所以在本报告中…" />
<meta name="keywords" content="apt, 摩诃草, 安全报告, 安全管理应急方法,安全管理解决方案,安全管理知识大全" />
<meta name="baidu-site-verification" content="nKKKqQxp6R" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="renderer" content="webkit">
<meta property="qc:admins" content="6620477777662552566375" />
<link rel='stylesheet' id='wpfp-css' href='http://www.freebuf.com/buf/plugins/wp-favorite-posts/wpfp.css' type='text/css' />
<link rel='stylesheet' id='wp-recentcomments-css'  href='http://static.3001.net/css/recentcomments/wp-recentcomments.css?ver=2.2.3' type='text/css' media='screen' />
<link rel='stylesheet' id='mycred-widget-css'  href='http://www.freebuf.com/buf/plugins/gold/assets/css/widget.css?ver=1.3.2.1' type='text/css' media='all' />
<script type='text/javascript' src='http://static.3001.net/js/header/jquery.min.js?ver=3.6.1'></script>
<script type='text/javascript' src='http://www.freebuf.com/buf/plugins/wp-favorite-posts/wpfp.js?ver=3.6.1'></script>
<link rel='prev' title='广告商可以通过手机电量跟踪你' href='http://www.freebuf.com/news/111013.html' />
<link rel='next' title='开源的威胁情报收集器：OSTrICa' href='http://www.freebuf.com/sectool/111049.html' />
<link rel='canonical' href='http://www.freebuf.com/articles/security-management/111166.html' />
<link rel='shortlink' href='http://www.freebuf.com/?p=111166' />

<link rel="stylesheet" href="http://static.3001.net/css/highslide/highslide.css" type="text/css" />
<script type="text/javascript" src="http://static.3001.net/js/highslide/highslide-with-html.packed.js"></script>
<script type="text/javascript">
jQuery(document).ready(function($) {
    hs.graphicsDir = "http://www.freebuf.com/buf/plugins/auto-highslide/images/graphics/";
    hs.outlineType = "rounded-white";
    hs.dimmingOpacity = 0.8;
    hs.outlineWhileAnimating = true;
    hs.showCredits = false;
    hs.captionEval = "this.thumb.alt";
    hs.numberPosition = "caption";
    hs.align = "center";
    hs.transitions = ["expand", "crossfade"];
    hs.addSlideshow({
        interval: 5000,
        repeat: true,
        useControls: true,
        fixedControls: "fit",
        overlayOptions: {
            opacity: 0.75,
            position: "bottom center",
            hideOnMouseOut: true

        }

    });
});
</script>
          <script language="JavaScript" type="text/javascript" src="http://www.freebuf.com/buf/plugins/cartpauj-pm/js/script.js"></script>
      <link rel="stylesheet" type="text/css" href="http://www.freebuf.com/buf/plugins/cartpauj-pm/style/style.css" />
      <script type="text/javascript" src="http://www.freebuf.com/buf/plugins/simditor/highlight/highlight.pack.js"></script><link type="text/css" rel="stylesheet" href=" http://www.freebuf.com/buf/plugins/simditor/highlight/styles/default.css" />	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<link rel="shortcut icon" href="http://static.freebuf.com/images/favicon.ico" />
<link rel="stylesheet" href="http://static.3001.net/css/new/header.css" />
<link href="http://static.3001.net/css/new/bootstrap.min.css?ver=2016051701" rel="stylesheet" media="screen">
    <!--轮播图-->
    <link href="http://static.3001.net/css/new/swiper-3.4.2.min.css" rel="stylesheet" type="text/css">
    <link href="http://static.3001.net/css/new/style.css?ver=20170912568" rel="stylesheet" type="text/css">
    <style type="text/css">
#contenttxt hr {
  display: block;
  height: 0px;
  border: 0;
  border-top: 1px solid #ccc;
  margin: 15px 0;
  padding: 0;
}
#contenttxt table {
  width: 100%;
  table-layout: fixed;
  border-collapse: collapse;
  border-spacing: 0;
  margin: 15px 0;
}
#contenttxt table thead {
  background-color: #f9f9f9;
}
#contenttxt table td, #contenttxt table th {
  min-width: 40px;
  height: 30px;
  border: 1px solid #ccc;
  vertical-align: top;
  padding: 2px 4px;
  text-align: left;
  box-sizing: border-box;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
#contenttxt table td.active, #contenttxt table th.active {
  background-color: #ffffee;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
</style>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/jquery-2.0.3.min.js"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/bootstrap.min.js"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/slider.js?2016022501.1" type="text/javascript"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/jquery.sticky.js" type="text/javascript"></script>
<script src="http://static.3001.net/js/focus/bjqs-1.3.min.js" type="text/javascript" ></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/mosaic.1.0.1.min.js" type="text/javascript" ></script>
<script type="text/javascript" src="http://static.3001.net/js/new/setint.js"></script>
    <!--轮播图-->
    <script src="http://static.3001.net/js/colum/swiper-3.4.2.min.js"></script>
<!--[if lt IE 9]>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/html5shiv.min.js"></script>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/respond.min.js"></script>
<![endif]-->
    <style>
        @font-face {font-family: 'iconfont';
            src: url('http://static.3001.net/iconfont/iconfont.eot'); /* IE9*/
            src: url('http://static.3001.net/iconfont/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
            url('http://static.3001.net/iconfont/iconfont.woff') format('woff'), /* chrome、firefox */
            url('http://static.3001.net/iconfont/iconfonticonfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
            url('http://static.3001.net/iconfont/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
        }
    </style>
</head>

<body>
<!----------header---------->
<!--头部导航-->
<div id="undefined-sticky-wrapper" class="sticky-wrapper is-sticky">
    <div class="main-header">
        <div class="header">
            <div class="header-container clearfix">
                                <div class="header-logo"><a href="http://www.freebuf.com"></a></div>
                                        <!-- column -->
                        <div class="nav">
                            <ul class="nav-child clearfix">
                                <li class=" index">
                                    <a href="http://www.freebuf.com">首页</a></li>
                                <li data-value="read-menu">
                                    <a href="#">分类阅读<b class="triangle-down triangle-down-04"></b></a>
                                </li>
                                <li data-value="wenku-menu"><a href="javascript:;" target="_blank">文库<b class="triangle-down triangle-down-04"></b></a></li>
                                <li>
                                    <a href="http://zhuanlan.freebuf.com" target="_blank">专栏</a><b class="icon-betr"></b>
                                </li>
                                <li><a href="http://open.freebuf.com" target="_blank">公开课</a></li>
                                <li><a href="http://shop.freebuf.com" target="_blank">商城</a></li>
                                <li data-value="company-menu"><a href="javascript:;" >企业服务<b class="triangle-down triangle-down-04"></b></a></li>
                                <li data-value="user-menu"><a href="javascript:;" >用户服务<b class="triangle-down triangle-down-04"></b></a></li>
                            </ul>
                        </div>
                                        <div class="header-right">
                                    <div class="loginSign login-before">
                        <a href="https://account.tophant.com/register.html" class="login-btn">注册</a>
                        |
                        <a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a>
                    </div>
                                    <!--搜索-->
                    <div class="search-form-inner clearfix">
                        <i class="searchdisplayico"></i>
                        <div class="form-group has-active search-col search-form-text">
                            <form id="hpsform-new" class="navbar-search navbar-form" onsubmit="return dispatch();">
                                <div class="form-group">
                                    <input id="bigq" class="input form-control" type="text" placeholder="关键字查找" autocomplete="off" title="关键字查找" name="q">
                                    <button class="submit" type="submit"></button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <!--<script>
                        $('.search-form-inner .searchdisplayico').click(function(event) {
                            var evt = evt || event;
                            evt.stopPropagation();
                            $(this).siblings('.search-col').addClass('active');
                        });
                        $('.search-form-inner .search-col').click(function(event) {
                            var evt = evt || event;
                            evt.stopPropagation();
                            $('.search-form-inner .search-col').addClass('active');
                        });
                        $(document).click(function() {
                            $('.search-form-inner .search-col').removeClass('active');
                        });
                    </script>-->
                                    <div class="btn-publish">
                        <a href="#">投稿</a>
                        <div class="btn-publish-child">
                            <ul class="btn-child clearfix">
                                <li><a href="http://my.freebuf.com/post/edit/" target="_blank">文章撰写</a></li>
                                <li><hr/></li>
                                <li><a href="http://my.freebuf.com/post/article/" target="_blank">投稿管理</a></li>
                                                        </ul>
                        </div>
                    </div>
                </div>
                <div class="nav-small">
                    <a href="#">&#xe634;</a>
                    <ul class="nav-child clearfix">
                                                        <li class=" index">
                                    <a href="http://www.freebuf.com">首页</a></li>
                                <li class="read-classify">
                                    <a href="#">分类阅读<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2 read-classify clearfix">
                                        <li>
                                            <strong>黑客</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                                <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                                <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                                <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                                <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                                <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                                <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                                <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                                <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                                <a href="http://www.freebuf.com/articles/es" target="_blank">企业安全</a>
                                                <a href="http://www.freebuf.com/ics-articles" target="_blank">工控安全</a>
                                            </div>
                                        </li>
                                        <li>
                                            <strong>极客</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                                <a href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                                            </div>
                                        </li>
                                        <li>
                                            <strong>特色</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/news/special" target="_blank">头条</a>
                                                <a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a>
                                                <a href="http://www.freebuf.com/fevents" target="_blank">活动</a>
                                                <a href="http://www.freebuf.com/video" target="_blank">视频</a>
                                                <a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a>
                                                <a href="http://www.freebuf.com/jobs" target="_blank">招聘</a>
                                                <a href="http://www.freebuf.com/paper/" target="_blank">报告</a>
                                            </div>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="http://zhuanlan.freebuf.com/" target="_blank">专栏</a></li>
                                <li><a href="http://open.freebuf.com" target="_blank">公开课</a></li>
                                <li><a href="http://shop.freebuf.com" target="_blank">商城</a></li>
                                <li>
                                    <a href="javascript:;" target="_blank">企业服务<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="https://www.vulbox.com/bounties/item-9-0-1" target="_blank"><strong>企业SRC</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://company.freebuf.com" target="_blank"><strong>企业空间</strong></a>
                                        </li>
                                        <li>
                                            <a href="https://www.vulbox.com/" target="_blank"><strong>安全测试</strong></a>
                                        </li>
                                        <li>
                                            <a href="https://www.riskivy.com/" target="_blank"><strong>风险感知</strong></a>
                                        </li>

                                    </ul>
                                </li>
                                <li>
                                    <a href="javascript:;" target="_blank">用户服务<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="http://www.freebuf.com/newsend" target="_blank"><strong>有奖投稿</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://zhuanlan.freebuf.com" target="_blank">
                                        </li>
                                        <li>
                                            <a href="https://www.vulbox.com/bounties/detail-72" target="_blank"><strong>提交漏洞</strong></a>
                                        </li>
                                        <li class="last">
                                            <a href="https://www.vulbox.com/bounties" target="_blank"><strong>参与众测</strong></a>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="javascript:;" target="_blank">文库<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="http://www.freebuf.com/wenku" target="_blank"><strong>文库</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://www.freebuf.com/special-subject" target="_blank"><strong>专题</strong></a>
                                        </li>
                                    </ul>
                                </li>
                                                    <li><a href="http://my.freebuf.com/post/edit" target="_blank">投稿</a></li>
                                                    <li><a href="https://account.tophant.com/register.html" class="login-btn">注册</a>
                            </li>
                            <li><a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a></li>
                                            </ul>
                </div>
            </div>
            <div class="dropdown-menu read-menu" id="read-menu">
                <div class="container">
                    <ul class="menu clearfix">
                        <li>
                            <strong>黑客</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                <a href="http://www.freebuf.com/articles/es" target="_blank">企业安全</a>
                                <a class="last" href="http://www.freebuf.com/ics-articles" target="_blank">工控安全</a>
                            </div>
                        </li>
                        <li>
                            <strong>极客</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                <a class="last" href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                            </div>
                        </li>
                        <li>
                            <strong>特色</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/news/special" target="_blank">头条</a>
                                <a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a>
                                <a href="http://www.freebuf.com/fevents" target="_blank">活动</a>
                                <a href="http://www.freebuf.com/video" target="_blank">视频</a>
                                <a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a>
                                <a href="http://www.freebuf.com/jobs" target="_blank">招聘</a>
                                <a class="last" href="http://www.freebuf.com/paper/" target="_blank">报告</a>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="dropdown-menu company-menu" id="company-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="https://www.vulbox.com/bounties/item-9-0-1" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-src.png"></span>
                                <span class="name">企业SRC</span>
                                <span class="intro">全/半托管式互联网漏洞收集管理</span>
                            </a>
                        </li>
                        <li>
                            <a href="http://company.freebuf.com" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-company.png"></span>
                                <span class="name">企业空间</span>
                                <span class="intro">为企业定制信息安全专属门户</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.vulbox.com/" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-safety.png"></span>
                                <span class="name">安全测试</span>
                                <span class="intro">国内领先的互联网安全众测服务</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="https://www.riskivy.com/" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-risk.png"></span>
                                <span class="name">风险感知</span>
                                <span class="intro">基于IT资产的自动化安全监控</span>
                            </a>
                        </li>

                    </ul>
                </div>
            </div>
            <div class="dropdown-menu user-menu" id="user-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="http://www.freebuf.com/newsend" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-write.png"></span>
                                <span class="name">有奖投稿</span>
                                <span class="intro">与整个行业分享你的经验与见解</span>
                            </a>
                        </li>
                        <li>
                            <a href="http://zhuanlan.freebuf.com" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-column.png"></span>
                                <span class="name">申请专栏</span>
                                <span class="intro">自由创作，打造自主内容品牌</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.vulbox.com/bounties/detail-72" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-leak.png"></span>
                                <span class="name">提交漏洞</span>
                                <span class="intro">与数万白帽一起，让互联网更安全</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="https://www.vulbox.com/bounties" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-test.png"></span>
                                <span class="name">参与众测</span>
                                <span class="intro">挖洞开启自由职业之路</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="dropdown-menu wenku-menu" id="wenku-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="http://www.freebuf.com/wenku" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-write.png"></span>
                                <span class="name">文库</span>
                                <span class="intro">最全的FB百科</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="http://www.freebuf.com/special-subject" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-test.png"></span>
                                <span class="name">专题</span>
                                <span class="intro">浓缩的安全精华汇总</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!----------header end---------->
<!--<script type="application/javascript">
    var  _value_tab = '';
    $(function(){
        var _that = '', _show_flag = 0;
        $('.header .header-container .nav .nav-child > li:not(input[data-value])').mouseover(function() {
            $('.header .dropdown-menu').stop().slideUp(50);
        });
        $('.header').mouseout(function() {
            $('.header .dropdown-menu').stop().slideUp(50);
        });
        /*$('.header .header-container .nav .nav-child > li').mouseover(function() {
         _value_tab = $(this).attr('data-value');
         $('#'+_value_tab).siblings('.dropdown-menu').stop().slideUp(50);
         $('#'+_value_tab).stop().slideDown(100);
         });*/
        $(".header .header-container .nav .nav-child > li").hoverDelay({
            hoverDuring: 500,
            hoverEvent: function(){
                $('#'+_value_tab).siblings('.dropdown-menu').stop().slideUp(50);
                $('#'+_value_tab).stop().slideDown(100);
            }
        });
        $('.header .dropdown-menu').mouseover(function() {
            _value_tab = $(this).attr('id');
            _that = this;
            $('.nav-child li[data-value="'+_value_tab+'"]').addClass('hover');
            $(this).stop().slideDown(50);
        }).mouseout(function() {
            $('.nav-child li[data-value="'+_value_tab+'"]').removeClass('hover');
            $(_that).stop().slideUp(50);
        });

        $(".nav-small .nav-child > li").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();

            if($(this).find('.nav-child2').is(":hidden")) {
                _show_flag = 1;
                $(this).find('.nav-child2').slideDown();
                $(this).find('.icon-arrow').addClass('bottom');
            }else {
                _show_flag = 0;
                $(this).find('.nav-child2').slideUp();
                $(this).find('.icon-arrow').removeClass('bottom');
            }
            $(this).siblings().find('.nav-child2').slideUp();
            $(this).siblings().find('.icon-arrow').removeClass('bottom');
        });
        //头部投稿按钮hover状态展开菜单
        $(".btn-publish-child > ul > li").hover(function(){
            $(this).addClass("active");
            $(this).siblings().removeClass("active");
        });

        $(document).click(function(event){
            var ev = ev || event;
            $(".login-after").find(".login-after-child").hide();
        });
        //点击用户信息，出现下拉菜单
        $("#user-info").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();
            $(".login-after").find(".login-after-child").toggle();
        });
        //顶部导航
        $(".nav-small").click(function(){
            $(this).find(".nav-child").slideToggle();
        });
        var that = '';
        $('.header .header-container .nav .nav-child > li').mouseover(function() {
            that = this;
            $(this).find('.dropdown-menu').stop().slideDown(200);
        }).mouseout(function() {
            $(that).find('.dropdown-menu').stop().slideUp(200);
        });
    });
    $(".nav-small .nav-child > li").click(function(event){
        var ev = ev || event;
        ev.stopPropagation();
        $(this).siblings('li').find('.dropdown-menu').hide();
        $(this).find(".dropdown-menu").toggle();
    });
    //鼠标经过(hover)事件的延时处理
    (function($){
        $.fn.hoverDelay = function(options){
            var defaults = {
                hoverDuring: 100,
                outDuring: 100,
                hoverEvent: function(){
                    $.noop();
                },
                outEvent: function(){
                    $.noop();
                }
            };
            var sets = $.extend(defaults,options || {});
            var hoverTimer, outTimer;
            return $(this).each(function(){
                $(this).hover(function(){
                    _value_tab = $(this).attr('data-value');
                    clearTimeout(outTimer);
                    hoverTimer = setTimeout(sets.hoverEvent, sets.hoverDuring);
                },function(){
                    clearTimeout(hoverTimer);
                    outTimer = setTimeout(sets.outEvent, sets.outDuring);
                });
            });
        }
    })(jQuery);
</script>-->
<script type="text/javascript" src="http://static.3001.net/js/header/header.js"></script><script>
    jQuery(window).load(function(){
      if(jQuery(window).width()>480){
        jQuery(".main-header").sticky({ topSpacing: 0 });
      }else{
        jQuery(".main-header nav").removeClass("navbar-fixed-top");
      }
      jQuery("#mar-right").sticky({ topSpacing: 105,bottomSpacing: 410 });
    });
</script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/layer.js"></script>
<script type="text/javascript" src="http://static.3001.net/js/pretty/prettify.js"></script>
<script type="text/javascript" src="http://static.3001.net/js/header/lazyload.js"></script>
<script type="text/javascript" charset="utf-8">
      jQuery(function() {
          jQuery("img").lazyload({
              effect : "fadeIn"
          });
      });
 </script>
<script type="text/javascript">
    window.onload = function(){
        prettyPrint();
    }
</script>
<script language="JavaScript" type="text/javascript">
//<![CDATA[
var va = "您已经点亮过了";
function acv_vote(id,option, m){
  if( m==null) m =''; m = m + '';
  jQuery('#acv_stat_'+m+id).html('Loading...');
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option="+option+"&ID="+id;
  jQuery.get(url,function(d){
    d =d.split('|');var s='#acv_stat_'+m+d[0];
    var sele = '#cos_support-'+m+id,unsele = '#cos_unsupport-'+m+id,tpjs = 'javascript:alert(va)';
    jQuery( s ).html( d[1] );jQuery(s).fadeOut(400,function(){jQuery(s).fadeIn();});
    if( d[2] == 1 ){ jQuery(sele).html(jQuery(sele).html()*1+1); }
    if( d[2] == -1 ){ jQuery(unsele).html(jQuery(unsele).html()*1+1); }
    jQuery('#vote4-'+id).attr('href',tpjs);jQuery('#vote4-2'+id).attr('href',tpjs);
    jQuery('#votea-'+id).attr('href',tpjs);jQuery('#votea-2'+id).attr('href',tpjs);
  });
}
  
$(document).on("mouseenter",".comment-tools",function(){
  $(this).find(".btn-report").show();
  $(this).find(".btn-report").addClass("hover");
}).on("mouseleave",".comment-tools",function(){
  var $_this = $(this);
  $(this).find(".btn-report").removeClass("hover");
  if(!$(this).find(".dropup").hasClass('open')){
    $(this).find(".btn-report").hide(); 
    $_this.find(".dropdown-menu").css("display","none");
  }else{
    setTimeout(function(){
      if(!$_this.find(".btn-report").hasClass("hover")){
        $_this.find(".dropup").removeClass("open");
        $_this.find(".dropdown-menu").css("display","none");
        $_this.find(".btn-report").hide(); 
      }
    },"500");
  }
})

$(document).on("click",".click_report",function(){
  $(this).parent().parent().css("display","none");
  var id = $(this).attr("data-id");
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option=0&ID="+id;
  $_this = $(this);
  jQuery.get(url,function(d){
    d =d.split('|');
    if(d[1]=='您已经点过灯了'){
      d[1] = '您已经举报过了';
    }
    if(d[1]=='Thank you'){
      d[1] = '举报成功';
    }
    $_this.parent().parent().parent().find(".btn-report").text(d[1]);
    $_this.parent().parent().parent().find(".btn-report").css("display","block");
  })
})

$(document).on("click",".btn-report",function(){
  if($(this).parent().hasClass('open')){
    $(this).parent().find(".dropdown-menu").css("display","block");
  }else{
    $(this).parent().find(".dropdown-menu").css("display","none");
  }
})
//]]>
</script>
<div class="column-article" data-column="">
            <div class="container pad-top35">
        <div class="row clearfix">
            <div class="col-md-9" id="getWidth">
                                    <div class="reletive search-xs-wrap">
                    <div class="form-group has-active search-col search-xs">
                        <form id="hpsform-new" class="navbar-search navbar-form" onsubmit="return dispatch()">
                            <div class="form-group">
                                <input id="q" class="input form-control" type="text" placeholder="关键字查找" autocomplete="off" title="关键字查找" name="q">
                                <button class="submit" type="submit"></button>
                            </div>
                        </form>
                    </div>
                </div>
                    <script type="text/javascript">
                        var dispatch = function () {
                            console.log(123)
                            var q = document.getElementById("q");
                            if (q.value == "") {
                                q = document.getElementById("bigq");
                            }
                            if (q.value != "") {
                                window.open('http://www.freebuf.com/?s=' + q.value, "_blank");
                                return false;
                            } else {
                                return false;
                            }
                        }
                    </script>
                                <div class="article-wrap panel panel-default">
                                                            <div class="articlecontent">
                                                    <div class="title">
                                <h2>
                                    摩诃草APT组织大揭秘                                </h2>
                                <div class="property">
                                                                            <span class="name"><a href="http://www.freebuf.com/author/360%e5%ae%89%e5%85%a8%e5%8d%ab%e5%a3%ab" title="由 360安全卫士 发布" rel="author">360安全卫士</a></span>
                                                                        <span class="icon-f"><a href="http://www.freebuf.com/bufer" target="_blank"><img src="http://image.3001.net/images/index/f2.png" title="认证厂商"></a></span>
                                    <span class="time">2016-08-08</span>
                                                                                                            <span class="look">共<strong>337934</strong>人围观
                                        ，发现 <strong>12</strong> 个不明物体 </span>                                      </span>
                                                                <span class="tags">
                                      <a href="http://www.freebuf.com/./articles/paper">安全报告</a><a href="http://www.freebuf.com/./articles/security-management">安全管理</a></span>
                                    <span class="tags_01"></span>
                                </div>
                            </div>
                                                                                                <div id="contenttxt">
                            <h2>披露申明</h2>
<blockquote><p>本报告中出现的IOC（Indicators of Compromise，威胁指标），进一步包括涉及到相关攻击事件的样本文件MD5等哈希值、域名、IP、URL、邮箱等威胁情报信息，由于其相关信息的敏感性和特殊性，所以在本报告中暂不对外披露，在报告中呈现的相关内容（文字、图片等）均通过打码隐藏处理。</p>
</blockquote>
<p><span style="color: rgb(159, 163, 168);">*若您对本报告的内容感兴趣，需要了解报告相关细节或相关IOC，可与360追日团队通过电子邮件进行联系，另外我们目前只提供电子邮件联系方式：360zhuiri@360.cn，敬请谅解！</span></p>
<h2>一、	概述</h2>
<p>摩诃草组织（APT-C-09），又称HangOver、VICEROY TIGER、The Dropping Elephant、Patchwork，是一个来自于南亚地区的境外APT组织，该组织已持续活跃了7年。摩诃草组织最早由Norman安全公司于2013年曝光，随后又有其他安全厂商持续追踪并披露该组织的最新活动，但该组织并未由于相关攻击行动曝光而停止对相关目标的攻击，相反从2015年开始更加活跃。</p>
<p>摩诃草组织主要针对中国、巴基斯坦等亚洲地区国家进行网络间谍活动，其中以窃取敏感信息为主。相关攻击活动最早可以追溯到2009年11月，至今还非常活跃。在针对中国地区的攻击中，该组织主要针对政府机构、科研教育领域进行攻击，其中以科研教育领域为主。</p>
<p>从2009年至今，该组织针对不同国家和领域至少发动了3波攻击行动和1次疑似攻击行动。整个攻击过程使用了大量系统漏洞，其中至少包括一次0day漏洞攻击；该组织所采用的恶意代码非常繁杂。载荷投递的方式相对传统，主要是以鱼叉邮件进行恶意代码的传播，另外部分行动会采用少量水坑方式进行攻击；值得关注的是，在最近一次攻击行动中，出现了基于即时通讯工具和社交网络的恶意代码投递方式，进一步还会使用钓鱼网站进行社会工程学攻击。在攻击目标的选择上，该组织主要针对Windows系统进行攻击，同时我们也发现了存在针对Mac OS X系统的攻击，从2015年开始，甚至出现了针对Android OS移动设备的攻击。</p>
<p>由于对摩诃草组织的攻击行动不是第一次披露，通过针对相应TTPs（Tactics, Techniques and Procedures，战术、技术与步骤）的分析，结合以往跟进或披露的各类APT组织或攻击行动，我们认为大部分APT组织的相关攻击活动是不会停歇的，即使被某些报告暂时披露，导致过去的手段失效，但是只要被攻击目标存在价值，攻击组织的行动依然持续；存在部分情况，攻击已达到最初预期，攻击组织选择暂时的蛰伏，但最终的目的也都是为了下一次攻击养精蓄锐，这也是APT本身特性之一。其次，APT组织是否会对一个目标发动攻击，主要取决于被攻击目标的价值，而不在于被攻击目标本身的安全防护强弱程度，被攻击目标本身的强弱只是决定了攻击组织所需的成本，而大多数APT组织会为了达到其意图，几乎不计成本（具有国家背景的攻击组织所投入的攻击成本常常超出我们的想象）。</p>
<p>分析过去一年中发生的APT攻击，我们还发现中国一直都是APT攻击的主要受害国，其中相关攻击组织主要关注科研教育、政府机构领域，以窃取数据为目的。这和中国目前所处的经济与政治环境息息相关。同时，导致针对中国目标的攻击频频得手，除了被攻击目标本身防御措施薄弱以外，针对APT等高级威胁，被攻击目标本身缺乏积极主动的响应，即使在报告披露之后，甚至得知成为受害者之后，依然无法引起相应的重视，导致对自身检查和修复不足，常常旧伤未愈，又添新恨。</p>
<p>同时，中国网络安全行业依然缺乏能力型厂商的生存空间，大量的建设还是围绕过去的规划思路进行，这就导致了防护措施与高级威胁之间的脱节，从而给APT攻击造成了大量可乘之机。十三五规划的第一年，只有我们真正从安全规划上改变思路，积极引入能力型厂商，才能形成能力型安全厂商与客户之间的协同联动，打通监控发现到检测防御的事件响应各个环节，形成良性的闭合循环。</p>
<table>
<colgroup>
<col width="33.28540618260244%">
<col width="33.35729690869878%">
<col width="33.42918763479511%"></colgroup>
<thead>
<tr>
<th>  <b>公开时间</b>  </th>
<th>  <b>报告名称</b>  </th>
<th>  <b>公司</b>  </th>
</tr>
</thead>
<tbody>
<tr>
<td>  <b>2013</b><b>年5</b><b>月16</b><b>日</b>  </td>
<td>  OPERATION  HANGOVER-Unveiling an Indian Cyberattack Infrastructure</td>
<td>  Norman</td>
</tr>
<tr>
<td>  <b>2013</b><b>年5</b><b>月20</b><b>日</b>  </td>
<td>  Operation Hangover: Q&amp;A on Attacks</td>
<td>  Symantec  </td>
</tr>
<tr>
<td>  <b>2013</b><b>年5</b><b>月21</b><b>日</b>  </td>
<td>  Big Hangover  </td>
<td>  F-Secure  </td>
</tr>
<tr>
<td>  <b>2013</b><b>年6</b><b>月5</b><b>日</b>  </td>
<td>  Operation Hangover: more links to the  Oslo Freedom Forum incident</td>
<td>  ESET  </td>
</tr>
<tr>
<td>  <b>2013</b><b>年6</b><b>月7</b><b>日</b>  </td>
<td>  Rare Glimpse  into a Real-Life Command-and-Control Server</td>
<td>  Crowdstrike  </td>
</tr>
<tr>
<td>  <b>2013</b><b>年11</b><b>月5</b><b>日</b>  </td>
<td>  Microsoft Office Zeroday used to attack  Pakistani targets</td>
<td>  AlienVault  </td>
</tr>
<tr>
<td>  <b>2013</b><b>年11</b><b>月5</b><b>日</b>  </td>
<td>  CVE-2013-3906: a  graphics vulnerability exploited through Word documents</td>
<td>  Microsoft  </td>
</tr>
<tr>
<td>  <b>2013</b><b>年11</b><b>月6</b><b>日</b>  </td>
<td>  Updates and Mitigation to Microsoft  Office Zero-Day Threat (CVE-2013-3906)</td>
<td>  McAfee  </td>
</tr>
<tr>
<td>  <b>2013</b><b>年11</b><b>月6</b><b>日</b>  </td>
<td>  VICEROY TIGER  Delivers New Zero-Day Exploit</td>
<td>  Crowdstrike  </td>
</tr>
<tr>
<td>  <b>2013</b><b>年11</b><b>月7</b><b>日</b>  </td>
<td>  THE DUAL USE EXPLOIT: CVE-2013-3906 USED  IN BOTH TARGETED ATTACKS AND CRIMEWARE CAMPAIGNS<a href="file:///C:/Users/Woopoin/Downloads/%E6%91%A9%E8%AF%83%E8%8D%89%E7%BB%84%E7%BB%87-20160803%EF%BC%88%E6%89%93%E7%A0%81%EF%BC%89-%E6%9C%80%E7%BB%88%E7%89%88.docx#_ftn10"><span style="font-size: 10.5pt;">[</span></a></td>
<td>  FireEye  </td>
</tr>
<tr>
<td>  <b>2014</b><b>年6</b><b>月10</b><b>日</b>  </td>
<td>  Snake In The  Grass: Python-based Malware Used For Targeted Attacks</td>
<td>  Blue Coat  </td>
</tr>
<tr>
<td>  <b>2016</b><b>年7</b><b>月7</b><b>日</b>  </td>
<td>  Unveiling Patchwork</td>
<td>  Cymmetria  </td>
</tr>
<tr>
<td>  <b>2016</b><b>年</b><b>7</b><b>月</b><b>8</b><b>日</b>  </td>
<td>  The Dropping  Elephant – aggressive cyber-espionage in the Asian region</td>
<td>  Kaspersky  </td>
</tr>
<tr>
<td>  <b>2016</b><b>年7</b><b>月10</b><b>日</b>  </td>
<td>  白象的舞步——来自南亚次大陆的网络攻击</td>
<td>  安天  </td>
</tr>
<tr>
<td>  <b>2016</b><b>年7</b><b>月25</b><b>日</b>  </td>
<td>  Patchwork  cyberespionage group expands targets from governments to wide range of  industries</td>
<td>  Symantec  </td>
</tr>
</tbody>
</table>
<h2>二、	摩诃草组织的四次攻击行动</h2>
<p style="text-align: center;"><img alt="1.png" data-original="http://image.3001.net/images/20160805/14703635954977.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="310"></p>
<noscript><img alt="1.png" src="http://image.3001.net/images/20160805/14703635954977.png!small" width="690" height="310"></p></noscript>
<p style="text-align: center;">摩诃草组织相关重点事件时间轴</p>
<p><span style="color: rgb(239, 71, 71);">注：</span></p>
<p>1、	圆形蓝色里程碑：相关典型后门首次出现时间</p>
<p>2、	正方形里程碑：相关漏洞（CVE编号）首次出现时间</p>
<p>黑色：发起相关攻击时，漏洞为已知漏洞</p>
<p>橙色：发起相关攻击时，漏洞为0day漏洞</p>
<p>3、	菱形深灰色里程碑：载荷投递首次出现的时间</p>
<p style="text-align: center;"><img alt="2.png" data-original="http://image.3001.net/images/20160805/14703637251717.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="362"></p>
<noscript><img alt="2.png" src="http://image.3001.net/images/20160805/14703637251717.png!small" width="690" height="362"></p></noscript>
<p style="text-align: center;">四波攻击行动</p>
<p>第一次攻击行动：Norman安全公司于2013年曝光的Hangover组织，我们发现相关样本最早可以追溯到2009年11月，该组织在2012年尤为活跃，相关恶意代码和攻击目标的数量有不断增加。该攻击主要针对巴基斯坦，也有针对中国的攻击，但相关攻击事件较少。除了针对windows操作系统的攻击，在2012年针对Mac OS X操作系统的攻击也出现了。在第一次攻击行动中就已经开始利用漏洞进行攻击，但暂时没有发现该组织会利用0day漏洞。</p>
<p>第二次攻击行动：摩诃草组织在2013年10月下旬开始针对巴基斯坦的一次集中攻击，主要针对巴基斯坦情报机构或军事相关目标。本次攻击行动具有代表性的就是攻击中采用了一次利用0day漏洞（CVE-2013-3906）的攻击，该漏洞是针对微软Office产品，随后微软发布的漏洞预警指出该漏洞主要和TIFF图像解析有关。</p>
<p>第三次攻击行动：第二次小范围集中攻击之后，2013年12月底至2014年初，开始了新一轮攻击，相关目标主要还是针对巴基斯坦军事领域相关目标，本次攻击行动中除了C&amp;C服务器等从网络行为可以联系上第一次攻击行动以外，从恶意代码本身代码同源性已经很难关联到第一次攻击行动了。这主要是本次攻击行动中的恶意代码大部分是用Python编写的脚本，然后使用PyInstaller 和 Py2Exe两种方式进行打包。</p>
<p>第四次（疑似）攻击行动：本次攻击行动也安全厂商被称为“Patchwork”或“The Dropping Elephant”，从2015年初开始持续至今的攻击，其中从2015年8月开始至2016年6月攻击非常频繁。本次行动的攻击目标主要是中国地区，期间使用了大量文档型漏洞，以CVE-2014-4114使用最多。我们主要通过本次攻击行动中C&amp;C的SOA关联到第一次攻击行动中相关C&amp;C历史域名注册人，由于SOA本身可以被DNS管理者修改，所以存在被刻意修改的可能性，但从我们的分析推断来看这种可能性很低，另外结合相关行动意图和幕后组织的发起方，我们更倾向本次攻击行动属于摩诃草组织的最新一次攻击行动。在本报告后续章节的研究分析，会将本次攻击行动作为摩诃草组织的第四次攻击行动进行描述。</p>
<h2>三、	中国受影响情况</h2>
<p>本章主要基于摩诃草组织近期的第四次攻击行动，另外会涉及少量第三次攻击行动。进一步对相关攻击行动所针对目标涉及的地域和行业进行相关统计分析，时间范围选择2015年7月1日至2016年6月30日。</p>
<h3>1.	地域分布</h3>
<p style="text-align: center;"><img alt="3.jpg" data-original="http://image.3001.net/images/20160805/1470363867414.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="552" height="436"></p>
<noscript><img alt="3.jpg" src="http://image.3001.net/images/20160805/1470363867414.jpg!small" width="552" height="436"></p></noscript>
<p style="text-align: center;">国内用户受影响情况（2015年7月-2016年6月）</p>
<p>国内受影响量排名前三的省市是：北京、广东、福建，其中北京地区是主要攻击目标，在西藏、宁夏和贵州这三个省市自治区暂未发现受影响的用户。</p>
<p><span style="color: rgb(239, 71, 71);">注：本报告中用户数量主要指追日团队监控到的计算机终端的数量</span></p>
<h3>2.	行业分布</h3>
<p style="text-align: center;"><img alt="4.jpg" data-original="http://image.3001.net/images/20160805/14703639272163.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="461" height="384"></p>
<noscript><img alt="4.jpg" src="http://image.3001.net/images/20160805/14703639272163.jpg!small" width="461" height="384"></p></noscript>
<p style="text-align: center;">主要针对的行业分布</p>
<p>与第一次攻击行动类似，第四次攻击行动在针对中国的攻击中，科研教育领域依然是摩诃草组织重点针对的目标。</p>
<p>从第一次攻击行动开始军事领域一直是摩诃草组织关注的重点，期间主要是针对巴基斯坦地区，很少针对中国地区，但从2015年第三方和第四次攻击行动的开始，这一趋势逐渐改变，针对中国地区的军事领域的相关攻击不断增加。</p>
<h2>四、	载荷投递</h2>
<p>关于针对中国的APT攻击中常使用的载荷投递方式，和主流的载荷投递方式的介绍，我们在《2015年中国高级持续性威胁（APT）研究报告》 第四章中也详细介绍，读者可以结合参看相关报告。</p>
<h3>1.	鱼叉邮件</h3>
<p style="text-align: center;"><img alt="5.jpg" data-original="http://image.3001.net/images/20160805/14703639875677.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="610" height="250"></p>
<noscript><img alt="5.jpg" src="http://image.3001.net/images/20160805/14703639875677.jpg!small" width="610" height="250"></p></noscript>
<p style="text-align: center;">鱼叉邮件主要的类型</p>
<p><span style="color: rgb(239, 71, 71);">注：上图中斜体字内容是摩诃草组织较少或从未使用的方式。</span></p>
<p><b>携带恶意附件</b></p>
<p>摩诃草组织最常用的是携带二进制格式的可执行恶意程序，相关恶意可执行程序多为“.exe”和“.scr”扩展名。恶意代码文件图标一般为伪装文档、图片图片，进一步一般这类可执行程序均进行压缩，以压缩包形态发送。压缩包和包内恶意代码文件名一般是针对目标进行精心构造的文件名，相关文件名一般与邮件主题、正文内容和恶意代码释放出的诱饵文档内容相符。</p>
<p>另外还频繁使用文档型漏洞，文档型漏洞文件主要作为邮件附件进行针对性投放。相关文档漏洞主要是针对微软Office系列，主要采用已知漏洞进行攻击，另外也使用过0day漏洞。关于摩诃草组织所使用的漏洞我们在之后章节会有详细介绍。</p>
<p><b>恶意网址</b></p>
<p>一般APT攻击中鱼叉邮件使用恶意网址（或恶意URL）相比携带恶意附件还是少很多。但是在摩诃草组织的第四次攻击行动中则为主流的方法。</p>
<p>通常恶意网址会出现在邮件正文中（以超链接或非超链接形态出现），或邮件附件内容中。后面这种情况较少，一般都是在正文中出现。恶意网址最终指向的页面一般分为几种</p>
<p>：钓鱼页面、漏洞页面（浏览器漏洞、文档漏洞）和二进制可执行程序。钓鱼页面指的是不包含最终指向二进制可执行程序的恶意代码（基本为脚本），一般是通过伪造的页面信息，诱导目标将相关敏感信息（用户名、密码等）通过页面窃取。</p>
<p>在摩诃草组织发动的攻击行动中主要是恶意网址以超链接形态存在与邮件正文中，最终是指向一个文档型漏洞文件，相关文档型漏洞文件被放置在钓鱼网站（攻击者依照目标所关注的网站，进行伪造的恶意网站）。攻击者采用这种载荷投递的方式，可以有效地绕过以检测邮件附件为主的防御体系。</p>
<h3>2.	即时通讯工具</h3>
<p>在APT攻击中利用即时通讯工具进行载荷投递的情况比较少，主要是由于基于即时通讯工具的攻击成本远大于使用邮件。关于使用邮件和即时通讯工具，我们进行了一个对比，具体如下表所示：</p>
<p style="text-align: center;"><img alt="6.jpg" data-original="http://image.3001.net/images/20160805/14703640738130.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="188"></p>
<noscript><img alt="6.jpg" src="http://image.3001.net/images/20160805/14703640738130.jpg!small" width="690" height="188"></p></noscript>
<p style="text-align: center;">邮件和即时通讯工具相关对比</p>
<p>首先邮件一般是以办公为主，而即时通讯工具（如：QQ，之后涉及到相关都以QQ为例）除了企业级产品，其他以个人用户为主的产品通常都是以个人用途为主。</p>
<p>从上表中“获得目标联系方式难度”这项来看，电子邮箱地址，尤其是对外办公联系的地址一般都会公布在互联网上，而QQ号码，尤其是以个人名义的QQ号码很少会公布。进一步攻击者已经获得目标QQ号，在“投放实施难度”，需要攻击者具备这些条件：首先，在侦查跟踪环节已经对目标积累了一定的了解，包括目标基本信息、关注的领域、兴趣爱好等；之后，就是需要与目标建立起联系，一般是攻击者主动添加目标QQ号，或者是被动等待目标添加，无论是主动还是被动方式建立联系，都需要大量社会工程学与目标之间进行交互。虽然成本较高，但一旦与目标之间建立起联系，并且取得目标的信任，则之后攻击的成功率会较高，而且时效性高。</p>
<p>基于部分客户反馈提供的相关攻击信息，我们发现摩诃草组织在第四次攻击行动中，从2015年8月底持续到2016年6月，大量使用即时通讯工具（主要是腾讯的QQ聊天工具）向目标发送木马文件和文档型漏洞文件。其中主要以发送二进制可执行程序为主，这类程序主要伪造成MP4格式的视频文件，下表示相关恶意文件的文件名：</p>
<p style="text-align: center;"></p>
<p style="text-align: center;">部分诱饵文件名称（伪装MP4视频文件）</p>
<p>我们发现同一个恶意诱饵文件还会针对不同的目标进行多次投放，进一步我们也观测到同一目标在短期内也会被不同的木马连续攻击，如下图所示，所使用的木马类型都属于同类不同的变种，我们推测出现这种情况是由于攻击者对目标失去控制权限后，进一步重新获得权限，这也能看出目标的重要程度。</p>
<p style="text-align: center;"><img alt="8.jpg" data-original="http://image.3001.net/images/20160805/14703641753019.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="116"></p>
<noscript><img alt="8.jpg" src="http://image.3001.net/images/20160805/14703641753019.jpg!small" width="690" height="116"></p></noscript>
<p style="text-align: center;">针对同一目标的三次攻击（基于即时通讯工具）</p>
<h3>3.	社交网络</h3>
<p>本月初我们披露了一起名为人面狮（APT-C-15） 的攻击行动，此次行动是活跃在中东地区的网络间谍活动。期间我们介绍了利用社交网络（Facebook）进行水坑攻击的事例。利用社交网络进行载荷投递的攻击方式并不常见，在摩诃草组织的攻击行动中也采用了类似方式。从2015年3月开始我们就陆续观察到利用社交网络（国内某社交网站）进行载荷投递，但其频次是远低于利用鱼叉邮件和即时通讯工具。下图是攻击者所关注的两个目标页面。</p>
<p style="text-align: center;"><img alt="9.jpg" data-original="http://image.3001.net/images/20160805/14703642846786.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="428"></p>
<noscript><img alt="9.jpg" src="http://image.3001.net/images/20160805/14703642846786.jpg!small" width="690" height="428"></p></noscript>
<p style="text-align: center;">目标社交网络帐号页面1</p>
<p style="text-align: center;"><img alt="10.jpg" data-original="http://image.3001.net/images/20160805/14703643143369.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="444"></p>
<noscript><img alt="10.jpg" src="http://image.3001.net/images/20160805/14703643143369.jpg!small" width="690" height="444"></p></noscript>
<p style="text-align: center;">目标社交网络帐号页面2</p>
<p>利用社交网络进行载荷投递一般是分为：SNS蠕虫、放置二进制格式可执行恶意程序或文档型漏洞文件，利用SNS蠕虫比较少见，主要是需要依赖第三方社交网络平台自身漏洞，这对攻击成本有较高要求。最常见的就是放置二进制可执行程序或文档型漏洞文件，一般是放置文件或恶意链接地址，具体投递可能会直接给目标用户留言、发信息等，或者放置到目标所关注的其他社交账号的页面上，后者就是人面狮基于Facebook进行水坑攻击的方式。</p>
<h3>4.	水坑攻击</h3>
<p>APT攻击中主流的水坑攻击主要分为以下两种：</p>
<p>第一种：被攻击目标关注A网站，攻击者将A网站攻陷，并植入恶意代码（一般为漏洞脚本文件，俗称挂马），当目标访问被攻陷的A网站并浏览相关页面时，当目标环境相关应用触发漏洞则有可能被植入恶意代码。</p>
<p>第二种：被攻击目标关注A网站，攻击者将A网站攻陷，并将A网站上一些可信应用或链接替换为攻击者所持有的恶意下载链接，当目标访问被攻陷的A网站并将恶意下载链接的文件下载并执行，则被植入恶意代码。这种攻击的典型案例是2014年公开Havex木马 ，也被称作蜻蜓（Dragonfly）和活力熊（Energetic Bear）和我们在2015年5月末发布的海莲花（OceanLotus）APT组织 。</p>
<p>这两种水坑攻击的共性是攻击者需要获得被攻击目标所关注网站的修改权限。在摩诃草组织的相关攻击行动中，几乎很少采用以上者两种“标准”的水坑攻击。期间类似水坑攻击，如鱼叉邮件正文中嵌入恶意网址（钓鱼网站）或基于社交网络的攻击。</p>
<p>另外在Norman安全公司于2013年曝光的Hangover报告中，披露的利用Internet Explorer漏洞（CVE-2012-4792）和Java漏洞（CVE-2012-0422），这两个漏洞主要出现在水坑攻击中。</p>
<h2>五、	钓鱼网站</h2>
<h3>1.	攻击描述</h3>
<p>摩诃草组织除了对目标用户进行基于二进制可执行程序的攻击以外，还会对目标用户进行传统的钓鱼网站攻击。</p>
<p>钓鱼网站一般伪装成网易邮箱网站，诱骗用户在钓鱼页面输入用户名和密码，来达到窃取目标用户账号信息的目的。这种方法没有利用一般的二进制木马或漏洞程序，而是完全通过社会工程学的方法进行攻击。</p>
<p>相关钓鱼网站还是通过载荷投递中的鱼叉邮件（恶意网址）、即时通讯工具、社交网络等方法进行定向传播。</p>
<p style="text-align: center;"><img alt="11.jpg" data-original="http://image.3001.net/images/20160805/14703645381171.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="103"></p>
<noscript><img alt="11.jpg" src="http://image.3001.net/images/20160805/14703645381171.jpg!small" width="690" height="103"></p></noscript>
<p style="text-align: center;">相关钓鱼网站列表</p>
<p>攻击者对网易邮箱网站页面进行了完全的拷贝复制，以此来达到以假乱真，最终只是在登录验证的环节进行了替换，将原有地址替换为指向攻击者所持有的这个IP：**.***.**.242。</p>
<p style="text-align: center;"><img alt="12.jpg" data-original="http://image.3001.net/images/20160805/14703646206190.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="194"></p>
<noscript><img alt="12.jpg" src="http://image.3001.net/images/20160805/14703646206190.jpg!small" width="690" height="194"></p></noscript>
<p style="text-align: center;">钓鱼网站回传目标用户账号信息源码</p>
<h3>2.	典型案例</h3>
<p>案例1：*******web.com</p>
<p style="text-align: center;"><img alt="13.jpg" data-original="http://image.3001.net/images/20160805/14703646863614.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="423"></p>
<noscript><img alt="13.jpg" src="http://image.3001.net/images/20160805/14703646863614.jpg!small" width="690" height="423"></p></noscript>
<p style="text-align: center;"><span style="font-size: 10.5pt;">钓鱼页面</span><span style="font-size: 10.5pt;">1</span></p>
<p style="text-align: center;"><span style="font-size: 10.5pt;"><img alt="14.jpg" data-original="http://image.3001.net/images/20160805/14703646964384.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="212"><br /></span></p>
<noscript><img alt="14.jpg" src="http://image.3001.net/images/20160805/14703646964384.jpg!small" width="690" height="212"><br /></span></p></noscript>
<p style="text-align: center;">钓鱼页面1（源码）</p>
<p>案例2：*******ina.info</p>
<p style="text-align: center;"><span style="font-size: 10.5pt;"><img alt="15.jpg" data-original="http://image.3001.net/images/20160805/14703652426519.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="392"><br /></span></p>
<noscript><img alt="15.jpg" src="http://image.3001.net/images/20160805/14703652426519.jpg!small" width="690" height="392"><br /></span></p></noscript>
<p style="text-align: center;"><span style="font-size: 10.5pt;">钓鱼页面2<br /></span></p>
<p style="text-align: center;"><span style="font-size: 10.5pt;"><img alt="16.jpg" data-original="http://image.3001.net/images/20160805/14703652873816.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="181"><br /></span></p>
<noscript><img alt="16.jpg" src="http://image.3001.net/images/20160805/14703652873816.jpg!small" width="690" height="181"><br /></span></p></noscript>
<p style="text-align: center;">钓鱼页面2（源码）</p>
<h2>六、	漏洞利用</h2>
<h3>1.	0day漏洞（CVE-2013-3906）</h3>
<p><b>背景</b></p>
<p>在第二次攻击行动中，针对巴基斯坦的攻击摩诃草组织使用了该漏洞，该漏洞在当时还是0day漏洞，从捕获的攻击事件来看最早使用该漏洞是在2013年10月23日，直到11月5日才有相关安全机构发布研究报告，微软给出安全公告。这也直接证明了该组织是具备持有0day漏洞的能力。该漏洞在其他APT组织中也使用广泛，如APT-C-05、APT-C-06、APT-C-17 等组织都使用过该漏洞，但使用时已经不是0day了。</p>
<p style="text-align: center;"><span style="font-size: 10.5pt;"><img alt="17.jpg" data-original="http://image.3001.net/images/20160805/14703653571710.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="260"><br /></span></p>
<noscript><img alt="17.jpg" src="http://image.3001.net/images/20160805/14703653571710.jpg!small" width="690" height="260"><br /></span></p></noscript>
<p style="text-align: center;">漏洞相关基本信息</p>
<p><b>分析</b></p>
<p>CVE-2013-3906是ogl.dll模块中在处理TIFF文件时存在一个整数溢出漏洞，精心构造数据会导致代码分配一块大小为0的内存，却像其中写入0&#215;1484大小的数据，最终导致覆盖堆中对象虚表，结合ActiveX控件进行堆喷射攻击，完成最终利用。</p>
<p style="text-align: center;"><span style="font-size: 10.5pt;"><img alt="18.jpg" data-original="http://image.3001.net/images/20160805/14703654111890.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="681" height="100"><br /></span></p>
<noscript><img alt="18.jpg" src="http://image.3001.net/images/20160805/14703654111890.jpg!small" width="681" height="100"><br /></span></p></noscript>
<p style="text-align: center;"><span style="font-size: 10.5pt;">往大小为0的堆拷贝数据<br /></span></p>
<p style="text-align: center;"><span style="font-size: 10.5pt;"><br /></span></p>
<p style="text-align: center;"><span style="font-size: 10.5pt;">调用栈<br /></span></p>
<p style="text-align: center;"><span style="font-size: 10.5pt;"><img alt="20.jpg" data-original="http://image.3001.net/images/20160805/14703654614385.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="631" height="131"><br /></span></p>
<noscript><img alt="20.jpg" src="http://image.3001.net/images/20160805/14703654614385.jpg!small" width="631" height="131"><br /></span></p></noscript>
<p style="text-align: center;"><span style="font-size: 10.5pt;">拷贝源数据<br /></span></p>
<p style="text-align: center;"><span style="font-size: 10.5pt;"><img alt="21.jpg" data-original="http://image.3001.net/images/20160805/14703654838300.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="601" height="279"><br /></span></p>
<noscript><img alt="21.jpg" src="http://image.3001.net/images/20160805/14703654838300.jpg!small" width="601" height="279"><br /></span></p></noscript>
<p style="text-align: center;">拷贝源数据对于样本中的内容</p>
<p style="text-align: center;"><img alt="22.jpg" data-original="http://image.3001.net/images/20160805/1470365530819.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="369"></p>
<noscript><img alt="22.jpg" src="http://image.3001.net/images/20160805/1470365530819.jpg!small" width="690" height="369"></p></noscript>
<p style="text-align: center;">拷贝目的地堆内存大小为0</p>
<p style="text-align: center;"><img alt="23.jpg" data-original="http://image.3001.net/images/20160805/14703655663184.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="368"></p>
<noscript><img alt="23.jpg" src="http://image.3001.net/images/20160805/14703655663184.jpg!small" width="690" height="368"></p></noscript>
<p style="text-align: center;">拷贝源数据堆内存大小0&#215;1484</p>
<h3>2.	已知漏洞</h3>
<p>摩诃草组织发动的每次攻击行动中都会频繁的使用漏洞进行攻击，其中大多数情况还是使用已知漏洞（或称1day或Nday漏洞），也就是受影响厂商已经知道相关漏洞并发布更新补丁或者新版本产品代替。</p>
<p>在相关攻击行动中，该组织更倾向使用文档型漏洞，这往往需要和载荷投递方式进行配合。另外也会涉及到浏览器等适合水坑攻击的漏洞，我们在“第四章载荷投递”中就曾提及Internet Explorer漏洞（CVE-2012-4792）和Java漏洞（CVE-2012-0422）这两个漏洞的利用。</p>
<p>以文档型漏洞为主</p>
<p>下表是相关文档型漏洞列表，主要针对Microsoft Word和PowerPoint。其中以CVE-2014-4114在第四次攻击行动中使用最为频繁。</p>
<p style="text-align: center;"></p>
<p style="text-align: center;">相关漏洞列表</p>
<p><b>CVE-2014-4114</b></p>
<p>背景</p>
<p>CVE-2014-4114漏洞是iSIGHT公司 在2014年10月14日发布相关报告，报告其中提到一个0day漏洞（CVE-2014-4114）用于俄罗斯相关主要针对北约、欧盟、电信和能源相关领域的网络间谍活动。微软也是在10月14日发布相关安全公告。</p>
<p>而CVE-2014-6352是可以认为绕过CVE-2014-4114补丁的漏洞，微软之前的修补方案首先在生成Inf和exe文件后添加MakeFileUnsafe调用，来设置文件Zone信息，这样随后在漏洞执行inf安装时，会有一个安全提示。而CVE-2014-6352漏洞样本抛弃了使用inf来安装exe，转而直接执行exe。因为xp以上系统可执行文件的右键菜单第二项是以管理员权限执行，这样导致如果用户关闭了uac会导致没有任何安全提醒。所以微软6352的补丁是在调用右键菜单添加一个安全提示弹窗。</p>
<table>
<colgroup>
<col width="49.96405463695183%">
<col width="50.035945363048164%"></colgroup>
<thead>
<tr>
<th>  <b>漏洞编号</b>  </th>
<th>  <b>CVE-2014-4114</b>  </th>
</tr>
</thead>
<tbody>
<tr>
<td>  <b>说明</b>  </td>
<td>  Windows OLE 中存在一个漏洞，如果用户打开包含特制 OLE 对象的文件，则该漏洞可能允许远程执行代码。成功利用此漏洞的攻击者可以获得与登录用户相同的用户权限。如果当前用户使用管理用户权限登录，则攻击者可随后安装程序；查看、更改或删除数据；或者创建拥有完全用户权限的新帐户。那些帐户被配置为拥有较少用户权限的用户比具有管理用户权限的用户受到的影响要小。  </td>
</tr>
<tr>
<td>  <b>公布时间</b>  </td>
<td>  2014年10月14日  </td>
</tr>
<tr>
<td>  <b>参考链接</b>  </td>
<td>  <span style="color: rgb(51, 51, 51);"><a href="https://technet.microsoft.com/zh-cn/library/security/ms14-060.aspx">https://technet.microsoft.com/zh-cn/library/security/ms14-060.aspx</a>  <br /><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-4114">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-4114</a>  </span></td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col width="49.96405463695183%">
<col width="50.035945363048164%"></colgroup>
<thead>
<tr>
<th>  <b>漏洞编号</b>  </th>
<th>  <b>CVE-2014-6352</b>  </th>
</tr>
</thead>
<tbody>
<tr>
<td>  <b>说明</b>  </td>
<td>  在用户下载或接收，然后打开经特殊设计的包含 OLE 对象的 Microsoft  Office 文件时，会导致当前用户上下文中的远程执行代码漏洞。Microsoft 最初通过协调漏洞披露渠道了解到有关此漏洞的信息。此漏洞最初在 Microsoft 安全通报 3010060 中进行了说明。Microsoft 获悉尝试使用此漏洞的有限攻击。此更新通过修改在访问 OLE 对象时受影响的操作系统验证内存使用的方式来解决这些漏洞。  </td>
</tr>
<tr>
<td>  <b>公布时间</b>  </td>
<td>  2014年10月21日  </td>
</tr>
<tr>
<td>  <b>参考链接</b>  </td>
<td>  <span style="color: rgb(51, 51, 51);"><a href="https://technet.microsoft.com/zh-cn/library/security/3010060.aspx">https://technet.microsoft.com/zh-cn/library/security/3010060.aspx</a>  <br /><a href="https://technet.microsoft.com/zh-cn/library/security/ms14-064.aspx">https://technet.microsoft.com/zh-cn/library/security/ms14-064.aspx</a>  <br /><a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6352">http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6352</a>  </span></td>
</tr>
</tbody>
</table>
<p>分析</p>
<p>由于之前CVE-2014-4114和CVE-2014-6352主要内嵌在Microsoft Office 2007（open xml）格式文档中使用。</p>
<p>Open Xml通过xml描述文档构造，通过zip打包在一起，导致安全分析人员很容易提取出样本中的恶意数据。本次样本（**************************df4715）使用了传统的office03（复合文档格式）文件格式，并且通过构造特殊zlib数据来躲避多数安全软件扫描和分析人员分析。</p>
<p>传统的CVE-2014-4114样本分析只需要使用zip解压Microsoft Office 2007文档后，查看\ppt\embeddings\目录下内嵌文件即可知道样本行为。</p>
<p style="text-align: center;"><img alt="25.jpg" data-original="http://image.3001.net/images/20160805/14703658263971.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="431" height="124"></p>
<noscript><img alt="25.jpg" src="http://image.3001.net/images/20160805/14703658263971.jpg!small" width="431" height="124"></p></noscript>
<p style="text-align: center;">Microsoft Office 2007样本内嵌恶意文件</p>
<p>而Microsoft Office 2003格式无法直接解压缩，并且原来embeddings目录下的文件会被zlib压缩后以ExternalObjectStorage 结构保存在PowerPoint Document流中。</p>
<p>通常我们解析到ExOleObjStgCompressedAtom结构，调用zlib解压其中数据即可得到原始的内嵌文件，而此样本利用Office容错能力嵌入了没有zlib头的zlib流导致大部分分析工具解压识别，如我们使用oletools解析提示无效压缩头。</p>
<p style="text-align: center;"><img alt="26.jpg" data-original="http://image.3001.net/images/20160805/14703658622033.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="243"></p>
<noscript><img alt="26.jpg" src="http://image.3001.net/images/20160805/14703658622033.jpg!small" width="690" height="243"></p></noscript>
<p style="text-align: center;">Oletools解压pps内嵌zlib数据失败</p>
<p style="text-align: center;"><img alt="1.png" data-original="http://image.3001.net/images/20160805/14703659121874.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="588" height="105"></p>
<noscript><img alt="1.png" src="http://image.3001.net/images/20160805/14703659121874.png!small" width="588" height="105"></p></noscript>
<p style="text-align: center;">恶意样本内嵌的zlib流</p>
<p>修正解压问题后，最终拿到了内嵌文件，利用inf给内嵌的pe写启动达到最终目的。</p>
<p style="text-align: center;"><img alt="2.png" data-original="http://image.3001.net/images/20160805/14703659412642.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="560"></p>
<noscript><img alt="2.png" src="http://image.3001.net/images/20160805/14703659412642.png!small" width="690" height="560"></p></noscript>
<p style="text-align: center;">恶意样本内嵌的Inf文件</p>
<p style="text-align: center;"><img alt="3.png" data-original="http://image.3001.net/images/20160805/14703659648368.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="574" height="378"></p>
<noscript><img alt="3.png" src="http://image.3001.net/images/20160805/14703659648368.png!small" width="574" height="378"></p></noscript>
<p style="text-align: center;">恶意样本内嵌的PE文件</p>
<h3>3.	诱饵文件</h3>
<p>诱饵文件主要分为文档、图片和视频，其中主要是文档类，进一步相关内容主要涉及到政治、军事等，另外还有一些色情相关内容。</p>
<p><b>视频类</b></p>
<p style="text-align: center;"><img alt="4.png" data-original="http://image.3001.net/images/20160805/14703660297758.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="142"></p>
<noscript><img alt="4.png" src="http://image.3001.net/images/20160805/14703660297758.png!small" width="690" height="142"></p></noscript>
<p>视频类恶意文件图标</p>
<p>伪装视频类文件的攻击主要出现在基于即时通讯工具的这种载荷投递的方式中。其他方式中很少见。</p>
<p><b>图片类</b></p>
<p style="text-align: center;"><b><img alt="5.png" data-original="http://image.3001.net/images/20160805/14703661044428.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="991"><br /></b></p>
<noscript><img alt="5.png" src="http://image.3001.net/images/20160805/14703661044428.png!small" width="690" height="991"><br /></b></p></noscript>
<p style="text-align: center;">诱饵图片</p>
<p><b>文档类</b></p>
<p>Word相关</p>
<p style="text-align: center;"><img alt="6.png" data-original="http://image.3001.net/images/20160805/14703661612998.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="634"></p>
<noscript><img alt="6.png" src="http://image.3001.net/images/20160805/14703661612998.png!small" width="690" height="634"></p></noscript>
<p style="text-align: center;">诱饵文档1（CVE-2015-1641）</p>
<p style="text-align: center;"><img alt="7.png" data-original="http://image.3001.net/images/20160805/14703661893619.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="476"></p>
<noscript><img alt="7.png" src="http://image.3001.net/images/20160805/14703661893619.png!small" width="690" height="476"></p></noscript>
<p style="text-align: center;">诱饵文档2（CVE-2012-0158）</p>
<p style="text-align: center;"><img alt="8.png" data-original="http://image.3001.net/images/20160805/14703662198543.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="366"></p>
<noscript><img alt="8.png" src="http://image.3001.net/images/20160805/14703662198543.png!small" width="690" height="366"></p></noscript>
<p style="text-align: center;">诱饵文档3（CVE-2014-1761）</p>
<p><b>PowerPoint相关</b></p>
<p style="text-align: center;"></p>
<p style="text-align: center;">诱饵文档4（CVE-2014-4114）</p>
<p><b>PDF类</b></p>
<p style="text-align: center;"><b><img alt="10.png" data-original="http://image.3001.net/images/20160805/14703662891015.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="608"><br /></b></p>
<noscript><img alt="10.png" src="http://image.3001.net/images/20160805/14703662891015.png!small" width="690" height="608"><br /></b></p></noscript>
<p style="text-align: center;">诱饵文档6（PDF）</p>
<h2>七、	后门分析</h2>
<p>摩诃草组织第一次攻击行动中，针对Windows系统安装植入环节的恶意代码主要分为两大类：Smackdown下载者和HangOver（或HangOve）后门。Smackdown下载者主要在第一阶段实施，可能是由一个自称“Yash”或“Yashu”的人开发编写，HangOver后门主要应用在第二阶段，主要作用是窃取敏感信息，其中以窃取指定文件扩展名的文件为主。</p>
<p style="text-align: center;"><img alt="11.png" data-original="http://image.3001.net/images/20160805/14703663482141.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="76"></p>
<noscript><img alt="11.png" src="http://image.3001.net/images/20160805/14703663482141.png!small" width="690" height="76"></p></noscript>
<p style="text-align: center;">相关文件扩展名1（windows）</p>
<p>另外，在第一次攻击行动中，就已经发现存在针对Mac OS X系统的攻击了，家族名称为OSX.Kumar，其主要功能还是窃取敏感数据信息，和HangOver后门目的类似。</p>
<p>从第三次攻击行动开始到第四次攻击行动，相关恶意代码发生了较大的变化，其中出现了由Python、AutoIt、Go语言等开发的恶意代码，在本章节我们会有详细的介绍。</p>
<p>摩诃草组织主要针对PC（Windows、Mac OS X）进行攻击，我们在2015年发现该组织开始针对移动设备（Android系统）进行攻击，由于相关样本信息的特殊性，本报告中暂不对Android版本的恶意代码展开分析介绍。</p>
<h3>1.	Mac OS X</h3>
<p><b>功能简介</b></p>
<p><span style="color: rgb(239, 71, 71);">Trojan.Spy.OSX.Kumar.A</span></p>
<p>添加自身为开机自启动，恶意代码在FileBackup.ini中保存了一些变量信息，例如文件后缀名列表，搜索磁盘下为下列后缀名的文档，压缩成zip文档后基于HTTP协议上传。</p>
<p style="text-align: center;"><img alt="12.png" data-original="http://image.3001.net/images/20160805/14703664833668.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="51"></p>
<noscript><img alt="12.png" src="http://image.3001.net/images/20160805/14703664833668.png!small" width="690" height="51"></p></noscript>
<p style="text-align: center;">相关文件扩展名2（Mac OS X）</p>
<p>该家族中各个样本程序代码大致，不同点在于上传的URL不同，如下表所示：</p>
<p style="text-align: center;"><img alt="13.png" data-original="http://image.3001.net/images/20160805/14703665272299.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="100"></p>
<noscript><img alt="13.png" src="http://image.3001.net/images/20160805/14703665272299.png!small" width="690" height="100"></p></noscript>
<p style="text-align: center;">相关URL列表</p>
<p><span style="color: rgb(239, 71, 71);">Trojan.Spy.OSX.Kumar.B</span></p>
<p>首先将自己复制到“/Users/%username%/%bundlename%.app”目录下，执行“/bin/sh -c open -a /Users/%username%/%bundlename%.app”，通过修改“/Users/%username%/Library/Preferences/com.apple.loginitems.plist”实现开机自启动。每20s获取屏幕截图保存在“$HOME/MacApp”中，命名规则为yy-MM-dd-HH:mm:ss.png，通过HTTP上传到远程服务器。</p>
<p style="text-align: center;"><img alt="14.png" data-original="http://image.3001.net/images/20160805/14703665813567.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="330"></p>
<noscript><img alt="14.png" src="http://image.3001.net/images/20160805/14703665813567.png!small" width="690" height="330"></p></noscript>
<p style="text-align: center;">样本证书时间戳和其他样本信息</p>
<p><b>OSX.Kumar变种之间的关联</b></p>
<p>OSX.Kumar.A和OSX.Kumar.B的作者签名信息相同：“Developer ID Application：Rajinder Kumar”，两者部分代码相同，如下图所示：</p>
<p style="text-align: center;"><img alt="15.png" data-original="http://image.3001.net/images/20160805/14703666274000.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="211"></p>
<noscript><img alt="15.png" src="http://image.3001.net/images/20160805/14703666274000.png!small" width="690" height="211"></p></noscript>
<p style="text-align: center;">代码对比图</p>
<p style="text-align: center;"><img alt="16.png" data-original="http://image.3001.net/images/20160805/14703666877159.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="78"></p>
<noscript><img alt="16.png" src="http://image.3001.net/images/20160805/14703666877159.png!small" width="690" height="78"></p></noscript>
<p style="text-align: center;">两个版本恶意代码共用C&amp;C</p>
<p>从上表也可以看出两者之间存在共用C&amp;C服务器的情况，据上述分析我们认为相关恶意代码应该为同一作者所开发，只是两者在功能上不同，OSX.Kumar.A是上传文件，OSX.Kumar.B获取屏幕信息。</p>
<h3>2.	Python版本</h3>
<p><b>概述</b></p>
<p style="text-align: center;"><img alt="17.png" data-original="http://image.3001.net/images/20160805/14703667616767.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="375"></p>
<noscript><img alt="17.png" src="http://image.3001.net/images/20160805/14703667616767.png!small" width="690" height="375"></p></noscript>
<p style="text-align: center;">功能流程图</p>
<p>样本文件大多伪装成“pps、doc、pub、pdf、jpg”等类型的文件诱导用户点击，样本程序大多是自解压文件点击后在打开正常文件的同时可以释放并运行恶意程序。恶意的文件主要用python编写的脚本然后使用PyInstaller 和 Py2Exe两种方式进行打包。</p>
<p style="text-align: center;"><img alt="18.png" data-original="http://image.3001.net/images/20160805/14703668095563.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="131"></p>
<noscript><img alt="18.png" src="http://image.3001.net/images/20160805/14703668095563.png!small" width="690" height="131"></p></noscript>
<p style="text-align: center;">自解压样本1</p>
<p><b>功能介绍</b></p>
<p>Python相关的exe文件主要通过PyInstaller和 Py2Exe两种打包方式将python脚本打包成exe程序的,每一个打包成的exe都是一个功能模块，主要功能有三类，此外还有一个非python的程序。</p>
<p><span style="color: rgb(239, 71, 71);">模块A（CxsSvce.exe,send.exe）</span></p>
<p>调用系统工具systeminfo.exe检测虚拟机，上传指定目录下的文件到服务器，从服务器下载文件并执行</p>
<p style="text-align: center;"><img alt="19.png" data-original="http://image.3001.net/images/20160805/1470366855346.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="253"></p>
<noscript><img alt="19.png" src="http://image.3001.net/images/20160805/1470366855346.png!small" width="690" height="253"></p></noscript>
<p style="text-align: center;">相关代码截图1（模块A）</p>
<p><span style="color: rgb(239, 71, 71);">模块B（reg.exe，reg1.exe）</span></p>
<p>这个模块并不是python的而是用MINGW32 C++编写的，主要功能就是修改注册表添加启动项。</p>
<p style="text-align: center;"><img alt="20.png" data-original="http://image.3001.net/images/20160805/14703668844218.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="275"></p>
<noscript><img alt="20.png" src="http://image.3001.net/images/20160805/14703668844218.png!small" width="690" height="275"></p></noscript>
<p style="text-align: center;">相关代码截图2（模块B）</p>
<p><span style="color: rgb(239, 71, 71);">模块C（winrm.exe，stisvc.exe）</span></p>
<p>主要功能就是偷窃文件，格式主要有：“doc, xls, ppt, pps, inp, pdf, xlsx, docx, pptx”</p>
<p style="text-align: center;"><img alt="21.png" data-original="http://image.3001.net/images/20160805/14703669196620.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="293"></p>
<noscript><img alt="21.png" src="http://image.3001.net/images/20160805/14703669196620.png!small" width="690" height="293"></p></noscript>
<p style="text-align: center;">相关代码截图3（模块C）</p>
<p><span style="color: rgb(239, 71, 71);">模块D（sppsvc.exe，key.exe）</span></p>
<p>这是一个以键盘记录器，hook了键盘和鼠标时间，记录键盘操作到日志文件中。</p>
<p style="text-align: center;"><img alt="22.png" data-original="http://image.3001.net/images/20160805/14703669557751.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="304"></p>
<noscript><img alt="22.png" src="http://image.3001.net/images/20160805/14703669557751.png!small" width="690" height="304"></p></noscript>
<p style="text-align: center;">相关代码截图4（模块D）</p>
<h3>3.	2016 AutoIT（Indetectables RAT）</h3>
<p><b>执行流程</b></p>
<p style="text-align: center;"><img alt="23.png" data-original="http://image.3001.net/images/20160805/14703712086445.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="602" height="684"></p>
<noscript><img alt="23.png" src="http://image.3001.net/images/20160805/14703712086445.png!small" width="602" height="684"></p></noscript>
<p style="text-align: center;">2016 AutoIT执行流程</p>
<p><b>基于第三方已公开方法</b></p>
<p style="text-align: center;"><img alt="24.png" data-original="http://image.3001.net/images/20160805/1470371235273.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="566" height="552"></p>
<noscript><img alt="24.png" src="http://image.3001.net/images/20160805/1470371235273.png!small" width="566" height="552"></p></noscript>
<p style="text-align: center;">基于第三方已公开工具、源码等</p>
<p style="text-align: center;"><img alt="25.png" data-original="http://image.3001.net/images/20160805/14703713615303.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="363"></p>
<noscript><img alt="25.png" src="http://image.3001.net/images/20160805/14703713615303.png!small" width="690" height="363"></p></noscript>
<p style="text-align: center;">相关第三方已公开工具、源码参考链接</p>
<p style="text-align: center;"><img alt="25.png" data-original="http://image.3001.net/images/20160805/14703713837184.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="363"></p>
<noscript><img alt="25.png" src="http://image.3001.net/images/20160805/14703713837184.png!small" width="690" height="363"></p></noscript>
<p style="text-align: center;">相关第三方已公开工具、源码参考链接</p>
<p><b>具体功能分析</b></p>
<p>恶意代码使用AutoIt脚本编译成的exe来执行功能，其中核心代码抄袭自一款叫Indetectables RAT的远程控制软件。</p>
<p>	主要的库函数全部来自引用，程序使用了现成的AutoIt库函数来直接组织程序功能。</p>
<p style="text-align: center;"><img alt="26.png" data-original="http://image.3001.net/images/20160805/1470371476249.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="687" height="451"></p>
<noscript><img alt="26.png" src="http://image.3001.net/images/20160805/1470371476249.png!small" width="687" height="451"></p></noscript>
<p style="text-align: center;">库函数引用表</p>
<p>程序主要过程中的功能通过使用上述库函数实现，其中部分函数抄袭自Indetectables RAT</p>
<p style="text-align: center;"><img alt="27.png" data-original="http://image.3001.net/images/20160805/14703715748101.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="618"></p>
<noscript><img alt="27.png" src="http://image.3001.net/images/20160805/14703715748101.png!small" width="690" height="618"></p></noscript>
<p style="text-align: center;">功能函数表</p>
<p style="text-align: center;"><img alt="28.png" data-original="http://image.3001.net/images/20160805/14703716067938.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="669" height="108"></p>
<noscript><img alt="28.png" src="http://image.3001.net/images/20160805/14703716067938.png!small" width="669" height="108"></p></noscript>
<p style="text-align: center;">C&amp;C功能说明</p>
<h3>4.	Go语言</h3>
<p>样本使用GO语言编写，功能为从C&amp;C下载SHELLCODE，解密后为PE，在内存中加载并执行。C&amp;C地址为***.***.***.172，端口为8443。</p>
<p>每次下载的内容不相同，但是解密后的PE相同，解密时的大小有错误，需要patch后才能继续执行。但是进入OEP依然有错误，代码为0且不可执行。</p>
<h3>5.	FakeJLI</h3>
<p><b>基本信息</b></p>
<p>FakeJLI是第四次攻击行动中近期很活跃的一个家族，通过样本时间戳来看在2016年6月已经出现。</p>
<p>当初始样本被点击打开以后，首先会释放各种组件到%temp%目录，然后触发CVE-2014-4114漏洞，将释放在%temp%目录的组件之一的sysvolinfo.exe文件运行起来，sysvolinfo.exe该文件名曾多次在AutoIt样本中出现。</p>
<p>通过分析sysvolinfo.exe是用IExpress打包成的自解压安装程序（类似于NSIS），通过解包在%temp%目录下释放MICROS~1.EXE，jij.dll及Msvcr71.dll三个文件。其中Msvcrt71.dll为正常文件，为VC7.0运行库，之后执行MICROS~1.EXE，安装包的标题信息为merged1234。</p>
<p style="text-align: center;"><img alt="29.png" data-original="http://image.3001.net/images/20160805/14703716669197.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="101"></p>
<noscript><img alt="29.png" src="http://image.3001.net/images/20160805/14703716669197.png!small" width="690" height="101"></p></noscript>
<p style="text-align: center;">相关基本信息</p>
<p><b>行为隐藏和安全检测绕过</b></p>
<p style="text-align: center;"></p>
<p style="text-align: center;">MICROS~1.EXE签名信息</p>
<p>MICROS~1.EXE是Java的一个组件，带有正常的签名信息。Jil.dll 是真正的恶意程序，Micros~1.EXE默认会加载这两个动态库。MICROS~.EXE在main函数中会直接调用jil.dll的导出函数JLI_MemAlloc()，而没有经过任何的校验，从而导致恶意代码被执行起来。Msvcrt71.dll为正常文件，为VC7.0运行库，释放它的目的是为了使样本能正常运行。</p>
<p style="text-align: center;"><img alt="31.png" data-original="http://image.3001.net/images/20160805/14703717536804.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="155"></p>
<noscript><img alt="31.png" src="http://image.3001.net/images/20160805/14703717536804.png!small" width="690" height="155"></p></noscript>
<p style="text-align: center;">jij.dll中所有的导出函数都被重定向到了恶意代码开始的地方</p>
<p>MICROS~1.EXE 是正常的带签名Java组件，原本其调用的Jli.dll原本也应该是正常的Java组件，现在被替换成带毒的Dll（导出函数名不变，但是函数是病毒函数），即通过带签名的可信程序去加载伪装成正常组件的病毒Dll，也算是一种Dll劫持。利用这种方法可以绕过杀软的主动防策略，从而可以执行真正恶意代码，是一种比较常见的绕过现有病毒查杀体系的方法。</p>
<p><b>具体功能分析</b></p>
<p><span style="color: rgb(239, 71, 71);">功能简述</span></p>
<blockquote><p>隐藏掉自身的窗口以防止被察觉到。</p>
<p>设置自身为自启动。</p>
<p>载入其他模块，并动态加载，或者创建子进程。</p>
<p>当有U盘插入的时候遍历目录，搜索各种文档（主要包括：“pdf、doc、docx、ppt、pptx、txt”），并写入文件，上传到远程服务器。</p>
<p>连接跳板链接获取真正C&amp;C地址。</p>
<p>与远程C&amp;C服务器通信接收执行命令，收集各种信息，包括：用户名、电脑名用户、样本版本信息等上传。</p>
<p>反弹Shell，执行命令。</p>
</blockquote>
<p><span style="color: rgb(239, 71, 71);">C&amp;C地址的获取</span></p>
<p>恶意代码在获取C&amp;C地址的时候，方法比较特殊，相关C&amp;C地址并未预留在恶意代码本身，而是存放在第三方可信网站中。</p>
<p>进一步主要是两种方式：</p>
<blockquote><p>基于第三方论坛博客：攻击者会选择在论坛回复发帖留言，将C&amp;C地址预留在帖子内容中，进一步通过不断修改已发帖的内容来达到更改C&amp;C信息的目的。</p>
<p>入侵可信网站：攻击者事先会将正常可信网站攻陷后，将相关C&amp;C地址预留在指定页面。</p>
</blockquote>
<p style="text-align: center;"><img alt="32.png" data-original="http://image.3001.net/images/20160805/14703718853984.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="108"></p>
<noscript><img alt="32.png" src="http://image.3001.net/images/20160805/14703718853984.png!small" width="690" height="108"></p></noscript>
<p style="text-align: center;">回复帖中预留的相关C&amp;C地址信息</p>
<p>解密后相关真实C&amp;C地址如下：</p>
</p>
<pre><code>hxxp://***.***.***.173/yumhong/ghsnls.php</code></pre>
</p>
<p>另外关于本小节的内容，在本报告的“C&amp;C分析”章节会有进一步详细描述，具体请参看相关章节内容。</p>
<h2>八、	C&amp;C分析</h2>
<h3>1.	Whois隐私保护</h3>
<p>Whois隐私保护是指域名注册服务商为域名注册者提供的一种服务，即域名WHOIS信息会隐藏域名注册者的真实信息，如电子邮件地址、电话号码等，一般这种服务为收费有偿服务。</p>
<p>在APT攻击中，相关组织非常喜欢采用whois隐私保护这种方式来隐藏自己的真实身份，安全研究机构或人员很难找到相关线索信息进行关联回溯。下图是我们就第一次攻击行动和第四次攻击行动中是否采用whois隐私保护进行的统计分析。</p>
<p style="text-align: center;"><img alt="33.png" data-original="http://image.3001.net/images/20160805/14703719764038.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="687" height="344"></p>
<noscript><img alt="33.png" src="http://image.3001.net/images/20160805/14703719764038.png!small" width="687" height="344"></p></noscript>
<p style="text-align: center;">左图（第一次攻击）、右图（第四次攻击）</p>
<p>上图分别是两次攻击行动中C&amp;C域名的保护情况（目前的状态，如果相关域名现在被sinkhole状态，则以历史存在whois隐私保护来计算），整体来看第四次攻击行动基本都采用了whois隐私保护，大部分从域名注册后的第二天就开始进行whois隐私保护。而第一次攻击行动中，尤其是2011年初期注册的域名，很多是未进行whois隐私保护，如下表所示，在2011年未进行保护，在2012年就开始进行whois隐私保护来进行弥补。</p>
<p style="text-align: center;"><img alt="34.png" data-original="http://image.3001.net/images/20160805/14703720928905.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="675" height="372"></p>
<noscript><img alt="34.png" src="http://image.3001.net/images/20160805/14703720928905.png!small" width="675" height="372"></p></noscript>
<p style="text-align: center;">第一次攻击行动相关C&amp;C信息（WHOIS信息）</p>
<h3>2.	域名注册时间分布</h3>
<p style="text-align: center;"><img alt="35.png" data-original="http://image.3001.net/images/20160805/14703721505539.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="244"></p>
<noscript><img alt="35.png" src="http://image.3001.net/images/20160805/14703721505539.png!small" width="690" height="244"></p></noscript>
<p style="text-align: center;">左图（第一次攻击）、右图（第四次攻击）</p>
<p>上图分别是两次攻击行动中C&amp;C域名注册时间的分布情况，第一次攻击行动主要分布在2011和2012年，相关攻击活跃的时间主要是2012年，而在第四次攻击中主要是2014和2015年，其相关攻击主要活跃的时间是2015年和2016年。</p>
<p>由此也可以推断在最新第四次攻击中，摩诃草组织有计划的提前半年到一年左右就将相关域名资源规划好了。</p>
<h3>3.	C&amp;C对应IP地理位置分布</h3>
<p style="text-align: center;"><img alt="36.png" data-original="http://image.3001.net/images/20160805/14703724434274.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="379"></p>
<noscript><img alt="36.png" src="http://image.3001.net/images/20160805/14703724434274.png!small" width="690" height="379"></p></noscript>
<p style="text-align: center;">（第一次攻击）、右图（第四次攻击）</p>
<p>可以看出第一次攻击行动和第四次攻击行动所使用的IP地理位置还是有很多共性的。排除第一次行动中的英国和第四次攻击中的德国，其使用比例比较接近。</p>
<h3>4.	基于第三方可信网站中转</h3>
<p><b>概述</b></p>
<p>在“后门分析”章节中我们对FakeJLI家族进行了分析，并发现了其他特殊的获取C&amp;C地址的方式。</p>
<p>进一步主要是两种方式：</p>
<blockquote><p>基于第三方论坛博客：攻击者会选择在论坛回复发帖留言，将C&amp;C地址预留在帖子内容中，进一步通过不断修改已发帖的内容来达到更改C&amp;C信息的目的。</p>
<p>入侵可信网站：攻击者事先会将正常可信网站攻陷后，将相关C&amp;C地址预留在指定页面。</p>
</blockquote>
<p style="text-align: center;"><img alt="37.png" data-original="http://image.3001.net/images/20160805/14703725385827.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="213"></p>
<noscript><img alt="37.png" src="http://image.3001.net/images/20160805/14703725385827.png!small" width="690" height="213"></p></noscript>
<p style="text-align: center;">相关被利用第三方可信网站链接</p>
<p>恶意代码首先会从论坛帖子中寻找相关C&amp;C地址，如果没有则会尝试从被入侵网站中寻找相关C&amp;C地址。被作为中转的论坛都是国内大型论坛，攻击者通过回复正常提问帖子来隐藏C&amp; C信息。</p>
<p><b>相关案例</b></p>
<p><span style="color: rgb(239, 71, 71);">某大型论坛1</span></p>
<p style="text-align: center;"><img alt="38.png" data-original="http://image.3001.net/images/20160805/14703725879532.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="649" height="452"></p>
<noscript><img alt="38.png" src="http://image.3001.net/images/20160805/14703725879532.png!small" width="649" height="452"></p></noscript>
<p style="text-align: center;">某大型论坛1相关用户信息</p>
<p style="text-align: center;"><img alt="1.jpg" data-original="http://image.3001.net/images/20160805/14703726573732.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="85"></p>
<noscript><img alt="1.jpg" src="http://image.3001.net/images/20160805/14703726573732.jpg!small" width="690" height="85"></p></noscript>
<p style="text-align: center;">相关回帖信息</p>
<p>如上图所示，该域名信息在3月20日发布，最近的一次修改是4月6号，可知作者通过修改帖子来不断更新C&amp;C信息。</p>
<p><span style="color: rgb(239, 71, 71);">某大型论坛2</span></p>
<p style="text-align: center;"><img alt="1.png" data-original="http://image.3001.net/images/20160805/1470372715218.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="281"></p>
<noscript><img alt="1.png" src="http://image.3001.net/images/20160805/1470372715218.png!small" width="690" height="281"></p></noscript>
<p style="text-align: center;">某大型论坛2相关用户信息</p>
<p style="text-align: center;"><img alt="2.png" data-original="http://image.3001.net/images/20160805/14703727405149.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="315"></p>
<noscript><img alt="2.png" src="http://image.3001.net/images/20160805/14703727405149.png!small" width="690" height="315"></p></noscript>
<p style="text-align: center;">相关回帖信息</p>
<p>C&amp;C信息同样是3月19发布，4月6号修改。另外攻击者在论坛中提及发邮件给了*********ch@163.com，不知道是否对相关邮箱进行了攻击。</p>
<p><span style="color: rgb(239, 71, 71);">某大型论坛3</span></p>
<p style="text-align: center;"><img alt="3.png" data-original="http://image.3001.net/images/20160805/1470372839905.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="434"></p>
<noscript><img alt="3.png" src="http://image.3001.net/images/20160805/1470372839905.png!small" width="690" height="434"></p></noscript>
<p style="text-align: center;">某大型论坛3相关用户信息</p>
<p style="text-align: center;"><img alt="4.png" data-original="http://image.3001.net/images/20160805/14703728663813.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="108"></p>
<noscript><img alt="4.png" src="http://image.3001.net/images/20160805/14703728663813.png!small" width="690" height="108"></p></noscript>
<p style="text-align: center;">相关回帖信息</p>
<p>用户注册日期是3月14日，最近回复也是3月14日。</p>
<h2>九、	关联分析</h2>
<p>本章主要就摩诃草组织的四次攻击行动之间的联系进行关联分析，进一步主要从相关攻击中所使用的恶意代码、C&amp;C服务器等技术层面的分析。</p>
<p>从这四次行动的攻击意图和背景分析来看，应该都是来自于同一国家，且攻击目标基本一致。</p>
<h3>1.	第一次攻击行动中Windows和Mac OS X</h3>
<p><b>共用C&amp;C</b></p>
<p style="text-align: center;"><img alt="5.png" data-original="http://image.3001.net/images/20160805/14703729344420.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="686" height="110"></p>
<noscript><img alt="5.png" src="http://image.3001.net/images/20160805/14703729344420.png!small" width="686" height="110"></p></noscript>
<p style="text-align: center;">OSX.Kumar.A基本信息</p>
<p style="text-align: center;"><img alt="6.png" data-original="http://image.3001.net/images/20160805/14703729611249.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="254"></p>
<noscript><img alt="6.png" src="http://image.3001.net/images/20160805/14703729611249.png!small" width="690" height="254"></p></noscript>
<p style="text-align: center;">OSX.Kumar.A样本代码截图（C&amp;C地址）</p>
<p style="text-align: center;"><img alt="7.png" data-original="http://image.3001.net/images/20160805/14703729979539.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="675" height="136"></p>
<noscript><img alt="7.png" src="http://image.3001.net/images/20160805/14703729979539.png!small" width="675" height="136"></p></noscript>
<p style="text-align: center;">Hangover样本基本信息</p>
<p style="text-align: center;"><img alt="8.png" data-original="http://image.3001.net/images/20160805/14703730281899.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="635" height="350"></p>
<noscript><img alt="8.png" src="http://image.3001.net/images/20160805/14703730281899.png!small" width="635" height="350"></p></noscript>
<p style="text-align: center;">Hangover样本代码截图（C&amp;C地址）</p>
<p><b>特殊字符串</b></p>
<p>对比OSX.Kumar.A样本和已知Hangover样本的分析结果，可以看出*********zone.net是共用C&amp;C。进一步OSX.Kumar.A请求的URL如下：</p>
<pre><code>*********one.net/yash/upload.php</code></pre>
<p>另外我们可以看到Kumar样本请求的URL中的目录名称和Hangover样本PDB路径中的用户名相同。相关部分PDB路径如下表所示：</p>
<p style="text-align: center;"><img alt="9.png" data-original="http://image.3001.net/images/20160805/14703731291795.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="148"></p>
<noscript><img alt="9.png" src="http://image.3001.net/images/20160805/14703731291795.png!small" width="690" height="148"></p></noscript>
<p style="text-align: center;">Hangover相关样本PDB路径</p>
<h3>2.	第一次和第二次攻击行动</h3>
<p style="text-align: center;"><img alt="10.png" data-original="http://image.3001.net/images/20160805/14703732743730.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="288"></p>
<noscript><img alt="10.png" src="http://image.3001.net/images/20160805/14703732743730.png!small" width="690" height="288"></p></noscript>
<p style="text-align: center;">相关样本基本信息</p>
<p>从上表是第一次和第二次攻击行动相关样本的基本信息，从编译时间、C&amp;C，以及URL形态暂时看不出有较强的关联。</p>
<p style="text-align: center;"><img alt="11.png" data-original="http://image.3001.net/images/20160805/14703733213161.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="638" height="308"></p>
<noscript><img alt="11.png" src="http://image.3001.net/images/20160805/14703733213161.png!small" width="638" height="308"></p></noscript>
<p style="text-align: center;">两者之间相同信息</p>
<p>上表是两次攻击行动中样本的相同信息，其中User-Agent都是“WinInetGet/0.1”，进一步两者都属于downloader，作用为通过HTTP连接C&amp;C，下载payload并执行，然后将执行结果通过res参数上报C&amp;C，成功为sucessfully（拼写错误），失败为failed。下表示两者之间网络函数的差别。</p>
<p style="text-align: center;"></p>
<p style="text-align: center;">两者之间网络函数的区别</p>
<h3>3.	第一次和第三次攻击行动</h3>
<p><b>共用C&amp;C</b></p>
<p>第一次和第三次攻击行动中的后门程序都使用了相同的C&amp;C服务器，如下：</p>
<p style="text-align: center;"><img alt="13.png" data-original="http://image.3001.net/images/20160805/14703734363702.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="71"></p>
<noscript><img alt="13.png" src="http://image.3001.net/images/20160805/14703734363702.png!small" width="690" height="71"></p></noscript>
<p style="text-align: center;">共用的C&amp;C列表</p>
<p><b>相似的通信控制</b></p>
<p>第三次攻击行动中也有部分AutoIT恶意程序，AutoIT恶意程序请求的HTTP是“<a href="http://server/folder/online.php?sysname=">http://server/folder/online.php?sysname=</a>”，这个格式（dfiles5 = urlopen(&#8220;http://&#8221;+ getserver + foldername+ &#8220;/online.php?sysname=&#8221;+cname+&#8221;")）在Hangover攻击案例中的被多次用到，所以说两者的网络构建是关联的，进一步用于控制恶意程序的后端构架也是一样的。</p>
<h3>4.	第一次和第四次攻击行动</h3>
<p><b>相同的邮箱地址</b></p>
<p style="text-align: center;"><img alt="14.png" data-original="http://image.3001.net/images/20160805/14703878774933.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="689" height="270"></p>
<noscript><img alt="14.png" src="http://image.3001.net/images/20160805/14703878774933.png!small" width="689" height="270"></p></noscript>
<p style="text-align: center;">第四次攻击行动相关C&amp;C信息（SOA信息）</p>
<p>对照上表和下表的内容，我们可以看到第四次攻击中C&amp;C SOA的管理者邮箱地址与第一次攻击中C&amp;C的域名注册邮箱一致，都是“*********24@gmail.com”，上表中所有C&amp;C从注册第二天开始就采用whois隐私保护，从下表我们也能推测出攻击者基本是在2012年注意到域名注册邮箱会暴露相关信息，而统一更换为whois隐私保护策略，但由于有相关历史WHOIS记录，所以我们还是发现了相关蛛丝马迹。</p>
<p>但由于SOA的内容是可以由DNS管理者自行修改，所以也不排除攻击组织刻意修改为虚假邮箱地址等信息来达到混淆视听的目的。</p>
<p style="text-align: center;"><img alt="15.png" data-original="http://image.3001.net/images/20160805/1470387958388.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="374"></p>
<noscript><img alt="15.png" src="http://image.3001.net/images/20160805/1470387958388.png!small" width="690" height="374"></p></noscript>
<p style="text-align: center;">第一次攻击行动相关C&amp;C信息（WHOIS信息）</p>
<p><b>C&amp;C指向同一IP</b></p>
<p style="text-align: center;"><img alt="16.png" data-original="http://image.3001.net/images/20160805/14703880128189.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="107"></p>
<noscript><img alt="16.png" src="http://image.3001.net/images/20160805/14703880128189.png!small" width="690" height="107"></p></noscript>
<h2>十、	幕后组织</h2>
<h3>1.	归属分析</h3>
<p><b>PDB路径</b></p>
<p><span style="color: rgb(239, 71, 71);">第一次攻击行动</span></p>
<p>Hangover中OSX.Kumar.A样本请求的URL是“hxxp://******one.net/yash/upload.php”，其中“yash”在针对windows平台的其他样本中的PDB中也出现过。</p>
<p style="text-align: center;"><img alt="17.png" data-original="http://image.3001.net/images/20160805/14703881241152.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="150"></p>
<noscript><img alt="17.png" src="http://image.3001.net/images/20160805/14703881241152.png!small" width="690" height="150"></p></noscript>
<p style="text-align: center;">Hangover相关样本PDB路径</p>
<p><span style="color: rgb(239, 71, 71);">第四次攻击行动</span></p>
<p style="text-align: center;"><span style="color: rgb(239, 71, 71);"><img alt="18.png" data-original="http://image.3001.net/images/20160805/14703882486691.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="129"><br /></span></p>
<noscript><img alt="18.png" src="http://image.3001.net/images/20160805/14703882486691.png!small" width="690" height="129"><br /></span></p></noscript>
<p style="text-align: center;">基础信息</p>
<p>Kanishk是来自北印度语单词，意味着“守护之神毗湿奴的媒介”，一般作为男孩的名字，相关示例如下表（名+姓）。</p>
<p style="text-align: center;"><span style="color: rgb(239, 71, 71);"><img alt="19.png" data-original="http://image.3001.net/images/20160805/14703883168168.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="97"><br /></span></p>
<noscript><img alt="19.png" src="http://image.3001.net/images/20160805/14703883168168.png!small" width="690" height="97"><br /></span></p></noscript>
<p style="text-align: center;">相关姓名示例</p>
<p>另外Kanishk类似Kaniska，Kanishka。</p>
<p style="text-align: center;"><img alt="20.png" data-original="http://image.3001.net/images/20160805/14703884598015.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="340"></p>
<noscript><img alt="20.png" src="http://image.3001.net/images/20160805/14703884598015.png!small" width="690" height="340"></p></noscript>
<p style="text-align: center;">Kaniska维基百科</p>
<p style="text-align: center;"><img alt="21.png" data-original="http://image.3001.net/images/20160805/14703885195841.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="127"></p>
<noscript><img alt="21.png" src="http://image.3001.net/images/20160805/14703885195841.png!small" width="690" height="127"></p></noscript>
<p style="text-align: center;">相关基础信息</p>
<p><b>OSX.Kumar开发者信息</b></p>
<p>可以看到OSX.kumar家族中的苹果开发者信息是名为：Rajinder Kuma</p>
<p style="text-align: center;"><img alt="22.png" data-original="http://image.3001.net/images/20160805/14703885909435.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="290"></p>
<noscript><img alt="22.png" src="http://image.3001.net/images/20160805/14703885909435.png!small" width="690" height="290"></p></noscript>
<p style="text-align: center;">OSX.Kumar.B开发者相关信息</p>
<p><b>恶意代码时间戳</b></p>
<p>通过第一次和第四次攻击行动中样本时间戳统计来看，首先相关结果基本接近。</p>
<p>我们假设攻击者是职业组织，即与一般政府、工商等上班时间类似，则相关工作时间趋向于UTC+5 时区。</p>
<p style="text-align: center;"><img alt="23.png" data-original="http://image.3001.net/images/20160805/14703886289919.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="416"></p>
<noscript><img alt="23.png" src="http://image.3001.net/images/20160805/14703886289919.png!small" width="690" height="416"></p></noscript>
<p style="text-align: center;">第一次攻击行动</p>
<p style="text-align: center;"><img alt="24.png" data-original="http://image.3001.net/images/20160805/14703886728398.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="416"></p>
<noscript><img alt="24.png" src="http://image.3001.net/images/20160805/14703886728398.png!small" width="690" height="416"></p></noscript>
<p style="text-align: center;"><span style="font-size: 10.5pt;">第四次攻击行动</span></p>
<p><b>域名注册信息</b></p>
<p>其中以*********ine.org为例，分析相关WHOIS信息。</p>
<p style="text-align: center;"><span style="font-size: 10.5pt;"><img alt="25.png" data-original="http://image.3001.net/images/20160805/14703887675888.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="243"><br /></span></p>
<noscript><img alt="25.png" src="http://image.3001.net/images/20160805/14703887675888.png!small" width="690" height="243"><br /></span></p></noscript>
<p style="text-align: center;">域名注册相关信息</p>
<h3>2.	组织描述</h3>
<p style="text-align: center;"><span style="font-size: 10.5pt;"><br /></span></p>
<p style="text-align: center;">组织描述表</p>
<h2>十一、	总结</h2>
<p>在追日团队持续跟踪监控摩诃草组织，通过对该组织相关TTPs的研究分析，以及结合以往跟进或披露的APT组织或攻击行动，我们认为以下几点是值得大家关注的：</p>
<h3>1.	APT攻击从未停歇</h3>
<p>从2013年Norman安全公司将摩诃草组织（即HangOver）曝光后，该组织并未因此停止相关攻击活动，尤其从2015年至2016年期间，相关攻击活动愈演愈烈。对摩诃草组织这四次攻击行动的分析，我们发现其攻击意图中主要的攻击目标和目的也都未发生改变，这也体现出幕后组织意志的坚定性和达到目标的决心。</p>
<p>另外，在跟进的APT组织或行动中，很多组织都不会因为一次攻击行动的暴露或失败而导致该组织停止活动或放弃目标，由于相关恶意代码、C&amp;C等暴露的确会给相关组织带来一定影响，如暂时的蛰伏，而一旦该组织在重新配备资源，调整好相关战术和技术后，就会立即发动新的攻击。比如我们之前披露的海莲花组织（APT-C-00），在我们披露后该组织有很短一段时间没有活跃，但很快又恢复了“生机”，相关攻击活动至今还很活跃。</p>
<p>我们认为这种从未停歇的攻击体现出APT本身的特性，从一定角度很好的解释了APT里P（Persistent，持续性）的涵义。针对持续的威胁，没有一劳永逸的解决方法，与之能抗衡的就是需要我们从未停歇的对抗，持续的跟踪监控。</p>
<h3>2.	APT攻击“不计成本”</h3>
<p>虽然暂时没有直接的证据证实摩诃草组织是一个由国家支持的APT组织，但攻击过程中所使用的大量资源，都表明这不是一个人或一般组织能承受的攻击成本，除非幕后有一个强大的财团支持，另外，该组织相关攻击所表达出明确的意图和坚定的意志，这也不是个体所能达到的，结合这些客观现象，我们认为摩诃草更有可能是由一个国家背景长期支持的APT组织。</p>
<p>APT组织是否会对一个目标发动攻击，主要取决于目标的价值，而不在于目标本身的强弱程度。目标本身防御的强弱只是决定了发动相应攻击所动用的资源，如是否采用0day漏洞，或使用一般钓鱼网站攻击即可达到效果，摩诃草组织很好的诠释了这一点APT特性，在资源使用方面，摩诃草组织基本是对目标所存在的所有受影响攻击面都会涉及考虑到，采用各种方式，从各个角度进行攻击。几乎是一种为达到目的，不择手段，不计成本的攻击方式。</p>
<p>相关攻击行动中使用了大量漏洞，其中至少包括一次0day漏洞使用，相关恶意代码非常繁杂。目前恶意代码HASH数量有995个，C&amp;C数量为731个，而且相关恶意代码会持续的迭代更新。载荷投递的方式，主要是以鱼叉邮件进行恶意代码的传播，另外会涉及少量水坑攻击，在最近一次攻击行动中基于即时通讯工具和社交网络也是主要的恶意代码投递途径。尤其是该组织选择了基于即时通讯工具这种高成本的攻击。除了基于恶意代码攻击，还会采用钓鱼网站，用一种纯粹社会工程学的攻击方法来达到目的。该组织主要除了针对Windows系统进行攻击，同时也会针对Mac OS X系统进行攻击，不仅如此，随着智能移动终端的普及，针对Android的攻击也随之产生。</p>
<h3>3.	中国是APT主要受害国</h3>
<p>在今年我们发布的《2015年中国高级持续性威胁（APT）研究报告》 中已经明确指出了中国是APT攻击的主要受害国，报告中“截至2015年11月底，360威胁情报中心监测到的针对中国境内科研教育、政府机构等组织单位发动APT攻击的境内外黑客组织累计29个”，摩诃草组织就是这29个组织的其中之一。</p>
<p>摩诃草组织的主要攻击目标是中国，进一步主要针对中国科研教育和政府机构，其主要目的是窃取敏感数据情报。摩诃草组织也代表了以中国为攻击目标的APT组织一般所具有的特性：关注科研教育、政府机构，以窃取数据为目的。</p>
<p>在分析摩诃草组织过程中，我们发现在针对中国的攻击，从2015年第三方和第四次攻击行动中，针对中国的目标行业除了科研教育外，针对军事领域的相关攻击不断增加，尤其是关于南海争端等。也就是APT组织会紧密围绕政治、经济、科技、军工等热点领域及事件发动相关攻击。类似“一带一路”、“军民融合”等是除了摩诃草组织以外，也是如海莲花组织、APT-C-05、APT-C-12、APT-C-17等这些组织重点关注的领域。</p>
<h3>4.	国内能力型厂商依然缺位</h3>
<p>摩诃草组织从2009年一直活跃至今，尤其在2016相关攻击更为活跃，另外海莲花组织、APT-C-05、APT-C-06、APT-C-12等我们监控到的大部分APT组织都是类似，相关攻击从未停歇而且每次攻击行动都不会空手而归。在《2015年中国高级持续性威胁（APT）研究报告》中指出针对中国的攻击，往往低成本的攻击就能达到攻击者的预期，而导致低成本入侵频频得手的主要原因还是由于相关被攻击目标防御薄弱。这是造成摩诃草组织在曝光披露后依然活跃的原因之一，但更主要的原因是检测欠缺和响应乏力，我们在本节之后的内容中会详细阐述。</p>
<p>针对每一次攻击，无论是安全机构还是被攻击目标都基本需要经过这几个步骤：监控发现、分析披露、通报告警、检测防御。从摩诃草、海莲花组织的相关攻击中，我们可以看到中国的大部分安全机构或被攻击目标单位相关环节和防护措施还是存在很多问题。</p>
<p>首先，在国内只有很少几家安全厂商能实现自主发现APT攻击，一般机构都是在国外安全厂商披露后进行跟进分析，比如摩诃草最早是由Norman安全公司披露。这一现象不单单在APT攻击事件，如其他重大安全事件和漏洞，都是类似。国内安全厂商基本基于国外披露的信息进行报告、预警提交给有关单位或部门，然后就已经“完成”了一次事件响应，关于后续的检测防御，基本就是基于公开的IOC来进行，然而被攻击目标单位也基本“认同”这一处置方式。</p>
<p>我们所说的能力型安全厂商，不仅需要完成上述跟踪国外厂商报告的能力，更重要的是依赖自身数据或客户数据对APT攻击进行独立发现、溯源与监测，进而对这些攻击进行披露，同时还能针对这些APT攻击为各类受害用户提供日常的检测与响应。</p>
<p>国内虽然号称能够检测APT的产品很多，但是真正能够发现、分析、溯源和防护高级威胁的安全产品依然很少，这和国内缺乏能力型安全厂商生存的空间有很大的关系。从过去360威胁情报中心或安天实验室等能力型厂商已披露的APT组织或行动的监控来看，相关攻击在披露后，至今在各重要政府机构依然非常活跃，攻击中虽然新增了一些木马变种，但不可思议的是已知木马或C&amp;C还很活跃。这很像是医生与患者之间的关系，专业医院告知患者伤口未愈，患者表示知晓，但服务于患者的家庭医生并未给予患者缝合治愈，甚至部分患者也未对未愈的伤口表示重视，最后的结果就是患者继续带伤前行，直至遍体鳞伤无力倒地。这种现象确实和国内安全能力型厂商缺乏其生存的空间有很大的关系。</p>
<p>与上述医患关系一样，我们都不希望看到这种结果。如果在现在的防护体系中，能够引入更多能力型厂商，更多能从监控发现到检测防御每个环节打通完善，形成良性的闭合循环，各类安全厂商与被攻击目标之间形成协同联动，即使我们无法提前知晓摩诃草组织何时卷土重来，也无法阻止摩诃草组织发起下一次攻击行动，但我们依然可以将后续的相关攻击拒之门外，让摩诃草的第五次攻击行动化为泡影。</p>
<h3>5.	网络安全和信息化协同发展</h3>
<p>习总书记在2014年2月27日下午主持召开中央网络安全和信息化领导小组第一次会议并发表重要讲话，其中强调：“网络安全和信息化是一体之两翼、驱动之双轮，必须统一谋划、统一部署、统一推进、统一实施。做好网络安全和信息化工作，要处理好安全和发展的关系，做到协调一致、齐头并进，以安全保发展、以发展促安全，努力建久安之势、成长治之业。”</p>
<p>从摩诃草、海莲花等的相关攻击行动中，我们除了可以看出被攻击目标本身防御薄弱以外，也暴露出相关信息化建设的不完善。在摩诃草组织的攻击中我们发现有大量攻击是通过第三方个人版本的即时通讯工具和社交网络为起初攻击入口来实施攻击，进一步攻击者所投放的钓鱼网站也是假冒的第三方个人免费邮箱，这也从侧面反映被攻击目标可能以个人免费邮箱作为常用联系工具。最后大多数APT组织在针对中国地区的鱼叉邮件攻击中，被攻击目标所接收邮件的邮箱往往是第三方个人免费邮箱，另外攻击者也习惯采用同类第三方免费邮箱进行载荷投递。</p>
<p>从《2015年中国高级持续性威胁（APT）研究报告》中，我们可以了解到被攻击目标主要是集中在科研教育和政府机构等领域。这两类敏感重点行业领域更需要在建设初期就进行安全规划，特别是与互联网相关的个人和机构，避免将个人与工作的信息混杂，让攻击者找到潜在隐患的入口，最终导致机构被攻击渗透。2016年4月19日，习近平总书记在网络安全和信息化工作座谈会上强调：“网络安全是整体的而不是割裂的”，进一步在对APT等高级威胁的对抗过程中，除了加强网络安全环节的建设，也需要与信息化建设统一谋划、统一部署、统一推进和统一实施。</p>
<p><b style="color: rgb(159, 163, 168);">* 企业账号：360安全卫士，转载请注明来自FreeBuf黑客与极客（FreeBuf.COM）</b></p>
                                                    </div>
                        <div class="article-oper article-oper-new">
                            <style>
                                @font-face {font-family: 'iconfont';
                                    src: url('http://static.3001.net/iconfonts/iconfont.eot'); /* IE9*/
                                    src: url('http://static.3001.net/iconfonts/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
                                    url('http://static.3001.net/iconfonts/iconfont.woff') format('woff'), /* chrome、firefox */
                                    url('http://static.3001.net/iconfonts/iconfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
                                    url('http://static.3001.net/iconfonts/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
                                }
                            </style>
                            <div class="share-new clearfix">
                                <div class="share-author">
                                                                            <a href="http://www.freebuf.com/author/360安全卫士" title="由 360安全卫士 发布" rel="author">
                                            <img src="http://image.3001.net/2014/10/logo3.jpg" width="50" height="50" alt="360安全卫士" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 photo" />                                            <!--							<img src="http://image.3001.net/2015/06/17.jpg" alt="ArthurKiller">-->
                                        </a>
                                        <div class="share-author-info">
                                                                                        <a class="author-name" href="http://www.freebuf.com/author/360安全卫士">360安全卫士</a>
                                            <!--<span class="icon-f"></span>-->
                                            <span>
                                <i class="colour-red">
                                    132                                </i>
                                篇文章</span>
                                            <span>等级：
                                <i class="colour-green">8</i>级
                            </span>
                                        </div>
                                                                                                        </div>
                                <div class="user-center clearfix">
                                                                            <a href="http://www.freebuf.com/author/360安全卫士" data-toggle="tooltip" data-placement="top" title="个人主页" class="home" target="_blank"></a>
                                                                        <a href="http://www.freebuf.com/user/pm?pmaction=newmessage&to=360安全卫士" data-toggle="tooltip" data-placement="top" title="私信" class="letter" target="_blank"></a>
                                </div>
                                <div class="share-ctrl clearfix">
                                                                        <div class="bdsharebuttonbox clearfix bdshare-button-style1-24 columnstatus"
                                         data-bd-bind="1489991449190" data-column="" data-title="摩诃草APT组织大揭秘" data-name="">
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="tsina" title="分享到新浪微博" id="tsina"></a>
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="weixin" title="分享到微信" id="weixin"></a>
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="qzone" title="分享到QQ空间" id="qzone"></a>
                                       <!-- _shareUrlWeibo = 'http://service.weibo.com/share/share.php?url=http://'+encodeURIComponent(_json[i].url)+'&title='+encodeURIComponent(_json[i].title)+'-FreeBuf涓撴爮路'+_json[i].columnName;
                                        _shareUrlZone = 'http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://'+encodeURIComponent(_json[i].url)+'&title='+_json[i].title+'-FreeBuf涓撴爮路'+_json[i].columnName;
                                        _shareSrc = 'http://s.jiathis.com/qrcode.php?url=http://'+_json[i].url;-->
                                        <span class="share-line">|</span>
                                    </div>
                                </div>
                                <div class="user-ctrl clearfix">
                                                                            <a href="http://www.freebuf.com/oauth" id="collect" data-toggle="tooltip" data-placement="top" title="收藏" ></a>
                                                                        <a href="#respond" data-toggle="tooltip" data-placement="top" title="评论" id="comments"></a>
                                                                        <!--					<a href="#" title="文章纠正">&#xe6e3;</a>-->
                                    <span class="share-line">|</span>
                                    <span class="info-alert"></span>
                                </div>
                            </div>
                            <script>
                                var column = $('.columnstatus').attr('data-column');
                                var text = '';
                                if(column){
                                    var title = $('.columnstatus').attr('data-title');
                                    var name = $('.columnstatus').attr('data-name');
                                    text = title+' - FreeBuf专栏·'+name;
                                }
                                window._bd_share_config={
                                    "common": {
                                        "bdSnsKey": {},
                                        "bdText": text,
                                        "bdMini": "2",
                                        "bdMiniList": ["qzone", "tsina", "weixin"],
                                        "bdPic": "",
                                        "bdStyle": "1",
                                        "bdSize": "24"
                                    },
                                    "share":{},
                                };
                                with(document)0[
                                    (getElementsByTagName('head')[0]||body).
                                    appendChild(createElement('script')).
                                        src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)
                                    ];
                                //控制垂直方向分享模块的定位
                                function shareFixVertical(){
                                    var offsetTop = jQuery(".article-oper").get(0).offsetTop;
                                    var win_h = jQuery(window).height();
                                    var win_w = jQuery(window).width();
                                    var scrollTop = document.body.scrollTop||document.documentElement.scrollTop;
                                    var _height = offsetTop-scrollTop;
                                    var _flag = $('.column-article').attr('data-column');
                                    if(_flag == 1) {
                                        if(_height>=win_h-660&&win_w>975){
                                            var _width = jQuery("#getWidth").innerWidth()-30;
                                            var _left = jQuery("#getWidth").offset().left+15;
                                            jQuery(".share-new").addClass("fixed");
                                            jQuery(".fixed").css({
                                                width:_width,
                                                left:_left
                                            });

                                        }else{
                                            jQuery(".share-new").removeClass("fixed");
                                            jQuery(".share-new").css({
                                                width: "100%"
                                            });
                                        }
                                    }else {
                                        if(_height>=win_h-255&&win_w>975){
                                            var _width = jQuery("#getWidth").innerWidth()-30;
                                            var _left = jQuery("#getWidth").offset().left+15;
                                            jQuery(".share-new").addClass("fixed");
                                            jQuery(".fixed").css({
                                                width:_width,
                                                left:_left
                                            });

                                        }else{
                                            jQuery(".share-new").removeClass("fixed");
                                            jQuery(".share-new").css({
                                                width: "100%"
                                            });
                                        }
                                    }
                                }
                                //控制水平方向分享模块的定位
                                function shareFixHorizontal(){
                                    var _width = jQuery("#getWidth").innerWidth()-30;
                                    var _left = jQuery("#getWidth").get(0).offsetLeft+15;
                                    var win_w = document.documentElement.clientWidth || document.body.clientWidth;
                                    jQuery(".fixed").css({
                                        width:_width,
                                        left:_left
                                    });
                                    if(win_w< 975){
                                        jQuery(".share-new").css({
                                            width: "100%",
                                            left: "0"
                                        });
                                    }else{
                                        var _width = jQuery("#getWidth").innerWidth()-30;
                                        var _left = jQuery("#getWidth").get(0).offsetLeft+15;
                                        jQuery(".fixed").css({
                                            width:_width,
                                            left:_left
                                        });
                                    }
                                }
                                function click(){
                                    var _w = jQuery(window).width();
                                    jQuery(document).click(function(e){
                                        if(jQuery(e.target).attr("id")=="weixin"){
                                            if(_w <= 760) {
                                                jQuery("#bdshare_weixin_qrcode_dialog").hide();
                                                layer.open({
                                                    title: '提示',
                                                    btnAlign: 'c',
                                                    content: '请使用手机浏览器自带的分享功能分享该页面',
                                                    area: '260px'
                                                });
                                            }else {
                                                jQuery("#bdshare_weixin_qrcode_dialog").show();
                                            }
                                        }else {
                                            jQuery("#bdshare_weixin_qrcode_dialog").hide();
                                        }
                                    });
                                }

                                jQuery(window).on("load",function(){
                                    shareFixVertical();
                                    click();
                                });

                                jQuery(window).on("scroll",function(){
                                    //判断滚轮方向
                                    var agent = navigator.userAgent;
                                    if (/.*Firefox.*/.test(agent)) {
                                        document.addEventListener("DOMMouseScroll", function(e) {
                                            e = e || window.event;
                                            var detail = e.detail;
                                            if (detail > 0) {
                                                $(".share-new").removeClass("fixed");
                                                $(".share-new").css({
                                                    width: "100%"
                                                });
                                                $('.main-header .header').removeClass('op1');
                                                $('.main-header .header').addClass('op0');
                                            } else {
                                                shareFixVertical();
                                                $('.main-header .header').removeClass('op0');
                                                $('.main-header .header').addClass('op1');
                                            }
                                        });
                                    } else {
                                        document.onmousewheel = function(e) {
                                            e = e || window.event;
                                            var wheelDelta = e.wheelDelta;
                                            if (wheelDelta > 0) {
                                                shareFixVertical();
                                                $('.main-header .header').removeClass('op0');
                                                $('.main-header .header').addClass('op1');
                                            } else {
                                                $(".share-new").removeClass("fixed");
                                                $(".share-new").css({
                                                    width: "100%"
                                                });
                                                $('.main-header .header').removeClass('op1');
                                                $('.main-header .header').addClass('op0');
                                            }
                                        }
                                    }
                                });


                                jQuery(window).on("resize",function(){
                                    shareFixHorizontal();
                                    click();
                                })

                                //tooltips提示
                                $(function () { $("[data-toggle='tooltip']").tooltip(); });
                            </script>
                        </div>
                                                                                                                            <div class="article-pager ">
                                <ul>
                                    <li class="previous"><span>上一篇：</span><a href="http://www.freebuf.com/articles/terminal/111130.html" rel="prev">APP漏洞自动化扫描专业评测报告（上篇）</a>                                    </li>
                                    <li class="next"><span>下一篇：</span>
                                        <a href="http://www.freebuf.com/articles/paper/111009.html" rel="next">2016年最值得关注的9家云安全初创企业</a>                                    </li>
                                </ul>
                            </div>
                                            </div>
                </div>
                    <div class="comment-bright"><div class="main-tit04">
    <h3>这些评论亮了</h3></div>      <ul>      <li>
            <div class="user_photo">             <img src="http://image.3001.net/images/headimg/pic2.png">             </div>
            <div class="tit"><span class="name"> 周鸿祎 </span> 
						<span class="explain"></span>
			<span class="reply"><a onclick="return addComment.moveForm( 'comment-','', 'respond','111166' ) " href="?replytocom=#respond" class="comment-reply-link" rel="nofollow">回复</a></span></div>
            <div class="txt">
						除了我司，我就问你们，还有谁，能这么牛B？还有谁！！！</div>
            <div class="but"><span class="vote-count">)</span><span style="none" id="cos_support-2192907" class="vote-count">11</span><span class="vote-count">(</span><span class="vote">  <a class="ilike_icon" id="vote4-2192907" href="javascript:acv_vote(192907,1,2);">亮了</a></span></div>
          </li>
         </ul></div><div class="comment-list">
      <div class="main-tit02">
		<a rel="nofollow" class="btnbtn-default btn-comment" href="#respond">发表评论</a>
        <h3>已有 <span class="color_red">12</span> 条评论
      </div>
      <ul>
         <li class="comment even thread-even depth-1" id="li-comment-192907">
    <div id="comment-192907">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic6.png">     </div>
    <div class="tit"> 
	    <span class="name"> 周鸿祎 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-08-08</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-192907','192907', 'respond','111166' ) " href="?replytocom=192907#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">1楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>除了我司，我就问你们，还有谁，能这么牛B？还有谁！！！</p>
<div class="comment-tools">
<div class="vote" id="vote-192907"><span id="acv_stat_192907"></span><a class="ilike_icon"  id="vote4-192907" href="javascript:acv_vote(192907,1);">亮了</a>(<span id="cos_support-192907">11</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="192907" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="192907" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="192907" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="192907" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="192907" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment byuser comment-author-l odd alt depth-2" id="li-comment-192908">
    <div id="comment-192908">
        <div class="photo"> <a href="http://www.freebuf.com/author/美食家L">
    <img src="http://image.3001.net/2016/08/QQ截图20160525160129.jpg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/美食家L" target="_blank">美食家L&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(3级)</span>
				<span class="explain"> http:404.so～(　TロT)σ 别碰我~ </span>
		<span class="time">&nbsp;2016-08-08</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-192908','192908', 'respond','111166' ) " href="?replytocom=192908#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ 周鸿祎  你是？</p>
<div class="comment-tools">
<div class="vote" id="vote-192908"><span id="acv_stat_192908"></span><a class="ilike_icon"  id="vote4-192908" href="javascript:acv_vote(192908,1);">亮了</a>(<span id="cos_support-192908">4</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="192908" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="192908" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="192908" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="192908" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="192908" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even depth-2" id="li-comment-192911">
    <div id="comment-192911">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic2.png">     </div>
    <div class="tit"> 
	    <span class="name"> 李彦宏 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-08-08</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-192911','192911', 'respond','111166' ) " href="?replytocom=192911#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ 周鸿祎  我们百度外卖用的AI不比你们这些玩威胁情报的差</p>
<div class="comment-tools">
<div class="vote" id="vote-192911"><span id="acv_stat_192911"></span><a class="ilike_icon"  id="vote4-192911" href="javascript:acv_vote(192911,1);">亮了</a>(<span id="cos_support-192911">4</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="192911" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="192911" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="192911" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="192911" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="192911" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment odd alt depth-3" id="li-comment-192918">
    <div id="comment-192918">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic17.png">     </div>
    <div class="tit"> 
	    <span class="name"> 90_ </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-08-08</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		           <a onclick="return addComment.moveForm( 'comment-192918','192911', 'respond','111166' )" href="?replytocom=192918#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ 李彦宏  只能呵呵了</p>
<div class="comment-tools">
<div class="vote" id="vote-192918"><span id="acv_stat_192918"></span><a class="ilike_icon"  id="vote4-192918" href="javascript:acv_vote(192918,1);">亮了</a>(<span id="cos_support-192918">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="192918" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="192918" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="192918" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="192918" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="192918" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-67433 even depth-2" id="li-comment-192955">
    <div id="comment-192955">
        <div class="photo"> <a href="http://www.freebuf.com/author/鬼灬迹">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/鬼灬迹" target="_blank">鬼灬迹&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain"> FreeBuf最佳装逼哥 </span>
		<span class="time">&nbsp;2016-08-08</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-192955','192955', 'respond','111166' ) " href="?replytocom=192955#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ 周鸿祎  FireEye <img src='http://image.3001.net/images/index/smilies/icon_evil.gif' alt=':evil:' class='wp-smiley' /> </p>
<div class="comment-tools">
<div class="vote" id="vote-192955"><span id="acv_stat_192955"></span><a class="ilike_icon"  id="vote4-192955" href="javascript:acv_vote(192955,1);">亮了</a>(<span id="cos_support-192955">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="192955" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="192955" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="192955" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="192955" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="192955" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="li-comment-193003">
    <div id="comment-193003">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic13.png">     </div>
    <div class="tit"> 
	    <span class="name"> HD MOORE </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-08-09</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-193003','193003', 'respond','111166' ) " href="?replytocom=193003#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ 周鸿祎  All these tools are powered by metasploit.YOU ZHA ZHA</p>
<div class="comment-tools">
<div class="vote" id="vote-193003"><span id="acv_stat_193003"></span><a class="ilike_icon"  id="vote4-193003" href="javascript:acv_vote(193003,1);">亮了</a>(<span id="cos_support-193003">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="193003" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="193003" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="193003" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="193003" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="193003" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="li-comment-192925">
    <div id="comment-192925">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic17.png">     </div>
    <div class="tit"> 
	    <span class="name"> desperedge<span class="weibo"></span> </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-08-08</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-192925','192925', 'respond','111166' ) " href="?replytocom=192925#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">2楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>图里面的是石蒜。。</p>
<div class="comment-tools">
<div class="vote" id="vote-192925"><span id="acv_stat_192925"></span><a class="ilike_icon"  id="vote4-192925" href="javascript:acv_vote(192925,1);">亮了</a>(<span id="cos_support-192925">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="192925" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="192925" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="192925" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="192925" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="192925" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="li-comment-192932">
    <div id="comment-192932">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic4.png">     </div>
    <div class="tit"> 
	    <span class="name"> yyy3333 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-08-08</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-192932','192932', 'respond','111166' ) " href="?replytocom=192932#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">3楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>说了这么长……<br />
  就是    发 油贱 …… 日发油贱三万封……下一句是啥？</p>
<div class="comment-tools">
<div class="vote" id="vote-192932"><span id="acv_stat_192932"></span><a class="ilike_icon"  id="vote4-192932" href="javascript:acv_vote(192932,1);">亮了</a>(<span id="cos_support-192932">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="192932" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="192932" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="192932" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="192932" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="192932" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-langyajiekou even thread-odd thread-alt depth-1" id="li-comment-192942">
    <div id="comment-192942">
        <div class="photo"> <a href="http://www.freebuf.com/author/langyajiekou">
    <img src="http://image.3001.net/2015/10/female-SexyCyborg-hacker.jpg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/langyajiekou" target="_blank">langyajiekou&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(6级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2016-08-08</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-192942','192942', 'respond','111166' ) " href="?replytocom=192942#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">4楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>http://www.indetectables.net/viewtopic.php?f=7&amp;t=52263&amp;sid=b6fe274a4e8934fceb0f3fc90cd35aa2 没得下载源代码啊。。。</p>
<div class="comment-tools">
<div class="vote" id="vote-192942"><span id="acv_stat_192942"></span><a class="ilike_icon"  id="vote4-192942" href="javascript:acv_vote(192942,1);">亮了</a>(<span id="cos_support-192942">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="192942" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="192942" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="192942" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="192942" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="192942" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-startagain odd alt thread-even depth-1" id="li-comment-192960">
    <div id="comment-192960">
        <div class="photo"> <a href="http://www.freebuf.com/author/startagain">
    <img src="http://image.3001.net/2016/11/a9981e192042db1170f73e702bd09997.jpeg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/startagain" target="_blank">startagain&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(2级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2016-08-09</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-192960','192960', 'respond','111166' ) " href="?replytocom=192960#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">5楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>印度阿三，360现在为了写这些报告也是够拼的</p>
<div class="comment-tools">
<div class="vote" id="vote-192960"><span id="acv_stat_192960"></span><a class="ilike_icon"  id="vote4-192960" href="javascript:acv_vote(192960,1);">亮了</a>(<span id="cos_support-192960">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="192960" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="192960" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="192960" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="192960" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="192960" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="li-comment-192961">
    <div id="comment-192961">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic16.png">     </div>
    <div class="tit"> 
	    <span class="name"> 弟弟大大洞洞大大 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-08-09</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-192961','192961', 'respond','111166' ) " href="?replytocom=192961#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">6楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>分析的不错，但是为啥IOCs都要打码？至于么&#8230;<br />
过几天ForcePoint也要发一个关于HangOver的报告，完全不同的样本分析，敬请期待。</p>
<div class="comment-tools">
<div class="vote" id="vote-192961"><span id="acv_stat_192961"></span><a class="ilike_icon"  id="vote4-192961" href="javascript:acv_vote(192961,1);">亮了</a>(<span id="cos_support-192961">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="192961" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="192961" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="192961" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="192961" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="192961" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="li-comment-193093">
    <div id="comment-193093">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic13.png">     </div>
    <div class="tit"> 
	    <span class="name"> 要依林的女婿 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-08-10</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-193093','193093', 'respond','111166' ) " href="?replytocom=193093#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">7楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>看来我不能老反复啊，得整整外国银。</p>
<div class="comment-tools">
<div class="vote" id="vote-193093"><span id="acv_stat_193093"></span><a class="ilike_icon"  id="vote4-193093" href="javascript:acv_vote(193093,1);">亮了</a>(<span id="cos_support-193093">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="193093" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="193093" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="193093" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="193093" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="193093" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
      </ul>
      <div class="commentnav page01" style="padding-top:10px; text-align: center;">
               </div>
	  
<script src="http://www.freebuf.com/buf/themes/freebuf/js/ajaxfileupload.js" type="text/javascript"></script>
<div id="respond" class="comment-box">
<input type="file" id="uploadUnit" name="upfile" class="hidden" value="">
    <form action="http://www.freebuf.com/wp-comments-post.php" method="post" id="commentform">
        <div id="comment-author-info">
	    <div class="login-other">
		  <div class="login_button login_icon_sina" title="使用新浪微博登陆" onclick="login_button_click('sina')"></div>
          <div class="login_button login_icon_qq" title="使用腾讯QQ登陆" onclick="login_button_click('qq')"></div></div>
        <div class="login-input">
	    <p><label for="author">昵称</label>
		          <input type="text" name="author" id="author" value="" size="14" tabindex="1" aria-required='true' placeholder = "请输入昵称" required />
        </p><span>必须</span><span>您当前尚未登录。<a  class="simplemodal-login" href="http://www.freebuf.com/oauth" title="登陆">登陆？</a><a  href="https://account.tophant.com/register.html" target="_blank">注册</a></span></div>
		<div class="login-input">
		  <p><label for="email">邮箱</label><input type="text" name="email" id="email" value="" size="25" tabindex="2" aria-required='true' placeholder = "请输入邮箱地址" required /></p>
		<span>必须（保密）</span>
		</div>
    </div>

        <div id="test" class="post-area">
      <div class="holiday"></div>
	    <div class="comment-editor">
			<a id="comment-smiley" href="javascript:;">表情</a><a href="javascript:;" id="imageThumb">插图</a>
	    </div>
        <div id="smileys" >
           <a title="mrgreen" href="javascript:grin(':mrgreen:')"><img src="http://image.3001.net/images/index/smilies/icon_mrgreen.gif" /></a><a title="razz" href="javascript:grin(':razz:')"><img src="http://image.3001.net/images/index/smilies/icon_razz.gif" /></a><a title="sad" href="javascript:grin(':sad:')"><img src="http://image.3001.net/images/index/smilies/icon_sad.gif" /></a><a title="smile" href="javascript:grin(':smile:')"><img src="http://image.3001.net/images/index/smilies/icon_smile.gif" /></a><a title="oops" href="javascript:grin(':oops:')"><img src="http://image.3001.net/images/index/smilies/icon_redface.gif" /></a><a title="grin" href="javascript:grin(':grin:')"><img src="http://image.3001.net/images/index/smilies/icon_biggrin.gif" /></a><a title="eek" href="javascript:grin(':eek:')"><img src="http://image.3001.net/images/index/smilies/icon_surprised.gif" /></a><a title="???" href="javascript:grin(':???:')"><img src="http://image.3001.net/images/index/smilies/icon_confused.gif" /></a><a title="cool" href="javascript:grin(':cool:')"><img src="http://image.3001.net/images/index/smilies/icon_cool.gif" /></a><a title="lol" href="javascript:grin(':lol:')"><img src="http://image.3001.net/images/index/smilies/icon_lol.gif" /></a><a title="mad" href="javascript:grin(':mad:')"><img src="http://image.3001.net/images/index/smilies/icon_mad.gif" /></a><a title="twisted" href="javascript:grin(':twisted:')"><img src="http://image.3001.net/images/index/smilies/icon_twisted.gif" /></a><a title="roll" href="javascript:grin(':roll:')"><img src="http://image.3001.net/images/index/smilies/icon_rolleyes.gif" /></a><a title="wink" href="javascript:grin(':wink:')"><img src="http://image.3001.net/images/index/smilies/icon_wink.gif" /></a><a title="idea" href="javascript:grin(':idea:')"><img src="http://image.3001.net/images/index/smilies/icon_idea.gif" /></a><a title="arrow" href="javascript:grin(':arrow:')"><img src="http://image.3001.net/images/index/smilies/icon_arrow.gif" /></a><a title="neutral" href="javascript:grin(':neutral:')"><img src="http://image.3001.net/images/index/smilies/icon_neutral.gif" /></a><a title="cry" href="javascript:grin(':cry:')"><img src="http://image.3001.net/images/index/smilies/icon_cry.gif" /></a><a title="?" href="javascript:grin(':?:')"><img src="http://image.3001.net/images/index/smilies/icon_question.gif" /></a><a title="evil" href="javascript:grin(':evil:')"><img src="http://image.3001.net/images/index/smilies/icon_evil.gif" /></a><a title="shock" href="javascript:grin(':shock:')"><img src="http://image.3001.net/images/index/smilies/icon_eek.gif" /></a><a title="!" href="javascript:grin(':!:')"><img src="http://image.3001.net/images/index/smilies/icon_exclaim.gif" /></a>        </div>
         <textarea name="comment" id="comment" cols="100%" rows="7" tabindex="4" style="overflow-x:hidden; overflow-y:hidden; border:0; width:100%;" onkeydown="if(event.ctrlKey&amp;&amp;event.keyCode==13){document.getElementById('submit').click();return false};"></textarea>
    </div>
      <div class="subcon but">
      <input class="btn btn-success" type="submit" name="submit" id="submit" tabindex="5" value="提交评论(Ctrl+Enter)" />
      <a rel="nofollow" class="btn btn-default" id="cancel-comment-reply-link" href="javascript:;">取消</a>
      <div class="checkbox"><input type='hidden' name='comment_post_ID' value='111166' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
<label for="comment_mail_notify" class="comment_mail"><input type="checkbox" name="comment_mail_notify" id="comment_mail_notify" value="comment_mail_notify" checked="checked"/>有人回复时邮件通知我</label></div>
      </div>
    <input name="Token" id="Token" type="hidden" value="e2l1sf" />
  </form>
  </div>
</div>	  
<div class="commentshow">
<div class="comments-loading">Loading...</div>
</div>
<script language="javascript">
jQuery(document).ready(function($){ //Begin jQuery
    $('.reply').click(function() {
    var atid = '"#' + $(this).parent().attr("id") + '"';
    var atname = $(this).parent().find('span:first').text();
    $("#comment").val("@" + atname + " ").focus();
});
    $('.cancel-comment-reply a').click(function() { //点击取消回复评论清空评论框的内容
    $("#comment").val('');
});
}) 

jQuery(document).ready(function($) {
    $body = (window.opera) ? (document.compatMode == "CSS1Compat" ? $('html') : $('body')) : $('html,body');//commentnav ajax
    $(document).on('click', '.commentnav a', function(e) {
        e.preventDefault();
        $.ajax({
            type: "GET",
            url: $(this).attr('href'),
            beforeSend: function() {
                $('.commentnav').remove();
                $('.comment-list').remove();
                $('.comments-loading').slideDown();
            },
            dataType: "html",
            success: function(out) {
                result = $(out).find('.comment-list');
                nextlink = $(out).find('.commentnav');
                $('.comments-loading').slideUp(550);
                $('.comments-loading').after(result.fadeIn(800));
                $(".comment-list img").each(function(){
                  var url = $(this).attr("data-original");
                  $(this).attr("src",url);
                })
            }
        });
    });    
});
</script>            </div>
                    <div class="col-md-3 visible-md-block visible-lg-block">
                <div class="panel panel-default">
                    <div class="author-top">
                         <div class="author-wrap">
                            <div class="author-header"><img src="http://image.3001.net/2014/10/logo3.jpg" width="96" height="96" alt="360安全卫士" class="avatar avatar-100 wp-user-avatar wp-user-avatar-100 photo" />                            </div>
                            <p class="name"><a href="http://www.freebuf.com/author/360%e5%ae%89%e5%85%a8%e5%8d%ab%e5%a3%ab" title="由 360安全卫士 发布" rel="author">360安全卫士</a><span><a href="http://www.freebuf.com/bufer" target="_blank"><img src="http://image.3001.net/images/index/f2.png" title="认证厂商"></a></span></p>
                            <p class="signature">360安全卫士官方账号</p>
                            <p class="art-com clearfix">
                                <span class="aut-article">
                                    <a href="/author/360安全卫士"target="_blank">
                                        <i>132</i>
                                        <i>文章数</i>
                                    </a>
                                </span>
                                <span class="aut-comment">
                                    <a href="/author/360安全卫士?comment=1" target="_blank">
                                        <i>9</i>
                                        <i>评论数</i>
                                    </a>
                                </span>
                            </p>
                        </div>
                    </div>
                    <div class="author-bottom">
                        <div class="author-wrap">
                            <h3 class="last-title">最近文章</h3>
                            <div class="last-item-wrap">
                                                                        <div class="last-item">
                                            <a href="http://www.freebuf.com/articles/terminal/147797.html" target="_blank"><span class="point"></span>网页上的污染源：“PM2.5报告”插件实为恶意广告注射器</a>
                                            <p class="last-time">2017.09.19</p>
                                        </div>
                                                                            <div class="last-item">
                                            <a href="http://www.freebuf.com/articles/network/147652.html" target="_blank"><span class="point"></span>游戏辅助背后的黑产流水线：年劫持攻击千万次牟利数百万</a>
                                            <p class="last-time">2017.09.18</p>
                                        </div>
                                                                            <div class="last-item">
                                            <a href="http://www.freebuf.com/articles/system/147602.html" target="_blank"><span class="point"></span>一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现：最新的Office高级威胁攻击预警</a>
                                            <p class="last-time">2017.09.13</p>
                                        </div>
                                                                </div>
                        </div>

                        <div class="more-wrap">
                            <a href="http://www.freebuf.com/author/360安全卫士" target="_blank" class="btn-new">浏览更多</a>
                        </div>
                    </div>
                </div>
                                <div class="panel panel-default">
                    <div class="read visible-md-block visible-lg-block">
                        <div class="main-tit02">
                            <h3>相关阅读</h3>
                        </div>
                        <ul>
  <li><a href="http://www.freebuf.com/articles/network/86360.html" target="_blank">卡巴斯基辣评2016安全趋势：APT攻击将死，“后门买卖”会更加活跃</a></li>
  
  <li><a href="http://www.freebuf.com/news/101884.html" target="_blank">瑞典称其国家重要基础设施正在遭受俄罗斯黑客攻击</a></li>
  
  <li><a href="http://www.freebuf.com/news/75738.html" target="_blank">卡巴斯基：专业攻击日本的APT组织“蓝白蚁（blue termite）”新动向</a></li>
  
  <li><a href="http://www.freebuf.com/news/110431.html" target="_blank">赛门铁克：企业请注意！Patchwork APT攻击范围已扩展到各行各业</a></li>
  
  <li><a href="http://www.freebuf.com/news/13425.html" target="_blank">跨国高端黑客团体——Icefog</a></li>
  </ul>                    </div>
                </div>
                <!--<div class="ad-wrap"><a href="http://www.ijiami.cn/?freebuf.com" target="_blank"><img width="100%" src="http://image.3001.net/images/20141201/14174039186901.jpg"></a></div>-->
                <div class="panel panel-default rec-spe">
                    <div class="main-tit03 colour-blue">
                        <h3>特别推荐</h3>
                    </div>
                                                    <div class="rec-img"><a href="http://www.freebuf.com/ad?id=3" target="_blank"><img
                                            src="http://image.3001.net/2017/05/14a10c5c919d154dddbee79e3a944143-220x150.png" width="220"></a></div>
                                                </div>
                <div id="mar-right">
                    <!--<div class="read visible-lg-block">
        <div class="main-tit04">
          <h3>商城新品</h3>
        </div>
        <div id="slider" class="nivoSlider">  </div>
      </div>-->
                    <div class="panel panel-default code"><img src="http://image.3001.net/images/new/code.jpg" width="192"
                                                               height="192">
                        <p>关注我们 分享每日精选文章</p>
                    </div>
                </div>
            </div>
                </div>
                    <div class="row marvellous visible-lg-block">
                <h3>不容错过</h3>
                <ul>
                                                <li><a href="http://www.freebuf.com/news/79262.html" rel="bookmark"
                                   title="安卓粉的愤怒：苹果首款Android App遭疯狂差评">安卓粉的愤怒：苹果首款Android App遭疯狂差评</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/dawner" title="由 dawner 发布" rel="author">dawner</a></span>
                                                                        <span class="time">2015-09-22</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/articles/web/133306.html" rel="bookmark"
                                   title="游戏外挂网站暗藏病毒：盗号、锁首等数种危害并举">游戏外挂网站暗藏病毒：盗号、锁首等数种危害并举</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/%e7%81%ab%e7%bb%92%e5%ae%89%e5%85%a8" title="由 火绒安全 发布" rel="author">火绒安全</a></span>
                                                                        <span class="time">2017-05-02</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/news/111825.html" rel="bookmark"
                                   title="【FB TV】一周「BUF大事件」（20160806-201608012）">【FB TV】一周「BUF大事件」（20160806-201608012）</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/supercoco" title="由 supercoco 发布" rel="author">supercoco</a></span>
                                                                        <span class="time">2016-08-13</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/news/107916.html" rel="bookmark"
                                   title="动手搭建DDoS演练：揭秘在线DDoS攻击平台（下）">动手搭建DDoS演练：揭秘在线DDoS攻击平台（下）</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/arthurkiller" title="由 ArthurKiller 发布" rel="author">ArthurKiller</a></span>
                                                                        <span class="time">2016-07-05</span></p>
                            </li>
                                                            </ul>
            </div>
            </div>
</div>
<script type="text/javascript">
  $(window).load(function() {
    $('#slider').nivoSlider();
  });
  $('#contenttxt img').removeAttr('height');
  $('#contenttxt img').wrap(function(){
    if(!$(this).parent().attr('href')){
      var imgurl = $(this).attr('data-original');
      if(imgurl.substr(-6)=='!small'){
        imgurl = imgurl.substring(0,imgurl.length-6);
      }
      return '<a href="' + imgurl + '" class="highslide-image" onclick="return hs.expand(this);" target="_blank"></a>';
    }
  })
</script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/comments-ajax.js" type="text/javascript"></script>
<script type="text/javascript" src="http://static.3001.net/js/focus/jquery.nivo.slider.pack.js"></script>
<!----------footer---------->
<div class="footer">
  <div class="container">
    <div class="footer-list ">
      <h3>FREEBUF</h3>
      <ul>
        <li><a href="http://www.freebuf.com/dis">免责声明</a></li>
        <li><a href="http://www.freebuf.com/news/others/864.html">关于我们</a></li>
        <li><a href="http://www.freebuf.com/jobs/40386.html">加入我们</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>广告及服务</h3>
      <ul>
        <li><a target="_blank" href="mailto:root@freebuf.com">寻求报道</a></li>
        <li><a href="http://www.freebuf.com/advertise">广告合作</a></li>
        <li><a target="_blank" href="mailto:help@freebuf.com">联系我们</a></li>
        <li><a href="http://www.freebuf.com/friends">友情链接</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>关注我们</h3>
      <ul>
        <li><div class="weixin-pannel weixin"><a class="qr" href="javascript:viod(0);"><span class="g-icon-qr1">官方微信</span><i></i></a></div></li>
        <li><a rel="nofollow" target="_blank" href="http://weibo.com/freebuf">新浪微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://t.qq.com/freebuf">腾讯微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://twitter.com/freebuf">Twitter</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>赞助商</h3>
      <ul>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="http://www.aliyun.com/?freebuf"><img src="http://image.3001.net/images/ad/ali.png"></a></li>
        <li><a rel="nofollow" target="_blank" href="http://www.upyun.com/?freebuf"><img src="http://image.3001.net/images/ad/upyun.png"></a></li>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="https://www.trustasia.com/?freebuf"><img src="http://image.3001.net/images/ad/ad-yzcx.png"></a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <ul>
      </ul>
    </div>
    <div class="footer-logo  pull-right"><img src="http://image.3001.net/images/index/freebufrobot_shendanjie.png" ></div>
  </div>
  <div class="copyright"><div class="container"><p>Copyright &copy; 2017 WWW.FREEBUF.COM All Rights Reserved <a rel="nofollow" target="_blank" href="http://www.miitbeian.gov.cn">沪ICP备13033796号</a></p><span><a rel="nofollow" target="_blank" href="http://click.aliyun.com/m/1336/?freebuf"><img src="http://image.3001.net/images/new/icon-aly.png"></a></span></div></div>
</div>
<div class="bottom_tools"><a id="scrollUp" href="javascript:;" title="飞回顶部"></a></div>
<!----------footer end----------> 
<script src="http://static.3001.net/js/new/backtop.js"></script>
<script type="text/javascript">
jQuery(function(){	
	jQuery('.tabPanes ul li').click(function(){
		jQuery(this).addClass('hit').siblings().removeClass('hit');
		jQuery('.panesl>div:eq('+jQuery(this).index()+')').show().siblings().hide();	
	})
	jQuery('.vulbox-nav').click(function(e) { 
        e.stopPropagation(); 
    });  
})
</script>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fcc53db168808048541c6735ce30421f5' type='text/javascript'%3E%3C/script%3E"));
</script>
<img alt='css.php' src="http://www.freebuf.com/buf/plugins/cc/css.php?k=3cb185a485c81b23211eb80b75a406fd&amp;o=i&amp;t=726879767" width='1' height='1' /><script type="text/javascript">
jQuery(function() {
    jQuery(".simditor pre").each(function(i, block){
        hljs.highlightBlock(block);    
    });
    hljs.initHighlightingOnLoad();
});
</script>
<script>
/* <![CDATA[ */
var rcGlobal = {
	serverUrl		:'http://www.freebuf.com',
	infoTemp		:'%REVIEWER% on %POST%',
	loadingText		:'Loading',
	noCommentsText	:'No comments',
	newestText		:'&laquo; 最新',
	newerText		:'&laquo; 新一点',
	olderText		:'旧一点 &raquo;',
	showContent		:'1',
	external		:'1',
	avatarSize		:'32',
	avatarPosition	:'left',
	anonymous		:'Anonymous'
};
/* ]]> */
</script>
<script type='text/javascript' src='http://static.3001.net/js/recentcomments/wp-recentcomments-jquery.js?ver=2.2.3'></script>
</body>
</html>
