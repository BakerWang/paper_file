<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
                              _.._        ,------------.
                           ,'      `.    ( We want you! )
                          /  __) __` \    `-,----------'
                         (  (`-`(-')  ) _.-'
                         /)  \  = /  (
                        /'    |--' .  \
                       (  ,---|  `-.)__`
                        )(  `-.,--'   _`-.
                       '/,'          (  Uu",
                        (_       ,    `/,-' )
                        `.__,  : `-'/  /`--'
                          |     `--'  |
                          `   `-._   /
                           \        (
                           /\ .      \.  freebuf
                          / |` \     ,-\
                         /  \| .)   /   \
                        ( ,'|\    ,'     :
                        | \,`.`--"/      }
                        `,'    \  |,'    /
                       / "-._   `-/      |
                       "-.   "-.,'|     ;
                      /        _/["---'""]
                     :        /  |"-     '
                     '           |      /
                                 `      |
-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  技术分析：微软 Office 365平台SAML服务漏洞，可越权访问其他用户资源 - FreeBuf.COM | 关注黑客与极客</title>
<meta name="description" content="近期，两位安全研究人员，Klemen Bratec及&nbsp;Ioannis Kakavas，公布了他们发现的一个在Microsoft Office 365平台上的SAML服务漏洞，该漏洞可被利用进行跨域认证绕过，最终可对365平台上的所有联邦域造成影响。…" />
<meta name="keywords" content="Microsoft, Office 365, SAML, 单点登录, WEB安全渗透测试报告,WEB安全大事件点评,WEB安全技术, 最新漏洞报告,漏洞众测平台,漏洞攻击分析,漏洞POC和EXP" />
<meta name="baidu-site-verification" content="nKKKqQxp6R" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="renderer" content="webkit">
<meta property="qc:admins" content="6620477777662552566375" />
<link rel='stylesheet' id='wpfp-css' href='http://www.freebuf.com/buf/plugins/wp-favorite-posts/wpfp.css' type='text/css' />
<link rel='stylesheet' id='wp-recentcomments-css'  href='http://static.3001.net/css/recentcomments/wp-recentcomments.css?ver=2.2.3' type='text/css' media='screen' />
<link rel='stylesheet' id='mycred-widget-css'  href='http://www.freebuf.com/buf/plugins/gold/assets/css/widget.css?ver=1.3.2.1' type='text/css' media='all' />
<script type='text/javascript' src='http://static.3001.net/js/header/jquery.min.js?ver=3.6.1'></script>
<script type='text/javascript' src='http://www.freebuf.com/buf/plugins/wp-favorite-posts/wpfp.js?ver=3.6.1'></script>
<link rel='prev' title='极客DIY：制作一款属于自己的谷歌眼镜' href='http://www.freebuf.com/geek/103783.html' />
<link rel='next' title='关于Apache Struts 2 S2-032漏洞威胁监测和应急处置的情况公告' href='http://www.freebuf.com/vuls/103823.html' />
<link rel='canonical' href='http://www.freebuf.com/vuls/103718.html' />
<link rel='shortlink' href='http://www.freebuf.com/?p=103718' />

<link rel="stylesheet" href="http://static.3001.net/css/highslide/highslide.css" type="text/css" />
<script type="text/javascript" src="http://static.3001.net/js/highslide/highslide-with-html.packed.js"></script>
<script type="text/javascript">
jQuery(document).ready(function($) {
    hs.graphicsDir = "http://www.freebuf.com/buf/plugins/auto-highslide/images/graphics/";
    hs.outlineType = "rounded-white";
    hs.dimmingOpacity = 0.8;
    hs.outlineWhileAnimating = true;
    hs.showCredits = false;
    hs.captionEval = "this.thumb.alt";
    hs.numberPosition = "caption";
    hs.align = "center";
    hs.transitions = ["expand", "crossfade"];
    hs.addSlideshow({
        interval: 5000,
        repeat: true,
        useControls: true,
        fixedControls: "fit",
        overlayOptions: {
            opacity: 0.75,
            position: "bottom center",
            hideOnMouseOut: true

        }

    });
});
</script>
          <script language="JavaScript" type="text/javascript" src="http://www.freebuf.com/buf/plugins/cartpauj-pm/js/script.js"></script>
      <link rel="stylesheet" type="text/css" href="http://www.freebuf.com/buf/plugins/cartpauj-pm/style/style.css" />
      <script type="text/javascript" src="http://www.freebuf.com/buf/plugins/simditor/highlight/highlight.pack.js"></script><link type="text/css" rel="stylesheet" href=" http://www.freebuf.com/buf/plugins/simditor/highlight/styles/default.css" />	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<link rel="shortcut icon" href="http://static.freebuf.com/images/favicon.ico" />
<link rel="stylesheet" href="http://static.3001.net/css/new/header.css" />
<link href="http://static.3001.net/css/new/bootstrap.min.css?ver=2016051701" rel="stylesheet" media="screen">
    <!--轮播图-->
    <link href="http://static.3001.net/css/new/swiper-3.4.2.min.css" rel="stylesheet" type="text/css">
    <link href="http://static.3001.net/css/new/style.css?ver=20170912568" rel="stylesheet" type="text/css">
    <style type="text/css">
#contenttxt hr {
  display: block;
  height: 0px;
  border: 0;
  border-top: 1px solid #ccc;
  margin: 15px 0;
  padding: 0;
}
#contenttxt table {
  width: 100%;
  table-layout: fixed;
  border-collapse: collapse;
  border-spacing: 0;
  margin: 15px 0;
}
#contenttxt table thead {
  background-color: #f9f9f9;
}
#contenttxt table td, #contenttxt table th {
  min-width: 40px;
  height: 30px;
  border: 1px solid #ccc;
  vertical-align: top;
  padding: 2px 4px;
  text-align: left;
  box-sizing: border-box;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
#contenttxt table td.active, #contenttxt table th.active {
  background-color: #ffffee;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
</style>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/jquery-2.0.3.min.js"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/bootstrap.min.js"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/slider.js?2016022501.1" type="text/javascript"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/jquery.sticky.js" type="text/javascript"></script>
<script src="http://static.3001.net/js/focus/bjqs-1.3.min.js" type="text/javascript" ></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/mosaic.1.0.1.min.js" type="text/javascript" ></script>
<script type="text/javascript" src="http://static.3001.net/js/new/setint.js"></script>
    <!--轮播图-->
    <script src="http://static.3001.net/js/colum/swiper-3.4.2.min.js"></script>
<!--[if lt IE 9]>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/html5shiv.min.js"></script>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/respond.min.js"></script>
<![endif]-->
    <style>
        @font-face {font-family: 'iconfont';
            src: url('http://static.3001.net/iconfont/iconfont.eot'); /* IE9*/
            src: url('http://static.3001.net/iconfont/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
            url('http://static.3001.net/iconfont/iconfont.woff') format('woff'), /* chrome、firefox */
            url('http://static.3001.net/iconfont/iconfonticonfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
            url('http://static.3001.net/iconfont/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
        }
    </style>
</head>

<body>
<!----------header---------->
<!--头部导航-->
<div id="undefined-sticky-wrapper" class="sticky-wrapper is-sticky">
    <div class="main-header">
        <div class="header">
            <div class="header-container clearfix">
                                <div class="header-logo"><a href="http://www.freebuf.com"></a></div>
                                        <!-- column -->
                        <div class="nav">
                            <ul class="nav-child clearfix">
                                <li class=" index">
                                    <a href="http://www.freebuf.com">首页</a></li>
                                <li data-value="read-menu">
                                    <a href="#">分类阅读<b class="triangle-down triangle-down-04"></b></a>
                                </li>
                                <li data-value="wenku-menu"><a href="javascript:;" target="_blank">文库<b class="triangle-down triangle-down-04"></b></a></li>
                                <li>
                                    <a href="http://zhuanlan.freebuf.com" target="_blank">专栏</a><b class="icon-betr"></b>
                                </li>
                                <li><a href="http://open.freebuf.com" target="_blank">公开课</a></li>
                                <li><a href="http://shop.freebuf.com" target="_blank">商城</a></li>
                                <li data-value="company-menu"><a href="javascript:;" >企业服务<b class="triangle-down triangle-down-04"></b></a></li>
                                <li data-value="user-menu"><a href="javascript:;" >用户服务<b class="triangle-down triangle-down-04"></b></a></li>
                            </ul>
                        </div>
                                        <div class="header-right">
                                    <div class="loginSign login-before">
                        <a href="https://account.tophant.com/register.html" class="login-btn">注册</a>
                        |
                        <a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a>
                    </div>
                                    <!--搜索-->
                    <div class="search-form-inner clearfix">
                        <i class="searchdisplayico"></i>
                        <div class="form-group has-active search-col search-form-text">
                            <form id="hpsform-new" class="navbar-search navbar-form" onsubmit="return dispatch();">
                                <div class="form-group">
                                    <input id="bigq" class="input form-control" type="text" placeholder="关键字查找" autocomplete="off" title="关键字查找" name="q">
                                    <button class="submit" type="submit"></button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <!--<script>
                        $('.search-form-inner .searchdisplayico').click(function(event) {
                            var evt = evt || event;
                            evt.stopPropagation();
                            $(this).siblings('.search-col').addClass('active');
                        });
                        $('.search-form-inner .search-col').click(function(event) {
                            var evt = evt || event;
                            evt.stopPropagation();
                            $('.search-form-inner .search-col').addClass('active');
                        });
                        $(document).click(function() {
                            $('.search-form-inner .search-col').removeClass('active');
                        });
                    </script>-->
                                    <div class="btn-publish">
                        <a href="#">投稿</a>
                        <div class="btn-publish-child">
                            <ul class="btn-child clearfix">
                                <li><a href="http://my.freebuf.com/post/edit/" target="_blank">文章撰写</a></li>
                                <li><hr/></li>
                                <li><a href="http://my.freebuf.com/post/article/" target="_blank">投稿管理</a></li>
                                                        </ul>
                        </div>
                    </div>
                </div>
                <div class="nav-small">
                    <a href="#">&#xe634;</a>
                    <ul class="nav-child clearfix">
                                                        <li class=" index">
                                    <a href="http://www.freebuf.com">首页</a></li>
                                <li class="read-classify">
                                    <a href="#">分类阅读<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2 read-classify clearfix">
                                        <li>
                                            <strong>黑客</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                                <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                                <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                                <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                                <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                                <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                                <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                                <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                                <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                                <a href="http://www.freebuf.com/articles/es" target="_blank">企业安全</a>
                                                <a href="http://www.freebuf.com/ics-articles" target="_blank">工控安全</a>
                                            </div>
                                        </li>
                                        <li>
                                            <strong>极客</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                                <a href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                                            </div>
                                        </li>
                                        <li>
                                            <strong>特色</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/news/special" target="_blank">头条</a>
                                                <a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a>
                                                <a href="http://www.freebuf.com/fevents" target="_blank">活动</a>
                                                <a href="http://www.freebuf.com/video" target="_blank">视频</a>
                                                <a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a>
                                                <a href="http://www.freebuf.com/jobs" target="_blank">招聘</a>
                                                <a href="http://www.freebuf.com/paper/" target="_blank">报告</a>
                                            </div>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="http://zhuanlan.freebuf.com/" target="_blank">专栏</a></li>
                                <li><a href="http://open.freebuf.com" target="_blank">公开课</a></li>
                                <li><a href="http://shop.freebuf.com" target="_blank">商城</a></li>
                                <li>
                                    <a href="javascript:;" target="_blank">企业服务<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="https://www.vulbox.com/bounties/item-9-0-1" target="_blank"><strong>企业SRC</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://company.freebuf.com" target="_blank"><strong>企业空间</strong></a>
                                        </li>
                                        <li>
                                            <a href="https://www.vulbox.com/" target="_blank"><strong>安全测试</strong></a>
                                        </li>
                                        <li>
                                            <a href="https://www.riskivy.com/" target="_blank"><strong>风险感知</strong></a>
                                        </li>

                                    </ul>
                                </li>
                                <li>
                                    <a href="javascript:;" target="_blank">用户服务<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="http://www.freebuf.com/newsend" target="_blank"><strong>有奖投稿</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://zhuanlan.freebuf.com" target="_blank">
                                        </li>
                                        <li>
                                            <a href="https://www.vulbox.com/bounties/detail-72" target="_blank"><strong>提交漏洞</strong></a>
                                        </li>
                                        <li class="last">
                                            <a href="https://www.vulbox.com/bounties" target="_blank"><strong>参与众测</strong></a>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="javascript:;" target="_blank">文库<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="http://www.freebuf.com/wenku" target="_blank"><strong>文库</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://www.freebuf.com/special-subject" target="_blank"><strong>专题</strong></a>
                                        </li>
                                    </ul>
                                </li>
                                                    <li><a href="http://my.freebuf.com/post/edit" target="_blank">投稿</a></li>
                                                    <li><a href="https://account.tophant.com/register.html" class="login-btn">注册</a>
                            </li>
                            <li><a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a></li>
                                            </ul>
                </div>
            </div>
            <div class="dropdown-menu read-menu" id="read-menu">
                <div class="container">
                    <ul class="menu clearfix">
                        <li>
                            <strong>黑客</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                <a href="http://www.freebuf.com/articles/es" target="_blank">企业安全</a>
                                <a class="last" href="http://www.freebuf.com/ics-articles" target="_blank">工控安全</a>
                            </div>
                        </li>
                        <li>
                            <strong>极客</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                <a class="last" href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                            </div>
                        </li>
                        <li>
                            <strong>特色</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/news/special" target="_blank">头条</a>
                                <a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a>
                                <a href="http://www.freebuf.com/fevents" target="_blank">活动</a>
                                <a href="http://www.freebuf.com/video" target="_blank">视频</a>
                                <a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a>
                                <a href="http://www.freebuf.com/jobs" target="_blank">招聘</a>
                                <a class="last" href="http://www.freebuf.com/paper/" target="_blank">报告</a>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="dropdown-menu company-menu" id="company-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="https://www.vulbox.com/bounties/item-9-0-1" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-src.png"></span>
                                <span class="name">企业SRC</span>
                                <span class="intro">全/半托管式互联网漏洞收集管理</span>
                            </a>
                        </li>
                        <li>
                            <a href="http://company.freebuf.com" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-company.png"></span>
                                <span class="name">企业空间</span>
                                <span class="intro">为企业定制信息安全专属门户</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.vulbox.com/" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-safety.png"></span>
                                <span class="name">安全测试</span>
                                <span class="intro">国内领先的互联网安全众测服务</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="https://www.riskivy.com/" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-risk.png"></span>
                                <span class="name">风险感知</span>
                                <span class="intro">基于IT资产的自动化安全监控</span>
                            </a>
                        </li>

                    </ul>
                </div>
            </div>
            <div class="dropdown-menu user-menu" id="user-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="http://www.freebuf.com/newsend" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-write.png"></span>
                                <span class="name">有奖投稿</span>
                                <span class="intro">与整个行业分享你的经验与见解</span>
                            </a>
                        </li>
                        <li>
                            <a href="http://zhuanlan.freebuf.com" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-column.png"></span>
                                <span class="name">申请专栏</span>
                                <span class="intro">自由创作，打造自主内容品牌</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.vulbox.com/bounties/detail-72" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-leak.png"></span>
                                <span class="name">提交漏洞</span>
                                <span class="intro">与数万白帽一起，让互联网更安全</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="https://www.vulbox.com/bounties" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-test.png"></span>
                                <span class="name">参与众测</span>
                                <span class="intro">挖洞开启自由职业之路</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="dropdown-menu wenku-menu" id="wenku-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="http://www.freebuf.com/wenku" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-write.png"></span>
                                <span class="name">文库</span>
                                <span class="intro">最全的FB百科</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="http://www.freebuf.com/special-subject" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-test.png"></span>
                                <span class="name">专题</span>
                                <span class="intro">浓缩的安全精华汇总</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!----------header end---------->
<!--<script type="application/javascript">
    var  _value_tab = '';
    $(function(){
        var _that = '', _show_flag = 0;
        $('.header .header-container .nav .nav-child > li:not(input[data-value])').mouseover(function() {
            $('.header .dropdown-menu').stop().slideUp(50);
        });
        $('.header').mouseout(function() {
            $('.header .dropdown-menu').stop().slideUp(50);
        });
        /*$('.header .header-container .nav .nav-child > li').mouseover(function() {
         _value_tab = $(this).attr('data-value');
         $('#'+_value_tab).siblings('.dropdown-menu').stop().slideUp(50);
         $('#'+_value_tab).stop().slideDown(100);
         });*/
        $(".header .header-container .nav .nav-child > li").hoverDelay({
            hoverDuring: 500,
            hoverEvent: function(){
                $('#'+_value_tab).siblings('.dropdown-menu').stop().slideUp(50);
                $('#'+_value_tab).stop().slideDown(100);
            }
        });
        $('.header .dropdown-menu').mouseover(function() {
            _value_tab = $(this).attr('id');
            _that = this;
            $('.nav-child li[data-value="'+_value_tab+'"]').addClass('hover');
            $(this).stop().slideDown(50);
        }).mouseout(function() {
            $('.nav-child li[data-value="'+_value_tab+'"]').removeClass('hover');
            $(_that).stop().slideUp(50);
        });

        $(".nav-small .nav-child > li").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();

            if($(this).find('.nav-child2').is(":hidden")) {
                _show_flag = 1;
                $(this).find('.nav-child2').slideDown();
                $(this).find('.icon-arrow').addClass('bottom');
            }else {
                _show_flag = 0;
                $(this).find('.nav-child2').slideUp();
                $(this).find('.icon-arrow').removeClass('bottom');
            }
            $(this).siblings().find('.nav-child2').slideUp();
            $(this).siblings().find('.icon-arrow').removeClass('bottom');
        });
        //头部投稿按钮hover状态展开菜单
        $(".btn-publish-child > ul > li").hover(function(){
            $(this).addClass("active");
            $(this).siblings().removeClass("active");
        });

        $(document).click(function(event){
            var ev = ev || event;
            $(".login-after").find(".login-after-child").hide();
        });
        //点击用户信息，出现下拉菜单
        $("#user-info").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();
            $(".login-after").find(".login-after-child").toggle();
        });
        //顶部导航
        $(".nav-small").click(function(){
            $(this).find(".nav-child").slideToggle();
        });
        var that = '';
        $('.header .header-container .nav .nav-child > li').mouseover(function() {
            that = this;
            $(this).find('.dropdown-menu').stop().slideDown(200);
        }).mouseout(function() {
            $(that).find('.dropdown-menu').stop().slideUp(200);
        });
    });
    $(".nav-small .nav-child > li").click(function(event){
        var ev = ev || event;
        ev.stopPropagation();
        $(this).siblings('li').find('.dropdown-menu').hide();
        $(this).find(".dropdown-menu").toggle();
    });
    //鼠标经过(hover)事件的延时处理
    (function($){
        $.fn.hoverDelay = function(options){
            var defaults = {
                hoverDuring: 100,
                outDuring: 100,
                hoverEvent: function(){
                    $.noop();
                },
                outEvent: function(){
                    $.noop();
                }
            };
            var sets = $.extend(defaults,options || {});
            var hoverTimer, outTimer;
            return $(this).each(function(){
                $(this).hover(function(){
                    _value_tab = $(this).attr('data-value');
                    clearTimeout(outTimer);
                    hoverTimer = setTimeout(sets.hoverEvent, sets.hoverDuring);
                },function(){
                    clearTimeout(hoverTimer);
                    outTimer = setTimeout(sets.outEvent, sets.outDuring);
                });
            });
        }
    })(jQuery);
</script>-->
<script type="text/javascript" src="http://static.3001.net/js/header/header.js"></script><script>
    jQuery(window).load(function(){
      if(jQuery(window).width()>480){
        jQuery(".main-header").sticky({ topSpacing: 0 });
      }else{
        jQuery(".main-header nav").removeClass("navbar-fixed-top");
      }
      jQuery("#mar-right").sticky({ topSpacing: 105,bottomSpacing: 410 });
    });
</script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/layer.js"></script>
<script type="text/javascript" src="http://static.3001.net/js/pretty/prettify.js"></script>
<script type="text/javascript" src="http://static.3001.net/js/header/lazyload.js"></script>
<script type="text/javascript" charset="utf-8">
      jQuery(function() {
          jQuery("img").lazyload({
              effect : "fadeIn"
          });
      });
 </script>
<script type="text/javascript">
    window.onload = function(){
        prettyPrint();
    }
</script>
<script language="JavaScript" type="text/javascript">
//<![CDATA[
var va = "您已经点亮过了";
function acv_vote(id,option, m){
  if( m==null) m =''; m = m + '';
  jQuery('#acv_stat_'+m+id).html('Loading...');
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option="+option+"&ID="+id;
  jQuery.get(url,function(d){
    d =d.split('|');var s='#acv_stat_'+m+d[0];
    var sele = '#cos_support-'+m+id,unsele = '#cos_unsupport-'+m+id,tpjs = 'javascript:alert(va)';
    jQuery( s ).html( d[1] );jQuery(s).fadeOut(400,function(){jQuery(s).fadeIn();});
    if( d[2] == 1 ){ jQuery(sele).html(jQuery(sele).html()*1+1); }
    if( d[2] == -1 ){ jQuery(unsele).html(jQuery(unsele).html()*1+1); }
    jQuery('#vote4-'+id).attr('href',tpjs);jQuery('#vote4-2'+id).attr('href',tpjs);
    jQuery('#votea-'+id).attr('href',tpjs);jQuery('#votea-2'+id).attr('href',tpjs);
  });
}
  
$(document).on("mouseenter",".comment-tools",function(){
  $(this).find(".btn-report").show();
  $(this).find(".btn-report").addClass("hover");
}).on("mouseleave",".comment-tools",function(){
  var $_this = $(this);
  $(this).find(".btn-report").removeClass("hover");
  if(!$(this).find(".dropup").hasClass('open')){
    $(this).find(".btn-report").hide(); 
    $_this.find(".dropdown-menu").css("display","none");
  }else{
    setTimeout(function(){
      if(!$_this.find(".btn-report").hasClass("hover")){
        $_this.find(".dropup").removeClass("open");
        $_this.find(".dropdown-menu").css("display","none");
        $_this.find(".btn-report").hide(); 
      }
    },"500");
  }
})

$(document).on("click",".click_report",function(){
  $(this).parent().parent().css("display","none");
  var id = $(this).attr("data-id");
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option=0&ID="+id;
  $_this = $(this);
  jQuery.get(url,function(d){
    d =d.split('|');
    if(d[1]=='您已经点过灯了'){
      d[1] = '您已经举报过了';
    }
    if(d[1]=='Thank you'){
      d[1] = '举报成功';
    }
    $_this.parent().parent().parent().find(".btn-report").text(d[1]);
    $_this.parent().parent().parent().find(".btn-report").css("display","block");
  })
})

$(document).on("click",".btn-report",function(){
  if($(this).parent().hasClass('open')){
    $(this).parent().find(".dropdown-menu").css("display","block");
  }else{
    $(this).parent().find(".dropdown-menu").css("display","none");
  }
})
//]]>
</script>
<div class="column-article" data-column="">
            <div class="container pad-top35">
        <div class="row clearfix">
            <div class="col-md-9" id="getWidth">
                                    <div class="reletive search-xs-wrap">
                    <div class="form-group has-active search-col search-xs">
                        <form id="hpsform-new" class="navbar-search navbar-form" onsubmit="return dispatch()">
                            <div class="form-group">
                                <input id="q" class="input form-control" type="text" placeholder="关键字查找" autocomplete="off" title="关键字查找" name="q">
                                <button class="submit" type="submit"></button>
                            </div>
                        </form>
                    </div>
                </div>
                    <script type="text/javascript">
                        var dispatch = function () {
                            console.log(123)
                            var q = document.getElementById("q");
                            if (q.value == "") {
                                q = document.getElementById("bigq");
                            }
                            if (q.value != "") {
                                window.open('http://www.freebuf.com/?s=' + q.value, "_blank");
                                return false;
                            } else {
                                return false;
                            }
                        }
                    </script>
                                <div class="article-wrap panel panel-default">
                                                            <div class="articlecontent">
                                                    <div class="title">
                                <h2>
                                    技术分析：微软 Office 365平台SAML服务漏洞，可越权访问其他用户资源                                </h2>
                                <div class="property">
                                                                            <span class="name"><a href="http://www.freebuf.com/author/%e5%af%b0%e8%80%85" title="由 寰者 发布" rel="author">寰者</a></span>
                                                                        <span class="icon-f"><a href="http://zhuanlan.freebuf.com" target="_blank"><img src="http://image.3001.net/images/index/column-iden.png" title="专栏作者"></a></span>
                                    <span class="time">2016-05-10</span>
                                                                                                            <span class="look">共<strong>176344</strong>人围观
                                        ，发现 <strong>3</strong> 个不明物体 </span>                                      </span>
                                                                <span class="tags">
                                      <a href="http://www.freebuf.com/./articles/web">WEB安全</a><a href="http://www.freebuf.com/./vuls">漏洞</a></span>
                                    <span class="tags_01"></span>
                                </div>
                            </div>
                                                                                                <div id="contenttxt">
                            <p style="text-align: center;"><img alt="1.png" data-original="http://image.3001.net/images/20160508/14626382738803.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="426"></p>
<noscript><img alt="1.png" src="http://image.3001.net/images/20160508/14626382738803.png!small" width="690" height="426"></p></noscript>
<p><b style="color: rgb(0, 176, 80);">近期，两位安全研究人员，Klemen Bratec及&nbsp;Ioannis Kakavas，公布了他们发现的一个在Microsoft Office 365平台上的SAML服务漏洞，该漏洞可被利用进行跨域认证绕过，最终可对<span style="font-size: 16px;">365平台上的所有联邦</span>域造成影响。</b></p>
<p>攻击者可以利用这个漏洞突破访问权限限制，越权获取到受害用户的Office 365账户信息，并可借此访问他们的邮箱以及存储在 OneDrive（微软的云存储服务）上的文件等等。目前该漏洞已经被微软临时修复。</p>
<h2><b>SAML简介</b></h2>
<p>SAML即为安全声明标记语言，英文全称是Security Assertion Markup Language。它是一个基于XML的标准，用于在不同的安全域(security domain)之间交换认证和授权数据。其重要的作用在于跨域的单点登录。SAML实现的目标在于用户经过认证后，能对多个应用服务中的资源进行访问，无需重新进行身份验证（比如再次输入账户和密码等），而SAML便是这个过程中的“中间人”。</p>
<h2>web单点登录（Single Sign-on，SSO）</h2>
<p>单点登录是一种用于方便用户访问网络的技术。如上所述，用户只需在登录时进行一次注册，即可获得访问系统和应用软件的授权，以后便可以在各类应用中切换，不必多次输入用户名和口令来确定身份。在此条件下，管理员无需修改或干涉用户登录就能方便地实施希望得到的安全控制。</p>
<p>例如，我们很多时候登录一些网站时，发现除了注册新账户外，还可以通过其他应用账户（如QQ、微博等）来进行登录，其中便会使用到WEB单点登录技术。因为从用户重复性的角度出发的话，实际上有些网站的用户是重复的，那么对于这部分用户来说，如何在访问网站A之后，无需验证地去访问网站B，web单点登录技术便是一个不错的解决方案。</p>
<h2><b>SAML中若干重要的概念</b><br /></h2>
<p>我们从前文简单了解了这一部分主要会详细关注在SAML 2.0的原理上。目前，SAML标准中最为重要的组成部分如下，</p>
<p><b style="color: rgb(0, 112, 192);">1、声明（Assertions）</b></p>
<p>首先，声明是一个XML结构，其中包含了打包在声明中的用户信息。其中两个最为常用的声明类型是：</p>
<p>（1）认证声明（Authentication Assertions），包含用户已经对其身份进行认定的信息；</p>
<p>（2）属性声明（Attribute Assertions），包含关于用户的特定信息（如邮件地址，名称等等）。</p>
<p><b style="color: rgb(0, 112, 192);">2、协议（Protocols）</b></p>
<p>SAML协议描述了某些SAML要素（例如声明）是如何被封装在请求及系统是如何响应请求的，并给出了当进行登录或注销时，SAML实体（身份提供方和服务提供方）必须遵循的处理规则。也可以这么说，SAML协议定义了系统实体之间传递和处理SAML声明的协议集合，其中上述提到的验证请求协议将在之后介绍。</p>
<p><b style="color: rgb(0, 112, 192);">3、绑定（Bindings）</b></p>
<p>SAML绑定描述了一个SAML消息如何被映射到非SAML相关的消息格式和通信协议中。例如，我们在进行身份验证过程中，服务提供方（即用户去访问的应用资源）需与身份提供方进行通讯验证，那么如何从传输的消息中，提取双方需要的信息，这个就涉及到了绑定。<span style="font-size: 16px;">当需要从一个HTTP GET请求中取出URL中的查询字符串时，</span>HTTP重定向绑定（HTTP Redirect Binding<i></i>）定义了如何对该URL进行格式化，使之符合<span style="font-size: 16px;">SAML消息标准格式</span>。而在通讯过程中，SAML请求是经过SAMLRequest查询参数进行传递的，并经过压缩后，再进行基于base64的编码和URL解码。</p>
<p><b style="color: rgb(0, 112, 192);">4、身份提供方（Identity Provider）</b></p>
<p>身份提供方经过SAML 授权，并持有着关于用户的信息，<span style="font-size: 16px;">身份提供方</span>可以为使用者发布声明，使其能够于<span style="font-size: 16px;">身份提供方</span>的应用上进行权限内的操作。</p>
<p><b style="color: rgb(0, 112, 192);">5、服务提供方（Service Provider）</b></p>
<p>服务提供方是SAML消息的接收者，其接受来自身份提供方的用户信息，并开放符合该用户访问权限的资源。</p>
<h2><b>Web浏览器单点登录（SSO）的例子</b><br /></h2>
<p>接下来可以看一个基于Web浏览器单点登录框架的简单例子，我们可以通过这个例子来更加深入理解SAML。首先，在进行单点登录的过程中，服务提供方使用 HTTP重定向绑定和身份提供方使用 HTTP POST绑定。其中整个过程涉及到的部分如下，</p>
<blockquote><p>1、用户使用的浏览器</p>
<p>2、身份提供方</p>
<p>3、服务提供方</p>
</blockquote>
<p>我们从下图中也可以看到关于三者之间的交互，</p>
<p style="text-align: center;"><img alt="2.png" data-original="http://image.3001.net/images/20160508/14626979544030.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="485"></p>
<noscript><img alt="2.png" src="http://image.3001.net/images/20160508/14626979544030.png!small" width="690" height="485"></p></noscript>
<p>一、在我们这个例子中，这个单点登录过程始于一个用户尝试访问一个受保护的资源（或者简单来说，可以理解为请求登录）。服务提供方拥有允许或者拒绝联合登录的功能配置，以及实时地将用户重定向到一个发现服务接口，以便来选择他们的身份提供方。通过自动匹配选择，可让服务提供方知道和信任所其选择的身份提供方，接着服务提供方会创建一个SAML身份验证请求，具体如下：</p>
<pre><code><span class="nt">&lt;samlp:AuthnRequest</span> <span class="na">xmlns:samlp=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:protocol"</span>
                    <span class="na">ID=</span><span class="s">"_bec424fa5103428909a30ff1e31168327f79474984"</span> <span class="na">Version=</span><span class="s">"2.0"</span>
                    <span class="na">IssueInstant=</span><span class="s">"2016-04-14T11:39:34Z"</span> <span class="na">ForceAuthn=</span><span class="s">"false"</span>
                    <span class="na">IsPassive=</span><span class="s">"false"</span>
                    <span class="na">ProtocolBinding=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST"</span>
                    <span class="na">AssertionConsumerServiceURL=</span><span class="s">"https://myserviceprovider.atsomeorg.com/Shibboleth.sso/SAML2/POST"</span><span class="nt">&gt;</span>
     <span class="nt">&lt;saml:Issuer</span> <span class="na">xmlns:saml=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:assertion"</span><span class="nt">&gt;</span>

https://myserviceprovider.atsomeorg.com/shibboleth

     <span class="nt">&lt;/saml:Issuer&gt;</span>
     <span class="nt">&lt;samlp:NameIDPolicy</span>
            <span class="na">xmlns:samlp=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:protocol"</span>
            <span class="na">Format=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:nameid-format:transient"</span>
            <span class="na">AllowCreate=</span><span class="s">"true"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/samlp:AuthnRequest&gt;
</span></code></pre>
<p>在请求的信息中，有两个重要部分需要了解下，</p>
<blockquote><p>1、编码中的Issuer（发行人）代表了服务提供方的实体ID，其表现形式为一个 URI（统一资源标识符），像一串身份标识字符串一样的。Issuer（发行人）包含了服务提供方请求用户身份验证的信息。</p>
<p>2、IssueIstant，其包含的信息体现了当服务提供方发出请求后，生成的内部识别ID ,用以匹配在接受到该条请求后发出的SAML响应。</p>
</blockquote>
<p>二、然后用户的浏览器被重定向到身份提供方绑定的URL，SAML Authentication Request（SAML 验证请求）是通过 HTTP GET中的一串查询参数（之后请求的信息会被进行压缩，再经过 base64以及URL编码再进行传递）</p>
<p>三、在接收来自用户浏览器的SAML请求后，身份提供方检查发送请求验证信息的服务提供方身份，并在成功认证服务提供方身份后，验证请求的内容，提示用户进行登录认证（输入账户密码）。如果用户认证成功，身份提供方将生成SAML回应，具体如下：</p>
<pre><code><span class="nt">&lt;samlp:Response</span> <span class="na">xmlns:samlp=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:protocol"</span>
                <span class="na">xmlns:saml=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:assertion"</span>
                <span class="na">ID=</span><span class="s">"_8e8dc5f69a98cc4c1ff3427e5ce34606fd672f91e6"</span>
                <span class="na">Version=</span><span class="s">"2.0"</span> <span class="na">IssueInstant=</span><span class="s">"2016-04-14T11:40:48Z"</span>
                <span class="na">Destination=</span><span class="s">"https://myserviceprovider.atsomeorg.com/Shibboleth.sso/SAML2/POST"</span>
                <span class="na">InResponseTo=</span><span class="s">"_bec424fa5103428909a30ff1e31168327f79474984"</span><span class="nt">&gt;</span>
 <span class="nt">&lt;saml:Issuer&gt;</span>http://idp.example.com/idp/shibboleth<span class="nt">&lt;/saml:Issuer&gt;</span>
 <span class="nt">&lt;samlp:Status&gt;</span>
   <span class="nt">&lt;samlp:StatusCode</span> <span class="na">Value=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:status:Success"</span><span class="nt">/&gt;</span>
 <span class="nt">&lt;/samlp:Status&gt;</span>
 <span class="nt">&lt;saml:Assertion</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
                 <span class="na">xmlns:xs=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span>
                 <span class="na">ID=</span><span class="s">"pfx65c8c6cd-b03b-8634-fd54-636fa66e7722"</span>
                 <span class="na">Version=</span><span class="s">"2.0"</span> <span class="na">IssueInstant=</span><span class="s">"2016-04-14T11:40:48Z"</span><span class="nt">&gt;</span>
   <span class="nt">&lt;saml:Issuer&gt;</span>http://idp.example.com/idp/shibboleth<span class="nt">&lt;/saml:Issuer&gt;</span>
   <span class="nt">&lt;ds:Signature</span> <span class="na">xmlns:ds=</span><span class="s">"http://www.w3.org/2000/09/xmldsig#"</span><span class="nt">&gt;</span>
   <span class="nt">&lt;ds:SignedInfo&gt;</span>
       <span class="nt">&lt;ds:CanonicalizationMethod</span> <span class="na">Algorithm=</span><span class="s">"http://www.w3.org/2001/10/xml-exc-c14n#"</span><span class="nt">/&gt;</span>
       <span class="nt">&lt;ds:SignatureMethod</span> <span class="na">Algorithm=</span><span class="s">"http://www.w3.org/2000/09/xmldsig#rsa-sha1"</span><span class="nt">/&gt;</span>
     <span class="nt">&lt;ds:Reference</span> <span class="na">URI=</span><span class="s">"#pfx65c8c6cd-b03b-8634-fd54-636fa66e7722"</span><span class="nt">&gt;</span>
     <span class="nt">&lt;ds:Transforms&gt;</span>
       <span class="nt">&lt;ds:Transform</span> <span class="na">Algorithm=</span><span class="s">"http://www.w3.org/2000/09/xmldsig#enveloped-signature"</span><span class="nt">/&gt;</span>
       <span class="nt">&lt;ds:Transform</span> <span class="na">Algorithm=</span><span class="s">"http://www.w3.org/2001/10/xml-exc-c14n#"</span><span class="nt">/&gt;</span>
     <span class="nt">&lt;/ds:Transforms&gt;</span>
     <span class="nt">&lt;ds:DigestMethod</span> <span class="na">Algorithm=</span><span class="s">"http://www.w3.org/2000/09/xmldsig#sha1"</span><span class="nt">/&gt;</span>
       <span class="nt">&lt;ds:DigestValue&gt;</span>gxnHkIizISbLkkB1vSWapmWuQzk=<span class="nt">&lt;/ds:DigestValue&gt;</span>
     <span class="nt">&lt;/ds:Reference&gt;</span>
   <span class="nt">&lt;/ds:SignedInfo&gt;</span>
   <span class="nt">&lt;ds:SignatureValue&gt;</span>Qn69P4a3PQTISfqk/0t2JdJqG1nlswFQt8bNWPZ+K41EIYkCcTyuwlKnCzlTvU1YgNXIvHcFEyKjYAge+s3gwqecATI+yRB9OtD34YxBC4kyGcbq/ETQxIQ515xehfRxLrQjUpRzgHQXMLSjGdgjeelfKsHeSczA9Hp44kasQSs=<span class="nt">&lt;/ds:SignatureValue&gt;</span>
   <span class="nt">&lt;ds:KeyInfo&gt;</span>
     <span class="nt">&lt;ds:X509Data&gt;</span>
       <span class="nt">&lt;ds:X509Certificate&gt;</span>MIICajCCAdOgAwIBAgIBADANBgkqhkiG9w0BAQ0FADBSMQswCQYDVQQGEwJ1czETMBEGA1UECAwKQ2FsaWZvcm5pYTEVMBMGA1UECgwMT25lbG9naW4gSW5jMRcwFQYDVQQDDA5zcC5leGFtcGxlLmNvbTAeFw0xNDA3MTcxNDEyNTZaFw0xNTA3MTcxNDEyNTZaMFIxCzAJBgNVBAYTAnVzMRMwEQYDVQQIDApDYWxpZm9ybmlhMRUwEwYDVQQKDAxPbmVsb2dpbiBJbmMxFzAVBgNVBAMMDnNwLmV4YW1wbGUuY29tMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDZx+ON4IUoIWxgukTb1tOiX3bMYzYQiwWPUNMp+Fq82xoNogso2bykZG0yiJm5o8zv/sd6pGouayMgkx/2FSOdc36T0jGbCHuRSbtia0PEzNIRtmViMrt3AeoWBidRXmZsxCNLwgIV6dn2WpuE5Az0bHgpZnQxTKFek0BMKU/d8wIDAQABo1AwTjAdBgNVHQ4EFgQUGHxYqZYyX7cTxKVODVgZwSTdCnwwHwYDVR0jBBgwFoAUGHxYqZYyX7cTxKVODVgZwSTdCnwwDAYDVR0TBAUwAwEB/zANBgkqhkiG9w0BAQ0FAAOBgQByFOl+hMFICbd3DJfnp2Rgd/dqttsZG/tyhILWvErbio/DEe98mXpowhTkC04ENprOyXi7ZbUqiicF89uAGyt1oqgTUCD1VsLahqIcmrzgumNyTwLGWo17WDAa1/usDhetWAMhgzF/Cnf5ek0nK00m0YZGyc4LzgD0CROMASTWNg==
       <span class="nt">&lt;/ds:X509Certificate&gt;</span>
     <span class="nt">&lt;/ds:X509Data&gt;</span>
   <span class="nt">&lt;/ds:KeyInfo&gt;</span>
   <span class="nt">&lt;/ds:Signature&gt;</span>
   <span class="nt">&lt;saml:Subject&gt;</span>
     <span class="nt">&lt;saml:NameID</span>
        <span class="na">SPNameQualifier=</span><span class="s">"https://myserviceprovider.atsomeorg.com/shibboleth"</span>
        <span class="na">Format=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:nameid-format:transient"</span><span class="nt">&gt;</span>
        _ce3d2948b4cf20146dee0a0b3dd6f69b6cf86f62d7
     <span class="nt">&lt;/saml:NameID&gt;</span>
     <span class="nt">&lt;saml:SubjectConfirmation</span> <span class="na">Method=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:cm:bearer"</span><span class="nt">&gt;</span>
       <span class="nt">&lt;saml:SubjectConfirmationData</span>
           <span class="na">NotOnOrAfter=</span><span class="s">"2016-04-14T11:50:48Z"</span>
           <span class="na">Recipient=</span><span class="s">"https://myserviceprovider.atsomeorg.com/Shibboleth.sso/SAML2/POST"</span>
           <span class="na">InResponseTo=</span><span class="s">"_bec424fa5103428909a30ff1e31168327f79474984"</span><span class="nt">/&gt;</span>
     <span class="nt">&lt;/saml:SubjectConfirmation&gt;</span>
   <span class="nt">&lt;/saml:Subject&gt;</span>
   <span class="nt">&lt;saml:Conditions</span> <span class="na">NotBefore=</span><span class="s">"2016-04-14T11:40:48Z"</span>
                    <span class="na">NotOnOrAfter=</span><span class="s">"2016-04-14T11:50:48Z"</span><span class="nt">&gt;</span>
     <span class="nt">&lt;saml:AudienceRestriction&gt;</span>
       <span class="nt">&lt;saml:Audience&gt;</span>https://myserviceprovider.atsomeorg.com/shibboleth<span class="nt">&lt;/saml:Audience&gt;</span>
     <span class="nt">&lt;/saml:AudienceRestriction&gt;</span>
   <span class="nt">&lt;/saml:Conditions&gt;</span>
   <span class="nt">&lt;saml:AuthnStatement</span> <span class="na">AuthnInstant=</span><span class="s">"2016-04-14T11:40:48Z"</span>
                        <span class="na">SessionNotOnOrAfter=</span><span class="s">"2016-04-14T11:50:48Z"</span>
                        <span class="na">SessionIndex=</span><span class="s">"_be9967abd904ddcae3c0eb4189adbe3f71e327cf93"</span><span class="nt">&gt;</span>
     <span class="nt">&lt;saml:AuthnContext&gt;</span>
       <span class="nt">&lt;saml:AuthnContextClassRef&gt;</span>
           urn:oasis:names:tc:SAML:2.0:ac:classes:Password
       <span class="nt">&lt;/saml:AuthnContextClassRef&gt;</span>
     <span class="nt">&lt;/saml:AuthnContext&gt;</span>
   <span class="nt">&lt;/saml:AuthnStatement&gt;</span>
   <span class="nt">&lt;saml:AttributeStatement&gt;</span>
     <span class="nt">&lt;saml:Attribute</span> <span class="na">Name=</span><span class="s">"uid"</span>
                     <span class="na">NameFormat=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:attrname-format:basic"</span><span class="nt">&gt;</span>
       <span class="nt">&lt;saml:AttributeValue</span> <span class="na">xsi:type=</span><span class="s">"xs:string"</span><span class="nt">&gt;</span>test<span class="nt">&lt;/saml:AttributeValue&gt;</span>
     <span class="nt">&lt;/saml:Attribute&gt;</span>
     <span class="nt">&lt;saml:Attribute</span> <span class="na">Name=</span><span class="s">"mail"</span>
                     <span class="na">NameFormat=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:attrname-format:basic"</span><span class="nt">&gt;</span>
       <span class="nt">&lt;saml:AttributeValue</span> <span class="na">xsi:type=</span><span class="s">"xs:string"</span><span class="nt">&gt;</span>test@example.com<span class="nt">&lt;/saml:AttributeValue&gt;</span>
     <span class="nt">&lt;/saml:Attribute&gt;</span>
     <span class="nt">&lt;saml:Attribute</span> <span class="na">Name=</span><span class="s">"eduPersonAffiliation"</span>
                     <span class="na">NameFormat=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:attrname-format:basic"</span><span class="nt">&gt;</span>
       <span class="nt">&lt;saml:AttributeValue</span> <span class="na">xsi:type=</span><span class="s">"xs:string"</span><span class="nt">&gt;</span>users<span class="nt">&lt;/saml:AttributeValue&gt;</span>
       <span class="nt">&lt;saml:AttributeValue</span> <span class="na">xsi:type=</span><span class="s">"xs:string"</span><span class="nt">&gt;</span>examplerole1<span class="nt">&lt;/saml:AttributeValue&gt;</span>
     <span class="nt">&lt;/saml:Attribute&gt;</span>
   <span class="nt">&lt;/saml:AttributeStatement&gt;</span>
 <span class="nt">&lt;/saml:Assertion&gt;</span>
<span class="nt">&lt;/samlp:Response&gt;</span></code></pre>
<p>四、接下来，引导用户浏览器回应一个HTTP POST请求到服务提供方，在本次案例中假设为 <a href="https://myserviceprovider.atsomeorg.com/Shibboleth.sso/SAML2/POST">https://myserviceprovider.atsomeorg.com/Shibboleth.sso/SAML2/POST</a><font color="#3a4145">。其中，有部分内容也是需要了解的，具体如下。</font></p>
<blockquote><p><font color="#3a4145">1、InResponseTo，包含了一个ID值，该ID会与先前服务提供方发送请求的时候产生的内部标识ID进行匹配（避免重放攻击）；<br /></font></p>
<p><font color="#3a4145">2、IssueIstant, NotBefore 以及NotOnOrAfter 定义了 SAML响应（以及声明）的有效时间，也是为了避免重放攻击；</font></p>
<p><font color="#3a4145">3、声明还包含了一个 Isssuer字段，其中具有一个 url,因此服务提供方可以确认身份提供方的身份（是否符合此前请求指定的身份提供方地址）；</font></p>
<p><font color="#3a4145">4、AudienceRestriction部分，则定义了可对该声明进行读取的服务提供方，而其他服务提供方并无权限进行读取。</font></p>
<p><font color="#3a4145">5、Subject，用于识别验证用户身份；</font></p>
<p><font color="#3a4145">6、AttributeStatement部分，包含用户进行验证的信息，其中也包括各种属性以及它们的值；</font></p>
</blockquote>
<p><font color="#3a4145">在这份声明中（也包括全部的 SAML响应）是基于XML签名（ <a href="https://en.wikipedia.org/wiki/XML_Signature">XML Signature</a>）来保护其完整性，检查其在传输过程中并未遭受篡改。<br /></font></p>
<p><font color="#3a4145">五、在接收到SAML响应后，服务提供方可以验证其内容和结构，并验证签名，随后通过了用户认证，分配用户一个Cookie，启动与用户间的Web会话。</font></p>
<h2><font color="#3a4145">问题在哪里？</font></h2>
<p>那么到这里，或许你会有些疑惑，</p>
<blockquote><p>1、服务提供方如何知道并信任身份提供方？</p>
<p>2、身份提供方如何知道并信任服务提供方？</p>
<p>3、身份提供方如何对声明进行签名？</p>
<p>4、服务提供方在接受到一份声明后如何验证其完整性？</p>
</blockquote>
<p>实际上，在验证之前，身份提供方和服务提供方会进行相互之间的信任处理。为了实现在请求和响应的交互过程中，身份及信息的验证，两者之间需要交换元数据。我们可以理解为，此处的元数据包含了一个公钥，对应着身份提供方对声明进行签名加密所使用的私钥，每一个实体（可以是用户、服务提供方或是身份提供方）所绑定的URL以及支持或响应的算法等等。那么基于这样的出发点，有两种方法可让他们获取彼此的元数据：</p>
<p>1、双方以一种安全的方式交换元数据，确立信任关系；</p>
<p>2、或者通过加入一个联邦（Federation），将这种信任关系委托給第三方机构。然后联邦运营者会设定任务，收集来自所有参与的实体（身份提供方和服务提供方）的元数据，并发布这些数据。每个身份提供方和服务供应方都会提交其元数据来获取有关参与该联邦的其他实体的信息。</p>
<h2><b>Office 365 的SAML交互是如何运行的？</b><br /></h2>
<p><font color="#3a4145">Office 365平台服务提供方使用的是一个WS-Trust以及 SAML 2.0 web 浏览器单点登录框架的混合体。Office 365平台支持通过WS-Trust以及SAML 2.0 web 浏览器进行单点登录两种方式进行访问，但两者之间并不孤立。<br /></font></p>
<p><font color="#3a4145">实际上，WS-Trust为我们提供了一种安全令牌服务，比如令牌的颁发（Issuance）、续订（Renewal）和终止（Cancel）等。但SAML的服务提供方会将SAML 2.0标准的传输信息，使用令牌（ token）转换服务，在内部将 SAML信息转化为WS-Trust信息。而因为上述的令牌转换服务，所以此次在 SAML服务提供方发现的漏洞，也会影响到WS-Trust单点登录。<br /></font></p>
<p><font color="#3a4145">然而，为了简单起见，在理解本文Office 365 的服务提供方时，均可认为是使用SAML进行单点登录。<br /></font></p>
<p><font color="#3a4145">不过有一点需要强调的是， 对于经过SAML的账户验证，Office 365并不支持实时资源配置，所以对于使用账户进行单点登录的用户，需要已经在Azure AD上有租户才行。这个需要经过Directory同步或者经过用户在IDM 系统的帮助下进行配置，不过这已经超出了本文的范围，这里先略过不谈。<br /></font></p>
<p><font color="#3a4145">从一个身份提供方到 Office 365服务提供方，需要在请求消息中发布的属性，以便进行信息匹配，包括以下两个：<br /></font></p>
<p><font color="#3a4145">1、UPN（User principal name）用户主体名称，包含IDP（即身份提供方）Email名称等信息；</font></p>
<p><font color="#3a4145">2、ImmutableId，用户的唯一识别符，存放于SAML声明的Subject中。</font></p>
<p><font color="#3a4145">接下来，我们可以看下Office&nbsp;365平台的登录情况，</font></p>
<p>流程始于用户开始访问 <a href="https://portal.office.com/">Office 365 portal</a>，接着被重定向到 <a href="https://login.microsoftonline.com/login.srf">https://login.microsoftonline.com/login.srf</a>，而响应形式如下，</p>
<p style="text-align: center;"><img alt="4.png" data-original="http://image.3001.net/images/20160508/14626995414319.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="382"></p>
<noscript><img alt="4.png" src="http://image.3001.net/images/20160508/14626995414319.png!small" width="690" height="382"></p></noscript>
<p>在键入用户名称以及按下“TAB”或点击密码输入区域，该页面将构建一个XHR （XMLHttpRequest）发送到<a href="https://login.microsoftonline.com/common/userrealm">https://login.microsoftonline.com/common/userrealm</a>，而为了验证用户的域（可以简单理解为用户归属的企业）是否能与Office 365平台上的租户（可以理解为某企业所租赁的服务）相匹配。</p>
<pre><code><span class="nf">GET</span> <span class="nn">/common/userrealm/?user=ikakavas@testdomain.gr&amp;api-version=2.1&amp;stsRequest=rQIIAbNSzigpKSi20tcvyC8qSczRy09Ly0xO1UvOz9XLL0rPTAGxioS4BMruuVuZ2Fh77Wj-e6KxLMF2FaMaTp36OYl5KZl56XqJxQUVFxgZu5hYDA2MjTcxsfo6-zp5nmCacFbuFpOgf1G6Z0p4sVtqSmpRYklmft4jJt7Q4tQi_7ycypD87NS8Scx8OfnpmXnxxUVp8Wk5-eVAAaDxBYnJJfElmcnZqSW7mFVSU00tTCxTUnRNkpOTdU2Sksx0kwxSzXRTzZMtTC1ME00Mk1MOsGwIucAi8IOFcREr0C-3A6ZLrn182Gt-tWV-vVlpwi5OW-L8Yl-SWJSeWmKrapSWkpqWWJpTAhYGAA2&amp;checkForMicrosoftAccount=false</span> <span class="k" style="font-weight: bold">HTTP</span><span class="o" style="font-weight: bold">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">login.microsoftonline.com</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:45.0) Gecko/20100101 Firefox/45.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Accept-Language</span><span class="p">:</span> <span class="s">en-US,en;q=0.5</span>
<span class="na">Accept-Encoding</span><span class="p">:</span> <span class="s">gzip, deflate, br</span>
<span class="na">DNT</span><span class="p">:</span> <span class="s">1</span>
<span class="na">X-Requested-With</span><span class="p">:</span> <span class="s">XMLHttpRequest</span>
<span class="na">Referer</span><span class="p">:</span> <span class="s">https://login.microsoftonline.com/login.srf?wa=wsignin1.0&amp;rpsnv=4&amp;ct=1460721662&amp;rver=6.7.6640.0&amp;wp=MCMBI&amp;wreply=https%3a%2f%2fportal.office.com%2flanding.aspx%3ftarget%3d%252fdefault.aspx&amp;lc=1033&amp;id=501392&amp;msafed=0&amp;client-request-id=3a47de76-3c34-4a3b-b883-fdc88176603d</span></code></pre>
<p>如果域已被知道及配置成联邦身份，用户的浏览器将被引导构建一个 HTTP POST请求到 HTTP-POST绑定的身份提供方的 URL，具体的信息如下，</p>
<pre><code><span class="nt">&lt;samlp:AuthnRequest</span> <span class="na">xmlns:samlp=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:protocol"</span>
                    <span class="na">xmlns:saml=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:assertion"</span>
                    <span class="na">ID=</span><span class="s">"_f6daef39-fb54-407e-abb4-c75d261b75ae"</span>
                    <span class="na">IssueInstant=</span><span class="s">"2016-04-11T21:13:44Z"</span>
                    <span class="na">Version=</span><span class="s">"2.0"</span>
                    <span class="na">AssertionConsumerServiceIndex=</span><span class="s">"0"</span>
                    <span class="nt">&gt;</span>
   <span class="nt">&lt;saml:Issuer&gt;</span>urn:federation:MicrosoftOnline<span class="nt">&lt;/saml:Issuer&gt;</span>
   <span class="nt">&lt;samlp:NameIDPolicy</span> <span class="na">Format=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:nameid-format:persistent"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/samlp:AuthnRequest&gt;</span></code></pre>
<p>用户实时在身份提供方中进行身份验证，如下，</p>
<p style="text-align: center;"><img alt="5.png" data-original="http://image.3001.net/images/20160508/14626998075751.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="320" height="384.50592885375494"></p>
<noscript><img alt="5.png" src="http://image.3001.net/images/20160508/14626998075751.png!small" width="320" height="384.50592885375494"></p></noscript>
<p>随后浏览器会被引导到创建一个HTTP POST返回到 Office 365 HTTP-POST绑定的 URL，这里为<a href="https://login.microsoftonline.com/login.srf">https://login.microsoftonline.com/login.srf</a>&nbsp;。通过包含着声明的SAML响应。一个简单的响应例子如下，</p>
<pre><code><span class="nt">&lt;saml2p:Response</span> <span class="na">Destination=</span><span class="s">"https://login.microsoftonline.com/login.srf"</span>
                 <span class="na">ID=</span><span class="s">"_cefc5f992f2e455d7b3e52522fc479db"</span>
                 <span class="na">InResponseTo=</span><span class="s">"_f6daef39-fb54-407e-abb4-c75d261b75ae"</span>
                 <span class="na">IssueInstant=</span><span class="s">"2016-04-11T21:14:35.365Z"</span> <span class="na">Version=</span><span class="s">"2.0"</span>
                 <span class="na">xmlns:saml2p=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:protocol"</span>
                 <span class="na">xmlns:xsd=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span><span class="nt">&gt;</span>
   <span class="nt">&lt;saml2:Issuer</span> <span class="na">xmlns:saml2=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:assertion"</span><span class="nt">&gt;</span>

https://idp.admin.grnet.gr/idp/shibboleth

   <span class="nt">&lt;/saml2:Issuer&gt;</span>
   <span class="nt">&lt;ds:Signature</span> <span class="na">xmlns:ds=</span><span class="s">"http://www.w3.org/2000/09/xmldsig#"</span><span class="nt">&gt;</span>
       <span class="nt">&lt;ds:SignedInfo&gt;</span>
           <span class="nt">&lt;ds:CanonicalizationMethod</span>
               <span class="na">Algorithm=</span><span class="s">"http://www.w3.org/2001/10/xml-exc-c14n#"</span> <span class="nt">/&gt;</span>
           <span class="nt">&lt;ds:SignatureMethod</span>
               <span class="na">Algorithm=</span><span class="s">"http://www.w3.org/2000/09/xmldsig#rsa-sha1"</span> <span class="nt">/&gt;</span>
           <span class="nt">&lt;ds:Reference</span> <span class="na">URI=</span><span class="s">"#_cefc5f992f2e455d7b3e52522fc479db"</span><span class="nt">&gt;</span>
               <span class="nt">&lt;ds:Transforms&gt;</span>
                   <span class="nt">&lt;ds:Transform</span>
                       <span class="na">Algorithm=</span><span class="s">"http://www.w3.org/2000/09/xmldsig#enveloped-signature"</span> <span class="nt">/&gt;</span>
                   <span class="nt">&lt;ds:Transform</span>
                       <span class="na">Algorithm=</span><span class="s">"http://www.w3.org/2001/10/xml-exc-c14n#"</span><span class="nt">&gt;</span>
                       <span class="nt">&lt;ec:InclusiveNamespaces</span>
                           <span class="na">PrefixList=</span><span class="s">"xsd"</span>
                           <span class="na">xmlns:ec=</span><span class="s">"http://www.w3.org/2001/10/xml-exc-c14n#"</span><span class="nt">/&gt;</span>
                   <span class="nt">&lt;/ds:Transform&gt;</span>
               <span class="nt">&lt;/ds:Transforms&gt;</span>
               <span class="nt">&lt;ds:DigestMethod</span> <span class="na">Algorithm=</span><span class="s">"http://www.w3.org/2000/09/xmldsig#sha1"</span> <span class="nt">/&gt;</span>
               <span class="nt">&lt;ds:DigestValue&gt;</span>dc1f3jn97lZ6FWdxGxsEWxXNsTM=<span class="nt">&lt;/ds:DigestValue&gt;</span>
           <span class="nt">&lt;/ds:Reference&gt;</span>
       <span class="nt">&lt;/ds:SignedInfo&gt;</span>
       <span class="nt">&lt;ds:SignatureValue&gt;</span>
       Removed for brevity
       <span class="nt">&lt;/ds:SignatureValue&gt;</span>
       <span class="nt">&lt;ds:KeyInfo&gt;</span>
           <span class="nt">&lt;ds:X509Data&gt;</span>
               <span class="nt">&lt;ds:X509Certificate&gt;</span>
               Removed for brevity
               <span class="nt">&lt;/ds:X509Certificate&gt;</span>
          <span class="nt">&lt;/ds:X509Data&gt;</span>
       <span class="nt">&lt;/ds:KeyInfo&gt;</span>
   <span class="nt">&lt;/ds:Signature&gt;</span>
   <span class="nt">&lt;saml2p:Status&gt;</span>
       <span class="nt">&lt;saml2p:StatusCode</span> <span class="na">Value=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:status:Success"</span> <span class="nt">/&gt;</span>
   <span class="nt">&lt;/saml2p:Status&gt;</span>
   <span class="nt">&lt;saml2:Assertion</span> <span class="na">ID=</span><span class="s">"_b971f4e7f575bcc9cbc9034246c62c98"</span>
                    <span class="na">IssueInstant=</span><span class="s">"2016-04-11T21:14:35.365Z"</span> <span class="na">Version=</span><span class="s">"2.0"</span>
                    <span class="na">xmlns:saml2=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:assertion"</span>
                    <span class="na">xmlns:xsd=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span><span class="nt">&gt;</span>
       <span class="nt">&lt;saml2:Issuer&gt;</span>https://idp.admin.grnet.gr/idp/shibboleth<span class="nt">&lt;/saml2:Issuer&gt;</span>
       <span class="nt">&lt;ds:Signature</span> <span class="na">xmlns:ds=</span><span class="s">"http://www.w3.org/2000/09/xmldsig#"</span><span class="nt">&gt;</span>
           <span class="nt">&lt;ds:SignedInfo&gt;</span>
               <span class="nt">&lt;ds:CanonicalizationMethod</span>
                   <span class="na">Algorithm=</span><span class="s">"http://www.w3.org/2001/10/xml-exc-c14n#"</span> <span class="nt">/&gt;</span>
               <span class="nt">&lt;ds:SignatureMethod</span>
                   <span class="na">Algorithm=</span><span class="s">"http://www.w3.org/2000/09/xmldsig#rsa-sha1"</span> <span class="nt">/&gt;</span>
               <span class="nt">&lt;ds:Reference</span> <span class="na">URI=</span><span class="s">"#_b971f4e7f575bcc9cbc9034246c62c98"</span><span class="nt">&gt;</span>
                   <span class="nt">&lt;ds:Transforms&gt;</span>
                       <span class="nt">&lt;ds:Transform</span>
                           <span class="na">Algorithm=</span><span class="s">"http://www.w3.org/2000/09/xmldsig#enveloped-signature"</span> <span class="nt">/&gt;</span>
                       <span class="nt">&lt;ds:Transform</span>
                           <span class="na">Algorithm=</span><span class="s">"http://www.w3.org/2001/10/xml-exc-c14n#"</span><span class="nt">&gt;</span>
                           <span class="nt">&lt;ec:InclusiveNamespaces</span>
                               <span class="na">PrefixList=</span><span class="s">"xsd"</span>
                               <span class="na">xmlns:ec=</span><span class="s">"http://www.w3.org/2001/10/xml-exc-c14n#"</span><span class="nt">/&gt;</span>
                       <span class="nt">&lt;/ds:Transform&gt;</span>
                   <span class="nt">&lt;/ds:Transforms&gt;</span>
                   <span class="nt">&lt;ds:DigestMethod</span> <span class="na">Algorithm=</span><span class="s">"http://www.w3.org/2000/09/xmldsig#sha1"</span> <span class="nt">/&gt;</span>
                   <span class="nt">&lt;ds:DigestValue&gt;</span>WBgE+nW+3g9P5XpiZwGE06MT//g=<span class="nt">&lt;/ds:DigestValue&gt;</span>
               <span class="nt">&lt;/ds:Reference&gt;</span>
           <span class="nt">&lt;/ds:SignedInfo&gt;</span>
           <span class="nt">&lt;ds:SignatureValue&gt;</span>
           Removed for brevity
           <span class="nt">&lt;/ds:SignatureValue&gt;</span>
           <span class="nt">&lt;ds:KeyInfo&gt;</span>
               <span class="nt">&lt;ds:X509Data&gt;</span>
                   <span class="nt">&lt;ds:X509Certificate&gt;</span>
                   Removed for brevity
                   <span class="nt">&lt;/ds:X509Certificate&gt;</span>
               <span class="nt">&lt;/ds:X509Data&gt;</span>
           <span class="nt">&lt;/ds:KeyInfo&gt;</span>
       <span class="nt">&lt;/ds:Signature&gt;</span>
       <span class="nt">&lt;saml2:Subject&gt;</span>
           <span class="nt">&lt;saml2:NameID</span> <span class="na">Format=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:nameid-format:persistent"</span><span class="nt">&gt;</span>
                This is where my ImmutableId is
           <span class="nt">&lt;/saml2:NameID&gt;</span>
           <span class="nt">&lt;saml2:SubjectConfirmation</span> <span class="na">Method=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:cm:bearer"</span><span class="nt">&gt;</span>
               <span class="nt">&lt;saml2:SubjectConfirmationData</span>
                  <span class="na">Address=</span><span class="s">"2a02:214d:811b:7200:dc15:b7bc:a304:3738"</span>
                  <span class="na">InResponseTo=</span><span class="s">"_f6daef39-fb54-407e-abb4-c75d261b75ae"</span>
                  <span class="na">NotOnOrAfter=</span><span class="s">"2016-04-11T21:19:35.384Z"</span>
                  <span class="na">Recipient=</span><span class="s">"https://login.microsoftonline.com/login.srf"</span><span class="nt">/&gt;</span>
           <span class="nt">&lt;/saml2:SubjectConfirmation&gt;</span>
       <span class="nt">&lt;/saml2:Subject&gt;</span>
       <span class="nt">&lt;saml2:Conditions</span> <span class="na">NotBefore=</span><span class="s">"2016-04-11T21:14:35.365Z"</span>
                         <span class="na">NotOnOrAfter=</span><span class="s">"2016-04-11T21:19:35.365Z"</span><span class="nt">&gt;</span>
           <span class="nt">&lt;saml2:AudienceRestriction&gt;</span>
               <span class="nt">&lt;saml2:Audience&gt;</span>urn:federation:MicrosoftOnline<span class="nt">&lt;/saml2:Audience&gt;</span>
           <span class="nt">&lt;/saml2:AudienceRestriction&gt;</span>
       <span class="nt">&lt;/saml2:Conditions&gt;</span>
       <span class="nt">&lt;saml2:AuthnStatement</span> <span class="na">AuthnInstant=</span><span class="s">"2016-04-11T21:14:35.027Z"</span>
                             <span class="na">SessionIndex=</span><span class="s">"_91380d0480ac9af6bcb19f3b26f0ea81"</span><span class="nt">&gt;</span>
           <span class="nt">&lt;saml2:SubjectLocality</span> <span class="na">Address=</span><span class="s">"2a02:214d:811b:7200:dc15:b7bc:a304:3738"</span> <span class="nt">/&gt;</span>
           <span class="nt">&lt;saml2:AuthnContext&gt;</span>
               <span class="nt">&lt;saml2:AuthnContextClassRef&gt;</span>
                   urn:oasis:names:tc:SAML:2.0:ac:classes:
               <span class="nt">&lt;/saml2:AuthnContextClassRef&gt;</span>
           <span class="nt">&lt;/saml2:AuthnContext&gt;</span>
       <span class="nt">&lt;/saml2:AuthnStatement&gt;</span>
       <span class="nt">&lt;saml2:AttributeStatement&gt;</span>
           <span class="nt">&lt;saml2:Attribute</span> <span class="na">FriendlyName=</span><span class="s">"IDPEmail"</span>
                            <span class="na">Name=</span><span class="s">"IDPEmail"</span>
                            <span class="na">NameFormat=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:attrname-format:uri"</span><span class="nt">&gt;</span>
               <span class="nt">&lt;saml2:AttributeValue</span>
                    <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
                    <span class="na">xsi:type=</span><span class="s">"xsd:string"</span><span class="nt">&gt;</span>
                    ikakavas@mymail.example.com
               <span class="nt">&lt;/saml2:AttributeValue&gt;</span>
           <span class="nt">&lt;/saml2:Attribute&gt;</span>
       <span class="nt">&lt;/saml2:AttributeStatement&gt;</span>
   <span class="nt">&lt;/saml2:Assertion&gt;</span>
<span class="nt">&lt;/saml2p:Response&gt;</span></code></pre>
<p>在声明中的Subject 属性里面，包含的唯一标识符ImmutableId，具体如下，</p>
<pre><code><span class="nt">&lt;saml2:Subject&gt;</span>
       <span class="nt">&lt;saml2:NameID</span> <span class="na">Format=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:nameid-format:persistent"</span><span class="nt">&gt;</span>
            //以下为ImmutableId所在
       <span class="nt">&lt;/saml2:NameID&gt;</span>
       <span class="nt">&lt;saml2:SubjectConfirmation</span> <span class="na">Method=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:cm:bearer"</span><span class="nt">&gt;</span>
           <span class="nt">&lt;saml2:SubjectConfirmationData</span>
                <span class="na">Address=</span><span class="s">"2a02:214d:811b:7200:dc15:b7bc:a304:3738"</span>
                <span class="na">InResponseTo=</span><span class="s">"_f6daef39-fb54-407e-abb4-c75d261b75ae"</span>
                <span class="na">NotOnOrAfter=</span><span class="s">"2016-04-11T21:19:35.384Z"</span>
                <span class="na">Recipient=</span><span class="s">"https://login.microsoftonline.com/login.srf"</span><span class="nt">/&gt;</span>
       <span class="nt">&lt;/saml2:SubjectConfirmation&gt;</span>
<span class="nt">&lt;/saml2:Subject&gt;</span></code></pre>
<p>在属性声明中，包含着与用户在Azure AD已有账号的UPN（用户主体名称）相匹配的 IDPEmail信息，具体如下，</p>
<pre><code><span class="nt">&lt;saml2:AttributeStatement&gt;</span>
       <span class="nt">&lt;saml2:Attribute</span> <span class="na">FriendlyName=</span><span class="s">"IDPEmail"</span>
                        <span class="na">Name=</span><span class="s">"IDPEmail"</span>
                        <span class="na">NameFormat=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:attrname-format:uri"</span><span class="nt">&gt;</span>
           <span class="nt">&lt;saml2:AttributeValue</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
                                 <span class="na">xsi:type=</span><span class="s">"xsd:string"</span><span class="nt">&gt;</span>
                                 ikakavas@mymail.example.com
           <span class="nt">&lt;/saml2:AttributeValue&gt;</span>
       <span class="nt">&lt;/saml2:Attribute&gt;</span>
<span class="nt">&lt;/saml2:AttributeStatement&gt;</span></code></pre>
<p>在这里，同样能将SAML响应以及SAML声明看成是经过数字签名的。</p>
<h2><b>关于SAML NameID</b><br /></h2>
<p>首先我们从上方的声明中可以注意到，Office 365 SAML 服务提供方忽略了声明中的Subject，虽然ImmutableId 值包含了用户在Azure AD 唯一标识符。</p>
<p>而名称标识符，可以通过SAML 2 .0 &lt; nameid &gt;元素来体现，往往用以识别一个SAML声明中的 subject的。名称识别符可以是任意的字符，而其通常是一个邮件地址或电脑用户名称。</p>
<p>从攻击者的角度出发，事实上NameID的准确性并无进行校验，而使得事情更加容易的是，ImmutableID通常是来自于 AD objectGUID。</p>
<h2>范围界定</h2>
<p>在身份校验的过程中，IDPEmail属性值会去匹配Azure AD中用户的UPN，而这依靠在声明中的信息便可达到。但是声明中亦包含了Issuer（发行人）的信息（虽然有经过签名验证），所以根据前文的了解，正常来说，一个不相关的身份提供方是无法为其他域（或是租户）的用户创建声明么？</p>
<p>答案是否定的。</p>
<p>事实证明（在本文的漏洞利用过程中），服务提供方使用使用声明中的 Issuer （发行人）只是为了找到匹配的认证，识别SAML响应或者是声明的签名而已，但却没有真正对IDPEmail属性值进行任何检查。这基本上意味着可以通过声明，以身份提供方A的声明来认证身份提供方B的用户。以此便可实现越权访问B域的资源。</p>
<h2>如何利用前文提到的漏洞？</h2>
<p>在验证该漏洞时，我们需要有一个 Office 365租户作为连接Office 365和 SAML 2.0身份提供方的平台。我们还需要拥有一个基本的 Active Directory实例以及 <a href="https://simplesamlphp.org/SimpleSAMLphp">SimpleSAMLphp</a>（SAML 2.0 服务提供者和标识提供者功能的 PHP 实现，兼容 Shibboleth 1.3 和 2.0）作为我们的身份提供方。</p>
<p>首先，设置另外一个组织机构，其在我们这次试验中扮演着受害用户的角色。其中包含不同的EntityID并且是为新的Office 365试用租户，同时我们还需另外一个SimpleSAMLphp实例。</p>
<p>我们的测试所需环境如下，</p>
<p>1、首先，Office 365通过预设someorg-attacker.com作为身份提供方，具体为 <a href="http://idp.someorg-attacker.com/">http://idp.someorg-attacker.com/</a>；</p>
<p>2、接着， Office 365再通过预设 someorg-victim.com作为身份提供方，具体为 <a href="http://idp.someorg-victim.com/">http://idp.someorg-victim.com/</a>。</p>
<p>接下来，我们增加账户到 someorg-attacker的用户目录下，看下当我们尝试登录时会发生些什么。在AD(Active Directory)上增加一个新的alternative UPN suffix，接着通过内置的工具来新增用户，</p>
<p><font color="#494949">以下为someorg-victim用户目录下的实体用户，</font></p>
<p style="text-align: center;"><font color="#494949"><img alt="6.png" data-original="http://image.3001.net/images/20160508/1462714303395.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="81"><br /></font></p>
<noscript><img alt="6.png" src="http://image.3001.net/images/20160508/1462714303395.png!small" width="690" height="81"><br /></font></p></noscript>
<p><font color="#494949">以下为someorg-attacker用户目录下的包含两个组织</font>机构的实体用户，</p>
<p style="text-align: center;"><img alt="7.png" data-original="http://image.3001.net/images/20160508/14627143926540.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="121"></p>
<noscript><img alt="7.png" src="http://image.3001.net/images/20160508/14627143926540.png!small" width="690" height="121"></p></noscript>
<p><font color="#494949">我们可以看到其中新增了关于受害方中的实体用户。</font></p>
<p>接下来，该验证我们的发现了。首先从前文中，我们也可以知道一开始用户访问的页面为<a href="https://login.microsoftonline.com/">https://login.microsoftonline.com/</a>，验证步骤具体如下，</p>
<p>1、我们通过使用XXX@someorg-attacker.com账户（以上用户目录中的两个账户任意一个）作为登录的用户名，然后浏览器会被重定向到someorg-attacker的身份提供方进行身份认证；</p>
<p>2、当我们在身份提供方的实时身份验证登录过程中，我们通过使用此前在someorg-attacker目录下创建的带有受害方域名称的账户（例如john.smith@someorg-victim.com），进行登录验证，接着顺利完成了在身份提供方的验证过程；</p>
<p>3、接下来，我们会看到问题点所在，如上，在经过身份提供方的验证后，微软的登录页面会提示一个错误的信息，但除此之外并没有其他特别的提示和处置。而最终，我们也“顺利”以 john.smith@someorg-victim.com的身份登录进来了，并拥有了访问someorg-victim资源的权限。</p>
<p>而对于这样的情况，我们不知道该是高兴（因为验证了我们的发现）还是担忧（因为其影响的范围）。</p>
<h2>影响的用户</h2>
<p>受影响的用户包括，</p>
<blockquote><p>1、<a href="http://www.telefonika.com/">telefonika</a></p>
<p>2、<a href="http://www.caltex.com.au/">Caltex Australia</a></p>
<p>3、<a href="http://www.gsu.edu/">Georgia State University</a></p>
<p>4、<a href="http://www.jal.com/">Japan Airlines</a></p>
<p>5、<a href="http://www.sccgov.org/">Santa Clara County</a></p>
<p>6、<a href="http://www.cityofchicago.org/">City of Chicago,IL</a></p>
<p>7、<a href="http://www.ba.com/">British Airways</a></p>
</blockquote>
<h2>漏洞检测方法</h2>
<p>我们也可以通过以下的查询方式，确认某个域是否设置为加入联邦中，具体如下，</p>
</p>
<pre><code><p>https://login.microsoftonline.com/common/userrealm/?user=something@domain&amp;api-version=2.1&amp;checkForMicrosoftAccount=false<br /></p><p></p></code></pre>
<p>上述为检测一个域是否加入联邦的HTTP GET请求，而将会返回一个 json的响应信息，</p>
<pre><code><span class="p">{</span><span class="w">
</span><span class="nt">"NameSpaceType"</span><span class="p">:</span><span class="s2">"Federated"</span><span class="p">,</span><span class="w">
</span><span class="nt">"federation_protocol"</span><span class="p">:</span><span class="s2">"WSTrust"</span><span class="p">,</span><span class="w">
</span><span class="nt">"Login"</span><span class="p">:</span><span class="s2">"something@ba.com"</span><span class="p">,</span><span class="w">
</span><span class="nt">"AuthURL"</span><span class="p">:</span><span class="s2">"https://sts.baplc.com/adfs/ls/?username=something%40ba.com&amp;wa=wsignin1.0&amp;wtrealm=urn%3afederation%3aMicrosoftOnline&amp;wctx="</span><span class="p">,</span><span class="w">
</span><span class="nt">"DomainName"</span><span class="p">:</span><span class="s2">"ba.com"</span><span class="p">,</span><span class="w">
</span><span class="nt">"FederationBrandName"</span><span class="p">:</span><span class="s2">"BA.COM"</span><span class="p">,</span><span class="w">
</span><span class="nt">"cloudinstancename"</span><span class="p">:</span><span class="s2">"login.microsoftonline.com"</span><span class="w">
</span><span class="p">}</span></code></pre>
<p>从响应的参数来看，其中，</p>
<p>1、对于NameSpaceType参数来说，如果其值为Federated，那么说明该域被设置为联合单点登录，因此存在漏洞。</p>
<p>2、对于federation_protocol参数来说，如果该值为WSTrust或者是SAML2.0，这说明单点登录被设置为以上两种之一的协议，那么也是说明存在漏洞的。</p>
<p><b>＊参考来源：<a href="https://bratec.si/security/2016/04/27/road-to-hell-paved-with-saml-assertions.html#how-could-this-be-exploited" target="_blank">bratec.si</a>，FB小编troy编译，转载请注明来自FreeBuf黑客与极客（FreeBuf.COM）</b></p>
                                                    </div>
                        <div class="article-oper article-oper-new">
                            <style>
                                @font-face {font-family: 'iconfont';
                                    src: url('http://static.3001.net/iconfonts/iconfont.eot'); /* IE9*/
                                    src: url('http://static.3001.net/iconfonts/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
                                    url('http://static.3001.net/iconfonts/iconfont.woff') format('woff'), /* chrome、firefox */
                                    url('http://static.3001.net/iconfonts/iconfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
                                    url('http://static.3001.net/iconfonts/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
                                }
                            </style>
                            <div class="share-new clearfix">
                                <div class="share-author">
                                                                            <a href="http://www.freebuf.com/author/寰者" title="由 寰者 发布" rel="author">
                                            <img src="http://image.3001.net/2015/09/大象.png" width="50" height="50" alt="寰者" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 photo" />                                            <!--							<img src="http://image.3001.net/2015/06/17.jpg" alt="ArthurKiller">-->
                                        </a>
                                        <div class="share-author-info">
                                                                                        <a class="author-name" href="http://www.freebuf.com/author/寰者">寰者</a>
                                            <!--<span class="icon-f"></span>-->
                                            <span>
                                <i class="colour-red">
                                    75                                </i>
                                篇文章</span>
                                            <span>等级：
                                <i class="colour-green">7</i>级
                            </span>
                                        </div>
                                                                                                        </div>
                                <div class="user-center clearfix">
                                                                            <a href="http://www.freebuf.com/author/寰者" data-toggle="tooltip" data-placement="top" title="个人主页" class="home" target="_blank"></a>
                                                                        <a href="http://www.freebuf.com/user/pm?pmaction=newmessage&to=寰者" data-toggle="tooltip" data-placement="top" title="私信" class="letter" target="_blank"></a>
                                </div>
                                <div class="share-ctrl clearfix">
                                                                        <div class="bdsharebuttonbox clearfix bdshare-button-style1-24 columnstatus"
                                         data-bd-bind="1489991449190" data-column="" data-title="技术分析：微软 Office 365平台SAML服务漏洞，可越权访问其他用户资源" data-name="">
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="tsina" title="分享到新浪微博" id="tsina"></a>
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="weixin" title="分享到微信" id="weixin"></a>
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="qzone" title="分享到QQ空间" id="qzone"></a>
                                       <!-- _shareUrlWeibo = 'http://service.weibo.com/share/share.php?url=http://'+encodeURIComponent(_json[i].url)+'&title='+encodeURIComponent(_json[i].title)+'-FreeBuf涓撴爮路'+_json[i].columnName;
                                        _shareUrlZone = 'http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://'+encodeURIComponent(_json[i].url)+'&title='+_json[i].title+'-FreeBuf涓撴爮路'+_json[i].columnName;
                                        _shareSrc = 'http://s.jiathis.com/qrcode.php?url=http://'+_json[i].url;-->
                                        <span class="share-line">|</span>
                                    </div>
                                </div>
                                <div class="user-ctrl clearfix">
                                                                            <a href="http://www.freebuf.com/oauth" id="collect" data-toggle="tooltip" data-placement="top" title="收藏" ></a>
                                                                        <a href="#respond" data-toggle="tooltip" data-placement="top" title="评论" id="comments"></a>
                                                                        <!--					<a href="#" title="文章纠正">&#xe6e3;</a>-->
                                    <span class="share-line">|</span>
                                    <span class="info-alert"></span>
                                </div>
                            </div>
                            <script>
                                var column = $('.columnstatus').attr('data-column');
                                var text = '';
                                if(column){
                                    var title = $('.columnstatus').attr('data-title');
                                    var name = $('.columnstatus').attr('data-name');
                                    text = title+' - FreeBuf专栏·'+name;
                                }
                                window._bd_share_config={
                                    "common": {
                                        "bdSnsKey": {},
                                        "bdText": text,
                                        "bdMini": "2",
                                        "bdMiniList": ["qzone", "tsina", "weixin"],
                                        "bdPic": "",
                                        "bdStyle": "1",
                                        "bdSize": "24"
                                    },
                                    "share":{},
                                };
                                with(document)0[
                                    (getElementsByTagName('head')[0]||body).
                                    appendChild(createElement('script')).
                                        src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)
                                    ];
                                //控制垂直方向分享模块的定位
                                function shareFixVertical(){
                                    var offsetTop = jQuery(".article-oper").get(0).offsetTop;
                                    var win_h = jQuery(window).height();
                                    var win_w = jQuery(window).width();
                                    var scrollTop = document.body.scrollTop||document.documentElement.scrollTop;
                                    var _height = offsetTop-scrollTop;
                                    var _flag = $('.column-article').attr('data-column');
                                    if(_flag == 1) {
                                        if(_height>=win_h-660&&win_w>975){
                                            var _width = jQuery("#getWidth").innerWidth()-30;
                                            var _left = jQuery("#getWidth").offset().left+15;
                                            jQuery(".share-new").addClass("fixed");
                                            jQuery(".fixed").css({
                                                width:_width,
                                                left:_left
                                            });

                                        }else{
                                            jQuery(".share-new").removeClass("fixed");
                                            jQuery(".share-new").css({
                                                width: "100%"
                                            });
                                        }
                                    }else {
                                        if(_height>=win_h-255&&win_w>975){
                                            var _width = jQuery("#getWidth").innerWidth()-30;
                                            var _left = jQuery("#getWidth").offset().left+15;
                                            jQuery(".share-new").addClass("fixed");
                                            jQuery(".fixed").css({
                                                width:_width,
                                                left:_left
                                            });

                                        }else{
                                            jQuery(".share-new").removeClass("fixed");
                                            jQuery(".share-new").css({
                                                width: "100%"
                                            });
                                        }
                                    }
                                }
                                //控制水平方向分享模块的定位
                                function shareFixHorizontal(){
                                    var _width = jQuery("#getWidth").innerWidth()-30;
                                    var _left = jQuery("#getWidth").get(0).offsetLeft+15;
                                    var win_w = document.documentElement.clientWidth || document.body.clientWidth;
                                    jQuery(".fixed").css({
                                        width:_width,
                                        left:_left
                                    });
                                    if(win_w< 975){
                                        jQuery(".share-new").css({
                                            width: "100%",
                                            left: "0"
                                        });
                                    }else{
                                        var _width = jQuery("#getWidth").innerWidth()-30;
                                        var _left = jQuery("#getWidth").get(0).offsetLeft+15;
                                        jQuery(".fixed").css({
                                            width:_width,
                                            left:_left
                                        });
                                    }
                                }
                                function click(){
                                    var _w = jQuery(window).width();
                                    jQuery(document).click(function(e){
                                        if(jQuery(e.target).attr("id")=="weixin"){
                                            if(_w <= 760) {
                                                jQuery("#bdshare_weixin_qrcode_dialog").hide();
                                                layer.open({
                                                    title: '提示',
                                                    btnAlign: 'c',
                                                    content: '请使用手机浏览器自带的分享功能分享该页面',
                                                    area: '260px'
                                                });
                                            }else {
                                                jQuery("#bdshare_weixin_qrcode_dialog").show();
                                            }
                                        }else {
                                            jQuery("#bdshare_weixin_qrcode_dialog").hide();
                                        }
                                    });
                                }

                                jQuery(window).on("load",function(){
                                    shareFixVertical();
                                    click();
                                });

                                jQuery(window).on("scroll",function(){
                                    //判断滚轮方向
                                    var agent = navigator.userAgent;
                                    if (/.*Firefox.*/.test(agent)) {
                                        document.addEventListener("DOMMouseScroll", function(e) {
                                            e = e || window.event;
                                            var detail = e.detail;
                                            if (detail > 0) {
                                                $(".share-new").removeClass("fixed");
                                                $(".share-new").css({
                                                    width: "100%"
                                                });
                                                $('.main-header .header').removeClass('op1');
                                                $('.main-header .header').addClass('op0');
                                            } else {
                                                shareFixVertical();
                                                $('.main-header .header').removeClass('op0');
                                                $('.main-header .header').addClass('op1');
                                            }
                                        });
                                    } else {
                                        document.onmousewheel = function(e) {
                                            e = e || window.event;
                                            var wheelDelta = e.wheelDelta;
                                            if (wheelDelta > 0) {
                                                shareFixVertical();
                                                $('.main-header .header').removeClass('op0');
                                                $('.main-header .header').addClass('op1');
                                            } else {
                                                $(".share-new").removeClass("fixed");
                                                $(".share-new").css({
                                                    width: "100%"
                                                });
                                                $('.main-header .header').removeClass('op1');
                                                $('.main-header .header').addClass('op0');
                                            }
                                        }
                                    }
                                });


                                jQuery(window).on("resize",function(){
                                    shareFixHorizontal();
                                    click();
                                })

                                //tooltips提示
                                $(function () { $("[data-toggle='tooltip']").tooltip(); });
                            </script>
                        </div>
                                                                                                                            <div class="article-pager ">
                                <ul>
                                    <li class="previous"><span>上一篇：</span><a href="http://www.freebuf.com/vuls/103661.html" rel="prev">安全报告：通过NVD漏洞库看近年漏洞发展趋势</a>                                    </li>
                                    <li class="next"><span>下一篇：</span>
                                        <a href="http://www.freebuf.com/vuls/103823.html" rel="next">关于Apache Struts 2 S2-032漏洞威胁监测和应急处置的情况公告</a>                                    </li>
                                </ul>
                            </div>
                                            </div>
                </div>
                <div class="comment-list">
      <div class="main-tit02">
		<a rel="nofollow" class="btnbtn-default btn-comment" href="#respond">发表评论</a>
        <h3>已有 <span class="color_red">3</span> 条评论
      </div>
      <ul>
         <li class="comment even thread-even depth-1" id="li-comment-184954">
    <div id="comment-184954">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic17.png">     </div>
    <div class="tit"> 
	    <span class="name"> 牛二 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-05-10</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-184954','184954', 'respond','103718' ) " href="?replytocom=184954#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">1楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>中国的没有影响？</p>
<div class="comment-tools">
<div class="vote" id="vote-184954"><span id="acv_stat_184954"></span><a class="ilike_icon"  id="vote4-184954" href="javascript:acv_vote(184954,1);">亮了</a>(<span id="cos_support-184954">4</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="184954" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="184954" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="184954" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="184954" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="184954" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-185001">
    <div id="comment-185001">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic17.png">     </div>
    <div class="tit"> 
	    <span class="name"> 科科 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-05-10</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-185001','185001', 'respond','103718' ) " href="?replytocom=185001#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">2楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>你翻译的真是&#8230;..</p>
<div class="comment-tools">
<div class="vote" id="vote-185001"><span id="acv_stat_185001"></span><a class="ilike_icon"  id="vote4-185001" href="javascript:acv_vote(185001,1);">亮了</a>(<span id="cos_support-185001">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="185001" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="185001" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="185001" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="185001" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="185001" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment byuser comment-author-58215 bypostauthor even depth-2" id="li-comment-185008">
    <div id="comment-185008">
        <div class="photo"> <a href="http://www.freebuf.com/author/寰者">
    <img src="http://image.3001.net/2015/09/大象.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/寰者" target="_blank">寰者&nbsp;</a>  </span>
        		
		<span class="icon-f"> <a href="http://zhuanlan.freebuf.com" target="_blank"><img src="http://image.3001.net/images/index/column-iden.png" title="专栏作者"></a></span>
		<span class="rank">(7级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2016-05-10</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-185008','185008', 'respond','103718' ) " href="?replytocom=185008#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ 科科  不好意思，请问有哪里不清楚或者有问题，还请指正呢，谢谢！SAML可能相对来说比较“冷门”，所以一些概念性的东西也并未能完全写出来，还请多多交流，谢谢！</p>
<div class="comment-tools">
<div class="vote" id="vote-185008"><span id="acv_stat_185008"></span><a class="ilike_icon"  id="vote4-185008" href="javascript:acv_vote(185008,1);">亮了</a>(<span id="cos_support-185008">3</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="185008" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="185008" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="185008" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="185008" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="185008" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
      </ul>
      <div class="commentnav page01" style="padding-top:10px; text-align: center;">
               </div>
	  
<script src="http://www.freebuf.com/buf/themes/freebuf/js/ajaxfileupload.js" type="text/javascript"></script>
<div id="respond" class="comment-box">
<input type="file" id="uploadUnit" name="upfile" class="hidden" value="">
    <form action="http://www.freebuf.com/wp-comments-post.php" method="post" id="commentform">
        <div id="comment-author-info">
	    <div class="login-other">
		  <div class="login_button login_icon_sina" title="使用新浪微博登陆" onclick="login_button_click('sina')"></div>
          <div class="login_button login_icon_qq" title="使用腾讯QQ登陆" onclick="login_button_click('qq')"></div></div>
        <div class="login-input">
	    <p><label for="author">昵称</label>
		          <input type="text" name="author" id="author" value="" size="14" tabindex="1" aria-required='true' placeholder = "请输入昵称" required />
        </p><span>必须</span><span>您当前尚未登录。<a  class="simplemodal-login" href="http://www.freebuf.com/oauth" title="登陆">登陆？</a><a  href="https://account.tophant.com/register.html" target="_blank">注册</a></span></div>
		<div class="login-input">
		  <p><label for="email">邮箱</label><input type="text" name="email" id="email" value="" size="25" tabindex="2" aria-required='true' placeholder = "请输入邮箱地址" required /></p>
		<span>必须（保密）</span>
		</div>
    </div>

        <div id="test" class="post-area">
      <div class="holiday"></div>
	    <div class="comment-editor">
			<a id="comment-smiley" href="javascript:;">表情</a><a href="javascript:;" id="imageThumb">插图</a>
	    </div>
        <div id="smileys" >
           <a title="mrgreen" href="javascript:grin(':mrgreen:')"><img src="http://image.3001.net/images/index/smilies/icon_mrgreen.gif" /></a><a title="razz" href="javascript:grin(':razz:')"><img src="http://image.3001.net/images/index/smilies/icon_razz.gif" /></a><a title="sad" href="javascript:grin(':sad:')"><img src="http://image.3001.net/images/index/smilies/icon_sad.gif" /></a><a title="smile" href="javascript:grin(':smile:')"><img src="http://image.3001.net/images/index/smilies/icon_smile.gif" /></a><a title="oops" href="javascript:grin(':oops:')"><img src="http://image.3001.net/images/index/smilies/icon_redface.gif" /></a><a title="grin" href="javascript:grin(':grin:')"><img src="http://image.3001.net/images/index/smilies/icon_biggrin.gif" /></a><a title="eek" href="javascript:grin(':eek:')"><img src="http://image.3001.net/images/index/smilies/icon_surprised.gif" /></a><a title="???" href="javascript:grin(':???:')"><img src="http://image.3001.net/images/index/smilies/icon_confused.gif" /></a><a title="cool" href="javascript:grin(':cool:')"><img src="http://image.3001.net/images/index/smilies/icon_cool.gif" /></a><a title="lol" href="javascript:grin(':lol:')"><img src="http://image.3001.net/images/index/smilies/icon_lol.gif" /></a><a title="mad" href="javascript:grin(':mad:')"><img src="http://image.3001.net/images/index/smilies/icon_mad.gif" /></a><a title="twisted" href="javascript:grin(':twisted:')"><img src="http://image.3001.net/images/index/smilies/icon_twisted.gif" /></a><a title="roll" href="javascript:grin(':roll:')"><img src="http://image.3001.net/images/index/smilies/icon_rolleyes.gif" /></a><a title="wink" href="javascript:grin(':wink:')"><img src="http://image.3001.net/images/index/smilies/icon_wink.gif" /></a><a title="idea" href="javascript:grin(':idea:')"><img src="http://image.3001.net/images/index/smilies/icon_idea.gif" /></a><a title="arrow" href="javascript:grin(':arrow:')"><img src="http://image.3001.net/images/index/smilies/icon_arrow.gif" /></a><a title="neutral" href="javascript:grin(':neutral:')"><img src="http://image.3001.net/images/index/smilies/icon_neutral.gif" /></a><a title="cry" href="javascript:grin(':cry:')"><img src="http://image.3001.net/images/index/smilies/icon_cry.gif" /></a><a title="?" href="javascript:grin(':?:')"><img src="http://image.3001.net/images/index/smilies/icon_question.gif" /></a><a title="evil" href="javascript:grin(':evil:')"><img src="http://image.3001.net/images/index/smilies/icon_evil.gif" /></a><a title="shock" href="javascript:grin(':shock:')"><img src="http://image.3001.net/images/index/smilies/icon_eek.gif" /></a><a title="!" href="javascript:grin(':!:')"><img src="http://image.3001.net/images/index/smilies/icon_exclaim.gif" /></a>        </div>
         <textarea name="comment" id="comment" cols="100%" rows="7" tabindex="4" style="overflow-x:hidden; overflow-y:hidden; border:0; width:100%;" onkeydown="if(event.ctrlKey&amp;&amp;event.keyCode==13){document.getElementById('submit').click();return false};"></textarea>
    </div>
      <div class="subcon but">
      <input class="btn btn-success" type="submit" name="submit" id="submit" tabindex="5" value="提交评论(Ctrl+Enter)" />
      <a rel="nofollow" class="btn btn-default" id="cancel-comment-reply-link" href="javascript:;">取消</a>
      <div class="checkbox"><input type='hidden' name='comment_post_ID' value='103718' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
<label for="comment_mail_notify" class="comment_mail"><input type="checkbox" name="comment_mail_notify" id="comment_mail_notify" value="comment_mail_notify" checked="checked"/>有人回复时邮件通知我</label></div>
      </div>
    <input name="Token" id="Token" type="hidden" value="dkgszd" />
  </form>
  </div>
</div>	  
<div class="commentshow">
<div class="comments-loading">Loading...</div>
</div>
<script language="javascript">
jQuery(document).ready(function($){ //Begin jQuery
    $('.reply').click(function() {
    var atid = '"#' + $(this).parent().attr("id") + '"';
    var atname = $(this).parent().find('span:first').text();
    $("#comment").val("@" + atname + " ").focus();
});
    $('.cancel-comment-reply a').click(function() { //点击取消回复评论清空评论框的内容
    $("#comment").val('');
});
}) 

jQuery(document).ready(function($) {
    $body = (window.opera) ? (document.compatMode == "CSS1Compat" ? $('html') : $('body')) : $('html,body');//commentnav ajax
    $(document).on('click', '.commentnav a', function(e) {
        e.preventDefault();
        $.ajax({
            type: "GET",
            url: $(this).attr('href'),
            beforeSend: function() {
                $('.commentnav').remove();
                $('.comment-list').remove();
                $('.comments-loading').slideDown();
            },
            dataType: "html",
            success: function(out) {
                result = $(out).find('.comment-list');
                nextlink = $(out).find('.commentnav');
                $('.comments-loading').slideUp(550);
                $('.comments-loading').after(result.fadeIn(800));
                $(".comment-list img").each(function(){
                  var url = $(this).attr("data-original");
                  $(this).attr("src",url);
                })
            }
        });
    });    
});
</script>            </div>
                    <div class="col-md-3 visible-md-block visible-lg-block">
                <div class="panel panel-default">
                    <div class="author-top">
                         <div class="author-wrap">
                            <div class="author-header"><img src="http://image.3001.net/2015/09/大象.png" width="96" height="96" alt="寰者" class="avatar avatar-100 wp-user-avatar wp-user-avatar-100 photo" />                            </div>
                            <p class="name"><a href="http://www.freebuf.com/author/%e5%af%b0%e8%80%85" title="由 寰者 发布" rel="author">寰者</a><span><a href="http://zhuanlan.freebuf.com" target="_blank"><img src="http://image.3001.net/images/index/column-iden.png" title="专栏作者"></a></span></p>
                            <p class="signature">这家伙太懒，还未填写个人描述！</p>
                            <p class="art-com clearfix">
                                <span class="aut-article">
                                    <a href="/author/寰者"target="_blank">
                                        <i>75</i>
                                        <i>文章数</i>
                                    </a>
                                </span>
                                <span class="aut-comment">
                                    <a href="/author/寰者?comment=1" target="_blank">
                                        <i>33</i>
                                        <i>评论数</i>
                                    </a>
                                </span>
                            </p>
                        </div>
                    </div>
                    <div class="author-bottom">
                        <div class="author-wrap">
                            <h3 class="last-title">最近文章</h3>
                            <div class="last-item-wrap">
                                                                        <div class="last-item">
                                            <a href="http://www.freebuf.com/news/115777.html" target="_blank"><span class="point"></span>僵尸网络的发展，“智能设备”可帮了大忙（含Top 10物联网设备弱口令 ）</a>
                                            <p class="last-time">2016.10.09</p>
                                        </div>
                                                                            <div class="last-item">
                                            <a href="http://www.freebuf.com/articles/others-articles/110804.html" target="_blank"><span class="point"></span>【BlackHat 2016专题】黑客奥斯卡：Pwnie Awards那些事儿</a>
                                            <p class="last-time">2016.08.02</p>
                                        </div>
                                                                            <div class="last-item">
                                            <a href="http://www.freebuf.com/news/107974.html" target="_blank"><span class="point"></span>对话印度黑客：CloudSec云安全公司创始人Rahul Sasi</a>
                                            <p class="last-time">2016.07.05</p>
                                        </div>
                                                                </div>
                        </div>

                        <div class="more-wrap">
                            <a href="http://www.freebuf.com/author/寰者" target="_blank" class="btn-new">浏览更多</a>
                        </div>
                    </div>
                </div>
                                <div class="panel panel-default">
                    <div class="read visible-md-block visible-lg-block">
                        <div class="main-tit02">
                            <h3>相关阅读</h3>
                        </div>
                        <ul>
  <li><a href="http://www.freebuf.com/articles/system/144041.html" target="_blank">无招胜有招： 看我如何通过劫持COM服务器绕过AMSI</a></li>
  
  <li><a href="http://www.freebuf.com/news/11084.html" target="_blank">谷歌安全研究人员爆出的IE漏洞被用于大规模定向入侵</a></li>
  
  <li><a href="http://www.freebuf.com/news/20963.html" target="_blank">微软修复GDI+ 0day，关注ASLR绕过补丁</a></li>
  
  <li><a href="http://www.freebuf.com/news/119308.html" target="_blank">OAuth2.0部署不当，数十亿Android App账户存泄露风险</a></li>
  
  <li><a href="http://www.freebuf.com/news/50969.html" target="_blank">Microsoft昨日发布高达16个安全补丁</a></li>
  </ul>                    </div>
                </div>
                <!--<div class="ad-wrap"><a href="http://www.ijiami.cn/?freebuf.com" target="_blank"><img width="100%" src="http://image.3001.net/images/20141201/14174039186901.jpg"></a></div>-->
                <div class="panel panel-default rec-spe">
                    <div class="main-tit03 colour-blue">
                        <h3>特别推荐</h3>
                    </div>
                                                    <div class="rec-img"><a href="http://www.freebuf.com/ad?id=3" target="_blank"><img
                                            src="http://image.3001.net/2017/05/14a10c5c919d154dddbee79e3a944143-220x150.png" width="220"></a></div>
                                                </div>
                <div id="mar-right">
                    <!--<div class="read visible-lg-block">
        <div class="main-tit04">
          <h3>商城新品</h3>
        </div>
        <div id="slider" class="nivoSlider">  </div>
      </div>-->
                    <div class="panel panel-default code"><img src="http://image.3001.net/images/new/code.jpg" width="192"
                                                               height="192">
                        <p>关注我们 分享每日精选文章</p>
                    </div>
                </div>
            </div>
                </div>
                    <div class="row marvellous visible-lg-block">
                <h3>不容错过</h3>
                <ul>
                                                <li><a href="http://www.freebuf.com/sectool/109949.html" rel="bookmark"
                                   title="小米范系列渗透测试工具介绍">小米范系列渗透测试工具介绍</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/shentouceshi" title="由 shentouceshi 发布" rel="author">shentouceshi</a></span>
                                                                        <span class="time">2016-07-28</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/news/141308.html" rel="bookmark"
                                   title="AlphaBay是怎么垮掉的？解密全球最大黑市AlphaBay被查封全过程">AlphaBay是怎么垮掉的？解密全球最大黑市AlphaBay被查封全过程</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/alpha_h4ck" title="由 Alpha_h4ck 发布" rel="author">Alpha_h4ck</a></span>
                                                                        <span class="time">2017-07-25</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/news/137497.html" rel="bookmark"
                                   title="手工检测Web应用指纹的一些技巧">手工检测Web应用指纹的一些技巧</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/m00n1ight" title="由 m00n1ight 发布" rel="author">m00n1ight</a></span>
                                                                        <span class="time">2017-06-20</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/video/129652.html" rel="bookmark"
                                   title="【FB TV】一周「BUF大事件」：传闻“京东内鬼泄露50亿条公民信息”；Struts S2-045漏洞影响还在扩大；雅虎5亿账户泄露事件真相">【FB TV】一周「BUF大事件」：传闻“京东内鬼泄露50亿条公民信息”；Struts S2-045漏洞影响还在扩大；雅虎5亿账户泄露事件真相</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/supercoco" title="由 supercoco 发布" rel="author">supercoco</a></span>
                                                                        <span class="time">2017-03-18</span></p>
                            </li>
                                                            </ul>
            </div>
            </div>
</div>
<script type="text/javascript">
  $(window).load(function() {
    $('#slider').nivoSlider();
  });
  $('#contenttxt img').removeAttr('height');
  $('#contenttxt img').wrap(function(){
    if(!$(this).parent().attr('href')){
      var imgurl = $(this).attr('data-original');
      if(imgurl.substr(-6)=='!small'){
        imgurl = imgurl.substring(0,imgurl.length-6);
      }
      return '<a href="' + imgurl + '" class="highslide-image" onclick="return hs.expand(this);" target="_blank"></a>';
    }
  })
</script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/comments-ajax.js" type="text/javascript"></script>
<script type="text/javascript" src="http://static.3001.net/js/focus/jquery.nivo.slider.pack.js"></script>
<!----------footer---------->
<div class="footer">
  <div class="container">
    <div class="footer-list ">
      <h3>FREEBUF</h3>
      <ul>
        <li><a href="http://www.freebuf.com/dis">免责声明</a></li>
        <li><a href="http://www.freebuf.com/news/others/864.html">关于我们</a></li>
        <li><a href="http://www.freebuf.com/jobs/40386.html">加入我们</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>广告及服务</h3>
      <ul>
        <li><a target="_blank" href="mailto:root@freebuf.com">寻求报道</a></li>
        <li><a href="http://www.freebuf.com/advertise">广告合作</a></li>
        <li><a target="_blank" href="mailto:help@freebuf.com">联系我们</a></li>
        <li><a href="http://www.freebuf.com/friends">友情链接</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>关注我们</h3>
      <ul>
        <li><div class="weixin-pannel weixin"><a class="qr" href="javascript:viod(0);"><span class="g-icon-qr1">官方微信</span><i></i></a></div></li>
        <li><a rel="nofollow" target="_blank" href="http://weibo.com/freebuf">新浪微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://t.qq.com/freebuf">腾讯微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://twitter.com/freebuf">Twitter</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>赞助商</h3>
      <ul>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="http://www.aliyun.com/?freebuf"><img src="http://image.3001.net/images/ad/ali.png"></a></li>
        <li><a rel="nofollow" target="_blank" href="http://www.upyun.com/?freebuf"><img src="http://image.3001.net/images/ad/upyun.png"></a></li>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="https://www.trustasia.com/?freebuf"><img src="http://image.3001.net/images/ad/ad-yzcx.png"></a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <ul>
      </ul>
    </div>
    <div class="footer-logo  pull-right"><img src="http://image.3001.net/images/index/freebufrobot_shendanjie.png" ></div>
  </div>
  <div class="copyright"><div class="container"><p>Copyright &copy; 2017 WWW.FREEBUF.COM All Rights Reserved <a rel="nofollow" target="_blank" href="http://www.miitbeian.gov.cn">沪ICP备13033796号</a></p><span><a rel="nofollow" target="_blank" href="http://click.aliyun.com/m/1336/?freebuf"><img src="http://image.3001.net/images/new/icon-aly.png"></a></span></div></div>
</div>
<div class="bottom_tools"><a id="scrollUp" href="javascript:;" title="飞回顶部"></a></div>
<!----------footer end----------> 
<script src="http://static.3001.net/js/new/backtop.js"></script>
<script type="text/javascript">
jQuery(function(){	
	jQuery('.tabPanes ul li').click(function(){
		jQuery(this).addClass('hit').siblings().removeClass('hit');
		jQuery('.panesl>div:eq('+jQuery(this).index()+')').show().siblings().hide();	
	})
	jQuery('.vulbox-nav').click(function(e) { 
        e.stopPropagation(); 
    });  
})
</script>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fcc53db168808048541c6735ce30421f5' type='text/javascript'%3E%3C/script%3E"));
</script>
<img alt='css.php' src="http://www.freebuf.com/buf/plugins/cc/css.php?k=3cb185a485c81b23211eb80b75a406fd&amp;o=i&amp;t=1899051222" width='1' height='1' /><script type="text/javascript">
jQuery(function() {
    jQuery(".simditor pre").each(function(i, block){
        hljs.highlightBlock(block);    
    });
    hljs.initHighlightingOnLoad();
});
</script>
<script>
/* <![CDATA[ */
var rcGlobal = {
	serverUrl		:'http://www.freebuf.com',
	infoTemp		:'%REVIEWER% on %POST%',
	loadingText		:'Loading',
	noCommentsText	:'No comments',
	newestText		:'&laquo; 最新',
	newerText		:'&laquo; 新一点',
	olderText		:'旧一点 &raquo;',
	showContent		:'1',
	external		:'1',
	avatarSize		:'32',
	avatarPosition	:'left',
	anonymous		:'Anonymous'
};
/* ]]> */
</script>
<script type='text/javascript' src='http://static.3001.net/js/recentcomments/wp-recentcomments-jquery.js?ver=2.2.3'></script>
</body>
</html>
