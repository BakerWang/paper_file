<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
                              _.._        ,------------.
                           ,'      `.    ( We want you! )
                          /  __) __` \    `-,----------'
                         (  (`-`(-')  ) _.-'
                         /)  \  = /  (
                        /'    |--' .  \
                       (  ,---|  `-.)__`
                        )(  `-.,--'   _`-.
                       '/,'          (  Uu",
                        (_       ,    `/,-' )
                        `.__,  : `-'/  /`--'
                          |     `--'  |
                          `   `-._   /
                           \        (
                           /\ .      \.  freebuf
                          / |` \     ,-\
                         /  \| .)   /   \
                        ( ,'|\    ,'     :
                        | \,`.`--"/      }
                        `,'    \  |,'    /
                       / "-._   `-/      |
                       "-.   "-.,'|     ;
                      /        _/["---'""]
                     :        /  |"-     '
                     '           |      /
                                 `      |
-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  如何进行Linux平台共享库替换 - FreeBuf.COM | 关注黑客与极客</title>
<meta name="description" content="*本文原创作者：gaearrow，本文属FreeBuf原创奖励计划，未经许可禁止转载&nbsp;。    
共享库基础知识
程序由源代码变成可执行文件，一般可以分解为四个步骤，分别是预处理（Prepressing）、编译（Compilation）、…" />
<meta name="keywords" content="linux, 共享库, 动态替换, 系统安全解决方案,系统安全软件排行,系统安全技术" />
<meta name="baidu-site-verification" content="nKKKqQxp6R" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="renderer" content="webkit">
<meta property="qc:admins" content="6620477777662552566375" />
<link rel='stylesheet' id='wpfp-css' href='http://www.freebuf.com/buf/plugins/wp-favorite-posts/wpfp.css' type='text/css' />
<link rel='stylesheet' id='wp-recentcomments-css'  href='http://static.3001.net/css/recentcomments/wp-recentcomments.css?ver=2.2.3' type='text/css' media='screen' />
<link rel='stylesheet' id='mycred-widget-css'  href='http://www.freebuf.com/buf/plugins/gold/assets/css/widget.css?ver=1.3.2.1' type='text/css' media='all' />
<script type='text/javascript' src='http://static.3001.net/js/header/jquery.min.js?ver=3.6.1'></script>
<script type='text/javascript' src='http://www.freebuf.com/buf/plugins/wp-favorite-posts/wpfp.js?ver=3.6.1'></script>
<link rel='prev' title='ES6中的模板字符串和新XSS Payload' href='http://www.freebuf.com/articles/web/116825.html' />
<link rel='next' title='由HITCON 2016一道web聊一聊php反序列化漏洞' href='http://www.freebuf.com/vuls/116705.html' />
<link rel='canonical' href='http://www.freebuf.com/articles/system/116489.html' />
<link rel='shortlink' href='http://www.freebuf.com/?p=116489' />

<link rel="stylesheet" href="http://static.3001.net/css/highslide/highslide.css" type="text/css" />
<script type="text/javascript" src="http://static.3001.net/js/highslide/highslide-with-html.packed.js"></script>
<script type="text/javascript">
jQuery(document).ready(function($) {
    hs.graphicsDir = "http://www.freebuf.com/buf/plugins/auto-highslide/images/graphics/";
    hs.outlineType = "rounded-white";
    hs.dimmingOpacity = 0.8;
    hs.outlineWhileAnimating = true;
    hs.showCredits = false;
    hs.captionEval = "this.thumb.alt";
    hs.numberPosition = "caption";
    hs.align = "center";
    hs.transitions = ["expand", "crossfade"];
    hs.addSlideshow({
        interval: 5000,
        repeat: true,
        useControls: true,
        fixedControls: "fit",
        overlayOptions: {
            opacity: 0.75,
            position: "bottom center",
            hideOnMouseOut: true

        }

    });
});
</script>
          <script language="JavaScript" type="text/javascript" src="http://www.freebuf.com/buf/plugins/cartpauj-pm/js/script.js"></script>
      <link rel="stylesheet" type="text/css" href="http://www.freebuf.com/buf/plugins/cartpauj-pm/style/style.css" />
      <script type="text/javascript" src="http://www.freebuf.com/buf/plugins/simditor/highlight/highlight.pack.js"></script><link type="text/css" rel="stylesheet" href=" http://www.freebuf.com/buf/plugins/simditor/highlight/styles/default.css" />	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<link rel="shortcut icon" href="http://static.freebuf.com/images/favicon.ico" />
<link rel="stylesheet" href="http://static.3001.net/css/new/header.css" />
<link href="http://static.3001.net/css/new/bootstrap.min.css?ver=2016051701" rel="stylesheet" media="screen">
    <!--轮播图-->
    <link href="http://static.3001.net/css/new/swiper-3.4.2.min.css" rel="stylesheet" type="text/css">
    <link href="http://static.3001.net/css/new/style.css?ver=20170912568" rel="stylesheet" type="text/css">
    <style type="text/css">
#contenttxt hr {
  display: block;
  height: 0px;
  border: 0;
  border-top: 1px solid #ccc;
  margin: 15px 0;
  padding: 0;
}
#contenttxt table {
  width: 100%;
  table-layout: fixed;
  border-collapse: collapse;
  border-spacing: 0;
  margin: 15px 0;
}
#contenttxt table thead {
  background-color: #f9f9f9;
}
#contenttxt table td, #contenttxt table th {
  min-width: 40px;
  height: 30px;
  border: 1px solid #ccc;
  vertical-align: top;
  padding: 2px 4px;
  text-align: left;
  box-sizing: border-box;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
#contenttxt table td.active, #contenttxt table th.active {
  background-color: #ffffee;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
</style>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/jquery-2.0.3.min.js"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/bootstrap.min.js"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/slider.js?2016022501.1" type="text/javascript"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/jquery.sticky.js" type="text/javascript"></script>
<script src="http://static.3001.net/js/focus/bjqs-1.3.min.js" type="text/javascript" ></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/mosaic.1.0.1.min.js" type="text/javascript" ></script>
<script type="text/javascript" src="http://static.3001.net/js/new/setint.js"></script>
    <!--轮播图-->
    <script src="http://static.3001.net/js/colum/swiper-3.4.2.min.js"></script>
<!--[if lt IE 9]>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/html5shiv.min.js"></script>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/respond.min.js"></script>
<![endif]-->
    <style>
        @font-face {font-family: 'iconfont';
            src: url('http://static.3001.net/iconfont/iconfont.eot'); /* IE9*/
            src: url('http://static.3001.net/iconfont/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
            url('http://static.3001.net/iconfont/iconfont.woff') format('woff'), /* chrome、firefox */
            url('http://static.3001.net/iconfont/iconfonticonfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
            url('http://static.3001.net/iconfont/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
        }
    </style>
</head>

<body>
<!----------header---------->
<!--头部导航-->
<div id="undefined-sticky-wrapper" class="sticky-wrapper is-sticky">
    <div class="main-header">
        <div class="header">
            <div class="header-container clearfix">
                                <div class="header-logo"><a href="http://www.freebuf.com"></a></div>
                                        <!-- column -->
                        <div class="nav">
                            <ul class="nav-child clearfix">
                                <li class=" index">
                                    <a href="http://www.freebuf.com">首页</a></li>
                                <li data-value="read-menu">
                                    <a href="#">分类阅读<b class="triangle-down triangle-down-04"></b></a>
                                </li>
                                <li data-value="wenku-menu"><a href="javascript:;" target="_blank">文库<b class="triangle-down triangle-down-04"></b></a></li>
                                <li>
                                    <a href="http://zhuanlan.freebuf.com" target="_blank">专栏</a><b class="icon-betr"></b>
                                </li>
                                <li><a href="http://open.freebuf.com" target="_blank">公开课</a></li>
                                <li><a href="http://shop.freebuf.com" target="_blank">商城</a></li>
                                <li data-value="company-menu"><a href="javascript:;" >企业服务<b class="triangle-down triangle-down-04"></b></a></li>
                                <li data-value="user-menu"><a href="javascript:;" >用户服务<b class="triangle-down triangle-down-04"></b></a></li>
                            </ul>
                        </div>
                                        <div class="header-right">
                                    <div class="loginSign login-before">
                        <a href="https://account.tophant.com/register.html" class="login-btn">注册</a>
                        |
                        <a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a>
                    </div>
                                    <!--搜索-->
                    <div class="search-form-inner clearfix">
                        <i class="searchdisplayico"></i>
                        <div class="form-group has-active search-col search-form-text">
                            <form id="hpsform-new" class="navbar-search navbar-form" onsubmit="return dispatch();">
                                <div class="form-group">
                                    <input id="bigq" class="input form-control" type="text" placeholder="关键字查找" autocomplete="off" title="关键字查找" name="q">
                                    <button class="submit" type="submit"></button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <!--<script>
                        $('.search-form-inner .searchdisplayico').click(function(event) {
                            var evt = evt || event;
                            evt.stopPropagation();
                            $(this).siblings('.search-col').addClass('active');
                        });
                        $('.search-form-inner .search-col').click(function(event) {
                            var evt = evt || event;
                            evt.stopPropagation();
                            $('.search-form-inner .search-col').addClass('active');
                        });
                        $(document).click(function() {
                            $('.search-form-inner .search-col').removeClass('active');
                        });
                    </script>-->
                                    <div class="btn-publish">
                        <a href="#">投稿</a>
                        <div class="btn-publish-child">
                            <ul class="btn-child clearfix">
                                <li><a href="http://my.freebuf.com/post/edit/" target="_blank">文章撰写</a></li>
                                <li><hr/></li>
                                <li><a href="http://my.freebuf.com/post/article/" target="_blank">投稿管理</a></li>
                                                        </ul>
                        </div>
                    </div>
                </div>
                <div class="nav-small">
                    <a href="#">&#xe634;</a>
                    <ul class="nav-child clearfix">
                                                        <li class=" index">
                                    <a href="http://www.freebuf.com">首页</a></li>
                                <li class="read-classify">
                                    <a href="#">分类阅读<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2 read-classify clearfix">
                                        <li>
                                            <strong>黑客</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                                <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                                <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                                <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                                <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                                <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                                <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                                <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                                <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                                <a href="http://www.freebuf.com/articles/es" target="_blank">企业安全</a>
                                                <a href="http://www.freebuf.com/ics-articles" target="_blank">工控安全</a>
                                            </div>
                                        </li>
                                        <li>
                                            <strong>极客</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                                <a href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                                            </div>
                                        </li>
                                        <li>
                                            <strong>特色</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/news/special" target="_blank">头条</a>
                                                <a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a>
                                                <a href="http://www.freebuf.com/fevents" target="_blank">活动</a>
                                                <a href="http://www.freebuf.com/video" target="_blank">视频</a>
                                                <a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a>
                                                <a href="http://www.freebuf.com/jobs" target="_blank">招聘</a>
                                                <a href="http://www.freebuf.com/paper/" target="_blank">报告</a>
                                            </div>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="http://zhuanlan.freebuf.com/" target="_blank">专栏</a></li>
                                <li><a href="http://open.freebuf.com" target="_blank">公开课</a></li>
                                <li><a href="http://shop.freebuf.com" target="_blank">商城</a></li>
                                <li>
                                    <a href="javascript:;" target="_blank">企业服务<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="https://www.vulbox.com/bounties/item-9-0-1" target="_blank"><strong>企业SRC</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://company.freebuf.com" target="_blank"><strong>企业空间</strong></a>
                                        </li>
                                        <li>
                                            <a href="https://www.vulbox.com/" target="_blank"><strong>安全测试</strong></a>
                                        </li>
                                        <li>
                                            <a href="https://www.riskivy.com/" target="_blank"><strong>风险感知</strong></a>
                                        </li>

                                    </ul>
                                </li>
                                <li>
                                    <a href="javascript:;" target="_blank">用户服务<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="http://www.freebuf.com/newsend" target="_blank"><strong>有奖投稿</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://zhuanlan.freebuf.com" target="_blank">
                                        </li>
                                        <li>
                                            <a href="https://www.vulbox.com/bounties/detail-72" target="_blank"><strong>提交漏洞</strong></a>
                                        </li>
                                        <li class="last">
                                            <a href="https://www.vulbox.com/bounties" target="_blank"><strong>参与众测</strong></a>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="javascript:;" target="_blank">文库<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="http://www.freebuf.com/wenku" target="_blank"><strong>文库</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://www.freebuf.com/special-subject" target="_blank"><strong>专题</strong></a>
                                        </li>
                                    </ul>
                                </li>
                                                    <li><a href="http://my.freebuf.com/post/edit" target="_blank">投稿</a></li>
                                                    <li><a href="https://account.tophant.com/register.html" class="login-btn">注册</a>
                            </li>
                            <li><a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a></li>
                                            </ul>
                </div>
            </div>
            <div class="dropdown-menu read-menu" id="read-menu">
                <div class="container">
                    <ul class="menu clearfix">
                        <li>
                            <strong>黑客</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                <a href="http://www.freebuf.com/articles/es" target="_blank">企业安全</a>
                                <a class="last" href="http://www.freebuf.com/ics-articles" target="_blank">工控安全</a>
                            </div>
                        </li>
                        <li>
                            <strong>极客</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                <a class="last" href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                            </div>
                        </li>
                        <li>
                            <strong>特色</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/news/special" target="_blank">头条</a>
                                <a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a>
                                <a href="http://www.freebuf.com/fevents" target="_blank">活动</a>
                                <a href="http://www.freebuf.com/video" target="_blank">视频</a>
                                <a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a>
                                <a href="http://www.freebuf.com/jobs" target="_blank">招聘</a>
                                <a class="last" href="http://www.freebuf.com/paper/" target="_blank">报告</a>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="dropdown-menu company-menu" id="company-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="https://www.vulbox.com/bounties/item-9-0-1" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-src.png"></span>
                                <span class="name">企业SRC</span>
                                <span class="intro">全/半托管式互联网漏洞收集管理</span>
                            </a>
                        </li>
                        <li>
                            <a href="http://company.freebuf.com" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-company.png"></span>
                                <span class="name">企业空间</span>
                                <span class="intro">为企业定制信息安全专属门户</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.vulbox.com/" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-safety.png"></span>
                                <span class="name">安全测试</span>
                                <span class="intro">国内领先的互联网安全众测服务</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="https://www.riskivy.com/" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-risk.png"></span>
                                <span class="name">风险感知</span>
                                <span class="intro">基于IT资产的自动化安全监控</span>
                            </a>
                        </li>

                    </ul>
                </div>
            </div>
            <div class="dropdown-menu user-menu" id="user-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="http://www.freebuf.com/newsend" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-write.png"></span>
                                <span class="name">有奖投稿</span>
                                <span class="intro">与整个行业分享你的经验与见解</span>
                            </a>
                        </li>
                        <li>
                            <a href="http://zhuanlan.freebuf.com" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-column.png"></span>
                                <span class="name">申请专栏</span>
                                <span class="intro">自由创作，打造自主内容品牌</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.vulbox.com/bounties/detail-72" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-leak.png"></span>
                                <span class="name">提交漏洞</span>
                                <span class="intro">与数万白帽一起，让互联网更安全</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="https://www.vulbox.com/bounties" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-test.png"></span>
                                <span class="name">参与众测</span>
                                <span class="intro">挖洞开启自由职业之路</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="dropdown-menu wenku-menu" id="wenku-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="http://www.freebuf.com/wenku" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-write.png"></span>
                                <span class="name">文库</span>
                                <span class="intro">最全的FB百科</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="http://www.freebuf.com/special-subject" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-test.png"></span>
                                <span class="name">专题</span>
                                <span class="intro">浓缩的安全精华汇总</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!----------header end---------->
<!--<script type="application/javascript">
    var  _value_tab = '';
    $(function(){
        var _that = '', _show_flag = 0;
        $('.header .header-container .nav .nav-child > li:not(input[data-value])').mouseover(function() {
            $('.header .dropdown-menu').stop().slideUp(50);
        });
        $('.header').mouseout(function() {
            $('.header .dropdown-menu').stop().slideUp(50);
        });
        /*$('.header .header-container .nav .nav-child > li').mouseover(function() {
         _value_tab = $(this).attr('data-value');
         $('#'+_value_tab).siblings('.dropdown-menu').stop().slideUp(50);
         $('#'+_value_tab).stop().slideDown(100);
         });*/
        $(".header .header-container .nav .nav-child > li").hoverDelay({
            hoverDuring: 500,
            hoverEvent: function(){
                $('#'+_value_tab).siblings('.dropdown-menu').stop().slideUp(50);
                $('#'+_value_tab).stop().slideDown(100);
            }
        });
        $('.header .dropdown-menu').mouseover(function() {
            _value_tab = $(this).attr('id');
            _that = this;
            $('.nav-child li[data-value="'+_value_tab+'"]').addClass('hover');
            $(this).stop().slideDown(50);
        }).mouseout(function() {
            $('.nav-child li[data-value="'+_value_tab+'"]').removeClass('hover');
            $(_that).stop().slideUp(50);
        });

        $(".nav-small .nav-child > li").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();

            if($(this).find('.nav-child2').is(":hidden")) {
                _show_flag = 1;
                $(this).find('.nav-child2').slideDown();
                $(this).find('.icon-arrow').addClass('bottom');
            }else {
                _show_flag = 0;
                $(this).find('.nav-child2').slideUp();
                $(this).find('.icon-arrow').removeClass('bottom');
            }
            $(this).siblings().find('.nav-child2').slideUp();
            $(this).siblings().find('.icon-arrow').removeClass('bottom');
        });
        //头部投稿按钮hover状态展开菜单
        $(".btn-publish-child > ul > li").hover(function(){
            $(this).addClass("active");
            $(this).siblings().removeClass("active");
        });

        $(document).click(function(event){
            var ev = ev || event;
            $(".login-after").find(".login-after-child").hide();
        });
        //点击用户信息，出现下拉菜单
        $("#user-info").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();
            $(".login-after").find(".login-after-child").toggle();
        });
        //顶部导航
        $(".nav-small").click(function(){
            $(this).find(".nav-child").slideToggle();
        });
        var that = '';
        $('.header .header-container .nav .nav-child > li').mouseover(function() {
            that = this;
            $(this).find('.dropdown-menu').stop().slideDown(200);
        }).mouseout(function() {
            $(that).find('.dropdown-menu').stop().slideUp(200);
        });
    });
    $(".nav-small .nav-child > li").click(function(event){
        var ev = ev || event;
        ev.stopPropagation();
        $(this).siblings('li').find('.dropdown-menu').hide();
        $(this).find(".dropdown-menu").toggle();
    });
    //鼠标经过(hover)事件的延时处理
    (function($){
        $.fn.hoverDelay = function(options){
            var defaults = {
                hoverDuring: 100,
                outDuring: 100,
                hoverEvent: function(){
                    $.noop();
                },
                outEvent: function(){
                    $.noop();
                }
            };
            var sets = $.extend(defaults,options || {});
            var hoverTimer, outTimer;
            return $(this).each(function(){
                $(this).hover(function(){
                    _value_tab = $(this).attr('data-value');
                    clearTimeout(outTimer);
                    hoverTimer = setTimeout(sets.hoverEvent, sets.hoverDuring);
                },function(){
                    clearTimeout(hoverTimer);
                    outTimer = setTimeout(sets.outEvent, sets.outDuring);
                });
            });
        }
    })(jQuery);
</script>-->
<script type="text/javascript" src="http://static.3001.net/js/header/header.js"></script><script>
    jQuery(window).load(function(){
      if(jQuery(window).width()>480){
        jQuery(".main-header").sticky({ topSpacing: 0 });
      }else{
        jQuery(".main-header nav").removeClass("navbar-fixed-top");
      }
      jQuery("#mar-right").sticky({ topSpacing: 105,bottomSpacing: 410 });
    });
</script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/layer.js"></script>
<script type="text/javascript" src="http://static.3001.net/js/pretty/prettify.js"></script>
<script type="text/javascript" src="http://static.3001.net/js/header/lazyload.js"></script>
<script type="text/javascript" charset="utf-8">
      jQuery(function() {
          jQuery("img").lazyload({
              effect : "fadeIn"
          });
      });
 </script>
<script type="text/javascript">
    window.onload = function(){
        prettyPrint();
    }
</script>
<script language="JavaScript" type="text/javascript">
//<![CDATA[
var va = "您已经点亮过了";
function acv_vote(id,option, m){
  if( m==null) m =''; m = m + '';
  jQuery('#acv_stat_'+m+id).html('Loading...');
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option="+option+"&ID="+id;
  jQuery.get(url,function(d){
    d =d.split('|');var s='#acv_stat_'+m+d[0];
    var sele = '#cos_support-'+m+id,unsele = '#cos_unsupport-'+m+id,tpjs = 'javascript:alert(va)';
    jQuery( s ).html( d[1] );jQuery(s).fadeOut(400,function(){jQuery(s).fadeIn();});
    if( d[2] == 1 ){ jQuery(sele).html(jQuery(sele).html()*1+1); }
    if( d[2] == -1 ){ jQuery(unsele).html(jQuery(unsele).html()*1+1); }
    jQuery('#vote4-'+id).attr('href',tpjs);jQuery('#vote4-2'+id).attr('href',tpjs);
    jQuery('#votea-'+id).attr('href',tpjs);jQuery('#votea-2'+id).attr('href',tpjs);
  });
}
  
$(document).on("mouseenter",".comment-tools",function(){
  $(this).find(".btn-report").show();
  $(this).find(".btn-report").addClass("hover");
}).on("mouseleave",".comment-tools",function(){
  var $_this = $(this);
  $(this).find(".btn-report").removeClass("hover");
  if(!$(this).find(".dropup").hasClass('open')){
    $(this).find(".btn-report").hide(); 
    $_this.find(".dropdown-menu").css("display","none");
  }else{
    setTimeout(function(){
      if(!$_this.find(".btn-report").hasClass("hover")){
        $_this.find(".dropup").removeClass("open");
        $_this.find(".dropdown-menu").css("display","none");
        $_this.find(".btn-report").hide(); 
      }
    },"500");
  }
})

$(document).on("click",".click_report",function(){
  $(this).parent().parent().css("display","none");
  var id = $(this).attr("data-id");
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option=0&ID="+id;
  $_this = $(this);
  jQuery.get(url,function(d){
    d =d.split('|');
    if(d[1]=='您已经点过灯了'){
      d[1] = '您已经举报过了';
    }
    if(d[1]=='Thank you'){
      d[1] = '举报成功';
    }
    $_this.parent().parent().parent().find(".btn-report").text(d[1]);
    $_this.parent().parent().parent().find(".btn-report").css("display","block");
  })
})

$(document).on("click",".btn-report",function(){
  if($(this).parent().hasClass('open')){
    $(this).parent().find(".dropdown-menu").css("display","block");
  }else{
    $(this).parent().find(".dropdown-menu").css("display","none");
  }
})
//]]>
</script>
<div class="column-article" data-column="">
            <div class="container pad-top35">
        <div class="row clearfix">
            <div class="col-md-9" id="getWidth">
                                    <div class="reletive search-xs-wrap">
                    <div class="form-group has-active search-col search-xs">
                        <form id="hpsform-new" class="navbar-search navbar-form" onsubmit="return dispatch()">
                            <div class="form-group">
                                <input id="q" class="input form-control" type="text" placeholder="关键字查找" autocomplete="off" title="关键字查找" name="q">
                                <button class="submit" type="submit"></button>
                            </div>
                        </form>
                    </div>
                </div>
                    <script type="text/javascript">
                        var dispatch = function () {
                            console.log(123)
                            var q = document.getElementById("q");
                            if (q.value == "") {
                                q = document.getElementById("bigq");
                            }
                            if (q.value != "") {
                                window.open('http://www.freebuf.com/?s=' + q.value, "_blank");
                                return false;
                            } else {
                                return false;
                            }
                        }
                    </script>
                                <div class="article-wrap panel panel-default">
                                                            <div class="articlecontent">
                                                    <div class="title">
                                <h2>
                                    如何进行Linux平台共享库替换                                </h2>
                                <div class="property">
                                                                            <span class="name"><a href="http://www.freebuf.com/author/gaearrow" title="由 gaearrow 发布" rel="author">gaearrow</a></span>
                                                                        <span class="icon-f"></span>
                                    <span class="time">2016-10-19</span>
                                                                                                                <span class="rmb"><img title="现金奖励" src="http://image.3001.net/images/new/icon-m.jpg"/></span>
                                                                        <span class="look">共<strong>197857</strong>人围观
                                        ，发现 <strong>21</strong> 个不明物体 </span>                                      </span>
                                                                <span class="tags">
                                      <a href="http://www.freebuf.com/./articles/system">系统安全</a></span>
                                    <span class="tags_01"></span>
                                </div>
                            </div>
                                                                                                <div id="contenttxt">
                            <p><span style="color: rgb(239, 71, 71);"><b>*本文原创作者：gaearrow，本文属FreeBuf原创奖励计划，未经许可禁止转载&nbsp;</b>。    </span></p>
<h2>共享库基础知识<span></span></h2>
<p><b style="color: rgb(0, 176, 80);">程序由源代码变成可执行文件，一般可以分解为四个步骤，分别是预处理（Prepressing）、编译（Compilation）、汇编（Assembly）和链接（Linking）。预处理过程主要处理源代码中以“#”开始的预编译指令；编译过程把预处理完成的文件进行词法、语法、语义等分析并产生相应的汇编代码文件；汇编过程将汇编代码文件翻译成机器可以执行的目标文件；链接过程将汇编生成的目标文件集合相连接并生成最终的可执行文件。</b></p>
<p>链接方式分为静态链接和动态链接，静态链接分发程序只需要生成的可执行文件，动态链接分发程序不仅需要可执行文件，还要包含相应<span></span>的库文件。该库文件在Windows平台称为动态链接库（Dynamic-Link Library，DLL），在Linux平台一般称为共享库（Shared Object，SO）。</p>
<p>Linux平台SO替换可以分为静态替换和动态替换：静态替换利用文件操作直接替换SO，新SO在下次加载时生效；动态替换利用代码注入替换目标进程内存空间，实现新SO的加载和替换，新SO立即生效。</p>
<h2>静态替换</h2>
<p>针对未被加载的SO，利用复制命令（cp new.so old.so）即可直接完成静态替换，新SO在下次加载时生效。对于已经加载的原SO，直接用新SO复制替换将会导致相应程序崩溃，此种情况可以使用删除原SO（rm -f old.so）或修改原SO名称（mv old.so oldx.so）后，再复制新SO的方法代替，新SO同样在下次加载时生效。</p>
<p>程序崩溃的原因是复制替换操作会破坏系统访问原SO的索引节点inode，导致系统找不到原SO。系统为每个加载到内存中的文件创建对应的inode，用来管理该文件，inode包含了文件的元信息，如文件字节数、拥有者ID、读写执行权限等。系统以inode标识程 序加载的SO，不再关心文件名，修改SO名称并未改变对应inode，因此程序可以继续正常运行；删除SO只是无法查看，系统直到程序释放SO后才真正删除SO和inode，因此程序也可以继续正常运行；但是在直接复制替换时，新SO将会继承原SO的inode，程序无法继续访问原SO，从而导致程序崩溃。</p>
<h2>动态替换</h2>
<p>针对已经被程序加载的SO，为了实现不停止程序，替换后的SO立即生效的目的，可以采用动态替换。</p>
<p>动态替换的对象既可以是SO整体，也可以是SO中的特定函数。两者的区别主要是整体替换需要在特定函数替换的基础上再增加SO加载及输出函数重定位等过程。由于时间有限， 本文仅介绍特定函数动态替换的基本原理和初步实现，SO整体替换感兴趣的 读者可以自行尝试。</p>
<p>SO特定函数动态替换主要包括三个关键过程：控制目标进程，构造替换内容和确定替换地址，实际上依次解决的就是利用什么替换、替换什么内容和替换到哪里的问题。</p>
<h3>控制目标进程</h3>
<p>为实现对其它进程空间或运行进行控制， Linux平台提供了进程跟踪函数Ptrace()（类似于Windows平台的创建远程线程函数CreateRemoteThread()）。</p>
<p>Ptrace()函数引用头文件和参数形式如下：</p>
<pre><code>#include&lt;sys/ptrace.h&gt;
int ptrace(int request,int pid,int addr,int data);
</code></pre>
<p>其中，request参数决定了该函数的调用功能。</p>
<pre><code>PTRACE_ATTACH/ PTRACE_DETACH
int ptrace(PTRACE_ATTACH,Pid,NULL,NULL);
int ptrace(PTRACE_DETACH,Pid,NULL,NULL);
</code></pre>
<p><span></span></p>
<p>分别实现跟踪和结束跟踪目标进程功能。Pid表示目标进程标识符。成功跟踪后，被跟踪进程将成为当前进程的子进程，并进入中止状态。</p>
<pre><code>PTRACE_POKEDATA
int ptrace(PTRACE_?POKEDATA,Pid,Addr,Data);
</code></pre>
<p>实现向目标进程内存中写入一个字节数据功能。Pid表示目标进程标识符，Addr存储写入的内存地址，Data为要写入的数据。</p>
<p>除了以上本文中用到的功能，Ptrace()函数还提供数据读取（PTRACE_PEEKDATA）、终止进程（PTRACE_KILL）和重新运行（PTRACE_CONT）等功能，针对Intel386平台还提供读取和设置寄存器等功能。</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20161009/14759740497012.png%21small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20161009/14759740497012.png%21small" alt=""></p></noscript>
<p style="text-align: center;"><b>图 1特定函数替换主要过程活动图</b></p>
<p>SO特定函数动态替换主要过程活动图如图1所示，其中跟踪和结束跟踪目标进程过程由Ptrace()函数直接完成，替换目标进程内存过程由Ptrace()配合构造的替换内容共同完成。</p>
<h3><strong></strong>构造替换内容</h3>
<p>构造替换内容主要包括两方面工作，一是分析被替换函数的特征，确定替换空间结构和堆栈恢复指令；二是完成替换函数的编译、Shellcode提取及再构造。</p>
<p><b>被替换函数特征分析</b></p>
<p>测试被替换函数hello()存在于SO的libfso.so中，由主程序main载入并以固定周期循环调用，其反汇编代码如图2所示。由图可知，方框标识的代码为堆栈平衡和函数返回指令，函数实际执行部分为地址hello+8至hello+60之间。因此包含堆栈恢复和函数返回指令（2字节）的最大可替换空间地址为hello+8至hello+61，共计54个字节。</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20161009/14759740579243.png%21small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="">?</p>
<noscript><img src="http://image.3001.net/images/20161009/14759740579243.png%21small" alt="">?</p></noscript>
<p style="text-align: center;"><b>图 2测试被替换函数反汇编代码</b></p>
<p><b>替换函数编译再构造</b></p>
<p>测试替换函数汇编代码如图3所示，功能为输出Hello World!字符，其中方框标识的空指令是为堆栈恢复和函数返回指令预留的存储空间。</p>
<p>经过编译提取后可以得到46个字节的Shellcode，为了避免程序误将helloworld字符理解成指令执行导致程序崩溃，还需要将原函数的堆栈恢复和函数返回指令拷贝至预留的空指令位置，提前返回函数。成功替换后的被替换函数结构如图4所示，其中小方格内为堆栈平衡和函数返回指令，大方格内为构造的替换内容。</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20161009/14759740643510.png%21small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20161009/14759740643510.png%21small" alt=""></p></noscript>
<p style="text-align: center;"><b>图 3测试替换函数汇编代码</b></p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20161009/14759740685995.png%21small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20161009/14759740685995.png%21small" alt=""></p></noscript>
<p style="text-align: center;"><b>图 4成功替换后实际结构</b></p>
<h3>确定替换地址</h3>
<p>由于地址加载随机化ASLR（Address space layout randomization）的影响，SO加载到内存的基地址并不固定，但是函数相对于基地址的偏移地址是固定不变的。因此对被替换函数所在SO进行反汇编分析，可以确定被替换函数替换位置首地址，再配合linux提供的进程虚拟地址空间查看命令得到SO加载基地址，简单相减即可得到被替换函数位置相对偏移地址。待准备实施替换时，只需再次利用进程虚拟地址空间查看命令获得基地址加上相对地址就可以确定实际替换首地址。</p>
<p>图5中地址0x2b6901e0f000为测试程序SO加载基地址，图6中0x2b6901e0f514为函数替换位置首地址，相减得到0&#215;514，即为被替换函数替换起始位置的相对偏移地址。</p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20161009/14759740763086.png%21small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=""></p>
<noscript><img src="http://image.3001.net/images/20161009/14759740763086.png%21small" alt=""></p></noscript>
<p style="text-align: center;"><b>图 5共享库加载基地址</b></p>
<p style="text-align: center;"><img data-original="http://image.3001.net/images/20161009/14759740803815.png%21small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt="">?</p>
<noscript><img src="http://image.3001.net/images/20161009/14759740803815.png%21small" alt="">?</p></noscript>
<p style="text-align: center;"><b>图 6替换位置首地址</b></p>
<h2>测试实例</h2>
<h3><strong>测试环境</strong></h3>
<blockquote><p>CentOS 6.6 (Final)Linux version 2.6.32</p>
<p>gcc version 4.4.7 20120313</p>
<p>nasm version 2.07</p>
</blockquote>
<p>前文截图为64位系统情况，以下为32位系统情况。</p>
<h3>被动态替换程序</h3>
<p>【动态链接库】</p>
<pre><code>//fso.c
//gcc -c -Wall -Werror -fPIC fso.c
//gcc -shared -o libfso.so fso.o

#include &lt;stdio.h&gt;

void hello()
{
    int i = 0;
    int j = 0;
    printf("Hello Myboy!\n");
    for(i=0; i&lt;10000000; i++)
    {
        j++;
    }
}
</code></pre>
<p>以上代码中的for循环，仅仅是为了确保Shellcode在替换时具有足够的存储空间。</p>
<p>【被动态替换程序】</p>
<pre><code>//main.c
//gcc -L /home/mycos/so -Wall -o main main.c -lfso
//export LD_LIBRARY_PATH=/home/mycos/so :$LD_LIBRARY_PATH

#include &lt;stdio.h&gt;

extern void hello(void);

int main()
{
    int i = 0;
    printf("This is Main!\n");
    while(1)
    {
        if(i%10 == 0) printf("\n");
        sleep(1);
        hello();
        i++;
    }   
    return 0;
}
</code></pre>
<p>详细信息或出现错误请参见 <a href="http://blog.csdn.net/dearggae/article/details/47612565">加载动态链接库so程序简单实例</a><strong><span></span></strong></p>
<h3>Shellcode</h3>
<p>【hello.asm】</p>
<pre><code>; 32-bit "Hello World!" in CentOS 6 i686
; nasm -felf32 hello.asm -o hello.o
; ld -s -o hello hello.o

global _start

_start:
    jmp string

code:

    pop     ecx
    mov     eax, 0x4
    mov     ebx, 0x1
    mov     edx, 0xD
    int     0x80

    nop
    nop
    nop
    nop
    nop
    nop
    nop
    nop

string:
    call    code
    db 'Hello world!',0x0a
</code></pre>
<p>以上空指令nop，是为堆栈恢复和函数返回指令预留的存储空间，预留空指令空间必须比被替换程序动态库堆栈恢复和函数返回指令占用的空间大。</p>
<p>【提取Shellcode】</p>
<pre><code>for i in $(objdump -d hello |grep "^ " |cut -f2); do echo -n '\x'$i; done; echo
</code></pre>
<p>执行以上命令得到如下Shellcode，共计49个字节，但是该Shellcode还不能直接使用，需要根据目标程序动态链接库实际情况进行修改。</p>
<pre><code>\xe9\x1a\x00\x00\x00\x59\xb8\x04\x00\x00\x00\xbb\x01\x00\x00\x00\xba\x0d\x00\x00\x00\xcd\x80\x90\x90\x90\x90\x90\x90\x90\x90\xe8\xdf\xff\xff\xff\x48\x65\x6c\x6c\x6f\x20\x77\x6f\x72\x6c\x64\x21\x0a
</code></pre>
<p>【修改Shellcode】</p>
<p>利用GDB调试被替换程序，得到动态库中函数堆栈恢复和函数返回的代码。</p>
<pre><code>[mycos@localhost so]$ gdb main

(gdb) b hello
Breakpoint 1 at 0x804842c

(gdb) r
Starting program: /home/mycos/so/main 
This is Main!

Breakpoint 1, 0x00111434 in hello () from /home/mycos/so/libfso.so

(gdb) disas hello
Dump of assembler code for function hello:
   0x00111430 &lt;+0&gt;:     push   %ebp
   0x00111431 &lt;+1&gt;:     mov    %esp,%ebp
   0x00111433 &lt;+3&gt;:     push   %ebx
=&gt; 0x00111434 &lt;+4&gt;:     sub    $0x24,%esp
   0x00111437 &lt;+7&gt;:     call   0x111429 &lt;__i686.get_pc_thunk.bx&gt;
   0x0011143c &lt;+12&gt;:    add    $0x1190,%ebx
   0x00111442 &lt;+18&gt;:    movl   $0x0,-0x10(%ebp)
   0x00111449 &lt;+25&gt;:    movl   $0x0,-0xc(%ebp)
   0x00111450 &lt;+32&gt;:    lea    -0x10f8(%ebx),%eax
   0x00111456 &lt;+38&gt;:    mov    %eax,(%esp)
   0x00111459 &lt;+41&gt;:    call   0x111334 &lt;puts@plt&gt;
   0x0011145e &lt;+46&gt;:    movl   $0x0,-0x10(%ebp)
   0x00111465 &lt;+53&gt;:    jmp    0x11146f &lt;hello+63&gt;
   0x00111467 &lt;+55&gt;:    addl   $0x1,-0xc(%ebp)
   0x0011146b &lt;+59&gt;:    addl   $0x1,-0x10(%ebp)
   0x0011146f &lt;+63&gt;:    cmpl   $0x98967f,-0x10(%ebp)
   0x00111476 &lt;+70&gt;:    jle    0x111467 &lt;hello+55&gt;
   0x00111478 &lt;+72&gt;:    add    $0x24,%esp
   0x0011147b &lt;+75&gt;:    pop    %ebx
   0x0011147c &lt;+76&gt;:    pop    %ebp
   0x0011147d &lt;+77&gt;:    ret    
End of assembler dump.
</code></pre>
<pre><code>(gdb) x /8xb 0x111478
0x111478 &lt;hello+72&gt;:    0x83    0xc4    0x24    0x5b    0x5d    0xc3    0x90    0x90
</code></pre>
<p>分析动态库hello函数的汇编代码，可以较容易的判断出恢复堆栈和函数返回的地址从0&#215;00111478到0x0011147d共6个字节，且该函数实际可被shellcode覆盖填充的部分从0&#215;00111437（函数开始的堆栈平衡处理部分不能覆盖，易导致异常）到0x0011147d共70个字节大于shellcode的49个字节，满足替换空间要求。因此最后得到的Shellcode如下：</p>
<pre><code>\xe9\x1a\x00\x00\x00\x59\xb8\x04\x00\x00\x00\xbb\x01\x00\x00\x00\xba\x0d\x00\x00\x00\xcd\x80\x83\xc4\x24\x5b\x5d\xc3\x90\x90\xe8\xdf\xff\xff\xff\x48\x65\x6c\x6c\x6f\x20\x77\x6f\x72\x6c\x64\x21\x0a
</code></pre>
<p>查看被替换程序的内存分配情况，得到动态链接库加载基址（0&#215;00111000），结合上面GDB调试得到的函数替换起始地址（0&#215;00111437），可以确定替换地址的固定偏移量为0&#215;437，因此只要替换程序确定动态链接库基址，即可利用固定偏移量得到替换起始地址。</p>
<pre><code>[mycos@localhost asm]$ ps aux | grep main
mycos    13626  0.0  1.3  22292 14376 pts/2    S+   00:17   0:00 gdb main
mycos    13628  0.0  0.0   1872   344 pts/2    T    00:17   0:00 /home/mycos/so/main
mycos    13793  0.0  0.0   4352   724 pts/3    S+   01:08   0:00 grep main

[mycos@localhost asm]$ cat /proc/13628/maps
00110000-00111000 r-xp 00000000 00:00 0          [vdso]
00111000-00112000 r-xp 00000000 08:02 1054157    /home/mycos/so/libfso.so
00112000-00113000 rw-p 00000000 08:02 1054157    /home/mycos/so/libfso.so
008ed000-0090b000 r-xp 00000000 08:02 1053999    /lib/ld-2.12.so
0090b000-0090c000 r--p 0001d000 08:02 1053999    /lib/ld-2.12.so
0090c000-0090d000 rw-p 0001e000 08:02 1053999    /lib/ld-2.12.so
00913000-00aa3000 r-xp 00000000 08:02 1054095    /lib/libc-2.12.so
00aa3000-00aa5000 r--p 00190000 08:02 1054095    /lib/libc-2.12.so
00aa5000-00aa6000 rw-p 00192000 08:02 1054095    /lib/libc-2.12.so
00aa6000-00aa9000 rw-p 00000000 00:00 0 
08048000-08049000 r-xp 00000000 08:02 1054152    /home/mycos/so/main
08049000-0804a000 rw-p 00000000 08:02 1054152    /home/mycos/so/main
b7ff1000-b7ff2000 rw-p 00000000 00:00 0 
b7ffe000-b8000000 rw-p 00000000 00:00 0 
bffeb000-c0000000 rw-p 00000000 00:00 0          [stack]
</code></pre>
<h3>动态替换程序</h3>
<pre><code>//injectso.c
//gcc injectso.c -o injectso
#include &lt;sys/ptrace.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/wait.h&gt;
#include &lt;sys/user.h&gt;
#include &lt;sys/file.h&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

const int long_size = sizeof(long);

void getdata(pid_t child, long addr, char *str, int len)
{
    char *laddr;
    int i,j;
    union u{
        long val;
        char chars[long_size];
    }data;

    i = 0;
    j = len / long_size;
    laddr = str;
    while(i &lt; j){
        data.val = ptrace(PTRACE_PEEKDATA, child, addr + i*4, NULL);
        if (data.val &lt; 0) {
            printf("getdata1 Failed! \n");
            return;
        }

        memcpy(laddr, data.chars, long_size);
        ++i;
        laddr += long_size;
    }
    j = len % long_size;
    if(j != 0){
        data.val = ptrace(PTRACE_PEEKDATA, child, addr + i*4, NULL);
        if (data.val &lt; 0) {
            printf("getdata2 Failed! \n");
            return;
        }
        memcpy(laddr, data.chars, j);
    }
    str[len] = ' ';
}

void putdata(pid_t child, long addr, char *str, int len)
{
    char *laddr;
    int i,j;
    union u{
        long val;
        char chars[long_size];
    }data;

    long rst; 

    i = 0;
    j = len / long_size;
    laddr = str;
    while(i &lt; j){
        memcpy(data.chars, laddr, long_size);
        rst = ptrace(PTRACE_POKEDATA, child, addr + i*4, data.val);
        if (rst &lt; 0) {
            printf("Putdata1 Failed! \n");
            return;
        }
        ++i;
        laddr += long_size;
    }
    j = len % long_size;
    if(j != 0){
        memcpy(data.chars, laddr, j);
        rst = ptrace(PTRACE_POKEDATA, child, addr + i*4, data.val);
        if (rst &lt; 0) {
            printf("Putdata2 Failed! \n");
            return;
        }
    }
}

long getsobaseaddr(pid_t pid, char* soname)
{
    FILE *fp;
    char filename[30];
    char line[100];
    long addr;
    char str[100];
    sprintf(filename, "/proc/%d/maps", pid);
    fp = fopen(filename, "r");
    if(fp == NULL)
        return 1;
    while(fgets(line, 100, fp) != NULL) {
        sscanf(line, "%x-%*s %*s %*s %*s %*s %s", &amp;addr, 
               str, str, str, str, str, str);
        if(strstr(str, soname) != NULL)
            break;
    }
    fclose(fp);
    return addr + 0x437; //offset
}

int main(int argc, char *argv[])
{
    pid_t traced_process;
    struct user_regs_struct regs;
    int len = 49;

    /* hello world */
    char code[] =
        "\xe9\x1a\x00\x00\x00\x59\xb8\x04"
        "\x00\x00\x00\xbb\x01\x00\x00\x00"
        "\xba\x0d\x00\x00\x00\xcd\x80\x83"
        "\xc4\x24\x5b\x5d\xc3\x90\x90\xe8"
        "\xe1\xff\xff\xff\x48\x65\x6c\x6c"
        "\x6f\x20\x77\x6f\x72\x6c\x64\x21"
        "\x0a";

    if(argc != 2) {
        printf("PID?\n");
        return 1;
    }

    traced_process = atoi(argv[1]);
    ptrace(PTRACE_ATTACH, traced_process, NULL, NULL);
    int pid = wait(NULL);
    printf("Attach Pid: %d\n",pid);
    ptrace(PTRACE_GETREGS, traced_process, NULL, &amp;regs);

    long helloaddr = getsobaseaddr(traced_process, "libfso.so");
    printf("Inject So Addr: %p\n", helloaddr);
    putdata(traced_process, helloaddr, code, len);

    ptrace(PTRACE_SETREGS, traced_process, NULL, &amp;regs);
    ptrace(PTRACE_DETACH, traced_process, NULL, NULL);
    return 0;
}
</code></pre>
<p><span></span></p>
<p>在x86_64平台下，以上代码需要进行适当修改：一是头文件由 sys/user.h 改成 linux/user.h；二是getdata/putdata函数中涉及地址的位置由 4 改成 8；三是user_regs_struct结构体的指令寄存器由 eip 改成 rip；四是shellcode修改适用于x86_64平台。<strong><span></span></strong></p>
<h3>执行结果</h3>
<p>执行动态替换程序，被替换程序输出由Hello Myboy! 变成 Hello world! 且继续正常运行，说明替换已成功。</p>
<pre><code>[mycos@localhost so]$ ps aux | grep main
mycos    13834 12.2  0.0   1872   384 pts/0    T    21:16   0:03 ./main
mycos    13293  0.0  0.0   4352   720 pts/1    S+   21:16   0:00 grep main
[mycos@localhost so]$ ./injectso 13834
</code></pre>
<pre><code>[mycos@localhost so]$ ./main
This is Main!

Hello Myboy!
Hello Myboy!
Hello Myboy!
Hello Myboy!
Hello Myboy!
Hello Myboy!
Hello Myboy!
Hello Myboy!
Hello Myboy!
Hello Myboy!

Hello Myboy!
Hello Myboy!
Hello world!
Hello world!
Hello world!
Hello world!
</code></pre>
<p><span></span></p>
<h2>参 考</h2>
<p><a href="http://www.linuxidc.com/Linux/2011-01/31622.htm">http://www.linuxidc.com/Linux/2011-01/31622.htm</a></p>
<p><a href="http://www.cnblogs.com/itech/archive/2012/05/15/2502284.html">http://www.cnblogs.com/itech/archive/2012/05/15/2502284.html</a></p>
<p><a href="http://blog.csdn.net/myarrow/article/details/9630377">http://blog.csdn.net/myarrow/article/details/9630377</a></p>
<p><a href="http://blog.csdn.net/tju355/article/details/6884696">http://blog.csdn.net/tju355/article/details/6884696</a></p>
<p><a href="http://theantway.com/2013/01/notes-for-playing-with-ptrace-on-64-bits-ubuntu-12-10/">http://theantway.com/2013/01/notes-for-playing-with-ptrace-on-64-bits-ubuntu-12-10/</a></p>
<p><a href="http://www.cnblogs.com/wangkangluo1/archive/2012/06/05/2535484.html">http://www.cnblogs.com/wangkangluo1/archive/2012/06/05/2535484.html</a></p>
<p><a href="http://blog.sina.com.cn/s/blog_4ac74e9a0100n7w1.html">http://blog.sina.com.cn/s/blog_4ac74e9a0100n7w1.html</a></p>
<p><a href="http://blog.sina.com.cn/s/blog_601f224a01013alj.html">http://blog.sina.com.cn/s/blog_601f224a01013alj.html<span></span></a></p>
<p><b><b style="color: rgb(159, 163, 168);">*本文原创作者：gaearrow，本文属FreeBuf原创奖励计划，未经许可禁止转载&nbsp;</b><br /> </b></p>
                                                    </div>
                        <div class="article-oper article-oper-new">
                            <style>
                                @font-face {font-family: 'iconfont';
                                    src: url('http://static.3001.net/iconfonts/iconfont.eot'); /* IE9*/
                                    src: url('http://static.3001.net/iconfonts/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
                                    url('http://static.3001.net/iconfonts/iconfont.woff') format('woff'), /* chrome、firefox */
                                    url('http://static.3001.net/iconfonts/iconfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
                                    url('http://static.3001.net/iconfonts/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
                                }
                            </style>
                            <div class="share-new clearfix">
                                <div class="share-author">
                                                                            <a href="http://www.freebuf.com/author/gaearrow" title="由 gaearrow 发布" rel="author">
                                            <img src="http://image.3001.net/images/20170412/14920007621660.jpg!video" width="50" height="50" alt="gaearrow" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 photo" />                                            <!--							<img src="http://image.3001.net/2015/06/17.jpg" alt="ArthurKiller">-->
                                        </a>
                                        <div class="share-author-info">
                                                                                        <a class="author-name" href="http://www.freebuf.com/author/gaearrow">gaearrow</a>
                                            <!--<span class="icon-f"></span>-->
                                            <span>
                                <i class="colour-red">
                                    5                                </i>
                                篇文章</span>
                                            <span>等级：
                                <i class="colour-green">4</i>级
                            </span>
                                        </div>
                                                                                                        </div>
                                <div class="user-center clearfix">
                                                                            <a href="http://www.freebuf.com/author/gaearrow" data-toggle="tooltip" data-placement="top" title="个人主页" class="home" target="_blank"></a>
                                                                        <a href="http://www.freebuf.com/user/pm?pmaction=newmessage&to=gaearrow" data-toggle="tooltip" data-placement="top" title="私信" class="letter" target="_blank"></a>
                                </div>
                                <div class="share-ctrl clearfix">
                                                                        <div class="bdsharebuttonbox clearfix bdshare-button-style1-24 columnstatus"
                                         data-bd-bind="1489991449190" data-column="" data-title="如何进行Linux平台共享库替换" data-name="">
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="tsina" title="分享到新浪微博" id="tsina"></a>
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="weixin" title="分享到微信" id="weixin"></a>
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="qzone" title="分享到QQ空间" id="qzone"></a>
                                       <!-- _shareUrlWeibo = 'http://service.weibo.com/share/share.php?url=http://'+encodeURIComponent(_json[i].url)+'&title='+encodeURIComponent(_json[i].title)+'-FreeBuf涓撴爮路'+_json[i].columnName;
                                        _shareUrlZone = 'http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://'+encodeURIComponent(_json[i].url)+'&title='+_json[i].title+'-FreeBuf涓撴爮路'+_json[i].columnName;
                                        _shareSrc = 'http://s.jiathis.com/qrcode.php?url=http://'+_json[i].url;-->
                                        <span class="share-line">|</span>
                                    </div>
                                </div>
                                <div class="user-ctrl clearfix">
                                                                            <a href="http://www.freebuf.com/oauth" id="collect" data-toggle="tooltip" data-placement="top" title="收藏" ></a>
                                                                        <a href="#respond" data-toggle="tooltip" data-placement="top" title="评论" id="comments"></a>
                                                                        <!--					<a href="#" title="文章纠正">&#xe6e3;</a>-->
                                    <span class="share-line">|</span>
                                    <span class="info-alert"></span>
                                </div>
                            </div>
                            <script>
                                var column = $('.columnstatus').attr('data-column');
                                var text = '';
                                if(column){
                                    var title = $('.columnstatus').attr('data-title');
                                    var name = $('.columnstatus').attr('data-name');
                                    text = title+' - FreeBuf专栏·'+name;
                                }
                                window._bd_share_config={
                                    "common": {
                                        "bdSnsKey": {},
                                        "bdText": text,
                                        "bdMini": "2",
                                        "bdMiniList": ["qzone", "tsina", "weixin"],
                                        "bdPic": "",
                                        "bdStyle": "1",
                                        "bdSize": "24"
                                    },
                                    "share":{},
                                };
                                with(document)0[
                                    (getElementsByTagName('head')[0]||body).
                                    appendChild(createElement('script')).
                                        src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)
                                    ];
                                //控制垂直方向分享模块的定位
                                function shareFixVertical(){
                                    var offsetTop = jQuery(".article-oper").get(0).offsetTop;
                                    var win_h = jQuery(window).height();
                                    var win_w = jQuery(window).width();
                                    var scrollTop = document.body.scrollTop||document.documentElement.scrollTop;
                                    var _height = offsetTop-scrollTop;
                                    var _flag = $('.column-article').attr('data-column');
                                    if(_flag == 1) {
                                        if(_height>=win_h-660&&win_w>975){
                                            var _width = jQuery("#getWidth").innerWidth()-30;
                                            var _left = jQuery("#getWidth").offset().left+15;
                                            jQuery(".share-new").addClass("fixed");
                                            jQuery(".fixed").css({
                                                width:_width,
                                                left:_left
                                            });

                                        }else{
                                            jQuery(".share-new").removeClass("fixed");
                                            jQuery(".share-new").css({
                                                width: "100%"
                                            });
                                        }
                                    }else {
                                        if(_height>=win_h-255&&win_w>975){
                                            var _width = jQuery("#getWidth").innerWidth()-30;
                                            var _left = jQuery("#getWidth").offset().left+15;
                                            jQuery(".share-new").addClass("fixed");
                                            jQuery(".fixed").css({
                                                width:_width,
                                                left:_left
                                            });

                                        }else{
                                            jQuery(".share-new").removeClass("fixed");
                                            jQuery(".share-new").css({
                                                width: "100%"
                                            });
                                        }
                                    }
                                }
                                //控制水平方向分享模块的定位
                                function shareFixHorizontal(){
                                    var _width = jQuery("#getWidth").innerWidth()-30;
                                    var _left = jQuery("#getWidth").get(0).offsetLeft+15;
                                    var win_w = document.documentElement.clientWidth || document.body.clientWidth;
                                    jQuery(".fixed").css({
                                        width:_width,
                                        left:_left
                                    });
                                    if(win_w< 975){
                                        jQuery(".share-new").css({
                                            width: "100%",
                                            left: "0"
                                        });
                                    }else{
                                        var _width = jQuery("#getWidth").innerWidth()-30;
                                        var _left = jQuery("#getWidth").get(0).offsetLeft+15;
                                        jQuery(".fixed").css({
                                            width:_width,
                                            left:_left
                                        });
                                    }
                                }
                                function click(){
                                    var _w = jQuery(window).width();
                                    jQuery(document).click(function(e){
                                        if(jQuery(e.target).attr("id")=="weixin"){
                                            if(_w <= 760) {
                                                jQuery("#bdshare_weixin_qrcode_dialog").hide();
                                                layer.open({
                                                    title: '提示',
                                                    btnAlign: 'c',
                                                    content: '请使用手机浏览器自带的分享功能分享该页面',
                                                    area: '260px'
                                                });
                                            }else {
                                                jQuery("#bdshare_weixin_qrcode_dialog").show();
                                            }
                                        }else {
                                            jQuery("#bdshare_weixin_qrcode_dialog").hide();
                                        }
                                    });
                                }

                                jQuery(window).on("load",function(){
                                    shareFixVertical();
                                    click();
                                });

                                jQuery(window).on("scroll",function(){
                                    //判断滚轮方向
                                    var agent = navigator.userAgent;
                                    if (/.*Firefox.*/.test(agent)) {
                                        document.addEventListener("DOMMouseScroll", function(e) {
                                            e = e || window.event;
                                            var detail = e.detail;
                                            if (detail > 0) {
                                                $(".share-new").removeClass("fixed");
                                                $(".share-new").css({
                                                    width: "100%"
                                                });
                                                $('.main-header .header').removeClass('op1');
                                                $('.main-header .header').addClass('op0');
                                            } else {
                                                shareFixVertical();
                                                $('.main-header .header').removeClass('op0');
                                                $('.main-header .header').addClass('op1');
                                            }
                                        });
                                    } else {
                                        document.onmousewheel = function(e) {
                                            e = e || window.event;
                                            var wheelDelta = e.wheelDelta;
                                            if (wheelDelta > 0) {
                                                shareFixVertical();
                                                $('.main-header .header').removeClass('op0');
                                                $('.main-header .header').addClass('op1');
                                            } else {
                                                $(".share-new").removeClass("fixed");
                                                $(".share-new").css({
                                                    width: "100%"
                                                });
                                                $('.main-header .header').removeClass('op1');
                                                $('.main-header .header').addClass('op0');
                                            }
                                        }
                                    }
                                });


                                jQuery(window).on("resize",function(){
                                    shareFixHorizontal();
                                    click();
                                })

                                //tooltips提示
                                $(function () { $("[data-toggle='tooltip']").tooltip(); });
                            </script>
                        </div>
                                                                                                                            <div class="article-pager ">
                                <ul>
                                    <li class="previous"><span>上一篇：</span><a href="http://www.freebuf.com/articles/system/116761.html" rel="prev">Cerber敲诈者家族再升级：Cerber4变身随机后缀</a>                                    </li>
                                    <li class="next"><span>下一篇：</span>
                                        <a href="http://www.freebuf.com/vuls/117331.html" rel="next">漏洞预警：Linux内核9年高龄的“脏牛”0day漏洞</a>                                    </li>
                                </ul>
                            </div>
                                            </div>
                </div>
                <div class="comment-list">
      <div class="main-tit02">
		<a rel="nofollow" class="btnbtn-default btn-comment" href="#respond">发表评论</a>
        <h3>已有 <span class="color_red">21</span> 条评论
      </div>
      <ul>
         <li class="comment even thread-even depth-1" id="li-comment-198842">
    <div id="comment-198842">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic13.png">     </div>
    <div class="tit"> 
	    <span class="name"> 安全工程师 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-10-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-198842','198842', 'respond','116489' ) " href="?replytocom=198842#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">1楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>我其实就想知道这个和安全有什么关系，为什么会发布在freebuf上</p>
<div class="comment-tools">
<div class="vote" id="vote-198842"><span id="acv_stat_198842"></span><a class="ilike_icon"  id="vote4-198842" href="javascript:acv_vote(198842,1);">亮了</a>(<span id="cos_support-198842">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="198842" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="198842" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="198842" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="198842" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="198842" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment byuser comment-author-gaearrow bypostauthor odd alt depth-2" id="li-comment-198853">
    <div id="comment-198853">
        <div class="photo"> <a href="http://www.freebuf.com/author/gaearrow">
    <img src="http://image.3001.net/images/20170412/14920007621660.jpg!video"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/gaearrow" target="_blank">gaearrow&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(4级)</span>
				<span class="explain"> 二次元安全狗 </span>
		<span class="time">&nbsp;2016-10-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-198853','198853', 'respond','116489' ) " href="?replytocom=198853#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ 安全工程师  Linux共享库替换类似于Windows上的代码注入，恶意程序会用到</p>
<div class="comment-tools">
<div class="vote" id="vote-198853"><span id="acv_stat_198853"></span><a class="ilike_icon"  id="vote4-198853" href="javascript:acv_vote(198853,1);">亮了</a>(<span id="cos_support-198853">5</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="198853" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="198853" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="198853" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="198853" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="198853" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="li-comment-198855">
    <div id="comment-198855">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic1.png">     </div>
    <div class="tit"> 
	    <span class="name"> xo </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-10-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-198855','198855', 'respond','116489' ) " href="?replytocom=198855#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">2楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>不错的思路。</p>
<div class="comment-tools">
<div class="vote" id="vote-198855"><span id="acv_stat_198855"></span><a class="ilike_icon"  id="vote4-198855" href="javascript:acv_vote(198855,1);">亮了</a>(<span id="cos_support-198855">3</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="198855" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="198855" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="198855" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="198855" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="198855" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="li-comment-198864">
    <div id="comment-198864">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic16.png">     </div>
    <div class="tit"> 
	    <span class="name"> 三只野鹤<span class="weibo"></span> </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-10-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-198864','198864', 'respond','116489' ) " href="?replytocom=198864#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">3楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>自己造业太重，老人要自重！</p>
<div class="comment-tools">
<div class="vote" id="vote-198864"><span id="acv_stat_198864"></span><a class="ilike_icon"  id="vote4-198864" href="javascript:acv_vote(198864,1);">亮了</a>(<span id="cos_support-198864">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="198864" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="198864" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="198864" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="198864" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="198864" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment byuser comment-author-gaearrow bypostauthor even depth-2" id="li-comment-198884">
    <div id="comment-198884">
        <div class="photo"> <a href="http://www.freebuf.com/author/gaearrow">
    <img src="http://image.3001.net/images/20170412/14920007621660.jpg!video"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/gaearrow" target="_blank">gaearrow&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(4级)</span>
				<span class="explain"> 二次元安全狗 </span>
		<span class="time">&nbsp;2016-10-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-198884','198884', 'respond','116489' ) " href="?replytocom=198884#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ 三只野鹤   <img src='http://image.3001.net/images/index/smilies/icon_arrow.gif' alt=':arrow:' class='wp-smiley' /> </p>
<div class="comment-tools">
<div class="vote" id="vote-198884"><span id="acv_stat_198884"></span><a class="ilike_icon"  id="vote4-198884" href="javascript:acv_vote(198884,1);">亮了</a>(<span id="cos_support-198884">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="198884" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="198884" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="198884" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="198884" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="198884" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-198865">
    <div id="comment-198865">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic1.png">     </div>
    <div class="tit"> 
	    <span class="name"> valpin </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-10-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-198865','198865', 'respond','116489' ) " href="?replytocom=198865#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">4楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>静态替换解释错了，没记错的话是update了page cache的内容，导致so的映射的内存数据出错了</p>
<div class="comment-tools">
<div class="vote" id="vote-198865"><span id="acv_stat_198865"></span><a class="ilike_icon"  id="vote4-198865" href="javascript:acv_vote(198865,1);">亮了</a>(<span id="cos_support-198865">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="198865" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="198865" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="198865" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="198865" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="198865" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment byuser comment-author-gaearrow bypostauthor even depth-2" id="li-comment-198883">
    <div id="comment-198883">
        <div class="photo"> <a href="http://www.freebuf.com/author/gaearrow">
    <img src="http://image.3001.net/images/20170412/14920007621660.jpg!video"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/gaearrow" target="_blank">gaearrow&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(4级)</span>
				<span class="explain"> 二次元安全狗 </span>
		<span class="time">&nbsp;2016-10-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-198883','198883', 'respond','116489' ) " href="?replytocom=198883#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ valpin  关于这个问题，我在stackoverflow找到一个详细的回答（Answered by Anders Waldenborg  http://stackoverflow.com/questions/7767325/replacing-shared-object-so-file-while-main-program-is-running）。<br />
我的理解是：复制替换操作，会更新已经载入内存的inode（不知道你说的更新是不是指这个？），导致程序无法使用新inode访问原SO，从而发生崩溃。<br />
不知道我们的理解是不是一样 <img src='http://image.3001.net/images/index/smilies/icon_lol.gif' alt=':lol:' class='wp-smiley' />   <img src='http://image.3001.net/images/index/smilies/icon_lol.gif' alt=':lol:' class='wp-smiley' /> </p>
<div class="comment-tools">
<div class="vote" id="vote-198883"><span id="acv_stat_198883"></span><a class="ilike_icon"  id="vote4-198883" href="javascript:acv_vote(198883,1);">亮了</a>(<span id="cos_support-198883">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="198883" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="198883" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="198883" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="198883" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="198883" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment odd alt depth-3" id="li-comment-198898">
    <div id="comment-198898">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic8.png">     </div>
    <div class="tit"> 
	    <span class="name"> valpin </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-10-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		           <a onclick="return addComment.moveForm( 'comment-198898','198883', 'respond','116489' )" href="?replytocom=198898#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>这个说法，很简单嘛，做个测试<br />
写一个so，把他所有的函数都访问一遍（保证不会发生page fault了），然后替换掉so，继续调用so内部的函数，看崩溃不崩溃</p>
<p>问题还是发生在page cache更新上，更新文件以后，内核需要更新这个文件对应的page cache，那么，映射在应用层内存空间的代码就&#8230;</p>
<div class="comment-tools">
<div class="vote" id="vote-198898"><span id="acv_stat_198898"></span><a class="ilike_icon"  id="vote4-198898" href="javascript:acv_vote(198898,1);">亮了</a>(<span id="cos_support-198898">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="198898" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="198898" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="198898" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="198898" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="198898" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-gaearrow bypostauthor even depth-3" id="li-comment-198908">
    <div id="comment-198908">
        <div class="photo"> <a href="http://www.freebuf.com/author/gaearrow">
    <img src="http://image.3001.net/images/20170412/14920007621660.jpg!video"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/gaearrow" target="_blank">gaearrow&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(4级)</span>
				<span class="explain"> 二次元安全狗 </span>
		<span class="time">&nbsp;2016-10-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		           <a onclick="return addComment.moveForm( 'comment-198908','198883', 'respond','116489' )" href="?replytocom=198908#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ valpin  已经测试过：文中“测试实例”中的被动态替换程序在运行过程时，替换其共享库的确会导致程序崩溃。<br />
为什么我总觉得，我们是同一个观点的不同说法呢？  <img src='http://image.3001.net/images/index/smilies/icon_arrow.gif' alt=':arrow:' class='wp-smiley' /><br />
“内核需要更新这个文件对应的page cache”然而替换操作却没有更新，所以崩溃了？</p>
<div class="comment-tools">
<div class="vote" id="vote-198908"><span id="acv_stat_198908"></span><a class="ilike_icon"  id="vote4-198908" href="javascript:acv_vote(198908,1);">亮了</a>(<span id="cos_support-198908">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="198908" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="198908" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="198908" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="198908" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="198908" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt depth-2" id="li-comment-198897">
    <div id="comment-198897">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic10.png">     </div>
    <div class="tit"> 
	    <span class="name"> mengxp </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-10-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-198897','198897', 'respond','116489' ) " href="?replytocom=198897#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ valpin  对，数据错了才崩溃</p>
<div class="comment-tools">
<div class="vote" id="vote-198897"><span id="acv_stat_198897"></span><a class="ilike_icon"  id="vote4-198897" href="javascript:acv_vote(198897,1);">亮了</a>(<span id="cos_support-198897">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="198897" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="198897" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="198897" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="198897" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="198897" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment byuser comment-author-gaearrow bypostauthor even depth-3" id="li-comment-198910">
    <div id="comment-198910">
        <div class="photo"> <a href="http://www.freebuf.com/author/gaearrow">
    <img src="http://image.3001.net/images/20170412/14920007621660.jpg!video"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/gaearrow" target="_blank">gaearrow&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(4级)</span>
				<span class="explain"> 二次元安全狗 </span>
		<span class="time">&nbsp;2016-10-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		           <a onclick="return addComment.moveForm( 'comment-198910','198897', 'respond','116489' )" href="?replytocom=198910#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ mengxp  每个载入内存的文件，系统都会创建一个inode来管理。数据出错，既有可能是inode更新了，而管理的内存文件没变；也可能是inode没变，管理的内存文件更新。</p>
<div class="comment-tools">
<div class="vote" id="vote-198910"><span id="acv_stat_198910"></span><a class="ilike_icon"  id="vote4-198910" href="javascript:acv_vote(198910,1);">亮了</a>(<span id="cos_support-198910">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="198910" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="198910" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="198910" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="198910" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="198910" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment odd alt depth-3" id="li-comment-198915">
    <div id="comment-198915">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic13.png">     </div>
    <div class="tit"> 
	    <span class="name"> valpin </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-10-20</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		           <a onclick="return addComment.moveForm( 'comment-198915','198897', 'respond','116489' )" href="?replytocom=198915#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ gaearrow    copy过去inode是不变的..这个很容易验证，写个systemtap脚本跟下内核调用就知道了，stackoverflow的答案未必对，还是人云亦云的多，都说了，问题出在page cache的更新上</p>
<div class="comment-tools">
<div class="vote" id="vote-198915"><span id="acv_stat_198915"></span><a class="ilike_icon"  id="vote4-198915" href="javascript:acv_vote(198915,1);">亮了</a>(<span id="cos_support-198915">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="198915" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="198915" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="198915" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="198915" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="198915" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-gaearrow bypostauthor even depth-3" id="li-comment-199092">
    <div id="comment-199092">
        <div class="photo"> <a href="http://www.freebuf.com/author/gaearrow">
    <img src="http://image.3001.net/images/20170412/14920007621660.jpg!video"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/gaearrow" target="_blank">gaearrow&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(4级)</span>
				<span class="explain"> 二次元安全狗 </span>
		<span class="time">&nbsp;2016-10-22</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		           <a onclick="return addComment.moveForm( 'comment-199092','198897', 'respond','116489' )" href="?replytocom=199092#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ valpin  谢谢大牛！果然是实践出真知 <img src='http://image.3001.net/images/index/smilies/icon_redface.gif' alt=':oops:' class='wp-smiley' /> </p>
<div class="comment-tools">
<div class="vote" id="vote-199092"><span id="acv_stat_199092"></span><a class="ilike_icon"  id="vote4-199092" href="javascript:acv_vote(199092,1);">亮了</a>(<span id="cos_support-199092">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="199092" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="199092" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="199092" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="199092" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="199092" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-cwg2552298 odd alt thread-even depth-1" id="li-comment-198871">
    <div id="comment-198871">
        <div class="photo"> <a href="http://www.freebuf.com/author/cwg2552298">
    <img src="http://image.3001.net/2016/06/火狐截图_2016-03-06T00-22-02.973Z.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/cwg2552298" target="_blank">cwg2552298&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(6级)</span>
				<span class="explain"> Follow my own course </span>
		<span class="time">&nbsp;2016-10-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-198871','198871', 'respond','116489' ) " href="?replytocom=198871#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">5楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p> <img src='http://image.3001.net/images/index/smilies/icon_biggrin.gif' alt=':grin:' class='wp-smiley' />  写得很详细，多谢分享</p>
<div class="comment-tools">
<div class="vote" id="vote-198871"><span id="acv_stat_198871"></span><a class="ilike_icon"  id="vote4-198871" href="javascript:acv_vote(198871,1);">亮了</a>(<span id="cos_support-198871">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="198871" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="198871" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="198871" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="198871" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="198871" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="li-comment-198893">
    <div id="comment-198893">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic10.png">     </div>
    <div class="tit"> 
	    <span class="name"> dferter </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-10-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-198893','198893', 'respond','116489' ) " href="?replytocom=198893#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">6楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>在ubuntu（12.04以上）上可以成功吗？（默认配置）</p>
<div class="comment-tools">
<div class="vote" id="vote-198893"><span id="acv_stat_198893"></span><a class="ilike_icon"  id="vote4-198893" href="javascript:acv_vote(198893,1);">亮了</a>(<span id="cos_support-198893">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="198893" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="198893" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="198893" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="198893" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="198893" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment byuser comment-author-gaearrow bypostauthor odd alt depth-2" id="li-comment-198909">
    <div id="comment-198909">
        <div class="photo"> <a href="http://www.freebuf.com/author/gaearrow">
    <img src="http://image.3001.net/images/20170412/14920007621660.jpg!video"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/gaearrow" target="_blank">gaearrow&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(4级)</span>
				<span class="explain"> 二次元安全狗 </span>
		<span class="time">&nbsp;2016-10-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-198909','198909', 'respond','116489' ) " href="?replytocom=198909#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ dferter  木有测试过，不过感觉需要改的地方应该挺多</p>
<div class="comment-tools">
<div class="vote" id="vote-198909"><span id="acv_stat_198909"></span><a class="ilike_icon"  id="vote4-198909" href="javascript:acv_vote(198909,1);">亮了</a>(<span id="cos_support-198909">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="198909" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="198909" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="198909" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="198909" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="198909" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-10086 even thread-even depth-1" id="li-comment-198894">
    <div id="comment-198894">
        <div class="photo"> <a href="http://www.freebuf.com/author/死宅10086">
    <img src="http://image.3001.net/2016/04/145254ordw99xzxszuusly.jpg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/死宅10086" target="_blank">死宅10086&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(6级)</span>
				<span class="explain"> 这家伙太懒了，还未填写个人描述！ </span>
		<span class="time">&nbsp;2016-10-19</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-198894','198894', 'respond','116489' ) " href="?replytocom=198894#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">7楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>思路 <img src='http://image.3001.net/images/index/smilies/icon_cool.gif' alt=':cool:' class='wp-smiley' />  不错</p>
<div class="comment-tools">
<div class="vote" id="vote-198894"><span id="acv_stat_198894"></span><a class="ilike_icon"  id="vote4-198894" href="javascript:acv_vote(198894,1);">亮了</a>(<span id="cos_support-198894">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="198894" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="198894" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="198894" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="198894" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="198894" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-k0_pwn007 odd alt thread-odd thread-alt depth-1" id="li-comment-199025">
    <div id="comment-199025">
        <div class="photo"> <a href="http://www.freebuf.com/author/k0_pwn007">
    <img src="http://image.3001.net/2015/05/48_133223_1_lit.jpg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/k0_pwn007" target="_blank">k0_pwn007&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(3级)</span>
				<span class="explain"> 一只二进制小菜鸡k0shl </span>
		<span class="time">&nbsp;2016-10-21</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-199025','199025', 'respond','116489' ) " href="?replytocom=199025#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">8楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>我用的是64位测试的。。user.h应该还是sys/user.h。。需要修改的地方还有一处是sscanf的&amp;addr，应该是改成%lx，这样才能接收8字节完整的地址。。</p>
<div class="comment-tools">
<div class="vote" id="vote-199025"><span id="acv_stat_199025"></span><a class="ilike_icon"  id="vote4-199025" href="javascript:acv_vote(199025,1);">亮了</a>(<span id="cos_support-199025">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="199025" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="199025" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="199025" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="199025" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="199025" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment byuser comment-author-gaearrow bypostauthor even depth-2" id="li-comment-199089">
    <div id="comment-199089">
        <div class="photo"> <a href="http://www.freebuf.com/author/gaearrow">
    <img src="http://image.3001.net/images/20170412/14920007621660.jpg!video"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/gaearrow" target="_blank">gaearrow&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(4级)</span>
				<span class="explain"> 二次元安全狗 </span>
		<span class="time">&nbsp;2016-10-21</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-199089','199089', 'respond','116489' ) " href="?replytocom=199089#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ k0_pwn007    是在64位的centos吗？具体版本呢？文中介绍的64位修改意见是针对CentOS 5.4 （Final）x86_64 系统的</p>
<div class="comment-tools">
<div class="vote" id="vote-199089"><span id="acv_stat_199089"></span><a class="ilike_icon"  id="vote4-199089" href="javascript:acv_vote(199089,1);">亮了</a>(<span id="cos_support-199089">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="199089" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="199089" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="199089" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="199089" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="199089" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-gaearrow bypostauthor odd alt depth-2" id="li-comment-199090">
    <div id="comment-199090">
        <div class="photo"> <a href="http://www.freebuf.com/author/gaearrow">
    <img src="http://image.3001.net/images/20170412/14920007621660.jpg!video"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/gaearrow" target="_blank">gaearrow&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(4级)</span>
				<span class="explain"> 二次元安全狗 </span>
		<span class="time">&nbsp;2016-10-21</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-199090','199090', 'respond','116489' ) " href="?replytocom=199090#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ k0_pwn007    是在64位的centos吗？具体版本呢？文中介绍的64位修改意见是针对CentOS 5.4 （Final）x86_64 系统的，抱歉没有说明清楚</p>
<div class="comment-tools">
<div class="vote" id="vote-199090"><span id="acv_stat_199090"></span><a class="ilike_icon"  id="vote4-199090" href="javascript:acv_vote(199090,1);">亮了</a>(<span id="cos_support-199090">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="199090" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="199090" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="199090" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="199090" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="199090" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-gaearrow bypostauthor even depth-2" id="li-comment-199091">
    <div id="comment-199091">
        <div class="photo"> <a href="http://www.freebuf.com/author/gaearrow">
    <img src="http://image.3001.net/images/20170412/14920007621660.jpg!video"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/gaearrow" target="_blank">gaearrow&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(4级)</span>
				<span class="explain"> 二次元安全狗 </span>
		<span class="time">&nbsp;2016-10-21</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-199091','199091', 'respond','116489' ) " href="?replytocom=199091#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ k0_pwn007    具体情况可以参见 http://blog.csdn.net/dearggae/article/details/47450739</p>
<div class="comment-tools">
<div class="vote" id="vote-199091"><span id="acv_stat_199091"></span><a class="ilike_icon"  id="vote4-199091" href="javascript:acv_vote(199091,1);">亮了</a>(<span id="cos_support-199091">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="199091" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="199091" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="199091" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="199091" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="199091" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
      </ul>
      <div class="commentnav page01" style="padding-top:10px; text-align: center;">
               </div>
	  
<script src="http://www.freebuf.com/buf/themes/freebuf/js/ajaxfileupload.js" type="text/javascript"></script>
<div id="respond" class="comment-box">
<input type="file" id="uploadUnit" name="upfile" class="hidden" value="">
    <form action="http://www.freebuf.com/wp-comments-post.php" method="post" id="commentform">
        <div id="comment-author-info">
	    <div class="login-other">
		  <div class="login_button login_icon_sina" title="使用新浪微博登陆" onclick="login_button_click('sina')"></div>
          <div class="login_button login_icon_qq" title="使用腾讯QQ登陆" onclick="login_button_click('qq')"></div></div>
        <div class="login-input">
	    <p><label for="author">昵称</label>
		          <input type="text" name="author" id="author" value="" size="14" tabindex="1" aria-required='true' placeholder = "请输入昵称" required />
        </p><span>必须</span><span>您当前尚未登录。<a  class="simplemodal-login" href="http://www.freebuf.com/oauth" title="登陆">登陆？</a><a  href="https://account.tophant.com/register.html" target="_blank">注册</a></span></div>
		<div class="login-input">
		  <p><label for="email">邮箱</label><input type="text" name="email" id="email" value="" size="25" tabindex="2" aria-required='true' placeholder = "请输入邮箱地址" required /></p>
		<span>必须（保密）</span>
		</div>
    </div>

        <div id="test" class="post-area">
      <div class="holiday"></div>
	    <div class="comment-editor">
			<a id="comment-smiley" href="javascript:;">表情</a><a href="javascript:;" id="imageThumb">插图</a>
	    </div>
        <div id="smileys" >
           <a title="mrgreen" href="javascript:grin(':mrgreen:')"><img src="http://image.3001.net/images/index/smilies/icon_mrgreen.gif" /></a><a title="razz" href="javascript:grin(':razz:')"><img src="http://image.3001.net/images/index/smilies/icon_razz.gif" /></a><a title="sad" href="javascript:grin(':sad:')"><img src="http://image.3001.net/images/index/smilies/icon_sad.gif" /></a><a title="smile" href="javascript:grin(':smile:')"><img src="http://image.3001.net/images/index/smilies/icon_smile.gif" /></a><a title="oops" href="javascript:grin(':oops:')"><img src="http://image.3001.net/images/index/smilies/icon_redface.gif" /></a><a title="grin" href="javascript:grin(':grin:')"><img src="http://image.3001.net/images/index/smilies/icon_biggrin.gif" /></a><a title="eek" href="javascript:grin(':eek:')"><img src="http://image.3001.net/images/index/smilies/icon_surprised.gif" /></a><a title="???" href="javascript:grin(':???:')"><img src="http://image.3001.net/images/index/smilies/icon_confused.gif" /></a><a title="cool" href="javascript:grin(':cool:')"><img src="http://image.3001.net/images/index/smilies/icon_cool.gif" /></a><a title="lol" href="javascript:grin(':lol:')"><img src="http://image.3001.net/images/index/smilies/icon_lol.gif" /></a><a title="mad" href="javascript:grin(':mad:')"><img src="http://image.3001.net/images/index/smilies/icon_mad.gif" /></a><a title="twisted" href="javascript:grin(':twisted:')"><img src="http://image.3001.net/images/index/smilies/icon_twisted.gif" /></a><a title="roll" href="javascript:grin(':roll:')"><img src="http://image.3001.net/images/index/smilies/icon_rolleyes.gif" /></a><a title="wink" href="javascript:grin(':wink:')"><img src="http://image.3001.net/images/index/smilies/icon_wink.gif" /></a><a title="idea" href="javascript:grin(':idea:')"><img src="http://image.3001.net/images/index/smilies/icon_idea.gif" /></a><a title="arrow" href="javascript:grin(':arrow:')"><img src="http://image.3001.net/images/index/smilies/icon_arrow.gif" /></a><a title="neutral" href="javascript:grin(':neutral:')"><img src="http://image.3001.net/images/index/smilies/icon_neutral.gif" /></a><a title="cry" href="javascript:grin(':cry:')"><img src="http://image.3001.net/images/index/smilies/icon_cry.gif" /></a><a title="?" href="javascript:grin(':?:')"><img src="http://image.3001.net/images/index/smilies/icon_question.gif" /></a><a title="evil" href="javascript:grin(':evil:')"><img src="http://image.3001.net/images/index/smilies/icon_evil.gif" /></a><a title="shock" href="javascript:grin(':shock:')"><img src="http://image.3001.net/images/index/smilies/icon_eek.gif" /></a><a title="!" href="javascript:grin(':!:')"><img src="http://image.3001.net/images/index/smilies/icon_exclaim.gif" /></a>        </div>
         <textarea name="comment" id="comment" cols="100%" rows="7" tabindex="4" style="overflow-x:hidden; overflow-y:hidden; border:0; width:100%;" onkeydown="if(event.ctrlKey&amp;&amp;event.keyCode==13){document.getElementById('submit').click();return false};"></textarea>
    </div>
      <div class="subcon but">
      <input class="btn btn-success" type="submit" name="submit" id="submit" tabindex="5" value="提交评论(Ctrl+Enter)" />
      <a rel="nofollow" class="btn btn-default" id="cancel-comment-reply-link" href="javascript:;">取消</a>
      <div class="checkbox"><input type='hidden' name='comment_post_ID' value='116489' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
<label for="comment_mail_notify" class="comment_mail"><input type="checkbox" name="comment_mail_notify" id="comment_mail_notify" value="comment_mail_notify" checked="checked"/>有人回复时邮件通知我</label></div>
      </div>
    <input name="Token" id="Token" type="hidden" value="vlwzcu" />
  </form>
  </div>
</div>	  
<div class="commentshow">
<div class="comments-loading">Loading...</div>
</div>
<script language="javascript">
jQuery(document).ready(function($){ //Begin jQuery
    $('.reply').click(function() {
    var atid = '"#' + $(this).parent().attr("id") + '"';
    var atname = $(this).parent().find('span:first').text();
    $("#comment").val("@" + atname + " ").focus();
});
    $('.cancel-comment-reply a').click(function() { //点击取消回复评论清空评论框的内容
    $("#comment").val('');
});
}) 

jQuery(document).ready(function($) {
    $body = (window.opera) ? (document.compatMode == "CSS1Compat" ? $('html') : $('body')) : $('html,body');//commentnav ajax
    $(document).on('click', '.commentnav a', function(e) {
        e.preventDefault();
        $.ajax({
            type: "GET",
            url: $(this).attr('href'),
            beforeSend: function() {
                $('.commentnav').remove();
                $('.comment-list').remove();
                $('.comments-loading').slideDown();
            },
            dataType: "html",
            success: function(out) {
                result = $(out).find('.comment-list');
                nextlink = $(out).find('.commentnav');
                $('.comments-loading').slideUp(550);
                $('.comments-loading').after(result.fadeIn(800));
                $(".comment-list img").each(function(){
                  var url = $(this).attr("data-original");
                  $(this).attr("src",url);
                })
            }
        });
    });    
});
</script>            </div>
                    <div class="col-md-3 visible-md-block visible-lg-block">
                <div class="panel panel-default">
                    <div class="author-top">
                         <div class="author-wrap">
                            <div class="author-header"><img src="http://image.3001.net/images/20170412/14920007621660.jpg!video" width="96" height="96" alt="gaearrow" class="avatar avatar-100 wp-user-avatar wp-user-avatar-100 photo" />                            </div>
                            <p class="name"><a href="http://www.freebuf.com/author/gaearrow" title="由 gaearrow 发布" rel="author">gaearrow</a><span></span></p>
                            <p class="signature">二次元安全狗</p>
                            <p class="art-com clearfix">
                                <span class="aut-article">
                                    <a href="/author/gaearrow"target="_blank">
                                        <i>5</i>
                                        <i>文章数</i>
                                    </a>
                                </span>
                                <span class="aut-comment">
                                    <a href="/author/gaearrow?comment=1" target="_blank">
                                        <i>40</i>
                                        <i>评论数</i>
                                    </a>
                                </span>
                            </p>
                        </div>
                    </div>
                    <div class="author-bottom">
                        <div class="author-wrap">
                            <h3 class="last-title">最近文章</h3>
                            <div class="last-item-wrap">
                                                                        <div class="last-item">
                                            <a href="http://www.freebuf.com/sectool/136655.html" target="_blank"><span class="point"></span>NetUse命令在渗透测试中的连接条件测试</a>
                                            <p class="last-time">2017.06.12</p>
                                        </div>
                                                                            <div class="last-item">
                                            <a href="http://www.freebuf.com/sectool/135498.html" target="_blank"><span class="point"></span>网卡厂商自动识别工具（附源代码）</a>
                                            <p class="last-time">2017.05.26</p>
                                        </div>
                                                                            <div class="last-item">
                                            <a href="http://www.freebuf.com/articles/network/132814.html" target="_blank"><span class="point"></span>【新手指南】如何用Ettercap实现“中间人攻击”（二）：HTTP数据劫持</a>
                                            <p class="last-time">2017.04.28</p>
                                        </div>
                                                                </div>
                        </div>

                        <div class="more-wrap">
                            <a href="http://www.freebuf.com/author/gaearrow" target="_blank" class="btn-new">浏览更多</a>
                        </div>
                    </div>
                </div>
                                <div class="panel panel-default">
                    <div class="read visible-md-block visible-lg-block">
                        <div class="main-tit02">
                            <h3>相关阅读</h3>
                        </div>
                        <ul>
  <li><a href="http://www.freebuf.com/articles/system/117823.html" target="_blank">Linux平台“盖茨木马”分析</a></li>
  
  <li><a href="http://www.freebuf.com/vuls/136156.html" target="_blank">SELinux曝新安全漏洞：用户执行sudo命令可获取root权限</a></li>
  
  <li><a href="http://www.freebuf.com/articles/others-articles/124743.html" target="_blank">有趣！10个你不得不知的Linux终端游戏</a></li>
  
  <li><a href="http://www.freebuf.com/vuls/107440.html" target="_blank">Linux内核中的递归漏洞利用</a></li>
  
  <li><a href="http://www.freebuf.com/vuls/95708.html" target="_blank">利用Linux内核里的Use-After-Free（UAF）漏洞提权</a></li>
  </ul>                    </div>
                </div>
                <!--<div class="ad-wrap"><a href="http://www.ijiami.cn/?freebuf.com" target="_blank"><img width="100%" src="http://image.3001.net/images/20141201/14174039186901.jpg"></a></div>-->
                <div class="panel panel-default rec-spe">
                    <div class="main-tit03 colour-blue">
                        <h3>特别推荐</h3>
                    </div>
                                                    <div class="rec-img"><a href="http://www.freebuf.com/ad?id=3" target="_blank"><img
                                            src="http://image.3001.net/2017/05/14a10c5c919d154dddbee79e3a944143-220x150.png" width="220"></a></div>
                                                </div>
                <div id="mar-right">
                    <!--<div class="read visible-lg-block">
        <div class="main-tit04">
          <h3>商城新品</h3>
        </div>
        <div id="slider" class="nivoSlider">  </div>
      </div>-->
                    <div class="panel panel-default code"><img src="http://image.3001.net/images/new/code.jpg" width="192"
                                                               height="192">
                        <p>关注我们 分享每日精选文章</p>
                    </div>
                </div>
            </div>
                </div>
                    <div class="row marvellous visible-lg-block">
                <h3>不容错过</h3>
                <ul>
                                                <li><a href="http://www.freebuf.com/vuls/119055.html" rel="bookmark"
                                   title="【漏洞预警】GitLab未授权访问漏洞可导致远程命令执行">【漏洞预警】GitLab未授权访问漏洞可导致远程命令执行</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/arthurkiller" title="由 ArthurKiller 发布" rel="author">ArthurKiller</a></span>
                                                                        <span class="time">2016-11-04</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/sectool/104671.html" rel="bookmark"
                                   title="2016年最佳的15款Android黑客工具">2016年最佳的15款Android黑客工具</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/watcher" title="由 watcher 发布" rel="author">watcher</a></span>
                                                                        <span class="time">2016-05-18</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/fevents/147603.html" rel="bookmark"
                                   title="【限时优惠】FreeBuf精品公开课 | 36W漏洞奖金先生CplusHua： HTTP盲攻击的几种思路">【限时优惠】FreeBuf精品公开课 | 36W漏洞奖金先生CplusHua： HTTP盲攻击的几种思路</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/fb%e5%ae%a2%e6%9c%8d" title="由 FB客服 发布" rel="author">FB客服</a></span>
                                                                        <span class="time">2017-09-16</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/sectool/134657.html" rel="bookmark"
                                   title="分享“永恒之蓝（MS17-010）”批量远程检测工具">分享“永恒之蓝（MS17-010）”批量远程检测工具</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/%e6%9d%8e%e5%b0%8f%e6%98%8e%e2%80%8f%e2%80%8f" title="由 李小明‏‏ 发布" rel="author">李小明‏‏</a></span>
                                                                        <span class="time">2017-05-15</span></p>
                            </li>
                                                            </ul>
            </div>
            </div>
</div>
<script type="text/javascript">
  $(window).load(function() {
    $('#slider').nivoSlider();
  });
  $('#contenttxt img').removeAttr('height');
  $('#contenttxt img').wrap(function(){
    if(!$(this).parent().attr('href')){
      var imgurl = $(this).attr('data-original');
      if(imgurl.substr(-6)=='!small'){
        imgurl = imgurl.substring(0,imgurl.length-6);
      }
      return '<a href="' + imgurl + '" class="highslide-image" onclick="return hs.expand(this);" target="_blank"></a>';
    }
  })
</script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/comments-ajax.js" type="text/javascript"></script>
<script type="text/javascript" src="http://static.3001.net/js/focus/jquery.nivo.slider.pack.js"></script>
<!----------footer---------->
<div class="footer">
  <div class="container">
    <div class="footer-list ">
      <h3>FREEBUF</h3>
      <ul>
        <li><a href="http://www.freebuf.com/dis">免责声明</a></li>
        <li><a href="http://www.freebuf.com/news/others/864.html">关于我们</a></li>
        <li><a href="http://www.freebuf.com/jobs/40386.html">加入我们</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>广告及服务</h3>
      <ul>
        <li><a target="_blank" href="mailto:root@freebuf.com">寻求报道</a></li>
        <li><a href="http://www.freebuf.com/advertise">广告合作</a></li>
        <li><a target="_blank" href="mailto:help@freebuf.com">联系我们</a></li>
        <li><a href="http://www.freebuf.com/friends">友情链接</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>关注我们</h3>
      <ul>
        <li><div class="weixin-pannel weixin"><a class="qr" href="javascript:viod(0);"><span class="g-icon-qr1">官方微信</span><i></i></a></div></li>
        <li><a rel="nofollow" target="_blank" href="http://weibo.com/freebuf">新浪微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://t.qq.com/freebuf">腾讯微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://twitter.com/freebuf">Twitter</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>赞助商</h3>
      <ul>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="http://www.aliyun.com/?freebuf"><img src="http://image.3001.net/images/ad/ali.png"></a></li>
        <li><a rel="nofollow" target="_blank" href="http://www.upyun.com/?freebuf"><img src="http://image.3001.net/images/ad/upyun.png"></a></li>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="https://www.trustasia.com/?freebuf"><img src="http://image.3001.net/images/ad/ad-yzcx.png"></a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <ul>
      </ul>
    </div>
    <div class="footer-logo  pull-right"><img src="http://image.3001.net/images/index/freebufrobot_shendanjie.png" ></div>
  </div>
  <div class="copyright"><div class="container"><p>Copyright &copy; 2017 WWW.FREEBUF.COM All Rights Reserved <a rel="nofollow" target="_blank" href="http://www.miitbeian.gov.cn">沪ICP备13033796号</a></p><span><a rel="nofollow" target="_blank" href="http://click.aliyun.com/m/1336/?freebuf"><img src="http://image.3001.net/images/new/icon-aly.png"></a></span></div></div>
</div>
<div class="bottom_tools"><a id="scrollUp" href="javascript:;" title="飞回顶部"></a></div>
<!----------footer end----------> 
<script src="http://static.3001.net/js/new/backtop.js"></script>
<script type="text/javascript">
jQuery(function(){	
	jQuery('.tabPanes ul li').click(function(){
		jQuery(this).addClass('hit').siblings().removeClass('hit');
		jQuery('.panesl>div:eq('+jQuery(this).index()+')').show().siblings().hide();	
	})
	jQuery('.vulbox-nav').click(function(e) { 
        e.stopPropagation(); 
    });  
})
</script>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fcc53db168808048541c6735ce30421f5' type='text/javascript'%3E%3C/script%3E"));
</script>
<img alt='css.php' src="http://www.freebuf.com/buf/plugins/cc/css.php?k=3cb185a485c81b23211eb80b75a406fd&amp;o=i&amp;t=391727797" width='1' height='1' /><script type="text/javascript">
jQuery(function() {
    jQuery(".simditor pre").each(function(i, block){
        hljs.highlightBlock(block);    
    });
    hljs.initHighlightingOnLoad();
});
</script>
<script>
/* <![CDATA[ */
var rcGlobal = {
	serverUrl		:'http://www.freebuf.com',
	infoTemp		:'%REVIEWER% on %POST%',
	loadingText		:'Loading',
	noCommentsText	:'No comments',
	newestText		:'&laquo; 最新',
	newerText		:'&laquo; 新一点',
	olderText		:'旧一点 &raquo;',
	showContent		:'1',
	external		:'1',
	avatarSize		:'32',
	avatarPosition	:'left',
	anonymous		:'Anonymous'
};
/* ]]> */
</script>
<script type='text/javascript' src='http://static.3001.net/js/recentcomments/wp-recentcomments-jquery.js?ver=2.2.3'></script>
</body>
</html>
