<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />	
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="renderer" content="webkit">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0">
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<title>方程式组织EQUATION DRUG平台解析(提纲) —方程式组织系列分析报告之四 - SecPulse.COM | 安全脉搏</title>
<meta name="description" content="安天安全研究与应急处理中心（Antiy CERT）" />
<meta name="keywords" content="影子经纪人,插件,泄露,硬盘固件" />

<link rel='stylesheet' id='style-css'  href='https://www.secpulse.com/wp-content/themes/sec/style.css?ver=2014.9.21' type='text/css' media='all' />
<link rel='stylesheet' id='jquery.fancybox-css'  href='https://www.secpulse.com/wp-content/themes/sec/css/jquery.fancybox.css?ver=1.0' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-css'  href='https://www.secpulse.com/wp-content/themes/sec/css/font-awesome.min.css?ver=1.0' type='text/css' media='all' />
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.min.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.fancybox.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/helpers/jquery.fancybox-buttons.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.mousewheel-3.0.6.pack.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/owl.carousel.min.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/custom.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/comments-ajax.js?ver=1.3'></script>
<link rel='canonical' href='https://www.secpulse.com/archives/55098.html' />
<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?7f4cc5524dcb1aec487b4266c18bae48";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


</head>
<body class="single single-post postid-55098 single-format-standard">
	<header id="header" class="header clr">
		<div class="header-top inner clr">
	<hgroup class="logo-main"><h1 class="logo"><a href="https://www.secpulse.com/" rel="home" title="安全脉搏">安全脉搏</a></h1><h4 class="xs-hidden">分享技术，悦享品质 
	</h4>
	</hgroup>

<div class="login xs-hidden">
				<div class="logindiv">
					<div class="img">
<img src="https://www.secpulse.com/wp-content/uploads/2017/05/rabbit.jpeg" width="36" height="36" alt="" class="avatar avatar-36 wp-user-avatar wp-user-avatar-36 photo avatar-default" /></div><span href="javascript:void(0);" title="用户" class="yh">用户</span><i
						class="fa fa-caret-down fa-2"></i>
					<ul class="login-links">
						<li class="log"><a
							href="https://www.secpulse.com/wp-login.php"
							target="_blank"><i class="fa fa-arrow-right"></i><span>登陆</span></a></li>
						<li class="exit"><a
							href="https://www.secpulse.com/wp-login.php?action=register"><i
								class="fa fa-user-times"></i><span>注册</span></a></li>
					</ul>
	
  </div>
			</div>
			<div class="top-search xs-hidden">
  <form id="search" method="get" action="https://www.secpulse.com" >
	<input type="text" name="s" id="s" autocomplete="off"  placeholder="输入搜索内容">
	<button class="btn-search"> <i class="fa fa-search"></i></button>
</form></div>
			<div class="menu-button">
				<i class="fa fa-bars fa-3x"></i>
			</div>
		</div>


		<div class="main-nav  xs-hidden">
			<div class="inner clr"><nav class="left-nav clr"><ul id="menu-%e5%af%bc%e8%88%aa" class="header-menu-nav"><li id="menu-item-15" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15"><a href="https://www.secpulse.com/">首页</a></li>
<li id="menu-item-17" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-17"><a href="https://www.secpulse.com/archives/category/articles">文章</a>
<ul class="sub-menu">
	<li id="menu-item-34048" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34048"><a href="https://www.secpulse.com/archives/category/articles/intranet-penetration">内网渗透</a></li>
	<li id="menu-item-34047" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34047"><a href="https://www.secpulse.com/archives/category/articles/code-audit">代码审计</a></li>
	<li id="menu-item-34046" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34046"><a href="https://www.secpulse.com/archives/category/articles/web">Web安全</a></li>
	<li id="menu-item-34565" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34565"><a href="https://www.secpulse.com/archives/category/articles/sec-doc">安全文献</a></li>
	<li id="menu-item-34568" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34568"><a href="https://www.secpulse.com/archives/category/articles/social-engineering">社会工程</a></li>
	<li id="menu-item-35948" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35948"><a href="https://www.secpulse.com/archives/category/articles/wireless">无线安全</a></li>
	<li id="menu-item-35949" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35949"><a href="https://www.secpulse.com/archives/category/articles/mobile-security">移动安全</a></li>
	<li id="menu-item-35950" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-35950"><a href="https://www.secpulse.com/archives/category/articles/system">系统安全</a>
	<ul class="sub-menu">
		<li id="menu-item-35951" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35951"><a href="https://www.secpulse.com/archives/category/articles/system/linux">Linux</a></li>
		<li id="menu-item-35952" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35952"><a href="https://www.secpulse.com/archives/category/articles/system/windows">Windows</a></li>
	</ul>
</li>
	<li id="menu-item-35953" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35953"><a href="https://www.secpulse.com/archives/category/articles/reverse-break">逆向破解</a></li>
</ul>
</li>
<li id="menu-item-18" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-18"><a href="https://www.secpulse.com/archives/category/news">资讯</a>
<ul class="sub-menu">
	<li id="menu-item-35956" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35956"><a href="https://www.secpulse.com/archives/category/news/china-news">国内资讯</a></li>
	<li id="menu-item-35957" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35957"><a href="https://www.secpulse.com/archives/category/news/world-news">国外资讯</a></li>
</ul>
</li>
<li id="menu-item-379" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-has-children menu-item-379"><a href="https://www.secpulse.com/archives/category/construction">安全建设</a>
<ul class="sub-menu">
	<li id="menu-item-51480" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51480"><a href="https://www.secpulse.com/archives/category/construction/securityissue">安全管理</a></li>
	<li id="menu-item-54332" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54332"><a href="https://www.secpulse.com/archives/category/construction/%e4%b8%9a%e5%8a%a1%e5%ae%89%e5%85%a8">业务安全</a></li>
	<li id="menu-item-35955" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35955"><a href="https://www.secpulse.com/archives/category/construction/bigdata">数据分析</a></li>
	<li id="menu-item-54333" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-54333"><a href="https://www.secpulse.com/archives/category/construction/security-reports">安全报告</a></li>
</ul>
</li>
<li id="menu-item-368" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-368"><a href="https://www.secpulse.com/archives/category/exclusive">独家</a>
<ul class="sub-menu">
	<li id="menu-item-35947" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35947"><a href="https://www.secpulse.com/archives/category/articles/industrial-safety">工控安全</a></li>
	<li id="menu-item-35954" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35954"><a href="https://www.secpulse.com/archives/category/exclusive/ctf-writeup">CTF</a></li>
	<li id="menu-item-50217" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-50217"><a href="https://www.secpulse.com/archives/category/exclusive/duoyinsu">多因素令牌</a></li>
	<li id="menu-item-51479" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51479"><a href="https://www.secpulse.com/archives/category/exclusive/dataleakage">数据泄露</a></li>
</ul>
</li>
<li id="menu-item-16" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-16"><a href="https://www.secpulse.com/archives/category/tools">工具</a></li>
<li id="menu-item-52" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-52"><a href="https://www.secpulse.com/archives/category/hiring">招聘</a></li>
<li id="menu-item-50" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50"><a href="https://www.secpulse.com/newsend">投稿</a></li>
<li id="menu-item-6645" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6645"><a href="https://www.secpulse.com/archives/category/vul">漏洞</a></li>
</ul></nav>  <nav class="right-nav clr "><ul id="menu-%e5%af%bc%e8%88%aa%e4%ba%8c" class="header-menu-nav"><li id="menu-item-33967" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33967"><a title="付费渗透测试" href="http://service.secpulse.com">安全服务</a></li>
<li id="menu-item-52043" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-52043"><a title="安全从业者最实用的安全导航" href="http://nav.secpulse.com">安全导航</a></li>
<li id="menu-item-33966" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33966"><a title="安识科技" href="https://www.duoyinsu.com">多因素</a></li>
</ul></nav></div>
		</div>
		<div class="nav-bg"></div>
   <nav class="mini-nav visible-xs"><ul id="menu-%e5%af%bc%e8%88%aa-1" class="menu-mini-nav"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15"><a href="https://www.secpulse.com/">首页</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-17"><a href="https://www.secpulse.com/archives/category/articles">文章</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34048"><a href="https://www.secpulse.com/archives/category/articles/intranet-penetration">内网渗透</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34047"><a href="https://www.secpulse.com/archives/category/articles/code-audit">代码审计</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34046"><a href="https://www.secpulse.com/archives/category/articles/web">Web安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34565"><a href="https://www.secpulse.com/archives/category/articles/sec-doc">安全文献</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34568"><a href="https://www.secpulse.com/archives/category/articles/social-engineering">社会工程</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35948"><a href="https://www.secpulse.com/archives/category/articles/wireless">无线安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35949"><a href="https://www.secpulse.com/archives/category/articles/mobile-security">移动安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-35950"><a href="https://www.secpulse.com/archives/category/articles/system">系统安全</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35951"><a href="https://www.secpulse.com/archives/category/articles/system/linux">Linux</a></li>
		<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35952"><a href="https://www.secpulse.com/archives/category/articles/system/windows">Windows</a></li>
	</ul>
</li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35953"><a href="https://www.secpulse.com/archives/category/articles/reverse-break">逆向破解</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-18"><a href="https://www.secpulse.com/archives/category/news">资讯</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35956"><a href="https://www.secpulse.com/archives/category/news/china-news">国内资讯</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35957"><a href="https://www.secpulse.com/archives/category/news/world-news">国外资讯</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-has-children menu-item-379"><a href="https://www.secpulse.com/archives/category/construction">安全建设</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51480"><a href="https://www.secpulse.com/archives/category/construction/securityissue">安全管理</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54332"><a href="https://www.secpulse.com/archives/category/construction/%e4%b8%9a%e5%8a%a1%e5%ae%89%e5%85%a8">业务安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35955"><a href="https://www.secpulse.com/archives/category/construction/bigdata">数据分析</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-54333"><a href="https://www.secpulse.com/archives/category/construction/security-reports">安全报告</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-368"><a href="https://www.secpulse.com/archives/category/exclusive">独家</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35947"><a href="https://www.secpulse.com/archives/category/articles/industrial-safety">工控安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35954"><a href="https://www.secpulse.com/archives/category/exclusive/ctf-writeup">CTF</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-50217"><a href="https://www.secpulse.com/archives/category/exclusive/duoyinsu">多因素令牌</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51479"><a href="https://www.secpulse.com/archives/category/exclusive/dataleakage">数据泄露</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-16"><a href="https://www.secpulse.com/archives/category/tools">工具</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-52"><a href="https://www.secpulse.com/archives/category/hiring">招聘</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50"><a href="https://www.secpulse.com/newsend">投稿</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6645"><a href="https://www.secpulse.com/archives/category/vul">漏洞</a></li>
</ul></nav>     </header><section class="xs-main index-main clr">
<div class="inner">
<div class="xs-left">
<nav class="crumbs">现在位置： <a title="返回首页" href="https://www.secpulse.com">首页</a> &gt; <a href="https://www.secpulse.com/archives/category/construction">安全建设</a> &gt; <a href="https://www.secpulse.com/archives/category/construction/security-reports" rel="category tag">安全报告</a> &gt;  正文 </nav><article id="post-55098" class="post-55098 post type-post status-publish format-standard has-post-thumbnail hentry category-security-reports tag-62347 tag-63280 tag-11837 tag-63279">
	<header class="single-header">
		<h1>方程式组织EQUATION DRUG平台解析(提纲) —方程式组织系列分析报告之四</h1>
			<div class="single-meta">
				
		    <div class="time"><i></i> <a href="javascript:void(0);">2017 /1/25 13:55</a></div>
			<div class="eye xs-hidden"><i class="fa fa-eye fa-1"></i><a href="javascript:void(0);">6,202</a> </div>			<div class="comments xs-hidden"><i class="fa fa-comments fa-1"></i><a href="https://www.secpulse.com/archives/55098.html#respond">沙发</a></div>
			
			
		</div>
		<!-- .entry-meta -->
	</header>
	<!-- .single-header -->

	<div class="single-main">
		<h2 style="text-align: center"></h2>
<p style="text-align: center">安天安全研究与应急处理中心（Antiy CERT）</p>
<p style="text-align: center">报告初稿完成时间：2017年1月13日 16时00分<br />
首次发布时间：2017年1月16日 10时00分<br />
本版本更新时间：2017年1月17日 8时30分</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2017/01/1.jpg"><img class="aligncenter wp-image-55099 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/01/1.jpg" alt="1" width="548" height="548" /></a></p>
<h2><span style="color: #0000ff">1  背景</span></h2>
<hr />
<p>&nbsp;</p>
<p>对于“方程式组织”，在过去的两年中，安天已经连续发布了三篇分析报告：在《修改<a href="https://www.secpulse.com/archives/55098.html">硬盘固件</a>的木马——探索方程式（EQUATION）组织的攻击组件》<sup>[1]</sup> 中，安天对多个模块进行了分析，并对其写入硬盘固件的机理进行了分析验证；在《方程式（EQUATION）部分组件中的加密技巧分析》<sup>[2]</sup>报告中，对攻击组件中使用的加密方式实现了破解；在《从“方程式”到“方程组”——EQUATION攻击组织高级恶意代码的全平台能力解析》<sup>[3]</sup>报告中，安天独家提供了方程式Linux和Solaris系统的样本分析，这也是业内首次正式证实这些“恶灵”真实存在的公开分析。</p>
<p>APT的分析成果，与研发反APT产品一样，都要基于充分的基础积累，而不可能“一夜之间建成罗马”，对于方程式这样大至无形的超级攻击组织来说，我们过去所做的具体的分析工作都是盲人摸象的过程，一旦飘忽的线索落入我们已经摸索过的范围之内，就可以迅速发布储备成果，而如果面对的是一个未曾充分探查的区域，则需要更长的时间展开分析工作，因此与安天此前已经发布的3篇方程式的长篇报告相比，本篇报告的当前版本是比较仓促的，因此我们称之为“提纲”，我们旨在能抛砖引玉，邀请更多兄弟团队共同加入分析工作，以便进一步呈现出其全貌。</p>
<p>本篇分析是围绕2017年1月12日，“影子经纪人”放出Equation Group 组件中的61个文件<sup>[4]</sup> 展开的。经分析，本次放出的61个文件中，其中含有Equation Group 组件和DanderSpritZ（RAT）工具中的一些插件。DanderSpritZ是NSA（National Security Agency）的间谍工具之一，在1月7号“影子经纪人”放出的Windows攻击工具<sup>[5]</sup>中也包含了大量DanderSpritZ的插件名称。</p>
<p>组件EquationDrug是一个很复杂的模块。其存活时间有近10年，后来被GrayFish升级替代。EquationDrug到GrayFish是攻击平台级别的恶意代码体系，它具有安装与卸载插件功能。本次“影子经纪人”放出的文件中，我们看到了更多的EquationDrug组件中的插件。通过分析比对发现，这些插件比之前安天分析过的插件版本低，但相对更为全面。</p>
<p>至今，安天已经完成了对插件功能列表和部分插件的关联分析，先将此部分的分析工作对外分享，后续会将更多的信息分享。</p>
<h2>2 方程式线索曝光和分析成果时间链梳理</h2>
<hr />
<p>&nbsp;</p>
<p>2013年起，安天从样本分析中，逐步发现存在一个拥有<a href="https://www.secpulse.com/?p=55098&amp;preview=true" target="_blank">全平台载荷攻击</a>能力的攻击组织，并逐步关联分析了其多个平台的样本。在这个过程中，我们感到一个大至无形的超级攻击组织存在，但我们并未找到其攻击背景。</p>
<p>2015年2月，卡巴斯基实验室曝光了一个名为方程式（Equation Group）<sup>[6]</sup>的攻击组织，卡巴斯基认为该组织活跃近20年，可能是目前世界上存在的最复杂的APT攻击组织之一，并认为该组织是震网（Stuxnet）和火焰（Flame）病毒幕后的操纵者。经过线索比对，安天发现这正是此前一直跟踪的超级攻击组织，决定通过报告公开其针对硬盘固件作业的原理<sup>[1]</sup>和所破解的其部分加密算法<sup>[2]</sup>,形成了安天对于方程式系列分析的前两篇报告。,</p>
<p>2015年3月，卡巴斯基实验室发布了基于<a href="https://www.secpulse.com/?p=55098&amp;preview=true" target="_blank">Equation Drug组件</a>或平台的剖析<sup>[7]</sup>，Equation Drug是“方程式组织”所用的主要间谍组件或平台之一，最早追溯到2001年，并且一直沿用至今。该组件或平台的架构类似于一个具有内核模式和用户模式的微型操作系统，通过自定义接口进行交互，该组件或平台包括驱动程序、平台内核（协调器）和若干插件，其中一些插件配备独特的ID和版本号，用于定义相关功能等。</p>
<p>2016年8月，一个自称“<a href="https://www.secpulse.com/?p=55098&amp;preview=true" target="_blank">影子经纪人</a>”（The Shadow Brokers）的个人（或组织）声称入侵了网络间谍组织“方程式”（Equation）<sup>[8]</sup>，并以100万比特币（当时约价值5.6亿美元）的价格，公开“拍卖”所掌握的方程式组织的攻击工具。“方程式组织”被认为与NSA存在联系。为证明成功入侵的真实性，影子经纪人于当月13日在开源项目托管平台<a href="https://www.secpulse.com/?p=55098&amp;preview=true" target="_blank">GitHub</a>加密发布了这些攻击工具，并有意将其中的少量攻击工具以明文形式发布。</p>
<p>2016年8月，卡巴斯基实验室通过对“方程式组织”与“影子经纪人”曝光的数据进行对比验证<sup>[9]</sup>，确认了曝光的数据与“方程式组织”有关。2016年10月，影子经纪人对攻击工具再度发起拍卖[10]，并称在GitHub发布的方程式攻击工具只占其掌握的60%。</p>
<p>11月，影子经纪人公开了一份<a href="https://www.secpulse.com/?p=55098&amp;preview=true" target="_blank">遭受入侵</a>的服务器清单<sup>[11]</sup>，并称攻击方与NSA有关。清单的日期显示，各系统遭受入侵的时间在2000年到2010年之间，受控IP及域名分布在49个国家，主要集中在亚太地区，受影响的国家包括中国、日本、韩国、西班牙、德国、印度等。 安天将这些数据导入到安天态势感知和<a href="https://www.secpulse.com/?p=55098&amp;preview=true" target="_blank">预警平台</a>，形成了下图的可视化展现。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2017/01/2.jpg"><img class="aligncenter wp-image-55101 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/01/2.jpg" alt="2" width="700" height="390" /></a></p>
<p style="text-align: center">图 1 安天态势感知与<a href="https://www.secpulse.com/?p=55098&amp;preview=true">监控预警平台</a>：“方程式”组织对全球互联网节点的入侵可视化复现</p>
<p>&nbsp;</p>
<p>在<a href="https://www.secpulse.com/?p=55098&amp;preview=true">影子经纪人</a>的爆料中，提及相关服务器可能是Linux、FreeBSD和Solaris。而在2016年上半年的两次技术会议中，安天则明确说明，方程式有针对多个系统平台的样本，其中包括Linux和Solaris。安天最终于11月5日公开了方程式组织针对Linux和Solaris的部分样本载荷的分析报告（安天方程式系列报告之三）。</p>
<p>安天分析团队对小组“方程式”上述信息进行了梳理，整理出方程式事件曝光和相关分析的时间链。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2017/01/35.png"><img class=" wp-image-55102 size-full aligncenter" src="http://www.secpulse.com/wp-content/uploads/2017/01/35.png" alt="3" width="661" height="295" /></a></p>
<p style="text-align: center">图 2 方程式事件相关信息曝光和厂商分析的时间链</p>
<h2>3 DanderSpritz攻击平台</h2>
<p>安天通过对本次泄露的文件以及对以往方程式资料的分析发现，“方程式组织的“EquationDrug”平台与泄露文件中提到的“<a href="https://www.secpulse.com/?p=55098&amp;preview=true" target="_blank">DanderSpritz</a>”具有一定内在联系：</p>
<ol>
<li>本次<a href="https://www.secpulse.com/?p=55098&amp;preview=true" target="_blank">泄露的msgkd.ex_、msgki.ex_、msgks.ex_、msgku.ex_</a>为GROK插件，是“DanderSpritz”的插件或模块，该插件在“EquationDrug”平台中也曾出现，通过分析发现本次泄露的GROK为低版本GROK插件。</li>
<li>本次曝光的各类DLL插件中一处数据为插件ID，插件ID都是以0x79开头，如：0x79A4、0x79D8，同样，“EquationDrug”平台的插件也设有内置ID，“EquationDrug”平台的插件ID为0x80开头。且两个平台的插件导出函数参数的数据结构也存在相似之处。</li>
</ol>
<p>因此，基本可以认为方程式组织使用的“EquationDrug”攻击平台与“DanderSpritz” 使用了相同的架构设计， 两者可能是不同的版本代号，或至少来自同一开发团队，或<a href="https://www.secpulse.com/?p=55098&amp;preview=true" target="_blank">资源高度共享</a>的团队。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2017/01/42.png"><img class="aligncenter wp-image-55103 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/01/42.png" alt="4" width="700" height="411" /></a></p>
<p style="text-align: center">图 3 方程式组织的DanderSpritz攻击平台</p>
<p style="text-align: center"><a href="http://www.secpulse.com/wp-content/uploads/2017/01/52.png"><img class=" size-full wp-image-55105 aligncenter" src="http://www.secpulse.com/wp-content/uploads/2017/01/52.png" alt="5" width="700" height="424" /></a></p>
<p style="text-align: center">图 4 “影子经纪人”<a href="https://www.secpulse.com/?p=55098&amp;preview=true" target="_blank">泄露</a>的“DanderSpritz”攻击平台截图</p>
<p>本次“影子经纪人”曝光的文件中多数为“DanderSpritz”平台的攻击插件，从放出的文件列表HASH和截图来看，攻击工具和插件非常丰富且标准化，具体包括远控、漏洞利用、后门、插件等，DanderSpritz_All_Find.txt文件内容多达7千余行，其中插件有数百个之多，我们将泄露出来的61个文件进行梳理，分析出了部分插件的功能，如下表（后续版本会持续更新插件确认结果）：</p>
<table>
<tbody>
<tr>
<td><strong>原始文件名</strong></td>
<td><strong>编号ID</strong></td>
<td><strong>说明</strong></td>
</tr>
<tr>
<td><strong>DoubleFeatureDll.dll.unfinalized</strong></td>
<td></td>
<td>该模块用于创建线程执行函数，地址由调用者传入。</td>
</tr>
<tr>
<td><strong>DuplicateToken_Implant.dll</strong></td>
<td></td>
<td>该模块用于获取Token，并执行操作。</td>
</tr>
<tr>
<td><strong>DuplicateToken_Lp.dll</strong></td>
<td>0x79E2</td>
<td>该模块用于获取Token，并执行操作。</td>
</tr>
<tr>
<td><strong>DXGHLP16.SYS</strong></td>
<td></td>
<td>该模块用于对网络进行嗅探，监测以太网和VPN的流量，用于Windows 9x系统。</td>
</tr>
<tr>
<td><strong>EventLogEdit_Implant.dll</strong></td>
<td></td>
<td>该模块可对事件日志文件进行编辑。</td>
</tr>
<tr>
<td><strong>EventLogEdit_Lp.dll</strong></td>
<td>0x79B1</td>
<td>该模块可对事件日志文件进行编辑。</td>
</tr>
<tr>
<td><strong>GetAdmin_Implant.dll</strong></td>
<td></td>
<td>该模块用于获取管理员权限，并执行操作。</td>
</tr>
<tr>
<td><strong>GetAdmin_Lp.dll</strong></td>
<td>0x79A8</td>
<td>该模块用于获取管理员权限，并执行操作。</td>
</tr>
<tr>
<td><strong>kill_Implant.dll</strong></td>
<td></td>
<td>该模块功能是结束进程。</td>
</tr>
<tr>
<td><strong>kill_Implant9x.dll</strong></td>
<td></td>
<td>该模块功能是结束进程。</td>
</tr>
<tr>
<td><strong>LSADUMP_Implant.dll</strong></td>
<td></td>
<td>该模块可用来读取LSA凭据，根据传入参数的不同执行不同的操作。</td>
</tr>
<tr>
<td><strong>LSADUMP_Lp.dll</strong></td>
<td>0x79C9</td>
<td>该模块可用来读取LSA凭据，根据传入参数的不同执行不同的操作。</td>
</tr>
<tr>
<td><strong>modifyAudit_Implant.dll</strong></td>
<td></td>
<td>该模块用于修改审核配置。</td>
</tr>
<tr>
<td><strong>modifyAudit_Lp.dll</strong></td>
<td>0x79C8</td>
<td>该模块用于修改审核配置。</td>
</tr>
<tr>
<td><strong>modifyAuthentication_Implant.dll</strong></td>
<td></td>
<td>该模块用于修改权限认证。</td>
</tr>
<tr>
<td><strong>modifyAuthentication_Lp.dll</strong></td>
<td>0x79EF</td>
<td>该模块用于修改权限认证。</td>
</tr>
<tr>
<td><strong>ModifyGroup_Implant.dll</strong></td>
<td></td>
<td>该模块用于修改用户组权限。</td>
</tr>
<tr>
<td><strong>ModifyGroup_Lp.dll</strong></td>
<td> 0x79ED</td>
<td>该模块用于修改用户组权限。</td>
</tr>
<tr>
<td><strong>ModifyPrivilege_Implant.dll</strong></td>
<td></td>
<td>该模块用于修改用户权限。</td>
</tr>
<tr>
<td><strong>ModifyPrivilege_Lp.dll</strong></td>
<td>0x7995</td>
<td>该模块用于修改用户权限。</td>
</tr>
<tr>
<td><strong>msgkd.ex_</strong></td>
<td></td>
<td>释放GROK键盘/剪贴板记录器驱动。</td>
</tr>
<tr>
<td><strong>msgki.ex_</strong></td>
<td></td>
<td>释放GROK键盘/剪贴板记录器驱动。</td>
</tr>
<tr>
<td><strong>msgks.ex_</strong></td>
<td></td>
<td>释放GROK键盘/剪贴板记录器驱动。</td>
</tr>
<tr>
<td><strong>msgku.ex_</strong></td>
<td></td>
<td>释放GROK键盘/剪贴板记录器驱动。</td>
</tr>
<tr>
<td><strong>mssld.dll</strong></td>
<td></td>
<td>待确认</td>
</tr>
<tr>
<td><strong>msslu.dll</strong></td>
<td></td>
<td>待确认</td>
</tr>
<tr>
<td><strong>mstcp32.sys</strong></td>
<td></td>
<td>该模块用于对网络进行嗅探监测以太网和VPN的流量 。</td>
</tr>
<tr>
<td><strong>nethide_Implant.dll</strong></td>
<td></td>
<td>该模块用于隐藏网络连接。</td>
</tr>
<tr>
<td><strong>nethide_Lp.dll</strong></td>
<td>0x79CA</td>
<td>该模块用于隐藏网络连接。</td>
</tr>
<tr>
<td><strong>ntevt.sys</strong></td>
<td></td>
<td>该模块是事件日志相关驱动。</td>
</tr>
<tr>
<td><strong>ntevtx64.sys</strong></td>
<td></td>
<td>该模块是64位事件日志相关驱动。</td>
</tr>
<tr>
<td><strong>ntfltmgr.sys</strong></td>
<td></td>
<td>待确认</td>
</tr>
<tr>
<td><strong>PassFreely_Implant.dll</strong></td>
<td></td>
<td>待确认</td>
</tr>
<tr>
<td><strong>PassFreely_Lp.dll</strong></td>
<td>0x79DB</td>
<td>待确认</td>
</tr>
<tr>
<td><strong>PC_Legacy_dll</strong></td>
<td></td>
<td>待确认</td>
</tr>
<tr>
<td><strong>PC_Level3_dll</strong></td>
<td></td>
<td>待确认</td>
</tr>
<tr>
<td><strong>PC_Level3_dll_x64</strong></td>
<td></td>
<td>待确认</td>
</tr>
<tr>
<td><strong>PC_Level3_flav_dll</strong></td>
<td></td>
<td>待确认</td>
</tr>
<tr>
<td><strong>PC_Level3_flav_dll_x64</strong></td>
<td></td>
<td>待确认</td>
</tr>
<tr>
<td><strong>PC_Level3_http_dll</strong></td>
<td></td>
<td>待确认</td>
</tr>
<tr>
<td><strong>PC_Level3_http_dll_x64</strong></td>
<td></td>
<td>待确认</td>
</tr>
<tr>
<td><strong>PC_Level3_http_flav_dll</strong></td>
<td></td>
<td>待确认</td>
</tr>
<tr>
<td><strong>PC_Level3_http_flav_dll_x64</strong></td>
<td></td>
<td>待确认</td>
</tr>
<tr>
<td><strong>PC_Level4_flav_dll</strong></td>
<td></td>
<td>待确认</td>
</tr>
<tr>
<td><strong>PC_Level4_flav_dll_x64</strong></td>
<td></td>
<td>待确认</td>
</tr>
<tr>
<td><strong>PC_Level4_flav_exe</strong></td>
<td></td>
<td>待确认</td>
</tr>
<tr>
<td><strong>PC_Level4_http_flav_dll</strong></td>
<td></td>
<td>待确认</td>
</tr>
<tr>
<td><strong>PC_Level4_http_flav_dll_x64</strong></td>
<td></td>
<td>待确认</td>
</tr>
<tr>
<td><strong>PortMap_Implant.dll</strong></td>
<td></td>
<td>该模块用于进行端口映射。</td>
</tr>
<tr>
<td><strong>PortMap_Lp.dll</strong></td>
<td>0x79BB</td>
<td>该模块用于进行端口映射。</td>
</tr>
<tr>
<td><strong>ProcessHide_Implant.dll</strong></td>
<td></td>
<td>该模块用于进行隐藏进程。</td>
</tr>
<tr>
<td><strong>ProcessHide_Lp.dll</strong></td>
<td>0x79AC</td>
<td>该模块用于进行隐藏进程。</td>
</tr>
<tr>
<td><strong>processinfo_Implant.dll</strong></td>
<td></td>
<td>该模块可以用来获取进程信息。</td>
</tr>
<tr>
<td><strong>processinfo_Implant9x.dll</strong></td>
<td></td>
<td>该模块可以用来获取进程信息，支持Windows 9x。</td>
</tr>
<tr>
<td><strong>ProcessOptions_Implant.dll</strong></td>
<td></td>
<td>该模块用于设定进程执行属性。</td>
</tr>
<tr>
<td><strong>ProcessOptions_Lp.dll</strong></td>
<td>0x79D8</td>
<td>该模块用于设定进程执行属性。</td>
</tr>
<tr>
<td><strong>pwdump_Implant.dll</strong></td>
<td></td>
<td>该模块可用来读取系统中密码。</td>
</tr>
<tr>
<td><strong>pwdump_Lp.dll</strong></td>
<td>0x79CD</td>
<td>该模块可用来读取系统中密码。</td>
</tr>
<tr>
<td><strong>RunAsChild_Implant.dll</strong></td>
<td></td>
<td>该模块用于创建子进程，并执行操作。</td>
</tr>
<tr>
<td><strong>RunAsChild_Lp.dll</strong></td>
<td>0x79A4</td>
<td>该模块用于创建子进程，并执行操作。</td>
</tr>
<tr>
<td><strong>tdi6.sys</strong></td>
<td></td>
<td>该模块用于对网络进行嗅探 监测以太网和VPN的流量 。</td>
</tr>
</tbody>
</table>
<p><a href="http://www.secpulse.com/wp-content/uploads/2017/01/62.png"><img class="alignnone size-full wp-image-55106" src="http://www.secpulse.com/wp-content/uploads/2017/01/62.png" alt="6" width="512" height="465" /></a></p>
<p style="text-align: center">图 5 曝光的“DanderSpritz”平台的攻击插件截图</p>
<p> “DanderSpritz”一词在“棱镜”事件中曾被曝光，文件指出该平台是NSA用于<a href="https://www.secpulse.com/?p=55098&amp;preview=true" target="_blank">全球监控的网络武器</a>，可被用于多种作业场景，如下图中“FIREWALK”<sup>[12]</sup>工具用于网络流量采集和注入，其说明中提及到了DNT的“DanderSpritz”，DNT与ANT同属于NSA的网络组织，“方程式”与NSA再一次被联系到一起。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2017/01/63.png"><img class="alignnone size-full wp-image-55107" src="http://www.secpulse.com/wp-content/uploads/2017/01/63.png" alt="6" width="700" height="903" /></a></p>
<p style="text-align: center">图 6<a href="https://www.secpulse.com/?p=55098&amp;preview=true" target="_blank"> 斯诺登</a>曝光的NSA-ANT网络武器FIREWALK</p>
<p>NSA-ANT网络武器最早在2013年从斯诺登事件中曝光，共包含48个攻击武器，随着事件的发酵，不断有媒体和组织对其进行曝光，安天分析工程师根据目前曝光的全部资料尝试初步绘制了相关攻击装备的图谱，其相关映射关联还在进一步的维护中。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2017/01/7.jpg"><img class="alignnone size-full wp-image-55108" src="http://www.secpulse.com/wp-content/uploads/2017/01/7.jpg" alt="7" width="700" height="561" /></a></p>
<p style="text-align: center">图 7 NSA-TAO攻击装备体系（完善中）</p>
<h2>4  部分组件与插件分析（继续完善中）</h2>
<hr />
<p>&nbsp;</p>
<h3>4.1   GROK键盘与剪贴版<a href="https://www.secpulse.com/?p=55098&amp;preview=true" target="_blank">记录器驱动</a></h3>
<p>本次泄露的<a href="https://www.secpulse.com/?p=55098&amp;preview=true" target="_blank">恶意代码</a>中包含四个功能相似的GROK组件，它们都是PE文件，版本为1.2.0.1，均可以从资源段中解密并释放键盘与剪贴版记录器驱动msrtdv.sys。</p>
<h3><span style="color: #999999">4.1.1          样本标签</span></h3>
<p><span id="more-55098"></span></p>
<table class=" aligncenter" width="68%">
<tbody>
<tr>
<td width="41%"><strong>病毒名</strong></td>
<td width="59%">Trojan/Win32.EquationDrug</td>
</tr>
<tr>
<td width="41%"><strong>原始文件名</strong></td>
<td width="59%">msrtdv.sys</td>
</tr>
<tr>
<td width="41%"><strong>MD5</strong></td>
<td width="59%">6A4461AF87371B89D240A34846A7BC64</td>
</tr>
<tr>
<td width="41%"><strong>处理器架构</strong></td>
<td width="59%">X86-32</td>
</tr>
<tr>
<td width="41%"><strong>文件大小</strong></td>
<td width="59%">36.3 KB (37,248 字节)</td>
</tr>
<tr>
<td width="41%"><strong>文件格式</strong></td>
<td width="59%">BinExecute/Microsoft.SYS[:X86]</td>
</tr>
<tr>
<td width="41%"><strong>时间戳</strong></td>
<td width="59%">0x4B7F1480—&gt;2010-02-20 06:45:20</td>
</tr>
</tbody>
</table>
<p>该恶意代码样本是键盘记录器及剪贴版监视工具，在之前友商报告中曾经提到过有相似功能的恶意代码，下面对其相似之处进行对比。</p>
<h3><span style="color: #999999">4.1.2  版本信息</span></h3>
<p>样本包含<a href="https://www.secpulse.com/?p=55098&amp;preview=true" target="_blank">版本信息</a>，文件版本为5.1.1364.6430，源文件名为msrtdv.sys，文件描述为MSRTdv interface driver。其中文件版本低于之前已经曝光的版本5.3.1365.2180，源文件名与文件描述的不同在于将两个字母“d”和“v”的位置互换，一个是“mstrdv.sys”，另一个是“msrtvd.sys”。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2017/01/82.png"><img class="alignnone size-full wp-image-55109" src="http://www.secpulse.com/wp-content/uploads/2017/01/82.png" alt="8" width="643" height="229" /></a></p>
<p style="text-align: center">图 8 本次泄露版本与之前曝光版本的版本信息</p>
<h3><span style="color: #999999">4.1.3    主要功能</span></h3>
<p>两个不同版本的样本其主要功能相同，通过给转储程序建立专用的进程来汇集所收集的数据，每隔30分钟，将结果压缩到文件"%TEMP%\tm154o.da"。之前曝光的版本中，包含多个IoControlCode，分别对应不同的功能。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2017/01/92.png"><img class="alignnone size-full wp-image-55110" src="http://www.secpulse.com/wp-content/uploads/2017/01/92.png" alt="9" width="543" height="488" /></a></p>
<p style="text-align: center">图 9 之前曝光版本的主要功能代码</p>
<p>而本次泄露的样本中，IoControlCode虽然只有0x22002C，但一些主要功能仍然存在，可以通过反编译后的代码看出它们的相同之处。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2017/01/102.png"><img class="alignnone size-full wp-image-55111" src="http://www.secpulse.com/wp-content/uploads/2017/01/102.png" alt="10" width="563" height="414" /></a></p>
<p style="text-align: center">图 10 本次泄露版本的主要功能代码</p>
<p>从以上分析比较中可以发现，本次泄露的恶意代码样本应为较低版本，无论从版本信息还是功能上，都要低于之前曝光的版本。在影子经纪人泄露出的文件DanderSpritz_All_Find.txt中，GROK的版本号也清楚的说明了这个问题，影子经纪人所释放出的只是GROK组件的低版本部分文件，高版本仍然被其掌握在手中。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2017/01/112.png"><img class="alignnone size-full wp-image-55112" src="http://www.secpulse.com/wp-content/uploads/2017/01/112.png" alt="11" width="377" height="183" /></a></p>
<p>图 11 GROK组件的不同版本号</p>
<h3>4.2         Processinfo插件遍历进程模块</h3>
<p>本插件用于实现对指定进程的模块遍历，并调用上层模块预设的回调函数。</p>
<h3><span style="color: #999999">4.2.1 样本标签</span></h3>
<table width="68%">
<tbody>
<tr>
<td width="42%"><strong>病毒名</strong></td>
<td width="57%">Trojan/Win32.EquationDrug</td>
</tr>
<tr>
<td width="42%"><strong>原始文件名</strong></td>
<td width="57%">processinfo_Implant9x.dll</td>
</tr>
<tr>
<td width="42%"><strong>MD5</strong></td>
<td width="57%">6042EA9707316784FBC77A8B450E0991</td>
</tr>
<tr>
<td width="42%"><strong>处理器架构</strong></td>
<td width="57%">X86-32</td>
</tr>
<tr>
<td width="42%"><strong>文件大小</strong></td>
<td width="57%">8 KB (8,192 字节)</td>
</tr>
<tr>
<td width="42%"><strong>文件格式</strong></td>
<td width="57%">BinExecute/Microsoft.DLL[:X86]</td>
</tr>
<tr>
<td width="42%"><strong>时间戳</strong></td>
<td width="57%">45A40EC7-&gt;2007-01-10 05:53:11</td>
</tr>
</tbody>
</table>
<p>,</p>
<h3><span style="color: #999999">4.2.2  主要功能</span></h3>
<p>本插件提供四个基于序号导出的函数。</p>
<table>
<tbody>
<tr>
<td width="116"><strong>序号</strong></td>
<td width="343"><strong>功能</strong></td>
</tr>
<tr>
<td width="116">1</td>
<td width="343">设置上层模块回调函数，创建互斥体</td>
</tr>
<tr>
<td width="116">2</td>
<td width="343">释放资源</td>
</tr>
<tr>
<td width="116">3</td>
<td width="343">返回核心功能函数地址</td>
</tr>
<tr>
<td width="116">4</td>
<td width="343">获取插件版本信息</td>
</tr>
</tbody>
</table>
<p><a href="http://www.secpulse.com/wp-content/uploads/2017/01/122.png"><img class="alignnone size-full wp-image-55113" src="http://www.secpulse.com/wp-content/uploads/2017/01/122.png" alt="12" width="763" height="254" /></a></p>
<p style="text-align: center">图 12 1号导出函数 设置上层模块回调函数</p>
<p style="text-align: center"><a href="http://www.secpulse.com/wp-content/uploads/2017/01/132.png"><img class="alignnone size-full wp-image-55115" src="http://www.secpulse.com/wp-content/uploads/2017/01/132.png" alt="13" width="457" height="72" /></a></p>
<p style="text-align: center">图 13 3号导出函数 返回核心功能函数地址</p>
<p style="text-align: center"><a href="http://www.secpulse.com/wp-content/uploads/2017/01/142.png"><img class="alignnone size-full wp-image-55116" src="http://www.secpulse.com/wp-content/uploads/2017/01/142.png" alt="14" width="290" height="226" /></a></p>
<p>&nbsp;</p>
<p style="text-align: center">图 14 4号导出函数 获取插件版本信息</p>
<p style="text-align: center"><a href="http://www.secpulse.com/wp-content/uploads/2017/01/152.png"><img class="alignnone size-full wp-image-55117" src="http://www.secpulse.com/wp-content/uploads/2017/01/152.png" alt="15" width="479" height="375" /></a></p>
<p style="text-align: center">图 15 遍历指定进程，默认为当前进程</p>
<p style="text-align: center"><a href="http://www.secpulse.com/wp-content/uploads/2017/01/162.png"><img class="alignnone size-full wp-image-55118" src="http://www.secpulse.com/wp-content/uploads/2017/01/162.png" alt="16" width="556" height="472" /></a></p>
<p style="text-align: center">图 16 遍历指定进程模块，计算模块对应文件HASH（SHA1）</p>
<h2>4.3         kill_Implant插件杀进程模块</h2>
<h3><span style="color: #999999">4.3.1          样本标签</span></h3>
<table width="90%">
<tbody>
<tr>
<td width="24%"><strong>病毒名</strong></td>
<td width="75%">Trojan/Win32.EquationDrug</td>
</tr>
<tr>
<td width="24%"><strong>原始文件名</strong></td>
<td width="75%">kill_Implant.dll</td>
</tr>
<tr>
<td width="24%"><strong>MD5</strong></td>
<td width="75%">BDD2B462E050EF2FA7778526EA4A2A58</td>
</tr>
<tr>
<td width="24%"><strong>处理器架构</strong></td>
<td width="75%">X86-32</td>
</tr>
<tr>
<td width="24%"><strong>文件大小</strong></td>
<td width="75%">21 KB(21,504 字节)</td>
</tr>
<tr>
<td width="24%"><strong>文件格式</strong></td>
<td width="75%">BinExecute/Microsoft.DLL[:X86]</td>
</tr>
<tr>
<td width="24%"><strong>时间戳</strong></td>
<td width="75%">45A40616-&gt;2007-01-10 05:16:06</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<h3><span style="color: #999999">4.3.2  主要功能</span></h3>
<p>模块调用者传递进来进程ID，该模块利用函数OpenProcess获取句柄，再利用函数TerminateProcess结束对应进程。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2017/01/172.png"><img class="alignnone size-full wp-image-55119" src="http://www.secpulse.com/wp-content/uploads/2017/01/172.png" alt="17" width="740" height="165" /></a></p>
<p style="text-align: center">图 17 结束进程</p>
<h2>5  小结</h2>
<hr />
<p>&nbsp;</p>
<p>此次“影子经纪人”释放的Equation Group中的61个文件，对于全球网络安全研究者分析厘清EQUATION相关攻击平台的组成和架构有很大帮助，而经过打通分析相关曝光信息，我们看到了该攻击平台的更多的信息，如数百个攻击插件以及“DanderSpritz”攻击平台。</p>
<p>通过对相关文件分析后，安天分析小组可以判断其中部分组件与之前卡巴斯基所曝光的GROK组件为同类样本，而这些组件为早期的低版本。另外，我们的分析结果也表明了“DanderSpritz”与Equation Drug使用相同的组件和架构设计，“DanderSpritz”可能就是方程式组织使用的Equation Drug攻击平台。</p>
<p>由于时间仓促，我们目前只披露了部分文件和泄露信息的相关分析成果，后续我们的分析工作还会继续进行下去。</p>
<p>五年前，在<a href="https://www.secpulse.com/?p=55098&amp;preview=true" target="_blank">安天</a>展开针对Flame（火焰）蠕虫的马拉松分析中，有专家曾提醒我们不要“只见树叶，不见森林”，这让我们深刻的反思了传统分析工程师“视野从入口点开始”的局限性，而开始尝试建立起从微观见宏观的分析视野。</p>
<p>对安天来说，这四年以来，对方程式组织的持续跟踪分析，对安天是极为难得的了解最高级别攻击者（即我们所谓A<sup>2</sup>PT，‘高级的APT’）的经历。深入研究这种具有超级成本支撑和先进理念引领的超级攻击者，对于改善安天探海、智甲、追影等高级威胁检测防御产品的防御能力也非常关键。但对于应对A<sup>2</sup>PT攻击者来说，无论是有效改善防御，还是进行更为全面深入系统的分析，都不是一家安全企业能够独立承载的。此中还需要更多协同，更多的接力式分析，而不是反复重复的发明轮子。正是基于这种共同认知，在不久之前第四届安天网络安全冬训营上，安天和360企业安全等安全企业向部分与会专家介绍了能力型安全厂商分析成果互认的部分尝试。只有中国的机构用户和能力型安全厂商形成一个积极互动的体系，才能更好的防御来自各方面的危险。</p>
<p>我们警惕，但并不恐惧，对于一场防御战来说，除了扎实的架构、防御、分析工作之外，必胜的信念是一个前提。</p>
<p>无形者未必无影， 安天追影，画影图形！</p>
<h1>附录一：参考资料</h1>
<hr />
<p>&nbsp;</p>
<p>[1]      <a href="https://www.secpulse.com/?p=55098&amp;preview=true" target="_blank">安天：修改硬盘固件的木马 探索方程式（EQUATION）组织的攻击组件</a></p>
<p><a href="http://www.antiy.com/response/EQUATION_ANTIY_REPORT.html">http://www.antiy.com/response/EQUATION_ANTIY_REPORT.html</a></p>
<p>[2]     <a href="https://www.secpulse.com/?p=55098&amp;preview=true" target="_blank"> 安天：方程式（EQUATION）部分组件中的加密技巧分析</a></p>
<p><a href="http://www.antiy.com/response/Equation_part_of_the_component_analysis_of_cryptographic_techniques.html">http://www.antiy.com/response/Equation_part_of_the_component_analysis_of_cryptographic_techniques.html</a></p>
<p>[3]      <a href="https://www.secpulse.com/?p=55098&amp;preview=true" target="_blank">安天：从“方程式”到“方程组”EQUATION攻击组织高级恶意代码的全平台能力解析</a></p>
<p><a href="http://www.antiy.com/response/EQUATIONS/EQUATIONS.html">http://www.antiy.com/response/EQUATIONS/EQUATIONS.html</a></p>
<p>[4]      THESHADOWBROKERS CLOSED, GOING DARK</p>
<p><a href="https://onlyzero.net/theshadowbrokers.bit/post/messagefinale/">https://onlyzero.net/theshadowbrokers.bit/post/messagefinale/</a></p>
<p>[5]      Stolen NSA "Windows Hacking Tools" Now Up For Sale!</p>
<p><a href="http://thehackernews.com/2017/01/nsa-windows-hacking-tools.html">http://thehackernews.com/2017/01/nsa-windows-hacking-tools.html</a></p>
<p>[6]      Kaspersky：Equation: The Death Star of Malware Galaxy</p>
<p><a href="http://securelist.com/blog/research/68750/equation-the-death-star-of-malware-galaxy/">http://securelist.com/blog/research/68750/equation-the-death-star-of-malware-galaxy/</a></p>
<p>[7]      Kaspersky：Inside the EquationDrug Espionage Platform</p>
<p>https://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/</p>
<p>[8]      Equation Group Cyber Weapons Auction - Invitation</p>
<p><a href="https://github.com/theshadowbrokers/EQGRP-AUCTION">https://github.com/theshadowbrokers/EQGRP-AUCTION</a></p>
<p>[9]      The Equation giveaway</p>
<p><a href="https://securelist.com/blog/incidents/75812/the-equation-giveaway/">https://securelist.com/blog/incidents/75812/the-equation-giveaway/</a></p>
<p>[10]   I just published “TheShadowBrokers Message #3”</p>
<p><a href="https://medium.com/@shadowbrokerss/theshadowbrokers-message-3-af1b181b481">https://medium.com/@shadowbrokerss/theshadowbrokers-message-3-af1b181b481</a></p>
<p>[11]   Shadow Brokers reveals list of Servers Hacked by the NSA</p>
<p><a href="http://thehackernews.com/2016/10/nsa-shadow-brokers-hacking.html">http://thehackernews.com/2016/10/nsa-shadow-brokers-hacking.html</a></p>
<p>[12]   ANTProductData2013</p>
<p>https://search.edwardsnowden.com/docs/ANTProductData2013-12-30nsadocs</p>
<p>[13]   Kaspersky：A Fanny Equation: "I am your father, Stuxnet"</p>
<p><a href="http://securelist.com/blog/research/68787/a-fanny-equation-i-am-your-father-stuxnet/">http://securelist.com/blog/research/68787/a-fanny-equation-i-am-your-father-stuxnet/</a></p>
<p>[14]   Kaspersky：Equation Group: from Houston with love</p>
<p><a href="http://securelist.com/blog/research/68877/equation-group-from-houston-with-love/">http://securelist.com/blog/research/68877/equation-group-from-houston-with-love/</a></p>
<p>[15]   Kaspersky：Equation_group_questions_and_answers</p>
<p><a href="https://securelist.com/files/2015/02/Equation_group_questions_and_answers.pdf">https://securelist.com/files/2015/02/Equation_group_questions_and_answers.pdf</a></p>
<p>[16]   Kaspersky：The Equation giveaway</p>
<p>https://securelist.com/blog/incidents/75812/the-equation-giveaway/</p>
<p>【原文：<a href="http://www.antiy.com/response/EQUATION_DRUG/EQUATION_DRUG.html" target="_blank">方程式组织EQUATION DRUG平台解析(提纲)—方程式组织系列分析报告之四</a>   安全脉搏编辑整理发布】</p>
		<div class="pageShenming">
【安全脉搏：分享技术、悦享品质。文章仅代表作者看法，如有不同观点，欢迎添加安全脉搏微信号：SecPulse，进行交流。】</div>
<div class="post-tags"><span>Tags: </span><a href="https://www.secpulse.com/archives/tag/%e5%bd%b1%e5%ad%90%e7%bb%8f%e7%ba%aa%e4%ba%ba" rel="tag">影子经纪人</a><a href="https://www.secpulse.com/archives/tag/%e6%8f%92%e4%bb%b6" rel="tag">插件</a><a href="https://www.secpulse.com/archives/tag/%E6%B3%84%E9%9C%B2" rel="tag">泄露</a><a href="https://www.secpulse.com/archives/tag/%e7%a1%ac%e7%9b%98%e5%9b%ba%e4%bb%b6" rel="tag">硬盘固件</a></div>
		</div>
	<!-- .single-content -->
		<div class="pageActive">
	<div class="mark-like-btn">
							</div>
	<!-- Baidu Button BEGIN -->
	<div class="bdshare">
		<div class="bdsharebuttonbox">
			<a href="#" class="bds_more" data-cmd="more"></a><a href="#"
				class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#"
				class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#"
				class="bds_weixin" data-cmd="weixin" title="分享到微信"></a>
		</div>
		<script>
		window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"32"},"share":{}};
		with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
		</script>

	</div>
</div>    <section id="text-6" class="widget-container widget_text hidden-xs">			<div class="textwidget"><center><a href="https://www.duoyinsu.com" target="_blank" title="安识科技 专业安全服务商"><img src="https://www.secpulse.com/wp-includes/images/secweixin.png" style="width:785px;height:315px"></a><center></div>
		</section><section id="related_post-2" class="widget-container widget_related_post hidden-xs"><h3 class="widget-title">相关文章</h3>

	<ul class="related_post">
				<li><a href="https://www.secpulse.com/archives/57232.html" title="详细阅读 文件寄生——寻找宿主的不归路(NTFS文件流实际应用)">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=https://www.secpulse.com/wp-content/uploads/2017/03/QQ截图20170331190118.png&h=150&w=249&zc=1" alt="文件寄生——寻找宿主的不归路(NTFS文件流实际应用)" class="xg-img"/>
		<p>文件寄生——寻找宿主的不归路(NTFS文&hellip;</P></a></li>
				<li><a href="https://www.secpulse.com/archives/51120.html" title="详细阅读 美国NSA方程式组织Equation Group被黑,大量黑客工具泄露">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=https://www.secpulse.com/wp-content/uploads/2016/08/NSA.png&h=150&w=249&zc=1" alt="美国NSA方程式组织Equation Group被黑,大量黑客工具泄露" class="xg-img"/>
		<p>美国NSA方程式组织Equation G&hellip;</P></a></li>
				<li><a href="https://www.secpulse.com/archives/32081.html" title="详细阅读 中国移动某邮箱账户泄露导致员工及上千份内部资料泄露（安全意识不当）">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=http://www.secpulse.com/upload/201504/022316083a1b645f8da610a1c62529427e591ec4.png&h=150&w=249&zc=1" alt="中国移动某邮箱账户泄露导致员工及上千份内部资料泄露（安全意识不当）" class="xg-img"/>
		<p>中国移动某邮箱账户泄露导致员工及上千份内&hellip;</P></a></li>
			</ul>


</section></article>


<!-- 引用 -->
<div id="comments" class="comments-area">
	<h2 class="comments-title">
		抢沙发
	</h2>
			<div id="respond" class="comment-respond row">
		


			<form action="https://www.secpulse.com/wp-comments-post.php" method="post" id="commentform">
		
				
						
			<div id="comboxinfo">
					<div class="cominfodiv cominfodiv-author ">
					<p for="author" class="nicheng">
     <input type="text" name="author" id="author" class="texty" value="" tabindex="1" /> <span class="required">昵称*</span>
      </p>
</div>
					<div class="cominfodiv cominfodiv-email">
					<p for="email">	<input type="text" name="email" id="email" class="texty" value="" tabindex="2" /> <span class="required">邮箱*</span>
						</p>
					</div>
					<div class="cominfodiv cominfodiv-url">
					 	<p for="url"><input type="text" name="url" id="url" class="texty" value="" tabindex="3" /><span>网址 </span>
						</p>
					</div>
					
			
				
</div>		       <div class=" cominfodiv-nr">  
<textarea class="texty" name="w" id="comment" rows="10" tabindex="4" placeholder="输入评论内容..."></textarea><textarea name="comment" cols="100%" rows="4" style="display:none"></textarea>
							<div class="submitcom">
							
					<input id="submit" name="submit" type="submit" tabindex="5" value="提&nbsp;交"/>
					<input type='hidden' name='comment_post_ID' value='55098' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="a3d1224ecc" /></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="145"/></p>				</div>
				<div id="cancel_comment_reply"><a rel="nofollow" id="cancel-comment-reply-link" href="/archives/55098.html#respond" style="display:none;">取消回复</a></div>
			
</div>
			
				
			</form>
			
			
			<script type="text/javascript">
				document.getElementById("comment").onkeydown = function (moz_ev){
				var ev = null;
				if (window.event){
				ev = window.event;
				}else{
				ev = moz_ev;
				}
				if (ev != null && ev.ctrlKey && ev.keyCode == 13){
				document.getElementById("submit").click();}
				}
			</script></div>
	 		
</div>
<!-- #comments --></div>
		
<div class="xs-right sidebar xs-hidden xss-hidden">
	<div class="authorbox">
	<div class="author-top">
<div id="author-img">
<img src="https://www.secpulse.com/wp-content/uploads/2017/01/tt1-150x150.jpg" width="96" height="96" alt="yuyang" class="avatar avatar-96 wp-user-avatar wp-user-avatar-96 alignnone photo" />
</div>
<div class="au-name">
<a href="https://www.secpulse.com/archives/author/yuyang" title="由yuyang发布" rel="author">yuyang</a><br>
 <span class="au-title">总共23篇文章</span>
</div> </div>
	<div class="author-word"><span class="quotes q1"></span>
安全脉搏编辑~	<span class="quotes q2"></span></div>
	</div>
	
				<aside id="recent-posts-2" class="widget-container widget_recent_entries">		<div class="si-title"><h2>最新脉搏</h2></div>		<ul>
					<li>
				<a href="https://www.secpulse.com/archives/60653.html">《安天365安全研究》第5期</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60630.html">供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60605.html">2017先知创新大会：有ZHI而来</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60576.html">甲方工作杂谈</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60394.html">Catfish—缓存漏洞&#038;&#038;配合CSRF到Getshell</a>
						</li>
				</ul>
		</aside><aside id="hot_comment-3" class="widget-container widget_hot_comment"><div class="si-title"><h2>脉搏热评</h2></div>
	<ul class="hot_comment_widget">
		
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59497.html" rel="bookmark" title="XSS挑战之旅学习总结 (7条评论)" >XSS挑战之旅学习总结</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59065.html" rel="bookmark" title="web安全之如何全面发现系统后台 (6条评论)" >web安全之如何全面发现系统后台</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59770.html" rel="bookmark" title="电商的支付风控怎么玩？ (3条评论)" >电商的支付风控怎么玩？</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59466.html" rel="bookmark" title="安天移动安全联合猎豹揭秘无形之贼Dosoft免杀病毒 (2条评论)" >安天移动安全联合猎豹揭秘无形之贼Doso&hellip;</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59262.html" rel="bookmark" title="跟着DVWA学Web安全开发 (2条评论)" >跟着DVWA学Web安全开发</a></li>			</ul>

</aside><aside id="random_post-2" class="widget-container widget_random_post"><div class="si-title"><h2>随机脉搏</h2></div>

	<ul class="random_post">
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/19304.html" rel="bookmark" title="详细阅读 拉手网某站敏感信息泄露可造成全站被入侵">拉手网某站敏感信息泄露可造成全站被入侵</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/45173.html" rel="bookmark" title="详细阅读 江泰保险主站重要系统存在SQL注入（涉及/34数据库/百万数据）">江泰保险主站重要系统存在SQL注入（涉及/34数据库/百万数据）</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/29050.html" rel="bookmark" title="详细阅读 OPPO某站SQL注入导致用户信息泄露（手机号邮箱账号密码）">OPPO某站SQL注入导致用户信息泄露（手机号邮箱账号密码）</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/20803.html" rel="bookmark" title="详细阅读 PowerCDN订单遍历及SQL注入">PowerCDN订单遍历及SQL注入</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/43219.html" rel="bookmark" title="详细阅读 96wan游戏平台存漏洞#涉及30万用户信息（身份证#姓名#邮箱等）">96wan游戏平台存漏洞#涉及30万用户信息（身份证#姓名#邮箱等）</a></li>
					</ul>


</aside><aside id="text-11" class="widget-container widget_text"><div class="si-title"><h2>脉搏官方微信公众号</h2></div>			<div class="textwidget"><img src="https://www.secpulse.com/wp-includes/images/SecPulse.png" width="280px" height="364px" /></div>
		</aside>				</div>
	</div>

	</section>

  <div class="inner row visible-lg-block">

	<div class="friends">
		<h3>友情链接</h3>
		<ul>
			<li><a href="https://xianzhi.aliyun.com/forum/?secpulse" target="_blank">先知安全社区</a><span>|</span></li>
			<li><a href="https://threathunter.org/" target="_blank">ThreatHunter社区</a><span>|</span></li>
			<li><a href="http://www.ijiandao.com/" target="_blank">网络尖刀</a><span>|</span></li>
			<li><a href="http://navisec.it/" target="_blank">NaviSec导航</a><span>|</span></li>
		    <li><a href="https://www.easyaq.com/" target="_blank">E安全</a><span>|</span></li>
			<li><a href="http://www.sec-wiki.com/" target="_blank">Sec-Wiki</a><span>|</span></li>
			<li><a href="http://www.waitalone.cn/" target="_blank">独自等待</a><span>|</span></li>
			<li><a href="http://www.shellsec.com/" target="_blank">神刀网</a><span>|</span></li>
			<li><a href="http://www.ineice.com/" target="_blank">爱内测</a><span>|</span></li>
			<li><a href="http://www.itet.cn/" target="_blank">北京ITET培训中心</a><span>|</span></li>
			<li><a href="http://www.ihonker.org/" target="_blank">中国红客联盟</a><span>|</span></li>
			<li><a href="http://www.bigniu.com/" target="_blank">比戈大牛</a><span>|</span></li>
			<li><a href="http://www.tiejiang.org/" target="_blank">铁匠运维网</a><span>|</span></li>
			<li><a href="http://www.nagain.com" target="_blank">娜迦信息</a><span>|</span></li>
			<li><a href="https://www.secsilo.com/" target="_blank">SecSilo</a><span>|</span></li>
			<li><a href="https://team.armyzer0.com" target="_blank">armyzer0</a><span>|</span></li>
			<li><a href="http://www.nosafe.org" target="_blank">NoSafe</a></li>
		</ul>
	</div>

	<div class="friends">
		<h3>合作伙伴</h3>
		<ul>
			<a href="https://www.duoyinsu.com" class="external" target="_blank">
				<img src="https://www.secpulse.com/wp-content/uploads/anshi-logo.png"
				alt="安识科技" width="150px" height="45px">
			</a>
			<a href="http://aq.163.com/module/partner.html" class="external"
				target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/netease.jpg"
				alt="网易安全中心" width="150px" height="45px">
			</a>
			<a href="https://security.alibaba.com/" class="external"
				target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/asrc.jpg"
				alt="阿里安全中心" width="150px" height="45px">
			</a>
			
			<a href="http://yaq.qq.com/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/yaqnew.png" alt="腾讯御安全"
				width="140px" height="45px">
			</a>
			
			<a href="http://www.4hou.com" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/4hou.png"
				alt="嘶吼RoarTalk" width="150px" height="45px">
			</a>
			
			<a href="http://www.ichunqiu.com/?from=secpulse" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/ichunqiu.png" alt="i春秋学院"
				width="140px" height="45px">
			</a>

			<a href="#" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/bigsec.png" alt="bigsec岂安科技"
				width="140px" height="45px">
			</a>
		
			<a href="http://www.milw0rm.cn/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/milw0rm.png"
				alt="Milw0rm Team" width="120px" height="40px">
			</a>


			<a href="#" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/cloversec.png"
				alt="四叶草安全" width="130px" height="45px">
			</a>
			<a href="https://www.aqdog.com" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/aqdog.png"
				alt="安犬云平台" width="140px" height="45px">
			</a>
			
			<a href="http://www.e365.org/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/e365.png"
				alt="易安在线" width="130px" height="45px">
			</a>
			
			
			

		</ul>
	</div>
</div>
<footer class="footer clr" id="footer">
	<div class="inner inner-footer">
		<div class="footer-secpulse">
			<h3>SecPulse</h3>
			<ul>
				<li><a href="/about">关于SecPulse</a></li>
				<!--<li><a href="http://test.secpulse.com">SecPulse专测</a> <sup>NEW!</sup></li>-->
				<li><a href="/hire">加入我们</a></li>
				<li><a href="/report">寻求报道</a></li>
				<li><a href="/contact-us">联系我们</a></li>
			</ul>
		</div>
		<div class="footer-subscribe xs-hidden">
			<h3>订阅</h3>
			<ul>
				<li><a href="/feed">RSS订阅</a></li>
				<li><a href="/feed">邮箱订阅</a></li>
				<li><a href="/feed">线下活动订阅</a></li>
				<li></li>
				<li><a href="http://weibo.com/311057789">官方微博</a></li>
				<!-- <li><a href="https://twitter.com/secpulse">Twitter</a></li> -->
			</ul>
		</div>
		<div class="footer-partner">
			<h3>全力驱动</h3>
			<ul class="cf">
				<li><a href="https://www.secpulse.com" class="external"
					target="_blank"><img
						src="https://www.secpulse.com/wp-content/uploads/seclogo.png"
						alt="安全脉搏" width="200px"></a></li>
			</ul>
		</div>
		<div class="footer-copyright xs-hidden">
			<p>本站由SecPulse安全脉搏团队全力维护。</p>
			<p>
				Powered By <a title="安全脉搏" href="https://www.secpulse.com">SecPulse</a>
			</p>
			<p>©2013-2017 安全脉搏</p>
			<p>沪ICP备16016474号</p>
			<img src="https://www.secpulse.com/wp-includes/images/qrcode.jpg"
				alt="Qrcode" height="150px" width="150px">

		</div>
	</div>
</footer>
<div id="shangxia">
	<div id="shang" title="↑ 返回顶部"></div>
              <div id="comt" title="查看评论"></div>
              <div id="xia" title="↓ 移至底部"></div>
</div>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/plugins/akismet/_inc/form.js?ver=3.1.2'></script>
</body>

</html>
