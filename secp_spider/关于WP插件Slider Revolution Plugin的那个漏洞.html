<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />	
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="renderer" content="webkit">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0">
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<title>关于WP插件Slider Revolution Plugin的那个漏洞 - SecPulse.COM | 安全脉搏</title>
<meta name="description" content="根据老外的报道《WordPress插件 Slider Revolution Plugin 任意文件下载漏洞来袭》" />
<meta name="keywords" content="darkr4y,wp_srp_exp.py,wp_validate_auth_cookie" />

<link rel='stylesheet' id='style-css'  href='https://www.secpulse.com/wp-content/themes/sec/style.css?ver=2014.9.21' type='text/css' media='all' />
<link rel='stylesheet' id='jquery.fancybox-css'  href='https://www.secpulse.com/wp-content/themes/sec/css/jquery.fancybox.css?ver=1.0' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-css'  href='https://www.secpulse.com/wp-content/themes/sec/css/font-awesome.min.css?ver=1.0' type='text/css' media='all' />
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.min.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.fancybox.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/helpers/jquery.fancybox-buttons.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.mousewheel-3.0.6.pack.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/owl.carousel.min.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/custom.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/comments-ajax.js?ver=1.3'></script>
<link rel='canonical' href='https://www.secpulse.com/archives/132.html' />
<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?7f4cc5524dcb1aec487b4266c18bae48";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


</head>
<body class="single single-post postid-132 single-format-standard">
	<header id="header" class="header clr">
		<div class="header-top inner clr">
	<hgroup class="logo-main"><h1 class="logo"><a href="https://www.secpulse.com/" rel="home" title="安全脉搏">安全脉搏</a></h1><h4 class="xs-hidden">分享技术，悦享品质 
	</h4>
	</hgroup>

<div class="login xs-hidden">
				<div class="logindiv">
					<div class="img">
<img src="https://www.secpulse.com/wp-content/uploads/2017/05/rabbit.jpeg" width="36" height="36" alt="" class="avatar avatar-36 wp-user-avatar wp-user-avatar-36 photo avatar-default" /></div><span href="javascript:void(0);" title="用户" class="yh">用户</span><i
						class="fa fa-caret-down fa-2"></i>
					<ul class="login-links">
						<li class="log"><a
							href="https://www.secpulse.com/wp-login.php"
							target="_blank"><i class="fa fa-arrow-right"></i><span>登陆</span></a></li>
						<li class="exit"><a
							href="https://www.secpulse.com/wp-login.php?action=register"><i
								class="fa fa-user-times"></i><span>注册</span></a></li>
					</ul>
	
  </div>
			</div>
			<div class="top-search xs-hidden">
  <form id="search" method="get" action="https://www.secpulse.com" >
	<input type="text" name="s" id="s" autocomplete="off"  placeholder="输入搜索内容">
	<button class="btn-search"> <i class="fa fa-search"></i></button>
</form></div>
			<div class="menu-button">
				<i class="fa fa-bars fa-3x"></i>
			</div>
		</div>


		<div class="main-nav  xs-hidden">
			<div class="inner clr"><nav class="left-nav clr"><ul id="menu-%e5%af%bc%e8%88%aa" class="header-menu-nav"><li id="menu-item-15" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15"><a href="https://www.secpulse.com/">首页</a></li>
<li id="menu-item-17" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-17"><a href="https://www.secpulse.com/archives/category/articles">文章</a>
<ul class="sub-menu">
	<li id="menu-item-34048" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34048"><a href="https://www.secpulse.com/archives/category/articles/intranet-penetration">内网渗透</a></li>
	<li id="menu-item-34047" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34047"><a href="https://www.secpulse.com/archives/category/articles/code-audit">代码审计</a></li>
	<li id="menu-item-34046" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34046"><a href="https://www.secpulse.com/archives/category/articles/web">Web安全</a></li>
	<li id="menu-item-34565" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34565"><a href="https://www.secpulse.com/archives/category/articles/sec-doc">安全文献</a></li>
	<li id="menu-item-34568" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34568"><a href="https://www.secpulse.com/archives/category/articles/social-engineering">社会工程</a></li>
	<li id="menu-item-35948" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35948"><a href="https://www.secpulse.com/archives/category/articles/wireless">无线安全</a></li>
	<li id="menu-item-35949" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35949"><a href="https://www.secpulse.com/archives/category/articles/mobile-security">移动安全</a></li>
	<li id="menu-item-35950" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-35950"><a href="https://www.secpulse.com/archives/category/articles/system">系统安全</a>
	<ul class="sub-menu">
		<li id="menu-item-35951" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35951"><a href="https://www.secpulse.com/archives/category/articles/system/linux">Linux</a></li>
		<li id="menu-item-35952" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35952"><a href="https://www.secpulse.com/archives/category/articles/system/windows">Windows</a></li>
	</ul>
</li>
	<li id="menu-item-35953" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35953"><a href="https://www.secpulse.com/archives/category/articles/reverse-break">逆向破解</a></li>
</ul>
</li>
<li id="menu-item-18" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-18"><a href="https://www.secpulse.com/archives/category/news">资讯</a>
<ul class="sub-menu">
	<li id="menu-item-35956" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35956"><a href="https://www.secpulse.com/archives/category/news/china-news">国内资讯</a></li>
	<li id="menu-item-35957" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35957"><a href="https://www.secpulse.com/archives/category/news/world-news">国外资讯</a></li>
</ul>
</li>
<li id="menu-item-379" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-379"><a href="https://www.secpulse.com/archives/category/construction">安全建设</a>
<ul class="sub-menu">
	<li id="menu-item-51480" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51480"><a href="https://www.secpulse.com/archives/category/construction/securityissue">安全管理</a></li>
	<li id="menu-item-54332" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54332"><a href="https://www.secpulse.com/archives/category/construction/%e4%b8%9a%e5%8a%a1%e5%ae%89%e5%85%a8">业务安全</a></li>
	<li id="menu-item-35955" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35955"><a href="https://www.secpulse.com/archives/category/construction/bigdata">数据分析</a></li>
	<li id="menu-item-54333" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54333"><a href="https://www.secpulse.com/archives/category/construction/security-reports">安全报告</a></li>
</ul>
</li>
<li id="menu-item-368" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-has-children menu-item-368"><a href="https://www.secpulse.com/archives/category/exclusive">独家</a>
<ul class="sub-menu">
	<li id="menu-item-35947" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35947"><a href="https://www.secpulse.com/archives/category/articles/industrial-safety">工控安全</a></li>
	<li id="menu-item-35954" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35954"><a href="https://www.secpulse.com/archives/category/exclusive/ctf-writeup">CTF</a></li>
	<li id="menu-item-50217" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-50217"><a href="https://www.secpulse.com/archives/category/exclusive/duoyinsu">多因素令牌</a></li>
	<li id="menu-item-51479" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51479"><a href="https://www.secpulse.com/archives/category/exclusive/dataleakage">数据泄露</a></li>
</ul>
</li>
<li id="menu-item-16" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-16"><a href="https://www.secpulse.com/archives/category/tools">工具</a></li>
<li id="menu-item-52" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-52"><a href="https://www.secpulse.com/archives/category/hiring">招聘</a></li>
<li id="menu-item-50" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50"><a href="https://www.secpulse.com/newsend">投稿</a></li>
<li id="menu-item-6645" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6645"><a href="https://www.secpulse.com/archives/category/vul">漏洞</a></li>
</ul></nav>  <nav class="right-nav clr "><ul id="menu-%e5%af%bc%e8%88%aa%e4%ba%8c" class="header-menu-nav"><li id="menu-item-33967" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33967"><a title="付费渗透测试" href="http://service.secpulse.com">安全服务</a></li>
<li id="menu-item-52043" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-52043"><a title="安全从业者最实用的安全导航" href="http://nav.secpulse.com">安全导航</a></li>
<li id="menu-item-33966" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33966"><a title="安识科技" href="https://www.duoyinsu.com">多因素</a></li>
</ul></nav></div>
		</div>
		<div class="nav-bg"></div>
   <nav class="mini-nav visible-xs"><ul id="menu-%e5%af%bc%e8%88%aa-1" class="menu-mini-nav"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15"><a href="https://www.secpulse.com/">首页</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-17"><a href="https://www.secpulse.com/archives/category/articles">文章</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34048"><a href="https://www.secpulse.com/archives/category/articles/intranet-penetration">内网渗透</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34047"><a href="https://www.secpulse.com/archives/category/articles/code-audit">代码审计</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34046"><a href="https://www.secpulse.com/archives/category/articles/web">Web安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34565"><a href="https://www.secpulse.com/archives/category/articles/sec-doc">安全文献</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34568"><a href="https://www.secpulse.com/archives/category/articles/social-engineering">社会工程</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35948"><a href="https://www.secpulse.com/archives/category/articles/wireless">无线安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35949"><a href="https://www.secpulse.com/archives/category/articles/mobile-security">移动安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-35950"><a href="https://www.secpulse.com/archives/category/articles/system">系统安全</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35951"><a href="https://www.secpulse.com/archives/category/articles/system/linux">Linux</a></li>
		<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35952"><a href="https://www.secpulse.com/archives/category/articles/system/windows">Windows</a></li>
	</ul>
</li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35953"><a href="https://www.secpulse.com/archives/category/articles/reverse-break">逆向破解</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-18"><a href="https://www.secpulse.com/archives/category/news">资讯</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35956"><a href="https://www.secpulse.com/archives/category/news/china-news">国内资讯</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35957"><a href="https://www.secpulse.com/archives/category/news/world-news">国外资讯</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-379"><a href="https://www.secpulse.com/archives/category/construction">安全建设</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51480"><a href="https://www.secpulse.com/archives/category/construction/securityissue">安全管理</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54332"><a href="https://www.secpulse.com/archives/category/construction/%e4%b8%9a%e5%8a%a1%e5%ae%89%e5%85%a8">业务安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35955"><a href="https://www.secpulse.com/archives/category/construction/bigdata">数据分析</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54333"><a href="https://www.secpulse.com/archives/category/construction/security-reports">安全报告</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-has-children menu-item-368"><a href="https://www.secpulse.com/archives/category/exclusive">独家</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35947"><a href="https://www.secpulse.com/archives/category/articles/industrial-safety">工控安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35954"><a href="https://www.secpulse.com/archives/category/exclusive/ctf-writeup">CTF</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-50217"><a href="https://www.secpulse.com/archives/category/exclusive/duoyinsu">多因素令牌</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51479"><a href="https://www.secpulse.com/archives/category/exclusive/dataleakage">数据泄露</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-16"><a href="https://www.secpulse.com/archives/category/tools">工具</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-52"><a href="https://www.secpulse.com/archives/category/hiring">招聘</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50"><a href="https://www.secpulse.com/newsend">投稿</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6645"><a href="https://www.secpulse.com/archives/category/vul">漏洞</a></li>
</ul></nav>     </header><section class="xs-main index-main clr">
<div class="inner">
<div class="xs-left">
<nav class="crumbs">现在位置： <a title="返回首页" href="https://www.secpulse.com">首页</a> &gt; <a href="https://www.secpulse.com/archives/category/exclusive" rel="category tag">独家</a> &gt;  正文 </nav><article id="post-132" class="post-132 post type-post status-publish format-standard hentry category-exclusive tag-darkr4y tag-wp_srp_exp-py tag-wp_validate_auth_cookie">
	<header class="single-header">
		<h1>关于WP插件Slider Revolution Plugin的那个漏洞</h1>
			<div class="single-meta">
				
		    <div class="time"><i></i> <a href="javascript:void(0);">2014 /9/12 17:15</a></div>
			<div class="eye xs-hidden"><i class="fa fa-eye fa-1"></i><a href="javascript:void(0);">9,091</a> </div>			<div class="comments xs-hidden"><i class="fa fa-comments fa-1"></i><a href="https://www.secpulse.com/archives/132.html#comments">评论 12 条</a></div>
			
			
		</div>
		<!-- .entry-meta -->
	</header>
	<!-- .single-header -->

	<div class="single-main">
		<p style="color: #444444;">根据老外的报道<a href="http://www.secpulse.com/archives/106.html">《WordPress插件 Slider Revolution Plugin 任意文件下载漏洞来袭》</a></p>
<p style="color: #444444;">这个洞在地下黑客论坛已经活跃了很久，不知道老毛子搞黑产是怎么弄的。</p>
<p style="color: #444444;">我比较不赞同的地方是白帽子点到为止，相比之下，黑帽子因为利益的原因会考虑攻击成本及如何进行批量的自动化和可持续性管理。</p>
<p style="color: #444444;">本着研究与探索的精神我想思考下如何将攻击利用自动化。即这个议题是：<span style="color: #339966;"><strong>如何批量自动化的将鸡肋漏洞利用最大化</strong></span></p>
<p style="color: #444444;">poc很简单，之前一个GET请求就可以了，如此可以想到多种用于Web安全测试的工具可以拿来用，不过本着装13的态度，自己用python脚本解决:</p>
<p style="color: #444444;">https://github.com/darkr4y/pentest-script/blob/master/py/wp_srp_exp.py</p>
<p style="color: #444444;">之前研究“大数据”的给了我约2W条的WordPress记录，关于如何正确的收集想需要的数据不在这里的讨论范围。</p>
<p style="color: #444444;">接着该思考的问题来了，光一个任意文件下载似乎是没有直接的伤害，我能想到比较直接的利用方式就是：</p>
<p style="color: #444444;">
<p style="color: #444444;">
<p style="color: #444444; padding-left: 30px;"><span style="color: #339966;">1.利用POC下载wp-config.php</span><br />
<span style="color: #339966;"> 2.测试所处主机的MySQL是否能让用户外连（默认是禁止的，不排除很多虚拟主机套件为了方便会开启或者本来就用的在线远程db）</span><br />
<span style="color: #339966;"> 3.如果可以外连则自动查询管理员用户账户和密码</span><br />
<span style="color: #339966;"> 4.拿到密码之后，可以交由hashcat做简单的字典爆破或者掩码攻击，或者直接提交到哈希的查询接口来查询</span><br />
<span style="color: #339966;"> 5.破除密码之后就简单了，自动登陆利用theme-editor.php或plugin-editor.php来GetShell（部分没权限弹FTP登入提示的可以记录到另外一份Log）中</span></p>
<p style="color: #444444;">但是，测试的大部分记录中，很多都是不让外连的主机，考虑到这种情况占大多数，那么如何进一步利用呢。</p>
<p style="color: #444444;">我们来看看，wp-config.php中除了连接数据库的信息还有哪些是我们想要的，可以发现还有一大堆类似Key的东西。</p>
<p style="color: #444444;">熟悉WP代码一定可以很快知道，这里略过一部分按图索骥的过程，我们直接代码说话:</p>
<p style="color: #444444;">WordPress的Cookies验证部分位于 /wp-include/pluggable.php 中的 wp_validate_auth_cookie 函数</p>
<p style="color: #444444;"><a href="http://www.secpulse.com/wp-content/uploads/2014/09/11.png"><img class="alignnone size-full wp-image-361" src="http://www.secpulse.com/wp-content/uploads/2014/09/11.png" alt="11" width="719" height="297" /></a><br />
这里只贴了核心部分</p>
<blockquote>
<p style="color: #444444;">...<br />
$pass_frag = substr($user-&gt;user_pass, 8, 4);<br />
$key = wp_hash($username . $pass_frag . '|' . $expiration, $scheme);<br />
$hash = hash_hmac('md5', $username . '|' . $expiration, $key);<br />
if ( ! hash_equals( $hash, $hmac ) ) {<br />
...</p>
</blockquote>
<p style="color: #444444;">然后跟进wp_hash函数看一下</p>
<blockquote>
<p style="color: #444444;">function wp_hash($data, $scheme = 'auth') {<br />
$salt = wp_salt($scheme);<br />
return hash_hmac('md5', $data, $salt);<br />
}</p>
</blockquote>
<p style="color: #444444;">哇靠，这里又有一个 wp_hash 函数，跟进看一下</p>
<blockquote><p>if ( !function_exists('wp_salt') ) :<br />
/**<br />
* Get salt to add to hashes.<br />
*<br />
* Salts are created using secret keys. Secret keys are located in two places:<br />
* in the database and in the wp-config.php file. The secret key in the database<br />
* is randomly generated and will be appended to the secret keys in wp-config.php.<br />
*<br />
* The secret keys in wp-config.php should be updated to strong, random keys to maximize<br />
* security. Below is an example of how the secret key constants are defined.<br />
* Do not paste this example directly into wp-config.php. Instead, have a<br />
* {@link https://api.wordpress.org/secret-key/1.1/salt/ secret key created} just<br />
* for you.<br />
*<br />
*<br />
* define('AUTH_KEY', ' XakmM%G4Yt&gt;f`z]MON');<br />
* define('SECURE_AUTH_KEY', 'LzJ}op]mr|6+![P}Ak:uNdJCJZd&gt;(Hx.-Mh#Tz)pCIU#uGEnfFz|f ;;eU%/U^O~');<br />
* define('LOGGED_IN_KEY', '|i|Ux`9 * define('NONCE_KEY', '%:R{[P|,s.KuMltH5}cI;/kz7X&gt;QYR0Z_XnZ@|');<br />
* define('AUTH_SALT', 'eZyT)-Naw]F8CwA*VaW#q*|.)g@o}||wf~@C-YSt}(dh_r6EbI#A,y|nU2{B#JBW');<br />
* define('SECURE_AUTH_SALT', '!=oLUTXh,QW=H `}`L|9/^4-3 STz},T(w}W * define('LOGGED_IN_SALT', '+XSqHc;@Q*K_b|Z?NC[3H!!EONbh.n&lt;+=uKR:&gt;*c(u`g~EJBf#8u#R{mUEZrozmm');<br />
* define('NONCE_SALT', 'h`GXHhD&gt;SLWVfg1(1(N{;.V!MoE(SfbA_ksP@&amp;`+AycHcAV$+?@3q+rxV{%^VyKT');<br />
*<br />
*<br />
* Salting passwords helps against tools which has stored hashed values of<br />
* common dictionary strings. The added values makes it harder to crack.<br />
*<br />
* @since 2.5.0<br />
*<br />
* @link https://api.wordpress.org/secret-key/1.1/salt/ Create secrets for wp-config.php<br />
*<br />
* @param string $scheme Authentication scheme (auth, secure_auth, logged_in, nonce)<br />
* @return string Salt value<br />
*/<br />
function wp_salt( $scheme = 'auth' ) {<br />
static $cached_salts = array();<br />
if ( isset( $cached_salts[ $scheme ] ) ) {<br />
/**<br />
* Filter the WordPress salt.<br />
*<br />
* @since 2.5.0<br />
*<br />
* @param string $cached_salt Cached salt for the given scheme.<br />
* @param string $scheme Authentication scheme. Values include 'auth',<br />
* 'secure_auth', 'logged_in', and 'nonce'.<br />
*/<br />
return apply_filters( 'salt', $cached_salts[ $scheme ], $scheme );<br />
}<br />
static $duplicated_keys;<br />
if ( null === $duplicated_keys ) {<br />
$duplicated_keys = array( 'put your unique phrase here' =&gt; true );<br />
foreach ( array( 'AUTH', 'SECURE_AUTH', 'LOGGED_IN', 'NONCE', 'SECRET' ) as $first ) {<br />
foreach ( array( 'KEY', 'SALT' ) as $second ) {<br />
if ( ! defined( "{$first}_{$second}" ) )<br />
continue;<br />
$value = constant( "{$first}_{$second}" );<br />
$duplicated_keys[ $value ] = isset( $duplicated_keys[ $value ] );<br />
}<br />
}<br />
}</p>
<p>$key = $salt = '';<br />
if ( defined( 'SECRET_KEY' ) &amp;&amp; SECRET_KEY &amp;&amp; empty( $duplicated_keys[ SECRET_KEY ] ) )<br />
$key = SECRET_KEY;<br />
if ( 'auth' == $scheme &amp;&amp; defined( 'SECRET_SALT' ) &amp;&amp; SECRET_SALT &amp;&amp; empty( $duplicated_keys[ SECRET_SALT ] ) )<br />
$salt = SECRET_SALT;</p>
<p>if ( in_array( $scheme, array( 'auth', 'secure_auth', 'logged_in', 'nonce' ) ) ) {<br />
foreach ( array( 'key', 'salt' ) as $type ) {<br />
$const = strtoupper( "{$scheme}_{$type}" );x<br />
if ( defined( $const ) &amp;&amp; constant( $const ) &amp;&amp; empty( $duplicated_keys[ constant( $const ) ] ) ) {<br />
$$type = constant( $const );<br />
} elseif ( ! $$type ) {<br />
$$type = get_site_option( "{$scheme}_{$type}" );<br />
if ( ! $$type ) {<br />
$$type = wp_generate_password( 64, true, true );<br />
update_site_option( "{$scheme}_{$type}", $$type );<br />
}<br />
}<br />
}<br />
} else {<br />
if ( ! $key ) {<br />
$key = get_site_option( 'secret_key' );<br />
if ( ! $key ) {<br />
$key = wp_generate_password( 64, true, true );<br />
update_site_option( 'secret_key', $key );<br />
}<br />
}<br />
$salt = hash_hmac( 'md5', $scheme, $key );<br />
}</p>
<p>$cached_salts[ $scheme ] = $key . $salt;</p>
<p>/** This filter is documented in wp-includes/pluggable.php */<br />
return apply_filters( 'salt', $cached_salts[ $scheme ], $scheme );<br />
}<br />
endif;</p></blockquote>
<p style="color: #444444;">追溯到这里就可以看到$key是如何取得的了，我们再来观察一下登陆前后的Cookies变化 (-_-! 早上一不小心把wp升级了，所以抓到的哈希实际是稍微有改变的，具体是因为wp4.0改了一下验证函数,所以下面的Hash其实是4.0版本的)<br />
登陆后</p>
<pre style="color: #222222;">session	ofg0oUn2JIovSU4xNFDHgd08urnC5jstNYr90c9KvyFLSHIpVV4B72J1s4Bxm3o9
wordpress_149b1e81718ae8239d2e2d3fb2113357	darkray|1410053440|AYaMVIRSO6aBFOHkHIzbSnPEvKUrz1JvS1YzGbI8L8Y|3324fde5766ed949bcab533fc33dc9882f8de2fdc8fc1bbd2d4cafdca9740a06
wordpress_logged_in_149b1e81718ae8239d2e2d3fb2113357	darkray|1410053440|AYaMVIRSO6aBFOHkHIzbSnPEvKUrz1JvS1YzGbI8L8Y|e15b3b8d200b7cd42a26eb90dd37b033b1d0c93833805940d7f0bdd5dfc53878
wordpress_test_cookie	WP+Cookie+check
wp-settings-2	m9=c&amp;m8=c&amp;m6=c&amp;m5=c&amp;m1=c&amp;editor=html&amp;m4=c&amp;m0=c&amp;hidetb=1&amp;m2=c&amp;m3=c&amp;m7=c&amp;m10=c&amp;m11=c&amp;imgsize=full&amp;uploader=1&amp;libraryContent=browse&amp;align=none&amp;urlbutton=post&amp;ed_size=903&amp;mfold=o
wp-settings-time-2	1409208009	
</pre>
<p style="color: #444444;">登陆前</p>
<pre style="color: #222222;">session	ofg0oUn2JIovSU4xNFDHgd08urnC5jstNYr90c9KvyFLSHIpVV4B72J1s4Bxm3o9
wordpress_test_cookie	WP+Cookie+check
wp-settings-2	m9=c&amp;m8=c&amp;m6=c&amp;m5=c&amp;m1=c&amp;editor=html&amp;m4=c&amp;m0=c&amp;hidetb=1&amp;m2=c&amp;m3=c&amp;m7=c&amp;m10=c&amp;m11=c&amp;imgsize=full&amp;uploader=1&amp;libraryContent=browse&amp;align=none&amp;urlbutton=post&amp;ed_size=903&amp;mfold=o
wp-settings-time-2	1409208009
</pre>
<p style="color: #444444;">我们来解析一下登陆后的Cookies<br />
wordpress_149b1e81718ae8239d2e2d3fb2113357=darkray|1410053440|AYaMVIRSO6aBFOHkHIzbSnPEvKUrz1JvS1YzGbI8L8Y|3324fde5766ed949bcab533fc33dc9882f8de2fdc8fc1bbd2d4cafdca9740a06<br />
wordpress是固定关键字，下划线后面的是一串MD5，其是由对应站点来生成的既 149b1e81718ae8239d2e2d3fb2113357 = http://www.blackh4t.org<br />
而在cookies的值中<br />
darkray = 当前登陆的用户名(用户名可以很容易的获取)<br />
一串数字 = cookies的过期时间<br />
而最后一长串就是我们的验证Hash了，也是就是加密算法中 $hash = hash_hmac(‘md5′, $username . ‘|’ . $expiration, $key);<br />
走远了，我们知道$key是和wp-config.php中的一些常量相关的，所以这个$key的值在结合本文所述的漏洞中很任意得到，这样依赖我们要关心的就只是 $pass_frag = substr($user-&gt;user_pass, 8, 4) 的值了。显然在user_pass的取值是大小写加数字,<span style="color: #339966;">所以爆破的次数就是</span><br />
<span style="color: #339966;"> (26 + 26 + 10)^4 = 14776336 约 1.4 kw</span><br />
对于批量和自动化来说这个数字显得太庞大了，并且受限于管理员登陆的时间所以验证成功的概率不是固定的，如果点了注销也就只能白费功夫了。</p>
<p style="color: #444444;"><span style="color: #339966;">但是再定向攻击中，持续的渗透一个目标时不妨可以一试，反正已经自动化，后面的时就是休息等着结果了。</span><br />
很不幸，WordPress升级4.0后又对Cookies的验证函数做了修改，加入了一个新的$token变量，不过偷懒具体的就没有跟进代码了</p>
<blockquote>
<p style="color: #444444;">$pass_frag = substr($user-&gt;user_pass, 8, 4);<br />
$key = wp_hash( $username . '|' . $pass_frag . '|' . $expiration . '|' . $token, $scheme );<br />
$hash = hash_hmac( 'sha256', $username . '|' . $expiration . '|' . $token, $key );</p>
</blockquote>
<p style="color: #444444;">最后po一张漏洞的影响范围，2w条随机的WordPress大概成功获取到700左右的wp-config.php，代码中间有很多容错没有处理，比如HTTPS等，但也不会影响数据太多.<br />
<a href="http://www.secpulse.com/wp-content/uploads/2014/09/2.png"><img class="alignnone size-full wp-image-357" src="http://www.secpulse.com/wp-content/uploads/2014/09/2.png" alt="2" width="1331" height="618" /></a><br />
最后感谢<strong>某不愿意透漏id的同学</strong>的悉心指导！</p>
<p style="color: #444444;">参考：<br />
《WordPress cookie伪造漏洞详细分析及exp》 http://www.91ri.org/8759.html<br />
《WordPress 3.8.2 cookie伪造漏洞再分析》 http://drops.wooyun.org/papers/1409<br />
《WordPress 3.8.2补丁分析 HMAC timing attack》 http://drops.wooyun.org/papers/1404</p>
		<div class="pageShenming">
【安全脉搏：分享技术、悦享品质。文章仅代表作者看法，如有不同观点，欢迎添加安全脉搏微信号：SecPulse，进行交流。】</div>
<div class="post-tags"><span>Tags: </span><a href="https://www.secpulse.com/archives/tag/darkr4y" rel="tag">darkr4y</a><a href="https://www.secpulse.com/archives/tag/wp_srp_exp-py" rel="tag">wp_srp_exp.py</a><a href="https://www.secpulse.com/archives/tag/wp_validate_auth_cookie" rel="tag">wp_validate_auth_cookie</a></div>
		</div>
	<!-- .single-content -->
		<div class="pageActive">
	<div class="mark-like-btn">
							</div>
	<!-- Baidu Button BEGIN -->
	<div class="bdshare">
		<div class="bdsharebuttonbox">
			<a href="#" class="bds_more" data-cmd="more"></a><a href="#"
				class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#"
				class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#"
				class="bds_weixin" data-cmd="weixin" title="分享到微信"></a>
		</div>
		<script>
		window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"32"},"share":{}};
		with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
		</script>

	</div>
</div>    <section id="text-6" class="widget-container widget_text hidden-xs">			<div class="textwidget"><center><a href="https://www.duoyinsu.com" target="_blank" title="安识科技 专业安全服务商"><img src="https://www.secpulse.com/wp-includes/images/secweixin.png" style="width:785px;height:315px"></a><center></div>
		</section><section id="related_post-2" class="widget-container widget_related_post hidden-xs"><h3 class="widget-title">相关文章</h3>

	<ul class="related_post">
				<li><a href="https://www.secpulse.com/archives/60244.html" title="详细阅读 2017 ISG 管理运维赛 官方Writeup">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=https://www.secpulse.com/wp-content/uploads/2017/09/ISG.jpg&h=150&w=249&zc=1" alt="2017 ISG 管理运维赛 官方Writeup" class="xg-img"/>
		<p>2017 ISG 管理运维赛 官方Wri</P></a></li>
				<li><a href="https://www.secpulse.com/archives/58537.html" title="详细阅读 SecPulse“脉搏涌动”第二届安全技术交流沙龙">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=https://www.secpulse.com/wp-content/uploads/2017/06/m.png&h=150&w=249&zc=1" alt="SecPulse“脉搏涌动”第二届安全技术交流沙龙" class="xg-img"/>
		<p>SecPulse“脉搏涌动”第二届安全技</P></a></li>
				<li><a href="https://www.secpulse.com/archives/58354.html" title="详细阅读 2017第三届SSCTF全国网络安全大赛圆满结束">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=https://www.secpulse.com/wp-content/uploads/2017/05/SSCTF.jpg&h=150&w=249&zc=1" alt="2017第三届SSCTF全国网络安全大赛圆满结束" class="xg-img"/>
		<p>2017第三届SSCTF全国网络安全大赛</P></a></li>
			</ul>


</section></article>


<!-- 引用 -->
<div id="comments" class="comments-area">
		<h2 class="comments-title">
		10条评论
	</h2>
<!-- 显示正在加载新评论 -->
 <div id="loading-comments"><span>评论加载中，请稍等...</span></div>
	<ul class="commentlist">
			
	<li class="comment byuser comment-author-songpen even thread-even depth-1" id="comment-15">
	<div class="comment-author"><img src="https://www.secpulse.com/wp-content/uploads/2014/09/desc.jpg" width="40" height="40" alt="上头欢乐送" class="avatar avatar-40 wp-user-avatar wp-user-avatar-40 alignnone photo" /></div>
			<div id="div-comment-15" class="commenttext">
		<div class="commentmeta">
		
		<!--<cite class="fn">上头欢乐送</cite> <span class="says">:</span>-->
		<span class="commentid">上头欢乐送</span>
		<span class="comment-meta commentmetadata">
			<a href="https://www.secpulse.com/archives/132.html#comment-15"></a>
			<span class="commenttime">
				2014年09月12日 下午5:27											
				</span>
			</span>
			<span class="reply">&nbsp;<a class='comment-reply-link' href='/archives/132.html?replytocom=15#respond' onclick='return addComment.moveForm( "comment-15", "15", "respond", "132" )' aria-label='回复给上头欢乐送'>回复</a></span>
		</span>
	</div>
	<div class="commentp"><p>批量的话 最后爆破的确没必要了 定向的话可以试试 主要是不能连mysql后的突破 思路不错！</p>
</div>
			</div>
	</li><!-- #comment-## -->
	
	<li class="comment byuser comment-author-sp_editor odd alt thread-odd thread-alt depth-1" id="comment-16">
	<div class="comment-author"><img src="https://www.secpulse.com/wp-content/uploads/2017/01/spediator-150x150.jpg" width="40" height="40" alt="SP小编" class="avatar avatar-40 wp-user-avatar wp-user-avatar-40 alignnone photo" /></div>
			<div id="div-comment-16" class="commenttext">
		<div class="commentmeta">
		
		<!--<cite class="fn">SP小编</cite> <span class="says">:</span>-->
		<span class="commentid">SP小编</span>
		<span class="comment-meta commentmetadata">
			<a href="https://www.secpulse.com/archives/132.html#comment-16"></a>
			<span class="commenttime">
				2014年09月12日 下午5:35											
				</span>
			</span>
			<span class="reply">&nbsp;<a class='comment-reply-link' href='/archives/132.html?replytocom=16#respond' onclick='return addComment.moveForm( "comment-16", "16", "respond", "132" )' aria-label='回复给SP小编'>回复</a></span>
		</span>
	</div>
	<div class="commentp"><p>果然是年薪几十万的大牛</p>
</div>
			</div>
	</li><!-- #comment-## -->
	
	<li class="comment byuser comment-author-masterlcx-cc even thread-even depth-1" id="comment-17">
	<div class="comment-author"><img src="https://www.secpulse.com/wp-content/uploads/2015/01/9zhou-150x150.jpg" width="40" height="40" alt="Master" class="avatar avatar-40 wp-user-avatar wp-user-avatar-40 alignnone photo" /></div>
			<div id="div-comment-17" class="commenttext">
		<div class="commentmeta">
		
		<!--<cite class="fn">Master</cite> <span class="says">:</span>-->
		<span class="commentid">Master</span>
		<span class="comment-meta commentmetadata">
			<a href="https://www.secpulse.com/archives/132.html#comment-17"></a>
			<span class="commenttime">
				2014年09月12日 下午5:38											
				</span>
			</span>
			<span class="reply">&nbsp;<a class='comment-reply-link' href='/archives/132.html?replytocom=17#respond' onclick='return addComment.moveForm( "comment-17", "17", "respond", "132" )' aria-label='回复给Master'>回复</a></span>
		</span>
	</div>
	<div class="commentp"><p>果然是年薪几十万的大牛</p>
</div>
			</div>
	</li><!-- #comment-## -->
	
	<li class="comment byuser comment-author-install13 odd alt thread-odd thread-alt depth-1" id="comment-18">
	<div class="comment-author"><img src="https://www.secpulse.com/wp-content/uploads/2014/09/1500FB6A-B56C-4C51-BE88-2A4A376F332D-150x150.jpg" width="40" height="40" alt="装逼哥" class="avatar avatar-40 wp-user-avatar wp-user-avatar-40 alignnone photo" /></div>
			<div id="div-comment-18" class="commenttext">
		<div class="commentmeta">
		
		<!--<cite class="fn">装逼哥</cite> <span class="says">:</span>-->
		<span class="commentid">装逼哥</span>
		<span class="comment-meta commentmetadata">
			<a href="https://www.secpulse.com/archives/132.html#comment-18"></a>
			<span class="commenttime">
				2014年09月12日 下午5:39											
				</span>
			</span>
			<span class="reply">&nbsp;<a class='comment-reply-link' href='/archives/132.html?replytocom=18#respond' onclick='return addComment.moveForm( "comment-18", "18", "respond", "132" )' aria-label='回复给装逼哥'>回复</a></span>
		</span>
	</div>
	<div class="commentp"><p>果然是年薪几十万的大牛</p>
</div>
			</div>
	</li><!-- #comment-## -->
	
	<li class="comment byuser comment-author-secpulse even thread-even depth-1 parent" id="comment-19">
	<div class="comment-author"><img src="https://www.secpulse.com/wp-content/uploads/2015/03/avatar_522_b-150x150.jpg" width="40" height="40" alt="secpulse" class="avatar avatar-40 wp-user-avatar wp-user-avatar-40 alignnone photo" /></div>
			<div id="div-comment-19" class="commenttext">
		<div class="commentmeta">
		
		<!--<cite class="fn">secpulse</cite> <span class="says">:</span>-->
		<span class="commentid">secpulse</span>
		<span class="comment-meta commentmetadata">
			<a href="https://www.secpulse.com/archives/132.html#comment-19"></a>
			<span class="commenttime">
				2014年09月12日 下午5:42											
				</span>
			</span>
			<span class="reply">&nbsp;<a class='comment-reply-link' href='/archives/132.html?replytocom=19#respond' onclick='return addComment.moveForm( "comment-19", "19", "respond", "132" )' aria-label='回复给secpulse'>回复</a></span>
		</span>
	</div>
	<div class="commentp"><p>果然是年薪几十万的大牛</p>
</div>
			</div>
	<ul class="children">
	
	<li class="comment odd alt depth-2" id="comment-21">
	<div class="comment-author"><img src="https://www.secpulse.com/wp-content/uploads/2017/05/rabbit.jpeg" width="40" height="40" alt="" class="avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo avatar-default" /></div>
			<div id="div-comment-21" class="commenttext">
		<div class="commentmeta">
		
		<!--<cite class="fn">h3len</cite> <span class="says">:</span>-->
		<span class="commentid">h3len</span>
		<span class="comment-meta commentmetadata">
			<a href="https://www.secpulse.com/archives/132.html#comment-21"></a>
			<span class="commenttime">
				2014年09月12日 下午5:46											
				</span>
			</span>
			<span class="reply">&nbsp;<a class='comment-reply-link' href='/archives/132.html?replytocom=21#respond' onclick='return addComment.moveForm( "comment-21", "21", "respond", "132" )' aria-label='回复给h3len'>回复</a></span>
		</span>
	</div>
	<div class="commentp"><p>@<a href="#comment-19">secpulse</a> 果然是年薪几十万的大牛</p>
</div>
			</div>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	
	<li class="comment even thread-odd thread-alt depth-1" id="comment-20">
	<div class="comment-author"><img src="https://www.secpulse.com/wp-content/uploads/2017/05/rabbit.jpeg" width="40" height="40" alt="" class="avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo avatar-default" /></div>
			<div id="div-comment-20" class="commenttext">
		<div class="commentmeta">
		
		<!--<cite class="fn">土豪</cite> <span class="says">:</span>-->
		<span class="commentid">土豪</span>
		<span class="comment-meta commentmetadata">
			<a href="https://www.secpulse.com/archives/132.html#comment-20"></a>
			<span class="commenttime">
				2014年09月12日 下午5:43											
				</span>
			</span>
			<span class="reply">&nbsp;<a class='comment-reply-link' href='/archives/132.html?replytocom=20#respond' onclick='return addComment.moveForm( "comment-20", "20", "respond", "132" )' aria-label='回复给土豪'>回复</a></span>
		</span>
	</div>
	<div class="commentp"><p>果然是年薪几十万的大牛</p>
</div>
			</div>
	</li><!-- #comment-## -->
	
	<li class="comment odd alt thread-even depth-1 parent" id="comment-23">
	<div class="comment-author"><img src="https://www.secpulse.com/wp-content/uploads/2017/05/rabbit.jpeg" width="40" height="40" alt="" class="avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo avatar-default" /></div>
			<div id="div-comment-23" class="commenttext">
		<div class="commentmeta">
		
		<!--<cite class="fn">fuckray</cite> <span class="says">:</span>-->
		<span class="commentid">fuckray</span>
		<span class="comment-meta commentmetadata">
			<a href="https://www.secpulse.com/archives/132.html#comment-23"></a>
			<span class="commenttime">
				2014年09月12日 下午7:16											
				</span>
			</span>
			<span class="reply">&nbsp;<a class='comment-reply-link' href='/archives/132.html?replytocom=23#respond' onclick='return addComment.moveForm( "comment-23", "23", "respond", "132" )' aria-label='回复给fuckray'>回复</a></span>
		</span>
	</div>
	<div class="commentp"><p>****，中间有笔误</p>
</div>
			</div>
	<ul class="children">
	
	<li class="comment byuser comment-author-sp_editor even depth-2" id="comment-26">
	<div class="comment-author"><img src="https://www.secpulse.com/wp-content/uploads/2017/01/spediator-150x150.jpg" width="40" height="40" alt="SP小编" class="avatar avatar-40 wp-user-avatar wp-user-avatar-40 alignnone photo" /></div>
			<div id="div-comment-26" class="commenttext">
		<div class="commentmeta">
		
		<!--<cite class="fn">SP小编</cite> <span class="says">:</span>-->
		<span class="commentid">SP小编</span>
		<span class="comment-meta commentmetadata">
			<a href="https://www.secpulse.com/archives/132.html#comment-26"></a>
			<span class="commenttime">
				2014年09月12日 下午8:45											
				</span>
			</span>
			<span class="reply">&nbsp;<a class='comment-reply-link' href='/archives/132.html?replytocom=26#respond' onclick='return addComment.moveForm( "comment-26", "26", "respond", "132" )' aria-label='回复给SP小编'>回复</a></span>
		</span>
	</div>
	<div class="commentp"><p>@<a href="#comment-23">fuckray</a> 少年 你消消火 小编我立马找了2遍更正了一些笔误 的确很抱歉</p>
</div>
			</div>
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	
	<li class="comment byuser comment-author-secpulse odd alt thread-odd thread-alt depth-1" id="comment-25">
	<div class="comment-author"><img src="https://www.secpulse.com/wp-content/uploads/2015/03/avatar_522_b-150x150.jpg" width="40" height="40" alt="secpulse" class="avatar avatar-40 wp-user-avatar wp-user-avatar-40 alignnone photo" /></div>
			<div id="div-comment-25" class="commenttext">
		<div class="commentmeta">
		
		<!--<cite class="fn">secpulse</cite> <span class="says">:</span>-->
		<span class="commentid">secpulse</span>
		<span class="comment-meta commentmetadata">
			<a href="https://www.secpulse.com/archives/132.html#comment-25"></a>
			<span class="commenttime">
				2014年09月12日 下午8:29											
				</span>
			</span>
			<span class="reply">&nbsp;<a class='comment-reply-link' href='/archives/132.html?replytocom=25#respond' onclick='return addComment.moveForm( "comment-25", "25", "respond", "132" )' aria-label='回复给secpulse'>回复</a></span>
		</span>
	</div>
	<div class="commentp"><p>步骤3和4好像没必要吧 直接有数据库了可以直接添加用户 hastcat破解浪费时间而且破wp的效果应该不好 @Darkray</p>
</div>
			</div>
	</li><!-- #comment-## -->
	
	<li class="comment byuser comment-author-ca3tie4 even thread-even depth-1" id="comment-29">
	<div class="comment-author"><img src="https://www.secpulse.com/wp-content/uploads/2014/09/d73a932a992c8ce5c79bfc767ba26760.jpeg" width="40" height="40" alt="Ca3tie4" class="avatar avatar-40 wp-user-avatar wp-user-avatar-40 alignnone photo" /></div>
			<div id="div-comment-29" class="commenttext">
		<div class="commentmeta">
		
		<!--<cite class="fn">Ca3tie4</cite> <span class="says">:</span>-->
		<span class="commentid">Ca3tie4</span>
		<span class="comment-meta commentmetadata">
			<a href="https://www.secpulse.com/archives/132.html#comment-29"></a>
			<span class="commenttime">
				2014年09月13日 下午3:29											
				</span>
			</span>
			<span class="reply">&nbsp;<a class='comment-reply-link' href='/archives/132.html?replytocom=29#respond' onclick='return addComment.moveForm( "comment-29", "29", "respond", "132" )' aria-label='回复给Ca3tie4'>回复</a></span>
		</span>
	</div>
	<div class="commentp"><p>果然是年薪几十万的大牛</p>
</div>
			</div>
	</li><!-- #comment-## -->
	
	<li class="comment byuser comment-author-sp_editor odd alt thread-odd thread-alt depth-1" id="comment-39">
	<div class="comment-author"><img src="https://www.secpulse.com/wp-content/uploads/2017/01/spediator-150x150.jpg" width="40" height="40" alt="SP小编" class="avatar avatar-40 wp-user-avatar wp-user-avatar-40 alignnone photo" /></div>
			<div id="div-comment-39" class="commenttext">
		<div class="commentmeta">
		
		<!--<cite class="fn">SP小编</cite> <span class="says">:</span>-->
		<span class="commentid">SP小编</span>
		<span class="comment-meta commentmetadata">
			<a href="https://www.secpulse.com/archives/132.html#comment-39"></a>
			<span class="commenttime">
				2014年09月19日 上午9:31											
				</span>
			</span>
			<span class="reply">&nbsp;<a class='comment-reply-link' href='/archives/132.html?replytocom=39#respond' onclick='return addComment.moveForm( "comment-39", "39", "respond", "132" )' aria-label='回复给SP小编'>回复</a></span>
		</span>
	</div>
	<div class="commentp"><p><a href="http://blog.spiderlabs.com/2014/09/leveraging-lfi-to-get-full-compromise-on-wordpress-sites.html" rel="nofollow">http://blog.spiderlabs.com/2014/09/leveraging-lfi-to-get-full-compromise-on-wordpress-sites.html</a>  老外晚了好多天</p>
</div>
			</div>
	</li><!-- #comment-## -->
	</ul><!-- .comment-list -->

			<div id="respond" class="comment-respond row">
		


			<form action="https://www.secpulse.com/wp-comments-post.php" method="post" id="commentform">
		
				
						
			<div id="comboxinfo">
					<div class="cominfodiv cominfodiv-author ">
					<p for="author" class="nicheng">
     <input type="text" name="author" id="author" class="texty" value="" tabindex="1" /> <span class="required">昵称*</span>
      </p>
</div>
					<div class="cominfodiv cominfodiv-email">
					<p for="email">	<input type="text" name="email" id="email" class="texty" value="" tabindex="2" /> <span class="required">邮箱*</span>
						</p>
					</div>
					<div class="cominfodiv cominfodiv-url">
					 	<p for="url"><input type="text" name="url" id="url" class="texty" value="" tabindex="3" /><span>网址 </span>
						</p>
					</div>
					
			
				
</div>		       <div class=" cominfodiv-nr">  
<textarea class="texty" name="w" id="comment" rows="10" tabindex="4" placeholder="输入评论内容..."></textarea><textarea name="comment" cols="100%" rows="4" style="display:none"></textarea>
							<div class="submitcom">
							
					<input id="submit" name="submit" type="submit" tabindex="5" value="提&nbsp;交"/>
					<input type='hidden' name='comment_post_ID' value='132' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="dc615b6220" /></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="198"/></p>				</div>
				<div id="cancel_comment_reply"><a rel="nofollow" id="cancel-comment-reply-link" href="/archives/132.html#respond" style="display:none;">取消回复</a></div>
			
</div>
			
				
			</form>
			
			
			<script type="text/javascript">
				document.getElementById("comment").onkeydown = function (moz_ev){
				var ev = null;
				if (window.event){
				ev = window.event;
				}else{
				ev = moz_ev;
				}
				if (ev != null && ev.ctrlKey && ev.keyCode == 13){
				document.getElementById("submit").click();}
				}
			</script></div>
	 		
</div>
<!-- #comments --></div>
		
<div class="xs-right sidebar xs-hidden xss-hidden">
	<div class="authorbox">
	<div class="author-top">
<div id="author-img">
<img src="https://www.secpulse.com/wp-content/uploads/2014/09/4407382-150x150.jpg" width="96" height="96" alt="DarkRay" class="avatar avatar-96 wp-user-avatar wp-user-avatar-96 alignnone photo" />
</div>
<div class="au-name">
<a href="https://www.secpulse.com/archives/author/darkray" title="由DarkRay发布" rel="author">DarkRay</a><br>
 <span class="au-title">总共3篇文章</span>
</div> </div>
	<div class="author-word"><span class="quotes q1"></span>
	<span class="quotes q2"></span></div>
	</div>
	
				<aside id="recent-posts-2" class="widget-container widget_recent_entries">		<div class="si-title"><h2>最新脉搏</h2></div>		<ul>
					<li>
				<a href="https://www.secpulse.com/archives/60653.html">《安天365安全研究》第5期</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60630.html">供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60605.html">2017先知创新大会：有ZHI而来</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60576.html">甲方工作杂谈</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60394.html">Catfish—缓存漏洞&#038;&#038;配合CSRF到Getshell</a>
						</li>
				</ul>
		</aside><aside id="hot_comment-3" class="widget-container widget_hot_comment"><div class="si-title"><h2>脉搏热评</h2></div>
	<ul class="hot_comment_widget">
		
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59497.html" rel="bookmark" title="XSS挑战之旅学习总结 (7条评论)" >XSS挑战之旅学习总结</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59065.html" rel="bookmark" title="web安全之如何全面发现系统后台 (6条评论)" >web安全之如何全面发现系统后台</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59770.html" rel="bookmark" title="电商的支付风控怎么玩？ (3条评论)" >电商的支付风控怎么玩？</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59466.html" rel="bookmark" title="安天移动安全联合猎豹揭秘无形之贼Dosoft免杀病毒 (2条评论)" >安天移动安全联合猎豹揭秘无形之贼Doso&hellip;</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59262.html" rel="bookmark" title="跟着DVWA学Web安全开发 (2条评论)" >跟着DVWA学Web安全开发</a></li>			</ul>

</aside><aside id="random_post-2" class="widget-container widget_random_post"><div class="si-title"><h2>随机脉搏</h2></div>

	<ul class="random_post">
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/21174.html" rel="bookmark" title="详细阅读 边锋网络某弱口令+敏感信息泄露">边锋网络某弱口令+敏感信息泄露</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/42923.html" rel="bookmark" title="详细阅读 新网互联内网漫游泄漏大量政府与企业用户信息">新网互联内网漫游泄漏大量政府与企业用户信息</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/27454.html" rel="bookmark" title="详细阅读 国泰君安研究管理系统超级管理员弱口令导致任意数据库操作">国泰君安研究管理系统超级管理员弱口令导致任意数据库操作</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/9230.html" rel="bookmark" title="详细阅读 百度联盟官网 sql注射">百度联盟官网 sql注射</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/32671.html" rel="bookmark" title="详细阅读 妈妈网某系统未授权访问(root权限)">妈妈网某系统未授权访问(root权限)</a></li>
					</ul>


</aside><aside id="text-11" class="widget-container widget_text"><div class="si-title"><h2>脉搏官方微信公众号</h2></div>			<div class="textwidget"><img src="https://www.secpulse.com/wp-includes/images/SecPulse.png" width="280px" height="364px" /></div>
		</aside>				</div>
	</div>

	</section>

  <div class="inner row visible-lg-block">

	<div class="friends">
		<h3>友情链接</h3>
		<ul>
			<li><a href="https://xianzhi.aliyun.com/forum/?secpulse" target="_blank">先知安全社区</a><span>|</span></li>
			<li><a href="https://threathunter.org/" target="_blank">ThreatHunter社区</a><span>|</span></li>
			<li><a href="http://www.ijiandao.com/" target="_blank">网络尖刀</a><span>|</span></li>
			<li><a href="http://navisec.it/" target="_blank">NaviSec导航</a><span>|</span></li>
		    <li><a href="https://www.easyaq.com/" target="_blank">E安全</a><span>|</span></li>
			<li><a href="http://www.sec-wiki.com/" target="_blank">Sec-Wiki</a><span>|</span></li>
			<li><a href="http://www.waitalone.cn/" target="_blank">独自等待</a><span>|</span></li>
			<li><a href="http://www.shellsec.com/" target="_blank">神刀网</a><span>|</span></li>
			<li><a href="http://www.ineice.com/" target="_blank">爱内测</a><span>|</span></li>
			<li><a href="http://www.itet.cn/" target="_blank">北京ITET培训中心</a><span>|</span></li>
			<li><a href="http://www.ihonker.org/" target="_blank">中国红客联盟</a><span>|</span></li>
			<li><a href="http://www.bigniu.com/" target="_blank">比戈大牛</a><span>|</span></li>
			<li><a href="http://www.tiejiang.org/" target="_blank">铁匠运维网</a><span>|</span></li>
			<li><a href="http://www.nagain.com" target="_blank">娜迦信息</a><span>|</span></li>
			<li><a href="https://www.secsilo.com/" target="_blank">SecSilo</a><span>|</span></li>
			<li><a href="https://team.armyzer0.com" target="_blank">armyzer0</a><span>|</span></li>
			<li><a href="http://www.nosafe.org" target="_blank">NoSafe</a></li>
		</ul>
	</div>

	<div class="friends">
		<h3>合作伙伴</h3>
		<ul>
			<a href="https://www.duoyinsu.com" class="external" target="_blank">
				<img src="https://www.secpulse.com/wp-content/uploads/anshi-logo.png"
				alt="安识科技" width="150px" height="45px">
			</a>
			<a href="http://aq.163.com/module/partner.html" class="external"
				target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/netease.jpg"
				alt="网易安全中心" width="150px" height="45px">
			</a>
			<a href="https://security.alibaba.com/" class="external"
				target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/asrc.jpg"
				alt="阿里安全中心" width="150px" height="45px">
			</a>
			
			<a href="http://yaq.qq.com/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/yaqnew.png" alt="腾讯御安全"
				width="140px" height="45px">
			</a>
			
			<a href="http://www.4hou.com" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/4hou.png"
				alt="嘶吼RoarTalk" width="150px" height="45px">
			</a>
			
			<a href="http://www.ichunqiu.com/?from=secpulse" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/ichunqiu.png" alt="i春秋学院"
				width="140px" height="45px">
			</a>

			<a href="#" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/bigsec.png" alt="bigsec岂安科技"
				width="140px" height="45px">
			</a>
		
			<a href="http://www.milw0rm.cn/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/milw0rm.png"
				alt="Milw0rm Team" width="120px" height="40px">
			</a>


			<a href="#" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/cloversec.png"
				alt="四叶草安全" width="130px" height="45px">
			</a>
			<a href="https://www.aqdog.com" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/aqdog.png"
				alt="安犬云平台" width="140px" height="45px">
			</a>
			
			<a href="http://www.e365.org/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/e365.png"
				alt="易安在线" width="130px" height="45px">
			</a>
			
			
			

		</ul>
	</div>
</div>
<footer class="footer clr" id="footer">
	<div class="inner inner-footer">
		<div class="footer-secpulse">
			<h3>SecPulse</h3>
			<ul>
				<li><a href="/about">关于SecPulse</a></li>
				<!--<li><a href="http://test.secpulse.com">SecPulse专测</a> <sup>NEW!</sup></li>-->
				<li><a href="/hire">加入我们</a></li>
				<li><a href="/report">寻求报道</a></li>
				<li><a href="/contact-us">联系我们</a></li>
			</ul>
		</div>
		<div class="footer-subscribe xs-hidden">
			<h3>订阅</h3>
			<ul>
				<li><a href="/feed">RSS订阅</a></li>
				<li><a href="/feed">邮箱订阅</a></li>
				<li><a href="/feed">线下活动订阅</a></li>
				<li></li>
				<li><a href="http://weibo.com/311057789">官方微博</a></li>
				<!-- <li><a href="https://twitter.com/secpulse">Twitter</a></li> -->
			</ul>
		</div>
		<div class="footer-partner">
			<h3>全力驱动</h3>
			<ul class="cf">
				<li><a href="https://www.secpulse.com" class="external"
					target="_blank"><img
						src="https://www.secpulse.com/wp-content/uploads/seclogo.png"
						alt="安全脉搏" width="200px"></a></li>
			</ul>
		</div>
		<div class="footer-copyright xs-hidden">
			<p>本站由SecPulse安全脉搏团队全力维护。</p>
			<p>
				Powered By <a title="安全脉搏" href="https://www.secpulse.com">SecPulse</a>
			</p>
			<p>©2013-2017 安全脉搏</p>
			<p>沪ICP备16016474号</p>
			<img src="https://www.secpulse.com/wp-includes/images/qrcode.jpg"
				alt="Qrcode" height="150px" width="150px">

		</div>
	</div>
</footer>
<div id="shangxia">
	<div id="shang" title="↑ 返回顶部"></div>
              <div id="comt" title="查看评论"></div>
              <div id="xia" title="↓ 移至底部"></div>
</div>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/plugins/akismet/_inc/form.js?ver=3.1.2'></script>
</body>

</html>
