<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />	
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="renderer" content="webkit">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0">
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<title>百度旗下网站暗藏恶意代码——劫持用户电脑疯狂“收割”流量 - SecPulse.COM | 安全脉搏</title>
<meta name="description" content="本分析报告pdf版本下载：http://t.cn/RitHJky" />
<meta name="keywords" content="bime.dll,explorer.exe,HSoftDoloEx,LcScience.sys,nvMultitask,nvMultitask.exe,Rogue/NetReaper,云控劫持,劫持导航,劫持概率,恶意代码,服务器,流量劫持,流量收割者,火绒专杀工具,病毒" />

<link rel='stylesheet' id='style-css'  href='https://www.secpulse.com/wp-content/themes/sec/style.css?ver=2014.9.21' type='text/css' media='all' />
<link rel='stylesheet' id='jquery.fancybox-css'  href='https://www.secpulse.com/wp-content/themes/sec/css/jquery.fancybox.css?ver=1.0' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-css'  href='https://www.secpulse.com/wp-content/themes/sec/css/font-awesome.min.css?ver=1.0' type='text/css' media='all' />
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.min.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.fancybox.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/helpers/jquery.fancybox-buttons.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.mousewheel-3.0.6.pack.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/owl.carousel.min.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/custom.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/comments-ajax.js?ver=1.3'></script>
<link rel='canonical' href='https://www.secpulse.com/archives/56182.html' />
<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?7f4cc5524dcb1aec487b4266c18bae48";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


</head>
<body class="single single-post postid-56182 single-format-standard">
	<header id="header" class="header clr">
		<div class="header-top inner clr">
	<hgroup class="logo-main"><h1 class="logo"><a href="https://www.secpulse.com/" rel="home" title="安全脉搏">安全脉搏</a></h1><h4 class="xs-hidden">分享技术，悦享品质 
	</h4>
	</hgroup>

<div class="login xs-hidden">
				<div class="logindiv">
					<div class="img">
<img src="https://www.secpulse.com/wp-content/uploads/2017/05/rabbit.jpeg" width="36" height="36" alt="" class="avatar avatar-36 wp-user-avatar wp-user-avatar-36 photo avatar-default" /></div><span href="javascript:void(0);" title="用户" class="yh">用户</span><i
						class="fa fa-caret-down fa-2"></i>
					<ul class="login-links">
						<li class="log"><a
							href="https://www.secpulse.com/wp-login.php"
							target="_blank"><i class="fa fa-arrow-right"></i><span>登陆</span></a></li>
						<li class="exit"><a
							href="https://www.secpulse.com/wp-login.php?action=register"><i
								class="fa fa-user-times"></i><span>注册</span></a></li>
					</ul>
	
  </div>
			</div>
			<div class="top-search xs-hidden">
  <form id="search" method="get" action="https://www.secpulse.com" >
	<input type="text" name="s" id="s" autocomplete="off"  placeholder="输入搜索内容">
	<button class="btn-search"> <i class="fa fa-search"></i></button>
</form></div>
			<div class="menu-button">
				<i class="fa fa-bars fa-3x"></i>
			</div>
		</div>


		<div class="main-nav  xs-hidden">
			<div class="inner clr"><nav class="left-nav clr"><ul id="menu-%e5%af%bc%e8%88%aa" class="header-menu-nav"><li id="menu-item-15" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15"><a href="https://www.secpulse.com/">首页</a></li>
<li id="menu-item-17" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-17"><a href="https://www.secpulse.com/archives/category/articles">文章</a>
<ul class="sub-menu">
	<li id="menu-item-34048" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34048"><a href="https://www.secpulse.com/archives/category/articles/intranet-penetration">内网渗透</a></li>
	<li id="menu-item-34047" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34047"><a href="https://www.secpulse.com/archives/category/articles/code-audit">代码审计</a></li>
	<li id="menu-item-34046" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34046"><a href="https://www.secpulse.com/archives/category/articles/web">Web安全</a></li>
	<li id="menu-item-34565" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34565"><a href="https://www.secpulse.com/archives/category/articles/sec-doc">安全文献</a></li>
	<li id="menu-item-34568" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34568"><a href="https://www.secpulse.com/archives/category/articles/social-engineering">社会工程</a></li>
	<li id="menu-item-35948" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35948"><a href="https://www.secpulse.com/archives/category/articles/wireless">无线安全</a></li>
	<li id="menu-item-35949" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35949"><a href="https://www.secpulse.com/archives/category/articles/mobile-security">移动安全</a></li>
	<li id="menu-item-35950" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-35950"><a href="https://www.secpulse.com/archives/category/articles/system">系统安全</a>
	<ul class="sub-menu">
		<li id="menu-item-35951" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35951"><a href="https://www.secpulse.com/archives/category/articles/system/linux">Linux</a></li>
		<li id="menu-item-35952" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35952"><a href="https://www.secpulse.com/archives/category/articles/system/windows">Windows</a></li>
	</ul>
</li>
	<li id="menu-item-35953" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35953"><a href="https://www.secpulse.com/archives/category/articles/reverse-break">逆向破解</a></li>
</ul>
</li>
<li id="menu-item-18" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-18"><a href="https://www.secpulse.com/archives/category/news">资讯</a>
<ul class="sub-menu">
	<li id="menu-item-35956" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35956"><a href="https://www.secpulse.com/archives/category/news/china-news">国内资讯</a></li>
	<li id="menu-item-35957" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35957"><a href="https://www.secpulse.com/archives/category/news/world-news">国外资讯</a></li>
</ul>
</li>
<li id="menu-item-379" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-has-children menu-item-379"><a href="https://www.secpulse.com/archives/category/construction">安全建设</a>
<ul class="sub-menu">
	<li id="menu-item-51480" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51480"><a href="https://www.secpulse.com/archives/category/construction/securityissue">安全管理</a></li>
	<li id="menu-item-54332" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54332"><a href="https://www.secpulse.com/archives/category/construction/%e4%b8%9a%e5%8a%a1%e5%ae%89%e5%85%a8">业务安全</a></li>
	<li id="menu-item-35955" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35955"><a href="https://www.secpulse.com/archives/category/construction/bigdata">数据分析</a></li>
	<li id="menu-item-54333" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-54333"><a href="https://www.secpulse.com/archives/category/construction/security-reports">安全报告</a></li>
</ul>
</li>
<li id="menu-item-368" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-368"><a href="https://www.secpulse.com/archives/category/exclusive">独家</a>
<ul class="sub-menu">
	<li id="menu-item-35947" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35947"><a href="https://www.secpulse.com/archives/category/articles/industrial-safety">工控安全</a></li>
	<li id="menu-item-35954" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35954"><a href="https://www.secpulse.com/archives/category/exclusive/ctf-writeup">CTF</a></li>
	<li id="menu-item-50217" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-50217"><a href="https://www.secpulse.com/archives/category/exclusive/duoyinsu">多因素令牌</a></li>
	<li id="menu-item-51479" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51479"><a href="https://www.secpulse.com/archives/category/exclusive/dataleakage">数据泄露</a></li>
</ul>
</li>
<li id="menu-item-16" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-16"><a href="https://www.secpulse.com/archives/category/tools">工具</a></li>
<li id="menu-item-52" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-52"><a href="https://www.secpulse.com/archives/category/hiring">招聘</a></li>
<li id="menu-item-50" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50"><a href="https://www.secpulse.com/newsend">投稿</a></li>
<li id="menu-item-6645" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6645"><a href="https://www.secpulse.com/archives/category/vul">漏洞</a></li>
</ul></nav>  <nav class="right-nav clr "><ul id="menu-%e5%af%bc%e8%88%aa%e4%ba%8c" class="header-menu-nav"><li id="menu-item-33967" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33967"><a title="付费渗透测试" href="http://service.secpulse.com">安全服务</a></li>
<li id="menu-item-52043" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-52043"><a title="安全从业者最实用的安全导航" href="http://nav.secpulse.com">安全导航</a></li>
<li id="menu-item-33966" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33966"><a title="安识科技" href="https://www.duoyinsu.com">多因素</a></li>
</ul></nav></div>
		</div>
		<div class="nav-bg"></div>
   <nav class="mini-nav visible-xs"><ul id="menu-%e5%af%bc%e8%88%aa-1" class="menu-mini-nav"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15"><a href="https://www.secpulse.com/">首页</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-17"><a href="https://www.secpulse.com/archives/category/articles">文章</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34048"><a href="https://www.secpulse.com/archives/category/articles/intranet-penetration">内网渗透</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34047"><a href="https://www.secpulse.com/archives/category/articles/code-audit">代码审计</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34046"><a href="https://www.secpulse.com/archives/category/articles/web">Web安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34565"><a href="https://www.secpulse.com/archives/category/articles/sec-doc">安全文献</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34568"><a href="https://www.secpulse.com/archives/category/articles/social-engineering">社会工程</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35948"><a href="https://www.secpulse.com/archives/category/articles/wireless">无线安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35949"><a href="https://www.secpulse.com/archives/category/articles/mobile-security">移动安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-35950"><a href="https://www.secpulse.com/archives/category/articles/system">系统安全</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35951"><a href="https://www.secpulse.com/archives/category/articles/system/linux">Linux</a></li>
		<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35952"><a href="https://www.secpulse.com/archives/category/articles/system/windows">Windows</a></li>
	</ul>
</li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35953"><a href="https://www.secpulse.com/archives/category/articles/reverse-break">逆向破解</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-18"><a href="https://www.secpulse.com/archives/category/news">资讯</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35956"><a href="https://www.secpulse.com/archives/category/news/china-news">国内资讯</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35957"><a href="https://www.secpulse.com/archives/category/news/world-news">国外资讯</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-has-children menu-item-379"><a href="https://www.secpulse.com/archives/category/construction">安全建设</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51480"><a href="https://www.secpulse.com/archives/category/construction/securityissue">安全管理</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54332"><a href="https://www.secpulse.com/archives/category/construction/%e4%b8%9a%e5%8a%a1%e5%ae%89%e5%85%a8">业务安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35955"><a href="https://www.secpulse.com/archives/category/construction/bigdata">数据分析</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-54333"><a href="https://www.secpulse.com/archives/category/construction/security-reports">安全报告</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-368"><a href="https://www.secpulse.com/archives/category/exclusive">独家</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35947"><a href="https://www.secpulse.com/archives/category/articles/industrial-safety">工控安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35954"><a href="https://www.secpulse.com/archives/category/exclusive/ctf-writeup">CTF</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-50217"><a href="https://www.secpulse.com/archives/category/exclusive/duoyinsu">多因素令牌</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51479"><a href="https://www.secpulse.com/archives/category/exclusive/dataleakage">数据泄露</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-16"><a href="https://www.secpulse.com/archives/category/tools">工具</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-52"><a href="https://www.secpulse.com/archives/category/hiring">招聘</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50"><a href="https://www.secpulse.com/newsend">投稿</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6645"><a href="https://www.secpulse.com/archives/category/vul">漏洞</a></li>
</ul></nav>     </header><section class="xs-main index-main clr">
<div class="inner">
<div class="xs-left">
<nav class="crumbs">现在位置： <a title="返回首页" href="https://www.secpulse.com">首页</a> &gt; <a href="https://www.secpulse.com/archives/category/construction">安全建设</a> &gt; <a href="https://www.secpulse.com/archives/category/construction/security-reports" rel="category tag">安全报告</a> &gt;  正文 </nav><article id="post-56182" class="post-56182 post type-post status-publish format-standard has-post-thumbnail hentry category-security-reports tag-bime-dll tag-explorer-exe tag-hsoftdoloex tag-lcscience-sys tag-nvmultitask tag-nvmultitask-exe tag-roguenetreaper tag-63575 tag-63582 tag-63585 tag-63583 tag-63542 tag-62563 tag-63576 tag-63578 tag-122">
	<header class="single-header">
		<h1>百度旗下网站暗藏恶意代码——劫持用户电脑疯狂“收割”流量</h1>
			<div class="single-meta">
				
		    <div class="time"><i></i> <a href="javascript:void(0);">2017 /3/1 12:37</a></div>
			<div class="eye xs-hidden"><i class="fa fa-eye fa-1"></i><a href="javascript:void(0);">6,315</a> </div>			<div class="comments xs-hidden"><i class="fa fa-comments fa-1"></i><a href="https://www.secpulse.com/archives/56182.html#comments">评论 1 条</a></div>
			
			
		</div>
		<!-- .entry-meta -->
	</header>
	<!-- .single-header -->

	<div class="single-main">
		<p><em>本分析报告pdf版本下载：</em><a href="http://t.cn/RitHJky" target="_blank">http://t.cn/RitHJky</a></p>
<h2><strong>一、概述</strong></h2>
<blockquote><p>经火绒安全实验室截获、分析、追踪并验证，当用户从百度旗下的<a href="http://www.skycn.net/" target="_blank">http://www.skycn.net/</a>和 <a href="http://soft.hao123.com/" target="_blank">http://soft.hao123.com/</a>这两个网站下载任何软件时，都会被植入恶意代码。该恶意代码进入电脑后，会通过加载驱动等各种手段防止被卸载，进而长期潜伏，并随时可以被“云端”远程操控，用来<a href="https://www.secpulse.com/archives/tag/劫持导航" target="_blank">劫持导航</a>站、电商网站、广告联盟等各种流量。</p></blockquote>
<blockquote><p>火绒实验室近期接到数名电脑浏览器被劫持的用户求助，在分析被感染电脑时，提取到多个和流量劫持相关的可疑文件：HSoftDoloEx.exe 、bime.dll 、MsVwmlbkgn.sys、LcScience.sys、WaNdFilter.sys，这些可疑文件均包含百度签名。</p></blockquote>
<blockquote><p><span style="color: #ff6600;">这些包含恶意代码的可疑文件，被定位到一个名叫nvMultitask.exe的释放器上，当用户在<a style="color: #ff6600;" href="http://www.skycn.net/" target="_blank">http://www.skycn.net/</a>和<a style="color: #ff6600;" href="http://soft.hao123.com/" target="_blank">http://soft.hao123.com/</a>这两个下载站下载任何软件时，都会被捆绑下载该释放器，进而向用户电脑植入这些可疑文件。需要强调的是，下载器运行后会立即在后台静默释放和执行释放器nvMultitask.exe，植入恶意代码，即使用户不做任何操作直接关闭下载器，恶意代码也会被植入。</span></p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2017/03/Roge.png"><img class="alignnone size-full wp-image-56306" src="http://www.secpulse.com/wp-content/uploads/2017/03/Roge.png" alt="Roge" width="813" height="614" /></a></p></blockquote>
<blockquote><p>根据分析和溯源，最迟到2016年9月，这些<a href="https://www.secpulse.com/archives/tag/恶意代码" target="_blank">恶意代码</a>即被制作完成。而操纵流量劫持的“远程开关”于近期被开启，被感染的电脑会被按照区域和时段等条件，或者是随机地被“选择”出来，进行流量劫持——安全业界称之为“<a href="https://www.secpulse.com/archives/tag/云控劫持" target="_blank">云控劫持</a>”。</p></blockquote>
<p>&nbsp;</p>
<div align="center"></div>
<p><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_1.png"><img class=" wp-image-56184 size-full aligncenter" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_1.png" alt="image_1" width="510" height="258" /></a></p>
<div align="center">图 1、下载器向用户计算机植入恶意代码</div>
<p>&nbsp;</p>
<blockquote><p>被植入的恶意代码没有正常的用户卸载功能，也没有常规启动项，电脑每次开机时都会启动和更新恶意代码，恶意代码接收C&amp;C服务器指令，行为受云端控制，并且会通过加载驱动，保护相关的注册表和文件不被删除。</p></blockquote>
<blockquote><p>因此，这些植入恶意代码的用户电脑成为长期被远程控制的“肉鸡”。</p></blockquote>
<blockquote><p>该恶意代码被远程启动后，会劫持各种互联网流量，用户的浏览器、首页、导航站都会被劫持，将流量输送给hao123导航站。同时，还会篡改电商网站、网站联盟广告等链接，用以获取这些网站的流量收入分成（详情在本报告第二章）。</p></blockquote>
<blockquote><p>综上所述，该恶意代码本身以及通过下载器植入用户电脑的行为，同时符合安全行业通行的若干个恶意代码定义标准，<span style="color: #008000;">因此，火绒将这一恶意代码家族命名为“Rogue/NetReaper”（中文名：流量收割者）</span>。升级到“火绒安全软件”最新版本，即可全面查杀、清除该类恶意代码。</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/图2.png"><img class=" wp-image-56185 size-full aligncenter" src="http://www.secpulse.com/wp-content/uploads/2017/02/图2.png" alt="图2" width="800" height="515" /></a></div>
<div align="center">图2、火绒安全软件检测结果</div>
<blockquote><p>火绒安全软件4.0下载地址：<br />
<a href="http://www.huorong.cn/downv4.html" target="_blank">http://www.huorong.cn/downv4.html</a></p></blockquote>
<blockquote><p>火绒专杀工具下载地址：</p>
<p><a href="http://huorong.cn/download/tools/hrkill-v1.0.0.10.exe" target="_blank">http://huorong.cn/download/tools/hrkill-v1.0.0.10.exe</a></p></blockquote>
<h2><strong>二、主要劫持行为描述</strong></h2>
<blockquote><p>用户在这两个下载站下载软件后，电脑即被植入“Rogue/NetReaper”恶意代码，在长期的潜伏期过程中，电脑可能发生如下<a href="https://www.secpulse.com/archives/tag/流量劫持" target="_blank">流量劫持</a>情况（按地域和时间等因素云控劫持，或者随机劫持）：</p></blockquote>
<blockquote><p>1.导航站劫持：当用户访问其他导航站时，会被劫持到百度hao123导航站。</p>
<p>包括360、QQ、2345、搜狗、猎豹、114la、瑞星……等导航站都会被劫持，劫持后的hao123网址带有百度联盟的推广计费名。</p></blockquote>
<div align="center"></div>
<div align="center"></div>
<div align="center"></div>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_3.png"><img class="alignnone wp-image-56186 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_3.png" alt="image_3" width="569" height="169" /></a></div>
<p>&nbsp;</p>
<p style="text-align: center;">图3、常见导航站被直接为hao123</p>
<blockquote><p>2.首页劫持：把用户电脑首页修改为hao123导航站。<br />
使用IE浏览器的用户，其首页被修改为hao123导航站，并通过百度联盟计费名统计流量。</p></blockquote>
<blockquote><p>3.浏览器劫持：360浏览器替换成IE浏览器或者假IE浏览器。<br />
当发现用户使用360安全浏览器或360极速浏览器时，默认浏览器被修改为IE浏览器，或者修改为假IE浏览器，以躲避安全软件的浏览器保护。无论 怎样，被替换后首页都会变成hao123导航站，并通过百度联盟计费名统计流量。</p></blockquote>
<blockquote><p>4.网盟广告劫持：将百度网盟其他渠道计费名换成渠道商猎豹（金山毒霸）。</p></blockquote>
<blockquote><p>百度网盟有许多渠道商，这些渠道商都将流量售卖给百度网盟，这个劫持行为是将其他渠道商的推广计费名换成金山的，这样的话，本来应该属于其他渠道的百度网盟推广费用，就被猎豹获得，猎豹再向恶意代码制作者分钱。</p></blockquote>
<p>&nbsp;</p>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_4.png"><img class="alignnone wp-image-56187 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_4.png" alt="image_4" width="571" height="149" /></a></div>
<p>&nbsp;</p>
<div align="center">图 4、替换百度网盟广告</div>
<blockquote><p>5.电商流量劫持：使用IE浏览器访问京东等电商网站时，先跳转到电商导流网站站，然后再跳转回该电商网站。</p></blockquote>
<blockquote><p>先跳转到电商导流网站妖猴网（<a href="http://www.xmonkey.com/" target="_blank">http://www.xmonkey.com</a>），再返回原购物网站之后，电商网站链接就加上了妖猴网的计费名，电商网站就会按照流量向妖猴网支付推广费用，妖猴网再向恶意代码制作者分钱。</p></blockquote>
<p>&nbsp;</p>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_5.png"><img class="alignnone wp-image-56188 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_5.png" alt="image_5" width="561" height="771" /></a></div>
<p>&nbsp;</p>
<div align="center">图 5、访问电商网站时会跳转到电商导流网站</div>
<p>&nbsp;</p>
<h2><strong>三、概要分析</strong></h2>
<blockquote><p>执行任意从<a href="http://soft.hao123.com/" target="_blank">http://soft.hao123.com</a>下载到的下载器，不需要进行任何操作，恶意代码就会植入用户计算机。使用火绒剑可以监控植入恶意代码的整个过程，如下图：</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_6.png"><img class="alignnone wp-image-56189 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_6.png" alt="image_6" width="701" height="1078" /></a></div>
<p>&nbsp;</p>
<div align="center">图 6、恶意代码首次植入用户计算机流程</div>
<blockquote><p>恶意代码首次植入用户计算机流程：</p></blockquote>
<blockquote><p>1.下载器执行释放的nvMultitask.exe。目前下载器包含的nvMultitask.exe是0.2.0.1版本，该版本仅会在用户计算机上植入部分恶意代码，如下：</p>
<div style="padding-left: 30px;" align="left">       a)        3.2.0.1版的HSoftDoloEx.exe</div>
<div style="padding-left: 30px;" align="left">       b)        1.7.0.1版的bime.dll</div>
<div style="padding-left: 30px;" align="left">       c)        0.4.0.130 版的LcScience.sys</div>
<div style="padding-left: 30px;" align="left">       d)        0.5.30.70 版的WaNdFilter.sys</div>
<p style="padding-left: 30px;">      e)        1.0.0.1020版的npjuziplugin.dll</p>
</blockquote>
<blockquote><p>2.植入恶意代码成功后nvMultitask.exe使用命令行参数“-inject=install”执行HSoftDoloEx.exe</p></blockquote>
<p>&nbsp;</p>
<blockquote><p>3.启动的HSoftDoloEx.exe链接C&amp;C服务器(<a href="http://update.123juzi.net/update.php" target="_blank">http://update.123juzi.net/update.php</a>)进行更新，更新的恶意组件将在下次计算机启动后被激活</p>
<p>每次计算机重启，恶意代码都会启动和检查更新：</p></blockquote>
<blockquote><p>经过几次更新之后，<a href="https://www.secpulse.com/archives/tag/nvMultitask.exe" target="_blank">nvMultitask.exe</a>的会升级到当前最新版本3.2.0.4，后续分析将会以这个版本展开。</p></blockquote>
<p>&nbsp;</p>
<blockquote><p>最新版本的恶意组件在用户每次开机后都会执行以下流程：</p></blockquote>
<blockquote><p>1.LcScience.sys注册进程和映像加载回调将bime.dll分别注入services.exe、explorer.exe、iexplore.exe和其他第三方浏览器进程。</p></blockquote>
<blockquote><p>2.注入services.exe中的bime.dll负责启动HSoftDoloEx.exe</p>
<p style="padding-left: 30px;">1)HSoftDoloEx.exe链接C&amp;C服务器(<a href="http://update.123juzi.net/update.php" target="_blank">http://update.123juzi.net/update.php</a>)检测更新。<br />
2)HSoftDoloEx.exe链接C&amp;C服务器(<a href="http://update.qyllq.com/getupfs2.php" target="_blank">http://update.qyllq.com/getupfs2.php</a>)，获取流量劫持指令。（后续章节进行详细分析）</p>
</blockquote>
<blockquote><p>3.注入explorer.exe中的bime.dll负责在执行5分钟后链接C&amp;C服务器(<a href="http://update.123juzi.net/ccl.php" target="_blank">http://update.123juzi.net/ccl.php</a>)下载并加载恶意代码svcprotect.dat到explorer.exe。</p></blockquote>
<blockquote><p>4.svcprotect.dat（1.0.0.11）加载后释放两个全新的流量劫持模块：</p>
<p style="padding-left: 30px;">1)5.0.0.1版的iexplorer_helper.dat</p>
<p style="padding-left: 30px;">2)1.5.9.1098版的iexplore.exe</p>
</blockquote>
<p>&nbsp;</p>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_7.png"><img class="alignnone wp-image-56190 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_7.png" alt="image_7" width="702" height="516" /></a></div>
<p>&nbsp;</p>
<p style="text-align: center;">图 7、恶意代码植入用户计算机流程</p>
<blockquote><p>1.5.9.1098版的iexplore.exe是一个伪装系统名称的假IE浏览器，我们把这个文件上传到VirusTotal后发现，很多安全软件检测此文件是<a href="https://www.secpulse.com/archives/tag/病毒" target="_blank">病毒</a>，如图：</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_8.png"><img class="alignnone wp-image-56191 size-large" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_8-785x1024.png" alt="image_8" width="785" height="1024" /></a></div>
<p>&nbsp;</p>
<p style="text-align: center;">图 8、Virustotal检测的结果</p>
<p>&nbsp;</p>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_9.png"><img class="alignnone wp-image-56192 size-large" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_9-1024x550.png" alt="image_9" width="1024" height="550" /></a></div>
<p>&nbsp;</p>
<div align="center">图 9、恶意代码包含百度签名</div>
<p>&nbsp;</p>
<blockquote><p>&nbsp;</p>
<p>最终在用户计算机中所有包含恶意代码的文件如下：</p></blockquote>
<p>&nbsp;</p>
<div align="center">
<table class="t_table" cellspacing="0">
<tbody>
<tr>
<td width="331">
<div align="right">
<div align="center">安装目录</div>
</div>
</td>
<td width="218">
<div align="right">
<div align="center">安装文件</div>
</div>
</td>
</tr>
<tr>
<td width="331">
<div align="left">
<div align="left">%HOMEPATH%  \AppData\Roaming\HSoftDoloEx</div>
</div>
</td>
<td width="218">
<div align="left">
<div align="left">x86、x64</div>
<div align="left">HSoftDoloEx.exe（3.2.0.4）</div>
<div align="left">x86</div>
<div align="left">bime.dll（1.7.0.5）</div>
<div align="left">x64</div>
<div align="left">bime64.dll（1.7.0.5）</div>
</div>
</td>
</tr>
<tr>
<td width="331">
<div align="left">
<div align="left">%Drivers%</div>
</div>
</td>
<td width="218">
<div align="left">
<div align="left">x86</div>
<div align="left">LcScience.sys（0.4.0.130）</div>
<div align="left">WaNdFilter.sys（0.5.30.70）</div>
<div align="left">MsVwmlbkgn.sys（0.6.60.70）</div>
<div align="left">x64</div>
<div align="left">LcScience64.sys（0.4.0.130）</div>
<div align="left">WaNdFilter64.sys（0.5.30.70）</div>
<div align="left">MsVwmlbkgn64.sys（0.6.60.70）</div>
</div>
</td>
</tr>
<tr>
<td width="331">
<div align="left">
<div align="left">%HOMEPATH%\AppData\Local\Internet  Explorer</div>
</div>
</td>
<td width="218">
<div align="left">
<div align="left">x86、x64</div>
<div align="left">iexplorer_helper.dat（5.0.0.1）</div>
</div>
</td>
</tr>
<tr>
<td width="331">
<div align="left">
<div align="left">%HOMEPATH%\AppData\Local\ProgramData</div>
</div>
</td>
<td width="218">
<div align="left">
<div align="left">x86</div>
<div align="left">svcprotect_32_1.0.0.11.dat（1.0.0.11）</div>
<div align="left">x64</div>
<div align="left">svcprotect_64_1.0.0.11.dat（1.0.0.11）</div>
</div>
</td>
</tr>
<tr>
<td width="331">
<div align="left">
<div align="left">%HOMEPATH%\AppData\Roaming\{E233850D-5D6E-48E3-98B5-8049F7E9FC68}</div>
</div>
</td>
<td width="218">
<div align="left">
<div align="left">x86、x64</div>
<div align="left">iexplore.exe（1.5.9.1098）</div>
</div>
</td>
</tr>
<tr>
<td width="331">
<div align="left">
<div align="left">%HOMEPATH%  \AppData\LocalLow\JuziPlugin\1.0.0.1020</div>
</div>
</td>
<td width="218">
<div align="left">
<div align="left">x86、x64</div>
<div align="left">npjuziplugin.dll（1.0.0.1020）</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<h2><strong>四、详细分析</strong></h2>
<h3>1.        启动、保护和更新模块分析</h3>
<h4>1.1        启动</h4>
<blockquote><p>恶意代码有两个重要的启动模块HSoftDoloEx.exe和bime.dll。这两个文件是整组恶意代码的关键项，驱动文件LcScience.sys负责每次开机启动它们。</p>
<p>LcScience.sys（0.4.0.130）注册映像加载通知，排队一个工作例程，如下图：</p></blockquote>
<p>&nbsp;</p>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_10.png"><img class="alignnone wp-image-56193 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_10.png" alt="image_10" width="698" height="410" /></a></div>
<p>&nbsp;</p>
<div align="center">图 10、排队注入例程</div>
<blockquote><p>该工作例程会判断启动进程是否需要注入，完整的注入列表如下：</p></blockquote>
<div align="center">
<table class="t_table" cellspacing="0">
<tbody>
<tr>
<td>
<div align="right">
<div align="left">Services.exe、Explorer.exe、Iexplorer.exe、360se.exe、Maxthon.exe、</div>
<div align="left">iexplore.exe、liebao.exe、2345Explorer.exe、QQBrowser.exe、360chrome.exe和sogouexplorer.exe</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<blockquote><p>如果满足注入条件，就会注入bime.dll（1.7.0.5）到指定进程。LcScience.sys实现了两种注入方式：一种通过patch系统动态库ntdll.dll的入口将动态库bime.dll注入到制定进程；另一种则是通过patch系统动态库ntdll.dll的NtTestAlert函数实现注入bime.dll到指定进程，相关代码如下图：</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_11.png"><img class="alignnone wp-image-56194 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_11.png" alt="image_11" width="554" height="181" /></a></div>
<p>&nbsp;</p>
<div align="center">图 11、选择注入方式</div>
<blockquote><p>bime.dll（1.7.0.5）注入到services.exe、explorer.exe、iexplorer.exe和其他浏览器进程后，会根据宿主进程名称不同，会执行不一样的流程。</p></blockquote>
<blockquote><p>注入到services.exe系统进程bime.dll，在系统开机运行services.exe后，以"-inject=start"参数执行HSoftDoloEx.exe。在explorer.exe中的<a href="https://www.secpulse.com/archives/tag/bime.dll" target="_blank">bime.dll</a>（1.7.0.5）也会随着“桌面”程序的启动，一同被激活。bime.dll还会随着用户启动的浏览器一并启动，如下图：</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_12.png"><img class="alignnone wp-image-56195 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_12.png" alt="image_12" width="706" height="253" /></a></div>
<p>&nbsp;</p>
<div align="center">图 12、恶意代码启动流程图</div>
<h4>1.2        保护</h4>
<blockquote><p>WaNdFilter.sys（0.5.30.70）同LcScience.sys（0.4.0.130）都使用了注册表回调保护自己的注册表启动项不被删除，除此以外WaNdFilter.sys（0.5.30.70）还有两个保护点，如下图所示：</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_13.png"><img class="alignnone wp-image-56196 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_13.png" alt="image_13" width="711" height="806" /></a></div>
<p>&nbsp;</p>
<div align="center">图 13、文件保护逻辑</div>
<blockquote><p>图中标明file_needs_protect_1 函数负责保护“WaNdFilter.sys”、“LcScience.sys”和“MsVwmlbkgn.sys”这几个文件不被删除，标明file_needs_protect_2 函数会阻止特定进程不能访问恶意代码指定的文件列表。<br />
WaNdFilter.sys阻止的特定进程如下表：</p></blockquote>
<div align="center">
<table class="t_table" cellspacing="0">
<tbody>
<tr>
<td width="412">
<div align="right">
<div align="left">NSoftMgr.exe、360Tray.exe、360Safe.exe、360DeskAna.exe、</div>
<div align="left">QQPCSoftCmd.exe、QMAutoClean.exe、QQPCMgr.exe、QQPCSoftMgr.exe、QQPCRTP.exe</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<blockquote><p>恶意代码指定的文件列表的在我们的实验环境中并未得到。</p></blockquote>
<h4>1.3        更新</h4>
<blockquote><p>不同版本nvMultitask.exe释放的恶意代码在功能上存在差异。本文分析的是当前最新版本3.2.0.4。每次计算机重启恶意代码都会执行更新，升级到最新版本需要经过以下流程。</p></blockquote>
<blockquote><p>1）开机后执行HSoftDoloEx.exe，HSoftDoloEx.exe会向服务器<a href="http://update.123juzi.net/update.php" target="_blank">http://update.123juzi.net/update.php</a>发送升级请求，每次请求返回的都不是最新版本，一般来说从下载器自带的0.2.0.1版本需要至少重启三次计算机 ，才可以更新到3.2.0.4版本。</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_14.png"><img class="alignnone wp-image-56197 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_14.png" alt="image_14" width="700" height="220" /></a></div>
<p>&nbsp;</p>
<div align="center">图 14、恶意代码释放器升级流程</div>
<blockquote><p>2）除了HSoftDoloEx.exe会向服务器发送请求更新以外，3.2.0.4版的nvMultitask.exe中包含的1.7.0.5版的bime.dll ，会在注入系统进程Explorer.exe之后，也会向服务器<a href="http://update.123juzi.net/ccl.php" target="_blank">http://update.123juzi.net/ccl.php</a>发送请求。</p></blockquote>
<blockquote><p>3）请求得到的数据是一段Base64编码后的字符串，解码后可以得到win_32_1.0.0.11.dat的下载地址后开始下载。这是一个新出现的恶意代码</p></blockquote>
<blockquote><p>4）win_32_1.0.0.11.dat是加密的32位版本的svcprotect.dat（1.0.0.11）。</p></blockquote>
<p>&nbsp;</p>
<blockquote><p>5）bime.dll解密后调用svcprotect.dat名为“Run”的导出函数，释放恶意代码“iexplorer_helper.dat” （5.0.0.1）</p></blockquote>
<p>&nbsp;</p>
<blockquote><p>6）svcprotect.dat还会检查当前系统中是否存在“C:\ProgramData\userdata\data.dat”这个文件，如果不存在或者该文件最后写入时间距今相差30天以上，svcprotect.dat就会在“%HOMEPATH%\AppData\Roaming\{E233850D-5D6E-48E3-98B5-8049F7E9FC68}”目录中释放假iexplore.exe（1.5.9.1098）。“C:\ProgramData\userdata\data.dat”是一个0字节文件，会在svcprotect.dat第一次释放iexplore.exe后被svcprotect.dat创建。<br />
svcprotect.dat释放的文件都包含在它的PE资源中，如图：</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_15.png"><img class="alignnone wp-image-56198 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_15.png" alt="image_15" width="436" height="582" /></a></div>
<p>&nbsp;</p>
<div align="center">图 15、svcprotect.dat中包含的二进制资源</div>
<blockquote><p>FILE_0068_0804对应iexplore.exe（1.5.9.1098），FILE_0069_0804对应iexplorer_helper.dat（5.0.0.1）。至此所有恶意代码已经全部植入用户计算机了。</p></blockquote>
<p>&nbsp;</p>
<blockquote><p>如果升级服务器不返回请求数据（此处由云端控制），也可以在安装了nvMultitask.exe 0.2.0.1版本计算机上，直接运行nvMultitask_3.2.0.4.exe的安装包（MD5: 4bf77866e8a851a2fa7d4088b85be126），同样会更新到最新版的恶意代码。但是会缺少两个关键组件iexplorer_helper.dat（5.0.0.1）和svcprotect.dat（1.0.0.11）。</p></blockquote>
<blockquote><p>HSoftDoloEx.exe和C&amp;C服务器通信的请求升级流程如下表：</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_16.png"><img class="alignnone wp-image-56199 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_16.png" alt="image_16" width="700" height="798" /></a></div>
<p>&nbsp;</p>
<div align="center">图 16、HsoftDoloEx和C&amp;C服务通信流程</div>
<p>&nbsp;</p>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_17.png"><img class="alignnone wp-image-56200 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_17.png" alt="image_17" width="700" height="76" /></a></div>
<p>&nbsp;</p>
<div align="center">图 17、C&amp;C服务器返回的base64解码后数据</div>
<p><strong>2.        用户态流量劫持模块</strong></p>
<blockquote><p>bime.dll会被注入到<a href="https://www.secpulse.com/archives/tag/explorer.exe" target="_blank">explorer.exe</a>进程，在其等待5分钟之后会加载恶意模块svcprotect.dat。svcprotect.dat会释放另一个恶意模块iexplorer_helper.dat和一个假iexplore.exe，二者分别实现不同流量劫持功能：</p></blockquote>
<blockquote><p>1）针对用户浏览器首页的劫持：<br />
在Explorer.exe中的svcprotect.dat Hook了的CreateProcessW劫持浏览器首页流量，此外svcprotect.dat还会直接启动假iexplore.exe替换用户运行的浏览器完成首页劫持。</p></blockquote>
<blockquote><p>2）针对用户访问购物网站做流量劫持：<br />
svcprotect.dat释放的出来的iexplorer_helper.dat会针对系统IE浏览器劫持某购物网站流量。</p></blockquote>
<blockquote><p>负责用户态流量劫持的模块列表：</p></blockquote>
<div align="center">
<table class="t_table" cellspacing="0">
<tbody>
<tr>
<td colspan="2" width="446">
<div align="right">
<div align="center">劫持模块</div>
</div>
</td>
</tr>
<tr>
<td width="331">
<div align="left">
<div align="left">%HOMEPATH%\AppData\Roaming\HSoftDoloEx</div>
</div>
</td>
<td width="115">
<div align="left">
<div align="left">bime.dll</div>
</div>
</td>
</tr>
<tr>
<td width="331">
<div align="left">
<div align="left">%HOMEPATH%\AppData\Local\Internet Explorer</div>
</div>
</td>
<td width="115">
<div align="left">
<div align="left">iexplorer_helper.dat</div>
</div>
</td>
</tr>
<tr>
<td width="331">
<div align="left">
<div align="left">%HOMEPATH%\AppData\Roaming\{E233850D-5D6E-48E3-98B5-8049F7E9FC68}</div>
</div>
</td>
<td width="115">
<div align="left">
<div align="left">iexplore.exe</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<blockquote><p>负责用户态流量劫持的C&amp;C服务器：</p></blockquote>
<div align="center">
<table class="t_table" cellspacing="0">
<tbody>
<tr>
<td width="238">
<div align="right">
<div align="center">C&amp;C服务器</div>
</div>
</td>
</tr>
<tr>
<td width="238">
<div align="left">
<div align="left"><a href="http://update.123juzi.net/getupfs2.php" target="_blank">http://update.123juzi.net/getupfs2.php</a></div>
<div align="left">http://update.qyllq.net/test_json.php</div>
<div align="left">http://api.qyllq.com/url_loc.php</div>
<div align="left">http://update.qyllq.com/tnpp.php</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<blockquote><p>2.1        svcprotect.dat劫持模块分析<br />
加载到explorer.exe中的svcprotect.dat会向服务器<a href="http://update.123juzi.net/getupfs2.php" target="_blank">http://update.123juzi.net/getupfs2.php</a>发送请求获取控制指令。</p>
<p>svcprotect.dat和C&amp;C服务器通信流程如下表：</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_18.png"><img class="alignnone wp-image-56202 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_18.png" alt="image_18" width="700" height="227" /></a></div>
<p style="text-align: center;">图 18、svcprotect.dat和C&amp;C服务器通信流程</p>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_19.png"><img class="alignnone wp-image-56203 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_19.png" alt="image_19" width="700" height="219" /></a></div>
<p>&nbsp;</p>
<div align="center">图 19、解码服务器返回的数据为二进制格式</div>
<p>&nbsp;</p>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_20.png"><img class="alignnone wp-image-56204 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_20.png" alt="image_20" width="700" height="672" /></a></div>
<p>&nbsp;</p>
<div align="center">图 20、通过XOR 0x29得到的JSON格式的控制指令</div>
<p>&nbsp;</p>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_21.png"><img class="alignnone wp-image-56205 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_21.png" alt="image_21" width="700" height="168" /></a></div>
<p>&nbsp;</p>
<div align="center">图 21、控制指令的完整列表</div>
<blockquote><p>通过C&amp;C服务器得到的JSON各键名含义：</p></blockquote>
<div align="center">
<table class="t_table" cellspacing="0">
<tbody>
<tr>
<td width="52">
<div align="right">
<div align="center">字段</div>
</div>
</td>
<td width="238">
<div align="right">
<div align="center">字段含义</div>
</div>
</td>
</tr>
<tr>
<td width="52">
<div align="left">
<div align="left">browser</div>
</div>
</td>
<td width="238">
<div align="left">
<div align="left">被劫持的浏览器进程名</div>
</div>
</td>
</tr>
<tr>
<td width="52">
<div align="left">
<div align="left">action</div>
</div>
</td>
<td width="238">
<div align="left">
<div align="left">进程启动方式</div>
<div align="left">数值为800：快捷方式启动</div>
<div align="left">数值为400：快捷方式添加参数启动</div>
<div align="left">数值为1：直接由explorer启动（如Ctrl+R启动）</div>
</div>
</td>
</tr>
<tr>
<td width="52">
<div align="left">
<div align="left">home</div>
</div>
</td>
<td width="238">
<div align="left">
<div align="left">劫持网址</div>
</div>
</td>
</tr>
<tr>
<td width="52">
<div align="left">
<div align="left">juzi</div>
</div>
</td>
<td width="238">
<div align="left">
<div align="left">是否将进程替换为假IE</div>
</div>
</td>
</tr>
<tr>
<td width="52">
<div align="left">
<div align="left">per</div>
</div>
</td>
<td width="238">
<div align="left">
<div align="left">劫持概率</div>
</div>
</td>
</tr>
<tr>
<td width="52">
<div align="left">
<div align="left">perie</div>
</div>
</td>
<td width="238">
<div align="left">
<div align="left">将进程替换为系统IE的概率</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;</p>
<blockquote><p>svcprotect.dat根据接收到的云控指令，判断用户启动的浏览器是否匹配劫持条件，如果匹配则会选择对应的劫持方法。其流量劫持的手法一共分为三种：</p></blockquote>
<blockquote><p>1）将用户启动的浏览器劫持为假IE：<br />
在用户双击浏览器快捷方式（包括带网址参数和不带网址参数两种）或者通过explorer直接启动浏览器时（当前只劫持通过“Win+R”方式启动的浏览器，直接启动浏览器的可执行文件不会被劫持），只要配置文件中对应的概率命中，就会将当前启动浏览器替换为假IE。当然这样的劫持手法过于明显，很容易引起用户警觉，所以劫持为假IE的概率很低。</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_22.png"><img class=" wp-image-56207 size-large aligncenter" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_22-1024x476.png" alt="image_22" width="1024" height="476" /></a></div>
<p>&nbsp;</p>
<div align="center">图 22、假IE访问其默认首页</div>
<blockquote><p>2）劫持浏览器的命令行启动参数：</p></blockquote>
<blockquote><p>在用户启动无命令行参数的浏览器快捷方式时，如果配置文件中对应的概率命中，则会添加带有自己计费号的百度搜索网址参数，如果启动的浏览器是系统IE，劫持网址就是带有计费号的hao123链接。针对360安全浏览器和360极速浏览器这种当启动参数为其他导航站时，就会跳转到<a href="http://hao.360.cn/" target="_blank">http://hao.360.cn</a>的浏览器，劫持网址就是带有计费号的百度搜索链接。</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_23.png"><img class="alignnone wp-image-56208 size-large" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_23-1024x637.png" alt="image_23" width="1024" height="637" /></a></div>
<p>&nbsp;</p>
<div align="center">图 23、劫持浏览器参数</div>
<p><strong>3）将启动的第三方浏览器替换为系统IE：</strong></p>
<blockquote><p>​用户双击浏览器快捷方式（包括带网址参数和不带网址参数两种）或者通过explorer.exe直接启动时，如果“per”键值中的概率没有命中，则会继续使用“perie”键值中的概率进行第二次随机。如果命中第三方浏览器替换为系统IE。这种手法主要用于当第三方浏览器启动参数为hao123导航时，为了保住这些流量不会因为使用其他第三方浏览器而跳转到其他导航站（如：<a href="http://hao.360.cn/" target="_blank">http://hao.360.cn</a>），所以将第三方浏览器替换为系统IE，从而保护其固有流量。</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_24.png"><img class="alignnone wp-image-56209 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_24.png" alt="image_24" width="658" height="405" /></a></div>
<p>&nbsp;</p>
<div align="center">图 24、劫持逻辑流程图</div>
<blockquote><p>svcprotect.dat 释放的假IE<br />
因为当360安全浏览器和360极速浏览器的启动参数为<a href="http://www.hao123.com/" target="_blank">http://www.hao123.com</a>时，会默认打开<a href="http://hao.360.cn/" target="_blank">http://hao.360.cn</a>，所以为了更加彻底地劫持流量，svcprotect.dat中的恶意代码会将这两款浏览器替换为假IE，从而达到其劫持目的。除了启动后会默认打开hao123导航外，当假IE的启动参数为百度搜索时，其实际使用的计费号依然为自己的计费号（如下图，在访问网址时我们可以看到上述网址在浏览器标题栏中一闪而过）。</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_25.png"><img class="alignnone wp-image-56210 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_25.png" alt="image_25" width="975" height="636" /></a></div>
<p>&nbsp;</p>
<div align="center">图 25、假IE访问百度搜索</div>
<blockquote><p>2.2        iexplorer_helper.dat劫持模块分析<br />
注入浏览器的bime.dll会加载iexplorer_helper.dat组件，调用iexplorer_helper.dat动态库的"Run"导出函数后执行以下操作：</p></blockquote>
<blockquote><p>1）启动rundll32.exe，加载iexplorer_helper.dat，调用参数为Init</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_26.png"><img class="alignnone wp-image-56211 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_26.png" alt="image_26" width="556" height="526" /></a></div>
<p>&nbsp;</p>
<div align="center">图 26、rundll32.exe启动的iexplorer_helper.dat</div>
<blockquote><p>2）向C&amp;C<a href="https://www.secpulse.com/archives/tag/服务器" target="_blank">服务器</a>发送获取控制指令，一共发送三个请求：<br />
a)请求<a href="http://update.qyllq.net/test_json.php" target="_blank">http://update.qyllq.net/test_json.php</a>获取的云控指令，我们命名为hijack_cmd1。<br />
b)请求<a href="http://api.qyllq.com/url_loc.php" target="_blank">http://api.qyllq.com/url_loc.php</a>获取云控指令，我们命名为hijack_cmd2。<br />
c)请求<a href="http://update.qyllq.com/tnpp.php" target="_blank">http://update.qyllq.com/tnpp.php</a>获取云控指令，我们命名为hijack_cmd3。</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_27.png"><img class="alignnone wp-image-56212 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_27.png" alt="image_27" width="819" height="478" /></a></div>
<p>&nbsp;</p>
<div align="center">图 27、iexplorer_helper.dat和C&amp;C服务器通信</div>
<blockquote><p>iexplorer_helper.dat和C&amp;C服务器通信流程如下表：</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_28.png"><img class="alignnone wp-image-56213 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_28.png" alt="image_28" width="700" height="239" /></a></div>
<p>&nbsp;</p>
<div align="center">图 28、iexplorer_helper.dat和C&amp;C服务器通信流程</div>
<p>&nbsp;</p>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_29.png"><img class="alignnone wp-image-56215 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_29.png" alt="image_29" width="700" height="189" /></a></div>
<p>&nbsp;</p>
<div align="center">图 29、解码服务器返回的数据为二进制格式</div>
<p>&nbsp;</p>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_30.png"><img class="alignnone wp-image-56216 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_30.png" alt="image_30" width="700" height="560" /></a></div>
<p>&nbsp;</p>
<div align="center">图 30、通过XOR 0x9C得到的JSON格式的控制指令</div>
<p>&nbsp;</p>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_31.png"><img class="alignnone wp-image-56217 size-large" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_31-551x1024.png" alt="image_31" width="551" height="1024" /></a></div>
<p>&nbsp;</p>
<div align="center">图 31、控制指令的完整列表</div>
<p>&nbsp;</p>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_32.png"><img class="alignnone wp-image-56218 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_32.png" alt="image_32" width="700" height="323" /></a></div>
<div align="center">图 32、iexplorer_helper.dat和C&amp;C服务器通信流程</div>
<p>&nbsp;</p>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_33.png"><img class="alignnone wp-image-56220 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_33.png" alt="image_33" width="700" height="171" /></a></div>
<p>&nbsp;</p>
<div align="center">图 33、解码服务器返回的数据为二进制格式</div>
<p>&nbsp;</p>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_34.png"><img class="alignnone wp-image-56221 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_34.png" alt="image_34" width="700" height="399" /></a></div>
<p>&nbsp;</p>
<div align="center">图 34、通过XOR 0x9C得到的JSON格式的控制指令</div>
<p>&nbsp;</p>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_35.png"><img class="alignnone wp-image-56222 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_35.png" alt="image_35" width="700" height="399" /></a></div>
<p>&nbsp;</p>
<div align="center">图 35、控制指令的完整列表</div>
<p>&nbsp;</p>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_36.png"><img class="alignnone wp-image-56223 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_36.png" alt="image_36" width="700" height="173" /></a></div>
<p>&nbsp;</p>
<div align="center">图 36、iexplorer_helper.dat和C&amp;C服务器通信流程</div>
<p>&nbsp;</p>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_37.png"><img class="alignnone wp-image-56225 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_37.png" alt="image_37" width="700" height="105" /></a></div>
<p>&nbsp;</p>
<div align="center">图 37、通过XOR 0x9C得到的JSON格式的控制指令</div>
<blockquote><p>hijack_cmd3没有请求后没有得到对应数据，但是会保存从服务器请求到的base64编码指令到%HOMEPATH%\AppData\Local\ProgramData\iehlp.dat。其余两组的指令保存在内存没有在本地保存，对应的含义如下：</p></blockquote>
<blockquote><p>通过C&amp;C服务器得到hijack_cmd1的JSON各键名含义：</p></blockquote>
<div align="center">
<table class="t_table" cellspacing="0">
<tbody>
<tr>
<td width="55">
<div align="right">
<div align="center">字段</div>
</div>
</td>
<td width="252">
<div align="right">
<div align="center">字段含义</div>
</div>
</td>
</tr>
<tr>
<td width="55">
<div align="left">
<div align="left">id</div>
</div>
</td>
<td width="252">
<div align="left">
<div align="left">编号</div>
</div>
</td>
</tr>
<tr>
<td width="55">
<div align="left">
<div align="left">urlsrc</div>
</div>
</td>
<td width="252">
<div align="left">
<div align="left">原访问网址</div>
</div>
</td>
</tr>
<tr>
<td width="55">
<div align="left">
<div align="left">urldst</div>
</div>
</td>
<td width="252">
<div align="left">
<div align="left">劫持网址</div>
</div>
</td>
</tr>
<tr>
<td width="55">
<div align="left">
<div align="left">rand</div>
</div>
</td>
<td width="252">
<div align="left">
<div align="left">劫持概率</div>
</div>
</td>
</tr>
<tr>
<td width="55">
<div align="left">
<div align="left">times</div>
</div>
</td>
<td width="252">
<div align="left">
<div align="left">每日劫持次数</div>
</div>
</td>
</tr>
<tr>
<td width="55">
<div align="left">
<div align="left">elapse</div>
</div>
</td>
<td width="252">
<div align="left">
<div align="left">劫持间隔时间</div>
</div>
</td>
</tr>
<tr>
<td width="55">
<div align="left">
<div align="left">mode</div>
</div>
</td>
<td width="252">
<div align="left">
<div align="left">未知（现配置文件中所有mode键值都为8）</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<blockquote><p>通过C&amp;C服务器得到hijack_cmd2的JSON各键名含义:</p></blockquote>
<div align="center">
<table class="t_table" cellspacing="0">
<tbody>
<tr>
<td width="60">
<div align="right">
<div align="center">字段</div>
</div>
</td>
<td width="275">
<div align="right">
<div align="center">字段含义</div>
</div>
</td>
</tr>
<tr>
<td width="60">
<div align="left">
<div align="left">id</div>
</div>
</td>
<td width="275">
<div align="left">
<div align="left">编号</div>
</div>
</td>
</tr>
<tr>
<td width="60">
<div align="left">
<div align="left">urlsrc</div>
</div>
</td>
<td width="275">
<div align="left">
<div align="left">原访问网址</div>
</div>
</td>
</tr>
<tr>
<td width="60">
<div align="left">
<div align="left">urldst</div>
</div>
</td>
<td width="275">
<div align="left">
<div align="left">劫持网址</div>
</div>
</td>
</tr>
<tr>
<td width="60">
<div align="left">
<div align="left">rand</div>
</div>
</td>
<td width="275">
<div align="left">
<div align="left">劫持概率</div>
</div>
</td>
</tr>
<tr>
<td width="60">
<div align="left">
<div align="left">times</div>
</div>
</td>
<td width="275">
<div align="left">
<div align="left">每日劫持次数</div>
</div>
</td>
</tr>
<tr>
<td width="60">
<div align="left">
<div align="left">elapse</div>
</div>
</td>
<td width="275">
<div align="left">
<div align="left">劫持间隔时间</div>
</div>
</td>
</tr>
<tr>
<td width="60">
<div align="left">
<div align="left">mode</div>
</div>
</td>
<td width="275">
<div align="left">
<div align="left">未知（现配置文件中所有mode键值都为8）</div>
</div>
</td>
</tr>
<tr>
<td width="60">
<div align="left">
<div align="left">referer</div>
</div>
</td>
<td width="275">
<div align="left">
<div align="left">未见使用</div>
</div>
</td>
</tr>
<tr>
<td width="60">
<div align="left">
<div align="left">city</div>
</div>
</td>
<td width="275">
<div align="left">
<div align="left">未见使用</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<blockquote><p>每个浏览器都会加载中iexplorer_helper.dat启动rundll32.exe执行iexplorer_helper.dat的Init函数。但是如果启动的进程是iexplorer.exe。注入iexplorer_helper.dat会和rundll32.exe进程通信，将IE地址栏的访问地址劫持交给rundll32.exe进行分析，如果满足劫持条件跳转网址发送给iexplorer。进行劫持。</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_38.png"><img class="alignnone wp-image-56226 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_38.png" alt="image_38" width="650" height="365" /></a></div>
<p>&nbsp;</p>
<div align="center">图 38、进程通讯流程图</div>
<p>&nbsp;</p>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_39.png"><img class="alignnone wp-image-56227 size-large" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_39-1024x467.png" alt="image_39" width="1024" height="467" /></a></div>
<p>&nbsp;</p>
<div align="center">图 39、劫持jd.com添加推广号</div>
<blockquote><p>3）内核态流量劫持模块<br />
HSoftDoloEx.exe接收C&amp;C服务器云控指令发送给MsVwmlbkgn.sys进行HTTP收发包的流量劫持。从C&amp;C服务器接收到的云控指令包含了普通导航站的劫持和百度网盟广告的劫持。<br />
在x64系统zethelpEx64.exe(3.2.0.3)负责发送云控指令给MsVwmlbkgn.sys。<br />
内核态负责流量劫持的模块列表：</p></blockquote>
<div align="center">
<table class="t_table" cellspacing="0">
<tbody>
<tr>
<td colspan="2" width="346">
<div align="right">
<div align="center">劫持模块</div>
</div>
</td>
</tr>
<tr>
<td width="242">
<div align="left">
<div align="left">%HOMEPATH%\AppData\Roaming\HSoftDoloEx</div>
</div>
</td>
<td width="104">
<div align="left">
<div align="left">HSoftDoloEx.exe</div>
<div align="left">zethelpEx64.exe</div>
</div>
</td>
</tr>
<tr>
<td width="242">
<div align="left">
<div align="left">%drivers%</div>
</div>
</td>
<td width="104">
<div align="left">
<div align="left">MsVwmlbkgn.sys</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<blockquote><p>内核态负责流量劫持的云控指令文件:</p></blockquote>
<div align="center">
<table class="t_table" cellspacing="0">
<tbody>
<tr>
<td colspan="2" width="346">
<div align="right">
<div align="center">云控指令文件</div>
</div>
</td>
</tr>
<tr>
<td width="242">
<div align="left">
<div align="left">%HOMEPATH%\AppData\Roaming  \Internet Explorer</div>
</div>
</td>
<td width="104">
<div align="left">
<div align="left">cfg.dat</div>
<div align="left">iecompa.dat</div>
<div align="left">iecompb.dat</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
</div>
<div align="center">
<blockquote>
<p align="left">      内核态负责流量劫持的C&amp;C服务器指令接口:</p>
</blockquote>
</div>
<p>&nbsp;</p>
<div align="center">
<table class="t_table" cellspacing="0">
<tbody>
<tr>
<td width="346">
<div align="right">
<div align="center">C&amp;C服务器指令接口</div>
</div>
</td>
</tr>
<tr>
<td width="346">
<div align="left">
<div align="center">http://update.qyllq.com/getupfs2.php</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<blockquote><p>3.1        云控指令获取<br />
HSoftDoloEx.exe连接C&amp;C服务器（<a href="http://update.qyllq.net/" target="_blank">http://update.qyllq.net</a>）得到的加密的云控指令，解密后通过API函数DeviceIoControl，发送给设备“\\.\{D87A9329-ED85-49C3-A8D2-534474363333}”对应的驱动程序”MsVwmlbkgn.sys“。<br />
HSoftDoloEx.exe通过C&amp;C服务器获取运控制令流程：</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_40.png"><img class="alignnone wp-image-56228 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_40.png" alt="image_40" width="700" height="150" /></a></div>
<p>&nbsp;</p>
<div align="center">图 40、HSoftDoloEx.exe和C&amp;C服务器通信流程</div>
<blockquote><p>请求格式如下:</p></blockquote>
<div align="center">
<table class="t_table" cellspacing="0">
<tbody>
<tr>
<td width="143">
<div align="right">
<div align="center">字段</div>
</div>
</td>
<td width="366">
<div align="right">
<div align="center">说明</div>
</div>
</td>
</tr>
<tr>
<td width="143">
<div align="left">
<div align="left">update.qyllq.com/getupfs2.php</div>
</div>
</td>
<td width="366">
<div align="left">
<div align="left">C&amp;C服务器地址</div>
</div>
</td>
</tr>
<tr>
<td width="143">
<div align="left">
<div align="left">app=3.2.0.4</div>
</div>
</td>
<td width="366">
<div align="left">
<div align="left">HSoftDoloEx的版本号</div>
</div>
</td>
</tr>
<tr>
<td width="143">
<div align="left">
<div align="left">cfg=</div>
</div>
</td>
<td width="366">
<div align="left">
<div align="left">本机保存指令的版本号，在文件cfg.dat文件中说明，为空就是本机还没有保存指令</div>
</div>
</td>
</tr>
<tr>
<td width="143">
<div align="left">
<div align="left">os=3</div>
</div>
</td>
<td width="366">
<div align="left">
<div align="left">操作系统的版本</div>
<div align="left">[1]  WindowsXP、WinServer2003</div>
<div align="left">[2]  WinServer2008</div>
<div align="left">[3]  Windows7</div>
<div align="left">[4]  Windows8</div>
<div align="left">[5]  Windows10</div>
</div>
</td>
</tr>
<tr>
<td width="143">
<div align="left">
<div align="left">safe=0</div>
</div>
</td>
<td width="265">
<div align="left">
<div align="left">[0]  没有安装安全软件</div>
<div align="left">[1]  360安全卫士、360杀毒</div>
<div align="left">[2]  腾讯电脑管家</div>
<div align="left">[4]  百度卫士、百度杀毒</div>
<div align="left">[8]  金山毒霸</div>
<div align="left">如果安装多款安全软件就将数字相加，例如同时安装了360、腾讯电脑管家、和百度杀毒，safe就等于7。</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<blockquote><p>3.2        云控指令解密<br />
从C&amp;C服务器返回的http:\\d.qyllq.net\DB\iecomv2.7z"下载地址是一个压缩文件。HSoftDoloEx.exe下载后解压文件到%HOMEPATH%\AppData\Roaming \Internet Explorer目录，一共三个文件分别是cfg.dat、iecompa.dat和iecompb.dat。</p></blockquote>
<p>&nbsp;</p>
<blockquote><p>除cfg.dat是明文保存云控指令版本外。其余的iecompa.dat和iecompb.dat都是加密过的二进制数据。<br />
iecompa.dat（后文简称指令A）和iecompb.dat（后文简称指令B）的格式如下：</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_41.png"><img class="alignnone wp-image-56229 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_41.png" alt="image_41" width="881" height="354" /></a></div>
<p>&nbsp;</p>
<div align="center">图 41、iecompa.dat XOR 0xB5后得到的控制指令</div>
<p>&nbsp;</p>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_42.png"><img class="alignnone wp-image-56230 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_42.png" alt="image_42" width="886" height="375" /></a></div>
<p>&nbsp;</p>
<div align="center">图 42、iecompb.dat XOR 0xB5后得到的控制指令</div>
<blockquote><p>图中前0x16个字节中蓝色框中内容和版本相关，绿色是指令长度，黄色是校验和。在0x16字节后面的数据XOR 0xB5，就可以得到为被加密的具体指令。<br />
指令A（iecompa.dat）</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_43.png"><img class="alignnone wp-image-56231 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_43.png" alt="image_43" width="700" height="929" /></a></div>
<p>&nbsp;</p>
<div align="center">图 43、控制指令的完整列表（指令A）</div>
<blockquote><p>指令B（iecompb.dat）</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_44.png"><img class="alignnone wp-image-56232 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_44.png" alt="image_44" width="700" height="929" /></a></div>
<p>&nbsp;</p>
<div align="center">图 44、控制指令的完整列表（指令B）</div>
<blockquote><p>获取云控指令后的HSoftDoloEx.exe使用DeviceIoControl函数和MsVwmlbkgn.sys进行通信。一共有三组控制码（HSoftDoloEx.exe版本3.2.0.4，MsVwmlbkgn.sys版本0.6.60.70），分别是：<br />
a)222000 发送指令A的内容给MsVwmlbkgn.sys<br />
b)222004 发送指令B的内容给MsVwmlbkgn.sys<br />
c)222008 控制流量劫持功能的开关</p></blockquote>
<blockquote><p>目前3.2.0.4版HSoftDoloEx.exe还没有使用222008这个控制码， 因为在0.6.60.70版本的MsVwmlbkg.sys中，流量劫持功能默认为开。</p></blockquote>
<blockquote><p>“指令A”和“指令B” 分工合作， 在指令A中不同的劫持类型对应指令B给出不同处理劫持方案，根据具体的劫持内容可以分为三种情况，不同的劫持方案在下文会有详细分析：</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_45.png"><img class="alignnone wp-image-56233 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_45.png" alt="image_45" width="726" height="481" /></a></div>
<p>&nbsp;</p>
<div align="center">图 45、劫持指令说明</div>
<blockquote><p>3.3        劫持流程</p>
<p>MsVwmlbkgn.sys是一个WFP驱动程序，该驱动会向WFP FWPM_LAYER_STREAM_V4和FWPM_LAYER_STREAM_V6注册Callout（我们标记为wfp_classify_callout）来分别过滤IPv4和IPv6的TCP数据流：</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_46.png"><img class="alignnone wp-image-56234 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_46.png" alt="image_46" width="547" height="120" /></a></div>
<p>&nbsp;</p>
<div align="center">图 46、注册IPv4和IPv6数据流过滤Callout</div>
<blockquote><p>wfp_classify_callout中会调用http_hijack函数对TCP发送和接收的数据进行协议分析并按照一定的逻辑进行劫持：</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_47.png"><img class=" wp-image-56235 size-large aligncenter" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_47-1024x633.png" alt="image_47" width="1024" height="633" /></a></div>
<p>&nbsp;</p>
<div align="center">图 47、wfp_classify_callout函数</div>
<blockquote><p>http_hijack函数中，根据HSoftDoloEx.exe接收C&amp;C服务器云控指令对收发数据有选择地进行劫持，具体劫持流程如下：</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_48.png"><img class=" wp-image-56236 size-full aligncenter" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_48.png" alt="image_48" width="771" height="641" /></a></div>
<p>&nbsp;</p>
<div align="center">图 48、内核态劫持流程图</div>
<blockquote><p>3.3.1        发包流程<br />
MsVwmlbkgn有一个全局开关决定是开启劫持功能，这个全局开关在MsVwmlbkgn中由控制码222008进行控制（70版本默认是打开的，上层没有对应控制的流程）。</p></blockquote>
<blockquote><p>除了全局开关以外，MsVwmlbkgn还会根据请求包中“Host”字段的网址，在C&amp;C服务器给出的指令中查找，根据指令有不同的处理方式，C&amp;C给出的指令包含：需要劫持的网站、<a href="https://www.secpulse.com/archives/tag/劫持概率" target="_blank">劫持概率</a>、使用何种方式劫持和浏览器名称。</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_49.png"><img class=" wp-image-56237 size-full aligncenter" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_49.png" alt="image_49" width="875" height="883" /></a></div>
<p>&nbsp;</p>
<div align="center">图 49、发包流程判断逻辑1</div>
<blockquote><p>如果请求的URL在C&amp;C服务器返回的劫持列表中，接下来驱动还会对当前发起进程进行判断，最后再计算C&amp;C服务器返回的对当前URL的劫持概率。</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_501.png"><img class="alignnone wp-image-56241 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_501.png" alt="image_50" width="877" height="926" /></a></div>
<p>&nbsp;</p>
<div align="center">图 50、发包流程判断逻辑2</div>
<blockquote><p>如果上述判断逻辑均通过，则会根据C&amp;C服务器返回的针对当前请求URL的劫持类型，有选择地分别执行两类劫持逻辑：<br />
标记为“2”的劫持方式：<br />
首先将要劫持到的目标URL保存在redir_url。接下来，将当前HTTP Flow的句柄保存在flowHandle_lo/hi，在收包劫持流程中做判断使用。</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_51.png"><img class=" wp-image-56240 size-full aligncenter" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_51.png" alt="image_51" width="906" height="134" /></a></div>
<p>&nbsp;</p>
<div align="center">图 51、保存收包劫持所需数据</div>
<blockquote><p>MsVwmlbkgn会保留请求包中原始”Host“地址，在地址前添加“http://”子串后进行base64编码，在编码后的字符串前添加"&amp;s="，构成一个新的字符串，结果保存在url_from_http_get_request。恶意代码制造者会通过该字符串统计截取流量的来源。</p></blockquote>
<blockquote><p>以“<a href="http://hao.qq.com/" target="_blank">http://hao.qq.com/</a> ”为例，转换后”&amp;s=aHR0cDovL2hhby5xcS5jb20vIA==“，保存该字符串在对应的应答包中使用，用于服务器后台统计。</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_52.png"><img class=" wp-image-56242 size-full aligncenter" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_52.png" alt="image_52" width="782" height="664" /></a></div>
<p>&nbsp;</p>
<div align="center">图 52、分析HTTP发送请求完整URL</div>
<p>&nbsp;</p>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_53.png"><img class="alignnone wp-image-56243 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_53.png" alt="image_53" width="780" height="783" /></a></div>
<p>&nbsp;</p>
<div align="center">图 53、拼接劫持来源统计信息</div>
<blockquote><p>标记为“8”的劫持方式：<br />
如果是方式“8”直接添加插入一个请求数据包，在”Host“地址后面修改推广号，具体实现在construct_send_hijack_packet中完成。</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_54.png"><img class="alignnone wp-image-56244 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_54.png" alt="image_54" width="781" height="783" /></a></div>
<p>&nbsp;</p>
<div align="center">图 54、发包劫持流程</div>
<blockquote><p>3.3.2        收包流程<br />
如果当前HTTP Flow为发包时记录下的需要被劫持的Flow (flowHandle_lo/hi与当前句柄相同)，则表示这个收到的HTTP数据是需要被劫持的。这时，则会在应答流程中插入一个302重定向应答包，并将重定向地址指向redir_url，且将劫持来源统计信息（url_from_http_get_request）同时拼接到重定向URL中。</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_55.png"><img class="alignnone wp-image-56246 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_55.png" alt="image_55" width="714" height="579" /></a></div>
<p>&nbsp;</p>
<div align="center">图 55、收包劫持流程</div>
<p>&nbsp;</p>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_56.png"><img class="alignnone wp-image-56247 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_56.png" alt="image_56" width="812" height="987" /></a></div>
<p>&nbsp;</p>
<div align="center">图 56、拼接302重定向应答包</div>
<blockquote><p>以用户访问“<a href="http://hao.qq.com/" target="_blank">http://hao.qq.com/</a> ”为例，经过内核态劫持后，真正的访问链接就变成了“<a href="https://www.hao123.com/?tn=70000000_o2_hao_ss&amp;s=aHR0cDovL2hhby5xcS5jb20vIA==" target="_blank">https://www.hao123.com/?tn=70000 ... 2hhby5xcS5jb20vIA==</a>”</p></blockquote>
<blockquote><p>3.3.3        百度网盟广告劫持<br />
通过云控指令一节中可以看到，指令A中劫持的网站列表中绝大多数都是导航站，但是最后两个却是百度网盟的广告js脚本，劫持关系如下表：</p></blockquote>
<div align="center">
<table class="t_table" cellspacing="0">
<tbody>
<tr>
<td width="265">
<div align="right">
<div align="center">劫持源URL</div>
</div>
</td>
<td width="265">
<div align="right">
<div align="center">劫持目标URL</div>
</div>
</td>
</tr>
<tr>
<td width="265">
<div align="left">
<div align="left">http://cpro.baidustatic.com/cpro/ui/c.js</div>
</div>
</td>
<td width="265">
<div align="left">
<div align="left">http://update.qyllq.net/r.php?c=30&amp;v=3</div>
</div>
</td>
</tr>
<tr>
<td width="265">
<div align="left">
<div align="left">http://cpro.baidu.com/cpro/ui/c.js</div>
</div>
</td>
<td width="265">
<div align="left">
<div align="left">http://update.qyllq.net/r.php?c=31&amp;v=3</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<blockquote><p>用户访问有投放百度广告的网站时，恶意代码会劫持百度广告，具体流程如下：</p>
<p style="padding-left: 30px;">1）<a href="http://cpro.baidustatic.com/cpro/ui/c.js" target="_blank">http://cpro.baidustatic.com/cpro/ui/c.js</a>和<a href="http://cpro.baidu.com/cpro/ui/c.js" target="_blank">http://cpro.baidu.com/cpro/ui/c.js</a>是用于展示从百度网盟获取广告的js脚本。<br />
2）访问带有百度广告脚本的网站时，步骤1的“c.js”脚本被劫持替换成<a href="http://update.qyllq.net/r.php?c=30&amp;v=3" target="_blank">http://update.qyllq.net/r.php?c=30&amp;v=3</a>或<a href="http://update.qyllq.net/r.php?c=31&amp;v=3" target="_blank">http://update.qyllq.net/r.php?c=31&amp;v=3</a>。<br />
3）步骤2的PHP页面会继续跳转到<a href="http://xz.mascldl.com/ifr/c3w.js" target="_blank">http://xz.mascldl.com/ifr/c3w.js</a>，得到”c3w.js”脚本。<br />
4）继续跳转到<a href="http://xz.mascldl.com/ifr/cw3.js" target="_blank">http://xz.mascldl.com/ifr/cw3.js</a>，得到”cw3.js”脚本。<br />
5）”cw3.js”脚本就是最终得到负责劫持的百度网盟广告的js脚本。</p>
</blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/03/57.png"><img class="alignnone size-full wp-image-56310" src="http://www.secpulse.com/wp-content/uploads/2017/03/57.png" alt="57" width="572" height="181" /></a></div>
<p>&nbsp;</p>
<div align="center">图 57、百度网盟广告劫持流程图</div>
<blockquote><p>“cw3.js”脚本劫持百度网盟广告的流程如下：</p></blockquote>
<blockquote><p>1）首先拼接劫持到的目的网址，这些网址都是跳转链接：</p></blockquote>
<div align="center">
<table class="t_table" cellspacing="0">
<tbody>
<tr>
<td width="257">
<div align="right">
<div align="left">http://yu.xrtotel.com/cl/u63990/200x200.html</div>
<div align="left">http://yu.xrtotel.com/cl/u63990/250x250.html</div>
<div align="left">http://yu.xrtotel.com/cl/u63990/300x250.html</div>
<div align="left">http://yu.xrtotel.com/cl/u63990/336x280.html</div>
</div>
</td>
<td width="265">
<div align="right">
<div align="left">http://yu.xrtotel.com/cl/u63990/580x90.html</div>
<div align="left">http://yu.xrtotel.com/cl/u63990/640x60.html</div>
<div align="left">http://yu.xrtotel.com/cl/u63990/728x90.html</div>
<div align="left">http://yu.xrtotel.com/cl/u63990/960x90.html</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<blockquote><p>跳转后的广告页面为带有计费号的“<a href="http://duba.com/union2.html" target="_blank">http://duba.com/union2.html</a>“:</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_58.png"><img class="alignnone wp-image-56249 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_58.png" alt="image_58" width="714" height="551" /></a></div>
<p>&nbsp;</p>
<div align="center">图 58、劫持后的广告链接</div>
<blockquote><p>2）查找页面中的iframe标签，判断链接是否是”pos.baidu.com”并且不是”duba”：</p></blockquote>
<div align="center">
<table class="t_table" cellspacing="0">
<tbody>
<tr>
<td width="529">
<div align="right">
<div align="left">for (var M = 0; M &lt; H.length; M++) {</div>
<div align="left">     var D = H[M].id;</div>
<div align="left">    if  (D == null || D == "undefined" || D.indexOf("iframe") !==  0) {</div>
<div align="left">         continue</div>
<div align="left">    }</div>
<div align="left">    if  (H[M].src.indexOf("pos.baidu.com") != 7 ||  H[M].src.indexOf("duba") &gt; 0) {</div>
<div align="left">         continue</div>
<div align="left">    }</div>
<div align="left">     F(H[M], H[M].offsetWidth, H[M].offsetHeight)</div>
<div align="left">}</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<blockquote><p>3）如果条件匹配，判断第一步准备的广告有没有大小合适的，找到合适大小则将原始链接保存下来：</p></blockquote>
<div align="center">
<table class="t_table" cellspacing="0">
<tbody>
<tr>
<td width="529">
<div align="right">
<div align="left">
<div align="left">function F(U, d, T){</div>
<div align="left">   if (t.length == 0) {</div>
<div align="left">       return</div>
<div align="left">    }</div>
<div align="left">   for (var s in t) {</div>
<div align="left">       if (t[0] == U.offsetWidth &amp;&amp;t[1] == U.offsetHeight) {</div>
<div align="left">           G.push(U)</div>
<div align="left">       }</div>
<div align="left">    }</div>
<div align="left">}</div>
</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<blockquote><p>4）  然后判断当前网站链接是否在它的放过列表中</p></blockquote>
<div align="center">
<table class="t_table" cellspacing="0">
<tbody>
<tr>
<td width="529">
<div align="right">
<div align="left">
<div align="center">
<table class="t_table" cellspacing="0">
<tbody>
<tr>
<td width="529">
<div align="right">
<div align="left">
<div align="left">function e() {</div>
<div align="left">    var d = [".hao123.co", ".3567.com",  ".www2345.com",".www9991.com", ".365wz.net",  ".2345.net", ".2345.org",".77816.com",  ".365wz.com",".hao184.com", ".d1wz.com", ".to128.com", ".42.62.30.178",".42.62.30.180", ".2345soso.com", ".2345kankan.com",  ".ku118.com",".hh361.com", ".v2233.com", ".ie567.com", ".2345ii.com", ".kuku2.com",  ".yes115.com",".kabasiji.com", ".5599.net",  ".te99.com",".duote.com.cn", ".duote.net",  ".51ct.cn",".zhangyu.com", ".537.com", ".cc62.com", ".cn220.com",".k986.com", ".555k.net", ".wzeh.com",".yl234.com", ".2345download.com", ".g3456.com",".duote.com", ".duote.cn", ".9991.com", ".50bang.org",  ".2345.com.cn",".duote.org", ".haozip.com",  ".2345.com", ".2345.cn",".tt5000.com", ".4585.com", ".728.com",".game56.com", ".fa3000.com", ".yy5000.com",".777ge.com", ".hao774.com"];</div>
<div align="left">    var T = location.hostname;</div>
<div align="left">    for (var s = 0; s &lt; d.length; s++) {</div>
<div align="left">        if (T.indexOf(d) &gt; 0) {</div>
<div align="left">            return true</div>
<div align="left">        }</div>
<div align="left">    }</div>
<div align="left">    var U = ["hao123.co", "3567.com",  "www2345.com","www9991.com", "365wz.net", "2345.net", "2345.org", "77816.com",  "365wz.com","hao184.com", "d1wz.com", "to128.com", "42.62.30.178","42.62.30.180", "2345soso.com", "2345kankan.com","ku118.com", "hh361.com", "v2233.com","ie567.com", "2345ii.com", "kuku2.com","yes115.com", "kabasiji.com", "5599.net","te99.com", "duote.com.cn", "duote.net", "51ct.cn",  "zhangyu.com", "537.com","cc62.com", "cn220.com", "k986.com", "555k.net",  "wzeh.com", "yl234.com","2345download.com", "g3456.com",  "duote.com", "duote.cn","9991.com", "50bang.org", "2345.com.cn","duote.org", "haozip.com", "2345.com", "2345.cn",  "tt5000.com", "4585.com","728.com", "game56.com", "fa3000.com", "yy5000.com",  "777ge.com","hao774.com"];</div>
<div align="left">    for (var s = 0; s &lt; U.length; s++) {</div>
<div align="left">        if (T == U) {</div>
<div align="left">            return true</div>
<div align="left">        }</div>
<div align="left">    }</div>
<div align="left">    return false</div>
<div align="left">}</div>
</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<blockquote><p>5） 如果不在放过列表中，”cw3.js”劫持时用第一步中保存跳转链接替换原始的广告链接，达到劫持百度网盟广告的目的：</p></blockquote>
<div align="center">
<table class="t_table" cellspacing="0">
<tbody>
<tr>
<td width="529">
<div align="right">
<div align="left">d.addChildAdTask = function() {</div>
<div align="left">     d.CurrentDisplayAd = d.OldAd.cloneNode(true);</div>
<div align="left">     d.CurrentDisplayAd.setAttribute("src", d.AdSrc);</div>
<div align="left">    if  (d.OldAd == null) {</div>
<div align="left">         return</div>
<div align="left">    }</div>
<div align="left">     var i = q(d.OldAd);</div>
<div align="left">    if  (i) {</div>
<div align="left">         d.CurrentDisplayAd.style.display = "none";</div>
<div align="left">         d.ParentContainer.appendChild(d.CurrentDisplayAd);</div>
<div align="left">         setTimeout(function() {</div>
<div align="left">             d.removeFadeOut(d.OldAd)</div>
<div align="left">         }, 3000)</div>
<div align="left">    }  else {</div>
<div align="left">         d.OldAd.setAttribute("src", d.AdSrc)</div>
<div align="left">    }</div>
<div align="left">};</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;</p>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_59.png"><img class="alignnone wp-image-56251 size-full" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_59.png" alt="image_59" width="580" height="324" /></a></div>
<p>&nbsp;</p>
<div align="center">图 59、cw3.js劫持流程</div>
<p><strong>五、附录</strong></p>
<blockquote><p>1.        恶意代码攻击时间线</p></blockquote>
<div align="center"><a href="http://www.secpulse.com/wp-content/uploads/2017/02/image_60.png"><img class="alignnone wp-image-56252 size-medium" src="http://www.secpulse.com/wp-content/uploads/2017/02/image_60-300x59.png" alt="image_60" width="300" height="59" /></a></div>
<p>&nbsp;</p>
<div align="center">图 60、时间线</div>
<p>&nbsp;</p>
<table class="t_table" cellspacing="0">
<tbody>
<tr>
<td width="85">
<div align="right">
<div align="center">签名时间</div>
</div>
</td>
<td width="113">
<div align="right">
<div align="center">恶意代码释放器版本</div>
</div>
</td>
<td width="170">
<div align="right">
<div align="center">释放器中包含的恶意代码</div>
</div>
</td>
<td width="207">
<div align="right">
<div align="center">功能简述</div>
</div>
</td>
</tr>
<tr>
<td colspan="4" width="576">
<div align="left">
<div align="center">第一版</div>
</div>
</td>
</tr>
<tr>
<td width="85">
<div align="left">
<div align="left">2016-09-28</div>
</div>
</td>
<td width="113">
<div align="left">
<div align="left">nvMultitask.exe（0.2.0.1）</div>
<div align="left">最初版本</div>
<div align="left">软件站下载包内置</div>
</div>
</td>
<td width="170">
<div align="left">
<div align="left">HSoftDoloEx.exe（3.2.0.1）</div>
<div align="left">bime.dll(1.7.0.1)</div>
<div align="left">bime64.dll(1.7.0.1)</div>
<div align="left">LcScience.sys（0.4.0.130）</div>
<div align="left">LcScience64.sys（0.4.0.130）</div>
<div align="left">WaNdFilter.sys（0.5.30.70）</div>
<div align="left">WaNdFilter64.sys（0.5.30.70）</div>
<div align="left">npjuziplugin.dll(1.0.0.1020)</div>
</div>
</td>
<td width="207">
<div align="left">
<div align="left">这个版本包含保护驱动，但是没有相应的流量截取功能</div>
</div>
</td>
</tr>
<tr>
<td colspan="4" width="576">
<div align="left">
<div align="center">第二版</div>
</div>
</td>
</tr>
<tr>
<td width="85">
<div align="left">
<div align="left">2016-11-25</div>
</div>
</td>
<td width="113">
<div align="left">
<div align="left">nvMultitask.exe（3.2.0.2）</div>
</div>
</td>
<td width="170">
<div align="left">
<div align="left">MsVwmlbkgn.sys(0.6.60.66)</div>
<div align="left">MsVwmlbkgn64.sys(0.6.60.66)</div>
<div align="left">HSoftDoloEx.exe（3.2.0.2）</div>
<div align="left">bime.dll(1.7.0.2)</div>
<div align="left">bime64.dll(1.7.0.2)</div>
</div>
</td>
<td width="207">
<div align="left">
<div align="left">首次加入流量截取驱动MsVwmlbkgn[64].sys，版本0.6.60.66。HSoftDoloEx.exe连接<a href="http://update.qyllq.net/ntdl.php" target="_blank">http://update.qyllq.net/ntdl.php</a>下载JOSN格式的控制信息，通过ioctrl号222000h发送给驱动</div>
</div>
</td>
</tr>
<tr>
<td colspan="4" width="576">
<div align="left">
<div align="center">第三版</div>
</div>
</td>
</tr>
<tr>
<td width="85">
<div align="left">
<div align="left">2017-01-03</div>
</div>
</td>
<td width="113">
<div align="left">
<div align="left">nvMultitask.exe（3.2.0.3）</div>
</div>
</td>
<td width="170">
<div align="left">
<div align="left">zethelpEx64.exe（3.2.0.3）</div>
<div align="left">HSoftDoloEx.exe（3.2.0.3）</div>
<div align="left">MsVwmlbkgn.sys(0.6.60.68)</div>
<div align="left">MsVwmlbkgn64.sys(0.6.60.68)</div>
</div>
</td>
<td width="207">
<div align="left">
<div align="left">HSoftDoloEx放弃<a href="http://update.qyllq.net/ntdl.php" target="_blank">http://update.qyllq.net/ntdl.php</a>服务器，改用 <a href="http://update.qyllq.com/getupfs2.php" target="_blank">http://update.qyllq.com/getupfs2.php</a>获取云控指令。新增的zethelpEx64.exe只有64位版，版本号3.2.0.3，负责在x64位系统下和驱动MsVwmlbkgn.sys通信。0.6.60.68版本的MsVwmlbkgn.sys增加了两组新的控制码。</div>
</div>
</td>
</tr>
<tr>
<td colspan="4" width="576">
<div align="left">
<div align="center">第四版</div>
</div>
</td>
</tr>
<tr>
<td width="85">
<div align="left">
<div align="left">2017-01-18</div>
</div>
</td>
<td width="113">
<div align="left">
<div align="left">nvMultitask.exe（3.2.0.4）</div>
</div>
</td>
<td width="170">
<div align="left">
<div align="left">HSoftDoloEx.exe（3.2.0.4）</div>
<div align="left">MsVwmlbkgn.sys(0.6.60.70)</div>
<div align="left">MsVwmlbkgn64.sys(0.6.60.70)</div>
<div align="left">bime.dll(1.7.0.5)</div>
<div align="left">bime64.dll(1.7.0.5)</div>
</div>
</td>
<td width="207">
<div align="left">
<div align="left">更新的MsVwmlbkgn.sys版本0.6.60.70和旧版本68相比，修改了HTTP劫持和HTTP302头拼接的相关函数。1.7.0.5版本的bime.dll下载新组件svcprotect.dat，svcprotect.dat释放iexplore.exe（1.5.9.1098）和iexplorer_helper.dat（5.0.0.1）两个恶意组件</div>
</div>
</td>
</tr>
</tbody>
</table>
<blockquote><p>另外，火绒安全实验室还在<a href="http://dl.123juzi.net/" target="_blank">http://dl.123juzi.net</a>服务器上发现其他版本的恶意代码释放器，但是在实验室环境中并没有发现这些释放器何时被使用。</p></blockquote>
<div align="center">
<table class="t_table" cellspacing="0">
<tbody>
<tr>
<td width="99">
<div align="right">
<div align="center">签名时间</div>
</div>
</td>
<td width="168">
<div align="right">
<div align="center">恶意代码释放器版本</div>
</div>
</td>
<td width="203">
<div align="right">
<div align="center">释放器中包含的恶意代码</div>
</div>
</td>
</tr>
<tr>
<td width="99">
<div align="left">
<div align="left">2016-10-31</div>
</div>
</td>
<td width="168">
<div align="left">
<div align="left">nvMultitask.exe（4.2.0.1）</div>
</div>
</td>
<td width="203">
<div align="left">
<div align="left">nvSoftHelpEx.exe（4.2.0.1）</div>
</div>
</td>
</tr>
<tr>
<td width="99">
<div align="left">
<div align="left">2016-11-14</div>
</div>
</td>
<td width="168">
<div align="left">
<div align="left">nvMultitask.exe（4.2.0.2）</div>
</div>
</td>
<td width="203">
<div align="left">
<div align="left">nvSoftHelpEx.exe（4.2.0.2）</div>
<div align="left">bime.dlll(1.7.0.2)</div>
<div align="left">bime64.dlll(1.7.0.2)</div>
</div>
</td>
</tr>
<tr>
<td width="99">
<div align="left">
<div align="left">2017-01-19</div>
</div>
</td>
<td width="168">
<div align="left">
<div align="left">nvMultitask.exe（4.2.0.4）</div>
</div>
</td>
<td width="203">
<div align="left">
<div align="left">HSoftDoloEx.exe（4.2.0.4）</div>
<div align="left">MsVwmlbkgn.sys(0.6.60.70)</div>
<div align="left">MsVwmlbkgn64.sys(0.6.60.70)</div>
<div align="left">zethelpEx64.exe（3.2.0.3）</div>
<div align="left">bime.dll(1.7.0.5)</div>
<div align="left">bime64.dll(1.7.0.5)</div>
</div>
</td>
</tr>
<tr>
<td width="99">
<div align="left">
<div align="left">2017-01-19</div>
</div>
</td>
<td width="168">
<div align="left">
<div align="left">nvMultitask.exe（6.2.0.4）</div>
</div>
</td>
<td width="203">
<div align="left">
<div align="left">QyNthxlnsxy.exe（6.2.0.4）</div>
<div align="left">MsVwmlbkgn.sys(0.6.60.70)</div>
<div align="left">MsVwmlbkgn64.sys(0.6.60.70)</div>
<div align="left">zethelpEx64.exe（3.2.0.3）</div>
<div align="left">bime.dll(1.7.0.5)</div>
<div align="left">bime64.dll(1.7.0.5)</div>
</div>
</td>
</tr>
<tr>
<td width="99">
<div align="left">
<div align="left">2017-1-19</div>
</div>
</td>
<td width="168">
<div align="left">
<div align="left">nvMultitask.exe(8.2.0.4)</div>
</div>
</td>
<td width="203">
<div align="left">
<div align="left">ASoftDevHe.exe（8.2.0.4）</div>
<div align="left">MsVwmlbkgn.sys(0.6.60.70)</div>
<div align="left">MsVwmlbkgn64.sys(0.6.60.70)</div>
<div align="left">zethelpEx64.exe（3.2.0.3）</div>
<div align="left">bime.dlll(1.7.0.5)</div>
<div align="left">bime64.dlll(1.7.0.5)</div>
</div>
</td>
</tr>
<tr>
<td width="99">
<div align="left">
<div align="left">2017-1-19</div>
</div>
</td>
<td width="168">
<div align="left">
<div align="left">nvMultitask.exe(9.2.0.4)</div>
</div>
</td>
<td width="203">
<div align="left">
<div align="left">PjczMqnopyx.exe（9.2.0.4）</div>
<div align="left">MsVwmlbkgn.sys(0.6.60.70)</div>
<div align="left">MsVwmlbkgn64.sys(0.6.60.70)</div>
<div align="left">zethelpEx64.exe（3.2.0.3）</div>
<div align="left">bime.dlll(1.7.0.5)</div>
<div align="left">bime64.dlll(1.7.0.5)</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;</p>
<blockquote><p>2.        全部样本HASH和C&amp;C服务器指令接口</p>
<p>2.1        样本HASH</p></blockquote>
<div align="center">
<table class="t_table" cellspacing="0">
<tbody>
<tr>
<td width="180">
<div align="right">
<div align="center">文件名</div>
</div>
</td>
<td width="77">
<div align="right">
<div align="center">签名日期</div>
</div>
</td>
<td width="244">
<div align="right">
<div align="center">SHA1</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">bime.dll(1.7.0.1)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2016-09-28</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">4eedbccd08fd01008befb696221bec98a385f5c6</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">bime.dll(1.7.0.2)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2016-11-04</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">b5c4ad0d7ddb85ebb837544f09a2f3bb45edaef8</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">bime.dll(1.7.0.5)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2017-01-18</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">060aff4551d0577cc89fdcfa2b5d308c9314371b</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">bime64.dll(1.7.0.1)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2016-09-28</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">f7cfd2d0749b9e95a4980ed1062ef99d1ab7c731</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">bime64.dll(1.7.0.2)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2016-11-04</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">7d1028635e0d337acb86db6c56c0b73b5b36ec8b</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">bime64.dll(1.7.0.5)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2017-01-18</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">b769c3bbc65fb3c1cd04bc6f5824e1be4464d87d</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">LcScience.sys(0.4.0.130)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2016-09-28</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">c4856ae2cc30bee437ad46dce69b22227aa6323b</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">LcScience64.sys(0.4.0.130)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2016-09-28</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">2dc6ca6975acd6b28ae658a21dabe8e0d6634273</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">WaNdFilter.sys(5.30.70)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2016-09-28</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">7f3219d2b0edb6499e679507bac348d4200c2f0a</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">WaNdFilter64.sys(5.30.70)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2016-09-28</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">f1f0dda83814fc082ff072937c3efafe2d2670c7</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">nvMultitask.exe(0.2.0.1)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2016-09-28</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">2dcc278369563870712c2fa1ecd35907cc4bb8aa</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">nvMultitask.exe(3.2.0.2)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2016-11-25</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">d2e712fd1d20445b4bb1b279f79e8914b9eb2de9</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">nvMultitask.exe(3.2.0.3)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2017-01-03</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">ee136bbb979311c918fbd435d56cbbf096cab2d8</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">nvMultitask.exe(3.2.0.4)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2017-01-18</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">c9499909d8b60934ed03f3675af2acd2cd4bcac3</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">nvMultitask.exe(4.2.0.1)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2016-10-31</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">c00d956c96ec3c1ba2e946e305d9216a43d0c25d</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">nvMultitask.exe(4.2.0.2)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2016-11-04</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">3ba67878986dd0e4c49b55af2456a6759c937c77</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">nvMultitask.exe(4.2.0.4)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2017-01-19</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">2dc86b959799ae101b8fed077164927884d04473</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">nvMultitask.exe(6.2.0.4)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2017-01-19</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">99cc8d92322f34e1a399345b9bb95a9a681d611a</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">nvMultitask.exe(8.2.0.4)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2017-01-19</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">31a1db3189decd02e7359f6b0dd7822f9cbdbe54</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">nvMultitask.exe(9.2.0.4)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2017-01-19</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">8996b2d74e005c2e3ae2ff509a64c219a07c430c</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">HSoftDoloEx.exe(3.2.0.1)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2016-09-28</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">6a0eaf027efa32b5b0a6ab1219c6f9d592652f97</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">HSoftDoloEx.exe(3.2.0.2)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2016-11-25</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">9952bfb13643894f6190075c4776095a3240c423</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">HSoftDoloEx.exe(3.2.0.3)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2017-01-03</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">ca14a69ebfe8bc18d8cda40cbf762c27cc7f58d6</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">HSoftDoloEx.exe(3.2.0.4)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2017-01-18</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">660a464ccbe823a19c9cfde548f934464b8c6a41</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">nvSoftHelpEx.exe(4.2.0.1)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2016-10-28</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">179130056ee004500d8e508509b85f9a6b2ebfe0</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">nvSoftHelpEx.exe(4.2.0.2)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2016-11-04</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">bf92d23cfa6e941181880a06c6735e8d2a84a0c2</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">nvSoftHelpEx.exe(4.2.0.4)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2017-01-19</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">4b764c612ee3a0d773eff51012403b01bb183158</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">QyNthxlnsxy.exe(6.2.0.4)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2017-01-19</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">840b51615c16e908ac1dd7a71ef9ff0d72042fcf</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">ASoftDevHe.exe(8.2.0.4)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2017-01-19</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">f89f0d96475ba95197dbb4c1d7449793c941b19a</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">PjczMqnopyx.exe(9.2.0.4)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2017-01-19</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">9584cc3b35cad7a2d0b16e89cae27ae440d71475</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">zethelpEx64.exe(4.2.0.4)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2017-01-03</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">c68380c65e25e2f906a0928022f9b9d3511dd28e</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">MsVwmlbkgn.sys(0.6.60.66)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2016-11-25</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">5832935e3d08b40a730b11d3263606a485802048</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">MsVwmlbkgn.sys(0.6.60.68)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2017-01-03</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">8032e9ec79546d7fb875227fa984860ce432ce34</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">MsVwmlbkgn.sys(0.6.60.70)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2017-01-18</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">804ddba4d498a087c3153c4d0a668d230a2a9ecc</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">MsVwmlbkgn64.sys(0.6.60.66)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2016-11-25</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">98526463435f47b66212176a1d921a05cf7e2fb7</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">MsVwmlbkgn64.sys(0.6.60.68)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2017-01-03</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">c38df45eef5b3a9081dfbd7cd2c7d3cac2cfea92</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">MsVwmlbkgn64.sys(0.6.60.70)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2017-01-18</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">a71f16958f37a860968f8f92db391691758b48e4</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">iexplorer_helper.dat  (5.0.0.1)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2017-01-20</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">5f336d5aad078c1f8e4313e8bddc4bb2960cc8db</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">npjuziplugin.dll  (1.0.0.1018)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2016-03-17</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">286c0828918daa85b19f2d4ca18eda1db8a926ab</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">npjuziplugin.dll  (1.0.0.1020)</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2016-08-18</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">4fc5607bcfb608b7a64fb2b515f1f955fb178957</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">svcprotect_32_1.0.0.9.dat</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2017-01-10</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">96b93e21622da2a0e73d0bee061a810094bb5669</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">svcprotect_32_1.0.0.11.dat</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2017-01-23</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">853a6dfb0aa1e30f871f87d13719e82fab6987cf</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">svcprotect_64_1.0.0.9.dat</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2017-01-10</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">02a4468b263e341b63f3cb709fe4f5f1115db53a</div>
</div>
</td>
</tr>
<tr>
<td width="180">
<div align="left">
<div align="left">svcprotect_64_1.0.0.11.dat</div>
</div>
</td>
<td width="77">
<div align="left">
<div align="left">2017-01-23</div>
</div>
</td>
<td width="244">
<div align="left">
<div align="left">e9a62a8e198268de04a3378803f19d0b8213f497</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;</p>
<blockquote><p>2.2        C&amp;C服务器指令接口</p></blockquote>
<div align="center">
<table class="t_table" cellspacing="0">
<tbody>
<tr>
<td width="223">
<div align="right">
<div align="center">C&amp;C服务器指令接口</div>
</div>
</td>
<td width="223">
<div align="right">
<div align="center">描述</div>
</div>
</td>
</tr>
<tr>
<td width="223">
<div align="left">
<div align="left">http://update.123juzi.net/update.php</div>
</div>
</td>
<td width="223">
<div align="left">
<div align="left">恶意代码更新（nvMultitask.exe）</div>
</div>
</td>
</tr>
<tr>
<td width="223">
<div align="left">
<div align="left">http://update.123juzi.net/ccl.php</div>
</div>
</td>
<td width="223">
<div align="left">
<div align="left">恶意代码更新（svcprotect.dat）</div>
</div>
</td>
</tr>
<tr>
<td width="223">
<div align="left">
<div align="left">http://update.123juzi.net/getupfs2.php</div>
</div>
</td>
<td width="223">
<div align="left">
<div align="left">用户级劫持控制指令（svcprotect.dat）</div>
</div>
</td>
</tr>
<tr>
<td width="223">
<div align="left">
<div align="left">http://update.qyllq.net/test_json.php</div>
</div>
</td>
<td width="223">
<div align="left">
<div align="left">用户级劫持控制指令1（iexplorer_helper.dat）</div>
</div>
</td>
</tr>
<tr>
<td width="223">
<div align="left">
<div align="left">http://api.qyllq.com/url_loc.php</div>
</div>
</td>
<td width="223">
<div align="left">
<div align="left">用户级劫持控制指令2（iexplorer_helper.dat）</div>
</div>
</td>
</tr>
<tr>
<td width="223">
<div align="left">
<div align="left">http://update.qyllq.com/tnpp.php</div>
</div>
</td>
<td width="223">
<div align="left">
<div align="left">用户级劫持控制指令3（iexplorer_helper.dat）</div>
</div>
</td>
</tr>
<tr>
<td width="223">
<div align="left">
<div align="left">http://update.qyllq.net/ntdl.php</div>
</div>
</td>
<td width="223">
<div align="left">
<div align="left">旧版内核级劫持控制指令</div>
</div>
</td>
</tr>
<tr>
<td width="223">
<div align="left">
<div align="left">http://update.qyllq.com/getupfs2.php</div>
</div>
</td>
<td width="223">
<div align="left">
<div align="left">新版内核级劫持控制指令</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>&nbsp;</p>
<p>【本文由火绒安全原创投稿至安全脉搏，由火绒安全入驻账号发布；火绒安全让所有人都可以安全、安静、自由地使用智能终端设备 ；转载请注明来源安全脉搏】</p>
		<div class="pageShenming">
【安全脉搏：分享技术、悦享品质。文章仅代表作者看法，如有不同观点，欢迎添加安全脉搏微信号：SecPulse，进行交流。】</div>
<div class="post-tags"><span>Tags: </span><a href="https://www.secpulse.com/archives/tag/bime-dll" rel="tag">bime.dll</a><a href="https://www.secpulse.com/archives/tag/explorer-exe" rel="tag">explorer.exe</a><a href="https://www.secpulse.com/archives/tag/hsoftdoloex" rel="tag">HSoftDoloEx</a><a href="https://www.secpulse.com/archives/tag/lcscience-sys" rel="tag">LcScience.sys</a><a href="https://www.secpulse.com/archives/tag/nvmultitask" rel="tag">nvMultitask</a><a href="https://www.secpulse.com/archives/tag/nvmultitask-exe" rel="tag">nvMultitask.exe</a><a href="https://www.secpulse.com/archives/tag/roguenetreaper" rel="tag">Rogue/NetReaper</a><a href="https://www.secpulse.com/archives/tag/%e4%ba%91%e6%8e%a7%e5%8a%ab%e6%8c%81" rel="tag">云控劫持</a><a href="https://www.secpulse.com/archives/tag/%e5%8a%ab%e6%8c%81%e5%af%bc%e8%88%aa" rel="tag">劫持导航</a><a href="https://www.secpulse.com/archives/tag/%e5%8a%ab%e6%8c%81%e6%a6%82%e7%8e%87" rel="tag">劫持概率</a><a href="https://www.secpulse.com/archives/tag/%e6%81%b6%e6%84%8f%e4%bb%a3%e7%a0%81" rel="tag">恶意代码</a><a href="https://www.secpulse.com/archives/tag/%e6%9c%8d%e5%8a%a1%e5%99%a8" rel="tag">服务器</a><a href="https://www.secpulse.com/archives/tag/%e6%b5%81%e9%87%8f%e5%8a%ab%e6%8c%81" rel="tag">流量劫持</a><a href="https://www.secpulse.com/archives/tag/%e6%b5%81%e9%87%8f%e6%94%b6%e5%89%b2%e8%80%85" rel="tag">流量收割者</a><a href="https://www.secpulse.com/archives/tag/%e7%81%ab%e7%bb%92%e4%b8%93%e6%9d%80%e5%b7%a5%e5%85%b7" rel="tag">火绒专杀工具</a><a href="https://www.secpulse.com/archives/tag/%e7%97%85%e6%af%92" rel="tag">病毒</a></div>
		</div>
	<!-- .single-content -->
		<div class="pageActive">
	<div class="mark-like-btn">
							</div>
	<!-- Baidu Button BEGIN -->
	<div class="bdshare">
		<div class="bdsharebuttonbox">
			<a href="#" class="bds_more" data-cmd="more"></a><a href="#"
				class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#"
				class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#"
				class="bds_weixin" data-cmd="weixin" title="分享到微信"></a>
		</div>
		<script>
		window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"32"},"share":{}};
		with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
		</script>

	</div>
</div>    <section id="text-6" class="widget-container widget_text hidden-xs">			<div class="textwidget"><center><a href="https://www.duoyinsu.com" target="_blank" title="安识科技 专业安全服务商"><img src="https://www.secpulse.com/wp-includes/images/secweixin.png" style="width:785px;height:315px"></a><center></div>
		</section><section id="related_post-2" class="widget-container widget_related_post hidden-xs"><h3 class="widget-title">相关文章</h3>

	<ul class="related_post">
				<li><a href="https://www.secpulse.com/archives/59719.html" title="详细阅读 恶性病毒Kuzzle&#8221;攻破&#8221;安全厂商白名单 用户重装系统也难以清除">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=https://www.secpulse.com/wp-content/uploads/2017/08/timg.jpg&h=150&w=249&zc=1" alt="恶性病毒Kuzzle&#8221;攻破&#8221;安全厂商白名单 用户重装系统也难以清除" class="xg-img"/>
		<p>恶性病毒Kuzzle&#8221;攻破&&hellip;</P></a></li>
				<li><a href="https://www.secpulse.com/archives/58956.html" title="详细阅读 安天针对攻击乌克兰等国的“必加”(PETYA)病毒分析与应对">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=https://www.secpulse.com/wp-content/uploads/2017/06/117.png&h=150&w=249&zc=1" alt="安天针对攻击乌克兰等国的“必加”(PETYA)病毒分析与应对" class="xg-img"/>
		<p>安天针对攻击乌克兰等国的“必加”(PET&hellip;</P></a></li>
				<li><a href="https://www.secpulse.com/archives/57197.html" title="详细阅读 MySQL Order By 注入总结">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=https://www.secpulse.com/wp-content/uploads/2017/03/QQ截图20170329200255.png&h=150&w=249&zc=1" alt="MySQL Order By 注入总结" class="xg-img"/>
		<p>MySQL Order By 注入总结</P></a></li>
			</ul>


</section></article>


<!-- 引用 -->
<div id="comments" class="comments-area">
		<h2 class="comments-title">
		1条评论
	</h2>
<!-- 显示正在加载新评论 -->
 <div id="loading-comments"><span>评论加载中，请稍等...</span></div>
	<ul class="commentlist">
			
	<li class="comment byuser comment-author-xmirror even thread-even depth-1" id="comment-7725">
	<div class="comment-author"><img src="https://www.secpulse.com/wp-content/uploads/2017/03/xmirror1-150x150.png" width="40" height="40" alt="悬镜安全实验室" class="avatar avatar-40 wp-user-avatar wp-user-avatar-40 alignnone photo" /></div>
			<div id="div-comment-7725" class="commenttext">
		<div class="commentmeta">
		
		<!--<cite class="fn"><a href='http://www.xmirror.cn/' rel='external nofollow' class='url'>悬镜安全实验室</a></cite> <span class="says">:</span>-->
		<span class="commentid"><a href='http://www.xmirror.cn/' rel='external nofollow' target='_blank' class='url'>悬镜安全实验室</a></span>
		<span class="comment-meta commentmetadata">
			<a href="https://www.secpulse.com/archives/56182.html#comment-7725"></a>
			<span class="commenttime">
				2017年03月03日 下午5:22											
				</span>
			</span>
			<span class="reply">&nbsp;<a class='comment-reply-link' href='/archives/56182.html?replytocom=7725#respond' onclick='return addComment.moveForm( "comment-7725", "7725", "respond", "56182" )' aria-label='回复给悬镜安全实验室'>回复</a></span>
		</span>
	</div>
	<div class="commentp"><p>666</p>
</div>
			</div>
	</li><!-- #comment-## -->
	</ul><!-- .comment-list -->

			<div id="respond" class="comment-respond row">
		


			<form action="https://www.secpulse.com/wp-comments-post.php" method="post" id="commentform">
		
				
						
			<div id="comboxinfo">
					<div class="cominfodiv cominfodiv-author ">
					<p for="author" class="nicheng">
     <input type="text" name="author" id="author" class="texty" value="" tabindex="1" /> <span class="required">昵称*</span>
      </p>
</div>
					<div class="cominfodiv cominfodiv-email">
					<p for="email">	<input type="text" name="email" id="email" class="texty" value="" tabindex="2" /> <span class="required">邮箱*</span>
						</p>
					</div>
					<div class="cominfodiv cominfodiv-url">
					 	<p for="url"><input type="text" name="url" id="url" class="texty" value="" tabindex="3" /><span>网址 </span>
						</p>
					</div>
					
			
				
</div>		       <div class=" cominfodiv-nr">  
<textarea class="texty" name="w" id="comment" rows="10" tabindex="4" placeholder="输入评论内容..."></textarea><textarea name="comment" cols="100%" rows="4" style="display:none"></textarea>
							<div class="submitcom">
							
					<input id="submit" name="submit" type="submit" tabindex="5" value="提&nbsp;交"/>
					<input type='hidden' name='comment_post_ID' value='56182' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="9521065e7a" /></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="215"/></p>				</div>
				<div id="cancel_comment_reply"><a rel="nofollow" id="cancel-comment-reply-link" href="/archives/56182.html#respond" style="display:none;">取消回复</a></div>
			
</div>
			
				
			</form>
			
			
			<script type="text/javascript">
				document.getElementById("comment").onkeydown = function (moz_ev){
				var ev = null;
				if (window.event){
				ev = window.event;
				}else{
				ev = moz_ev;
				}
				if (ev != null && ev.ctrlKey && ev.keyCode == 13){
				document.getElementById("submit").click();}
				}
			</script></div>
	 		
</div>
<!-- #comments --></div>
		
<div class="xs-right sidebar xs-hidden xss-hidden">
	<div class="authorbox">
	<div class="author-top">
<div id="author-img">
<img src="https://www.secpulse.com/wp-content/uploads/2017/01/Newlogo_150x150.jpg" width="96" height="96" alt="火绒安全" class="avatar avatar-96 wp-user-avatar wp-user-avatar-96 alignnone photo" />
</div>
<div class="au-name">
<a href="https://www.secpulse.com/archives/author/mini-fox" title="由火绒安全发布" rel="author">火绒安全</a><br>
 <span class="au-title">总共10篇文章</span>
</div> </div>
	<div class="author-word"><span class="quotes q1"></span>
火绒安全让所有人都可以安全、安静、自由地使用智能终端设备	<span class="quotes q2"></span></div>
	</div>
	
				<aside id="recent-posts-2" class="widget-container widget_recent_entries">		<div class="si-title"><h2>最新脉搏</h2></div>		<ul>
					<li>
				<a href="https://www.secpulse.com/archives/60653.html">《安天365安全研究》第5期</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60630.html">供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60605.html">2017先知创新大会：有ZHI而来</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60576.html">甲方工作杂谈</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60394.html">Catfish—缓存漏洞&#038;&#038;配合CSRF到Getshell</a>
						</li>
				</ul>
		</aside><aside id="hot_comment-3" class="widget-container widget_hot_comment"><div class="si-title"><h2>脉搏热评</h2></div>
	<ul class="hot_comment_widget">
		
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59497.html" rel="bookmark" title="XSS挑战之旅学习总结 (7条评论)" >XSS挑战之旅学习总结</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59065.html" rel="bookmark" title="web安全之如何全面发现系统后台 (6条评论)" >web安全之如何全面发现系统后台</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59770.html" rel="bookmark" title="电商的支付风控怎么玩？ (3条评论)" >电商的支付风控怎么玩？</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59466.html" rel="bookmark" title="安天移动安全联合猎豹揭秘无形之贼Dosoft免杀病毒 (2条评论)" >安天移动安全联合猎豹揭秘无形之贼Doso&hellip;</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59262.html" rel="bookmark" title="跟着DVWA学Web安全开发 (2条评论)" >跟着DVWA学Web安全开发</a></li>			</ul>

</aside><aside id="random_post-2" class="widget-container widget_random_post"><div class="si-title"><h2>随机脉搏</h2></div>

	<ul class="random_post">
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/18848.html" rel="bookmark" title="详细阅读 边锋网络三国杀insert型SQLi">边锋网络三国杀insert型SQLi</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/22423.html" rel="bookmark" title="详细阅读 某不知名CMS通杀SQL漏洞之二">某不知名CMS通杀SQL漏洞之二</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/11188.html" rel="bookmark" title="详细阅读 北京联通宽带邮箱系统struts命令执行">北京联通宽带邮箱系统struts命令执行</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/34249.html" rel="bookmark" title="详细阅读 人人贷之向方便面学习账号爆破（弱弱的问句那个搞运维的是妹子么）">人人贷之向方便面学习账号爆破（弱弱的问句那个搞运维的是妹子么）</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/29036.html" rel="bookmark" title="详细阅读 百度某业务站点XSS跨站">百度某业务站点XSS跨站</a></li>
					</ul>


</aside><aside id="text-11" class="widget-container widget_text"><div class="si-title"><h2>脉搏官方微信公众号</h2></div>			<div class="textwidget"><img src="https://www.secpulse.com/wp-includes/images/SecPulse.png" width="280px" height="364px" /></div>
		</aside>				</div>
	</div>

	</section>

  <div class="inner row visible-lg-block">

	<div class="friends">
		<h3>友情链接</h3>
		<ul>
			<li><a href="https://xianzhi.aliyun.com/forum/?secpulse" target="_blank">先知安全社区</a><span>|</span></li>
			<li><a href="https://threathunter.org/" target="_blank">ThreatHunter社区</a><span>|</span></li>
			<li><a href="http://www.ijiandao.com/" target="_blank">网络尖刀</a><span>|</span></li>
			<li><a href="http://navisec.it/" target="_blank">NaviSec导航</a><span>|</span></li>
		    <li><a href="https://www.easyaq.com/" target="_blank">E安全</a><span>|</span></li>
			<li><a href="http://www.sec-wiki.com/" target="_blank">Sec-Wiki</a><span>|</span></li>
			<li><a href="http://www.waitalone.cn/" target="_blank">独自等待</a><span>|</span></li>
			<li><a href="http://www.shellsec.com/" target="_blank">神刀网</a><span>|</span></li>
			<li><a href="http://www.ineice.com/" target="_blank">爱内测</a><span>|</span></li>
			<li><a href="http://www.itet.cn/" target="_blank">北京ITET培训中心</a><span>|</span></li>
			<li><a href="http://www.ihonker.org/" target="_blank">中国红客联盟</a><span>|</span></li>
			<li><a href="http://www.bigniu.com/" target="_blank">比戈大牛</a><span>|</span></li>
			<li><a href="http://www.tiejiang.org/" target="_blank">铁匠运维网</a><span>|</span></li>
			<li><a href="http://www.nagain.com" target="_blank">娜迦信息</a><span>|</span></li>
			<li><a href="https://www.secsilo.com/" target="_blank">SecSilo</a><span>|</span></li>
			<li><a href="https://team.armyzer0.com" target="_blank">armyzer0</a><span>|</span></li>
			<li><a href="http://www.nosafe.org" target="_blank">NoSafe</a></li>
		</ul>
	</div>

	<div class="friends">
		<h3>合作伙伴</h3>
		<ul>
			<a href="https://www.duoyinsu.com" class="external" target="_blank">
				<img src="https://www.secpulse.com/wp-content/uploads/anshi-logo.png"
				alt="安识科技" width="150px" height="45px">
			</a>
			<a href="http://aq.163.com/module/partner.html" class="external"
				target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/netease.jpg"
				alt="网易安全中心" width="150px" height="45px">
			</a>
			<a href="https://security.alibaba.com/" class="external"
				target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/asrc.jpg"
				alt="阿里安全中心" width="150px" height="45px">
			</a>
			
			<a href="http://yaq.qq.com/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/yaqnew.png" alt="腾讯御安全"
				width="140px" height="45px">
			</a>
			
			<a href="http://www.4hou.com" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/4hou.png"
				alt="嘶吼RoarTalk" width="150px" height="45px">
			</a>
			
			<a href="http://www.ichunqiu.com/?from=secpulse" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/ichunqiu.png" alt="i春秋学院"
				width="140px" height="45px">
			</a>

			<a href="#" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/bigsec.png" alt="bigsec岂安科技"
				width="140px" height="45px">
			</a>
		
			<a href="http://www.milw0rm.cn/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/milw0rm.png"
				alt="Milw0rm Team" width="120px" height="40px">
			</a>


			<a href="#" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/cloversec.png"
				alt="四叶草安全" width="130px" height="45px">
			</a>
			<a href="https://www.aqdog.com" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/aqdog.png"
				alt="安犬云平台" width="140px" height="45px">
			</a>
			
			<a href="http://www.e365.org/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/e365.png"
				alt="易安在线" width="130px" height="45px">
			</a>
			
			
			

		</ul>
	</div>
</div>
<footer class="footer clr" id="footer">
	<div class="inner inner-footer">
		<div class="footer-secpulse">
			<h3>SecPulse</h3>
			<ul>
				<li><a href="/about">关于SecPulse</a></li>
				<!--<li><a href="http://test.secpulse.com">SecPulse专测</a> <sup>NEW!</sup></li>-->
				<li><a href="/hire">加入我们</a></li>
				<li><a href="/report">寻求报道</a></li>
				<li><a href="/contact-us">联系我们</a></li>
			</ul>
		</div>
		<div class="footer-subscribe xs-hidden">
			<h3>订阅</h3>
			<ul>
				<li><a href="/feed">RSS订阅</a></li>
				<li><a href="/feed">邮箱订阅</a></li>
				<li><a href="/feed">线下活动订阅</a></li>
				<li></li>
				<li><a href="http://weibo.com/311057789">官方微博</a></li>
				<!-- <li><a href="https://twitter.com/secpulse">Twitter</a></li> -->
			</ul>
		</div>
		<div class="footer-partner">
			<h3>全力驱动</h3>
			<ul class="cf">
				<li><a href="https://www.secpulse.com" class="external"
					target="_blank"><img
						src="https://www.secpulse.com/wp-content/uploads/seclogo.png"
						alt="安全脉搏" width="200px"></a></li>
			</ul>
		</div>
		<div class="footer-copyright xs-hidden">
			<p>本站由SecPulse安全脉搏团队全力维护。</p>
			<p>
				Powered By <a title="安全脉搏" href="https://www.secpulse.com">SecPulse</a>
			</p>
			<p>©2013-2017 安全脉搏</p>
			<p>沪ICP备16016474号</p>
			<img src="https://www.secpulse.com/wp-includes/images/qrcode.jpg"
				alt="Qrcode" height="150px" width="150px">

		</div>
	</div>
</footer>
<div id="shangxia">
	<div id="shang" title="↑ 返回顶部"></div>
              <div id="comt" title="查看评论"></div>
              <div id="xia" title="↓ 移至底部"></div>
</div>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/plugins/akismet/_inc/form.js?ver=3.1.2'></script>
</body>

</html>
