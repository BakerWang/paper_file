<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />	
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="renderer" content="webkit">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0">
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<title>修改硬盘固件的木马 探索方程式（EQUATION）组织的攻击组件 - SecPulse.COM | 安全脉搏</title>
<meta name="description" content="1、背景" />
<meta name="keywords" content="_SD_IP_CF.dll,360安全卫士,Avira,BitDefender,DesertWinterDriver.sys,DoubleFantasy,Equation,Equation Group,EquationDrug,EquationLaser,EQUESTRE,Fanny,GrayFish,GROK keylogger,IoControlCode,KeServiceDescriptorTable,MSNDSRV.SYS,nls_933w.dll,nt!NtAcceptConnectPort,TripleFantasy,win32m.sys,安天分析小组,攻击前导,方程式组织" />

<link rel='stylesheet' id='style-css'  href='https://www.secpulse.com/wp-content/themes/sec/style.css?ver=2014.9.21' type='text/css' media='all' />
<link rel='stylesheet' id='jquery.fancybox-css'  href='https://www.secpulse.com/wp-content/themes/sec/css/jquery.fancybox.css?ver=1.0' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-css'  href='https://www.secpulse.com/wp-content/themes/sec/css/font-awesome.min.css?ver=1.0' type='text/css' media='all' />
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.min.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.fancybox.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/helpers/jquery.fancybox-buttons.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.mousewheel-3.0.6.pack.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/owl.carousel.min.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/custom.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/comments-ajax.js?ver=1.3'></script>
<link rel='canonical' href='https://www.secpulse.com/archives/5326.html' />
<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?7f4cc5524dcb1aec487b4266c18bae48";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


</head>
<body class="single single-post postid-5326 single-format-standard">
	<header id="header" class="header clr">
		<div class="header-top inner clr">
	<hgroup class="logo-main"><h1 class="logo"><a href="https://www.secpulse.com/" rel="home" title="安全脉搏">安全脉搏</a></h1><h4 class="xs-hidden">分享技术，悦享品质 
	</h4>
	</hgroup>

<div class="login xs-hidden">
				<div class="logindiv">
					<div class="img">
<img src="https://www.secpulse.com/wp-content/uploads/2017/05/rabbit.jpeg" width="36" height="36" alt="" class="avatar avatar-36 wp-user-avatar wp-user-avatar-36 photo avatar-default" /></div><span href="javascript:void(0);" title="用户" class="yh">用户</span><i
						class="fa fa-caret-down fa-2"></i>
					<ul class="login-links">
						<li class="log"><a
							href="https://www.secpulse.com/wp-login.php"
							target="_blank"><i class="fa fa-arrow-right"></i><span>登陆</span></a></li>
						<li class="exit"><a
							href="https://www.secpulse.com/wp-login.php?action=register"><i
								class="fa fa-user-times"></i><span>注册</span></a></li>
					</ul>
	
  </div>
			</div>
			<div class="top-search xs-hidden">
  <form id="search" method="get" action="https://www.secpulse.com" >
	<input type="text" name="s" id="s" autocomplete="off"  placeholder="输入搜索内容">
	<button class="btn-search"> <i class="fa fa-search"></i></button>
</form></div>
			<div class="menu-button">
				<i class="fa fa-bars fa-3x"></i>
			</div>
		</div>


		<div class="main-nav  xs-hidden">
			<div class="inner clr"><nav class="left-nav clr"><ul id="menu-%e5%af%bc%e8%88%aa" class="header-menu-nav"><li id="menu-item-15" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15"><a href="https://www.secpulse.com/">首页</a></li>
<li id="menu-item-17" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-17"><a href="https://www.secpulse.com/archives/category/articles">文章</a>
<ul class="sub-menu">
	<li id="menu-item-34048" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34048"><a href="https://www.secpulse.com/archives/category/articles/intranet-penetration">内网渗透</a></li>
	<li id="menu-item-34047" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34047"><a href="https://www.secpulse.com/archives/category/articles/code-audit">代码审计</a></li>
	<li id="menu-item-34046" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34046"><a href="https://www.secpulse.com/archives/category/articles/web">Web安全</a></li>
	<li id="menu-item-34565" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34565"><a href="https://www.secpulse.com/archives/category/articles/sec-doc">安全文献</a></li>
	<li id="menu-item-34568" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34568"><a href="https://www.secpulse.com/archives/category/articles/social-engineering">社会工程</a></li>
	<li id="menu-item-35948" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35948"><a href="https://www.secpulse.com/archives/category/articles/wireless">无线安全</a></li>
	<li id="menu-item-35949" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35949"><a href="https://www.secpulse.com/archives/category/articles/mobile-security">移动安全</a></li>
	<li id="menu-item-35950" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-35950"><a href="https://www.secpulse.com/archives/category/articles/system">系统安全</a>
	<ul class="sub-menu">
		<li id="menu-item-35951" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35951"><a href="https://www.secpulse.com/archives/category/articles/system/linux">Linux</a></li>
		<li id="menu-item-35952" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35952"><a href="https://www.secpulse.com/archives/category/articles/system/windows">Windows</a></li>
	</ul>
</li>
	<li id="menu-item-35953" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35953"><a href="https://www.secpulse.com/archives/category/articles/reverse-break">逆向破解</a></li>
</ul>
</li>
<li id="menu-item-18" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-has-children menu-item-18"><a href="https://www.secpulse.com/archives/category/news">资讯</a>
<ul class="sub-menu">
	<li id="menu-item-35956" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35956"><a href="https://www.secpulse.com/archives/category/news/china-news">国内资讯</a></li>
	<li id="menu-item-35957" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-35957"><a href="https://www.secpulse.com/archives/category/news/world-news">国外资讯</a></li>
</ul>
</li>
<li id="menu-item-379" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-379"><a href="https://www.secpulse.com/archives/category/construction">安全建设</a>
<ul class="sub-menu">
	<li id="menu-item-51480" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51480"><a href="https://www.secpulse.com/archives/category/construction/securityissue">安全管理</a></li>
	<li id="menu-item-54332" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54332"><a href="https://www.secpulse.com/archives/category/construction/%e4%b8%9a%e5%8a%a1%e5%ae%89%e5%85%a8">业务安全</a></li>
	<li id="menu-item-35955" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35955"><a href="https://www.secpulse.com/archives/category/construction/bigdata">数据分析</a></li>
	<li id="menu-item-54333" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54333"><a href="https://www.secpulse.com/archives/category/construction/security-reports">安全报告</a></li>
</ul>
</li>
<li id="menu-item-368" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-368"><a href="https://www.secpulse.com/archives/category/exclusive">独家</a>
<ul class="sub-menu">
	<li id="menu-item-35947" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35947"><a href="https://www.secpulse.com/archives/category/articles/industrial-safety">工控安全</a></li>
	<li id="menu-item-35954" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35954"><a href="https://www.secpulse.com/archives/category/exclusive/ctf-writeup">CTF</a></li>
	<li id="menu-item-50217" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-50217"><a href="https://www.secpulse.com/archives/category/exclusive/duoyinsu">多因素令牌</a></li>
	<li id="menu-item-51479" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51479"><a href="https://www.secpulse.com/archives/category/exclusive/dataleakage">数据泄露</a></li>
</ul>
</li>
<li id="menu-item-16" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-16"><a href="https://www.secpulse.com/archives/category/tools">工具</a></li>
<li id="menu-item-52" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-52"><a href="https://www.secpulse.com/archives/category/hiring">招聘</a></li>
<li id="menu-item-50" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50"><a href="https://www.secpulse.com/newsend">投稿</a></li>
<li id="menu-item-6645" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6645"><a href="https://www.secpulse.com/archives/category/vul">漏洞</a></li>
</ul></nav>  <nav class="right-nav clr "><ul id="menu-%e5%af%bc%e8%88%aa%e4%ba%8c" class="header-menu-nav"><li id="menu-item-33967" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33967"><a title="付费渗透测试" href="http://service.secpulse.com">安全服务</a></li>
<li id="menu-item-52043" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-52043"><a title="安全从业者最实用的安全导航" href="http://nav.secpulse.com">安全导航</a></li>
<li id="menu-item-33966" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33966"><a title="安识科技" href="https://www.duoyinsu.com">多因素</a></li>
</ul></nav></div>
		</div>
		<div class="nav-bg"></div>
   <nav class="mini-nav visible-xs"><ul id="menu-%e5%af%bc%e8%88%aa-1" class="menu-mini-nav"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15"><a href="https://www.secpulse.com/">首页</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-17"><a href="https://www.secpulse.com/archives/category/articles">文章</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34048"><a href="https://www.secpulse.com/archives/category/articles/intranet-penetration">内网渗透</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34047"><a href="https://www.secpulse.com/archives/category/articles/code-audit">代码审计</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34046"><a href="https://www.secpulse.com/archives/category/articles/web">Web安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34565"><a href="https://www.secpulse.com/archives/category/articles/sec-doc">安全文献</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34568"><a href="https://www.secpulse.com/archives/category/articles/social-engineering">社会工程</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35948"><a href="https://www.secpulse.com/archives/category/articles/wireless">无线安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35949"><a href="https://www.secpulse.com/archives/category/articles/mobile-security">移动安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-35950"><a href="https://www.secpulse.com/archives/category/articles/system">系统安全</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35951"><a href="https://www.secpulse.com/archives/category/articles/system/linux">Linux</a></li>
		<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35952"><a href="https://www.secpulse.com/archives/category/articles/system/windows">Windows</a></li>
	</ul>
</li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35953"><a href="https://www.secpulse.com/archives/category/articles/reverse-break">逆向破解</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-has-children menu-item-18"><a href="https://www.secpulse.com/archives/category/news">资讯</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35956"><a href="https://www.secpulse.com/archives/category/news/china-news">国内资讯</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-35957"><a href="https://www.secpulse.com/archives/category/news/world-news">国外资讯</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-379"><a href="https://www.secpulse.com/archives/category/construction">安全建设</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51480"><a href="https://www.secpulse.com/archives/category/construction/securityissue">安全管理</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54332"><a href="https://www.secpulse.com/archives/category/construction/%e4%b8%9a%e5%8a%a1%e5%ae%89%e5%85%a8">业务安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35955"><a href="https://www.secpulse.com/archives/category/construction/bigdata">数据分析</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54333"><a href="https://www.secpulse.com/archives/category/construction/security-reports">安全报告</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-368"><a href="https://www.secpulse.com/archives/category/exclusive">独家</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35947"><a href="https://www.secpulse.com/archives/category/articles/industrial-safety">工控安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35954"><a href="https://www.secpulse.com/archives/category/exclusive/ctf-writeup">CTF</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-50217"><a href="https://www.secpulse.com/archives/category/exclusive/duoyinsu">多因素令牌</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51479"><a href="https://www.secpulse.com/archives/category/exclusive/dataleakage">数据泄露</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-16"><a href="https://www.secpulse.com/archives/category/tools">工具</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-52"><a href="https://www.secpulse.com/archives/category/hiring">招聘</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50"><a href="https://www.secpulse.com/newsend">投稿</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6645"><a href="https://www.secpulse.com/archives/category/vul">漏洞</a></li>
</ul></nav>     </header><section class="xs-main index-main clr">
<div class="inner">
<div class="xs-left">
<nav class="crumbs">现在位置： <a title="返回首页" href="https://www.secpulse.com">首页</a> &gt; <a href="https://www.secpulse.com/archives/category/news">资讯</a> &gt; <a href="https://www.secpulse.com/archives/category/news/world-news" rel="category tag">国外资讯</a> &gt;  正文 </nav><article id="post-5326" class="post-5326 post type-post status-publish format-standard hentry category-world-news tag-_sd_ip_cf-dll tag-2074 tag-avira tag-bitdefender tag-desertwinterdriver-sys tag-doublefantasy tag-equation tag-equation-group tag-equationdrug tag-equationlaser tag-equestre tag-fanny tag-grayfish tag-grok-keylogger tag-iocontrolcode tag-keservicedescriptortable tag-msndsrv-sys tag-nls_933w-dll tag-ntntacceptconnectport tag-triplefantasy tag-win32m-sys tag-2071 tag-2070 tag-2009">
	<header class="single-header">
		<h1>修改硬盘固件的木马 探索方程式（EQUATION）组织的攻击组件</h1>
			<div class="single-meta">
				
		    <div class="time"><i></i> <a href="javascript:void(0);">2015 /3/13 13:48</a></div>
			<div class="eye xs-hidden"><i class="fa fa-eye fa-1"></i><a href="javascript:void(0);">6,209</a> </div>			<div class="comments xs-hidden"><i class="fa fa-comments fa-1"></i><a href="https://www.secpulse.com/archives/5326.html#respond">沙发</a></div>
			
			
		</div>
		<!-- .entry-meta -->
	</header>
	<!-- .single-header -->

	<div class="single-main">
		<h2>1、背景</h2>
<p>2015年2月18日，安天实验室根据紧急研判，对被友商称为“方程式（Equation）”的攻击组织所使用的攻击组件，开始了初步的分析验证。后于2月25日正式组建了跨部门联合分析小组，于3月4日形成本报告第一版本。</p>
<p>事件相关背景为：卡巴斯基安全实验室在2月16日起发布系列报告（以下简称“友商报告”），披露了一个可能是目前世界上存在的最复杂的网络攻击组织&gt;——“方程式”组织（Equation Group）<sup>[1]</sup>。</p>
<p><span style="color: #008000">据卡巴斯基实验室称，该组织使用的C&amp;C早在1996年就被注册，这暗示了该组织可能已经活跃了20年之久。</span></p>
<p><span style="color: #008000">多年以来，他们因总能比其他组织早发现漏洞，从而具有绝对的优势。关于这个，看安全脉搏之前的<a href="http://www.secpulse.com/archives/5267.html" target="_blank">介绍</a>。</span></p>
<p>该组织拥有一套用于植入恶意代码的超级制式信息武器库（在友商报告中披露了其中6个），其中包括两个可以对数十种常见品牌的硬盘固件重编程的恶意模块，这可能是该组织掌握的最具特色的攻击武器，同时也是首个已知的能够感染硬盘固件的恶意代码。在2月17日和2月19日的友商报告中，先后发布了其中2个模块的详细分析结果，它们分别是Fanny<sup>[2]</sup>和DoubleFantasy<sup>[3]</sup>。</p>
<p><span style="color: #008000">卡巴斯基根据相关线索分析，认为被攻击目标包括俄罗斯、印度、中国等国家，而相关媒体根据卡巴斯基的报告，推断出该攻击组织可能与美国情报机构相关。</span></p>
<p>鉴于样本的复杂性，以及攻击硬盘固件的特殊特点，分析进展极为缓慢，目前将有限的分析工作对外分享，旨在推动更多的业内参与协作。同时对友商报告中已经充分论述的内容，本报告未作更多引用和重复。因此建议读者先阅读友商报告，再阅读本报告以给予批评指正。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/03/EQUATION.jpg"><img class="alignnone size-full wp-image-5353" src="http://www.secpulse.com/wp-content/uploads/2015/03/EQUATION.jpg" alt="EQUATION" width="548" height="548" /></a></p>
<h2>2 、Equation组织使用的组件</h2>
<p>Equation组织的被发现的武器库中至少有6件“装备”，它们是：EquationLaser、EquationDrug、DoubleFantasy、TripleFantasy、Fanny和GrayFish。</p>
<p>安天的工程师称其为“组件”。除了这6个组件外，友商报告还提供了该组织有可能用到的其它恶意代码程序的哈希，这些哈希对应的程序包括：与EquationDrug相似的EQUESTRE、键盘记录器程序GROK keylogger、DoubleFantasy安装程序和LNK漏洞利用程序_SD_IP_CF.dll，以及需要重点关注的能够对硬盘重新编程的模块nls_933w.dll。</p>
<table>
<tbody>
<tr>
<td width="110"><strong>组件名称</strong></td>
<td width="334"><strong>说明</strong></td>
<td colspan="2" width="109"><strong>时间</strong></td>
</tr>
<tr>
<td width="110"><strong>EquationLaser</strong></td>
<td colspan="2" width="362">Equation组织早期使用的植入程序，大约在2001至2004年间被使用。兼容Windows 95/98系统。</td>
<td width="81">2001-2003</td>
</tr>
<tr>
<td width="110"><strong>EquationDrug</strong></td>
<td colspan="2" width="362">该组织使用的一个非常复杂的攻击组件，用于支持能够被攻击者动态上传和卸载的模块插件系统。怀疑是EquationLaser的升级版。</td>
<td width="81">2003-2013</td>
</tr>
<tr>
<td width="110"><strong>DoubleFantasy</strong></td>
<td colspan="2" width="362">一个验证式的木马，旨在确定目标为预期目标。如果目标被确认，那么已植入恶意代码会升级到一个更为复杂的平台，如EQUATIONDRUG或GRAYFISH。</td>
<td width="81">2004-2012</td>
</tr>
<tr>
<td width="110"><strong>TripleFantasy</strong></td>
<td colspan="2" width="362">全功能的后门程序，有时用于配合GRAYFISH使用。看起来像是DOUBLEFANTASY的升级版，可能是更新的验证式插件。</td>
<td width="81">2012-至今</td>
</tr>
<tr>
<td width="110"><strong>Fanny</strong></td>
<td colspan="2" width="362">创建于2008年的利用USB设备进行传播的蠕虫，可攻击物理隔离网络并回传收集到的信息。Fanny被用于收集位于中东和亚洲的目标的信息。一些受害主机似乎已被升级到DoubleFantasy，然后又升级为EQUATIONDRUG。Fanny利用了两个后来被应用到Stuxnet中的0day漏洞。</td>
<td width="81">2008-2011</td>
</tr>
<tr>
<td width="110"><strong>GrayFish</strong></td>
<td colspan="2" width="362">Equation组织中最复杂的攻击组件，完全驻留在注册表中，依靠bootkit在操作系统启动时执行。</td>
<td width="81">2008-至今</td>
</tr>
</tbody>
</table>
<p>Equation组织的6个组件的攻击示意图：</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/03/image005.png"><img class="alignnone wp-image-5330 size-full" src="http://www.secpulse.com/wp-content/uploads/2015/03/image005.png" alt="image005" width="504" height="256" /></a></p>
<p><strong>图1 组件关系示意图</strong></p>
<p>Equation组织攻击时，选择Fanny或DoubleFantasy或TripleFantasy作为<span style="color: #ff6600">攻击前导</span>，当确认被攻击端是攻击者的预期目标后，会使用更复杂的组件EquationDrug或GrayFish。</p>
<p>安天分析小组目前将重点放在攻击前导组件（DoubleFantasy）、更复杂的组件（EquationDrug和GrayFish）。</p>
<p>同时对具有硬盘固件重新编程功能的nls_933w.dll进行分析。</p>
<p>&nbsp;</p>
<h2>3、组件DoubleFantasy分析</h2>
<p>组件DoubleFantasy是用来确认被攻击目标的，如果被攻击的目标属于被Equation组织感兴趣或关注的领域，<span style="color: #ff6600">那么更加复杂的其他组件就会从远端注入到被攻击的机器中</span>。</p>
<p>友商报告已经对组件DoubleFantasy进行了详细分析，安天分析小组原本计划对组件DoubleFantasy进行分析验证，但在验证的过程中，分析小组发现该组件是以往分析过的，并找到了其他的关联的恶意代码；同时，安天也发现了友商报告未见披露的信息。</p>
<h3>3.1         检测安全软件</h3>
<p>组件DoubleFantasy枚举注册表键值，查找系统是否安装了安全软件，查询的安全软件列表存在资源节中，使用0x79异或加密。</p>
<p>在友商报告中给出了其检测是否存在的安全软件列表，共计10种，而安天分析小组发现，实际上该组件一共检测13种安全软件的存在，除友商报告披露的10种产品外，还有360、BitDefender和Avira三家厂商的产品。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/03/image006.jpg"><img class="alignnone wp-image-5331 size-full" src="http://www.secpulse.com/wp-content/uploads/2015/03/image006.jpg" alt="image006" width="554" height="185" /></a></p>
<p><span style="color: #008000">鉴于其中360安全卫士主要用户均在中国，这也进一步验证了中国也是Equation组织攻击的目标之一。</span></p>
<p>&nbsp;</p>
<h3>3.2         回传信息</h3>
<p>DoubleFantasy收集系统信息，并回传给攻击者，回传格式为：</p>
<p><em>000:MAC</em><em>地址001<strong>:</strong>IP</em><em>地址......019:</em><em>当前时间</em></p>
<p>回传的详细信息如下：</p>
<table width="567">
<tbody>
<tr>
<td width="45"><strong>标号</strong></td>
<td width="163"><strong>说明</strong></td>
<td width="38"><strong>标号</strong></td>
<td width="178"><strong>说明</strong></td>
<td width="38"><strong>标号</strong></td>
<td width="106"><strong>说明</strong></td>
</tr>
<tr>
<td width="45"><strong>000</strong></td>
<td width="163">MAC地址</td>
<td width="38"><strong>007</strong></td>
<td width="178">系统补丁信息（CSDVersion，例如sp1）</td>
<td width="38"><strong>014</strong></td>
<td width="106">网络连接类型</td>
</tr>
<tr>
<td width="45"><strong>001</strong></td>
<td width="163">IP地址</td>
<td width="38"><strong>008</strong></td>
<td width="178">CurrentBuildNumber（例如2600）</td>
<td width="38"><strong>015</strong></td>
<td width="106">安装的软件信息</td>
</tr>
<tr>
<td width="45"><strong>002</strong></td>
<td width="163">样本版本号</td>
<td width="38"><strong>009</strong></td>
<td width="178">系统CurrentVersion（5.1）</td>
<td width="38"><strong>016</strong></td>
<td width="106">未知</td>
</tr>
<tr>
<td width="45"><strong>003</strong></td>
<td width="163">样本id</td>
<td width="38"><strong>010</strong></td>
<td width="178">ProductID</td>
<td width="38"><strong>017</strong></td>
<td width="106">此值不存在</td>
</tr>
<tr>
<td width="45"><strong>004</strong></td>
<td width="163">代理设置信息</td>
<td width="38"><strong>011</strong></td>
<td width="178">位置信息1</td>
<td width="38"><strong>018</strong></td>
<td width="106">32位或64位</td>
</tr>
<tr>
<td width="45"><strong>005</strong></td>
<td width="163">注册信息1(RegisteredOwner)</td>
<td width="38"><strong>012</strong></td>
<td width="178">位置信息2</td>
<td width="38"><strong>019</strong></td>
<td width="106">当前时间<strong> </strong></td>
</tr>
<tr>
<td width="45"><strong>006</strong></td>
<td width="163">注册信息2(RegisteredOrganization)</td>
<td width="38"><strong>013</strong></td>
<td width="178">系统目录</td>
<td width="38"><strong> </strong></td>
<td width="106"><strong> </strong></td>
</tr>
</tbody>
</table>
<h3>3.3         通讯协议</h3>
<p>DoubleFantasy的被控端返回包格式是第一字节不加密，后面的数据加密。举例0x42指令如下：</p>
<p><strong>0x42</strong><strong>指令分支详细功能</strong></p>
<p>功能：重新上线，初始化通讯密钥，删除自身，清理感染痕迹。</p>
<p>控制端发包格式：第一字节为指令代码0x42，第二字节为指令分支，分别有3种：00立即重新上线，01初始化通讯密钥，Sleep 60秒后重新上线，02删除自身，清除感染痕迹。</p>
<p>被控端返回包格式：无。</p>
<h3>3.4         新的版本、C&amp;C、密钥</h3>
<p>友商报告给出了相关组件的版本、C&amp;C列表和密钥，经安天进一步分析，获得了更多相关信息。下文中绿色为友商报告中信息，红色（加粗）为安天分析出的新的信息。<br />
<strong>   </strong><strong>版本列表：</strong></p>
<p style="padding-left: 30px"><em>8.1.0.4 (MSREGSTR.EXE)</em></p>
<p style="padding-left: 30px"><em>008.002.000.006</em></p>
<p style="padding-left: 30px"><em>008.002.001.001</em></p>
<p style="padding-left: 30px"><em>008.002.001.004</em></p>
<p style="padding-left: 30px"><em>008.002.001.04A (subversion "IMIL3.4.0-IMB1.8.0")</em></p>
<p style="padding-left: 30px"><em>008.002.002.000</em></p>
<p style="padding-left: 30px"><em>008.002.003.000</em></p>
<p style="padding-left: 30px"><span style="color: #ff0000"><strong><em>008.002.004.000</em></strong></span></p>
<p style="padding-left: 30px"><em>008.002.005.000</em></p>
<p style="padding-left: 30px"><span style="color: #ff0000"><strong><em>008.002.005.001</em></strong></span></p>
<p style="padding-left: 30px"><em>008.002.006.000</em></p>
<p style="padding-left: 30px"><em>011.000.001.001</em></p>
<p style="padding-left: 30px"><em>012.001.000.000</em></p>
<p style="padding-left: 30px"><em>012.001.001.000</em></p>
<p style="padding-left: 30px"><em>012.002.000.001</em></p>
<p style="padding-left: 30px"><em>012.003.001.000</em></p>
<p style="padding-left: 30px"><em>012.003.004.000</em></p>
<p style="padding-left: 30px"><em>012.003.004.001</em></p>
<p style="padding-left: 30px"><em>013.000.000.000</em></p>
<p><em>         </em></p>
<p><strong>C&amp;C</strong><strong>如下：</strong></p>
<p style="padding-left: 30px"><em>advancing-technology[.]com<br />
avidnewssource[.]com<br />
businessdealsblog[.]com<br />
businessedgeadvance[.]com<br />
charging-technology[.]com<br />
computertechanalysis[.]com<br />
config.getmyip[.]com - SINKHOLED BY KASPERSKY LAB<br />
globalnetworkanalys[.]com<br />
melding-technology[.]com<br />
myhousetechnews[.]com - SINKHOLED BY KASPERSKY LAB<br />
newsterminalvelocity[.]com - SINKHOLED BY KASPERSKY LAB<br />
selective-business[.]com<br />
slayinglance[.]com<br />
successful-marketing-now[.]com - SINKHOLED BY KASPERSKY LAB<br />
taking-technology[.]com<br />
techasiamusicsvr[.]com - SINKHOLED BY KASPERSKY LAB<br />
technicaldigitalreporting[.]com<br />
timelywebsitehostesses[.]com<br />
www.dt1blog[.]com<br />
www.forboringbusinesses[.]com</em></p>
<p style="padding-left: 30px"><span style="color: #ff0000"><strong><em>Ign***list.com</em></strong></span></p>
<p style="padding-left: 30px"><span style="color: #ff0000"><strong><em>Dat***cemgmt.net</em></strong></span></p>
<p style="padding-left: 30px"><span style="color: #ff0000"><strong><em>Imp***today.com</em></strong></span></p>
<p style="padding-left: 30px"><span style="color: #ff0000"><strong><em>Bud***nessnews.com</em></strong></span></p>
<p><strong><em> </em></strong></p>
<p><strong>         </strong><strong>新的密钥：</strong></p>
<p style="padding-left: 30px"><span style="color: #ff0000"><em>37 08 EF 89 29 A7 4B 6B AB 3E 5D 03 F6 B0 B5 B3</em></span></p>
<p style="padding-left: 30px"><em>66 39 71 3C 0F 85 99 81 20 19 35 43 FE 9A 84 11</em></p>
<p style="padding-left: 30px"><em>8B 4C 25 04 56 85 C9 75 06 33 C0 5E C2 08 31 F6</em></p>
<p style="padding-left: 30px"><em>32 EC 89 D8 0A 78 47 22 BD 58 2B A9 7F 12 AB 0C</em></p>
<p>组件DoubleFantasy通常是受害者被Equation组织感染的第一步，通过与后门的通信以及对不同系统参数的检查来确认受害者的信息。受害者一旦被确认，Equation组织将使用更复杂的组件EquationDrug或Grayfish。</p>
<p>&nbsp;</p>
<h2>4、组件EquationDrug分析</h2>
<p>组件EquationDrug是一个很复杂的模块。其存活时间有近10年，后来被GrayFish升级给代替了。</p>
<p>安天在分析中发现两个模块中的一些文件名称有相同处，从混淆加密等方面来看也有多处手法相同。它们都是从资源解密、解压缩和释放文件。分析中发现在资源里有一个SYS和一个VXD文件。VXD是Windows 9x下的驱动机制，所在可以认定这个模块也有感染Windows 9x下的能力。其EquationDrug是一个插件平台，它具有安装与卸载插件功能。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/03/image007.jpg"><img class="alignnone size-full wp-image-5332" src="http://www.secpulse.com/wp-content/uploads/2015/03/image007.jpg" alt="image007" width="554" height="335" /></a></p>
<p><strong>图2 组件EquationDrug的创建与调用关系图</strong></p>
<table width="576">
<tbody>
<tr>
<td width="141"><strong>模块名称</strong></td>
<td width="435"><strong>功能</strong></td>
</tr>
<tr>
<td width="141"><strong>msnadt.exe</strong></td>
<td width="435">文件功能主要为释放文件、解密资源、判断系统类型、注入代码到指定进程和加载驱动等功能。</td>
</tr>
<tr>
<td width="141"><strong>MSDIRECTX.EXE</strong></td>
<td width="435">创建INSTV3.BAT并运行自删除。</td>
</tr>
<tr>
<td width="141"><strong>MSCFG32.exe</strong></td>
<td width="435">加载MSCFG32.DLL，添加和修改注册表。</td>
</tr>
<tr>
<td width="141"><strong>MSCFG32.DLL</strong></td>
<td width="435">该文件会添加和修改注册表，释放unity.dll文件。与驱动文件有关系，含有网络功能。</td>
</tr>
<tr>
<td width="141"><strong>unity.dll</strong></td>
<td width="435">有大量文件操作和注册表操作</td>
</tr>
<tr>
<td width="141"><strong>MSNDSRV.SYS</strong><strong>MSSVC32.VXD</strong></td>
<td width="435">功能基本相同，但VXD是在windows9.x下用的，主要功能是hook、网络监听和写文件等。还会判断系统中是否有MSlog32.dat，有就打开写入数据，没有就创建一个新的。</td>
</tr>
<tr>
<td width="141"><strong>INSTV3.BAT</strong><strong>INSTV4.BAT</strong></td>
<td width="435">自删除文件。</td>
</tr>
</tbody>
</table>
<h3>4.1         检测安全软件</h3>
<p>其枚举注册表键值，查找系统是否安装了安全软件，查询的安全软件列表存在资源节中。</p>
<p>其所检测的安全软件比DoubleFantasy组件更多，且类型也更加丰富，但同时其检测的中国安全软件是瑞星（Rising），但并未检测当前更为流行的360。因此也可以验证前文关于这个组件已经被更新组件替代的结论。相关检测的注册表键值如下：</p>
<pre class="lang:python decode:true ">Zone Labs\TrueVector\

Zone Labs\ZoneAlarm\

KasperskyLab\

Network Ice\BlackIce\

Agnitum\Outpost Firewall\

Sygate Technologies, Inc.\Sygate Personal Firewall\

Norman\

Data Fellows\F-Secure\

PWI, Inc.\

rising\

Softwin\

network associates\tvd\shared components\on access scanner\behaviourblocking\FileBlockEnabled_27!=0

network associates\tvd\shared components\on access scanner\behaviourblocking\FileBlockEnabled_28!=0

network associates\tvd\shared components\on access scanner\behaviourblocking\FileBlockEnabled_29!=0

network associates\tvd\shared components\on access scanner\behaviourblocking\FileBlockEnabled_30!=0

McAfee\ePolicy Orchestrator\Application Plugins\VIRUSCAN8600

Sophos\

CA\CAPF\

CA\HIPSEngine\

Cisco\

Symantec\IDS\

Symantec\Norton 360\

Symantec\Internet Security\SuiteOwnerGuid\

Symantec\Norton AntiBot\

Symantec\Symantec Endpoint Protection\

Tiny Software\Tiny Firewall\

CyberMedia Inc\Guard Dog\

McAfee\Guard Dog\

McAfee\McAfee Firewall\

McAfee\Personal Firewall\

McAfee.com\Personal Firewall\

Network Associates\McAfee Fire\

Kerio\

BullGuard Ltd.\BullGuard\

TheGreenBow\

Panda Software\Firewall\

TrendMicro\PC-cillin\

ComputerAssociates\eTrust Suite Personal\pfw\

Grisoft\Firewall\</pre>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3>4.2         驱动模块MSNDSRV.SYS分析</h3>
<ol>
<li>驱动初始化的时候从注册表中遍历了所有的网卡，然后调用函数NdisRegisterProtocol向NDIS库注册了一个NDIS协议相关的结构。注册后该驱动就可以收到本机上的所有的网络流量，这一点类似于WinPcap的捕包机理。相关代码如下：</li>
</ol>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/03/image008.jpg"><img class="alignnone size-full wp-image-5333" src="http://www.secpulse.com/wp-content/uploads/2015/03/image008.jpg" alt="image008" width="553" height="278" /></a></p>
<p>2.修改了KeServiceDescriptorTable中的函数的地址。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/03/image009.png"><img class="alignnone size-full wp-image-5334" src="http://www.secpulse.com/wp-content/uploads/2015/03/image009.png" alt="image009" width="399" height="257" /></a></p>
<p style="padding-left: 30px">图3 原始的KeServiceDescriptorTable中的函数地址</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/03/image010.png"><img class="alignnone size-full wp-image-5335" src="http://www.secpulse.com/wp-content/uploads/2015/03/image010.png" alt="image010" width="396" height="130" /></a></p>
<p style="padding-left: 30px">图4 修改后的KeServiceDescriptorTable中的函数地址</p>
<p>修改后的函数地址只是包含一个JMP指令。 如果KeServiceDescriptorTable中的函数不是它要hook的目标则直接跳回原始函数的地址，否则跳到驱动自己的函数中去。</p>
<p>如函数nt!NtAcceptConnectPort在KeServiceDescriptorTable中它的地址是820742b1。</p>
<p>该处的指令如下：</p>
<table>
<tbody>
<tr>
<td width="397"><em>820742b1 2eff25b8420782  jmp     dword ptr cs:[820742B8h]</em></td>
</tr>
</tbody>
</table>
<p>820742B8就是NtAcceptConnectPort对应的地址。而函数NtTerminateProcess在KeServiceDescriptorTable中的地址是0x81cf9ebd.该处的指令为：</p>
<table>
<tbody>
<tr>
<td width="387"><em>81cf9ebd 2eff25c49ecf81  jmp     dword ptr cs:[81CF9EC4h]</em></td>
</tr>
</tbody>
</table>
<p>81CF9EC4中包含的地址为b1fd6eae，该地址指向驱动的一个函数。目前驱动hook的函数如下：</p>
<pre class="lang:python decode:true ">NtClose

NtCreateFile

NtCreateKey

NtCreateProcess

NtCreateProcessEx

NtCreateThread

NtEnumerateKey

NtOpenFile

NtOpenKey

NtOpenProcess

NtQueryAttributesFile

NtQueryDirectoryFile

NtQueryDirectoryObject

NtQueryFullAttributesFile

NtQueryKey

NtQuerySystemInformation

NtSetInformationFile

NtTerminateProcess</pre>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>5、组件GrayFish分析</h2>
<p>GrayFish是Equation组织中最复杂的攻击组件，是EquationDrug的新一代版本，安天分析小组认为其最重要的特点是：<span style="color: #ff0000"><strong>不依靠文件载体，而是完整的存在于注册表中，依靠</strong><strong>bootkit</strong><strong>在操作系统启动时执行，这一机制穿透了安全产品以文件为检测对象的机制，也穿透了相关基于白名单和可信计算的解决方案。</strong></span></p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/03/image011.jpg"><img class="alignnone size-full wp-image-5336" src="http://www.secpulse.com/wp-content/uploads/2015/03/image011.jpg" alt="image011" width="554" height="298" /></a></p>
<p>组件GrayFish的资源段中包含13个加密资源，均通过同一段解密算法进行解密：</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/03/image012.png"><img class="alignnone size-full wp-image-5337" src="http://www.secpulse.com/wp-content/uploads/2015/03/image012.png" alt="image012" width="328" height="238" /></a></p>
<p>解密后的13个文件中有5个驱动文件（sys）、2个动态链接库文件（dll）、4个包含注册表数据的文件、1个含有字符串“services.exe”的配置文件及1个加密的数据文件。</p>
<p>动态调试后发现，其中3个驱动文件hrilib.sys、msndsrv.sys及netvt.sys是由原始样本释放，包含网络驱动及注册表相关操作函数。mscfg32_ks.dll调用mscfg32.dll，拥有创建远程线程、获取系统信息、创建和删除注册表键值等功能。除已释放的三个驱动文件外，资源102中含有对注册表进行操作的函数，而DesertWinterDriver.sys中包含对IoControlCode的比较，具体功能有待分析。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/03/image013.jpg"><img class="alignnone size-full wp-image-5338" src="http://www.secpulse.com/wp-content/uploads/2015/03/image013.jpg" alt="image013" width="554" height="478" /></a></p>
<p>另外，原样本会生成批处理用以删除自身，该批处理文件名与EquationDrug用以自删除的文件名完全相同，这也说明二者之间具有密切的联系。</p>
<p>&nbsp;</p>
<h2>6、硬盘固件重新编程模块nls_933w.dll分析</h2>
<p>nls_933w.dll是具有硬盘固件重新编程能力的模块，由于硬盘固件是一个安天分析小组之前缺少储备的领域，因此分析进展非常缓慢。从目前分析来看，当nls_933w.dll模块被其他程序调用后，nls_933w.dll从自身资源释放win32m.sys驱动文件，win32m.sys驱动文件负责与硬盘控制器进行通信，它能够判断硬盘控制器类型，如：IDE、SATA等，根据不同类型的硬盘控制器发送对应的控制指令。因此只要攻击者熟悉各硬盘厂商规定的ATA指令，那么就可以对硬盘固件进行恶意篡改。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/03/image014.jpg"><img class="alignnone size-full wp-image-5339" src="http://www.secpulse.com/wp-content/uploads/2015/03/image014.jpg" alt="image014" width="198" height="403" /></a></p>
<p><strong>图5 修改硬盘固件的流程图</strong></p>
<p>动态调试后安天分析小组发现，该模块调用函数DeviceIoControl与win32m.sys进行交互。在win32m.sys中，安天分析小组发现多个IoControlCode并分析了它们所对应的功能。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/03/image015.jpg"><img class="alignnone size-full wp-image-5340" src="http://www.secpulse.com/wp-content/uploads/2015/03/image015.jpg" alt="image015" width="554" height="466" /></a></p>
<p><strong>图6 IoControlCode</strong><strong>所对应的功能图</strong></p>
<p>安天分析小组发现，当IoControlCode为0x870021D0时，nls_933w.dll对硬盘控制器发送ATA控制指令：0xEC，获取硬盘相关信息。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/03/image016.png"><img class="alignnone size-full wp-image-5341" src="http://www.secpulse.com/wp-content/uploads/2015/03/image016.png" alt="image016" width="567" height="168" /></a></p>
<p><strong>图7 获取硬盘相关信息</strong></p>
<p>调用DeviceIoControl前后内存中的数据对比，调用后返回硬盘信息：</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/03/image017.jpg"><img class="alignnone size-full wp-image-5342" src="http://www.secpulse.com/wp-content/uploads/2015/03/image017.jpg" alt="image017" width="554" height="304" /></a></p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/03/image018.jpg"><img class="alignnone size-full wp-image-5343" src="http://www.secpulse.com/wp-content/uploads/2015/03/image018.jpg" alt="image018" width="554" height="309" /></a></p>
<p>其他的IoControlCode所对应的功能及ATA指令有待进一步分析和发现。</p>
<p>&nbsp;</p>
<h2>7、 攻击硬盘固件的机理分析</h2>
<p>&nbsp;</p>
<h3>7.1         硬盘的结构和工作原理</h3>
<p>不论是传统的机械硬盘还是固态硬盘，其总体的结构都是相似的。硬盘主要由处理器、缓存、Boot ROM和主存储介质等几部分构成，对于机械硬盘，还有电机驱动电路和磁头控制电路等。其简化原理框图如下图所示：</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/03/image019.png"><img class="alignnone size-full wp-image-5344" src="http://www.secpulse.com/wp-content/uploads/2015/03/image019.png" alt="image019" width="536" height="315" /></a></p>
<p><strong>图8 硬盘原理框图</strong></p>
<p>由于硬盘的电路板上已经具有了CPU、内存和ROM，硬盘可以看做是一个小型的计算机系统，在固件的控制下可以有自己的行为。目前常见的硬盘处理器都是基于ARM核心的，新型的硬盘控制器甚至采用多核结构来保证高速的数据传输。</p>
<p>硬盘通电时，处理器执行片内的Loader代码，这部分代码会加载Boot ROM到缓存中，并执行（对硬盘上的嵌入式处理器来说，就是内存）。Boot ROM可能存放在主控的片内FLASH，独立的I2C EEPROM，SPI FLASH芯片或者固态硬盘上的NAND FLASH阵列中。Boot ROM得到控制权之后，会依次初始化基本外设，初始化主存储介质，从主存储介质上加载固件主体，启动IDE/SATA总线接口驱动模块，并进入待命状态，此时计算机即可对硬盘进行操作。</p>
<p><strong>1)        </strong><strong>传统机械硬盘</strong></p>
<p>对于目前大部分的机械硬盘来说，其固件的主体部分通常存放在盘片上的隐藏扇区中，Boot ROM按照校准数据初始化磁头组件之后，从隐藏扇区中读取固件数据，并将控制权转交给固件主体，固件主体完成自身初始化之后，加载并启动总线接口驱动模块。至此，硬盘完成上电启动过程。</p>
<p>机械硬盘的内部结构如图所示：</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/03/image020.jpg"><img class="alignnone size-full wp-image-5345" src="http://www.secpulse.com/wp-content/uploads/2015/03/image020.jpg" alt="image020" width="447" height="386" /></a></p>
<p><strong>图9 机械硬盘组成与结构</strong></p>
<p><strong>（http://jingyan.baidu.com/article/ab0b5630d88efdc15bfa7d60.html）</strong></p>
<p>硬 盘的数据存储在磁盘盘片上，硬盘工作时，主轴带动盘片高速旋转，读写磁头悬浮于盘片上方几微米处，通过巨磁阻效应来进行读写操作。传动手臂通过强磁铁与线 圈构成的音圈电机进行寻道，以定位要读写的内容。图中的返利局弹簧装置是给传动手臂提供回复力的，该装置能够保证硬盘在断电的时候，磁头能够自动归位到Park区。Park区有一块柔软的支撑垫，可以在硬盘不工作时固定读写手臂，以免因外界震动而划伤盘片。</p>
<p><strong>2)        </strong><strong>固态硬盘</strong></p>
<p>与机械硬盘相比，由于没有机械结构，固态硬盘的结构要简单不少，通常的固态硬盘都可以用下面的图来描述：</p>
<p><strong>图10 固态盘及其控制器结构框图</strong></p>
<p><strong>（《JMF608SATA III NAND Flash Controller datasheet》）</strong></p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/03/image021.jpg"><img class="alignnone size-full wp-image-5346" src="http://www.secpulse.com/wp-content/uploads/2015/03/image021.jpg" alt="image021" width="543" height="216" /></a></p>
<p>图中左边的框是固态硬盘的控制器，右边是板载外设和NAND FLASH阵列，部分型号的控制器还需要外置的Data Buffer RAM，也就是缓存。从图中可以看出，控制器本身就可以构成一个完整的计算机系统，其引导过程与机械硬盘类似，在此就不再重复了。</p>
<p><strong>3)        </strong><strong>硬盘的接口规范</strong></p>
<p>目前常见的IDE和SATA硬盘都遵循ATA指令集，PC机通过发送ATA命令来对硬盘进行读写操作。</p>
<p>ATA技术是一个关于IDE（Integrated Device Electronics）的技术规范族。最初，IDE只是一项以把控制器与盘体集成在一起为主要意图的硬盘接口技术。 随着IDE/EIDE得到的日益广泛的应用，全球标准化协议将该接口自诞生以来使用的技术规范归纳成为全球硬盘标准，这样就产生了ATA（Advanced Technology Attachment）。ATA发展至今经过多次修改和升级，每新一代的接口都建立在前一代标准之上，并保持着向后兼容性。除了读写命令以外，硬盘还支持一些高级功能，比如自我监测功能（SMART），容量设置（HPA）、噪音管理（AAS）等。详见《ATA/ATAPI Command Set - 2 (ACS-2)》（一部500多页的大部头标准文档！）。</p>
<h3>7.2         硬盘的信息安全脆弱性</h3>
<p>特别要值得注意的是，目前大部分硬盘都支持固件升级功能（通过下载微码命令或者厂商的私有命令实现），用户可以通过厂商规定的ATA指令来对硬盘驱动器上的固件进行更新。这使得硬盘厂商无需召回有固件bug的产品，而可以在用户系统上通过软件工具升级固件，修补缺陷。例如，希捷2008.12月的硬盘有故障，官方发布了固件更新工具和使用说明，使用户刷新固件解决问题。类似的还有硬盘厂商西部数据的C1门事件。</p>
<p>下图以Seagate SandForce SF-2200系列固态硬盘为例，说明硬盘固件的升级过程：</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/03/image022.png"><img class="alignnone size-full wp-image-5347" src="http://www.secpulse.com/wp-content/uploads/2015/03/image022.png" alt="image022" width="568" height="424" /></a></p>
<p><strong>图11 Seagate SandForce SF-2200</strong><strong>系列固态硬盘固件升级流程图</strong></p>
<p>这种通过主机软件在系统（In System）升级固件的机制使用很方便，但也意味着存在着固件被恶意篡改的可能性。而且这种篡改可以是通过软件操作，在用户毫不知情的情况下进行。</p>
<p>如 前文所述，硬盘本身就是一套完整的嵌入式系统，其内部的固件独立于计算机软硬件而运行。固件完全决定了硬盘的读写操作行为，甚至可以在主机不知情的时候自 主处理数据。如果攻击者在硬盘的固件中设计了精巧的代码，则可以对用户的读写操作进行拦截和干扰，或者通过这种手段获得系统的最高控制权，而所有这一切都 是在硬盘上完成的，计算机前面的用户、计算机上的软硬件根本无法感知这一过程，甚至知道也无法干预这样的动作发生。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/03/image023.jpg"><img class="alignnone size-full wp-image-5348" src="http://www.secpulse.com/wp-content/uploads/2015/03/image023.jpg" alt="image023" width="553" height="330" /></a></p>
<p><strong>图12 Jasmine</strong><strong>开发板结构框图</strong></p>
<p><strong>（</strong><a href="http://www.openssd-project.org"><strong>http://www.openssd-project.org</strong></a><strong>）</strong></p>
<p>以OpenSSD项目（一个以研究性质的开源硬盘项目）中的Jasmine开发板为例，如果攻击者对某款硬盘的控制器的结构非常了解，包括片上的外设地址空间等信息。则改攻击者可以通过精心构造的修改版固件来对控制器的某些特定的行为进行拦截，并在数据传输途中对缓存DRAM中的数据进行修改。比如拦截ATA读取命令20h，在读取指定扇区时篡改缓存中的数据，使计算机实际获得的数据与磁盘上存储的内容不符，进而实现自下而上的攻击效果。这种攻击方式对来自硬盘的数据流的改写完全绕过了计算机系统，因此可以在重装系统甚至低格硬盘之后仍然保持其危害性。</p>
<p>&nbsp;</p>
<h2>8 、小结</h2>
<p>时间总是让人觉得似曾相识，2月16日，农历腊月二十八，还有两天就是春节了，关于方程式攻击组织的相关信息浮出水面。这让我们想起2003年农历小年的Slammer蠕虫、2004五一节的震荡波蠕虫、以及去年国庆节前的“破壳”漏洞。但不同的是，此前事件冲击的是我们的应急速度，而方程式考验的是我们综合储备与能力深度，以及分析耐心。</p>
<p><span style="color: #ff6600">对安天的分析团队来说，这是第一次在发布一篇分析报告时如此惴惴不安。</span></p>
<p><span style="color: #ff6600">在2003年发布Dvldr（口令蠕虫）分析报告时，我们是那样急切，希望用户更快看到我们提供的解决方案；</span></p>
<p><span style="color: #ff6600">在发布震网分析报告时，我们是那样盲目，自以为我们的工作已经基本足够；</span></p>
<p><span style="color: #ff6600">在发布火焰系列组件分析报告时，我们是那样放任——既然庞大到分析不过来，就接力式的分析-发布好了。</span></p>
<p><span style="color: #ff6600">但这一次，完全不同，因为我们一度被卡住了，不因加密、驱动、隐藏，而是因为“硬盘固件”，对于那些经过长期准备而施于一点的攻击来说，防御者搞清问题的关键往往去取决于愿意付出多少人力与时间。</span></p>
<p><span style="color: #ff6600">我们自以为是敏锐的，我们很早就在关注嵌入式与固件，我们大讲威胁的泛化，但当威胁真正出现于面前之时，我们才发现对手更加先验和强大，而我们的所谓敏锐何其幼稚。</span></p>
<p><span style="color: #ff6600">而同样令我们忧心忡忡的是，相关事件的报告正在不断的走形。很多用户向我们求证和询问“是不是所有硬盘都已经放入了后门木马”。</span></p>
<p>因此尽管我们的分析工作还在持续之中，我们依然要凭借经验给出下列结论或判断：</p>
<p>&nbsp;</p>
<p>1、              硬件设备的固件可更新机制，是软硬件系统发展的必然结果，这种机制本身不能被称之为后门。同时对更多带有固件系统来说，如果没有更新机制，那么将导致有问题的版本不能得到补丁，即可能带来更大的运维成本，也反而可能是一个重要的安全隐患。</p>
<p>2、              综合安天和友商以及其他机构目前分析结果来推测，相关攻击中写入固件的行为发生于前导恶意代码回传主机信息，并被远端判定为有价值目标的情况下，即其并非一个普遍行为，而是一个高等级、有条件的入侵行为。</p>
<p>3、              通过长期的分析摸索，攻击者完全可以独立实现相关机理，并不一定需要入侵硬盘厂商获取技术文献，甚至靠硬盘厂商主动提供技术文献。</p>
<p>4、              其写入硬盘固件，关键是用于实现潜伏与长期存在，但上层的作业能力依然存在于主机系统中，而且可以通过网络灵活获取其他作业模块。</p>
<p>5、              鉴于相关国家此前的行为，我们也有理由怀疑，同样的组件，可能被用于物流链劫持，即在特定目标采购、返修主机或硬盘的过程中注入。但基于其作业手法和风险分析，我们有理由认为，对方程式这样的对手来说，这种Bootkit+固件的作业手法，通常不会进行批量作业。</p>
<p>6、              但后续我们同样要警惕的是Bruce Schneier所警告的 “越来越多战争中的战术行为被应用于更广泛的网络空间环境中”，而且新的手法一经曝光就会对黑产产生强烈的启迪效应，从而使威胁泛滥。</p>
<p>7、              相关攻击确实体现了相关供应链的安全盲点，对于硬盘固件是否有有效的签名验证机制，而同时已经写入硬盘的固件，目前来看我们没有找到看到低成本的无条件读取的接口。类似的设计就给安全分析人员进行检测验证带来了困难。</p>
<p>&nbsp;</p>
<p>防御阵地的规划，不能依赖于臆想对手。客观看待安全与发展的关系，深入具体的分析威胁，研判对手的策略和路径，永远是我们应对威胁的支点。</p>
<p>&nbsp;</p>
<h2>附录一：参考资料</h2>
<ol>
<li>Equation: The Death Star of Malware Galaxy</li>
</ol>
<p><a href="http://securelist.com/blog/research/68750/equation-the-death-star-of-malware-galaxy/">http://securelist.com/blog/research/68750/equation-the-death-star-of-malware-galaxy/</a></p>
<ol start="2">
<li>A Fanny Equation: "I am your father, Stuxnet"</li>
</ol>
<p><a href="http://securelist.com/blog/research/68787/a-fanny-equation-i-am-your-father-stuxnet/">http://securelist.com/blog/research/68787/a-fanny-equation-i-am-your-father-stuxnet/</a></p>
<ol start="3">
<li>Equation Group: from Houston with love</li>
</ol>
<p><a href="http://securelist.com/blog/research/68877/equation-group-from-houston-with-love/">http://securelist.com/blog/research/68877/equation-group-from-houston-with-love/</a></p>
<h2>附录二：事件日志</h2>
<table>
<tbody>
<tr>
<td width="207">2015-02-18</td>
<td width="361">启动事件研判、验证</td>
</tr>
<tr>
<td width="207">2015-02-21</td>
<td width="361">安天CERT与微嵌入联合分析组成立。</td>
</tr>
<tr>
<td width="207">2015-02-25</td>
<td width="361">启动全面分析。</td>
</tr>
<tr>
<td width="207">2015-03-02</td>
<td width="361">开始编写初步分析报告</td>
</tr>
<tr>
<td width="207">2015-03-04</td>
<td width="361">形成分析报告第一版本</td>
</tr>
<tr>
<td width="207">2015-03-05</td>
<td width="361">安天CERT进行内容校对并版本更新到V1.3</td>
</tr>
</tbody>
</table>
<p>【原文：<a href="http://www.antiy.com/response/EQUATION_ANTIY_REPORT.html" target="_blank">修改硬盘固件的木马 探索方程式（EQUATION）组织的攻击组件</a>  <a href="http://www.antiy.com/response/EQUATION_ANTIY_REPORT.pdf" target="_blank"> 报告下载</a>  <a href="http://www.secpulse.com/archives/5326.html%20" target="_blank">安全脉搏xunshan</a>发表】</p>
		<div class="pageShenming">
【安全脉搏：分享技术、悦享品质。文章仅代表作者看法，如有不同观点，欢迎添加安全脉搏微信号：SecPulse，进行交流。】</div>
<div class="post-tags"><span>Tags: </span><a href="https://www.secpulse.com/archives/tag/_sd_ip_cf-dll" rel="tag">_SD_IP_CF.dll</a><a href="https://www.secpulse.com/archives/tag/360%e5%ae%89%e5%85%a8%e5%8d%ab%e5%a3%ab" rel="tag">360安全卫士</a><a href="https://www.secpulse.com/archives/tag/avira" rel="tag">Avira</a><a href="https://www.secpulse.com/archives/tag/bitdefender" rel="tag">BitDefender</a><a href="https://www.secpulse.com/archives/tag/desertwinterdriver-sys" rel="tag">DesertWinterDriver.sys</a><a href="https://www.secpulse.com/archives/tag/doublefantasy" rel="tag">DoubleFantasy</a><a href="https://www.secpulse.com/archives/tag/equation" rel="tag">Equation</a><a href="https://www.secpulse.com/archives/tag/equation-group" rel="tag">Equation Group</a><a href="https://www.secpulse.com/archives/tag/equationdrug" rel="tag">EquationDrug</a><a href="https://www.secpulse.com/archives/tag/equationlaser" rel="tag">EquationLaser</a><a href="https://www.secpulse.com/archives/tag/equestre" rel="tag">EQUESTRE</a><a href="https://www.secpulse.com/archives/tag/fanny" rel="tag">Fanny</a><a href="https://www.secpulse.com/archives/tag/grayfish" rel="tag">GrayFish</a><a href="https://www.secpulse.com/archives/tag/grok-keylogger" rel="tag">GROK keylogger</a><a href="https://www.secpulse.com/archives/tag/iocontrolcode" rel="tag">IoControlCode</a><a href="https://www.secpulse.com/archives/tag/keservicedescriptortable" rel="tag">KeServiceDescriptorTable</a><a href="https://www.secpulse.com/archives/tag/msndsrv-sys" rel="tag">MSNDSRV.SYS</a><a href="https://www.secpulse.com/archives/tag/nls_933w-dll" rel="tag">nls_933w.dll</a><a href="https://www.secpulse.com/archives/tag/ntntacceptconnectport" rel="tag">nt!NtAcceptConnectPort</a><a href="https://www.secpulse.com/archives/tag/triplefantasy" rel="tag">TripleFantasy</a><a href="https://www.secpulse.com/archives/tag/win32m-sys" rel="tag">win32m.sys</a><a href="https://www.secpulse.com/archives/tag/%e5%ae%89%e5%a4%a9%e5%88%86%e6%9e%90%e5%b0%8f%e7%bb%84" rel="tag">安天分析小组</a><a href="https://www.secpulse.com/archives/tag/%e6%94%bb%e5%87%bb%e5%89%8d%e5%af%bc" rel="tag">攻击前导</a><a href="https://www.secpulse.com/archives/tag/%e6%96%b9%e7%a8%8b%e5%bc%8f%e7%bb%84%e7%bb%87" rel="tag">方程式组织</a></div>
		</div>
	<!-- .single-content -->
		<div class="pageActive">
	<div class="mark-like-btn">
							</div>
	<!-- Baidu Button BEGIN -->
	<div class="bdshare">
		<div class="bdsharebuttonbox">
			<a href="#" class="bds_more" data-cmd="more"></a><a href="#"
				class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#"
				class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#"
				class="bds_weixin" data-cmd="weixin" title="分享到微信"></a>
		</div>
		<script>
		window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"32"},"share":{}};
		with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
		</script>

	</div>
</div>    <section id="text-6" class="widget-container widget_text hidden-xs">			<div class="textwidget"><center><a href="https://www.duoyinsu.com" target="_blank" title="安识科技 专业安全服务商"><img src="https://www.secpulse.com/wp-includes/images/secweixin.png" style="width:785px;height:315px"></a><center></div>
		</section><section id="related_post-2" class="widget-container widget_related_post hidden-xs"><h3 class="widget-title">相关文章</h3>

	<ul class="related_post">
				<li><a href="https://www.secpulse.com/archives/51120.html" title="详细阅读 美国NSA方程式组织Equation Group被黑,大量黑客工具泄露">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=https://www.secpulse.com/wp-content/uploads/2016/08/NSA.png&h=150&w=249&zc=1" alt="美国NSA方程式组织Equation Group被黑,大量黑客工具泄露" class="xg-img"/>
		<p>美国NSA方程式组织Equation G&hellip;</P></a></li>
				<li><a href="https://www.secpulse.com/archives/30020.html" title="详细阅读 小红伞（Avira）杀毒软件升级过程存在缺陷（可被中间人攻击利用植入木马）">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=http://www.secpulse.com/upload/201412/171123052aecff63bda0ecc85b766a75b2062814.png&h=150&w=249&zc=1" alt="小红伞（Avira）杀毒软件升级过程存在缺陷（可被中间人攻击利用植入木马）" class="xg-img"/>
		<p>小红伞（Avira）杀毒软件升级过程存在&hellip;</P></a></li>
				<li><a href="https://www.secpulse.com/archives/24418.html" title="详细阅读 360安全卫士锁屏权限绕过漏洞">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=/upload/201406/2609173417298973193dedd8cb4037cdb22c7c4a.jpg&h=150&w=249&zc=1" alt="360安全卫士锁屏权限绕过漏洞" class="xg-img"/>
		<p>360安全卫士锁屏权限绕过漏洞</P></a></li>
			</ul>


</section></article>


<!-- 引用 -->
<div id="comments" class="comments-area">
	<h2 class="comments-title">
		抢沙发
	</h2>
			<div id="respond" class="comment-respond row">
		


			<form action="https://www.secpulse.com/wp-comments-post.php" method="post" id="commentform">
		
				
						
			<div id="comboxinfo">
					<div class="cominfodiv cominfodiv-author ">
					<p for="author" class="nicheng">
     <input type="text" name="author" id="author" class="texty" value="" tabindex="1" /> <span class="required">昵称*</span>
      </p>
</div>
					<div class="cominfodiv cominfodiv-email">
					<p for="email">	<input type="text" name="email" id="email" class="texty" value="" tabindex="2" /> <span class="required">邮箱*</span>
						</p>
					</div>
					<div class="cominfodiv cominfodiv-url">
					 	<p for="url"><input type="text" name="url" id="url" class="texty" value="" tabindex="3" /><span>网址 </span>
						</p>
					</div>
					
			
				
</div>		       <div class=" cominfodiv-nr">  
<textarea class="texty" name="w" id="comment" rows="10" tabindex="4" placeholder="输入评论内容..."></textarea><textarea name="comment" cols="100%" rows="4" style="display:none"></textarea>
							<div class="submitcom">
							
					<input id="submit" name="submit" type="submit" tabindex="5" value="提&nbsp;交"/>
					<input type='hidden' name='comment_post_ID' value='5326' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="e4a8815c45" /></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="150"/></p>				</div>
				<div id="cancel_comment_reply"><a rel="nofollow" id="cancel-comment-reply-link" href="/archives/5326.html#respond" style="display:none;">取消回复</a></div>
			
</div>
			
				
			</form>
			
			
			<script type="text/javascript">
				document.getElementById("comment").onkeydown = function (moz_ev){
				var ev = null;
				if (window.event){
				ev = window.event;
				}else{
				ev = moz_ev;
				}
				if (ev != null && ev.ctrlKey && ev.keyCode == 13){
				document.getElementById("submit").click();}
				}
			</script></div>
	 		
</div>
<!-- #comments --></div>
		
<div class="xs-right sidebar xs-hidden xss-hidden">
	<div class="authorbox">
	<div class="author-top">
<div id="author-img">
<img src="https://www.secpulse.com/wp-content/uploads/2014/10/32878_large1.png" width="73" height="73" alt="大王叫我来巡山" class="avatar avatar-96 wp-user-avatar wp-user-avatar-96 alignnone photo" />
</div>
<div class="au-name">
<a href="https://www.secpulse.com/archives/author/xunshan" title="由大王叫我来巡山发布" rel="author">大王叫我来巡山</a><br>
 <span class="au-title">总共3篇文章</span>
</div> </div>
	<div class="author-word"><span class="quotes q1"></span>
	<span class="quotes q2"></span></div>
	</div>
	
				<aside id="recent-posts-2" class="widget-container widget_recent_entries">		<div class="si-title"><h2>最新脉搏</h2></div>		<ul>
					<li>
				<a href="https://www.secpulse.com/archives/60653.html">《安天365安全研究》第5期</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60630.html">供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60605.html">2017先知创新大会：有ZHI而来</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60576.html">甲方工作杂谈</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60394.html">Catfish—缓存漏洞&#038;&#038;配合CSRF到Getshell</a>
						</li>
				</ul>
		</aside><aside id="hot_comment-3" class="widget-container widget_hot_comment"><div class="si-title"><h2>脉搏热评</h2></div>
	<ul class="hot_comment_widget">
		
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59497.html" rel="bookmark" title="XSS挑战之旅学习总结 (7条评论)" >XSS挑战之旅学习总结</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59065.html" rel="bookmark" title="web安全之如何全面发现系统后台 (6条评论)" >web安全之如何全面发现系统后台</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59770.html" rel="bookmark" title="电商的支付风控怎么玩？ (3条评论)" >电商的支付风控怎么玩？</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59466.html" rel="bookmark" title="安天移动安全联合猎豹揭秘无形之贼Dosoft免杀病毒 (2条评论)" >安天移动安全联合猎豹揭秘无形之贼Doso&hellip;</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59262.html" rel="bookmark" title="跟着DVWA学Web安全开发 (2条评论)" >跟着DVWA学Web安全开发</a></li>			</ul>

</aside><aside id="random_post-2" class="widget-container widget_random_post"><div class="si-title"><h2>随机脉搏</h2></div>

	<ul class="random_post">
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/7911.html" rel="bookmark" title="详细阅读 5173验证码可被绕过">5173验证码可被绕过</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/29363.html" rel="bookmark" title="详细阅读 新网分站存在SQL注入(附验证脚本)">新网分站存在SQL注入(附验证脚本)</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/39886.html" rel="bookmark" title="详细阅读 艺龙旅行网设计缺陷导致后台沦陷（泄漏大量用户开房信息）">艺龙旅行网设计缺陷导致后台沦陷（泄漏大量用户开房信息）</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/31645.html" rel="bookmark" title="详细阅读 工商银行安全控件可导致远程任意代码执行（新型技术点）">工商银行安全控件可导致远程任意代码执行（新型技术点）</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/11078.html" rel="bookmark" title="详细阅读 雅信达语言学科网络平台上传漏洞">雅信达语言学科网络平台上传漏洞</a></li>
					</ul>


</aside><aside id="text-11" class="widget-container widget_text"><div class="si-title"><h2>脉搏官方微信公众号</h2></div>			<div class="textwidget"><img src="https://www.secpulse.com/wp-includes/images/SecPulse.png" width="280px" height="364px" /></div>
		</aside>				</div>
	</div>

	</section>

  <div class="inner row visible-lg-block">

	<div class="friends">
		<h3>友情链接</h3>
		<ul>
			<li><a href="https://xianzhi.aliyun.com/forum/?secpulse" target="_blank">先知安全社区</a><span>|</span></li>
			<li><a href="https://threathunter.org/" target="_blank">ThreatHunter社区</a><span>|</span></li>
			<li><a href="http://www.ijiandao.com/" target="_blank">网络尖刀</a><span>|</span></li>
			<li><a href="http://navisec.it/" target="_blank">NaviSec导航</a><span>|</span></li>
		    <li><a href="https://www.easyaq.com/" target="_blank">E安全</a><span>|</span></li>
			<li><a href="http://www.sec-wiki.com/" target="_blank">Sec-Wiki</a><span>|</span></li>
			<li><a href="http://www.waitalone.cn/" target="_blank">独自等待</a><span>|</span></li>
			<li><a href="http://www.shellsec.com/" target="_blank">神刀网</a><span>|</span></li>
			<li><a href="http://www.ineice.com/" target="_blank">爱内测</a><span>|</span></li>
			<li><a href="http://www.itet.cn/" target="_blank">北京ITET培训中心</a><span>|</span></li>
			<li><a href="http://www.ihonker.org/" target="_blank">中国红客联盟</a><span>|</span></li>
			<li><a href="http://www.bigniu.com/" target="_blank">比戈大牛</a><span>|</span></li>
			<li><a href="http://www.tiejiang.org/" target="_blank">铁匠运维网</a><span>|</span></li>
			<li><a href="http://www.nagain.com" target="_blank">娜迦信息</a><span>|</span></li>
			<li><a href="https://www.secsilo.com/" target="_blank">SecSilo</a><span>|</span></li>
			<li><a href="https://team.armyzer0.com" target="_blank">armyzer0</a><span>|</span></li>
			<li><a href="http://www.nosafe.org" target="_blank">NoSafe</a></li>
		</ul>
	</div>

	<div class="friends">
		<h3>合作伙伴</h3>
		<ul>
			<a href="https://www.duoyinsu.com" class="external" target="_blank">
				<img src="https://www.secpulse.com/wp-content/uploads/anshi-logo.png"
				alt="安识科技" width="150px" height="45px">
			</a>
			<a href="http://aq.163.com/module/partner.html" class="external"
				target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/netease.jpg"
				alt="网易安全中心" width="150px" height="45px">
			</a>
			<a href="https://security.alibaba.com/" class="external"
				target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/asrc.jpg"
				alt="阿里安全中心" width="150px" height="45px">
			</a>
			
			<a href="http://yaq.qq.com/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/yaqnew.png" alt="腾讯御安全"
				width="140px" height="45px">
			</a>
			
			<a href="http://www.4hou.com" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/4hou.png"
				alt="嘶吼RoarTalk" width="150px" height="45px">
			</a>
			
			<a href="http://www.ichunqiu.com/?from=secpulse" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/ichunqiu.png" alt="i春秋学院"
				width="140px" height="45px">
			</a>

			<a href="#" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/bigsec.png" alt="bigsec岂安科技"
				width="140px" height="45px">
			</a>
		
			<a href="http://www.milw0rm.cn/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/milw0rm.png"
				alt="Milw0rm Team" width="120px" height="40px">
			</a>


			<a href="#" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/cloversec.png"
				alt="四叶草安全" width="130px" height="45px">
			</a>
			<a href="https://www.aqdog.com" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/aqdog.png"
				alt="安犬云平台" width="140px" height="45px">
			</a>
			
			<a href="http://www.e365.org/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/e365.png"
				alt="易安在线" width="130px" height="45px">
			</a>
			
			
			

		</ul>
	</div>
</div>
<footer class="footer clr" id="footer">
	<div class="inner inner-footer">
		<div class="footer-secpulse">
			<h3>SecPulse</h3>
			<ul>
				<li><a href="/about">关于SecPulse</a></li>
				<!--<li><a href="http://test.secpulse.com">SecPulse专测</a> <sup>NEW!</sup></li>-->
				<li><a href="/hire">加入我们</a></li>
				<li><a href="/report">寻求报道</a></li>
				<li><a href="/contact-us">联系我们</a></li>
			</ul>
		</div>
		<div class="footer-subscribe xs-hidden">
			<h3>订阅</h3>
			<ul>
				<li><a href="/feed">RSS订阅</a></li>
				<li><a href="/feed">邮箱订阅</a></li>
				<li><a href="/feed">线下活动订阅</a></li>
				<li></li>
				<li><a href="http://weibo.com/311057789">官方微博</a></li>
				<!-- <li><a href="https://twitter.com/secpulse">Twitter</a></li> -->
			</ul>
		</div>
		<div class="footer-partner">
			<h3>全力驱动</h3>
			<ul class="cf">
				<li><a href="https://www.secpulse.com" class="external"
					target="_blank"><img
						src="https://www.secpulse.com/wp-content/uploads/seclogo.png"
						alt="安全脉搏" width="200px"></a></li>
			</ul>
		</div>
		<div class="footer-copyright xs-hidden">
			<p>本站由SecPulse安全脉搏团队全力维护。</p>
			<p>
				Powered By <a title="安全脉搏" href="https://www.secpulse.com">SecPulse</a>
			</p>
			<p>©2013-2017 安全脉搏</p>
			<p>沪ICP备16016474号</p>
			<img src="https://www.secpulse.com/wp-includes/images/qrcode.jpg"
				alt="Qrcode" height="150px" width="150px">

		</div>
	</div>
</footer>
<div id="shangxia">
	<div id="shang" title="↑ 返回顶部"></div>
              <div id="comt" title="查看评论"></div>
              <div id="xia" title="↓ 移至底部"></div>
</div>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/plugins/akismet/_inc/form.js?ver=3.1.2'></script>
</body>

</html>
