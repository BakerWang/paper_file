<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />	
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="renderer" content="webkit">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0">
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<title>2015移动安全挑战赛（阿里&amp;看雪主办）全程回顾 - SecPulse.COM | 安全脉搏</title>
<meta name="description" content="汇集全国一流安全精英，挑战业内最强移动安全防御。2015移动安全挑战赛由阿里&amp;看雪在1月22日联合主办，本次比赛为单人挑战赛，非团队赛，参赛者需在比赛页面下载并破解给出移动应用。" />
<meta name="keywords" content="adb logcat,AliCrackme_5.apk,android_log_print,Annotations,AOSP,Dalvik VM,Dalvik字节码,Dexdump,getAnnotation,GoSSIP,GoSSIP_SJTU,hashcode,InDroid,init_array,Java_ali_00024a_M_00024j,jeb,JNI_Onload,libcrackme.so,libmobisec.so,s57e1p,securityCheck,wbyang,wojiushidaan,义弓么丸广之" />

<link rel='stylesheet' id='style-css'  href='https://www.secpulse.com/wp-content/themes/sec/style.css?ver=2014.9.21' type='text/css' media='all' />
<link rel='stylesheet' id='jquery.fancybox-css'  href='https://www.secpulse.com/wp-content/themes/sec/css/jquery.fancybox.css?ver=1.0' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-css'  href='https://www.secpulse.com/wp-content/themes/sec/css/font-awesome.min.css?ver=1.0' type='text/css' media='all' />
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.min.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.fancybox.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/helpers/jquery.fancybox-buttons.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.mousewheel-3.0.6.pack.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/owl.carousel.min.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/custom.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/comments-ajax.js?ver=1.3'></script>
<link rel='canonical' href='https://www.secpulse.com/archives/5731.html' />
<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?7f4cc5524dcb1aec487b4266c18bae48";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


</head>
<body class="single single-post postid-5731 single-format-standard">
	<header id="header" class="header clr">
		<div class="header-top inner clr">
	<hgroup class="logo-main"><h1 class="logo"><a href="https://www.secpulse.com/" rel="home" title="安全脉搏">安全脉搏</a></h1><h4 class="xs-hidden">分享技术，悦享品质 
	</h4>
	</hgroup>

<div class="login xs-hidden">
				<div class="logindiv">
					<div class="img">
<img src="https://www.secpulse.com/wp-content/uploads/2017/05/rabbit.jpeg" width="36" height="36" alt="" class="avatar avatar-36 wp-user-avatar wp-user-avatar-36 photo avatar-default" /></div><span href="javascript:void(0);" title="用户" class="yh">用户</span><i
						class="fa fa-caret-down fa-2"></i>
					<ul class="login-links">
						<li class="log"><a
							href="https://www.secpulse.com/wp-login.php"
							target="_blank"><i class="fa fa-arrow-right"></i><span>登陆</span></a></li>
						<li class="exit"><a
							href="https://www.secpulse.com/wp-login.php?action=register"><i
								class="fa fa-user-times"></i><span>注册</span></a></li>
					</ul>
	
  </div>
			</div>
			<div class="top-search xs-hidden">
  <form id="search" method="get" action="https://www.secpulse.com" >
	<input type="text" name="s" id="s" autocomplete="off"  placeholder="输入搜索内容">
	<button class="btn-search"> <i class="fa fa-search"></i></button>
</form></div>
			<div class="menu-button">
				<i class="fa fa-bars fa-3x"></i>
			</div>
		</div>


		<div class="main-nav  xs-hidden">
			<div class="inner clr"><nav class="left-nav clr"><ul id="menu-%e5%af%bc%e8%88%aa" class="header-menu-nav"><li id="menu-item-15" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15"><a href="https://www.secpulse.com/">首页</a></li>
<li id="menu-item-17" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-has-children menu-item-17"><a href="https://www.secpulse.com/archives/category/articles">文章</a>
<ul class="sub-menu">
	<li id="menu-item-34048" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34048"><a href="https://www.secpulse.com/archives/category/articles/intranet-penetration">内网渗透</a></li>
	<li id="menu-item-34047" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34047"><a href="https://www.secpulse.com/archives/category/articles/code-audit">代码审计</a></li>
	<li id="menu-item-34046" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34046"><a href="https://www.secpulse.com/archives/category/articles/web">Web安全</a></li>
	<li id="menu-item-34565" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34565"><a href="https://www.secpulse.com/archives/category/articles/sec-doc">安全文献</a></li>
	<li id="menu-item-34568" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34568"><a href="https://www.secpulse.com/archives/category/articles/social-engineering">社会工程</a></li>
	<li id="menu-item-35948" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35948"><a href="https://www.secpulse.com/archives/category/articles/wireless">无线安全</a></li>
	<li id="menu-item-35949" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-35949"><a href="https://www.secpulse.com/archives/category/articles/mobile-security">移动安全</a></li>
	<li id="menu-item-35950" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-35950"><a href="https://www.secpulse.com/archives/category/articles/system">系统安全</a>
	<ul class="sub-menu">
		<li id="menu-item-35951" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35951"><a href="https://www.secpulse.com/archives/category/articles/system/linux">Linux</a></li>
		<li id="menu-item-35952" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35952"><a href="https://www.secpulse.com/archives/category/articles/system/windows">Windows</a></li>
	</ul>
</li>
	<li id="menu-item-35953" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35953"><a href="https://www.secpulse.com/archives/category/articles/reverse-break">逆向破解</a></li>
</ul>
</li>
<li id="menu-item-18" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-18"><a href="https://www.secpulse.com/archives/category/news">资讯</a>
<ul class="sub-menu">
	<li id="menu-item-35956" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35956"><a href="https://www.secpulse.com/archives/category/news/china-news">国内资讯</a></li>
	<li id="menu-item-35957" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35957"><a href="https://www.secpulse.com/archives/category/news/world-news">国外资讯</a></li>
</ul>
</li>
<li id="menu-item-379" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-379"><a href="https://www.secpulse.com/archives/category/construction">安全建设</a>
<ul class="sub-menu">
	<li id="menu-item-51480" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51480"><a href="https://www.secpulse.com/archives/category/construction/securityissue">安全管理</a></li>
	<li id="menu-item-54332" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54332"><a href="https://www.secpulse.com/archives/category/construction/%e4%b8%9a%e5%8a%a1%e5%ae%89%e5%85%a8">业务安全</a></li>
	<li id="menu-item-35955" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35955"><a href="https://www.secpulse.com/archives/category/construction/bigdata">数据分析</a></li>
	<li id="menu-item-54333" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54333"><a href="https://www.secpulse.com/archives/category/construction/security-reports">安全报告</a></li>
</ul>
</li>
<li id="menu-item-368" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-has-children menu-item-368"><a href="https://www.secpulse.com/archives/category/exclusive">独家</a>
<ul class="sub-menu">
	<li id="menu-item-35947" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35947"><a href="https://www.secpulse.com/archives/category/articles/industrial-safety">工控安全</a></li>
	<li id="menu-item-35954" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-35954"><a href="https://www.secpulse.com/archives/category/exclusive/ctf-writeup">CTF</a></li>
	<li id="menu-item-50217" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-50217"><a href="https://www.secpulse.com/archives/category/exclusive/duoyinsu">多因素令牌</a></li>
	<li id="menu-item-51479" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51479"><a href="https://www.secpulse.com/archives/category/exclusive/dataleakage">数据泄露</a></li>
</ul>
</li>
<li id="menu-item-16" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-16"><a href="https://www.secpulse.com/archives/category/tools">工具</a></li>
<li id="menu-item-52" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-52"><a href="https://www.secpulse.com/archives/category/hiring">招聘</a></li>
<li id="menu-item-50" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50"><a href="https://www.secpulse.com/newsend">投稿</a></li>
<li id="menu-item-6645" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6645"><a href="https://www.secpulse.com/archives/category/vul">漏洞</a></li>
</ul></nav>  <nav class="right-nav clr "><ul id="menu-%e5%af%bc%e8%88%aa%e4%ba%8c" class="header-menu-nav"><li id="menu-item-33967" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33967"><a title="付费渗透测试" href="http://service.secpulse.com">安全服务</a></li>
<li id="menu-item-52043" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-52043"><a title="安全从业者最实用的安全导航" href="http://nav.secpulse.com">安全导航</a></li>
<li id="menu-item-33966" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33966"><a title="安识科技" href="https://www.duoyinsu.com">多因素</a></li>
</ul></nav></div>
		</div>
		<div class="nav-bg"></div>
   <nav class="mini-nav visible-xs"><ul id="menu-%e5%af%bc%e8%88%aa-1" class="menu-mini-nav"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15"><a href="https://www.secpulse.com/">首页</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-has-children menu-item-17"><a href="https://www.secpulse.com/archives/category/articles">文章</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34048"><a href="https://www.secpulse.com/archives/category/articles/intranet-penetration">内网渗透</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34047"><a href="https://www.secpulse.com/archives/category/articles/code-audit">代码审计</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34046"><a href="https://www.secpulse.com/archives/category/articles/web">Web安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34565"><a href="https://www.secpulse.com/archives/category/articles/sec-doc">安全文献</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34568"><a href="https://www.secpulse.com/archives/category/articles/social-engineering">社会工程</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35948"><a href="https://www.secpulse.com/archives/category/articles/wireless">无线安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-35949"><a href="https://www.secpulse.com/archives/category/articles/mobile-security">移动安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-35950"><a href="https://www.secpulse.com/archives/category/articles/system">系统安全</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35951"><a href="https://www.secpulse.com/archives/category/articles/system/linux">Linux</a></li>
		<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35952"><a href="https://www.secpulse.com/archives/category/articles/system/windows">Windows</a></li>
	</ul>
</li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35953"><a href="https://www.secpulse.com/archives/category/articles/reverse-break">逆向破解</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-18"><a href="https://www.secpulse.com/archives/category/news">资讯</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35956"><a href="https://www.secpulse.com/archives/category/news/china-news">国内资讯</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35957"><a href="https://www.secpulse.com/archives/category/news/world-news">国外资讯</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-379"><a href="https://www.secpulse.com/archives/category/construction">安全建设</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51480"><a href="https://www.secpulse.com/archives/category/construction/securityissue">安全管理</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54332"><a href="https://www.secpulse.com/archives/category/construction/%e4%b8%9a%e5%8a%a1%e5%ae%89%e5%85%a8">业务安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35955"><a href="https://www.secpulse.com/archives/category/construction/bigdata">数据分析</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54333"><a href="https://www.secpulse.com/archives/category/construction/security-reports">安全报告</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-has-children menu-item-368"><a href="https://www.secpulse.com/archives/category/exclusive">独家</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35947"><a href="https://www.secpulse.com/archives/category/articles/industrial-safety">工控安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-35954"><a href="https://www.secpulse.com/archives/category/exclusive/ctf-writeup">CTF</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-50217"><a href="https://www.secpulse.com/archives/category/exclusive/duoyinsu">多因素令牌</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51479"><a href="https://www.secpulse.com/archives/category/exclusive/dataleakage">数据泄露</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-16"><a href="https://www.secpulse.com/archives/category/tools">工具</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-52"><a href="https://www.secpulse.com/archives/category/hiring">招聘</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50"><a href="https://www.secpulse.com/newsend">投稿</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6645"><a href="https://www.secpulse.com/archives/category/vul">漏洞</a></li>
</ul></nav>     </header><section class="xs-main index-main clr">
<div class="inner">
<div class="xs-left">
<nav class="crumbs">现在位置： <a title="返回首页" href="https://www.secpulse.com">首页</a> &gt; <a href="https://www.secpulse.com/archives/category/exclusive">独家</a> &gt; <a href="https://www.secpulse.com/archives/category/exclusive/ctf-writeup" rel="category tag">CTF</a> &gt; <a href="https://www.secpulse.com/archives/category/articles">文章</a> &gt; <a href="https://www.secpulse.com/archives/category/articles/mobile-security" rel="category tag">移动安全</a> &gt;  正文 </nav><article id="post-5731" class="post-5731 post type-post status-publish format-standard hentry category-ctf-writeup category-mobile-security tag-adb-logcat tag-alicrackme_5-apk tag-android_log_print tag-annotations tag-aosp tag-dalvik-vm tag-dalvik tag-dexdump tag-getannotation tag-gossip tag-gossip_sjtu tag-hashcode tag-indroid tag-init_array tag-java_ali_00024a_m_00024j tag-jeb tag-jni_onload tag-libcrackme-so tag-libmobisec-so tag-s57e1p tag-securitycheck tag-wbyang tag-wojiushidaan tag-2410">
	<header class="single-header">
		<h1>2015移动安全挑战赛（阿里&#038;看雪主办）全程回顾</h1>
			<div class="single-meta">
				
		    <div class="time"><i></i> <a href="javascript:void(0);">2015 /4/2 23:11</a></div>
			<div class="eye xs-hidden"><i class="fa fa-eye fa-1"></i><a href="javascript:void(0);">12,412</a> </div>			<div class="comments xs-hidden"><i class="fa fa-comments fa-1"></i><a href="https://www.secpulse.com/archives/5731.html#respond">沙发</a></div>
			
			
		</div>
		<!-- .entry-meta -->
	</header>
	<!-- .single-header -->

	<div class="single-main">
		<p>汇集全国一流安全精英，挑战业内最强移动安全防御。2015移动安全挑战赛由阿里&amp;看雪在1月22日联合主办，本次比赛为单人挑战赛，非团队赛，参赛者需在比赛页面下载并破解给出移动应用。</p>
<p>所有比赛过程均在线上完成。3天赛程中共开启5道题，参赛者破解了当前题目后即可开启下一题。</p>
<p>比赛时，参赛者需破解给出的移动应用程序，提交正确答案，破解成功后将赢得该题对应的分值。</p>
<p>本writeup作者：上海交通大学密码与计算机安全实验室软件安全小组GoSSIP</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/04/index.jpg"><img class="alignnone size-full wp-image-5733" src="http://www.secpulse.com/wp-content/uploads/2015/04/index.jpg" alt="index" width="600" height="270" /></a></p>
<h2>第一题</h2>
<h3><span style="color: #ff6600;">0x1 分析</span></h3>
<p>&nbsp;</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/04/0x01.jpg"><img class="alignnone size-full wp-image-5734" src="http://www.secpulse.com/wp-content/uploads/2015/04/0x01.jpg" alt="0x01" width="540" height="960" /></a></p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/04/AliCrackme_1.zip" target="_blank">AliCrackme_1</a></p>
<p>本次比赛的第一个题目是一个APK文件，安装后，需要用户输入特定的密码，输入正确会显示破解成功。</p>
<p>该题目的APK文件没有太多的保护，可以直接使用各种分析工具（如jeb等）反编译得到Java代码。</p>
<p>获得正确注册码的代码逻辑为：</p>
<p>1. 从logo.png这张图片的偏移89473处，读取一个映射表，768字节编码成UTF-8，即256个中文表</p>
<p>2. 从偏移91265处读取18个字节编码的UTF-8（即6个中文字符）为最终比较的密码。然后通过输入的字符的转换，转换规则就是ASCII字符编码，去比较是否和最终密码相等。</p>
<p>&nbsp;</p>
<h3><span style="color: #ff6600;">0x2 巧妙的解法</span></h3>
<p>我们在这里提供一种非常愉快的解法，不需要复杂的工具和分析，大家可以参见视频</p>
<p><embed src="http://www.secpulse.com/wp-content/uploads/2015/04/alimobisec_1.mp4" width="480" height="390"></embed></p>
<p>&nbsp;</p>
<p>打开app后，我们使用adb logcat并加上这个app独有的 <em>lil</em> 标签过滤日志输出，发现app输出日志中有table，pw以及enPassword。</p>
<p>随意输入字符串如123456789，发现enPassword中有对应的中文输出，根据输出反馈，可以知道有如下对应关系</p>
<ul>
<li>1 - 么</li>
<li>2 - 广</li>
<li>3 - 亡</li>
<li>4 - 门</li>
<li>5 - 义</li>
<li>6 - 之</li>
<li>7 - 尸</li>
<li>8 - 弓</li>
<li>9 - 己</li>
</ul>
<p>通过观察Logcat输出可知，最终目标pw应为<em>义弓么丸广之</em>，根据上述table中的对应关系，我们可以得到最终密码为：</p>
<pre class="lang:python decode:true ">581026</pre>
<p>&nbsp;</p>
<h2>第二题</h2>
<h3><span style="color: #ff6600;">0x1 分析</span></h3>
<p>&nbsp;</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/04/0x02.png"><img class="alignnone size-full wp-image-5735" src="http://www.secpulse.com/wp-content/uploads/2015/04/0x02.png" alt="0x02" width="353" height="624" /></a></p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/04/AliCrackme_2.zip">AliCrackme_2</a></p>
<p>本次比赛的第二个题目仍然是一个独立的APK文件，安装后，需要用户输入特定的密码，输入正确会显示成功。第二题APK在Java层代码中并没有关键逻辑，将用户输入直接传给native so层中<em>securityCheck</em>这个native method（<em>securityCheck</em>方法在libcrackme.so中），由native code来决定返回正确与否。</p>
<p>用IDA工具打开libcrackme.so，首先看下程序的大致流程，可以看到在<em>securityCheck</em>这个方法调用前，在<em>init_array</em>段和<em>JNI_Onload</em>函数里程序都做了些处理，而在<em>securityCheck</em>方法的最后有一个判断，将用户输入和<strong>wojiushidaan</strong>做比较。尝试直接输入<strong>wojiushidaan</strong>，发现密码错误，因此可以猜测前面一大段逻辑的作用就是会把这个最终的字符串改掉。此时的思路是只需知道最终判断时候这个<strong>wojiushidaan</strong>地址上的变换后的值就行了。尝试使用IDA调试发现一旦attach上去，整个程序就退出，想必一定是在之前的代码中有反调试的代码。</p>
<p>&nbsp;</p>
<h3><span style="color: #ff6600;">0x2 巧妙的解法</span></h3>
<p>同上一题一样，我们提供一种非常巧妙的解法：</p>
<p>注意到在最终比较之前，程序使用了<em>android_log_print</em>函数，当我们直接运行程序时，发现这里固定输出了</p>
<pre class="lang:python decode:true ">I/yaotong ( XXX): SecurityCheck Started...</pre>
<p>&nbsp;</p>
<p>这时候我们想，是否可以直接patch这个libcrackme.so，修改打印的内容，直接利用这个函数帮我们输出此时真正需要比较的值。</p>
<p>我们选择patch的方法是直接把这个log函数往下移，因为在0x12A4地址处正好有我们需要的打印的数据地址赋值给了R2寄存器（本来是为了给后面做比较用的），因此将代码段从0x1284到0x129C的地方都用NOP改写，在0x12AC的地方调用log函数，同时为了不影响R1的值，把0x12A0处的R1改成R3。</p>
<p>下面是对比patch前和patch后的图：</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/04/0x03.png"><img class="alignnone size-large wp-image-5736" src="http://www.secpulse.com/wp-content/uploads/2015/04/0x03-1024x512.png" alt="0x03" width="1024" height="512" /></a></p>
<p>&nbsp;</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/04/0x04.png"><img class="alignnone size-large wp-image-5737" src="http://www.secpulse.com/wp-content/uploads/2015/04/0x04-1024x510.png" alt="0x04" width="1024" height="510" /></a>......................</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>参考视频给出了完整的解决过程：</p>
<p><embed src="http://static.wooyun.org/drops/20150331/alimobisec_2.mp4" width="480" height="390"></embed></p>
<p>通过观察Logcat输出可知，最终密码为：</p>
<pre class="lang:python decode:true ">aiyou,bucuoo</pre>
<p>&nbsp;</p>
<h2>第三题</h2>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/04/AliCrackme_3.zip">AliCrackme_3</a></p>
<p>在介绍本次比赛第三道题目之前，首先要介绍一个我们GoSSIP小组开发的基于Dalvik VM的插桩分析框架InDroid，其设计思想是直接修改AOSP上的Dalvik VM解释器，在解释器解释执行Dalvik字节码时，插入监控的代码，这样就可以获取到所有程序运行于Dalvik上的动态信息，如执行的指令、调用的方法信息、参数返回值、各种Java对象的数据等等。InDroid只需要修改AOSP的dalvik vm部分代码，编译之后，可直接将编译生成的新libdvm.so刷入任何AOSP支持的真机设备上（目前我们主要使用Nexus系列机型特别是Nexus4和Galaxy Nexus）。在本次比赛的第三题和第四题分析过程中，我们使用该工具进行分析，大大提高了分析效率。具体细节可以参考我们发表的CIT 2014论文<strong>DIAS: Automated Online Analysis for Android Applications</strong></p>
<p>回到题目上，将第三题的APK进行反编译后发现代码使用了加壳保护，对付这类加壳的APK，最方便的方法就是使用InDroid来进行动态监控，因为静态加密的DEX一定会在执行时在Dalvik上时解密执行，这样我们可以直接在InDroid框架里对解释执行过程中释放出来的指令进行监控。在我们自己使用的工具里，我们开发了一个动态读取整个dex信息的接口，执行时去读DexFile这个结构，然后对其进行解析（解析时直接复用了Android自带的dexdump的代码）。这样，我们的插桩工具在运行程序后，能够直接得到程序的dex信息，同未经保护时使用dexdump后得到的结果基本一致。虽然我们得到的信息是dalvik字节码，没有直接反编译成Java代码那么友好，但由于程序不大，关键逻辑不多，因此对我们的分析效率影响并不大。</p>
<p>使用InDroid进行脱壳的演示视频：</p>
<p><embed src="http://www.secpulse.com/wp-content/uploads/2015/04/Alimobisec_3_1.mp4" width="480" height="390"></embed></p>
<p>在得到脱壳之后的dexdump结果后，我们可以对代码进行静态分析。我们发现用户的输入会传递给继承自Class timertask的Class b，被Class b的<em>run</em>方法处理。在<em>run</em>方法中，如果<em>sendEmptyMessage</em>方法被调用时的参数为0，就会导致Class c的<em>handleMessage</em>这个方法中得到的<em>message</em>的<em>what</em>值为0，进而导致103除0跳入异常处理中，触发成功的提示。</p>
<p>继续分析这个<em>run</em>方法的逻辑，可以知道用户的输入会被传递到Class e的<em>a</em>方法中，做个类似摩尔斯译码的过程（其译码与标准的摩尔斯电码不太一样），然后经过下面一系列大量的混淆用的无用处理和不可能相等的比较后，将译码后得到的字符串送入到关键的判断中去。这个判断成功的条件比较复杂：对于译码后得到的字符串的前两个字节，要求使用hashcode方法的结果等于3618，并且这两个字节相加等于168，才会进入后面的比较。我们穷搜索一下符合这类输入的字符串：</p>
<div>
<div class="syntaxhighlighter  java">
<pre class="lang:python decode:true ">for ( size_t i = 33; i &lt; 127; ++i )
{
    for ( size_t j = 33; j &lt; 127; ++j )
    {
        String x =String.valueOf((char)j)+String.valueOf((char)i);
        if (x.hashCode()==3618 &amp;&amp; (i+j) == 168)
        {
            System.out.println(x);
            System.out.println(j+i);
        }
    }
}</pre>
<p>&nbsp;</p>
</div>
<div id="highlighter_56763" class="syntaxhighlighter  java">输出为：</div>
</div>
<pre class="lang:python decode:true ">s5
168</pre>
<p>&nbsp;</p>
<p>也就是说只有<strong>s5</strong>满足hashcode为3618，而相加等于168这个条件。</p>
<p>确定前两个字符后，后面还有四个字符需要同Class e和Class a的Annotation值比较。因为我们做脱壳的时候直接使用了dexdump的代码，而dexdump即使到最新版里也无法很好地处理Annotations：</p>
<pre class="lang:python decode:true ">// TODO: Annotations.</pre>
<p>&nbsp;</p>
<p>不过没关系，我们还有动态分析工具这一利器，因为最终目的是得到<em>getAnnotation</em>方法的返回值，依然可以用InDroid在Dalvik执行到<em>getAnnotation</em>方法时监控返回值，就能得到Annotation的具体值。使用InDroid获取具体信息的视频如下：</p>
<p><embed src="http://www.secpulse.com/wp-content/uploads/2015/04/Alimobisec_3_2.mp4" width="480" height="390"></embed></p>
<p>最后可知，符合程序需求的字符串是</p>
<pre class="lang:python decode:true ">s57e1p</pre>
<p>&nbsp;</p>
<p>使用程序内部的对应表，对其进行逆变换，能够让程序输入成功提示的输入应该是：</p>
<pre class="lang:python decode:true ">… _____ ____. . ..___ .__.</pre>
<p>&nbsp;</p>
<h2>第四题</h2>
<p>&nbsp;</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/04/0x05.png"><img class="alignnone size-large wp-image-5738" src="http://www.secpulse.com/wp-content/uploads/2015/04/0x05-576x1024.png" alt="0x05" width="576" height="1024" /></a></p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/04/AliCrackme_4.zip">AliCrackme_4</a></p>
<p>本次移动安全挑战赛的第四题和第三题一样，是一个包含了加壳dex的APK文件，我们使用同解决上一题一样的方法，用InDroid得到原始dex文件的dexdump结果:</p>
<p>使用InDroid进行脱壳的演示视频：</p>
<p><embed src="http://www.secpulse.com/wp-content/uploads/2015/04/Alimobisec_4.mp4" width="480" height="390"></embed></p>
<p>Dex整体处理过程和上一题也类似，使用<code>handleMessage</code>处理最后的判断输入成功与否，只有<code>sendEmptyMessage(0)</code>后，触发除以0的异常才能成功。不过这一题将用户输入转成byte后，传给一个native的方法：<code>ali$a</code>的<code>M$j</code>方法，另外参数还包括一个常数48和Handler。看样子逆向native库势在必行了。这一题的lib文件夹下文件和上一题是一样的，有三个文件，其中<code>libmobisecy.so</code>其实是个zip文件，解压后是个classes.dex，直接反汇编后，类和方法的名字都在，只是里面的代码都是</p>
<pre class="lang:python decode:true ">throw new RuntimeException();</pre>
<p>&nbsp;</p>
<p>而<code>libmobisecz.so</code>直接就是一堆binary数据，猜测应该是运行时会被解密，通过某种方式映射到为真正的代码执行。因此我们的目标就是<code>libmobisec.so</code>这个ELF文件。</p>
<p>直接用IDA打开<code>libmobisec.so</code>，发现IDA会崩溃。用readelf发现正常的节区头数据都被破坏了，因此应该这个so本身也被加过壳了，很多数据只有在动态运行时才会解开，所以直接使用动态的方法，先运行这个程序后，直接在内存中把这个so dump出来。</p>
<p>首先需要在输入框中随便输入些数据后，点击确定，保证用户输入数据执行到native方法里后再做dump。我们使用的方法是查看maps后，使用dd命令把整个so都dump出来。</p>
<p>输入命令：</p>
<pre class="lang:python decode:true ">root@maguro:/ # ps | grep crackme.a4
u0_a73    1935  126   512204 48276 ffffffff 400dc408 S crackme.a4
root@maguro:/ # cat /proc/1935/maps
5e0f2000-5e283000 r-xp 00000000 103:04 741132    /data/app-lib/crackme.a4-1/libmobisec.so
5e283000-5e466000 r-xp 00000000 00:00 0 
5e466000-5e467000 rwxp 00000000 00:00 0 
5e467000-5e479000 rw-p 00000000 00:00 0
5e479000-5e490000 r-xp 00191000 103:04 741132    /data/app-lib/crackme.a4-1/libmobisec.so
5e490000-5e491000 rwxp 001a8000 103:04 741132    /data/app-lib/crackme.a4-1/libmobisec.so
5e491000-5e492000 rw-p 001a9000 103:04 741132    /data/app-lib/crackme.a4-1/libmobisec.so
5e492000-5e493000 rwxp 001aa000 103:04 741132    /data/app-lib/crackme.a4-1/libmobisec.so
5e493000-5e4c1000 rw-p 001ab000 103:04 741132    /data/app-lib/crackme.a4-1/libmobisec.so</pre>
<p>&nbsp;</p>
<p>使用dd命令将libmobisec.so的内存dump出来</p>
<pre class="lang:python decode:true ">root@maguro:/ # dd if=/proc/1935/mem of=/sdcard/alimsc4 skip=1578049536 ibs=1 count=3993600</pre>
<p>&nbsp;</p>
<p>dd命令使用的数字都是十进制的，skip就是<code>libmobisec.so</code>的起始地址，count是总长度。 为了让IDA还能够识别libmobisec里的libc函数，我们还需要把libc也载入到IDA中，libc就直接从system/lib里拖出来就行了。</p>
<pre class="lang:python decode:true ">adb pull /system/lib/libc.so ./</pre>
<p>&nbsp;</p>
<p>用IDA先打开libc，调整好是在内存中的偏移即rebase program，再在load additional binary里载入dd出来的libmobisec.so，通过maps里的偏移后载入。接下来的任务就是在其中找到M\$j这个函数的地址。</p>
<p>一开始尝试直接在dd出来的ELF文件中找这个M\$j这个函数名，类似的名字会被处理成</p>
<pre class="lang:python decode:true">Java_ali_00024a_M_00024j</pre>
<p>&nbsp;</p>
<p>类似下图：</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/04/0x06.png"><img class="alignnone size-full wp-image-5739" src="http://www.secpulse.com/wp-content/uploads/2015/04/0x06.png" alt="0x06" width="631" height="237" /></a></p>
<p>&nbsp;</p>
<p>不过我没找到这个<code>M\$j</code>这个名字，逆过JNI库的都知道，如果符号表里找不到这个函数名，说明在<code>JNI_Onload</code>的时候，使用<code>RegisterNatives</code>函数重新将一个JNI函数映射为Native函数了。</p>
<p>正当一筹莫展的时候，我再次想起了InDroid系统。在Dalvik中，每个方法都是一个Method的结构体，其中当这个方法是native的时候，Method的insns这个指针会指向native方法的起始地址。因此我们修改了下InDroid，让Dalvik在执行<code>M\$j</code>这个方法前，去打印了<code>M\$j</code>方法的<code>insns</code>指针。这时我们得到了一个指向另一片内存区域的值，既不在libdvm中，也不在libmobisec中，并且这片内存页被映射成了rwx，由此推断里面也极有可能是代码，我们继而又dd出了这块内存，用IDA打开，使用ARM平台反汇编，发现该处就一条指令，是LOAD PC到另一个地址，而这个地址恰好在libmobisec中。于是我们直接到IDA中跳到这个地址，发现正好是个压栈指令，印证了我们的想法，此处就是M$j函数，于是在在IDA里该地址指令处，右击选择create function，让IDA识别这一段汇编指令为函数指令后，就可以通过F5查看看反编译的C代码了。</p>
<p>这个函数本身做了一些控制流混淆，同时还有很多字符串加解密的功能函数，一些简单的如异或操作，也被展开成与和或的组合等更长更复杂的表达式形式。另外还看到一些变形过的RC4，等等。不过因为我们已经是dump出来执行过的数据，所以必要的数据都已经解密了。如下图：</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/04/0x07.png"><img class="alignnone size-full wp-image-5740" src="http://www.secpulse.com/wp-content/uploads/2015/04/0x07.png" alt="0x07" width="211" height="377" /></a></p>
<p>&nbsp;</p>
<p>通过查看反编译的C代码，我发现程序中是直接通过JNI方法调用了Java中的<code>bh</code>类的方法<code>a</code>（在图2常量中也可以看到）。 再次回到dex层查看<code>a</code>方法，该方法是不断的将输入传递给不同的函数进行处理，先是<code>cd</code>的<code>a</code>方法，<code>cC</code>的<code>a</code>方法，<code>p</code>的<code>a</code>方法，<code>x</code>的<code>a</code>方法，<code>ali$a</code>的<code>M$d</code>方法（native），<code>aS</code>的<code>a</code>方法，<code>x</code>的<code>a</code>方法，<code>ali$a</code>的<code>M&amp;z</code>方法（native），<code>cd</code>的<code>a</code>方法，<code>cC</code>的<code>a</code>方法，每一个方法都是些简单的数学运算，编码，以及密码学处理等可逆的操作，结合逆向和Indroid对输入输出的监控，都可以轻松确定每个Java函数的作用，具体过程如下代码显示：</p>
<pre class="lang:python decode:true ">invoke-static {}, LbKn;.a:()Z // method@08a1
move-result v3
invoke-static {v3}, LbKn;.b:(I)V // method@08a2
add-int/lit8 v0, v5, #int 1 // #01
invoke-static {v4, v5}, Lcd;.a:([BI)[B // method@0b23
move-result-object v1
add-int/lit8 v2, v0, #int 1 // #01
invoke-static {v1, v0}, LcC;.a:([BI)[B // method@0a30
move-result-object v0
add-int/lit8 v1, v2, #int -1 // #ff
invoke-static {v0, v2}, Lp;.a:([BI)[B // method@0e8d
move-result-object v0
invoke-static {v0, v1}, Lx;.a:([BI)[B // method@0ede
move-result-object v0
add-int/lit8 v2, v1, #int -1 // #ff
invoke-static {v0, v1}, Lali$a;.M$d:([BI)[B // method@03d3
move-result-object v0
add-int/lit8 v1, v2, #int 1 // #01
invoke-static {v0, v2}, LaS;.a:([BI)[B // method@022e
move-result-object v0
invoke-static {v0, v1}, Lx;.a:([BI)[B // method@0ede
move-result-object v0
add-int/lit8 v2, v1, #int 1 // #01
invoke-static {v0, v1}, Lali$a;.M$z:([BI)[B // method@0440
move-result-object v0
add-int/lit8 v1, v2, #int 1 // #01
invoke-static {v0, v2}, Lcd;.a:([BI)[B // method@0b23
move-result-object v0
add-int/lit8 v2, v1, #int 1 // #01
invoke-static {v0, v1}, LcC;.a:([BI)[B // method@0a30
move-result-object v0
return-object v0</pre>
<p>&nbsp;</p>
<p>值得注意的是，其中有两个native的方法，因为InDroid还可以监控调用native方法的参数以及返回值，我们发现这几个native都没有对输入做复杂的处理，只有M\$d对输入的第四个字节做了减8的处理。</p>
<p>做了这些逆变换以后我们其实并没有找到最终比较的处理，不过在解密过的数据中（图2），不仅有之前需要调用的各种方法和类，还可以发现有个十分可疑的Base64的字符串。</p>
<pre class="lang:python decode:true ">aJTCZnf6NyBPYJfbrBuLu0wOhRFbPtvqpYjiby5J81M=</pre>
<p>&nbsp;</p>
<p>并且在native的M\$z方法的反汇编代码中，可以看到有对这个Base64字符串的长度比较，由于我们并没有找到真正的比较函数，因此得到这个字符串后，我们直接从M\$z开始向上逆推之前的变换就得到了的答案。</p>
<p>具体解密代码如下：</p>
<pre class="lang:python decode:true ">#!/usr/bin/env python
# encoding: utf-8
 
from Crypto.Cipher import AES
 
def Lcda(s):
    return ''.join(map(lambda x: chr((ord(x) + 3) &amp; 0xff), s))
def de_Lcda(s):
    return ''.join(map(lambda x: chr((ord(x) - 3) &amp; 0xff), s))
 
def LcCa(s, a):
    return ''.join([chr(((ord(s[i]) ^ a) + i) &amp; 0xff) for i in xrange(len(s))])
def de_LcCa(s, a):
    return ''.join([chr(((ord(s[i]) - i) &amp; 0xff) ^ a) for i in xrange(len(s))])
 
def Lpa(s):
    return s[1:] + s[0]
def de_Lpa(s):
    return s[-1] + s[:-1]
 
def Lxa(s):
    return s.encode("base64")[:-1]
def de_Lxa(s):
    return s.decode("base64")
 
def LaliaMd(s):
    return s[:3] + chr((ord(s[3]) - 8) &amp; 0xff) + s[4:]
def de_LaliaMd(s):
    return s[:3] + chr((ord(s[3]) + 8) &amp; 0xff) + s[4:]
 
def LaSa(s):
    BS = 16
    pad = lambda s: s + (BS - len(s) % BS) * chr(BS - len(s) % BS)
    cc = AES.new("qqVJwt11yyLm7hVK1iI2aw==".decode("base64"), AES.MODE_ECB)
    cipher = cc.encrypt(pad(s))
    return cipher
def de_LaSa(s):
    cc = AES.new("qqVJwt11yyLm7hVK1iI2aw==".decode("base64"), AES.MODE_ECB)
    cipher = cc.decrypt(s)
    return cipher
 
res = "aJTCZnf6NyBPYJfbrBuLu0wOhRFbPtvqpYjiby5J81M="
 
flag = de_Lcda(de_LcCa(de_Lpa(de_Lxa(de_LaliaMd(de_LaSa(de_Lxa(res))))), 49))
print flag</pre>
<p>&nbsp;</p>
<p>结果为：</p>
<pre class="lang:python decode:true ">alilaba2345ba</pre>
<p>&nbsp;</p>
<p>这里还需要提一下如何寻找<code>M\$d</code>和<code>M\$z</code>两个函数在so库中的地址的方法，不过这个方法是一些经验的总结，原因是整个native ELF文件的节区结构是被修改过的。这两个方法和M\$j不太一样，因为在dump出的libmobisec里可以找到M\$z的函数名，证明这个方法没有使用<code>RegiterNatives</code>来做变换，因此我们可以通过符号表来找这个函数与文件头部的偏移。方法是找<code>M\$z</code>和字符串表的偏移，如0x03FE，然后穷搜整个文件:</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/04/0x08.png"><img class="alignnone size-full wp-image-5741" src="http://www.secpulse.com/wp-content/uploads/2015/04/0x08.png" alt="0x08" width="674" height="83" /></a></p>
<p>&nbsp;</p>
<p>因为符号表应该会把字符串表偏移作为一项，这块区域的结构体，我们对照ELF结构发现并不是标准的符号表，但还是可以大概看出结构体的内容，包括索引，字符串表偏移，以及ELF特殊的标志数，因此推测0x57BE4偏移是<code>M\$z</code>函数。该地址也正好是个压栈的指令，证明了我们的猜想。</p>
<p>&nbsp;</p>
<h2>第五题</h2>
<p>&nbsp;</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/04/0x09.png"><img class="alignnone size-large wp-image-5742" src="http://www.secpulse.com/wp-content/uploads/2015/04/0x09-576x1024.png" alt="0x09" width="576" height="1024" /></a></p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/04/AliCrackme_5.zip">AliCrackme_5</a></p>
<p>2015年移动安全挑战赛的最后一道题目，在规定的比赛时间内，仅有来自我们<a href="http://loccs.sjtu.edu.cn/gossip" target="_blank">GoSSIP</a>的wbyang一名选手解决了这道问题，今天我们就来揭开这一道最高难度题目的神秘面纱。</p>
<p>先把名为<code>AliCrackme_5.apk</code>的文件丢到JEB里看一看：</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/04/0x10.jpg"><img class="alignnone wp-image-5743 size-large" src="http://www.secpulse.com/wp-content/uploads/2015/04/0x10-803x1024.jpg" alt="0x10" width="803" height="1024" /></a></p>
<p>&nbsp;</p>
<p>dex文件并没有进行加壳和混淆，看上去是一个非常简单的程序，Java代码部分使用函数<code>Register("Bomb_Atlantis", input)</code>对输入进行判断。所以需要分析的逻辑应该都在<code>libcrackme.so</code>里的<code>Register</code>函数中。</p>
<p>接下来我们用IDA打开这个<code>libcrackme.so</code>，不出所料的发现IDA完全没法处理，应该是进行了强烈的混淆和加壳处理：</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/04/0x11.jpg"><img class="alignnone size-large wp-image-5744" src="http://www.secpulse.com/wp-content/uploads/2015/04/0x11-896x1024.jpg" alt="0x11" width="896" height="1024" /></a></p>
<p>&nbsp;</p>
<p>使用和解决前面题目相同的技巧，我们继续使用<code>dd</code>的方法来去处一部分的混淆和加壳。运行一次程序后，从<code>/proc/self/maps</code>里找到<code>libcrackme.so</code>在内存中的位置，使用<code>dd</code>命令从<code>/proc/self/mem</code>中提取出内存中的<code>libcrackme.so</code>，接着使用在解决第四题时使用过的技巧，将<code>libcrackme.so</code>和<code>libc.so</code>一起加载到IDA里。</p>
<p>用IDA打开dump出的代码后，我们发现仍然有大部分的代码无法被IDA识别，需要手动定位到需要分析的代码然后手工定义（IDA快捷键<strong>C</strong>）代码，同时由于代码会在THUMB指令集和ARM指令集之间切换，有时候需要用快捷键<strong>ALT+G</strong>来将T寄存器设置为不同的值，设置正确后才能正确翻译出代码。这里我们首先遇到的问题是无法定位<code>Register</code>函数，同样使用第四题中的技巧，用InDroid监控到<code>Register</code>函数的真实地址，就可以在该地址上开始分析。</p>
<p>在<code>libcrackme.so</code>这个动态库里使用的一些混淆方法，对于处理了前面一些类似混淆后现在的我们来说已经不是问题（^_^）。通过分析代码，我们定位了几个函数，这些函数的偏移在不同的设备上应该是不同的。整体的逻辑其实并不复杂，首先会有一个固定的字符串“Bomb_Atlantis”和一个固定的salt去进行一次md5运算，salt是动态生成的，不过由于dump内存的时候这些动态的值已经生成好了，所以能够直接发现这个salt(出于一些版权原因我们不便公布本题目的一些内部细节，因此该salt值请大家自己分析）</p>
<p>之后程序会将这个md5值和我们的输入进行一些异或和计算的操作，经过几步比较简单、可逆的变换之后，进入一个比较复杂的函数，经过这个函数处理后直接和一个内存中的值进行比较，返回比较结果。</p>
<p><a href="http://www.secpulse.com/wp-content/uploads/2015/04/0x12.jpg"><img class="alignnone size-large wp-image-5745" src="http://www.secpulse.com/wp-content/uploads/2015/04/0x12-897x1024.jpg" alt="0x12" width="897" height="1024" /></a></p>
<p>&nbsp;</p>
<p>这里说一个我们在做第五题时用到的分析方法——动态hook。由于<code>libcrackme.so</code>中并没有对调用自身的上层应用进行验证，这就导致了我们可以自己写一个程序去加载这个so，调用其中的方法。这也导致了我们在加载<code>libcrackme.so</code>后，可以加载另一个用于hook的so，这样我们可以hook <code>libcrackme.so</code>中的任意函数，从而知道任意函数的参数和返回值，这对于我们理解程序有着非常大的帮助。这里我们使用的hook框架是著名Android安全研究人员Collin Mulliner开发的Android平台上的一个二进制注入框架<a href="https://github.com/crmulliner/adbi">adbi</a>。当然这道题目并不能够通过注入的方法将我们的so注入进去，因为源程序禁掉了ptrace这样的系统调用。我们对adbi稍作修改，使之成为一个可以手动加载的动态hook框架。同时由于我们没法通过符号表来定位函数的地址，所有的hook地址都需要硬编码，并且要和运行这道题目程序的Android设备内存映射严格对应。</p>
<p>需要指出的是adbi中存在一个小bug，<code>hook.c</code>这个文件的118行应该是</p>
<pre class="lang:python decode:true ">h-&gt;jumpt[0]=0x60</pre>
<p>&nbsp;</p>
<p>而不是0x30，对应的thumb汇编应该是</p>
<pre class="lang:python decode:true ">push{r5,r6}</pre>
<p>&nbsp;</p>
<p>而不是</p>
<pre class="lang:python decode:true ">push{r4,r5}，</pre>
<p>&nbsp;</p>
<p>这个小bug在解题过程中会造成一些影响。使用adbi来hook这道题目的函数还需要注意一点，这题的代码中有一些函数使用的THUMB指令集，hook这些函数时，不要忘记人工的对hook地址+1。</p>
<p>通过hook的方法，我们已经能够动态的分析<code>libcrackme.so</code>，首先我们验证了我们对之前几步变换的分析结果。之后就是分析最后一个复杂的处理函数，通过<strong>静态分析+动态调试</strong>，我们发现这是一个类似于白盒密码学的加密函数。我们的输入进入函数后，首先经过几步类似DES的预处理，之后会进行若干轮的查表，通过查询一个巨大的表将我们的输入进行某种加密，生成一段密文，再经过几次简单的处理后和最后内存中的一段常量(出于一些版权原因我们不便公布本题目的一些内部细节，因此该常量请大家自己分析）进行比较。</p>
<p>通过动态调试，我们能够计算出加密算法最后应该输出的值，但是由于这个加密算法的密钥融入了整个置换表中，要找出一个逆置换表显然不太可能。我们简单过滤了<code>libcrackme.so</code>的其他函数，也没有发现用于解密的函数，想要正常解密密文是不太现实了。不过根据对加密算法的分析，我们发现这若干轮的置换是相互独立的，并且每一轮的复杂度并不高，这就意味这我们可以在可以接受的时间内对算法进行爆破。我们一开始的想法是code reuse，直接在Android设备上爆破，但是发现速度太慢，最后只能用笨办法，通过hook从内存中dump出来置换表，用C代码重写了这个算法，有惊无险地在比赛结束前半小时搜索出结果。根据逆推算法推出正确输入是：</p>
<pre class="lang:python decode:true">3EFoAdTxepVcVtGgdVDB6AA=</pre>
<p>好了，我们的2015移动安全挑战赛全系列回顾就到此为止了！希望大家能和我们多多交流讨论，欢迎大家关注我们的微博<strong>GoSSIP_SJTU</strong>，基本上每天都会有精彩的内容发布哦。</p>
<p>【原文：<a title="Permanent Link to 2015移动安全挑战赛（阿里&amp;看雪主办）全程回顾" href="http://drops.wooyun.org/tips/5409" target="_blank" rel="bookmark">2015移动安全挑战赛（阿里&amp;看雪主办）全程回顾</a> 】</p>
		<div class="pageShenming">
【安全脉搏：分享技术、悦享品质。文章仅代表作者看法，如有不同观点，欢迎添加安全脉搏微信号：SecPulse，进行交流。】</div>
<div class="post-tags"><span>Tags: </span><a href="https://www.secpulse.com/archives/tag/adb-logcat" rel="tag">adb logcat</a><a href="https://www.secpulse.com/archives/tag/alicrackme_5-apk" rel="tag">AliCrackme_5.apk</a><a href="https://www.secpulse.com/archives/tag/android_log_print" rel="tag">android_log_print</a><a href="https://www.secpulse.com/archives/tag/annotations" rel="tag">Annotations</a><a href="https://www.secpulse.com/archives/tag/aosp" rel="tag">AOSP</a><a href="https://www.secpulse.com/archives/tag/dalvik-vm" rel="tag">Dalvik VM</a><a href="https://www.secpulse.com/archives/tag/dalvik%e5%ad%97%e8%8a%82%e7%a0%81" rel="tag">Dalvik字节码</a><a href="https://www.secpulse.com/archives/tag/dexdump" rel="tag">Dexdump</a><a href="https://www.secpulse.com/archives/tag/getannotation" rel="tag">getAnnotation</a><a href="https://www.secpulse.com/archives/tag/gossip" rel="tag">GoSSIP</a><a href="https://www.secpulse.com/archives/tag/gossip_sjtu" rel="tag">GoSSIP_SJTU</a><a href="https://www.secpulse.com/archives/tag/hashcode" rel="tag">hashcode</a><a href="https://www.secpulse.com/archives/tag/indroid" rel="tag">InDroid</a><a href="https://www.secpulse.com/archives/tag/init_array" rel="tag">init_array</a><a href="https://www.secpulse.com/archives/tag/java_ali_00024a_m_00024j" rel="tag">Java_ali_00024a_M_00024j</a><a href="https://www.secpulse.com/archives/tag/jeb" rel="tag">jeb</a><a href="https://www.secpulse.com/archives/tag/jni_onload" rel="tag">JNI_Onload</a><a href="https://www.secpulse.com/archives/tag/libcrackme-so" rel="tag">libcrackme.so</a><a href="https://www.secpulse.com/archives/tag/libmobisec-so" rel="tag">libmobisec.so</a><a href="https://www.secpulse.com/archives/tag/s57e1p" rel="tag">s57e1p</a><a href="https://www.secpulse.com/archives/tag/securitycheck" rel="tag">securityCheck</a><a href="https://www.secpulse.com/archives/tag/wbyang" rel="tag">wbyang</a><a href="https://www.secpulse.com/archives/tag/wojiushidaan" rel="tag">wojiushidaan</a><a href="https://www.secpulse.com/archives/tag/%e4%b9%89%e5%bc%93%e4%b9%88%e4%b8%b8%e5%b9%bf%e4%b9%8b" rel="tag">义弓么丸广之</a></div>
		</div>
	<!-- .single-content -->
		<div class="pageActive">
	<div class="mark-like-btn">
							</div>
	<!-- Baidu Button BEGIN -->
	<div class="bdshare">
		<div class="bdsharebuttonbox">
			<a href="#" class="bds_more" data-cmd="more"></a><a href="#"
				class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#"
				class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#"
				class="bds_weixin" data-cmd="weixin" title="分享到微信"></a>
		</div>
		<script>
		window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"32"},"share":{}};
		with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
		</script>

	</div>
</div>    <section id="text-6" class="widget-container widget_text hidden-xs">			<div class="textwidget"><center><a href="https://www.duoyinsu.com" target="_blank" title="安识科技 专业安全服务商"><img src="https://www.secpulse.com/wp-includes/images/secweixin.png" style="width:785px;height:315px"></a><center></div>
		</section><section id="related_post-2" class="widget-container widget_related_post hidden-xs"><h3 class="widget-title">相关文章</h3>

	<ul class="related_post">
				<li><a href="https://www.secpulse.com/archives/52719.html" title="详细阅读 Android逆向随笔之遇见MultiDex">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=https://www.secpulse.com/wp-content/uploads/2016/10/dex.png&h=150&w=249&zc=1" alt="Android逆向随笔之遇见MultiDex" class="xg-img"/>
		<p>Android逆向随笔之遇见MultiD&hellip;</P></a></li>
				<li><a href="https://www.secpulse.com/archives/48052.html" title="详细阅读 Android安全开发之ZIP文件目录遍历">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=https://www.secpulse.com/wp-content/uploads/2016/06/android.jpg&h=150&w=249&zc=1" alt="Android安全开发之ZIP文件目录遍历" class="xg-img"/>
		<p>Android安全开发之ZIP文件目录遍&hellip;</P></a></li>
				<li><a href="https://www.secpulse.com/archives/4535.html" title="详细阅读 爱加密重金聘请安卓安全工程师，入职就送5000红包">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=http://www.secpulse.com/wp-content/uploads/2015/02/ijiami2.png&h=150&w=249&zc=1" alt="爱加密重金聘请安卓安全工程师，入职就送5000红包" class="xg-img"/>
		<p>爱加密重金聘请安卓安全工程师，入职就送5&hellip;</P></a></li>
			</ul>


</section></article>


<!-- 引用 -->
<div id="comments" class="comments-area">
	<h2 class="comments-title">
		抢沙发
	</h2>
			<div id="respond" class="comment-respond row">
		


			<form action="https://www.secpulse.com/wp-comments-post.php" method="post" id="commentform">
		
				
						
			<div id="comboxinfo">
					<div class="cominfodiv cominfodiv-author ">
					<p for="author" class="nicheng">
     <input type="text" name="author" id="author" class="texty" value="" tabindex="1" /> <span class="required">昵称*</span>
      </p>
</div>
					<div class="cominfodiv cominfodiv-email">
					<p for="email">	<input type="text" name="email" id="email" class="texty" value="" tabindex="2" /> <span class="required">邮箱*</span>
						</p>
					</div>
					<div class="cominfodiv cominfodiv-url">
					 	<p for="url"><input type="text" name="url" id="url" class="texty" value="" tabindex="3" /><span>网址 </span>
						</p>
					</div>
					
			
				
</div>		       <div class=" cominfodiv-nr">  
<textarea class="texty" name="w" id="comment" rows="10" tabindex="4" placeholder="输入评论内容..."></textarea><textarea name="comment" cols="100%" rows="4" style="display:none"></textarea>
							<div class="submitcom">
							
					<input id="submit" name="submit" type="submit" tabindex="5" value="提&nbsp;交"/>
					<input type='hidden' name='comment_post_ID' value='5731' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="5f4bbe6586" /></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="39"/></p>				</div>
				<div id="cancel_comment_reply"><a rel="nofollow" id="cancel-comment-reply-link" href="/archives/5731.html#respond" style="display:none;">取消回复</a></div>
			
</div>
			
				
			</form>
			
			
			<script type="text/javascript">
				document.getElementById("comment").onkeydown = function (moz_ev){
				var ev = null;
				if (window.event){
				ev = window.event;
				}else{
				ev = moz_ev;
				}
				if (ev != null && ev.ctrlKey && ev.keyCode == 13){
				document.getElementById("submit").click();}
				}
			</script></div>
	 		
</div>
<!-- #comments --></div>
		
<div class="xs-right sidebar xs-hidden xss-hidden">
	<div class="authorbox">
	<div class="author-top">
<div id="author-img">
<img src="https://www.secpulse.com/wp-content/uploads/2014/12/b_4216_20111222020023739433835-150x150.jpg" width="96" height="96" alt="SP胖编" class="avatar avatar-96 wp-user-avatar wp-user-avatar-96 alignnone photo" />
</div>
<div class="au-name">
<a href="https://www.secpulse.com/archives/author/sp_panbian" title="由SP胖编发布" rel="author">SP胖编</a><br>
 <span class="au-title">总共60篇文章</span>
</div> </div>
	<div class="author-word"><span class="quotes q1"></span>
神器 神器 神器	<span class="quotes q2"></span></div>
	</div>
	
				<aside id="recent-posts-2" class="widget-container widget_recent_entries">		<div class="si-title"><h2>最新脉搏</h2></div>		<ul>
					<li>
				<a href="https://www.secpulse.com/archives/60653.html">《安天365安全研究》第5期</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60630.html">供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60605.html">2017先知创新大会：有ZHI而来</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60576.html">甲方工作杂谈</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60394.html">Catfish—缓存漏洞&#038;&#038;配合CSRF到Getshell</a>
						</li>
				</ul>
		</aside><aside id="hot_comment-3" class="widget-container widget_hot_comment"><div class="si-title"><h2>脉搏热评</h2></div>
	<ul class="hot_comment_widget">
		
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59497.html" rel="bookmark" title="XSS挑战之旅学习总结 (7条评论)" >XSS挑战之旅学习总结</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59065.html" rel="bookmark" title="web安全之如何全面发现系统后台 (6条评论)" >web安全之如何全面发现系统后台</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59770.html" rel="bookmark" title="电商的支付风控怎么玩？ (3条评论)" >电商的支付风控怎么玩？</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59466.html" rel="bookmark" title="安天移动安全联合猎豹揭秘无形之贼Dosoft免杀病毒 (2条评论)" >安天移动安全联合猎豹揭秘无形之贼Doso&hellip;</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59262.html" rel="bookmark" title="跟着DVWA学Web安全开发 (2条评论)" >跟着DVWA学Web安全开发</a></li>			</ul>

</aside><aside id="random_post-2" class="widget-container widget_random_post"><div class="si-title"><h2>随机脉搏</h2></div>

	<ul class="random_post">
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/16449.html" rel="bookmark" title="详细阅读 求教什么是大数据云端化之百合数据服务器4500w数据再次面临被脱裤">求教什么是大数据云端化之百合数据服务器4500w数据再次面临被脱裤</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/34993.html" rel="bookmark" title="详细阅读 p2p金融安全之爱钱进SQL注入漏洞(影响信息安全)">p2p金融安全之爱钱进SQL注入漏洞(影响信息安全)</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/2089.html" rel="bookmark" title="详细阅读 Zabbix的前台SQL注射漏洞利用">Zabbix的前台SQL注射漏洞利用</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/28166.html" rel="bookmark" title="详细阅读 博思CRM管理系统补丁不及时致机关部门服务信息泄露">博思CRM管理系统补丁不及时致机关部门服务信息泄露</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/49291.html" rel="bookmark" title="详细阅读 光大证券某平台存在漏洞（已Getshell/可泄漏大量的内部数据）">光大证券某平台存在漏洞（已Getshell/可泄漏大量的内部数据）</a></li>
					</ul>


</aside><aside id="text-11" class="widget-container widget_text"><div class="si-title"><h2>脉搏官方微信公众号</h2></div>			<div class="textwidget"><img src="https://www.secpulse.com/wp-includes/images/SecPulse.png" width="280px" height="364px" /></div>
		</aside>				</div>
	</div>

	</section>

  <div class="inner row visible-lg-block">

	<div class="friends">
		<h3>友情链接</h3>
		<ul>
			<li><a href="https://xianzhi.aliyun.com/forum/?secpulse" target="_blank">先知安全社区</a><span>|</span></li>
			<li><a href="https://threathunter.org/" target="_blank">ThreatHunter社区</a><span>|</span></li>
			<li><a href="http://www.ijiandao.com/" target="_blank">网络尖刀</a><span>|</span></li>
			<li><a href="http://navisec.it/" target="_blank">NaviSec导航</a><span>|</span></li>
		    <li><a href="https://www.easyaq.com/" target="_blank">E安全</a><span>|</span></li>
			<li><a href="http://www.sec-wiki.com/" target="_blank">Sec-Wiki</a><span>|</span></li>
			<li><a href="http://www.waitalone.cn/" target="_blank">独自等待</a><span>|</span></li>
			<li><a href="http://www.shellsec.com/" target="_blank">神刀网</a><span>|</span></li>
			<li><a href="http://www.ineice.com/" target="_blank">爱内测</a><span>|</span></li>
			<li><a href="http://www.itet.cn/" target="_blank">北京ITET培训中心</a><span>|</span></li>
			<li><a href="http://www.ihonker.org/" target="_blank">中国红客联盟</a><span>|</span></li>
			<li><a href="http://www.bigniu.com/" target="_blank">比戈大牛</a><span>|</span></li>
			<li><a href="http://www.tiejiang.org/" target="_blank">铁匠运维网</a><span>|</span></li>
			<li><a href="http://www.nagain.com" target="_blank">娜迦信息</a><span>|</span></li>
			<li><a href="https://www.secsilo.com/" target="_blank">SecSilo</a><span>|</span></li>
			<li><a href="https://team.armyzer0.com" target="_blank">armyzer0</a><span>|</span></li>
			<li><a href="http://www.nosafe.org" target="_blank">NoSafe</a></li>
		</ul>
	</div>

	<div class="friends">
		<h3>合作伙伴</h3>
		<ul>
			<a href="https://www.duoyinsu.com" class="external" target="_blank">
				<img src="https://www.secpulse.com/wp-content/uploads/anshi-logo.png"
				alt="安识科技" width="150px" height="45px">
			</a>
			<a href="http://aq.163.com/module/partner.html" class="external"
				target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/netease.jpg"
				alt="网易安全中心" width="150px" height="45px">
			</a>
			<a href="https://security.alibaba.com/" class="external"
				target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/asrc.jpg"
				alt="阿里安全中心" width="150px" height="45px">
			</a>
			
			<a href="http://yaq.qq.com/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/yaqnew.png" alt="腾讯御安全"
				width="140px" height="45px">
			</a>
			
			<a href="http://www.4hou.com" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/4hou.png"
				alt="嘶吼RoarTalk" width="150px" height="45px">
			</a>
			
			<a href="http://www.ichunqiu.com/?from=secpulse" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/ichunqiu.png" alt="i春秋学院"
				width="140px" height="45px">
			</a>

			<a href="#" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/bigsec.png" alt="bigsec岂安科技"
				width="140px" height="45px">
			</a>
		
			<a href="http://www.milw0rm.cn/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/milw0rm.png"
				alt="Milw0rm Team" width="120px" height="40px">
			</a>


			<a href="#" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/cloversec.png"
				alt="四叶草安全" width="130px" height="45px">
			</a>
			<a href="https://www.aqdog.com" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/aqdog.png"
				alt="安犬云平台" width="140px" height="45px">
			</a>
			
			<a href="http://www.e365.org/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/e365.png"
				alt="易安在线" width="130px" height="45px">
			</a>
			
			
			

		</ul>
	</div>
</div>
<footer class="footer clr" id="footer">
	<div class="inner inner-footer">
		<div class="footer-secpulse">
			<h3>SecPulse</h3>
			<ul>
				<li><a href="/about">关于SecPulse</a></li>
				<!--<li><a href="http://test.secpulse.com">SecPulse专测</a> <sup>NEW!</sup></li>-->
				<li><a href="/hire">加入我们</a></li>
				<li><a href="/report">寻求报道</a></li>
				<li><a href="/contact-us">联系我们</a></li>
			</ul>
		</div>
		<div class="footer-subscribe xs-hidden">
			<h3>订阅</h3>
			<ul>
				<li><a href="/feed">RSS订阅</a></li>
				<li><a href="/feed">邮箱订阅</a></li>
				<li><a href="/feed">线下活动订阅</a></li>
				<li></li>
				<li><a href="http://weibo.com/311057789">官方微博</a></li>
				<!-- <li><a href="https://twitter.com/secpulse">Twitter</a></li> -->
			</ul>
		</div>
		<div class="footer-partner">
			<h3>全力驱动</h3>
			<ul class="cf">
				<li><a href="https://www.secpulse.com" class="external"
					target="_blank"><img
						src="https://www.secpulse.com/wp-content/uploads/seclogo.png"
						alt="安全脉搏" width="200px"></a></li>
			</ul>
		</div>
		<div class="footer-copyright xs-hidden">
			<p>本站由SecPulse安全脉搏团队全力维护。</p>
			<p>
				Powered By <a title="安全脉搏" href="https://www.secpulse.com">SecPulse</a>
			</p>
			<p>©2013-2017 安全脉搏</p>
			<p>沪ICP备16016474号</p>
			<img src="https://www.secpulse.com/wp-includes/images/qrcode.jpg"
				alt="Qrcode" height="150px" width="150px">

		</div>
	</div>
</footer>
<div id="shangxia">
	<div id="shang" title="↑ 返回顶部"></div>
              <div id="comt" title="查看评论"></div>
              <div id="xia" title="↓ 移至底部"></div>
</div>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/plugins/akismet/_inc/form.js?ver=3.1.2'></script>
</body>

</html>
