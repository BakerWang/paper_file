<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
    <title>数字签名攻击报告：正在摧毁软件身份“信用体系”的安全危机 | MottoIN</title>
    <link rel='dns-prefetch' href='//www.mottoin.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="MottoIN &raquo; 数字签名攻击报告：正在摧毁软件身份“信用体系”的安全危机评论Feed" href="http://www.mottoin.com/105178.html/feed" />
<link rel='stylesheet' id='stylesheet-css'  href='http://www.mottoin.com/wp-content/themes/JustNews/css/style.css?ver=2.3.2' type='text/css' media='all' />
<link rel='stylesheet' id='wpcom-qa-css'  href='http://www.mottoin.com/wp-content/plugins/wpcom-qa/css/style.css?ver=1.0' type='text/css' media='all' />
<style id='wpcom-qa-inline-css' type='text/css'>

        .q-content .topic-tab,.q-content .q-answer .as-user,.q-content .q-answer .as-comment-name{color: #1471CA;}
        .q-content .q-topic-wrap a:hover,.q-content .q-answer .as-action a:hover,.q-content .topic-tab:hover{color:#0D62B3;}
        .q-content .put-top,.q-content .topic-tab.current-tab,.q-content .q-answer .as-submit .btn-submit,.q-content .q-answer .as-comments-submit,.q-content .q-add-header .btn-post,.q-content .q-pagination .current{background-color:#1471CA;}
        .q-content .q-answer .as-submit .btn-submit:hover,.q-content .q-answer .as-comments-submit:hover,.q-content .q-add-header .btn-post:hover,.q-content .topic-tab.current-tab:hover,.q-content .q-pagination a:hover{background-color:#0D62B3;}
        .q-content .q-answer .as-comments-input:focus{border-color: #1471CA;}
        
</style>
<link rel='stylesheet' id='um_minified-css'  href='http://www.mottoin.com/wp-content/plugins/ultimate-member/assets/css/um.min.css?ver=10.3.88' type='text/css' media='all' />
<script type='text/javascript' src='http://www.mottoin.com/wp-content/themes/JustNews/js/jquery.min.js?ver=1.12.4'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.mottoin.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.mottoin.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='信任与安全：国外安全公司研究员联合对抗WireX僵尸网络' href='http://www.mottoin.com/105173.html' />
<link rel='next' title='悄然崛起的挖矿机僵尸网络：打服务器挖价值百万门罗币' href='http://www.mottoin.com/105241.html' />
<link rel='shortlink' href='http://www.mottoin.com/?p=105178' />
<!--  WPCOM主题相关信息开始 -->
<meta name="applicable-device" content="pc,mobile">
<meta http-equiv="Cache-Control" content="no-transform">
<meta name="description" content="背景近期，360公司核心安全事业部发现全球范围内的利用软件数字签名的恶意攻击呈活跃趋势，黑客的攻击目标涉及软件开发商、个人用户和重要的政府、企事业单位；攻击形式多样，包括盗用、冒用软件开发商的合法数字签名和流行软件投毒的大规模定向攻击等。在这些攻击中，黑客的首要攻击目标是软件开发商，围绕软件的数字签名进行各种形式的攻击，如在企业发布的合法数字签名软件安装包中植入恶意代码，用户从正规渠道下载官方正规">
<!--  WPCOM主题相关信息结束 -->
 
		<script type="text/javascript">

		var ultimatemember_image_upload_url = 'http://www.mottoin.com/wp-content/plugins/ultimate-member/core/lib/upload/um-image-upload.php';
		var ultimatemember_file_upload_url = 'http://www.mottoin.com/wp-content/plugins/ultimate-member/core/lib/upload/um-file-upload.php';
		var ultimatemember_ajax_url = 'http://www.mottoin.com/wp-admin/admin-ajax.php';

		</script>

	
		<style type="text/css">.request_name { display: none !important; }</style>

	<link rel="icon" href="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-32x32.jpg" sizes="32x32" />
<link rel="icon" href="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-192x192.jpg" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-180x180.jpg" />
<meta name="msapplication-TileImage" content="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-270x270.jpg" />
    <style>
                a,.sec-panel-head span,.list.tabs .tab.active a,.header .nav>li.active>a,.header .dropdown-menu>.active>a,.entry .entry-info .nickname,.entry-bar-inner .author-title,.entry-action .btn-zan,.entry-action .btn-dashang,.comment-body .nickname,.form-submit-text span,.widget_profile .author-title,.um .um-profile-body .um-item-meta a,.login-modal-body .btn-register{color: #08c;}
        .header .dropdown-menu>li>a:hover,.header .dropdown-menu>.active>a:hover,.header .dropdown-menu>.active>a:focus,.navbar-action .publish,.pagination .current,.flex-control-paging li a.flex-active,.form-submit .submit,.sidebar .widget_nav_menu ul li.current-menu-item a,.sidebar .widget_nav_menu ul li.current-post-parent a,.search-form input.submit,.action .contact-title,.pf-submit,.tagHandler ul.tagHandlerContainer li.tagItem,.login-modal-body .btn-login,.woocommerce a.button,.woocommerce button.button,.woocommerce input.button,.woocommerce a.button.alt,.woocommerce button.button.alt,.woocommerce input.button.alt,.woocommerce a.button.alt.disabled,.woocommerce a.button.alt.disabled:hover,.woocommerce a.button.alt:disabled,.woocommerce a.button.alt:disabled:hover,.woocommerce a.button.alt:disabled[disabled],.woocommerce a.button.alt:disabled[disabled]:hover,.woocommerce button.button.alt.disabled,.woocommerce button.button.alt.disabled:hover,.woocommerce button.button.alt:disabled,.woocommerce button.button.alt:disabled:hover,.woocommerce button.button.alt:disabled[disabled],.woocommerce button.button.alt:disabled[disabled]:hover,.woocommerce input.button.alt.disabled,.woocommerce input.button.alt.disabled:hover,.woocommerce input.button.alt:disabled,.woocommerce input.button.alt:disabled:hover,.woocommerce input.button.alt:disabled[disabled],.woocommerce input.button.alt:disabled[disabled]:hover,.woocommerce .widget_price_filter .ui-slider .ui-slider-handle,.woocommerce .widget_price_filter .ui-slider .ui-slider-range,.shopping-count,.social-login-form .sl-input-submit{background-color: #08c;}
        .entry .entry-content h3,.entry .entry-content .h3,.widget-title{border-left-color: #08c;}
        .entry-bar-inner .author-title,.entry-action .btn-zan,.entry-action .btn-dashang,.search-form input.keyword:focus,.widget_profile .author-title,.login-modal-body .btn-login,.login-modal-body .btn-register{border-color: #08c;}
        .entry-bar-inner .author-title:before,.widget_profile .author-title:before{border-right-color: #08c;}
        .list.tabs .tab.active a{border-bottom-color: #08c;}

        a:hover,.header .nav>li>a:hover,.header .nav>li.active>a,.navbar-action .login:hover,.navbar-action .login:focus,.navbar-action .profile a:hover,.navbar-search-icon:hover,.navbar-search-icon:focus,.entry .entry-info a:hover,.entry .entry-info a:focus,.entry-bar .info-item a:hover,.p-item-wrap:hover .title a,.special-item-title a:hover,.special-item-bottom a:hover,.widget ul a:hover,.widget ol a:hover,.sec-panel-head .more:hover,.topic-list .topic-wrap:hover span,.tabs .tab a:hover,
        .article-list .item-title a:hover,.article-list .item-meta a:hover,.article-list .item-meta a:focus,.list-links a:hover,.list-links a:focus,.um .um-profile-body .um-item-meta a:hover,.um .um-profile-body .um-item-link a:hover,.load-more:hover,.login-modal-body .btn-register:hover{color: #07c;}
        .navbar-action .publish:hover,.navbar-action .publish:focus,.entry-tag a:hover,.entry-tag a:focus,.entry-action .btn-zan:hover,.entry-action .btn-dashang:hover,.entry-action .btn-zan.liked,.pagination a:hover,.flex-control-paging li a:hover,.form-submit .submit:hover,.widget .tagcloud a:hover,.sidebar .widget_nav_menu ul li.current-menu-item .sub-menu a:hover,.sidebar .widget_nav_menu ul li.current-post-parent .sub-menu a:hover,.sidebar .widget_nav_menu ul li a:hover,.search-form input.submit:hover,.action .a-box:hover,.footer-sns .fa:after,.article-list .item-category:hover,.pf-submit:hover,.tagHandler ul.tagHandlerContainer li.tagItem:hover,.login-modal-body .btn-login:hover,.woocommerce a.button:hover,.woocommerce button.button:hover,.woocommerce input.button:hover,.woocommerce a.button.alt:hover,.woocommerce button.button.alt:hover,.woocommerce input.button.alt:hover,.woocommerce .widget_price_filter .price_slider_wrapper .ui-widget-content,.social-login-form .sl-input-submit:hover{background-color: #07c;}
        .entry-tag a:hover,.entry-tag a:focus,.entry-action .btn-zan:hover,.entry-action .btn-dashang:hover,.entry-action .btn-zan.liked,.widget .tagcloud a:hover,.load-more:hover,.login-modal-body .btn-login:hover,.login-modal-body .btn-register:hover{border-color: #07c;}
        .special-item-bottom a:hover:before{border-left-color: #07c;}
        .list.tabs .tab.active a:hover{border-bottom-color: #07c;}
        @media (max-width: 991px){
            .header .navbar-nav>li.active>a,.header .navbar-nav .dropdown-menu .active a,.header .navbar-nav .dropdown-menu .active .dropdown-menu .active a{color: #08c;}
            .navbar-collapse{background-color: #08c;}
            .dropdown-menu>li a{border-color: #07c;}
            .header .navbar-nav>li.active>a:hover,.header .navbar-nav>li a:hover,.header .navbar-nav .dropdown-menu .active a:hover,.header .navbar-nav .dropdown-menu .active .dropdown-menu a:hover,.header .navbar-nav .dropdown-menu li a:hover{color: #07c;}
        }
        .j-share{position: fixed!important;top: 50%!important;}
                .header .logo img{max-height: 32px;}
                @media (max-width: 767px){
            .header .logo img{max-height: 26px;}
        }
                        .btn-post{
    display: block;
    margin: 0 auto;
    padding: 15px 20px;
    font-size: 16px;
    text-align: center;
    color: #fff !important;
    line-height: 1;
    background: #1471CA;
    -webkit-border-radius: 3px;
    border-radius: 3px;
    text-decoration: none;
    border: 0;
    outline: 0;
}    </style>
    <script> (function() {if (!/*@cc_on!@*/0) return;var e = "abbr, article, aside, audio, canvas, datalist, details, dialog, eventsource, figure, footer, header, hgroup, mark, menu, meter, nav, output, progress, section, time, video".split(', ');var i= e.length; while (i--){ document.createElement(e[i]) } })()</script>
    <!--[if lte IE 8]><script src="http://www.mottoin.com/wp-content/themes/JustNews/js/respond.min.js"></script><![endif]-->
</head>
<body class="post-template-default single single-post postid-105178 single-format-standard">
<header class="header">
    <div class="container clearfix">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar icon-bar-1"></span>
                <span class="icon-bar icon-bar-2"></span>
                <span class="icon-bar icon-bar-3"></span>
            </button>
            <a class="logo" href="http://www.mottoin.com"><img src="http://www.mottoin.com/img/mottoin/logo.png" alt="MottoIN"></a>
        </div>
        <div class="collapse navbar-collapse">
            <nav class="navbar-left primary-menu"><ul id="menu-%e5%af%bc%e8%88%aa" class="nav navbar-nav"><li class="menu-item menu-item-home"><a href="http://www.mottoin.com/">首页</a></li>
<li class="menu-item"><a href="http://www.mottoin.com/category/news">资讯</a></li>
<li class="menu-item current-post-ancestor dropdown"><a href="http://www.mottoin.com/category/article" class="dropdown-toggle">文章</a>
<ul role="menu" class=" dropdown-menu">
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/web">Web安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/system">系统安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/network">网络安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/terminal">终端安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/database">数据安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/wireless">无线安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/social">社会工程</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/intranet">内网渗透</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/code">代码审计</a></li>
	<li class="menu-item current-post-ancestor current-menu-parent current-post-parent"><a href="http://www.mottoin.com/category/article/reverse">逆向破解</a></li>
</ul>
</li>
<li class="menu-item"><a href="http://www.mottoin.com/category/tools">工具</a></li>
<li class="menu-item"><a href="http://www.mottoin.com/category/geek">极客</a></li>
<li class="menu-item dropdown"><a href="http://www.mottoin.com/category/sole" class="dropdown-toggle">独家</a>
<ul role="menu" class=" dropdown-menu">
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/topic">专题</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/people">人物</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/view">观点</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/events">活动</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/video">视频</a></li>
</ul>
</li>
<li class="menu-item"><a href="http://www.mottoin.com/category/hr">招聘</a></li>
<li class="menu-item"><a href="http://www.mottoin.com/forum">社区</a></li>
</ul></nav>            <div class="navbar-action pull-right">

                                    <form class="navbar-search" action="http://www.mottoin.com" method="get" role="search">
                        <input type="text" name="s" class="navbar-search-input" autocomplete="off" placeholder="输入关键词搜索..." value="">
                        <a class="navbar-search-icon j-navbar-search" href="javascript:;"></a>
                    </form>

                    
                    <div id="j-user-wrap">
                        <a class="login" href="http://www.mottoin.com/login">登录</a>
                        <a class="login" href="http://www.mottoin.com/register">注册</a>
                    </div>
                    <a class="publish" href="http://www.mottoin.com/post">
                        投稿</a>
                                                </div>
        </div><!-- /.navbar-collapse -->
    </div><!-- /.container -->
</header>
<div id="wrap">    <div class="main container">
        <div class="content">
                            <article id="post-105178" class="post-105178 post type-post status-publish format-standard has-post-thumbnail hentry category-tech category-reverse">
                    <div class="entry">
                        <div class="entry-head">
                            <h1 class="entry-title">数字签名攻击报告：正在摧毁软件身份“信用体系”的安全危机</h1>
                            <div class="entry-info">
                                                                <a class="nickname" href="http://www.mottoin.com/user/360/">360安全</a>
                                <span class="dot">•</span>
                                <span>2017年9月4日</span>
                                <span class="dot">•</span>
                                <a href="http://www.mottoin.com/category/tech" rel="category tag">技术控</a>, <a href="http://www.mottoin.com/category/article/reverse" rel="category tag">逆向破解</a>                                                                    <span class="dot">•</span>
                                    <span>阅读 394</span>
                                                            </div>
                        </div>
                                                                        <div class="entry-content clearfix">
                            <h3>背景</h3>
<p><a name="_Toc256000004"></a>近期，360公司核心安全事业部发现全球范围内的利用软件数字签名的恶意攻击呈活跃趋势，黑客的攻击目标涉及软件开发商、个人用户和重要的政府、企事业单位；攻击形式多样，包括盗用、冒用软件开发商的合法数字签名和流行软件投毒的大规模定向攻击等。在这些攻击中，黑客的首要攻击目标是软件开发商，围绕软件的数字签名进行各种形式的攻击，如在企业发布的合法数字签名软件安装包中植入恶意代码，用户从正规渠道下载官方正规软件主动中招；盗用和冒用企业数字签名批量制作“合法”的木马病毒，逃避杀毒软件的查杀等。利用软件数字签名的恶意攻击日趋严峻，这类攻击比常规的木马病毒更具威胁，广大用户极难分辨，也容易被检测机制不严格的安全软件放行，严重危害网络安全。</p>
<h3>软件签名安全简介</h3>
<p>“数字签名”是指可以添加到文件的电子安全标记。使用它可以验证文件的发布者以及帮助验证文件自被数字签名后是否发生更改。如果文件没有有效的数字签名，则无法确保该文件确实来自它所声称的源，或者无法确保它在发布后未被篡改。比如windows系统中内置的UAC（User Account Control用户账户控制）功能，就会在要求用户在执行可能会影响计算机运行的操作或执行更改影响其他用户的设置的操作之前，需要用户提供权限进行交互确认，在打开文件时的安全提示中显示程序的发布者供用户参考。</p>
<p>如没有软件数字签名的程序，UAC会显示发布者未知，交互提示框是黄色，提示用户该程序无法验证发布者，运行下去是有安全风险的。</p>
<p><img class="aligncenter size-full wp-image-105179 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/99TAPOVVE0R7JX5@R.png" alt="" width="460" height="265" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/99TAPOVVE0R7JX5@R.png 460w, http://www.mottoin.com/wp-content/uploads/2017/09/99TAPOVVE0R7JX5@R-300x173.png 300w" sizes="(max-width: 460px) 100vw, 460px" /></p>
<p>而包含正常数字签名的交互提示框是蓝色的，会标注已验证的的发布者，提示用户如果信任发布者可以放心运行下去。</p>
<p><img class="aligncenter size-full wp-image-105180 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/GDH24TB834YHP886E.png" alt="" width="466" height="233" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/GDH24TB834YHP886E.png 466w, http://www.mottoin.com/wp-content/uploads/2017/09/GDH24TB834YHP886E-300x150.png 300w" sizes="(max-width: 466px) 100vw, 466px" /></p>
<p>一个正规的已经打上数字签名的程序，可以在程序文件的属性中查看到，便于用户识别确认。</p>
<p><img class="aligncenter size-full wp-image-105181 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044939691.png" alt="" width="417" height="445" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044939691.png 417w, http://www.mottoin.com/wp-content/uploads/2017/09/15044939691-281x300.png 281w" sizes="(max-width: 417px) 100vw, 417px" /></p>
<h3>流行数字签名攻击形式分析</h3>
<p>由于数字签名安全的校验文件的身份和完整性，所以数字签名天生成为了各种正规软件的“身份证”，基于正规厂商和用户之间的信任关系，以及厂商和厂商间的信任关系，大部分安全厂商对有数字签名和正规身份的程序默认是信任的。而黑客则针对这一信任关系进行攻击，他们会攻击合法软件的发布流程，利用各种疏忽或漏洞在合法的签名软件包中植入恶意代码 ，甚至直接盗取和冒用合法软件开发商的数字签名，从而绕过安全产品的检查进行非法攻击，攻击破坏了厂商和用户之间的信任关系，也损坏了软件开发商的信誉，同时也对安全软件的查杀带来了一定的阻碍。目前这类攻击开始越演愈烈，主要分为以下三个形式。</p>
<h3>软件供应链攻击形式</h3>
<p>这类攻击的主要形式是在厂商的正规签名软件包中植入恶意代码，比如近日的NetSarang系列软件关键网络通信组件nssock2.dll被植入了恶意代码，厂商在发布软件时并未发现恶意代码，并给被感染组件打上了合法的数字签名随新版软件包一起发布，由于该软件被程序员和网络运维管理人员广泛使用，由此引发了该软件用户“主动”中招的大规模定向攻击事件。</p>
<p><img class="aligncenter size-full wp-image-105182 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044940391.png" alt="" width="343" height="246" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044940391.png 343w, http://www.mottoin.com/wp-content/uploads/2017/09/15044940391-300x215.png 300w" sizes="(max-width: 343px) 100vw, 343px" /></p>
<p>被植入恶意代码的nssock2.dll文件，拥有2017年7月13日的NetSarang公司数字签名，如图：</p>
<p><img class="aligncenter size-full wp-image-105183 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044940871.png" alt="" width="414" height="485" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044940871.png 414w, http://www.mottoin.com/wp-content/uploads/2017/09/15044940871-256x300.png 256w" sizes="(max-width: 414px) 100vw, 414px" /></p>
<h3>盗用签名攻击形式</h3>
<p>黑客会盗用厂商数字签名直接签发木马病毒，或者利用已签名程序的安全漏洞发起攻击。如近期出现的恶性病毒&#8221;Kuzzle&#8221;，该病毒采用多种技术手段躲避安全软件的查杀，直接盗用了某公司的数字签名用于签发病毒，同时还利用了某安全厂商的已签发数字签名驱动加载执行代码，该病毒会感染用户计算机的主引导记录（MBR）和卷引导记录（VBR），劫持浏览器首页牟利，同时接受病毒作者的远程指令进行其他破坏活动。</p>
<p>被恶意利用的正规签名驱动如图：</p>
<p><img class="aligncenter size-full wp-image-105184 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/1504494145.png" alt="" width="503" height="727" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/1504494145.png 503w, http://www.mottoin.com/wp-content/uploads/2017/09/1504494145-208x300.png 208w" sizes="(max-width: 503px) 100vw, 503px" /> <img class="aligncenter size-full wp-image-105185 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044941541.png" alt="" width="900" height="319" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044941541.png 900w, http://www.mottoin.com/wp-content/uploads/2017/09/15044941541-300x106.png 300w, http://www.mottoin.com/wp-content/uploads/2017/09/15044941541-768x272.png 768w" sizes="(max-width: 900px) 100vw, 900px" /></p>
<h3>冒用签名攻击形式</h3>
<p>黑客冒用知名公司的身份资料，在境外申请知名公司的数字签名签发恶意程序，这种攻击方式让软件厂商无辜躺枪。近期360集团核心安全白名单分析团队发现黑客通过伪造知名公司的资料，在境外证书颁发机构申请相应公司数字证书，用于大量签发恶意私服和木马程序，多家知名公司躺枪。被冒用签名所签发的恶意程序如图：</p>
<h3><img class="aligncenter size-full wp-image-105186 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044942101.png" alt="" width="1115" height="659" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044942101.png 1115w, http://www.mottoin.com/wp-content/uploads/2017/09/15044942101-300x177.png 300w, http://www.mottoin.com/wp-content/uploads/2017/09/15044942101-768x454.png 768w, http://www.mottoin.com/wp-content/uploads/2017/09/15044942101-1024x605.png 1024w" sizes="(max-width: 1115px) 100vw, 1115px" />数字签名攻击影响面分析</h3>
<p>黑客针对软件数字签名进行攻击，不仅成功对用户发动了攻击，还对厂商的信誉造成了损害。基于对软件厂商的信任，用户主动下载更新软件中招，攻击得到广泛传播；同时签发的有“身份证”的木马病毒，因为信任关系短时间内不易被安全软件查杀。</p>
<p>以下为抽样统计Xshell后门的用户活跃量，实际数据预计会比抽样数据扩大5倍，每天Xshell后门的主动使用受害者数以万计。</p>
<p><img class="aligncenter size-full wp-image-105187 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044944211.png" alt="" width="716" height="229" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044944211.png 716w, http://www.mottoin.com/wp-content/uploads/2017/09/15044944211-300x96.png 300w" sizes="(max-width: 716px) 100vw, 716px" /></p>
<p>同期，还有一些正规公司的签名被冒用来签发其他恶意程序，时间轴从今年初跨越至今，一些公司信誉严重受损。</p>
<p><img class="aligncenter size-full wp-image-105188 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044944711.png" alt="" width="1075" height="452" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044944711.png 1075w, http://www.mottoin.com/wp-content/uploads/2017/09/15044944711-300x126.png 300w, http://www.mottoin.com/wp-content/uploads/2017/09/15044944711-768x323.png 768w, http://www.mottoin.com/wp-content/uploads/2017/09/15044944711-1024x431.png 1024w" sizes="(max-width: 1075px) 100vw, 1075px" /></p>
<p>根据360大数据监测统计，今年新增冒用样本数量约400个，感染量约35万。下图所示是2017年8月份之前的受害者地域分布图，其中沿海一带以浙江、辽宁和广东传播最多，内陆则以四川和湖南居多 。</p>
<p><img class="aligncenter size-full wp-image-105189 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044945111.png" alt="" width="672" height="627" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044945111.png 672w, http://www.mottoin.com/wp-content/uploads/2017/09/15044945111-300x280.png 300w" sizes="(max-width: 672px) 100vw, 672px" /></p>
<h3>数字签名攻击典型案例技术分析</h3>
<h3>Xshellghost技术分析</h3>
<p>近日，NetSarang旗下的Xmanager、Xshell、Xftp和Xlpd等在全球流行使用的服务器远程管理软件曝出被多家杀毒软件报毒查杀的情况，经过360集团追日团队调查分析确认，NetSarang旗下多款软件的关键模块被植入了高级后门，这是一起入侵感染供应链软件的大规模攻击事件，我们将其命名为“XshellGhost”（xshell幽灵）。该程序是一个精密的定向攻击平台，所有的功能模块实现均为shellcode形式，客户端攻击通过感染供应链软件和各个shellcode模块，实现了无自启动项、无落地文件和多种通信协议的远程控制，后门潜伏于受害者电脑等待黑客在云控制平台下发shellcode数据执行，黑客在云端甚至可能通过上传的用户信息进行选择性的定向攻击。</p>
<h3>远程控制步骤分析</h3>
<p>XshellGhost的远程控制主要分为5个步骤：</p>
<ol>
<li>Xshell等软件启动加载被感染组件dll，解密shellcode1执行。</li>
<li>Shellcode1解密Shellcode2执行如下功能：</li>
<li>a) 创建注册表项，上报数据到每月对应的DGA域名当中；</li>
<li>b) 通过发往知名的域名解析器当中上传用户信息给攻击者；</li>
<li>c) 将接收的数据写入到创建的注册表项当中；</li>
<li>d) 通过获取的key1和key2解密Shellcode 3并执行；</li>
<li>Shellcode3会创建日志文件并写入信息,启动系统进程Svchost.exe，修改其oep处的代码，并注入shellcode形式的Root模块执行。</li>
<li>Root模块的初始化过程中，会加载并初始化Plugins、Config、Install、Online和DNS等功能模块，然后调用函数Install-&gt;InstallByCfg以获取配置信息，监控注册表并创建全局互斥体，调用Online-&gt; InitNet；</li>
</ol>
<p>5. 函数Online-&gt; InitNet会根据其配置初始化网络相关资源，向指定服务地址发送信息，并等待云端动态下发代码进行下一步攻击。</p>
<p><img class="aligncenter size-full wp-image-105190 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044946161.png" alt="" width="554" height="395" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044946161.png 554w, http://www.mottoin.com/wp-content/uploads/2017/09/15044946161-300x214.png 300w" sizes="(max-width: 554px) 100vw, 554px" /></p>
<h3>后门功能模块分析</h3>
<p>此次攻击的所有模块调度加载实现方式都是通过shellcode形式，采用了模块化的方法进行统一管理。后门主要分为基础管理模块 （ROOT）、插件功能模块（Plugins）、C&amp;C配置模块（Config）、代码安装模块（Install）和网络通信模块（Online）这5个模块。</p>
<p><img class="aligncenter size-full wp-image-105191 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044946841.png" alt="" width="773" height="186" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044946841.png 773w, http://www.mottoin.com/wp-content/uploads/2017/09/15044946841-300x72.png 300w, http://www.mottoin.com/wp-content/uploads/2017/09/15044946841-768x185.png 768w" sizes="(max-width: 773px) 100vw, 773px" /></p>
<h3>网络通信模块分析</h3>
<p>网络通信管理模块（Online）是本次攻击的关键模块，在本次攻击事件当中我们已经发现了DNS模块，其它几个网络模块（TCP、HTTP、UDP、HTTPS、SSL）虽然在代码当中有所体现，但是在shellcode当中尚未主动运行，各个网络模块的函数接口及其作用如下表所示：</p>
<p><img class="aligncenter size-full wp-image-105192 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044947331.png" alt="" width="827" height="264" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044947331.png 827w, http://www.mottoin.com/wp-content/uploads/2017/09/15044947331-300x96.png 300w, http://www.mottoin.com/wp-content/uploads/2017/09/15044947331-768x245.png 768w" sizes="(max-width: 827px) 100vw, 827px" /></p>
<p>各个网络模块的功能的展开和运行依赖于Online模块提供的函数接口列表：</p>
<p><img class="aligncenter size-full wp-image-105193 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044948011.png" alt="" width="727" height="681" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044948011.png 727w, http://www.mottoin.com/wp-content/uploads/2017/09/15044948011-300x281.png 300w" sizes="(max-width: 727px) 100vw, 727px" /></p>
<p>InitNet在读取网络代理配置以后每隔1秒调用功能A，如果功能A返回20000，则函数彻底结束，功能A逻辑：</p>
<p><img class="aligncenter size-full wp-image-105194 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/1504494910.png" alt="" width="251" height="384" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/1504494910.png 251w, http://www.mottoin.com/wp-content/uploads/2017/09/1504494910-196x300.png 196w" sizes="(max-width: 251px) 100vw, 251px" /></p>
<p>功能B逻辑，用于等待云端下发代码执行：</p>
<p><img class="aligncenter size-full wp-image-105195 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044949471.png" alt="" width="534" height="822" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044949471.png 534w, http://www.mottoin.com/wp-content/uploads/2017/09/15044949471-195x300.png 195w" sizes="(max-width: 534px) 100vw, 534px" /></p>
<p>此次攻击已知使用的通信模块是DNS模块，该后门基于DNS隧道技术进行通信：</p>
<p><img class="aligncenter size-full wp-image-105196 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044950111.png" alt="" width="571" height="221" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044950111.png 571w, http://www.mottoin.com/wp-content/uploads/2017/09/15044950111-300x116.png 300w" sizes="(max-width: 571px) 100vw, 571px" /></p>
<p>该模块发送的数据包有3种类型：</p>
<p>1.初始化数据包，大小为0x18</p>
<p><img class="aligncenter size-full wp-image-105197 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044950921.png" alt="" width="124" height="225" /></p>
<p>2.Data数据包，大小0x8+</p>
<p><img class="aligncenter size-full wp-image-105198 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044951331.png" alt="" width="124" height="225" /></p>
<p>3.关闭数据包， 大小0x8</p>
<p><img class="aligncenter size-full wp-image-105199 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044951741.png" alt="" width="119" height="173" /></p>
<p>其发送函数如下：</p>
<p><img class="aligncenter size-full wp-image-105201 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044952551.png" alt="" width="804" height="209" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044952551.png 804w, http://www.mottoin.com/wp-content/uploads/2017/09/15044952551-300x78.png 300w, http://www.mottoin.com/wp-content/uploads/2017/09/15044952551-768x200.png 768w" sizes="(max-width: 804px) 100vw, 804px" /></p>
<p><img class="aligncenter size-full wp-image-105200 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044952031.png" alt="" width="650" height="454" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044952031.png 650w, http://www.mottoin.com/wp-content/uploads/2017/09/15044952031-300x210.png 300w" sizes="(max-width: 650px) 100vw, 650px" /></p>
<p><img class="aligncenter size-full wp-image-105202 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044952391.png" alt="" width="568" height="225" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044952391.png 568w, http://www.mottoin.com/wp-content/uploads/2017/09/15044952391-300x119.png 300w" sizes="(max-width: 568px) 100vw, 568px" /></p>
<p>在调用DNS模块2号函数返回自定义对象时，其调用了GetAdaptersAddresses获取适配器的DNS</p>
<p><img class="aligncenter size-full wp-image-105203 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044953211.png" alt="" width="1005" height="503" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044953211.png 1005w, http://www.mottoin.com/wp-content/uploads/2017/09/15044953211-300x150.png 300w, http://www.mottoin.com/wp-content/uploads/2017/09/15044953211-768x384.png 768w" sizes="(max-width: 1005px) 100vw, 1005px" /></p>
<p>最多收集0x10个DNS，随后在调用该模块第3号函数时，其使用收集到的DNS，合并Config文件中的4个DNS地址，循环往每一个DNS发送查询，等到到任何一个返回数据，或者超时，并记录下第一个返回应答的DNS数据包，以后再次发送的时候，只会给第一个返回应答的DNS发送数据。</p>
<p><img class="aligncenter size-full wp-image-105204 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044953601.png" alt="" width="664" height="726" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044953601.png 664w, http://www.mottoin.com/wp-content/uploads/2017/09/15044953601-274x300.png 274w" sizes="(max-width: 664px) 100vw, 664px" /></p>
<p><img class="aligncenter size-full wp-image-105205 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044954791.png" alt="" width="662" height="489" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044954791.png 662w, http://www.mottoin.com/wp-content/uploads/2017/09/15044954791-300x222.png 300w" sizes="(max-width: 662px) 100vw, 662px" /></p>
<p>在发送数据包时，会将数据嵌套到DNS协议中发送，其中数据会编码成特定的字符串，添加在要配置文件中的CC DNS URL前，实现DNS隧道通讯。</p>
<p><img class="aligncenter size-full wp-image-105206 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044955271.png" alt="" width="669" height="329" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044955271.png 669w, http://www.mottoin.com/wp-content/uploads/2017/09/15044955271-300x148.png 300w" sizes="(max-width: 669px) 100vw, 669px" /></p>
<h3>盗用签名攻击和白利用攻击的典型案例</h3>
<p>刷机精灵官方主程序被利用，伪装成“照片.exe”，通过QQ传播，会加载一个伪造的ShuameManager.dll。</p>
<p><img class="aligncenter size-full wp-image-105207 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044955741.png" alt="" width="423" height="485" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044955741.png 423w, http://www.mottoin.com/wp-content/uploads/2017/09/15044955741-262x300.png 262w" sizes="(max-width: 423px) 100vw, 423px" /></p>
<p>伪造的ShuameManager.dll盗用“北京财联融讯信息技术有限公司”数字签名：</p>
<p><img class="aligncenter size-full wp-image-105208 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044956281.png" alt="" width="457" height="531" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044956281.png 457w, http://www.mottoin.com/wp-content/uploads/2017/09/15044956281-258x300.png 258w" sizes="(max-width: 457px) 100vw, 457px" /></p>
<p>伪造的ShuameManager.dll和刷机精灵官方的ShuameManager.dll有相同的导出函数“StartShume”供主程序调用，恶意ShuameManager.dll的导出函数内部代码是循环休眠：</p>
<p><img class="aligncenter size-full wp-image-105209 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044957511.png" alt="" width="351" height="347" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044957511.png 351w, http://www.mottoin.com/wp-content/uploads/2017/09/15044957511-300x297.png 300w" sizes="(max-width: 351px) 100vw, 351px" /></p>
<p>真正的恶意代码其实在ShuameManager.dll刚载入时就已经启动，并且采用拼接字符串的方式来隐藏敏感API调用，直接创建一个工作线程：</p>
<p><img class="aligncenter size-full wp-image-105210 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044958111.png" alt="" width="862" height="599" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044958111.png 862w, http://www.mottoin.com/wp-content/uploads/2017/09/15044958111-300x208.png 300w, http://www.mottoin.com/wp-content/uploads/2017/09/15044958111-768x534.png 768w" sizes="(max-width: 862px) 100vw, 862px" /></p>
<p>工作线程的任务是解密一个加密的文件“coonfig.dat”，内存解密出一个dll文件，然后进行加载：</p>
<p><img class="aligncenter size-full wp-image-105211 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044958481.png" alt="" width="690" height="626" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044958481.png 690w, http://www.mottoin.com/wp-content/uploads/2017/09/15044958481-300x272.png 300w" sizes="(max-width: 690px) 100vw, 690px" /></p>
<p>解密的算法是简单的加法和异或运算，初始key是9：</p>
<p><img class="aligncenter size-full wp-image-105212 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044958811.png" alt="" width="971" height="356" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044958811.png 971w, http://www.mottoin.com/wp-content/uploads/2017/09/15044958811-300x110.png 300w, http://www.mottoin.com/wp-content/uploads/2017/09/15044958811-768x282.png 768w" sizes="(max-width: 971px) 100vw, 971px" /></p>
<p>经过循环9次解密后，coonfig.dat文件在内存里解密出一个dll，工作线程接着准备加载调用其导出函数“InitMyEntry”：</p>
<p><img class="aligncenter size-full wp-image-105213 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044959321.png" alt="" width="696" height="455" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044959321.png 696w, http://www.mottoin.com/wp-content/uploads/2017/09/15044959321-300x196.png 300w" sizes="(max-width: 696px) 100vw, 696px" /></p>
<p>首先判断解密出来的文件格式是否满足条件，符合PE格式则进行解析分配对应大小的内存进行装载：</p>
<p><img class="aligncenter size-full wp-image-105214 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044959711.png" alt="" width="687" height="418" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044959711.png 687w, http://www.mottoin.com/wp-content/uploads/2017/09/15044959711-300x183.png 300w" sizes="(max-width: 687px) 100vw, 687px" /></p>
<p>接着就是根据PE格式的映射原理进行解析和装载，然后调用dll的入口点函数进行初始化：</p>
<p><img class="aligncenter size-full wp-image-105215 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044960161.png" alt="" width="688" height="441" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044960161.png 688w, http://www.mottoin.com/wp-content/uploads/2017/09/15044960161-300x192.png 300w" sizes="(max-width: 688px) 100vw, 688px" /></p>
<p>解密后的dll装载初始化完后，接着查找其导出函数“InitMyEntry”地址最后直接跳转执行：</p>
<p><img class="aligncenter size-full wp-image-105216 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044960501.png" alt="" width="426" height="281" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044960501.png 426w, http://www.mottoin.com/wp-content/uploads/2017/09/15044960501-300x198.png 300w" sizes="(max-width: 426px) 100vw, 426px" /></p>
<p>分析到这里，可以看出ShuameManager.dll其实就是一个加密程序内存装载器，采用了一系列对抗手法来规避查杀，具体执行的恶意活动取决于coonfig.dat解密出来的程序。ShuameManager.dll配套的coonfig.dat，其中一个功能是调用一款第三方工具NirCmd.exe来进行添加开机启动项，命令参数为：</p>
<blockquote><p>regsetval sz &#8220;HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run&#8221; &#8220;Live&#8221; &#8220;C:\Elantech\TXPTOP\update_psy\Elantech.exe&#8221;</p></blockquote>
<p>而启动的目标程序Elantech.exe只是伪装“触控板”的文件名，实际上是一个和上述被利用的“刷机精灵”类似的程序，Elantech.exe主要有两类，其中一类是yy游戏官方的程序：</p>
<p><img class="aligncenter size-full wp-image-105217 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044961051.png" alt="" width="454" height="531" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044961051.png 454w, http://www.mottoin.com/wp-content/uploads/2017/09/15044961051-256x300.png 256w" sizes="(max-width: 454px) 100vw, 454px" /></p>
<p>yy的程序被利用来加载的恶意dll是“VideoSdk.dll”，“VideoSdk.dll”和伪造的ShuameManager.dll采用相同的解密key和loader框架，并且同样带有盗用的“北京财联融讯信息技术有限公司”数字签名，最终都是加载coonfig.dat导出的InitMyEntry函数来进行恶意活动。另一类Elantech.exe程序是一款韩国杀毒软件“安博士”的升级程序，该程序被利用来加载名为“AhnUpCtl.dll”的dll，功能和手法都和上述类似，这里就不再赘述。</p>
<h3>2017年签名冒用攻击大追踪</h3>
<h3>冒用方式</h3>
<p>签名冒用的利用方式360已经分析披露过多次，这里简单再说明一下。下图是官方正常数字签名与冒用数字签名的样本对比，两者都显示数字签名正常且签名主体均为“上海**软件有限公司”。左图是该公司官方的程序签名，而右图则是冒用的数字签名，其是冒用签名的作者伪造该公司资料在国外签发机构“Go Daddy”申请的数字证书。</p>
<p><img class="aligncenter size-full wp-image-105218 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044961791.png" alt="" width="984" height="657" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044961791.png 984w, http://www.mottoin.com/wp-content/uploads/2017/09/15044961791-300x200.png 300w, http://www.mottoin.com/wp-content/uploads/2017/09/15044961791-768x513.png 768w" sizes="(max-width: 984px) 100vw, 984px" /></p>
<p>目前为止，发现的冒用签名主要都是通过“Go Daddy”和“Startfield”两家国外签发机构申请的，今年新增的8种冒用签名如下所示，其中每种签名对应若干张数字证书，且部分证书目前已被颁发者直接吊销：</p>
<p><img class="aligncenter size-full wp-image-105219 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044962161.png" alt="" width="1187" height="789" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044962161.png 1187w, http://www.mottoin.com/wp-content/uploads/2017/09/15044962161-300x199.png 300w, http://www.mottoin.com/wp-content/uploads/2017/09/15044962161-768x510.png 768w, http://www.mottoin.com/wp-content/uploads/2017/09/15044962161-1024x681.png 1024w" sizes="(max-width: 1187px) 100vw, 1187px" /></p>
<h3>样本分析</h3>
<p>下面主要分析带冒用签名的劫持类私服程序，由于其他恶意程序传播受限这里暂不分析。</p>
<h3>（一）流程框架</h3>
<p>360截获的带冒用签名的劫持类私服程序种类较多且更新频繁，其劫持组件也是经常变化，不过总体的功能框架相对不变。样本的整个运行过程如下所示，部分程序模块在玩家电脑上采用随机文件名，图中的备注名（如[msvcs.dll]）是其对应在私服服务器上的模块名称。</p>
<p><img class="aligncenter size-full wp-image-105220 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044962681.png" alt="" width="843" height="636" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044962681.png 843w, http://www.mottoin.com/wp-content/uploads/2017/09/15044962681-300x226.png 300w, http://www.mottoin.com/wp-content/uploads/2017/09/15044962681-768x579.png 768w" sizes="(max-width: 843px) 100vw, 843px" /></p>
<p>从前文的流程图看，本模块主要进行两条劫持流程，首先进行的是流程图的上半部分，母体是dnetsup.dll，最终通过安装文件过滤驱动进行劫持，紧接着进行流程图的下半部分，母体是drvsup.dll，最终通过安装tdi过滤驱动进行劫持。</p>
<h3>（二）文件过滤流程劫持DNS</h3>
<p>首先是文件过滤流程，过程基于dotnet（.Net）的运行环境，所以dnetsup.dll先判断并安装dotnet环境，然后通过注册通用类库的方式来得到程序运行机会。一旦注册成功，之后每次用户启动浏览器，浏览器进程都会被“注入”该劫持模块（donetset2/4），从而执行其中的程序代码，通过我们的行为监控工具查看，可以看到IE浏览器的进程树下多出了两个子进程，这两个子进程其实是注入其中的劫持模块donetset2.dll创建的（见下文）：</p>
<p><img class="aligncenter size-full wp-image-105221 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044963271.png" alt="" width="830" height="202" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044963271.png 830w, http://www.mottoin.com/wp-content/uploads/2017/09/15044963271-300x73.png 300w, http://www.mottoin.com/wp-content/uploads/2017/09/15044963271-768x187.png 768w" sizes="(max-width: 830px) 100vw, 830px" /></p>
<p>当该组件的工作例程开始运行时，就进行文件过滤驱动的安装或启动，并下载一份hosts列表保存到dida.mid这个文件来进行本地DNS劫持，上文看到浏览器的进程树即是下载完劫持列表文件后调用cmd的ipconfig命令进行DNS缓存刷新：</p>
<p><img class="aligncenter size-full wp-image-105222 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044963711.png" alt="" width="758" height="543" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044963711.png 758w, http://www.mottoin.com/wp-content/uploads/2017/09/15044963711-300x215.png 300w" sizes="(max-width: 758px) 100vw, 758px" /></p>
<p>下载的列表格式与系统hosts文件一致，主要用于劫持安全软件和竞争对手的DNS请求：</p>
<p><img class="aligncenter size-full wp-image-105223 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/1504496424.png" alt="" width="489" height="425" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/1504496424.png 489w, http://www.mottoin.com/wp-content/uploads/2017/09/1504496424-300x261.png 300w" sizes="(max-width: 489px) 100vw, 489px" /></p>
<p>本模块安装的驱动程序是从资源里释放的，dHelperKit.dll负责和文件过滤驱动的通信操作。驱动程序出自EldoS公司的一款名为“CallbackFiler”的产品，该产品实际上是专门为开发人员提供文件系统过滤功能的程序库：</p>
<p><img class="aligncenter size-full wp-image-105224 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044964541.png" alt="" width="423" height="484" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044964541.png 423w, http://www.mottoin.com/wp-content/uploads/2017/09/15044964541-262x300.png 262w" sizes="(max-width: 423px) 100vw, 423px" /></p>
<p>dHelperKit.dll负责控制驱动库完成劫持的功能。该模块的导出函数“kitStartCbfltfs”通过“CallbackFiler”提供的API来操作文件过滤驱动cbfltfs3.sys，借助其对文件系统的的过滤功能来劫持DNS。具体实现的方式是添加一个文件名（路径）重解析的回调函数，设置请求的目标文件名（路径）为本地hosts文件的路径，在系统进程访问到该文件路径时重定向到一个新的控制路径（dida.mid文件的路径）：</p>
<p><img class="aligncenter size-full wp-image-105225 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044965781.png" alt="" width="883" height="438" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044965781.png 883w, http://www.mottoin.com/wp-content/uploads/2017/09/15044965781-300x149.png 300w, http://www.mottoin.com/wp-content/uploads/2017/09/15044965781-768x381.png 768w" sizes="(max-width: 883px) 100vw, 883px" /></p>
<p>待重新下载dida.mid列表文件后调用命令刷新DNS缓存，此时负责网络服务的进程svchost会将新的hosts列表刷入本地DNS缓存，安全软件或竞争私服等程序在联网时默认先查询DNS缓存，发现缓存列表里存在相关记录项就会导致该域名解析被重定向，从而实现屏蔽或劫持网络的作用。此时检查系统的hosts文件将看不到任何异常，然而通过ping命令便能验证出DNS已被劫持：</p>
<p><img class="aligncenter size-full wp-image-105226 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044966591.png" alt="" width="671" height="520" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044966591.png 671w, http://www.mottoin.com/wp-content/uploads/2017/09/15044966591-300x232.png 300w" sizes="(max-width: 671px) 100vw, 671px" /></p>
<p>由于目标域名劫持后重定向到一个本机回环地址（127.0.0.1），所以屏蔽了对劫持域名（ip***360safe.com）的网络请求，此目的为干扰安全软件的正常联网。当然要进行劫持的域名都是由云端分配控制的，劫持列表可以随时更换，例如下面是一组被劫持的知名游戏网站，均被劫持到某一固定的ip地址（139.***.246.167）：</p>
<p><img class="aligncenter size-full wp-image-105227 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044967151.png" alt="" width="671" height="600" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044967151.png 671w, http://www.mottoin.com/wp-content/uploads/2017/09/15044967151-300x268.png 300w" sizes="(max-width: 671px) 100vw, 671px" /></p>
<h3>（三）TDI过滤流程劫持网络流量</h3>
<p>接下来分析tdi过滤流程，最终实现通过驱动劫持用户的网络流量。母体drvsup.dll通过IsWow64Process判断系统环境，选择下载x64或者x86版本的tdi驱动到本地保存为mstd32.sys：</p>
<p><img class="aligncenter size-full wp-image-105228 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044967481.png" alt="" width="728" height="483" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044967481.png 728w, http://www.mottoin.com/wp-content/uploads/2017/09/15044967481-300x199.png 300w" sizes="(max-width: 728px) 100vw, 728px" /></p>
<p>下载后按照正常启动服务的方式直接启动该驱动程序：</p>
<p><img class="aligncenter size-full wp-image-105229 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044967981.png" alt="" width="865" height="485" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044967981.png 865w, http://www.mottoin.com/wp-content/uploads/2017/09/15044967981-300x168.png 300w, http://www.mottoin.com/wp-content/uploads/2017/09/15044967981-768x431.png 768w" sizes="(max-width: 865px) 100vw, 865px" /></p>
<p>一旦驱动加载起来，后面的流程全靠该驱动独立完成，无需与应用层程序进行其他交互。驱动每次启动时重新下载一份劫持列表tdipaddr.dll到内存，并将其解析到链表中方便后面进行劫持过滤：</p>
<p><img class="aligncenter size-full wp-image-105230 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044968291.png" alt="" width="517" height="237" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044968291.png 517w, http://www.mottoin.com/wp-content/uploads/2017/09/15044968291-300x138.png 300w" sizes="(max-width: 517px) 100vw, 517px" /></p>
<p>下载的列表经常发生变化，并且同时存在多种不同的传播版本，对不同类型的知名网址进行劫持，如下是截获的其中一个版本，其中包含大量知名的游戏公司官网，均被劫持到某搜索引擎的一个服务器ip（14.***38）：</p>
<p><img class="aligncenter size-full wp-image-105231 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044968931.png" alt="" width="463" height="387" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044968931.png 463w, http://www.mottoin.com/wp-content/uploads/2017/09/15044968931-300x251.png 300w" sizes="(max-width: 463px) 100vw, 463px" /></p>
<p>后面过滤IO请求时，将以该列表去匹配当前网络访问的host：</p>
<p><img class="aligncenter size-full wp-image-105233 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044969301-1.png" alt="" width="643" height="400" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044969301-1.png 643w, http://www.mottoin.com/wp-content/uploads/2017/09/15044969301-1-300x187.png 300w" sizes="(max-width: 643px) 100vw, 643px" /></p>
<p>满足过滤规则的所有网络IO请求会被标记，待相应的请求响应后对接收到的数据进行修改，添加301重定向响应头或者嵌入html框架来实现劫持，最后将修改后的内容返回给请求联网的应用层程序（如浏览器）处理：</p>
<p><img class="aligncenter size-full wp-image-105234 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044971581.png" alt="" width="905" height="542" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044971581.png 905w, http://www.mottoin.com/wp-content/uploads/2017/09/15044971581-300x180.png 300w, http://www.mottoin.com/wp-content/uploads/2017/09/15044971581-768x460.png 768w" sizes="(max-width: 905px) 100vw, 905px" /></p>
<p>例如我们通过浏览器正常访问盛大游戏官网时如下：</p>
<p><img class="aligncenter size-full wp-image-105235 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044971961.png" alt="" width="1147" height="659" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044971961.png 1147w, http://www.mottoin.com/wp-content/uploads/2017/09/15044971961-300x172.png 300w, http://www.mottoin.com/wp-content/uploads/2017/09/15044971961-768x441.png 768w, http://www.mottoin.com/wp-content/uploads/2017/09/15044971961-1024x588.png 1024w" sizes="(max-width: 1147px) 100vw, 1147px" /></p>
<p>而驱动劫持后访问盛大游戏官网则会发生跳转，将其劫持到某搜索引擎（或其他地址，根据云端列表来控制），阻碍用户正常访问游戏网站。从360浏览器的抓包工具可以看出劫持方式是嵌入一个指向搜索引擎地址的html框架：</p>
<p><img class="aligncenter size-full wp-image-105236 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044972451.png" alt="" width="1146" height="660" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044972451.png 1146w, http://www.mottoin.com/wp-content/uploads/2017/09/15044972451-300x173.png 300w, http://www.mottoin.com/wp-content/uploads/2017/09/15044972451-768x442.png 768w, http://www.mottoin.com/wp-content/uploads/2017/09/15044972451-1024x590.png 1024w" sizes="(max-width: 1146px) 100vw, 1146px" /></p>
<p>对劫持过程进行双机调试，也能观察到访问盛大游戏官网时驱动程序劫持的过滤过程：</p>
<p><img class="aligncenter size-full wp-image-105237 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044973071.png" alt="" width="1003" height="810" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044973071.png 1003w, http://www.mottoin.com/wp-content/uploads/2017/09/15044973071-300x242.png 300w, http://www.mottoin.com/wp-content/uploads/2017/09/15044973071-768x620.png 768w" sizes="(max-width: 1003px) 100vw, 1003px" /></p>
<p>最后发现驱动程序还注册了一个关机回调，在系统关机时改变驱动文件名，重写驱动文件来增加自身的隐蔽性。驱动的路径如下图所示，可以看到文件名为8位随机字母：</p>
<p><img class="aligncenter size-full wp-image-105238 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044973361.png" alt="" width="545" height="352" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044973361.png 545w, http://www.mottoin.com/wp-content/uploads/2017/09/15044973361-300x194.png 300w" sizes="(max-width: 545px) 100vw, 545px" /></p>
<p>重写驱动文件后将新的驱动路径注册成一个开机自启动的服务，以保证在用户电脑上的劫持活动得以延续。</p>
<p><img class="aligncenter size-full wp-image-105239 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044973781.png" alt="" width="869" height="463" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044973781.png 869w, http://www.mottoin.com/wp-content/uploads/2017/09/15044973781-300x160.png 300w, http://www.mottoin.com/wp-content/uploads/2017/09/15044973781-768x409.png 768w" sizes="(max-width: 869px) 100vw, 869px" /></p>
<h3>总结和安全建议</h3>
<p>2017年初始至今，黑客从盗用正规公司的数字签名制造有“身份证”的木马病毒，以及有组织有预谋地入侵厂商污染软件发布流程，最后甚至使用社会工程学伪装厂商身份冒用数字签名，针对软件数字签名的攻击，无所不用其极，拥有良好信誉的软件厂商和众多软件用户已经成为黑客的主要攻击目标。</p>
<p>软件开发商的数字签名属于软件自身的“身份证”，软件身份被恶意利用，会对公司的商业信誉带来恶劣影响，同时也破坏了该厂商的在软件安全体系的可信身份，使安全厂商和用户都不再信任其软件身份，软件厂商将损失大量的用户。因此，软件厂商有义务保护好自己的数字签名，如果发现数字签名被攻击应及时公告用户处置，并采取有效措施减少用户的损失。</p>
<p>此外，网民也应该认识到，数字签名只是识别软件身份的一种方式，软件拥有数字签名并不能代表绝对安全，针对有“身份”的软件仍然需要提高警惕，使用检测机制严格、可靠的安全软件防御恶意攻击。</p>
                                                        <div class="entry-copyright"><p>原创文章，作者：360安全，如若转载，请注明出处：http://www.mottoin.com/105178.html</p></div>                        </div>
                        <div class="entry-footer">
                            <div class="entry-tag"></div>
                            <div class="entry-action">
                                <div class="btn-zan" data-id="105178"><i class="fa fa-thumbs-up"></i> 赞 <span class="entry-action-num">(1)</span></div>

                                
                            </div>
                            <div class="entry-bar">
                                <div class="entry-bar-inner clearfix">
                                                                            <div class="author pull-left">
                                            <a data-user="529" target="_blank" href="http://www.mottoin.com/user/360/" class="avatar">
                                                <img src="http://www.mottoin.com/wp-content/uploads/ultimatemember/529/profile_photo-80.png?1505839125" class="func-um_user gravatar avatar avatar-60 um-avatar um-avatar-uploaded" width="60" height="60" alt="360安全" />                                                360安全                                            </a>
                                            <span class="author-title">企业用户</span>                                         </div>
                                                                        <div class="info pull-right">
                                        <div class="info-item meta">
                                            <a class="meta-item j-heart" href="javascript:;" data-id="105178"><i class="fa fa-heart"></i> <span class="data">0</span></a>
                                            <a class="meta-item" href="#comments"><i class="fa fa-comment"></i> <span class="data">0</span></a>
                                                                                    </div>
                                        <div class="info-item share">
                                            <a class="meta-item" href="javascript:;">
                                                <i class="fa fa-wechat"></i>
                                                <span class="wx-wrap">
                                                    <img src="//pan.baidu.com/share/qrcode?w=320&h=320&url=http://www.mottoin.com/105178.html">
                                                    <span>扫码分享到微信</span>
                                                </span>
                                            </a>
                                            <a class="meta-item" href="http://share.baidu.com/s?type=text&searchPic=1&sign=on&to=tsina&key=&url=http%3A%2F%2Fwww.mottoin.com%2F105178.html&title=%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D%E6%94%BB%E5%87%BB%E6%8A%A5%E5%91%8A%EF%BC%9A%E6%AD%A3%E5%9C%A8%E6%91%A7%E6%AF%81%E8%BD%AF%E4%BB%B6%E8%BA%AB%E4%BB%BD%E2%80%9C%E4%BF%A1%E7%94%A8%E4%BD%93%E7%B3%BB%E2%80%9D%E7%9A%84%E5%AE%89%E5%85%A8%E5%8D%B1%E6%9C%BA" target="_blank"><i class="fa fa-weibo"></i></a>
                                            <a class="meta-item" href="http://share.baidu.com/s?type=text&searchPic=1&sign=on&to=qzone&key=&url=http%3A%2F%2Fwww.mottoin.com%2F105178.html&title=%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D%E6%94%BB%E5%87%BB%E6%8A%A5%E5%91%8A%EF%BC%9A%E6%AD%A3%E5%9C%A8%E6%91%A7%E6%AF%81%E8%BD%AF%E4%BB%B6%E8%BA%AB%E4%BB%BD%E2%80%9C%E4%BF%A1%E7%94%A8%E4%BD%93%E7%B3%BB%E2%80%9D%E7%9A%84%E5%AE%89%E5%85%A8%E5%8D%B1%E6%9C%BA" target="_blank"><i class="fa fa-qq"></i></a>
                                        </div>
                                        <div class="info-item act">
                                            <a href="javascript:;" id="j-reading"><i class="fa fa-file-text"></i></a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                                                        <h3 class="entry-related-title">相关推荐</h3><ul class="entry-related clearfix"><li><a href="http://www.mottoin.com/87173.html" title="Tomcat漏洞详解">Tomcat漏洞详解</a></li><li><a href="http://www.mottoin.com/104438.html" title="BEC攻击花招不断，开始使用HTML附件进行网络钓鱼了">BEC攻击花招不断，开始使用HTML附件进行网络钓鱼了</a></li><li><a href="http://www.mottoin.com/104516.html" title="用Python写成的MCR乐队敲诈者木马：这种操作很朋克！">用Python写成的MCR乐队敲诈者木马：这种操作很朋克！</a></li><li><a href="http://www.mottoin.com/18447.html" title="过狗注入研究历史及最后突破思路">过狗注入研究历史及最后突破思路</a></li><li><a href="http://www.mottoin.com/87670.html" title="基于镜像流量的漏洞挖掘思路分析">基于镜像流量的漏洞挖掘思路分析</a></li><li><a href="http://www.mottoin.com/89035.html" title="常见app加固厂商脱壳方法研究">常见app加固厂商脱壳方法研究</a></li><li><a href="http://www.mottoin.com/89396.html" title="如何用Cross-Site Scripting和MITM绕过NoScript安全套件">如何用Cross-Site Scripting和MITM绕过NoScript安全套件</a></li><li><a href="http://www.mottoin.com/86341.html" title="LNScan&#8211;一个高效的信息探测脚本">LNScan&#8211;一个高效的信息探测脚本</a></li><li><a href="http://www.mottoin.com/88558.html" title="PhpMyAdmin SQL注入漏洞(CVE-2016-5703)分析">PhpMyAdmin SQL注入漏洞(CVE-2016-5703)分析</a></li><li><a href="http://www.mottoin.com/90595.html" title="Schtasks Backdoor：权限维持工具">Schtasks Backdoor：权限维持工具</a></li></ul>                        </div>
                        
<div id="comments" class="entry-comments">
    	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">发表评论 <small><a rel="nofollow" id="cancel-comment-reply-link" href="/105178.html#respond" style="display:none;">取消回复</a></small></h3><div class="comment-form"><div class="comment-must-login">请登录后评论...</div><div class="form-submit"><div class="form-submit-text pull-left"><a href="http://www.mottoin.com/login">登录</a>后才能评论</div> <input name="submit" type="submit" id="must-submit" class="submit" value="发表"></div></div>	</div><!-- #respond -->
		</div><!-- .comments-area -->                    </div>
                </article>
                    </div>
        <aside class="sidebar">
            <div id="profile-3" class="widget widget_profile">                <div class="cover_photo"></div>
                        <div class="avatar-wrap">
                <a target="_blank" href="http://www.mottoin.com/user/360/" class="avatar-link"><img src="http://www.mottoin.com/wp-content/uploads/ultimatemember/529/profile_photo-190.png?1505839125" class="func-um_user gravatar avatar avatar-120 um-avatar um-avatar-uploaded" width="120" height="120" alt="360安全" /></a></div>
            <div class="profile-info">
                <p><span class="author-name">360安全</span><span class="author-title">企业用户</span></p>
                <p class="author-description"></p>
            </div>
            <div class="profile-posts">
                <h3 class="widget-title"><span>最近文章</span></h3>
                <ul>                    <li><a href="http://www.mottoin.com/105879.html" title="全球首款网络安全概念车驶入上海滩">全球首款网络安全概念车驶入上海滩</a></li>
                                    <li><a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场</a></li>
                                    <li><a href="http://www.mottoin.com/105773.html" title="网页上的污染源：“PM2.5报告”插件实为恶意广告注射器">网页上的污染源：“PM2.5报告”插件实为恶意广告注射器</a></li>
                                    <li><a href="http://www.mottoin.com/105746.html" title="游戏辅助背后的黑产流水线：年劫持攻击千万次牟利数百万">游戏辅助背后的黑产流水线：年劫持攻击千万次牟利数百万</a></li>
                                    <li><a href="http://www.mottoin.com/105703.html" title="【现场还原】补天漏洞情报发布会记事">【现场还原】补天漏洞情报发布会记事</a></li>
                </ul>            </div>
            </div><div id="custom_html-3" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><a class="btn-post" href="/question"><i class="fa fa-edit"></i> 我要提问</a></div></div><div id="post-thumb-3" class="widget widget_post_thumb">            <ul>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105917.html" title="美参议员要求电信巨头们回应SS7信令系统的安全问题">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG929-480x300.jpeg" width="480" height="300" alt="美参议员要求电信巨头们回应SS7信令系统的安全问题">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105917.html" title="美参议员要求电信巨头们回应SS7信令系统的安全问题">美参议员要求电信巨头们回应SS7信令系统的安全问题</a></p>
                            <p class="item-date">2017年9月19日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105914.html" title="美国国土安全部发布禁止使用卡巴斯基产品的明细">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG928-480x300.jpeg" width="480" height="300" alt="美国国土安全部发布禁止使用卡巴斯基产品的明细">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105914.html" title="美国国土安全部发布禁止使用卡巴斯基产品的明细">美国国土安全部发布禁止使用卡巴斯基产品的明细</a></p>
                            <p class="item-date">2017年9月19日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105885.html" title="【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG906-480x300.jpeg" width="480" height="300" alt="【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105885.html" title="【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）">【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）</a></p>
                            <p class="item-date">2017年9月19日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105879.html" title="全球首款网络安全概念车驶入上海滩">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15057198871-480x300.png" width="480" height="300" alt="全球首款网络安全概念车驶入上海滩">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105879.html" title="全球首款网络安全概念车驶入上海滩">全球首款网络安全概念车驶入上海滩</a></p>
                            <p class="item-date">2017年9月18日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105872.html" title="暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG897-480x300.jpeg" width="480" height="300" alt="暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105872.html" title="暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3">暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3</a></p>
                            <p class="item-date">2017年9月18日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105865.html" title="美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG896-480x300.jpeg" width="480" height="300" alt="美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105865.html" title="美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁">美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁</a></p>
                            <p class="item-date">2017年9月18日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105858.html" title="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG150-480x300.jpeg" width="480" height="300" alt="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105858.html" title="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护</a></p>
                            <p class="item-date">2017年9月17日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG141-480x300.jpeg" width="480" height="300" alt="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场</a></p>
                            <p class="item-date">2017年9月16日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105837.html" title="黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG132-480x300.jpeg" width="480" height="300" alt="黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105837.html" title="黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协">黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协</a></p>
                            <p class="item-date">2017年9月16日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105832.html" title="Equifax数据泄漏事件，或将成为推动美国社会安全号（SSN）改革的契机">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG895-480x300.jpeg" width="480" height="300" alt="Equifax数据泄漏事件，或将成为推动美国社会安全号（SSN）改革的契机">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105832.html" title="Equifax数据泄漏事件，或将成为推动美国社会安全号（SSN）改革的契机">Equifax数据泄漏事件，或将成为推动美国社会安全号（SSN）改革的契机</a></p>
                            <p class="item-date">2017年9月15日</p>
                        </div>
                    </li>
                            </ul>
        </div><div id="lastest-products-4" class="widget widget_lastest_products">            <ul class="p-list clearfix">
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105858.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG150-480x300.jpeg" width="480" height="300" alt="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105858.html" title="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">
                                    DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105847.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG141-480x300.jpeg" width="480" height="300" alt="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">
                                    国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105799.html">
                                <img width="480" height="300" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" class="attachment-post-thumbnail size-post-thumbnail j-lazy wp-post-image" alt="暗网系列之：“入店行窃者”的工具、战术和克星" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15054708381-150x150-480x300.png" />                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105799.html" title="暗网系列之：“入店行窃者”的工具、战术和克星">
                                    暗网系列之：“入店行窃者”的工具、战术和克星                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105703.html">
                                <img width="480" height="300" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" class="attachment-post-thumbnail size-post-thumbnail j-lazy wp-post-image" alt="【现场还原】补天漏洞情报发布会记事" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG82-150x150-480x300.jpeg" />                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105703.html" title="【现场还原】补天漏洞情报发布会记事">
                                    【现场还原】补天漏洞情报发布会记事                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105692.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG75-480x300.jpeg" width="480" height="300" alt="SyScan360看点回顾：中美德俄等七国黑客专家神技大比拼">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105692.html" title="SyScan360看点回顾：中美德俄等七国黑客专家神技大比拼">
                                    SyScan360看点回顾：中美德俄等七国黑客专家神技大比拼                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105642.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG58-480x300.jpeg" width="480" height="300" alt="大安全时代序幕开启！ 中国互联网安全大会重新定义网络安全">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105642.html" title="大安全时代序幕开启！ 中国互联网安全大会重新定义网络安全">
                                    大安全时代序幕开启！ 中国互联网安全大会重新定义网络安全                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105621.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG512-480x300.jpeg" width="480" height="300" alt="【重磅推出】ISC大会补天漏洞情报服务发布会：英雄，你准备好了吗？">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105621.html" title="【重磅推出】ISC大会补天漏洞情报服务发布会：英雄，你准备好了吗？">
                                    【重磅推出】ISC大会补天漏洞情报服务发布会：英雄，你准备好了吗？                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105629.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG49-480x300.jpeg" width="480" height="300" alt="ISC直击：360守护者计划登陆ISC 最强白帽挑战黑客马拉松大奖赛">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105629.html" title="ISC直击：360守护者计划登陆ISC 最强白帽挑战黑客马拉松大奖赛">
                                    ISC直击：360守护者计划登陆ISC 最强白帽挑战黑客马拉松大奖赛                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105603.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG42-480x300.jpeg" width="480" height="300" alt="【ISC2017精彩剪辑】周鸿祎：大安全时代 网络空间防御刻不容缓">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105603.html" title="【ISC2017精彩剪辑】周鸿祎：大安全时代 网络空间防御刻不容缓">
                                    【ISC2017精彩剪辑】周鸿祎：大安全时代 网络空间防御刻不容缓                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105587.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG36-480x300.jpeg" width="480" height="300" alt="【ISC2017精彩剪辑】生物黑客：植入芯片变身“半机械人”">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105587.html" title="【ISC2017精彩剪辑】生物黑客：植入芯片变身“半机械人”">
                                    【ISC2017精彩剪辑】生物黑客：植入芯片变身“半机械人”                                </a>
                            </h4>
                        </div>
                    </li>
                            </ul>
        </div>        </aside>
    </div>
<div class="modal" id="login-modal">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                <h4 class="modal-title">请登录</h4>
            </div>
            <div class="modal-body login-modal-body">
                <p>您还未登录，请登录后再进行相关操作！</p>
                <div class="login-btn">
                    <a class="btn btn-login" href="http://www.mottoin.com/login">登 录</a>
                    <a class="btn btn-register" href="http://www.mottoin.com/register">注 册</a>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
<footer class="footer">
    <div class="container">
        <div class="clearfix">
                        <div class="footer-col footer-col-logo">
                <img src="http://www.mottoin.com/img/mottoin/tmxk.png" alt="MottoIN">
            </div>
                        <div class="footer-col footer-col-copy">
                <ul class="footer-nav hidden-xs"><li id="menu-item-104182" class="menu-item menu-item-104182"><a href="http://www.mottoin.com/about">关于我们</a></li>
<li id="menu-item-104181" class="menu-item menu-item-104181"><a href="http://www.mottoin.com/dis">免责声明</a></li>
<li id="menu-item-104183" class="menu-item menu-item-104183"><a href="http://www.mottoin.com/joinus">加入我们</a></li>
<li id="menu-item-105509" class="menu-item menu-item-105509"><a href="http://www.mottoin.com/contact">联系我们</a></li>
<li id="menu-item-104184" class="menu-item menu-item-104184"><a href="http://www.mottoin.com/report">寻求报道</a></li>
<li id="menu-item-104185" class="menu-item menu-item-104185"><a href="http://www.mottoin.com/contribute">我要投稿</a></li>
</ul>                <div class="copyright">
                    Copyright © 2017 MottoIN 版权所有 <a href="http://www.miibeian.gov.cn/">沪ICP备16010654号-5</a>  <img class="alignnone " src="http://www.mottoin.com/img/mottoin/ga.png" width="16" height="16" /> <a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31010402001331">沪公网安备31010402001331号</a>                 </div>
            </div>
            <div class="footer-col footer-col-sns">
                <div class="footer-sns">
                                                                                    <a class="sns-wx" href="javascript:;">
                            <i class="fa fa-weixin"></i>
                            <span style="background-image:url(http://www.mottoin.com/img/mottoin/weixin.jpg);"></span>
                        </a>
                                                                <a target="_blank" href="http://weibo.com/mottoin" rel="nofollow"><i class="fa fa-weibo"></i></a>
                                                                <a target="_blank" href="http://weibo.com/mottoin" rel="nofollow"><i class="fa fa-tencent-weibo"></i></a>
                                                                                                                                                                                </div>
            </div>
        </div>
    </div>
</footer>
<div class="action" style="top:50%;">
            <div class="a-box contact">
            <div class="contact-wrap">
                <h3 class="contact-title">联系我们</h3>
                <h4 style="text-align: center;"><span style="color: #2d6ded;"><strong>021-62666911</strong></span></h4>
<p>在线咨询：<a href="http://wpa.qq.com/msgrd?uin=19539638" target="_blank" rel="noopener"><img class="alignnone" title="点击这里给我发消息" src="http://wpa.qq.com/pa?p=2:1666839010:51" alt="点击这里给我发消息" border="0" /></a></p>
<p>邮件：root@mottoin.com</p>
<p>工作时间：周一至周五，9:30-18:30，节假日休息</p>
            </div>
        </div>
                <div class="a-box wechat">
            <div class="wechat-wrap">
                <img src="http://www.mottoin.com/img/mottoin/weixin.jpg" alt="QR code">
            </div>
        </div>
            <div class="a-box gotop" id="j-top" style="display: none;"></div>
</div>
<style>.footer{padding-bottom: 35px;}</style><div id="um_upload_single" style="display:none">
	
</div><div id="um_view_photo" style="display:none">

	<a href="#" data-action="um_remove_modal" class="um-modal-close"><i class="um-faicon-times"></i></a>
	
	<div class="um-modal-body photo">
	
		<div class="um-modal-photo">

		</div>

	</div>
	
</div><script type='text/javascript'>
/* <![CDATA[ */
var _wpcom_js = {"ajaxurl":"http:\/\/www.mottoin.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/themes/JustNews/js/main.js?ver=2.3.2'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/comment-reply.min.js?ver=4.8.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpcom_qa_js = {"ajaxurl":"http:\/\/www.mottoin.com\/wp-admin\/admin-ajax.php","ajaxloading":"http:\/\/www.mottoin.com\/wp-content\/plugins\/wpcom-qa\/images\/loading.gif"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/plugins/wpcom-qa/js/scripts.min.js?ver=1.0'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/imagesloaded.min.js?ver=3.2.0'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/masonry.min.js?ver=3.3.2'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/jquery/jquery.masonry.min.js?ver=3.1.2b'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var um_scripts = {"ajaxurl":"http:\/\/www.mottoin.com\/wp-admin\/admin-ajax.php","fileupload":"http:\/\/www.mottoin.com\/wp-content\/plugins\/ultimate-member\/core\/lib\/upload\/um-file-upload.php","imageupload":"http:\/\/www.mottoin.com\/wp-content\/plugins\/ultimate-member\/core\/lib\/upload\/um-image-upload.php"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/plugins/ultimate-member/assets/js/um.min.js?ver=10.3.88'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/plugins/ultimate-member/assets/js/pickadate/translations/zh_CN.js?ver=10.3.88'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/wp-embed.min.js?ver=4.8.1'></script>

		<script type="text/javascript">jQuery( '#request' ).val( '' );</script>

	    <script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":["mshare","tsina","weixin","qzone","sqq","douban","fbook","twi","bdhome","tqq","tieba","mail","youdao","print"],"bdPic":"","bdStyle":"1","bdSize":"16"},"share":[{"tag" : "single", "bdSize" : 16}, {"tag" : "global","bdSize" : 16,bdPopupOffsetLeft:-227}],url:'http://www.mottoin.com/wp-content/themes/JustNews'};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://www.mottoin.com/wp-content/themes/JustNews/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
</body>
</html>