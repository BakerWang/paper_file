<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
    <title>CVE-2013-3934 Wps栈溢出分析 | MottoIN</title>
    <link rel='dns-prefetch' href='//www.mottoin.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="MottoIN &raquo; CVE-2013-3934 Wps栈溢出分析评论Feed" href="http://www.mottoin.com/88191.html/feed" />
<link rel='stylesheet' id='stylesheet-css'  href='http://www.mottoin.com/wp-content/themes/JustNews/css/style.css?ver=2.3.2' type='text/css' media='all' />
<link rel='stylesheet' id='wpcom-qa-css'  href='http://www.mottoin.com/wp-content/plugins/wpcom-qa/css/style.css?ver=1.0' type='text/css' media='all' />
<style id='wpcom-qa-inline-css' type='text/css'>

        .q-content .topic-tab,.q-content .q-answer .as-user,.q-content .q-answer .as-comment-name{color: #1471CA;}
        .q-content .q-topic-wrap a:hover,.q-content .q-answer .as-action a:hover,.q-content .topic-tab:hover{color:#0D62B3;}
        .q-content .put-top,.q-content .topic-tab.current-tab,.q-content .q-answer .as-submit .btn-submit,.q-content .q-answer .as-comments-submit,.q-content .q-add-header .btn-post,.q-content .q-pagination .current{background-color:#1471CA;}
        .q-content .q-answer .as-submit .btn-submit:hover,.q-content .q-answer .as-comments-submit:hover,.q-content .q-add-header .btn-post:hover,.q-content .topic-tab.current-tab:hover,.q-content .q-pagination a:hover{background-color:#0D62B3;}
        .q-content .q-answer .as-comments-input:focus{border-color: #1471CA;}
        
</style>
<link rel='stylesheet' id='um_minified-css'  href='http://www.mottoin.com/wp-content/plugins/ultimate-member/assets/css/um.min.css?ver=10.3.88' type='text/css' media='all' />
<script type='text/javascript' src='http://www.mottoin.com/wp-content/themes/JustNews/js/jquery.min.js?ver=1.12.4'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.mottoin.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.mottoin.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='JDNI注入/LDAP Entry污染攻击技术研究' href='http://www.mottoin.com/88143.html' />
<link rel='next' title='LFI Getshell Without Uploadpage' href='http://www.mottoin.com/88204.html' />
<link rel='shortlink' href='http://www.mottoin.com/?p=88191' />
<!--  WPCOM主题相关信息开始 -->
<meta name="applicable-device" content="pc,mobile">
<meta http-equiv="Cache-Control" content="no-transform">
<meta name="keywords" content="CVE-2013-3934,exp,Wps,栈溢出,漏洞分析">
<meta name="description" content="0x00分析环境MicrosoftWindows[版本6.1.7601]KingsoftOfficeWriterv20128.1.0.3385python2.7.5windbg6.12ollydbgIDA_Pro_v6.8_and_Hex-Rays_Decompiler_(ARM,x64,x86)_GreenImmunityDebuggerZynamics_BinDiff_4.2exphttps:">
<!--  WPCOM主题相关信息结束 -->
 
		<script type="text/javascript">

		var ultimatemember_image_upload_url = 'http://www.mottoin.com/wp-content/plugins/ultimate-member/core/lib/upload/um-image-upload.php';
		var ultimatemember_file_upload_url = 'http://www.mottoin.com/wp-content/plugins/ultimate-member/core/lib/upload/um-file-upload.php';
		var ultimatemember_ajax_url = 'http://www.mottoin.com/wp-admin/admin-ajax.php';

		</script>

	
		<style type="text/css">.request_name { display: none !important; }</style>

	<link rel="icon" href="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-32x32.jpg" sizes="32x32" />
<link rel="icon" href="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-192x192.jpg" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-180x180.jpg" />
<meta name="msapplication-TileImage" content="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-270x270.jpg" />
    <style>
                a,.sec-panel-head span,.list.tabs .tab.active a,.header .nav>li.active>a,.header .dropdown-menu>.active>a,.entry .entry-info .nickname,.entry-bar-inner .author-title,.entry-action .btn-zan,.entry-action .btn-dashang,.comment-body .nickname,.form-submit-text span,.widget_profile .author-title,.um .um-profile-body .um-item-meta a,.login-modal-body .btn-register{color: #08c;}
        .header .dropdown-menu>li>a:hover,.header .dropdown-menu>.active>a:hover,.header .dropdown-menu>.active>a:focus,.navbar-action .publish,.pagination .current,.flex-control-paging li a.flex-active,.form-submit .submit,.sidebar .widget_nav_menu ul li.current-menu-item a,.sidebar .widget_nav_menu ul li.current-post-parent a,.search-form input.submit,.action .contact-title,.pf-submit,.tagHandler ul.tagHandlerContainer li.tagItem,.login-modal-body .btn-login,.woocommerce a.button,.woocommerce button.button,.woocommerce input.button,.woocommerce a.button.alt,.woocommerce button.button.alt,.woocommerce input.button.alt,.woocommerce a.button.alt.disabled,.woocommerce a.button.alt.disabled:hover,.woocommerce a.button.alt:disabled,.woocommerce a.button.alt:disabled:hover,.woocommerce a.button.alt:disabled[disabled],.woocommerce a.button.alt:disabled[disabled]:hover,.woocommerce button.button.alt.disabled,.woocommerce button.button.alt.disabled:hover,.woocommerce button.button.alt:disabled,.woocommerce button.button.alt:disabled:hover,.woocommerce button.button.alt:disabled[disabled],.woocommerce button.button.alt:disabled[disabled]:hover,.woocommerce input.button.alt.disabled,.woocommerce input.button.alt.disabled:hover,.woocommerce input.button.alt:disabled,.woocommerce input.button.alt:disabled:hover,.woocommerce input.button.alt:disabled[disabled],.woocommerce input.button.alt:disabled[disabled]:hover,.woocommerce .widget_price_filter .ui-slider .ui-slider-handle,.woocommerce .widget_price_filter .ui-slider .ui-slider-range,.shopping-count,.social-login-form .sl-input-submit{background-color: #08c;}
        .entry .entry-content h3,.entry .entry-content .h3,.widget-title{border-left-color: #08c;}
        .entry-bar-inner .author-title,.entry-action .btn-zan,.entry-action .btn-dashang,.search-form input.keyword:focus,.widget_profile .author-title,.login-modal-body .btn-login,.login-modal-body .btn-register{border-color: #08c;}
        .entry-bar-inner .author-title:before,.widget_profile .author-title:before{border-right-color: #08c;}
        .list.tabs .tab.active a{border-bottom-color: #08c;}

        a:hover,.header .nav>li>a:hover,.header .nav>li.active>a,.navbar-action .login:hover,.navbar-action .login:focus,.navbar-action .profile a:hover,.navbar-search-icon:hover,.navbar-search-icon:focus,.entry .entry-info a:hover,.entry .entry-info a:focus,.entry-bar .info-item a:hover,.p-item-wrap:hover .title a,.special-item-title a:hover,.special-item-bottom a:hover,.widget ul a:hover,.widget ol a:hover,.sec-panel-head .more:hover,.topic-list .topic-wrap:hover span,.tabs .tab a:hover,
        .article-list .item-title a:hover,.article-list .item-meta a:hover,.article-list .item-meta a:focus,.list-links a:hover,.list-links a:focus,.um .um-profile-body .um-item-meta a:hover,.um .um-profile-body .um-item-link a:hover,.load-more:hover,.login-modal-body .btn-register:hover{color: #07c;}
        .navbar-action .publish:hover,.navbar-action .publish:focus,.entry-tag a:hover,.entry-tag a:focus,.entry-action .btn-zan:hover,.entry-action .btn-dashang:hover,.entry-action .btn-zan.liked,.pagination a:hover,.flex-control-paging li a:hover,.form-submit .submit:hover,.widget .tagcloud a:hover,.sidebar .widget_nav_menu ul li.current-menu-item .sub-menu a:hover,.sidebar .widget_nav_menu ul li.current-post-parent .sub-menu a:hover,.sidebar .widget_nav_menu ul li a:hover,.search-form input.submit:hover,.action .a-box:hover,.footer-sns .fa:after,.article-list .item-category:hover,.pf-submit:hover,.tagHandler ul.tagHandlerContainer li.tagItem:hover,.login-modal-body .btn-login:hover,.woocommerce a.button:hover,.woocommerce button.button:hover,.woocommerce input.button:hover,.woocommerce a.button.alt:hover,.woocommerce button.button.alt:hover,.woocommerce input.button.alt:hover,.woocommerce .widget_price_filter .price_slider_wrapper .ui-widget-content,.social-login-form .sl-input-submit:hover{background-color: #07c;}
        .entry-tag a:hover,.entry-tag a:focus,.entry-action .btn-zan:hover,.entry-action .btn-dashang:hover,.entry-action .btn-zan.liked,.widget .tagcloud a:hover,.load-more:hover,.login-modal-body .btn-login:hover,.login-modal-body .btn-register:hover{border-color: #07c;}
        .special-item-bottom a:hover:before{border-left-color: #07c;}
        .list.tabs .tab.active a:hover{border-bottom-color: #07c;}
        @media (max-width: 991px){
            .header .navbar-nav>li.active>a,.header .navbar-nav .dropdown-menu .active a,.header .navbar-nav .dropdown-menu .active .dropdown-menu .active a{color: #08c;}
            .navbar-collapse{background-color: #08c;}
            .dropdown-menu>li a{border-color: #07c;}
            .header .navbar-nav>li.active>a:hover,.header .navbar-nav>li a:hover,.header .navbar-nav .dropdown-menu .active a:hover,.header .navbar-nav .dropdown-menu .active .dropdown-menu a:hover,.header .navbar-nav .dropdown-menu li a:hover{color: #07c;}
        }
        .j-share{position: fixed!important;top: 50%!important;}
                .header .logo img{max-height: 32px;}
                @media (max-width: 767px){
            .header .logo img{max-height: 26px;}
        }
                        .btn-post{
    display: block;
    margin: 0 auto;
    padding: 15px 20px;
    font-size: 16px;
    text-align: center;
    color: #fff !important;
    line-height: 1;
    background: #1471CA;
    -webkit-border-radius: 3px;
    border-radius: 3px;
    text-decoration: none;
    border: 0;
    outline: 0;
}    </style>
    <script> (function() {if (!/*@cc_on!@*/0) return;var e = "abbr, article, aside, audio, canvas, datalist, details, dialog, eventsource, figure, footer, header, hgroup, mark, menu, meter, nav, output, progress, section, time, video".split(', ');var i= e.length; while (i--){ document.createElement(e[i]) } })()</script>
    <!--[if lte IE 8]><script src="http://www.mottoin.com/wp-content/themes/JustNews/js/respond.min.js"></script><![endif]-->
</head>
<body class="post-template-default single single-post postid-88191 single-format-standard">
<header class="header">
    <div class="container clearfix">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar icon-bar-1"></span>
                <span class="icon-bar icon-bar-2"></span>
                <span class="icon-bar icon-bar-3"></span>
            </button>
            <a class="logo" href="http://www.mottoin.com"><img src="http://www.mottoin.com/img/mottoin/logo.png" alt="MottoIN"></a>
        </div>
        <div class="collapse navbar-collapse">
            <nav class="navbar-left primary-menu"><ul id="menu-%e5%af%bc%e8%88%aa" class="nav navbar-nav"><li class="menu-item menu-item-home"><a href="http://www.mottoin.com/">首页</a></li>
<li class="menu-item"><a href="http://www.mottoin.com/category/news">资讯</a></li>
<li class="menu-item current-post-ancestor dropdown"><a href="http://www.mottoin.com/category/article" class="dropdown-toggle">文章</a>
<ul role="menu" class=" dropdown-menu">
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/web">Web安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/system">系统安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/network">网络安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/terminal">终端安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/database">数据安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/wireless">无线安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/social">社会工程</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/intranet">内网渗透</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/code">代码审计</a></li>
	<li class="menu-item current-post-ancestor current-menu-parent current-post-parent"><a href="http://www.mottoin.com/category/article/reverse">逆向破解</a></li>
</ul>
</li>
<li class="menu-item"><a href="http://www.mottoin.com/category/tools">工具</a></li>
<li class="menu-item"><a href="http://www.mottoin.com/category/geek">极客</a></li>
<li class="menu-item dropdown"><a href="http://www.mottoin.com/category/sole" class="dropdown-toggle">独家</a>
<ul role="menu" class=" dropdown-menu">
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/topic">专题</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/people">人物</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/view">观点</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/events">活动</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/video">视频</a></li>
</ul>
</li>
<li class="menu-item"><a href="http://www.mottoin.com/category/hr">招聘</a></li>
<li class="menu-item"><a href="http://www.mottoin.com/forum">社区</a></li>
</ul></nav>            <div class="navbar-action pull-right">

                                    <form class="navbar-search" action="http://www.mottoin.com" method="get" role="search">
                        <input type="text" name="s" class="navbar-search-input" autocomplete="off" placeholder="输入关键词搜索..." value="">
                        <a class="navbar-search-icon j-navbar-search" href="javascript:;"></a>
                    </form>

                    
                    <div id="j-user-wrap">
                        <a class="login" href="http://www.mottoin.com/login">登录</a>
                        <a class="login" href="http://www.mottoin.com/register">注册</a>
                    </div>
                    <a class="publish" href="http://www.mottoin.com/post">
                        投稿</a>
                                                </div>
        </div><!-- /.navbar-collapse -->
    </div><!-- /.container -->
</header>
<div id="wrap">    <div class="main container">
        <div class="content">
                            <article id="post-88191" class="post-88191 post type-post status-publish format-standard has-post-thumbnail hentry category-reverse tag-cve-2013-3934 tag-exp tag-wps tag-646 tag-425">
                    <div class="entry">
                        <div class="entry-head">
                            <h1 class="entry-title">CVE-2013-3934 Wps栈溢出分析</h1>
                            <div class="entry-info">
                                                                <a class="nickname" href="http://www.mottoin.com/user/seceditor/">Moto</a>
                                <span class="dot">•</span>
                                <span>2016年8月26日</span>
                                <span class="dot">•</span>
                                <a href="http://www.mottoin.com/category/article/reverse" rel="category tag">逆向破解</a>                                                                    <span class="dot">•</span>
                                    <span>阅读 1141</span>
                                                            </div>
                        </div>
                                                                        <div class="entry-content clearfix">
                            <h2>0x00分析环境</h2>
<ol>
<li>Microsoft Windows [版本 6.1.7601]</li>
<li>Kingsoft Office Writer v2012 8.1.0.3385</li>
<li>python 2.7.5</li>
<li>windbg 6.12</li>
<li>ollydbg</li>
<li>IDA_Pro_v6.8_and_Hex-Rays_Decompiler_(ARM,x64,x86)_Green</li>
<li>Immunity Debugger</li>
<li>Zynamics_BinDiff_4.2</li>
<li>exp https://www.exploit-db.com/exploits/29922/</li>
</ol>
<h2>0x01漏洞定位</h2>
<pre class="">(fa8.f4c): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
eax=0018c668 ebx=75b545d2 ecx=90909090 edx=0018c3c4 esi=0018c668 edi=03edf59c
eip=67a0523e esp=0018c3b0 ebp=0018c3bc iopl=0 nv up ei pl zr na pe nc
cs=001b ss=0023 ds=0023 es=0023 fs=003b gs=0000 efl=00210246
*** ERROR: Symbol file could not be found. Defaulted to export symbols for C:\Program Files\Kingsoft\Kingsoft Office\office6\wpsio.dll - 
wpsio!TxExport+0x37b8:
67a0523e ff5114 call dword ptr [ecx+14h] ds:0023:909090a4=????????</pre>
<p>打开exp,windbg捕捉到首次异常.能看到漏洞出现在wpsio模块上.</p>
<p>没有覆盖之前的seh chain:</p>
<pre class="">0:000&gt; !exchain -v
0031f7c4: ntdll!_except_handler4+0 (76dbe0ed)
 CRT scope 0, filter: ntdll!LdrpDoDebuggerBreak+32 (76e404fc)
 func: ntdll!LdrpDoDebuggerBreak+36 (76e40500)
0031f974: ntdll!_except_handler4+0 (76dbe0ed)
 CRT scope 0, filter: ntdll!_LdrpInitialize+db (76e20ea4)
 func: ntdll!_LdrpInitialize+f0 (76e20eb9)
Invalid exception stack at ffffffff</pre>
<p>之后被淹没</p>
<pre class="">0:000&gt; !exchain -v
0031c630: *** WARNING: Unable to verify checksum for C:\Program Files\Kingsoft\Kingsoft Office\office6\IRLAS.dll
*** ERROR: Symbol file could not be found. Defaulted to export symbols for C:\Program Files\Kingsoft\Kingsoft Office\office6\IRLAS.dll - 
IRLAS!WordSegmentSimple+7566 (5101ade6)
Invalid exception stack at 06eb9090</pre>
<p>地址在IRLAS.dll上,nseh为06eb9090,seh handle为5101ade6.因为:</p>
<p><img class="alignnone size-full wp-image-88192 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/1-78.png" alt="1" width="1504" height="951" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/1-78.png 1504w, http://www.mottoin.com/wp-content/uploads/2016/08/1-78-300x190.png 300w, http://www.mottoin.com/wp-content/uploads/2016/08/1-78-768x486.png 768w, http://www.mottoin.com/wp-content/uploads/2016/08/1-78-1024x647.png 1024w" sizes="(max-width: 1504px) 100vw, 1504px" /></p>
<p>接着单步就是ppt了</p>
<p><img class="alignnone size-full wp-image-88193 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/2-71.png" alt="2" width="1021" height="766" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/2-71.png 1021w, http://www.mottoin.com/wp-content/uploads/2016/08/2-71-300x225.png 300w, http://www.mottoin.com/wp-content/uploads/2016/08/2-71-768x576.png 768w" sizes="(max-width: 1021px) 100vw, 1021px" /></p>
<p>查看首轮异常时eip附近代码</p>
<pre class="">67a3522e 55 push ebp
67a3522f 8bec mov ebp,esp
67a35231 8b4508 mov eax,dword ptr [ebp+8]
67a35234 8b08 mov ecx,dword ptr [eax]
67a35236 8d5508 lea edx,[ebp+8]
67a35239 52 push edx
67a3523a ff750c push dword ptr [ebp+0Ch]
67a3523d 50 push eax
67a3523e ff5114 call dword ptr [ecx+14h] ds:0023:909090a4=????????
67a35241 85c0 test eax,eax
67a35243 7907 jns wpsio!TxExport+0x37c6 (67a3524c)</pre>
<p>可以看到从栈中读出数据交给ecx,触发访问违例.</p>
<p>查看调用栈</p>
<pre class="">0:000&gt; kb 5
ChildEBP RetAddr Args to Child 
WARNING: Stack unwind information not available. Following frames may be wrong.
0031c3c4 67a3ceb3 0031c670 010c0032 0031c3f8 wpsio!TxExport+0x37b8
0031c63c 90909b5e 90909090 90909090 90909090 wpsio!TxExport+0xb42d
0031c640 90909090 90909090 90909090 90909090 0x90909b5e
0031c644 90909090 90909090 90909090 90909090 0x90909090
0031c648 90909090 90909090 90909090 90909090 0x90909090
0:000&gt; ub 67a3ceb3
wpsio!TxExport+0xb40e:
67a3ce94 57 push edi
67a3ce95 ff153085c067 call dword ptr [wpsio!TxCreatePicImporter+0x1b416b (67c08530)]
67a3ce9b 8bb5c4fdffff mov esi,dword ptr [ebp-23Ch]
67a3cea1 8d85bcfdffff lea eax,[ebp-244h]
67a3cea7 50 push eax
67a3cea8 6832000c01 push 10C0032h
67a3cead 56 push esi
67a3ceae e87b83ffff call wpsio!TxExport+0x37a8 (67a3522e)
0:000&gt; u 67a3ceb3
wpsio!TxExport+0xb42d:
67a3ceb3 85c0 test eax,eax
67a3ceb5 7817 js wpsio!TxExport+0xb448 (67a3cece)
67a3ceb7 8a85bcfdffff mov al,byte ptr [ebp-244h]
67a3cebd c0e004 shl al,4
67a3cec0 3285c8fdffff xor al,byte ptr [ebp-238h]
67a3cec6 2470 and al,70h
67a3cec8 3085c8fdffff xor byte ptr [ebp-238h],al
67a3cece 83a5c4fdffff00 and dword ptr [ebp-23Ch],0
0:000&gt; r eip
eip=67a3523e</pre>
<p>看到在67a3ceae位置处调用.(dll基址浮动)</p>
<ol>
<li>wps在进行打开文件动作时,会起一条线程加载wpsio.dll.</li>
<li>在wpsio模块中两次调用6645522E函数.在首次调用上下断.<br />
暂且把xxxx522E函数命名为raiseExcept.<br />
跟到raiseExcept内.</li>
<li>硬编码对比.</li>
</ol>
<p><img class="alignnone size-full wp-image-88194 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/3-65.png" alt="3" width="637" height="579" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/3-65.png 637w, http://www.mottoin.com/wp-content/uploads/2016/08/3-65-300x273.png 300w" sizes="(max-width: 637px) 100vw, 637px" /></p>
<p>假如参数A已申请字符串指针,那么释放掉.</p>
<p><img class="alignnone size-full wp-image-88195 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/4-62.png" alt="4" width="769" height="455" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/4-62.png 769w, http://www.mottoin.com/wp-content/uploads/2016/08/4-62-300x178.png 300w, http://www.mottoin.com/wp-content/uploads/2016/08/4-62-768x454.png 768w" sizes="(max-width: 769px) 100vw, 769px" /></p>
<p>4.申请了两段内存空间,第一段长度为228,第二段为200.</p>
<p>5.紧接着有内存覆盖的动作,向第二段内存空间复制了214 byte. 覆盖了seh.</p>
<p><img class="alignnone size-full wp-image-88196 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/5-51.png" alt="5" width="1785" height="1074" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/5-51.png 1785w, http://www.mottoin.com/wp-content/uploads/2016/08/5-51-300x181.png 300w, http://www.mottoin.com/wp-content/uploads/2016/08/5-51-768x462.png 768w, http://www.mottoin.com/wp-content/uploads/2016/08/5-51-1024x616.png 1024w" sizes="(max-width: 1785px) 100vw, 1785px" /></p>
<p>6.跟进memcpy函数.rep movs dword ptr es:[edi],dword ptr ds&gt;循环复制,为溢出点.</p>
<pre class="">6B7E1E80 &gt; 55 push ebp
6B7E1E81 8BEC mov ebp,esp
6B7E1E83 57 push edi
6B7E1E84 56 push esi ; OLEAUT32.SysStringLen
6B7E1E85 8B75 0C mov esi,dword ptr ss:[ebp+C]
6B7E1E88 8B4D 10 mov ecx,dword ptr ss:[ebp+10]
6B7E1E8B 8B7D 08 mov edi,dword ptr ss:[ebp+8]
6B7E1E8E 8BC1 mov eax,ecx
6B7E1E90 8BD1 mov edx,ecx
6B7E1E92 03C6 add eax,esi ; OLEAUT32.SysStringLen
6B7E1E94 3BFE cmp edi,esi ; OLEAUT32.SysStringLen
6B7E1E96 76 08 jbe short MSVCR100.6B7E1EA0
6B7E1E98 3BF8 cmp edi,eax
6B7E1E9A 0F82 A0010000 jb MSVCR100.6B7E2040
6B7E1EA0 81F9 80000000 cmp ecx,80
6B7E1EA6 72 1C jb short MSVCR100.6B7E1EC4
6B7E1EA8 833D F055896B 0&gt;cmp dword ptr ds:[6B8955F0],0
6B7E1EAF 74 13 je short MSVCR100.6B7E1EC4
6B7E1EB1 57 push edi
6B7E1EB2 56 push esi ; OLEAUT32.SysStringLen
6B7E1EB3 83E7 0F and edi,0F
6B7E1EB6 83E6 0F and esi,0F
6B7E1EB9 3BFE cmp edi,esi ; OLEAUT32.SysStringLen
6B7E1EBB 5E pop esi ; 0023C544
6B7E1EBC 5F pop edi ; 0023C544
6B7E1EBD 75 05 jnz short MSVCR100.6B7E1EC4
6B7E1EBF E9 35EB0000 jmp MSVCR100.6B7F09F9
6B7E1EC4 F7C7 03000000 test edi,3
6B7E1ECA 75 14 jnz short MSVCR100.6B7E1EE0
6B7E1ECC C1E9 02 shr ecx,2
6B7E1ECF 83E2 03 and edx,3
6B7E1ED2 83F9 08 cmp ecx,8
6B7E1ED5 72 29 jb short MSVCR100.6B7E1F00
6B7E1ED7 F3:A5 rep movs dword ptr es:[edi],dword ptr ds&gt; ;溢出位置
6B7E1ED9 FF2495 F01F7E6B jmp dword ptr ds:[edx*4+6B7E1FF0] ; MSVCR100.6B7E2000
6B7E1EE0 8BC7 mov eax,edi
6B7E1EE2 BA 03000000 mov edx,3
6B7E1EE7 83E9 04 sub ecx,4</pre>
<p>7.继续向下跟进还能看到memcpy和指针释放的动作.</p>
<p>看到如下代码可能有人要问啦(其实并没有&#8230;): &#8220;难道这个memcpy又溢出了一次吗?&#8221;</p>
<p>A:其实也可以这么说,但SysAllocStringLen在memcpy之前已经有过申请,我刚开始没注意到罢了&#8230;</p>
<pre class="">6645CE35 . 83C4 0C add esp,0C
6645CE38 . 57 push edi
6645CE39 . FFD6 call esi ; OLEAUT32.SysStringLen
6645CE3B . 85C0 test eax,eax
6645CE3D . 7E 5C jle short wpsio.6645CE9B
6645CE3F . 33C9 xor ecx,ecx
6645CE41 . 66:833F 20 cmp word ptr ds:[edi],20
6645CE45 . 75 08 jnz short wpsio.6645CE4F
6645CE47 &gt; 41 inc ecx
6645CE48 . 66:833C4F 20 cmp word ptr ds:[edi+ecx*2],20
6645CE4D .^ 74 F8 je short wpsio.6645CE47
6645CE4F &gt; 8D5447 FE lea edx,dword ptr ds:[edi+eax*2-2]
6645CE53 . EB 04 jmp short wpsio.6645CE59
6645CE55 &gt; 48 dec eax
6645CE56 . 83EA 02 sub edx,2
6645CE59 &gt; 66:833A 20 cmp word ptr ds:[edx],20
6645CE5D .^ 74 F6 je short wpsio.6645CE55
6645CE5F . 50 push eax
6645CE60 . 8D044F lea eax,dword ptr ds:[edi+ecx*2]
6645CE63 . 50 push eax
6645CE64 . FFD3 call ebx ; OLEAUT32.SysAllocStringLen
6645CE66 . 8BF8 mov edi,eax
6645CE68 . 8B85 BCFDFFFF mov eax,dword ptr ss:[ebp-244]
6645CE6E . 40 inc eax
6645CE6F . 57 push edi
6645CE70 . 66:8985 CCFDF&gt;mov word ptr ss:[ebp-234],ax
6645CE77 . FFD6 call esi ; OLEAUT32.SysStringLen
6645CE79 . 03C0 add eax,eax
6645CE7B . 50 push eax ; /n = 23C544 (2344260.)
6645CE7C . 0FB785 CCFDFF&gt;movzx eax,word ptr ss:[ebp-234] ; |
6645CE83 . 8D8445 F0FDFF&gt;lea eax,dword ptr ss:[ebp+eax*2-210] ; |
6645CE8A . 57 push edi ; |src = 05023654
6645CE8B . 50 push eax ; |dest = 0023C544
6645CE8C . E8 7F1A1600 call &lt;jmp.&amp;MSVCR100.memcpy&gt; ; \memcpy
6645CE91 . 83C4 0C add esp,0C
6645CE94 . 57 push edi ; /Arg1 = 05023654
6645CE95 . FF15 30856266 call dword ptr ds:[&lt;&amp;OLEAUT32.#6_SysFree&gt;; \SysFreeString
6645CE9B &gt; 8BB5 C4FDFFFF mov esi,dword ptr ss:[ebp-23C]
6645CEA1 . 8D85 BCFDFFFF lea eax,dword ptr ss:[ebp-244]
6645CEA7 . 50 push eax ; /Arg3 = 0023C544
6645CEA8 . 68 32000C01 push 10C0032 ; |Arg2 = 010C0032
6645CEAD . 56 push esi ; |Arg1 = 75B54680
6645CEAE . E8 7B83FFFF call wpsio.6645522E ; \access violation on func</pre>
<p>8.航母f5:</p>
<p><img class="alignnone size-full wp-image-88197 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/6-44.png" alt="6" width="1732" height="1054" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/6-44.png 1732w, http://www.mottoin.com/wp-content/uploads/2016/08/6-44-300x183.png 300w, http://www.mottoin.com/wp-content/uploads/2016/08/6-44-768x467.png 768w, http://www.mottoin.com/wp-content/uploads/2016/08/6-44-1024x623.png 1024w" sizes="(max-width: 1732px) 100vw, 1732px" /></p>
<h2>0x02补丁对比or漏洞修复</h2>
<p><img class="alignnone size-full wp-image-88198 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/7-35.png" alt="7" width="1775" height="935" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/7-35.png 1775w, http://www.mottoin.com/wp-content/uploads/2016/08/7-35-300x158.png 300w, http://www.mottoin.com/wp-content/uploads/2016/08/7-35-768x405.png 768w, http://www.mottoin.com/wp-content/uploads/2016/08/7-35-1024x539.png 1024w" sizes="(max-width: 1775px) 100vw, 1775px" /></p>
<p><img class="alignnone size-full wp-image-88199 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/8-33.png" alt="8" width="1920" height="1040" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/8-33.png 1920w, http://www.mottoin.com/wp-content/uploads/2016/08/8-33-300x163.png 300w, http://www.mottoin.com/wp-content/uploads/2016/08/8-33-768x416.png 768w, http://www.mottoin.com/wp-content/uploads/2016/08/8-33-1024x555.png 1024w" sizes="(max-width: 1920px) 100vw, 1920px" /></p>
<p>1.memcpy移到了if之外.</p>
<p>2.条件中判断src长度,为真,释放BSTR指针.</p>
<p><img class="alignnone size-full wp-image-88200 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/9-28.png" alt="9" width="1330" height="919" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/9-28.png 1330w, http://www.mottoin.com/wp-content/uploads/2016/08/9-28-300x207.png 300w, http://www.mottoin.com/wp-content/uploads/2016/08/9-28-768x531.png 768w, http://www.mottoin.com/wp-content/uploads/2016/08/9-28-1024x708.png 1024w" sizes="(max-width: 1330px) 100vw, 1330px" /></p>
<p>3.去掉了原本申请字符串指针后直接进行memcpy的代码,新增了长度判断的代码块.cmp eax,edx</p>
<p>4.航母f5:</p>
<pre class="">v8 = SysAllocStringLen(&amp;v3[v6], v4);
 v24 = v8;
 v27 = -1;
 v38 = 0;
 if ( sub_100171F7(v29, 2, &amp;v27) &lt; 0
 || (memset(&amp;v30, 0, 0x228u),
 memset(v37, 0, 0x200u),
 v28 = 0,
 sub_100171BB((int)v29, 17563701, &amp;v28),
 v9 = SysStringLen(v8),
 v10 = v9,
 v9 &gt;= 256) )
 {
 SysFreeString(v8);
 return -2147467259;
 }
 memcpy(v37, v8, 2 * v9);
 v11 = v28;
 v12 = SysStringLen(v28);
 if ( v12 &lt;= 0 )
 goto LABEL_24;
 v13 = 0;
 if ( *v11 == 32 )
 {
 do
 ++v13;
 while ( v11[v13] == 32 );
 }
 for ( j = &amp;v11[v12 - 1]; *j == 32; --j )
 --v12;
 v15 = SysAllocStringLen(&amp;v11[v13], v12);
 v16 = v15;
 v32 = v10 + 1;
 v17 = SysStringLen(v15);
 if ( v17 &lt; 256 - v32 )
 {
 memcpy(&amp;v37[2 * v32], v16, 2 * v17);
 SysFreeString(v16);
 ...</pre>
<h2>0x03referer:</h2>
<blockquote data-secret="xpDZfp3MyA" class="wp-embedded-content"><p><a href="https://www.rcesecurity.com/2013/11/cve-2013-3934-kingsoft-office-writer-v2012-8-1-0-3385-buffer-overflow-safeseh-bypass-exploit/">CVE-2013-3934: Kingsoft Office Writer v2012 8.1.0.3385 Buffer Overflow SafeSEH Bypass Exploit</a></p></blockquote>
<p><iframe class="wp-embedded-content" sandbox="allow-scripts" security="restricted" style="position: absolute; clip: rect(1px, 1px, 1px, 1px);" src="https://www.rcesecurity.com/2013/11/cve-2013-3934-kingsoft-office-writer-v2012-8-1-0-3385-buffer-overflow-safeseh-bypass-exploit/embed/#?secret=xpDZfp3MyA" data-secret="xpDZfp3MyA" width="500" height="282" title="&#8220;CVE-2013-3934: Kingsoft Office Writer v2012 8.1.0.3385 Buffer Overflow SafeSEH Bypass Exploit&#8221; &#8212; RCE Security" frameborder="0" marginwidth="0" marginheight="0" scrolling="no"></iframe></p>
<h2>0x04后话</h2>
<p>如有不当之处,欢迎诸君批评、斧正</p>
<p>&nbsp;</p>
<p style="text-align: center;">*作者：<a href="http://www.ohvirus.com/1.code/2016-08-24-wps-stack-overflow-anlayze.html">pr0mise </a> Mottoin整理发布</p>
                                                        <div class="entry-copyright"><p>原创文章，作者：Moto，如若转载，请注明出处：http://www.mottoin.com/88191.html</p></div>                        </div>
                        <div class="entry-footer">
                            <div class="entry-tag"><a href="http://www.mottoin.com/tag/cve-2013-3934" rel="tag">CVE-2013-3934</a><a href="http://www.mottoin.com/tag/exp" rel="tag">exp</a><a href="http://www.mottoin.com/tag/wps" rel="tag">Wps</a><a href="http://www.mottoin.com/tag/%e6%a0%88%e6%ba%a2%e5%87%ba" rel="tag">栈溢出</a><a href="http://www.mottoin.com/tag/%e6%bc%8f%e6%b4%9e%e5%88%86%e6%9e%90" rel="tag">漏洞分析</a></div>
                            <div class="entry-action">
                                <div class="btn-zan" data-id="88191"><i class="fa fa-thumbs-up"></i> 赞 <span class="entry-action-num">(0)</span></div>

                                
                            </div>
                            <div class="entry-bar">
                                <div class="entry-bar-inner clearfix">
                                                                            <div class="author pull-left">
                                            <a data-user="7" target="_blank" href="http://www.mottoin.com/user/seceditor/" class="avatar">
                                                <img src="http://gravatar.com/avatar/?s=400&d=mm" class="func-um_user gravatar avatar avatar-60 um-avatar um-avatar-gravatar" width="60" height="60" alt="Moto" />                                                Moto                                            </a>
                                            <span class="author-title">普通用户</span>                                         </div>
                                                                        <div class="info pull-right">
                                        <div class="info-item meta">
                                            <a class="meta-item j-heart" href="javascript:;" data-id="88191"><i class="fa fa-heart"></i> <span class="data">0</span></a>
                                            <a class="meta-item" href="#comments"><i class="fa fa-comment"></i> <span class="data">0</span></a>
                                                                                    </div>
                                        <div class="info-item share">
                                            <a class="meta-item" href="javascript:;">
                                                <i class="fa fa-wechat"></i>
                                                <span class="wx-wrap">
                                                    <img src="//pan.baidu.com/share/qrcode?w=320&h=320&url=http://www.mottoin.com/88191.html">
                                                    <span>扫码分享到微信</span>
                                                </span>
                                            </a>
                                            <a class="meta-item" href="http://share.baidu.com/s?type=text&searchPic=1&sign=on&to=tsina&key=&url=http%3A%2F%2Fwww.mottoin.com%2F88191.html&title=CVE-2013-3934+Wps%E6%A0%88%E6%BA%A2%E5%87%BA%E5%88%86%E6%9E%90" target="_blank"><i class="fa fa-weibo"></i></a>
                                            <a class="meta-item" href="http://share.baidu.com/s?type=text&searchPic=1&sign=on&to=qzone&key=&url=http%3A%2F%2Fwww.mottoin.com%2F88191.html&title=CVE-2013-3934+Wps%E6%A0%88%E6%BA%A2%E5%87%BA%E5%88%86%E6%9E%90" target="_blank"><i class="fa fa-qq"></i></a>
                                        </div>
                                        <div class="info-item act">
                                            <a href="javascript:;" id="j-reading"><i class="fa fa-file-text"></i></a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                                                        <h3 class="entry-related-title">相关推荐</h3><ul class="entry-related clearfix"><li><a href="http://www.mottoin.com/90147.html" title="CTF解题分享-MP3音频隐写&#038;0ops官网Flag&#038;逆向路由器固件">CTF解题分享-MP3音频隐写&#038;0ops官网Flag&#038;逆向路由器固件</a></li><li><a href="http://www.mottoin.com/88358.html" title="Osx Apache Code To Reveal CVE-2013-0966 漏洞分析">Osx Apache Code To Reveal CVE-2013-0966 漏洞分析</a></li><li><a href="http://www.mottoin.com/85378.html" title="逆向分析：面试Tencent的简单笔试题">逆向分析：面试Tencent的简单笔试题</a></li><li><a href="http://www.mottoin.com/88278.html" title="Linux简单内核栈溢出调试分析">Linux简单内核栈溢出调试分析</a></li><li><a href="http://www.mottoin.com/88447.html" title="逆向分享 – Reversing.Kr (1)">逆向分享 – Reversing.Kr (1)</a></li><li><a href="http://www.mottoin.com/104594.html" title="“灵隐”木马黑吃灰：绑架数十款游戏外挂实现恶意推广">“灵隐”木马黑吃灰：绑架数十款游戏外挂实现恶意推广</a></li><li><a href="http://www.mottoin.com/95759.html" title="浏览器漏洞利用学习篇之 Internet Explorer 11（上）">浏览器漏洞利用学习篇之 Internet Explorer 11（上）</a></li><li><a href="http://www.mottoin.com/86919.html" title="浅谈 iOS 关键代码的混淆">浅谈 iOS 关键代码的混淆</a></li><li><a href="http://www.mottoin.com/84388.html" title="CVE-2016-4203分析：Adobe Acrobat和Reader 的CoolType处理导致的堆溢出漏洞">CVE-2016-4203分析：Adobe Acrobat和Reader 的CoolType处理导致的堆溢出漏洞</a></li><li><a href="http://www.mottoin.com/90842.html" title="MS08-067蠕虫样本“分析”">MS08-067蠕虫样本“分析”</a></li></ul>                        </div>
                        
<div id="comments" class="entry-comments">
    	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">发表评论 <small><a rel="nofollow" id="cancel-comment-reply-link" href="/88191.html#respond" style="display:none;">取消回复</a></small></h3><div class="comment-form"><div class="comment-must-login">请登录后评论...</div><div class="form-submit"><div class="form-submit-text pull-left"><a href="http://www.mottoin.com/login">登录</a>后才能评论</div> <input name="submit" type="submit" id="must-submit" class="submit" value="发表"></div></div>	</div><!-- #respond -->
		</div><!-- .comments-area -->                    </div>
                </article>
                    </div>
        <aside class="sidebar">
            <div id="profile-3" class="widget widget_profile">                <div class="cover_photo"></div>
                        <div class="avatar-wrap">
                <a target="_blank" href="http://www.mottoin.com/user/seceditor/" class="avatar-link"><img src="http://gravatar.com/avatar/?s=400&d=mm" class="func-um_user gravatar avatar avatar-120 um-avatar um-avatar-gravatar" width="120" height="120" alt="Moto" /></a></div>
            <div class="profile-info">
                <p><span class="author-name">Moto</span><span class="author-title">普通用户</span></p>
                <p class="author-description"></p>
            </div>
            <div class="profile-posts">
                <h3 class="widget-title"><span>最近文章</span></h3>
                <ul>                    <li><a href="http://www.mottoin.com/101279.html" title="Windows内核漏洞发现与利用">Windows内核漏洞发现与利用</a></li>
                                    <li><a href="http://www.mottoin.com/100495.html" title="浏览器信息收集: 利用 PowerShell 无文件读取 Chrome Cookie">浏览器信息收集: 利用 PowerShell 无文件读取 Chrome Cookie</a></li>
                                    <li><a href="http://www.mottoin.com/99735.html" title="一键无文件感染技术分析">一键无文件感染技术分析</a></li>
                                    <li><a href="http://www.mottoin.com/99776.html" title="APT10：中国黑客组织攻击全球IT服务供应商">APT10：中国黑客组织攻击全球IT服务供应商</a></li>
                                    <li><a href="http://www.mottoin.com/99257.html" title="IIS 6.0 WebDAV远程代码执行（CVE-2017-7269）">IIS 6.0 WebDAV远程代码执行（CVE-2017-7269）</a></li>
                </ul>            </div>
            </div><div id="custom_html-3" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><a class="btn-post" href="/question"><i class="fa fa-edit"></i> 我要提问</a></div></div><div id="post-thumb-3" class="widget widget_post_thumb">            <ul>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105921.html" title="“黑客反击”的合法化之争">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/170918-Cox-The-Hackers-Hitting-Back-At-Cybercriminals-hero_vkcor5-480x300.gif" width="480" height="300" alt="“黑客反击”的合法化之争">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105921.html" title="“黑客反击”的合法化之争">“黑客反击”的合法化之争</a></p>
                            <p class="item-date">2017年9月20日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105917.html" title="美参议员要求电信巨头们回应SS7信令系统的安全问题">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG929-480x300.jpeg" width="480" height="300" alt="美参议员要求电信巨头们回应SS7信令系统的安全问题">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105917.html" title="美参议员要求电信巨头们回应SS7信令系统的安全问题">美参议员要求电信巨头们回应SS7信令系统的安全问题</a></p>
                            <p class="item-date">2017年9月19日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105914.html" title="美国国土安全部发布禁止使用卡巴斯基产品的明细">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG928-480x300.jpeg" width="480" height="300" alt="美国国土安全部发布禁止使用卡巴斯基产品的明细">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105914.html" title="美国国土安全部发布禁止使用卡巴斯基产品的明细">美国国土安全部发布禁止使用卡巴斯基产品的明细</a></p>
                            <p class="item-date">2017年9月19日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105885.html" title="【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG906-480x300.jpeg" width="480" height="300" alt="【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105885.html" title="【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）">【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）</a></p>
                            <p class="item-date">2017年9月19日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105879.html" title="全球首款网络安全概念车驶入上海滩">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15057198871-480x300.png" width="480" height="300" alt="全球首款网络安全概念车驶入上海滩">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105879.html" title="全球首款网络安全概念车驶入上海滩">全球首款网络安全概念车驶入上海滩</a></p>
                            <p class="item-date">2017年9月18日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105872.html" title="暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG897-480x300.jpeg" width="480" height="300" alt="暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105872.html" title="暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3">暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3</a></p>
                            <p class="item-date">2017年9月18日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105865.html" title="美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG896-480x300.jpeg" width="480" height="300" alt="美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105865.html" title="美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁">美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁</a></p>
                            <p class="item-date">2017年9月18日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105858.html" title="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG150-480x300.jpeg" width="480" height="300" alt="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105858.html" title="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护</a></p>
                            <p class="item-date">2017年9月17日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG141-480x300.jpeg" width="480" height="300" alt="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场</a></p>
                            <p class="item-date">2017年9月16日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105837.html" title="黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG132-480x300.jpeg" width="480" height="300" alt="黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105837.html" title="黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协">黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协</a></p>
                            <p class="item-date">2017年9月16日</p>
                        </div>
                    </li>
                            </ul>
        </div><div id="lastest-products-4" class="widget widget_lastest_products">            <ul class="p-list clearfix">
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105921.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/170918-Cox-The-Hackers-Hitting-Back-At-Cybercriminals-hero_vkcor5-480x300.gif" width="480" height="300" alt="“黑客反击”的合法化之争">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105921.html" title="“黑客反击”的合法化之争">
                                    “黑客反击”的合法化之争                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105858.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG150-480x300.jpeg" width="480" height="300" alt="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105858.html" title="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">
                                    DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105847.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG141-480x300.jpeg" width="480" height="300" alt="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">
                                    国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105799.html">
                                <img width="480" height="300" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" class="attachment-post-thumbnail size-post-thumbnail j-lazy wp-post-image" alt="暗网系列之：“入店行窃者”的工具、战术和克星" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15054708381-150x150-480x300.png" />                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105799.html" title="暗网系列之：“入店行窃者”的工具、战术和克星">
                                    暗网系列之：“入店行窃者”的工具、战术和克星                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105703.html">
                                <img width="480" height="300" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" class="attachment-post-thumbnail size-post-thumbnail j-lazy wp-post-image" alt="【现场还原】补天漏洞情报发布会记事" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG82-150x150-480x300.jpeg" />                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105703.html" title="【现场还原】补天漏洞情报发布会记事">
                                    【现场还原】补天漏洞情报发布会记事                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105692.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG75-480x300.jpeg" width="480" height="300" alt="SyScan360看点回顾：中美德俄等七国黑客专家神技大比拼">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105692.html" title="SyScan360看点回顾：中美德俄等七国黑客专家神技大比拼">
                                    SyScan360看点回顾：中美德俄等七国黑客专家神技大比拼                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105642.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG58-480x300.jpeg" width="480" height="300" alt="大安全时代序幕开启！ 中国互联网安全大会重新定义网络安全">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105642.html" title="大安全时代序幕开启！ 中国互联网安全大会重新定义网络安全">
                                    大安全时代序幕开启！ 中国互联网安全大会重新定义网络安全                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105621.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG512-480x300.jpeg" width="480" height="300" alt="【重磅推出】ISC大会补天漏洞情报服务发布会：英雄，你准备好了吗？">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105621.html" title="【重磅推出】ISC大会补天漏洞情报服务发布会：英雄，你准备好了吗？">
                                    【重磅推出】ISC大会补天漏洞情报服务发布会：英雄，你准备好了吗？                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105629.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG49-480x300.jpeg" width="480" height="300" alt="ISC直击：360守护者计划登陆ISC 最强白帽挑战黑客马拉松大奖赛">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105629.html" title="ISC直击：360守护者计划登陆ISC 最强白帽挑战黑客马拉松大奖赛">
                                    ISC直击：360守护者计划登陆ISC 最强白帽挑战黑客马拉松大奖赛                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105603.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG42-480x300.jpeg" width="480" height="300" alt="【ISC2017精彩剪辑】周鸿祎：大安全时代 网络空间防御刻不容缓">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105603.html" title="【ISC2017精彩剪辑】周鸿祎：大安全时代 网络空间防御刻不容缓">
                                    【ISC2017精彩剪辑】周鸿祎：大安全时代 网络空间防御刻不容缓                                </a>
                            </h4>
                        </div>
                    </li>
                            </ul>
        </div>        </aside>
    </div>
<div class="modal" id="login-modal">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                <h4 class="modal-title">请登录</h4>
            </div>
            <div class="modal-body login-modal-body">
                <p>您还未登录，请登录后再进行相关操作！</p>
                <div class="login-btn">
                    <a class="btn btn-login" href="http://www.mottoin.com/login">登 录</a>
                    <a class="btn btn-register" href="http://www.mottoin.com/register">注 册</a>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
<footer class="footer">
    <div class="container">
        <div class="clearfix">
                        <div class="footer-col footer-col-logo">
                <img src="http://www.mottoin.com/img/mottoin/tmxk.png" alt="MottoIN">
            </div>
                        <div class="footer-col footer-col-copy">
                <ul class="footer-nav hidden-xs"><li id="menu-item-104182" class="menu-item menu-item-104182"><a href="http://www.mottoin.com/about">关于我们</a></li>
<li id="menu-item-104181" class="menu-item menu-item-104181"><a href="http://www.mottoin.com/dis">免责声明</a></li>
<li id="menu-item-104183" class="menu-item menu-item-104183"><a href="http://www.mottoin.com/joinus">加入我们</a></li>
<li id="menu-item-105509" class="menu-item menu-item-105509"><a href="http://www.mottoin.com/contact">联系我们</a></li>
<li id="menu-item-104184" class="menu-item menu-item-104184"><a href="http://www.mottoin.com/report">寻求报道</a></li>
<li id="menu-item-104185" class="menu-item menu-item-104185"><a href="http://www.mottoin.com/contribute">我要投稿</a></li>
</ul>                <div class="copyright">
                    Copyright © 2017 MottoIN 版权所有 <a href="http://www.miibeian.gov.cn/">沪ICP备16010654号-5</a>  <img class="alignnone " src="http://www.mottoin.com/img/mottoin/ga.png" width="16" height="16" /> <a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31010402001331">沪公网安备31010402001331号</a>                 </div>
            </div>
            <div class="footer-col footer-col-sns">
                <div class="footer-sns">
                                                                                    <a class="sns-wx" href="javascript:;">
                            <i class="fa fa-weixin"></i>
                            <span style="background-image:url(http://www.mottoin.com/img/mottoin/weixin.jpg);"></span>
                        </a>
                                                                <a target="_blank" href="http://weibo.com/mottoin" rel="nofollow"><i class="fa fa-weibo"></i></a>
                                                                <a target="_blank" href="http://weibo.com/mottoin" rel="nofollow"><i class="fa fa-tencent-weibo"></i></a>
                                                                                                                                                                                </div>
            </div>
        </div>
    </div>
</footer>
<div class="action" style="top:50%;">
            <div class="a-box contact">
            <div class="contact-wrap">
                <h3 class="contact-title">联系我们</h3>
                <h4 style="text-align: center;"><span style="color: #2d6ded;"><strong>021-62666911</strong></span></h4>
<p>在线咨询：<a href="http://wpa.qq.com/msgrd?uin=19539638" target="_blank" rel="noopener"><img class="alignnone" title="点击这里给我发消息" src="http://wpa.qq.com/pa?p=2:1666839010:51" alt="点击这里给我发消息" border="0" /></a></p>
<p>邮件：root@mottoin.com</p>
<p>工作时间：周一至周五，9:30-18:30，节假日休息</p>
            </div>
        </div>
                <div class="a-box wechat">
            <div class="wechat-wrap">
                <img src="http://www.mottoin.com/img/mottoin/weixin.jpg" alt="QR code">
            </div>
        </div>
            <div class="a-box gotop" id="j-top" style="display: none;"></div>
</div>
<style>.footer{padding-bottom: 35px;}</style><div id="um_upload_single" style="display:none">
	
</div><div id="um_view_photo" style="display:none">

	<a href="#" data-action="um_remove_modal" class="um-modal-close"><i class="um-faicon-times"></i></a>
	
	<div class="um-modal-body photo">
	
		<div class="um-modal-photo">

		</div>

	</div>
	
</div><script type='text/javascript'>
/* <![CDATA[ */
var _wpcom_js = {"ajaxurl":"http:\/\/www.mottoin.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/themes/JustNews/js/main.js?ver=2.3.2'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/comment-reply.min.js?ver=4.8.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpcom_qa_js = {"ajaxurl":"http:\/\/www.mottoin.com\/wp-admin\/admin-ajax.php","ajaxloading":"http:\/\/www.mottoin.com\/wp-content\/plugins\/wpcom-qa\/images\/loading.gif"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/plugins/wpcom-qa/js/scripts.min.js?ver=1.0'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/imagesloaded.min.js?ver=3.2.0'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/masonry.min.js?ver=3.3.2'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/jquery/jquery.masonry.min.js?ver=3.1.2b'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var um_scripts = {"ajaxurl":"http:\/\/www.mottoin.com\/wp-admin\/admin-ajax.php","fileupload":"http:\/\/www.mottoin.com\/wp-content\/plugins\/ultimate-member\/core\/lib\/upload\/um-file-upload.php","imageupload":"http:\/\/www.mottoin.com\/wp-content\/plugins\/ultimate-member\/core\/lib\/upload\/um-image-upload.php"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/plugins/ultimate-member/assets/js/um.min.js?ver=10.3.88'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/plugins/ultimate-member/assets/js/pickadate/translations/zh_CN.js?ver=10.3.88'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/wp-embed.min.js?ver=4.8.1'></script>

		<script type="text/javascript">jQuery( '#request' ).val( '' );</script>

	    <script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":["mshare","tsina","weixin","qzone","sqq","douban","fbook","twi","bdhome","tqq","tieba","mail","youdao","print"],"bdPic":"","bdStyle":"1","bdSize":"16"},"share":[{"tag" : "single", "bdSize" : 16}, {"tag" : "global","bdSize" : 16,bdPopupOffsetLeft:-227}],url:'http://www.mottoin.com/wp-content/themes/JustNews'};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://www.mottoin.com/wp-content/themes/JustNews/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
</body>
</html>