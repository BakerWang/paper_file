<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
    <title>McAfee for Linux Vulnerability Writeup | MottoIN</title>
    <link rel='dns-prefetch' href='//www.mottoin.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="MottoIN &raquo; McAfee for Linux Vulnerability Writeup评论Feed" href="http://www.mottoin.com/94066.html/feed" />
<link rel='stylesheet' id='stylesheet-css'  href='http://www.mottoin.com/wp-content/themes/JustNews/css/style.css?ver=2.3.2' type='text/css' media='all' />
<link rel='stylesheet' id='wpcom-qa-css'  href='http://www.mottoin.com/wp-content/plugins/wpcom-qa/css/style.css?ver=1.0' type='text/css' media='all' />
<style id='wpcom-qa-inline-css' type='text/css'>

        .q-content .topic-tab,.q-content .q-answer .as-user,.q-content .q-answer .as-comment-name{color: #1471CA;}
        .q-content .q-topic-wrap a:hover,.q-content .q-answer .as-action a:hover,.q-content .topic-tab:hover{color:#0D62B3;}
        .q-content .put-top,.q-content .topic-tab.current-tab,.q-content .q-answer .as-submit .btn-submit,.q-content .q-answer .as-comments-submit,.q-content .q-add-header .btn-post,.q-content .q-pagination .current{background-color:#1471CA;}
        .q-content .q-answer .as-submit .btn-submit:hover,.q-content .q-answer .as-comments-submit:hover,.q-content .q-add-header .btn-post:hover,.q-content .topic-tab.current-tab:hover,.q-content .q-pagination a:hover{background-color:#0D62B3;}
        .q-content .q-answer .as-comments-input:focus{border-color: #1471CA;}
        
</style>
<link rel='stylesheet' id='um_minified-css'  href='http://www.mottoin.com/wp-content/plugins/ultimate-member/assets/css/um.min.css?ver=10.3.88' type='text/css' media='all' />
<script type='text/javascript' src='http://www.mottoin.com/wp-content/themes/JustNews/js/jquery.min.js?ver=1.12.4'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.mottoin.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.mottoin.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='n0js case1 writeup' href='http://www.mottoin.com/94105.html' />
<link rel='next' title='AddThis Widget 调用 PostMessage API 导致上百万网站存在 XSS 漏洞' href='http://www.mottoin.com/94130.html' />
<link rel='shortlink' href='http://www.mottoin.com/?p=94066' />
<!--  WPCOM主题相关信息开始 -->
<meta name="applicable-device" content="pc,mobile">
<meta http-equiv="Cache-Control" content="no-transform">
<meta name="keywords" content="CVE-2016-8016,CVE-2016-8017,CVE-2016-8018,CVE-2016-8019,CVE-2016-8020,CVE-2016-8021,CVE-2016-8022,CVE-2016-8023,CVE-2016-8024,CVE-2016-8025,HTTP响应拆分,McAfeeVirusScan Linux企业版,SQL注入漏洞,Web接口允许在已知地址写入任意文件,无跨站请求伪造（CSRF）验证令牌,暴力破解身份验证令牌,未经验证的文件远程读取漏洞（受限）,未经验证的远程文件探测漏洞,跨站脚本攻击（XSS）,远程代码执行&amp;特权提升漏洞（提权）,远程使用身份验证令牌">
<meta name="description" content="概述McAfeeVirusScanLinux企业版中存在大量的安全漏洞，这些漏洞可能会受到远程攻击者的攻击。另外，其中一些漏洞可以被攻击者结合起来利用（组成漏洞利用链），以root身份执行远程代码。影响版本v1.9.2（发布2/19/2015）到v2.0.2（发布时间4/22/16）版本的产品均受影响，与旧版本的唯一区别是更新到新的版本库，新版本更容易利用这些漏洞。Timeline2016年6月2">
<!--  WPCOM主题相关信息结束 -->
 
		<script type="text/javascript">

		var ultimatemember_image_upload_url = 'http://www.mottoin.com/wp-content/plugins/ultimate-member/core/lib/upload/um-image-upload.php';
		var ultimatemember_file_upload_url = 'http://www.mottoin.com/wp-content/plugins/ultimate-member/core/lib/upload/um-file-upload.php';
		var ultimatemember_ajax_url = 'http://www.mottoin.com/wp-admin/admin-ajax.php';

		</script>

	
		<style type="text/css">.request_name { display: none !important; }</style>

	<link rel="icon" href="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-32x32.jpg" sizes="32x32" />
<link rel="icon" href="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-192x192.jpg" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-180x180.jpg" />
<meta name="msapplication-TileImage" content="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-270x270.jpg" />
    <style>
                a,.sec-panel-head span,.list.tabs .tab.active a,.header .nav>li.active>a,.header .dropdown-menu>.active>a,.entry .entry-info .nickname,.entry-bar-inner .author-title,.entry-action .btn-zan,.entry-action .btn-dashang,.comment-body .nickname,.form-submit-text span,.widget_profile .author-title,.um .um-profile-body .um-item-meta a,.login-modal-body .btn-register{color: #08c;}
        .header .dropdown-menu>li>a:hover,.header .dropdown-menu>.active>a:hover,.header .dropdown-menu>.active>a:focus,.navbar-action .publish,.pagination .current,.flex-control-paging li a.flex-active,.form-submit .submit,.sidebar .widget_nav_menu ul li.current-menu-item a,.sidebar .widget_nav_menu ul li.current-post-parent a,.search-form input.submit,.action .contact-title,.pf-submit,.tagHandler ul.tagHandlerContainer li.tagItem,.login-modal-body .btn-login,.woocommerce a.button,.woocommerce button.button,.woocommerce input.button,.woocommerce a.button.alt,.woocommerce button.button.alt,.woocommerce input.button.alt,.woocommerce a.button.alt.disabled,.woocommerce a.button.alt.disabled:hover,.woocommerce a.button.alt:disabled,.woocommerce a.button.alt:disabled:hover,.woocommerce a.button.alt:disabled[disabled],.woocommerce a.button.alt:disabled[disabled]:hover,.woocommerce button.button.alt.disabled,.woocommerce button.button.alt.disabled:hover,.woocommerce button.button.alt:disabled,.woocommerce button.button.alt:disabled:hover,.woocommerce button.button.alt:disabled[disabled],.woocommerce button.button.alt:disabled[disabled]:hover,.woocommerce input.button.alt.disabled,.woocommerce input.button.alt.disabled:hover,.woocommerce input.button.alt:disabled,.woocommerce input.button.alt:disabled:hover,.woocommerce input.button.alt:disabled[disabled],.woocommerce input.button.alt:disabled[disabled]:hover,.woocommerce .widget_price_filter .ui-slider .ui-slider-handle,.woocommerce .widget_price_filter .ui-slider .ui-slider-range,.shopping-count,.social-login-form .sl-input-submit{background-color: #08c;}
        .entry .entry-content h3,.entry .entry-content .h3,.widget-title{border-left-color: #08c;}
        .entry-bar-inner .author-title,.entry-action .btn-zan,.entry-action .btn-dashang,.search-form input.keyword:focus,.widget_profile .author-title,.login-modal-body .btn-login,.login-modal-body .btn-register{border-color: #08c;}
        .entry-bar-inner .author-title:before,.widget_profile .author-title:before{border-right-color: #08c;}
        .list.tabs .tab.active a{border-bottom-color: #08c;}

        a:hover,.header .nav>li>a:hover,.header .nav>li.active>a,.navbar-action .login:hover,.navbar-action .login:focus,.navbar-action .profile a:hover,.navbar-search-icon:hover,.navbar-search-icon:focus,.entry .entry-info a:hover,.entry .entry-info a:focus,.entry-bar .info-item a:hover,.p-item-wrap:hover .title a,.special-item-title a:hover,.special-item-bottom a:hover,.widget ul a:hover,.widget ol a:hover,.sec-panel-head .more:hover,.topic-list .topic-wrap:hover span,.tabs .tab a:hover,
        .article-list .item-title a:hover,.article-list .item-meta a:hover,.article-list .item-meta a:focus,.list-links a:hover,.list-links a:focus,.um .um-profile-body .um-item-meta a:hover,.um .um-profile-body .um-item-link a:hover,.load-more:hover,.login-modal-body .btn-register:hover{color: #07c;}
        .navbar-action .publish:hover,.navbar-action .publish:focus,.entry-tag a:hover,.entry-tag a:focus,.entry-action .btn-zan:hover,.entry-action .btn-dashang:hover,.entry-action .btn-zan.liked,.pagination a:hover,.flex-control-paging li a:hover,.form-submit .submit:hover,.widget .tagcloud a:hover,.sidebar .widget_nav_menu ul li.current-menu-item .sub-menu a:hover,.sidebar .widget_nav_menu ul li.current-post-parent .sub-menu a:hover,.sidebar .widget_nav_menu ul li a:hover,.search-form input.submit:hover,.action .a-box:hover,.footer-sns .fa:after,.article-list .item-category:hover,.pf-submit:hover,.tagHandler ul.tagHandlerContainer li.tagItem:hover,.login-modal-body .btn-login:hover,.woocommerce a.button:hover,.woocommerce button.button:hover,.woocommerce input.button:hover,.woocommerce a.button.alt:hover,.woocommerce button.button.alt:hover,.woocommerce input.button.alt:hover,.woocommerce .widget_price_filter .price_slider_wrapper .ui-widget-content,.social-login-form .sl-input-submit:hover{background-color: #07c;}
        .entry-tag a:hover,.entry-tag a:focus,.entry-action .btn-zan:hover,.entry-action .btn-dashang:hover,.entry-action .btn-zan.liked,.widget .tagcloud a:hover,.load-more:hover,.login-modal-body .btn-login:hover,.login-modal-body .btn-register:hover{border-color: #07c;}
        .special-item-bottom a:hover:before{border-left-color: #07c;}
        .list.tabs .tab.active a:hover{border-bottom-color: #07c;}
        @media (max-width: 991px){
            .header .navbar-nav>li.active>a,.header .navbar-nav .dropdown-menu .active a,.header .navbar-nav .dropdown-menu .active .dropdown-menu .active a{color: #08c;}
            .navbar-collapse{background-color: #08c;}
            .dropdown-menu>li a{border-color: #07c;}
            .header .navbar-nav>li.active>a:hover,.header .navbar-nav>li a:hover,.header .navbar-nav .dropdown-menu .active a:hover,.header .navbar-nav .dropdown-menu .active .dropdown-menu a:hover,.header .navbar-nav .dropdown-menu li a:hover{color: #07c;}
        }
        .j-share{position: fixed!important;top: 50%!important;}
                .header .logo img{max-height: 32px;}
                @media (max-width: 767px){
            .header .logo img{max-height: 26px;}
        }
                        .btn-post{
    display: block;
    margin: 0 auto;
    padding: 15px 20px;
    font-size: 16px;
    text-align: center;
    color: #fff !important;
    line-height: 1;
    background: #1471CA;
    -webkit-border-radius: 3px;
    border-radius: 3px;
    text-decoration: none;
    border: 0;
    outline: 0;
}    </style>
    <script> (function() {if (!/*@cc_on!@*/0) return;var e = "abbr, article, aside, audio, canvas, datalist, details, dialog, eventsource, figure, footer, header, hgroup, mark, menu, meter, nav, output, progress, section, time, video".split(', ');var i= e.length; while (i--){ document.createElement(e[i]) } })()</script>
    <!--[if lte IE 8]><script src="http://www.mottoin.com/wp-content/themes/JustNews/js/respond.min.js"></script><![endif]-->
</head>
<body class="post-template-default single single-post postid-94066 single-format-standard">
<header class="header">
    <div class="container clearfix">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar icon-bar-1"></span>
                <span class="icon-bar icon-bar-2"></span>
                <span class="icon-bar icon-bar-3"></span>
            </button>
            <a class="logo" href="http://www.mottoin.com"><img src="http://www.mottoin.com/img/mottoin/logo.png" alt="MottoIN"></a>
        </div>
        <div class="collapse navbar-collapse">
            <nav class="navbar-left primary-menu"><ul id="menu-%e5%af%bc%e8%88%aa" class="nav navbar-nav"><li class="menu-item menu-item-home"><a href="http://www.mottoin.com/">首页</a></li>
<li class="menu-item"><a href="http://www.mottoin.com/category/news">资讯</a></li>
<li class="menu-item current-post-ancestor dropdown"><a href="http://www.mottoin.com/category/article" class="dropdown-toggle">文章</a>
<ul role="menu" class=" dropdown-menu">
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/web">Web安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/system">系统安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/network">网络安全</a></li>
	<li class="menu-item current-post-ancestor current-menu-parent current-post-parent"><a href="http://www.mottoin.com/category/article/terminal">终端安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/database">数据安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/wireless">无线安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/social">社会工程</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/intranet">内网渗透</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/code">代码审计</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/reverse">逆向破解</a></li>
</ul>
</li>
<li class="menu-item"><a href="http://www.mottoin.com/category/tools">工具</a></li>
<li class="menu-item"><a href="http://www.mottoin.com/category/geek">极客</a></li>
<li class="menu-item dropdown"><a href="http://www.mottoin.com/category/sole" class="dropdown-toggle">独家</a>
<ul role="menu" class=" dropdown-menu">
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/topic">专题</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/people">人物</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/view">观点</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/events">活动</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/video">视频</a></li>
</ul>
</li>
<li class="menu-item"><a href="http://www.mottoin.com/category/hr">招聘</a></li>
<li class="menu-item"><a href="http://www.mottoin.com/forum">社区</a></li>
</ul></nav>            <div class="navbar-action pull-right">

                                    <form class="navbar-search" action="http://www.mottoin.com" method="get" role="search">
                        <input type="text" name="s" class="navbar-search-input" autocomplete="off" placeholder="输入关键词搜索..." value="">
                        <a class="navbar-search-icon j-navbar-search" href="javascript:;"></a>
                    </form>

                    
                    <div id="j-user-wrap">
                        <a class="login" href="http://www.mottoin.com/login">登录</a>
                        <a class="login" href="http://www.mottoin.com/register">注册</a>
                    </div>
                    <a class="publish" href="http://www.mottoin.com/post">
                        投稿</a>
                                                </div>
        </div><!-- /.navbar-collapse -->
    </div><!-- /.container -->
</header>
<div id="wrap">    <div class="main container">
        <div class="content">
                            <article id="post-94066" class="post-94066 post type-post status-publish format-standard has-post-thumbnail hentry category-terminal tag-cve-2016-8016 tag-cve-2016-8017 tag-cve-2016-8018 tag-cve-2016-8019 tag-cve-2016-8020 tag-cve-2016-8021 tag-cve-2016-8022 tag-cve-2016-8023 tag-cve-2016-8024 tag-cve-2016-8025 tag-http tag-mcafeevirusscan-linux tag-sql tag-web tag-csrf tag-2273 tag-2261 tag-2259 tag-xss tag-2267 tag-2271">
                    <div class="entry">
                        <div class="entry-head">
                            <h1 class="entry-title">McAfee for Linux Vulnerability Writeup</h1>
                            <div class="entry-info">
                                                                <a class="nickname" href="http://www.mottoin.com/user/seceditor/">Moto</a>
                                <span class="dot">•</span>
                                <span>2016年12月16日</span>
                                <span class="dot">•</span>
                                <a href="http://www.mottoin.com/category/article/terminal" rel="category tag">终端安全</a>                                                                    <span class="dot">•</span>
                                    <span>阅读 1466</span>
                                                            </div>
                        </div>
                                                                        <div class="entry-content clearfix">
                            <h2>概述</h2>
<p><a href="http://www.mcafee.com/us/products/virusscan-enterprise-for-linux.aspx">McAfeeVirusScan Linux企业版</a>中存在大量的安全漏洞，这些漏洞可能会受到远程攻击者的攻击。另外，其中一些漏洞可以被攻击者结合起来利用（组成漏洞利用链），以root身份执行远程代码。</p>
<h2>影响版本</h2>
<p>v1.9.2（发布2/19/2015）到v 2.0.2（发布时间4/22/16）版本的产品均受影响，与旧版本的唯一区别是更新到新的版本库，新版本更容易利用这些漏洞。</p>
<h2>Timeline</h2>
<ul>
<li>2016年6月23日：漏洞被上报给安全应急响应中心（CERT），漏洞的详细信息将会在8月23日正式对外披露；</li>
<li>2016年7月19日：McAfee要求推迟漏洞披露时间，暂定于9月份，但有可能要推迟到12月份；</li>
<li>2016年9月~2016年11月：McAfee公司没有任何回复；</li>
<li>2016年12月5日：McAfee发布通知说12月12日披露漏洞详情；</li>
<li>2016年12月9日：McAfee发布了<a href="https://kc.mcafee.com/corporate/index?page=content&amp;id=SB10181">安全公告</a>，并为漏洞分配了<a href="http://www.kb.cert.org/vuls/id/245327">CVE ID</a>；</li>
<li>2016年12月12日：发布漏洞分析报告，并对相应漏洞的细节进行了描述。</li>
</ul>
<h2>简介</h2>
<p>从总体来看，英特尔公司的McAfeeVirusScan Linux企业版拥有很多优秀的特性，而这些功能和特性是漏洞研究人员所喜爱的：它能够以root权限运行，它声称可以让你的系统更加安全，它并不是特别的流行，而且它看起来好像已经很久没更新了。当我注意到了这些特性之后，我打算仔细研究一下这款工具。</p>
<p>在对产品漏洞的细节进行分析之前，我们需要对这款产品的系统架构进行了解。</p>
<h3>服务</h3>
<p>这款产品包含两个单独的服务：其中一个以root权限运行，另一个以非特权用户（nails）运行。扫描程序的主服务以root权限运行，负责监听本地Unixsocket（/var/opt/NAI/LinuxShield/dev/nails_monitor）。Webserver则以nails用户权限运行，负责监听0.0.0:55443。</p>
<h3>进程间通信</h3>
<p>这个Webserver其实就是一个扫描服务的用户操作界面。当用户像webserver发送请求的时候，系统会重新对请求信息进行格式化，然后请求会被发送至root服务。处理完成之后，用户就可以在一个html网页中看到响应信息了。需要注意的是，这个web接口并不会对用户的输入数据进行限制，所以攻击者也可以向root服务发送恶意数据。</p>
<h2>漏洞列表</h2>
<p>下面是本文将要讨论的十个漏洞：</p>
<ol>
<li>CVE-2016-8016:未经验证的远程文件探测漏洞</li>
<li>CVE-2016-8017: 未经验证的文件远程读取漏洞（受限）</li>
<li>CVE-2016-8018: 无跨站请求伪造（CSRF）验证令牌</li>
<li>CVE-2016-8019: 跨站脚本攻击（XSS）</li>
<li>CVE-2016-8020: 远程代码执行&amp;特权提升漏洞（提权）</li>
<li>CVE-2016-8021: Web接口允许在已知地址写入任意文件</li>
<li>CVE-2016-8022: 远程使用身份验证令牌</li>
<li>CVE-2016-8023: 暴力破解身份验证令牌</li>
<li>CVE-2016-8024: HTTP响应拆分</li>
<li>CVE-2016-8025: SQL注入漏洞</li>
</ol>
<p>如果攻击者将这些漏洞结合起来利用，攻击者将可以root身份执行远程代码。</p>
<h2>0x1.CVE-2016-8016:未经验证的远程文件探测漏洞</h2>
<p><a href="http://www.mottoin.com/94066.html/burp_tasks_html" rel="attachment wp-att-94072"><img class="alignnone size-full wp-image-94072 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/12/burp_tasks_html.png" alt="burp_tasks_html" width="839" height="402" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/12/burp_tasks_html.png 839w, http://www.mottoin.com/wp-content/uploads/2016/12/burp_tasks_html-300x144.png 300w, http://www.mottoin.com/wp-content/uploads/2016/12/burp_tasks_html-768x368.png 768w" sizes="(max-width: 839px) 100vw, 839px" /></a></p>
<p>在对Web接口中的各个部分进行分析时，我们发现了tplt参数重指定了一个html文件的路径，大家可以在上图中看到，tplt参数中设置的是tasks.html。在web服务器上运行strace命令之后，我们可以得到这个被打开的html文件地址为/opt/NAI/LinuxShield/apache/htdocs/0409/tasks.html，具体如下图所示：</p>
<p><a href="http://www.mottoin.com/94066.html/strace_open_tasks_html" rel="attachment wp-att-94073"><img class="alignnone size-full wp-image-94073 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/12/strace_open_tasks_html.png" alt="strace_open_tasks_html" width="767" height="25" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/12/strace_open_tasks_html.png 767w, http://www.mottoin.com/wp-content/uploads/2016/12/strace_open_tasks_html-300x10.png 300w" sizes="(max-width: 767px) 100vw, 767px" /></a></p>
<p>如果tplt参数设置的是其他的页面，例如..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd（经过URL编码的字符串../../../../../../etc/passwrd），那么此时的响应信息将会是一个包含有错误变量（错误码为14）的页面。JavaScript函数lookupErrorCode会将error14映射为字符串“BadlyFormed Web Template.”。如果tplt变量设置成了一个不存在的相对地址，那么错误变量将会被设置为10，error10对应的则是“connot open file”。</p>
<p><a href="http://www.mottoin.com/94066.html/js_bad_template_vs_file" rel="attachment wp-att-94074"><img class="alignnone wp-image-94074 size-full j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/12/js_bad_template_vs_file.png" alt="js_bad_template_vs_file" width="212" height="93" /></a></p>
<p><a href="http://www.mottoin.com/94066.html/strace_no_file_vs_file" rel="attachment wp-att-94075"><img class="alignnone size-full wp-image-94075 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/12/strace_no_file_vs_file.png" alt="strace_no_file_vs_file" width="1362" height="80" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/12/strace_no_file_vs_file.png 1362w, http://www.mottoin.com/wp-content/uploads/2016/12/strace_no_file_vs_file-300x18.png 300w, http://www.mottoin.com/wp-content/uploads/2016/12/strace_no_file_vs_file-768x45.png 768w, http://www.mottoin.com/wp-content/uploads/2016/12/strace_no_file_vs_file-1024x60.png 1024w" sizes="(max-width: 1362px) 100vw, 1362px" /></a></p>
<p>如果系统上存在由给定名称的文件，则两个不同的错误消息可以向未授权的远程用户显示。</p>
<p>这将导致有效的Web模板（例如tasks.html）和无效的模板文件（例如/etc/passwd）之间有什么不同的问题呢？大家可以去思考一下这个问题。</p>
<h2>0x2. CVE-2016-8017: 未经验证的文件远程读取漏洞（受限）</h2>
<p>在对Webserver所使用的各种模版文件进行了分析之后，我们可以看到有效的模版文件会包含字符串“__REPLACE_THIS__”或者两个标签“[%”和“%]”，并且这两个标签中间还会有一个字符串（任意值）。</p>
<p>如果攻击者可以替换这些字符串，那么攻击者就可以利用webserver来远程读取目标主机中的文件了。不过在利用这个漏洞的过程中，攻击者只能以“nails”用户权限来读取文件。</p>
<h2>0x3.CVE-2016-8018: 无跨站请求伪造（CSRF）验证令牌</h2>
<p>Web接口中的所有表单都没带有CSRF验证令牌，当经过验证的用户访问了由攻击者控制的外部域名之后，攻击者就可以利用用户的合法信息来提交认证请求了。其实，在一款2016年发布的反病毒产品中看到这样一种最基础的漏洞，着实令人感到惊讶。</p>
<h2>0x4.CVE-2016-8019: 跨站脚本攻击（XSS）</h2>
<p>当tplt参数设置为NailsConfig.html或MonitorHost.html时，参数info:7和info:5将负责把不受信的用户输入数据以字符串的形式传递给JavaScript函数formatData()。通常情况下，info:7的值是一个字符串列表（例如single,show,serverUtcOffset=-25200）。其中的值将会被保存在一个字符串（单引号扩起来的）中，然后传递给formatData函数。如果参数info:7的值设置成了single’.prototype.constructor=eval(‘alert(“xss”‘))+’，那么eval函数将会在formatData函数被调用之前执行恶意的JavaScript代码。</p>
<p><a href="http://www.mottoin.com/94066.html/xss_req" rel="attachment wp-att-94079"><img class="alignnone size-full wp-image-94079 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/12/xss_req.png" alt="xss_req" width="628" height="206" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/12/xss_req.png 628w, http://www.mottoin.com/wp-content/uploads/2016/12/xss_req-300x98.png 300w" sizes="(max-width: 628px) 100vw, 628px" /></a></p>
<p><a href="http://www.mottoin.com/94066.html/xss_resp" rel="attachment wp-att-94080"><img class="alignnone size-full wp-image-94080 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/12/xss_resp.png" alt="xss_resp" width="653" height="474" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/12/xss_resp.png 653w, http://www.mottoin.com/wp-content/uploads/2016/12/xss_resp-300x218.png 300w" sizes="(max-width: 653px) 100vw, 653px" /></a></p>
<h2>0x5. CVE-2016-8020: 远程代码执行&amp;特权提升漏洞（提权）</h2>
<p>在开始对系统进行扫描之前，我们需要填写四个表单。</p>
<p style="text-align: center;"><a href="http://www.mottoin.com/94066.html/scan1" rel="attachment wp-att-94085"><img class="alignnone size-full wp-image-94085 aligncenter j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/12/scan1.png" alt="scan1" width="990" height="540" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/12/scan1.png 990w, http://www.mottoin.com/wp-content/uploads/2016/12/scan1-300x164.png 300w, http://www.mottoin.com/wp-content/uploads/2016/12/scan1-768x419.png 768w" sizes="(max-width: 990px) 100vw, 990px" /></a>表单一</p>
<p style="text-align: center;"><a href="http://www.mottoin.com/94066.html/scan2" rel="attachment wp-att-94086"><img class="alignnone size-full wp-image-94086 aligncenter j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/12/scan2.png" alt="scan2" width="988" height="358" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/12/scan2.png 988w, http://www.mottoin.com/wp-content/uploads/2016/12/scan2-300x109.png 300w, http://www.mottoin.com/wp-content/uploads/2016/12/scan2-768x278.png 768w" sizes="(max-width: 988px) 100vw, 988px" /></a>表单二<a href="http://www.mottoin.com/94066.html/scan3" rel="attachment wp-att-94088"><img class="alignnone size-full wp-image-94088 aligncenter j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/12/scan3.png" alt="scan3" width="971" height="572" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/12/scan3.png 971w, http://www.mottoin.com/wp-content/uploads/2016/12/scan3-300x177.png 300w, http://www.mottoin.com/wp-content/uploads/2016/12/scan3-768x452.png 768w" sizes="(max-width: 971px) 100vw, 971px" /></a>表单三</p>
<p style="text-align: center;"><a href="http://www.mottoin.com/94066.html/scan4" rel="attachment wp-att-94090"><img class="alignnone size-full wp-image-94090 aligncenter j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/12/scan4.png" alt="scan4" width="980" height="220" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/12/scan4.png 980w, http://www.mottoin.com/wp-content/uploads/2016/12/scan4-300x67.png 300w, http://www.mottoin.com/wp-content/uploads/2016/12/scan4-768x172.png 768w" sizes="(max-width: 980px) 100vw, 980px" /></a>表单四</p>
<p>提交了最后一个表单页面后，系统会向服务器发送大量请求。请求信息的部分参数如下所示：</p>
<p><a href="http://www.mottoin.com/94066.html/scan_props2" rel="attachment wp-att-94092"><img class="alignnone size-full wp-image-94092 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/12/scan_props2.png" alt="scan_props2" width="641" height="747" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/12/scan_props2.png 641w, http://www.mottoin.com/wp-content/uploads/2016/12/scan_props2-257x300.png 257w" sizes="(max-width: 641px) 100vw, 641px" /></a></p>
<p>nailsd.profile.ODS_9.scannerPath变量包含系统所要扫描的路径信息，将它的值修改为“/bin/sh”后，我们将会在web页面中看到下列错误信息：</p>
<p><a href="http://www.mottoin.com/94066.html/cmd_inject_err" rel="attachment wp-att-94095"><img class="alignnone size-full wp-image-94095 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/12/cmd_inject_err.png" alt="cmd_inject_err" width="605" height="51" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/12/cmd_inject_err.png 605w, http://www.mottoin.com/wp-content/uploads/2016/12/cmd_inject_err-300x25.png 300w" sizes="(max-width: 605px) 100vw, 605px" /></a></p>
<p>运行strace命令后我们可以看到，这个参数被一个以root权限运行的进程直接传递给execve函数。</p>
<p><a href="http://www.mottoin.com/94066.html/strace_execve" rel="attachment wp-att-94098"><img class="alignnone size-full wp-image-94098 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/12/strace_execve.png" alt="strace_execve" width="677" height="127" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/12/strace_execve.png 677w, http://www.mottoin.com/wp-content/uploads/2016/12/strace_execve-300x56.png 300w" sizes="(max-width: 677px) 100vw, 677px" /></a></p>
<p>通过修改这个变量的值，经过认证的用户可以通过root用户权限来执行任意代码，攻击者还可以配合其他的XSS或CSRF漏洞来进行攻击。</p>
<p>这个不能轻易地扩展到任意代码执行，因为有多个参数传递需要给二进制。但是，scannerPath变量不是从webserver直接传递给execve的唯一变量; 而一些值是硬编码的，四个完全被攻击者控制的变量导致以下命令：</p>
<pre>[scannerPath] –e [enginePath] –D [datPath] –L [engineLibDir] –p 21 –i 2 –I 0</pre>
<p>利用这个的一个向量是/bin/sh，它将加载由-e参数指定的shell脚本并执行它。本地用户可以使用此来升级权限，但远程攻击者需要以其他方法将恶意shell脚本放置到系统上。</p>
<h2>0x6.CVE-2016-8021: Web接口允许在已知地址写入任意文件</h2>
<p>Web界面允许用户指定一台更新服务器，并向这台服务器请求更新。如果远程用户需要向系统写入文件的话，通过这个功能可以实现。</p>
<p>为了解这个更新服务器的工作机制，我在本地克隆了一份McAfee的更新代码库，然后重新设置了服务器，让系统从我的服务器下载更新。</p>
<p><a href="http://www.mottoin.com/94066.html/repos" rel="attachment wp-att-94104"><img class="alignnone size-full wp-image-94104 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/12/repos.png" alt="repos" width="1360" height="210" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/12/repos.png 1360w, http://www.mottoin.com/wp-content/uploads/2016/12/repos-300x46.png 300w, http://www.mottoin.com/wp-content/uploads/2016/12/repos-768x119.png 768w, http://www.mottoin.com/wp-content/uploads/2016/12/repos-1024x158.png 1024w" sizes="(max-width: 1360px) 100vw, 1360px" /></a></p>
<p>在更新过程中系统会发出两个请求（/SiteStat.xml和/catalog.z）。SiteStat文件是一个标准的XML文件，记录了网站的运行状态和一些基本信息。catelog.z文件貌似是一个<a href="http://www.mcafee.com/us/downloads/endpoint-protection/products/epolicy-orchestrator.aspx">McAfeeePolicy Orchestrator文件</a>，文件中大多是一些二进制数据。我之前认为，系统会对更新包进行签名认证，所以我们无法通过向目标系统推送恶意更新来完成攻击。但是，我打算利用这个功能来向目标系统发送一个shell脚本，然后利用之前的一些漏洞来完成攻击。</p>
<p>我们可以从日志文件中了解到具体的更新步骤：下载文件、验证文件完整性、解压缩和完成安装。</p>
<p><a href="http://www.mottoin.com/94066.html/downloading_update" rel="attachment wp-att-94106"><img class="alignnone size-full wp-image-94106 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/12/downloading_update.png" alt="downloading_update" width="528" height="496" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/12/downloading_update.png 528w, http://www.mottoin.com/wp-content/uploads/2016/12/downloading_update-300x282.png 300w" sizes="(max-width: 528px) 100vw, 528px" /></a></p>
<p>因为它不是一个单线程程序，所以我们可以利用这个逻辑让程序下载一个大文件并保存在/opt/McAfee/cma/scratch/update/catalog.z，然后在下载完成之前或者在开始验证之前利用漏洞5来执行我们的恶意脚本。</p>
<p>结合漏洞5和漏洞6，攻击者就可以实现提权了，即从nails用户权限提升为root权限。除此之外，攻击者还可以利用CSRF或XSS来利用这些漏洞实现远程提权。</p>
<h2>0x7.CVE-2016-8022: 远程使用身份验证令牌</h2>
<p>为了利用XSS和CSRF漏洞，我们需要从目标主机中窃取已认证用户的cookie数据。但是当我在自己的“攻击”设备上使用这些cookie来进行身份验证时，却发现验证失效了：</p>
<p><a href="http://www.mottoin.com/94066.html/bad_creds" rel="attachment wp-att-94109"><img class="alignnone size-full wp-image-94109 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/12/bad_creds.png" alt="bad_creds" width="960" height="264" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/12/bad_creds.png 960w, http://www.mottoin.com/wp-content/uploads/2016/12/bad_creds-300x83.png 300w, http://www.mottoin.com/wp-content/uploads/2016/12/bad_creds-768x211.png 768w" sizes="(max-width: 960px) 100vw, 960px" /></a></p>
<p>我在原始设备上再一次对这些令牌进行了验证，所以我认为认证令牌很可能会对用户的IP地址进行限制。这也就使得我们的漏洞利用过程更加困难了，但是我们仍然可以在目标用户的浏览器中使用JavaScript脚本来利用XSS漏洞实施攻击。</p>
<p>当用户通过网站来进行身份验证时，认证消息会通过一个unix-socket发送至root服务。root服务会对认证消息进行验证，然后将验证结果返回给Webserver。为了弄清楚我的cookie到底出了什么问题，我使用了socat来拦截这些socket信息。</p>
<p>下面的脚本重启了nails并拦截socket上的所有通信：</p>
<pre>#!/bin/bash 
_restore() {
    mv /var/opt/NAI/LinuxShield/dev/nails_monitor{_real,}
}

echo "Restarting nails"
/etc/init.d/nails restart 2&gt;&amp;1 &gt; /dev/null 

mv /var/opt/NAI/LinuxShield/dev/nails_monitor{,_real} 

echo "Intercepted data:" 

socat -v \
unix-listen:/var/opt/NAI/LinuxShield/dev/nails_monitor,perm=777,fork \
unix-connect:/var/opt/NAI/LinuxShield/dev/nails_monitor_real 

trap _restore SIGTERM</pre>
<p>我们可以在拦截下的信息中看到下面这两个请求：</p>
<h3>有效请求：</h3>
<pre>&lt; 2015/07/30 11:14:28.119036  length=70 from=0 to=69
+OK welcome to the NAILS Monitor Service &lt;19224.2214.1438280068.161&gt;\r
&gt; 2015/07/30 11:14:28.119326  length=54 from=0 to=53
auth 2259618965-19224.2214.1438280068.161-2259618965\r
&lt; 2015/07/30 11:14:28.119399  length=31 from=70 to=100
+OK successful authentication\r
&gt; 2015/07/30 11:14:28.137344  length=66 from=54 to=119
cred 127.0.0.1/nails/1438280067/1438279968-checksum//0 127.0.0.1\r
&lt; 2015/07/30 11:14:28.137530  length=20 from=101 to=120
+OK credentials OK\r</pre>
<h3>无效请求：</h3>
<pre>&lt; 2015/07/30 11:14:28.119036  length=70 from=0 to=69
+OK welcome to the NAILS Monitor Service &lt;19224.2214.1438280068.161&gt;\r
&gt; 2015/07/30 11:14:28.119326  length=54 from=0 to=53
auth 2259618965-19224.2214.1438280068.161-2259618965\r
&lt; 2015/07/30 11:14:28.119399  length=31 from=70 to=100
+OK successful authentication\r
&gt; 2015/07/30 11:14:28.137344  length=66 from=54 to=119
cred 127.0.0.1/nails/1438280067/1438279968-checksum//0 [ATTACKER IP]\r
&lt; 2015/07/30 11:14:28.137530  length=20 from=101 to=120
+ERR bad credentials\r</pre>
<p>用户请求认证时，webserver会将请求者的IP地址和cookie信息打包发送。虽然有点不寻常，但这不是一个可怕的安全决定。</p>
<p>我们的cookie是通过一个基于文本的协议发送的，cookie后面还有一些数据空间和IP地址。但是，如果我们将其中的一个数据域修改为目标用户的IP地址后，系统将无法进行正常的解析。</p>
<p>socket中的原始信息如下：</p>
<pre>AUTH [cookie] [ATTACKER IP]</pre>
<p>修改后的信息如下：</p>
<pre>AUTH [stolen cookie + VICTIM IP               ] [ATTACKER IP]</pre>
<p>服务将无法正常解析这一行数据，并且会认为这段cookie数据是从目标用户的IP地址发出的。</p>
<p>完整的通信数据如下：</p>
<pre>&lt; 2015/07/30 11:14:28.119036  length=70 from=0 to=69
+OK welcome to the NAILS Monitor Service &lt;19224.2214.1438280068.161&gt;\r
&gt; 2015/07/30 11:14:28.119326  length=54 from=0 to=53
auth 2259618965-19224.2214.1438280068.161-2259618965\r
&lt; 2015/07/30 11:14:28.119399  length=31 from=70 to=100
+OK successful authentication\r
&gt; 2015/07/30 11:14:28.137344  length=66 from=54 to=119
cred 127.0.0.1/nails/1438280067/1438279968-checksum//0 127.0.0.1                      10.0.0.130\r
&lt; 2015/07/30 11:14:28.137530  length=20 from=101 to=120
+OK credentials OK\r</pre>
<h2>0x8.CVE-2016-8023: 暴力破解身份验证令牌</h2>
<p>之前的cookie-parsing逻辑失败后，我想测试其他cookie验证逻辑是如何工作的。</p>
<p>下面给出的是nailsSessionIdcookie的一些样本值，当用户登录或注销nails账号时会自动生成这些值。</p>
<pre>127.0.0.1/nails/1459548338/1459548277-checksum//0</pre>
<pre class="brush">127.0.0.1/nails/1459549661/1459549629-checksum//0</pre>
<pre class="brush">127.0.0.1/nails/1459549695/1459549629-checksum//0</pre>
<p>在普通的登录过程中，cookie中只有两个部分会发生改变。Cookie格式如下所示：</p>
<pre class="brush">[host]/[username]/[SECRET1]/[SECRET2]-checksum//[Zero]</pre>
<p>正常的数据如下所示：</p>
<p><a href="http://www.mottoin.com/94066.html/rehrehyreafhdstr" rel="attachment wp-att-94123"><img class="alignnone size-full wp-image-94123 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/12/rehrehyreafhdstr.png" alt="rehrehyreafhdstr" width="753" height="253" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/12/rehrehyreafhdstr.png 753w, http://www.mottoin.com/wp-content/uploads/2016/12/rehrehyreafhdstr-300x101.png 300w" sizes="(max-width: 753px) 100vw, 753px" /></a></p>
<p>将时间戳作为[SECRET]变量的值绝对是一个糟糕的想法，因为这个值是可以被暴力破解出来的，但是使用两个时间戳的话会增加攻击的难度。在进行了一些基本的测试之后，我们发现这些数据域可接受的值范围非常的广泛：</p>
<p><a href="http://www.mottoin.com/94066.html/attachment/45214214552135" rel="attachment wp-att-94124"><img class="alignnone size-full wp-image-94124 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/12/45214214552135.png" alt="45214214552135" width="748" height="249" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/12/45214214552135.png 748w, http://www.mottoin.com/wp-content/uploads/2016/12/45214214552135-300x100.png 300w" sizes="(max-width: 748px) 100vw, 748px" /></a></p>
<p>这样只需要获取到服务器的启动时间，然后修改下列cookie中的DATE值就可以了：</p>
<pre class="brush">[Attacker IP]/n/0/[DATE]-checksum//</pre>
<h2>0x9.CVE-2016-8024: HTTP响应拆分</h2>
<p>用户可以在“系统事件”页面中导出所有的日志数据（CSV文件），此时系统会发送一个GET请求。</p>
<p><a href="http://www.mottoin.com/94066.html/export_csv" rel="attachment wp-att-94126"><img class="alignnone size-full wp-image-94126 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/12/export_csv.png" alt="export_csv" width="460" height="130" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/12/export_csv.png 460w, http://www.mottoin.com/wp-content/uploads/2016/12/export_csv-300x85.png 300w" sizes="(max-width: 460px) 100vw, 460px" /></a></p>
<p>在请求中，有一个参数为info%3A0。这个参数的值通常为multi%2Capplication%2Fvnd.ms-excel。在服务器相应的响应数据中，有一个header为Content-Type:application/vnd.ms-excel。攻击者可以将header中的链接修改为恶意文件。</p>
<p><a href="http://www.mottoin.com/94066.html/splitting_req" rel="attachment wp-att-94127"><img class="alignnone size-full wp-image-94127 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/12/splitting_req.png" alt="splitting_req" width="1284" height="198" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/12/splitting_req.png 1284w, http://www.mottoin.com/wp-content/uploads/2016/12/splitting_req-300x46.png 300w, http://www.mottoin.com/wp-content/uploads/2016/12/splitting_req-768x118.png 768w, http://www.mottoin.com/wp-content/uploads/2016/12/splitting_req-1024x158.png 1024w" sizes="(max-width: 1284px) 100vw, 1284px" /></a></p>
<p><a href="http://www.mottoin.com/94066.html/splitting_resp" rel="attachment wp-att-94128"><img class="alignnone size-full wp-image-94128 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/12/splitting_resp.png" alt="splitting_resp" width="672" height="522" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/12/splitting_resp.png 672w, http://www.mottoin.com/wp-content/uploads/2016/12/splitting_resp-300x233.png 300w" sizes="(max-width: 672px) 100vw, 672px" /></a></p>
<h2>0x10.CVE-2016-8025: SQL注入漏洞</h2>
<p>此系统使用SQLite数据库来存储有关设置和先前扫描的数据。我查看的这个数据库的每个入口点都容易遭受SQL注入。此应用程序似乎将URL参数转换为SQLite命令，使用在漏洞9的讨论中提到的CSV导出功能，我们就可以通过访问这个URL来导出sqlite_master表（CSV格式）。查询语句“select* from sqlite_master;“被嵌入在嵌入在URL中：</p>
<pre>localhost:55443/0409/nails?pg=proxy&amp;tplt=-&amp;addr=127.0.0.1%3A65443&amp;mon%3A0=db+select+_show%3D%24*++_output
%3Dcsv+_table%3Dsqlite_master+&amp;info%3A0=multi%2Capplication%2Fvnd.ms-excel</pre>
<p><a href="http://www.mottoin.com/94066.html/sql_db" rel="attachment wp-att-94129"><img class="alignnone size-full wp-image-94129 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/12/sql_db.png" alt="sql_db" width="1066" height="722" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/12/sql_db.png 1066w, http://www.mottoin.com/wp-content/uploads/2016/12/sql_db-300x203.png 300w, http://www.mottoin.com/wp-content/uploads/2016/12/sql_db-768x520.png 768w, http://www.mottoin.com/wp-content/uploads/2016/12/sql_db-1024x694.png 1024w, http://www.mottoin.com/wp-content/uploads/2016/12/sql_db-220x150.png 220w" sizes="(max-width: 1066px) 100vw, 1066px" /></a></p>
<p>数据库不用于身份验证，仅用于跟踪已扫描的文件和事件日志。在入侵了目标设备之后，攻击者就可以利用SQL注入攻击来修改这些日志，并清除他们的攻击痕迹。</p>
<p>数据库模式如下：</p>
<pre class="brush">"*"
"31-Dec-1969 16:00:00 (-08:00 UTC)","nailsInfo","nailsInfo","4","create table nailsInfo(attrib varchar(32) not null unique,	-- name of the attribute
                          val varchar(32),			-- string value
			  i_val integer				-- integer value
			 )"
"31-Dec-1969 16:00:00 (-08:00 UTC)","(nailsInfo autoindex 1)","nailsInfo","3",""
"31-Dec-1969 16:00:00 (-08:00 UTC)","counters","counters","5","create table counters(i_lastUpdated integer not null, 	-- time the counters were last updated
			 i_scanned integer not null,		-- Number of objects scanned 
			 i_totalScanCpu integer not null,	-- Total CPU used for scanning (microseconds) 
			 i_excludes integer not null,		-- Number of excluded files 
			 i_ok integer not null,			-- Number of files scanned to be ok 
			 i_infected integer not null,		-- Number of objects that have been infected 
			 i_infections integer not null,		-- Number of of infections 
			 i_cleaned integer not null,		-- Number of objects that have been cleaned 
			 i_cleanAttempts integer not null,	-- Number of objects that have been queued for cleaning 
			 i_cleanRequests integer not null,	-- Number of clean requests from the scan sources 
			 i_repaired integer not null,		-- Number of repairs made 
			 i_possiblyCleaned integer not null,	-- Number of partial repairs made 
			 i_errors integer not null,		-- Number of failed scans not clean and not infected 
			 i_timeouts integer not null,		-- Number of scans that have timed out 
			 i_denied integer not null,		-- Number of process denied access 
			 i_deleted integer not null,		-- Number of cleans that resulted in deleting the file 
			 i_renamed integer not null,		-- Number of cleans that resulted on renaming the file 
			 i_quarantined integer not null,	-- Number of cleans that resulted on quarantining the file 
			 i_corrupted integer not null,		-- Number of corrupted items detected by scanning 
			 i_encrypted integer not null,		-- Number of encrypted items detected by scanning 
			 i_uptime integer not null,		-- Number of seconds since we started 
			 i_wait integer not null,		-- Number of objects waiting to be scanned 
			 i_busy integer not null,		-- Number of objects being scanned 
			 i_adds integer not null,		-- Number of objects that have been added to a queued entry 
			 i_cacheSize integer not null,		-- Number of entries in the cache 
			 i_cacheHits integer not null,		-- Number of cache hits 
			 i_cacheMisses integer not null,	-- Number of cache misses 
			 i_cacheInserts integer not null	-- Number of cache insertions 
			)"
"31-Dec-1969 16:00:00 (-08:00 UTC)","schedule","schedule","9","create table schedule(i_taskId integer primary key,    	-- an auto-increment column
                         taskName varchar(64) not null unique,	-- the name of the task
			 timetable varchar(255) not null,	-- the encoded string of when it runs
			 taskType varchar(16) not null,		-- upgrade, scan, report
			 taskInfo varchar(255),			-- information specific to the task
			 taskResults varchar(255),		-- results of the task
			 i_lastRun integer,			-- time last run
			 status varchar(8),			-- status of last run
			 progress varchar(255),			-- progress string
			 i_duration integer,			-- current duration of the task run
			 i_nextRun integer,			-- time next run
			 i_recurrenceCounter integer,		-- count scheduler invocations by cron
			 i_taskPid integer			-- pid of the task being run
			)"
"31-Dec-1969 16:00:00 (-08:00 UTC)","(schedule autoindex 1)","schedule","8",""
"31-Dec-1969 16:00:00 (-08:00 UTC)","errorClass","errorClass","12","create table errorClass(errorClsNm varchar(16) not null unique)"
"31-Dec-1969 16:00:00 (-08:00 UTC)","(errorClass autoindex 1)","errorClass","11",""
"31-Dec-1969 16:00:00 (-08:00 UTC)","repository","repository","15","create table repository(siteList blob, status int)"
"31-Dec-1969 16:00:00 (-08:00 UTC)","scanLog","scanLog","16","create table scanLog(i_logId integer primary key, 		-- an auto-increment column
			origin varchar(8) not null,		-- access or demand
			i_taskId integer,			-- references schedule.i_taskId
			i_objId integer,			-- an id to relate scan events on the same object
			i_tim integer not null,			-- UTC time it happened
			fileName varchar(255), 
			path varchar(255), 
			action varchar(16),
			virusName varchar(64),
			virusType varchar(16),			-- Unknown, Virus, App, Joke, Killed, Test, Trojan, Wannabee
			userName varchar(32),
			processName varchar(32)
		       )"
"31-Dec-1969 16:00:00 (-08:00 UTC)","eventLog","eventLog","18","create table eventLog(i_logId integer primary key,		-- an auto-increment column
                         origin varchar(8) not null,		-- system or task
			 i_taskId varchar(64),			-- references schedule.i_taskId
			 i_objId integer,			-- an id to relate events on the same object
			 i_tim integer not null,		-- UTC time it happened
			 errorClsNm varchar(16), 		-- references errorClass.errorClsNm
			 i_errorCode integer,			-- the error code
			 errorType varchar(8),			-- info or error
			 description varchar(255)
			)"</pre>
<h2>0x11.漏洞综合利用：以Root权限实现远程代码执行</h2>
<p>要在远程计算机上以root用户身份执行代码，可利用下面的方法：</p>
<ol>
<li>利用漏洞7和漏洞8对身份验证令牌进行暴力破解。</li>
<li> 开启恶意更新服务器。</li>
<li>利用漏洞7向更新服务器发送请求（带有身份验证令牌）。</li>
<li>利用漏洞6在目标系统中创建并执行恶意脚本。</li>
<li>利用漏洞5和漏洞6来触发目标主机中的漏洞扫描任务，但实际上执行的是恶意脚本。</li>
<li>在目标设备中以root权限执行恶意脚本。</li>
</ol>
<p>利用此漏洞取决于每当用户登录Web界面时生成的有效登录令牌是否存在。 这些令牌在登录后大约一小时内有效。</p>
<h2>漏洞PoC</h2>
<ul>
<li><a href="https://gist.github.com/AndrewFasano/e8339d700a42416bd83cb1cf0a05e624#file-exploit-py">GitHub</a></li>
<li><a href="https://www.exploit-db.com/exploits/40911/">exploit-db</a></li>
</ul>
<p>&nbsp;</p>
<p style="text-align: center;"><span style="color: #ff0000;"><strong>*原文：<a style="color: #ff0000;" href="https://nation.state.actor/mcafee.html">Andrew Fasano</a> MottoIN小编翻译，转载请注明来自<a href="http://www.mottoin.com/94066.html">MottoIN</a></strong></span></p>
                                                        <div class="entry-copyright"><p>原创文章，作者：Moto，如若转载，请注明出处：http://www.mottoin.com/94066.html</p></div>                        </div>
                        <div class="entry-footer">
                            <div class="entry-tag"><a href="http://www.mottoin.com/tag/cve-2016-8016" rel="tag">CVE-2016-8016</a><a href="http://www.mottoin.com/tag/cve-2016-8017" rel="tag">CVE-2016-8017</a><a href="http://www.mottoin.com/tag/cve-2016-8018" rel="tag">CVE-2016-8018</a><a href="http://www.mottoin.com/tag/cve-2016-8019" rel="tag">CVE-2016-8019</a><a href="http://www.mottoin.com/tag/cve-2016-8020" rel="tag">CVE-2016-8020</a><a href="http://www.mottoin.com/tag/cve-2016-8021" rel="tag">CVE-2016-8021</a><a href="http://www.mottoin.com/tag/cve-2016-8022" rel="tag">CVE-2016-8022</a><a href="http://www.mottoin.com/tag/cve-2016-8023" rel="tag">CVE-2016-8023</a><a href="http://www.mottoin.com/tag/cve-2016-8024" rel="tag">CVE-2016-8024</a><a href="http://www.mottoin.com/tag/cve-2016-8025" rel="tag">CVE-2016-8025</a><a href="http://www.mottoin.com/tag/http%e5%93%8d%e5%ba%94%e6%8b%86%e5%88%86" rel="tag">HTTP响应拆分</a><a href="http://www.mottoin.com/tag/mcafeevirusscan-linux%e4%bc%81%e4%b8%9a%e7%89%88" rel="tag">McAfeeVirusScan Linux企业版</a><a href="http://www.mottoin.com/tag/sql%e6%b3%a8%e5%85%a5%e6%bc%8f%e6%b4%9e" rel="tag">SQL注入漏洞</a><a href="http://www.mottoin.com/tag/web%e6%8e%a5%e5%8f%a3%e5%85%81%e8%ae%b8%e5%9c%a8%e5%b7%b2%e7%9f%a5%e5%9c%b0%e5%9d%80%e5%86%99%e5%85%a5%e4%bb%bb%e6%84%8f%e6%96%87%e4%bb%b6" rel="tag">Web接口允许在已知地址写入任意文件</a><a href="http://www.mottoin.com/tag/%e6%97%a0%e8%b7%a8%e7%ab%99%e8%af%b7%e6%b1%82%e4%bc%aa%e9%80%a0%ef%bc%88csrf%ef%bc%89%e9%aa%8c%e8%af%81%e4%bb%a4%e7%89%8c" rel="tag">无跨站请求伪造（CSRF）验证令牌</a><a href="http://www.mottoin.com/tag/%e6%9a%b4%e5%8a%9b%e7%a0%b4%e8%a7%a3%e8%ba%ab%e4%bb%bd%e9%aa%8c%e8%af%81%e4%bb%a4%e7%89%8c" rel="tag">暴力破解身份验证令牌</a><a href="http://www.mottoin.com/tag/%e6%9c%aa%e7%bb%8f%e9%aa%8c%e8%af%81%e7%9a%84%e6%96%87%e4%bb%b6%e8%bf%9c%e7%a8%8b%e8%af%bb%e5%8f%96%e6%bc%8f%e6%b4%9e%ef%bc%88%e5%8f%97%e9%99%90%ef%bc%89" rel="tag">未经验证的文件远程读取漏洞（受限）</a><a href="http://www.mottoin.com/tag/%e6%9c%aa%e7%bb%8f%e9%aa%8c%e8%af%81%e7%9a%84%e8%bf%9c%e7%a8%8b%e6%96%87%e4%bb%b6%e6%8e%a2%e6%b5%8b%e6%bc%8f%e6%b4%9e" rel="tag">未经验证的远程文件探测漏洞</a><a href="http://www.mottoin.com/tag/%e8%b7%a8%e7%ab%99%e8%84%9a%e6%9c%ac%e6%94%bb%e5%87%bb%ef%bc%88xss%ef%bc%89" rel="tag">跨站脚本攻击（XSS）</a><a href="http://www.mottoin.com/tag/%e8%bf%9c%e7%a8%8b%e4%bb%a3%e7%a0%81%e6%89%a7%e8%a1%8c%e7%89%b9%e6%9d%83%e6%8f%90%e5%8d%87%e6%bc%8f%e6%b4%9e%ef%bc%88%e6%8f%90%e6%9d%83%ef%bc%89" rel="tag">远程代码执行&amp;特权提升漏洞（提权）</a><a href="http://www.mottoin.com/tag/%e8%bf%9c%e7%a8%8b%e4%bd%bf%e7%94%a8%e8%ba%ab%e4%bb%bd%e9%aa%8c%e8%af%81%e4%bb%a4%e7%89%8c" rel="tag">远程使用身份验证令牌</a></div>
                            <div class="entry-action">
                                <div class="btn-zan" data-id="94066"><i class="fa fa-thumbs-up"></i> 赞 <span class="entry-action-num">(0)</span></div>

                                
                            </div>
                            <div class="entry-bar">
                                <div class="entry-bar-inner clearfix">
                                                                            <div class="author pull-left">
                                            <a data-user="7" target="_blank" href="http://www.mottoin.com/user/seceditor/" class="avatar">
                                                <img src="http://gravatar.com/avatar/?s=400&d=mm" class="func-um_user gravatar avatar avatar-60 um-avatar um-avatar-gravatar" width="60" height="60" alt="Moto" />                                                Moto                                            </a>
                                            <span class="author-title">普通用户</span>                                         </div>
                                                                        <div class="info pull-right">
                                        <div class="info-item meta">
                                            <a class="meta-item j-heart" href="javascript:;" data-id="94066"><i class="fa fa-heart"></i> <span class="data">0</span></a>
                                            <a class="meta-item" href="#comments"><i class="fa fa-comment"></i> <span class="data">0</span></a>
                                                                                    </div>
                                        <div class="info-item share">
                                            <a class="meta-item" href="javascript:;">
                                                <i class="fa fa-wechat"></i>
                                                <span class="wx-wrap">
                                                    <img src="//pan.baidu.com/share/qrcode?w=320&h=320&url=http://www.mottoin.com/94066.html">
                                                    <span>扫码分享到微信</span>
                                                </span>
                                            </a>
                                            <a class="meta-item" href="http://share.baidu.com/s?type=text&searchPic=1&sign=on&to=tsina&key=&url=http%3A%2F%2Fwww.mottoin.com%2F94066.html&title=McAfee+for+Linux+Vulnerability+Writeup" target="_blank"><i class="fa fa-weibo"></i></a>
                                            <a class="meta-item" href="http://share.baidu.com/s?type=text&searchPic=1&sign=on&to=qzone&key=&url=http%3A%2F%2Fwww.mottoin.com%2F94066.html&title=McAfee+for+Linux+Vulnerability+Writeup" target="_blank"><i class="fa fa-qq"></i></a>
                                        </div>
                                        <div class="info-item act">
                                            <a href="javascript:;" id="j-reading"><i class="fa fa-file-text"></i></a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                                                        <h3 class="entry-related-title">相关推荐</h3><ul class="entry-related clearfix"><li><a href="http://www.mottoin.com/101059.html" title="Ubuntu LightDM Guest 账户本地提权漏洞详情（CVE-2017-7358）">Ubuntu LightDM Guest 账户本地提权漏洞详情（CVE-2017-7358）</a></li><li><a href="http://www.mottoin.com/85217.html" title="iOS客户端hack的两种姿势">iOS客户端hack的两种姿势</a></li><li><a href="http://www.mottoin.com/95379.html" title="通过DIVA了解APP安全问题">通过DIVA了解APP安全问题</a></li><li><a href="http://www.mottoin.com/88060.html" title="Dark Mobile Bank之移动银行应用仿冒攻击威胁分析报告">Dark Mobile Bank之移动银行应用仿冒攻击威胁分析报告</a></li><li><a href="http://www.mottoin.com/93236.html" title="Android逆向与病毒分析">Android逆向与病毒分析</a></li><li><a href="http://www.mottoin.com/100495.html" title="浏览器信息收集: 利用 PowerShell 无文件读取 Chrome Cookie">浏览器信息收集: 利用 PowerShell 无文件读取 Chrome Cookie</a></li><li><a href="http://www.mottoin.com/92104.html" title="使用Raspberry Pi Zero在锁定的计算机中安装后门">使用Raspberry Pi Zero在锁定的计算机中安装后门</a></li><li><a href="http://www.mottoin.com/100154.html" title="以DVR 设备为目标的恶意软件Amnesia分析">以DVR 设备为目标的恶意软件Amnesia分析</a></li><li><a href="http://www.mottoin.com/91246.html" title="IoT: 物联网安全测试经验总结">IoT: 物联网安全测试经验总结</a></li><li><a href="http://www.mottoin.com/87123.html" title="如何提升现代iOS应用安全性">如何提升现代iOS应用安全性</a></li></ul>                        </div>
                        
<div id="comments" class="entry-comments">
    	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">发表评论 <small><a rel="nofollow" id="cancel-comment-reply-link" href="/94066.html#respond" style="display:none;">取消回复</a></small></h3><div class="comment-form"><div class="comment-must-login">请登录后评论...</div><div class="form-submit"><div class="form-submit-text pull-left"><a href="http://www.mottoin.com/login">登录</a>后才能评论</div> <input name="submit" type="submit" id="must-submit" class="submit" value="发表"></div></div>	</div><!-- #respond -->
		</div><!-- .comments-area -->                    </div>
                </article>
                    </div>
        <aside class="sidebar">
            <div id="profile-3" class="widget widget_profile">                <div class="cover_photo"></div>
                        <div class="avatar-wrap">
                <a target="_blank" href="http://www.mottoin.com/user/seceditor/" class="avatar-link"><img src="http://gravatar.com/avatar/?s=400&d=mm" class="func-um_user gravatar avatar avatar-120 um-avatar um-avatar-gravatar" width="120" height="120" alt="Moto" /></a></div>
            <div class="profile-info">
                <p><span class="author-name">Moto</span><span class="author-title">普通用户</span></p>
                <p class="author-description"></p>
            </div>
            <div class="profile-posts">
                <h3 class="widget-title"><span>最近文章</span></h3>
                <ul>                    <li><a href="http://www.mottoin.com/101279.html" title="Windows内核漏洞发现与利用">Windows内核漏洞发现与利用</a></li>
                                    <li><a href="http://www.mottoin.com/100495.html" title="浏览器信息收集: 利用 PowerShell 无文件读取 Chrome Cookie">浏览器信息收集: 利用 PowerShell 无文件读取 Chrome Cookie</a></li>
                                    <li><a href="http://www.mottoin.com/99735.html" title="一键无文件感染技术分析">一键无文件感染技术分析</a></li>
                                    <li><a href="http://www.mottoin.com/99776.html" title="APT10：中国黑客组织攻击全球IT服务供应商">APT10：中国黑客组织攻击全球IT服务供应商</a></li>
                                    <li><a href="http://www.mottoin.com/99257.html" title="IIS 6.0 WebDAV远程代码执行（CVE-2017-7269）">IIS 6.0 WebDAV远程代码执行（CVE-2017-7269）</a></li>
                </ul>            </div>
            </div><div id="custom_html-3" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><a class="btn-post" href="/question"><i class="fa fa-edit"></i> 我要提问</a></div></div><div id="post-thumb-3" class="widget widget_post_thumb">            <ul>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105921.html" title="“黑客反击”的合法化之争">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/170918-Cox-The-Hackers-Hitting-Back-At-Cybercriminals-hero_vkcor5-480x300.gif" width="480" height="300" alt="“黑客反击”的合法化之争">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105921.html" title="“黑客反击”的合法化之争">“黑客反击”的合法化之争</a></p>
                            <p class="item-date">2017年9月20日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105917.html" title="美参议员要求电信巨头们回应SS7信令系统的安全问题">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG929-480x300.jpeg" width="480" height="300" alt="美参议员要求电信巨头们回应SS7信令系统的安全问题">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105917.html" title="美参议员要求电信巨头们回应SS7信令系统的安全问题">美参议员要求电信巨头们回应SS7信令系统的安全问题</a></p>
                            <p class="item-date">2017年9月19日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105914.html" title="美国国土安全部发布禁止使用卡巴斯基产品的明细">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG928-480x300.jpeg" width="480" height="300" alt="美国国土安全部发布禁止使用卡巴斯基产品的明细">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105914.html" title="美国国土安全部发布禁止使用卡巴斯基产品的明细">美国国土安全部发布禁止使用卡巴斯基产品的明细</a></p>
                            <p class="item-date">2017年9月19日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105885.html" title="【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG906-480x300.jpeg" width="480" height="300" alt="【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105885.html" title="【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）">【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）</a></p>
                            <p class="item-date">2017年9月19日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105879.html" title="全球首款网络安全概念车驶入上海滩">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15057198871-480x300.png" width="480" height="300" alt="全球首款网络安全概念车驶入上海滩">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105879.html" title="全球首款网络安全概念车驶入上海滩">全球首款网络安全概念车驶入上海滩</a></p>
                            <p class="item-date">2017年9月18日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105872.html" title="暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG897-480x300.jpeg" width="480" height="300" alt="暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105872.html" title="暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3">暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3</a></p>
                            <p class="item-date">2017年9月18日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105865.html" title="美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG896-480x300.jpeg" width="480" height="300" alt="美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105865.html" title="美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁">美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁</a></p>
                            <p class="item-date">2017年9月18日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105858.html" title="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG150-480x300.jpeg" width="480" height="300" alt="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105858.html" title="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护</a></p>
                            <p class="item-date">2017年9月17日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG141-480x300.jpeg" width="480" height="300" alt="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场</a></p>
                            <p class="item-date">2017年9月16日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105837.html" title="黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG132-480x300.jpeg" width="480" height="300" alt="黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105837.html" title="黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协">黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协</a></p>
                            <p class="item-date">2017年9月16日</p>
                        </div>
                    </li>
                            </ul>
        </div><div id="lastest-products-4" class="widget widget_lastest_products">            <ul class="p-list clearfix">
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105921.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/170918-Cox-The-Hackers-Hitting-Back-At-Cybercriminals-hero_vkcor5-480x300.gif" width="480" height="300" alt="“黑客反击”的合法化之争">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105921.html" title="“黑客反击”的合法化之争">
                                    “黑客反击”的合法化之争                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105858.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG150-480x300.jpeg" width="480" height="300" alt="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105858.html" title="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">
                                    DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105847.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG141-480x300.jpeg" width="480" height="300" alt="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">
                                    国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105799.html">
                                <img width="480" height="300" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" class="attachment-post-thumbnail size-post-thumbnail j-lazy wp-post-image" alt="暗网系列之：“入店行窃者”的工具、战术和克星" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15054708381-150x150-480x300.png" />                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105799.html" title="暗网系列之：“入店行窃者”的工具、战术和克星">
                                    暗网系列之：“入店行窃者”的工具、战术和克星                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105703.html">
                                <img width="480" height="300" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" class="attachment-post-thumbnail size-post-thumbnail j-lazy wp-post-image" alt="【现场还原】补天漏洞情报发布会记事" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG82-150x150-480x300.jpeg" />                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105703.html" title="【现场还原】补天漏洞情报发布会记事">
                                    【现场还原】补天漏洞情报发布会记事                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105692.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG75-480x300.jpeg" width="480" height="300" alt="SyScan360看点回顾：中美德俄等七国黑客专家神技大比拼">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105692.html" title="SyScan360看点回顾：中美德俄等七国黑客专家神技大比拼">
                                    SyScan360看点回顾：中美德俄等七国黑客专家神技大比拼                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105642.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG58-480x300.jpeg" width="480" height="300" alt="大安全时代序幕开启！ 中国互联网安全大会重新定义网络安全">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105642.html" title="大安全时代序幕开启！ 中国互联网安全大会重新定义网络安全">
                                    大安全时代序幕开启！ 中国互联网安全大会重新定义网络安全                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105621.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG512-480x300.jpeg" width="480" height="300" alt="【重磅推出】ISC大会补天漏洞情报服务发布会：英雄，你准备好了吗？">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105621.html" title="【重磅推出】ISC大会补天漏洞情报服务发布会：英雄，你准备好了吗？">
                                    【重磅推出】ISC大会补天漏洞情报服务发布会：英雄，你准备好了吗？                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105629.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG49-480x300.jpeg" width="480" height="300" alt="ISC直击：360守护者计划登陆ISC 最强白帽挑战黑客马拉松大奖赛">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105629.html" title="ISC直击：360守护者计划登陆ISC 最强白帽挑战黑客马拉松大奖赛">
                                    ISC直击：360守护者计划登陆ISC 最强白帽挑战黑客马拉松大奖赛                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105603.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG42-480x300.jpeg" width="480" height="300" alt="【ISC2017精彩剪辑】周鸿祎：大安全时代 网络空间防御刻不容缓">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105603.html" title="【ISC2017精彩剪辑】周鸿祎：大安全时代 网络空间防御刻不容缓">
                                    【ISC2017精彩剪辑】周鸿祎：大安全时代 网络空间防御刻不容缓                                </a>
                            </h4>
                        </div>
                    </li>
                            </ul>
        </div>        </aside>
    </div>
<div class="modal" id="login-modal">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                <h4 class="modal-title">请登录</h4>
            </div>
            <div class="modal-body login-modal-body">
                <p>您还未登录，请登录后再进行相关操作！</p>
                <div class="login-btn">
                    <a class="btn btn-login" href="http://www.mottoin.com/login">登 录</a>
                    <a class="btn btn-register" href="http://www.mottoin.com/register">注 册</a>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
<footer class="footer">
    <div class="container">
        <div class="clearfix">
                        <div class="footer-col footer-col-logo">
                <img src="http://www.mottoin.com/img/mottoin/tmxk.png" alt="MottoIN">
            </div>
                        <div class="footer-col footer-col-copy">
                <ul class="footer-nav hidden-xs"><li id="menu-item-104182" class="menu-item menu-item-104182"><a href="http://www.mottoin.com/about">关于我们</a></li>
<li id="menu-item-104181" class="menu-item menu-item-104181"><a href="http://www.mottoin.com/dis">免责声明</a></li>
<li id="menu-item-104183" class="menu-item menu-item-104183"><a href="http://www.mottoin.com/joinus">加入我们</a></li>
<li id="menu-item-105509" class="menu-item menu-item-105509"><a href="http://www.mottoin.com/contact">联系我们</a></li>
<li id="menu-item-104184" class="menu-item menu-item-104184"><a href="http://www.mottoin.com/report">寻求报道</a></li>
<li id="menu-item-104185" class="menu-item menu-item-104185"><a href="http://www.mottoin.com/contribute">我要投稿</a></li>
</ul>                <div class="copyright">
                    Copyright © 2017 MottoIN 版权所有 <a href="http://www.miibeian.gov.cn/">沪ICP备16010654号-5</a>  <img class="alignnone " src="http://www.mottoin.com/img/mottoin/ga.png" width="16" height="16" /> <a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31010402001331">沪公网安备31010402001331号</a>                 </div>
            </div>
            <div class="footer-col footer-col-sns">
                <div class="footer-sns">
                                                                                    <a class="sns-wx" href="javascript:;">
                            <i class="fa fa-weixin"></i>
                            <span style="background-image:url(http://www.mottoin.com/img/mottoin/weixin.jpg);"></span>
                        </a>
                                                                <a target="_blank" href="http://weibo.com/mottoin" rel="nofollow"><i class="fa fa-weibo"></i></a>
                                                                <a target="_blank" href="http://weibo.com/mottoin" rel="nofollow"><i class="fa fa-tencent-weibo"></i></a>
                                                                                                                                                                                </div>
            </div>
        </div>
    </div>
</footer>
<div class="action" style="top:50%;">
            <div class="a-box contact">
            <div class="contact-wrap">
                <h3 class="contact-title">联系我们</h3>
                <h4 style="text-align: center;"><span style="color: #2d6ded;"><strong>021-62666911</strong></span></h4>
<p>在线咨询：<a href="http://wpa.qq.com/msgrd?uin=19539638" target="_blank" rel="noopener"><img class="alignnone" title="点击这里给我发消息" src="http://wpa.qq.com/pa?p=2:1666839010:51" alt="点击这里给我发消息" border="0" /></a></p>
<p>邮件：root@mottoin.com</p>
<p>工作时间：周一至周五，9:30-18:30，节假日休息</p>
            </div>
        </div>
                <div class="a-box wechat">
            <div class="wechat-wrap">
                <img src="http://www.mottoin.com/img/mottoin/weixin.jpg" alt="QR code">
            </div>
        </div>
            <div class="a-box gotop" id="j-top" style="display: none;"></div>
</div>
<style>.footer{padding-bottom: 35px;}</style><div id="um_upload_single" style="display:none">
	
</div><div id="um_view_photo" style="display:none">

	<a href="#" data-action="um_remove_modal" class="um-modal-close"><i class="um-faicon-times"></i></a>
	
	<div class="um-modal-body photo">
	
		<div class="um-modal-photo">

		</div>

	</div>
	
</div><script type='text/javascript'>
/* <![CDATA[ */
var _wpcom_js = {"ajaxurl":"http:\/\/www.mottoin.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/themes/JustNews/js/main.js?ver=2.3.2'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/comment-reply.min.js?ver=4.8.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpcom_qa_js = {"ajaxurl":"http:\/\/www.mottoin.com\/wp-admin\/admin-ajax.php","ajaxloading":"http:\/\/www.mottoin.com\/wp-content\/plugins\/wpcom-qa\/images\/loading.gif"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/plugins/wpcom-qa/js/scripts.min.js?ver=1.0'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/imagesloaded.min.js?ver=3.2.0'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/masonry.min.js?ver=3.3.2'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/jquery/jquery.masonry.min.js?ver=3.1.2b'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var um_scripts = {"ajaxurl":"http:\/\/www.mottoin.com\/wp-admin\/admin-ajax.php","fileupload":"http:\/\/www.mottoin.com\/wp-content\/plugins\/ultimate-member\/core\/lib\/upload\/um-file-upload.php","imageupload":"http:\/\/www.mottoin.com\/wp-content\/plugins\/ultimate-member\/core\/lib\/upload\/um-image-upload.php"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/plugins/ultimate-member/assets/js/um.min.js?ver=10.3.88'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/plugins/ultimate-member/assets/js/pickadate/translations/zh_CN.js?ver=10.3.88'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/wp-embed.min.js?ver=4.8.1'></script>

		<script type="text/javascript">jQuery( '#request' ).val( '' );</script>

	    <script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":["mshare","tsina","weixin","qzone","sqq","douban","fbook","twi","bdhome","tqq","tieba","mail","youdao","print"],"bdPic":"","bdStyle":"1","bdSize":"16"},"share":[{"tag" : "single", "bdSize" : 16}, {"tag" : "global","bdSize" : 16,bdPopupOffsetLeft:-227}],url:'http://www.mottoin.com/wp-content/themes/JustNews'};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://www.mottoin.com/wp-content/themes/JustNews/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
</body>
</html>