<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
    <title>悄然崛起的挖矿机僵尸网络：打服务器挖价值百万门罗币 | MottoIN</title>
    <link rel='dns-prefetch' href='//www.mottoin.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="MottoIN &raquo; 悄然崛起的挖矿机僵尸网络：打服务器挖价值百万门罗币评论Feed" href="http://www.mottoin.com/105241.html/feed" />
<link rel='stylesheet' id='stylesheet-css'  href='http://www.mottoin.com/wp-content/themes/JustNews/css/style.css?ver=2.3.2' type='text/css' media='all' />
<link rel='stylesheet' id='wpcom-qa-css'  href='http://www.mottoin.com/wp-content/plugins/wpcom-qa/css/style.css?ver=1.0' type='text/css' media='all' />
<style id='wpcom-qa-inline-css' type='text/css'>

        .q-content .topic-tab,.q-content .q-answer .as-user,.q-content .q-answer .as-comment-name{color: #1471CA;}
        .q-content .q-topic-wrap a:hover,.q-content .q-answer .as-action a:hover,.q-content .topic-tab:hover{color:#0D62B3;}
        .q-content .put-top,.q-content .topic-tab.current-tab,.q-content .q-answer .as-submit .btn-submit,.q-content .q-answer .as-comments-submit,.q-content .q-add-header .btn-post,.q-content .q-pagination .current{background-color:#1471CA;}
        .q-content .q-answer .as-submit .btn-submit:hover,.q-content .q-answer .as-comments-submit:hover,.q-content .q-add-header .btn-post:hover,.q-content .topic-tab.current-tab:hover,.q-content .q-pagination a:hover{background-color:#0D62B3;}
        .q-content .q-answer .as-comments-input:focus{border-color: #1471CA;}
        
</style>
<link rel='stylesheet' id='um_minified-css'  href='http://www.mottoin.com/wp-content/plugins/ultimate-member/assets/css/um.min.css?ver=10.3.88' type='text/css' media='all' />
<script type='text/javascript' src='http://www.mottoin.com/wp-content/themes/JustNews/js/jquery.min.js?ver=1.12.4'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.mottoin.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.mottoin.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='数字签名攻击报告：正在摧毁软件身份“信用体系”的安全危机' href='http://www.mottoin.com/105178.html' />
<link rel='next' title='HTTPS劫匪木马暴力升级：破坏ARK攻击杀软' href='http://www.mottoin.com/105329.html' />
<link rel='shortlink' href='http://www.mottoin.com/?p=105241' />
<!--  WPCOM主题相关信息开始 -->
<meta name="applicable-device" content="pc,mobile">
<meta http-equiv="Cache-Control" content="no-transform">
<meta name="description" content="第一部分背景360互联网安全中心监测到一种利用被入侵服务器进行门罗币挖矿的僵尸网络，该僵尸网络控制的服务器数量高峰时单日达到两万多台。僵尸网络建立初期利用“永恒之蓝”漏洞攻击武器入侵一定数量的计算机并以此作为僵尸网络发展的基础，之后这些计算机扫描其他计算机的1433端口（msSQL服务端口），尝试爆破目标计算机的msSQL服务，一旦爆破成功则登陆SQLServer执行恶意代码。目标计算机被僵尸网络">
<!--  WPCOM主题相关信息结束 -->
 
		<script type="text/javascript">

		var ultimatemember_image_upload_url = 'http://www.mottoin.com/wp-content/plugins/ultimate-member/core/lib/upload/um-image-upload.php';
		var ultimatemember_file_upload_url = 'http://www.mottoin.com/wp-content/plugins/ultimate-member/core/lib/upload/um-file-upload.php';
		var ultimatemember_ajax_url = 'http://www.mottoin.com/wp-admin/admin-ajax.php';

		</script>

	
		<style type="text/css">.request_name { display: none !important; }</style>

	<link rel="icon" href="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-32x32.jpg" sizes="32x32" />
<link rel="icon" href="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-192x192.jpg" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-180x180.jpg" />
<meta name="msapplication-TileImage" content="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-270x270.jpg" />
    <style>
                a,.sec-panel-head span,.list.tabs .tab.active a,.header .nav>li.active>a,.header .dropdown-menu>.active>a,.entry .entry-info .nickname,.entry-bar-inner .author-title,.entry-action .btn-zan,.entry-action .btn-dashang,.comment-body .nickname,.form-submit-text span,.widget_profile .author-title,.um .um-profile-body .um-item-meta a,.login-modal-body .btn-register{color: #08c;}
        .header .dropdown-menu>li>a:hover,.header .dropdown-menu>.active>a:hover,.header .dropdown-menu>.active>a:focus,.navbar-action .publish,.pagination .current,.flex-control-paging li a.flex-active,.form-submit .submit,.sidebar .widget_nav_menu ul li.current-menu-item a,.sidebar .widget_nav_menu ul li.current-post-parent a,.search-form input.submit,.action .contact-title,.pf-submit,.tagHandler ul.tagHandlerContainer li.tagItem,.login-modal-body .btn-login,.woocommerce a.button,.woocommerce button.button,.woocommerce input.button,.woocommerce a.button.alt,.woocommerce button.button.alt,.woocommerce input.button.alt,.woocommerce a.button.alt.disabled,.woocommerce a.button.alt.disabled:hover,.woocommerce a.button.alt:disabled,.woocommerce a.button.alt:disabled:hover,.woocommerce a.button.alt:disabled[disabled],.woocommerce a.button.alt:disabled[disabled]:hover,.woocommerce button.button.alt.disabled,.woocommerce button.button.alt.disabled:hover,.woocommerce button.button.alt:disabled,.woocommerce button.button.alt:disabled:hover,.woocommerce button.button.alt:disabled[disabled],.woocommerce button.button.alt:disabled[disabled]:hover,.woocommerce input.button.alt.disabled,.woocommerce input.button.alt.disabled:hover,.woocommerce input.button.alt:disabled,.woocommerce input.button.alt:disabled:hover,.woocommerce input.button.alt:disabled[disabled],.woocommerce input.button.alt:disabled[disabled]:hover,.woocommerce .widget_price_filter .ui-slider .ui-slider-handle,.woocommerce .widget_price_filter .ui-slider .ui-slider-range,.shopping-count,.social-login-form .sl-input-submit{background-color: #08c;}
        .entry .entry-content h3,.entry .entry-content .h3,.widget-title{border-left-color: #08c;}
        .entry-bar-inner .author-title,.entry-action .btn-zan,.entry-action .btn-dashang,.search-form input.keyword:focus,.widget_profile .author-title,.login-modal-body .btn-login,.login-modal-body .btn-register{border-color: #08c;}
        .entry-bar-inner .author-title:before,.widget_profile .author-title:before{border-right-color: #08c;}
        .list.tabs .tab.active a{border-bottom-color: #08c;}

        a:hover,.header .nav>li>a:hover,.header .nav>li.active>a,.navbar-action .login:hover,.navbar-action .login:focus,.navbar-action .profile a:hover,.navbar-search-icon:hover,.navbar-search-icon:focus,.entry .entry-info a:hover,.entry .entry-info a:focus,.entry-bar .info-item a:hover,.p-item-wrap:hover .title a,.special-item-title a:hover,.special-item-bottom a:hover,.widget ul a:hover,.widget ol a:hover,.sec-panel-head .more:hover,.topic-list .topic-wrap:hover span,.tabs .tab a:hover,
        .article-list .item-title a:hover,.article-list .item-meta a:hover,.article-list .item-meta a:focus,.list-links a:hover,.list-links a:focus,.um .um-profile-body .um-item-meta a:hover,.um .um-profile-body .um-item-link a:hover,.load-more:hover,.login-modal-body .btn-register:hover{color: #07c;}
        .navbar-action .publish:hover,.navbar-action .publish:focus,.entry-tag a:hover,.entry-tag a:focus,.entry-action .btn-zan:hover,.entry-action .btn-dashang:hover,.entry-action .btn-zan.liked,.pagination a:hover,.flex-control-paging li a:hover,.form-submit .submit:hover,.widget .tagcloud a:hover,.sidebar .widget_nav_menu ul li.current-menu-item .sub-menu a:hover,.sidebar .widget_nav_menu ul li.current-post-parent .sub-menu a:hover,.sidebar .widget_nav_menu ul li a:hover,.search-form input.submit:hover,.action .a-box:hover,.footer-sns .fa:after,.article-list .item-category:hover,.pf-submit:hover,.tagHandler ul.tagHandlerContainer li.tagItem:hover,.login-modal-body .btn-login:hover,.woocommerce a.button:hover,.woocommerce button.button:hover,.woocommerce input.button:hover,.woocommerce a.button.alt:hover,.woocommerce button.button.alt:hover,.woocommerce input.button.alt:hover,.woocommerce .widget_price_filter .price_slider_wrapper .ui-widget-content,.social-login-form .sl-input-submit:hover{background-color: #07c;}
        .entry-tag a:hover,.entry-tag a:focus,.entry-action .btn-zan:hover,.entry-action .btn-dashang:hover,.entry-action .btn-zan.liked,.widget .tagcloud a:hover,.load-more:hover,.login-modal-body .btn-login:hover,.login-modal-body .btn-register:hover{border-color: #07c;}
        .special-item-bottom a:hover:before{border-left-color: #07c;}
        .list.tabs .tab.active a:hover{border-bottom-color: #07c;}
        @media (max-width: 991px){
            .header .navbar-nav>li.active>a,.header .navbar-nav .dropdown-menu .active a,.header .navbar-nav .dropdown-menu .active .dropdown-menu .active a{color: #08c;}
            .navbar-collapse{background-color: #08c;}
            .dropdown-menu>li a{border-color: #07c;}
            .header .navbar-nav>li.active>a:hover,.header .navbar-nav>li a:hover,.header .navbar-nav .dropdown-menu .active a:hover,.header .navbar-nav .dropdown-menu .active .dropdown-menu a:hover,.header .navbar-nav .dropdown-menu li a:hover{color: #07c;}
        }
        .j-share{position: fixed!important;top: 50%!important;}
                .header .logo img{max-height: 32px;}
                @media (max-width: 767px){
            .header .logo img{max-height: 26px;}
        }
                        .btn-post{
    display: block;
    margin: 0 auto;
    padding: 15px 20px;
    font-size: 16px;
    text-align: center;
    color: #fff !important;
    line-height: 1;
    background: #1471CA;
    -webkit-border-radius: 3px;
    border-radius: 3px;
    text-decoration: none;
    border: 0;
    outline: 0;
}    </style>
    <script> (function() {if (!/*@cc_on!@*/0) return;var e = "abbr, article, aside, audio, canvas, datalist, details, dialog, eventsource, figure, footer, header, hgroup, mark, menu, meter, nav, output, progress, section, time, video".split(', ');var i= e.length; while (i--){ document.createElement(e[i]) } })()</script>
    <!--[if lte IE 8]><script src="http://www.mottoin.com/wp-content/themes/JustNews/js/respond.min.js"></script><![endif]-->
</head>
<body class="post-template-default single single-post postid-105241 single-format-standard">
<header class="header">
    <div class="container clearfix">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar icon-bar-1"></span>
                <span class="icon-bar icon-bar-2"></span>
                <span class="icon-bar icon-bar-3"></span>
            </button>
            <a class="logo" href="http://www.mottoin.com"><img src="http://www.mottoin.com/img/mottoin/logo.png" alt="MottoIN"></a>
        </div>
        <div class="collapse navbar-collapse">
            <nav class="navbar-left primary-menu"><ul id="menu-%e5%af%bc%e8%88%aa" class="nav navbar-nav"><li class="menu-item menu-item-home"><a href="http://www.mottoin.com/">首页</a></li>
<li class="menu-item"><a href="http://www.mottoin.com/category/news">资讯</a></li>
<li class="menu-item current-post-ancestor dropdown"><a href="http://www.mottoin.com/category/article" class="dropdown-toggle">文章</a>
<ul role="menu" class=" dropdown-menu">
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/web">Web安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/system">系统安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/network">网络安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/terminal">终端安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/database">数据安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/wireless">无线安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/social">社会工程</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/intranet">内网渗透</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/code">代码审计</a></li>
	<li class="menu-item current-post-ancestor current-menu-parent current-post-parent"><a href="http://www.mottoin.com/category/article/reverse">逆向破解</a></li>
</ul>
</li>
<li class="menu-item"><a href="http://www.mottoin.com/category/tools">工具</a></li>
<li class="menu-item"><a href="http://www.mottoin.com/category/geek">极客</a></li>
<li class="menu-item dropdown"><a href="http://www.mottoin.com/category/sole" class="dropdown-toggle">独家</a>
<ul role="menu" class=" dropdown-menu">
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/topic">专题</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/people">人物</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/view">观点</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/events">活动</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/video">视频</a></li>
</ul>
</li>
<li class="menu-item"><a href="http://www.mottoin.com/category/hr">招聘</a></li>
<li class="menu-item"><a href="http://www.mottoin.com/forum">社区</a></li>
</ul></nav>            <div class="navbar-action pull-right">

                                    <form class="navbar-search" action="http://www.mottoin.com" method="get" role="search">
                        <input type="text" name="s" class="navbar-search-input" autocomplete="off" placeholder="输入关键词搜索..." value="">
                        <a class="navbar-search-icon j-navbar-search" href="javascript:;"></a>
                    </form>

                    
                    <div id="j-user-wrap">
                        <a class="login" href="http://www.mottoin.com/login">登录</a>
                        <a class="login" href="http://www.mottoin.com/register">注册</a>
                    </div>
                    <a class="publish" href="http://www.mottoin.com/post">
                        投稿</a>
                                                </div>
        </div><!-- /.navbar-collapse -->
    </div><!-- /.container -->
</header>
<div id="wrap">    <div class="main container">
        <div class="content">
                            <article id="post-105241" class="post-105241 post type-post status-publish format-standard has-post-thumbnail hentry category-tech category-reverse">
                    <div class="entry">
                        <div class="entry-head">
                            <h1 class="entry-title">悄然崛起的挖矿机僵尸网络：打服务器挖价值百万门罗币</h1>
                            <div class="entry-info">
                                                                <a class="nickname" href="http://www.mottoin.com/user/360/">360安全</a>
                                <span class="dot">•</span>
                                <span>2017年9月4日</span>
                                <span class="dot">•</span>
                                <a href="http://www.mottoin.com/category/tech" rel="category tag">技术控</a>, <a href="http://www.mottoin.com/category/article/reverse" rel="category tag">逆向破解</a>                                                                    <span class="dot">•</span>
                                    <span>阅读 432</span>
                                                            </div>
                        </div>
                                                                        <div class="entry-content clearfix">
                            <h3><strong>第一部分背景</strong></h3>
<p>360互联网安全中心监测到一种利用被入侵服务器进行门罗币挖矿的僵尸网络，该僵尸网络控制的服务器数量高峰时单日达到两万多台。僵尸网络建立初期利用“永恒之蓝”漏洞攻击武器入侵一定数量的计算机并以此作为僵尸网络发展的基础，之后这些计算机扫描其他计算机的1433端口（msSQL服务端口），尝试爆破目标计算机的msSQL服务，一旦爆破成功则登陆SQL Server执行恶意代码。目标计算机被僵尸网络控制之后同样会通过1433端口入侵其他计算机，僵尸网络因此不断扩大控制范围，最终形成现在这样的规模。</p>
<p>僵尸网络的蔓延离不开强大的Bot程序，通过代码同源性可以发现该家族的Bot程序的诞生最早可追溯到2014年。在2014年到2017年之间，Bot程序进行多次版本更新，最早的版本只是简单的入侵与远程控制，从2017年4月的版本开始， Bot程序借鉴多款扫描器、爆破工具以及著名僵尸网络mirai的实现，添加了多种针对不同协议的扫描爆破模块，并且实现了一套针对msSQL的“入侵+利用+传播”的攻击模块。Bot程序版本更替及传播量如下图所示。（图示中xx.x.x.x.x(x)表示的是Bot程序的版本，例如17.1.0.0.2(1)表示2017年编译的1.0.0.2版本的Bot程序变种1）</p>
<p><img class="aligncenter size-full wp-image-105242 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044975311.png" alt="" width="558" height="268" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044975311.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15044975311-300x144.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图1-1 Bot程序版本更替及感染量概览图</p>
<p>从图1-1中可以看出，Bot程序自4月底开始传播量开始出现爆发式增长，这正是作者利用“永恒之蓝”漏洞攻击武器进行僵尸网络建立的时间段。此外，Bot程序有一套完善的更新体系，当Bot程序检测到有新版本发布之后，将自动更新至最新版本。从图1种也不难看出，新版本传播量增加之后，老版本的传播量也相应地下降。</p>
<p>Bot程序当前的主要目的是安装门罗币挖矿机，利用服务器资源挖矿。截止目前，作者的门罗币钱包已经有高达1975枚门罗币，当前约合人民币167万。</p>
<p><img class="aligncenter size-full wp-image-105243 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/KHMBYQ_7_6P9L7H_9W.png" alt="" width="558" height="176" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/KHMBYQ_7_6P9L7H_9W.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/KHMBYQ_7_6P9L7H_9W-300x95.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图1-2 作者门罗币钱包概况</p>
<p>Bot程序高度模块化，集合了多种不同的功能，并且具有完善的更新和持久驻留机制。</p>
<p>对Bot程序的分析将有助于了解该僵尸网络的传播机制。本文将通过对Bot程序的详细分析，挖掘该僵尸网络的工作原理，并据此讨论服务器在面对该僵尸网络时所需的预防措施以及防御策略。</p>
<h3><strong>第二部分</strong><strong>Bot</strong><strong>程序分析</strong></h3>
<p>本文选用Bot程序2017年4月份编译的1.0.0.2版本作为分析的样本，样本MD5：10ace2e06cc8b5656d38eb2e6ed4f079。</p>
<p>Bot程序由main模块，update模块，Scanner模块，Cracker模块，ServerAgent模块和cService模块6个模块构成，模块之间互有联系，相互协作。以下将对每个模块执行的功能进行分析。</p>
<ol>
<li><strong>main</strong><strong>模块分析</strong></li>
</ol>
<p>Bot程序是以控制台形式存在的，在介绍main模块之前先介绍Bot程序所接收的启动参数以及参数对应的功能。</p>
<p><img class="aligncenter size-full wp-image-105244 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044976961.png" alt="" width="953" height="510" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044976961.png 953w, http://www.mottoin.com/wp-content/uploads/2017/09/15044976961-300x161.png 300w, http://www.mottoin.com/wp-content/uploads/2017/09/15044976961-768x411.png 768w" sizes="(max-width: 953px) 100vw, 953px" /></p>
<p style="text-align: center;">表2-1-1 Bot程序所接收的参数及对应的功能</p>
<p>这些启动参数满足以下几条规则：</p>
<p>1.当存在“-start”，“-stop”，“-create”和“-delete”中的多个时，只有第一个参数是有效的，因此作者引入“-run”参数配合“-create”参数以完成创建服务并启动服务的操作。</p>
<p>2.“-delete”参数在删除Bot服务之前会关闭该服务。</p>
<p>3.当未指定“-syn”参数时默认扫描器为TCP_CONNECT模式。</p>
<p>4.当同时存在“-srv”和“-cli”时只有第一个参数是是有效的，两者都不存在时默认为“-srv”。</p>
<p>5.当程序启动参数包含“-s”时，将以服务形式执行main模块，否则以控制台形式执行main模块。</p>
<p>main模块主要是进行一些准备工作以及配置并启用其他模块。在程序准备工作方面，主要包括以下几部分。</p>
<p>（1）获取系统信息。</p>
<p><img class="aligncenter size-full wp-image-105245 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044977401.png" alt="" width="340" height="94" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044977401.png 340w, http://www.mottoin.com/wp-content/uploads/2017/09/15044977401-300x83.png 300w" sizes="(max-width: 340px) 100vw, 340px" /></p>
<p style="text-align: center;">图2-1-1 获取系统信息</p>
<p>（2）判断系统类型是否为Server。</p>
<p><img class="aligncenter size-full wp-image-105246 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044977481.png" alt="" width="540" height="73" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044977481.png 540w, http://www.mottoin.com/wp-content/uploads/2017/09/15044977481-300x41.png 300w" sizes="(max-width: 540px) 100vw, 540px" /></p>
<p style="text-align: center;">图2-1-2 判断系统类型</p>
<p>（3）结束并禁用Network list Service和Network Location Awareness。Network list Service用于识别计算机已连接的网络，收集和存储这些网络的属性，并在更改这些属性时通知应用程序；Network Location Awareness用于收集并保存网络配置和位置信息，并在信息改动时通知应用程序。Bot程序关闭并禁用这些服务以防止自身的网络通信被记录。</p>
<p><img class="aligncenter size-full wp-image-105247 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044977541.png" alt="" width="558" height="17" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044977541.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15044977541-300x9.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-1-3 结束并禁用Network list Service和Network Location Awareness</p>
<p>（4）结束并禁用SharedAccess和MpsSvc（Intemet连接共享和防火墙服务）以保障Bot程序的网络通信能够正常进行，并且删除日志文件。</p>
<p><img class="aligncenter size-full wp-image-105248 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044978841.png" alt="" width="558" height="28" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044978841.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15044978841-300x15.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-1-4结束并禁用SharedAccess和MpsSvc</p>
<p>完成初始化工作之后，main模块将创建新线程执行update模块。update模块检查Bot程序版本并根据情况进行更新。同时，main模块还作为Scanner模块，Cracker模块和ServerAgent模块的入口。</p>
<ol>
<li><strong>update</strong><strong>模块分析</strong></li>
</ol>
<p><strong> </strong>update模块是Bot程序进行自更新的模块。当程序执行main模块时，将创建线程执行update模块进行版本检查及必要的更新。update模块每6小时进行一次更新检查。</p>
<p><img class="aligncenter size-full wp-image-105249 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044979381.png" alt="" width="558" height="91" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044979381.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15044979381-300x49.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-2-1 创建线程执行update模块</p>
<p><img class="aligncenter size-full wp-image-105250 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044979471.png" alt="" width="196" height="25" /></p>
<p style="text-align: center;">图2-2-2 调用Sleep函数以定期执行update模块</p>
<p>进行更新检查时，update模块首先获取程序当前的版本号，之后通过博客地址“http://blog.sina.com.cn/s/blog_16fb721c50102x6hw.html”获得加密后的C&amp;C的ip地址。将加密后的ip地址去除首尾的分隔符（***和@@@），经过base64解密并与0x36异或之后得到真实的ip地址（在本样本中，C&amp;C ip地址为67.229.144.218，以下简称为“ip”）。</p>
<p><img class="aligncenter size-full wp-image-105251 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044979561.png" alt="" width="333" height="167" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044979561.png 333w, http://www.mottoin.com/wp-content/uploads/2017/09/15044979561-300x150.png 300w" sizes="(max-width: 333px) 100vw, 333px" /></p>
<p>http://ip:8888/ver.txt中存放最新的Bot程序版本号，update模块读取该版本号并与当前Bot程序的版本号进行对比。当两者相同时，则认为程序已经更新到最新版本，继续执行后续功能；当两者不同时，则对程序进行更新。</p>
<p><img class="aligncenter size-full wp-image-105252 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044979671.png" alt="" width="558" height="161" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044979671.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15044979671-300x87.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-2-4 对比Bot程序版本和最新版本号</p>
<p><img class="aligncenter size-full wp-image-105253 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044979721.png" alt="" width="328" height="73" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044979721.png 328w, http://www.mottoin.com/wp-content/uploads/2017/09/15044979721-300x67.png 300w" sizes="(max-width: 328px) 100vw, 328px" /></p>
<p style="text-align: center;">图2-2-5 最新的版本号</p>
<p>若Bot程序未更新到最新版本，则进行更新。最新版本的Bot程序通过路径C://windows/system下的更新程序cabs.exe获取。若cabs.exe不存在，则Bot程序将从http://ip:8888/ups.rar下载cab.exe，并启动该程序进行更新。</p>
<p><img class="aligncenter size-full wp-image-105254 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044979781.png" alt="" width="558" height="289" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044979781.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15044979781-300x155.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-2-5 下载更新程序cab.exe并启动更新</p>
<p>cabs.exe会判断当前计算机系统是否为Windows Server，只有当当前计算机系统为Windows Server时才会执行更新。</p>
<p><img class="aligncenter size-full wp-image-105255 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044979841.png" alt="" width="428" height="158" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044979841.png 428w, http://www.mottoin.com/wp-content/uploads/2017/09/15044979841-300x111.png 300w" sizes="(max-width: 428px) 100vw, 428px" /></p>
<p style="text-align: center;">图2-2-6 判断当前系统是否为Windows Server</p>
<p>如果当前计算机系统为Windows Server，则访问http://ip:8888/update.txt获取最新的下载列表，并将下载列表下载到c:\\windows\\system路径下，命名为upslist.txt。</p>
<p><img class="aligncenter size-full wp-image-105256 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044979921.png" alt="" width="447" height="70" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044979921.png 447w, http://www.mottoin.com/wp-content/uploads/2017/09/15044979921-300x47.png 300w" sizes="(max-width: 447px) 100vw, 447px" /></p>
<p style="text-align: center;">图2-2-7 下载下载列表</p>
<p>下载列表中包含两个文件ps.jpg和my1.html。</p>
<p><img class="aligncenter size-full wp-image-105257 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044979981.png" alt="" width="425" height="50" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044979981.png 425w, http://www.mottoin.com/wp-content/uploads/2017/09/15044979981-300x35.png 300w" sizes="(max-width: 425px) 100vw, 425px" /></p>
<p style="text-align: center;">图2-2-8 下载列表内容</p>
<p>ps.jpg是末尾拼接了一个PE文件的图片。该PE文件就是最新版本的Bot程序。</p>
<p><img class="aligncenter size-full wp-image-105258 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044980041.png" alt="" width="201" height="232" /></p>
<p style="text-align: center;">图2-2-9 藏有最新版本Bot程序的图片</p>
<p><img class="aligncenter size-full wp-image-105259 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044980101.png" alt="" width="539" height="70" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044980101.png 539w, http://www.mottoin.com/wp-content/uploads/2017/09/15044980101-300x39.png 300w" sizes="(max-width: 539px) 100vw, 539px" /></p>
<p style="text-align: center;">图2-2-10 图片中监测到的PE文件特征</p>
<p>my1.html是一个批处理脚本，功能与Cracker:mssql模块释放的批处理脚本123.dat基本相同，主要是创建一些需要的文件夹并为之后Cracker模块配置环境。</p>
<p>完成下载之后，cabs.exe会结束Bot程序的进程和服务，更新相关文件之后再重启Bot进程和服务。</p>
<ol>
<li><strong>scanner</strong><strong>模块分析</strong></li>
</ol>
<p>scanner模块修改自masscan（github：https://github.com/robertdavidgraham/masscan）。masscan是一个快速、灵活的端口扫描器，在windows下发包速度可达到每秒30万包。</p>
<p>在调用scanner模块进行扫描之前，Bot程序会配置一个excludefile，该文件指定ip段黑名单，在该范围中的ip地址将不会被扫描。ip黑名单以字符串的形式存放在Bot程序的资源段中，scanner模块在临时文件夹下创建excludefile，读取资源后将ip黑名单写入excludefile。</p>
<p><img class="aligncenter size-full wp-image-105260 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044980181.png" alt="" width="558" height="412" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044980181.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15044980181-300x222.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-3-1 读取ip黑名单资源并写入excludefile</p>
<p>在Bot程序2017年四月份编译的1.0.0.2版本和五月份编译的1.0.0.3版本的其中一个变种中未发现ip黑名单，在五月份编译的1.0.0.3版本的另一个变种中发现了ip黑名单。</p>
<p><img class="aligncenter size-full wp-image-105261 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044980241.png" alt="" width="450" height="407" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044980241.png 450w, http://www.mottoin.com/wp-content/uploads/2017/09/15044980241-300x271.png 300w" sizes="(max-width: 450px) 100vw, 450px" /></p>
<p style="text-align: center;">图2-3-2 存放在Bot程序资源段中的ip黑名单</p>
<p>对于每一个a类ip，scaner模块排除掉部分b段。由于全网扫描容易遭到监控，通过排除部分ip地址可以减少被发现的风险。</p>
<p><img class="aligncenter size-full wp-image-105262 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044980301.png" alt="" width="366" height="69" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044980301.png 366w, http://www.mottoin.com/wp-content/uploads/2017/09/15044980301-300x57.png 300w" sizes="(max-width: 366px) 100vw, 366px" /></p>
<p style="text-align: center;">图2-3-3 scanner模块排除部分ip地址后扫描全网</p>
<p>scanner模块能够扫描的端口包括1433端口，3306端口，135端口，22端口，445端口，23端口，80端口和3389端口。</p>
<p><img class="aligncenter size-full wp-image-105263 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044980361.png" alt="" width="558" height="187" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044980361.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15044980361-300x101.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-3-4 部分scanner模块扫描的端口</p>
<p>scanner模块可通过两种模式进行端口扫描，分别是TCP_SYN扫描和TCP_CONNECT扫描。使用何种扫描模式由参数“-syn”决定，如果启动参数包含“-syn”则选择使用TCP_SYN模式进行端口扫描，否则选择TCP_CONNECT模式进行端口扫描。当选择TCP_SYN模式进行端口扫描时，Bot程序只发送SYN帧，端口开放回应SYN&amp;ACK帧，端口关闭回应RST帧，；当选择TCP_CONNECT模式进行端口扫描时，Bot程序尝试连接目标端口，端口开放则连接成功，否则连接失败。</p>
<p>Scanner模块创建的最大扫描线程数由“-t”参数决定，“-t”的最大值为1800。在scanner模块创建扫描线程的同时会同时创建名为“CrackerWMI”的线程，但是在Bot程序发送的数据包中并未发现目的端口为135（wmi服务使用的端口）的数据包，推测可能是作者预留的尚未完善的功能。</p>
<p><img class="aligncenter size-full wp-image-105264 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15044980441.png" alt="" width="558" height="515" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15044980441.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15044980441-300x277.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-3-5 两种不同的扫描模式</p>
<p>scanner模块会记录开放特定端口的ip地址，并且与ServerAgent模块和Cracker模块进行交互完成“端口扫描+爆破+入侵”一系列工作。</p>
<ol>
<li><strong>ServerAgent</strong><strong>模块分析</strong></li>
</ol>
<p>ServerAgent模块由两部分功能组成。一是向C&amp;C发送扫描结果；二是对端口扫描和爆破进行相应的配置工作。</p>
<p>ServerAgent模块在scanner模块扫描过程中连接C&amp;C。当scanner模块扫描到开放的端口之后，ServerAgent模块将把对应的ip地址和端口号发送至C&amp;C。</p>
<p><img class="aligncenter size-full wp-image-105265 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045048721.png" alt="" width="558" height="169" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045048721.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045048721-300x91.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-4-1 ServerAgent模块连接C&amp;C</p>
<p>此外，ServerAgent模块下载密码字典并为Cracker模块配置密码字典，当scanner模块扫描到某ip地址的特定端口为开放状态时，将通过该字典进行爆破。字典的下载地址为http://ip:8888/wpd.dat，当下载完成之后，ServerAgent模块将从http://ip:8888/wpdmd5.txt获取正确的密码字典的MD5值并与下载的字典wpd.dat的MD5值进行对比以确定下载文件的正确性。下载的密码字典wpd.dat是经过加密的，ServerAgent模块读取密钥“cm9vdCpwd2Q=”，对密钥进行base64解密后，使用其解密wpt.dat。解密后的wpd.dat部分内容如下图所示。</p>
<p><img class="aligncenter size-full wp-image-105266 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045048801.png" alt="" width="291" height="334" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045048801.png 291w, http://www.mottoin.com/wp-content/uploads/2017/09/15045048801-261x300.png 261w" sizes="(max-width: 291px) 100vw, 291px" /></p>
<p style="text-align: center;">图2-4-2 密码字典的部分内容</p>
<p>wpd.dat实际上是一个xml文件，里面包含mysql，mssql，telnet，wmi，ssh，rdp的密码字典以及不同的入侵方式执行的shell。此外，wpd.dat中存在一个名为ports的键，当该键的某个子健键值为1时，ServerAgent模块将配置scanner模块使其扫描该子键对应的端口。</p>
<p><img class="aligncenter size-full wp-image-105267 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045048851.png" alt="" width="163" height="157" /></p>
<p style="text-align: center;">图2-4-3 ports键概览</p>
<p>在默认的wpd.dat中，只有mssql子键的值设为1，因此scanner模块只扫描mssql服务对应的端口（端口号1433）。黑客可以通过配置wpd.dat文件增加、减少、修改扫描端口的数目和类别。</p>
<p><img class="aligncenter size-full wp-image-105268 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045048911.png" alt="" width="558" height="85" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045048911.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045048911-300x46.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-4-4 从抓包数据发现Bot程序只扫描1433端口</p>
<p>有趣的是，ServerAgent模块选择随机的ip段作为每一轮扫描的ip范围，这和mirai僵尸网络的做法十分相似。如下所示，get_random_ip函数生成的随机ip段为220.176.171.93~220.182.171.87，因此本轮扫描中scanner模块对该ip段进行扫描。</p>
<p><img class="aligncenter size-full wp-image-105269 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045048981.png" alt="" width="558" height="228" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045048981.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045048981-300x123.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-4-5 ServerAgent模块计算并选取随机ip段</p>
<p><img class="aligncenter size-full wp-image-105270 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045049061.png" alt="" width="342" height="42" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045049061.png 342w, http://www.mottoin.com/wp-content/uploads/2017/09/15045049061-300x37.png 300w" sizes="(max-width: 342px) 100vw, 342px" /></p>
<p style="text-align: center;">图2-4-6 测试中生成的随机ip段</p>
<p><img class="aligncenter size-full wp-image-105271 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045049111.png" alt="" width="558" height="65" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045049111.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045049111-300x35.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-4-7 从抓包数据中发现此轮扫描中Bot程序扫描其随机生成的ip段</p>
<p style="text-align: left;"><strong>Cracker</strong><strong>模块分析</strong></p>
<p>Cracker模块是Bot程序中最重要的模块。该模块用于入侵目标计算机并在目标计算机上执行恶意代码。Cracker模块分为多个小模块，在分析的样本中包括Cracker:CCTV，Cracker:mssql， Cracker:RDP，Cracker:Telnet四个小模块。按照入侵的端口的不同，Cracker模块提供不同的攻击方式。下面将介绍每一种攻击的实现。</p>
<p><strong>5.1  Cracker:mssql</strong></p>
<p>由于Bot程序默认的密码字典wpd.dat中指定扫描的服务为msSQL，因此Cracker:mssql模块是所有Cracker模块中功能最为完善的。在大部分被感染的服务器的msSQL服务中都可以发现该模块所执行的恶意动作。</p>
<p>Cracker:mssql模块首先使用爆破字典爆破目标的msSQL服务。如果成功爆破目标，则登陆SQL Server执行下一步操作。</p>
<p>登陆SQL Server之后，需要在SQL Server中获得执行shell的权限，因此Cracker:mssql模块使用多种方式尝试获得执行shell的权限，包括：</p>
<p>恢复xp_cmdshell。</p>
<p><img class="aligncenter size-full wp-image-105272 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045049191.png" alt="" width="412" height="26" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045049191.png 412w, http://www.mottoin.com/wp-content/uploads/2017/09/15045049191-300x19.png 300w" sizes="(max-width: 412px) 100vw, 412px" /></p>
<p style="text-align: center;">图2-5-1 恢复xp_cmdshell</p>
<p style="text-align: left;">开启被禁止的xp_cmdshell。</p>
<p><img class="aligncenter size-full wp-image-105273 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045049241.png" alt="" width="558" height="30" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045049241.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045049241-300x16.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-2 开启xp_cmdshell</p>
<p>xp_cmdshell被删除后，使用SP_OACreate执行shell。</p>
<p><img class="aligncenter size-full wp-image-105274 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045049301.png" alt="" width="558" height="40" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045049301.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045049301-300x22.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-3 使用SP_OACreate执行shell</p>
<p>开启CLR enabled选项，使用SQL Server CLR执行shell。</p>
<p><img class="aligncenter size-full wp-image-105275 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045049361.png" alt="" width="558" height="29" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045049361.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045049361-300x16.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-4 开启CLR enabled选项</p>
<p>注册regsvr32.dll执行远端代码所需的组件，使用regsvr32.dll执行shell。</p>
<p><img class="aligncenter size-full wp-image-105276 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045049421.png" alt="" width="558" height="44" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045049421.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045049421-300x24.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-5 注册相关组件</p>
<p style="text-align: left;">通过沙盒执行shell。</p>
<p><img class="aligncenter size-full wp-image-105277 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045049481.png" alt="" width="558" height="30" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045049481.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045049481-300x16.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">2-5-6 通过沙盒执行shell</p>
<p style="text-align: left;">开启SQL Agent服务，使用SQL Agent服务执行shell。</p>
<p><img class="aligncenter size-full wp-image-105278 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045049541.png" alt="" width="376" height="31" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045049541.png 376w, http://www.mottoin.com/wp-content/uploads/2017/09/15045049541-300x25.png 300w" sizes="(max-width: 376px) 100vw, 376px" /></p>
<p style="text-align: center;">图2-5-7 开启SQL Agent服务</p>
<p>Cracker:mssql模块所执行的主要功能主要包括以下几方面：</p>
<p>在c:\\windows\system32\wbem下创建批处理文件dat，并在该文件中写入内容。</p>
<p><img class="aligncenter size-full wp-image-105279 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045049611.png" alt="" width="558" height="152" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045049611.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045049611-300x82.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-8 创建123.bat</p>
<p>该批处理文件执行的功能包括对一些程序运行所涉及到的文件和文件夹进行权限设置；使用regsvr32.dll执行远端代码；判断是否存在item.dat，若存在则调用rundll32执行该程序。item.dat是修改自PCShare（github：https://github.com/isuhao/pcshare）的远程控制程序，C&amp;C通过item.dat控制Bot。</p>
<p>创建文件ini，并在该文件中写入内容。</p>
<p><img class="aligncenter size-full wp-image-105280 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045049681.png" alt="" width="558" height="154" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045049681.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045049681-300x83.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-9 创建PerfStringse.ini</p>
<p>该文件是个组策略模板文件，主要是禁止一些涉及到的文件的访问权限。在创建该模板文件之后调用secedit.exe配置组策略。</p>
<p><img class="aligncenter size-full wp-image-105281 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045049741.png" alt="" width="558" height="41" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045049741.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045049741-300x22.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-10 调用secedit.exe配置组策略</p>
<p style="text-align: left;">在c:\\windows\system下创建文件dvr，并在文件中写入内容。</p>
<p><img class="aligncenter size-full wp-image-105282 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045049811.png" alt="" width="558" height="74" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045049811.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045049811-300x40.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-11 创建myusa.dvr</p>
<p>myusa.dvr是个ftp下载脚本，主要功能是从down.mys2016.info下载文件1.dat到本地c:\\windows\system路径下，命名为myusago.dvr；下载1.bat到本地c:\\windows\system路径下，命名为backs.bat。</p>
<p>myusago.dvr也是个ftp下载脚本，从down.mys2016.info下载多个文件到本地；backs.bat用于记录系统时间并写入1.txt中。</p>
<p><img class="aligncenter size-full wp-image-105283 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045049871.png" alt="" width="363" height="138" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045049871.png 363w, http://www.mottoin.com/wp-content/uploads/2017/09/15045049871-300x114.png 300w" sizes="(max-width: 363px) 100vw, 363px" /></p>
<p style="text-align: center;">图2-5-12 myusago.dvr内容</p>
<p>下载的文件中，item.dat是C&amp;C用于控制Bot的远程控制软件；ms.rar实际上就是Bot程序的更新程序cab.exe；ss.bat和Cracker:mssql模块释放的123.bat是同一个文件；未找到op7key.rar文件，猜测与爆破字典类似。</p>
<p>从myusago.dvr下载的文件不难看出，Bot程序除了执行Cracker:mssql模块中硬编码的恶意代码之外，还通过云端下载相应的恶意程序，这保障与Bot程序相关联的恶意代码能够持续驻留。在分析的过程中我们发现，用于进行环境配置和程序运行控制的123.bat批处理脚本是更新最为频繁的，从2017年4月份起更新次数超过了10次。</p>
<p>myusago.dvr和myusa.dvr将作为ftp的参数写入命令行中并加入SQL Agent的Job中，每天执行一次。</p>
<p>将Bot程序加入SQL Agent的job中，并附带参数“-syn 1000”。每次SQL Agent启动时Bot程序也将启动。</p>
<p><img class="aligncenter size-full wp-image-105284 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045049931.png" alt="" width="558" height="30" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045049931.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045049931-300x16.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-13 将Bot程序加入SQL Agent的Job中</p>
<p style="text-align: left;">以Job的形式每20分钟运行一次C：\\Progra~1\mainsoft\install.exe。该程序是一个挂机赚分软件。</p>
<p><img class="aligncenter size-full wp-image-105285 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045049981.png" alt="" width="558" height="54" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045049981.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045049981-300x29.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-14 以Job形式执行install.exe</p>
<p style="text-align: left;">以Job的形式每20分钟执行C:\\windows\debug，C:\\Progra~1\\shengda和C:\\Progra~1\\kugou2010路径下的所有exe。从我们的监控中发现，Bot程序所释放的挖矿机以及能给黑客带来直接收益的程序都存在于这几个路径中，黑客通过定时启动这些程序保证收益的源源不断。</p>
<p><img class="aligncenter size-full wp-image-105286 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045050051.png" alt="" width="558" height="30" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045050051.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045050051-300x16.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-15 定时执行C:\\windows\debug下的exe</p>
<p><img class="aligncenter size-full wp-image-105287 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045050181.png" alt="" width="558" height="28" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045050181.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045050181-300x15.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-16 定时执行C:\\Progra~1\\shengda下的exe</p>
<p><img class="aligncenter size-full wp-image-105288 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045050231.png" alt="" width="558" height="28" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045050231.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045050231-300x15.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-17 定时执行C:\\Progra~1\\kugou2010下的exe</p>
<p>创建ftp下载脚本msinfo.dat，该脚本从down.mys2016.info下载文件到C:\\windows\debug路径下，并命名为bss.exe。之后通过批处理脚本msinfo.bat调用ftp执行下载脚本，下载完成后启动bss.exe，并删除这两个脚本。bss.exe疑似是个远控木马。</p>
<p><img class="aligncenter size-full wp-image-105289 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045050301.png" alt="" width="297" height="91" /></p>
<p style="text-align: center;">图2-5-18 msinfo.dat内容</p>
<p><img class="aligncenter size-full wp-image-105290 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045050361.png" alt="" width="339" height="86" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045050361.png 339w, http://www.mottoin.com/wp-content/uploads/2017/09/15045050361-300x76.png 300w" sizes="(max-width: 339px) 100vw, 339px" /></p>
<p style="text-align: center;">图2-5-19 msinfo.bat内容</p>
<p style="text-align: left;">将dat和123.bat加入启动项中。</p>
<p><img class="aligncenter size-full wp-image-105291 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045050411.png" alt="" width="558" height="31" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045050411.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045050411-300x17.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-20 将item.dat加入启动项中</p>
<p><img class="aligncenter size-full wp-image-105292 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045050451.png" alt="" width="558" height="29" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045050451.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045050451-300x16.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-21 将123.bat加入启动项中</p>
<p style="text-align: left;">确定权限允许之后，删除SQL用户，并设置SQL SA（超级管理员）帐户及密码，同时添加多个SQL帐户。完成这步操作之后，黑客正式接管该计算机的SQL Server，管理员无法再通过之前的帐户登录SQL Server。</p>
<p><img class="aligncenter size-full wp-image-105293 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045050521.png" alt="" width="558" height="23" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045050521.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045050521-300x12.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-22 添加SQL SA</p>
<p>Cracker:mssql模块还通过SQL Server执行多段shellcode，大部分的shellcode都以SQL Agent的Job形式存在并定期执行。</p>
<p>第一段shellcode使用wmi中的ActiveScriptEventConsumer类执行脚本代码。该脚本读取http://www.cyg2016.xyz:8888/test.html网页内容，并根据网页内容获取第二组网址，下载文件并执行。</p>
<p><img class="aligncenter size-full wp-image-105294 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045050581.png" alt="" width="558" height="177" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045050581.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045050581-300x95.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-23 第一段shellcode内容</p>
<p>下载的文件包括更新程序cabs.exe和挖矿机lsmosee.exe。挖矿机修改自xmr-stak（github：https://github.com/fireice-uk/xmr-stak-cpu），以32位形式编译，作者在此挖矿机中添加了一个模块，当需要64位挖矿机时，该模块将从C&amp;C下载64位的挖矿机lsmose.exe到本地执行。本样本中，32位挖矿机的路径为“C:\\windows\help”，而64位挖矿机的路径修改为“C:\\windows\debug”。由于作者添加了SQL Agent的Job，使“C:\\windows\debug”路径下的exe文件每20分钟执行一次，猜测作者将挖矿机保存到此目录下是为了保证挖矿机能够稳定运行。</p>
<p><img class="aligncenter size-full wp-image-105295 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045050631.png" alt="" width="558" height="22" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045050631.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045050631-300x12.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-24 下载挖矿机和更新程序</p>
<p>第二段shellcode使用js脚本执行恶意代码，脚本功能与第一段shellcode中的jscript代码相同。</p>
<p><img class="aligncenter size-full wp-image-105296 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045050681.png" alt="" width="558" height="49" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045050681.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045050681-300x26.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-25 第二段shellcode内容</p>
<p>第三段shellcode同样使用wmi脚本执行jscript代码，所执行的功能与创建的批处理文件123.bat的功能相同，猜测作者此举为了防止文件123.bat被杀毒软件清除而执行的备用方案。</p>
<p><img class="aligncenter size-full wp-image-105294 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045050581.png" alt="" width="558" height="177" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045050581.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045050581-300x95.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-26 第三段shellcode内容</p>
<p>第四段shellcode是第三段shellcode的js版本。不难发现，作者对于每段shellcode都准备了wmi和js两种版本，以确保脚本执行的稳定性。</p>
<p><img class="aligncenter size-full wp-image-105298 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045050851.png" alt="" width="558" height="74" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045050851.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045050851-300x40.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-27 第四段shellcode内容</p>
<p>第五段shellcode通过恢复cmdshell，恢复SP_OACreate等方式保证能通过SQL Server执行shell，猜测作者通过Job定期执行这段shellcode以保证shell能长期存活。</p>
<p><img class="aligncenter size-full wp-image-105299 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045050891.png" alt="" width="558" height="55" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045050891.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045050891-300x30.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-28 第五段shellcode内容</p>
<p>第六段shellcode删除C:\\Documents and Settings\Default User\Local Settings\Temporary Internet Files\Content.IE5路径下的文件。由于下载文件时都会在该目录下留下对应的tmp文件，作者此举是为了防止用户通过该目录发现可疑文件，可见作者对痕迹的清理十分细心。</p>
<p><img class="aligncenter size-full wp-image-105300 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045050951.png" alt="" width="558" height="64" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045050951.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045050951-300x34.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-29 第六段shellcode内容</p>
<p>第七段shellcode使用js脚本访问http://www.cyg2016.xyz:8888/kill.html，该页面是个文件名列表。脚本搜寻系统中是否存在与该页面返回的文件名相同的文件，若存在则结束对应进程并将文件删除。这些文件大多数是一些其他入侵者释放的挖矿机。</p>
<p><img class="aligncenter size-full wp-image-105301 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045051011.png" alt="" width="558" height="45" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045051011.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045051011-300x24.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-30 第七段shellcode内容</p>
<p>透过这些文件名我们发现了一个有趣的现象，在被删除的文件中包含了一些和Bot程序释放的挖矿机文件名十分相似的文件，例如C:\\windows\debug\lsmosee.exe（Bot程序释放的挖矿机是c:\\windows\help\lsmosee.exe和C:\\windows\debug\lsmose.exe）。是作者通过这样的方式进行更新，淘汰旧的挖矿机，还是其他入侵者利用Bot程序定时执行C:\\windows\debug路径下程序的特性坐收渔翁之利就不得而知了。</p>
<p><img class="aligncenter size-full wp-image-105302 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045051081.png" alt="" width="558" height="38" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045051081.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045051081-300x20.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-31 待删除文件列表</p>
<p>第八段shellcode将123.bat加入启动项中，此处不再赘述。</p>
<p>第九段shellcode从http://down.mys2016.info:280下载文件到C:\\WINDOWS路径下，并命名为ps.exe。ps.exe实际上是PsExec，一款强大的远程执行工具，黑客在每台入侵的计算中部署该工具，使每台计算机成为一个控制端，方便构建一个庞大的僵尸网络。</p>
<p><img class="aligncenter size-full wp-image-105303 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045051141.png" alt="" width="558" height="41" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045051141.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045051141-300x22.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-32 第九段shellcode内容</p>
<p>第十段shellcode主要是完成SQL提权的一系列操作。</p>
<p><img class="aligncenter size-full wp-image-105304 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045051201.png" alt="" width="558" height="151" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045051201.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045051201-300x81.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-33 第十段shellcode内容</p>
<p>第十一段shellcode是利用SQL Server CLR执行shell的payload，从payload中可以发现其访问http://www.cyg2016.xyz:8888/clr.txt并执行该页面中返回的内容。</p>
<p><img class="aligncenter size-full wp-image-105305 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045051261.png" alt="" width="143" height="224" /></p>
<p style="text-align: center;">图2-5-34payload的部分内容</p>
<p>该页面和http://www.cyg2016.xyz:8888/test.html一致，即下载更新程序和挖矿机到计算机中并运行。</p>
<p>Cracker:mssql模块完成了Bot程序几乎所有要完成的功能，包括更新、挖矿、清除同类程序、定时任务以及SQL Server管理员账户的设置。由于作者目前的密码字典中将mssql作为唯一攻击目标，因此Cracker:mssql模块如此完善也是可以理解的。若之后作者开启了其他攻击方式，其他的Cracker模块也将变得更加完善。</p>
<p><strong>Cracker:Telnet</strong></p>
<p>Cracker:Telnet模块是除了Cracker:mssql模块之外较为完善的一个模块。作者充分利用mirai僵尸网络的优点构建了一套类似于mirai的Telnet入侵模块。</p>
<p>在执行Cracker:Telnet模块之前，Bot程序在ServerAgent模块中配置Telnet入侵攻击的payload。ServerAgent模块会根据不同的平台架构从资源段中读取payload并将其转化为十六进制字节码的形式。</p>
<p><img class="aligncenter size-full wp-image-105306 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045102341.png" alt="" width="548" height="144" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045102341.png 548w, http://www.mottoin.com/wp-content/uploads/2017/09/15045102341-300x79.png 300w" sizes="(max-width: 548px) 100vw, 548px" /></p>
<p style="text-align: center;">图2-5-35 从资源段读取payload</p>
<p>在payload中我们发现一些mirai相关的标识，通过对比发现Bot程序所使用的payload就是mirai僵尸网络的payload（github：https://github.com/jgamblin/Mirai-Source-Code/tree/master/loader/bins），这些payload适用于不同的平台架构（arm，arm7，m68k，mips，mpsl，ppc，sh4，spc，x86）。</p>
<p><img class="aligncenter size-full wp-image-105307 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045102391.png" alt="" width="137" height="133" /></p>
<p style="text-align: center;">图2-5-36 payload中mirai的相关标识</p>
<p>除了payload与mirai相同之外，Cracker:Telnet模块也基本修改自mirai源码，包含密码爆破功能和入侵功能。</p>
<p><img class="aligncenter size-full wp-image-105308 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045102441.png" alt="" width="558" height="134" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045102441.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045102441-300x72.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-37 Cracker:Telnet模块中的mirai特征</p>
<p>mirai在通过Telnet入侵之前会配置一个ip地址用于作为report服务器地址，用于返回扫描结果，在分析中我们也发现了一个疑似report服务器ip地址。如果Bot程序的启动参数中包含“-srv”，则ServerAgent模块会从密码字典中读取名为telnetip的子键的键值，该键值是个ip地址，之后被传入Cracker:Telnet模块中。如果启动参数中包含“-cli”，Bot程序会从当前目录下的wpdconfig.ini文件中读取ip地址。</p>
<p><img class="aligncenter size-full wp-image-105309 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045102511.png" alt="" width="267" height="66" /></p>
<p style="text-align: center;">图2-5-38 密码字典中的report服务器地址</p>
<p>由于Cracker:Telnet模块与mirai相差无几，在此不再赘述，感兴趣的读者可以查看mirai源码（github：https://github.com/jgamblin/Mirai-Source-Code）。</p>
<p><strong>Cracker:RDP</strong></p>
<p>Cracker:RDP模块修改自hydra（github：https://github.com/vanhauser-thc/thc-hydra）的RDP部分。hydra是一款支持多种网络服务的强大的暴力破解工具，Cracker:RDP模块使用了其源码中的rdp.c文件，用于对开放了RDP服务端口的计算机进行爆破。不同于Cracker:mssql模块和Cracker:Telnet模块，Cracker:RDP模块只是进行爆破而未加入任何入侵以及代码执行的功能。</p>
<p><img class="aligncenter size-full wp-image-105310 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045102581.png" alt="" width="558" height="168" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045102581.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045102581-300x90.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-39 Cracker:RDP模块扫描端口</p>
<p><strong>Cracker:CCTV</strong></p>
<p>Cracker:CCTV模块是一个CCTV摄像头入侵模块。该模块会向http://Targetip:port/shell?&#8230;（…的内容猜测是用户名&amp;密码）发送GET请求，一旦请求返回的状态值不为400，401，403，404或500，则认为该ip地址和端口号对应的CCTV摄像头可以被入侵。</p>
<p><img class="aligncenter size-full wp-image-105311 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045102631.png" alt="" width="558" height="119" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045102631.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045102631-300x64.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-40 Cracker:CCTV模块扫描CCTV摄像头</p>
<p>由于在密码字典wpd.dat中并没有配置CCTV相关的键值,猜测该模块是和Cracker:Telnet模块结合使用的。由于mirai中含有识别特定IOT设备的代码，而Cracker:Telnet模块又是修改自mirai，猜测当Cracker:Telnet模块发现某台设备为CCTV摄像机时则通过Cracker:CCTV模块进行入侵。</p>
<p><strong>其他模块</strong></p>
<p>在Bot程序早期的版本中（2016年10月编译的版本）还发现了Cracker:MySQL模块，Cracker:SSH模块和Cracker:WMI模块，这些模块的功能都是在被入侵的计算机中执行shell。</p>
<p><img class="aligncenter size-full wp-image-105312 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045102691.png" alt="" width="558" height="134" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045102691.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045102691-300x72.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-41 Cracker:MySQL模块</p>
<p><img class="aligncenter size-full wp-image-105313 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045102741.png" alt="" width="558" height="40" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045102741.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045102741-300x22.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-41 Cracker:WMI模块</p>
<p><img class="aligncenter size-full wp-image-105314 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045102811.png" alt="" width="558" height="93" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045102811.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045102811-300x50.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-5-41 Cracker:WMI模块</p>
<p>不过这几个模块在之后的版本中都被移除了，而原本功能简单的Cracker:mssql模块在之后的版本中得到了完善。</p>
<p><strong>cService</strong><strong>模块分析</strong></p>
<p>cService模块用于管理Bot服务，Bot服务是Service形式的Bot程序。</p>
<p>当Bot程序的启动参数中包含“-create”时，cService模块创建名为“xWinWpdSrv”的服务，该服务以“-s –syn 1500”作为启动参数启动Bot程序。</p>
<p><img class="aligncenter size-full wp-image-105315 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045102881.png" alt="" width="558" height="239" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045102881.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045102881-300x128.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-6-1 创建Bot服务</p>
<p>当Bot程序的启动参数包含“-delete”时，cService模块删除“xWinWpdSrv”服务。</p>
<p><img class="aligncenter size-full wp-image-105316 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045102931.png" alt="" width="558" height="164" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045102931.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045102931-300x88.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-6-2 删除Bot服务</p>
<p>当Bot程序的启动参数包含“-start”时，cService模块启动“xWinWpdSrv”服务。</p>
<p><img class="aligncenter size-full wp-image-105317 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045102991.png" alt="" width="558" height="116" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045102991.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045102991-300x62.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-6-3 启动Bot服务</p>
<p>当Bot程序的启动参数包含“-stop”时，cService模块停止“xWinWpdSrv”服务。</p>
<p><img class="aligncenter size-full wp-image-105318 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045103051.png" alt="" width="558" height="129" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045103051.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045103051-300x69.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-6-4 停止Bot服务</p>
<p>Bot程序模块众多，并且各模块之间关系紧密，相互配合。此外，Bot程序与其他组件相辅相成，以保证攻击者对计算机的持久控制以及僵尸网络的不断壮大。以下将用一个关系图描述Bot程序与其他组件之间的关联。</p>
<p><img class="aligncenter size-full wp-image-105319 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045103151.png" alt="" width="558" height="236" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045103151.png 558w, http://www.mottoin.com/wp-content/uploads/2017/09/15045103151-300x127.png 300w" sizes="(max-width: 558px) 100vw, 558px" /></p>
<p style="text-align: center;">图2-6-5 Bot程序与其他组件关系图</p>
<h3><strong>第三部分 防御总结</strong></h3>
<p>从僵尸网络当前的攻击重点来看，防范其通过1433端口入侵计算机是非常有必要的。此外，Bot程序还有多种攻击方式尚未使用，这些攻击方式可能在未来的某一天被开启，因此也需要防范可能发生的攻击。对此，我们总结以下几个防御策略：</p>
<p>1.对于未遭到入侵的服务器，注意msSQL，RDP，Telnet等服务的弱口令问题。如果这些服务设置了弱口令，需要尽快修改；</p>
<p>2.对于无需使用的服务不要随意开放，开放的服务是黑客入侵的前提。对于必须使用的服务，注意相关服务的弱口令问题；</p>
<p>3.特别注意445端口的开放情况。由于黑客曾经使用永恒之蓝漏洞入侵计算机，不排除黑客故技重施。及时打上补丁更新操作系统是非常有必要的。</p>
<p>4.关注服务器运行状况，注意CPU占用率和进程列表和网络流量情况可以及时发现系统存在的异常。此外，注意系统账户情况，禁用不必要的账户。</p>
<p>5.对于网络摄像头持有者，建议修改默认密码以防止黑客直接使用默认密码爆破。</p>
<p>该僵尸网络现今主要依靠端口扫描和弱口令爆破进行传播，但其在“永恒之蓝”漏洞攻击武器出现之初就利用该武器入侵了一定数量的计算机，可见其对于最新曝光的漏洞利用以及攻击方法的掌握十分迅速，因此需时刻警惕其可能发起的重大攻击。</p>
<h3><strong>附录</strong></h3>
<p><strong>相关文件MD5</strong></p>
<p><img class="aligncenter size-full wp-image-105320 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045103331.png" alt="" width="888" height="681" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045103331.png 888w, http://www.mottoin.com/wp-content/uploads/2017/09/15045103331-300x230.png 300w, http://www.mottoin.com/wp-content/uploads/2017/09/15045103331-768x589.png 768w" sizes="(max-width: 888px) 100vw, 888px" /><strong>相关ip地址和域名</strong></p>
<p><img class="aligncenter size-full wp-image-105321 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045103521.png" alt="" width="876" height="593" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045103521.png 876w, http://www.mottoin.com/wp-content/uploads/2017/09/15045103521-300x203.png 300w, http://www.mottoin.com/wp-content/uploads/2017/09/15045103521-768x520.png 768w" sizes="(max-width: 876px) 100vw, 876px" /><strong>密码字典</strong></p>
<p><img class="aligncenter size-full wp-image-105322 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045106671.png" alt="" width="862" height="726" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045106671.png 862w, http://www.mottoin.com/wp-content/uploads/2017/09/15045106671-300x253.png 300w, http://www.mottoin.com/wp-content/uploads/2017/09/15045106671-768x647.png 768w" sizes="(max-width: 862px) 100vw, 862px" /> <img class="aligncenter size-full wp-image-105323 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045106861.png" alt="" width="547" height="835" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045106861.png 547w, http://www.mottoin.com/wp-content/uploads/2017/09/15045106861-197x300.png 197w" sizes="(max-width: 547px) 100vw, 547px" /> <img class="aligncenter size-full wp-image-105324 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045107081.png" alt="" width="533" height="829" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045107081.png 533w, http://www.mottoin.com/wp-content/uploads/2017/09/15045107081-193x300.png 193w" sizes="(max-width: 533px) 100vw, 533px" /> <img class="aligncenter size-full wp-image-105325 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045107201.png" alt="" width="526" height="832" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045107201.png 526w, http://www.mottoin.com/wp-content/uploads/2017/09/15045107201-190x300.png 190w" sizes="(max-width: 526px) 100vw, 526px" /> <img class="aligncenter size-full wp-image-105326 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045107321.png" alt="" width="529" height="827" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045107321.png 529w, http://www.mottoin.com/wp-content/uploads/2017/09/15045107321-192x300.png 192w" sizes="(max-width: 529px) 100vw, 529px" /> <img class="aligncenter size-full wp-image-105327 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15045107451.png" alt="" width="524" height="706" data-srcset="http://www.mottoin.com/wp-content/uploads/2017/09/15045107451.png 524w, http://www.mottoin.com/wp-content/uploads/2017/09/15045107451-223x300.png 223w" sizes="(max-width: 524px) 100vw, 524px" /></p>
                                                        <div class="entry-copyright"><p>原创文章，作者：360安全，如若转载，请注明出处：http://www.mottoin.com/105241.html</p></div>                        </div>
                        <div class="entry-footer">
                            <div class="entry-tag"></div>
                            <div class="entry-action">
                                <div class="btn-zan" data-id="105241"><i class="fa fa-thumbs-up"></i> 赞 <span class="entry-action-num">(1)</span></div>

                                
                            </div>
                            <div class="entry-bar">
                                <div class="entry-bar-inner clearfix">
                                                                            <div class="author pull-left">
                                            <a data-user="529" target="_blank" href="http://www.mottoin.com/user/360/" class="avatar">
                                                <img src="http://www.mottoin.com/wp-content/uploads/ultimatemember/529/profile_photo-80.png?1505900679" class="func-um_user gravatar avatar avatar-60 um-avatar um-avatar-uploaded" width="60" height="60" alt="360安全" />                                                360安全                                            </a>
                                            <span class="author-title">企业用户</span>                                         </div>
                                                                        <div class="info pull-right">
                                        <div class="info-item meta">
                                            <a class="meta-item j-heart" href="javascript:;" data-id="105241"><i class="fa fa-heart"></i> <span class="data">0</span></a>
                                            <a class="meta-item" href="#comments"><i class="fa fa-comment"></i> <span class="data">0</span></a>
                                                                                    </div>
                                        <div class="info-item share">
                                            <a class="meta-item" href="javascript:;">
                                                <i class="fa fa-wechat"></i>
                                                <span class="wx-wrap">
                                                    <img src="//pan.baidu.com/share/qrcode?w=320&h=320&url=http://www.mottoin.com/105241.html">
                                                    <span>扫码分享到微信</span>
                                                </span>
                                            </a>
                                            <a class="meta-item" href="http://share.baidu.com/s?type=text&searchPic=1&sign=on&to=tsina&key=&url=http%3A%2F%2Fwww.mottoin.com%2F105241.html&title=%E6%82%84%E7%84%B6%E5%B4%9B%E8%B5%B7%E7%9A%84%E6%8C%96%E7%9F%BF%E6%9C%BA%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C%EF%BC%9A%E6%89%93%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%8C%96%E4%BB%B7%E5%80%BC%E7%99%BE%E4%B8%87%E9%97%A8%E7%BD%97%E5%B8%81" target="_blank"><i class="fa fa-weibo"></i></a>
                                            <a class="meta-item" href="http://share.baidu.com/s?type=text&searchPic=1&sign=on&to=qzone&key=&url=http%3A%2F%2Fwww.mottoin.com%2F105241.html&title=%E6%82%84%E7%84%B6%E5%B4%9B%E8%B5%B7%E7%9A%84%E6%8C%96%E7%9F%BF%E6%9C%BA%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C%EF%BC%9A%E6%89%93%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%8C%96%E4%BB%B7%E5%80%BC%E7%99%BE%E4%B8%87%E9%97%A8%E7%BD%97%E5%B8%81" target="_blank"><i class="fa fa-qq"></i></a>
                                        </div>
                                        <div class="info-item act">
                                            <a href="javascript:;" id="j-reading"><i class="fa fa-file-text"></i></a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                                                        <h3 class="entry-related-title">相关推荐</h3><ul class="entry-related clearfix"><li><a href="http://www.mottoin.com/88191.html" title="CVE-2013-3934 Wps栈溢出分析">CVE-2013-3934 Wps栈溢出分析</a></li><li><a href="http://www.mottoin.com/84091.html" title="Linux下Mac地址绑定防范arp病毒攻击">Linux下Mac地址绑定防范arp病毒攻击</a></li><li><a href="http://www.mottoin.com/102385.html" title="六面防护：教你如何打造一套深度防御体系">六面防护：教你如何打造一套深度防御体系</a></li><li><a href="http://www.mottoin.com/87137.html" title="BrupSuite使用Intruder绕过CSRF Token继续爆破">BrupSuite使用Intruder绕过CSRF Token继续爆破</a></li><li><a href="http://www.mottoin.com/104938.html" title="远控木马上演白利用偷天神技：揭秘假破解工具背后的盗刷暗流">远控木马上演白利用偷天神技：揭秘假破解工具背后的盗刷暗流</a></li><li><a href="http://www.mottoin.com/104983.html" title="手机银行木马程序将目光投向约车服务类APPs">手机银行木马程序将目光投向约车服务类APPs</a></li><li><a href="http://www.mottoin.com/104687.html" title="高通加解密引擎提权漏洞解析">高通加解密引擎提权漏洞解析</a></li><li><a href="http://www.mottoin.com/88278.html" title="Linux简单内核栈溢出调试分析">Linux简单内核栈溢出调试分析</a></li><li><a href="http://www.mottoin.com/84257.html" title="web前端安全编码">web前端安全编码</a></li><li><a href="http://www.mottoin.com/105329.html" title="HTTPS劫匪木马暴力升级：破坏ARK攻击杀软">HTTPS劫匪木马暴力升级：破坏ARK攻击杀软</a></li></ul>                        </div>
                        
<div id="comments" class="entry-comments">
    	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">发表评论 <small><a rel="nofollow" id="cancel-comment-reply-link" href="/105241.html#respond" style="display:none;">取消回复</a></small></h3><div class="comment-form"><div class="comment-must-login">请登录后评论...</div><div class="form-submit"><div class="form-submit-text pull-left"><a href="http://www.mottoin.com/login">登录</a>后才能评论</div> <input name="submit" type="submit" id="must-submit" class="submit" value="发表"></div></div>	</div><!-- #respond -->
		</div><!-- .comments-area -->                    </div>
                </article>
                    </div>
        <aside class="sidebar">
            <div id="profile-3" class="widget widget_profile">                <div class="cover_photo"></div>
                        <div class="avatar-wrap">
                <a target="_blank" href="http://www.mottoin.com/user/360/" class="avatar-link"><img src="http://www.mottoin.com/wp-content/uploads/ultimatemember/529/profile_photo-190.png?1505900679" class="func-um_user gravatar avatar avatar-120 um-avatar um-avatar-uploaded" width="120" height="120" alt="360安全" /></a></div>
            <div class="profile-info">
                <p><span class="author-name">360安全</span><span class="author-title">企业用户</span></p>
                <p class="author-description"></p>
            </div>
            <div class="profile-posts">
                <h3 class="widget-title"><span>最近文章</span></h3>
                <ul>                    <li><a href="http://www.mottoin.com/105879.html" title="全球首款网络安全概念车驶入上海滩">全球首款网络安全概念车驶入上海滩</a></li>
                                    <li><a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场</a></li>
                                    <li><a href="http://www.mottoin.com/105773.html" title="网页上的污染源：“PM2.5报告”插件实为恶意广告注射器">网页上的污染源：“PM2.5报告”插件实为恶意广告注射器</a></li>
                                    <li><a href="http://www.mottoin.com/105746.html" title="游戏辅助背后的黑产流水线：年劫持攻击千万次牟利数百万">游戏辅助背后的黑产流水线：年劫持攻击千万次牟利数百万</a></li>
                                    <li><a href="http://www.mottoin.com/105703.html" title="【现场还原】补天漏洞情报发布会记事">【现场还原】补天漏洞情报发布会记事</a></li>
                </ul>            </div>
            </div><div id="custom_html-3" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><a class="btn-post" href="/question"><i class="fa fa-edit"></i> 我要提问</a></div></div><div id="post-thumb-3" class="widget widget_post_thumb">            <ul>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105921.html" title="“黑客反击”的合法化之争">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/170918-Cox-The-Hackers-Hitting-Back-At-Cybercriminals-hero_vkcor5-480x300.gif" width="480" height="300" alt="“黑客反击”的合法化之争">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105921.html" title="“黑客反击”的合法化之争">“黑客反击”的合法化之争</a></p>
                            <p class="item-date">2017年9月20日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105917.html" title="美参议员要求电信巨头们回应SS7信令系统的安全问题">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG929-480x300.jpeg" width="480" height="300" alt="美参议员要求电信巨头们回应SS7信令系统的安全问题">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105917.html" title="美参议员要求电信巨头们回应SS7信令系统的安全问题">美参议员要求电信巨头们回应SS7信令系统的安全问题</a></p>
                            <p class="item-date">2017年9月19日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105914.html" title="美国国土安全部发布禁止使用卡巴斯基产品的明细">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG928-480x300.jpeg" width="480" height="300" alt="美国国土安全部发布禁止使用卡巴斯基产品的明细">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105914.html" title="美国国土安全部发布禁止使用卡巴斯基产品的明细">美国国土安全部发布禁止使用卡巴斯基产品的明细</a></p>
                            <p class="item-date">2017年9月19日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105885.html" title="【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG906-480x300.jpeg" width="480" height="300" alt="【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105885.html" title="【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）">【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）</a></p>
                            <p class="item-date">2017年9月19日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105879.html" title="全球首款网络安全概念车驶入上海滩">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15057198871-480x300.png" width="480" height="300" alt="全球首款网络安全概念车驶入上海滩">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105879.html" title="全球首款网络安全概念车驶入上海滩">全球首款网络安全概念车驶入上海滩</a></p>
                            <p class="item-date">2017年9月18日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105872.html" title="暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG897-480x300.jpeg" width="480" height="300" alt="暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105872.html" title="暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3">暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3</a></p>
                            <p class="item-date">2017年9月18日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105865.html" title="美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG896-480x300.jpeg" width="480" height="300" alt="美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105865.html" title="美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁">美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁</a></p>
                            <p class="item-date">2017年9月18日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105858.html" title="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG150-480x300.jpeg" width="480" height="300" alt="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105858.html" title="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护</a></p>
                            <p class="item-date">2017年9月17日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG141-480x300.jpeg" width="480" height="300" alt="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场</a></p>
                            <p class="item-date">2017年9月16日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105837.html" title="黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG132-480x300.jpeg" width="480" height="300" alt="黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105837.html" title="黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协">黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协</a></p>
                            <p class="item-date">2017年9月16日</p>
                        </div>
                    </li>
                            </ul>
        </div><div id="lastest-products-4" class="widget widget_lastest_products">            <ul class="p-list clearfix">
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105921.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/170918-Cox-The-Hackers-Hitting-Back-At-Cybercriminals-hero_vkcor5-480x300.gif" width="480" height="300" alt="“黑客反击”的合法化之争">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105921.html" title="“黑客反击”的合法化之争">
                                    “黑客反击”的合法化之争                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105858.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG150-480x300.jpeg" width="480" height="300" alt="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105858.html" title="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">
                                    DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105847.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG141-480x300.jpeg" width="480" height="300" alt="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">
                                    国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105799.html">
                                <img width="480" height="300" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" class="attachment-post-thumbnail size-post-thumbnail j-lazy wp-post-image" alt="暗网系列之：“入店行窃者”的工具、战术和克星" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15054708381-150x150-480x300.png" />                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105799.html" title="暗网系列之：“入店行窃者”的工具、战术和克星">
                                    暗网系列之：“入店行窃者”的工具、战术和克星                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105703.html">
                                <img width="480" height="300" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" class="attachment-post-thumbnail size-post-thumbnail j-lazy wp-post-image" alt="【现场还原】补天漏洞情报发布会记事" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG82-150x150-480x300.jpeg" />                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105703.html" title="【现场还原】补天漏洞情报发布会记事">
                                    【现场还原】补天漏洞情报发布会记事                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105692.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG75-480x300.jpeg" width="480" height="300" alt="SyScan360看点回顾：中美德俄等七国黑客专家神技大比拼">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105692.html" title="SyScan360看点回顾：中美德俄等七国黑客专家神技大比拼">
                                    SyScan360看点回顾：中美德俄等七国黑客专家神技大比拼                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105642.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG58-480x300.jpeg" width="480" height="300" alt="大安全时代序幕开启！ 中国互联网安全大会重新定义网络安全">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105642.html" title="大安全时代序幕开启！ 中国互联网安全大会重新定义网络安全">
                                    大安全时代序幕开启！ 中国互联网安全大会重新定义网络安全                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105621.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG512-480x300.jpeg" width="480" height="300" alt="【重磅推出】ISC大会补天漏洞情报服务发布会：英雄，你准备好了吗？">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105621.html" title="【重磅推出】ISC大会补天漏洞情报服务发布会：英雄，你准备好了吗？">
                                    【重磅推出】ISC大会补天漏洞情报服务发布会：英雄，你准备好了吗？                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105629.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG49-480x300.jpeg" width="480" height="300" alt="ISC直击：360守护者计划登陆ISC 最强白帽挑战黑客马拉松大奖赛">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105629.html" title="ISC直击：360守护者计划登陆ISC 最强白帽挑战黑客马拉松大奖赛">
                                    ISC直击：360守护者计划登陆ISC 最强白帽挑战黑客马拉松大奖赛                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105603.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG42-480x300.jpeg" width="480" height="300" alt="【ISC2017精彩剪辑】周鸿祎：大安全时代 网络空间防御刻不容缓">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105603.html" title="【ISC2017精彩剪辑】周鸿祎：大安全时代 网络空间防御刻不容缓">
                                    【ISC2017精彩剪辑】周鸿祎：大安全时代 网络空间防御刻不容缓                                </a>
                            </h4>
                        </div>
                    </li>
                            </ul>
        </div>        </aside>
    </div>
<div class="modal" id="login-modal">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                <h4 class="modal-title">请登录</h4>
            </div>
            <div class="modal-body login-modal-body">
                <p>您还未登录，请登录后再进行相关操作！</p>
                <div class="login-btn">
                    <a class="btn btn-login" href="http://www.mottoin.com/login">登 录</a>
                    <a class="btn btn-register" href="http://www.mottoin.com/register">注 册</a>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
<footer class="footer">
    <div class="container">
        <div class="clearfix">
                        <div class="footer-col footer-col-logo">
                <img src="http://www.mottoin.com/img/mottoin/tmxk.png" alt="MottoIN">
            </div>
                        <div class="footer-col footer-col-copy">
                <ul class="footer-nav hidden-xs"><li id="menu-item-104182" class="menu-item menu-item-104182"><a href="http://www.mottoin.com/about">关于我们</a></li>
<li id="menu-item-104181" class="menu-item menu-item-104181"><a href="http://www.mottoin.com/dis">免责声明</a></li>
<li id="menu-item-104183" class="menu-item menu-item-104183"><a href="http://www.mottoin.com/joinus">加入我们</a></li>
<li id="menu-item-105509" class="menu-item menu-item-105509"><a href="http://www.mottoin.com/contact">联系我们</a></li>
<li id="menu-item-104184" class="menu-item menu-item-104184"><a href="http://www.mottoin.com/report">寻求报道</a></li>
<li id="menu-item-104185" class="menu-item menu-item-104185"><a href="http://www.mottoin.com/contribute">我要投稿</a></li>
</ul>                <div class="copyright">
                    Copyright © 2017 MottoIN 版权所有 <a href="http://www.miibeian.gov.cn/">沪ICP备16010654号-5</a>  <img class="alignnone " src="http://www.mottoin.com/img/mottoin/ga.png" width="16" height="16" /> <a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31010402001331">沪公网安备31010402001331号</a>                 </div>
            </div>
            <div class="footer-col footer-col-sns">
                <div class="footer-sns">
                                                                                    <a class="sns-wx" href="javascript:;">
                            <i class="fa fa-weixin"></i>
                            <span style="background-image:url(http://www.mottoin.com/img/mottoin/weixin.jpg);"></span>
                        </a>
                                                                <a target="_blank" href="http://weibo.com/mottoin" rel="nofollow"><i class="fa fa-weibo"></i></a>
                                                                <a target="_blank" href="http://weibo.com/mottoin" rel="nofollow"><i class="fa fa-tencent-weibo"></i></a>
                                                                                                                                                                                </div>
            </div>
        </div>
    </div>
</footer>
<div class="action" style="top:50%;">
            <div class="a-box contact">
            <div class="contact-wrap">
                <h3 class="contact-title">联系我们</h3>
                <h4 style="text-align: center;"><span style="color: #2d6ded;"><strong>021-62666911</strong></span></h4>
<p>在线咨询：<a href="http://wpa.qq.com/msgrd?uin=19539638" target="_blank" rel="noopener"><img class="alignnone" title="点击这里给我发消息" src="http://wpa.qq.com/pa?p=2:1666839010:51" alt="点击这里给我发消息" border="0" /></a></p>
<p>邮件：root@mottoin.com</p>
<p>工作时间：周一至周五，9:30-18:30，节假日休息</p>
            </div>
        </div>
                <div class="a-box wechat">
            <div class="wechat-wrap">
                <img src="http://www.mottoin.com/img/mottoin/weixin.jpg" alt="QR code">
            </div>
        </div>
            <div class="a-box gotop" id="j-top" style="display: none;"></div>
</div>
<style>.footer{padding-bottom: 35px;}</style><div id="um_upload_single" style="display:none">
	
</div><div id="um_view_photo" style="display:none">

	<a href="#" data-action="um_remove_modal" class="um-modal-close"><i class="um-faicon-times"></i></a>
	
	<div class="um-modal-body photo">
	
		<div class="um-modal-photo">

		</div>

	</div>
	
</div><script type='text/javascript'>
/* <![CDATA[ */
var _wpcom_js = {"ajaxurl":"http:\/\/www.mottoin.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/themes/JustNews/js/main.js?ver=2.3.2'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/comment-reply.min.js?ver=4.8.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpcom_qa_js = {"ajaxurl":"http:\/\/www.mottoin.com\/wp-admin\/admin-ajax.php","ajaxloading":"http:\/\/www.mottoin.com\/wp-content\/plugins\/wpcom-qa\/images\/loading.gif"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/plugins/wpcom-qa/js/scripts.min.js?ver=1.0'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/imagesloaded.min.js?ver=3.2.0'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/masonry.min.js?ver=3.3.2'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/jquery/jquery.masonry.min.js?ver=3.1.2b'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var um_scripts = {"ajaxurl":"http:\/\/www.mottoin.com\/wp-admin\/admin-ajax.php","fileupload":"http:\/\/www.mottoin.com\/wp-content\/plugins\/ultimate-member\/core\/lib\/upload\/um-file-upload.php","imageupload":"http:\/\/www.mottoin.com\/wp-content\/plugins\/ultimate-member\/core\/lib\/upload\/um-image-upload.php"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/plugins/ultimate-member/assets/js/um.min.js?ver=10.3.88'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/plugins/ultimate-member/assets/js/pickadate/translations/zh_CN.js?ver=10.3.88'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/wp-embed.min.js?ver=4.8.1'></script>

		<script type="text/javascript">jQuery( '#request' ).val( '' );</script>

	    <script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":["mshare","tsina","weixin","qzone","sqq","douban","fbook","twi","bdhome","tqq","tieba","mail","youdao","print"],"bdPic":"","bdStyle":"1","bdSize":"16"},"share":[{"tag" : "single", "bdSize" : 16}, {"tag" : "global","bdSize" : 16,bdPopupOffsetLeft:-227}],url:'http://www.mottoin.com/wp-content/themes/JustNews'};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://www.mottoin.com/wp-content/themes/JustNews/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
</body>
</html>