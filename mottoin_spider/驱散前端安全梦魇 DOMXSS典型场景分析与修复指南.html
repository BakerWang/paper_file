<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
    <title>驱散前端安全梦魇——DOMXSS典型场景分析与修复指南 | MottoIN</title>
    <link rel='dns-prefetch' href='//www.mottoin.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="MottoIN &raquo; 驱散前端安全梦魇——DOMXSS典型场景分析与修复指南评论Feed" href="http://www.mottoin.com/87345.html/feed" />
<link rel='stylesheet' id='stylesheet-css'  href='http://www.mottoin.com/wp-content/themes/JustNews/css/style.css?ver=2.3.2' type='text/css' media='all' />
<link rel='stylesheet' id='wpcom-qa-css'  href='http://www.mottoin.com/wp-content/plugins/wpcom-qa/css/style.css?ver=1.0' type='text/css' media='all' />
<style id='wpcom-qa-inline-css' type='text/css'>

        .q-content .topic-tab,.q-content .q-answer .as-user,.q-content .q-answer .as-comment-name{color: #1471CA;}
        .q-content .q-topic-wrap a:hover,.q-content .q-answer .as-action a:hover,.q-content .topic-tab:hover{color:#0D62B3;}
        .q-content .put-top,.q-content .topic-tab.current-tab,.q-content .q-answer .as-submit .btn-submit,.q-content .q-answer .as-comments-submit,.q-content .q-add-header .btn-post,.q-content .q-pagination .current{background-color:#1471CA;}
        .q-content .q-answer .as-submit .btn-submit:hover,.q-content .q-answer .as-comments-submit:hover,.q-content .q-add-header .btn-post:hover,.q-content .topic-tab.current-tab:hover,.q-content .q-pagination a:hover{background-color:#0D62B3;}
        .q-content .q-answer .as-comments-input:focus{border-color: #1471CA;}
        
</style>
<link rel='stylesheet' id='um_minified-css'  href='http://www.mottoin.com/wp-content/plugins/ultimate-member/assets/css/um.min.css?ver=10.3.88' type='text/css' media='all' />
<script type='text/javascript' src='http://www.mottoin.com/wp-content/themes/JustNews/js/jquery.min.js?ver=1.12.4'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.mottoin.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.mottoin.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Scan-T：网络空间指纹扫描工具' href='http://www.mottoin.com/87339.html' />
<link rel='next' title='动手实现代码虚拟机' href='http://www.mottoin.com/87374.html' />
<link rel='shortlink' href='http://www.mottoin.com/?p=87345' />
<!--  WPCOM主题相关信息开始 -->
<meta name="applicable-device" content="pc,mobile">
<meta http-equiv="Cache-Control" content="no-transform">
<meta name="keywords" content="DOM-Based XSS,DOMXSS,Javascript,Web前端漏洞,xss,前端安全">
<meta name="description" content="0x00背景DOM-BasedXSS是一种基于文档对象模型（DocumentObjectModel，DOM)的Web前端漏洞，简单来说就是JavaScript代码缺陷造成的漏洞。与普通XSS不同的是，DOMXSS是在浏览器的解析中改变页面DOM树，且恶意代码并不在返回页面源码中回显，这使我们无法通过特征匹配来检测DOMXSS，给自动化漏洞检测带来了挑战。在2012年，腾讯安全平台部就研发并使用了基">
<!--  WPCOM主题相关信息结束 -->
 
		<script type="text/javascript">

		var ultimatemember_image_upload_url = 'http://www.mottoin.com/wp-content/plugins/ultimate-member/core/lib/upload/um-image-upload.php';
		var ultimatemember_file_upload_url = 'http://www.mottoin.com/wp-content/plugins/ultimate-member/core/lib/upload/um-file-upload.php';
		var ultimatemember_ajax_url = 'http://www.mottoin.com/wp-admin/admin-ajax.php';

		</script>

	
		<style type="text/css">.request_name { display: none !important; }</style>

	<link rel="icon" href="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-32x32.jpg" sizes="32x32" />
<link rel="icon" href="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-192x192.jpg" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-180x180.jpg" />
<meta name="msapplication-TileImage" content="http://www.mottoin.com/wp-content/uploads/2016/12/cropped-Avatar-270x270.jpg" />
    <style>
                a,.sec-panel-head span,.list.tabs .tab.active a,.header .nav>li.active>a,.header .dropdown-menu>.active>a,.entry .entry-info .nickname,.entry-bar-inner .author-title,.entry-action .btn-zan,.entry-action .btn-dashang,.comment-body .nickname,.form-submit-text span,.widget_profile .author-title,.um .um-profile-body .um-item-meta a,.login-modal-body .btn-register{color: #08c;}
        .header .dropdown-menu>li>a:hover,.header .dropdown-menu>.active>a:hover,.header .dropdown-menu>.active>a:focus,.navbar-action .publish,.pagination .current,.flex-control-paging li a.flex-active,.form-submit .submit,.sidebar .widget_nav_menu ul li.current-menu-item a,.sidebar .widget_nav_menu ul li.current-post-parent a,.search-form input.submit,.action .contact-title,.pf-submit,.tagHandler ul.tagHandlerContainer li.tagItem,.login-modal-body .btn-login,.woocommerce a.button,.woocommerce button.button,.woocommerce input.button,.woocommerce a.button.alt,.woocommerce button.button.alt,.woocommerce input.button.alt,.woocommerce a.button.alt.disabled,.woocommerce a.button.alt.disabled:hover,.woocommerce a.button.alt:disabled,.woocommerce a.button.alt:disabled:hover,.woocommerce a.button.alt:disabled[disabled],.woocommerce a.button.alt:disabled[disabled]:hover,.woocommerce button.button.alt.disabled,.woocommerce button.button.alt.disabled:hover,.woocommerce button.button.alt:disabled,.woocommerce button.button.alt:disabled:hover,.woocommerce button.button.alt:disabled[disabled],.woocommerce button.button.alt:disabled[disabled]:hover,.woocommerce input.button.alt.disabled,.woocommerce input.button.alt.disabled:hover,.woocommerce input.button.alt:disabled,.woocommerce input.button.alt:disabled:hover,.woocommerce input.button.alt:disabled[disabled],.woocommerce input.button.alt:disabled[disabled]:hover,.woocommerce .widget_price_filter .ui-slider .ui-slider-handle,.woocommerce .widget_price_filter .ui-slider .ui-slider-range,.shopping-count,.social-login-form .sl-input-submit{background-color: #08c;}
        .entry .entry-content h3,.entry .entry-content .h3,.widget-title{border-left-color: #08c;}
        .entry-bar-inner .author-title,.entry-action .btn-zan,.entry-action .btn-dashang,.search-form input.keyword:focus,.widget_profile .author-title,.login-modal-body .btn-login,.login-modal-body .btn-register{border-color: #08c;}
        .entry-bar-inner .author-title:before,.widget_profile .author-title:before{border-right-color: #08c;}
        .list.tabs .tab.active a{border-bottom-color: #08c;}

        a:hover,.header .nav>li>a:hover,.header .nav>li.active>a,.navbar-action .login:hover,.navbar-action .login:focus,.navbar-action .profile a:hover,.navbar-search-icon:hover,.navbar-search-icon:focus,.entry .entry-info a:hover,.entry .entry-info a:focus,.entry-bar .info-item a:hover,.p-item-wrap:hover .title a,.special-item-title a:hover,.special-item-bottom a:hover,.widget ul a:hover,.widget ol a:hover,.sec-panel-head .more:hover,.topic-list .topic-wrap:hover span,.tabs .tab a:hover,
        .article-list .item-title a:hover,.article-list .item-meta a:hover,.article-list .item-meta a:focus,.list-links a:hover,.list-links a:focus,.um .um-profile-body .um-item-meta a:hover,.um .um-profile-body .um-item-link a:hover,.load-more:hover,.login-modal-body .btn-register:hover{color: #07c;}
        .navbar-action .publish:hover,.navbar-action .publish:focus,.entry-tag a:hover,.entry-tag a:focus,.entry-action .btn-zan:hover,.entry-action .btn-dashang:hover,.entry-action .btn-zan.liked,.pagination a:hover,.flex-control-paging li a:hover,.form-submit .submit:hover,.widget .tagcloud a:hover,.sidebar .widget_nav_menu ul li.current-menu-item .sub-menu a:hover,.sidebar .widget_nav_menu ul li.current-post-parent .sub-menu a:hover,.sidebar .widget_nav_menu ul li a:hover,.search-form input.submit:hover,.action .a-box:hover,.footer-sns .fa:after,.article-list .item-category:hover,.pf-submit:hover,.tagHandler ul.tagHandlerContainer li.tagItem:hover,.login-modal-body .btn-login:hover,.woocommerce a.button:hover,.woocommerce button.button:hover,.woocommerce input.button:hover,.woocommerce a.button.alt:hover,.woocommerce button.button.alt:hover,.woocommerce input.button.alt:hover,.woocommerce .widget_price_filter .price_slider_wrapper .ui-widget-content,.social-login-form .sl-input-submit:hover{background-color: #07c;}
        .entry-tag a:hover,.entry-tag a:focus,.entry-action .btn-zan:hover,.entry-action .btn-dashang:hover,.entry-action .btn-zan.liked,.widget .tagcloud a:hover,.load-more:hover,.login-modal-body .btn-login:hover,.login-modal-body .btn-register:hover{border-color: #07c;}
        .special-item-bottom a:hover:before{border-left-color: #07c;}
        .list.tabs .tab.active a:hover{border-bottom-color: #07c;}
        @media (max-width: 991px){
            .header .navbar-nav>li.active>a,.header .navbar-nav .dropdown-menu .active a,.header .navbar-nav .dropdown-menu .active .dropdown-menu .active a{color: #08c;}
            .navbar-collapse{background-color: #08c;}
            .dropdown-menu>li a{border-color: #07c;}
            .header .navbar-nav>li.active>a:hover,.header .navbar-nav>li a:hover,.header .navbar-nav .dropdown-menu .active a:hover,.header .navbar-nav .dropdown-menu .active .dropdown-menu a:hover,.header .navbar-nav .dropdown-menu li a:hover{color: #07c;}
        }
        .j-share{position: fixed!important;top: 50%!important;}
                .header .logo img{max-height: 32px;}
                @media (max-width: 767px){
            .header .logo img{max-height: 26px;}
        }
                        .btn-post{
    display: block;
    margin: 0 auto;
    padding: 15px 20px;
    font-size: 16px;
    text-align: center;
    color: #fff !important;
    line-height: 1;
    background: #1471CA;
    -webkit-border-radius: 3px;
    border-radius: 3px;
    text-decoration: none;
    border: 0;
    outline: 0;
}    </style>
    <script> (function() {if (!/*@cc_on!@*/0) return;var e = "abbr, article, aside, audio, canvas, datalist, details, dialog, eventsource, figure, footer, header, hgroup, mark, menu, meter, nav, output, progress, section, time, video".split(', ');var i= e.length; while (i--){ document.createElement(e[i]) } })()</script>
    <!--[if lte IE 8]><script src="http://www.mottoin.com/wp-content/themes/JustNews/js/respond.min.js"></script><![endif]-->
</head>
<body class="post-template-default single single-post postid-87345 single-format-standard">
<header class="header">
    <div class="container clearfix">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar icon-bar-1"></span>
                <span class="icon-bar icon-bar-2"></span>
                <span class="icon-bar icon-bar-3"></span>
            </button>
            <a class="logo" href="http://www.mottoin.com"><img src="http://www.mottoin.com/img/mottoin/logo.png" alt="MottoIN"></a>
        </div>
        <div class="collapse navbar-collapse">
            <nav class="navbar-left primary-menu"><ul id="menu-%e5%af%bc%e8%88%aa" class="nav navbar-nav"><li class="menu-item menu-item-home"><a href="http://www.mottoin.com/">首页</a></li>
<li class="menu-item"><a href="http://www.mottoin.com/category/news">资讯</a></li>
<li class="menu-item current-post-ancestor dropdown"><a href="http://www.mottoin.com/category/article" class="dropdown-toggle">文章</a>
<ul role="menu" class=" dropdown-menu">
	<li class="menu-item current-post-ancestor current-menu-parent current-post-parent"><a href="http://www.mottoin.com/category/article/web">Web安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/system">系统安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/network">网络安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/terminal">终端安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/database">数据安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/wireless">无线安全</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/social">社会工程</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/intranet">内网渗透</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/code">代码审计</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/article/reverse">逆向破解</a></li>
</ul>
</li>
<li class="menu-item"><a href="http://www.mottoin.com/category/tools">工具</a></li>
<li class="menu-item"><a href="http://www.mottoin.com/category/geek">极客</a></li>
<li class="menu-item dropdown"><a href="http://www.mottoin.com/category/sole" class="dropdown-toggle">独家</a>
<ul role="menu" class=" dropdown-menu">
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/topic">专题</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/people">人物</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/view">观点</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/events">活动</a></li>
	<li class="menu-item"><a href="http://www.mottoin.com/category/sole/video">视频</a></li>
</ul>
</li>
<li class="menu-item"><a href="http://www.mottoin.com/category/hr">招聘</a></li>
<li class="menu-item"><a href="http://www.mottoin.com/forum">社区</a></li>
</ul></nav>            <div class="navbar-action pull-right">

                                    <form class="navbar-search" action="http://www.mottoin.com" method="get" role="search">
                        <input type="text" name="s" class="navbar-search-input" autocomplete="off" placeholder="输入关键词搜索..." value="">
                        <a class="navbar-search-icon j-navbar-search" href="javascript:;"></a>
                    </form>

                    
                    <div id="j-user-wrap">
                        <a class="login" href="http://www.mottoin.com/login">登录</a>
                        <a class="login" href="http://www.mottoin.com/register">注册</a>
                    </div>
                    <a class="publish" href="http://www.mottoin.com/post">
                        投稿</a>
                                                </div>
        </div><!-- /.navbar-collapse -->
    </div><!-- /.container -->
</header>
<div id="wrap">    <div class="main container">
        <div class="content">
                            <article id="post-87345" class="post-87345 post type-post status-publish format-standard has-post-thumbnail hentry category-web category-tech tag-dom-based-xss tag-domxss tag-javascript tag-web tag-xss tag-814">
                    <div class="entry">
                        <div class="entry-head">
                            <h1 class="entry-title">驱散前端安全梦魇——DOMXSS典型场景分析与修复指南</h1>
                            <div class="entry-info">
                                                                <a class="nickname" href="http://www.mottoin.com/user/seceditor/">Moto</a>
                                <span class="dot">•</span>
                                <span>2016年8月17日</span>
                                <span class="dot">•</span>
                                <a href="http://www.mottoin.com/category/article/web" rel="category tag">Web安全</a>, <a href="http://www.mottoin.com/category/tech" rel="category tag">技术控</a>                                                                    <span class="dot">•</span>
                                    <span>阅读 995</span>
                                                            </div>
                        </div>
                                                                        <div class="entry-content clearfix">
                            <h2>0x00 背景</h2>
<p>DOM-Based XSS是一种基于文档对象模型（Document Object Model，DOM)的Web前端漏洞，简单来说就是JavaScript代码缺陷造成的漏洞。与普通XSS不同的是，DOM XSS是在浏览器的解析中改变页面DOM树，且恶意代码并不在返回页面源码中回显，这使我们无法通过特征匹配来检测DOM XSS，给自动化漏洞检测带来了挑战。在2012年，腾讯安全平台部就研发并使用了基于QTWebkit引擎的检测方案。</p>
<p>然而，由于Web前端语言灵活多变，各项业务代码复杂不一，加上部分前端开发人员安全意识不足，仍源源不断有存在JavaScript缺陷的页面产生，使得DOM XSS的检测出现了不少“漏网之鱼”。更加雪上加霜的是，由于JavaScript是一门客户端脚本语言，其代码逻辑可以被任意用户查看到，所以不少“治标不治本”的DOM XSS对抗策略被攻击者再次绕过，刚爬出一个坑，又跌落另一个坑。</p>
<p>DOM XSS就像行人在广场随地乱吐的口香糖，成了Web前端挥之不去的安全梦魇。被随手编写出来容易，查找和修复却反反复复，费时费力。无论是目前安全平台部研发的门神系统，还是DOM XSS安全JS，都只能称作缓兵之计。若能在开发过程中，有针对性的留意容易造成DOM XSS的JavaScript代码多留一个心眼，对传入的数据做严格的过滤，将其限制在可控范围内，才有可能从根本上解决DOM XSS。毕竟所有漏洞的终极良药就是安全的开发意识和规范。驱散前端安全梦魇，保护用户安全，需要从开发到运维的多方面共同努力。</p>
<p>本文将首先讲解DOM XSS不可小觑的危害，接着总结高发DOM XSS的业务场景，给出缺陷代码实例，并详述漏洞产生原因，最后分类给出有效彻底的防护过滤手段。</p>
<h2>0x01 不可小觑的DOM-XSS</h2>
<p>比漏洞本身更具危害的是：掉以轻心。</p>
<p>一般情况下，XSS给人最深的印象似乎就是弹不完的浏览器提示框，除了恼人外，似乎无关痛痒：</p>
<p><img class="alignnone size-full wp-image-87346 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/1-16.jpg" alt="1" width="490" height="181" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/1-16.jpg 490w, http://www.mottoin.com/wp-content/uploads/2016/08/1-16-300x111.jpg 300w" sizes="(max-width: 490px) 100vw, 490px" /></p>
<p>但就算是小小的一个反射型DOM XSS，如果落到黑产手中，也会被利用的“淋漓尽致”，让成千上万的用户带来损失。以邮箱业务下的DOM XSS为例，通过该漏洞，黑产能够偷取到邮箱用户的cookie。借助这个“令牌”，攻击者就能够自由出入用户的邮箱，收发用户的私密邮件。至此，一方面攻击者能够劫持中招用户继续扩散恶意邮件，偷取更多邮箱用户的“令牌”，进而控制更多的邮箱；另一方面，黑产可以获取用户邮箱中的敏感信息，进而重置邮箱用户在其他网站注册的账户密码。试想，在如今生活方方面面离不开互联网的今天，如果一位用户将邮箱账户同时绑定了Apple iCloud账户，网盘账户，金融支付账户，邮箱的沦陷将带来多大的“雪崩式”效应。</p>
<p>你以为这就是全部了？如果DOM XSS如果出现在了客户端产品的“特权域”，危害将会被进一步升级。首先向大家来解释一下什么是“特权域”。特权域是部分客户端产品，因为要实现WEB和客户端产品的交互，比如在网页内点击链接自动安装一个浏览器插件，自动向手机推送一条消息。但同时出于安全考虑，又不能让所有WEB域都调用这些具有“特权”的接口，因此基于“白名单”思想，客户端开发工程师设下了“结界”，限制了类似只有如“*.qq.com”域名下将能够调用“结界”内的API接口。因为一般来讲，借助“白名单”思路，API的调用是十分可控的。但如果这些特权域下出现了DOM-XSS，攻击者可以通过引入外部恶意JS，让自己瞬间具备了调用特权API的权限，至此，工程师设下的“结界”被捅破严重的情况下，甚至可以导致客户端产品的远程代码执行。</p>
<h2>0x02 DOM XSS典型场景分析与修复指南</h2>
<h3>一、 在前端实现页面跳转</h3>
<p>在很多场景下，业务需要实现页面跳转，常见的实现方式一般有三种，第一种是设在后端设置302跳转Header或通过函数接收参数实现跳转，第二种是使用Meta标签实现跳转，最后一种是通过JavaScript实现跳转。不少Web前端工程师对最后一种跳转的方式情有独钟，最常用到的方法有:</p>
<pre class="">location.href / location.replace() / location.assign()</pre>
<p>也许提到页面跳转业务场景下的安全问题，你首先会想到限制不严导致任意URL跳转，而DOM XSS与此似乎“八竿子打不着”。但有一种神奇的东西叫“伪协议”，比如：“javascript:”、“vbscript:”、“data:”、“tencent:”、“mobileqqapi:”等，其中“javascript:”、“vbscript:”、“data:”在浏览器下可以执行脚本：</p>
<p><img class="alignnone size-full wp-image-87347 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/2-46.png" alt="2" width="810" height="187" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/2-46.png 810w, http://www.mottoin.com/wp-content/uploads/2016/08/2-46-300x69.png 300w, http://www.mottoin.com/wp-content/uploads/2016/08/2-46-768x177.png 768w" sizes="(max-width: 810px) 100vw, 810px" /></p>
<p>最为要命的是，使用这些伪协议执行的JavaScript代码的上下文（context）就是当前页面，也就相当于在页面内注入了一段恶意JavaScript代码。至此，攻击者也就能实施0x01中提到的攻击了。</p>
<p>经过前几年DOM XSS狂轰滥炸式的洗礼，Web前端工程处理起相关跳转代码逻辑来，也个个都是有经验的老司机了。直接从各种来源取跳转目标URL，然后通过上面提到的三个JavaScript实现跳转的方式，已销声匿迹。</p>
<p>你以为这样就结束了？这个世界上，还有一种比老司机更厉害的生物，那就是“老老司机”——时刻虎视眈眈查找业务漏洞的攻击者们。之前提到，由于JavaScript是一种客户端脚本语言，如果说Web后端代码有一层“窗户纸”护着的话，那位于Web前端的JavaScript代码就时时刻刻“天窗大开”和访客“坦诚相见”。所以，以下若干种过滤对抗手段，一下子就会眼尖的攻击者绕过，并继续大摇大摆的构造攻击：</p>
<h3>常见缺陷1：使用indexOf判断URL参数是否合法</h3>
<p>示例缺陷代码：</p>
<p><img class="alignnone size-full wp-image-87348 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/3-15.jpg" alt="3" width="696" height="291" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/3-15.jpg 696w, http://www.mottoin.com/wp-content/uploads/2016/08/3-15-300x125.jpg 300w" sizes="(max-width: 696px) 100vw, 696px" /></p>
<p>JavaScript相关规范中指出，indexOf() 方法可返回某个指定的字符串值在字符串中首次出现的位置。该方法将从头到尾地检索字符串 stringObject，看它是否含有子串 searchvalue。</p>
<p>也就是说，如果传入的URL中带有indexOf的关键词，那indexOf方法将直接返回true。拿上面的缺陷代码为例，只要攻击传入的URL中带有tmast://，indexOf将直接返回true，并进入跳转逻辑。所以攻击者只要构造”javascript:alert(1);//tmast://”即可完成攻击，又因为“tmast://”位于JavaScript代码的注释部分，所以JavaScript代码运行时会直接忽略，但indexOf却认为URL中存在“tmast://”直接放行。</p>
<h3>常见缺陷2：正则表达式缺陷</h3>
<p>示例缺陷代码 [1]：</p>
<p><img class="alignnone size-full wp-image-87349 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/4-11.jpg" alt="4" width="1784" height="228" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/4-11.jpg 1784w, http://www.mottoin.com/wp-content/uploads/2016/08/4-11-300x38.jpg 300w, http://www.mottoin.com/wp-content/uploads/2016/08/4-11-768x98.jpg 768w, http://www.mottoin.com/wp-content/uploads/2016/08/4-11-1024x131.jpg 1024w" sizes="(max-width: 1784px) 100vw, 1784px" /></p>
<p>示例缺陷代码 [2]：</p>
<p><img class="alignnone size-full wp-image-87350 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/5-8.jpg" alt="5" width="570" height="232" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/5-8.jpg 570w, http://www.mottoin.com/wp-content/uploads/2016/08/5-8-300x122.jpg 300w" sizes="(max-width: 570px) 100vw, 570px" /></p>
<p>聪明的Web前端工程狮，当然知道indexOf下潜藏的“深坑”，所以祭出了神器“正则表达式”。但不曾想“阴沟翻船”，有对URL进行了严格限制的意识，比如跳转页面只能是qq.com/paipai.com，认为这样就可以解决DOM-XSS和URL跳转的问题，但忘了一个神奇的符号“^”，加上和不加上，过滤的效果具有天壤之别。因为正则没有严格限制传入的URL开头只能是“http”或“https”，攻击者仍然可以构造“javascript:alert(1);//http://www.qq.com”来绕过看似严格的过滤。</p>
<h3>修复技巧</h3>
<p><img class="alignnone size-full wp-image-87351 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/6-8.jpg" alt="6" width="1805" height="232" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/6-8.jpg 1805w, http://www.mottoin.com/wp-content/uploads/2016/08/6-8-300x39.jpg 300w, http://www.mottoin.com/wp-content/uploads/2016/08/6-8-768x99.jpg 768w, http://www.mottoin.com/wp-content/uploads/2016/08/6-8-1024x132.jpg 1024w" sizes="(max-width: 1805px) 100vw, 1805px" /></p>
<p>在前端实现页面跳转业务场景下，正确的过滤实现方法是，严格限制跳转范围。一方面要限制能够跳转页面的协议：只能是http、https或是其他指可控协议；另一方面，要严格限制跳转的范围，如果业务只要跳转到指定的几个页面，可以直接从数组中取值判断是否这几个页面，如果跳转范围稍大，正确使用正则表达式将跳转URL严格限制到可控范围内。</p>
<h3>
二、 取值写入页面或动态执行</h3>
<p>除接收URL参数经后端处理最后在前端展示外，在Web前端通过JavaScript获取不同来源的参数值，不经后端处理即刻在Web页面进行展示或动态执行的业务场景也十分常见，虽然通过此方法，优化了用户的浏览体验，但也带来了满满的安全风险。</p>
<p>想要在客户端实现接受参数并写入页面或动态执行，就不得不用到JavaScript“三姐妹”，她们分别是：innerHTML、document.write、eval。“三姐妹”具有强大的功能的同时，不经意间也成了DOM-XSS攻击的导火索。因为JavaScript取值的来源纷繁复杂，如：Parameter、Cookies、Referer、Window name、SessionStorage等，工程师稍有不慎忘记做转义处理，或过分相信取值来源的数据，直接将分离出的参数值交给JavaScript“三姐妹”处理，就有可能招来DOM-XSS。接下来，将按不同数据源，详述每种业务场景下易造成DOM-XSS的代码缺陷。</p>
<h3>常见缺陷1：从URL中的取参数值写入页面或动态执行</h3>
<p>示例缺陷代码[1]：</p>
<p><img class="alignnone size-full wp-image-87352 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/7-7.jpg" alt="7" width="1800" height="556" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/7-7.jpg 1800w, http://www.mottoin.com/wp-content/uploads/2016/08/7-7-300x93.jpg 300w, http://www.mottoin.com/wp-content/uploads/2016/08/7-7-768x237.jpg 768w, http://www.mottoin.com/wp-content/uploads/2016/08/7-7-1024x316.jpg 1024w" sizes="(max-width: 1800px) 100vw, 1800px" /></p>
<p>粗心的工程狮直接从URL的锚参数（即位于#后面的参数）中取值，不经过任何处理直接innerHTML写入页面，导致攻击者只需要构造如下URL即可完成一次DOM XSS攻击：</p>
<p><img class="alignnone size-full wp-image-87353 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/8-4.jpg" alt="8" width="1098" height="42" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/8-4.jpg 1098w, http://www.mottoin.com/wp-content/uploads/2016/08/8-4-300x11.jpg 300w, http://www.mottoin.com/wp-content/uploads/2016/08/8-4-768x29.jpg 768w, http://www.mottoin.com/wp-content/uploads/2016/08/8-4-1024x39.jpg 1024w" sizes="(max-width: 1098px) 100vw, 1098px" /></p>
<p>由于整个攻击过程在客户端侧完成，不需要向服务器发送任何请求数据，所以即便业务接入了对抗反射型XSS的Web应用防火墙（WAF），这类DOM XSS也无法被感知，攻击者便可畅通无阻的利用漏洞对用户开展攻击。</p>
<h3>示例缺陷代码[2]:</h3>
<p><img class="alignnone size-full wp-image-87354 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/9-3.jpg" alt="9" width="830" height="155" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/9-3.jpg 830w, http://www.mottoin.com/wp-content/uploads/2016/08/9-3-300x56.jpg 300w, http://www.mottoin.com/wp-content/uploads/2016/08/9-3-768x143.jpg 768w" sizes="(max-width: 830px) 100vw, 830px" /></p>
<p>当然，不只是innerHTML一种方法，只要传入的参数值没有做任何处理，并进入到JavaScript“三姐妹”类似的函数中，就会产生DOM XSS漏洞。就比如在此案例下，页面内引入了jQuery库，JavaScript的initUI函数直接将获取到的未经过滤的name参数，通过“$().html()”的方式写入了页面，进而可以被攻击者利用，进行基于DOM XSS漏洞的攻击。</p>
<h3>常见缺陷2：从Cookie中的取参数值写入页面或动态执行</h3>
<p>示例缺陷代码[1]:</p>
<p><img class="alignnone size-full wp-image-87355 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/10-3.jpg" alt="10" width="1007" height="303" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/10-3.jpg 1007w, http://www.mottoin.com/wp-content/uploads/2016/08/10-3-300x90.jpg 300w, http://www.mottoin.com/wp-content/uploads/2016/08/10-3-768x231.jpg 768w" sizes="(max-width: 1007px) 100vw, 1007px" /></p>
<p>示例缺陷代码 [2]：</p>
<p><img class="alignnone size-full wp-image-87356 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/11-4.jpg" alt="11" width="1332" height="248" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/11-4.jpg 1332w, http://www.mottoin.com/wp-content/uploads/2016/08/11-4-300x56.jpg 300w, http://www.mottoin.com/wp-content/uploads/2016/08/11-4-768x143.jpg 768w, http://www.mottoin.com/wp-content/uploads/2016/08/11-4-1024x191.jpg 1024w" sizes="(max-width: 1332px) 100vw, 1332px" /></p>
<p>依据相关规范，在浏览器中不同域下的Cookie有隔离措施，即在google.com下是不能向qq.com下设置cookie的，可以说cookie这个来源相对来说较为可靠。但万事总是不是绝对的，由于过分相信cookie这个来源，除了直接从cookie中取值作为判断用户身份的依据造成任意用户账户登录的的高危逻辑缺陷外，不安全的cookie操作方式也产生了大量的DOM-XSS。</p>
<p>示例缺陷代码[1]，直接从cookie中取值写入页面或动态执行，原理基本同从URL中的取参数值写入页面或动态执行，只是换了一个取值来源而已，相信各位已经有了大概了解。但同时我们注意到，还有一种较为特殊的业务场景，示例缺陷代码[2]：取cookie键值，动态拼接要页面引入前端资源的URL。在此场景下，工程师已经对HTML常见的特殊字符做了过滤，是不是就安全了呢？并不。一般情况下，进行转义的HTML的特殊字符如下：</p>
<p><img class="alignnone size-full wp-image-87357 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/12-2.jpg" alt="12" width="554" height="132" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/12-2.jpg 554w, http://www.mottoin.com/wp-content/uploads/2016/08/12-2-300x71.jpg 300w" sizes="(max-width: 554px) 100vw, 554px" /></p>
<p>在上面这个案例中，如果window.isp取到的值为“www.attacker.com/”，最终拼接出来的静态资源URL路径为：http://www.attacker.com/victim.com，因为“.”和“/”都不在转义范围内，导致攻击者可以向页面引入自己站点下的恶意js文件，进而实施DOM-XSS攻击。</p>
<h3>常见缺陷3：从localStorage、Referer、Window name、SessionStorage中的取参数值写入页面或动态执行</h3>
<p>示例缺陷代码：</p>
<p><img class="alignnone size-full wp-image-87358 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/13-2.jpg" alt="13" width="949" height="486" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/13-2.jpg 949w, http://www.mottoin.com/wp-content/uploads/2016/08/13-2-300x154.jpg 300w, http://www.mottoin.com/wp-content/uploads/2016/08/13-2-768x393.jpg 768w" sizes="(max-width: 949px) 100vw, 949px" /></p>
<p>从localStorage、Referer、Window name、SessionStorage数据源中取数据，也时常是栽跟头的高发地。上面这段示例代码中，就首先取window.name的值，最后直接innerHTML到页面中。一般情况下，页面的window.name攻击者不可控，故往往会被认为来源相对可信。但借助iframe的name属性，攻击者可以将页面的window.name设置为攻击代码，仍然可以通过下面这段Payload，构造DOM XSS：</p>
<p><img class="alignnone size-full wp-image-87359 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/14-2.jpg" alt="14" width="1513" height="41" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/14-2.jpg 1513w, http://www.mottoin.com/wp-content/uploads/2016/08/14-2-300x8.jpg 300w, http://www.mottoin.com/wp-content/uploads/2016/08/14-2-768x21.jpg 768w, http://www.mottoin.com/wp-content/uploads/2016/08/14-2-1024x28.jpg 1024w" sizes="(max-width: 1513px) 100vw, 1513px" /></p>
<h3>修复技巧</h3>
<p>1. 写入页面前先转义。在取值写入页面或动态执行的业务场景下，在将各种来源获取到的参数值传入JavaScript“三姐妹”函数（innerHTML、document.write、eval）处理前，对传入数据中的HTML特殊字符进行转义处理能防止大部分DOM-XSS的产生。此外，根据不同业务的真实情况，还应使用正则表达式，针对传入的数据做更严格的过滤限制，才能保证万无一失。</p>
<p><img class="alignnone size-full wp-image-87360 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/15-2.jpg" alt="15" width="683" height="413" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/15-2.jpg 683w, http://www.mottoin.com/wp-content/uploads/2016/08/15-2-300x181.jpg 300w" sizes="(max-width: 683px) 100vw, 683px" /></p>
<p>2. 慎用危险的“eval”。需要强调的是，由于JavaScript中的eval函数十分灵活，能够支持执行的字符串编码纷繁复杂。强烈建议，不到万不得已，不要使用eval函数处理不可控的外部数据。</p>
<p>3. 编写安全的函数方法，从看似“可靠”的数据源获取参数值。无论是从cookie，还是从localStorage、Referer、Window name、SessionStorage中获取数据，都应使用安全的函数，对传入的数据做过滤后，再传递给相关函数写入页面或执行。</p>
<p><img class="alignnone size-full wp-image-87361 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/16-2.jpg" alt="16" width="1802" height="595" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/16-2.jpg 1802w, http://www.mottoin.com/wp-content/uploads/2016/08/16-2-300x99.jpg 300w, http://www.mottoin.com/wp-content/uploads/2016/08/16-2-768x254.jpg 768w, http://www.mottoin.com/wp-content/uploads/2016/08/16-2-1024x338.jpg 1024w" sizes="(max-width: 1802px) 100vw, 1802px" /></p>
<h3>三、 使用HTML5 postMessage进行跨域通讯</h3>
<p>示例缺陷代码：</p>
<p><img class="alignnone size-full wp-image-87362 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/17-2.jpg" alt="17" width="1200" height="301" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/17-2.jpg 1200w, http://www.mottoin.com/wp-content/uploads/2016/08/17-2-300x75.jpg 300w, http://www.mottoin.com/wp-content/uploads/2016/08/17-2-768x193.jpg 768w, http://www.mottoin.com/wp-content/uploads/2016/08/17-2-1024x257.jpg 1024w" sizes="(max-width: 1200px) 100vw, 1200px" /></p>
<p>HTML5引入的postMessage()方法允许来自不同源的脚本采用异步方式进行有限的通信，可以实现跨文本档、多窗口、跨域消息传递。其本意是方便Web前端开发者实现跨域通讯，由于浏览器遵循同源策略（Same Origin Policy），所以如下跨域向页面写入内容的操作将会被阻断：</p>
<p><img class="alignnone size-full wp-image-87363 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/18-1.jpg" alt="18" width="1301" height="262" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/18-1.jpg 1301w, http://www.mottoin.com/wp-content/uploads/2016/08/18-1-300x60.jpg 300w, http://www.mottoin.com/wp-content/uploads/2016/08/18-1-768x155.jpg 768w, http://www.mottoin.com/wp-content/uploads/2016/08/18-1-1024x206.jpg 1024w" sizes="(max-width: 1301px) 100vw, 1301px" /></p>
<p>但借助postMessage()方法，Web前端开发者就能实现跨域从site-a.net向site-b.net下页面写入内容。然而，开发者享受便利的同时，也却往往疏忽大意，忘记对postMessage的来源event.origin进行限制，导致任意域名下的页面只要通过如下代码，就可以与存在缺陷的页面进行跨域交互通讯，也再次落入DOM XSS的深坑：</p>
<p><img class="alignnone size-full wp-image-87363 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/18-1.jpg" alt="18" width="1301" height="262" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/18-1.jpg 1301w, http://www.mottoin.com/wp-content/uploads/2016/08/18-1-300x60.jpg 300w, http://www.mottoin.com/wp-content/uploads/2016/08/18-1-768x155.jpg 768w, http://www.mottoin.com/wp-content/uploads/2016/08/18-1-1024x206.jpg 1024w" sizes="(max-width: 1301px) 100vw, 1301px" /> <img class="alignnone size-full wp-image-87364 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/19.jpg" alt="19" width="1756" height="154" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/19.jpg 1756w, http://www.mottoin.com/wp-content/uploads/2016/08/19-300x26.jpg 300w, http://www.mottoin.com/wp-content/uploads/2016/08/19-768x67.jpg 768w, http://www.mottoin.com/wp-content/uploads/2016/08/19-1024x90.jpg 1024w" sizes="(max-width: 1756px) 100vw, 1756px" /></p>
<h3>修复技巧：</h3>
<p><img class="alignnone size-full wp-image-87365 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/20.jpg" alt="20" width="1275" height="303" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/20.jpg 1275w, http://www.mottoin.com/wp-content/uploads/2016/08/20-300x71.jpg 300w, http://www.mottoin.com/wp-content/uploads/2016/08/20-768x183.jpg 768w, http://www.mottoin.com/wp-content/uploads/2016/08/20-1024x243.jpg 1024w" sizes="(max-width: 1275px) 100vw, 1275px" /></p>
<p>修复此类漏洞的方法简单直接，只要在页面进行innerHTML操作前做一次even.origin的判断。当然，在innerHTML前，将event.data的数据进行一次HTML特殊字符转义，将会锦上添花，确保万无一失。</p>
<h3>四、使用存在缺陷的第三方库或通用组件</h3>
<p>常见缺陷：jQuery低版本（1.9.0以下）存在DOM XSS漏洞可导致用户身份被盗用 （参考：http://bugs.jquery.com/ticket/9521）</p>
<p><img class="alignnone size-full wp-image-87366 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/21.jpg" alt="21" width="409" height="235" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/21.jpg 409w, http://www.mottoin.com/wp-content/uploads/2016/08/21-300x172.jpg 300w" sizes="(max-width: 409px) 100vw, 409px" /></p>
<p style="text-align: center;">(图：漏洞利用代码传入$()函数执行可触发漏洞)</p>
<p>jQuery 是一个非常流行的JavaScript 库，但低版本的jQeury存在设计缺陷，导致引入低版本的jQuery文件之后，若对用户传入的参数值没有进行处理即传入$()函数中执行，且参数值中存在html标签，即$(‘〈 img src=x onerror=alert()〉‘)，jQuery会自动生成该html标签并加载在页面中，可导致DOM XSS漏洞。</p>
<h2>0x03 DOM XSS通用解决方案</h2>
<h3>一、参考/使用filter.js库</h3>
<p>filter.js由一系列针对常见业务场景下造成DOM XSS的恶意数据开展过滤的函数组成。其中包括：VaildURL、HtmlEncode、HtmlAttributeEncode等函数方法。在使用过程中，针对上面一部分提到的不同的场景需要，使用与之对应的过滤函数进行验证，才可以从根本上防止DOM XSS产生。</p>
<p><img class="alignnone size-full wp-image-87368 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/22.jpg" alt="22" width="1918" height="891" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/22.jpg 1918w, http://www.mottoin.com/wp-content/uploads/2016/08/22-300x139.jpg 300w, http://www.mottoin.com/wp-content/uploads/2016/08/22-768x357.jpg 768w, http://www.mottoin.com/wp-content/uploads/2016/08/22-1024x476.jpg 1024w" sizes="(max-width: 1918px) 100vw, 1918px" /></p>
<p style="text-align: center;">(图: aq_common.js实现原理及防御效果)</p>
<p>举个例子，当业务需要在前端实现页面跳转时，根据之前提到的修复策略，就应使用VaildURL方法对跳转目标做一次过滤验证。</p>
<p><img class="alignnone size-full wp-image-87369 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/23-1.jpg" alt="23" width="611" height="115" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/23-1.jpg 611w, http://www.mottoin.com/wp-content/uploads/2016/08/23-1-300x56.jpg 300w" sizes="(max-width: 611px) 100vw, 611px" /></p>
<p>当然在使用filter.js之前，需要根据业务真实情况，对其中部分JavaScript函数做修改，比如上面这个校验跳转目标网址的函数，就应根据自身需要基于正则表达式做相关扩充或更严格的限制。</p>
<h3>二、Web前端应用防护方案</h3>
<p>门神DOM-XSS防御JS是腾讯安全平台部为解决XSS问题提出的一套Web前端应用防护方案，与运行在后端的门神WAF是“亲兄弟”。但相较于传统WAF，门神DOM XSS防御JS通过JavaScript代码实现，所以能在客户端持续生效，可以缓解DOM XSS漏洞带来的危害。</p>
<p><img class="alignnone size-full wp-image-87370 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/24.jpg" alt="24" width="586" height="537" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/24.jpg 586w, http://www.mottoin.com/wp-content/uploads/2016/08/24-300x275.jpg 300w" sizes="(max-width: 586px) 100vw, 586px" /></p>
<p style="text-align: center;">(图: 门神DOM-XSS防御JS实现原理及防御效果)</p>
<p>在参考/使用filter.js库的同时，也不妨参考门神DOM XSS防御JS，给站点多加一层“防护罩”。不过需要提示的是，类似门神DOM XSS防御JS这样的Web前端应用防护，仅能提高常见DOM XSS攻击的门槛，并不能从源头上修复并解决XSS。所以要根除DOM XSS还需要从存在缺陷的代码入手，对获取的参数值做严格过滤限制，才能真正治本。</p>
<h3>三、定期进行漏洞检测</h3>
<p>在业务上线前后，使用漏洞扫描系统，定期进行漏洞检测有助于及时发现和处理JavaScript代码中的缺陷。</p>
<p>腾讯云的客户可以使用自带的“云安全 QS”，很方便地进行定期漏洞检测。访问“https://console.qcloud.com/host/defect/exam”，在如下界面添加要扫描的站点即可：</p>
<p><img class="alignnone size-full wp-image-87371 j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2016/08/25.jpg" alt="25" width="1425" height="688" data-srcset="http://www.mottoin.com/wp-content/uploads/2016/08/25.jpg 1425w, http://www.mottoin.com/wp-content/uploads/2016/08/25-300x145.jpg 300w, http://www.mottoin.com/wp-content/uploads/2016/08/25-768x371.jpg 768w, http://www.mottoin.com/wp-content/uploads/2016/08/25-1024x494.jpg 1024w" sizes="(max-width: 1425px) 100vw, 1425px" /></p>
<p style="text-align: center;">(图: 腾讯云“主机与网站安全”网站漏洞检测系统)</p>
<h2>0x04 写在最后</h2>
<p>用一句话来总结所有DOM XSS的场景，就是：不可控的危险数据，未经过滤被传入存在缺陷的JavaScript代码处理，最终触发DOM XSS漏洞。而在制定防护DOM XSS漏洞方案时，应首先树立起“安全的开发意识和规范”，从存在缺陷的代码入手，从源头解决DOM XSS，最后辅之以Web前端应用相关防护措施。</p>
<p>在防御和消灭DOM XSS漏洞的斗争一线，希望Web前端工程师们树立起安全的开发意识，与广大运维安全人员携手，将DOM XSS漏洞消灭在萌芽之中。驱散前端安全梦魇，保护用户安全。</p>
<h2>0x05 参考资料</h2>
<ol>
<li>[腾讯安全应急响应中心] 基于QtWebKit的DOM XSS检测技术<br />
https://security.tencent.com/index.php/blog/msg/12</li>
<li>[Hewlett Packard] XSS and App Security through HTML5&#8217;s PostMessage()<br />
http://community.hpe.com/t5/Protect-Your-Assets/XSS-and-App-Security-through-HTML5-s-PostMessage/ba-p/6515002#.V7FTFk196Ul</li>
</ol>
<p>&nbsp;</p>
<p style="text-align: center;">*来源：<a href="https://security.tencent.com/index.php/blog/msg/107">腾讯安全应急响应中心 </a> 作者：Martin  Mottoin小编整理发布</p>
                                                        <div class="entry-copyright"><p>原创文章，作者：Moto，如若转载，请注明出处：http://www.mottoin.com/87345.html</p></div>                        </div>
                        <div class="entry-footer">
                            <div class="entry-tag"><a href="http://www.mottoin.com/tag/dom-based-xss" rel="tag">DOM-Based XSS</a><a href="http://www.mottoin.com/tag/domxss" rel="tag">DOMXSS</a><a href="http://www.mottoin.com/tag/javascript" rel="tag">Javascript</a><a href="http://www.mottoin.com/tag/web%e5%89%8d%e7%ab%af%e6%bc%8f%e6%b4%9e" rel="tag">Web前端漏洞</a><a href="http://www.mottoin.com/tag/xss" rel="tag">xss</a><a href="http://www.mottoin.com/tag/%e5%89%8d%e7%ab%af%e5%ae%89%e5%85%a8" rel="tag">前端安全</a></div>
                            <div class="entry-action">
                                <div class="btn-zan" data-id="87345"><i class="fa fa-thumbs-up"></i> 赞 <span class="entry-action-num">(0)</span></div>

                                
                            </div>
                            <div class="entry-bar">
                                <div class="entry-bar-inner clearfix">
                                                                            <div class="author pull-left">
                                            <a data-user="7" target="_blank" href="http://www.mottoin.com/user/seceditor/" class="avatar">
                                                <img src="http://gravatar.com/avatar/?s=400&d=mm" class="func-um_user gravatar avatar avatar-60 um-avatar um-avatar-gravatar" width="60" height="60" alt="Moto" />                                                Moto                                            </a>
                                            <span class="author-title">普通用户</span>                                         </div>
                                                                        <div class="info pull-right">
                                        <div class="info-item meta">
                                            <a class="meta-item j-heart" href="javascript:;" data-id="87345"><i class="fa fa-heart"></i> <span class="data">0</span></a>
                                            <a class="meta-item" href="#comments"><i class="fa fa-comment"></i> <span class="data">0</span></a>
                                                                                    </div>
                                        <div class="info-item share">
                                            <a class="meta-item" href="javascript:;">
                                                <i class="fa fa-wechat"></i>
                                                <span class="wx-wrap">
                                                    <img src="//pan.baidu.com/share/qrcode?w=320&h=320&url=http://www.mottoin.com/87345.html">
                                                    <span>扫码分享到微信</span>
                                                </span>
                                            </a>
                                            <a class="meta-item" href="http://share.baidu.com/s?type=text&searchPic=1&sign=on&to=tsina&key=&url=http%3A%2F%2Fwww.mottoin.com%2F87345.html&title=%E9%A9%B1%E6%95%A3%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A8%E6%A2%A6%E9%AD%87%E2%80%94%E2%80%94DOMXSS%E5%85%B8%E5%9E%8B%E5%9C%BA%E6%99%AF%E5%88%86%E6%9E%90%E4%B8%8E%E4%BF%AE%E5%A4%8D%E6%8C%87%E5%8D%97" target="_blank"><i class="fa fa-weibo"></i></a>
                                            <a class="meta-item" href="http://share.baidu.com/s?type=text&searchPic=1&sign=on&to=qzone&key=&url=http%3A%2F%2Fwww.mottoin.com%2F87345.html&title=%E9%A9%B1%E6%95%A3%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A8%E6%A2%A6%E9%AD%87%E2%80%94%E2%80%94DOMXSS%E5%85%B8%E5%9E%8B%E5%9C%BA%E6%99%AF%E5%88%86%E6%9E%90%E4%B8%8E%E4%BF%AE%E5%A4%8D%E6%8C%87%E5%8D%97" target="_blank"><i class="fa fa-qq"></i></a>
                                        </div>
                                        <div class="info-item act">
                                            <a href="javascript:;" id="j-reading"><i class="fa fa-file-text"></i></a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                                                        <h3 class="entry-related-title">相关推荐</h3><ul class="entry-related clearfix"><li><a href="http://www.mottoin.com/538.html" title="开源沙盒Cuckoo － 自动化恶意软件分析软件">开源沙盒Cuckoo － 自动化恶意软件分析软件</a></li><li><a href="http://www.mottoin.com/87893.html" title="SANS：2016年网络威胁情报现状调研报告">SANS：2016年网络威胁情报现状调研报告</a></li><li><a href="http://www.mottoin.com/88697.html" title="色情应用暗藏杀机，宅男福利竟成“灾难降临”">色情应用暗藏杀机，宅男福利竟成“灾难降临”</a></li><li><a href="http://www.mottoin.com/102019.html" title="量子计算与密码学">量子计算与密码学</a></li><li><a href="http://www.mottoin.com/90266.html" title="谈一谈SQLite Load_Extension的妙用">谈一谈SQLite Load_Extension的妙用</a></li><li><a href="http://www.mottoin.com/102504.html" title="“斗篷&#038;匕首”攻击：静默安装一个上帝模式的APP">“斗篷&#038;匕首”攻击：静默安装一个上帝模式的APP</a></li><li><a href="http://www.mottoin.com/87977.html" title="Metasploit如何派生一个shell给cobaltstrike">Metasploit如何派生一个shell给cobaltstrike</a></li><li><a href="http://www.mottoin.com/517.html" title="RouterSploit － 路由器漏洞检测框架">RouterSploit － 路由器漏洞检测框架</a></li><li><a href="http://www.mottoin.com/90543.html" title="一种DOM Based XSS自动检测雏形">一种DOM Based XSS自动检测雏形</a></li><li><a href="http://www.mottoin.com/91981.html" title="命令行注入绕过过滤器的多个方法">命令行注入绕过过滤器的多个方法</a></li></ul>                        </div>
                        
<div id="comments" class="entry-comments">
    	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">发表评论 <small><a rel="nofollow" id="cancel-comment-reply-link" href="/87345.html#respond" style="display:none;">取消回复</a></small></h3><div class="comment-form"><div class="comment-must-login">请登录后评论...</div><div class="form-submit"><div class="form-submit-text pull-left"><a href="http://www.mottoin.com/login">登录</a>后才能评论</div> <input name="submit" type="submit" id="must-submit" class="submit" value="发表"></div></div>	</div><!-- #respond -->
		</div><!-- .comments-area -->                    </div>
                </article>
                    </div>
        <aside class="sidebar">
            <div id="profile-3" class="widget widget_profile">                <div class="cover_photo"></div>
                        <div class="avatar-wrap">
                <a target="_blank" href="http://www.mottoin.com/user/seceditor/" class="avatar-link"><img src="http://gravatar.com/avatar/?s=400&d=mm" class="func-um_user gravatar avatar avatar-120 um-avatar um-avatar-gravatar" width="120" height="120" alt="Moto" /></a></div>
            <div class="profile-info">
                <p><span class="author-name">Moto</span><span class="author-title">普通用户</span></p>
                <p class="author-description"></p>
            </div>
            <div class="profile-posts">
                <h3 class="widget-title"><span>最近文章</span></h3>
                <ul>                    <li><a href="http://www.mottoin.com/101279.html" title="Windows内核漏洞发现与利用">Windows内核漏洞发现与利用</a></li>
                                    <li><a href="http://www.mottoin.com/100495.html" title="浏览器信息收集: 利用 PowerShell 无文件读取 Chrome Cookie">浏览器信息收集: 利用 PowerShell 无文件读取 Chrome Cookie</a></li>
                                    <li><a href="http://www.mottoin.com/99735.html" title="一键无文件感染技术分析">一键无文件感染技术分析</a></li>
                                    <li><a href="http://www.mottoin.com/99776.html" title="APT10：中国黑客组织攻击全球IT服务供应商">APT10：中国黑客组织攻击全球IT服务供应商</a></li>
                                    <li><a href="http://www.mottoin.com/99257.html" title="IIS 6.0 WebDAV远程代码执行（CVE-2017-7269）">IIS 6.0 WebDAV远程代码执行（CVE-2017-7269）</a></li>
                </ul>            </div>
            </div><div id="custom_html-3" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><a class="btn-post" href="/question"><i class="fa fa-edit"></i> 我要提问</a></div></div><div id="post-thumb-3" class="widget widget_post_thumb">            <ul>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105921.html" title="“黑客反击”的合法化之争">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/170918-Cox-The-Hackers-Hitting-Back-At-Cybercriminals-hero_vkcor5-480x300.gif" width="480" height="300" alt="“黑客反击”的合法化之争">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105921.html" title="“黑客反击”的合法化之争">“黑客反击”的合法化之争</a></p>
                            <p class="item-date">2017年9月20日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105917.html" title="美参议员要求电信巨头们回应SS7信令系统的安全问题">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG929-480x300.jpeg" width="480" height="300" alt="美参议员要求电信巨头们回应SS7信令系统的安全问题">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105917.html" title="美参议员要求电信巨头们回应SS7信令系统的安全问题">美参议员要求电信巨头们回应SS7信令系统的安全问题</a></p>
                            <p class="item-date">2017年9月19日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105914.html" title="美国国土安全部发布禁止使用卡巴斯基产品的明细">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG928-480x300.jpeg" width="480" height="300" alt="美国国土安全部发布禁止使用卡巴斯基产品的明细">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105914.html" title="美国国土安全部发布禁止使用卡巴斯基产品的明细">美国国土安全部发布禁止使用卡巴斯基产品的明细</a></p>
                            <p class="item-date">2017年9月19日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105885.html" title="【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG906-480x300.jpeg" width="480" height="300" alt="【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105885.html" title="【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）">【威胁预警】供应链攻击：CCleaner 5.33官方下载被植入恶意代码（附技术详解）</a></p>
                            <p class="item-date">2017年9月19日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105879.html" title="全球首款网络安全概念车驶入上海滩">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15057198871-480x300.png" width="480" height="300" alt="全球首款网络安全概念车驶入上海滩">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105879.html" title="全球首款网络安全概念车驶入上海滩">全球首款网络安全概念车驶入上海滩</a></p>
                            <p class="item-date">2017年9月18日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105872.html" title="暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG897-480x300.jpeg" width="480" height="300" alt="暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105872.html" title="暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3">暗网市场上开始兜售Equifax的数据，数据泄漏后常见的诈骗招数1、2、3</a></p>
                            <p class="item-date">2017年9月18日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105865.html" title="美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG896-480x300.jpeg" width="480" height="300" alt="美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105865.html" title="美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁">美国财政部确认伊朗11个实体的恶意网络活动，宣布对它们实施制裁</a></p>
                            <p class="item-date">2017年9月18日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105858.html" title="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG150-480x300.jpeg" width="480" height="300" alt="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105858.html" title="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护</a></p>
                            <p class="item-date">2017年9月17日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG141-480x300.jpeg" width="480" height="300" alt="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场</a></p>
                            <p class="item-date">2017年9月16日</p>
                        </div>
                    </li>
                                    <li class="item">
                                                    <div class="item-img">
                                <a href="http://www.mottoin.com/105837.html" title="黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协">
                                    <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG132-480x300.jpeg" width="480" height="300" alt="黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协">                                </a>
                            </div>
                                                <div class="item-content">
                            <p class="item-title"><a href="http://www.mottoin.com/105837.html" title="黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协">黑客组织OurMine窃取Vevo约3.12TB数据，疑似后者已妥协</a></p>
                            <p class="item-date">2017年9月16日</p>
                        </div>
                    </li>
                            </ul>
        </div><div id="lastest-products-4" class="widget widget_lastest_products">            <ul class="p-list clearfix">
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105921.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/170918-Cox-The-Hackers-Hitting-Back-At-Cybercriminals-hero_vkcor5-480x300.gif" width="480" height="300" alt="“黑客反击”的合法化之争">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105921.html" title="“黑客反击”的合法化之争">
                                    “黑客反击”的合法化之争                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105858.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG150-480x300.jpeg" width="480" height="300" alt="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105858.html" title="DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护">
                                    DHS称美国政府不能正确评估 WannaCry 和NotPetya的影响，对企业缺乏适当的保护                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105847.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG141-480x300.jpeg" width="480" height="300" alt="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105847.html" title="国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场">
                                    国家网络安全周开幕 大安全时代360前沿“黑科技”震撼登场                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105799.html">
                                <img width="480" height="300" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" class="attachment-post-thumbnail size-post-thumbnail j-lazy wp-post-image" alt="暗网系列之：“入店行窃者”的工具、战术和克星" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/15054708381-150x150-480x300.png" />                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105799.html" title="暗网系列之：“入店行窃者”的工具、战术和克星">
                                    暗网系列之：“入店行窃者”的工具、战术和克星                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105703.html">
                                <img width="480" height="300" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" class="attachment-post-thumbnail size-post-thumbnail j-lazy wp-post-image" alt="【现场还原】补天漏洞情报发布会记事" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG82-150x150-480x300.jpeg" />                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105703.html" title="【现场还原】补天漏洞情报发布会记事">
                                    【现场还原】补天漏洞情报发布会记事                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105692.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG75-480x300.jpeg" width="480" height="300" alt="SyScan360看点回顾：中美德俄等七国黑客专家神技大比拼">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105692.html" title="SyScan360看点回顾：中美德俄等七国黑客专家神技大比拼">
                                    SyScan360看点回顾：中美德俄等七国黑客专家神技大比拼                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105642.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG58-480x300.jpeg" width="480" height="300" alt="大安全时代序幕开启！ 中国互联网安全大会重新定义网络安全">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105642.html" title="大安全时代序幕开启！ 中国互联网安全大会重新定义网络安全">
                                    大安全时代序幕开启！ 中国互联网安全大会重新定义网络安全                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105621.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG512-480x300.jpeg" width="480" height="300" alt="【重磅推出】ISC大会补天漏洞情报服务发布会：英雄，你准备好了吗？">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105621.html" title="【重磅推出】ISC大会补天漏洞情报服务发布会：英雄，你准备好了吗？">
                                    【重磅推出】ISC大会补天漏洞情报服务发布会：英雄，你准备好了吗？                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105629.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG49-480x300.jpeg" width="480" height="300" alt="ISC直击：360守护者计划登陆ISC 最强白帽挑战黑客马拉松大奖赛">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105629.html" title="ISC直击：360守护者计划登陆ISC 最强白帽挑战黑客马拉松大奖赛">
                                    ISC直击：360守护者计划登陆ISC 最强白帽挑战黑客马拉松大奖赛                                </a>
                            </h4>
                        </div>
                    </li>
                                    <li class="col-xs-12 col-md-6 p-item">
                        <div class="p-item-wrap">
                            <a class="thumb" href="http://www.mottoin.com/105603.html">
                                <img class="j-lazy" src="http://www.mottoin.com/wp-content/themes/JustNews/themer/assets/images/lazy.png" data-original="http://www.mottoin.com/wp-content/uploads/2017/09/WechatIMG42-480x300.jpeg" width="480" height="300" alt="【ISC2017精彩剪辑】周鸿祎：大安全时代 网络空间防御刻不容缓">                            </a>
                            <h4 class="title">
                                <a href="http://www.mottoin.com/105603.html" title="【ISC2017精彩剪辑】周鸿祎：大安全时代 网络空间防御刻不容缓">
                                    【ISC2017精彩剪辑】周鸿祎：大安全时代 网络空间防御刻不容缓                                </a>
                            </h4>
                        </div>
                    </li>
                            </ul>
        </div>        </aside>
    </div>
<div class="modal" id="login-modal">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                <h4 class="modal-title">请登录</h4>
            </div>
            <div class="modal-body login-modal-body">
                <p>您还未登录，请登录后再进行相关操作！</p>
                <div class="login-btn">
                    <a class="btn btn-login" href="http://www.mottoin.com/login">登 录</a>
                    <a class="btn btn-register" href="http://www.mottoin.com/register">注 册</a>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
<footer class="footer">
    <div class="container">
        <div class="clearfix">
                        <div class="footer-col footer-col-logo">
                <img src="http://www.mottoin.com/img/mottoin/tmxk.png" alt="MottoIN">
            </div>
                        <div class="footer-col footer-col-copy">
                <ul class="footer-nav hidden-xs"><li id="menu-item-104182" class="menu-item menu-item-104182"><a href="http://www.mottoin.com/about">关于我们</a></li>
<li id="menu-item-104181" class="menu-item menu-item-104181"><a href="http://www.mottoin.com/dis">免责声明</a></li>
<li id="menu-item-104183" class="menu-item menu-item-104183"><a href="http://www.mottoin.com/joinus">加入我们</a></li>
<li id="menu-item-105509" class="menu-item menu-item-105509"><a href="http://www.mottoin.com/contact">联系我们</a></li>
<li id="menu-item-104184" class="menu-item menu-item-104184"><a href="http://www.mottoin.com/report">寻求报道</a></li>
<li id="menu-item-104185" class="menu-item menu-item-104185"><a href="http://www.mottoin.com/contribute">我要投稿</a></li>
</ul>                <div class="copyright">
                    Copyright © 2017 MottoIN 版权所有 <a href="http://www.miibeian.gov.cn/">沪ICP备16010654号-5</a>  <img class="alignnone " src="http://www.mottoin.com/img/mottoin/ga.png" width="16" height="16" /> <a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31010402001331">沪公网安备31010402001331号</a>                 </div>
            </div>
            <div class="footer-col footer-col-sns">
                <div class="footer-sns">
                                                                                    <a class="sns-wx" href="javascript:;">
                            <i class="fa fa-weixin"></i>
                            <span style="background-image:url(http://www.mottoin.com/img/mottoin/weixin.jpg);"></span>
                        </a>
                                                                <a target="_blank" href="http://weibo.com/mottoin" rel="nofollow"><i class="fa fa-weibo"></i></a>
                                                                <a target="_blank" href="http://weibo.com/mottoin" rel="nofollow"><i class="fa fa-tencent-weibo"></i></a>
                                                                                                                                                                                </div>
            </div>
        </div>
    </div>
</footer>
<div class="action" style="top:50%;">
            <div class="a-box contact">
            <div class="contact-wrap">
                <h3 class="contact-title">联系我们</h3>
                <h4 style="text-align: center;"><span style="color: #2d6ded;"><strong>021-62666911</strong></span></h4>
<p>在线咨询：<a href="http://wpa.qq.com/msgrd?uin=19539638" target="_blank" rel="noopener"><img class="alignnone" title="点击这里给我发消息" src="http://wpa.qq.com/pa?p=2:1666839010:51" alt="点击这里给我发消息" border="0" /></a></p>
<p>邮件：root@mottoin.com</p>
<p>工作时间：周一至周五，9:30-18:30，节假日休息</p>
            </div>
        </div>
                <div class="a-box wechat">
            <div class="wechat-wrap">
                <img src="http://www.mottoin.com/img/mottoin/weixin.jpg" alt="QR code">
            </div>
        </div>
            <div class="a-box gotop" id="j-top" style="display: none;"></div>
</div>
<style>.footer{padding-bottom: 35px;}</style><div id="um_upload_single" style="display:none">
	
</div><div id="um_view_photo" style="display:none">

	<a href="#" data-action="um_remove_modal" class="um-modal-close"><i class="um-faicon-times"></i></a>
	
	<div class="um-modal-body photo">
	
		<div class="um-modal-photo">

		</div>

	</div>
	
</div><script type='text/javascript'>
/* <![CDATA[ */
var _wpcom_js = {"ajaxurl":"http:\/\/www.mottoin.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/themes/JustNews/js/main.js?ver=2.3.2'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/comment-reply.min.js?ver=4.8.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wpcom_qa_js = {"ajaxurl":"http:\/\/www.mottoin.com\/wp-admin\/admin-ajax.php","ajaxloading":"http:\/\/www.mottoin.com\/wp-content\/plugins\/wpcom-qa\/images\/loading.gif"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/plugins/wpcom-qa/js/scripts.min.js?ver=1.0'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/imagesloaded.min.js?ver=3.2.0'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/masonry.min.js?ver=3.3.2'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/jquery/jquery.masonry.min.js?ver=3.1.2b'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var um_scripts = {"ajaxurl":"http:\/\/www.mottoin.com\/wp-admin\/admin-ajax.php","fileupload":"http:\/\/www.mottoin.com\/wp-content\/plugins\/ultimate-member\/core\/lib\/upload\/um-file-upload.php","imageupload":"http:\/\/www.mottoin.com\/wp-content\/plugins\/ultimate-member\/core\/lib\/upload\/um-image-upload.php"};
/* ]]> */
</script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/plugins/ultimate-member/assets/js/um.min.js?ver=10.3.88'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-content/plugins/ultimate-member/assets/js/pickadate/translations/zh_CN.js?ver=10.3.88'></script>
<script type='text/javascript' src='http://www.mottoin.com/wp-includes/js/wp-embed.min.js?ver=4.8.1'></script>

		<script type="text/javascript">jQuery( '#request' ).val( '' );</script>

	    <script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":["mshare","tsina","weixin","qzone","sqq","douban","fbook","twi","bdhome","tqq","tieba","mail","youdao","print"],"bdPic":"","bdStyle":"1","bdSize":"16"},"share":[{"tag" : "single", "bdSize" : 16}, {"tag" : "global","bdSize" : 16,bdPopupOffsetLeft:-227}],url:'http://www.mottoin.com/wp-content/themes/JustNews'};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://www.mottoin.com/wp-content/themes/JustNews/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
</body>
</html>